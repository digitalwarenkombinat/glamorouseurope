function u5(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const a in r)if(a!=="default"&&!(a in t)){const i=Object.getOwnPropertyDescriptor(r,a);i&&Object.defineProperty(t,a,i.get?i:{enumerable:!0,get:()=>r[a]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function e(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(r){if(r.ep)return;r.ep=!0;const a=e(r);fetch(r.href,a)}})();var ya=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Hi(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function RV(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var a=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,a.get?a:{enumerable:!0,get:function(){return t[r]}})}),n}var c5={exports:{}},v0={},d5={exports:{}},Et={};/**
* @license React
* react.production.min.js
*
* Copyright (c) Facebook, Inc. and its affiliates.
*
* This source code is licensed under the MIT license found in the
* LICENSE file in the root directory of this source tree.
*/var nh=Symbol.for("react.element"),MV=Symbol.for("react.portal"),AV=Symbol.for("react.fragment"),PV=Symbol.for("react.strict_mode"),DV=Symbol.for("react.profiler"),LV=Symbol.for("react.provider"),FV=Symbol.for("react.context"),BV=Symbol.for("react.forward_ref"),zV=Symbol.for("react.suspense"),VV=Symbol.for("react.memo"),WV=Symbol.for("react.lazy"),p5=Symbol.iterator;function jV(t){return t===null||typeof t!="object"?null:(t=p5&&t[p5]||t["@@iterator"],typeof t=="function"?t:null)}var h5={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},f5=Object.assign,m5={};function zc(t,e,n){this.props=t,this.context=e,this.refs=m5,this.updater=n||h5}zc.prototype.isReactComponent={},zc.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")},zc.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function g5(){}g5.prototype=zc.prototype;function ek(t,e,n){this.props=t,this.context=e,this.refs=m5,this.updater=n||h5}var tk=ek.prototype=new g5;tk.constructor=ek,f5(tk,zc.prototype),tk.isPureReactComponent=!0;var y5=Array.isArray,b5=Object.prototype.hasOwnProperty,nk={current:null},v5={key:!0,ref:!0,__self:!0,__source:!0};function x5(t,e,n){var r,a={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)b5.call(e,r)&&!v5.hasOwnProperty(r)&&(a[r]=e[r]);var s=arguments.length-2;if(s===1)a.children=n;else if(1<s){for(var l=Array(s),u=0;u<s;u++)l[u]=arguments[u+2];a.children=l}if(t&&t.defaultProps)for(r in s=t.defaultProps,s)a[r]===void 0&&(a[r]=s[r]);return{$$typeof:nh,type:t,key:i,ref:o,props:a,_owner:nk.current}}function UV(t,e){return{$$typeof:nh,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function rk(t){return typeof t=="object"&&t!==null&&t.$$typeof===nh}function GV(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var w5=/\/+/g;function ak(t,e){return typeof t=="object"&&t!==null&&t.key!=null?GV(""+t.key):e.toString(36)}function x0(t,e,n,r,a){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case nh:case MV:o=!0}}if(o)return o=t,a=a(o),t=r===""?"."+ak(o,0):r,y5(a)?(n="",t!=null&&(n=t.replace(w5,"$&/")+"/"),x0(a,e,n,"",function(u){return u})):a!=null&&(rk(a)&&(a=UV(a,n+(!a.key||o&&o.key===a.key?"":(""+a.key).replace(w5,"$&/")+"/")+t)),e.push(a)),1;if(o=0,r=r===""?".":r+":",y5(t))for(var s=0;s<t.length;s++){i=t[s];var l=r+ak(i,s);o+=x0(i,e,n,l,a)}else if(l=jV(t),typeof l=="function")for(t=l.call(t),s=0;!(i=t.next()).done;)i=i.value,l=r+ak(i,s++),o+=x0(i,e,n,l,a);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function w0(t,e,n){if(t==null)return t;var r=[],a=0;return x0(t,r,"","",function(i){return e.call(n,i,a++)}),r}function HV(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var ba={current:null},k0={transition:null},qV={ReactCurrentDispatcher:ba,ReactCurrentBatchConfig:k0,ReactCurrentOwner:nk};Et.Children={map:w0,forEach:function(t,e,n){w0(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return w0(t,function(){e++}),e},toArray:function(t){return w0(t,function(e){return e})||[]},only:function(t){if(!rk(t))throw Error("React.Children.only expected to receive a single React element child.");return t}},Et.Component=zc,Et.Fragment=AV,Et.Profiler=DV,Et.PureComponent=ek,Et.StrictMode=PV,Et.Suspense=zV,Et.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=qV,Et.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=f5({},t.props),a=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=nk.current),e.key!==void 0&&(a=""+e.key),t.type&&t.type.defaultProps)var s=t.type.defaultProps;for(l in e)b5.call(e,l)&&!v5.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&s!==void 0?s[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){s=Array(l);for(var u=0;u<l;u++)s[u]=arguments[u+2];r.children=s}return{$$typeof:nh,type:t.type,key:a,ref:i,props:r,_owner:o}},Et.createContext=function(t){return t={$$typeof:FV,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:LV,_context:t},t.Consumer=t},Et.createElement=x5,Et.createFactory=function(t){var e=x5.bind(null,t);return e.type=t,e},Et.createRef=function(){return{current:null}},Et.forwardRef=function(t){return{$$typeof:BV,render:t}},Et.isValidElement=rk,Et.lazy=function(t){return{$$typeof:WV,_payload:{_status:-1,_result:t},_init:HV}},Et.memo=function(t,e){return{$$typeof:VV,type:t,compare:e===void 0?null:e}},Et.startTransition=function(t){var e=k0.transition;k0.transition={};try{t()}finally{k0.transition=e}},Et.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},Et.useCallback=function(t,e){return ba.current.useCallback(t,e)},Et.useContext=function(t){return ba.current.useContext(t)},Et.useDebugValue=function(){},Et.useDeferredValue=function(t){return ba.current.useDeferredValue(t)},Et.useEffect=function(t,e){return ba.current.useEffect(t,e)},Et.useId=function(){return ba.current.useId()},Et.useImperativeHandle=function(t,e,n){return ba.current.useImperativeHandle(t,e,n)},Et.useInsertionEffect=function(t,e){return ba.current.useInsertionEffect(t,e)},Et.useLayoutEffect=function(t,e){return ba.current.useLayoutEffect(t,e)},Et.useMemo=function(t,e){return ba.current.useMemo(t,e)},Et.useReducer=function(t,e,n){return ba.current.useReducer(t,e,n)},Et.useRef=function(t){return ba.current.useRef(t)},Et.useState=function(t){return ba.current.useState(t)},Et.useSyncExternalStore=function(t,e,n){return ba.current.useSyncExternalStore(t,e,n)},Et.useTransition=function(){return ba.current.useTransition()},Et.version="18.2.0",d5.exports=Et;var P=d5.exports;const G=Hi(P),k5=u5({__proto__:null,default:G},[P]);/**
* @license React
* react-jsx-runtime.production.min.js
*
* Copyright (c) Facebook, Inc. and its affiliates.
*
* This source code is licensed under the MIT license found in the
* LICENSE file in the root directory of this source tree.
*/var KV=P,XV=Symbol.for("react.element"),YV=Symbol.for("react.fragment"),QV=Object.prototype.hasOwnProperty,ZV=KV.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,JV={key:!0,ref:!0,__self:!0,__source:!0};function S5(t,e,n){var r,a={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)QV.call(e,r)&&!JV.hasOwnProperty(r)&&(a[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)a[r]===void 0&&(a[r]=e[r]);return{$$typeof:XV,type:t,key:i,ref:o,props:a,_owner:ZV.current}}v0.Fragment=YV,v0.jsx=S5,v0.jsxs=S5,c5.exports=v0;var fe=c5.exports;const eW={type:"logger",log(t){this.output("log",t)},warn(t){this.output("warn",t)},error(t){this.output("error",t)},output(t,e){console&&console[t]&&console[t].apply(console,e)}};let tW=class ME{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.init(e,n)}init(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.prefix=n.prefix||"i18next:",this.logger=e||eW,this.options=n,this.debug=n.debug}log(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.forward(n,"log","",!0)}warn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.forward(n,"warn","",!0)}error(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.forward(n,"error","")}deprecate(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.forward(n,"warn","WARNING DEPRECATED: ",!0)}forward(e,n,r,a){return a&&!this.debug?null:(typeof e[0]=="string"&&(e[0]=`${r}${this.prefix} ${e[0]}`),this.logger[n](e))}create(e){return new ME(this.logger,{prefix:`${this.prefix}:${e}:`,...this.options})}clone(e){return e=e||this.options,e.prefix=e.prefix||this.prefix,new ME(this.logger,e)}};var ko=new tW;class S0{constructor(){this.observers={}}on(e,n){return e.split(" ").forEach(r=>{this.observers[r]||(this.observers[r]=new Map);const a=this.observers[r].get(n)||0;this.observers[r].set(n,a+1)}),this}off(e,n){if(this.observers[e]){if(!n){delete this.observers[e];return}this.observers[e].delete(n)}}emit(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];this.observers[e]&&Array.from(this.observers[e].entries()).forEach(i=>{let[o,s]=i;for(let l=0;l<s;l++)o(...r)}),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach(i=>{let[o,s]=i;for(let l=0;l<s;l++)o.apply(o,[e,...r])})}}function rh(){let t,e;const n=new Promise((r,a)=>{t=r,e=a});return n.resolve=t,n.reject=e,n}function C5(t){return t==null?"":""+t}function nW(t,e,n){t.forEach(r=>{e[r]&&(n[r]=e[r])})}const rW=/###/g;function ah(t,e,n){function r(s){return s&&s.indexOf("###")>-1?s.replace(rW,"."):s}function a(){return!t||typeof t=="string"}const i=typeof e!="string"?e:e.split(".");let o=0;for(;o<i.length-1;){if(a())return{};const s=r(i[o]);!t[s]&&n&&(t[s]=new n),Object.prototype.hasOwnProperty.call(t,s)?t=t[s]:t={},++o}return a()?{}:{obj:t,k:r(i[o])}}function N5(t,e,n){const{obj:r,k:a}=ah(t,e,Object);if(r!==void 0||e.length===1){r[a]=n;return}let i=e[e.length-1],o=e.slice(0,e.length-1),s=ah(t,o,Object);for(;s.obj===void 0&&o.length;)i=`${o[o.length-1]}.${i}`,o=o.slice(0,o.length-1),s=ah(t,o,Object),s&&s.obj&&typeof s.obj[`${s.k}.${i}`]<"u"&&(s.obj=void 0);s.obj[`${s.k}.${i}`]=n}function aW(t,e,n,r){const{obj:a,k:i}=ah(t,e,Object);a[i]=a[i]||[],r&&(a[i]=a[i].concat(n)),r||a[i].push(n)}function C0(t,e){const{obj:n,k:r}=ah(t,e);if(n)return n[r]}function iW(t,e,n){const r=C0(t,n);return r!==void 0?r:C0(e,n)}function T5(t,e,n){for(const r in e)r!=="__proto__"&&r!=="constructor"&&(r in t?typeof t[r]=="string"||t[r]instanceof String||typeof e[r]=="string"||e[r]instanceof String?n&&(t[r]=e[r]):T5(t[r],e[r],n):t[r]=e[r]);return t}function Vc(t){return t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}var oW={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};function sW(t){return typeof t=="string"?t.replace(/[&<>"'\/]/g,e=>oW[e]):t}class lW{constructor(e){this.capacity=e,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(e){const n=this.regExpMap.get(e);if(n!==void 0)return n;const r=new RegExp(e);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(e,r),this.regExpQueue.push(e),r}}const uW=[" ",",","?","!",";"],cW=new lW(20);function dW(t,e,n){e=e||"",n=n||"";const r=uW.filter(o=>e.indexOf(o)<0&&n.indexOf(o)<0);if(r.length===0)return!0;const a=cW.getRegExp(`(${r.map(o=>o==="?"?"\\?":o).join("|")})`);let i=!a.test(t);if(!i){const o=t.indexOf(n);o>0&&!a.test(t.substring(0,o))&&(i=!0)}return i}function ik(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:".";if(!t)return;if(t[e])return t[e];const r=e.split(n);let a=t;for(let i=0;i<r.length;){if(!a||typeof a!="object")return;let o,s="";for(let l=i;l<r.length;++l)if(l!==i&&(s+=n),s+=r[l],o=a[s],o!==void 0){if(["string","number","boolean"].indexOf(typeof o)>-1&&l<r.length-1)continue;i+=l-i+1;break}a=o}return a}function N0(t){return t&&t.indexOf("_")>0?t.replace("_","-"):t}class I5 extends S0{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{ns:["translation"],defaultNS:"translation"};super(),this.data=e||{},this.options=n,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.options.ignoreJSONStructure===void 0&&(this.options.ignoreJSONStructure=!0)}addNamespaces(e){this.options.ns.indexOf(e)<0&&this.options.ns.push(e)}removeNamespaces(e){const n=this.options.ns.indexOf(e);n>-1&&this.options.ns.splice(n,1)}getResource(e,n,r){let a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};const i=a.keySeparator!==void 0?a.keySeparator:this.options.keySeparator,o=a.ignoreJSONStructure!==void 0?a.ignoreJSONStructure:this.options.ignoreJSONStructure;let s;e.indexOf(".")>-1?s=e.split("."):(s=[e,n],r&&(Array.isArray(r)?s.push(...r):typeof r=="string"&&i?s.push(...r.split(i)):s.push(r)));const l=C0(this.data,s);return!l&&!n&&!r&&e.indexOf(".")>-1&&(e=s[0],n=s[1],r=s.slice(2).join(".")),l||!o||typeof r!="string"?l:ik(this.data&&this.data[e]&&this.data[e][n],r,i)}addResource(e,n,r,a){let i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{silent:!1};const o=i.keySeparator!==void 0?i.keySeparator:this.options.keySeparator;let s=[e,n];r&&(s=s.concat(o?r.split(o):r)),e.indexOf(".")>-1&&(s=e.split("."),a=n,n=s[1]),this.addNamespaces(n),N5(this.data,s,a),i.silent||this.emit("added",e,n,r,a)}addResources(e,n,r){let a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{silent:!1};for(const i in r)(typeof r[i]=="string"||Object.prototype.toString.apply(r[i])==="[object Array]")&&this.addResource(e,n,i,r[i],{silent:!0});a.silent||this.emit("added",e,n,r)}addResourceBundle(e,n,r,a,i){let o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{silent:!1},s=[e,n];e.indexOf(".")>-1&&(s=e.split("."),a=r,r=n,n=s[1]),this.addNamespaces(n);let l=C0(this.data,s)||{};a?T5(l,r,i):l={...l,...r},N5(this.data,s,l),o.silent||this.emit("added",e,n,r)}removeResourceBundle(e,n){this.hasResourceBundle(e,n)&&delete this.data[e][n],this.removeNamespaces(n),this.emit("removed",e,n)}hasResourceBundle(e,n){return this.getResource(e,n)!==void 0}getResourceBundle(e,n){return n||(n=this.options.defaultNS),this.options.compatibilityAPI==="v1"?{...this.getResource(e,n)}:this.getResource(e,n)}getDataByLanguage(e){return this.data[e]}hasLanguageSomeTranslations(e){const n=this.getDataByLanguage(e);return!!(n&&Object.keys(n)||[]).find(r=>n[r]&&Object.keys(n[r]).length>0)}toJSON(){return this.data}}var E5={processors:{},addPostProcessor(t){this.processors[t.name]=t},handle(t,e,n,r,a){return t.forEach(i=>{this.processors[i]&&(e=this.processors[i].process(e,n,r,a))}),e}};const _5={};class W2 extends S0{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),nW(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],e,this),this.options=n,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.logger=ko.create("translator")}changeLanguage(e){e&&(this.language=e)}exists(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}};if(e==null)return!1;const r=this.resolve(e,n);return r&&r.res!==void 0}extractFromKey(e,n){let r=n.nsSeparator!==void 0?n.nsSeparator:this.options.nsSeparator;r===void 0&&(r=":");const a=n.keySeparator!==void 0?n.keySeparator:this.options.keySeparator;let i=n.ns||this.options.defaultNS||[];const o=r&&e.indexOf(r)>-1,s=!this.options.userDefinedKeySeparator&&!n.keySeparator&&!this.options.userDefinedNsSeparator&&!n.nsSeparator&&!dW(e,r,a);if(o&&!s){const l=e.match(this.interpolator.nestingRegexp);if(l&&l.length>0)return{key:e,namespaces:i};const u=e.split(r);(r!==a||r===a&&this.options.ns.indexOf(u[0])>-1)&&(i=u.shift()),e=u.join(a)}return typeof i=="string"&&(i=[i]),{key:e,namespaces:i}}translate(e,n,r){if(typeof n!="object"&&this.options.overloadTranslationOptionHandler&&(n=this.options.overloadTranslationOptionHandler(arguments)),typeof n=="object"&&(n={...n}),n||(n={}),e==null)return"";Array.isArray(e)||(e=[String(e)]);const a=n.returnDetails!==void 0?n.returnDetails:this.options.returnDetails,i=n.keySeparator!==void 0?n.keySeparator:this.options.keySeparator,{key:o,namespaces:s}=this.extractFromKey(e[e.length-1],n),l=s[s.length-1],u=n.lng||this.language,c=n.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(u&&u.toLowerCase()==="cimode"){if(c){const w=n.nsSeparator||this.options.nsSeparator;return a?{res:`${l}${w}${o}`,usedKey:o,exactUsedKey:o,usedLng:u,usedNS:l,usedParams:this.getUsedParamsDetails(n)}:`${l}${w}${o}`}return a?{res:o,usedKey:o,exactUsedKey:o,usedLng:u,usedNS:l,usedParams:this.getUsedParamsDetails(n)}:o}const d=this.resolve(e,n);let p=d&&d.res;const f=d&&d.usedKey||o,g=d&&d.exactUsedKey||o,y=Object.prototype.toString.apply(p),x=["[object Number]","[object Function]","[object RegExp]"],b=n.joinArrays!==void 0?n.joinArrays:this.options.joinArrays,v=!this.i18nFormat||this.i18nFormat.handleAsObject;if(v&&p&&typeof p!="string"&&typeof p!="boolean"&&typeof p!="number"&&x.indexOf(y)<0&&!(typeof b=="string"&&y==="[object Array]")){if(!n.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const w=this.options.returnedObjectHandler?this.options.returnedObjectHandler(f,p,{...n,ns:s}):`key '${o} (${this.language})' returned an object instead of string.`;return a?(d.res=w,d.usedParams=this.getUsedParamsDetails(n),d):w}if(i){const w=y==="[object Array]",S=w?[]:{},C=w?g:f;for(const I in p)if(Object.prototype.hasOwnProperty.call(p,I)){const _=`${C}${i}${I}`;S[I]=this.translate(_,{...n,joinArrays:!1,ns:s}),S[I]===_&&(S[I]=p[I])}p=S}}else if(v&&typeof b=="string"&&y==="[object Array]")p=p.join(b),p&&(p=this.extendTranslation(p,e,n,r));else{let w=!1,S=!1;const C=n.count!==void 0&&typeof n.count!="string",I=W2.hasDefaultValue(n),_=C?this.pluralResolver.getSuffix(u,n.count,n):"",E=n.ordinal&&C?this.pluralResolver.getSuffix(u,n.count,{ordinal:!1}):"",A=C&&!n.ordinal&&n.count===0&&this.pluralResolver.shouldUseIntlApi(),M=A&&n[`defaultValue${this.options.pluralSeparator}zero`]||n[`defaultValue${_}`]||n[`defaultValue${E}`]||n.defaultValue;!this.isValidLookup(p)&&I&&(w=!0,p=M),this.isValidLookup(p)||(S=!0,p=o);const L=(n.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&S?void 0:p,W=I&&M!==p&&this.options.updateMissing;if(S||w||W){if(this.logger.log(W?"updateKey":"missingKey",u,l,o,W?M:p),i){const Q=this.resolve(o,{...n,keySeparator:!1});Q&&Q.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let B=[];const K=this.languageUtils.getFallbackCodes(this.options.fallbackLng,n.lng||this.language);if(this.options.saveMissingTo==="fallback"&&K&&K[0])for(let Q=0;Q<K.length;Q++)B.push(K[Q]);else this.options.saveMissingTo==="all"?B=this.languageUtils.toResolveHierarchy(n.lng||this.language):B.push(n.lng||this.language);const X=(Q,H,F)=>{const Y=I&&F!==p?F:L;this.options.missingKeyHandler?this.options.missingKeyHandler(Q,l,H,Y,W,n):this.backendConnector&&this.backendConnector.saveMissing&&this.backendConnector.saveMissing(Q,l,H,Y,W,n),this.emit("missingKey",Q,l,H,p)};this.options.saveMissing&&(this.options.saveMissingPlurals&&C?B.forEach(Q=>{const H=this.pluralResolver.getSuffixes(Q,n);A&&n[`defaultValue${this.options.pluralSeparator}zero`]&&H.indexOf(`${this.options.pluralSeparator}zero`)<0&&H.push(`${this.options.pluralSeparator}zero`),H.forEach(F=>{X([Q],o+F,n[`defaultValue${F}`]||M)})}):X(B,o,M))}p=this.extendTranslation(p,e,n,d,r),S&&p===o&&this.options.appendNamespaceToMissingKey&&(p=`${l}:${o}`),(S||w)&&this.options.parseMissingKeyHandler&&(this.options.compatibilityAPI!=="v1"?p=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${l}:${o}`:o,w?p:void 0):p=this.options.parseMissingKeyHandler(p))}return a?(d.res=p,d.usedParams=this.getUsedParamsDetails(n),d):p}extendTranslation(e,n,r,a,i){var o=this;if(this.i18nFormat&&this.i18nFormat.parse)e=this.i18nFormat.parse(e,{...this.options.interpolation.defaultVariables,...r},r.lng||this.language||a.usedLng,a.usedNS,a.usedKey,{resolved:a});else if(!r.skipInterpolation){r.interpolation&&this.interpolator.init({...r,interpolation:{...this.options.interpolation,...r.interpolation}});const u=typeof e=="string"&&(r&&r.interpolation&&r.interpolation.skipOnVariables!==void 0?r.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let c;if(u){const p=e.match(this.interpolator.nestingRegexp);c=p&&p.length}let d=r.replace&&typeof r.replace!="string"?r.replace:r;if(this.options.interpolation.defaultVariables&&(d={...this.options.interpolation.defaultVariables,...d}),e=this.interpolator.interpolate(e,d,r.lng||this.language,r),u){const p=e.match(this.interpolator.nestingRegexp),f=p&&p.length;c<f&&(r.nest=!1)}!r.lng&&this.options.compatibilityAPI!=="v1"&&a&&a.res&&(r.lng=a.usedLng),r.nest!==!1&&(e=this.interpolator.nest(e,function(){for(var p=arguments.length,f=new Array(p),g=0;g<p;g++)f[g]=arguments[g];return i&&i[0]===f[0]&&!r.context?(o.logger.warn(`It seems you are nesting recursively key: ${f[0]} in key: ${n[0]}`),null):o.translate(...f,n)},r)),r.interpolation&&this.interpolator.reset()}const s=r.postProcess||this.options.postProcess,l=typeof s=="string"?[s]:s;return e!=null&&l&&l.length&&r.applyPostProcessor!==!1&&(e=E5.handle(l,e,n,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...a,usedParams:this.getUsedParamsDetails(r)},...r}:r,this)),e}resolve(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r,a,i,o,s;return typeof e=="string"&&(e=[e]),e.forEach(l=>{if(this.isValidLookup(r))return;const u=this.extractFromKey(l,n),c=u.key;a=c;let d=u.namespaces;this.options.fallbackNS&&(d=d.concat(this.options.fallbackNS));const p=n.count!==void 0&&typeof n.count!="string",f=p&&!n.ordinal&&n.count===0&&this.pluralResolver.shouldUseIntlApi(),g=n.context!==void 0&&(typeof n.context=="string"||typeof n.context=="number")&&n.context!=="",y=n.lngs?n.lngs:this.languageUtils.toResolveHierarchy(n.lng||this.language,n.fallbackLng);d.forEach(x=>{this.isValidLookup(r)||(s=x,!_5[`${y[0]}-${x}`]&&this.utils&&this.utils.hasLoadedNamespace&&!this.utils.hasLoadedNamespace(s)&&(_5[`${y[0]}-${x}`]=!0,this.logger.warn(`key "${a}" for languages "${y.join(", ")}" won't get resolved as namespace "${s}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),y.forEach(b=>{if(this.isValidLookup(r))return;o=b;const v=[c];if(this.i18nFormat&&this.i18nFormat.addLookupKeys)this.i18nFormat.addLookupKeys(v,c,b,x,n);else{let S;p&&(S=this.pluralResolver.getSuffix(b,n.count,n));const C=`${this.options.pluralSeparator}zero`,I=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(p&&(v.push(c+S),n.ordinal&&S.indexOf(I)===0&&v.push(c+S.replace(I,this.options.pluralSeparator)),f&&v.push(c+C)),g){const _=`${c}${this.options.contextSeparator}${n.context}`;v.push(_),p&&(v.push(_+S),n.ordinal&&S.indexOf(I)===0&&v.push(_+S.replace(I,this.options.pluralSeparator)),f&&v.push(_+C))}}let w;for(;w=v.pop();)this.isValidLookup(r)||(i=w,r=this.getResource(b,x,w,n))}))})}),{res:r,usedKey:a,exactUsedKey:i,usedLng:o,usedNS:s}}isValidLookup(e){return e!==void 0&&!(!this.options.returnNull&&e===null)&&!(!this.options.returnEmptyString&&e==="")}getResource(e,n,r){let a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return this.i18nFormat&&this.i18nFormat.getResource?this.i18nFormat.getResource(e,n,r,a):this.resourceStore.getResource(e,n,r,a)}getUsedParamsDetails(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],r=e.replace&&typeof e.replace!="string";let a=r?e.replace:e;if(r&&typeof e.count<"u"&&(a.count=e.count),this.options.interpolation.defaultVariables&&(a={...this.options.interpolation.defaultVariables,...a}),!r){a={...a};for(const i of n)delete a[i]}return a}static hasDefaultValue(e){const n="defaultValue";for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&n===r.substring(0,n.length)&&e[r]!==void 0)return!0;return!1}}function ok(t){return t.charAt(0).toUpperCase()+t.slice(1)}class O5{constructor(e){this.options=e,this.supportedLngs=this.options.supportedLngs||!1,this.logger=ko.create("languageUtils")}getScriptPartFromCode(e){if(e=N0(e),!e||e.indexOf("-")<0)return null;const n=e.split("-");return n.length===2||(n.pop(),n[n.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(n.join("-"))}getLanguagePartFromCode(e){if(e=N0(e),!e||e.indexOf("-")<0)return e;const n=e.split("-");return this.formatLanguageCode(n[0])}formatLanguageCode(e){if(typeof e=="string"&&e.indexOf("-")>-1){const n=["hans","hant","latn","cyrl","cans","mong","arab"];let r=e.split("-");return this.options.lowerCaseLng?r=r.map(a=>a.toLowerCase()):r.length===2?(r[0]=r[0].toLowerCase(),r[1]=r[1].toUpperCase(),n.indexOf(r[1].toLowerCase())>-1&&(r[1]=ok(r[1].toLowerCase()))):r.length===3&&(r[0]=r[0].toLowerCase(),r[1].length===2&&(r[1]=r[1].toUpperCase()),r[0]!=="sgn"&&r[2].length===2&&(r[2]=r[2].toUpperCase()),n.indexOf(r[1].toLowerCase())>-1&&(r[1]=ok(r[1].toLowerCase())),n.indexOf(r[2].toLowerCase())>-1&&(r[2]=ok(r[2].toLowerCase()))),r.join("-")}return this.options.cleanCode||this.options.lowerCaseLng?e.toLowerCase():e}isSupportedCode(e){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(e=this.getLanguagePartFromCode(e)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(e)>-1}getBestMatchFromCodes(e){if(!e)return null;let n;return e.forEach(r=>{if(n)return;const a=this.formatLanguageCode(r);(!this.options.supportedLngs||this.isSupportedCode(a))&&(n=a)}),!n&&this.options.supportedLngs&&e.forEach(r=>{if(n)return;const a=this.getLanguagePartFromCode(r);if(this.isSupportedCode(a))return n=a;n=this.options.supportedLngs.find(i=>{if(i===a||!(i.indexOf("-")<0&&a.indexOf("-")<0)&&i.indexOf(a)===0)return i})}),n||(n=this.getFallbackCodes(this.options.fallbackLng)[0]),n}getFallbackCodes(e,n){if(!e)return[];if(typeof e=="function"&&(e=e(n)),typeof e=="string"&&(e=[e]),Object.prototype.toString.apply(e)==="[object Array]")return e;if(!n)return e.default||[];let r=e[n];return r||(r=e[this.getScriptPartFromCode(n)]),r||(r=e[this.formatLanguageCode(n)]),r||(r=e[this.getLanguagePartFromCode(n)]),r||(r=e.default),r||[]}toResolveHierarchy(e,n){const r=this.getFallbackCodes(n||this.options.fallbackLng||[],e),a=[],i=o=>{o&&(this.isSupportedCode(o)?a.push(o):this.logger.warn(`rejecting language code not found in supportedLngs: ${o}`))};return typeof e=="string"&&(e.indexOf("-")>-1||e.indexOf("_")>-1)?(this.options.load!=="languageOnly"&&i(this.formatLanguageCode(e)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&i(this.getScriptPartFromCode(e)),this.options.load!=="currentOnly"&&i(this.getLanguagePartFromCode(e))):typeof e=="string"&&i(this.formatLanguageCode(e)),r.forEach(o=>{a.indexOf(o)<0&&i(this.formatLanguageCode(o))}),a}}let pW=[{lngs:["ach","ak","am","arn","br","fil","gun","ln","mfe","mg","mi","oc","pt","pt-BR","tg","tl","ti","tr","uz","wa"],nr:[1,2],fc:1},{lngs:["af","an","ast","az","bg","bn","ca","da","de","dev","el","en","eo","es","et","eu","fi","fo","fur","fy","gl","gu","ha","hi","hu","hy","ia","it","kk","kn","ku","lb","mai","ml","mn","mr","nah","nap","nb","ne","nl","nn","no","nso","pa","pap","pms","ps","pt-PT","rm","sco","se","si","so","son","sq","sv","sw","ta","te","tk","ur","yo"],nr:[1,2],fc:2},{lngs:["ay","bo","cgg","fa","ht","id","ja","jbo","ka","km","ko","ky","lo","ms","sah","su","th","tt","ug","vi","wo","zh"],nr:[1],fc:3},{lngs:["be","bs","cnr","dz","hr","ru","sr","uk"],nr:[1,2,5],fc:4},{lngs:["ar"],nr:[0,1,2,3,11,100],fc:5},{lngs:["cs","sk"],nr:[1,2,5],fc:6},{lngs:["csb","pl"],nr:[1,2,5],fc:7},{lngs:["cy"],nr:[1,2,3,8],fc:8},{lngs:["fr"],nr:[1,2],fc:9},{lngs:["ga"],nr:[1,2,3,7,11],fc:10},{lngs:["gd"],nr:[1,2,3,20],fc:11},{lngs:["is"],nr:[1,2],fc:12},{lngs:["jv"],nr:[0,1],fc:13},{lngs:["kw"],nr:[1,2,3,4],fc:14},{lngs:["lt"],nr:[1,2,10],fc:15},{lngs:["lv"],nr:[1,2,0],fc:16},{lngs:["mk"],nr:[1,2],fc:17},{lngs:["mnk"],nr:[0,1,2],fc:18},{lngs:["mt"],nr:[1,2,11,20],fc:19},{lngs:["or"],nr:[2,1],fc:2},{lngs:["ro"],nr:[1,2,20],fc:20},{lngs:["sl"],nr:[5,1,2,3],fc:21},{lngs:["he","iw"],nr:[1,2,20,21],fc:22}],hW={1:function(t){return+(t>1)},2:function(t){return+(t!=1)},3:function(t){return 0},4:function(t){return t%10==1&&t%100!=11?0:t%10>=2&&t%10<=4&&(t%100<10||t%100>=20)?1:2},5:function(t){return t==0?0:t==1?1:t==2?2:t%100>=3&&t%100<=10?3:t%100>=11?4:5},6:function(t){return t==1?0:t>=2&&t<=4?1:2},7:function(t){return t==1?0:t%10>=2&&t%10<=4&&(t%100<10||t%100>=20)?1:2},8:function(t){return t==1?0:t==2?1:t!=8&&t!=11?2:3},9:function(t){return+(t>=2)},10:function(t){return t==1?0:t==2?1:t<7?2:t<11?3:4},11:function(t){return t==1||t==11?0:t==2||t==12?1:t>2&&t<20?2:3},12:function(t){return+(t%10!=1||t%100==11)},13:function(t){return+(t!==0)},14:function(t){return t==1?0:t==2?1:t==3?2:3},15:function(t){return t%10==1&&t%100!=11?0:t%10>=2&&(t%100<10||t%100>=20)?1:2},16:function(t){return t%10==1&&t%100!=11?0:t!==0?1:2},17:function(t){return t==1||t%10==1&&t%100!=11?0:1},18:function(t){return t==0?0:t==1?1:2},19:function(t){return t==1?0:t==0||t%100>1&&t%100<11?1:t%100>10&&t%100<20?2:3},20:function(t){return t==1?0:t==0||t%100>0&&t%100<20?1:2},21:function(t){return t%100==1?1:t%100==2?2:t%100==3||t%100==4?3:0},22:function(t){return t==1?0:t==2?1:(t<0||t>10)&&t%10==0?2:3}};const fW=["v1","v2","v3"],mW=["v4"],$5={zero:0,one:1,two:2,few:3,many:4,other:5};function gW(){const t={};return pW.forEach(e=>{e.lngs.forEach(n=>{t[n]={numbers:e.nr,plurals:hW[e.fc]}})}),t}class yW{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.languageUtils=e,this.options=n,this.logger=ko.create("pluralResolver"),(!this.options.compatibilityJSON||mW.includes(this.options.compatibilityJSON))&&(typeof Intl>"u"||!Intl.PluralRules)&&(this.options.compatibilityJSON="v3",this.logger.error("Your environment seems not to be Intl API compatible, use an Intl.PluralRules polyfill. Will fallback to the compatibilityJSON v3 format handling.")),this.rules=gW()}addRule(e,n){this.rules[e]=n}getRule(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.shouldUseIntlApi())try{return new Intl.PluralRules(N0(e==="dev"?"en":e),{type:n.ordinal?"ordinal":"cardinal"})}catch{return}return this.rules[e]||this.rules[this.languageUtils.getLanguagePartFromCode(e)]}needsPlural(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=this.getRule(e,n);return this.shouldUseIntlApi()?r&&r.resolvedOptions().pluralCategories.length>1:r&&r.numbers.length>1}getPluralFormsOfKey(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.getSuffixes(e,r).map(a=>`${n}${a}`)}getSuffixes(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=this.getRule(e,n);return r?this.shouldUseIntlApi()?r.resolvedOptions().pluralCategories.sort((a,i)=>$5[a]-$5[i]).map(a=>`${this.options.prepend}${n.ordinal?`ordinal${this.options.prepend}`:""}${a}`):r.numbers.map(a=>this.getSuffix(e,a,n)):[]}getSuffix(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const a=this.getRule(e,r);return a?this.shouldUseIntlApi()?`${this.options.prepend}${r.ordinal?`ordinal${this.options.prepend}`:""}${a.select(n)}`:this.getSuffixRetroCompatible(a,n):(this.logger.warn(`no plural rule found for: ${e}`),"")}getSuffixRetroCompatible(e,n){const r=e.noAbs?e.plurals(n):e.plurals(Math.abs(n));let a=e.numbers[r];this.options.simplifyPluralSuffix&&e.numbers.length===2&&e.numbers[0]===1&&(a===2?a="plural":a===1&&(a=""));const i=()=>this.options.prepend&&a.toString()?this.options.prepend+a.toString():a.toString();return this.options.compatibilityJSON==="v1"?a===1?"":typeof a=="number"?`_plural_${a.toString()}`:i():this.options.compatibilityJSON==="v2"||this.options.simplifyPluralSuffix&&e.numbers.length===2&&e.numbers[0]===1?i():this.options.prepend&&r.toString()?this.options.prepend+r.toString():r.toString()}shouldUseIntlApi(){return!fW.includes(this.options.compatibilityJSON)}}function R5(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:".",a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,i=iW(t,e,n);return!i&&a&&typeof n=="string"&&(i=ik(t,n,r),i===void 0&&(i=ik(e,n,r))),i}class bW{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.logger=ko.create("interpolator"),this.options=e,this.format=e.interpolation&&e.interpolation.format||(n=>n),this.init(e)}init(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.interpolation||(e.interpolation={escapeValue:!0});const n=e.interpolation;this.escape=n.escape!==void 0?n.escape:sW,this.escapeValue=n.escapeValue!==void 0?n.escapeValue:!0,this.useRawValueToEscape=n.useRawValueToEscape!==void 0?n.useRawValueToEscape:!1,this.prefix=n.prefix?Vc(n.prefix):n.prefixEscaped||"{{",this.suffix=n.suffix?Vc(n.suffix):n.suffixEscaped||"}}",this.formatSeparator=n.formatSeparator?n.formatSeparator:n.formatSeparator||",",this.unescapePrefix=n.unescapeSuffix?"":n.unescapePrefix||"-",this.unescapeSuffix=this.unescapePrefix?"":n.unescapeSuffix||"",this.nestingPrefix=n.nestingPrefix?Vc(n.nestingPrefix):n.nestingPrefixEscaped||Vc("$t("),this.nestingSuffix=n.nestingSuffix?Vc(n.nestingSuffix):n.nestingSuffixEscaped||Vc(")"),this.nestingOptionsSeparator=n.nestingOptionsSeparator?n.nestingOptionsSeparator:n.nestingOptionsSeparator||",",this.maxReplaces=n.maxReplaces?n.maxReplaces:1e3,this.alwaysFormat=n.alwaysFormat!==void 0?n.alwaysFormat:!1,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const e=(n,r)=>n&&n.source===r?(n.lastIndex=0,n):new RegExp(r,"g");this.regexp=e(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=e(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=e(this.nestingRegexp,`${this.nestingPrefix}(.+?)${this.nestingSuffix}`)}interpolate(e,n,r,a){let i,o,s;const l=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{};function u(f){return f.replace(/\$/g,"$$$$")}const c=f=>{if(f.indexOf(this.formatSeparator)<0){const b=R5(n,l,f,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(b,void 0,r,{...a,...n,interpolationkey:f}):b}const g=f.split(this.formatSeparator),y=g.shift().trim(),x=g.join(this.formatSeparator).trim();return this.format(R5(n,l,y,this.options.keySeparator,this.options.ignoreJSONStructure),x,r,{...a,...n,interpolationkey:y})};this.resetRegExp();const d=a&&a.missingInterpolationHandler||this.options.missingInterpolationHandler,p=a&&a.interpolation&&a.interpolation.skipOnVariables!==void 0?a.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:f=>u(f)},{regex:this.regexp,safeValue:f=>this.escapeValue?u(this.escape(f)):u(f)}].forEach(f=>{for(s=0;i=f.regex.exec(e);){const g=i[1].trim();if(o=c(g),o===void 0)if(typeof d=="function"){const x=d(e,i,a);o=typeof x=="string"?x:""}else if(a&&Object.prototype.hasOwnProperty.call(a,g))o="";else if(p){o=i[0];continue}else this.logger.warn(`missed to pass in variable ${g} for interpolating ${e}`),o="";else typeof o!="string"&&!this.useRawValueToEscape&&(o=C5(o));const y=f.safeValue(o);if(e=e.replace(i[0],y),p?(f.regex.lastIndex+=o.length,f.regex.lastIndex-=i[0].length):f.regex.lastIndex=0,s++,s>=this.maxReplaces)break}}),e}nest(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a,i,o;function s(l,u){const c=this.nestingOptionsSeparator;if(l.indexOf(c)<0)return l;const d=l.split(new RegExp(`${c}[ ]*{`));let p=`{${d[1]}`;l=d[0],p=this.interpolate(p,o);const f=p.match(/'/g),g=p.match(/"/g);(f&&f.length%2===0&&!g||g.length%2!==0)&&(p=p.replace(/'/g,'"'));try{o=JSON.parse(p),u&&(o={...u,...o})}catch(y){return this.logger.warn(`failed parsing options string in nesting for key ${l}`,y),`${l}${c}${p}`}return delete o.defaultValue,l}for(;a=this.nestingRegexp.exec(e);){let l=[];o={...r},o=o.replace&&typeof o.replace!="string"?o.replace:o,o.applyPostProcessor=!1,delete o.defaultValue;let u=!1;if(a[0].indexOf(this.formatSeparator)!==-1&&!/{.*}/.test(a[1])){const c=a[1].split(this.formatSeparator).map(d=>d.trim());a[1]=c.shift(),l=c,u=!0}if(i=n(s.call(this,a[1].trim(),o),o),i&&a[0]===e&&typeof i!="string")return i;typeof i!="string"&&(i=C5(i)),i||(this.logger.warn(`missed to resolve ${a[1]} for nesting ${e}`),i=""),u&&(i=l.reduce((c,d)=>this.format(c,d,r.lng,{...r,interpolationkey:a[1].trim()}),i.trim())),e=e.replace(a[0],i),this.regexp.lastIndex=0}return e}}function vW(t){let e=t.toLowerCase().trim();const n={};if(t.indexOf("(")>-1){const r=t.split("(");e=r[0].toLowerCase().trim();const a=r[1].substring(0,r[1].length-1);e==="currency"&&a.indexOf(":")<0?n.currency||(n.currency=a.trim()):e==="relativetime"&&a.indexOf(":")<0?n.range||(n.range=a.trim()):a.split(";").forEach(i=>{if(!i)return;const[o,...s]=i.split(":"),l=s.join(":").trim().replace(/^'+|'+$/g,"");n[o.trim()]||(n[o.trim()]=l),l==="false"&&(n[o.trim()]=!1),l==="true"&&(n[o.trim()]=!0),isNaN(l)||(n[o.trim()]=parseInt(l,10))})}return{formatName:e,formatOptions:n}}function Wc(t){const e={};return function(n,r,a){const i=r+JSON.stringify(a);let o=e[i];return o||(o=t(N0(r),a),e[i]=o),o(n)}}class xW{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.logger=ko.create("formatter"),this.options=e,this.formats={number:Wc((n,r)=>{const a=new Intl.NumberFormat(n,{...r});return i=>a.format(i)}),currency:Wc((n,r)=>{const a=new Intl.NumberFormat(n,{...r,style:"currency"});return i=>a.format(i)}),datetime:Wc((n,r)=>{const a=new Intl.DateTimeFormat(n,{...r});return i=>a.format(i)}),relativetime:Wc((n,r)=>{const a=new Intl.RelativeTimeFormat(n,{...r});return i=>a.format(i,r.range||"day")}),list:Wc((n,r)=>{const a=new Intl.ListFormat(n,{...r});return i=>a.format(i)})},this.init(e)}init(e){const n=(arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}}).interpolation;this.formatSeparator=n.formatSeparator?n.formatSeparator:n.formatSeparator||","}add(e,n){this.formats[e.toLowerCase().trim()]=n}addCached(e,n){this.formats[e.toLowerCase().trim()]=Wc(n)}format(e,n,r){let a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return n.split(this.formatSeparator).reduce((i,o)=>{const{formatName:s,formatOptions:l}=vW(o);if(this.formats[s]){let u=i;try{const c=a&&a.formatParams&&a.formatParams[a.interpolationkey]||{},d=c.locale||c.lng||a.locale||a.lng||r;u=this.formats[s](i,d,{...l,...a,...c})}catch(c){this.logger.warn(c)}return u}else this.logger.warn(`there was no format function for ${s}`);return i},e)}}function wW(t,e){t.pending[e]!==void 0&&(delete t.pending[e],t.pendingCount--)}class kW extends S0{constructor(e,n,r){let a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};super(),this.backend=e,this.store=n,this.services=r,this.languageUtils=r.languageUtils,this.options=a,this.logger=ko.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=a.maxParallelReads||10,this.readingCalls=0,this.maxRetries=a.maxRetries>=0?a.maxRetries:5,this.retryTimeout=a.retryTimeout>=1?a.retryTimeout:350,this.state={},this.queue=[],this.backend&&this.backend.init&&this.backend.init(r,a.backend,a)}queueLoad(e,n,r,a){const i={},o={},s={},l={};return e.forEach(u=>{let c=!0;n.forEach(d=>{const p=`${u}|${d}`;!r.reload&&this.store.hasResourceBundle(u,d)?this.state[p]=2:this.state[p]<0||(this.state[p]===1?o[p]===void 0&&(o[p]=!0):(this.state[p]=1,c=!1,o[p]===void 0&&(o[p]=!0),i[p]===void 0&&(i[p]=!0),l[d]===void 0&&(l[d]=!0)))}),c||(s[u]=!0)}),(Object.keys(i).length||Object.keys(o).length)&&this.queue.push({pending:o,pendingCount:Object.keys(o).length,loaded:{},errors:[],callback:a}),{toLoad:Object.keys(i),pending:Object.keys(o),toLoadLanguages:Object.keys(s),toLoadNamespaces:Object.keys(l)}}loaded(e,n,r){const a=e.split("|"),i=a[0],o=a[1];n&&this.emit("failedLoading",i,o,n),r&&this.store.addResourceBundle(i,o,r),this.state[e]=n?-1:2;const s={};this.queue.forEach(l=>{aW(l.loaded,[i],o),wW(l,e),n&&l.errors.push(n),l.pendingCount===0&&!l.done&&(Object.keys(l.loaded).forEach(u=>{s[u]||(s[u]={});const c=l.loaded[u];c.length&&c.forEach(d=>{s[u][d]===void 0&&(s[u][d]=!0)})}),l.done=!0,l.errors.length?l.callback(l.errors):l.callback())}),this.emit("loaded",s),this.queue=this.queue.filter(l=>!l.done)}read(e,n,r){let a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:this.retryTimeout,o=arguments.length>5?arguments[5]:void 0;if(!e.length)return o(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:e,ns:n,fcName:r,tried:a,wait:i,callback:o});return}this.readingCalls++;const s=(u,c)=>{if(this.readingCalls--,this.waitingReads.length>0){const d=this.waitingReads.shift();this.read(d.lng,d.ns,d.fcName,d.tried,d.wait,d.callback)}if(u&&c&&a<this.maxRetries){setTimeout(()=>{this.read.call(this,e,n,r,a+1,i*2,o)},i);return}o(u,c)},l=this.backend[r].bind(this.backend);if(l.length===2){try{const u=l(e,n);u&&typeof u.then=="function"?u.then(c=>s(null,c)).catch(s):s(null,u)}catch(u){s(u)}return}return l(e,n,s)}prepareLoading(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),a&&a();typeof e=="string"&&(e=this.languageUtils.toResolveHierarchy(e)),typeof n=="string"&&(n=[n]);const i=this.queueLoad(e,n,r,a);if(!i.toLoad.length)return i.pending.length||a(),null;i.toLoad.forEach(o=>{this.loadOne(o)})}load(e,n,r){this.prepareLoading(e,n,{},r)}reload(e,n,r){this.prepareLoading(e,n,{reload:!0},r)}loadOne(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const r=e.split("|"),a=r[0],i=r[1];this.read(a,i,"read",void 0,void 0,(o,s)=>{o&&this.logger.warn(`${n}loading namespace ${i} for language ${a} failed`,o),!o&&s&&this.logger.log(`${n}loaded namespace ${i} for language ${a}`,s),this.loaded(e,o,s)})}saveMissing(e,n,r,a,i){let o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{},s=arguments.length>6&&arguments[6]!==void 0?arguments[6]:()=>{};if(this.services.utils&&this.services.utils.hasLoadedNamespace&&!this.services.utils.hasLoadedNamespace(n)){this.logger.warn(`did not save key "${r}" as the namespace "${n}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(!(r==null||r==="")){if(this.backend&&this.backend.create){const l={...o,isUpdate:i},u=this.backend.create.bind(this.backend);if(u.length<6)try{let c;u.length===5?c=u(e,n,r,a,l):c=u(e,n,r,a),c&&typeof c.then=="function"?c.then(d=>s(null,d)).catch(s):s(null,c)}catch(c){s(c)}else u(e,n,r,a,s,l)}!e||!e[0]||this.store.addResource(e[0],n,r,a)}}}function M5(){return{debug:!1,initImmediate:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:function(t){let e={};if(typeof t[1]=="object"&&(e=t[1]),typeof t[1]=="string"&&(e.defaultValue=t[1]),typeof t[2]=="string"&&(e.tDescription=t[2]),typeof t[2]=="object"||typeof t[3]=="object"){const n=t[3]||t[2];Object.keys(n).forEach(r=>{e[r]=n[r]})}return e},interpolation:{escapeValue:!0,format:t=>t,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0}}}function A5(t){return typeof t.ns=="string"&&(t.ns=[t.ns]),typeof t.fallbackLng=="string"&&(t.fallbackLng=[t.fallbackLng]),typeof t.fallbackNS=="string"&&(t.fallbackNS=[t.fallbackNS]),t.supportedLngs&&t.supportedLngs.indexOf("cimode")<0&&(t.supportedLngs=t.supportedLngs.concat(["cimode"])),t}function T0(){}function SW(t){Object.getOwnPropertyNames(Object.getPrototypeOf(t)).forEach(e=>{typeof t[e]=="function"&&(t[e]=t[e].bind(t))})}class Tg extends S0{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;if(super(),this.options=A5(e),this.services={},this.logger=ko,this.modules={external:[]},SW(this),n&&!this.isInitialized&&!e.isClone){if(!this.options.initImmediate)return this.init(e,n),this;setTimeout(()=>{this.init(e,n)},0)}}init(){var e=this;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0;typeof n=="function"&&(r=n,n={}),!n.defaultNS&&n.defaultNS!==!1&&n.ns&&(typeof n.ns=="string"?n.defaultNS=n.ns:n.ns.indexOf("translation")<0&&(n.defaultNS=n.ns[0]));const a=M5();this.options={...a,...this.options,...A5(n)},this.options.compatibilityAPI!=="v1"&&(this.options.interpolation={...a.interpolation,...this.options.interpolation}),n.keySeparator!==void 0&&(this.options.userDefinedKeySeparator=n.keySeparator),n.nsSeparator!==void 0&&(this.options.userDefinedNsSeparator=n.nsSeparator);function i(l){return l?typeof l=="function"?new l:l:null}if(!this.options.isClone){this.modules.logger?ko.init(i(this.modules.logger),this.options):ko.init(null,this.options);let l;this.modules.formatter?l=this.modules.formatter:typeof Intl<"u"&&(l=xW);const u=new O5(this.options);this.store=new I5(this.options.resources,this.options);const c=this.services;c.logger=ko,c.resourceStore=this.store,c.languageUtils=u,c.pluralResolver=new yW(u,{prepend:this.options.pluralSeparator,compatibilityJSON:this.options.compatibilityJSON,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),l&&(!this.options.interpolation.format||this.options.interpolation.format===a.interpolation.format)&&(c.formatter=i(l),c.formatter.init(c,this.options),this.options.interpolation.format=c.formatter.format.bind(c.formatter)),c.interpolator=new bW(this.options),c.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},c.backendConnector=new kW(i(this.modules.backend),c.resourceStore,c,this.options),c.backendConnector.on("*",function(d){for(var p=arguments.length,f=new Array(p>1?p-1:0),g=1;g<p;g++)f[g-1]=arguments[g];e.emit(d,...f)}),this.modules.languageDetector&&(c.languageDetector=i(this.modules.languageDetector),c.languageDetector.init&&c.languageDetector.init(c,this.options.detection,this.options)),this.modules.i18nFormat&&(c.i18nFormat=i(this.modules.i18nFormat),c.i18nFormat.init&&c.i18nFormat.init(this)),this.translator=new W2(this.services,this.options),this.translator.on("*",function(d){for(var p=arguments.length,f=new Array(p>1?p-1:0),g=1;g<p;g++)f[g-1]=arguments[g];e.emit(d,...f)}),this.modules.external.forEach(d=>{d.init&&d.init(this)})}if(this.format=this.options.interpolation.format,r||(r=T0),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const l=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);l.length>0&&l[0]!=="dev"&&(this.options.lng=l[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(l=>{this[l]=function(){return e.store[l](...arguments)}}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(l=>{this[l]=function(){return e.store[l](...arguments),e}});const o=rh(),s=()=>{const l=(u,c)=>{this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),o.resolve(c),r(u,c)};if(this.languages&&this.options.compatibilityAPI!=="v1"&&!this.isInitialized)return l(null,this.t.bind(this));this.changeLanguage(this.options.lng,l)};return this.options.resources||!this.options.initImmediate?s():setTimeout(s,0),o}loadResources(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:T0;const r=typeof e=="string"?e:this.language;if(typeof e=="function"&&(n=e),!this.options.resources||this.options.partialBundledLanguages){if(r&&r.toLowerCase()==="cimode"&&(!this.options.preload||this.options.preload.length===0))return n();const a=[],i=o=>{!o||o==="cimode"||this.services.languageUtils.toResolveHierarchy(o).forEach(s=>{s!=="cimode"&&a.indexOf(s)<0&&a.push(s)})};r?i(r):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(o=>i(o)),this.options.preload&&this.options.preload.forEach(o=>i(o)),this.services.backendConnector.load(a,this.options.ns,o=>{!o&&!this.resolvedLanguage&&this.language&&this.setResolvedLanguage(this.language),n(o)})}else n(null)}reloadResources(e,n,r){const a=rh();return e||(e=this.languages),n||(n=this.options.ns),r||(r=T0),this.services.backendConnector.reload(e,n,i=>{a.resolve(),r(i)}),a}use(e){if(!e)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!e.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return e.type==="backend"&&(this.modules.backend=e),(e.type==="logger"||e.log&&e.warn&&e.error)&&(this.modules.logger=e),e.type==="languageDetector"&&(this.modules.languageDetector=e),e.type==="i18nFormat"&&(this.modules.i18nFormat=e),e.type==="postProcessor"&&E5.addPostProcessor(e),e.type==="formatter"&&(this.modules.formatter=e),e.type==="3rdParty"&&this.modules.external.push(e),this}setResolvedLanguage(e){if(!(!e||!this.languages)&&!(["cimode","dev"].indexOf(e)>-1))for(let n=0;n<this.languages.length;n++){const r=this.languages[n];if(!(["cimode","dev"].indexOf(r)>-1)&&this.store.hasLanguageSomeTranslations(r)){this.resolvedLanguage=r;break}}}changeLanguage(e,n){var r=this;this.isLanguageChangingTo=e;const a=rh();this.emit("languageChanging",e);const i=l=>{this.language=l,this.languages=this.services.languageUtils.toResolveHierarchy(l),this.resolvedLanguage=void 0,this.setResolvedLanguage(l)},o=(l,u)=>{u?(i(u),this.translator.changeLanguage(u),this.isLanguageChangingTo=void 0,this.emit("languageChanged",u),this.logger.log("languageChanged",u)):this.isLanguageChangingTo=void 0,a.resolve(function(){return r.t(...arguments)}),n&&n(l,function(){return r.t(...arguments)})},s=l=>{!e&&!l&&this.services.languageDetector&&(l=[]);const u=typeof l=="string"?l:this.services.languageUtils.getBestMatchFromCodes(l);u&&(this.language||i(u),this.translator.language||this.translator.changeLanguage(u),this.services.languageDetector&&this.services.languageDetector.cacheUserLanguage&&this.services.languageDetector.cacheUserLanguage(u)),this.loadResources(u,c=>{o(c,u)})};return!e&&this.services.languageDetector&&!this.services.languageDetector.async?s(this.services.languageDetector.detect()):!e&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect.length===0?this.services.languageDetector.detect().then(s):this.services.languageDetector.detect(s):s(e),a}getFixedT(e,n,r){var a=this;const i=function(o,s){let l;if(typeof s!="object"){for(var u=arguments.length,c=new Array(u>2?u-2:0),d=2;d<u;d++)c[d-2]=arguments[d];l=a.options.overloadTranslationOptionHandler([o,s].concat(c))}else l={...s};l.lng=l.lng||i.lng,l.lngs=l.lngs||i.lngs,l.ns=l.ns||i.ns,l.keyPrefix=l.keyPrefix||r||i.keyPrefix;const p=a.options.keySeparator||".";let f;return l.keyPrefix&&Array.isArray(o)?f=o.map(g=>`${l.keyPrefix}${p}${g}`):f=l.keyPrefix?`${l.keyPrefix}${p}${o}`:o,a.t(f,l)};return typeof e=="string"?i.lng=e:i.lngs=e,i.ns=n,i.keyPrefix=r,i}t(){return this.translator&&this.translator.translate(...arguments)}exists(){return this.translator&&this.translator.exists(...arguments)}setDefaultNamespace(e){this.options.defaultNS=e}hasLoadedNamespace(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const r=n.lng||this.resolvedLanguage||this.languages[0],a=this.options?this.options.fallbackLng:!1,i=this.languages[this.languages.length-1];if(r.toLowerCase()==="cimode")return!0;const o=(s,l)=>{const u=this.services.backendConnector.state[`${s}|${l}`];return u===-1||u===2};if(n.precheck){const s=n.precheck(this,o);if(s!==void 0)return s}return!!(this.hasResourceBundle(r,e)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||o(r,e)&&(!a||o(i,e)))}loadNamespaces(e,n){const r=rh();return this.options.ns?(typeof e=="string"&&(e=[e]),e.forEach(a=>{this.options.ns.indexOf(a)<0&&this.options.ns.push(a)}),this.loadResources(a=>{r.resolve(),n&&n(a)}),r):(n&&n(),Promise.resolve())}loadLanguages(e,n){const r=rh();typeof e=="string"&&(e=[e]);const a=this.options.preload||[],i=e.filter(o=>a.indexOf(o)<0);return i.length?(this.options.preload=a.concat(i),this.loadResources(o=>{r.resolve(),n&&n(o)}),r):(n&&n(),Promise.resolve())}dir(e){if(e||(e=this.resolvedLanguage||(this.languages&&this.languages.length>0?this.languages[0]:this.language)),!e)return"rtl";const n=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"],r=this.services&&this.services.languageUtils||new O5(M5());return n.indexOf(r.getLanguagePartFromCode(e))>-1||e.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;return new Tg(e,n)}cloneInstance(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:T0;const r=e.forkResourceStore;r&&delete e.forkResourceStore;const a={...this.options,...e,isClone:!0},i=new Tg(a);return(e.debug!==void 0||e.prefix!==void 0)&&(i.logger=i.logger.clone(e)),["store","services","language"].forEach(o=>{i[o]=this[o]}),i.services={...this.services},i.services.utils={hasLoadedNamespace:i.hasLoadedNamespace.bind(i)},r&&(i.store=new I5(this.store.data,a),i.services.resourceStore=i.store),i.translator=new W2(i.services,a),i.translator.on("*",function(o){for(var s=arguments.length,l=new Array(s>1?s-1:0),u=1;u<s;u++)l[u-1]=arguments[u];i.emit(o,...l)}),i.init(a,n),i.translator.options=a,i.translator.backendConnector.services.utils={hasLoadedNamespace:i.hasLoadedNamespace.bind(i)},i}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const Pr=Tg.createInstance();Pr.createInstance=Tg.createInstance,Pr.createInstance,Pr.dir,Pr.init,Pr.loadResources,Pr.reloadResources,Pr.use,Pr.changeLanguage,Pr.getFixedT,Pr.t,Pr.exists,Pr.setDefaultNamespace,Pr.hasLoadedNamespace,Pr.loadNamespaces,Pr.loadLanguages;const P5=P.createContext({dragDropManager:void 0});function ih(t){"@babel/helpers - typeof";return ih=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ih(t)}function CW(t,e){if(ih(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(ih(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function NW(t){var e=CW(t,"string");return ih(e)=="symbol"?e:String(e)}function TW(t,e,n){return e=NW(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function D5(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,r)}return n}function L5(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?D5(Object(n),!0).forEach(function(r){TW(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):D5(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Jr(t){return"Minified Redux error #"+t+"; visit https://redux.js.org/Errors?code="+t+" for the full message or use the non-minified dev environment for full errors. "}var F5=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}(),sk=function(){return Math.random().toString(36).substring(7).split("").join(".")},I0={INIT:"@@redux/INIT"+sk(),REPLACE:"@@redux/REPLACE"+sk(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+sk()}};function IW(t){if(typeof t!="object"||t===null)return!1;for(var e=t;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e}function lk(t,e,n){var r;if(typeof e=="function"&&typeof n=="function"||typeof n=="function"&&typeof arguments[3]=="function")throw new Error(Jr(0));if(typeof e=="function"&&typeof n>"u"&&(n=e,e=void 0),typeof n<"u"){if(typeof n!="function")throw new Error(Jr(1));return n(lk)(t,e)}if(typeof t!="function")throw new Error(Jr(2));var a=t,i=e,o=[],s=o,l=!1;function u(){s===o&&(s=o.slice())}function c(){if(l)throw new Error(Jr(3));return i}function d(y){if(typeof y!="function")throw new Error(Jr(4));if(l)throw new Error(Jr(5));var x=!0;return u(),s.push(y),function(){if(x){if(l)throw new Error(Jr(6));x=!1,u();var b=s.indexOf(y);s.splice(b,1),o=null}}}function p(y){if(!IW(y))throw new Error(Jr(7));if(typeof y.type>"u")throw new Error(Jr(8));if(l)throw new Error(Jr(9));try{l=!0,i=a(i,y)}finally{l=!1}for(var x=o=s,b=0;b<x.length;b++){var v=x[b];v()}return y}function f(y){if(typeof y!="function")throw new Error(Jr(10));a=y,p({type:I0.REPLACE})}function g(){var y,x=d;return y={subscribe:function(b){if(typeof b!="object"||b===null)throw new Error(Jr(11));function v(){b.next&&b.next(c())}v();var w=x(v);return{unsubscribe:w}}},y[F5]=function(){return this},y}return p({type:I0.INIT}),r={dispatch:p,subscribe:d,getState:c,replaceReducer:f},r[F5]=g,r}function EW(t){Object.keys(t).forEach(function(e){var n=t[e],r=n(void 0,{type:I0.INIT});if(typeof r>"u")throw new Error(Jr(12));if(typeof n(void 0,{type:I0.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(Jr(13))})}function _W(t){for(var e=Object.keys(t),n={},r=0;r<e.length;r++){var a=e[r];typeof t[a]=="function"&&(n[a]=t[a])}var i=Object.keys(n),o;try{EW(n)}catch(s){o=s}return function(s,l){if(s===void 0&&(s={}),o)throw o;for(var u=!1,c={},d=0;d<i.length;d++){var p=i[d],f=n[p],g=s[p],y=f(g,l);if(typeof y>"u")throw l&&l.type,new Error(Jr(14));c[p]=y,u=u||y!==g}return u=u||i.length!==Object.keys(s).length,u?c:s}}function B5(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.length===0?function(r){return r}:e.length===1?e[0]:e.reduce(function(r,a){return function(){return r(a.apply(void 0,arguments))}})}function OW(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(r){return function(){var a=r.apply(void 0,arguments),i=function(){throw new Error(Jr(15))},o={getState:a.getState,dispatch:function(){return i.apply(void 0,arguments)}},s=e.map(function(l){return l(o)});return i=B5.apply(void 0,s)(a.dispatch),L5(L5({},a),{},{dispatch:i})}}}function mt(t,e,...n){if($W()&&e===void 0)throw new Error("invariant requires an error message argument");if(!t){let r;if(e===void 0)r=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{let a=0;r=new Error(e.replace(/%s/g,function(){return n[a++]})),r.name="Invariant Violation"}throw r.framesToPop=1,r}}function $W(){return typeof process<"u"&&!0}function RW(t,e,n){return e.split(".").reduce((r,a)=>r&&r[a]?r[a]:n||null,t)}function MW(t,e){return t.filter(n=>n!==e)}function z5(t){return typeof t=="object"}function AW(t,e){const n=new Map,r=i=>{n.set(i,n.has(i)?n.get(i)+1:1)};t.forEach(r),e.forEach(r);const a=[];return n.forEach((i,o)=>{i===1&&a.push(o)}),a}function PW(t,e){return t.filter(n=>e.indexOf(n)>-1)}const uk="dnd-core/INIT_COORDS",E0="dnd-core/BEGIN_DRAG",ck="dnd-core/PUBLISH_DRAG_SOURCE",_0="dnd-core/HOVER",O0="dnd-core/DROP",$0="dnd-core/END_DRAG";function V5(t,e){return{type:uk,payload:{sourceClientOffset:e||null,clientOffset:t||null}}}const DW={type:uk,payload:{clientOffset:null,sourceClientOffset:null}};function LW(t){return function(e=[],n={publishSource:!0}){const{publishSource:r=!0,clientOffset:a,getSourceClientOffset:i}=n,o=t.getMonitor(),s=t.getRegistry();t.dispatch(V5(a)),FW(e,o,s);const l=VW(e,o);if(l==null){t.dispatch(DW);return}let u=null;if(a){if(!i)throw new Error("getSourceClientOffset must be defined");BW(i),u=i(l)}t.dispatch(V5(a,u));const c=s.getSource(l).beginDrag(o,l);if(c==null)return;zW(c),s.pinSource(l);const d=s.getSourceType(l);return{type:E0,payload:{itemType:d,item:c,sourceId:l,clientOffset:a||null,sourceClientOffset:u||null,isSourcePublic:!!r}}}}function FW(t,e,n){mt(!e.isDragging(),"Cannot call beginDrag while dragging."),t.forEach(function(r){mt(n.getSource(r),"Expected sourceIds to be registered.")})}function BW(t){mt(typeof t=="function","When clientOffset is provided, getSourceClientOffset must be a function.")}function zW(t){mt(z5(t),"Item must be an object.")}function VW(t,e){let n=null;for(let r=t.length-1;r>=0;r--)if(e.canDragSource(t[r])){n=t[r];break}return n}function WW(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jW(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{},r=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable}))),r.forEach(function(a){WW(t,a,n[a])})}return t}function UW(t){return function(e={}){const n=t.getMonitor(),r=t.getRegistry();GW(n),KW(n).forEach((a,i)=>{const o=HW(a,i,r,n),s={type:O0,payload:{dropResult:jW({},e,o)}};t.dispatch(s)})}}function GW(t){mt(t.isDragging(),"Cannot call drop while not dragging."),mt(!t.didDrop(),"Cannot call drop twice during one drag operation.")}function HW(t,e,n,r){const a=n.getTarget(t);let i=a?a.drop(r,t):void 0;return qW(i),typeof i>"u"&&(i=e===0?{}:r.getDropResult()),i}function qW(t){mt(typeof t>"u"||z5(t),"Drop result must either be an object or undefined.")}function KW(t){const e=t.getTargetIds().filter(t.canDropOnTarget,t);return e.reverse(),e}function XW(t){return function(){const e=t.getMonitor(),n=t.getRegistry();YW(e);const r=e.getSourceId();return r!=null&&(n.getSource(r,!0).endDrag(e,r),n.unpinSource()),{type:$0}}}function YW(t){mt(t.isDragging(),"Cannot call endDrag while not dragging.")}function dk(t,e){return e===null?t===null:Array.isArray(t)?t.some(n=>n===e):t===e}function QW(t){return function(e,{clientOffset:n}={}){ZW(e);const r=e.slice(0),a=t.getMonitor(),i=t.getRegistry(),o=a.getItemType();return ej(r,i,o),JW(r,a,i),tj(r,a,i),{type:_0,payload:{targetIds:r,clientOffset:n||null}}}}function ZW(t){mt(Array.isArray(t),"Expected targetIds to be an array.")}function JW(t,e,n){mt(e.isDragging(),"Cannot call hover while not dragging."),mt(!e.didDrop(),"Cannot call hover after drop.");for(let r=0;r<t.length;r++){const a=t[r];mt(t.lastIndexOf(a)===r,"Expected targetIds to be unique in the passed array.");const i=n.getTarget(a);mt(i,"Expected targetIds to be registered.")}}function ej(t,e,n){for(let r=t.length-1;r>=0;r--){const a=t[r],i=e.getTargetType(a);dk(i,n)||t.splice(r,1)}}function tj(t,e,n){t.forEach(function(r){n.getTarget(r).hover(e,r)})}function nj(t){return function(){if(t.getMonitor().isDragging())return{type:ck}}}function rj(t){return{beginDrag:LW(t),publishDragSource:nj(t),hover:QW(t),drop:UW(t),endDrag:XW(t)}}class aj{receiveBackend(e){this.backend=e}getMonitor(){return this.monitor}getBackend(){return this.backend}getRegistry(){return this.monitor.registry}getActions(){const e=this,{dispatch:n}=this.store;function r(i){return(...o)=>{const s=i.apply(e,o);typeof s<"u"&&n(s)}}const a=rj(this);return Object.keys(a).reduce((i,o)=>{const s=a[o];return i[o]=r(s),i},{})}dispatch(e){this.store.dispatch(e)}constructor(e,n){this.isSetUp=!1,this.handleRefCountChange=()=>{const r=this.store.getState().refCount>0;this.backend&&(r&&!this.isSetUp?(this.backend.setup(),this.isSetUp=!0):!r&&this.isSetUp&&(this.backend.teardown(),this.isSetUp=!1))},this.store=e,this.monitor=n,e.subscribe(this.handleRefCountChange)}}function ij(t,e){return{x:t.x+e.x,y:t.y+e.y}}function W5(t,e){return{x:t.x-e.x,y:t.y-e.y}}function oj(t){const{clientOffset:e,initialClientOffset:n,initialSourceClientOffset:r}=t;return!e||!n||!r?null:W5(ij(e,r),n)}function sj(t){const{clientOffset:e,initialClientOffset:n}=t;return!e||!n?null:W5(e,n)}const oh=[],pk=[];oh.__IS_NONE__=!0,pk.__IS_ALL__=!0;function lj(t,e){return t===oh?!1:t===pk||typeof e>"u"?!0:PW(e,t).length>0}class uj{subscribeToStateChange(e,n={}){const{handlerIds:r}=n;mt(typeof e=="function","listener must be a function."),mt(typeof r>"u"||Array.isArray(r),"handlerIds, when specified, must be an array of strings.");let a=this.store.getState().stateId;const i=()=>{const o=this.store.getState(),s=o.stateId;try{s===a||s===a+1&&!lj(o.dirtyHandlerIds,r)||e()}finally{a=s}};return this.store.subscribe(i)}subscribeToOffsetChange(e){mt(typeof e=="function","listener must be a function.");let n=this.store.getState().dragOffset;const r=()=>{const a=this.store.getState().dragOffset;a!==n&&(n=a,e())};return this.store.subscribe(r)}canDragSource(e){if(!e)return!1;const n=this.registry.getSource(e);return mt(n,`Expected to find a valid source. sourceId=${e}`),this.isDragging()?!1:n.canDrag(this,e)}canDropOnTarget(e){if(!e)return!1;const n=this.registry.getTarget(e);if(mt(n,`Expected to find a valid target. targetId=${e}`),!this.isDragging()||this.didDrop())return!1;const r=this.registry.getTargetType(e),a=this.getItemType();return dk(r,a)&&n.canDrop(this,e)}isDragging(){return!!this.getItemType()}isDraggingSource(e){if(!e)return!1;const n=this.registry.getSource(e,!0);if(mt(n,`Expected to find a valid source. sourceId=${e}`),!this.isDragging()||!this.isSourcePublic())return!1;const r=this.registry.getSourceType(e),a=this.getItemType();return r!==a?!1:n.isDragging(this,e)}isOverTarget(e,n={shallow:!1}){if(!e)return!1;const{shallow:r}=n;if(!this.isDragging())return!1;const a=this.registry.getTargetType(e),i=this.getItemType();if(i&&!dk(a,i))return!1;const o=this.getTargetIds();if(!o.length)return!1;const s=o.indexOf(e);return r?s===o.length-1:s>-1}getItemType(){return this.store.getState().dragOperation.itemType}getItem(){return this.store.getState().dragOperation.item}getSourceId(){return this.store.getState().dragOperation.sourceId}getTargetIds(){return this.store.getState().dragOperation.targetIds}getDropResult(){return this.store.getState().dragOperation.dropResult}didDrop(){return this.store.getState().dragOperation.didDrop}isSourcePublic(){return!!this.store.getState().dragOperation.isSourcePublic}getInitialClientOffset(){return this.store.getState().dragOffset.initialClientOffset}getInitialSourceClientOffset(){return this.store.getState().dragOffset.initialSourceClientOffset}getClientOffset(){return this.store.getState().dragOffset.clientOffset}getSourceClientOffset(){return oj(this.store.getState().dragOffset)}getDifferenceFromInitialOffset(){return sj(this.store.getState().dragOffset)}constructor(e,n){this.store=e,this.registry=n}}const j5=typeof global<"u"?global:self,U5=j5.MutationObserver||j5.WebKitMutationObserver;function G5(t){return function(){const e=setTimeout(r,0),n=setInterval(r,50);function r(){clearTimeout(e),clearInterval(n),t()}}}function cj(t){let e=1;const n=new U5(t),r=document.createTextNode("");return n.observe(r,{characterData:!0}),function(){e=-e,r.data=e}}const dj=typeof U5=="function"?cj:G5;class pj{enqueueTask(e){const{queue:n,requestFlush:r}=this;n.length||(r(),this.flushing=!0),n[n.length]=e}constructor(){this.queue=[],this.pendingErrors=[],this.flushing=!1,this.index=0,this.capacity=1024,this.flush=()=>{const{queue:e}=this;for(;this.index<e.length;){const n=this.index;if(this.index++,e[n].call(),this.index>this.capacity){for(let r=0,a=e.length-this.index;r<a;r++)e[r]=e[r+this.index];e.length-=this.index,this.index=0}}e.length=0,this.index=0,this.flushing=!1},this.registerPendingError=e=>{this.pendingErrors.push(e),this.requestErrorThrow()},this.requestFlush=dj(this.flush),this.requestErrorThrow=G5(()=>{if(this.pendingErrors.length)throw this.pendingErrors.shift()})}}class hj{call(){try{this.task&&this.task()}catch(e){this.onError(e)}finally{this.task=null,this.release(this)}}constructor(e,n){this.onError=e,this.release=n,this.task=null}}class fj{create(e){const n=this.freeTasks,r=n.length?n.pop():new hj(this.onError,a=>n[n.length]=a);return r.task=e,r}constructor(e){this.onError=e,this.freeTasks=[]}}const H5=new pj,mj=new fj(H5.registerPendingError);function gj(t){H5.enqueueTask(mj.create(t))}const hk="dnd-core/ADD_SOURCE",fk="dnd-core/ADD_TARGET",mk="dnd-core/REMOVE_SOURCE",R0="dnd-core/REMOVE_TARGET";function yj(t){return{type:hk,payload:{sourceId:t}}}function bj(t){return{type:fk,payload:{targetId:t}}}function vj(t){return{type:mk,payload:{sourceId:t}}}function xj(t){return{type:R0,payload:{targetId:t}}}function wj(t){mt(typeof t.canDrag=="function","Expected canDrag to be a function."),mt(typeof t.beginDrag=="function","Expected beginDrag to be a function."),mt(typeof t.endDrag=="function","Expected endDrag to be a function.")}function kj(t){mt(typeof t.canDrop=="function","Expected canDrop to be a function."),mt(typeof t.hover=="function","Expected hover to be a function."),mt(typeof t.drop=="function","Expected beginDrag to be a function.")}function gk(t,e){if(e&&Array.isArray(t)){t.forEach(n=>gk(n,!1));return}mt(typeof t=="string"||typeof t=="symbol",e?"Type can only be a string, a symbol, or an array of either.":"Type can only be a string or a symbol.")}var mi;(function(t){t.SOURCE="SOURCE",t.TARGET="TARGET"})(mi||(mi={}));let Sj=0;function Cj(){return Sj++}function Nj(t){const e=Cj().toString();switch(t){case mi.SOURCE:return`S${e}`;case mi.TARGET:return`T${e}`;default:throw new Error(`Unknown Handler Role: ${t}`)}}function q5(t){switch(t[0]){case"S":return mi.SOURCE;case"T":return mi.TARGET;default:throw new Error(`Cannot parse handler ID: ${t}`)}}function K5(t,e){const n=t.entries();let r=!1;do{const{done:a,value:[,i]}=n.next();if(i===e)return!0;r=!!a}while(!r);return!1}class Tj{addSource(e,n){gk(e),wj(n);const r=this.addHandler(mi.SOURCE,e,n);return this.store.dispatch(yj(r)),r}addTarget(e,n){gk(e,!0),kj(n);const r=this.addHandler(mi.TARGET,e,n);return this.store.dispatch(bj(r)),r}containsHandler(e){return K5(this.dragSources,e)||K5(this.dropTargets,e)}getSource(e,n=!1){return mt(this.isSourceId(e),"Expected a valid source ID."),n&&e===this.pinnedSourceId?this.pinnedSource:this.dragSources.get(e)}getTarget(e){return mt(this.isTargetId(e),"Expected a valid target ID."),this.dropTargets.get(e)}getSourceType(e){return mt(this.isSourceId(e),"Expected a valid source ID."),this.types.get(e)}getTargetType(e){return mt(this.isTargetId(e),"Expected a valid target ID."),this.types.get(e)}isSourceId(e){return q5(e)===mi.SOURCE}isTargetId(e){return q5(e)===mi.TARGET}removeSource(e){mt(this.getSource(e),"Expected an existing source."),this.store.dispatch(vj(e)),gj(()=>{this.dragSources.delete(e),this.types.delete(e)})}removeTarget(e){mt(this.getTarget(e),"Expected an existing target."),this.store.dispatch(xj(e)),this.dropTargets.delete(e),this.types.delete(e)}pinSource(e){const n=this.getSource(e);mt(n,"Expected an existing source."),this.pinnedSourceId=e,this.pinnedSource=n}unpinSource(){mt(this.pinnedSource,"No source is pinned at the time."),this.pinnedSourceId=null,this.pinnedSource=null}addHandler(e,n,r){const a=Nj(e);return this.types.set(a,n),e===mi.SOURCE?this.dragSources.set(a,r):e===mi.TARGET&&this.dropTargets.set(a,r),a}constructor(e){this.types=new Map,this.dragSources=new Map,this.dropTargets=new Map,this.pinnedSourceId=null,this.pinnedSource=null,this.store=e}}const Ij=(t,e)=>t===e;function Ej(t,e){return!t&&!e?!0:!t||!e?!1:t.x===e.x&&t.y===e.y}function _j(t,e,n=Ij){if(t.length!==e.length)return!1;for(let r=0;r<t.length;++r)if(!n(t[r],e[r]))return!1;return!0}function Oj(t=oh,e){switch(e.type){case _0:break;case hk:case fk:case R0:case mk:return oh;case E0:case ck:case $0:case O0:default:return pk}const{targetIds:n=[],prevTargetIds:r=[]}=e.payload,a=AW(n,r);if(!(a.length>0||!_j(n,r)))return oh;const i=r[r.length-1],o=n[n.length-1];return i!==o&&(i&&a.push(i),o&&a.push(o)),a}function $j(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rj(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{},r=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable}))),r.forEach(function(a){$j(t,a,n[a])})}return t}const X5={initialSourceClientOffset:null,initialClientOffset:null,clientOffset:null};function Mj(t=X5,e){const{payload:n}=e;switch(e.type){case uk:case E0:return{initialSourceClientOffset:n.sourceClientOffset,initialClientOffset:n.clientOffset,clientOffset:n.clientOffset};case _0:return Ej(t.clientOffset,n.clientOffset)?t:Rj({},t,{clientOffset:n.clientOffset});case $0:case O0:return X5;default:return t}}function Aj(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jc(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{},r=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable}))),r.forEach(function(a){Aj(t,a,n[a])})}return t}const Pj={itemType:null,item:null,sourceId:null,targetIds:[],dropResult:null,didDrop:!1,isSourcePublic:null};function Dj(t=Pj,e){const{payload:n}=e;switch(e.type){case E0:return jc({},t,{itemType:n.itemType,item:n.item,sourceId:n.sourceId,isSourcePublic:n.isSourcePublic,dropResult:null,didDrop:!1});case ck:return jc({},t,{isSourcePublic:!0});case _0:return jc({},t,{targetIds:n.targetIds});case R0:return t.targetIds.indexOf(n.targetId)===-1?t:jc({},t,{targetIds:MW(t.targetIds,n.targetId)});case O0:return jc({},t,{dropResult:n.dropResult,didDrop:!0,targetIds:[]});case $0:return jc({},t,{itemType:null,item:null,sourceId:null,dropResult:null,didDrop:!1,isSourcePublic:null,targetIds:[]});default:return t}}function Lj(t=0,e){switch(e.type){case hk:case fk:return t+1;case mk:case R0:return t-1;default:return t}}function Fj(t=0){return t+1}function Bj(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zj(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{},r=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable}))),r.forEach(function(a){Bj(t,a,n[a])})}return t}function Vj(t={},e){return{dirtyHandlerIds:Oj(t.dirtyHandlerIds,{type:e.type,payload:zj({},e.payload,{prevTargetIds:RW(t,"dragOperation.targetIds",[])})}),dragOffset:Mj(t.dragOffset,e),refCount:Lj(t.refCount,e),dragOperation:Dj(t.dragOperation,e),stateId:Fj(t.stateId)}}function Wj(t,e=void 0,n={},r=!1){const a=jj(r),i=new uj(a,new Tj(a)),o=new aj(a,i),s=t(o,e,n);return o.receiveBackend(s),o}function jj(t){const e=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION__;return lk(Vj,t&&e&&e({name:"dnd-core",instanceId:"dnd-core"}))}function Uj(t,e){if(t==null)return{};var n=Gj(t,e),r,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(a=0;a<i.length;a++)r=i[a],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function Gj(t,e){if(t==null)return{};var n={},r=Object.keys(t),a,i;for(i=0;i<r.length;i++)a=r[i],!(e.indexOf(a)>=0)&&(n[a]=t[a]);return n}let Y5=0;const M0=Symbol.for("__REACT_DND_CONTEXT_INSTANCE__");var Hj=P.memo(function(t){var{children:e}=t,n=Uj(t,["children"]);const[r,a]=qj(n);return P.useEffect(()=>{if(a){const i=Q5();return++Y5,()=>{--Y5===0&&(i[M0]=null)}}},[]),fe.jsx(P5.Provider,{value:r,children:e})});function qj(t){if("manager"in t)return[{dragDropManager:t.manager},!1];const e=Kj(t.backend,t.context,t.options,t.debugMode),n=!t.context;return[e,n]}function Kj(t,e=Q5(),n,r){const a=e;return a[M0]||(a[M0]={dragDropManager:Wj(t,e,n,r)}),a[M0]}function Q5(){return typeof global<"u"?global:window}const Xj=P.memo(function({connect:t,src:e}){return P.useEffect(()=>{if(typeof Image>"u")return;let n=!1;const r=new Image;return r.src=e,r.onload=()=>{t(r),n=!0},()=>{n&&t(null)}}),null});var Yj=function t(e,n){if(e===n)return!0;if(e&&n&&typeof e=="object"&&typeof n=="object"){if(e.constructor!==n.constructor)return!1;var r,a,i;if(Array.isArray(e)){if(r=e.length,r!=n.length)return!1;for(a=r;a--!==0;)if(!t(e[a],n[a]))return!1;return!0}if(e.constructor===RegExp)return e.source===n.source&&e.flags===n.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===n.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===n.toString();if(i=Object.keys(e),r=i.length,r!==Object.keys(n).length)return!1;for(a=r;a--!==0;)if(!Object.prototype.hasOwnProperty.call(n,i[a]))return!1;for(a=r;a--!==0;){var o=i[a];if(!t(e[o],n[o]))return!1}return!0}return e!==e&&n!==n};const Qj=Hi(Yj),hu=typeof window<"u"?P.useLayoutEffect:P.useEffect;function Zj(t,e,n){const[r,a]=P.useState(()=>e(t)),i=P.useCallback(()=>{const o=e(t);Qj(r,o)||(a(o),n&&n())},[r,t,n]);return hu(i),[r,i]}function Jj(t,e,n){const[r,a]=Zj(t,e,n);return hu(function(){const i=t.getHandlerId();if(i!=null)return t.subscribeToStateChange(a,{handlerIds:[i]})},[t,a]),r}function Z5(t,e,n){return Jj(e,t||(()=>({})),()=>n.reconnect())}function J5(t,e){const n=[...e||[]];return e==null&&typeof t!="function"&&n.push(t),P.useMemo(()=>typeof t=="function"?t():t,n)}function eU(t){return P.useMemo(()=>t.hooks.dragSource(),[t])}function tU(t){return P.useMemo(()=>t.hooks.dragPreview(),[t])}let yk=!1,bk=!1;class nU{receiveHandlerId(e){this.sourceId=e}getHandlerId(){return this.sourceId}canDrag(){mt(!yk,"You may not call monitor.canDrag() inside your canDrag() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor");try{return yk=!0,this.internalMonitor.canDragSource(this.sourceId)}finally{yk=!1}}isDragging(){if(!this.sourceId)return!1;mt(!bk,"You may not call monitor.isDragging() inside your isDragging() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor");try{return bk=!0,this.internalMonitor.isDraggingSource(this.sourceId)}finally{bk=!1}}subscribeToStateChange(e,n){return this.internalMonitor.subscribeToStateChange(e,n)}isDraggingSource(e){return this.internalMonitor.isDraggingSource(e)}isOverTarget(e,n){return this.internalMonitor.isOverTarget(e,n)}getTargetIds(){return this.internalMonitor.getTargetIds()}isSourcePublic(){return this.internalMonitor.isSourcePublic()}getSourceId(){return this.internalMonitor.getSourceId()}subscribeToOffsetChange(e){return this.internalMonitor.subscribeToOffsetChange(e)}canDragSource(e){return this.internalMonitor.canDragSource(e)}canDropOnTarget(e){return this.internalMonitor.canDropOnTarget(e)}getItemType(){return this.internalMonitor.getItemType()}getItem(){return this.internalMonitor.getItem()}getDropResult(){return this.internalMonitor.getDropResult()}didDrop(){return this.internalMonitor.didDrop()}getInitialClientOffset(){return this.internalMonitor.getInitialClientOffset()}getInitialSourceClientOffset(){return this.internalMonitor.getInitialSourceClientOffset()}getSourceClientOffset(){return this.internalMonitor.getSourceClientOffset()}getClientOffset(){return this.internalMonitor.getClientOffset()}getDifferenceFromInitialOffset(){return this.internalMonitor.getDifferenceFromInitialOffset()}constructor(e){this.sourceId=null,this.internalMonitor=e.getMonitor()}}let vk=!1;class rU{receiveHandlerId(e){this.targetId=e}getHandlerId(){return this.targetId}subscribeToStateChange(e,n){return this.internalMonitor.subscribeToStateChange(e,n)}canDrop(){if(!this.targetId)return!1;mt(!vk,"You may not call monitor.canDrop() inside your canDrop() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drop-target-monitor");try{return vk=!0,this.internalMonitor.canDropOnTarget(this.targetId)}finally{vk=!1}}isOver(e){return this.targetId?this.internalMonitor.isOverTarget(this.targetId,e):!1}getItemType(){return this.internalMonitor.getItemType()}getItem(){return this.internalMonitor.getItem()}getDropResult(){return this.internalMonitor.getDropResult()}didDrop(){return this.internalMonitor.didDrop()}getInitialClientOffset(){return this.internalMonitor.getInitialClientOffset()}getInitialSourceClientOffset(){return this.internalMonitor.getInitialSourceClientOffset()}getSourceClientOffset(){return this.internalMonitor.getSourceClientOffset()}getClientOffset(){return this.internalMonitor.getClientOffset()}getDifferenceFromInitialOffset(){return this.internalMonitor.getDifferenceFromInitialOffset()}constructor(e){this.targetId=null,this.internalMonitor=e.getMonitor()}}function aU(t,e,n){const r=n.getRegistry(),a=r.addTarget(t,e);return[a,()=>r.removeTarget(a)]}function iU(t,e,n){const r=n.getRegistry(),a=r.addSource(t,e);return[a,()=>r.removeSource(a)]}function xk(t,e,n,r){let a=n?n.call(r,t,e):void 0;if(a!==void 0)return!!a;if(t===e)return!0;if(typeof t!="object"||!t||typeof e!="object"||!e)return!1;const i=Object.keys(t),o=Object.keys(e);if(i.length!==o.length)return!1;const s=Object.prototype.hasOwnProperty.bind(e);for(let l=0;l<i.length;l++){const u=i[l];if(!s(u))return!1;const c=t[u],d=e[u];if(a=n?n.call(r,c,d,u):void 0,a===!1||a===void 0&&c!==d)return!1}return!0}function wk(t){return t!==null&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function oU(t){if(typeof t.type=="string")return;const e=t.type.displayName||t.type.name||"the component";throw new Error(`Only native element nodes can now be passed to React DnD connectors.You can either wrap ${e} into a <div>, or turn it into a drag source or a drop target itself.`)}function sU(t){return(e=null,n=null)=>{if(!P.isValidElement(e)){const a=e;return t(a,n),a}const r=e;return oU(r),lU(r,n?a=>t(a,n):t)}}function eO(t){const e={};return Object.keys(t).forEach(n=>{const r=t[n];if(n.endsWith("Ref"))e[n]=t[n];else{const a=sU(r);e[n]=()=>a}}),e}function tO(t,e){typeof t=="function"?t(e):t.current=e}function lU(t,e){const n=t.ref;return mt(typeof n!="string","Cannot connect React DnD to an element with an existing string ref. Please convert it to use a callback ref instead, or wrap it into a <span> or <div>. Read more: https://reactjs.org/docs/refs-and-the-dom.html#callback-refs"),n?P.cloneElement(t,{ref:r=>{tO(n,r),tO(e,r)}}):P.cloneElement(t,{ref:e})}class uU{receiveHandlerId(e){this.handlerId!==e&&(this.handlerId=e,this.reconnect())}get connectTarget(){return this.dragSource}get dragSourceOptions(){return this.dragSourceOptionsInternal}set dragSourceOptions(e){this.dragSourceOptionsInternal=e}get dragPreviewOptions(){return this.dragPreviewOptionsInternal}set dragPreviewOptions(e){this.dragPreviewOptionsInternal=e}reconnect(){const e=this.reconnectDragSource();this.reconnectDragPreview(e)}reconnectDragSource(){const e=this.dragSource,n=this.didHandlerIdChange()||this.didConnectedDragSourceChange()||this.didDragSourceOptionsChange();return n&&this.disconnectDragSource(),this.handlerId?e?(n&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragSource=e,this.lastConnectedDragSourceOptions=this.dragSourceOptions,this.dragSourceUnsubscribe=this.backend.connectDragSource(this.handlerId,e,this.dragSourceOptions)),n):(this.lastConnectedDragSource=e,n):n}reconnectDragPreview(e=!1){const n=this.dragPreview,r=e||this.didHandlerIdChange()||this.didConnectedDragPreviewChange()||this.didDragPreviewOptionsChange();if(r&&this.disconnectDragPreview(),!!this.handlerId){if(!n){this.lastConnectedDragPreview=n;return}r&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragPreview=n,this.lastConnectedDragPreviewOptions=this.dragPreviewOptions,this.dragPreviewUnsubscribe=this.backend.connectDragPreview(this.handlerId,n,this.dragPreviewOptions))}}didHandlerIdChange(){return this.lastConnectedHandlerId!==this.handlerId}didConnectedDragSourceChange(){return this.lastConnectedDragSource!==this.dragSource}didConnectedDragPreviewChange(){return this.lastConnectedDragPreview!==this.dragPreview}didDragSourceOptionsChange(){return!xk(this.lastConnectedDragSourceOptions,this.dragSourceOptions)}didDragPreviewOptionsChange(){return!xk(this.lastConnectedDragPreviewOptions,this.dragPreviewOptions)}disconnectDragSource(){this.dragSourceUnsubscribe&&(this.dragSourceUnsubscribe(),this.dragSourceUnsubscribe=void 0)}disconnectDragPreview(){this.dragPreviewUnsubscribe&&(this.dragPreviewUnsubscribe(),this.dragPreviewUnsubscribe=void 0,this.dragPreviewNode=null,this.dragPreviewRef=null)}get dragSource(){return this.dragSourceNode||this.dragSourceRef&&this.dragSourceRef.current}get dragPreview(){return this.dragPreviewNode||this.dragPreviewRef&&this.dragPreviewRef.current}clearDragSource(){this.dragSourceNode=null,this.dragSourceRef=null}clearDragPreview(){this.dragPreviewNode=null,this.dragPreviewRef=null}constructor(e){this.hooks=eO({dragSource:(n,r)=>{this.clearDragSource(),this.dragSourceOptions=r||null,wk(n)?this.dragSourceRef=n:this.dragSourceNode=n,this.reconnectDragSource()},dragPreview:(n,r)=>{this.clearDragPreview(),this.dragPreviewOptions=r||null,wk(n)?this.dragPreviewRef=n:this.dragPreviewNode=n,this.reconnectDragPreview()}}),this.handlerId=null,this.dragSourceRef=null,this.dragSourceOptionsInternal=null,this.dragPreviewRef=null,this.dragPreviewOptionsInternal=null,this.lastConnectedHandlerId=null,this.lastConnectedDragSource=null,this.lastConnectedDragSourceOptions=null,this.lastConnectedDragPreview=null,this.lastConnectedDragPreviewOptions=null,this.backend=e}}class cU{get connectTarget(){return this.dropTarget}reconnect(){const e=this.didHandlerIdChange()||this.didDropTargetChange()||this.didOptionsChange();e&&this.disconnectDropTarget();const n=this.dropTarget;if(this.handlerId){if(!n){this.lastConnectedDropTarget=n;return}e&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDropTarget=n,this.lastConnectedDropTargetOptions=this.dropTargetOptions,this.unsubscribeDropTarget=this.backend.connectDropTarget(this.handlerId,n,this.dropTargetOptions))}}receiveHandlerId(e){e!==this.handlerId&&(this.handlerId=e,this.reconnect())}get dropTargetOptions(){return this.dropTargetOptionsInternal}set dropTargetOptions(e){this.dropTargetOptionsInternal=e}didHandlerIdChange(){return this.lastConnectedHandlerId!==this.handlerId}didDropTargetChange(){return this.lastConnectedDropTarget!==this.dropTarget}didOptionsChange(){return!xk(this.lastConnectedDropTargetOptions,this.dropTargetOptions)}disconnectDropTarget(){this.unsubscribeDropTarget&&(this.unsubscribeDropTarget(),this.unsubscribeDropTarget=void 0)}get dropTarget(){return this.dropTargetNode||this.dropTargetRef&&this.dropTargetRef.current}clearDropTarget(){this.dropTargetRef=null,this.dropTargetNode=null}constructor(e){this.hooks=eO({dropTarget:(n,r)=>{this.clearDropTarget(),this.dropTargetOptions=r,wk(n)?this.dropTargetRef=n:this.dropTargetNode=n,this.reconnect()}}),this.handlerId=null,this.dropTargetRef=null,this.dropTargetOptionsInternal=null,this.lastConnectedHandlerId=null,this.lastConnectedDropTarget=null,this.lastConnectedDropTargetOptions=null,this.backend=e}}function Uc(){const{dragDropManager:t}=P.useContext(P5);return mt(t!=null,"Expected drag drop context"),t}function dU(t,e){const n=Uc(),r=P.useMemo(()=>new uU(n.getBackend()),[n]);return hu(()=>(r.dragSourceOptions=t||null,r.reconnect(),()=>r.disconnectDragSource()),[r,t]),hu(()=>(r.dragPreviewOptions=e||null,r.reconnect(),()=>r.disconnectDragPreview()),[r,e]),r}function pU(){const t=Uc();return P.useMemo(()=>new nU(t),[t])}class hU{beginDrag(){const e=this.spec,n=this.monitor;let r=null;return typeof e.item=="object"?r=e.item:typeof e.item=="function"?r=e.item(n):r={},r??null}canDrag(){const e=this.spec,n=this.monitor;return typeof e.canDrag=="boolean"?e.canDrag:typeof e.canDrag=="function"?e.canDrag(n):!0}isDragging(e,n){const r=this.spec,a=this.monitor,{isDragging:i}=r;return i?i(a):n===e.getSourceId()}endDrag(){const e=this.spec,n=this.monitor,r=this.connector,{end:a}=e;a&&a(n.getItem(),n),r.reconnect()}constructor(e,n,r){this.spec=e,this.monitor=n,this.connector=r}}function fU(t,e,n){const r=P.useMemo(()=>new hU(t,e,n),[e,n]);return P.useEffect(()=>{r.spec=t},[t]),r}function mU(t){return P.useMemo(()=>{const e=t.type;return mt(e!=null,"spec.type must be defined"),e},[t])}function gU(t,e,n){const r=Uc(),a=fU(t,e,n),i=mU(t);hu(function(){if(i!=null){const[o,s]=iU(i,a,r);return e.receiveHandlerId(o),n.receiveHandlerId(o),s}},[r,e,n,a,i])}function yU(t,e){const n=J5(t,e);mt(!n.begin,"useDrag::spec.begin was deprecated in v14. Replace spec.begin() with spec.item(). (see more here - https://react-dnd.github.io/react-dnd/docs/api/use-drag)");const r=pU(),a=dU(n.options,n.previewOptions);return gU(n,r,a),[Z5(n.collect,r,a),eU(a),tU(a)]}function bU(t){return P.useMemo(()=>t.hooks.dropTarget(),[t])}function vU(t){const e=Uc(),n=P.useMemo(()=>new cU(e.getBackend()),[e]);return hu(()=>(n.dropTargetOptions=t||null,n.reconnect(),()=>n.disconnectDropTarget()),[t]),n}function xU(){const t=Uc();return P.useMemo(()=>new rU(t),[t])}function wU(t){const{accept:e}=t;return P.useMemo(()=>(mt(t.accept!=null,"accept must be defined"),Array.isArray(e)?e:[e]),[e])}class kU{canDrop(){const e=this.spec,n=this.monitor;return e.canDrop?e.canDrop(n.getItem(),n):!0}hover(){const e=this.spec,n=this.monitor;e.hover&&e.hover(n.getItem(),n)}drop(){const e=this.spec,n=this.monitor;if(e.drop)return e.drop(n.getItem(),n)}constructor(e,n){this.spec=e,this.monitor=n}}function SU(t,e){const n=P.useMemo(()=>new kU(t,e),[e]);return P.useEffect(()=>{n.spec=t},[t]),n}function CU(t,e,n){const r=Uc(),a=SU(t,e),i=wU(t);hu(function(){const[o,s]=aU(i,a,r);return e.receiveHandlerId(o),n.receiveHandlerId(o),s},[r,e,a,n,i.map(o=>o.toString()).join("|")])}function NU(t,e){const n=J5(t,e),r=xU(),a=vU(n.options);return CU(n,r,a),[Z5(n.collect,r,a),bU(a)]}var Xs;(function(t){t.mouse="mouse",t.touch="touch",t.keyboard="keyboard"})(Xs||(Xs={}));class TU{get delay(){var e;return(e=this.args.delay)!==null&&e!==void 0?e:0}get scrollAngleRanges(){return this.args.scrollAngleRanges}get getDropTargetElementsAtPoint(){return this.args.getDropTargetElementsAtPoint}get ignoreContextMenu(){var e;return(e=this.args.ignoreContextMenu)!==null&&e!==void 0?e:!1}get enableHoverOutsideTarget(){var e;return(e=this.args.enableHoverOutsideTarget)!==null&&e!==void 0?e:!1}get enableKeyboardEvents(){var e;return(e=this.args.enableKeyboardEvents)!==null&&e!==void 0?e:!1}get enableMouseEvents(){var e;return(e=this.args.enableMouseEvents)!==null&&e!==void 0?e:!1}get enableTouchEvents(){var e;return(e=this.args.enableTouchEvents)!==null&&e!==void 0?e:!0}get touchSlop(){return this.args.touchSlop||0}get delayTouchStart(){var e,n,r,a;return(a=(r=(e=this.args)===null||e===void 0?void 0:e.delayTouchStart)!==null&&r!==void 0?r:(n=this.args)===null||n===void 0?void 0:n.delay)!==null&&a!==void 0?a:0}get delayMouseStart(){var e,n,r,a;return(a=(r=(e=this.args)===null||e===void 0?void 0:e.delayMouseStart)!==null&&r!==void 0?r:(n=this.args)===null||n===void 0?void 0:n.delay)!==null&&a!==void 0?a:0}get window(){if(this.context&&this.context.window)return this.context.window;if(typeof window<"u")return window}get document(){var e;if(!((e=this.context)===null||e===void 0)&&e.document)return this.context.document;if(this.window)return this.window.document}get rootElement(){var e;return((e=this.args)===null||e===void 0?void 0:e.rootElement)||this.document}constructor(e,n){this.args=e,this.context=n}}function IU(t,e,n,r){return Math.sqrt(Math.pow(Math.abs(n-t),2)+Math.pow(Math.abs(r-e),2))}function EU(t,e,n,r,a){if(!a)return!1;const i=Math.atan2(r-e,n-t)*180/Math.PI+180;for(let o=0;o<a.length;++o){const s=a[o];if(s&&(s.start==null||i>=s.start)&&(s.end==null||i<=s.end))return!0}return!1}const _U={Left:1,Right:2,Center:4},OU={Left:0,Center:1,Right:2};function kk(t){return t.button===void 0||t.button===OU.Left}function $U(t){return t.buttons===void 0||(t.buttons&_U.Left)===0}function nO(t){return!!t.targetTouches}const RU=1;function MU(t){const e=t.nodeType===RU?t:t.parentElement;if(!e)return;const{top:n,left:r}=e.getBoundingClientRect();return{x:r,y:n}}function AU(t,e){if(t.targetTouches.length===1)return A0(t.targetTouches[0]);if(e&&t.touches.length===1&&t.touches[0].target===e.target)return A0(t.touches[0])}function A0(t,e){return nO(t)?AU(t,e):{x:t.clientX,y:t.clientY}}const rO=(()=>{let t=!1;try{addEventListener("test",()=>{},Object.defineProperty({},"passive",{get(){return t=!0,!0}}))}catch{}return t})(),sh={[Xs.mouse]:{start:"mousedown",move:"mousemove",end:"mouseup",contextmenu:"contextmenu"},[Xs.touch]:{start:"touchstart",move:"touchmove",end:"touchend"},[Xs.keyboard]:{keydown:"keydown"}};class Ng{profile(){var e;return{sourceNodes:this.sourceNodes.size,sourcePreviewNodes:this.sourcePreviewNodes.size,sourcePreviewNodeOptions:this.sourcePreviewNodeOptions.size,targetNodes:this.targetNodes.size,dragOverTargetIds:((e=this.dragOverTargetIds)===null||e===void 0?void 0:e.length)||0}}get document(){return this.options.document}setup(){const e=this.options.rootElement;e&&(mt(!Ng.isSetUp,"Cannot have two Touch backends at the same time."),Ng.isSetUp=!0,this.addEventListener(e,"start",this.getTopMoveStartHandler()),this.addEventListener(e,"start",this.handleTopMoveStartCapture,!0),this.addEventListener(e,"move",this.handleTopMove),this.addEventListener(e,"move",this.handleTopMoveCapture,!0),this.addEventListener(e,"end",this.handleTopMoveEndCapture,!0),this.options.enableMouseEvents&&!this.options.ignoreContextMenu&&this.addEventListener(e,"contextmenu",this.handleTopMoveEndCapture),this.options.enableKeyboardEvents&&this.addEventListener(e,"keydown",this.handleCancelOnEscape,!0))}teardown(){const e=this.options.rootElement;e&&(Ng.isSetUp=!1,this._mouseClientOffset={},this.removeEventListener(e,"start",this.handleTopMoveStartCapture,!0),this.removeEventListener(e,"start",this.handleTopMoveStart),this.removeEventListener(e,"move",this.handleTopMoveCapture,!0),this.removeEventListener(e,"move",this.handleTopMove),this.removeEventListener(e,"end",this.handleTopMoveEndCapture,!0),this.options.enableMouseEvents&&!this.options.ignoreContextMenu&&this.removeEventListener(e,"contextmenu",this.handleTopMoveEndCapture),this.options.enableKeyboardEvents&&this.removeEventListener(e,"keydown",this.handleCancelOnEscape,!0),this.uninstallSourceNodeRemovalObserver())}addEventListener(e,n,r,a=!1){const i=rO?{capture:a,passive:!1}:a;this.listenerTypes.forEach(function(o){const s=sh[o][n];s&&e.addEventListener(s,r,i)})}removeEventListener(e,n,r,a=!1){const i=rO?{capture:a,passive:!1}:a;this.listenerTypes.forEach(function(o){const s=sh[o][n];s&&e.removeEventListener(s,r,i)})}connectDragSource(e,n){const r=this.handleMoveStart.bind(this,e);return this.sourceNodes.set(e,n),this.addEventListener(n,"start",r),()=>{this.sourceNodes.delete(e),this.removeEventListener(n,"start",r)}}connectDragPreview(e,n,r){return this.sourcePreviewNodeOptions.set(e,r),this.sourcePreviewNodes.set(e,n),()=>{this.sourcePreviewNodes.delete(e),this.sourcePreviewNodeOptions.delete(e)}}connectDropTarget(e,n){const r=this.options.rootElement;if(!this.document||!r)return()=>{};const a=i=>{if(!this.document||!r||!this.monitor.isDragging())return;let o;switch(i.type){case sh.mouse.move:o={x:i.clientX,y:i.clientY};break;case sh.touch.move:var s,l;o={x:((s=i.touches[0])===null||s===void 0?void 0:s.clientX)||0,y:((l=i.touches[0])===null||l===void 0?void 0:l.clientY)||0};break}const u=o!=null?this.document.elementFromPoint(o.x,o.y):void 0,c=u&&n.contains(u);if(u===n||c)return this.handleMove(i,e)};return this.addEventListener(this.document.body,"move",a),this.targetNodes.set(e,n),()=>{this.document&&(this.targetNodes.delete(e),this.removeEventListener(this.document.body,"move",a))}}getTopMoveStartHandler(){return!this.options.delayTouchStart&&!this.options.delayMouseStart?this.handleTopMoveStart:this.handleTopMoveStartDelay}installSourceNodeRemovalObserver(e){this.uninstallSourceNodeRemovalObserver(),this.draggedSourceNode=e,this.draggedSourceNodeRemovalObserver=new MutationObserver(()=>{e&&!e.parentElement&&(this.resurrectSourceNode(),this.uninstallSourceNodeRemovalObserver())}),!(!e||!e.parentElement)&&this.draggedSourceNodeRemovalObserver.observe(e.parentElement,{childList:!0})}resurrectSourceNode(){this.document&&this.draggedSourceNode&&(this.draggedSourceNode.style.display="none",this.draggedSourceNode.removeAttribute("data-reactid"),this.document.body.appendChild(this.draggedSourceNode))}uninstallSourceNodeRemovalObserver(){this.draggedSourceNodeRemovalObserver&&this.draggedSourceNodeRemovalObserver.disconnect(),this.draggedSourceNodeRemovalObserver=void 0,this.draggedSourceNode=void 0}constructor(e,n,r){this.getSourceClientOffset=a=>{const i=this.sourceNodes.get(a);return i&&MU(i)},this.handleTopMoveStartCapture=a=>{kk(a)&&(this.moveStartSourceIds=[])},this.handleMoveStart=a=>{Array.isArray(this.moveStartSourceIds)&&this.moveStartSourceIds.unshift(a)},this.handleTopMoveStart=a=>{if(!kk(a))return;const i=A0(a);i&&(nO(a)&&(this.lastTargetTouchFallback=a.targetTouches[0]),this._mouseClientOffset=i),this.waitingForDelay=!1},this.handleTopMoveStartDelay=a=>{if(!kk(a))return;const i=a.type===sh.touch.start?this.options.delayTouchStart:this.options.delayMouseStart;this.timeout=setTimeout(this.handleTopMoveStart.bind(this,a),i),this.waitingForDelay=!0},this.handleTopMoveCapture=()=>{this.dragOverTargetIds=[]},this.handleMove=(a,i)=>{this.dragOverTargetIds&&this.dragOverTargetIds.unshift(i)},this.handleTopMove=a=>{if(this.timeout&&clearTimeout(this.timeout),!this.document||this.waitingForDelay)return;const{moveStartSourceIds:i,dragOverTargetIds:o}=this,s=this.options.enableHoverOutsideTarget,l=A0(a,this.lastTargetTouchFallback);if(!l)return;if(this._isScrolling||!this.monitor.isDragging()&&EU(this._mouseClientOffset.x||0,this._mouseClientOffset.y||0,l.x,l.y,this.options.scrollAngleRanges)){this._isScrolling=!0;return}if(!this.monitor.isDragging()&&this._mouseClientOffset.hasOwnProperty("x")&&i&&IU(this._mouseClientOffset.x||0,this._mouseClientOffset.y||0,l.x,l.y)>(this.options.touchSlop?this.options.touchSlop:0)&&(this.moveStartSourceIds=void 0,this.actions.beginDrag(i,{clientOffset:this._mouseClientOffset,getSourceClientOffset:this.getSourceClientOffset,publishSource:!1})),!this.monitor.isDragging())return;const u=this.sourceNodes.get(this.monitor.getSourceId());this.installSourceNodeRemovalObserver(u),this.actions.publishDragSource(),a.cancelable&&a.preventDefault();const c=(o||[]).map(g=>this.targetNodes.get(g)).filter(g=>!!g),d=this.options.getDropTargetElementsAtPoint?this.options.getDropTargetElementsAtPoint(l.x,l.y,c):this.document.elementsFromPoint(l.x,l.y),p=[];for(const g in d){if(!d.hasOwnProperty(g))continue;let y=d[g];for(y!=null&&p.push(y);y;)y=y.parentElement,y&&p.indexOf(y)===-1&&p.push(y)}const f=p.filter(g=>c.indexOf(g)>-1).map(g=>this._getDropTargetId(g)).filter(g=>!!g).filter((g,y,x)=>x.indexOf(g)===y);if(s)for(const g in this.targetNodes){const y=this.targetNodes.get(g);if(u&&y&&y.contains(u)&&f.indexOf(g)===-1){f.unshift(g);break}}f.reverse(),this.actions.hover(f,{clientOffset:l})},this._getDropTargetId=a=>{const i=this.targetNodes.keys();let o=i.next();for(;o.done===!1;){const s=o.value;if(a===this.targetNodes.get(s))return s;o=i.next()}},this.handleTopMoveEndCapture=a=>{if(this._isScrolling=!1,this.lastTargetTouchFallback=void 0,!!$U(a)){if(!this.monitor.isDragging()||this.monitor.didDrop()){this.moveStartSourceIds=void 0;return}a.cancelable&&a.preventDefault(),this._mouseClientOffset={},this.uninstallSourceNodeRemovalObserver(),this.actions.drop(),this.actions.endDrag()}},this.handleCancelOnEscape=a=>{a.key==="Escape"&&this.monitor.isDragging()&&(this._mouseClientOffset={},this.uninstallSourceNodeRemovalObserver(),this.actions.endDrag())},this.options=new TU(r,n),this.actions=e.getActions(),this.monitor=e.getMonitor(),this.sourceNodes=new Map,this.sourcePreviewNodes=new Map,this.sourcePreviewNodeOptions=new Map,this.targetNodes=new Map,this.listenerTypes=[],this._mouseClientOffset={},this._isScrolling=!1,this.options.enableMouseEvents&&this.listenerTypes.push(Xs.mouse),this.options.enableTouchEvents&&this.listenerTypes.push(Xs.touch),this.options.enableKeyboardEvents&&this.listenerTypes.push(Xs.keyboard)}}const PU=function(t,e={},n={}){return new Ng(t,e,n)};var aO={exports:{}},Ka={},iO={exports:{}},oO={};/**
* @license React
* scheduler.production.min.js
*
* Copyright (c) Facebook, Inc. and its affiliates.
*
* This source code is licensed under the MIT license found in the
* LICENSE file in the root directory of this source tree.
*/(function(t){function e(F,Y){var Z=F.length;F.push(Y);e:for(;0<Z;){var ne=Z-1>>>1,se=F[ne];if(0<a(se,Y))F[ne]=Y,F[Z]=se,Z=ne;else break e}}function n(F){return F.length===0?null:F[0]}function r(F){if(F.length===0)return null;var Y=F[0],Z=F.pop();if(Z!==Y){F[0]=Z;e:for(var ne=0,se=F.length,ce=se>>>1;ne<ce;){var le=2*(ne+1)-1,ye=F[le],we=le+1,q=F[we];if(0>a(ye,Z))we<se&&0>a(q,ye)?(F[ne]=q,F[we]=Z,ne=we):(F[ne]=ye,F[le]=Z,ne=le);else if(we<se&&0>a(q,Z))F[ne]=q,F[we]=Z,ne=we;else break e}}return Y}function a(F,Y){var Z=F.sortIndex-Y.sortIndex;return Z!==0?Z:F.id-Y.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,s=o.now();t.unstable_now=function(){return o.now()-s}}var l=[],u=[],c=1,d=null,p=3,f=!1,g=!1,y=!1,x=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(F){for(var Y=n(u);Y!==null;){if(Y.callback===null)r(u);else if(Y.startTime<=F)r(u),Y.sortIndex=Y.expirationTime,e(l,Y);else break;Y=n(u)}}function S(F){if(y=!1,w(F),!g)if(n(l)!==null)g=!0,Q(C);else{var Y=n(u);Y!==null&&H(S,Y.startTime-F)}}function C(F,Y){g=!1,y&&(y=!1,b(E),E=-1),f=!0;var Z=p;try{for(w(Y),d=n(l);d!==null&&(!(d.expirationTime>Y)||F&&!L());){var ne=d.callback;if(typeof ne=="function"){d.callback=null,p=d.priorityLevel;var se=ne(d.expirationTime<=Y);Y=t.unstable_now(),typeof se=="function"?d.callback=se:d===n(l)&&r(l),w(Y)}else r(l);d=n(l)}if(d!==null)var ce=!0;else{var le=n(u);le!==null&&H(S,le.startTime-Y),ce=!1}return ce}finally{d=null,p=Z,f=!1}}var I=!1,_=null,E=-1,A=5,M=-1;function L(){return!(t.unstable_now()-M<A)}function W(){if(_!==null){var F=t.unstable_now();M=F;var Y=!0;try{Y=_(!0,F)}finally{Y?B():(I=!1,_=null)}}else I=!1}var B;if(typeof v=="function")B=function(){v(W)};else if(typeof MessageChannel<"u"){var K=new MessageChannel,X=K.port2;K.port1.onmessage=W,B=function(){X.postMessage(null)}}else B=function(){x(W,0)};function Q(F){_=F,I||(I=!0,B())}function H(F,Y){E=x(function(){F(t.unstable_now())},Y)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(F){F.callback=null},t.unstable_continueExecution=function(){g||f||(g=!0,Q(C))},t.unstable_forceFrameRate=function(F){0>F||125<F?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<F?Math.floor(1e3/F):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(F){switch(p){case 1:case 2:case 3:var Y=3;break;default:Y=p}var Z=p;p=Y;try{return F()}finally{p=Z}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(F,Y){switch(F){case 1:case 2:case 3:case 4:case 5:break;default:F=3}var Z=p;p=F;try{return Y()}finally{p=Z}},t.unstable_scheduleCallback=function(F,Y,Z){var ne=t.unstable_now();switch(typeof Z=="object"&&Z!==null?(Z=Z.delay,Z=typeof Z=="number"&&0<Z?ne+Z:ne):Z=ne,F){case 1:var se=-1;break;case 2:se=250;break;case 5:se=1073741823;break;case 4:se=1e4;break;default:se=5e3}return se=Z+se,F={id:c++,callback:Y,priorityLevel:F,startTime:Z,expirationTime:se,sortIndex:-1},Z>ne?(F.sortIndex=Z,e(u,F),n(l)===null&&F===n(u)&&(y?(b(E),E=-1):y=!0,H(S,Z-ne))):(F.sortIndex=se,e(l,F),g||f||(g=!0,Q(C))),F},t.unstable_shouldYield=L,t.unstable_wrapCallback=function(F){var Y=p;return function(){var Z=p;p=Y;try{return F.apply(this,arguments)}finally{p=Z}}}})(oO),iO.exports=oO;var lh=iO.exports;/**
* @license React
* react-dom.production.min.js
*
* Copyright (c) Facebook, Inc. and its affiliates.
*
* This source code is licensed under the MIT license found in the
* LICENSE file in the root directory of this source tree.
*/var sO=P,Xa=lh;function Se(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var lO=new Set,uh={};function fu(t,e){Gc(t,e),Gc(t+"Capture",e)}function Gc(t,e){for(uh[t]=e,t=0;t<e.length;t++)lO.add(e[t])}var ts=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Sk=Object.prototype.hasOwnProperty,DU=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,uO={},cO={};function LU(t){return Sk.call(cO,t)?!0:Sk.call(uO,t)?!1:DU.test(t)?cO[t]=!0:(uO[t]=!0,!1)}function FU(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function BU(t,e,n,r){if(e===null||typeof e>"u"||FU(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function va(t,e,n,r,a,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var Dr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Dr[t]=new va(t,0,!1,t,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Dr[e]=new va(e,1,!1,t[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(t){Dr[t]=new va(t,2,!1,t.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Dr[t]=new va(t,2,!1,t,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Dr[t]=new va(t,3,!1,t.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(t){Dr[t]=new va(t,3,!0,t,null,!1,!1)}),["capture","download"].forEach(function(t){Dr[t]=new va(t,4,!1,t,null,!1,!1)}),["cols","rows","size","span"].forEach(function(t){Dr[t]=new va(t,6,!1,t,null,!1,!1)}),["rowSpan","start"].forEach(function(t){Dr[t]=new va(t,5,!1,t.toLowerCase(),null,!1,!1)});var Ck=/[\-:]([a-z])/g;function Nk(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Ck,Nk);Dr[e]=new va(e,1,!1,t,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Ck,Nk);Dr[e]=new va(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Ck,Nk);Dr[e]=new va(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(t){Dr[t]=new va(t,1,!1,t.toLowerCase(),null,!1,!1)}),Dr.xlinkHref=new va("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(t){Dr[t]=new va(t,1,!1,t.toLowerCase(),null,!0,!0)});function Tk(t,e,n,r){var a=Dr.hasOwnProperty(e)?Dr[e]:null;(a!==null?a.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(BU(e,n,a,r)&&(n=null),r||a===null?LU(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):a.mustUseProperty?t[a.propertyName]=n===null?a.type===3?!1:"":n:(e=a.attributeName,r=a.attributeNamespace,n===null?t.removeAttribute(e):(a=a.type,n=a===3||a===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var ns=sO.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,P0=Symbol.for("react.element"),Hc=Symbol.for("react.portal"),qc=Symbol.for("react.fragment"),Ik=Symbol.for("react.strict_mode"),Ek=Symbol.for("react.profiler"),dO=Symbol.for("react.provider"),pO=Symbol.for("react.context"),_k=Symbol.for("react.forward_ref"),Ok=Symbol.for("react.suspense"),$k=Symbol.for("react.suspense_list"),Rk=Symbol.for("react.memo"),Ys=Symbol.for("react.lazy"),hO=Symbol.for("react.offscreen"),fO=Symbol.iterator;function ch(t){return t===null||typeof t!="object"?null:(t=fO&&t[fO]||t["@@iterator"],typeof t=="function"?t:null)}var Rn=Object.assign,Mk;function dh(t){if(Mk===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Mk=e&&e[1]||""}return`
`+Mk+t}var Ak=!1;function Pk(t,e){if(!t||Ak)return"";Ak=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var a=u.stack.split(`
`),i=r.stack.split(`
`),o=a.length-1,s=i.length-1;1<=o&&0<=s&&a[o]!==i[s];)s--;for(;1<=o&&0<=s;o--,s--)if(a[o]!==i[s]){if(o!==1||s!==1)do if(o--,s--,0>s||a[o]!==i[s]){var l=`
`+a[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=s);break}}}finally{Ak=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?dh(t):""}function zU(t){switch(t.tag){case 5:return dh(t.type);case 16:return dh("Lazy");case 13:return dh("Suspense");case 19:return dh("SuspenseList");case 0:case 2:case 15:return t=Pk(t.type,!1),t;case 11:return t=Pk(t.type.render,!1),t;case 1:return t=Pk(t.type,!0),t;default:return""}}function Dk(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case qc:return"Fragment";case Hc:return"Portal";case Ek:return"Profiler";case Ik:return"StrictMode";case Ok:return"Suspense";case $k:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case pO:return(t.displayName||"Context")+".Consumer";case dO:return(t._context.displayName||"Context")+".Provider";case _k:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Rk:return e=t.displayName||null,e!==null?e:Dk(t.type)||"Memo";case Ys:e=t._payload,t=t._init;try{return Dk(t(e))}catch{}}return null}function VU(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Dk(e);case 8:return e===Ik?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Qs(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function mO(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function WU(t){var e=mO(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var a=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return a.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function D0(t){t._valueTracker||(t._valueTracker=WU(t))}function gO(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=mO(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function L0(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Lk(t,e){var n=e.checked;return Rn({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function yO(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Qs(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function bO(t,e){e=e.checked,e!=null&&Tk(t,"checked",e,!1)}function Fk(t,e){bO(t,e);var n=Qs(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Bk(t,e.type,n):e.hasOwnProperty("defaultValue")&&Bk(t,e.type,Qs(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function vO(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Bk(t,e,n){(e!=="number"||L0(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var ph=Array.isArray;function Kc(t,e,n,r){if(t=t.options,e){e={};for(var a=0;a<n.length;a++)e["$"+n[a]]=!0;for(n=0;n<t.length;n++)a=e.hasOwnProperty("$"+t[n].value),t[n].selected!==a&&(t[n].selected=a),a&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Qs(n),e=null,a=0;a<t.length;a++){if(t[a].value===n){t[a].selected=!0,r&&(t[a].defaultSelected=!0);return}e!==null||t[a].disabled||(e=t[a])}e!==null&&(e.selected=!0)}}function zk(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Se(91));return Rn({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function xO(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(Se(92));if(ph(n)){if(1<n.length)throw Error(Se(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Qs(n)}}function wO(t,e){var n=Qs(e.value),r=Qs(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function kO(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function SO(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Vk(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?SO(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var F0,CO=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,a){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,a)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(F0=F0||document.createElement("div"),F0.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=F0.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function hh(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var fh={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},jU=["Webkit","ms","Moz","O"];Object.keys(fh).forEach(function(t){jU.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),fh[e]=fh[t]})});function NO(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||fh.hasOwnProperty(t)&&fh[t]?(""+e).trim():e+"px"}function TO(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,a=NO(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,a):t[n]=a}}var UU=Rn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Wk(t,e){if(e){if(UU[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Se(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Se(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Se(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Se(62))}}function jk(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Uk=null;function Gk(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Hk=null,Xc=null,Yc=null;function IO(t){if(t=Dh(t)){if(typeof Hk!="function")throw Error(Se(280));var e=t.stateNode;e&&(e=s1(e),Hk(t.stateNode,t.type,e))}}function EO(t){Xc?Yc?Yc.push(t):Yc=[t]:Xc=t}function _O(){if(Xc){var t=Xc,e=Yc;if(Yc=Xc=null,IO(t),e)for(t=0;t<e.length;t++)IO(e[t])}}function OO(t,e){return t(e)}function $O(){}var qk=!1;function RO(t,e,n){if(qk)return t(e,n);qk=!0;try{return OO(t,e,n)}finally{qk=!1,(Xc!==null||Yc!==null)&&($O(),_O())}}function mh(t,e){var n=t.stateNode;if(n===null)return null;var r=s1(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(Se(231,e,typeof n));return n}var Kk=!1;if(ts)try{var gh={};Object.defineProperty(gh,"passive",{get:function(){Kk=!0}}),window.addEventListener("test",gh,gh),window.removeEventListener("test",gh,gh)}catch{Kk=!1}function GU(t,e,n,r,a,i,o,s,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(c){this.onError(c)}}var yh=!1,B0=null,z0=!1,Xk=null,HU={onError:function(t){yh=!0,B0=t}};function qU(t,e,n,r,a,i,o,s,l){yh=!1,B0=null,GU.apply(HU,arguments)}function KU(t,e,n,r,a,i,o,s,l){if(qU.apply(this,arguments),yh){if(yh){var u=B0;yh=!1,B0=null}else throw Error(Se(198));z0||(z0=!0,Xk=u)}}function mu(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function MO(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function AO(t){if(mu(t)!==t)throw Error(Se(188))}function XU(t){var e=t.alternate;if(!e){if(e=mu(t),e===null)throw Error(Se(188));return e!==t?null:t}for(var n=t,r=e;;){var a=n.return;if(a===null)break;var i=a.alternate;if(i===null){if(r=a.return,r!==null){n=r;continue}break}if(a.child===i.child){for(i=a.child;i;){if(i===n)return AO(a),t;if(i===r)return AO(a),e;i=i.sibling}throw Error(Se(188))}if(n.return!==r.return)n=a,r=i;else{for(var o=!1,s=a.child;s;){if(s===n){o=!0,n=a,r=i;break}if(s===r){o=!0,r=a,n=i;break}s=s.sibling}if(!o){for(s=i.child;s;){if(s===n){o=!0,n=i,r=a;break}if(s===r){o=!0,r=i,n=a;break}s=s.sibling}if(!o)throw Error(Se(189))}}if(n.alternate!==r)throw Error(Se(190))}if(n.tag!==3)throw Error(Se(188));return n.stateNode.current===n?t:e}function PO(t){return t=XU(t),t!==null?DO(t):null}function DO(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=DO(t);if(e!==null)return e;t=t.sibling}return null}var LO=Xa.unstable_scheduleCallback,FO=Xa.unstable_cancelCallback,YU=Xa.unstable_shouldYield,QU=Xa.unstable_requestPaint,qn=Xa.unstable_now,ZU=Xa.unstable_getCurrentPriorityLevel,Yk=Xa.unstable_ImmediatePriority,BO=Xa.unstable_UserBlockingPriority,V0=Xa.unstable_NormalPriority,JU=Xa.unstable_LowPriority,zO=Xa.unstable_IdlePriority,W0=null,So=null;function eG(t){if(So&&typeof So.onCommitFiberRoot=="function")try{So.onCommitFiberRoot(W0,t,void 0,(t.current.flags&128)===128)}catch{}}var qi=Math.clz32?Math.clz32:rG,tG=Math.log,nG=Math.LN2;function rG(t){return t>>>=0,t===0?32:31-(tG(t)/nG|0)|0}var j0=64,U0=4194304;function bh(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function G0(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,a=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var s=o&~a;s!==0?r=bh(s):(i&=o,i!==0&&(r=bh(i)))}else o=n&~a,o!==0?r=bh(o):i!==0&&(r=bh(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&a)&&(a=r&-r,i=e&-e,a>=i||a===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-qi(e),a=1<<n,r|=t[n],e&=~a;return r}function aG(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function iG(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,a=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-qi(i),s=1<<o,l=a[o];l===-1?(!(s&n)||s&r)&&(a[o]=aG(s,e)):l<=e&&(t.expiredLanes|=s),i&=~s}}function Qk(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function VO(){var t=j0;return j0<<=1,!(j0&4194240)&&(j0=64),t}function Zk(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function vh(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-qi(e),t[e]=n}function oG(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var a=31-qi(n),i=1<<a;e[a]=0,r[a]=-1,t[a]=-1,n&=~i}}function Jk(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-qi(n),a=1<<r;a&e|t[r]&e&&(t[r]|=e),n&=~a}}var Zt=0;function WO(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var jO,eS,UO,GO,HO,tS=!1,H0=[],Zs=null,Js=null,el=null,xh=new Map,wh=new Map,tl=[],sG="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function qO(t,e){switch(t){case"focusin":case"focusout":Zs=null;break;case"dragenter":case"dragleave":Js=null;break;case"mouseover":case"mouseout":el=null;break;case"pointerover":case"pointerout":xh.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":wh.delete(e.pointerId)}}function kh(t,e,n,r,a,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[a]},e!==null&&(e=Dh(e),e!==null&&eS(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,a!==null&&e.indexOf(a)===-1&&e.push(a),t)}function lG(t,e,n,r,a){switch(e){case"focusin":return Zs=kh(Zs,t,e,n,r,a),!0;case"dragenter":return Js=kh(Js,t,e,n,r,a),!0;case"mouseover":return el=kh(el,t,e,n,r,a),!0;case"pointerover":var i=a.pointerId;return xh.set(i,kh(xh.get(i)||null,t,e,n,r,a)),!0;case"gotpointercapture":return i=a.pointerId,wh.set(i,kh(wh.get(i)||null,t,e,n,r,a)),!0}return!1}function KO(t){var e=gu(t.target);if(e!==null){var n=mu(e);if(n!==null){if(e=n.tag,e===13){if(e=MO(n),e!==null){t.blockedOn=e,HO(t.priority,function(){UO(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function q0(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=rS(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Uk=r,n.target.dispatchEvent(r),Uk=null}else return e=Dh(n),e!==null&&eS(e),t.blockedOn=n,!1;e.shift()}return!0}function XO(t,e,n){q0(t)&&n.delete(e)}function uG(){tS=!1,Zs!==null&&q0(Zs)&&(Zs=null),Js!==null&&q0(Js)&&(Js=null),el!==null&&q0(el)&&(el=null),xh.forEach(XO),wh.forEach(XO)}function Sh(t,e){t.blockedOn===e&&(t.blockedOn=null,tS||(tS=!0,Xa.unstable_scheduleCallback(Xa.unstable_NormalPriority,uG)))}function Ch(t){function e(a){return Sh(a,t)}if(0<H0.length){Sh(H0[0],t);for(var n=1;n<H0.length;n++){var r=H0[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Zs!==null&&Sh(Zs,t),Js!==null&&Sh(Js,t),el!==null&&Sh(el,t),xh.forEach(e),wh.forEach(e),n=0;n<tl.length;n++)r=tl[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<tl.length&&(n=tl[0],n.blockedOn===null);)KO(n),n.blockedOn===null&&tl.shift()}var Qc=ns.ReactCurrentBatchConfig,K0=!0;function cG(t,e,n,r){var a=Zt,i=Qc.transition;Qc.transition=null;try{Zt=1,nS(t,e,n,r)}finally{Zt=a,Qc.transition=i}}function dG(t,e,n,r){var a=Zt,i=Qc.transition;Qc.transition=null;try{Zt=4,nS(t,e,n,r)}finally{Zt=a,Qc.transition=i}}function nS(t,e,n,r){if(K0){var a=rS(t,e,n,r);if(a===null)xS(t,e,r,X0,n),qO(t,r);else if(lG(a,t,e,n,r))r.stopPropagation();else if(qO(t,r),e&4&&-1<sG.indexOf(t)){for(;a!==null;){var i=Dh(a);if(i!==null&&jO(i),i=rS(t,e,n,r),i===null&&xS(t,e,r,X0,n),i===a)break;a=i}a!==null&&r.stopPropagation()}else xS(t,e,r,null,n)}}var X0=null;function rS(t,e,n,r){if(X0=null,t=Gk(r),t=gu(t),t!==null)if(e=mu(t),e===null)t=null;else if(n=e.tag,n===13){if(t=MO(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return X0=t,null}function YO(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ZU()){case Yk:return 1;case BO:return 4;case V0:case JU:return 16;case zO:return 536870912;default:return 16}default:return 16}}var nl=null,aS=null,Y0=null;function QO(){if(Y0)return Y0;var t,e=aS,n=e.length,r,a="value"in nl?nl.value:nl.textContent,i=a.length;for(t=0;t<n&&e[t]===a[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===a[i-r];r++);return Y0=a.slice(t,1<r?1-r:void 0)}function Q0(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Z0(){return!0}function ZO(){return!1}function Ya(t){function e(n,r,a,i,o){this._reactName=n,this._targetInst=a,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var s in t)t.hasOwnProperty(s)&&(n=t[s],this[s]=n?n(i):i[s]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Z0:ZO,this.isPropagationStopped=ZO,this}return Rn(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Z0)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Z0)},persist:function(){},isPersistent:Z0}),e}var Zc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},iS=Ya(Zc),Nh=Rn({},Zc,{view:0,detail:0}),pG=Ya(Nh),oS,sS,Th,J0=Rn({},Nh,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:uS,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Th&&(Th&&t.type==="mousemove"?(oS=t.screenX-Th.screenX,sS=t.screenY-Th.screenY):sS=oS=0,Th=t),oS)},movementY:function(t){return"movementY"in t?t.movementY:sS}}),JO=Ya(J0),hG=Rn({},J0,{dataTransfer:0}),fG=Ya(hG),mG=Rn({},Nh,{relatedTarget:0}),lS=Ya(mG),gG=Rn({},Zc,{animationName:0,elapsedTime:0,pseudoElement:0}),yG=Ya(gG),bG=Rn({},Zc,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),vG=Ya(bG),xG=Rn({},Zc,{data:0}),e$=Ya(xG),wG={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},kG={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},SG={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function CG(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=SG[t])?!!e[t]:!1}function uS(){return CG}var NG=Rn({},Nh,{key:function(t){if(t.key){var e=wG[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Q0(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?kG[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:uS,charCode:function(t){return t.type==="keypress"?Q0(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Q0(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),TG=Ya(NG),IG=Rn({},J0,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),t$=Ya(IG),EG=Rn({},Nh,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:uS}),_G=Ya(EG),OG=Rn({},Zc,{propertyName:0,elapsedTime:0,pseudoElement:0}),$G=Ya(OG),RG=Rn({},J0,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),MG=Ya(RG),AG=[9,13,27,32],cS=ts&&"CompositionEvent"in window,Ih=null;ts&&"documentMode"in document&&(Ih=document.documentMode);var PG=ts&&"TextEvent"in window&&!Ih,n$=ts&&(!cS||Ih&&8<Ih&&11>=Ih),r$=" ",a$=!1;function i$(t,e){switch(t){case"keyup":return AG.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function o$(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Jc=!1;function DG(t,e){switch(t){case"compositionend":return o$(e);case"keypress":return e.which!==32?null:(a$=!0,r$);case"textInput":return t=e.data,t===r$&&a$?null:t;default:return null}}function LG(t,e){if(Jc)return t==="compositionend"||!cS&&i$(t,e)?(t=QO(),Y0=aS=nl=null,Jc=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return n$&&e.locale!=="ko"?null:e.data;default:return null}}var FG={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function s$(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!FG[t.type]:e==="textarea"}function l$(t,e,n,r){EO(r),e=a1(e,"onChange"),0<e.length&&(n=new iS("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Eh=null,_h=null;function BG(t){T$(t,0)}function e1(t){var e=ad(t);if(gO(e))return t}function zG(t,e){if(t==="change")return e}var u$=!1;if(ts){var dS;if(ts){var pS="oninput"in document;if(!pS){var c$=document.createElement("div");c$.setAttribute("oninput","return;"),pS=typeof c$.oninput=="function"}dS=pS}else dS=!1;u$=dS&&(!document.documentMode||9<document.documentMode)}function d$(){Eh&&(Eh.detachEvent("onpropertychange",p$),_h=Eh=null)}function p$(t){if(t.propertyName==="value"&&e1(_h)){var e=[];l$(e,_h,t,Gk(t)),RO(BG,e)}}function VG(t,e,n){t==="focusin"?(d$(),Eh=e,_h=n,Eh.attachEvent("onpropertychange",p$)):t==="focusout"&&d$()}function WG(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return e1(_h)}function jG(t,e){if(t==="click")return e1(e)}function UG(t,e){if(t==="input"||t==="change")return e1(e)}function GG(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Ki=typeof Object.is=="function"?Object.is:GG;function Oh(t,e){if(Ki(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var a=n[r];if(!Sk.call(e,a)||!Ki(t[a],e[a]))return!1}return!0}function h$(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function f$(t,e){var n=h$(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=h$(n)}}function m$(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?m$(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function g$(){for(var t=window,e=L0();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=L0(t.document)}return e}function hS(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function HG(t){var e=g$(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&m$(n.ownerDocument.documentElement,n)){if(r!==null&&hS(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var a=n.textContent.length,i=Math.min(r.start,a);r=r.end===void 0?i:Math.min(r.end,a),!t.extend&&i>r&&(a=r,r=i,i=a),a=f$(n,i);var o=f$(n,r);a&&o&&(t.rangeCount!==1||t.anchorNode!==a.node||t.anchorOffset!==a.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(a.node,a.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var qG=ts&&"documentMode"in document&&11>=document.documentMode,ed=null,fS=null,$h=null,mS=!1;function y$(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;mS||ed==null||ed!==L0(r)||(r=ed,"selectionStart"in r&&hS(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),$h&&Oh($h,r)||($h=r,r=a1(fS,"onSelect"),0<r.length&&(e=new iS("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=ed)))}function t1(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var td={animationend:t1("Animation","AnimationEnd"),animationiteration:t1("Animation","AnimationIteration"),animationstart:t1("Animation","AnimationStart"),transitionend:t1("Transition","TransitionEnd")},gS={},b$={};ts&&(b$=document.createElement("div").style,"AnimationEvent"in window||(delete td.animationend.animation,delete td.animationiteration.animation,delete td.animationstart.animation),"TransitionEvent"in window||delete td.transitionend.transition);function n1(t){if(gS[t])return gS[t];if(!td[t])return t;var e=td[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in b$)return gS[t]=e[n];return t}var v$=n1("animationend"),x$=n1("animationiteration"),w$=n1("animationstart"),k$=n1("transitionend"),S$=new Map,C$="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function rl(t,e){S$.set(t,e),fu(e,[t])}for(var yS=0;yS<C$.length;yS++){var bS=C$[yS],KG=bS.toLowerCase(),XG=bS[0].toUpperCase()+bS.slice(1);rl(KG,"on"+XG)}rl(v$,"onAnimationEnd"),rl(x$,"onAnimationIteration"),rl(w$,"onAnimationStart"),rl("dblclick","onDoubleClick"),rl("focusin","onFocus"),rl("focusout","onBlur"),rl(k$,"onTransitionEnd"),Gc("onMouseEnter",["mouseout","mouseover"]),Gc("onMouseLeave",["mouseout","mouseover"]),Gc("onPointerEnter",["pointerout","pointerover"]),Gc("onPointerLeave",["pointerout","pointerover"]),fu("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),fu("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),fu("onBeforeInput",["compositionend","keypress","textInput","paste"]),fu("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),fu("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),fu("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Rh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),YG=new Set("cancel close invalid load scroll toggle".split(" ").concat(Rh));function N$(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,KU(r,e,void 0,t),t.currentTarget=null}function T$(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],a=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var s=r[o],l=s.instance,u=s.currentTarget;if(s=s.listener,l!==i&&a.isPropagationStopped())break e;N$(a,s,u),i=l}else for(o=0;o<r.length;o++){if(s=r[o],l=s.instance,u=s.currentTarget,s=s.listener,l!==i&&a.isPropagationStopped())break e;N$(a,s,u),i=l}}}if(z0)throw t=Xk,z0=!1,Xk=null,t}function vn(t,e){var n=e[TS];n===void 0&&(n=e[TS]=new Set);var r=t+"__bubble";n.has(r)||(I$(e,t,2,!1),n.add(r))}function vS(t,e,n){var r=0;e&&(r|=4),I$(n,t,r,e)}var r1="_reactListening"+Math.random().toString(36).slice(2);function Mh(t){if(!t[r1]){t[r1]=!0,lO.forEach(function(n){n!=="selectionchange"&&(YG.has(n)||vS(n,!1,t),vS(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[r1]||(e[r1]=!0,vS("selectionchange",!1,e))}}function I$(t,e,n,r){switch(YO(e)){case 1:var a=cG;break;case 4:a=dG;break;default:a=nS}n=a.bind(null,e,n,t),a=void 0,!Kk||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(a=!0),r?a!==void 0?t.addEventListener(e,n,{capture:!0,passive:a}):t.addEventListener(e,n,!0):a!==void 0?t.addEventListener(e,n,{passive:a}):t.addEventListener(e,n,!1)}function xS(t,e,n,r,a){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var s=r.stateNode.containerInfo;if(s===a||s.nodeType===8&&s.parentNode===a)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===a||l.nodeType===8&&l.parentNode===a))return;o=o.return}for(;s!==null;){if(o=gu(s),o===null)return;if(l=o.tag,l===5||l===6){r=i=o;continue e}s=s.parentNode}}r=r.return}RO(function(){var u=i,c=Gk(n),d=[];e:{var p=S$.get(t);if(p!==void 0){var f=iS,g=t;switch(t){case"keypress":if(Q0(n)===0)break e;case"keydown":case"keyup":f=TG;break;case"focusin":g="focus",f=lS;break;case"focusout":g="blur",f=lS;break;case"beforeblur":case"afterblur":f=lS;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=JO;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=fG;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=_G;break;case v$:case x$:case w$:f=yG;break;case k$:f=$G;break;case"scroll":f=pG;break;case"wheel":f=MG;break;case"copy":case"cut":case"paste":f=vG;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=t$}var y=(e&4)!==0,x=!y&&t==="scroll",b=y?p!==null?p+"Capture":null:p;y=[];for(var v=u,w;v!==null;){w=v;var S=w.stateNode;if(w.tag===5&&S!==null&&(w=S,b!==null&&(S=mh(v,b),S!=null&&y.push(Ah(v,S,w)))),x)break;v=v.return}0<y.length&&(p=new f(p,g,null,n,c),d.push({event:p,listeners:y}))}}if(!(e&7)){e:{if(p=t==="mouseover"||t==="pointerover",f=t==="mouseout"||t==="pointerout",p&&n!==Uk&&(g=n.relatedTarget||n.fromElement)&&(gu(g)||g[rs]))break e;if((f||p)&&(p=c.window===c?c:(p=c.ownerDocument)?p.defaultView||p.parentWindow:window,f?(g=n.relatedTarget||n.toElement,f=u,g=g?gu(g):null,g!==null&&(x=mu(g),g!==x||g.tag!==5&&g.tag!==6)&&(g=null)):(f=null,g=u),f!==g)){if(y=JO,S="onMouseLeave",b="onMouseEnter",v="mouse",(t==="pointerout"||t==="pointerover")&&(y=t$,S="onPointerLeave",b="onPointerEnter",v="pointer"),x=f==null?p:ad(f),w=g==null?p:ad(g),p=new y(S,v+"leave",f,n,c),p.target=x,p.relatedTarget=w,S=null,gu(c)===u&&(y=new y(b,v+"enter",g,n,c),y.target=w,y.relatedTarget=x,S=y),x=S,f&&g)t:{for(y=f,b=g,v=0,w=y;w;w=nd(w))v++;for(w=0,S=b;S;S=nd(S))w++;for(;0<v-w;)y=nd(y),v--;for(;0<w-v;)b=nd(b),w--;for(;v--;){if(y===b||b!==null&&y===b.alternate)break t;y=nd(y),b=nd(b)}y=null}else y=null;f!==null&&E$(d,p,f,y,!1),g!==null&&x!==null&&E$(d,x,g,y,!0)}}e:{if(p=u?ad(u):window,f=p.nodeName&&p.nodeName.toLowerCase(),f==="select"||f==="input"&&p.type==="file")var C=zG;else if(s$(p))if(u$)C=UG;else{C=WG;var I=VG}else(f=p.nodeName)&&f.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(C=jG);if(C&&(C=C(t,u))){l$(d,C,n,c);break e}I&&I(t,p,u),t==="focusout"&&(I=p._wrapperState)&&I.controlled&&p.type==="number"&&Bk(p,"number",p.value)}switch(I=u?ad(u):window,t){case"focusin":(s$(I)||I.contentEditable==="true")&&(ed=I,fS=u,$h=null);break;case"focusout":$h=fS=ed=null;break;case"mousedown":mS=!0;break;case"contextmenu":case"mouseup":case"dragend":mS=!1,y$(d,n,c);break;case"selectionchange":if(qG)break;case"keydown":case"keyup":y$(d,n,c)}var _;if(cS)e:{switch(t){case"compositionstart":var E="onCompositionStart";break e;case"compositionend":E="onCompositionEnd";break e;case"compositionupdate":E="onCompositionUpdate";break e}E=void 0}else Jc?i$(t,n)&&(E="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(E="onCompositionStart");E&&(n$&&n.locale!=="ko"&&(Jc||E!=="onCompositionStart"?E==="onCompositionEnd"&&Jc&&(_=QO()):(nl=c,aS="value"in nl?nl.value:nl.textContent,Jc=!0)),I=a1(u,E),0<I.length&&(E=new e$(E,t,null,n,c),d.push({event:E,listeners:I}),_?E.data=_:(_=o$(n),_!==null&&(E.data=_)))),(_=PG?DG(t,n):LG(t,n))&&(u=a1(u,"onBeforeInput"),0<u.length&&(c=new e$("onBeforeInput","beforeinput",null,n,c),d.push({event:c,listeners:u}),c.data=_))}T$(d,e)})}function Ah(t,e,n){return{instance:t,listener:e,currentTarget:n}}function a1(t,e){for(var n=e+"Capture",r=[];t!==null;){var a=t,i=a.stateNode;a.tag===5&&i!==null&&(a=i,i=mh(t,n),i!=null&&r.unshift(Ah(t,i,a)),i=mh(t,e),i!=null&&r.push(Ah(t,i,a))),t=t.return}return r}function nd(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function E$(t,e,n,r,a){for(var i=e._reactName,o=[];n!==null&&n!==r;){var s=n,l=s.alternate,u=s.stateNode;if(l!==null&&l===r)break;s.tag===5&&u!==null&&(s=u,a?(l=mh(n,i),l!=null&&o.unshift(Ah(n,l,s))):a||(l=mh(n,i),l!=null&&o.push(Ah(n,l,s)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var QG=/\r\n?/g,ZG=/\u0000|\uFFFD/g;function _$(t){return(typeof t=="string"?t:""+t).replace(QG,`
`).replace(ZG,"")}function i1(t,e,n){if(e=_$(e),_$(t)!==e&&n)throw Error(Se(425))}function o1(){}var wS=null,kS=null;function SS(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var CS=typeof setTimeout=="function"?setTimeout:void 0,JG=typeof clearTimeout=="function"?clearTimeout:void 0,O$=typeof Promise=="function"?Promise:void 0,eH=typeof queueMicrotask=="function"?queueMicrotask:typeof O$<"u"?function(t){return O$.resolve(null).then(t).catch(tH)}:CS;function tH(t){setTimeout(function(){throw t})}function NS(t,e){var n=e,r=0;do{var a=n.nextSibling;if(t.removeChild(n),a&&a.nodeType===8)if(n=a.data,n==="/$"){if(r===0){t.removeChild(a),Ch(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=a}while(n);Ch(e)}function al(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function $$(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var rd=Math.random().toString(36).slice(2),Co="__reactFiber$"+rd,Ph="__reactProps$"+rd,rs="__reactContainer$"+rd,TS="__reactEvents$"+rd,nH="__reactListeners$"+rd,rH="__reactHandles$"+rd;function gu(t){var e=t[Co];if(e)return e;for(var n=t.parentNode;n;){if(e=n[rs]||n[Co]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=$$(t);t!==null;){if(n=t[Co])return n;t=$$(t)}return e}t=n,n=t.parentNode}return null}function Dh(t){return t=t[Co]||t[rs],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function ad(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Se(33))}function s1(t){return t[Ph]||null}var IS=[],id=-1;function il(t){return{current:t}}function xn(t){0>id||(t.current=IS[id],IS[id]=null,id--)}function fn(t,e){id++,IS[id]=t.current,t.current=e}var ol={},ea=il(ol),$a=il(!1),yu=ol;function od(t,e){var n=t.type.contextTypes;if(!n)return ol;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var a={},i;for(i in n)a[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=a),a}function Ra(t){return t=t.childContextTypes,t!=null}function l1(){xn($a),xn(ea)}function R$(t,e,n){if(ea.current!==ol)throw Error(Se(168));fn(ea,e),fn($a,n)}function M$(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var a in r)if(!(a in e))throw Error(Se(108,VU(t)||"Unknown",a));return Rn({},n,r)}function u1(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||ol,yu=ea.current,fn(ea,t),fn($a,$a.current),!0}function A$(t,e,n){var r=t.stateNode;if(!r)throw Error(Se(169));n?(t=M$(t,e,yu),r.__reactInternalMemoizedMergedChildContext=t,xn($a),xn(ea),fn(ea,t)):xn($a),fn($a,n)}var as=null,c1=!1,ES=!1;function P$(t){as===null?as=[t]:as.push(t)}function aH(t){c1=!0,P$(t)}function sl(){if(!ES&&as!==null){ES=!0;var t=0,e=Zt;try{var n=as;for(Zt=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}as=null,c1=!1}catch(a){throw as!==null&&(as=as.slice(t+1)),LO(Yk,sl),a}finally{Zt=e,ES=!1}}return null}var sd=[],ld=0,d1=null,p1=0,gi=[],yi=0,bu=null,is=1,os="";function vu(t,e){sd[ld++]=p1,sd[ld++]=d1,d1=t,p1=e}function D$(t,e,n){gi[yi++]=is,gi[yi++]=os,gi[yi++]=bu,bu=t;var r=is;t=os;var a=32-qi(r)-1;r&=~(1<<a),n+=1;var i=32-qi(e)+a;if(30<i){var o=a-a%5;i=(r&(1<<o)-1).toString(32),r>>=o,a-=o,is=1<<32-qi(e)+a|n<<a|r,os=i+t}else is=1<<i|n<<a|r,os=t}function _S(t){t.return!==null&&(vu(t,1),D$(t,1,0))}function OS(t){for(;t===d1;)d1=sd[--ld],sd[ld]=null,p1=sd[--ld],sd[ld]=null;for(;t===bu;)bu=gi[--yi],gi[yi]=null,os=gi[--yi],gi[yi]=null,is=gi[--yi],gi[yi]=null}var Qa=null,Za=null,Nn=!1,Xi=null;function L$(t,e){var n=wi(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function F$(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Qa=t,Za=al(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Qa=t,Za=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=bu!==null?{id:is,overflow:os}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=wi(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Qa=t,Za=null,!0):!1;default:return!1}}function $S(t){return(t.mode&1)!==0&&(t.flags&128)===0}function RS(t){if(Nn){var e=Za;if(e){var n=e;if(!F$(t,e)){if($S(t))throw Error(Se(418));e=al(n.nextSibling);var r=Qa;e&&F$(t,e)?L$(r,n):(t.flags=t.flags&-4097|2,Nn=!1,Qa=t)}}else{if($S(t))throw Error(Se(418));t.flags=t.flags&-4097|2,Nn=!1,Qa=t}}}function B$(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Qa=t}function h1(t){if(t!==Qa)return!1;if(!Nn)return B$(t),Nn=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!SS(t.type,t.memoizedProps)),e&&(e=Za)){if($S(t))throw z$(),Error(Se(418));for(;e;)L$(t,e),e=al(e.nextSibling)}if(B$(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Se(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Za=al(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Za=null}}else Za=Qa?al(t.stateNode.nextSibling):null;return!0}function z$(){for(var t=Za;t;)t=al(t.nextSibling)}function ud(){Za=Qa=null,Nn=!1}function MS(t){Xi===null?Xi=[t]:Xi.push(t)}var iH=ns.ReactCurrentBatchConfig;function Yi(t,e){if(t&&t.defaultProps){e=Rn({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var f1=il(null),m1=null,cd=null,AS=null;function PS(){AS=cd=m1=null}function DS(t){var e=f1.current;xn(f1),t._currentValue=e}function LS(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function dd(t,e){m1=t,AS=cd=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Ma=!0),t.firstContext=null)}function bi(t){var e=t._currentValue;if(AS!==t)if(t={context:t,memoizedValue:e,next:null},cd===null){if(m1===null)throw Error(Se(308));cd=t,m1.dependencies={lanes:0,firstContext:t}}else cd=cd.next=t;return e}var xu=null;function FS(t){xu===null?xu=[t]:xu.push(t)}function V$(t,e,n,r){var a=e.interleaved;return a===null?(n.next=n,FS(e)):(n.next=a.next,a.next=n),e.interleaved=n,ss(t,r)}function ss(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var ll=!1;function BS(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function W$(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function ls(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function ul(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Dt&2){var a=r.pending;return a===null?e.next=e:(e.next=a.next,a.next=e),r.pending=e,ss(t,n)}return a=r.interleaved,a===null?(e.next=e,FS(r)):(e.next=a.next,a.next=e),r.interleaved=e,ss(t,n)}function g1(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Jk(t,n)}}function j$(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var a=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?a=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?a=i=e:i=i.next=e}else a=i=e;n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function y1(t,e,n,r){var a=t.updateQueue;ll=!1;var i=a.firstBaseUpdate,o=a.lastBaseUpdate,s=a.shared.pending;if(s!==null){a.shared.pending=null;var l=s,u=l.next;l.next=null,o===null?i=u:o.next=u,o=l;var c=t.alternate;c!==null&&(c=c.updateQueue,s=c.lastBaseUpdate,s!==o&&(s===null?c.firstBaseUpdate=u:s.next=u,c.lastBaseUpdate=l))}if(i!==null){var d=a.baseState;o=0,c=u=l=null,s=i;do{var p=s.lane,f=s.eventTime;if((r&p)===p){c!==null&&(c=c.next={eventTime:f,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var g=t,y=s;switch(p=e,f=n,y.tag){case 1:if(g=y.payload,typeof g=="function"){d=g.call(f,d,p);break e}d=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=y.payload,p=typeof g=="function"?g.call(f,d,p):g,p==null)break e;d=Rn({},d,p);break e;case 2:ll=!0}}s.callback!==null&&s.lane!==0&&(t.flags|=64,p=a.effects,p===null?a.effects=[s]:p.push(s))}else f={eventTime:f,lane:p,tag:s.tag,payload:s.payload,callback:s.callback,next:null},c===null?(u=c=f,l=d):c=c.next=f,o|=p;if(s=s.next,s===null){if(s=a.shared.pending,s===null)break;p=s,s=p.next,p.next=null,a.lastBaseUpdate=p,a.shared.pending=null}}while(!0);if(c===null&&(l=d),a.baseState=l,a.firstBaseUpdate=u,a.lastBaseUpdate=c,e=a.shared.interleaved,e!==null){a=e;do o|=a.lane,a=a.next;while(a!==e)}else i===null&&(a.shared.lanes=0);Su|=o,t.lanes=o,t.memoizedState=d}}function U$(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],a=r.callback;if(a!==null){if(r.callback=null,r=n,typeof a!="function")throw Error(Se(191,a));a.call(r)}}}var G$=new sO.Component().refs;function zS(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Rn({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var b1={isMounted:function(t){return(t=t._reactInternals)?mu(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=wa(),a=hl(t),i=ls(r,a);i.payload=e,n!=null&&(i.callback=n),e=ul(t,i,a),e!==null&&(Ji(e,t,a,r),g1(e,t,a))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=wa(),a=hl(t),i=ls(r,a);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=ul(t,i,a),e!==null&&(Ji(e,t,a,r),g1(e,t,a))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=wa(),r=hl(t),a=ls(n,r);a.tag=2,e!=null&&(a.callback=e),e=ul(t,a,r),e!==null&&(Ji(e,t,r,n),g1(e,t,r))}};function H$(t,e,n,r,a,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!Oh(n,r)||!Oh(a,i):!0}function q$(t,e,n){var r=!1,a=ol,i=e.contextType;return typeof i=="object"&&i!==null?i=bi(i):(a=Ra(e)?yu:ea.current,r=e.contextTypes,i=(r=r!=null)?od(t,a):ol),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=b1,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=a,t.__reactInternalMemoizedMaskedChildContext=i),e}function K$(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&b1.enqueueReplaceState(e,e.state,null)}function VS(t,e,n,r){var a=t.stateNode;a.props=n,a.state=t.memoizedState,a.refs=G$,BS(t);var i=e.contextType;typeof i=="object"&&i!==null?a.context=bi(i):(i=Ra(e)?yu:ea.current,a.context=od(t,i)),a.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(zS(t,e,i,n),a.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(e=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),e!==a.state&&b1.enqueueReplaceState(a,a.state,null),y1(t,n,a,r),a.state=t.memoizedState),typeof a.componentDidMount=="function"&&(t.flags|=4194308)}function Lh(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Se(309));var r=n.stateNode}if(!r)throw Error(Se(147,t));var a=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var s=a.refs;s===G$&&(s=a.refs={}),o===null?delete s[i]:s[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(Se(284));if(!n._owner)throw Error(Se(290,t))}return t}function v1(t,e){throw t=Object.prototype.toString.call(e),Error(Se(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function X$(t){var e=t._init;return e(t._payload)}function Y$(t){function e(b,v){if(t){var w=b.deletions;w===null?(b.deletions=[v],b.flags|=16):w.push(v)}}function n(b,v){if(!t)return null;for(;v!==null;)e(b,v),v=v.sibling;return null}function r(b,v){for(b=new Map;v!==null;)v.key!==null?b.set(v.key,v):b.set(v.index,v),v=v.sibling;return b}function a(b,v){return b=ml(b,v),b.index=0,b.sibling=null,b}function i(b,v,w){return b.index=w,t?(w=b.alternate,w!==null?(w=w.index,w<v?(b.flags|=2,v):w):(b.flags|=2,v)):(b.flags|=1048576,v)}function o(b){return t&&b.alternate===null&&(b.flags|=2),b}function s(b,v,w,S){return v===null||v.tag!==6?(v=SC(w,b.mode,S),v.return=b,v):(v=a(v,w),v.return=b,v)}function l(b,v,w,S){var C=w.type;return C===qc?c(b,v,w.props.children,S,w.key):v!==null&&(v.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===Ys&&X$(C)===v.type)?(S=a(v,w.props),S.ref=Lh(b,v,w),S.return=b,S):(S=F1(w.type,w.key,w.props,null,b.mode,S),S.ref=Lh(b,v,w),S.return=b,S)}function u(b,v,w,S){return v===null||v.tag!==4||v.stateNode.containerInfo!==w.containerInfo||v.stateNode.implementation!==w.implementation?(v=CC(w,b.mode,S),v.return=b,v):(v=a(v,w.children||[]),v.return=b,v)}function c(b,v,w,S,C){return v===null||v.tag!==7?(v=Iu(w,b.mode,S,C),v.return=b,v):(v=a(v,w),v.return=b,v)}function d(b,v,w){if(typeof v=="string"&&v!==""||typeof v=="number")return v=SC(""+v,b.mode,w),v.return=b,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case P0:return w=F1(v.type,v.key,v.props,null,b.mode,w),w.ref=Lh(b,null,v),w.return=b,w;case Hc:return v=CC(v,b.mode,w),v.return=b,v;case Ys:var S=v._init;return d(b,S(v._payload),w)}if(ph(v)||ch(v))return v=Iu(v,b.mode,w,null),v.return=b,v;v1(b,v)}return null}function p(b,v,w,S){var C=v!==null?v.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return C!==null?null:s(b,v,""+w,S);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case P0:return w.key===C?l(b,v,w,S):null;case Hc:return w.key===C?u(b,v,w,S):null;case Ys:return C=w._init,p(b,v,C(w._payload),S)}if(ph(w)||ch(w))return C!==null?null:c(b,v,w,S,null);v1(b,w)}return null}function f(b,v,w,S,C){if(typeof S=="string"&&S!==""||typeof S=="number")return b=b.get(w)||null,s(v,b,""+S,C);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case P0:return b=b.get(S.key===null?w:S.key)||null,l(v,b,S,C);case Hc:return b=b.get(S.key===null?w:S.key)||null,u(v,b,S,C);case Ys:var I=S._init;return f(b,v,w,I(S._payload),C)}if(ph(S)||ch(S))return b=b.get(w)||null,c(v,b,S,C,null);v1(v,S)}return null}function g(b,v,w,S){for(var C=null,I=null,_=v,E=v=0,A=null;_!==null&&E<w.length;E++){_.index>E?(A=_,_=null):A=_.sibling;var M=p(b,_,w[E],S);if(M===null){_===null&&(_=A);break}t&&_&&M.alternate===null&&e(b,_),v=i(M,v,E),I===null?C=M:I.sibling=M,I=M,_=A}if(E===w.length)return n(b,_),Nn&&vu(b,E),C;if(_===null){for(;E<w.length;E++)_=d(b,w[E],S),_!==null&&(v=i(_,v,E),I===null?C=_:I.sibling=_,I=_);return Nn&&vu(b,E),C}for(_=r(b,_);E<w.length;E++)A=f(_,b,E,w[E],S),A!==null&&(t&&A.alternate!==null&&_.delete(A.key===null?E:A.key),v=i(A,v,E),I===null?C=A:I.sibling=A,I=A);return t&&_.forEach(function(L){return e(b,L)}),Nn&&vu(b,E),C}function y(b,v,w,S){var C=ch(w);if(typeof C!="function")throw Error(Se(150));if(w=C.call(w),w==null)throw Error(Se(151));for(var I=C=null,_=v,E=v=0,A=null,M=w.next();_!==null&&!M.done;E++,M=w.next()){_.index>E?(A=_,_=null):A=_.sibling;var L=p(b,_,M.value,S);if(L===null){_===null&&(_=A);break}t&&_&&L.alternate===null&&e(b,_),v=i(L,v,E),I===null?C=L:I.sibling=L,I=L,_=A}if(M.done)return n(b,_),Nn&&vu(b,E),C;if(_===null){for(;!M.done;E++,M=w.next())M=d(b,M.value,S),M!==null&&(v=i(M,v,E),I===null?C=M:I.sibling=M,I=M);return Nn&&vu(b,E),C}for(_=r(b,_);!M.done;E++,M=w.next())M=f(_,b,E,M.value,S),M!==null&&(t&&M.alternate!==null&&_.delete(M.key===null?E:M.key),v=i(M,v,E),I===null?C=M:I.sibling=M,I=M);return t&&_.forEach(function(W){return e(b,W)}),Nn&&vu(b,E),C}function x(b,v,w,S){if(typeof w=="object"&&w!==null&&w.type===qc&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case P0:e:{for(var C=w.key,I=v;I!==null;){if(I.key===C){if(C=w.type,C===qc){if(I.tag===7){n(b,I.sibling),v=a(I,w.props.children),v.return=b,b=v;break e}}else if(I.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===Ys&&X$(C)===I.type){n(b,I.sibling),v=a(I,w.props),v.ref=Lh(b,I,w),v.return=b,b=v;break e}n(b,I);break}else e(b,I);I=I.sibling}w.type===qc?(v=Iu(w.props.children,b.mode,S,w.key),v.return=b,b=v):(S=F1(w.type,w.key,w.props,null,b.mode,S),S.ref=Lh(b,v,w),S.return=b,b=S)}return o(b);case Hc:e:{for(I=w.key;v!==null;){if(v.key===I)if(v.tag===4&&v.stateNode.containerInfo===w.containerInfo&&v.stateNode.implementation===w.implementation){n(b,v.sibling),v=a(v,w.children||[]),v.return=b,b=v;break e}else{n(b,v);break}else e(b,v);v=v.sibling}v=CC(w,b.mode,S),v.return=b,b=v}return o(b);case Ys:return I=w._init,x(b,v,I(w._payload),S)}if(ph(w))return g(b,v,w,S);if(ch(w))return y(b,v,w,S);v1(b,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,v!==null&&v.tag===6?(n(b,v.sibling),v=a(v,w),v.return=b,b=v):(n(b,v),v=SC(w,b.mode,S),v.return=b,b=v),o(b)):n(b,v)}return x}var pd=Y$(!0),Q$=Y$(!1),Fh={},No=il(Fh),Bh=il(Fh),zh=il(Fh);function wu(t){if(t===Fh)throw Error(Se(174));return t}function WS(t,e){switch(fn(zh,e),fn(Bh,t),fn(No,Fh),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Vk(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Vk(e,t)}xn(No),fn(No,e)}function hd(){xn(No),xn(Bh),xn(zh)}function Z$(t){wu(zh.current);var e=wu(No.current),n=Vk(e,t.type);e!==n&&(fn(Bh,t),fn(No,n))}function jS(t){Bh.current===t&&(xn(No),xn(Bh))}var Mn=il(0);function x1(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var US=[];function GS(){for(var t=0;t<US.length;t++)US[t]._workInProgressVersionPrimary=null;US.length=0}var w1=ns.ReactCurrentDispatcher,HS=ns.ReactCurrentBatchConfig,ku=0,An=null,sr=null,wr=null,k1=!1,Vh=!1,Wh=0,oH=0;function ta(){throw Error(Se(321))}function qS(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Ki(t[n],e[n]))return!1;return!0}function KS(t,e,n,r,a,i){if(ku=i,An=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,w1.current=t===null||t.memoizedState===null?cH:dH,t=n(r,a),Vh){i=0;do{if(Vh=!1,Wh=0,25<=i)throw Error(Se(301));i+=1,wr=sr=null,e.updateQueue=null,w1.current=pH,t=n(r,a)}while(Vh)}if(w1.current=N1,e=sr!==null&&sr.next!==null,ku=0,wr=sr=An=null,k1=!1,e)throw Error(Se(300));return t}function XS(){var t=Wh!==0;return Wh=0,t}function To(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return wr===null?An.memoizedState=wr=t:wr=wr.next=t,wr}function vi(){if(sr===null){var t=An.alternate;t=t!==null?t.memoizedState:null}else t=sr.next;var e=wr===null?An.memoizedState:wr.next;if(e!==null)wr=e,sr=t;else{if(t===null)throw Error(Se(310));sr=t,t={memoizedState:sr.memoizedState,baseState:sr.baseState,baseQueue:sr.baseQueue,queue:sr.queue,next:null},wr===null?An.memoizedState=wr=t:wr=wr.next=t}return wr}function jh(t,e){return typeof e=="function"?e(t):e}function YS(t){var e=vi(),n=e.queue;if(n===null)throw Error(Se(311));n.lastRenderedReducer=t;var r=sr,a=r.baseQueue,i=n.pending;if(i!==null){if(a!==null){var o=a.next;a.next=i.next,i.next=o}r.baseQueue=a=i,n.pending=null}if(a!==null){i=a.next,r=r.baseState;var s=o=null,l=null,u=i;do{var c=u.lane;if((ku&c)===c)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var d={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(s=l=d,o=r):l=l.next=d,An.lanes|=c,Su|=c}u=u.next}while(u!==null&&u!==i);l===null?o=r:l.next=s,Ki(r,e.memoizedState)||(Ma=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){a=t;do i=a.lane,An.lanes|=i,Su|=i,a=a.next;while(a!==t)}else a===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function QS(t){var e=vi(),n=e.queue;if(n===null)throw Error(Se(311));n.lastRenderedReducer=t;var r=n.dispatch,a=n.pending,i=e.memoizedState;if(a!==null){n.pending=null;var o=a=a.next;do i=t(i,o.action),o=o.next;while(o!==a);Ki(i,e.memoizedState)||(Ma=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function J$(){}function eR(t,e){var n=An,r=vi(),a=e(),i=!Ki(r.memoizedState,a);if(i&&(r.memoizedState=a,Ma=!0),r=r.queue,ZS(rR.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||wr!==null&&wr.memoizedState.tag&1){if(n.flags|=2048,Uh(9,nR.bind(null,n,r,a,e),void 0,null),kr===null)throw Error(Se(349));ku&30||tR(n,e,a)}return a}function tR(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=An.updateQueue,e===null?(e={lastEffect:null,stores:null},An.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function nR(t,e,n,r){e.value=n,e.getSnapshot=r,aR(e)&&iR(t)}function rR(t,e,n){return n(function(){aR(e)&&iR(t)})}function aR(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Ki(t,n)}catch{return!0}}function iR(t){var e=ss(t,1);e!==null&&Ji(e,t,1,-1)}function oR(t){var e=To();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:jh,lastRenderedState:t},e.queue=t,t=t.dispatch=uH.bind(null,An,t),[e.memoizedState,t]}function Uh(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=An.updateQueue,e===null?(e={lastEffect:null,stores:null},An.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function sR(){return vi().memoizedState}function S1(t,e,n,r){var a=To();An.flags|=t,a.memoizedState=Uh(1|e,n,void 0,r===void 0?null:r)}function C1(t,e,n,r){var a=vi();r=r===void 0?null:r;var i=void 0;if(sr!==null){var o=sr.memoizedState;if(i=o.destroy,r!==null&&qS(r,o.deps)){a.memoizedState=Uh(e,n,i,r);return}}An.flags|=t,a.memoizedState=Uh(1|e,n,i,r)}function lR(t,e){return S1(8390656,8,t,e)}function ZS(t,e){return C1(2048,8,t,e)}function uR(t,e){return C1(4,2,t,e)}function cR(t,e){return C1(4,4,t,e)}function dR(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function pR(t,e,n){return n=n!=null?n.concat([t]):null,C1(4,4,dR.bind(null,e,t),n)}function JS(){}function hR(t,e){var n=vi();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&qS(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function fR(t,e){var n=vi();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&qS(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function mR(t,e,n){return ku&21?(Ki(n,e)||(n=VO(),An.lanes|=n,Su|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Ma=!0),t.memoizedState=n)}function sH(t,e){var n=Zt;Zt=n!==0&&4>n?n:4,t(!0);var r=HS.transition;HS.transition={};try{t(!1),e()}finally{Zt=n,HS.transition=r}}function gR(){return vi().memoizedState}function lH(t,e,n){var r=hl(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},yR(t))bR(e,n);else if(n=V$(t,e,n,r),n!==null){var a=wa();Ji(n,t,r,a),vR(n,e,r)}}function uH(t,e,n){var r=hl(t),a={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(yR(t))bR(e,a);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,s=i(o,n);if(a.hasEagerState=!0,a.eagerState=s,Ki(s,o)){var l=e.interleaved;l===null?(a.next=a,FS(e)):(a.next=l.next,l.next=a),e.interleaved=a;return}}catch{}finally{}n=V$(t,e,a,r),n!==null&&(a=wa(),Ji(n,t,r,a),vR(n,e,r))}}function yR(t){var e=t.alternate;return t===An||e!==null&&e===An}function bR(t,e){Vh=k1=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function vR(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Jk(t,n)}}var N1={readContext:bi,useCallback:ta,useContext:ta,useEffect:ta,useImperativeHandle:ta,useInsertionEffect:ta,useLayoutEffect:ta,useMemo:ta,useReducer:ta,useRef:ta,useState:ta,useDebugValue:ta,useDeferredValue:ta,useTransition:ta,useMutableSource:ta,useSyncExternalStore:ta,useId:ta,unstable_isNewReconciler:!1},cH={readContext:bi,useCallback:function(t,e){return To().memoizedState=[t,e===void 0?null:e],t},useContext:bi,useEffect:lR,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,S1(4194308,4,dR.bind(null,e,t),n)},useLayoutEffect:function(t,e){return S1(4194308,4,t,e)},useInsertionEffect:function(t,e){return S1(4,2,t,e)},useMemo:function(t,e){var n=To();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=To();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=lH.bind(null,An,t),[r.memoizedState,t]},useRef:function(t){var e=To();return t={current:t},e.memoizedState=t},useState:oR,useDebugValue:JS,useDeferredValue:function(t){return To().memoizedState=t},useTransition:function(){var t=oR(!1),e=t[0];return t=sH.bind(null,t[1]),To().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=An,a=To();if(Nn){if(n===void 0)throw Error(Se(407));n=n()}else{if(n=e(),kr===null)throw Error(Se(349));ku&30||tR(r,e,n)}a.memoizedState=n;var i={value:n,getSnapshot:e};return a.queue=i,lR(rR.bind(null,r,i,t),[t]),r.flags|=2048,Uh(9,nR.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=To(),e=kr.identifierPrefix;if(Nn){var n=os,r=is;n=(r&~(1<<32-qi(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Wh++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=oH++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},dH={readContext:bi,useCallback:hR,useContext:bi,useEffect:ZS,useImperativeHandle:pR,useInsertionEffect:uR,useLayoutEffect:cR,useMemo:fR,useReducer:YS,useRef:sR,useState:function(){return YS(jh)},useDebugValue:JS,useDeferredValue:function(t){var e=vi();return mR(e,sr.memoizedState,t)},useTransition:function(){var t=YS(jh)[0],e=vi().memoizedState;return[t,e]},useMutableSource:J$,useSyncExternalStore:eR,useId:gR,unstable_isNewReconciler:!1},pH={readContext:bi,useCallback:hR,useContext:bi,useEffect:ZS,useImperativeHandle:pR,useInsertionEffect:uR,useLayoutEffect:cR,useMemo:fR,useReducer:QS,useRef:sR,useState:function(){return QS(jh)},useDebugValue:JS,useDeferredValue:function(t){var e=vi();return sr===null?e.memoizedState=t:mR(e,sr.memoizedState,t)},useTransition:function(){var t=QS(jh)[0],e=vi().memoizedState;return[t,e]},useMutableSource:J$,useSyncExternalStore:eR,useId:gR,unstable_isNewReconciler:!1};function fd(t,e){try{var n="",r=e;do n+=zU(r),r=r.return;while(r);var a=n}catch(i){a=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:a,digest:null}}function eC(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function tC(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var hH=typeof WeakMap=="function"?WeakMap:Map;function xR(t,e,n){n=ls(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){R1||(R1=!0,mC=r),tC(t,e)},n}function wR(t,e,n){n=ls(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var a=e.value;n.payload=function(){return r(a)},n.callback=function(){tC(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){tC(t,e),typeof r!="function"&&(dl===null?dl=new Set([this]):dl.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function kR(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new hH;var a=new Set;r.set(e,a)}else a=r.get(e),a===void 0&&(a=new Set,r.set(e,a));a.has(n)||(a.add(n),t=IH.bind(null,t,e,n),e.then(t,t))}function SR(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function CR(t,e,n,r,a){return t.mode&1?(t.flags|=65536,t.lanes=a,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=ls(-1,1),e.tag=2,ul(n,e,1))),n.lanes|=1),t)}var fH=ns.ReactCurrentOwner,Ma=!1;function xa(t,e,n,r){e.child=t===null?Q$(e,null,n,r):pd(e,t.child,n,r)}function NR(t,e,n,r,a){n=n.render;var i=e.ref;return dd(e,a),r=KS(t,e,n,r,i,a),n=XS(),t!==null&&!Ma?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~a,us(t,e,a)):(Nn&&n&&_S(e),e.flags|=1,xa(t,e,r,a),e.child)}function TR(t,e,n,r,a){if(t===null){var i=n.type;return typeof i=="function"&&!kC(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,IR(t,e,i,r,a)):(t=F1(n.type,null,r,e,e.mode,a),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&a)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:Oh,n(o,r)&&t.ref===e.ref)return us(t,e,a)}return e.flags|=1,t=ml(i,r),t.ref=e.ref,t.return=e,e.child=t}function IR(t,e,n,r,a){if(t!==null){var i=t.memoizedProps;if(Oh(i,r)&&t.ref===e.ref)if(Ma=!1,e.pendingProps=r=i,(t.lanes&a)!==0)t.flags&131072&&(Ma=!0);else return e.lanes=t.lanes,us(t,e,a)}return nC(t,e,n,r,a)}function ER(t,e,n){var r=e.pendingProps,a=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},fn(gd,Ja),Ja|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,fn(gd,Ja),Ja|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,fn(gd,Ja),Ja|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,fn(gd,Ja),Ja|=r;return xa(t,e,a,n),e.child}function _R(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function nC(t,e,n,r,a){var i=Ra(n)?yu:ea.current;return i=od(e,i),dd(e,a),n=KS(t,e,n,r,i,a),r=XS(),t!==null&&!Ma?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~a,us(t,e,a)):(Nn&&r&&_S(e),e.flags|=1,xa(t,e,n,a),e.child)}function OR(t,e,n,r,a){if(Ra(n)){var i=!0;u1(e)}else i=!1;if(dd(e,a),e.stateNode===null)I1(t,e),q$(e,n,r),VS(e,n,r,a),r=!0;else if(t===null){var o=e.stateNode,s=e.memoizedProps;o.props=s;var l=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=bi(u):(u=Ra(n)?yu:ea.current,u=od(e,u));var c=n.getDerivedStateFromProps,d=typeof c=="function"||typeof o.getSnapshotBeforeUpdate=="function";d||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(s!==r||l!==u)&&K$(e,o,r,u),ll=!1;var p=e.memoizedState;o.state=p,y1(e,r,o,a),l=e.memoizedState,s!==r||p!==l||$a.current||ll?(typeof c=="function"&&(zS(e,n,c,r),l=e.memoizedState),(s=ll||H$(e,n,s,r,p,l,u))?(d||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=u,r=s):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,W$(t,e),s=e.memoizedProps,u=e.type===e.elementType?s:Yi(e.type,s),o.props=u,d=e.pendingProps,p=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=bi(l):(l=Ra(n)?yu:ea.current,l=od(e,l));var f=n.getDerivedStateFromProps;(c=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(s!==d||p!==l)&&K$(e,o,r,l),ll=!1,p=e.memoizedState,o.state=p,y1(e,r,o,a);var g=e.memoizedState;s!==d||p!==g||$a.current||ll?(typeof f=="function"&&(zS(e,n,f,r),g=e.memoizedState),(u=ll||H$(e,n,u,r,p,g,l)||!1)?(c||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,g,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,g,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||s===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||s===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=g),o.props=r,o.state=g,o.context=l,r=u):(typeof o.componentDidUpdate!="function"||s===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||s===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),r=!1)}return rC(t,e,n,r,i,a)}function rC(t,e,n,r,a,i){_R(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return a&&A$(e,n,!1),us(t,e,i);r=e.stateNode,fH.current=e;var s=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=pd(e,t.child,null,i),e.child=pd(e,null,s,i)):xa(t,e,s,i),e.memoizedState=r.state,a&&A$(e,n,!0),e.child}function $R(t){var e=t.stateNode;e.pendingContext?R$(t,e.pendingContext,e.pendingContext!==e.context):e.context&&R$(t,e.context,!1),WS(t,e.containerInfo)}function RR(t,e,n,r,a){return ud(),MS(a),e.flags|=256,xa(t,e,n,r),e.child}var aC={dehydrated:null,treeContext:null,retryLane:0};function iC(t){return{baseLanes:t,cachePool:null,transitions:null}}function MR(t,e,n){var r=e.pendingProps,a=Mn.current,i=!1,o=(e.flags&128)!==0,s;if((s=o)||(s=t!==null&&t.memoizedState===null?!1:(a&2)!==0),s?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(a|=1),fn(Mn,a&1),t===null)return RS(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=B1(o,r,0,null),t=Iu(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=iC(n),e.memoizedState=aC,t):oC(e,o));if(a=t.memoizedState,a!==null&&(s=a.dehydrated,s!==null))return mH(t,e,o,r,s,a,n);if(i){i=r.fallback,o=e.mode,a=t.child,s=a.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==a?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=ml(a,l),r.subtreeFlags=a.subtreeFlags&14680064),s!==null?i=ml(s,i):(i=Iu(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?iC(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=aC,r}return i=t.child,t=i.sibling,r=ml(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function oC(t,e){return e=B1({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function T1(t,e,n,r){return r!==null&&MS(r),pd(e,t.child,null,n),t=oC(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function mH(t,e,n,r,a,i,o){if(n)return e.flags&256?(e.flags&=-257,r=eC(Error(Se(422))),T1(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,a=e.mode,r=B1({mode:"visible",children:r.children},a,0,null),i=Iu(i,a,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&pd(e,t.child,null,o),e.child.memoizedState=iC(o),e.memoizedState=aC,i);if(!(e.mode&1))return T1(t,e,o,null);if(a.data==="$!"){if(r=a.nextSibling&&a.nextSibling.dataset,r)var s=r.dgst;return r=s,i=Error(Se(419)),r=eC(i,r,void 0),T1(t,e,o,r)}if(s=(o&t.childLanes)!==0,Ma||s){if(r=kr,r!==null){switch(o&-o){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(r.suspendedLanes|o)?0:a,a!==0&&a!==i.retryLane&&(i.retryLane=a,ss(t,a),Ji(r,t,a,-1))}return wC(),r=eC(Error(Se(421))),T1(t,e,o,r)}return a.data==="$?"?(e.flags|=128,e.child=t.child,e=EH.bind(null,t),a._reactRetry=e,null):(t=i.treeContext,Za=al(a.nextSibling),Qa=e,Nn=!0,Xi=null,t!==null&&(gi[yi++]=is,gi[yi++]=os,gi[yi++]=bu,is=t.id,os=t.overflow,bu=e),e=oC(e,r.children),e.flags|=4096,e)}function AR(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),LS(t.return,e,n)}function sC(t,e,n,r,a){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=a)}function PR(t,e,n){var r=e.pendingProps,a=r.revealOrder,i=r.tail;if(xa(t,e,r.children,n),r=Mn.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&AR(t,n,e);else if(t.tag===19)AR(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(fn(Mn,r),!(e.mode&1))e.memoizedState=null;else switch(a){case"forwards":for(n=e.child,a=null;n!==null;)t=n.alternate,t!==null&&x1(t)===null&&(a=n),n=n.sibling;n=a,n===null?(a=e.child,e.child=null):(a=n.sibling,n.sibling=null),sC(e,!1,a,n,i);break;case"backwards":for(n=null,a=e.child,e.child=null;a!==null;){if(t=a.alternate,t!==null&&x1(t)===null){e.child=a;break}t=a.sibling,a.sibling=n,n=a,a=t}sC(e,!0,n,null,i);break;case"together":sC(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function I1(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function us(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Su|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Se(153));if(e.child!==null){for(t=e.child,n=ml(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=ml(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function gH(t,e,n){switch(e.tag){case 3:$R(e),ud();break;case 5:Z$(e);break;case 1:Ra(e.type)&&u1(e);break;case 4:WS(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,a=e.memoizedProps.value;fn(f1,r._currentValue),r._currentValue=a;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(fn(Mn,Mn.current&1),e.flags|=128,null):n&e.child.childLanes?MR(t,e,n):(fn(Mn,Mn.current&1),t=us(t,e,n),t!==null?t.sibling:null);fn(Mn,Mn.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return PR(t,e,n);e.flags|=128}if(a=e.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),fn(Mn,Mn.current),r)break;return null;case 22:case 23:return e.lanes=0,ER(t,e,n)}return us(t,e,n)}var DR,lC,LR,FR;DR=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},lC=function(){},LR=function(t,e,n,r){var a=t.memoizedProps;if(a!==r){t=e.stateNode,wu(No.current);var i=null;switch(n){case"input":a=Lk(t,a),r=Lk(t,r),i=[];break;case"select":a=Rn({},a,{value:void 0}),r=Rn({},r,{value:void 0}),i=[];break;case"textarea":a=zk(t,a),r=zk(t,r),i=[];break;default:typeof a.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=o1)}Wk(n,r);var o;n=null;for(u in a)if(!r.hasOwnProperty(u)&&a.hasOwnProperty(u)&&a[u]!=null)if(u==="style"){var s=a[u];for(o in s)s.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(uh.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in r){var l=r[u];if(s=a?.[u],r.hasOwnProperty(u)&&l!==s&&(l!=null||s!=null))if(u==="style")if(s){for(o in s)!s.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&s[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(i||(i=[]),i.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,s=s?s.__html:void 0,l!=null&&s!==l&&(i=i||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(uh.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&vn("scroll",t),i||s===l||(i=[])):(i=i||[]).push(u,l))}n&&(i=i||[]).push("style",n);var u=i;(e.updateQueue=u)&&(e.flags|=4)}},FR=function(t,e,n,r){n!==r&&(e.flags|=4)};function Gh(t,e){if(!Nn)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function na(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var a=t.child;a!==null;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags&14680064,r|=a.flags&14680064,a.return=t,a=a.sibling;else for(a=t.child;a!==null;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags,r|=a.flags,a.return=t,a=a.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function yH(t,e,n){var r=e.pendingProps;switch(OS(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return na(e),null;case 1:return Ra(e.type)&&l1(),na(e),null;case 3:return r=e.stateNode,hd(),xn($a),xn(ea),GS(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(h1(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Xi!==null&&(bC(Xi),Xi=null))),lC(t,e),na(e),null;case 5:jS(e);var a=wu(zh.current);if(n=e.type,t!==null&&e.stateNode!=null)LR(t,e,n,r,a),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(Se(166));return na(e),null}if(t=wu(No.current),h1(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[Co]=e,r[Ph]=i,t=(e.mode&1)!==0,n){case"dialog":vn("cancel",r),vn("close",r);break;case"iframe":case"object":case"embed":vn("load",r);break;case"video":case"audio":for(a=0;a<Rh.length;a++)vn(Rh[a],r);break;case"source":vn("error",r);break;case"img":case"image":case"link":vn("error",r),vn("load",r);break;case"details":vn("toggle",r);break;case"input":yO(r,i),vn("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},vn("invalid",r);break;case"textarea":xO(r,i),vn("invalid",r)}Wk(n,i),a=null;for(var o in i)if(i.hasOwnProperty(o)){var s=i[o];o==="children"?typeof s=="string"?r.textContent!==s&&(i.suppressHydrationWarning!==!0&&i1(r.textContent,s,t),a=["children",s]):typeof s=="number"&&r.textContent!==""+s&&(i.suppressHydrationWarning!==!0&&i1(r.textContent,s,t),a=["children",""+s]):uh.hasOwnProperty(o)&&s!=null&&o==="onScroll"&&vn("scroll",r)}switch(n){case"input":D0(r),vO(r,i,!0);break;case"textarea":D0(r),kO(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=o1)}r=a,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=a.nodeType===9?a:a.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=SO(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Co]=e,t[Ph]=r,DR(t,e,!1,!1),e.stateNode=t;e:{switch(o=jk(n,r),n){case"dialog":vn("cancel",t),vn("close",t),a=r;break;case"iframe":case"object":case"embed":vn("load",t),a=r;break;case"video":case"audio":for(a=0;a<Rh.length;a++)vn(Rh[a],t);a=r;break;case"source":vn("error",t),a=r;break;case"img":case"image":case"link":vn("error",t),vn("load",t),a=r;break;case"details":vn("toggle",t),a=r;break;case"input":yO(t,r),a=Lk(t,r),vn("invalid",t);break;case"option":a=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},a=Rn({},r,{value:void 0}),vn("invalid",t);break;case"textarea":xO(t,r),a=zk(t,r),vn("invalid",t);break;default:a=r}Wk(n,a),s=a;for(i in s)if(s.hasOwnProperty(i)){var l=s[i];i==="style"?TO(t,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&CO(t,l)):i==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&hh(t,l):typeof l=="number"&&hh(t,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(uh.hasOwnProperty(i)?l!=null&&i==="onScroll"&&vn("scroll",t):l!=null&&Tk(t,i,l,o))}switch(n){case"input":D0(t),vO(t,r,!1);break;case"textarea":D0(t),kO(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Qs(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?Kc(t,!!r.multiple,i,!1):r.defaultValue!=null&&Kc(t,!!r.multiple,r.defaultValue,!0);break;default:typeof a.onClick=="function"&&(t.onclick=o1)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return na(e),null;case 6:if(t&&e.stateNode!=null)FR(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(Se(166));if(n=wu(zh.current),wu(No.current),h1(e)){if(r=e.stateNode,n=e.memoizedProps,r[Co]=e,(i=r.nodeValue!==n)&&(t=Qa,t!==null))switch(t.tag){case 3:i1(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&i1(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Co]=e,e.stateNode=r}return na(e),null;case 13:if(xn(Mn),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Nn&&Za!==null&&e.mode&1&&!(e.flags&128))z$(),ud(),e.flags|=98560,i=!1;else if(i=h1(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(Se(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Se(317));i[Co]=e}else ud(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;na(e),i=!1}else Xi!==null&&(bC(Xi),Xi=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Mn.current&1?lr===0&&(lr=3):wC())),e.updateQueue!==null&&(e.flags|=4),na(e),null);case 4:return hd(),lC(t,e),t===null&&Mh(e.stateNode.containerInfo),na(e),null;case 10:return DS(e.type._context),na(e),null;case 17:return Ra(e.type)&&l1(),na(e),null;case 19:if(xn(Mn),i=e.memoizedState,i===null)return na(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)Gh(i,!1);else{if(lr!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=x1(t),o!==null){for(e.flags|=128,Gh(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return fn(Mn,Mn.current&1|2),e.child}t=t.sibling}i.tail!==null&&qn()>yd&&(e.flags|=128,r=!0,Gh(i,!1),e.lanes=4194304)}else{if(!r)if(t=x1(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Gh(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Nn)return na(e),null}else 2*qn()-i.renderingStartTime>yd&&n!==1073741824&&(e.flags|=128,r=!0,Gh(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=qn(),e.sibling=null,n=Mn.current,fn(Mn,r?n&1|2:n&1),e):(na(e),null);case 22:case 23:return xC(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Ja&1073741824&&(na(e),e.subtreeFlags&6&&(e.flags|=8192)):na(e),null;case 24:return null;case 25:return null}throw Error(Se(156,e.tag))}function bH(t,e){switch(OS(e),e.tag){case 1:return Ra(e.type)&&l1(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return hd(),xn($a),xn(ea),GS(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return jS(e),null;case 13:if(xn(Mn),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Se(340));ud()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return xn(Mn),null;case 4:return hd(),null;case 10:return DS(e.type._context),null;case 22:case 23:return xC(),null;case 24:return null;default:return null}}var E1=!1,ra=!1,vH=typeof WeakSet=="function"?WeakSet:Set,Be=null;function md(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){zn(t,e,r)}else n.current=null}function BR(t,e,n){try{n()}catch(r){zn(t,e,r)}}var zR=!1;function xH(t,e){if(wS=K0,t=g$(),hS(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var a=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,s=-1,l=-1,u=0,c=0,d=t,p=null;t:for(;;){for(var f;d!==n||a!==0&&d.nodeType!==3||(s=o+a),d!==i||r!==0&&d.nodeType!==3||(l=o+r),d.nodeType===3&&(o+=d.nodeValue.length),(f=d.firstChild)!==null;)p=d,d=f;for(;;){if(d===t)break t;if(p===n&&++u===a&&(s=o),p===i&&++c===r&&(l=o),(f=d.nextSibling)!==null)break;d=p,p=d.parentNode}d=f}n=s===-1||l===-1?null:{start:s,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(kS={focusedElem:t,selectionRange:n},K0=!1,Be=e;Be!==null;)if(e=Be,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Be=t;else for(;Be!==null;){e=Be;try{var g=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var y=g.memoizedProps,x=g.memoizedState,b=e.stateNode,v=b.getSnapshotBeforeUpdate(e.elementType===e.type?y:Yi(e.type,y),x);b.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var w=e.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Se(163))}}catch(S){zn(e,e.return,S)}if(t=e.sibling,t!==null){t.return=e.return,Be=t;break}Be=e.return}return g=zR,zR=!1,g}function Hh(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var a=r=r.next;do{if((a.tag&t)===t){var i=a.destroy;a.destroy=void 0,i!==void 0&&BR(e,n,i)}a=a.next}while(a!==r)}}function _1(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function uC(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function VR(t){var e=t.alternate;e!==null&&(t.alternate=null,VR(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Co],delete e[Ph],delete e[TS],delete e[nH],delete e[rH])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function WR(t){return t.tag===5||t.tag===3||t.tag===4}function jR(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||WR(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function cC(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=o1));else if(r!==4&&(t=t.child,t!==null))for(cC(t,e,n),t=t.sibling;t!==null;)cC(t,e,n),t=t.sibling}function dC(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(dC(t,e,n),t=t.sibling;t!==null;)dC(t,e,n),t=t.sibling}var Lr=null,Qi=!1;function cl(t,e,n){for(n=n.child;n!==null;)UR(t,e,n),n=n.sibling}function UR(t,e,n){if(So&&typeof So.onCommitFiberUnmount=="function")try{So.onCommitFiberUnmount(W0,n)}catch{}switch(n.tag){case 5:ra||md(n,e);case 6:var r=Lr,a=Qi;Lr=null,cl(t,e,n),Lr=r,Qi=a,Lr!==null&&(Qi?(t=Lr,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Lr.removeChild(n.stateNode));break;case 18:Lr!==null&&(Qi?(t=Lr,n=n.stateNode,t.nodeType===8?NS(t.parentNode,n):t.nodeType===1&&NS(t,n),Ch(t)):NS(Lr,n.stateNode));break;case 4:r=Lr,a=Qi,Lr=n.stateNode.containerInfo,Qi=!0,cl(t,e,n),Lr=r,Qi=a;break;case 0:case 11:case 14:case 15:if(!ra&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){a=r=r.next;do{var i=a,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&BR(n,e,o),a=a.next}while(a!==r)}cl(t,e,n);break;case 1:if(!ra&&(md(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(s){zn(n,e,s)}cl(t,e,n);break;case 21:cl(t,e,n);break;case 22:n.mode&1?(ra=(r=ra)||n.memoizedState!==null,cl(t,e,n),ra=r):cl(t,e,n);break;default:cl(t,e,n)}}function GR(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new vH),e.forEach(function(r){var a=_H.bind(null,t,r);n.has(r)||(n.add(r),r.then(a,a))})}}function Zi(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var a=n[r];try{var i=t,o=e,s=o;e:for(;s!==null;){switch(s.tag){case 5:Lr=s.stateNode,Qi=!1;break e;case 3:Lr=s.stateNode.containerInfo,Qi=!0;break e;case 4:Lr=s.stateNode.containerInfo,Qi=!0;break e}s=s.return}if(Lr===null)throw Error(Se(160));UR(i,o,a),Lr=null,Qi=!1;var l=a.alternate;l!==null&&(l.return=null),a.return=null}catch(u){zn(a,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)HR(e,t),e=e.sibling}function HR(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Zi(e,t),Io(t),r&4){try{Hh(3,t,t.return),_1(3,t)}catch(y){zn(t,t.return,y)}try{Hh(5,t,t.return)}catch(y){zn(t,t.return,y)}}break;case 1:Zi(e,t),Io(t),r&512&&n!==null&&md(n,n.return);break;case 5:if(Zi(e,t),Io(t),r&512&&n!==null&&md(n,n.return),t.flags&32){var a=t.stateNode;try{hh(a,"")}catch(y){zn(t,t.return,y)}}if(r&4&&(a=t.stateNode,a!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,s=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{s==="input"&&i.type==="radio"&&i.name!=null&&bO(a,i),jk(s,o);var u=jk(s,i);for(o=0;o<l.length;o+=2){var c=l[o],d=l[o+1];c==="style"?TO(a,d):c==="dangerouslySetInnerHTML"?CO(a,d):c==="children"?hh(a,d):Tk(a,c,d,u)}switch(s){case"input":Fk(a,i);break;case"textarea":wO(a,i);break;case"select":var p=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!i.multiple;var f=i.value;f!=null?Kc(a,!!i.multiple,f,!1):p!==!!i.multiple&&(i.defaultValue!=null?Kc(a,!!i.multiple,i.defaultValue,!0):Kc(a,!!i.multiple,i.multiple?[]:"",!1))}a[Ph]=i}catch(y){zn(t,t.return,y)}}break;case 6:if(Zi(e,t),Io(t),r&4){if(t.stateNode===null)throw Error(Se(162));a=t.stateNode,i=t.memoizedProps;try{a.nodeValue=i}catch(y){zn(t,t.return,y)}}break;case 3:if(Zi(e,t),Io(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Ch(e.containerInfo)}catch(y){zn(t,t.return,y)}break;case 4:Zi(e,t),Io(t);break;case 13:Zi(e,t),Io(t),a=t.child,a.flags&8192&&(i=a.memoizedState!==null,a.stateNode.isHidden=i,!i||a.alternate!==null&&a.alternate.memoizedState!==null||(fC=qn())),r&4&&GR(t);break;case 22:if(c=n!==null&&n.memoizedState!==null,t.mode&1?(ra=(u=ra)||c,Zi(e,t),ra=u):Zi(e,t),Io(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!c&&t.mode&1)for(Be=t,c=t.child;c!==null;){for(d=Be=c;Be!==null;){switch(p=Be,f=p.child,p.tag){case 0:case 11:case 14:case 15:Hh(4,p,p.return);break;case 1:md(p,p.return);var g=p.stateNode;if(typeof g.componentWillUnmount=="function"){r=p,n=p.return;try{e=r,g.props=e.memoizedProps,g.state=e.memoizedState,g.componentWillUnmount()}catch(y){zn(r,n,y)}}break;case 5:md(p,p.return);break;case 22:if(p.memoizedState!==null){XR(d);continue}}f!==null?(f.return=p,Be=f):XR(d)}c=c.sibling}e:for(c=null,d=t;;){if(d.tag===5){if(c===null){c=d;try{a=d.stateNode,u?(i=a.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(s=d.stateNode,l=d.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,s.style.display=NO("display",o))}catch(y){zn(t,t.return,y)}}}else if(d.tag===6){if(c===null)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(y){zn(t,t.return,y)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===t)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;c===d&&(c=null),d=d.return}c===d&&(c=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Zi(e,t),Io(t),r&4&&GR(t);break;case 21:break;default:Zi(e,t),Io(t)}}function Io(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(WR(n)){var r=n;break e}n=n.return}throw Error(Se(160))}switch(r.tag){case 5:var a=r.stateNode;r.flags&32&&(hh(a,""),r.flags&=-33);var i=jR(t);dC(t,i,a);break;case 3:case 4:var o=r.stateNode.containerInfo,s=jR(t);cC(t,s,o);break;default:throw Error(Se(161))}}catch(l){zn(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function wH(t,e,n){Be=t,qR(t)}function qR(t,e,n){for(var r=(t.mode&1)!==0;Be!==null;){var a=Be,i=a.child;if(a.tag===22&&r){var o=a.memoizedState!==null||E1;if(!o){var s=a.alternate,l=s!==null&&s.memoizedState!==null||ra;s=E1;var u=ra;if(E1=o,(ra=l)&&!u)for(Be=a;Be!==null;)o=Be,l=o.child,o.tag===22&&o.memoizedState!==null?YR(a):l!==null?(l.return=o,Be=l):YR(a);for(;i!==null;)Be=i,qR(i),i=i.sibling;Be=a,E1=s,ra=u}KR(t)}else a.subtreeFlags&8772&&i!==null?(i.return=a,Be=i):KR(t)}}function KR(t){for(;Be!==null;){var e=Be;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:ra||_1(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!ra)if(n===null)r.componentDidMount();else{var a=e.elementType===e.type?n.memoizedProps:Yi(e.type,n.memoizedProps);r.componentDidUpdate(a,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&U$(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}U$(e,o,n)}break;case 5:var s=e.stateNode;if(n===null&&e.flags&4){n=s;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var d=c.dehydrated;d!==null&&Ch(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Se(163))}ra||e.flags&512&&uC(e)}catch(p){zn(e,e.return,p)}}if(e===t){Be=null;break}if(n=e.sibling,n!==null){n.return=e.return,Be=n;break}Be=e.return}}function XR(t){for(;Be!==null;){var e=Be;if(e===t){Be=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Be=n;break}Be=e.return}}function YR(t){for(;Be!==null;){var e=Be;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{_1(4,e)}catch(l){zn(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var a=e.return;try{r.componentDidMount()}catch(l){zn(e,a,l)}}var i=e.return;try{uC(e)}catch(l){zn(e,i,l)}break;case 5:var o=e.return;try{uC(e)}catch(l){zn(e,o,l)}}}catch(l){zn(e,e.return,l)}if(e===t){Be=null;break}var s=e.sibling;if(s!==null){s.return=e.return,Be=s;break}Be=e.return}}var kH=Math.ceil,O1=ns.ReactCurrentDispatcher,pC=ns.ReactCurrentOwner,xi=ns.ReactCurrentBatchConfig,Dt=0,kr=null,er=null,Fr=0,Ja=0,gd=il(0),lr=0,qh=null,Su=0,$1=0,hC=0,Kh=null,Aa=null,fC=0,yd=1/0,cs=null,R1=!1,mC=null,dl=null,M1=!1,pl=null,A1=0,Xh=0,gC=null,P1=-1,D1=0;function wa(){return Dt&6?qn():P1!==-1?P1:P1=qn()}function hl(t){return t.mode&1?Dt&2&&Fr!==0?Fr&-Fr:iH.transition!==null?(D1===0&&(D1=VO()),D1):(t=Zt,t!==0||(t=window.event,t=t===void 0?16:YO(t.type)),t):1}function Ji(t,e,n,r){if(50<Xh)throw Xh=0,gC=null,Error(Se(185));vh(t,n,r),(!(Dt&2)||t!==kr)&&(t===kr&&(!(Dt&2)&&($1|=n),lr===4&&fl(t,Fr)),Pa(t,r),n===1&&Dt===0&&!(e.mode&1)&&(yd=qn()+500,c1&&sl()))}function Pa(t,e){var n=t.callbackNode;iG(t,e);var r=G0(t,t===kr?Fr:0);if(r===0)n!==null&&FO(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&FO(n),e===1)t.tag===0?aH(ZR.bind(null,t)):P$(ZR.bind(null,t)),eH(function(){!(Dt&6)&&sl()}),n=null;else{switch(WO(r)){case 1:n=Yk;break;case 4:n=BO;break;case 16:n=V0;break;case 536870912:n=zO;break;default:n=V0}n=oM(n,QR.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function QR(t,e){if(P1=-1,D1=0,Dt&6)throw Error(Se(327));var n=t.callbackNode;if(bd()&&t.callbackNode!==n)return null;var r=G0(t,t===kr?Fr:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=L1(t,r);else{e=r;var a=Dt;Dt|=2;var i=eM();(kr!==t||Fr!==e)&&(cs=null,yd=qn()+500,Nu(t,e));do try{NH();break}catch(s){JR(t,s)}while(!0);PS(),O1.current=i,Dt=a,er!==null?e=0:(kr=null,Fr=0,e=lr)}if(e!==0){if(e===2&&(a=Qk(t),a!==0&&(r=a,e=yC(t,a))),e===1)throw n=qh,Nu(t,0),fl(t,r),Pa(t,qn()),n;if(e===6)fl(t,r);else{if(a=t.current.alternate,!(r&30)&&!SH(a)&&(e=L1(t,r),e===2&&(i=Qk(t),i!==0&&(r=i,e=yC(t,i))),e===1))throw n=qh,Nu(t,0),fl(t,r),Pa(t,qn()),n;switch(t.finishedWork=a,t.finishedLanes=r,e){case 0:case 1:throw Error(Se(345));case 2:Tu(t,Aa,cs);break;case 3:if(fl(t,r),(r&130023424)===r&&(e=fC+500-qn(),10<e)){if(G0(t,0)!==0)break;if(a=t.suspendedLanes,(a&r)!==r){wa(),t.pingedLanes|=t.suspendedLanes&a;break}t.timeoutHandle=CS(Tu.bind(null,t,Aa,cs),e);break}Tu(t,Aa,cs);break;case 4:if(fl(t,r),(r&4194240)===r)break;for(e=t.eventTimes,a=-1;0<r;){var o=31-qi(r);i=1<<o,o=e[o],o>a&&(a=o),r&=~i}if(r=a,r=qn()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*kH(r/1960))-r,10<r){t.timeoutHandle=CS(Tu.bind(null,t,Aa,cs),r);break}Tu(t,Aa,cs);break;case 5:Tu(t,Aa,cs);break;default:throw Error(Se(329))}}}return Pa(t,qn()),t.callbackNode===n?QR.bind(null,t):null}function yC(t,e){var n=Kh;return t.current.memoizedState.isDehydrated&&(Nu(t,e).flags|=256),t=L1(t,e),t!==2&&(e=Aa,Aa=n,e!==null&&bC(e)),t}function bC(t){Aa===null?Aa=t:Aa.push.apply(Aa,t)}function SH(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var a=n[r],i=a.getSnapshot;a=a.value;try{if(!Ki(i(),a))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function fl(t,e){for(e&=~hC,e&=~$1,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-qi(e),r=1<<n;t[n]=-1,e&=~r}}function ZR(t){if(Dt&6)throw Error(Se(327));bd();var e=G0(t,0);if(!(e&1))return Pa(t,qn()),null;var n=L1(t,e);if(t.tag!==0&&n===2){var r=Qk(t);r!==0&&(e=r,n=yC(t,r))}if(n===1)throw n=qh,Nu(t,0),fl(t,e),Pa(t,qn()),n;if(n===6)throw Error(Se(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Tu(t,Aa,cs),Pa(t,qn()),null}function vC(t,e){var n=Dt;Dt|=1;try{return t(e)}finally{Dt=n,Dt===0&&(yd=qn()+500,c1&&sl())}}function Cu(t){pl!==null&&pl.tag===0&&!(Dt&6)&&bd();var e=Dt;Dt|=1;var n=xi.transition,r=Zt;try{if(xi.transition=null,Zt=1,t)return t()}finally{Zt=r,xi.transition=n,Dt=e,!(Dt&6)&&sl()}}function xC(){Ja=gd.current,xn(gd)}function Nu(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,JG(n)),er!==null)for(n=er.return;n!==null;){var r=n;switch(OS(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&l1();break;case 3:hd(),xn($a),xn(ea),GS();break;case 5:jS(r);break;case 4:hd();break;case 13:xn(Mn);break;case 19:xn(Mn);break;case 10:DS(r.type._context);break;case 22:case 23:xC()}n=n.return}if(kr=t,er=t=ml(t.current,null),Fr=Ja=e,lr=0,qh=null,hC=$1=Su=0,Aa=Kh=null,xu!==null){for(e=0;e<xu.length;e++)if(n=xu[e],r=n.interleaved,r!==null){n.interleaved=null;var a=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=a,r.next=o}n.pending=r}xu=null}return t}function JR(t,e){do{var n=er;try{if(PS(),w1.current=N1,k1){for(var r=An.memoizedState;r!==null;){var a=r.queue;a!==null&&(a.pending=null),r=r.next}k1=!1}if(ku=0,wr=sr=An=null,Vh=!1,Wh=0,pC.current=null,n===null||n.return===null){lr=1,qh=e,er=null;break}e:{var i=t,o=n.return,s=n,l=e;if(e=Fr,s.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,c=s,d=c.tag;if(!(c.mode&1)&&(d===0||d===11||d===15)){var p=c.alternate;p?(c.updateQueue=p.updateQueue,c.memoizedState=p.memoizedState,c.lanes=p.lanes):(c.updateQueue=null,c.memoizedState=null)}var f=SR(o);if(f!==null){f.flags&=-257,CR(f,o,s,i,e),f.mode&1&&kR(i,u,e),e=f,l=u;var g=e.updateQueue;if(g===null){var y=new Set;y.add(l),e.updateQueue=y}else g.add(l);break e}else{if(!(e&1)){kR(i,u,e),wC();break e}l=Error(Se(426))}}else if(Nn&&s.mode&1){var x=SR(o);if(x!==null){!(x.flags&65536)&&(x.flags|=256),CR(x,o,s,i,e),MS(fd(l,s));break e}}i=l=fd(l,s),lr!==4&&(lr=2),Kh===null?Kh=[i]:Kh.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var b=xR(i,l,e);j$(i,b);break e;case 1:s=l;var v=i.type,w=i.stateNode;if(!(i.flags&128)&&(typeof v.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(dl===null||!dl.has(w)))){i.flags|=65536,e&=-e,i.lanes|=e;var S=wR(i,s,e);j$(i,S);break e}}i=i.return}while(i!==null)}nM(n)}catch(C){e=C,er===n&&n!==null&&(er=n=n.return);continue}break}while(!0)}function eM(){var t=O1.current;return O1.current=N1,t===null?N1:t}function wC(){(lr===0||lr===3||lr===2)&&(lr=4),kr===null||!(Su&268435455)&&!($1&268435455)||fl(kr,Fr)}function L1(t,e){var n=Dt;Dt|=2;var r=eM();(kr!==t||Fr!==e)&&(cs=null,Nu(t,e));do try{CH();break}catch(a){JR(t,a)}while(!0);if(PS(),Dt=n,O1.current=r,er!==null)throw Error(Se(261));return kr=null,Fr=0,lr}function CH(){for(;er!==null;)tM(er)}function NH(){for(;er!==null&&!YU();)tM(er)}function tM(t){var e=iM(t.alternate,t,Ja);t.memoizedProps=t.pendingProps,e===null?nM(t):er=e,pC.current=null}function nM(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=bH(n,e),n!==null){n.flags&=32767,er=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{lr=6,er=null;return}}else if(n=yH(n,e,Ja),n!==null){er=n;return}if(e=e.sibling,e!==null){er=e;return}er=e=t}while(e!==null);lr===0&&(lr=5)}function Tu(t,e,n){var r=Zt,a=xi.transition;try{xi.transition=null,Zt=1,TH(t,e,n,r)}finally{xi.transition=a,Zt=r}return null}function TH(t,e,n,r){do bd();while(pl!==null);if(Dt&6)throw Error(Se(327));n=t.finishedWork;var a=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(Se(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(oG(t,i),t===kr&&(er=kr=null,Fr=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||M1||(M1=!0,oM(V0,function(){return bd(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=xi.transition,xi.transition=null;var o=Zt;Zt=1;var s=Dt;Dt|=4,pC.current=null,xH(t,n),HR(n,t),HG(kS),K0=!!wS,kS=wS=null,t.current=n,wH(n),QU(),Dt=s,Zt=o,xi.transition=i}else t.current=n;if(M1&&(M1=!1,pl=t,A1=a),i=t.pendingLanes,i===0&&(dl=null),eG(n.stateNode),Pa(t,qn()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)a=e[n],r(a.value,{componentStack:a.stack,digest:a.digest});if(R1)throw R1=!1,t=mC,mC=null,t;return A1&1&&t.tag!==0&&bd(),i=t.pendingLanes,i&1?t===gC?Xh++:(Xh=0,gC=t):Xh=0,sl(),null}function bd(){if(pl!==null){var t=WO(A1),e=xi.transition,n=Zt;try{if(xi.transition=null,Zt=16>t?16:t,pl===null)var r=!1;else{if(t=pl,pl=null,A1=0,Dt&6)throw Error(Se(331));var a=Dt;for(Dt|=4,Be=t.current;Be!==null;){var i=Be,o=i.child;if(Be.flags&16){var s=i.deletions;if(s!==null){for(var l=0;l<s.length;l++){var u=s[l];for(Be=u;Be!==null;){var c=Be;switch(c.tag){case 0:case 11:case 15:Hh(8,c,i)}var d=c.child;if(d!==null)d.return=c,Be=d;else for(;Be!==null;){c=Be;var p=c.sibling,f=c.return;if(VR(c),c===u){Be=null;break}if(p!==null){p.return=f,Be=p;break}Be=f}}}var g=i.alternate;if(g!==null){var y=g.child;if(y!==null){g.child=null;do{var x=y.sibling;y.sibling=null,y=x}while(y!==null)}}Be=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,Be=o;else e:for(;Be!==null;){if(i=Be,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Hh(9,i,i.return)}var b=i.sibling;if(b!==null){b.return=i.return,Be=b;break e}Be=i.return}}var v=t.current;for(Be=v;Be!==null;){o=Be;var w=o.child;if(o.subtreeFlags&2064&&w!==null)w.return=o,Be=w;else e:for(o=v;Be!==null;){if(s=Be,s.flags&2048)try{switch(s.tag){case 0:case 11:case 15:_1(9,s)}}catch(C){zn(s,s.return,C)}if(s===o){Be=null;break e}var S=s.sibling;if(S!==null){S.return=s.return,Be=S;break e}Be=s.return}}if(Dt=a,sl(),So&&typeof So.onPostCommitFiberRoot=="function")try{So.onPostCommitFiberRoot(W0,t)}catch{}r=!0}return r}finally{Zt=n,xi.transition=e}}return!1}function rM(t,e,n){e=fd(n,e),e=xR(t,e,1),t=ul(t,e,1),e=wa(),t!==null&&(vh(t,1,e),Pa(t,e))}function zn(t,e,n){if(t.tag===3)rM(t,t,n);else for(;e!==null;){if(e.tag===3){rM(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(dl===null||!dl.has(r))){t=fd(n,t),t=wR(e,t,1),e=ul(e,t,1),t=wa(),e!==null&&(vh(e,1,t),Pa(e,t));break}}e=e.return}}function IH(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=wa(),t.pingedLanes|=t.suspendedLanes&n,kr===t&&(Fr&n)===n&&(lr===4||lr===3&&(Fr&130023424)===Fr&&500>qn()-fC?Nu(t,0):hC|=n),Pa(t,e)}function aM(t,e){e===0&&(t.mode&1?(e=U0,U0<<=1,!(U0&130023424)&&(U0=4194304)):e=1);var n=wa();t=ss(t,e),t!==null&&(vh(t,e,n),Pa(t,n))}function EH(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),aM(t,n)}function _H(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,a=t.memoizedState;a!==null&&(n=a.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(Se(314))}r!==null&&r.delete(e),aM(t,n)}var iM;iM=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||$a.current)Ma=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Ma=!1,gH(t,e,n);Ma=!!(t.flags&131072)}else Ma=!1,Nn&&e.flags&1048576&&D$(e,p1,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;I1(t,e),t=e.pendingProps;var a=od(e,ea.current);dd(e,n),a=KS(null,e,r,t,a,n);var i=XS();return e.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Ra(r)?(i=!0,u1(e)):i=!1,e.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,BS(e),a.updater=b1,e.stateNode=a,a._reactInternals=e,VS(e,r,t,n),e=rC(null,e,r,!0,i,n)):(e.tag=0,Nn&&i&&_S(e),xa(null,e,a,n),e=e.child),e;case 16:r=e.elementType;e:{switch(I1(t,e),t=e.pendingProps,a=r._init,r=a(r._payload),e.type=r,a=e.tag=$H(r),t=Yi(r,t),a){case 0:e=nC(null,e,r,t,n);break e;case 1:e=OR(null,e,r,t,n);break e;case 11:e=NR(null,e,r,t,n);break e;case 14:e=TR(null,e,r,Yi(r.type,t),n);break e}throw Error(Se(306,r,""))}return e;case 0:return r=e.type,a=e.pendingProps,a=e.elementType===r?a:Yi(r,a),nC(t,e,r,a,n);case 1:return r=e.type,a=e.pendingProps,a=e.elementType===r?a:Yi(r,a),OR(t,e,r,a,n);case 3:e:{if($R(e),t===null)throw Error(Se(387));r=e.pendingProps,i=e.memoizedState,a=i.element,W$(t,e),y1(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){a=fd(Error(Se(423)),e),e=RR(t,e,r,n,a);break e}else if(r!==a){a=fd(Error(Se(424)),e),e=RR(t,e,r,n,a);break e}else for(Za=al(e.stateNode.containerInfo.firstChild),Qa=e,Nn=!0,Xi=null,n=Q$(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(ud(),r===a){e=us(t,e,n);break e}xa(t,e,r,n)}e=e.child}return e;case 5:return Z$(e),t===null&&RS(e),r=e.type,a=e.pendingProps,i=t!==null?t.memoizedProps:null,o=a.children,SS(r,a)?o=null:i!==null&&SS(r,i)&&(e.flags|=32),_R(t,e),xa(t,e,o,n),e.child;case 6:return t===null&&RS(e),null;case 13:return MR(t,e,n);case 4:return WS(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=pd(e,null,r,n):xa(t,e,r,n),e.child;case 11:return r=e.type,a=e.pendingProps,a=e.elementType===r?a:Yi(r,a),NR(t,e,r,a,n);case 7:return xa(t,e,e.pendingProps,n),e.child;case 8:return xa(t,e,e.pendingProps.children,n),e.child;case 12:return xa(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,a=e.pendingProps,i=e.memoizedProps,o=a.value,fn(f1,r._currentValue),r._currentValue=o,i!==null)if(Ki(i.value,o)){if(i.children===a.children&&!$a.current){e=us(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var s=i.dependencies;if(s!==null){o=i.child;for(var l=s.firstContext;l!==null;){if(l.context===r){if(i.tag===1){l=ls(-1,n&-n),l.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?l.next=l:(l.next=c.next,c.next=l),u.pending=l}}i.lanes|=n,l=i.alternate,l!==null&&(l.lanes|=n),LS(i.return,n,e),s.lanes|=n;break}l=l.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(Se(341));o.lanes|=n,s=o.alternate,s!==null&&(s.lanes|=n),LS(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}xa(t,e,a.children,n),e=e.child}return e;case 9:return a=e.type,r=e.pendingProps.children,dd(e,n),a=bi(a),r=r(a),e.flags|=1,xa(t,e,r,n),e.child;case 14:return r=e.type,a=Yi(r,e.pendingProps),a=Yi(r.type,a),TR(t,e,r,a,n);case 15:return IR(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,a=e.pendingProps,a=e.elementType===r?a:Yi(r,a),I1(t,e),e.tag=1,Ra(r)?(t=!0,u1(e)):t=!1,dd(e,n),q$(e,r,a),VS(e,r,a,n),rC(null,e,r,!0,t,n);case 19:return PR(t,e,n);case 22:return ER(t,e,n)}throw Error(Se(156,e.tag))};function oM(t,e){return LO(t,e)}function OH(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function wi(t,e,n,r){return new OH(t,e,n,r)}function kC(t){return t=t.prototype,!(!t||!t.isReactComponent)}function $H(t){if(typeof t=="function")return kC(t)?1:0;if(t!=null){if(t=t.$$typeof,t===_k)return 11;if(t===Rk)return 14}return 2}function ml(t,e){var n=t.alternate;return n===null?(n=wi(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function F1(t,e,n,r,a,i){var o=2;if(r=t,typeof t=="function")kC(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case qc:return Iu(n.children,a,i,e);case Ik:o=8,a|=8;break;case Ek:return t=wi(12,n,e,a|2),t.elementType=Ek,t.lanes=i,t;case Ok:return t=wi(13,n,e,a),t.elementType=Ok,t.lanes=i,t;case $k:return t=wi(19,n,e,a),t.elementType=$k,t.lanes=i,t;case hO:return B1(n,a,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case dO:o=10;break e;case pO:o=9;break e;case _k:o=11;break e;case Rk:o=14;break e;case Ys:o=16,r=null;break e}throw Error(Se(130,t==null?t:typeof t,""))}return e=wi(o,n,e,a),e.elementType=t,e.type=r,e.lanes=i,e}function Iu(t,e,n,r){return t=wi(7,t,r,e),t.lanes=n,t}function B1(t,e,n,r){return t=wi(22,t,r,e),t.elementType=hO,t.lanes=n,t.stateNode={isHidden:!1},t}function SC(t,e,n){return t=wi(6,t,null,e),t.lanes=n,t}function CC(t,e,n){return e=wi(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function RH(t,e,n,r,a){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Zk(0),this.expirationTimes=Zk(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Zk(0),this.identifierPrefix=r,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function NC(t,e,n,r,a,i,o,s,l){return t=new RH(t,e,n,s,l),e===1?(e=1,i===!0&&(e|=8)):e=0,i=wi(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},BS(i),t}function MH(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Hc,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function sM(t){if(!t)return ol;t=t._reactInternals;e:{if(mu(t)!==t||t.tag!==1)throw Error(Se(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Ra(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Se(171))}if(t.tag===1){var n=t.type;if(Ra(n))return M$(t,n,e)}return e}function lM(t,e,n,r,a,i,o,s,l){return t=NC(n,r,!0,t,a,i,o,s,l),t.context=sM(null),n=t.current,r=wa(),a=hl(n),i=ls(r,a),i.callback=e??null,ul(n,i,a),t.current.lanes=a,vh(t,a,r),Pa(t,r),t}function z1(t,e,n,r){var a=e.current,i=wa(),o=hl(a);return n=sM(n),e.context===null?e.context=n:e.pendingContext=n,e=ls(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=ul(a,e,o),t!==null&&(Ji(t,a,o,i),g1(t,a,o)),o}function V1(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function uM(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function TC(t,e){uM(t,e),(t=t.alternate)&&uM(t,e)}function AH(){return null}var cM=typeof reportError=="function"?reportError:function(t){console.error(t)};function IC(t){this._internalRoot=t}W1.prototype.render=IC.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Se(409));z1(t,e,null,null)},W1.prototype.unmount=IC.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Cu(function(){z1(null,t,null,null)}),e[rs]=null}};function W1(t){this._internalRoot=t}W1.prototype.unstable_scheduleHydration=function(t){if(t){var e=GO();t={blockedOn:null,target:t,priority:e};for(var n=0;n<tl.length&&e!==0&&e<tl[n].priority;n++);tl.splice(n,0,t),n===0&&KO(t)}};function EC(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function j1(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function dM(){}function PH(t,e,n,r,a){if(a){if(typeof r=="function"){var i=r;r=function(){var u=V1(o);i.call(u)}}var o=lM(e,r,t,0,null,!1,!1,"",dM);return t._reactRootContainer=o,t[rs]=o.current,Mh(t.nodeType===8?t.parentNode:t),Cu(),o}for(;a=t.lastChild;)t.removeChild(a);if(typeof r=="function"){var s=r;r=function(){var u=V1(l);s.call(u)}}var l=NC(t,0,!1,null,null,!1,!1,"",dM);return t._reactRootContainer=l,t[rs]=l.current,Mh(t.nodeType===8?t.parentNode:t),Cu(function(){z1(e,l,n,r)}),l}function U1(t,e,n,r,a){var i=n._reactRootContainer;if(i){var o=i;if(typeof a=="function"){var s=a;a=function(){var l=V1(o);s.call(l)}}z1(e,o,t,a)}else o=PH(n,e,t,a,r);return V1(o)}jO=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=bh(e.pendingLanes);n!==0&&(Jk(e,n|1),Pa(e,qn()),!(Dt&6)&&(yd=qn()+500,sl()))}break;case 13:Cu(function(){var r=ss(t,1);if(r!==null){var a=wa();Ji(r,t,1,a)}}),TC(t,1)}},eS=function(t){if(t.tag===13){var e=ss(t,134217728);if(e!==null){var n=wa();Ji(e,t,134217728,n)}TC(t,134217728)}},UO=function(t){if(t.tag===13){var e=hl(t),n=ss(t,e);if(n!==null){var r=wa();Ji(n,t,e,r)}TC(t,e)}},GO=function(){return Zt},HO=function(t,e){var n=Zt;try{return Zt=t,e()}finally{Zt=n}},Hk=function(t,e,n){switch(e){case"input":if(Fk(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var a=s1(r);if(!a)throw Error(Se(90));gO(r),Fk(r,a)}}}break;case"textarea":wO(t,n);break;case"select":e=n.value,e!=null&&Kc(t,!!n.multiple,e,!1)}},OO=vC,$O=Cu;var DH={usingClientEntryPoint:!1,Events:[Dh,ad,s1,EO,_O,vC]},Yh={findFiberByHostInstance:gu,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},LH={bundleType:Yh.bundleType,version:Yh.version,rendererPackageName:Yh.rendererPackageName,rendererConfig:Yh.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ns.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=PO(t),t===null?null:t.stateNode},findFiberByHostInstance:Yh.findFiberByHostInstance||AH,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var G1=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!G1.isDisabled&&G1.supportsFiber)try{W0=G1.inject(LH),So=G1}catch{}}Ka.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=DH,Ka.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!EC(e))throw Error(Se(200));return MH(t,e,null,n)},Ka.createRoot=function(t,e){if(!EC(t))throw Error(Se(299));var n=!1,r="",a=cM;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(a=e.onRecoverableError)),e=NC(t,1,!1,null,null,n,!1,r,a),t[rs]=e.current,Mh(t.nodeType===8?t.parentNode:t),new IC(e)},Ka.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Se(188)):(t=Object.keys(t).join(","),Error(Se(268,t)));return t=PO(e),t=t===null?null:t.stateNode,t},Ka.flushSync=function(t){return Cu(t)},Ka.hydrate=function(t,e,n){if(!j1(e))throw Error(Se(200));return U1(null,t,e,!0,n)},Ka.hydrateRoot=function(t,e,n){if(!EC(t))throw Error(Se(405));var r=n!=null&&n.hydratedSources||null,a=!1,i="",o=cM;if(n!=null&&(n.unstable_strictMode===!0&&(a=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=lM(e,null,t,1,n??null,a,!1,i,o),t[rs]=e.current,Mh(t),r)for(t=0;t<r.length;t++)n=r[t],a=n._getVersion,a=a(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,a]:e.mutableSourceEagerHydrationData.push(n,a);return new W1(e)},Ka.render=function(t,e,n){if(!j1(e))throw Error(Se(200));return U1(null,t,e,!1,n)},Ka.unmountComponentAtNode=function(t){if(!j1(t))throw Error(Se(40));return t._reactRootContainer?(Cu(function(){U1(null,null,t,!1,function(){t._reactRootContainer=null,t[rs]=null})}),!0):!1},Ka.unstable_batchedUpdates=vC,Ka.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!j1(n))throw Error(Se(200));if(t==null||t._reactInternals===void 0)throw Error(Se(38));return U1(t,e,n,!1,r)},Ka.version="18.2.0-next-9e3b772b8-20220608";function pM(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(pM)}catch(t){console.error(t)}}pM(),aO.exports=Ka;var H1=aO.exports;const FH=Hi(H1);var hM,fM=H1;hM=fM.createRoot,fM.hydrateRoot;function BH(){if(console&&console.warn){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];typeof e[0]=="string"&&(e[0]=`react-i18next:: ${e[0]}`),console.warn(...e)}}const mM={};function _C(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];typeof e[0]=="string"&&mM[e[0]]||(typeof e[0]=="string"&&(mM[e[0]]=new Date),BH(...e))}const gM=(t,e)=>()=>{if(t.isInitialized)e();else{const n=()=>{setTimeout(()=>{t.off("initialized",n)},0),e()};t.on("initialized",n)}};function yM(t,e,n){t.loadNamespaces(e,gM(t,n))}function bM(t,e,n,r){typeof n=="string"&&(n=[n]),n.forEach(a=>{t.options.ns.indexOf(a)<0&&t.options.ns.push(a)}),t.loadLanguages(e,gM(t,r))}function zH(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=e.languages[0],a=e.options?e.options.fallbackLng:!1,i=e.languages[e.languages.length-1];if(r.toLowerCase()==="cimode")return!0;const o=(s,l)=>{const u=e.services.backendConnector.state[`${s}|${l}`];return u===-1||u===2};return n.bindI18n&&n.bindI18n.indexOf("languageChanging")>-1&&e.services.backendConnector.backend&&e.isLanguageChangingTo&&!o(e.isLanguageChangingTo,t)?!1:!!(e.hasResourceBundle(r,t)||!e.services.backendConnector.backend||e.options.resources&&!e.options.partialBundledLanguages||o(r,t)&&(!a||o(i,t)))}function VH(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return!e.languages||!e.languages.length?(_C("i18n.languages were undefined or empty",e.languages),!0):e.options.ignoreJSONStructure!==void 0?e.hasLoadedNamespace(t,{lng:n.lng,precheck:(r,a)=>{if(n.bindI18n&&n.bindI18n.indexOf("languageChanging")>-1&&r.services.backendConnector.backend&&r.isLanguageChangingTo&&!a(r.isLanguageChangingTo,t))return!1}}):zH(t,e,n)}const WH=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,jH={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"\xA9","&#169;":"\xA9","&reg;":"\xAE","&#174;":"\xAE","&hellip;":"\u2026","&#8230;":"\u2026","&#x2F;":"/","&#47;":"/"},UH=t=>jH[t],GH=t=>t.replace(WH,UH);let HH={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape:GH};function qH(){return HH}let KH;function XH(){return KH}const vM=P.createContext();class YH{constructor(){this.usedNamespaces={}}addUsedNamespaces(e){e.forEach(n=>{this.usedNamespaces[n]||(this.usedNamespaces[n]=!0)})}getUsedNamespaces(){return Object.keys(this.usedNamespaces)}}const QH=(t,e)=>{const n=P.useRef();return P.useEffect(()=>{n.current=e?n.current:t},[t,e]),n.current};function xM(t,e,n,r){return t.getFixedT(e,n,r)}function ZH(t,e,n,r){return P.useCallback(xM(t,e,n,r),[t,e,n,r])}function Qh(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{i18n:n}=e,{i18n:r,defaultNS:a}=P.useContext(vM)||{},i=n||r||XH();if(i&&!i.reportNamespaces&&(i.reportNamespaces=new YH),!i){_C("You will need to pass in an i18next instance by using initReactI18next");const C=(_,E)=>typeof E=="string"?E:E&&typeof E=="object"&&typeof E.defaultValue=="string"?E.defaultValue:Array.isArray(_)?_[_.length-1]:_,I=[C,{},!1];return I.t=C,I.i18n={},I.ready=!1,I}i.options.react&&i.options.react.wait!==void 0&&_C("It seems you are still using the old wait option, you may migrate to the new useSuspense behaviour.");const o={...qH(),...i.options.react,...e},{useSuspense:s,keyPrefix:l}=o;let u=t||a||i.options&&i.options.defaultNS;u=typeof u=="string"?[u]:u||["translation"],i.reportNamespaces.addUsedNamespaces&&i.reportNamespaces.addUsedNamespaces(u);const c=(i.isInitialized||i.initializedStoreOnce)&&u.every(C=>VH(C,i,o)),d=ZH(i,e.lng||null,o.nsMode==="fallback"?u:u[0],l),p=()=>d,f=()=>xM(i,e.lng||null,o.nsMode==="fallback"?u:u[0],l),[g,y]=P.useState(p);let x=u.join();e.lng&&(x=`${e.lng}${x}`);const b=QH(x),v=P.useRef(!0);P.useEffect(()=>{const{bindI18n:C,bindI18nStore:I}=o;v.current=!0,!c&&!s&&(e.lng?bM(i,e.lng,u,()=>{v.current&&y(f)}):yM(i,u,()=>{v.current&&y(f)})),c&&b&&b!==x&&v.current&&y(f);function _(){v.current&&y(f)}return C&&i&&i.on(C,_),I&&i&&i.store.on(I,_),()=>{v.current=!1,C&&i&&C.split(" ").forEach(E=>i.off(E,_)),I&&i&&I.split(" ").forEach(E=>i.store.off(E,_))}},[i,x]);const w=P.useRef(!0);P.useEffect(()=>{v.current&&!w.current&&y(p),w.current=!1},[i,l]);const S=[g,i,c];if(S.t=g,S.i18n=i,S.ready=c,c||!c&&!s)return S;throw new Promise(C=>{e.lng?bM(i,e.lng,u,()=>C()):yM(i,u,()=>C())})}function JH(t){let{i18n:e,defaultNS:n,children:r}=t;const a=P.useMemo(()=>({i18n:e,defaultNS:n}),[e,n]);return P.createElement(vM.Provider,{value:a},r)}/**
* @remix-run/router v1.15.0
*
* Copyright (c) Remix Software Inc.
*
* This source code is licensed under the MIT license found in the
* LICENSE.md file in the root directory of this source tree.
*
* @license MIT
*/function Zh(){return Zh=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Zh.apply(this,arguments)}var gl;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(gl||(gl={}));const wM="popstate";function eq(t){t===void 0&&(t={});function e(r,a){let{pathname:i,search:o,hash:s}=r.location;return $C("",{pathname:i,search:o,hash:s},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function n(r,a){return typeof a=="string"?a:q1(a)}return nq(e,n,null,t)}function Pn(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function OC(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function tq(){return Math.random().toString(36).substr(2,8)}function kM(t,e){return{usr:t.state,key:t.key,idx:e}}function $C(t,e,n,r){return n===void 0&&(n=null),Zh({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?vd(e):e,{state:n,key:e&&e.key||r||tq()})}function q1(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function vd(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function nq(t,e,n,r){r===void 0&&(r={});let{window:a=document.defaultView,v5Compat:i=!1}=r,o=a.history,s=gl.Pop,l=null,u=c();u==null&&(u=0,o.replaceState(Zh({},o.state,{idx:u}),""));function c(){return(o.state||{idx:null}).idx}function d(){s=gl.Pop;let x=c(),b=x==null?null:x-u;u=x,l&&l({action:s,location:y.location,delta:b})}function p(x,b){s=gl.Push;let v=$C(y.location,x,b);n&&n(v,x),u=c()+1;let w=kM(v,u),S=y.createHref(v);try{o.pushState(w,"",S)}catch(C){if(C instanceof DOMException&&C.name==="DataCloneError")throw C;a.location.assign(S)}i&&l&&l({action:s,location:y.location,delta:1})}function f(x,b){s=gl.Replace;let v=$C(y.location,x,b);n&&n(v,x),u=c();let w=kM(v,u),S=y.createHref(v);o.replaceState(w,"",S),i&&l&&l({action:s,location:y.location,delta:0})}function g(x){let b=a.location.origin!=="null"?a.location.origin:a.location.href,v=typeof x=="string"?x:q1(x);return Pn(b,"No window.location.(origin|href) available to create URL for href: "+v),new URL(v,b)}let y={get action(){return s},get location(){return t(a,o)},listen(x){if(l)throw new Error("A history only accepts one active listener");return a.addEventListener(wM,d),l=x,()=>{a.removeEventListener(wM,d),l=null}},createHref(x){return e(a,x)},createURL:g,encodeLocation(x){let b=g(x);return{pathname:b.pathname,search:b.search,hash:b.hash}},push:p,replace:f,go(x){return o.go(x)}};return y}var SM;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(SM||(SM={}));function rq(t,e,n){n===void 0&&(n="/");let r=typeof e=="string"?vd(e):e,a=xd(r.pathname||"/",n);if(a==null)return null;let i=CM(t);aq(i);let o=null;for(let s=0;o==null&&s<i.length;++s)o=hq(i[s],mq(a));return o}function CM(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let a=(i,o,s)=>{let l={relativePath:s===void 0?i.path||"":s,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};l.relativePath.startsWith("/")&&(Pn(l.relativePath.startsWith(r),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(r.length));let u=yl([r,l.relativePath]),c=n.concat(l);i.children&&i.children.length>0&&(Pn(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),CM(i.children,e,c,u)),!(i.path==null&&!i.index)&&e.push({path:u,score:dq(u,i.index),routesMeta:c})};return t.forEach((i,o)=>{var s;if(i.path===""||!((s=i.path)!=null&&s.includes("?")))a(i,o);else for(let l of NM(i.path))a(i,o,l)}),e}function NM(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,a=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return a?[i,""]:[i];let o=NM(r.join("/")),s=[];return s.push(...o.map(l=>l===""?i:[i,l].join("/"))),a&&s.push(...o),s.map(l=>t.startsWith("/")&&l===""?"/":l)}function aq(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:pq(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const iq=/^:[\w-]+$/,oq=3,sq=2,lq=1,uq=10,cq=-2,TM=t=>t==="*";function dq(t,e){let n=t.split("/"),r=n.length;return n.some(TM)&&(r+=cq),e&&(r+=sq),n.filter(a=>!TM(a)).reduce((a,i)=>a+(iq.test(i)?oq:i===""?lq:uq),r)}function pq(t,e){return t.length===e.length&&t.slice(0,-1).every((n,r)=>n===e[r])?t[t.length-1]-e[e.length-1]:0}function hq(t,e){let{routesMeta:n}=t,r={},a="/",i=[];for(let o=0;o<n.length;++o){let s=n[o],l=o===n.length-1,u=a==="/"?e:e.slice(a.length)||"/",c=K1({path:s.relativePath,caseSensitive:s.caseSensitive,end:l},u);if(!c)return null;Object.assign(r,c.params);let d=s.route;i.push({params:r,pathname:yl([a,c.pathname]),pathnameBase:xq(yl([a,c.pathnameBase])),route:d}),c.pathnameBase!=="/"&&(a=yl([a,c.pathnameBase]))}return i}function K1(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=fq(t.path,t.caseSensitive,t.end),a=e.match(n);if(!a)return null;let i=a[0],o=i.replace(/(.)\/+$/,"$1"),s=a.slice(1);return{params:r.reduce((l,u,c)=>{let{paramName:d,isOptional:p}=u;if(d==="*"){let g=s[c]||"";o=i.slice(0,i.length-g.length).replace(/(.)\/+$/,"$1")}const f=s[c];return p&&!f?l[d]=void 0:l[d]=gq(f||"",d),l},{}),pathname:i,pathnameBase:o,pattern:t}}function fq(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),OC(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],a="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,o,s)=>(r.push({paramName:o,isOptional:s!=null}),s?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),a+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":t!==""&&t!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),r]}function mq(t){try{return decodeURI(t)}catch(e){return OC(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function gq(t,e){try{return decodeURIComponent(t)}catch(n){return OC(!1,'The value for the URL param "'+e+'" will not be decoded because'+(' the string "'+t+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+n+").")),t}}function xd(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function yq(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:a=""}=typeof t=="string"?vd(t):t;return{pathname:n?n.startsWith("/")?n:bq(n,e):e,search:wq(r),hash:kq(a)}}function bq(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(r=>{r===".."?n.length>1&&n.pop():r!=="."&&n.push(r)}),n.length>1?n.join("/"):"/"}function RC(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function vq(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function IM(t,e){let n=vq(t);return e?n.map((r,a)=>a===t.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function EM(t,e,n,r){r===void 0&&(r=!1);let a;typeof t=="string"?a=vd(t):(a=Zh({},t),Pn(!a.pathname||!a.pathname.includes("?"),RC("?","pathname","search",a)),Pn(!a.pathname||!a.pathname.includes("#"),RC("#","pathname","hash",a)),Pn(!a.search||!a.search.includes("#"),RC("#","search","hash",a)));let i=t===""||a.pathname==="",o=i?"/":a.pathname,s;if(o==null)s=n;else{let d=e.length-1;if(!r&&o.startsWith("..")){let p=o.split("/");for(;p[0]==="..";)p.shift(),d-=1;a.pathname=p.join("/")}s=d>=0?e[d]:"/"}let l=yq(a,s),u=o&&o!=="/"&&o.endsWith("/"),c=(i||o===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(u||c)&&(l.pathname+="/"),l}const yl=t=>t.join("/").replace(/\/\/+/g,"/"),xq=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),wq=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,kq=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function Sq(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const _M=["post","put","patch","delete"];new Set(_M);const Cq=["get",..._M];new Set(Cq);/**
* React Router v6.22.0
*
* Copyright (c) Remix Software Inc.
*
* This source code is licensed under the MIT license found in the
* LICENSE.md file in the root directory of this source tree.
*
* @license MIT
*/function Jh(){return Jh=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Jh.apply(this,arguments)}const X1=P.createContext(null),OM=P.createContext(null),bl=P.createContext(null),Y1=P.createContext(null),vl=P.createContext({outlet:null,matches:[],isDataRoute:!1}),$M=P.createContext(null);function Nq(t,e){let{relative:n}=e===void 0?{}:e;wd()||Pn(!1);let{basename:r,navigator:a}=P.useContext(bl),{hash:i,pathname:o,search:s}=ki(t,{relative:n}),l=o;return r!=="/"&&(l=o==="/"?r:yl([r,o])),a.createHref({pathname:l,search:s,hash:i})}function wd(){return P.useContext(Y1)!=null}function kd(){return wd()||Pn(!1),P.useContext(Y1).location}function xl(t){wd()||Pn(!1);let{pathname:e}=kd();return P.useMemo(()=>K1(t,e),[e,t])}function RM(t){P.useContext(bl).static||P.useLayoutEffect(t)}function Tq(){let{isDataRoute:t}=P.useContext(vl);return t?Vq():Iq()}function Iq(){wd()||Pn(!1);let t=P.useContext(X1),{basename:e,future:n,navigator:r}=P.useContext(bl),{matches:a}=P.useContext(vl),{pathname:i}=kd(),o=JSON.stringify(IM(a,n.v7_relativeSplatPath)),s=P.useRef(!1);return RM(()=>{s.current=!0}),P.useCallback(function(l,u){if(u===void 0&&(u={}),!s.current)return;if(typeof l=="number"){r.go(l);return}let c=EM(l,JSON.parse(o),i,u.relative==="path");t==null&&e!=="/"&&(c.pathname=c.pathname==="/"?e:yl([e,c.pathname])),(u.replace?r.replace:r.push)(c,u.state,u)},[e,r,o,i,t])}const Eq=P.createContext(null);function _q(t){let e=P.useContext(vl).outlet;return e&&P.createElement(Eq.Provider,{value:t},e)}function ki(t,e){let{relative:n}=e===void 0?{}:e,{future:r}=P.useContext(bl),{matches:a}=P.useContext(vl),{pathname:i}=kd(),o=JSON.stringify(IM(a,r.v7_relativeSplatPath));return P.useMemo(()=>EM(t,JSON.parse(o),i,n==="path"),[t,o,i,n])}function Oq(t,e){return $q(t,e)}function $q(t,e,n,r){wd()||Pn(!1);let{navigator:a}=P.useContext(bl),{matches:i}=P.useContext(vl),o=i[i.length-1],s=o?o.params:{};o&&o.pathname;let l=o?o.pathnameBase:"/";o&&o.route;let u=kd(),c;if(e){var d;let x=typeof e=="string"?vd(e):e;l==="/"||(d=x.pathname)!=null&&d.startsWith(l)||Pn(!1),c=x}else c=u;let p=c.pathname||"/",f=l==="/"?p:p.slice(l.length)||"/",g=rq(t,{pathname:f}),y=Dq(g&&g.map(x=>Object.assign({},x,{params:Object.assign({},s,x.params),pathname:yl([l,a.encodeLocation?a.encodeLocation(x.pathname).pathname:x.pathname]),pathnameBase:x.pathnameBase==="/"?l:yl([l,a.encodeLocation?a.encodeLocation(x.pathnameBase).pathname:x.pathnameBase])})),i,n,r);return e&&y?P.createElement(Y1.Provider,{value:{location:Jh({pathname:"/",search:"",hash:"",state:null,key:"default"},c),navigationType:gl.Pop}},y):y}function Rq(){let t=zq(),e=Sq(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,r={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return P.createElement(P.Fragment,null,P.createElement("h2",null,"Unexpected Application Error!"),P.createElement("h3",{style:{fontStyle:"italic"}},e),n?P.createElement("pre",{style:r},n):null,null)}const Mq=P.createElement(Rq,null);class Aq extends P.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?P.createElement(vl.Provider,{value:this.props.routeContext},P.createElement($M.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Pq(t){let{routeContext:e,match:n,children:r}=t,a=P.useContext(X1);return a&&a.static&&a.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=n.route.id),P.createElement(vl.Provider,{value:e},r)}function Dq(t,e,n,r){var a;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var i;if((i=n)!=null&&i.errors)t=n.matches;else return null}let o=t,s=(a=n)==null?void 0:a.errors;if(s!=null){let c=o.findIndex(d=>d.route.id&&s?.[d.route.id]);c>=0||Pn(!1),o=o.slice(0,Math.min(o.length,c+1))}let l=!1,u=-1;if(n&&r&&r.v7_partialHydration)for(let c=0;c<o.length;c++){let d=o[c];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(u=c),d.route.id){let{loaderData:p,errors:f}=n,g=d.route.loader&&p[d.route.id]===void 0&&(!f||f[d.route.id]===void 0);if(d.route.lazy||g){l=!0,u>=0?o=o.slice(0,u+1):o=[o[0]];break}}}return o.reduceRight((c,d,p)=>{let f,g=!1,y=null,x=null;n&&(f=s&&d.route.id?s[d.route.id]:void 0,y=d.route.errorElement||Mq,l&&(u<0&&p===0?(Wq("route-fallback",!1),g=!0,x=null):u===p&&(g=!0,x=d.route.hydrateFallbackElement||null)));let b=e.concat(o.slice(0,p+1)),v=()=>{let w;return f?w=y:g?w=x:d.route.Component?w=P.createElement(d.route.Component,null):d.route.element?w=d.route.element:w=c,P.createElement(Pq,{match:d,routeContext:{outlet:c,matches:b,isDataRoute:n!=null},children:w})};return n&&(d.route.ErrorBoundary||d.route.errorElement||p===0)?P.createElement(Aq,{location:n.location,revalidation:n.revalidation,component:y,error:f,children:v(),routeContext:{outlet:null,matches:b,isDataRoute:!0}}):v()},null)}var MM=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(MM||{}),Q1=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(Q1||{});function Lq(t){let e=P.useContext(X1);return e||Pn(!1),e}function Fq(t){let e=P.useContext(OM);return e||Pn(!1),e}function Bq(t){let e=P.useContext(vl);return e||Pn(!1),e}function AM(t){let e=Bq(),n=e.matches[e.matches.length-1];return n.route.id||Pn(!1),n.route.id}function zq(){var t;let e=P.useContext($M),n=Fq(Q1.UseRouteError),r=AM(Q1.UseRouteError);return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}function Vq(){let{router:t}=Lq(MM.UseNavigateStable),e=AM(Q1.UseNavigateStable),n=P.useRef(!1);return RM(()=>{n.current=!0}),P.useCallback(function(r,a){a===void 0&&(a={}),n.current&&(typeof r=="number"?t.navigate(r):t.navigate(r,Jh({fromRouteId:e},a)))},[t,e])}const PM={};function Wq(t,e,n){!e&&!PM[t]&&(PM[t]=!0)}function jq(t){return _q(t.context)}function Sd(t){Pn(!1)}function Uq(t){let{basename:e="/",children:n=null,location:r,navigationType:a=gl.Pop,navigator:i,static:o=!1,future:s}=t;wd()&&Pn(!1);let l=e.replace(/^\/*/,"/"),u=P.useMemo(()=>({basename:l,navigator:i,static:o,future:Jh({v7_relativeSplatPath:!1},s)}),[l,s,i,o]);typeof r=="string"&&(r=vd(r));let{pathname:c="/",search:d="",hash:p="",state:f=null,key:g="default"}=r,y=P.useMemo(()=>{let x=xd(c,l);return x==null?null:{location:{pathname:x,search:d,hash:p,state:f,key:g},navigationType:a}},[l,c,d,p,f,g,a]);return y==null?null:P.createElement(bl.Provider,{value:u},P.createElement(Y1.Provider,{children:n,value:y}))}function Gq(t){let{children:e,location:n}=t;return Oq(MC(e),n)}new Promise(()=>{});function MC(t,e){e===void 0&&(e=[]);let n=[];return P.Children.forEach(t,(r,a)=>{if(!P.isValidElement(r))return;let i=[...e,a];if(r.type===P.Fragment){n.push.apply(n,MC(r.props.children,i));return}r.type!==Sd&&Pn(!1),!r.props.index||!r.props.children||Pn(!1);let o={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=MC(r.props.children,i)),n.push(o)}),n}/**
* React Router DOM v6.22.0
*
* Copyright (c) Remix Software Inc.
*
* This source code is licensed under the MIT license found in the
* LICENSE.md file in the root directory of this source tree.
*
* @license MIT
*/function Z1(){return Z1=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Z1.apply(this,arguments)}function DM(t,e){if(t==null)return{};var n={},r=Object.keys(t),a,i;for(i=0;i<r.length;i++)a=r[i],!(e.indexOf(a)>=0)&&(n[a]=t[a]);return n}function Hq(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function qq(t,e){return t.button===0&&(!e||e==="_self")&&!Hq(t)}const Kq=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","unstable_viewTransition"],Xq=["aria-current","caseSensitive","className","end","style","to","unstable_viewTransition","children"],Yq="6";try{window.__reactRouterVersion=Yq}catch{}const Qq=P.createContext({isTransitioning:!1}),Zq="startTransition",LM=k5[Zq];function Jq(t){let{basename:e,children:n,future:r,window:a}=t,i=P.useRef();i.current==null&&(i.current=eq({window:a,v5Compat:!0}));let o=i.current,[s,l]=P.useState({action:o.action,location:o.location}),{v7_startTransition:u}=r||{},c=P.useCallback(d=>{u&&LM?LM(()=>l(d)):l(d)},[l,u]);return P.useLayoutEffect(()=>o.listen(c),[o,c]),P.createElement(Uq,{basename:e,children:n,location:s.location,navigationType:s.action,navigator:o,future:r})}const eK=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",tK=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,J1=P.forwardRef(function(t,e){let{onClick:n,relative:r,reloadDocument:a,replace:i,state:o,target:s,to:l,preventScrollReset:u,unstable_viewTransition:c}=t,d=DM(t,Kq),{basename:p}=P.useContext(bl),f,g=!1;if(typeof l=="string"&&tK.test(l)&&(f=l,eK))try{let v=new URL(window.location.href),w=l.startsWith("//")?new URL(v.protocol+l):new URL(l),S=xd(w.pathname,p);w.origin===v.origin&&S!=null?l=S+w.search+w.hash:g=!0}catch{}let y=Nq(l,{relative:r}),x=rK(l,{replace:i,state:o,target:s,preventScrollReset:u,relative:r,unstable_viewTransition:c});function b(v){n&&n(v),v.defaultPrevented||x(v)}return P.createElement("a",Z1({},d,{href:f||y,onClick:g||a?n:b,ref:e,target:s}))}),ey=P.forwardRef(function(t,e){let{"aria-current":n="page",caseSensitive:r=!1,className:a="",end:i=!1,style:o,to:s,unstable_viewTransition:l,children:u}=t,c=DM(t,Xq),d=ki(s,{relative:c.relative}),p=kd(),f=P.useContext(OM),{navigator:g,basename:y}=P.useContext(bl),x=f!=null&&aK(d)&&l===!0,b=g.encodeLocation?g.encodeLocation(d).pathname:d.pathname,v=p.pathname,w=f&&f.navigation&&f.navigation.location?f.navigation.location.pathname:null;r||(v=v.toLowerCase(),w=w?w.toLowerCase():null,b=b.toLowerCase()),w&&y&&(w=xd(w,y)||w);const S=b!=="/"&&b.endsWith("/")?b.length-1:b.length;let C=v===b||!i&&v.startsWith(b)&&v.charAt(S)==="/",I=w!=null&&(w===b||!i&&w.startsWith(b)&&w.charAt(b.length)==="/"),_={isActive:C,isPending:I,isTransitioning:x},E=C?n:void 0,A;typeof a=="function"?A=a(_):A=[a,C?"active":null,I?"pending":null,x?"transitioning":null].filter(Boolean).join(" ");let M=typeof o=="function"?o(_):o;return P.createElement(J1,Z1({},c,{"aria-current":E,className:A,ref:e,style:M,to:s,unstable_viewTransition:l}),typeof u=="function"?u(_):u)});var AC;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(AC||(AC={}));var FM;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(FM||(FM={}));function nK(t){let e=P.useContext(X1);return e||Pn(!1),e}function rK(t,e){let{target:n,replace:r,state:a,preventScrollReset:i,relative:o,unstable_viewTransition:s}=e===void 0?{}:e,l=Tq(),u=kd(),c=ki(t,{relative:o});return P.useCallback(d=>{if(qq(d,n)){d.preventDefault();let p=r!==void 0?r:q1(u)===q1(c);l(t,{replace:p,state:a,preventScrollReset:i,relative:o,unstable_viewTransition:s})}},[u,l,c,r,a,n,t,i,o,s])}function aK(t,e){e===void 0&&(e={});let n=P.useContext(Qq);n==null&&Pn(!1);let{basename:r}=nK(AC.useViewTransitionState),a=ki(t,{relative:e.relative});if(!n.isTransitioning)return!1;let i=xd(n.currentLocation.pathname,r)||n.currentLocation.pathname,o=xd(n.nextLocation.pathname,r)||n.nextLocation.pathname;return K1(a.pathname,o)!=null||K1(a.pathname,i)!=null}function iK({title:t,titleId:e,...n},r){return P.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},n),t?P.createElement("title",{id:e},t):null,P.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"}))}const oK=P.forwardRef(iK),sK=oK;function lK({title:t,titleId:e,...n},r){return P.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},n),t?P.createElement("title",{id:e},t):null,P.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m15 15-6 6m0 0-6-6m6 6V9a6 6 0 0 1 12 0v3"}))}const uK=P.forwardRef(lK),cK=uK;function dK({title:t,titleId:e,...n},r){return P.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},n),t?P.createElement("title",{id:e},t):null,P.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m9 9 6-6m0 0 6 6m-6-6v12a6 6 0 0 1-12 0v-3"}))}const pK=P.forwardRef(dK),hK=pK;function fK({title:t,titleId:e,...n},r){return P.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},n),t?P.createElement("title",{id:e},t):null,P.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 19.5 8.25 12l7.5-7.5"}))}const mK=P.forwardRef(fK),gK=mK;function yK({title:t,titleId:e,...n},r){return P.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},n),t?P.createElement("title",{id:e},t):null,P.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m8.25 4.5 7.5 7.5-7.5 7.5"}))}const bK=P.forwardRef(yK),vK=bK;function xK({title:t,titleId:e,...n},r){return P.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},n),t?P.createElement("title",{id:e},t):null,P.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7.498 15.25H4.372c-1.026 0-1.945-.694-2.054-1.715a12.137 12.137 0 0 1-.068-1.285c0-2.848.992-5.464 2.649-7.521C5.287 4.247 5.886 4 6.504 4h4.016a4.5 4.5 0 0 1 1.423.23l3.114 1.04a4.5 4.5 0 0 0 1.423.23h1.294M7.498 15.25c.618 0 .991.724.725 1.282A7.471 7.471 0 0 0 7.5 19.75 2.25 2.25 0 0 0 9.75 22a.75.75 0 0 0 .75-.75v-.633c0-.573.11-1.14.322-1.672.304-.76.93-1.33 1.653-1.715a9.04 9.04 0 0 0 2.86-2.4c.498-.634 1.226-1.08 2.032-1.08h.384m-10.253 1.5H9.7m8.075-9.75c.01.05.027.1.05.148.593 1.2.925 2.55.925 3.977 0 1.487-.36 2.89-.999 4.125m.023-8.25c-.076-.365.183-.75.575-.75h.908c.889 0 1.713.518 1.972 1.368.339 1.11.521 2.287.521 3.507 0 1.553-.295 3.036-.831 4.398-.306.774-1.086 1.227-1.918 1.227h-1.053c-.472 0-.745-.556-.5-.96a8.95 8.95 0 0 0 .303-.54"}))}const wK=P.forwardRef(xK),kK=wK;function SK({title:t,titleId:e,...n},r){return P.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},n),t?P.createElement("title",{id:e},t):null,P.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.633 10.25c.806 0 1.533-.446 2.031-1.08a9.041 9.041 0 0 1 2.861-2.4c.723-.384 1.35-.956 1.653-1.715a4.498 4.498 0 0 0 .322-1.672V2.75a.75.75 0 0 1 .75-.75 2.25 2.25 0 0 1 2.25 2.25c0 1.152-.26 2.243-.723 3.218-.266.558.107 1.282.725 1.282m0 0h3.126c1.026 0 1.945.694 2.054 1.715.045.422.068.85.068 1.285a11.95 11.95 0 0 1-2.649 7.521c-.388.482-.987.729-1.605.729H13.48c-.483 0-.964-.078-1.423-.23l-3.114-1.04a4.501 4.501 0 0 0-1.423-.23H5.904m10.598-9.75H14.25M5.904 18.5c.083.205.173.405.27.602.197.4-.078.898-.523.898h-.908c-.889 0-1.713-.518-1.972-1.368a12 12 0 0 1-.521-3.507c0-1.553.295-3.036.831-4.398C3.387 9.953 4.167 9.5 5 9.5h1.053c.472 0 .745.556.5.96a8.958 8.958 0 0 0-1.302 4.665c0 1.194.232 2.333.654 3.375Z"}))}const CK=P.forwardRef(SK),NK=CK;function TK({title:t,titleId:e,...n},r){return P.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},n),t?P.createElement("title",{id:e},t):null,P.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12Z"}))}const IK=P.forwardRef(TK),EK=IK;function _K({title:t,titleId:e,...n},r){return P.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},n),t?P.createElement("title",{id:e},t):null,P.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m2.25 12 8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25"}))}const OK=P.forwardRef(_K),$K=OK;function RK({title:t,titleId:e,...n},r){return P.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},n),t?P.createElement("title",{id:e},t):null,P.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m2.25 15.75 5.159-5.159a2.25 2.25 0 0 1 3.182 0l5.159 5.159m-1.5-1.5 1.409-1.409a2.25 2.25 0 0 1 3.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 0 0 1.5-1.5V6a1.5 1.5 0 0 0-1.5-1.5H3.75A1.5 1.5 0 0 0 2.25 6v12a1.5 1.5 0 0 0 1.5 1.5Zm10.5-11.25h.008v.008h-.008V8.25Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"}))}const MK=P.forwardRef(RK),AK=MK;function PK({title:t,titleId:e,...n},r){return P.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},n),t?P.createElement("title",{id:e},t):null,P.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7.217 10.907a2.25 2.25 0 1 0 0 2.186m0-2.186c.18.324.283.696.283 1.093s-.103.77-.283 1.093m0-2.186 9.566-5.314m-9.566 7.5 9.566 5.314m0 0a2.25 2.25 0 1 0 3.935 2.186 2.25 2.25 0 0 0-3.935-2.186Zm0-12.814a2.25 2.25 0 1 0 3.933-2.185 2.25 2.25 0 0 0-3.933 2.185Z"}))}const DK=P.forwardRef(PK),LK=DK;function FK({title:t,titleId:e,...n},r){return P.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},n),t?P.createElement("title",{id:e},t):null,P.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 8.25V6a2.25 2.25 0 0 0-2.25-2.25H6A2.25 2.25 0 0 0 3.75 6v8.25A2.25 2.25 0 0 0 6 16.5h2.25m8.25-8.25H18a2.25 2.25 0 0 1 2.25 2.25V18A2.25 2.25 0 0 1 18 20.25h-7.5A2.25 2.25 0 0 1 8.25 18v-1.5m8.25-8.25h-6a2.25 2.25 0 0 0-2.25 2.25v6"}))}const BK=P.forwardRef(FK),zK=BK;function VK({title:t,titleId:e,...n},r){return P.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},n),t?P.createElement("title",{id:e},t):null,P.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"}))}const WK=P.forwardRef(VK),jK=WK;var BM={exports:{}};(function(t,e){(function(n,r){r()})(ya,function(){function n(u,c){return typeof c>"u"?c={autoBom:!1}:typeof c!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),c={autoBom:!c}),c.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(u.type)?new Blob(["\uFEFF",u],{type:u.type}):u}function r(u,c,d){var p=new XMLHttpRequest;p.open("GET",u),p.responseType="blob",p.onload=function(){l(p.response,c,d)},p.onerror=function(){console.error("could not download file")},p.send()}function a(u){var c=new XMLHttpRequest;c.open("HEAD",u,!1);try{c.send()}catch{}return 200<=c.status&&299>=c.status}function i(u){try{u.dispatchEvent(new MouseEvent("click"))}catch{var c=document.createEvent("MouseEvents");c.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),u.dispatchEvent(c)}}var o=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof ya=="object"&&ya.global===ya?ya:void 0,s=o.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),l=o.saveAs||(typeof window!="object"||window!==o?function(){}:"download"in HTMLAnchorElement.prototype&&!s?function(u,c,d){var p=o.URL||o.webkitURL,f=document.createElement("a");c=c||u.name||"download",f.download=c,f.rel="noopener",typeof u=="string"?(f.href=u,f.origin===location.origin?i(f):a(f.href)?r(u,c,d):i(f,f.target="_blank")):(f.href=p.createObjectURL(u),setTimeout(function(){p.revokeObjectURL(f.href)},4e4),setTimeout(function(){i(f)},0))}:"msSaveOrOpenBlob"in navigator?function(u,c,d){if(c=c||u.name||"download",typeof u!="string")navigator.msSaveOrOpenBlob(n(u,d),c);else if(a(u))r(u,c,d);else{var p=document.createElement("a");p.href=u,p.target="_blank",setTimeout(function(){i(p)})}}:function(u,c,d,p){if(p=p||open("","_blank"),p&&(p.document.title=p.document.body.innerText="downloading..."),typeof u=="string")return r(u,c,d);var f=u.type==="application/octet-stream",g=/constructor/i.test(o.HTMLElement)||o.safari,y=/CriOS\/[\d]+/.test(navigator.userAgent);if((y||f&&g||s)&&typeof FileReader<"u"){var x=new FileReader;x.onloadend=function(){var w=x.result;w=y?w:w.replace(/^data:[^;]*;/,"data:attachment/file;"),p?p.location.href=w:location=w,p=null},x.readAsDataURL(u)}else{var b=o.URL||o.webkitURL,v=b.createObjectURL(u);p?p.location=v:location.href=v,p=null,setTimeout(function(){b.revokeObjectURL(v)},4e4)}});o.saveAs=l.saveAs=l,t.exports=l})})(BM);var UK=BM.exports;const ef=G.createContext({theme:"material",dark:!0,touchRipple:!0});function GK(t,e){return typeof window>"u"?P.useEffect(t,e):P.useLayoutEffect(t,e)}const zM=function(t,e){e===void 0&&(e=!0);const[n,r]=P.useState(t);return GK(()=>{if(e){if(t==="ios"||t==="material")n!==t&&r(t);else if(n==="parent"&&typeof window<"u"&&typeof document<"u"){const a=document.documentElement;a&&(a.classList.contains("ios")?r("ios"):(a.classList.contains("md")||a.classList.contains("material"))&&r("material"))}}},[t]),e?n:t},HK=t=>{const{theme:e,dark:n,touchRipple:r=!0,autoThemeDetection:a=!0,children:i}=t,o=zM(e,a);return G.createElement(ef.Provider,{value:{theme:o,dark:n,touchRipple:r}},i)};function R(){const t=[];for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];n.forEach(i=>{typeof i=="object"&&i.constructor===Object?Object.keys(i).forEach(o=>{i[o]&&t.push(o)}):Array.isArray(i)?t.push(...i):typeof i=="function"?t.push(i()):i&&i.value?t.push(i.value):i&&t.push(i)});const a=[];return t.forEach(i=>{a.indexOf(i)<0&&a.push(i)}),a.filter(i=>!!i).join(" ")}const Dn=function(t,e){return e===void 0&&(e=""),!e||typeof e!="string"?t:["static","relative","absolute","fixed","sticky"].filter(n=>e.indexOf(n)>=0).length>0?"":t},qK=(t,e,n)=>{const{safeAreas:r}=t;return R(e==="ios"&&"k-ios",e==="material"&&"k-material","k-app w-full h-full min-h-screen",r&&"safe-areas",Dn("relative",n),n)};function PC(){return PC=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},PC.apply(this,arguments)}const VM=P.forwardRef((t,e)=>{const{component:n="div",className:r,theme:a="material",dark:i=!0,touchRipple:o=!0,safeAreas:s=!0,children:l,...u}=t,c=P.useRef(null);P.useImperativeHandle(e,()=>({el:c.current}));const d=n,p={...u},f=zM(a),g=qK({...t,safeAreas:s},f,r);return G.createElement(HK,{theme:f,dark:i,touchRipple:o,autoThemeDetection:!1},G.createElement(d,PC({ref:c,className:g},p),l))});VM.displayName="App";const DC=(t,e,n)=>{if(typeof t=="string")return t;const r=[t.common,t[e]];return n&&t[n]&&(typeof t[n]=="string"?r.push(t[n]):r.push(t[n].common,t[n][e])),r},KK=(t,e,n)=>{const r={},a=["common","ios","material"];return Object.keys(t).forEach(i=>{const o=i==="base"?n:"";if(!(typeof t[i]!="string"&&Object.keys(t[i]).filter(l=>!a.includes(l)).length>0)){r[i]=R(DC(t[i],e),o);return}r[i]={};const s=DC(t[i],e);r[i].default=R(s,o),Object.keys(t[i]).filter(l=>!a.includes(l)).forEach(l=>{r[i][l]=R(s,DC(t[i],e,l),o)})}),r},Je=function(t){let{ios:e,material:n}=t===void 0?{}:t,r=P.useContext(ef).theme||"ios";return e&&(r="ios"),n&&(r="material"),(a,i)=>KK(a,r,i)},XK=(t,e)=>({base:{common:R("transition-transform z-40 left-1/2 bottom-0 transform -translate-x-1/2 max-w-md w-full overflow-hidden",Dn("fixed",e)),ios:"pt-2 px-2 pb-2-safe duration-300",material:"pb-safe last-child-hairline-b-none rounded-t-2xl duration-400 ease-material-in",opened:"",closed:"translate-y-full"},backdrop:{common:"fixed z-40 w-full h-full left-0 top-0 bg-black bg-opacity-50 duration-300",opened:"",closed:"opacity-0 pointer-events-none"}});function LC(){return LC=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},LC.apply(this,arguments)}const YK=P.forwardRef((t,e)=>{const{component:n="div",className:r,ios:a,material:i,opened:o,backdrop:s=!0,onBackdropClick:l,children:u,...c}=t,d=P.useRef(null);P.useImperativeHandle(e,()=>({el:d.current}));const p=o?"opened":"closed",f=n,g={...c},y=Je({ios:a,material:i})(XK(t,r),r);return G.createElement(G.Fragment,null,s&&G.createElement("div",{className:y.backdrop[p],onClick:l}),G.createElement(f,LC({ref:d,className:y.base[p]},g),u))});YK.displayName="Actions";const QK=t=>{const{dividers:e}=t;return{base:{common:"relative",ios:"mt-2 first:mt-0 last-child-hairline-b-none",material:R(e&&"hairline-b")}}};function FC(){return FC=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},FC.apply(this,arguments)}const ZK=P.forwardRef((t,e)=>{const{component:n="div",className:r,ios:a,material:i,dividers:o=!0,children:s,...l}=t,u=P.useRef(null);P.useImperativeHandle(e,()=>({el:u.current}));const c=n,d={...l},p=Je({ios:a,material:i})(QK({dividers:o,...t}),r);return G.createElement(c,FC({ref:u,className:p.base},d),s)});ZK.displayName="ActionsGroup";const Jt=function(t){let{ios:e,material:n}=t===void 0?{}:t,r=P.useContext(ef).theme||"ios";return e&&(r="ios"),n&&(r="material"),r};class JK{constructor(e,n,r){const a=this;if(!e)return;a.el=e;const{left:i,top:o,width:s,height:l}=e.getBoundingClientRect(),u={x:n-i,y:r-o};let c=Math.max((l**2+s**2)**.5,48);const d=e.classList.contains("k-touch-ripple-inset");d&&(c=Math.max(Math.min(s,l),48));const p=typeof window<"u"&&window.getComputedStyle(e,null).getPropertyValue("overflow")==="hidden";if(!d&&p){const g=((u.x-s/2)**2+(u.y-l/2)**2)**.5,y=(c/2+g)/(c/2);a.rippleTransform=`translate3d(0px, 0px, 0) scale(${y})`}else a.rippleTransform=`translate3d(${-u.x+s/2}px, ${-u.y+l/2}px, 0) scale(1)`;a.rippleWaveEl=document.createElement("span"),a.rippleWaveEl.classList.add("k-touch-ripple-wave"),a.rippleWaveEl.setAttribute("hidden",""),a.rippleWaveEl.style=`
      width: ${c}px;
      height: ${c}px;
      margin-top:-${c/2}px;
      margin-left:-${c/2}px;
      left:${u.x}px;
      top:${u.y}px; --k-ripple-transform: ${a.rippleTransform}`,e.insertAdjacentElement("afterbegin",a.rippleWaveEl);const f=()=>{a.rippleWaveEl.removeEventListener("animationend",f),a.rippleWaveEl&&(a.rippleWaveEl.classList.contains("k-touch-ripple-wave-out")||(a.rippleWaveEl.classList.add("k-touch-ripple-wave-in"),a.shouldBeRemoved&&a.out()))};return a.rippleWaveEl.addEventListener("animationend",f),a}destroy(){let e=this;e.rippleWaveEl&&e.el.removeChild(e.rippleWaveEl),Object.keys(e).forEach(n=>{e[n]=null,delete e[n]}),e=null}out(){const e=this,{rippleWaveEl:n}=this;clearTimeout(e.removeTimeout),n.classList.add("k-touch-ripple-wave-out"),e.removeTimeout=setTimeout(()=>{e.destroy()},300);const r=()=>{e.rippleWaveEl.removeEventListener("animationend",r),clearTimeout(e.removeTimeout),e.destroy()};e.rippleWaveEl.addEventListener("animationend",r)}remove(){const e=this;e.shouldBeRemoved||(e.removeTimeout=setTimeout(()=>{e.destroy()},400),e.shouldBeRemoved=!0,e.rippleWaveEl.classList.contains("k-touch-ripple-wave-in")&&e.out())}}const eo=(t,e,n)=>{const r=P.useContext(ef);n||(n=t);const a=P.useRef(null),i=()=>{a.current&&a.current.remove(),a.current=null},o=f=>{a.current=new JK(t.current,f.pageX,f.pageY)},s=()=>{i()},l=()=>{i()},u=()=>{if(!r.touchRipple)return;const f=n.current;f.addEventListener("pointerdown",o),f.addEventListener("pointermove",s),f.addEventListener("pointerup",l),f.addEventListener("pointercancel",l),f.addEventListener("contextmenu",l)},c=()=>{const f=n.current;f.removeEventListener("pointerdown",o),f.removeEventListener("pointermove",s),f.removeEventListener("pointerup",l),f.removeEventListener("pointercancel",l),f.removeEventListener("contextmenu",l)},d=()=>{!n||!n.current||!e||u()},p=()=>{!n||!n.current||!e||c()};P.useEffect(()=>(d(),()=>p()))},gt=()=>{const t=P.useContext(ef);return e=>t.dark?e:""},eX=(t,e,n)=>{const{fontSizeIos:r,fontSizeMaterial:a,bold:i,dividers:o}=t;return{base:{common:R("flex items-center w-full px-4 relative z-10 overflow-hidden",o&&"hairline-b"),ios:R("h-14",e.textIos,e.bgIos,e.activeBgIos,r,"first:rounded-t-xl last:rounded-b-xl justify-center",i&&"font-semibold"),material:R("h-12",e.textMaterial,e.bgMaterial,e.activeBgMaterial,a,"justify-start",n("dark:touch-ripple-white"),i&&"font-medium")}}},tX=function(t,e){return t===void 0&&(t={}),{bgIos:R("bg-white",e("dark:bg-neutral-800")),bgMaterial:R("bg-md-light-surface-3",e("dark:bg-md-dark-surface-3")),activeBgIos:R("active:bg-neutral-200",e("dark:active:bg-neutral-700")),activeBgMaterial:"",textIos:"text-primary",textMaterial:R("text-md-light-on-surface",e("dark:text-md-dark-on-surface")),...t}};function BC(){return BC=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},BC.apply(this,arguments)}const nX=P.forwardRef((t,e)=>{const{component:n="button",className:r,colors:a,ios:i,material:o,bold:s,boldIos:l=!1,boldMaterial:u=!1,fontSizeIos:c="text-xl",fontSizeMaterial:d="text-base",href:p,touchRipple:f=!0,dividers:g=void 0,children:y,...x}=t,b=P.useRef(null);P.useImperativeHandle(e,()=>({el:b.current}));let v=n;typeof t.component>"u"&&(p||p==="")&&(v="a");const w={href:p,...x},S=Jt({ios:i,material:o}),C=Je({ios:i,material:o}),I=gt();eo(b,S==="material"&&f);const _=tX(a,I),E=C(eX({fontSizeIos:c,fontSizeMaterial:d,bold:typeof s>"u"?S==="ios"?l:u:s,dividers:typeof g>"u"?S==="ios":g,...t},_,I),r);return G.createElement(v,BC({ref:b,role:"button",tabIndex:"0",className:E.base},w),y)});nX.displayName="ActionsButton";const rX=(t,e)=>{const{fontSizeIos:n,fontSizeMaterial:r,dividers:a}=t;return{base:{common:R(`flex items-center w-full px-4 relative z-10 overflow-hidden ${e.activeBg}`,a&&"hairline-b"),ios:R("h-14",e.bgIos,e.textIos,n,"first:rounded-t-xl last:rounded-b-xl justify-center"),material:R("h-12",e.bgMaterial,e.textMaterial,r,"font-medium","justify-start")}}},aX=function(t,e){return t===void 0&&(t={}),{bgIos:R("bg-white",e("dark:bg-neutral-800")),bgMaterial:R("bg-md-light-surface-3",e("dark:bg-md-dark-surface-3")),textIos:R("text-black text-opacity-55",e("dark:text-white dark:text-opacity-55")),textMaterial:R("text-md-light-primary",e("dark:text-md-dark-primary")),...t}};function zC(){return zC=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},zC.apply(this,arguments)}const iX=P.forwardRef((t,e)=>{const{component:n="div",className:r,colors:a,ios:i,material:o,fontSizeIos:s="text-sm",fontSizeMaterial:l="text-sm",dividers:u=void 0,children:c,...d}=t,p=P.useRef(null);P.useImperativeHandle(e,()=>({el:p.current}));const f=n,g={...d},y=Jt({ios:i,material:o}),x=Je({ios:i,material:o}),b=gt(),v=aX(a,b),w=x(rX({fontSizeIos:s,fontSizeMaterial:l,dividers:typeof u>"u"?y==="ios":u,...t},v),r);return G.createElement(f,zC({ref:p,className:w.base},g),c)});iX.displayName="ActionsLabel";const oX=(t,e)=>({base:{common:`${e.text} ${e.bg} inline-flex items-center justify-center rounded-full leading-none`,ios:"font-semibold",material:"font-medium",sm:"text-2xs min-w-4 min-h-4 px-0.5",md:"text-xs min-w-5 min-h-5 px-1.5 py-0.5"}}),sX=function(t){return t===void 0&&(t={}),{bg:"bg-primary",text:"text-white",...t}};function VC(){return VC=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},VC.apply(this,arguments)}const WM=P.forwardRef((t,e)=>{const{component:n="span",className:r,colors:a,small:i,ios:o,material:s,children:l,...u}=t,c=P.useRef(null);P.useImperativeHandle(e,()=>({el:c.current}));const d=n,p={...u},f=Je({ios:o,material:s}),g=sX(a),y=i?"sm":"md",x=f(oX(t,g),r);return G.createElement(d,VC({ref:c,className:x.base[y]},p),l)});WM.displayName="Badge";const lX=(t,e,n)=>{const{inset:r,nested:a,margin:i,padding:o,strong:s,outline:l}=t;return{base:{common:R("text-sm z-10",Dn("relative",n),!r&&!a&&l&&"hairline-t hairline-b",r&&l&&"border",r&&"px-4",!r&&"pl-4-safe pr-4-safe",!a&&i,(s||l)&&o),ios:R(e.textIos,s&&e.strongBgIos,r&&l&&e.outlineIos),material:R(e.textMaterial,s&&e.strongBgMaterial,r&&l&&e.outlineMaterial)},inset:{common:"ml-4-safe mr-4-safe overflow-hidden",ios:"rounded-lg",material:"rounded-2xl"}}},uX=function(t,e){return t===void 0&&(t={}),{outlineIos:R("border-black border-opacity-20",e("dark:border-white dark:border-opacity-15")),outlineMaterial:R("border-md-light-outline",e("border-md-dark-outline")),strongBgIos:R("bg-ios-light-surface-1",e("dark:bg-ios-dark-surface-1")),strongBgMaterial:R("bg-md-light-surface-1",e("dark:bg-md-dark-surface-1")),textIos:"",textMaterial:R("text-md-light-on-surface",e("dark:text-md-dark-on-surface")),...t}};function WC(){return WC=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},WC.apply(this,arguments)}const ds=P.forwardRef((t,e)=>{const{component:n="div",className:r,colors:a,margin:i="my-8",padding:o="py-4",inset:s,insetIos:l,insetMaterial:u,strong:c,strongIos:d,strongMaterial:p,outline:f,outlineIos:g,outlineMaterial:y,nested:x,ios:b,material:v,children:w,...S}=t,C=P.useRef(null);P.useImperativeHandle(e,()=>({el:C.current}));const I=n,_={...S},E=Jt({ios:b,material:v}),A=Je({ios:b,material:v}),M=gt(),L=uX(a,M),W=typeof c>"u"?E==="ios"?d:p:c,B=typeof f>"u"?E==="ios"?g:y:f,K=typeof s>"u"?E==="ios"?l:u:s,X=A(lX({...t,margin:i,padding:o,inset:K,strong:W,outline:B},L,r)),Q=R(X.base,K&&X.inset,r);return G.createElement(I,WC({ref:C,className:Q},_),w)});ds.displayName="Block";const cX=(t,e)=>{const{inset:n}=t;return{base:{common:R("mb-8 flex items-center -mt-6 text-sm",n?"pl-8-safe pr-8-safe":"pl-4-safe pr-4-safe"),ios:e.textIos,material:e.textMaterial}}},dX=function(t,e){return t===void 0&&(t={}),{textIos:R("text-black text-opacity-75",e("dark:text-white dark:text-opacity-75")),textMaterial:R("text-md-light-on-surface-variant",e("dark:text-md-dark-on-surface-variant")),...t}};function jC(){return jC=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},jC.apply(this,arguments)}const pX=P.forwardRef((t,e)=>{const{component:n="div",className:r,colors:a,ios:i,material:o,inset:s,insetIos:l,insetMaterial:u,children:c,...d}=t,p=P.useRef(null);P.useImperativeHandle(e,()=>({el:p.current}));const f=Jt(),g=typeof s>"u"?f==="ios"?l:u:s,y=n,x={...d},b=Je({ios:i,material:o}),v=gt(),w=dX(a,v),S=b(cX({...t,inset:g},w),r);return G.createElement(y,jC({ref:p,className:S.base},x),c)});pX.displayName="BlockFooter";const hX=(t,e)=>{const{inset:n}=t;return{base:{common:R("mt-8 flex items-center -mb-6 text-sm",n?"pl-8-safe pr-8-safe":"pl-4-safe pr-4-safe"),ios:e.textIos,material:e.textMaterial}}},fX=function(t,e){return t===void 0&&(t={}),{textIos:R("text-black",e("dark:text-white")),textMaterial:R("text-md-light-on-surface-variant",e("dark:text-md-dark-on-surface-variant")),...t}};function UC(){return UC=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},UC.apply(this,arguments)}const mX=P.forwardRef((t,e)=>{const{component:n="div",className:r,colors:a,ios:i,material:o,inset:s,insetIos:l,insetMaterial:u,children:c,...d}=t,p=P.useRef(null);P.useImperativeHandle(e,()=>({el:p.current}));const f=n,g={...d},y=Jt(),x=typeof s>"u"?y==="ios"?l:u:s,b=Je({ios:i,material:o}),v=gt(),w=fX(a,v),S=b(hX({...t,inset:x},w),r);return G.createElement(f,UC({ref:p,className:S.base},g),c)});mX.displayName="BlockHeader";const gX=(t,e)=>{const{withBlock:n,medium:r,large:a}=t;return{base:{common:`pl-4-safe pr-4-safe mt-8 flex justify-between items-center ${n?"-mb-6":"mb-2"}`,ios:R(`font-semibold ${e.textIos}`,a&&"text-[1.5rem]",r&&"text-[1.125rem]",!r&&!a&&"text-[1rem]"),material:R(`font-medium ${e.textMaterial}`,a&&"text-[1.375rem]",r&&"text-[1rem]",!r&&!a&&"text-[0.875rem]")}}},yX=function(t,e){return t===void 0&&(t={}),{textIos:"",textMaterial:R("text-md-light-primary",e("dark:text-md-dark-primary")),...t}};function GC(){return GC=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},GC.apply(this,arguments)}const bX=P.forwardRef((t,e)=>{const{component:n="div",className:r,colors:a,withBlock:i=!0,medium:o,large:s,ios:l,material:u,children:c,...d}=t,p=P.useRef(null);P.useImperativeHandle(e,()=>({el:p.current}));const f=n,g={...d},y=Je({ios:l,material:u}),x=gt(),b=yX(a,x),v=y(gX({...t,withBlock:i},b),r);return G.createElement(f,GC({ref:p,className:v.base},g),c)});bX.displayName="BlockTitle";const vX=t=>{const{fontSizeIos:e,fontSizeMaterial:n}=t;return{base:{common:"flex items-center justify-start overflow-auto whitespace-nowrap py-1 px-0 space-x-3 no-scrollbar rtl:space-x-reverse",ios:e,material:n}}};function HC(){return HC=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},HC.apply(this,arguments)}const xX=P.forwardRef((t,e)=>{const{component:n="div",className:r,fontSizeIos:a="text-[17px]",fontSizeMaterial:i="text-[14px]",ios:o,material:s,children:l,...u}=t,c=P.useRef(null);P.useImperativeHandle(e,()=>({el:c.current}));const d=n,p={...u},f=Je({ios:o,material:s})(vX({...t,fontSizeIos:a,fontSizeMaterial:i}),r);return G.createElement(d,HC({ref:c,className:f.base},p),l)});xX.displayName="Breadcrumbs";const wX=(t,e)=>{const{active:n}=t;return{base:{common:R("flex items-center overflow-hidden"),ios:R(e.textIos,e.bgIos,n?e.textActiveIos:e.textIos,n&&"font-semibold"),material:R("font-medium px-2 py-1 rounded-lg",e.bgMaterial,n?e.textActiveMaterial:e.textMaterial)}}},kX=function(t,e){return t===void 0&&(t={}),{textIos:R("text-black text-opacity-55",e("dark:text-white dark:text-opacity-55")),textMaterial:R("text-md-light-on-secondary-container",e("dark:text-md-dark-on-secondary-container")),bgIos:"",bgMaterial:R("bg-md-light-secondary-container",e("dark:bg-md-dark-secondary-container")),textActiveIos:R("text-black",e("dark:text-white")),textActiveMaterial:R("text-md-light-on-secondary-container",e("dark:text-md-dark-on-secondary-container")),...t}};function qC(){return qC=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},qC.apply(this,arguments)}const SX=P.forwardRef((t,e)=>{const{component:n="div",className:r,ios:a,material:i,colors:o,active:s,children:l,...u}=t,c=P.useRef(null);P.useImperativeHandle(e,()=>({el:c.current}));const d=n,p={...u},f=Je({ios:a,material:i}),g=gt(),y=kX(o,g),x=f(wX({...t},y),r);return G.createElement(d,qC({ref:c,className:x.base,role:"menuitem",tabIndex:"0"},p),l)});SX.displayName="BreadcrumbsItem";const CX=()=>({base:{common:"w-3 opacity-35 flex justify-center",ios:"",material:""},icon:{common:"rtl:rotate-180",ios:"h-3",material:"h-2.5"}});function KC(){return KC=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},KC.apply(this,arguments)}const jM=t=>G.createElement("svg",KC({xmlns:"http://www.w3.org/2000/svg",width:"8",height:"14",viewBox:"0 0 12 20",fill:"currentcolor"},t),G.createElement("path",{d:"M11.518406,10.5648622 C11.4831857,10.6163453 11.4426714,10.6653692 11.3968592,10.7111814 L2.5584348,19.5496058 C1.9753444,20.1326962 1.03186648,20.1345946 0.44199608,19.5447242 C-0.14379032,18.9589377 -0.14922592,18.0146258 0.43711448,17.4282854 L7.87507783,9.9903221 L0.4431923,2.5584366 C-0.1398981,1.9753462 -0.1417965,1.0318683 0.448074,0.4419979 C1.0338604,-0.1437886 1.9781723,-0.1492241 2.56451268,0.4371163 L11.4029371,9.2755407 C11.7556117,9.6282153 11.7969345,10.1725307 11.518406,10.5648622 Z"}));function XC(){return XC=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},XC.apply(this,arguments)}const NX=P.forwardRef((t,e)=>{const{component:n="div",className:r,ios:a,material:i,children:o,...s}=t,l=P.useRef(null);P.useImperativeHandle(e,()=>({el:l.current}));const u=n,c={...s},d=Je({ios:a,material:i})(CX({...t}),r);return G.createElement(u,XC({ref:l,className:d.base},c),G.createElement(jM,{className:d.icon}),o)});NX.displayName="BreadcrumbsSeparator";const TX=(t,e)=>({base:{common:`flex items-center cursor-pointer space-x-0.75 rtl:space-x-reverse ${e.bg}`,ios:R("rounded active:opacity-30 px-1.5 h-[1em] duration-300 active:duration-0",e.bgIos),material:R("py-3 px-2 rounded-lg",e.bgMaterial)},dot:{common:`w-1 h-1 rounded-full ${e.dotBg}`,ios:e.dotBgIos,material:e.dotBgMaterial}}),IX=function(t,e){return t===void 0&&(t={}),{bgIos:R("bg-black bg-opacity-15",e("dark:bg-white dark:bg-opacity-15")),bgMaterial:R("bg-md-light-secondary-container",e("dark:bg-md-dark-secondary-container")),dotBgIos:R("bg-black",e("dark:bg-white")),dotBgMaterial:R("bg-md-light-primary",e("dark:bg-md-dark-primary")),...t}};function YC(){return YC=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},YC.apply(this,arguments)}const EX=P.forwardRef((t,e)=>{const{component:n="div",className:r,colors:a,ios:i,material:o,children:s,...l}=t,u=P.useRef(null);P.useImperativeHandle(e,()=>({el:u.current}));const c=gt(),d=IX(a,c),p=n,f={...l},g=Je({ios:i,material:o})(TX({...t},d),r);return G.createElement(p,YC({ref:u,role:"button",tabIndex:"0",className:g.base},f),G.createElement("span",{className:g.dot}),G.createElement("span",{className:g.dot}),G.createElement("span",{className:g.dot}),s)});EX.displayName="BreadcrumbsCollapsed";const _X=(t,e,n,r)=>{const{inline:a,segmented:i,segmentedStrong:o,segmentedActive:s,disabled:l}=t;return{base:{common:R("flex text-center justify-center items-center appearance-none py-1 transition-colors focus:outline-none cursor-pointer select-none overflow-hidden z-10",a?"inline-flex":"w-full flex",Dn("relative",n),l&&"pointer-events-none",o&&s&&"k-segmented-strong-button-active"),ios:"uppercase duration-100 font-semibold px-2",material:"duration-300 font-medium px-4",square:{ios:i&&!o?"first:rounded-s last:rounded-e":"rounded",material:i&&!o?"first:rounded-lg-s last:rounded-lg-e":"rounded-lg"},rounded:i&&!o?"":"rounded-full"},style:{fill:{common:R(l&&R(e.disabledBg,e.disabledText)),ios:R(l?R(e.disabledBg,e.disabledText):`${e.fillTextIos} ${e.fillBgIos} ${e.fillActiveBgIos}`),material:R(l?R(e.disabledBg,e.disabledText):R(e.fillTextMaterial,e.fillBgMaterial,e.fillActiveBgMaterial,e.fillTouchRipple))},outline:{common:R(l?R(e.disabledText,e.disabledBorder):R("active:bg-opacity-15",e.touchRipple)),ios:R(!i&&"border-2",!l&&!i&&e.outlineBorderIos,!l&&R(e.textIos,e.activeBgIos)),material:R(!i&&"border",!l&&!i&&e.outlineBorderMaterial,!l&&R(e.textMaterial,e.activeBgMaterial))},clear:{common:R(l?e.disabledText:`active:bg-opacity-15 ${e.touchRipple}`),ios:!l&&R(e.textIos,e.activeBgIos),material:!l&&R(e.textMaterial,e.activeBgMaterial)},tonal:{common:l?R(e.disabledBg,e.disabledText):R(e.touchRipple),ios:!l&&R(e.tonalTextIos,e.tonalBgIos,e.activeBgIos,"bg-opacity-15 active:bg-opacity-25"),material:!l&&R(e.tonalTextMaterial,e.tonalBgMaterial,e.activeBgMaterial)},segmentedStrong:R("active:bg-black active:bg-opacity-10",r("dark:active:bg-white dark:active:bg-opacity-5 dark:touch-ripple-white")),segmentedStrongActive:"duration-0"},size:{small:{ios:"text-xs h-7",material:"text-sm h-8"},medium:{common:"text-sm",ios:"h-7",material:"h-10"},large:{ios:"h-11",material:"h-12"}},raised:"shadow active:shadow-lg"}},OX=function(t,e){return t===void 0&&(t={}),{activeBgIos:"active:bg-primary",activeBgMaterial:"",textIos:"text-primary",textMaterial:R("text-md-light-primary","dark:text-md-dark-primary"),fillTextIos:R("text-white"),fillTextMaterial:R("text-md-light-on-primary",e("dark:text-md-dark-on-primary")),fillActiveBgIos:"active:bg-ios-primary-shade",fillActiveBgMaterial:"",fillBgIos:"bg-primary",fillBgMaterial:R("bg-md-light-primary",e("dark:bg-md-dark-primary")),fillTouchRipple:R("touch-ripple-white","dark:touch-ripple-primary"),outlineBorderIos:"border-primary",outlineBorderMaterial:R("border-md-light-outline",e("dark:border-md-dark-outline")),tonalBgIos:"bg-primary",tonalBgMaterial:R("bg-md-light-secondary-container",e("dark:bg-md-dark-secondary-container")),tonalTextIos:"text-primary",tonalTextMaterial:R("text-md-light-on-secondary-container",e("dark:text-md-dark-on-secondary-container")),touchRipple:"touch-ripple-primary",disabledText:R("text-black text-opacity-30",e("dark:text-white dark:text-opacity-30")),disabledBg:R("bg-black bg-opacity-10",e("dark:bg-white dark:bg-opacity-10")),disabledBorder:R("border-black border-opacity-10",e("dark:border-white dark:border-opacity-10")),...t}};function QC(){return QC=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},QC.apply(this,arguments)}const Br=P.forwardRef((t,e)=>{const{component:n="button",className:r,colors:a,ios:i,material:o,disabled:s,href:l,outline:u,outlineIos:c,outlineMaterial:d,clear:p,clearIos:f,clearMaterial:g,tonal:y,tonalIos:x,tonalMaterial:b,rounded:v,roundedIos:w,roundedMaterial:S,small:C,smallIos:I,smallMaterial:_,large:E,largeIos:A,largeMaterial:M,raised:L,raisedIos:W,raisedMaterial:B,inline:K,segmented:X,segmentedStrong:Q,segmentedActive:H,touchRipple:F=!0,children:Y,...Z}=t,ne=P.useRef(null);P.useImperativeHandle(e,()=>({el:ne.current}));let se=n;typeof t.component>"u"&&(l||l==="")&&(se="a");const ce={href:l,...Z},le=Jt({ios:i,material:o}),ye=Je({ios:i,material:o}),we=gt();eo(ne,le==="material"&&F);const q=(De=>{const He={};return Object.keys(De).forEach(Me=>{He[Me]=typeof De[Me]>"u"?le==="ios"?t[`${Me}Ios`]:t[`${Me}Material`]:De[Me]}),He})({outline:u,clear:p,tonal:y,rounded:v,small:C,large:E,raised:L}),ie=q.large?"large":q.small?"small":"medium";let de=q.outline?"outline":q.clear||X&&!H?"clear":q.tonal?"tonal":"fill";Q&&(de="segmentedStrong"),Q&&H&&(de="segmentedStrongActive");const ke=OX(a,we),Ne=ye(_X({...t,...q},ke,r,we)),Ie=R(Ne.base[q.rounded?"rounded":"square"],Ne.style[de],Ne.size[ie],q.raised&&Ne.raised,r);return G.createElement(se,QC({ref:ne,className:Ie,disabled:s,role:"button",tabIndex:"0"},ce),Y)});Br.displayName="Button";const $X=(t,e)=>{const{margin:n,headerDivider:r,footerDivider:a,contentWrapPadding:i}=t;return{base:{common:R(n,"overflow-hidden"),ios:R("rounded-lg",e.bgIos,e.textIos),material:R("rounded-2xl",e.bgMaterial,e.textMaterial),plain:"",raised:"shadow",outline:{common:R("border"),ios:e.outlineIos,material:e.outlineMaterial}},header:{common:R(r&&"border-b","p-4"),ios:R(r&&e.outlineIos,t.headerFontSizeIos),material:R(r&&e.outlineMaterial,t.headerFontSizeMaterial)},content:R(i,"text-sm"),footer:{common:R(r&&"border-t","text-sm p-4"),ios:R(e.footerTextIos,a&&e.outlineIos),material:R(e.footerTextMaterial,a&&e.outlineMaterial)}}},RX=function(t,e){return t===void 0&&(t={}),{textIos:R(""),textMaterial:R("text-md-light-on-surface",e("dark:text-md-dark-on-surface")),bgIos:R("bg-ios-light-surface-1",e("dark:bg-ios-dark-surface-1")),bgMaterial:R("bg-md-light-surface-1",e("dark:bg-md-dark-surface-1")),footerTextIos:R("text-black text-opacity-55",e("dark:text-white dark:text-opacity-55")),footerTextMaterial:R("text-md-light-on-surface-variant",e("dark:text-md-dark-on-surface-variant")),outlineIos:R("border-black border-opacity-20",e("dark:border-white dark:border-opacity-20")),outlineMaterial:R("border-md-light-outline",e("dark:border-md-dark-outline")),...t}};function ZC(){return ZC=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},ZC.apply(this,arguments)}const UM=P.forwardRef((t,e)=>{const{component:n="div",className:r,margin:a="m-4",colors:i,header:o,footer:s,ios:l,material:u,headerFontSizeIos:c="text-[17px]",headerFontSizeMaterial:d="text-[22px]",contentWrap:p=!0,contentWrapPadding:f="p-4",raised:g,raisedIos:y,raisedMaterial:x,outline:b,outlineIos:v,outlineMaterial:w,headerDivider:S=!1,footerDivider:C=!1,children:I,..._}=t,E=P.useRef(null);P.useImperativeHandle(e,()=>({el:E.current}));const A=n,M={..._},L=Jt(),W=Je({ios:l,material:u}),B=gt(),K=RX(i,B),X=typeof b>"u"?L==="ios"?v:w:b,Q=typeof g>"u"?L==="ios"?y:x:g,H=X?"outline":Q?"raised":"plain",F=W($X({...t,margin:a,contentWrapPadding:f,headerDivider:S,footerDivider:C,headerFontSizeIos:c,headerFontSizeMaterial:d,outline:X,raised:Q},K),r);return G.createElement(A,ZC({ref:E,className:F.base[H]},M),o&&G.createElement("div",{className:F.header},o),p?G.createElement("div",{className:F.content},I):I,s&&G.createElement("div",{className:F.footer},s))});UM.displayName="Card";const MX=(t,e,n,r)=>({base:R("cursor-pointer inline-flex align-middle",Dn("relative",n),r("dark:touch-ripple-white")),iconWrap:{common:R("flex items-center justify-center text-white",r("dark:text-black")),ios:"w-5.5 h-5.5 rounded-full border",material:"w-4.5 h-4.5 rounded-sm border-2",notChecked:{ios:e.borderIos,material:e.borderMaterial},checked:{ios:`${e.bgCheckedIos} ${e.borderCheckedIos}`,material:`${e.bgCheckedMaterial} ${e.borderCheckedMaterial}`}},icon:{notChecked:"opacity-0",checked:"opacity-100"},indeterminateIcon:{common:R("bg-white w-3/4",r("dark:bg-black")),ios:"h-0.5 rounded-full",material:"h-0.5"},input:"hidden"}),AX=function(t,e){return t===void 0&&(t={}),{borderIos:R("border-black border-opacity-30",e("dark:border-white dark:border-opacity-30")),borderMaterial:R("border-md-light-outline",e("dark:border-md-dark-outline")),bgCheckedIos:"bg-primary",bgCheckedMaterial:R("bg-md-light-primary",e("dark:bg-md-dark-primary")),borderCheckedIos:"border-primary",borderCheckedMaterial:R("border-md-light-primary",e("dark:border-md-dark-primary")),...t}};function ty(){return ty=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},ty.apply(this,arguments)}const GM=t=>{const{ios:e,material:n,fill:r,...a}=t;return Jt({ios:e,material:n})==="ios"?G.createElement("svg",ty({xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20",fill:"currentcolor"},a),G.createElement("path",{fill:r||"currentColor",fillRule:"evenodd",d:"M10.6461792,0.119820016 C11.0022676,0.346673312 11.1070333,0.819240884 10.88018,1.17532923 L5.59004012,9.47918548 C5.44456028,9.70754308 5.19802823,9.83254199 4.94596825,9.83309245 C4.59813173,9.83364386 4.39457446,9.67360825 4.28105047,9.53831563 L1.17887189,5.84128316 C0.907480501,5.5178515 0.949667479,5.03565214 1.27309914,4.76426075 C1.59653081,4.49286936 2.07873017,4.53505633 2.35012156,4.858488 L4.8346263,7.81909046 L9.59067001,0.353820775 C9.81752331,-0.00226757161 10.2900909,-0.10703328 10.6461792,0.119820016 Z",transform:"translate(4 5.483)"})):G.createElement("svg",ty({xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 18 14",fill:"currentcolor"},a),G.createElement("polygon",{fill:r,points:"6 11.17 1.83 7 .41 8.41 6 14 18 2 16.59 .59"}))};function JC(){return JC=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},JC.apply(this,arguments)}const PX=P.forwardRef((t,e)=>{const{component:n="label",className:r,colors:a,defaultChecked:i,checked:o,indeterminate:s,name:l,value:u,disabled:c,readOnly:d,onChange:p,ios:f,material:g,touchRipple:y=!0,children:x,...b}=t,v=P.useRef(null),w=P.useRef(null);P.useImperativeHandle(e,()=>({el:w.current,inputEl:v.current}));const S=n,C={...b},I=Jt({ios:f,material:g}),_=Je({ios:f,material:g}),E=gt();eo(w,I==="material"&&y);const A=AX(a,E),M=o||i&&!p||s?"checked":"notChecked",L=_(MX(t,A,r,E),r);return P.useEffect(()=>{v.current&&(v.current.indeterminate=!!s)},[s]),G.createElement(S,JC({ref:w,className:L.base},C),G.createElement("input",{ref:v,type:"checkbox",name:l,value:u,disabled:c,readOnly:d,checked:o,defaultChecked:i,onChange:p,className:L.input}),G.createElement("i",{className:L.iconWrap[M]},s?G.createElement("span",{className:L.indeterminateIcon}):G.createElement(GM,{ios:f,material:g,className:L.icon[M]})),x)});PX.displayName="Checkbox";const DX=(t,e)=>({base:{common:"text-sm inline-flex items-center justify-center align-middle rounded-full px-3",ios:"rounded-full h-7",material:"rounded-lg h-8 font-medium",fill:{ios:R(e.fillBg||e.fillBgIos,e.fillText||e.fillTextIos),material:R(e.fillBg||e.fillBgMaterial,e.fillText||e.fillTextMaterial)},outline:{common:"border",ios:R(e.outlineText||e.outlineTextIos,e.outlineBorder||e.outlineBorderIos),material:R(e.outlineText||e.outlineTextMaterial,e.outlineBorder||e.outlineBorderMaterial)}},media:{common:"-my-1 me-1 select-none",ios:"-ms-3",material:"-ms-2"},deleteButton:"-me-2 -my-1 ms-1 h-full flex items-center justify-center w-6 cursor-pointer opacity-50 active:opacity-100 select-none"}),LX=function(t,e){return t===void 0&&(t={}),{fillTextIos:"text-current",fillTextMaterial:R("text-md-light-on-secondary-container",e("dark:text-md-dark-on-secondary-container")),fillBgIos:R("bg-black bg-opacity-10",e("dark:bg-white dark:bg-opacity-10")),fillBgMaterial:R("bg-md-light-secondary-container",e("dark:bg-md-dark-secondary-container")),outlineTextIos:R("text-current"),outlineTextMaterial:R("text-md-light-on-surface",e("dark:text-md-dark-on-surface")),outlineBorderIos:R("border-black border-opacity-20",e("dark:border-white dark:border-opacity-20")),outlineBorderMaterial:R("border-md-light-outline",e("dark:border-md-dark-outline")),...t}};function ny(){return ny=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},ny.apply(this,arguments)}const tf=t=>{let{theme:e,...n}=t;return e==="ios"?G.createElement("svg",ny({xmlns:"http://www.w3.org/2000/svg",width:"28",height:"28",viewBox:"0 0 28 28",fill:"currentcolor"},n),G.createElement("path",{d:"M14,0 C21.7319865,0 28,6.2680135 28,14 C28,21.7319865 21.7319865,28 14,28 C6.2680135,28 0,21.7319865 0,14 C0,6.2680135 6.2680135,0 14,0 Z M18.9393398,6.93933983 L14,11.8786797 L9.06066017,6.93933983 L6.93933983,9.06066017 L11.8786797,14 L6.93933983,18.9393398 L9.06066017,21.0606602 L14,16.1213203 L18.9393398,21.0606602 L21.0606602,18.9393398 L16.1213203,14 L21.0606602,9.06066017 L18.9393398,6.93933983 Z"})):G.createElement("svg",ny({width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},n),G.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12 2C6.47 2 2 6.47 2 12C2 17.53 6.47 22 12 22C17.53 22 22 17.53 22 12C22 6.47 17.53 2 12 2ZM12 20C7.59 20 4 16.41 4 12C4 7.59 7.59 4 12 4C16.41 4 20 7.59 20 12C20 16.41 16.41 20 12 20ZM12 10.59L15.59 7L17 8.41L13.41 12L17 15.59L15.59 17L12 13.41L8.41 17L7 15.59L10.59 12L7 8.41L8.41 7L12 10.59Z",fill:"currentcolor"}))};function eN(){return eN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},eN.apply(this,arguments)}const FX=P.forwardRef((t,e)=>{const{component:n="div",className:r,colors:a,media:i,deleteButton:o,onDelete:s,ios:l,material:u,outline:c,children:d,...p}=t,f=P.useRef(null);P.useImperativeHandle(e,()=>({el:f.current}));const g=n,y={...p},x=Je({ios:l,material:u}),b=Jt({ios:l,material:u}),v=gt(),w=c?"outline":"fill",S=LX(a,v),C=x(DX(t,S),r);return G.createElement(g,eN({ref:f,className:C.base[w]},y),i&&G.createElement("div",{className:C.media},i),d,o&&G.createElement("div",{className:C.deleteButton,role:"button",tabIndex:"0",onClick:s},G.createElement(tf,{theme:b,className:"h-4 w-4"})))});FX.displayName="Chip";const BX=(t,e,n,r)=>{let{hasButtons:a}=r;const{titleFontSizeMaterial:i,titleFontSizeIos:o,translucent:s,sizeIos:l,sizeMaterial:u}=t;return{base:{common:R("left-1/2 top-1/2 transform -translate-x-1/2 -translate-y-1/2 z-40 max-h-full overflow-hidden duration-400",Dn("fixed",n)),ios:R("rounded-xl max-w-full",l,e.bgIos,s&&"translucent"),material:R("rounded-[1.75rem] p-6 max-w-[90%]",u,e.bgMaterial),opened:"",closed:"scale-[0.85] opacity-0 pointer-events-none"},contentWrap:{common:"flex flex-col items-center justify-center",material:"space-y-3",ios:R("p-4 space-y-1 relative",a&&"hairline-b")},title:{common:R("w-full"),ios:R(e.titleIos,o,"font-semibold text-center"),material:R(e.titleMaterial,i)},content:{common:R("text-sm w-full"),ios:R(e.contentTextIos,"text-center"),material:R(e.contentTextMaterial)},buttons:{common:"flex items-center",ios:R("justify-center last-child-hairline-r-none"),material:R("justify-end pt-6 space-x-2 rtl:space-x-reverse")},backdrop:{common:"fixed z-40 w-full h-full left-0 top-0 bg-black bg-opacity-50 duration-400",opened:"",closed:"opacity-0 pointer-events-none"}}},zX=function(t,e){return t===void 0&&(t={}),{bgIos:R("bg-white",e("dark:bg-neutral-800")),bgMaterial:R("bg-md-light-surface-3",e("dark:bg-md-dark-surface-3")),titleIos:"",titleMaterial:R("text-md-light-on-surface",e("dark:text-md-dark-on-surface")),contentTextIos:"",contentTextMaterial:R("text-md-light-on-surface-variant",e("dark:text-md-dark-on-surface-variant")),...t}};function tN(){return tN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},tN.apply(this,arguments)}const VX=P.forwardRef((t,e)=>{const{component:n="div",className:r,colors:a,opened:i,backdrop:o=!0,onBackdropClick:s,translucent:l=!0,sizeIos:u="w-[16.875rem]",sizeMaterial:c="w-[19.5rem]",titleFontSizeIos:d="text-[18px]",titleFontSizeMaterial:p="text-[24px]",title:f,content:g,buttons:y,ios:x,material:b,children:v,...w}=t,S=P.useRef(null);P.useImperativeHandle(e,()=>({el:S.current}));const C=i?"opened":"closed",I=n,_={...w},E=Je({ios:x,material:b}),A=gt(),M=zX(a,A),L=E(BX({...t,titleFontSizeIos:d,titleFontSizeMaterial:p,translucent:l,sizeIos:u,sizeMaterial:c},M,r,{hasButtons:!!y}),r);return G.createElement(G.Fragment,null,o&&G.createElement("div",{className:L.backdrop[C],onClick:s}),G.createElement(I,tN({ref:S,className:L.base[C]},_),G.createElement("div",{className:L.contentWrap},f&&G.createElement("div",{className:L.title},f),(g||v)&&G.createElement("div",{className:L.content},g,v)),y&&G.createElement("div",{className:L.buttons},y)))});VX.displayName="Dialog";const WX=(t,e)=>{const{strong:n,disabled:r}=t;return{base:{ios:R("text-center text-[17px] flex items-center justify-center h-11 w-full hairline-r rtl:hairline-l relative first:rounded-bl-xl last:rounded-br-xl rtl:first:rounded-br-xl rtl:first:rounded-bl-none rtl:last:rounded-bl-xl rtl:last:rounded-br-none",r?e.disabledTextIos:e.textIos,n&&"font-semibold",!r&&e.activeBgIos)}}},jX=function(t,e){return t===void 0&&(t={}),{activeBgIos:R("active:bg-black active:bg-opacity-10",e("dark:active:bg-white dark:active:bg-opacity-10")),textIos:"text-primary",disabledTextIos:R("text-black text-opacity-30",e("dark:text-white dark:text-opacity-30")),...t}};function ry(){return ry=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},ry.apply(this,arguments)}const UX=P.forwardRef((t,e)=>{const{component:n="button",className:r,colors:a,ios:i,material:o,disabled:s,strong:l,strongIos:u,strongMaterial:c,children:d,...p}=t,f=P.useRef(null);P.useImperativeHandle(e,()=>({el:f.current}));const g={...p},y=Jt({ios:i,material:o}),x=Je({ios:i,material:o}),b=gt(),v=jX(a,b),w=typeof l>"u"?y==="ios"?u:c:l,S=x(WX({...t,strong:w},v),r),C=n;return y==="ios"?G.createElement(C,ry({className:S.base,disabled:s,role:"button",tabIndex:"0"},g),d):G.createElement(Br,ry({component:n,inline:!0,rounded:!0,disabled:s,clear:!w,className:r},g),d)});UX.displayName="DialogButton";const GX=(t,e)=>({base:{common:"flex items-center justify-center space-x-2 rtl:!space-x-reverse cursor-pointer overflow-hidden select-none",ios:`h-12 duration-100 rounded-full shadow-lg ${e.bgIos} ${e.activeBgIos} ${e.textIos}`,material:`duration-300 rounded-2xl shadow ${e.bgMaterial} ${e.activeBgMaterial} ${e.textMaterial} ${e.touchRipple}`,iconOnly:{ios:"w-12",material:"w-14 h-14"},withText:{common:"px-4",material:"h-14"}},text:{common:"text-sm",ios:"font-semibold uppercase",material:"font-medium"},icon:{common:"h-1em w-1em",ios:"text-icon-ios",material:"text-icon-material"}}),HX=function(t,e){return t===void 0&&(t={}),{bgIos:"bg-primary",bgMaterial:R("bg-md-light-primary-container",e("dark:bg-md-dark-primary-container")),activeBgIos:"active:bg-ios-primary-shade",activeBgMaterial:"",textIos:"text-white",textMaterial:R("text-md-light-on-primary-container",e("dark:text-md-dark-on-primary-container")),touchRipple:R("touch-ripple-primary",e("dark:touch-ripple-white")),...t}};function nN(){return nN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},nN.apply(this,arguments)}const qX=P.forwardRef((t,e)=>{const{component:n="a",className:r,colors:a,href:i,text:o,textPosition:s="after",icon:l,ios:u,material:c,touchRipple:d=!0,children:p,...f}=t,g=P.useRef(null);P.useImperativeHandle(e,()=>({el:g.current}));const y=n,x={...f},b=Jt({ios:u,material:c}),v=Je({ios:u,material:c}),w=gt();eo(g,b==="material"&&d);const S=HX(a,w),C=v(GX(t,S),r);return G.createElement(y,nN({className:o?C.base.withText:C.base.iconOnly,href:i,ref:g,role:"button",tabIndex:"0"},x),o&&s==="before"&&G.createElement("span",{className:C.text},o),l&&G.createElement("span",{className:C.icon},l),o&&s==="after"&&G.createElement("span",{className:C.text},o),p)});qX.displayName="Fab";const KX=(t,e)=>({base:`${Dn("relative",e)} inline-block not-italic`,badge:"absolute -end-1.5 -top-0.5"});function rN(){return rN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},rN.apply(this,arguments)}const ei=P.forwardRef((t,e)=>{const{component:n="i",className:r,ios:a,material:i,badge:o,badgeColors:s,children:l,...u}=t,c=P.useRef(null);P.useImperativeHandle(e,()=>({el:c.current}));const d=n,p={...u},f=Je(),g=Jt(),y=f(KX(t,r),r);return G.createElement(d,rN({ref:c,className:y.base},p),g==="ios"?a:i,typeof o<"u"&&o!==null&&G.createElement(WM,{small:!0,className:y.badge,colors:s},o),l)});ei.displayName="Icon";const XX=(t,e,n)=>{let{textColor:r,needsTouchRipple:a}=e;const{iconOnly:i,tabbar:o}=t;return{base:{common:R(!o&&r,"inline-flex space-x-1 rtl:!space-x-reverse justify-center items-center cursor-pointer select-none",a&&`touch-ripple-primary ${Dn("relative",n)} z-10`),notTabbar:{ios:"active:opacity-30 duration-300 active:duration-0",material:a?"":"active:opacity-55"}},tabbar:{common:R(Dn("relative",n),"w-full h-full duration-300"),material:"font-medium text-sm z-10",active:"k-tabbar-link-active",inactive:""},toolbar:{common:R("h-full max-h-12",i&&"k-touch-ripple-inset"),material:"px-3 text-sm font-medium"},navbar:{common:R("h-full max-h-12",i&&"k-touch-ripple-inset"),material:"px-3"}}},YX=function(t,e){return t===void 0&&(t={}),{textIos:"text-primary",textMaterial:R("text-md-light-primary",e("dark:text-md-dark-primary")),navbarTextIos:"text-primary",navbarTextMaterial:"",...t}};function aN(){return aN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},aN.apply(this,arguments)}const iN=P.forwardRef((t,e)=>{const{component:n="a",className:r,colors:a,navbar:i,toolbar:o,iconOnly:s,linkProps:l={},tabbar:u,tabbarActive:c,touchRipple:d=void 0,ios:p,material:f,onClick:g,children:y,...x}=t,b=P.useRef(null);P.useImperativeHandle(e,()=>({el:b.current}));const v=n,w={...l,...x},S=Jt({ios:p,material:f}),C=Je({ios:p,material:f}),I=gt(),_=S==="material"&&(d||(o||u||i)&&typeof d>"u");eo(b,_);const E=YX(a,I),A=t.navbar?S==="material"?E.navbarTextMaterial:E.navbarTextIos:S==="material"?E.textMaterial:E.textIos,M=u&&!c?E.tabbarInactive:A,L=c?"active":"inactive",W=C(XX(t,{textColor:M,needsTouchRipple:_},r)),B=R(W.base[u?"default":"notTabbar"],o&&W.toolbar,i&&W.navbar,u&&W.tabbar[L],r);return G.createElement(v,aN({ref:b,className:B},w,{role:"link",tabIndex:"0",onClick:g}),y)});iN.displayName="Link";const QX=(t,e,n)=>{const{nested:r,margin:a,inset:i,strong:o,outline:s}=t;return{base:{common:R(!r&&a,!i&&!r&&s&&"hairline-t hairline-b",i&&s&&"border",Dn("relative",n),"z-10"),ios:R(o&&e.strongBgIos,i&&s&&e.outlineIos),material:R(o&&e.strongBgMaterial,i&&s&&e.outlineMaterial)},ul:{common:R(i&&"no-safe-areas","last-child-hairline-b-none")},inset:{common:"ml-4-safe mr-4-safe overflow-hidden",ios:"rounded-lg",material:"rounded-2xl"},menuList:{common:"py-1"}}},ZX=function(t,e){return t===void 0&&(t={}),{outlineIos:R("border-black border-opacity-20",e("dark:border-white dark:border-opacity-15")),outlineMaterial:R("border-md-light-outline",e("border-md-dark-outline")),strongBgIos:R("bg-ios-light-surface-1",e("dark:bg-ios-dark-surface-1")),strongBgMaterial:R("bg-md-light-surface-1",e("dark:bg-md-dark-surface-1")),...t}},HM=G.createContext(!1);function oN(){return oN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},oN.apply(this,arguments)}const sN=P.forwardRef((t,e)=>{const{component:n="div",className:r,colors:a,margin:i="my-8",nested:o,menuList:s,dividers:l,dividersIos:u=!0,dividersMaterial:c=!1,inset:d,insetIos:p,insetMaterial:f,strong:g,strongIos:y,strongMaterial:x,outline:b,outlineIos:v,outlineMaterial:w,ios:S,material:C,children:I,..._}=t,E=P.useRef(null);P.useImperativeHandle(e,()=>({el:E.current}));const A=n,M={..._},L=Jt(),W=Je({ios:S,material:C}),B=gt(),K=typeof l>"u"?L==="ios"?u:c:l,X=typeof g>"u"?L==="ios"?y:x:g,Q=typeof b>"u"?L==="ios"?v:w:b,H=typeof d>"u"?L==="ios"?p:f:d,F=ZX(a,B),Y=W(QX({...t,margin:i,inset:H,strong:X,outline:Q},F,r)),Z=R(Y.base,H&&Y.inset,s&&Y.menuList,r);return G.createElement(HM.Provider,{value:K},G.createElement(A,oN({ref:E,className:Z},M),G.createElement("ul",{className:Y.ul},I)))});sN.displayName="List";function lN(){return lN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},lN.apply(this,arguments)}const JX=P.forwardRef((t,e)=>{const{children:n,...r}=t,a=P.useRef(null);P.useImperativeHandle(e,()=>({el:a.current}));const i={...r};return G.createElement("li",{ref:a},G.createElement(sN,lN({nested:!0},i),n))});JX.displayName="ListGroup";const eY=(t,e,n)=>{const{dividers:r}=t;return{base:"",button:{common:R(Dn("relative",n),r&&"hairline-b active:hairline-transparent",`flex items-center justify-center px-4 space-x-1 w-full duration-300 active:duration-0 focus:outline-none ${e.touchRipple} overflow-hidden select-none`),ios:R("h-11",e.textIos,e.activeBgIos,e.activeBgIos),material:R("h-12",e.textMaterial,e.activeBgMaterial)}}},tY=function(t,e){return t===void 0&&(t={}),{textIos:"text-primary",textMaterial:R("text-md-light-primary",e("dark:text-md-dark-primary")),activeBgIos:"active:bg-primary active:bg-opacity-15",activeBgMaterial:"",touchRipple:"touch-ripple-primary",...t}},qM=()=>P.useContext(HM);function ay(){return ay=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},ay.apply(this,arguments)}const nY=P.forwardRef((t,e)=>{const{component:n="li",className:r,colors:a,href:i,target:o,type:s,value:l,linkComponent:u="a",linkProps:c={},ios:d,material:p,touchRipple:f=!0,children:g,...y}=t,x=P.useRef(null),b=P.useRef(null),v=qM();P.useImperativeHandle(e,()=>({el:x.current}));const w=n,S={...y},C=Jt({ios:d,material:p}),I=Je({ios:d,material:p});eo(b,C==="material"&&f);const _=gt(),E=tY(a,_),A=I(eY({...t,dividers:v},E,r),r),M=!!i||i==="",L={href:!M||i===!0||i===!1?void 0:i||"",target:o,type:s,value:l,...c},W=M?u:"button";return G.createElement(w,ay({ref:x,className:A.base},S),G.createElement(W,ay({ref:b,className:A.button},L),g))});nY.displayName="ListButton";const rY=(t,e,n)=>{let{className:r,isMediaItem:a,theme:i,textColor:o,needsTouchRipple:s,isMenuListItemActive:l,autoStrongTitle:u}=n;const{menuListItem:c,dividers:d,mediaClassName:p="",mediaClass:f="",innerClassName:g="",innerClass:y="",contentClassName:x="",contentClass:b="",titleWrapClassName:v="",titleWrapClass:w="",titleFontSizeIos:S,titleFontSizeMaterial:C,strongTitle:I,contacts:_}=t;return{base:{common:c?`${o} py-1`:"",material:_&&"[&:nth-child(2)]:-mt-12"},itemContent:{common:R(`flex items-center ${x||b}`),ios:R(!c&&R(e.primaryTextIos,"ps-4-safe"),c&&"rounded-lg ml-2-safe mr-2-safe ps-2"),material:R(!c&&R(e.primaryTextMaterial,a?"ml-2-safe mr-2-safe rounded-2xl ps-2":"ps-4-safe",_&&"ml-10"),c&&"rounded-full min-h-[3.5rem] ml-4-safe mr-4-safe ps-4"),link:R("duration-300 active:duration-0 cursor-pointer select-none",d&&i==="ios"&&"active:hairline-transparent",s&&R("relative overflow-hidden z-10",e.touchRipple),R(l?i==="ios"?e.menuListItemActiveBgIos:e.menuListItemActiveBgMaterial:c?i==="ios"?e.menuListItemBgIos:e.menuListItemBgMaterial:i==="ios"?e.activeBgIos:e.activeBgMaterial))},media:{common:`shrink-0 flex ${p||f}`,ios:"py-2 me-4",material:R("py-3",c?"me-3":"me-4")},inner:{common:R("w-full relative",!c&&d&&"hairline-b",g||y),ios:"py-2.5 pe-4-safe",material:R("py-3",a&&!c?"pe-2":"pe-4-safe")},titleWrap:{common:R(`flex justify-between items-center ${v||w}`),ios:R(!c&&S),material:R(!c&&C)},title:{common:"shrink",menuListItem:R("text-sm",I===!0||u?"font-semibold":"font-medium"),strong:{common:"",ios:"font-semibold",material:"font-medium"}},after:{common:R("shrink-0 ms-auto ps-1 flex items-center space-x-1"),ios:e.secondaryTextIos,material:R(e.secondaryTextMaterial,"text-sm")},chevron:"opacity-20 shrink-0 ms-3 rtl:rotate-180",subtitle:"text-sm",text:{common:R("text-sm line-clamp-2"),ios:e.secondaryTextIos,material:e.secondaryTextMaterial},header:{common:"text-xs mb-0.5",ios:e.secondaryTextIos,material:e.secondaryTextMaterial},footer:{common:R("text-xs mt-0.5"),ios:e.secondaryTextIos,material:e.secondaryTextMaterial},groupTitle:{common:R("pl-4-safe pr-4-safe py-1 flex items-center z-20",Dn("relative",r)),ios:`h-8${d?" hairline-t":""} -mt-px ${S} ${e.secondaryTextIos} ${e.groupTitleBgIos} ${_&&R("font-semibold top-11-safe sticky",e.groupTitleContactsTextIos,e.groupTitleContactsBgIos)}`,material:`h-12 ${C} ${e.secondaryTextMaterial} ${e.groupTitleBgMaterial} ${_&&R("pointer-events-none overflow-visible h-12 box-border text-xl font-medium flex max-w-full items-center px-4 top-16-safe sticky",e.groupTitleContactsTextMaterial,e.groupTitleContactsBgMaterial)}`}}},aY=function(t,e){return t===void 0&&(t={}),{primaryTextIos:R("text-black",e("dark:text-white")),primaryTextMaterial:R("text-md-light-on-surface",e("dark:text-md-dark-on-surface")),secondaryTextIos:R("text-black text-opacity-55",e("dark:text-white dark:text-opacity-55")),secondaryTextMaterial:R("text-md-light-on-surface-variant",e("dark:text-md-dark-on-surface-variant")),activeBgIos:R("active:bg-black active:bg-opacity-10",e("dark:active:bg-white dark:active:bg-opacity-10")),activeBgMaterial:"",groupTitleBgIos:R("bg-ios-light-surface-variant",e("dark:bg-ios-dark-surface-variant")),groupTitleBgMaterial:R("bg-md-light-surface-2",e("dark:bg-md-dark-surface-2")),menuListItemTextIos:R("text-black",e("dark:text-white")),menuListItemTextMaterial:R("text-md-light-on-surface-variant",e("dark:text-md-dark-on-surface-variant")),menuListItemBgIos:R("active:bg-black active:bg-opacity-10",e("dark:active:bg-white dark:active:bg-opacity-10")),menuListItemBgMaterial:R("bg-md-light-surface-1",e("dark:bg-md-dark-surface-1")),menuListItemActiveTextIos:R("text-primary",e("dark:text-white")),menuListItemActiveTextMaterial:R("text-md-light-on-secondary-container",e("dark:text-md-dark-on-secondary-container")),menuListItemActiveBgIos:R("bg-primary bg-opacity-15",e("dark:bg-primary")),menuListItemActiveBgMaterial:R("bg-md-light-secondary-container",e("dark:bg-md-dark-secondary-container")),touchRipple:R("touch-ripple-black",e("dark:touch-ripple-white")),groupTitleContactsTextIos:R("text-opacity-90",e("dark:text-opacity-90")),groupTitleContactsTextMaterial:R("text-md-light-primary",e("dark:text-md-dark-primary")),groupTitleContactsBgIos:R(e("dark:bg-[#323234]")),groupTitleContactsBgMaterial:R("bg-transparent",e("dark:bg-transparent")),...t}};function iy(){return iy=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},iy.apply(this,arguments)}const uN=P.forwardRef((t,e)=>{const{component:n="li",colors:r,className:a,mediaClassName:i="",innerClassName:o="",innerChildren:s,contentClassName:l="",contentChildren:u,titleWrapClassName:c="",titleFontSizeIos:d="text-[17px]",titleFontSizeMaterial:p="text-[16px]",title:f,subtitle:g,text:y,after:x,media:b,header:v,footer:w,menuListItem:S,menuListItemActive:C,groupTitle:I,strongTitle:_="auto",label:E,chevron:A=void 0,chevronIos:M=!0,chevronMaterial:L=!0,chevronIcon:W,href:B,target:K,link:X,linkComponent:Q="a",linkProps:H={},dividers:F,contacts:Y,ios:Z,material:ne,touchRipple:se=!0,children:ce,...le}=t,ye=P.useRef(null),we=P.useRef(null);P.useImperativeHandle(e,()=>({el:we.current}));const q=n,ie={...le},de=typeof F>"u"?qM():F,ke=Jt({ios:Z,material:ne}),Ne=Je({ios:Z,material:ne}),Ie=gt(),De=typeof A>"u"?ke==="ios"?M:L:A,He=aY(r,Ie),Me=S&&C,it=He[`${Me?"menuListItemActiveText":S?"menuListItemText":"text"}${ke==="ios"?"Ios":"Material"}`],Ye=!!B||B===""||S||X,Ze=!!E,Qe=ke==="material"&&(Ze||Ye)&&se;eo(ye,Qe);const Xt=B===!0||B===!1||typeof B>"u"?void 0:B||"",Wt=Ye?Q:Ze?"label":"div",Ht=Ye?{href:Xt,target:K,...H}:{},Yt=f&&(g||y),jt=_==="auto"&&Yt,Tt=Ne(rY({...t,titleFontSizeIos:d,titleFontSizeMaterial:p,dividers:de,strongTitle:_,mediaClassName:i,innerClassName:o,contentClassName:l,titleWrapClassName:c},He,{isMediaItem:Yt,theme:ke,textColor:it,needsTouchRipple:Qe,isMenuListItemActive:Me,darkClasses:Ie,autoStrongTitle:jt,className:a}),a),Gn=Ye||Ze?Tt.itemContent.link:Tt.itemContent.default,gr=S?Tt.title.menuListItem:_===!0||jt?Tt.title.strong:Tt.title.default;return I?G.createElement(q,{className:R(Tt.groupTitle,a)},f,ce):G.createElement(q,iy({ref:we,className:Tt.base},ie),G.createElement(Wt,iy({ref:ye,className:Gn},Ht),b&&G.createElement("div",{className:Tt.media},b),G.createElement("div",{className:Tt.inner},v&&G.createElement("div",{className:Tt.header},v),(f||x)&&G.createElement("div",{className:Tt.titleWrap},f&&G.createElement("div",{className:gr},f),x&&G.createElement("div",{className:Tt.after},x),Ye&&De&&!S&&(W||G.createElement(jM,{className:Tt.chevron}))),g&&G.createElement("div",{className:Tt.subtitle},g),y&&G.createElement("div",{className:Tt.text},y),w&&G.createElement("div",{className:Tt.footer},w),s),u),ce)});uN.displayName="ListItem";function cN(){return cN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},cN.apply(this,arguments)}const iY=t=>G.createElement("svg",cN({xmlns:"http://www.w3.org/2000/svg",width:"8",height:"5",viewBox:"0 0 8 5",fill:"currentcolor"},t),G.createElement("polygon",{fillRule:"evenodd",points:"0 0 8 0 4 5"})),oY=(t,e,n)=>{let{isFloatingTransformed:r,isFocused:a,darkClasses:i,getLabelColor:o,hasLabel:s}=n;const{error:l,type:u,outline:c,inputClassName:d="",inputClass:p=""}=t;return{base:{common:"",ios:R(c&&"my-4"),material:R("py-2")},itemContent:{common:"relative",ios:R(c&&"ml-4 mr-4 rounded-lg",!c&&e.bgIos),material:R("min-h-[56px] ml-4 mr-4",c?R("rounded"):R(e.bgMaterial,"rounded-t relative "))},inner:{common:"",material:R(c?"pt-4 pb-4":"pt-2 pb-2"),stacked:"",floating:""},label:{common:R("duration-200 text-xs",o(),c&&"flex"),ios:R(c&&"-mt-4"),material:R(c&&"-mt-4"),stacked:"",floating:{common:R("pointer-events-none duration-200 transform origin-left rtl:origin-right max-w-[66%]",r&&"scale-133"),ios:r?c?"translate-y-6":"translate-y-4":"",material:r?c?"translate-y-8":"translate-y-3":""}},labelText:{common:R(c&&"relative p-1 block -m-1"),ios:R(c&&R("-top-1",e.outlineLabelBgIos)),material:R(c&&R("-top-2",e.outlineLabelBgMaterial))},inputWrap:{common:"relative",ios:R((!s||c)&&"-mt-2.5","-mb-2.5"),stacked:"",floating:""},media:{material:""},titleWrap:{material:`duration-200 ${o()}`},input:{common:`block text-base appearance-none w-full focus:outline-none bg-transparent ${d||p}`,ios:"h-10",material:"h-6",notFloating:{common:R("placeholder-black placeholder-opacity-30",i("dark:placeholder-white dark:placeholder-opacity-30")),material:R(u==="textarea"&&"py-1"),ios:R(u==="textarea"&&"py-2")},floating:r?"placeholder-transparent":R("placeholder-black placeholder-opacity-30",i("dark:placeholder-white dark:placeholder-opacity-30"))},errorInfo:{common:"text-xs relative z-10",ios:"mt-1",material:""},error:e.errorText,info:"opacity-50",clearButton:{common:"absolute end-0 top-1/2 transform -translate-y-1/2 cursor-pointer",ios:R("w-3.5 h-3.5 opacity-45 active:opacity-30",e.labelTextIos),material:R("w-6 h-6 active:opacity-55",e.labelTextMaterial)},dropdown:"absolute end-0 top-1/2 transform -translate-y-1/2 pointer-events-none opacity-50",border:{common:"pointer-events-none absolute start-0 bottom-0 duration-200 w-full",ios:c&&R(l?e.errorBorder:a?e.outlineBorderFocusIos:e.outlineBorderIos,"h-full border rounded-lg -z-10"),material:R(l?e.errorBorder:a?e.outlineBorderFocusMaterial:e.outlineBorderMaterial,c&&R("h-full border rounded -z-10",a&&"border-2"),!c&&R("border-b h-px origin-bottom",a&&"scale-y-[2]"))}}},sY=function(t,e){return t===void 0&&(t={}),{bgIos:"",bgMaterial:R("bg-md-light-surface-variant",e("dark:bg-md-dark-surface-variant")),outlineBorderIos:R("border-black border-opacity-30",e("dark:border-white dark:border-opacity-30")),outlineBorderFocusIos:"border-primary",outlineBorderMaterial:R("border-md-light-on-surface",e("dark:border-md-dark-on-surface")),outlineBorderFocusMaterial:R("border-md-light-primary",e("dark:border-md-dark-primary")),outlineLabelBgIos:R("bg-ios-light-surface-1",e("dark:bg-ios-dark-surface-1")),outlineLabelBgMaterial:R("bg-md-light-surface",e("dark:bg-md-dark-surface")),labelTextIos:"",labelTextFocusIos:"",labelTextMaterial:R("text-md-light-on-surface-variant",e("dark:text-md-dark-on-surface-variant")),labelTextFocusMaterial:R("text-md-light-primary",e("dark:text-md-dark-primary")),errorText:"text-red-500",errorBorder:"border-red-500",...t}};function dN(){return dN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},dN.apply(this,arguments)}const lY=P.forwardRef((t,e)=>{const{component:n="li",className:r,colors:a,label:i,floatingLabel:o,outline:s,outlineIos:l,outlineMaterial:u,media:c,input:d,info:p,error:f,clearButton:g,dropdown:y,inputId:x,inputStyle:b,inputClassName:v="",name:w,value:S,defaultValue:C,type:I="text",inputMode:_,readOnly:E,required:A,disabled:M,placeholder:L,size:W,accept:B,autoComplete:K,autoCorrect:X,autoCapitalize:Q,spellCheck:H,autoFocus:F,autoSave:Y,max:Z,min:ne,step:se,maxLength:ce,minLength:le,multiple:ye,pattern:we,tabIndex:q,onInput:ie,onChange:de,onFocus:ke,onBlur:Ne,onClear:Ie,ios:De,material:He,children:Me,...it}=t,Ye=P.useRef(null),Ze=P.useRef(null);P.useImperativeHandle(e,()=>({el:Ze.current,inputEl:Ye.current}));const[Qe,Xt]=P.useState(!1),Wt=Jt({ios:De,material:He}),Ht=Je({ios:De,material:He}),Yt=gt(),jt=sY(a,Yt),Tt=i&&o?"floating":"stacked",Gn=Tt==="floating"?"floating":"notFloating",gr=()=>{if(Ye.current)return Ye.current.value},Ga=i&&o&&!(()=>{const Ca=gr();return typeof S>"u"?Ca||Ca===0:S||S===0})()&&!Qe,_r=()=>f?jt.errorText:Wt==="material"?Qe?jt.labelTextFocusMaterial:jt.labelTextMaterial:Wt==="ios"?Qe?jt.labelTextFocusIos:jt.labelTextIos:"",Li=Ca=>{Xt(!0),ke&&ke(Ca)},Ls=Ca=>{Xt(!1),Ne&&Ne(Ca)},ho=typeof s>"u"?Wt==="ios"?l:u:s,rn=Ht(oY({...t,outline:ho},jt,{isFloatingTransformed:Ga,isFocused:Qe,darkClasses:Yt,getLabelColor:_r,inputClassName:v,hasLabel:!!i})),Fi={...it},Fs=()=>{if(d)return d;const Ca=I==="select"||I==="textarea"?I:"input",Rp=Ca==="input";return G.createElement(Ca,{id:x,ref:Ye,className:rn.input[Gn],style:b,name:w,type:Rp?I:void 0,placeholder:L,inputMode:_,size:W,accept:B,autoComplete:K,autoCorrect:X,autoCapitalize:Q,spellCheck:H,autoFocus:F,autoSave:Y,disabled:M,max:Z,maxLength:ce,min:ne,minLength:le,step:se,multiple:ye,readOnly:E,required:A,pattern:we,tabIndex:q,value:S,defaultValue:C,onInput:ie,onChange:de,onFocus:Li,onBlur:Ls},I==="select"?Me:null)},fo=G.createElement(G.Fragment,null,f&&f!==!0&&G.createElement("div",{className:R(rn.errorInfo,rn.error)},f),p&&!f&&G.createElement("div",{className:R(rn.errorInfo,rn.info)},p)),$p=G.createElement(G.Fragment,null,i&&G.createElement("div",{className:rn.label[Tt]},G.createElement("div",{className:rn.labelText},i)),G.createElement("div",{className:rn.inputWrap[Tt]},Fs(),g&&G.createElement(tf,{theme:Wt,onClick:Ie,className:rn.clearButton}),y&&G.createElement(iY,{className:rn.dropdown})),fo);return G.createElement(uN,dN({ref:Ze,component:n,media:c,className:rn.base,title:null,mediaClassName:rn.media,innerClassName:rn.inner[Tt],contentClassName:rn.itemContent,titleWrapClassName:rn.titleWrap,innerChildren:$p,contentChildren:(ho||Wt==="material")&&G.createElement("span",{className:rn.border}),dividers:Wt==="material"||ho?!1:void 0},Fi),I!=="select"?Me:null)});lY.displayName="ListInput";function pN(){return pN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},pN.apply(this,arguments)}const uY=P.forwardRef((t,e)=>{const{children:n,...r}=t,a=P.useRef(null);P.useImperativeHandle(e,()=>({el:a.current}));const i={...r};return G.createElement(sN,pN({ref:a,menuList:!0},i),n)});uY.displayName="MenuList";function hN(){return hN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},hN.apply(this,arguments)}const cY=P.forwardRef((t,e)=>{const{active:n,href:r,children:a,...i}=t,o=P.useRef(null);P.useImperativeHandle(e,()=>({el:o.current}));const s={...i};return G.createElement(uN,hN({ref:o,menuListItem:!0,menuListItemActive:n,href:r||!1},s),a)});cY.displayName="MenuListItem";const dY=(t,e)=>{const{type:n}=t;return{message:{common:"max-w-[70%] box-border flex relative z-1 transform translate-z-0 mb-2 first:mt-2"},messageSent:{common:R("self-end",e.messageSent)},messageReceived:{common:e.messageReceived},messageName:{common:"text-xs",ios:R("mb-0.5 ms-4",e.messageNameIos),material:R("ms-4 mb-0.5",e.messageNameMd)},messageHeader:{common:"text-xs",ios:R("mb-0.5 ms-4",e.messageNameIos),material:R("ms-4 mb-0.5",e.messageNameMd)},messageFooter:{common:"text-xs",ios:R("mb-0.5 ms-4",e.messageNameIos),material:R("ms-4 mb-0.5",e.messageNameMd)},messageAvatar:{common:R("rounded-full relative bg-cover self-end shrink-0 me-1.5 w-8 h-8")},messageContent:{common:"flex flex-col"},messageBubble:{...n==="sent"&&{ios:R("rounded-3xl box-border break-words flex flex-col relative rounded-2xl py-1.5 px-4",e.bubbleSentIos),material:R("box-border break-words flex flex-col relative rounded-3xl py-2.5 px-4",e.bubbleSentMd)},...n==="received"&&{ios:R("rounded-2xl box-border break-words flex flex-col relative rounded-2xl py-1.5 px-4",e.bubbleReceivedIos),material:R("box-border break-words flex flex-col relative rounded-3xl py-2.5 px-4 ",e.bubbleReceivedMd)}},messageTextHeader:{common:"w-full text-left leading-tight text-sm opacity-80"},messageTextFooter:{common:"w-full text-left leading-tight text-sm opacity-80"},messageText:{common:"w-full text-left leading-tight"}}},pY=function(t,e){return t===void 0&&(t={}),{messageSent:"text-white",messageReceived:"text-inherit",messageNameIos:R("text-black text-opacity-45",e("dark:text-white dark:text-opacity-45")),messageNameMd:R("text-md-light-on-surface-variant",e("dark:text-md-dark-on-surface-variant")),bubbleSentIos:R("bg-primary"),bubbleSentMd:R("bg-md-light-primary",e("dark:bg-md-dark-primary dark:text-md-dark-on-primary")),bubbleReceivedIos:R("bg-[#e5e5ea]",e("dark:bg-[#252525]")),bubbleReceivedMd:R(e("dark:bg-md-dark-surface-variant"),"bg-[#e5e5ea]"),...t}};function fN(){return fN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},fN.apply(this,arguments)}const hY=P.forwardRef((t,e)=>{const{component:n="div",className:r,colors:a,id:i,text:o,name:s,type:l="sent",header:u,footer:c,textHeader:d,textFooter:p,avatar:f,ios:g,material:y,children:x,...b}=t,v=P.useRef(null);P.useImperativeHandle(e,()=>({el:v.current}));const w=Je({ios:g,material:y}),S=gt(),C=pY(a,S),I=w(dY({...t},C)),_=n,E={...b},A=R(r,I.message,{[I.messageSent]:l==="sent",[I.messageReceived]:l==="received"});return G.createElement(_,fN({id:i,ref:v,className:A},E),f&&G.createElement("div",{className:I.messageAvatar},f),G.createElement("div",{className:I.messageContent},s&&G.createElement("div",{className:I.messageName},s),u&&G.createElement("div",{className:I.messageHeader},u),G.createElement("div",{className:I.messageBubble},d&&G.createElement("div",{className:I.messageTextHeader},d),o&&G.createElement("div",{className:I.messageText},o),p&&G.createElement("div",{className:I.messageTextFooter},p)),c&&G.createElement("div",{className:I.messageFooter},c)))});hY.displayName="Message";const fY=(t,e,n)=>{let{isFocused:r}=n;const{rightClassName:a="",rightClass:i="",leftClassName:o="",leftClass:s=""}=t;return{base:{common:"fixed bottom-0 start-0 w-full"},toolbar:{material:e.bgMessage},left:{common:R("mt-1 -ms-2",o||s),ios:R("px-2",e.toolbarIconIos),material:R("",e.toolbarIconMd)},right:{common:R("mt-1 -me-2",a||i),ios:R("px-2",e.toolbarIconIos)},messagebarArea:{common:"w-full"},messagebarInput:{common:R("block w-full focus:outline-none resize-none",r&&"outline-offset-0"),ios:R("border h-8 rounded-3xl px-4 leading-4 py-1.5",e.inputBgIos,e.borderIos,e.placeholderIos),material:R("rounded-3xl h-12 px-4 py-4 leading-4 ",e.inputBgMd,e.placeholderMd)}}},mY=function(t,e){return t===void 0&&(t={}),{toolbarIconIos:R("fill-primary",e("dark:fill-md-dark-primary")),toolbarIconMd:R("fill-black"),inputBgIos:R("bg-transparent"),borderIos:R("border-[#c8c8cd]",e("dark:border-white dark:border-opacity-30")),inputBgMd:R("bg-md-light-surface-2",e("dark:bg-md-dark-surface-variant")),placeholderIos:R(e("dark:placeholder-white dark:placeholder-opacity-40")),placeholderMd:R("placeholder-md-light-on-surface-variant",e("dark:placeholder-md-dark-on-surface-variant")),bgIos:R("bg-white",e("dark:bg-black")),bgMaterial:R("bg-md-light-surface",e("dark:bg-md-dark-surface")),...t}},gY=(t,e,n)=>{const{bgClassName:r="",bgClass:a="",outline:i,translucent:o,innerClassName:s="",innerClass:l="",tabbar:u,tabbarIcons:c,top:d}=t;return{base:{common:R("w-full z-20",Dn("relative",n),!d&&"pb-safe")},bg:{common:R("absolute w-full h-full left-0 top-0",i&&(d?"hairline-b":"hairline-t"),r||a),ios:R(e.bgIos,o&&"translucent"),material:R(`${e.bgMaterial}`)},inner:{common:R("flex relative justify-between items-center w-full overflow-hidden",s||l),ios:R("pl-2-safe pr-2-safe",c?"h-12.5":"h-11"),material:R(u?"":"pl-2-safe pr-2-safe",c?"h-20":"h-14")},highlight:{common:R(d?"bottom-0":"top-0","absolute left-0 w-full h-0.5 duration-200 pointer-events-none transition-transform"),ios:e.tabbarHighlightBgIos,material:e.tabbarHighlightBgMaterial}}},yY=function(t,e){return t===void 0&&(t={}),{bgIos:R("bg-ios-light-surface-2",e("dark:bg-ios-dark-surface-2")),bgMaterial:R("bg-md-light-surface-2",e("dark:bg-md-dark-surface-2")),tabbarHighlightBgIos:"bg-primary",tabbarHighlightBgMaterial:R("bg-md-light-primary",e("dark:bg-md-dark-primary")),...t}};function mN(){return mN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},mN.apply(this,arguments)}const gN=P.forwardRef((t,e)=>{const{component:n="div",className:r,colors:a,translucent:i=!0,bgClassName:o="",innerClassName:s="",outline:l,tabbar:u,tabbarIcons:c,tabbarLabels:d,top:p,ios:f,material:g,children:y,...x}=t,b=P.useRef(null),v=P.useRef(null);P.useImperativeHandle(e,()=>({el:v.current}));const w=n,[S,C]=P.useState({transform:"",width:""}),I=Jt({ios:f,material:g}),_=Je({ios:f,material:g}),E=gt(),A={...x},M=yY(a,E),L=_(gY({...t,outline:typeof l>"u"?I==="ios":l,translucent:i,bgClassName:o,innerClassName:s},M,r),r),W=I==="material"&&u&&!c;return P.useEffect(()=>{if(W&&b.current){const B=b.current.previousElementSibling,K=1/B.children.length*100,X=[...B.children].indexOf(B.querySelector(".k-tabbar-link-active"));C({...S,width:`${K}%`,transform:`translateX(${X*100}%)`})}},[y]),G.createElement(w,mN({ref:v,className:L.base},A),G.createElement("div",{className:L.bg}),G.createElement("div",{className:L.inner},y),W&&G.createElement("span",{className:L.highlight,style:S,ref:b}))});gN.displayName="Toolbar";function yN(){return yN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},yN.apply(this,arguments)}const bY=P.forwardRef((t,e)=>{const{component:n="div",className:r,colors:a,id:i,style:o,name:s,placeholder:l="Message",value:u,outline:c=!1,leftClassName:d="",rightClassName:p="",textareaId:f,disabled:g,size:y,left:x,right:b,ios:v,material:w,onInput:S,onChange:C,onFocus:I,children:_,...E}=t,A=P.useRef(null),M=P.useRef(null);P.useImperativeHandle(e,()=>({el:A.current,areaElRef:M.current}));const[L,W]=P.useState(!1),B=Je({ios:v,material:w}),K=gt(),X=mY(a,K),Q=Z=>{W(!0),I&&I(Z)},H=B(fY({...t},X,{isFocused:L})),F=n,Y={...E};return G.createElement(F,yN({ref:A,id:i,style:o,className:H.base},Y),G.createElement(gN,{colors:X,outline:c},x&&G.createElement("div",{className:H.left},x),G.createElement("div",{className:H.messagebarArea},G.createElement("textarea",{id:f,ref:M,type:"textarea",className:H.messagebarInput,placeholder:l,name:s,size:y,disabled:g,onInput:S,onChange:C,onFocus:Q,value:u})),b&&G.createElement("div",{className:H.right},b)))});bY.displayName="Messagebar";const vY=()=>({base:{common:R("flex flex-col relative z-1 px-2"),ios:"mb-12",material:"mb-16"}});function bN(){return bN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},bN.apply(this,arguments)}const xY=P.forwardRef((t,e)=>{const{component:n="div",className:r,colors:a,id:i,ios:o,material:s,children:l,...u}=t,c=P.useRef(null);P.useImperativeHandle(e,()=>({el:c.current}));const d=Je({ios:o,material:s})(vY({...t})),p=n,f={...u};return G.createElement(p,bN({id:i,className:d.base,ref:c},f),l)});xY.displayName="Messages";const wY=(t,e)=>({base:{common:R("text-center text-xs leading-none"),ios:R("w-full mt-2.5",e.titleIos),material:R("mt-4",e.titleMd)}}),kY=function(t,e){return t===void 0&&(t={}),{titleIos:R("text-black text-opacity-45",e("dark:text-white dark:text-opacity-45")),titleMd:R("text-md-light-on-surface-variant",e("dark:text-md-dark-on-surface-variant")),...t}};function vN(){return vN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},vN.apply(this,arguments)}const SY=P.forwardRef((t,e)=>{const{component:n="div",className:r,colors:a,ios:i,material:o,id:s,children:l,...u}=t,c=P.useRef(null);P.useImperativeHandle(e,()=>({el:c.current}));const d=Je({ios:i,material:o}),p=gt(),f=kY(a,p),g=d(wY({...t},f)),y=n,x={...u};return G.createElement(y,vN({id:s,className:g.base,ref:c},x),l)});SY.displayName="MessagesTitle";const CY=(t,e,n)=>{const{outline:r,translucent:a,large:i,medium:o,transparent:s,left:l,right:u,fontSizeIos:c,fontSizeMaterial:d,titleFontSizeIos:p,titleFontSizeMaterial:f,titleLargeFontSizeIos:g,titleLargeFontSizeMaterial:y,titleMediumFontSizeIos:x,titleMediumFontSizeMaterial:b,bgClassName:v="",bgClass:w="",subnavbarClassName:S="",subnavbarClass:C="",innerClassName:I="",innerClass:_="",leftClassName:E="",leftClass:A="",titleClassName:M="",titleClass:L="",subtitleClassName:W="",subtitleClass:B="",rightClassName:K="",rightClass:X="",centerTitle:Q}=t;return{base:{common:R("w-full z-20 top-0 pt-safe",(i||o)&&"pointer-events-none",Dn("sticky",n)),ios:R(c,e.textIos),material:R(d,e.textMaterial)},bg:{common:R("absolute w-full h-full left-0 top-0",r&&"hairline-b",v||w),ios:R(e.bgIos,a&&"translucent"),material:`${e.bgMaterial}`},subnavbar:{common:R("relative flex items-center",S||C,(i||o)&&"pointer-events-auto"),ios:"h-11 pl-2-safe pr-2-safe",material:"h-14 pl-4-safe pr-4-safe"},inner:{common:R("flex relative items-center w-full overflow-hidden",I||_,(i||o)&&"pointer-events-auto z-10"),ios:R("pl-2-safe pr-2-safe h-11",!l&&u?"justify-end":"justify-between"),material:"justify-start h-16 pl-safe pr-safe"},titleContainer:{common:R("flex items-center px-4 relative",(i||o)&&"pointer-events-auto"),ios:R(o&&R(x,"h-11 font-semibold"),i&&R(g,"h-13 font-bold")),material:R(o&&R(b,"h-12 pb-4"),i&&R(y,"h-[5.5rem]"))},left:{common:R("flex justify-center items-center h-full",E||A),ios:"me-2 transform transform-gpu",material:"mx-1"},title:{common:R("whitespace-nowrap leading-tight",M||L,(i||o||s)&&"opacity-0",Q?"absolute top-1/2 left-1/2 transform-gpu -translate-x-1/2 -translate-y-1/2 text-center":"text-start"),ios:R(`${p} font-semibold`,!Q&&"first:mx-2"),material:R(`${f} font-normal`,!Q&&"first:mx-4")},subtitle:{common:R("font-normal leading-none",W||B),ios:"text-2xs opacity-55",material:"text-sm opacity-85"},right:{common:R("flex justify-center items-center h-full",K||X),ios:R("transform transform-gpu",Q?"ms-2":"ms-auto"),material:"ms-auto me-1"}}},NY=(t,e)=>({bgIos:R("bg-ios-light-surface-2",e("dark:bg-ios-dark-surface-2")),bgMaterial:R("bg-md-light-surface-2",e("dark:bg-md-dark-surface-2")),textIos:R("text-black",e("dark:text-white")),textMaterial:R("text-md-light-on-surface",e("dark:text-md-dark-on-surface")),...t});function xN(){return xN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},xN.apply(this,arguments)}const KM=P.forwardRef((t,e)=>{const{component:n="div",className:r,bgClassName:a="",innerClassName:i="",leftClassName:o="",titleClassName:s="",subtitleClassName:l="",rightClassName:u="",subnavbarClassName:c="",centerTitle:d,colors:p,translucent:f=!0,outline:g,medium:y,large:x,transparent:b,fontSizeIos:v="text-[17px]",fontSizeMaterial:w="text-[16px]",titleFontSizeIos:S="text-[17px]",titleFontSizeMaterial:C="text-[22px]",titleMediumFontSizeIos:I="text-[24px]",titleMediumFontSizeMaterial:_="text-[24px]",titleLargeFontSizeIos:E="text-[34px]",titleLargeFontSizeMaterial:A="text-[28px]",scrollEl:M,left:L,title:W,subtitle:B,right:K,subnavbar:X,ios:Q,material:H,children:F,...Y}=t,Z=P.useRef(null),ne=P.useRef(0),se=P.useRef(null),ce=P.useRef(null),le=P.useRef(null),ye=P.useRef(null),we=P.useRef(null),q=P.useRef(null);P.useImperativeHandle(e,()=>({el:Z.current}));const ie=n,de=Jt({ios:Q,material:H}),ke=Je({ios:Q,material:H}),Ne=gt(),Ie={...Y},De=NY(p,Ne),He=Qe=>{const{scrollTop:Xt}=Qe.target;if(!b&&!x&&!y){q.current&&(ye.current&&(ye.current.style.opacity=""),se.current&&(se.current.style.opacity=""));return}const Wt=ne.current,Ht=Math.max(Math.min(Xt/Wt,1),0);se.current.style.opacity=b?-.5+Ht*1.5:"",(y||x)&&(se.current.style.transform=`translateY(-${Ht*Wt}px)`),le.current&&(le.current.style.transform=`translateY(-${Ht*Wt}px)`,le.current.style.opacity=1-Ht*2),ye.current&&(ye.current.style.opacity=-.5+Ht*1.5),(y||x)&&we.current&&(we.current.style.transform=`translateY(-${Ht*Wt}px)`)},Me=()=>typeof M>"u"?Z.current&&Z.current.parentNode:M.current||M,it=()=>{if(!x&&!y&&!b){q.current&&(He({target:{scrollTop:0}}),q.current=!1);return}q.current=!0,le.current?ne.current=le.current.offsetHeight:ne.current=ce.current.offsetHeight;const Qe=Me();Qe?(Qe.addEventListener("scroll",He),He({target:Qe})):He({target:{scrollTop:0}})},Ye=()=>{const Qe=Me();Qe&&Qe.removeEventListener("scroll",He)};P.useEffect(()=>(it(),Ye));const Ze=ke(CY({...t,centerTitle:typeof d>"u"?de==="ios":d,translucent:f,outline:typeof g>"u"?de==="ios":g,fontSizeIos:v,fontSizeMaterial:w,titleFontSizeIos:S,titleFontSizeMaterial:C,titleMediumFontSizeIos:I,titleMediumFontSizeMaterial:_,titleLargeFontSizeIos:E,titleLargeFontSizeMaterial:A,bgClassName:a,innerClassName:i,leftClassName:o,titleClassName:s,subtitleClassName:l,rightClassName:u,subnavbarClassName:c},De,r),r);return G.createElement(ie,xN({ref:Z,className:Ze.base},Ie),G.createElement("div",{className:Ze.bg,ref:se}),G.createElement("div",{className:Ze.inner,ref:ce},L&&G.createElement("div",{className:Ze.left},L),(W||B)&&G.createElement("div",{className:Ze.title,ref:ye},W,B&&G.createElement("div",{className:Ze.subtitle},B)),K&&G.createElement("div",{className:Ze.right},K),F),(x||y)&&G.createElement("div",{className:Ze.titleContainer,ref:le},W),X&&G.createElement("div",{className:Ze.subnavbar,ref:we},X))});KM.displayName="Navbar";function oy(){return oy=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},oy.apply(this,arguments)}const XM=t=>{let{theme:e,...n}=t;return e==="ios"?G.createElement("svg",oy({xmlns:"http://www.w3.org/2000/svg",width:"12",height:"20",viewBox:"0 0 12 20",fill:"currentcolor"},n),G.createElement("path",{d:"M0.18261596,9.4221638 C0.21783626,9.37068075 0.25835058,9.32165682 0.30416276,9.27584463 L9.1425872,0.4374202 C9.7256776,-0.14567018 10.6691555,-0.1475686 11.2590259,0.44230183 C11.8448123,1.02808827 11.8502479,1.97240019 11.2639075,2.55874056 L3.82594417,9.9967039 L11.2578297,17.4285894 C11.8409201,18.0116798 11.8428185,18.9551577 11.252948,19.5450281 C10.6671616,20.1308146 9.7228497,20.1362501 9.13650932,19.5499097 L0.2980849,10.7114853 C-0.0545897,10.3588107 -0.0959125,9.8144953 0.18261596,9.4221638 Z"})):G.createElement("svg",oy({xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentcolor"},n),G.createElement("polygon",{points:"16 7 3.83 7 9.42 1.41 8 0 0 8 8 16 9.41 14.59 3.83 9 16 9"}))},TY=()=>({base:{common:"cursor-pointer",material:"min-w-12 k-touch-ripple-inset"},icon:"rtl:rotate-180"});function wN(){return wN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},wN.apply(this,arguments)}const IY=P.forwardRef((t,e)=>{const{component:n="a",className:r,text:a="Back",showText:i="auto",ios:o,material:s,onClick:l,children:u,...c}=t,d=P.useRef(null);P.useImperativeHandle(e,()=>({el:d.current}));const p={...c},f=Jt({ios:o,material:s}),g=Je({ios:o,material:s}),y=i==="auto"&&f==="ios"||i===!0,x=g(TY(),r);return G.createElement(iN,wN({ref:d,component:n,className:x.base,navbar:!0},p,{onClick:l}),G.createElement("span",{className:x.icon},G.createElement(XM,{theme:f})),y&&G.createElement("span",null,a),u)});IY.displayName="NavbarBackLink";const EY=(t,e,n)=>{const{opened:r,translucent:a}=t;return{base:{common:R(Dn("absolute",n),"z-50 transform transition-transform-opacity box-border duration-500",!r&&"-translate-y-full opacity-0 pointer-events-none transition duration-500","md:w-[568px] md:end-auto md:start-1/2 md:-ms-[256px]"),ios:R("rounded-xl px-2.5 py-2.5 start-2 end-2 top-2 shadow-lg",e.bgIos,a&&"translucent"),material:R("rounded-2xl py-5 px-4 start-4 end-4 top-4",e.bgMaterial)},content:{common:"",ios:"mt-2.5 ",material:R("mt-2")},header:{common:R("flex justify-start"),ios:"items-center",material:"items-start"},icon:{ios:R("me-2"),material:"me-4"},contentTitle:{material:R("flex flex-row items-center")},title:{ios:R("tracking-wide text-[13px] uppercase",e.titleIos),material:R("font-medium")},titleRightText:{ios:R("me-1 ms-auto text-[13px]",e.titleRightIos),material:R("ms-1 text-xs before:w-0.75 before:h-0.75 before:rounded-full before:inline-block before:align-middle before:me-1",e.titleRightMd)},button:{ios:R("me-1 ms-auto cursor-pointer"),material:R("ms-auto cursor-pointer")},deleteIcon:{ios:R("w-5 h-5",e.deleteIconIos),material:R("w-6 h-6",e.deleteIconMd)},subtitle:{ios:R("text-[15px] font-semibold",e.subtitleIos),material:R("text-sm")},text:{ios:R("text-[15px]"),material:R("text-sm",e.textMaterial)}}},_Y=(t,e)=>({bgIos:R("bg-white",e("dark:bg-[#1e1e1e]")),bgMaterial:R("bg-md-light-surface-5",e("dark:bg-md-dark-surface-5")),titleIos:R("text-black",e("dark:text-white")),titleRightIos:R("text-opacity-45 text-black",e("dark:text-white dark:text-opacity-45")),titleRightMd:R("text-md-light-on-surface-variant before:bg-md-light-on-surface-variant",e("dark:text-md-dark-on-surface-variant before:dark:bg-md-dark-on-surface-variant")),subtitleIos:R("text-black ",e("dark:text-white")),textMaterial:R("text-md-light-on-surface-variant",e("dark:text-md-dark-on-surface-variant ")),deleteIconIos:R("fill-stone-400 active:fill-stone-200",e("dark:fill-stone-500 dark:active:fill-stone-700")),deleteIconMd:R("text-md-light-on-surface-variant",e("dark:text-md-dark-on-surface-variant")),...t});function sy(){return sy=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},sy.apply(this,arguments)}const OY=P.forwardRef((t,e)=>{const{component:n="div",className:r,colors:a,button:i,icon:o,title:s,titleRightText:l,subtitle:u,text:c,translucent:d=!0,opened:p,onClose:f,ios:g,material:y,children:x,...b}=t,v=P.useRef(null);P.useImperativeHandle(e,()=>({el:v.current}));const w=n,S={...b},C=Jt({ios:g,material:y}),I=Je({ios:g,material:y}),_=gt(),E=_Y(a,_),A=I(EY({...t,translucent:d},E,r),r);return C==="ios"?G.createElement(w,sy({ref:v,className:A.base},S),G.createElement("div",{className:A.header},o&&G.createElement("div",{className:A.icon},o),s&&G.createElement("div",{className:A.title},s),l&&G.createElement("div",{className:A.titleRightText},l),i&&G.createElement("div",{className:A.button,role:"button",tabIndex:"0",onClick:f},G.createElement(tf,{theme:C,className:A.deleteIcon}))),G.createElement("div",{className:A.content},u&&G.createElement("div",{className:A.subtitle},u),c&&G.createElement("div",{className:A.text},c),x)):G.createElement(w,sy({ref:v,className:A.base},S),G.createElement("div",{className:A.header},o&&G.createElement("div",{className:A.icon},o),G.createElement("div",{className:A.contentWrapper},G.createElement("div",{className:A.contentTitle},s&&G.createElement("div",{className:A.title},s),l&&G.createElement("div",{className:A.titleRightText},l)),G.createElement("div",{className:A.content},u&&G.createElement("div",{className:A.subtitle},u),c&&G.createElement("div",{className:A.text},c),x)),i&&G.createElement("div",{className:A.button,role:"button",tabIndex:"0",onClick:f},G.createElement(tf,{theme:C,className:A.deleteIcon}))))});OY.displayName="Notification";const $Y=(t,e,n)=>({base:{common:R("h-full w-full left-0 top-0 overflow-auto",Dn("absolute",n)),ios:e.bgIos,material:e.bgMaterial}}),RY=function(t,e){return t===void 0&&(t={}),{bgIos:R("bg-ios-light-surface",e("dark:bg-ios-dark-surface")),bgMaterial:R("bg-md-light-surface",e("dark:bg-md-dark-surface")),...t}};function kN(){return kN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},kN.apply(this,arguments)}const SN=P.forwardRef((t,e)=>{const{component:n="div",className:r,colors:a,ios:i,material:o,children:s,...l}=t,u=P.useRef(null);P.useImperativeHandle(e,()=>({el:u.current}));const c=n,d={...l},p=Je({ios:i,material:o}),f=gt(),g=RY(a,f),y=p($Y(t,g,r),r);return G.createElement(c,kN({ref:u,className:y.base},d),s)});SN.displayName="Page";const MY=(t,e,n)=>{const{size:r,floating:a}=t;return{base:{common:R("transition-transform transform duration-400 z-40 max-w-full overflow-hidden",a?"top-2-safe bottom-2-safe !h-auto":"top-0 max-h-full",e.bg,Dn("fixed",n),r),ios:"",material:"ease-material-in"},left:{common:R("no-safe-areas-right",a?"right-full -mr-2 rounded-2xl":"right-full"),material:R(!a&&"rounded-r-2xl"),opened:"translate-x-full",closed:"-translate-x-2"},right:{common:R("no-safe-areas-left",a?"left-full -ml-2 rounded-2xl":"left-full"),material:R(!a&&"rounded-l-2xl"),opened:"-translate-x-full",closed:"translate-x-2"},backdrop:{common:"fixed z-40 w-full h-full left-0 top-0 bg-black bg-opacity-50 duration-400",opened:"",closed:"opacity-0 pointer-events-none"}}},AY=function(t,e){return t===void 0&&(t={}),{bg:R("bg-white",e("dark:bg-black")),...t}};function CN(){return CN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},CN.apply(this,arguments)}const PY=P.forwardRef((t,e)=>{const{component:n="div",className:r,colors:a,size:i="w-72 h-screen",side:o="left",opened:s,backdrop:l=!0,floating:u=!1,onBackdropClick:c,ios:d,material:p,children:f,...g}=t,y=P.useRef(null);P.useImperativeHandle(e,()=>({el:y.current}));const x=s?"opened":"closed",b=n,v={...g},w=Je({ios:d,material:p}),S=gt(),C=AY(a,S),I=w(MY({...t,size:i,floating:u},C,r),r),_=R(I.base,I[o][x]);return G.createElement(G.Fragment,null,l&&G.createElement("div",{className:I.backdrop[x],onClick:c}),G.createElement(b,CN({ref:y,className:_},v),f))});PY.displayName="Panel";const DY=t=>{let{popoverEl:e,targetEl:n,angleEl:r,needsAngle:a,targetX:i,targetY:o,targetWidth:s=0,targetHeight:l=0,theme:u}=t;n.current?n=n.current:n.value?n=n.value:n.el?n=n.el:n.$el&&(n=n.$el),typeof n=="string"&&(n=document.querySelector(n));let c=document.body.offsetWidth,d=document.body.offsetHeight;c===0&&(c=window.innerWidth),d===0&&(d=window.innerHeight);const[p,f]=[e.offsetWidth,e.offsetHeight];let g=0,y,x,b="";a&&(g=r.offsetWidth/2);let v,w;const S=window.getComputedStyle(n);let C=parseInt(S.getPropertyValue("--k-safe-area-top"),10)||0,I=parseInt(S.getPropertyValue("--k-safe-area-left"),10)||0,_=parseInt(S.getPropertyValue("--k-safe-area-right"),10)||0;if(Number.isNaN(C)&&(C=0),Number.isNaN(I)&&(I=0),Number.isNaN(_)&&(_=0),n){s=n.offsetWidth,l=n.offsetHeight;const X=n.getBoundingClientRect();v=X.left,w=X.top}else typeof i<"u"&&o!=="undefined"&&(v=i,w=o);let[E,A,M]=[0,0,0];const L=u==="ios"?13:23;let W="top";f+g<w-C?A=w-f-g:f+g<d-w-l?(W="bottom",A=w+l+g):(W="middle",A=l/2+w-f/2,M=A,A=Math.max(5,Math.min(A,d-f-5)),M-=A),W==="top"||W==="bottom"?(E=s/2+v-p/2,M=E,E=Math.max(5,Math.min(E,c-p-5)),I&&(E=Math.max(E,I)),_&&E+p>c-5-_&&(E=c-5-_-p),W==="top"&&(b="bottom"),W==="bottom"&&(b="top"),M-=E,y=p/2-g+M,y=Math.max(Math.min(y,p-g*2-L),L)):W==="middle"&&(E=v-p-g,b="right",(E<5||E+p+_>c||E<I)&&(E<5&&(E=v+s+g),E+p+_>c&&(E=c-p-5-_),E<I&&(E=I),b="left"),x=f/2-g+M,x=Math.max(Math.min(x,f-g*2-L),L));const B=W,K=E<v?"left":"right";return{set:!0,angleTop:typeof x>"u"?void 0:`${x}px`,angleLeft:typeof y>"u"?void 0:`${y}px`,anglePosition:b,popoverTop:`${A}px`,popoverLeft:`${E}px`,popoverPosition:`${B}-${K}`}},LY=(t,e,n)=>{const{size:r,translucent:a,angleClassName:i,angleClass:o}=t;return{base:{common:R("transition-transform-opacity z-40 no-safe-areas",Dn("fixed",n),r),ios:"duration-300",material:"duration-400 ease-material-in",opened:"",closed:{common:"opacity-0 pointer-events-none",ios:"",material:"scale-x-90 scale-y-75"}},inner:{common:R("overflow-hidden relative"),ios:R("rounded-xl",a&&"translucent",e.bgIos),material:R("rounded-[1.75rem]",e.bgMaterial)},angleWrap:{common:R(i||o||"","pointer-events-none"),ios:R("absolute w-6.5 h-6.5 z-50 overflow-hidden",a&&"opacity-80"),material:R("absolute w-6.5 h-6.5 z-50 overflow-hidden"),bottom:"top-full",top:"bottom-full",left:"right-full",right:"left-full"},angleArrow:{common:R("absolute rounded w-full h-full transform rotate-45"),ios:e.bgIos,material:e.bgMaterial,bottom:"-top-4.75",top:"top-4.75",left:"left-4.75",right:"-left-4.75"},backdrop:{common:"fixed z-40 w-full h-full left-0 top-0 bg-black bg-opacity-50 duration-300",opened:"",closed:"opacity-0 pointer-events-none"}}},FY=function(t,e){return t===void 0&&(t={}),{bgIos:R("bg-ios-light-surface-3",e("dark:bg-ios-dark-surface-3")),bgMaterial:R("bg-md-light-surface-3",e("dark:bg-md-dark-surface-3")),...t}};function NN(){return NN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},NN.apply(this,arguments)}const BY=P.forwardRef((t,e)=>{const{component:n="div",className:r,angle:a=!0,angleClassName:i="",colors:o,size:s="w-64",opened:l,backdrop:u=!0,onBackdropClick:c,target:d,targetX:p,targetY:f,targetWidth:g,targetHeight:y,translucent:x=!0,ios:b,material:v,children:w,style:S={},...C}=t,I=P.useRef(null),_=P.useRef(null),[E,A]=P.useState({set:!1,angleTop:0,angleLeft:0,anglePosition:"bottom",popoverTop:0,popoverLeft:0,popoverPosition:"top-left"});P.useImperativeHandle(e,()=>({el:I.current}));const M=l?"opened":"closed",L=n,W={...C},B=Jt({ios:b,material:v}),K=Je({ios:b,material:v}),X=gt(),Q=FY(o,X),H=K(LY({...t,size:s,angleClassName:i,translucent:x},Q,r),r),F=()=>{!d||!I.current||!l||A(DY({popoverEl:I.current,targetEl:d,angleEl:_.current,needsAngle:a,targetX:p,targetY:f,targetHeight:y,targetWidth:g,theme:B}))},Y=()=>{typeof window>"u"||window.addEventListener("resize",F)},Z=()=>{typeof window>"u"||window.removeEventListener("resize",F)};P.useEffect(()=>(Y(),()=>Z())),P.useEffect(()=>{F()},[l]);const ne=E.set?{...S||{},left:E.popoverLeft,top:E.popoverTop}:S,se=E.set?{left:E.angleLeft,top:E.angleTop}:void 0,ce={"top-right":"origin-bottom-left","top-left":"origin-bottom-right","middle-left":"origin-right","middle-right":"origin-left","bottom-right":"origin-top-left","bottom-left":"origin-top-right"},le=R(H.base[M],B==="material"&&ce[E.popoverPosition]);return G.createElement(G.Fragment,null,u&&G.createElement("div",{className:H.backdrop[M],onClick:c}),G.createElement(L,NN({ref:I,className:le,style:ne},W),a&&G.createElement("div",{ref:_,style:se,className:H.angleWrap[E.anglePosition]},G.createElement("div",{className:H.angleArrow[E.anglePosition]})),G.createElement("div",{className:H.inner},w)))});BY.displayName="Popover";const zY=(t,e,n)=>{const{size:r}=t;return{base:{common:R("left-1/2 top-1/2 transition-transform transform -translate-x-1/2 z-40 max-w-full max-h-full overflow-hidden md:no-safe-areas",e.bg,Dn("fixed",n),r),ios:"duration-400 md:rounded-lg",material:" md:rounded-[1.75rem]",opened:{common:"-translate-y-1/2",material:R("ease-material-in-popup duration-[600ms]")},closed:{common:"translate-y-full",material:"duration-400"}},backdrop:{common:"fixed z-40 w-full h-full left-0 top-0 bg-black bg-opacity-50 duration-400",opened:"",closed:"opacity-0 pointer-events-none"}}},VY=function(t,e){return t===void 0&&(t={}),{bg:R("bg-white",e("dark:bg-black")),...t}};function TN(){return TN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},TN.apply(this,arguments)}const YM=P.forwardRef((t,e)=>{const{component:n="div",className:r,colors:a,size:i="w-screen h-screen md:w-160 md:h-160",opened:o,backdrop:s=!0,onBackdropClick:l,ios:u,material:c,children:d,...p}=t,f=P.useRef(null);P.useImperativeHandle(e,()=>({el:f.current}));const g=o?"opened":"closed",y=n,x={...p},b=Je({ios:u,material:c}),v=gt(),w=VY(a,v),S=b(zY({...t,size:i},w,r),r);return G.createElement(G.Fragment,null,s&&G.createElement("div",{className:S.backdrop[g],onClick:l}),G.createElement(y,TN({ref:f,className:S.base[g]},x),d))});YM.displayName="Popup";function IN(){return IN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},IN.apply(this,arguments)}const WY=t=>G.createElement("svg",IN({xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20",fill:"currentcolor"},t),G.createElement("path",{d:"M10,0 C10.5522847,0 11,0.44771525 11,1 L11,6 C11,6.55228475 10.5522847,7 10,7 C9.44771525,7 9,6.55228475 9,6 L9,1 C9,0.44771525 9.44771525,0 10,0 Z"}),G.createElement("path",{d:"M10,13 C10.5522847,13 11,13.4477153 11,14 L11,19 C11,19.5522847 10.5522847,20 10,20 C9.44771525,20 9,19.5522847 9,19 L9,14 C9,13.4477153 9.44771525,13 10,13 Z",opacity:".64"}),G.createElement("path",{d:"M13,10 C13,9.44771525 13.4477153,9 14,9 L19,9 C19.5522847,9 20,9.44771525 20,10 C20,10.5522847 19.5522847,11 19,11 L14,11 C13.4477153,11 13,10.5522847 13,10 Z",opacity:".82"}),G.createElement("path",{d:"M-3.8285687e-16,10 C-3.8285687e-16,9.44771525 0.44771525,9 1,9 L6,9 C6.55228475,9 7,9.44771525 7,10 C7,10.5522847 6.55228475,11 6,11 L1,11 C0.44771525,11 -3.8285687e-16,10.5522847 -3.8285687e-16,10 Z",opacity:".46"}),G.createElement("path",{d:"M2.92912627,2.92912627 C3.31965056,2.53860197 3.95281554,2.53860197 4.34333983,2.92912627 L7.87887373,6.46466017 C8.26939803,6.85518446 8.26939803,7.48834944 7.87887373,7.87887373 C7.48834944,8.26939803 6.85518446,8.26939803 6.46466017,7.87887373 L2.92912627,4.34333983 C2.53860197,3.95281554 2.53860197,3.31965056 2.92912627,2.92912627 Z",opacity:".37"}),G.createElement("path",{d:"M12.1211263,12.1211263 C12.5116506,11.730602 13.1448155,11.730602 13.5353398,12.1211263 L17.0708737,15.6566602 C17.461398,16.0471845 17.461398,16.6803494 17.0708737,17.0708737 C16.6803494,17.461398 16.0471845,17.461398 15.6566602,17.0708737 L12.1211263,13.5353398 C11.730602,13.1448155 11.730602,12.5116506 12.1211263,12.1211263 Z",opacity:".73"}),G.createElement("path",{d:"M12.1211263,7.87887373 C11.730602,7.48834944 11.730602,6.85518446 12.1211263,6.46466017 L15.6566602,2.92912627 C16.0471845,2.53860197 16.6803494,2.53860197 17.0708737,2.92912627 C17.461398,3.31965056 17.461398,3.95281554 17.0708737,4.34333983 L13.5353398,7.87887373 C13.1448155,8.26939803 12.5116506,8.26939803 12.1211263,7.87887373 Z",opacity:".91"}),G.createElement("path",{d:"M2.92912627,17.0708737 C2.53860197,16.6803494 2.53860197,16.0471845 2.92912627,15.6566602 L6.46466017,12.1211263 C6.85518446,11.730602 7.48834944,11.730602 7.87887373,12.1211263 C8.26939803,12.5116506 8.26939803,13.1448155 7.87887373,13.5353398 L4.34333983,17.0708737 C3.95281554,17.461398 3.31965056,17.461398 2.92912627,17.0708737 Z",opacity:".55"}));function EN(){return EN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},EN.apply(this,arguments)}const jY=t=>G.createElement("svg",EN({viewBox:"0 0 36 36"},t,{fill:"none",stroke:"currentcolor"}),G.createElement("circle",{cx:"18",cy:"18",r:"16"})),UY=(t,e,n)=>{const{size:r}=t;return{base:{common:R(n==="ios"?"k-ios-preloader":"k-material-preloader",`inline-block ${r}`),ios:e.iconIos,material:`stroke-4 ${e.iconMaterial}`},inner:{common:"block w-full h-full"}}},GY=function(t,e){return t===void 0&&(t={}),{iconIos:"text-primary",iconMaterial:R("text-md-light-primary",e("dark:text-md-dark-primary")),...t}};function _N(){return _N=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},_N.apply(this,arguments)}const HY=P.forwardRef((t,e)=>{const{component:n="span",className:r,colors:a,size:i="w-8 h-8",ios:o,material:s,children:l,...u}=t,c=P.useRef(null);P.useImperativeHandle(e,()=>({el:c.current}));const d=n,p={...u},f=Jt({ios:o,material:s}),g=Je({ios:o,material:s}),y=gt(),x=GY(a,y),b=f==="ios"?WY:jY,v=g(UY({...t,size:i},x,f),r);return G.createElement(d,_N({ref:c,className:v.base},p),G.createElement("span",{className:v.inner},G.createElement(b,{className:"w-full h-full"})),l)});HY.displayName="Preloader";const qY=t=>({base:{common:"block h-1 bg-opacity-30 dark:bg-opacity-30 overflow-hidden rtl:rotate-180",ios:"bg-black rounded-full",material:t.bgMaterial},inner:{common:"block duration-200 w-full h-full",ios:t.bgIos,material:t.bgMaterial}}),KY=function(t,e){return t===void 0&&(t={}),{bgIos:"bg-primary",bgMaterial:R("bg-md-light-primary",e("dark:bg-md-dark-primary")),...t}};function ON(){return ON=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},ON.apply(this,arguments)}const XY=P.forwardRef((t,e)=>{const{component:n="span",className:r,colors:a,ios:i,material:o,progress:s=0,children:l,...u}=t,c=P.useRef(null);P.useImperativeHandle(e,()=>({el:c.current}));const d=n,p={...u},f=Je({ios:i,material:o}),g=gt(),y=KY(a,g),x=f(qY(y),r);return G.createElement(d,ON({ref:c,className:x.base},p),G.createElement("span",{className:x.inner,style:{transform:`translateX(-${100-s/1*100}%)`}}),l)});XY.displayName="Progressbar";const YY=(t,e,n,r)=>({base:R("cursor-pointer inline-flex align-middle",Dn("relative",n),r("dark:touch-ripple-white")),iconWrap:{common:"flex items-center justify-center rounded-full",ios:"w-5.5 h-5.5 border",material:"w-5 h-5 border-2",notChecked:{ios:e.borderIos,material:e.borderMaterial},checked:{ios:e.borderCheckedIos,material:e.borderCheckedMaterial}},icon:{ios:"text-primary",material:`w-3 h-3 rounded-full ${e.bgCheckedMaterial}`,notChecked:"opacity-0",checked:"opacity-100"},indeterminateIcon:{common:"bg-white w-3/4",ios:"h-0.25",material:"h-0.5"},input:{common:"hidden"}}),QY=function(t,e){return t===void 0&&(t={}),{borderIos:R("border-black border-opacity-30",e("dark:border-white dark:border-opacity-30")),borderMaterial:R("border-md-light-outline",e("dark:border-md-dark-outline")),bgCheckedIos:"bg-primary",bgCheckedMaterial:R("bg-md-light-primary",e("dark:bg-md-dark-primary")),borderCheckedIos:"border-primary",borderCheckedMaterial:R("border-md-light-primary",e("dark:border-md-dark-primary")),...t}};function $N(){return $N=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},$N.apply(this,arguments)}const ZY=P.forwardRef((t,e)=>{const{component:n="label",className:r,colors:a,defaultChecked:i,checked:o,name:s,value:l,disabled:u,readOnly:c,onChange:d,ios:p,material:f,touchRipple:g=!0,children:y,...x}=t,b=P.useRef(null);P.useImperativeHandle(e,()=>({el:b.current}));const v=n,w={...x},S=Jt({ios:p,material:f}),C=Je({ios:p,material:f}),I=gt();eo(b,S==="material"&&g);const _=QY(a,I),E=o||i&&!d?"checked":"notChecked",A=C(YY(t,_,r,I),r);return G.createElement(v,$N({ref:b,className:A.base},w),G.createElement("input",{type:"radio",name:s,value:l,disabled:u,readOnly:c,checked:o,defaultChecked:i,onChange:d,className:A.input}),G.createElement("i",{className:A.iconWrap[E]},S==="ios"?G.createElement(GM,{className:A.icon[E]}):G.createElement("span",{className:A.icon[E]})),y)});ZY.displayName="Radio";const JY=(t,e,n)=>({base:{common:"block relative select-none w-full self-center touch-pan-y",ios:"h-7",material:"h-5"},trackBg:{common:R("absolute top-1/2 left-0 w-full transform -translate-y-1/2 bg-black bg-opacity-20",n("dark:bg-white dark:bg-opacity-20")),ios:"h-1 rounded-full",material:"h-0.5"},trackValue:{common:"absolute top-1/2 start-0 w-full transform -translate-y-1/2",ios:`h-1 rounded-full ${e.valueBgIos}`,material:`h-0.5 ${e.valueBgMaterial}`},input:{common:"appearance-none w-full bg-transparent cursor-pointer block focus:outline-none relative",ios:"h-7",material:"h-5"},inputThumb:{common:"range-thumb:relative range-thumb:appearance-none range-thumb:rounded-full range-thumb:border-none",ios:`range-thumb:w-7 range-thumb:h-7 range-thumb:-mt-3.5 ${e.thumbBgIos} range-thumb:shadow-ios-toggle`,material:`range-thumb:w-3 range-thumb:h-3 ${e.thumbBgMaterial} range-thumb:-mt-1.5 range-thumb:transform range-thumb:duration-200 active:range-thumb:scale-150`},inputTrack:{common:"range-track:appearance-none range-track:h-px"}}),eQ=function(t,e){return t===void 0&&(t={}),{valueBgIos:"bg-primary",valueBgMaterial:R("bg-md-light-primary",e("dark:bg-md-dark-primary")),thumbBgIos:"range-thumb:bg-white",thumbBgMaterial:R("range-thumb:bg-md-light-primary",e("dark:range-thumb:bg-md-dark-primary")),...t}};function RN(){return RN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},RN.apply(this,arguments)}const tQ=P.forwardRef((t,e)=>{const{component:n="div",className:r,colors:a,ios:i,material:o,children:s,inputId:l,name:u,value:c=void 0,defaultValue:d,readOnly:p,disabled:f,step:g=1,min:y=0,max:x=100,onInput:b,onChange:v,onFocus:w,onBlur:S,...C}=t,I=P.useRef(null);P.useImperativeHandle(e,()=>({el:I.current}));const _=n,E={...C},A=Je({ios:i,material:o}),M=gt(),L=eQ(a,M),W=A(JY(t,L,M),r),B=((c||0)-y)/(x-y)*100;return G.createElement(_,RN({ref:I,className:W.base},E),G.createElement("span",{className:W.trackBg}),G.createElement("span",{className:W.trackValue,style:{width:`${B}%`}}),G.createElement("input",{className:R(W.input,W.inputThumb,W.inputTrack),type:"range",id:l,name:u,min:y,max:x,step:g,value:c,defaultValue:d,readOnly:p,disabled:f,onInput:b,onChange:v,onFocus:w,onBlur:S}))});tQ.displayName="Range";const nQ=(t,e,n)=>{let{isEnabled:r,darkClasses:a}=n;return{base:{common:"relative flex overflow-hidden items-center",ios:"px-2 w-full",material:"px-0 py-2 -mx-2 w-[calc(100%+32px)]"},inner:{common:"w-full shrink-1 relative",ios:"transition-all duration-300"},searchIconWrap:{common:"absolute inset-y-0 flex items-center z-40",ios:"start-2",material:"start-4"},clearButton:{common:"absolute justify-center inset-y-0 flex items-center z-40 cursor-pointer end-0",ios:"w-8 h-8",material:"w-12 h-12"},input:{common:"block appearance-none  w-full py-2  focus:outline-none z-30",ios:R("h-8 bg-black/10 pl-7 pr-7 rounded-lg text-base",a("dark:placeholder-white dark:placeholder-opacity-30 dark:bg-white/10"),e.placeholderIos,e.inputBgIos),material:R("h-12 ps-12 pe-4 rounded-full",e.placeholderMaterial,e.inputBgMaterial)},deleteIcon:{common:"",ios:"w-3.5 h-3.5 opacity-45",material:"w-6 h-6 active:opacity-20"},searchIcon:{common:"",ios:R("w-4 h-4 opacity-45"),material:R("w-5 h-5 z-30",r?"opacity-0 transform rotate-90 scale-50 transition-transform-opacity  duration-400 ":"block transform transition-transform-opacity scale-100 rotate-0 duration-400")},cancelButton:{ios:R("ps-2 flex items-center h-8 cursor-pointer bg-transparent text-primary shrink-0 z-40 transition-all duration-300 active:opacity-30",r?"":"opacity-0"),material:R("absolute left-4 cursor-pointer",r?"z-40 transform scale-100 rotate-0 transition-transform-opacity  duration-400":"opacity-0 transform -rotate-90 scale-50 transition-transform-opacity duration-400")}}},rQ=function(t,e){return t===void 0&&(t={}),{inputBgIos:"",inputBgMaterial:R("bg-md-light-secondary-container",e("dark:bg-md-dark-secondary-container")),placeholderIos:"",placeholderMaterial:R("placeholder-md-light-on-surface-variant",e("dark:placeholder-md-dark-on-surface-variant")),...t}};function ly(){return ly=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},ly.apply(this,arguments)}const aQ=t=>{let{theme:e,...n}=t;return e==="ios"?G.createElement("svg",ly({xmlns:"http://www.w3.org/2000/svg",width:"13",height:"13",viewBox:"0 0 56 56",fill:"currentcolor"},n),G.createElement("path",{d:"M 23.9570 41.7695 C 27.8476 41.7695 31.4804 40.5039 34.4336 38.3945 L 45.5429 49.5039 C 46.0585 50.0195 46.7382 50.2774 47.4414 50.2774 C 48.9648 50.2774 50.0664 49.1055 50.0664 47.6055 C 50.0664 46.9023 49.8322 46.2461 49.3162 45.7305 L 38.2773 34.6679 C 40.5976 31.6211 41.9804 27.8476 41.9804 23.7461 C 41.9804 13.8320 33.8710 5.7226 23.9570 5.7226 C 14.0195 5.7226 5.9336 13.8320 5.9336 23.7461 C 5.9336 33.6601 14.0195 41.7695 23.9570 41.7695 Z M 23.9570 37.8789 C 16.1992 37.8789 9.8242 31.4805 9.8242 23.7461 C 9.8242 16.0117 16.1992 9.6133 23.9570 9.6133 C 31.6914 9.6133 38.0898 16.0117 38.0898 23.7461 C 38.0898 31.4805 31.6914 37.8789 23.9570 37.8789 Z"})):G.createElement("svg",ly({xmlns:"http://www.w3.org/2000/svg",width:"48",height:"48",viewBox:"0 0 56 56",fill:"currentcolor"},n),G.createElement("path",{d:"M 23.9570 41.7695 C 27.8476 41.7695 31.4804 40.5039 34.4336 38.3945 L 45.5429 49.5039 C 46.0585 50.0195 46.7382 50.2774 47.4414 50.2774 C 48.9648 50.2774 50.0664 49.1055 50.0664 47.6055 C 50.0664 46.9023 49.8322 46.2461 49.3162 45.7305 L 38.2773 34.6679 C 40.5976 31.6211 41.9804 27.8476 41.9804 23.7461 C 41.9804 13.8320 33.8710 5.7226 23.9570 5.7226 C 14.0195 5.7226 5.9336 13.8320 5.9336 23.7461 C 5.9336 33.6601 14.0195 41.7695 23.9570 41.7695 Z M 23.9570 37.8789 C 16.1992 37.8789 9.8242 31.4805 9.8242 23.7461 C 9.8242 16.0117 16.1992 9.6133 23.9570 9.6133 C 31.6914 9.6133 38.0898 16.0117 38.0898 23.7461 C 38.0898 31.4805 31.6914 37.8789 23.9570 37.8789 Z"}))};function MN(){return MN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},MN.apply(this,arguments)}const iQ=P.forwardRef((t,e)=>{const{component:n="div",className:r,colors:a,placeholder:i="Search",value:o,inputId:s,inputStyle:l,disableButton:u=!1,disableButtonText:c="Cancel",clearButton:d=!0,onInput:p,onChange:f,onFocus:g,onBlur:y,onClear:x,onDisable:b,ios:v,material:w,...S}=t,C=P.useRef(null),I=P.useRef(null),_=P.useRef(null),[E,A]=P.useState(0),M=P.useRef(null),L=P.useRef(!1);P.useImperativeHandle(e,()=>({el:I.current,searchEl:C.current}));const[W,B]=P.useState(!1),K=Jt({ios:v,material:w}),X=Je({ios:v,material:w}),Q=gt(),H=rQ(a,Q),F=de=>{p&&p(de)},Y=de=>{f&&f(de)},Z=de=>{B(!0),g&&g(de)},ne=de=>{y&&y(de)},se=()=>{o||(M.current=setTimeout(()=>{B(!1)}))},ce=()=>{clearTimeout(M.current)},le=de=>{de.preventDefault(),B(!1),C.current&&C.current.blur(),b&&b(),x&&x()};P.useEffect(()=>{_.current&&A(_.current.offsetWidth),requestAnimationFrame(()=>{requestAnimationFrame(()=>{L.current=!0})})},[]);const ye=X(nQ({...t},H,{isEnabled:W,darkClasses:Q})),we=K==="ios"?G.createElement("button",{type:"button",ref:_,style:{marginRight:W?0:`-${E}px`,transitionDuration:L.current?"":"0ms"},className:ye.cancelButton,onClick:le,onPointerDown:de=>de.preventDefault()},c):G.createElement(XM,{theme:K,onClick:le,className:R(ye.cancelButton),onPointerDown:de=>de.preventDefault()}),q=n,ie={...S};return G.createElement(q,MN({ref:I,className:ye.base},ie,{onBlurCapture:se,onFocusCapture:ce}),G.createElement("div",{className:ye.inner},G.createElement("span",{className:ye.searchIconWrap},G.createElement(aQ,{ios:v,material:w,className:ye.searchIcon})),G.createElement("input",{id:s,ref:C,className:R(ye.input),style:l,type:"text",name:"search",placeholder:i,value:o,onInput:F,onChange:Y,onFocus:Z,onBlur:ne}),o&&d&&G.createElement("button",{className:ye.clearButton,onClick:x,type:"button"},G.createElement(tf,{theme:K,className:ye.deleteIcon}))),u&&we)});iQ.displayName="Searchbar";const oQ=(t,e,n)=>{const{outline:r,rounded:a}=t;return{base:{common:"flex justify-center items-center overflow-hidden w-full",square:{ios:"rounded",material:"rounded-lg"},rounded:"rounded-full"},raised:r?"shadow":"shadow divide-x divide-black divide-opacity-10 rtl:divide-x-reverse",outline:{common:"",ios:`${e.borderIos} border-2`,material:`${e.borderMaterial} border`},outlineInner:{common:"-m-0.5 flex w-full justify-center items-center rtl:divide-x-reverse",ios:`divide-x-2 ${e.divideIos}`,material:`divide-x ${e.divideMaterial}`},strong:{common:R("p-0.5 space-x-1 relative"),ios:e.strongBgIos,material:e.strongBgMaterial},strongHighlight:{common:R("absolute start-0.5 top-0.5 bottom-0.5 !ms-0 pointer-events-none duration-200",a&&"rounded-full","bg-white shadow",n("dark:bg-opacity-15 dark:touch-ripple-white")),ios:R(!a&&"rounded"),material:R(!a&&"rounded-md")}}},sQ=function(t,e){return t===void 0&&(t={}),{strongBgIos:R("bg-black bg-opacity-5",e("dark:bg-white dark:bg-opacity-10")),strongBgMaterial:R("bg-md-light-surface-variant",e("dark:bg-md-dark-surface-variant")),borderIos:"border-primary",borderMaterial:R("border-md-light-outline",e("dark:border-md-dark-outline")),divideIos:"divide-primary",divideMaterial:R("divide-md-light-outline",e("dark:divide-md-dark-outline")),...t}};function AN(){return AN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},AN.apply(this,arguments)}const lQ=P.forwardRef((t,e)=>{const{component:n="div",className:r,colors:a,ios:i,material:o,raised:s,outline:l,strong:u,rounded:c,children:d,...p}=t,f=P.useRef(null),g=P.useRef(null);P.useImperativeHandle(e,()=>({el:f.current}));const[y,x]=P.useState({transform:"",width:""}),b=n,v={...p},w=Je({ios:i,material:o}),S=gt(),C=sQ(a,S),I=w(oQ(t,C,S)),_=R(c?I.base.rounded:I.base.square,s&&I.raised,l&&I.outline,u&&I.strong,r);return P.useEffect(()=>{if(u&&g.current){const E=g.current.parentElement,A=E.children.length-1,M=[...E.children].indexOf(E.querySelector(".k-segmented-strong-button-active")),L="4px";x({...y,width:`calc((100% - 2px * 2 - ${L} * (${A} - 1)) / ${A})`,transform:`translateX(calc((${M} * 100% + ${M} * ${L}) * var(--k-rtl-reverse)))`})}},[d]),G.createElement(b,AN({ref:f,className:_},v),l?G.createElement("span",{className:I.outlineInner},d):d,u&&G.createElement("span",{ref:g,className:I.strongHighlight,style:y}))});lQ.displayName="Segmented";function PN(){return PN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},PN.apply(this,arguments)}const uQ=P.forwardRef((t,e)=>{const{active:n,children:r,outline:a,strong:i,clear:o,rounded:s,...l}=t,u=P.useRef(null);return P.useImperativeHandle(e,()=>({el:u.current})),G.createElement(Br,PN({ref:u,segmented:!0,segmentedActive:n,segmentedStrong:i,rounded:s&&i},l),r)});uQ.displayName="SegmentedButton";const cQ=(t,e,n)=>({base:{common:R("left-0 top-full transition-transform duration-400 z-40 overflow-hidden",Dn("fixed",n)),ios:"",material:`rounded-t-2xl ease-material-in ${e.bgIos}`,opened:`-translate-y-full ${e.bgMaterial}`,closed:""},backdrop:{common:"fixed z-40 w-full h-full left-0 top-0 bg-black bg-opacity-50 duration-400",opened:"",closed:"opacity-0 pointer-events-none"}}),dQ=function(t,e){return t===void 0&&(t={}),{bgIos:R("bg-white",e("dark:bg-black")),bgMaterial:R("bg-md-light-surface",e("dark:bg-md-dark-surface")),...t}};function DN(){return DN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},DN.apply(this,arguments)}const pQ=P.forwardRef((t,e)=>{const{component:n="div",className:r,colors:a,opened:i,backdrop:o=!0,onBackdropClick:s,ios:l,material:u,children:c,...d}=t,p=P.useRef(null);P.useImperativeHandle(e,()=>({el:p.current}));const f=i?"opened":"closed",g=n,y={...d},x=Je({ios:l,material:u}),b=gt(),v=dQ(a,b),w=x(cQ(t,v,r),r);return G.createElement(G.Fragment,null,o&&G.createElement("div",{className:w.backdrop[f],onClick:s}),G.createElement(g,DN({ref:p,className:w.base[f]},y),c))});pQ.displayName="Sheet";const hQ=(t,e)=>{const{buttonsOnly:n}=t;return{base:`${e.text} inline-flex items-stretch`,raised:"shadow",size:{small:{ios:"h-6",material:"h-8"},medium:{ios:"h-7",material:"h-10"},large:{ios:"h-11",material:"h-12"}},shape:{square:{ios:"rounded",material:"rounded-lg"},rounded:"rounded-full"},button:{common:"relative flex items-center justify-center w-10 cursor-pointer overflow-hidden z-10 select-none"},buttonLeftShape:{square:{ios:"rounded-s",material:"rounded-s-lg"},rounded:"rounded-s-full"},buttonRightShape:{square:{ios:"rounded-e",material:"rounded-e-lg"},rounded:"rounded-e-full"},buttonStyle:{fill:{common:R(e.fillTouchRipple,n&&"first:border-r border-black border-opacity-10 rtl:first:border-l rtl:first:border-r-0"),ios:R(e.fillBgIos,e.fillTextIos,e.fillActiveBgIos),material:R(e.fillBgMaterial,e.fillTextMaterial,e.fillActiveBgMaterial)},outline:{common:R(e.touchRipple,"active:bg-opacity-15",n&&"first:border-r-0 rtl:last:border-r-0"),ios:R("border-2",e.textIos,e.activeBgIos,e.outlineBorderIos,n&&"rtl:first:border-r-2"),material:R("border",e.textMaterial,e.activeBgMaterial,e.outlineBorderMaterial,n&&"rtl:first:border-r")},clear:{common:`${e.touchRipple} active:bg-opacity-15 last:border-l rtl:last:border-l-0 rtl:first:border-l border-black border-opacity-10`,ios:R(e.textIos,e.activeBgIos),material:R(e.textMaterial,e.activeBgMaterial)}},input:{common:"focus:outline-none text-center appearance-none bg-transparent"},value:{common:"w-11 flex items-center justify-center font-medium",ios:`text-base ${e.textIos}`,material:`text-sm ${e.textMaterial}`,fill:{common:"",ios:`border-t-2 border-b-2 ${e.outlineBorderIos}`,material:`border-t border-b ${e.outlineBorderMaterial}`},outline:{common:"",ios:`border-t-2 border-b-2 ${e.outlineBorderIos}`,material:`border-t border-b ${e.outlineBorderMaterial}`},clear:"border-l border-black border-opacity-10"},hBar:"w-4 h-0.5 bg-current block",vBar:"w-0.5 h-4 bg-current block absolute inset-1/2 transform -translate-x-1/2 rtl:translate-x-1/2 -translate-y-1/2"}},fQ=function(t,e){return t===void 0&&(t={}),{activeBgIos:"active:bg-primary",activeBgMaterial:"",textIos:"text-primary",textMaterial:R("text-md-light-primary","dark:text-md-dark-primary"),fillTextIos:R("text-white"),fillTextMaterial:R("text-md-light-on-primary",e("dark:text-md-dark-on-primary")),fillBgIos:"bg-primary",fillBgMaterial:R("bg-md-light-primary",e("dark:bg-md-dark-primary")),fillActiveBgIos:"active:bg-ios-primary-shade",fillActiveBgMaterial:"",fillTouchRipple:R("touch-ripple-white","dark:touch-ripple-primary"),outlineBorderIos:"border-primary",outlineBorderMaterial:R("border-md-light-outline",e("dark:border-md-dark-outline")),touchRipple:"touch-ripple-primary",...t}};function LN(){return LN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},LN.apply(this,arguments)}const mQ=P.forwardRef((t,e)=>{const{component:n="span",className:r,colors:a,value:i=0,defaultValue:o,input:s=!1,inputType:l="text",inputPlaceholder:u,inputDisabled:c,inputReadOnly:d,buttonsOnly:p,rounded:f,roundedIos:g,roundedMaterial:y,small:x,smallIos:b,smallMaterial:v,large:w,largeIos:S,largeMaterial:C,raised:I,raisedIos:_,raisedMaterial:E,outline:A,outlineIos:M,outlineMaterial:L,onInput:W,onChange:B,onFocus:K,onBlur:X,onMinus:Q,onPlus:H,ios:F,material:Y,touchRipple:Z=!0,children:ne,...se}=t,ce=P.useRef(null),le=P.useRef(null),ye=P.useRef(null);P.useImperativeHandle(e,()=>({el:ce.current}));const we=n,q=Jt({ios:F,material:Y}),ie=Je({ios:F,material:Y});eo(le,q==="material"&&Z),eo(ye,q==="material"&&Z);const de=typeof f>"u"?q==="ios"?g:y:f,ke=typeof x>"u"?q==="ios"?b:v:x,Ne=typeof w>"u"?q==="ios"?S:C:w,Ie=typeof I>"u"?q==="ios"?_:E:I,De=typeof A>"u"?q==="ios"?M:L:A,He=gt(),Me=fQ(a,He),it=Ne?"large":ke?"small":"medium",Ye=De&&Ie?"clear":De?"outline":"fill",Ze=de?"rounded":"square",Qe=ie(hQ({...t,rounded:de,small:ke,large:Ne,raised:Ie,outline:De},Me)),Xt={...se},Wt=R(Qe.base,Ie&&Qe.raised,Qe.size[it],Qe.shape[Ze],r),Ht=R(Qe.button,Qe.buttonStyle[Ye],Qe.buttonLeftShape[Ze]),Yt=R(Qe.button,Qe.buttonStyle[Ye],Qe.buttonRightShape[Ze]),jt=R(s&&Qe.input,Qe.value[Ye]);return G.createElement(we,LN({ref:ce,className:Wt},Xt),G.createElement("span",{ref:le,className:Ht,role:"button",tabIndex:"0",onClick:Q},G.createElement("span",{className:Qe.hBar})),s&&!p&&G.createElement("input",{className:jt,placeholder:u,type:l,value:i,defaultValue:o,disabled:c,readOnly:d,onInput:W,onChange:B,onFocus:K,onBlur:X}),!s&&!p&&G.createElement("span",{className:jt},i),G.createElement("span",{ref:ye,className:Yt,role:"button",tabIndex:"0",onClick:H},G.createElement("span",{className:Qe.hBar}),G.createElement("span",{className:Qe.vBar})))});mQ.displayName="Stepper";function FN(){return FN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},FN.apply(this,arguments)}const QM=P.forwardRef((t,e)=>{const{labels:n,icons:r,children:a,...i}=t,o=P.useRef(null);P.useImperativeHandle(e,()=>({el:o.current}));const s={...i};return G.createElement(gN,FN({ref:o,tabbar:!0,tabbarIcons:r,tabbarLabels:n},s),a)});QM.displayName="Tabbar";const gQ=function(t,e){let{hasIcon:n,hasLabel:r,active:a}=t===void 0?{}:t;return e===void 0&&(e={}),{content:{common:"flex flex-col items-center justify-center h-full",ios:R("py-1",a?e.textActiveIos:e.textIos),material:R("py-2",n&&r&&"space-y-1",a?e.textActiveMaterial:e.textMaterial)},iconContainer:{common:"flex items-center justify-center k-tabbar-link-icon relative",ios:R("w-7 h-7"),material:R("w-16 h-8 rounded-full")},iconBg:{common:"absolute left-0 top-0 w-full h-full rounded-full duration-200 -z-10 pointer-events-none",ios:R(a?e.iconBgActiveIos:e.iconBgIos),material:R(a?e.iconBgActiveMaterial:e.iconBgMaterial,!a&&"scale-x-[0.5] opacity-0")},label:{ios:R(n?"text-xs font-medium":"",""),material:R(n?"text-xs":"text-sm","font-medium")}}},yQ=function(t,e){return t===void 0&&(t={}),{textIos:R("text-black text-opacity-40",e("dark:text-white dark:text-opacity-55")),textActiveIos:"text-primary",textMaterial:R("text-md-light-on-surface-variant",e("dark:text-md-dark-on-surface-variant")),textActiveMaterial:R("text-md-light-on-secondary-container",e("dark:text-md-dark-on-secondary-container")),iconBgIos:"",iconBgActiveIos:"",iconBgMaterial:"",iconBgActiveMaterial:R("bg-md-light-secondary-container",e("dark:bg-md-dark-secondary-container")),...t}};function BN(){return BN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},BN.apply(this,arguments)}const nf=P.forwardRef((t,e)=>{const{className:n,active:r,ios:a,material:i,colors:o,linkProps:s={},icon:l,label:u,children:c,...d}=t,p=P.useRef(null);P.useImperativeHandle(e,()=>({el:p.current}));const f={...s,...d},g=gt(),y=yQ(o,g),x=Je({ios:a,material:i}),b=!!l,v=u||c&&c.length,w=x(gQ({hasLabel:v,hasIcon:b,active:r},y));return G.createElement(iN,BN({ref:p,tabbar:!0,tabbarActive:r,className:n},f),G.createElement("span",{className:w.content},l&&G.createElement("span",{className:w.iconContainer},G.createElement("span",{className:w.iconBg}),l),(u||c&&c.length)&&G.createElement("span",{className:w.label},u,c)))});nf.displayName="TabbarLink";const bQ=()=>({base:{common:"w-full border-none p-0 m-0 border-collapse text-left table",ios:"",material:""}});function zN(){return zN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},zN.apply(this,arguments)}const vQ=P.forwardRef((t,e)=>{const{className:n,ios:r,material:a,children:i,...o}=t,s=P.useRef(null);P.useImperativeHandle(e,()=>({el:s.current}));const l=Je({ios:r,material:a})(bQ({...t})),u={...o};return G.createElement("table",zN({className:l.base,ref:s},u),i)});vQ.displayName="Table";const xQ=()=>({base:{common:"text-sm",ios:"",material:""}});function VN(){return VN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},VN.apply(this,arguments)}const wQ=P.forwardRef((t,e)=>{const{className:n,ios:r,material:a,children:i,...o}=t,s=P.useRef(null);P.useImperativeHandle(e,()=>({el:s.current}));const l=Je({ios:r,material:a})(xQ({...t})),u={...o};return G.createElement("tbody",VN({className:l.base,ref:s},u),i)});wQ.displayName="TableBody";const kQ=(t,e,n)=>{const{header:r}=t;return{base:{common:R("align-middle",n),ios:R(r?`text-xs font-semibold overflow-hidden whitespace-nowrap leading-4 h-11 bg-transparent ${e.textHeaderIos} py-0 px-4`:"h-11 relative py-0 px-4"),material:R(r?`${e.textHeaderMaterial} px-6 py-0  text-xs font-medium overflow-hidden text-ellipsis whitespace-nowrap leading-4 h-14 bg-transparent`:"py-0 first:px-6 px-7 h-12")}}},SQ=function(t,e){return t===void 0&&(t={}),{textHeaderIos:R("text-black/45",e("dark:text-white/55")),textHeaderMaterial:R("text-md-light-on-surface-variant",e("dark:text-md-dark-on-surface-variant")),...t}};function WN(){return WN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},WN.apply(this,arguments)}const CQ=P.forwardRef((t,e)=>{const{className:n,colors:r,header:a,ios:i,material:o,children:s,...l}=t,u=P.useRef(null);P.useImperativeHandle(e,()=>({el:u.current}));const c=a?"th":"td",d=Je({ios:i,material:o}),p=gt(),f=SQ(r,p),g=d(kQ({...t},f,n)),y={...l};return G.createElement(c,WN({className:g.base,ref:u},y),s)});CQ.displayName="TableCell";const NQ=()=>({base:{common:"align-middle relative",ios:"hairline-b",material:""}});function jN(){return jN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},jN.apply(this,arguments)}const TQ=P.forwardRef((t,e)=>{const{className:n,ios:r,material:a,children:i,...o}=t,s=P.useRef(null);P.useImperativeHandle(e,()=>({el:s.current}));const l=Je({ios:r,material:a})(NQ({...t})),u={...o};return G.createElement("thead",jN({className:l.base,ref:s},u),i)});TQ.displayName="TableHead";const IQ=(t,e)=>{const{header:n}=t;return{base:{common:"align-middle relative",ios:n?"":R(e.bgIos,"hairline-b last:hairline-transparent"),material:n?"":R(e.bgMaterial,`border-t ${e.dividerMaterial}`)}}},EQ=function(t,e){return t===void 0&&(t={}),{bgIos:R("hover:bg-black/5",e("dark:hover:bg-white/10")),bgMaterial:R("hover:bg-md-light-secondary-container",e("dark:hover:bg-md-dark-secondary-container")),dividerMaterial:R("border-md-light-outline",e("dark:border-md-dark-outline")),...t}};function UN(){return UN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},UN.apply(this,arguments)}const _Q=P.forwardRef((t,e)=>{const{className:n,colors:r,header:a,ios:i,material:o,children:s,...l}=t,u=P.useRef(null);P.useImperativeHandle(e,()=>({el:u.current}));const c=Je({ios:i,material:o}),d=gt(),p=EQ(r,d),f=c(IQ({...t},p)),g={...l};return G.createElement("tr",UN({className:f.base,ref:u},g),s)});_Q.displayName="TableRow";const OQ=(t,e,n)=>{const{translucent:r,opened:a}=t;return{base:{common:R(Dn("fixed",n),"z-50 transform transition-transform-opacity w-full sm:w-auto start-0 bottom-0 sm:max-w-lg",!a&&"translate-y-full opacity-0 pointer-events-none"),ios:R("sm:rounded-lg duration-300",e.textIos,e.bgIos,r&&"translucent"),material:R("sm:rounded-2xl duration-200",e.textMaterial,e.bgMaterial),left:"sm:start-4-safe sm:bottom-4-safe",right:"sm:end-4-safe sm:bottom-4-safe sm:start-auto",center:"sm:left-1/2 sm:bottom-4-safe sm:-translate-x-1/2"},content:{common:"flex items-center justify-between",ios:"pl-4-safe pr-4-safe pt-3 pb-3-safe sm:px-4 sm:py-3",material:"pl-6-safe pr-6-safe py-3.5 pb-3.5-safe sm:px-6 sm:py-3.5"},button:{common:"-my-2 shrink-0 ms-4",ios:"",material:"-me-2"}}},$Q=function(t,e){return t===void 0&&(t={}),{bgIos:"bg-black",bgMaterial:R("bg-md-light-surface-5",e("dark:bg-md-dark-surface-5")),textIos:"text-white",textMaterial:R("text-md-light-primary",e("dark:text-md-dark-primary")),...t}};function GN(){return GN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},GN.apply(this,arguments)}const RQ=P.forwardRef((t,e)=>{const{component:n="div",className:r,colors:a,translucent:i=!0,button:o,position:s="left",opened:l,ios:u,material:c,children:d,...p}=t,f=P.useRef(null);P.useImperativeHandle(e,()=>({el:f.current}));const g=n,y={...p},x=Je({ios:u,material:c}),b=gt(),v=$Q(a,b),w=x(OQ({...t,translucent:i},v,r),r);return G.createElement(g,GN({ref:f,className:w.base[s]},y),G.createElement("div",{className:w.content},d,o&&G.createElement("div",{className:w.button},o)))});RQ.displayName="Toast";const MQ=(t,e,n,r)=>({base:{common:R(Dn("relative",n),"cursor-pointer select-none inline-block align-middle relative duration-300 rounded-full group",r("dark:touch-ripple-white")),ios:"h-8 w-13 p-0.5",material:"w-13 h-8 border-2",notChecked:{ios:e.bgIos,material:R(e.bgMaterial,e.borderMaterial)},checked:{ios:`${e.checkedBgIos}`,material:R(e.checkedBgMaterial,e.checkedBorderMaterial)}},inner:{ios:R("w-full h-full bg-white rounded-full block duration-300 transform",r("dark:bg-opacity-0")),notChecked:{},checked:{ios:"scale-0"}},thumbWrap:{common:"rounded-full absolute duration-300 transform",ios:"w-7 h-7 start-0.5 top-0.5",material:"w-6 h-6 start-0.5 top-0.5",checked:{ios:R("translate-x-5 rtl:!-translate-x-5"),material:R("translate-x-5 rtl:!-translate-x-5")},notChecked:""},thumb:{common:"w-full h-full rounded-full absolute duration-300 transform start-0 top-0",ios:"shadow-ios-toggle",material:"group-active:scale-[1.1]",checked:{ios:R(e.checkedThumbBgIos),material:R(e.checkedThumbBgMaterial)},notChecked:{ios:e.thumbBgIos,material:R("scale-[0.666]",e.thumbBgMaterial)}},input:{common:"hidden"}}),AQ=function(t,e){return t===void 0&&(t={}),{bgIos:R("bg-black bg-opacity-10",e("dark:bg-white dark:bg-opacity-20")),checkedBgIos:"bg-primary",thumbBgIos:"bg-white",checkedThumbBgIos:"bg-white",bgMaterial:R("bg-md-light-surface-variant",e("dark:bg-md-dark-surface-variant")),checkedBgMaterial:R("bg-md-light-primary",e("dark:bg-md-dark-primary")),borderMaterial:R("border-md-light-outline",e("dark:border-md-dark-outline")),checkedBorderMaterial:R("border-md-light-primary",e("dark:border-md-dark-primary")),thumbBgMaterial:R("bg-md-light-outline",e("dark:bg-md-dark-outline")),checkedThumbBgMaterial:R("bg-md-light-on-primary",e("dark:bg-md-dark-on-primary")),...t}};function HN(){return HN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},HN.apply(this,arguments)}const PQ=P.forwardRef((t,e)=>{const{component:n="label",className:r,colors:a,defaultChecked:i,checked:o,name:s,value:l,disabled:u,readOnly:c,onChange:d,touchRipple:p=!0,ios:f,material:g,children:y,...x}=t,b=P.useRef(null),v=P.useRef(null);P.useImperativeHandle(e,()=>({el:b.current}));const w=n,S={...x},C=Jt({ios:f,material:g}),I=Je({ios:f,material:g}),_=gt();eo(v,C==="material"&&p,b);const E=AQ(a,_),A=o||i&&!d?"checked":"notChecked",M=I(MQ(t,E,r,_),r);return G.createElement(w,HN({ref:b,className:M.base[A]},S),G.createElement("input",{type:"checkbox",name:s,value:l,disabled:u,readOnly:c,checked:o,defaultChecked:i,onChange:d,className:M.input}),G.createElement("span",{className:M.inner[A]}),G.createElement("span",{ref:v,className:M.thumbWrap[A]},G.createElement("span",{className:M.thumb[A]})),y)});PQ.displayName="Toggle";var ZM={exports:{}},uy={},cy={},wt={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t._registerNode=t.Konva=t.glob=void 0;const e=Math.PI/180;function n(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}t.glob=typeof ya<"u"?ya:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},t.Konva={_global:t.glob,version:"9.3.3",isBrowser:n(),isUnminified:/param/.test(function(a){}.toString()),dblClickWindow:400,getAngle(a){return t.Konva.angleDeg?a*e:a},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return t.Konva.DD.isDragging},isDragReady(){return!!t.Konva.DD.node},releaseCanvasOnDestroy:!0,document:t.glob.document,_injectGlobal(a){t.glob.Konva=a}};const r=a=>{t.Konva[a.prototype.getClassName()]=a};t._registerNode=r,t.Konva._injectGlobal(t.Konva)})(wt);var Ln={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Util=t.Transform=void 0;const e=wt;class n{constructor(S=[1,0,0,1,0,0]){this.dirty=!1,this.m=S&&S.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new n(this.m)}copyInto(S){S.m[0]=this.m[0],S.m[1]=this.m[1],S.m[2]=this.m[2],S.m[3]=this.m[3],S.m[4]=this.m[4],S.m[5]=this.m[5]}point(S){var C=this.m;return{x:C[0]*S.x+C[2]*S.y+C[4],y:C[1]*S.x+C[3]*S.y+C[5]}}translate(S,C){return this.m[4]+=this.m[0]*S+this.m[2]*C,this.m[5]+=this.m[1]*S+this.m[3]*C,this}scale(S,C){return this.m[0]*=S,this.m[1]*=S,this.m[2]*=C,this.m[3]*=C,this}rotate(S){var C=Math.cos(S),I=Math.sin(S),_=this.m[0]*C+this.m[2]*I,E=this.m[1]*C+this.m[3]*I,A=this.m[0]*-I+this.m[2]*C,M=this.m[1]*-I+this.m[3]*C;return this.m[0]=_,this.m[1]=E,this.m[2]=A,this.m[3]=M,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(S,C){var I=this.m[0]+this.m[2]*C,_=this.m[1]+this.m[3]*C,E=this.m[2]+this.m[0]*S,A=this.m[3]+this.m[1]*S;return this.m[0]=I,this.m[1]=_,this.m[2]=E,this.m[3]=A,this}multiply(S){var C=this.m[0]*S.m[0]+this.m[2]*S.m[1],I=this.m[1]*S.m[0]+this.m[3]*S.m[1],_=this.m[0]*S.m[2]+this.m[2]*S.m[3],E=this.m[1]*S.m[2]+this.m[3]*S.m[3],A=this.m[0]*S.m[4]+this.m[2]*S.m[5]+this.m[4],M=this.m[1]*S.m[4]+this.m[3]*S.m[5]+this.m[5];return this.m[0]=C,this.m[1]=I,this.m[2]=_,this.m[3]=E,this.m[4]=A,this.m[5]=M,this}invert(){var S=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),C=this.m[3]*S,I=-this.m[1]*S,_=-this.m[2]*S,E=this.m[0]*S,A=S*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),M=S*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=C,this.m[1]=I,this.m[2]=_,this.m[3]=E,this.m[4]=A,this.m[5]=M,this}getMatrix(){return this.m}decompose(){var S=this.m[0],C=this.m[1],I=this.m[2],_=this.m[3],E=this.m[4],A=this.m[5],M=S*_-C*I;let L={x:E,y:A,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(S!=0||C!=0){var W=Math.sqrt(S*S+C*C);L.rotation=C>0?Math.acos(S/W):-Math.acos(S/W),L.scaleX=W,L.scaleY=M/W,L.skewX=(S*I+C*_)/M,L.skewY=0}else if(I!=0||_!=0){var B=Math.sqrt(I*I+_*_);L.rotation=Math.PI/2-(_>0?Math.acos(-I/B):-Math.acos(I/B)),L.scaleX=M/B,L.scaleY=B,L.skewX=0,L.skewY=(S*I+C*_)/M}return L.rotation=t.Util._getRotation(L.rotation),L}}t.Transform=n;var r="[object Array]",a="[object Number]",i="[object String]",o="[object Boolean]",s=Math.PI/180,l=180/Math.PI,u="#",c="",d="0",p="Konva warning: ",f="Konva error: ",g="rgb(",y={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},x=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/,b=[];const v=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(w){setTimeout(w,60)};t.Util={_isElement(w){return!!(w&&w.nodeType==1)},_isFunction(w){return!!(w&&w.constructor&&w.call&&w.apply)},_isPlainObject(w){return!!w&&w.constructor===Object},_isArray(w){return Object.prototype.toString.call(w)===r},_isNumber(w){return Object.prototype.toString.call(w)===a&&!isNaN(w)&&isFinite(w)},_isString(w){return Object.prototype.toString.call(w)===i},_isBoolean(w){return Object.prototype.toString.call(w)===o},isObject(w){return w instanceof Object},isValidSelector(w){if(typeof w!="string")return!1;var S=w[0];return S==="#"||S==="."||S===S.toUpperCase()},_sign(w){return w===0||w>0?1:-1},requestAnimFrame(w){b.push(w),b.length===1&&v(function(){const S=b;b=[],S.forEach(function(C){C()})})},createCanvasElement(){var w=document.createElement("canvas");try{w.style=w.style||{}}catch{}return w},createImageElement(){return document.createElement("img")},_isInDocument(w){for(;w=w.parentNode;)if(w==document)return!0;return!1},_urlToImage(w,S){var C=t.Util.createImageElement();C.onload=function(){S(C)},C.src=w},_rgbToHex(w,S,C){return((1<<24)+(w<<16)+(S<<8)+C).toString(16).slice(1)},_hexToRgb(w){w=w.replace(u,c);var S=parseInt(w,16);return{r:S>>16&255,g:S>>8&255,b:S&255}},getRandomColor(){for(var w=(Math.random()*16777215<<0).toString(16);w.length<6;)w=d+w;return u+w},getRGB(w){var S;return w in y?(S=y[w],{r:S[0],g:S[1],b:S[2]}):w[0]===u?this._hexToRgb(w.substring(1)):w.substr(0,4)===g?(S=x.exec(w.replace(/ /g,"")),{r:parseInt(S[1],10),g:parseInt(S[2],10),b:parseInt(S[3],10)}):{r:0,g:0,b:0}},colorToRGBA(w){return w=w||"black",t.Util._namedColorToRBA(w)||t.Util._hex3ColorToRGBA(w)||t.Util._hex4ColorToRGBA(w)||t.Util._hex6ColorToRGBA(w)||t.Util._hex8ColorToRGBA(w)||t.Util._rgbColorToRGBA(w)||t.Util._rgbaColorToRGBA(w)||t.Util._hslColorToRGBA(w)},_namedColorToRBA(w){var S=y[w.toLowerCase()];return S?{r:S[0],g:S[1],b:S[2],a:1}:null},_rgbColorToRGBA(w){if(w.indexOf("rgb(")===0){w=w.match(/rgb\(([^)]+)\)/)[1];var S=w.split(/ *, */).map(Number);return{r:S[0],g:S[1],b:S[2],a:1}}},_rgbaColorToRGBA(w){if(w.indexOf("rgba(")===0){w=w.match(/rgba\(([^)]+)\)/)[1];var S=w.split(/ *, */).map((C,I)=>C.slice(-1)==="%"?I===3?parseInt(C)/100:parseInt(C)/100*255:Number(C));return{r:S[0],g:S[1],b:S[2],a:S[3]}}},_hex8ColorToRGBA(w){if(w[0]==="#"&&w.length===9)return{r:parseInt(w.slice(1,3),16),g:parseInt(w.slice(3,5),16),b:parseInt(w.slice(5,7),16),a:parseInt(w.slice(7,9),16)/255}},_hex6ColorToRGBA(w){if(w[0]==="#"&&w.length===7)return{r:parseInt(w.slice(1,3),16),g:parseInt(w.slice(3,5),16),b:parseInt(w.slice(5,7),16),a:1}},_hex4ColorToRGBA(w){if(w[0]==="#"&&w.length===5)return{r:parseInt(w[1]+w[1],16),g:parseInt(w[2]+w[2],16),b:parseInt(w[3]+w[3],16),a:parseInt(w[4]+w[4],16)/255}},_hex3ColorToRGBA(w){if(w[0]==="#"&&w.length===4)return{r:parseInt(w[1]+w[1],16),g:parseInt(w[2]+w[2],16),b:parseInt(w[3]+w[3],16),a:1}},_hslColorToRGBA(w){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(w)){const[S,...C]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(w),I=Number(C[0])/360,_=Number(C[1])/100,E=Number(C[2])/100;let A,M,L;if(_===0)return L=E*255,{r:Math.round(L),g:Math.round(L),b:Math.round(L),a:1};E<.5?A=E*(1+_):A=E+_-E*_;const W=2*E-A,B=[0,0,0];for(let K=0;K<3;K++)M=I+1/3*-(K-1),M<0&&M++,M>1&&M--,6*M<1?L=W+(A-W)*6*M:2*M<1?L=A:3*M<2?L=W+(A-W)*(2/3-M)*6:L=W,B[K]=L*255;return{r:Math.round(B[0]),g:Math.round(B[1]),b:Math.round(B[2]),a:1}}},haveIntersection(w,S){return!(S.x>w.x+w.width||S.x+S.width<w.x||S.y>w.y+w.height||S.y+S.height<w.y)},cloneObject(w){var S={};for(var C in w)this._isPlainObject(w[C])?S[C]=this.cloneObject(w[C]):this._isArray(w[C])?S[C]=this.cloneArray(w[C]):S[C]=w[C];return S},cloneArray(w){return w.slice(0)},degToRad(w){return w*s},radToDeg(w){return w*l},_degToRad(w){return t.Util.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),t.Util.degToRad(w)},_radToDeg(w){return t.Util.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),t.Util.radToDeg(w)},_getRotation(w){return e.Konva.angleDeg?t.Util.radToDeg(w):w},_capitalize(w){return w.charAt(0).toUpperCase()+w.slice(1)},throw(w){throw new Error(f+w)},error(w){console.error(f+w)},warn(w){e.Konva.showWarnings&&console.warn(p+w)},each(w,S){for(var C in w)S(C,w[C])},_inRange(w,S,C){return S<=w&&w<C},_getProjectionToSegment(w,S,C,I,_,E){var A,M,L,W=(w-C)*(w-C)+(S-I)*(S-I);if(W==0)A=w,M=S,L=(_-C)*(_-C)+(E-I)*(E-I);else{var B=((_-w)*(C-w)+(E-S)*(I-S))/W;B<0?(A=w,M=S,L=(w-_)*(w-_)+(S-E)*(S-E)):B>1?(A=C,M=I,L=(C-_)*(C-_)+(I-E)*(I-E)):(A=w+B*(C-w),M=S+B*(I-S),L=(A-_)*(A-_)+(M-E)*(M-E))}return[A,M,L]},_getProjectionToLine(w,S,C){var I=t.Util.cloneObject(w),_=Number.MAX_VALUE;return S.forEach(function(E,A){if(!(!C&&A===S.length-1)){var M=S[(A+1)%S.length],L=t.Util._getProjectionToSegment(E.x,E.y,M.x,M.y,w.x,w.y),W=L[0],B=L[1],K=L[2];K<_&&(I.x=W,I.y=B,_=K)}}),I},_prepareArrayForTween(w,S,C){var I,_=[],E=[];if(w.length>S.length){var A=S;S=w,w=A}for(I=0;I<w.length;I+=2)_.push({x:w[I],y:w[I+1]});for(I=0;I<S.length;I+=2)E.push({x:S[I],y:S[I+1]});var M=[];return E.forEach(function(L){var W=t.Util._getProjectionToLine(L,_,C);M.push(W.x),M.push(W.y)}),M},_prepareToStringify(w){var S;w.visitedByCircularReferenceRemoval=!0;for(var C in w)if(w.hasOwnProperty(C)&&w[C]&&typeof w[C]=="object"){if(S=Object.getOwnPropertyDescriptor(w,C),w[C].visitedByCircularReferenceRemoval||t.Util._isElement(w[C]))if(S.configurable)delete w[C];else return null;else if(t.Util._prepareToStringify(w[C])===null)if(S.configurable)delete w[C];else return null}return delete w.visitedByCircularReferenceRemoval,w},_assign(w,S){for(var C in S)w[C]=S[C];return w},_getFirstPointerId(w){return w.touches?w.changedTouches[0].identifier:w.pointerId||999},releaseCanvas(...w){e.Konva.releaseCanvasOnDestroy&&w.forEach(S=>{S.width=0,S.height=0})},drawRoundedRectPath(w,S,C,I){let _=0,E=0,A=0,M=0;typeof I=="number"?_=E=A=M=Math.min(I,S/2,C/2):(_=Math.min(I[0]||0,S/2,C/2),E=Math.min(I[1]||0,S/2,C/2),M=Math.min(I[2]||0,S/2,C/2),A=Math.min(I[3]||0,S/2,C/2)),w.moveTo(_,0),w.lineTo(S-E,0),w.arc(S-E,E,E,Math.PI*3/2,0,!1),w.lineTo(S,C-M),w.arc(S-M,C-M,M,0,Math.PI/2,!1),w.lineTo(A,C),w.arc(A,C-A,A,Math.PI/2,Math.PI,!1),w.lineTo(0,_),w.arc(_,_,_,Math.PI,Math.PI*3/2,!1)}}})(Ln);var Tn={},kt={},Ge={};Object.defineProperty(Ge,"__esModule",{value:!0}),Ge.getComponentValidator=Ge.getBooleanValidator=Ge.getNumberArrayValidator=Ge.getFunctionValidator=Ge.getStringOrGradientValidator=Ge.getStringValidator=Ge.getNumberOrAutoValidator=Ge.getNumberOrArrayOfNumbersValidator=Ge.getNumberValidator=Ge.alphaComponent=Ge.RGBComponent=void 0;const ps=wt,Vn=Ln;function hs(t){return Vn.Util._isString(t)?'"'+t+'"':Object.prototype.toString.call(t)==="[object Number]"||Vn.Util._isBoolean(t)?t:Object.prototype.toString.call(t)}function DQ(t){return t>255?255:t<0?0:Math.round(t)}Ge.RGBComponent=DQ;function LQ(t){return t>1?1:t<1e-4?1e-4:t}Ge.alphaComponent=LQ;function FQ(){if(ps.Konva.isUnminified)return function(t,e){return Vn.Util._isNumber(t)||Vn.Util.warn(hs(t)+' is a not valid value for "'+e+'" attribute. The value should be a number.'),t}}Ge.getNumberValidator=FQ;function BQ(t){if(ps.Konva.isUnminified)return function(e,n){let r=Vn.Util._isNumber(e),a=Vn.Util._isArray(e)&&e.length==t;return!r&&!a&&Vn.Util.warn(hs(e)+' is a not valid value for "'+n+'" attribute. The value should be a number or Array<number>('+t+")"),e}}Ge.getNumberOrArrayOfNumbersValidator=BQ;function zQ(){if(ps.Konva.isUnminified)return function(t,e){var n=Vn.Util._isNumber(t),r=t==="auto";return n||r||Vn.Util.warn(hs(t)+' is a not valid value for "'+e+'" attribute. The value should be a number or "auto".'),t}}Ge.getNumberOrAutoValidator=zQ;function VQ(){if(ps.Konva.isUnminified)return function(t,e){return Vn.Util._isString(t)||Vn.Util.warn(hs(t)+' is a not valid value for "'+e+'" attribute. The value should be a string.'),t}}Ge.getStringValidator=VQ;function WQ(){if(ps.Konva.isUnminified)return function(t,e){const n=Vn.Util._isString(t),r=Object.prototype.toString.call(t)==="[object CanvasGradient]"||t&&t.addColorStop;return n||r||Vn.Util.warn(hs(t)+' is a not valid value for "'+e+'" attribute. The value should be a string or a native gradient.'),t}}Ge.getStringOrGradientValidator=WQ;function jQ(){if(ps.Konva.isUnminified)return function(t,e){return Vn.Util._isFunction(t)||Vn.Util.warn(hs(t)+' is a not valid value for "'+e+'" attribute. The value should be a function.'),t}}Ge.getFunctionValidator=jQ;function UQ(){if(ps.Konva.isUnminified)return function(t,e){const n=Int8Array?Object.getPrototypeOf(Int8Array):null;return n&&t instanceof n||(Vn.Util._isArray(t)?t.forEach(function(r){Vn.Util._isNumber(r)||Vn.Util.warn('"'+e+'" attribute has non numeric element '+r+". Make sure that all elements are numbers.")}):Vn.Util.warn(hs(t)+' is a not valid value for "'+e+'" attribute. The value should be a array of numbers.')),t}}Ge.getNumberArrayValidator=UQ;function GQ(){if(ps.Konva.isUnminified)return function(t,e){var n=t===!0||t===!1;return n||Vn.Util.warn(hs(t)+' is a not valid value for "'+e+'" attribute. The value should be a boolean.'),t}}Ge.getBooleanValidator=GQ;function HQ(t){if(ps.Konva.isUnminified)return function(e,n){return e==null||Vn.Util.isObject(e)||Vn.Util.warn(hs(e)+' is a not valid value for "'+n+'" attribute. The value should be an object with properties '+t),e}}Ge.getComponentValidator=HQ,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Factory=void 0;const e=Ln,n=Ge;var r="get",a="set";t.Factory={addGetterSetter(i,o,s,l,u){t.Factory.addGetter(i,o,s),t.Factory.addSetter(i,o,l,u),t.Factory.addOverloadedGetterSetter(i,o)},addGetter(i,o,s){var l=r+e.Util._capitalize(o);i.prototype[l]=i.prototype[l]||function(){var u=this.attrs[o];return u===void 0?s:u}},addSetter(i,o,s,l){var u=a+e.Util._capitalize(o);i.prototype[u]||t.Factory.overWriteSetter(i,o,s,l)},overWriteSetter(i,o,s,l){var u=a+e.Util._capitalize(o);i.prototype[u]=function(c){return s&&c!==void 0&&c!==null&&(c=s.call(this,c,o)),this._setAttr(o,c),l&&l.call(this),this}},addComponentsGetterSetter(i,o,s,l,u){var c=s.length,d=e.Util._capitalize,p=r+d(o),f=a+d(o),g,y;i.prototype[p]=function(){var b={};for(g=0;g<c;g++)y=s[g],b[y]=this.getAttr(o+d(y));return b};var x=(0,n.getComponentValidator)(s);i.prototype[f]=function(b){var v=this.attrs[o],w;l&&(b=l.call(this,b)),x&&x.call(this,b,o);for(w in b)b.hasOwnProperty(w)&&this._setAttr(o+d(w),b[w]);return b||s.forEach(S=>{this._setAttr(o+d(S),void 0)}),this._fireChangeEvent(o,v,b),u&&u.call(this),this},t.Factory.addOverloadedGetterSetter(i,o)},addOverloadedGetterSetter(i,o){var s=e.Util._capitalize(o),l=a+s,u=r+s;i.prototype[o]=function(){return arguments.length?(this[l](arguments[0]),this):this[u]()}},addDeprecatedGetterSetter(i,o,s,l){e.Util.error("Adding deprecated "+o);var u=r+e.Util._capitalize(o),c=o+" property is deprecated and will be removed soon. Look at Konva change log for more information.";i.prototype[u]=function(){e.Util.error(c);var d=this.attrs[o];return d===void 0?s:d},t.Factory.addSetter(i,o,l,function(){e.Util.error(c)}),t.Factory.addOverloadedGetterSetter(i,o)},backCompat(i,o){e.Util.each(o,function(s,l){var u=i.prototype[l],c=r+e.Util._capitalize(s),d=a+e.Util._capitalize(s);function p(){u.apply(this,arguments),e.Util.error('"'+s+'" method is deprecated and will be removed soon. Use ""'+l+'" instead.')}i.prototype[s]=p,i.prototype[c]=p,i.prototype[d]=p})},afterSetFilter(){this._filterUpToDate=!1}}}(kt);var to={},fs={};Object.defineProperty(fs,"__esModule",{value:!0}),fs.HitContext=fs.SceneContext=fs.Context=void 0;const JM=Ln,qQ=wt;function KQ(t){var e=[],n=t.length,r=JM.Util,a,i;for(a=0;a<n;a++)i=t[a],r._isNumber(i)?i=Math.round(i*1e3)/1e3:r._isString(i)||(i=i+""),e.push(i);return e}var e6=",",XQ="(",YQ=")",QQ="([",ZQ="])",JQ=";",eZ="()",tZ="=",t6=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],nZ=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"];const rZ=100;class dy{constructor(e){this.canvas=e,qQ.Konva.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(e){e.fillEnabled()&&this._fill(e)}_fill(e){}strokeShape(e){e.hasStroke()&&this._stroke(e)}_stroke(e){}fillStrokeShape(e){e.attrs.fillAfterStrokeEnabled?(this.strokeShape(e),this.fillShape(e)):(this.fillShape(e),this.strokeShape(e))}getTrace(e,n){var r=this.traceArr,a=r.length,i="",o,s,l,u;for(o=0;o<a;o++)s=r[o],l=s.method,l?(u=s.args,i+=l,e?i+=eZ:JM.Util._isArray(u[0])?i+=QQ+u.join(e6)+ZQ:(n&&(u=u.map(c=>typeof c=="number"?Math.floor(c):c)),i+=XQ+u.join(e6)+YQ)):(i+=s.property,e||(i+=tZ+s.val)),i+=JQ;return i}clearTrace(){this.traceArr=[]}_trace(e){var n=this.traceArr,r;n.push(e),r=n.length,r>=rZ&&n.shift()}reset(){var e=this.getCanvas().getPixelRatio();this.setTransform(1*e,0,0,1*e,0,0)}getCanvas(){return this.canvas}clear(e){var n=this.getCanvas();e?this.clearRect(e.x||0,e.y||0,e.width||0,e.height||0):this.clearRect(0,0,n.getWidth()/n.pixelRatio,n.getHeight()/n.pixelRatio)}_applyLineCap(e){const n=e.attrs.lineCap;n&&this.setAttr("lineCap",n)}_applyOpacity(e){var n=e.getAbsoluteOpacity();n!==1&&this.setAttr("globalAlpha",n)}_applyLineJoin(e){const n=e.attrs.lineJoin;n&&this.setAttr("lineJoin",n)}setAttr(e,n){this._context[e]=n}arc(e,n,r,a,i,o){this._context.arc(e,n,r,a,i,o)}arcTo(e,n,r,a,i){this._context.arcTo(e,n,r,a,i)}beginPath(){this._context.beginPath()}bezierCurveTo(e,n,r,a,i,o){this._context.bezierCurveTo(e,n,r,a,i,o)}clearRect(e,n,r,a){this._context.clearRect(e,n,r,a)}clip(...e){this._context.clip.apply(this._context,e)}closePath(){this._context.closePath()}createImageData(e,n){var r=arguments;if(r.length===2)return this._context.createImageData(e,n);if(r.length===1)return this._context.createImageData(e)}createLinearGradient(e,n,r,a){return this._context.createLinearGradient(e,n,r,a)}createPattern(e,n){return this._context.createPattern(e,n)}createRadialGradient(e,n,r,a,i,o){return this._context.createRadialGradient(e,n,r,a,i,o)}drawImage(e,n,r,a,i,o,s,l,u){var c=arguments,d=this._context;c.length===3?d.drawImage(e,n,r):c.length===5?d.drawImage(e,n,r,a,i):c.length===9&&d.drawImage(e,n,r,a,i,o,s,l,u)}ellipse(e,n,r,a,i,o,s,l){this._context.ellipse(e,n,r,a,i,o,s,l)}isPointInPath(e,n,r,a){return r?this._context.isPointInPath(r,e,n,a):this._context.isPointInPath(e,n,a)}fill(...e){this._context.fill.apply(this._context,e)}fillRect(e,n,r,a){this._context.fillRect(e,n,r,a)}strokeRect(e,n,r,a){this._context.strokeRect(e,n,r,a)}fillText(e,n,r,a){a?this._context.fillText(e,n,r,a):this._context.fillText(e,n,r)}measureText(e){return this._context.measureText(e)}getImageData(e,n,r,a){return this._context.getImageData(e,n,r,a)}lineTo(e,n){this._context.lineTo(e,n)}moveTo(e,n){this._context.moveTo(e,n)}rect(e,n,r,a){this._context.rect(e,n,r,a)}roundRect(e,n,r,a,i){this._context.roundRect(e,n,r,a,i)}putImageData(e,n,r){this._context.putImageData(e,n,r)}quadraticCurveTo(e,n,r,a){this._context.quadraticCurveTo(e,n,r,a)}restore(){this._context.restore()}rotate(e){this._context.rotate(e)}save(){this._context.save()}scale(e,n){this._context.scale(e,n)}setLineDash(e){this._context.setLineDash?this._context.setLineDash(e):"mozDash"in this._context?this._context.mozDash=e:"webkitLineDash"in this._context&&(this._context.webkitLineDash=e)}getLineDash(){return this._context.getLineDash()}setTransform(e,n,r,a,i,o){this._context.setTransform(e,n,r,a,i,o)}stroke(e){e?this._context.stroke(e):this._context.stroke()}strokeText(e,n,r,a){this._context.strokeText(e,n,r,a)}transform(e,n,r,a,i,o){this._context.transform(e,n,r,a,i,o)}translate(e,n){this._context.translate(e,n)}_enableTrace(){var e=this,n=t6.length,r=this.setAttr,a,i,o=function(s){var l=e[s],u;e[s]=function(){return i=KQ(Array.prototype.slice.call(arguments,0)),u=l.apply(e,arguments),e._trace({method:s,args:i}),u}};for(a=0;a<n;a++)o(t6[a]);e.setAttr=function(){r.apply(e,arguments);var s=arguments[0],l=arguments[1];(s==="shadowOffsetX"||s==="shadowOffsetY"||s==="shadowBlur")&&(l=l/this.canvas.getPixelRatio()),e._trace({property:s,val:l})}}_applyGlobalCompositeOperation(e){const n=e.attrs.globalCompositeOperation;var r=!n||n==="source-over";r||this.setAttr("globalCompositeOperation",n)}}fs.Context=dy,nZ.forEach(function(t){Object.defineProperty(dy.prototype,t,{get(){return this._context[t]},set(e){this._context[t]=e}})});class aZ extends dy{constructor(e,{willReadFrequently:n=!1}={}){super(e),this._context=e._canvas.getContext("2d",{willReadFrequently:n})}_fillColor(e){var n=e.fill();this.setAttr("fillStyle",n),e._fillFunc(this)}_fillPattern(e){this.setAttr("fillStyle",e._getFillPattern()),e._fillFunc(this)}_fillLinearGradient(e){var n=e._getLinearGradient();n&&(this.setAttr("fillStyle",n),e._fillFunc(this))}_fillRadialGradient(e){const n=e._getRadialGradient();n&&(this.setAttr("fillStyle",n),e._fillFunc(this))}_fill(e){const n=e.fill(),r=e.getFillPriority();if(n&&r==="color"){this._fillColor(e);return}const a=e.getFillPatternImage();if(a&&r==="pattern"){this._fillPattern(e);return}const i=e.getFillLinearGradientColorStops();if(i&&r==="linear-gradient"){this._fillLinearGradient(e);return}const o=e.getFillRadialGradientColorStops();if(o&&r==="radial-gradient"){this._fillRadialGradient(e);return}n?this._fillColor(e):a?this._fillPattern(e):i?this._fillLinearGradient(e):o&&this._fillRadialGradient(e)}_strokeLinearGradient(e){const n=e.getStrokeLinearGradientStartPoint(),r=e.getStrokeLinearGradientEndPoint(),a=e.getStrokeLinearGradientColorStops(),i=this.createLinearGradient(n.x,n.y,r.x,r.y);if(a){for(var o=0;o<a.length;o+=2)i.addColorStop(a[o],a[o+1]);this.setAttr("strokeStyle",i)}}_stroke(e){var n=e.dash(),r=e.getStrokeScaleEnabled();if(e.hasStroke()){if(!r){this.save();var a=this.getCanvas().getPixelRatio();this.setTransform(a,0,0,a,0,0)}this._applyLineCap(e),n&&e.dashEnabled()&&(this.setLineDash(n),this.setAttr("lineDashOffset",e.dashOffset())),this.setAttr("lineWidth",e.strokeWidth()),e.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)");var i=e.getStrokeLinearGradientColorStops();i?this._strokeLinearGradient(e):this.setAttr("strokeStyle",e.stroke()),e._strokeFunc(this),r||this.restore()}}_applyShadow(e){var n,r,a,i=(n=e.getShadowRGBA())!==null&&n!==void 0?n:"black",o=(r=e.getShadowBlur())!==null&&r!==void 0?r:5,s=(a=e.getShadowOffset())!==null&&a!==void 0?a:{x:0,y:0},l=e.getAbsoluteScale(),u=this.canvas.getPixelRatio(),c=l.x*u,d=l.y*u;this.setAttr("shadowColor",i),this.setAttr("shadowBlur",o*Math.min(Math.abs(c),Math.abs(d))),this.setAttr("shadowOffsetX",s.x*c),this.setAttr("shadowOffsetY",s.y*d)}}fs.SceneContext=aZ;class iZ extends dy{constructor(e){super(e),this._context=e._canvas.getContext("2d",{willReadFrequently:!0})}_fill(e){this.save(),this.setAttr("fillStyle",e.colorKey),e._fillFuncHit(this),this.restore()}strokeShape(e){e.hasHitStroke()&&this._stroke(e)}_stroke(e){if(e.hasHitStroke()){const i=e.getStrokeScaleEnabled();if(!i){this.save();var n=this.getCanvas().getPixelRatio();this.setTransform(n,0,0,n,0,0)}this._applyLineCap(e);var r=e.hitStrokeWidth(),a=r==="auto"?e.strokeWidth():r;this.setAttr("lineWidth",a),this.setAttr("strokeStyle",e.colorKey),e._strokeFuncHit(this),i||this.restore()}}}fs.HitContext=iZ,Object.defineProperty(to,"__esModule",{value:!0}),to.HitCanvas=to.SceneCanvas=to.Canvas=void 0;const py=Ln,n6=fs,r6=wt,oZ=kt,sZ=Ge;var hy;function lZ(){if(hy)return hy;var t=py.Util.createCanvasElement(),e=t.getContext("2d");return hy=function(){var n=r6.Konva._global.devicePixelRatio||1,r=e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1;return n/r}(),py.Util.releaseCanvas(t),hy}let fy=class{constructor(t){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;var e=t||{},n=e.pixelRatio||r6.Konva.pixelRatio||lZ();this.pixelRatio=n,this._canvas=py.Util.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(t){var e=this.pixelRatio;this.pixelRatio=t,this.setSize(this.getWidth()/e,this.getHeight()/e)}setWidth(t){this.width=this._canvas.width=t*this.pixelRatio,this._canvas.style.width=t+"px";var e=this.pixelRatio,n=this.getContext()._context;n.scale(e,e)}setHeight(t){this.height=this._canvas.height=t*this.pixelRatio,this._canvas.style.height=t+"px";var e=this.pixelRatio,n=this.getContext()._context;n.scale(e,e)}getWidth(){return this.width}getHeight(){return this.height}setSize(t,e){this.setWidth(t||0),this.setHeight(e||0)}toDataURL(t,e){try{return this._canvas.toDataURL(t,e)}catch{try{return this._canvas.toDataURL()}catch(n){return py.Util.error("Unable to get data URL. "+n.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}};to.Canvas=fy,oZ.Factory.addGetterSetter(fy,"pixelRatio",void 0,(0,sZ.getNumberValidator)());class uZ extends fy{constructor(e={width:0,height:0,willReadFrequently:!1}){super(e),this.context=new n6.SceneContext(this,{willReadFrequently:e.willReadFrequently}),this.setSize(e.width,e.height)}}to.SceneCanvas=uZ;class cZ extends fy{constructor(e={width:0,height:0}){super(e),this.hitCanvas=!0,this.context=new n6.HitContext(this),this.setSize(e.width,e.height)}}to.HitCanvas=cZ;var my={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.DD=void 0;const e=wt,n=Ln;t.DD={get isDragging(){var r=!1;return t.DD._dragElements.forEach(a=>{a.dragStatus==="dragging"&&(r=!0)}),r},justDragged:!1,get node(){var r;return t.DD._dragElements.forEach(a=>{r=a.node}),r},_dragElements:new Map,_drag(r){const a=[];t.DD._dragElements.forEach((i,o)=>{const{node:s}=i,l=s.getStage();l.setPointersPositions(r),i.pointerId===void 0&&(i.pointerId=n.Util._getFirstPointerId(r));const u=l._changedPointerPositions.find(p=>p.id===i.pointerId);if(u){if(i.dragStatus!=="dragging"){var c=s.dragDistance(),d=Math.max(Math.abs(u.x-i.startPointerPos.x),Math.abs(u.y-i.startPointerPos.y));if(d<c||(s.startDrag({evt:r}),!s.isDragging()))return}s._setDragPosition(r,i),a.push(s)}}),a.forEach(i=>{i.fire("dragmove",{type:"dragmove",target:i,evt:r},!0)})},_endDragBefore(r){const a=[];t.DD._dragElements.forEach(i=>{const{node:o}=i,s=o.getStage();if(r&&s.setPointersPositions(r),!s._changedPointerPositions.find(u=>u.id===i.pointerId))return;(i.dragStatus==="dragging"||i.dragStatus==="stopped")&&(t.DD.justDragged=!0,e.Konva._mouseListenClick=!1,e.Konva._touchListenClick=!1,e.Konva._pointerListenClick=!1,i.dragStatus="stopped");const l=i.node.getLayer()||i.node instanceof e.Konva.Stage&&i.node;l&&a.indexOf(l)===-1&&a.push(l)}),a.forEach(i=>{i.draw()})},_endDragAfter(r){t.DD._dragElements.forEach((a,i)=>{a.dragStatus==="stopped"&&a.node.fire("dragend",{type:"dragend",target:a.node,evt:r},!0),a.dragStatus!=="dragging"&&t.DD._dragElements.delete(i)})}},e.Konva.isBrowser&&(window.addEventListener("mouseup",t.DD._endDragBefore,!0),window.addEventListener("touchend",t.DD._endDragBefore,!0),window.addEventListener("mousemove",t.DD._drag),window.addEventListener("touchmove",t.DD._drag),window.addEventListener("mouseup",t.DD._endDragAfter,!1),window.addEventListener("touchend",t.DD._endDragAfter,!1))})(my),Object.defineProperty(Tn,"__esModule",{value:!0}),Tn.Node=void 0;const _t=Ln,rf=kt,af=to,Eu=wt,Si=my,Kn=Ge;var gy="absoluteOpacity",yy="allEventListeners",ms="absoluteTransform",a6="absoluteScale",_u="canvas",dZ="Change",pZ="children",hZ="konva",qN="listening",i6="mouseenter",o6="mouseleave",s6="set",l6="Shape",by=" ",u6="stage",wl="transform",fZ="Stage",KN="visible",mZ=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(by);let gZ=1;class lt{constructor(e){this._id=gZ++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(e),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(e){(e===wl||e===ms)&&this._cache.get(e)?this._cache.get(e).dirty=!0:e?this._cache.delete(e):this._cache.clear()}_getCache(e,n){var r=this._cache.get(e),a=e===wl||e===ms,i=r===void 0||a&&r.dirty===!0;return i&&(r=n.call(this),this._cache.set(e,r)),r}_calculate(e,n,r){if(!this._attachedDepsListeners.get(e)){const a=n.map(i=>i+"Change.konva").join(by);this.on(a,()=>{this._clearCache(e)}),this._attachedDepsListeners.set(e,!0)}return this._getCache(e,r)}_getCanvasCache(){return this._cache.get(_u)}_clearSelfAndDescendantCache(e){this._clearCache(e),e===ms&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(_u)){const{scene:e,filter:n,hit:r}=this._cache.get(_u);_t.Util.releaseCanvas(e,n,r),this._cache.delete(_u)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(e){var n=e||{},r={};(n.x===void 0||n.y===void 0||n.width===void 0||n.height===void 0)&&(r=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));var a=Math.ceil(n.width||r.width),i=Math.ceil(n.height||r.height),o=n.pixelRatio,s=n.x===void 0?Math.floor(r.x):n.x,l=n.y===void 0?Math.floor(r.y):n.y,u=n.offset||0,c=n.drawBorder||!1,d=n.hitCanvasPixelRatio||1;if(!a||!i){_t.Util.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}const p=Math.abs(Math.round(r.x)-s)>.5?1:0,f=Math.abs(Math.round(r.y)-l)>.5?1:0;a+=u*2+p,i+=u*2+f,s-=u,l-=u;var g=new af.SceneCanvas({pixelRatio:o,width:a,height:i}),y=new af.SceneCanvas({pixelRatio:o,width:0,height:0,willReadFrequently:!0}),x=new af.HitCanvas({pixelRatio:d,width:a,height:i}),b=g.getContext(),v=x.getContext();return x.isCache=!0,g.isCache=!0,this._cache.delete(_u),this._filterUpToDate=!1,n.imageSmoothingEnabled===!1&&(g.getContext()._context.imageSmoothingEnabled=!1,y.getContext()._context.imageSmoothingEnabled=!1),b.save(),v.save(),b.translate(-s,-l),v.translate(-s,-l),this._isUnderCache=!0,this._clearSelfAndDescendantCache(gy),this._clearSelfAndDescendantCache(a6),this.drawScene(g,this),this.drawHit(x,this),this._isUnderCache=!1,b.restore(),v.restore(),c&&(b.save(),b.beginPath(),b.rect(0,0,a,i),b.closePath(),b.setAttr("strokeStyle","red"),b.setAttr("lineWidth",5),b.stroke(),b.restore()),this._cache.set(_u,{scene:g,filter:y,hit:x,x:s,y:l}),this._requestDraw(),this}isCached(){return this._cache.has(_u)}getClientRect(e){throw new Error('abstract "getClientRect" method call')}_transformedRect(e,n){var r=[{x:e.x,y:e.y},{x:e.x+e.width,y:e.y},{x:e.x+e.width,y:e.y+e.height},{x:e.x,y:e.y+e.height}],a=1/0,i=1/0,o=-1/0,s=-1/0,l=this.getAbsoluteTransform(n);return r.forEach(function(u){var c=l.point(u);a===void 0&&(a=o=c.x,i=s=c.y),a=Math.min(a,c.x),i=Math.min(i,c.y),o=Math.max(o,c.x),s=Math.max(s,c.y)}),{x:a,y:i,width:o-a,height:s-i}}_drawCachedSceneCanvas(e){e.save(),e._applyOpacity(this),e._applyGlobalCompositeOperation(this);const n=this._getCanvasCache();e.translate(n.x,n.y);var r=this._getCachedSceneCanvas(),a=r.pixelRatio;e.drawImage(r._canvas,0,0,r.width/a,r.height/a),e.restore()}_drawCachedHitCanvas(e){var n=this._getCanvasCache(),r=n.hit;e.save(),e.translate(n.x,n.y),e.drawImage(r._canvas,0,0,r.width/r.pixelRatio,r.height/r.pixelRatio),e.restore()}_getCachedSceneCanvas(){var e=this.filters(),n=this._getCanvasCache(),r=n.scene,a=n.filter,i=a.getContext(),o,s,l,u;if(e){if(!this._filterUpToDate){var c=r.pixelRatio;a.setSize(r.width/r.pixelRatio,r.height/r.pixelRatio);try{for(o=e.length,i.clear(),i.drawImage(r._canvas,0,0,r.getWidth()/c,r.getHeight()/c),s=i.getImageData(0,0,a.getWidth(),a.getHeight()),l=0;l<o;l++){if(u=e[l],typeof u!="function"){_t.Util.error("Filter should be type of function, but got "+typeof u+" instead. Please check correct filters");continue}u.call(this,s),i.putImageData(s,0,0)}}catch(d){_t.Util.error("Unable to apply filter. "+d.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return a}return r}on(e,n){if(this._cache&&this._cache.delete(yy),arguments.length===3)return this._delegate.apply(this,arguments);var r=e.split(by),a=r.length,i,o,s,l,u;for(i=0;i<a;i++)o=r[i],s=o.split("."),l=s[0],u=s[1]||"",this.eventListeners[l]||(this.eventListeners[l]=[]),this.eventListeners[l].push({name:u,handler:n});return this}off(e,n){var r=(e||"").split(by),a=r.length,i,o,s,l,u,c;if(this._cache&&this._cache.delete(yy),!e)for(o in this.eventListeners)this._off(o);for(i=0;i<a;i++)if(s=r[i],l=s.split("."),u=l[0],c=l[1],u)this.eventListeners[u]&&this._off(u,c,n);else for(o in this.eventListeners)this._off(o,c,n);return this}dispatchEvent(e){var n={target:this,type:e.type,evt:e};return this.fire(e.type,n),this}addEventListener(e,n){return this.on(e,function(r){n.call(this,r.evt)}),this}removeEventListener(e){return this.off(e),this}_delegate(e,n,r){var a=this;this.on(e,function(i){for(var o=i.target.findAncestors(n,!0,a),s=0;s<o.length;s++)i=_t.Util.cloneObject(i),i.currentTarget=o[s],r.call(o[s],i)})}remove(){return this.isDragging()&&this.stopDrag(),Si.DD._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(ms),this._clearSelfAndDescendantCache(gy),this._clearSelfAndDescendantCache(a6),this._clearSelfAndDescendantCache(u6),this._clearSelfAndDescendantCache(KN),this._clearSelfAndDescendantCache(qN)}_remove(){this._clearCaches();var e=this.getParent();e&&e.children&&(e.children.splice(this.index,1),e._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(e){var n="get"+_t.Util._capitalize(e);return _t.Util._isFunction(this[n])?this[n]():this.attrs[e]}getAncestors(){for(var e=this.getParent(),n=[];e;)n.push(e),e=e.getParent();return n}getAttrs(){return this.attrs||{}}setAttrs(e){return this._batchTransformChanges(()=>{var n,r;if(!e)return this;for(n in e)n!==pZ&&(r=s6+_t.Util._capitalize(n),_t.Util._isFunction(this[r])?this[r](e[n]):this._setAttr(n,e[n]))}),this}isListening(){return this._getCache(qN,this._isListening)}_isListening(e){if(!this.listening())return!1;const n=this.getParent();return n&&n!==e&&this!==e?n._isListening(e):!0}isVisible(){return this._getCache(KN,this._isVisible)}_isVisible(e){if(!this.visible())return!1;const n=this.getParent();return n&&n!==e&&this!==e?n._isVisible(e):!0}shouldDrawHit(e,n=!1){if(e)return this._isVisible(e)&&this._isListening(e);var r=this.getLayer(),a=!1;Si.DD._dragElements.forEach(o=>{o.dragStatus==="dragging"&&(o.node.nodeType==="Stage"||o.node.getLayer()===r)&&(a=!0)});var i=!n&&!Eu.Konva.hitOnDragEnabled&&a;return this.isListening()&&this.isVisible()&&!i}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){var e=this.getDepth(),n=this,r=0,a,i,o,s;function l(c){for(a=[],i=c.length,o=0;o<i;o++)s=c[o],r++,s.nodeType!==l6&&(a=a.concat(s.getChildren().slice())),s._id===n._id&&(o=i);a.length>0&&a[0].getDepth()<=e&&l(a)}const u=this.getStage();return n.nodeType!==fZ&&u&&l(u.getChildren()),r}getDepth(){for(var e=0,n=this.parent;n;)e++,n=n.parent;return e}_batchTransformChanges(e){this._batchingTransformChange=!0,e(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(wl),this._clearSelfAndDescendantCache(ms)),this._needClearTransformCache=!1}setPosition(e){return this._batchTransformChanges(()=>{this.x(e.x),this.y(e.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){const e=this.getStage();if(!e)return null;var n=e.getPointerPosition();if(!n)return null;var r=this.getAbsoluteTransform().copy();return r.invert(),r.point(n)}getAbsolutePosition(e){let n=!1,r=this.parent;for(;r;){if(r.isCached()){n=!0;break}r=r.parent}n&&!e&&(e=!0);var a=this.getAbsoluteTransform(e).getMatrix(),i=new _t.Transform,o=this.offset();return i.m=a.slice(),i.translate(o.x,o.y),i.getTranslation()}setAbsolutePosition(e){const{x:n,y:r,...a}=this._clearTransform();this.attrs.x=n,this.attrs.y=r,this._clearCache(wl);var i=this._getAbsoluteTransform().copy();return i.invert(),i.translate(e.x,e.y),e={x:this.attrs.x+i.getTranslation().x,y:this.attrs.y+i.getTranslation().y},this._setTransform(a),this.setPosition({x:e.x,y:e.y}),this._clearCache(wl),this._clearSelfAndDescendantCache(ms),this}_setTransform(e){var n;for(n in e)this.attrs[n]=e[n]}_clearTransform(){var e={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,e}move(e){var n=e.x,r=e.y,a=this.x(),i=this.y();return n!==void 0&&(a+=n),r!==void 0&&(i+=r),this.setPosition({x:a,y:i}),this}_eachAncestorReverse(e,n){var r=[],a=this.getParent(),i,o;if(!(n&&n._id===this._id)){for(r.unshift(this);a&&(!n||a._id!==n._id);)r.unshift(a),a=a.parent;for(i=r.length,o=0;o<i;o++)e(r[o])}}rotate(e){return this.rotation(this.rotation()+e),this}moveToTop(){if(!this.parent)return _t.Util.warn("Node has no parent. moveToTop function is ignored."),!1;var e=this.index,n=this.parent.getChildren().length;return e<n-1?(this.parent.children.splice(e,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return _t.Util.warn("Node has no parent. moveUp function is ignored."),!1;var e=this.index,n=this.parent.getChildren().length;return e<n-1?(this.parent.children.splice(e,1),this.parent.children.splice(e+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return _t.Util.warn("Node has no parent. moveDown function is ignored."),!1;var e=this.index;return e>0?(this.parent.children.splice(e,1),this.parent.children.splice(e-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return _t.Util.warn("Node has no parent. moveToBottom function is ignored."),!1;var e=this.index;return e>0?(this.parent.children.splice(e,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(e){if(!this.parent)return _t.Util.warn("Node has no parent. zIndex parameter is ignored."),this;(e<0||e>=this.parent.children.length)&&_t.Util.warn("Unexpected value "+e+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");var n=this.index;return this.parent.children.splice(n,1),this.parent.children.splice(e,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(gy,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){var e=this.opacity(),n=this.getParent();return n&&!n._isUnderCache&&(e*=n.getAbsoluteOpacity()),e}moveTo(e){return this.getParent()!==e&&(this._remove(),e.add(this)),this}toObject(){var e=this.getAttrs(),n,r,a,i,o;const s={attrs:{},className:this.getClassName()};for(n in e)r=e[n],o=_t.Util.isObject(r)&&!_t.Util._isPlainObject(r)&&!_t.Util._isArray(r),!o&&(a=typeof this[n]=="function"&&this[n],delete e[n],i=a?a.call(this):null,e[n]=r,i!==r&&(s.attrs[n]=r));return _t.Util._prepareToStringify(s)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(e,n,r){var a=[];n&&this._isMatch(e)&&a.push(this);for(var i=this.parent;i;){if(i===r)return a;i._isMatch(e)&&a.push(i),i=i.parent}return a}isAncestorOf(e){return!1}findAncestor(e,n,r){return this.findAncestors(e,n,r)[0]}_isMatch(e){if(!e)return!1;if(typeof e=="function")return e(this);var n=e.replace(/ /g,"").split(","),r=n.length,a,i;for(a=0;a<r;a++)if(i=n[a],_t.Util.isValidSelector(i)||(_t.Util.warn('Selector "'+i+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),_t.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),_t.Util.warn("Konva is awesome, right?")),i.charAt(0)==="#"){if(this.id()===i.slice(1))return!0}else if(i.charAt(0)==="."){if(this.hasName(i.slice(1)))return!0}else if(this.className===i||this.nodeType===i)return!0;return!1}getLayer(){var e=this.getParent();return e?e.getLayer():null}getStage(){return this._getCache(u6,this._getStage)}_getStage(){var e=this.getParent();return e?e.getStage():null}fire(e,n={},r){return n.target=n.target||this,r?this._fireAndBubble(e,n):this._fire(e,n),this}getAbsoluteTransform(e){return e?this._getAbsoluteTransform(e):this._getCache(ms,this._getAbsoluteTransform)}_getAbsoluteTransform(e){var n;if(e)return n=new _t.Transform,this._eachAncestorReverse(function(a){var i=a.transformsEnabled();i==="all"?n.multiply(a.getTransform()):i==="position"&&n.translate(a.x()-a.offsetX(),a.y()-a.offsetY())},e),n;n=this._cache.get(ms)||new _t.Transform,this.parent?this.parent.getAbsoluteTransform().copyInto(n):n.reset();var r=this.transformsEnabled();if(r==="all")n.multiply(this.getTransform());else if(r==="position"){const a=this.attrs.x||0,i=this.attrs.y||0,o=this.attrs.offsetX||0,s=this.attrs.offsetY||0;n.translate(a-o,i-s)}return n.dirty=!1,n}getAbsoluteScale(e){for(var n=this;n;)n._isUnderCache&&(e=n),n=n.getParent();const r=this.getAbsoluteTransform(e).decompose();return{x:r.scaleX,y:r.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(wl,this._getTransform)}_getTransform(){var e,n,r=this._cache.get(wl)||new _t.Transform;r.reset();var a=this.x(),i=this.y(),o=Eu.Konva.getAngle(this.rotation()),s=(e=this.attrs.scaleX)!==null&&e!==void 0?e:1,l=(n=this.attrs.scaleY)!==null&&n!==void 0?n:1,u=this.attrs.skewX||0,c=this.attrs.skewY||0,d=this.attrs.offsetX||0,p=this.attrs.offsetY||0;return(a!==0||i!==0)&&r.translate(a,i),o!==0&&r.rotate(o),(u!==0||c!==0)&&r.skew(u,c),(s!==1||l!==1)&&r.scale(s,l),(d!==0||p!==0)&&r.translate(-1*d,-1*p),r.dirty=!1,r}clone(e){var n=_t.Util.cloneObject(this.attrs),r,a,i,o,s;for(r in e)n[r]=e[r];var l=new this.constructor(n);for(r in this.eventListeners)for(a=this.eventListeners[r],i=a.length,o=0;o<i;o++)s=a[o],s.name.indexOf(hZ)<0&&(l.eventListeners[r]||(l.eventListeners[r]=[]),l.eventListeners[r].push(s));return l}_toKonvaCanvas(e){e=e||{};var n=this.getClientRect(),r=this.getStage(),a=e.x!==void 0?e.x:Math.floor(n.x),i=e.y!==void 0?e.y:Math.floor(n.y),o=e.pixelRatio||1,s=new af.SceneCanvas({width:e.width||Math.ceil(n.width)||(r?r.width():0),height:e.height||Math.ceil(n.height)||(r?r.height():0),pixelRatio:o}),l=s.getContext();const u=new af.SceneCanvas({width:s.width/s.pixelRatio+Math.abs(a),height:s.height/s.pixelRatio+Math.abs(i),pixelRatio:s.pixelRatio});return e.imageSmoothingEnabled===!1&&(l._context.imageSmoothingEnabled=!1),l.save(),(a||i)&&l.translate(-1*a,-1*i),this.drawScene(s,void 0,u),l.restore(),s}toCanvas(e){return this._toKonvaCanvas(e)._canvas}toDataURL(e){e=e||{};var n=e.mimeType||null,r=e.quality||null,a=this._toKonvaCanvas(e).toDataURL(n,r);return e.callback&&e.callback(a),a}toImage(e){return new Promise((n,r)=>{try{const a=e?.callback;a&&delete e.callback,_t.Util._urlToImage(this.toDataURL(e),function(i){n(i),a?.(i)})}catch(a){r(a)}})}toBlob(e){return new Promise((n,r)=>{try{const a=e?.callback;a&&delete e.callback,this.toCanvas(e).toBlob(i=>{n(i),a?.(i)},e?.mimeType,e?.quality)}catch(a){r(a)}})}setSize(e){return this.width(e.width),this.height(e.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():Eu.Konva.dragDistance}_off(e,n,r){var a=this.eventListeners[e],i,o,s;for(i=0;i<a.length;i++)if(o=a[i].name,s=a[i].handler,(o!=="konva"||n==="konva")&&(!n||o===n)&&(!r||r===s)){if(a.splice(i,1),a.length===0){delete this.eventListeners[e];break}i--}}_fireChangeEvent(e,n,r){this._fire(e+dZ,{oldVal:n,newVal:r})}addName(e){if(!this.hasName(e)){var n=this.name(),r=n?n+" "+e:e;this.name(r)}return this}hasName(e){if(!e)return!1;const n=this.name();if(!n)return!1;var r=(n||"").split(/\s/g);return r.indexOf(e)!==-1}removeName(e){var n=(this.name()||"").split(/\s/g),r=n.indexOf(e);return r!==-1&&(n.splice(r,1),this.name(n.join(" "))),this}setAttr(e,n){var r=this[s6+_t.Util._capitalize(e)];return _t.Util._isFunction(r)?r.call(this,n):this._setAttr(e,n),this}_requestDraw(){if(Eu.Konva.autoDrawEnabled){const e=this.getLayer()||this.getStage();e?.batchDraw()}}_setAttr(e,n){var r=this.attrs[e];r===n&&!_t.Util.isObject(n)||(n==null?delete this.attrs[e]:this.attrs[e]=n,this._shouldFireChangeEvents&&this._fireChangeEvent(e,r,n),this._requestDraw())}_setComponentAttr(e,n,r){var a;r!==void 0&&(a=this.attrs[e],a||(this.attrs[e]=this.getAttr(e)),this.attrs[e][n]=r,this._fireChangeEvent(e,a,r))}_fireAndBubble(e,n,r){n&&this.nodeType===l6&&(n.target=this);var a=(e===i6||e===o6)&&(r&&(this===r||this.isAncestorOf&&this.isAncestorOf(r))||this.nodeType==="Stage"&&!r);if(!a){this._fire(e,n);var i=(e===i6||e===o6)&&r&&r.isAncestorOf&&r.isAncestorOf(this)&&!r.isAncestorOf(this.parent);(n&&!n.cancelBubble||!n)&&this.parent&&this.parent.isListening()&&!i&&(r&&r.parent?this._fireAndBubble.call(this.parent,e,n,r):this._fireAndBubble.call(this.parent,e,n))}}_getProtoListeners(e){var n,r,a;const i=(n=this._cache.get(yy))!==null&&n!==void 0?n:{};let o=i?.[e];if(o===void 0){o=[];let s=Object.getPrototypeOf(this);for(;s;){const l=(a=(r=s.eventListeners)===null||r===void 0?void 0:r[e])!==null&&a!==void 0?a:[];o.push(...l),s=Object.getPrototypeOf(s)}i[e]=o,this._cache.set(yy,i)}return o}_fire(e,n){n=n||{},n.currentTarget=this,n.type=e;const r=this._getProtoListeners(e);if(r)for(var a=0;a<r.length;a++)r[a].handler.call(this,n);const i=this.eventListeners[e];if(i)for(var a=0;a<i.length;a++)i[a].handler.call(this,n)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(e){var n=e?e.pointerId:void 0,r=this.getStage(),a=this.getAbsolutePosition();if(r){var i=r._getPointerById(n)||r._changedPointerPositions[0]||a;Si.DD._dragElements.set(this._id,{node:this,startPointerPos:i,offset:{x:i.x-a.x,y:i.y-a.y},dragStatus:"ready",pointerId:n})}}startDrag(e,n=!0){Si.DD._dragElements.has(this._id)||this._createDragElement(e);const r=Si.DD._dragElements.get(this._id);r.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:e&&e.evt},n)}_setDragPosition(e,n){const r=this.getStage()._getPointerById(n.pointerId);if(r){var a={x:r.x-n.offset.x,y:r.y-n.offset.y},i=this.dragBoundFunc();if(i!==void 0){const o=i.call(this,a,e);o?a=o:_t.Util.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==a.x||this._lastPos.y!==a.y)&&(this.setAbsolutePosition(a),this._requestDraw()),this._lastPos=a}}stopDrag(e){const n=Si.DD._dragElements.get(this._id);n&&(n.dragStatus="stopped"),Si.DD._endDragBefore(e),Si.DD._endDragAfter(e)}setDraggable(e){this._setAttr("draggable",e),this._dragChange()}isDragging(){const e=Si.DD._dragElements.get(this._id);return e?e.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(e){var n=e.evt.button!==void 0,r=!n||Eu.Konva.dragButtons.indexOf(e.evt.button)>=0;if(r&&!this.isDragging()){var a=!1;Si.DD._dragElements.forEach(i=>{this.isAncestorOf(i.node)&&(a=!0)}),a||this._createDragElement(e)}})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{this._dragCleanup();var e=this.getStage();if(!e)return;const n=Si.DD._dragElements.get(this._id),r=n&&n.dragStatus==="dragging",a=n&&n.dragStatus==="ready";r?this.stopDrag():a&&Si.DD._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(e={x:0,y:0}){const n=this.getStage();if(!n)return!1;const r={x:-e.x,y:-e.y,width:n.width()+2*e.x,height:n.height()+2*e.y};return _t.Util.haveIntersection(r,this.getClientRect())}static create(e,n){return _t.Util._isString(e)&&(e=JSON.parse(e)),this._createNode(e,n)}static _createNode(e,n){var r=lt.prototype.getClassName.call(e),a=e.children,i,o,s;n&&(e.attrs.container=n),Eu.Konva[r]||(_t.Util.warn('Can not find a node with class name "'+r+'". Fallback to "Shape".'),r="Shape");const l=Eu.Konva[r];if(i=new l(e.attrs),a)for(o=a.length,s=0;s<o;s++)i.add(lt._createNode(a[s]));return i}}Tn.Node=lt,lt.prototype.nodeType="Node",lt.prototype._attrsAffectingSize=[],lt.prototype.eventListeners={},lt.prototype.on.call(lt.prototype,mZ,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(wl),this._clearSelfAndDescendantCache(ms)}),lt.prototype.on.call(lt.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(KN)}),lt.prototype.on.call(lt.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(qN)}),lt.prototype.on.call(lt.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(gy)});const sn=rf.Factory.addGetterSetter;sn(lt,"zIndex"),sn(lt,"absolutePosition"),sn(lt,"position"),sn(lt,"x",0,(0,Kn.getNumberValidator)()),sn(lt,"y",0,(0,Kn.getNumberValidator)()),sn(lt,"globalCompositeOperation","source-over",(0,Kn.getStringValidator)()),sn(lt,"opacity",1,(0,Kn.getNumberValidator)()),sn(lt,"name","",(0,Kn.getStringValidator)()),sn(lt,"id","",(0,Kn.getStringValidator)()),sn(lt,"rotation",0,(0,Kn.getNumberValidator)()),rf.Factory.addComponentsGetterSetter(lt,"scale",["x","y"]),sn(lt,"scaleX",1,(0,Kn.getNumberValidator)()),sn(lt,"scaleY",1,(0,Kn.getNumberValidator)()),rf.Factory.addComponentsGetterSetter(lt,"skew",["x","y"]),sn(lt,"skewX",0,(0,Kn.getNumberValidator)()),sn(lt,"skewY",0,(0,Kn.getNumberValidator)()),rf.Factory.addComponentsGetterSetter(lt,"offset",["x","y"]),sn(lt,"offsetX",0,(0,Kn.getNumberValidator)()),sn(lt,"offsetY",0,(0,Kn.getNumberValidator)()),sn(lt,"dragDistance",null,(0,Kn.getNumberValidator)()),sn(lt,"width",0,(0,Kn.getNumberValidator)()),sn(lt,"height",0,(0,Kn.getNumberValidator)()),sn(lt,"listening",!0,(0,Kn.getBooleanValidator)()),sn(lt,"preventDefault",!0,(0,Kn.getBooleanValidator)()),sn(lt,"filters",null,function(t){return this._filterUpToDate=!1,t}),sn(lt,"visible",!0,(0,Kn.getBooleanValidator)()),sn(lt,"transformsEnabled","all",(0,Kn.getStringValidator)()),sn(lt,"size"),sn(lt,"dragBoundFunc"),sn(lt,"draggable",!1,(0,Kn.getBooleanValidator)()),rf.Factory.backCompat(lt,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"});var Ou={};Object.defineProperty(Ou,"__esModule",{value:!0}),Ou.Container=void 0;const Cd=kt,XN=Tn,vy=Ge;class $u extends XN.Node{constructor(){super(...arguments),this.children=[]}getChildren(e){if(!e)return this.children||[];const n=this.children||[];var r=[];return n.forEach(function(a){e(a)&&r.push(a)}),r}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(e=>{e.parent=null,e.index=0,e.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(e=>{e.parent=null,e.index=0,e.destroy()}),this.children=[],this._requestDraw(),this}add(...e){if(e.length===0)return this;if(e.length>1){for(var n=0;n<e.length;n++)this.add(e[n]);return this}const r=e[0];return r.getParent()?(r.moveTo(this),this):(this._validateAdd(r),r.index=this.getChildren().length,r.parent=this,r._clearCaches(),this.getChildren().push(r),this._fire("add",{child:r}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(e){return this._generalFind(e,!1)}findOne(e){var n=this._generalFind(e,!0);return n.length>0?n[0]:void 0}_generalFind(e,n){var r=[];return this._descendants(a=>{const i=a._isMatch(e);return i&&r.push(a),!!(i&&n)}),r}_descendants(e){let n=!1;const r=this.getChildren();for(const a of r)if(n=e(a),n||a.hasChildren()&&(n=a._descendants(e),n))return!0;return!1}toObject(){var e=XN.Node.prototype.toObject.call(this);return e.children=[],this.getChildren().forEach(n=>{e.children.push(n.toObject())}),e}isAncestorOf(e){for(var n=e.getParent();n;){if(n._id===this._id)return!0;n=n.getParent()}return!1}clone(e){var n=XN.Node.prototype.clone.call(this,e);return this.getChildren().forEach(function(r){n.add(r.clone())}),n}getAllIntersections(e){var n=[];return this.find("Shape").forEach(r=>{r.isVisible()&&r.intersects(e)&&n.push(r)}),n}_clearSelfAndDescendantCache(e){var n;super._clearSelfAndDescendantCache(e),!this.isCached()&&((n=this.children)===null||n===void 0||n.forEach(function(r){r._clearSelfAndDescendantCache(e)}))}_setChildrenIndices(){var e;(e=this.children)===null||e===void 0||e.forEach(function(n,r){n.index=r}),this._requestDraw()}drawScene(e,n,r){var a=this.getLayer(),i=e||a&&a.getCanvas(),o=i&&i.getContext(),s=this._getCanvasCache(),l=s&&s.scene,u=i&&i.isCache;if(!this.isVisible()&&!u)return this;if(l){o.save();var c=this.getAbsoluteTransform(n).getMatrix();o.transform(c[0],c[1],c[2],c[3],c[4],c[5]),this._drawCachedSceneCanvas(o),o.restore()}else this._drawChildren("drawScene",i,n,r);return this}drawHit(e,n){if(!this.shouldDrawHit(n))return this;var r=this.getLayer(),a=e||r&&r.hitCanvas,i=a&&a.getContext(),o=this._getCanvasCache(),s=o&&o.hit;if(s){i.save();var l=this.getAbsoluteTransform(n).getMatrix();i.transform(l[0],l[1],l[2],l[3],l[4],l[5]),this._drawCachedHitCanvas(i),i.restore()}else this._drawChildren("drawHit",a,n);return this}_drawChildren(e,n,r,a){var i,o=n&&n.getContext(),s=this.clipWidth(),l=this.clipHeight(),u=this.clipFunc(),c=s&&l||u;const d=r===this;if(c){o.save();var p=this.getAbsoluteTransform(r),f=p.getMatrix();o.transform(f[0],f[1],f[2],f[3],f[4],f[5]),o.beginPath();let b;if(u)b=u.call(this,o,this);else{var g=this.clipX(),y=this.clipY();o.rect(g,y,s,l)}o.clip.apply(o,b),f=p.copy().invert().getMatrix(),o.transform(f[0],f[1],f[2],f[3],f[4],f[5])}var x=!d&&this.globalCompositeOperation()!=="source-over"&&e==="drawScene";x&&(o.save(),o._applyGlobalCompositeOperation(this)),(i=this.children)===null||i===void 0||i.forEach(function(b){b[e](n,r,a)}),x&&o.restore(),c&&o.restore()}getClientRect(e={}){var n,r=e.skipTransform,a=e.relativeTo,i,o,s,l,u={x:1/0,y:1/0,width:0,height:0},c=this;(n=this.children)===null||n===void 0||n.forEach(function(y){if(y.visible()){var x=y.getClientRect({relativeTo:c,skipShadow:e.skipShadow,skipStroke:e.skipStroke});x.width===0&&x.height===0||(i===void 0?(i=x.x,o=x.y,s=x.x+x.width,l=x.y+x.height):(i=Math.min(i,x.x),o=Math.min(o,x.y),s=Math.max(s,x.x+x.width),l=Math.max(l,x.y+x.height)))}});for(var d=this.find("Shape"),p=!1,f=0;f<d.length;f++){var g=d[f];if(g._isVisible(this)){p=!0;break}}return p&&i!==void 0?u={x:i,y:o,width:s-i,height:l-o}:u={x:0,y:0,width:0,height:0},r?u:this._transformedRect(u,a)}}Ou.Container=$u,Cd.Factory.addComponentsGetterSetter($u,"clip",["x","y","width","height"]),Cd.Factory.addGetterSetter($u,"clipX",void 0,(0,vy.getNumberValidator)()),Cd.Factory.addGetterSetter($u,"clipY",void 0,(0,vy.getNumberValidator)()),Cd.Factory.addGetterSetter($u,"clipWidth",void 0,(0,vy.getNumberValidator)()),Cd.Factory.addGetterSetter($u,"clipHeight",void 0,(0,vy.getNumberValidator)()),Cd.Factory.addGetterSetter($u,"clipFunc");var c6={},ti={};Object.defineProperty(ti,"__esModule",{value:!0}),ti.releaseCapture=ti.setPointerCapture=ti.hasPointerCapture=ti.createEvent=ti.getCapturedShape=void 0;const yZ=wt,of=new Map,d6=yZ.Konva._global.PointerEvent!==void 0;function bZ(t){return of.get(t)}ti.getCapturedShape=bZ;function YN(t){return{evt:t,pointerId:t.pointerId}}ti.createEvent=YN;function vZ(t,e){return of.get(t)===e}ti.hasPointerCapture=vZ;function xZ(t,e){p6(t),e.getStage()&&(of.set(t,e),d6&&e._fire("gotpointercapture",YN(new PointerEvent("gotpointercapture"))))}ti.setPointerCapture=xZ;function p6(t,e){const n=of.get(t);if(!n)return;const r=n.getStage();r&&r.content,of.delete(t),d6&&n._fire("lostpointercapture",YN(new PointerEvent("lostpointercapture")))}ti.releaseCapture=p6,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Stage=t.stages=void 0;const e=Ln,n=kt,r=Ou,a=wt,i=to,o=my,s=wt,l=ti;var u="Stage",c="string",d="px",p="mouseout",f="mouseleave",g="mouseover",y="mouseenter",x="mousemove",b="mousedown",v="mouseup",w="pointermove",S="pointerdown",C="pointerup",I="pointercancel",_="lostpointercapture",E="pointerout",A="pointerleave",M="pointerover",L="pointerenter",W="contextmenu",B="touchstart",K="touchend",X="touchmove",Q="touchcancel",H="wheel",F=5,Y=[[y,"_pointerenter"],[b,"_pointerdown"],[x,"_pointermove"],[v,"_pointerup"],[f,"_pointerleave"],[B,"_pointerdown"],[X,"_pointermove"],[K,"_pointerup"],[Q,"_pointercancel"],[g,"_pointerover"],[H,"_wheel"],[W,"_contextmenu"],[S,"_pointerdown"],[w,"_pointermove"],[C,"_pointerup"],[I,"_pointercancel"],[_,"_lostpointercapture"]];const Z={mouse:{[E]:p,[A]:f,[M]:g,[L]:y,[w]:x,[S]:b,[C]:v,[I]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[E]:"touchout",[A]:"touchleave",[M]:"touchover",[L]:"touchenter",[w]:X,[S]:B,[C]:K,[I]:Q,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[E]:E,[A]:A,[M]:M,[L]:L,[w]:w,[S]:S,[C]:C,[I]:I,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},ne=we=>we.indexOf("pointer")>=0?"pointer":we.indexOf("touch")>=0?"touch":"mouse",se=we=>{const q=ne(we);if(q==="pointer")return a.Konva.pointerEventsEnabled&&Z.pointer;if(q==="touch")return Z.touch;if(q==="mouse")return Z.mouse};function ce(we={}){return(we.clipFunc||we.clipWidth||we.clipHeight)&&e.Util.warn("Stage does not support clipping. Please use clip for Layers or Groups."),we}const le="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);";t.stages=[];class ye extends r.Container{constructor(q){super(ce(q)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),t.stages.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{ce(this.attrs)}),this._checkVisibility()}_validateAdd(q){const ie=q.getType()==="Layer",de=q.getType()==="FastLayer";ie||de||e.Util.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const q=this.visible()?"":"none";this.content.style.display=q}setContainer(q){if(typeof q===c){if(q.charAt(0)==="."){var ie=q.slice(1);q=document.getElementsByClassName(ie)[0]}else{var de;q.charAt(0)!=="#"?de=q:de=q.slice(1),q=document.getElementById(de)}if(!q)throw"Can not find container in document with id "+de}return this._setAttr("container",q),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),q.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){var q=this.children,ie=q.length,de;for(de=0;de<ie;de++)q[de].clear();return this}clone(q){return q||(q={}),q.container=typeof document<"u"&&document.createElement("div"),r.Container.prototype.clone.call(this,q)}destroy(){super.destroy();var q=this.content;q&&e.Util._isInDocument(q)&&this.container().removeChild(q);var ie=t.stages.indexOf(this);return ie>-1&&t.stages.splice(ie,1),e.Util.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const q=this._pointerPositions[0]||this._changedPointerPositions[0];return q?{x:q.x,y:q.y}:(e.Util.warn(le),null)}_getPointerById(q){return this._pointerPositions.find(ie=>ie.id===q)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(q){q=q||{},q.x=q.x||0,q.y=q.y||0,q.width=q.width||this.width(),q.height=q.height||this.height();var ie=new i.SceneCanvas({width:q.width,height:q.height,pixelRatio:q.pixelRatio||1}),de=ie.getContext()._context,ke=this.children;return(q.x||q.y)&&de.translate(-1*q.x,-1*q.y),ke.forEach(function(Ne){if(Ne.isVisible()){var Ie=Ne._toKonvaCanvas(q);de.drawImage(Ie._canvas,q.x,q.y,Ie.getWidth()/Ie.getPixelRatio(),Ie.getHeight()/Ie.getPixelRatio())}}),ie}getIntersection(q){if(!q)return null;var ie=this.children,de=ie.length,ke=de-1,Ne;for(Ne=ke;Ne>=0;Ne--){const Ie=ie[Ne].getIntersection(q);if(Ie)return Ie}return null}_resizeDOM(){var q=this.width(),ie=this.height();this.content&&(this.content.style.width=q+d,this.content.style.height=ie+d),this.bufferCanvas.setSize(q,ie),this.bufferHitCanvas.setSize(q,ie),this.children.forEach(de=>{de.setSize({width:q,height:ie}),de.draw()})}add(q,...ie){if(arguments.length>1){for(var de=0;de<arguments.length;de++)this.add(arguments[de]);return this}super.add(q);var ke=this.children.length;return ke>F&&e.Util.warn("The stage has "+ke+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),q.setSize({width:this.width(),height:this.height()}),q.draw(),a.Konva.isBrowser&&this.content.appendChild(q.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(q){return l.hasPointerCapture(q,this)}setPointerCapture(q){l.setPointerCapture(q,this)}releaseCapture(q){l.releaseCapture(q,this)}getLayers(){return this.children}_bindContentEvents(){a.Konva.isBrowser&&Y.forEach(([q,ie])=>{this.content.addEventListener(q,de=>{this[ie](de)},{passive:!1})})}_pointerenter(q){this.setPointersPositions(q);const ie=se(q.type);ie&&this._fire(ie.pointerenter,{evt:q,target:this,currentTarget:this})}_pointerover(q){this.setPointersPositions(q);const ie=se(q.type);ie&&this._fire(ie.pointerover,{evt:q,target:this,currentTarget:this})}_getTargetShape(q){let ie=this[q+"targetShape"];return ie&&!ie.getStage()&&(ie=null),ie}_pointerleave(q){const ie=se(q.type),de=ne(q.type);if(ie){this.setPointersPositions(q);var ke=this._getTargetShape(de),Ne=!o.DD.isDragging||a.Konva.hitOnDragEnabled;ke&&Ne?(ke._fireAndBubble(ie.pointerout,{evt:q}),ke._fireAndBubble(ie.pointerleave,{evt:q}),this._fire(ie.pointerleave,{evt:q,target:this,currentTarget:this}),this[de+"targetShape"]=null):Ne&&(this._fire(ie.pointerleave,{evt:q,target:this,currentTarget:this}),this._fire(ie.pointerout,{evt:q,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}}_pointerdown(q){const ie=se(q.type),de=ne(q.type);if(ie){this.setPointersPositions(q);var ke=!1;this._changedPointerPositions.forEach(Ne=>{var Ie=this.getIntersection(Ne);if(o.DD.justDragged=!1,a.Konva["_"+de+"ListenClick"]=!0,!Ie||!Ie.isListening())return;a.Konva.capturePointerEventsEnabled&&Ie.setPointerCapture(Ne.id),this[de+"ClickStartShape"]=Ie,Ie._fireAndBubble(ie.pointerdown,{evt:q,pointerId:Ne.id}),ke=!0;const De=q.type.indexOf("touch")>=0;Ie.preventDefault()&&q.cancelable&&De&&q.preventDefault()}),ke||this._fire(ie.pointerdown,{evt:q,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}}_pointermove(q){const ie=se(q.type),de=ne(q.type);if(!ie)return;o.DD.isDragging&&o.DD.node.preventDefault()&&q.cancelable&&q.preventDefault(),this.setPointersPositions(q);var ke=!o.DD.isDragging||a.Konva.hitOnDragEnabled;if(!ke)return;var Ne={};let Ie=!1;var De=this._getTargetShape(de);this._changedPointerPositions.forEach(He=>{const Me=l.getCapturedShape(He.id)||this.getIntersection(He),it=He.id,Ye={evt:q,pointerId:it};var Ze=De!==Me;if(Ze&&De&&(De._fireAndBubble(ie.pointerout,{...Ye},Me),De._fireAndBubble(ie.pointerleave,{...Ye},Me)),Me){if(Ne[Me._id])return;Ne[Me._id]=!0}Me&&Me.isListening()?(Ie=!0,Ze&&(Me._fireAndBubble(ie.pointerover,{...Ye},De),Me._fireAndBubble(ie.pointerenter,{...Ye},De),this[de+"targetShape"]=Me),Me._fireAndBubble(ie.pointermove,{...Ye})):De&&(this._fire(ie.pointerover,{evt:q,target:this,currentTarget:this,pointerId:it}),this[de+"targetShape"]=null)}),Ie||this._fire(ie.pointermove,{evt:q,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(q){const ie=se(q.type),de=ne(q.type);if(!ie)return;this.setPointersPositions(q);const ke=this[de+"ClickStartShape"],Ne=this[de+"ClickEndShape"];var Ie={};let De=!1;this._changedPointerPositions.forEach(He=>{const Me=l.getCapturedShape(He.id)||this.getIntersection(He);if(Me){if(Me.releaseCapture(He.id),Ie[Me._id])return;Ie[Me._id]=!0}const it=He.id,Ye={evt:q,pointerId:it};let Ze=!1;a.Konva["_"+de+"InDblClickWindow"]?(Ze=!0,clearTimeout(this[de+"DblTimeout"])):o.DD.justDragged||(a.Konva["_"+de+"InDblClickWindow"]=!0,clearTimeout(this[de+"DblTimeout"])),this[de+"DblTimeout"]=setTimeout(function(){a.Konva["_"+de+"InDblClickWindow"]=!1},a.Konva.dblClickWindow),Me&&Me.isListening()?(De=!0,this[de+"ClickEndShape"]=Me,Me._fireAndBubble(ie.pointerup,{...Ye}),a.Konva["_"+de+"ListenClick"]&&ke&&ke===Me&&(Me._fireAndBubble(ie.pointerclick,{...Ye}),Ze&&Ne&&Ne===Me&&Me._fireAndBubble(ie.pointerdblclick,{...Ye}))):(this[de+"ClickEndShape"]=null,a.Konva["_"+de+"ListenClick"]&&this._fire(ie.pointerclick,{evt:q,target:this,currentTarget:this,pointerId:it}),Ze&&this._fire(ie.pointerdblclick,{evt:q,target:this,currentTarget:this,pointerId:it}))}),De||this._fire(ie.pointerup,{evt:q,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),a.Konva["_"+de+"ListenClick"]=!1,q.cancelable&&de!=="touch"&&q.preventDefault()}_contextmenu(q){this.setPointersPositions(q);var ie=this.getIntersection(this.getPointerPosition());ie&&ie.isListening()?ie._fireAndBubble(W,{evt:q}):this._fire(W,{evt:q,target:this,currentTarget:this})}_wheel(q){this.setPointersPositions(q);var ie=this.getIntersection(this.getPointerPosition());ie&&ie.isListening()?ie._fireAndBubble(H,{evt:q}):this._fire(H,{evt:q,target:this,currentTarget:this})}_pointercancel(q){this.setPointersPositions(q);const ie=l.getCapturedShape(q.pointerId)||this.getIntersection(this.getPointerPosition());ie&&ie._fireAndBubble(C,l.createEvent(q)),l.releaseCapture(q.pointerId)}_lostpointercapture(q){l.releaseCapture(q.pointerId)}setPointersPositions(q){var ie=this._getContentPosition(),de=null,ke=null;q=q||window.event,q.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(q.touches,Ne=>{this._pointerPositions.push({id:Ne.identifier,x:(Ne.clientX-ie.left)/ie.scaleX,y:(Ne.clientY-ie.top)/ie.scaleY})}),Array.prototype.forEach.call(q.changedTouches||q.touches,Ne=>{this._changedPointerPositions.push({id:Ne.identifier,x:(Ne.clientX-ie.left)/ie.scaleX,y:(Ne.clientY-ie.top)/ie.scaleY})})):(de=(q.clientX-ie.left)/ie.scaleX,ke=(q.clientY-ie.top)/ie.scaleY,this.pointerPos={x:de,y:ke},this._pointerPositions=[{x:de,y:ke,id:e.Util._getFirstPointerId(q)}],this._changedPointerPositions=[{x:de,y:ke,id:e.Util._getFirstPointerId(q)}])}_setPointerPosition(q){e.Util.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(q)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};var q=this.content.getBoundingClientRect();return{top:q.top,left:q.left,scaleX:q.width/this.content.clientWidth||1,scaleY:q.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new i.SceneCanvas({width:this.width(),height:this.height()}),this.bufferHitCanvas=new i.HitCanvas({pixelRatio:1,width:this.width(),height:this.height()}),!!a.Konva.isBrowser){var q=this.container();if(!q)throw"Stage has no container. A container is required.";q.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),q.appendChild(this.content),this._resizeDOM()}}cache(){return e.Util.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(q){q.batchDraw()}),this}}t.Stage=ye,ye.prototype.nodeType=u,(0,s._registerNode)(ye),n.Factory.addGetterSetter(ye,"container")}(c6);var sf={},ur={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Shape=t.shapes=void 0;const e=wt,n=Ln,r=kt,a=Tn,i=Ge,o=wt,s=ti;var l="hasShadow",u="shadowRGBA",c="patternImage",d="linearGradient",p="radialGradient";let f;function g(){return f||(f=n.Util.createCanvasElement().getContext("2d"),f)}t.shapes={};function y(A){const M=this.attrs.fillRule;M?A.fill(M):A.fill()}function x(A){A.stroke()}function b(A){A.fill()}function v(A){A.stroke()}function w(){this._clearCache(l)}function S(){this._clearCache(u)}function C(){this._clearCache(c)}function I(){this._clearCache(d)}function _(){this._clearCache(p)}class E extends a.Node{constructor(M){super(M);let L;for(;L=n.Util.getRandomColor(),!(L&&!(L in t.shapes)););this.colorKey=L,t.shapes[L]=this}getContext(){return n.Util.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return n.Util.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(l,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(c,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){var M=g();const L=M.createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(L&&L.setTransform){const W=new n.Transform;W.translate(this.fillPatternX(),this.fillPatternY()),W.rotate(e.Konva.getAngle(this.fillPatternRotation())),W.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),W.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const B=W.getMatrix(),K=typeof DOMMatrix>"u"?{a:B[0],b:B[1],c:B[2],d:B[3],e:B[4],f:B[5]}:new DOMMatrix(B);L.setTransform(K)}return L}}_getLinearGradient(){return this._getCache(d,this.__getLinearGradient)}__getLinearGradient(){var M=this.fillLinearGradientColorStops();if(M){for(var L=g(),W=this.fillLinearGradientStartPoint(),B=this.fillLinearGradientEndPoint(),K=L.createLinearGradient(W.x,W.y,B.x,B.y),X=0;X<M.length;X+=2)K.addColorStop(M[X],M[X+1]);return K}}_getRadialGradient(){return this._getCache(p,this.__getRadialGradient)}__getRadialGradient(){var M=this.fillRadialGradientColorStops();if(M){for(var L=g(),W=this.fillRadialGradientStartPoint(),B=this.fillRadialGradientEndPoint(),K=L.createRadialGradient(W.x,W.y,this.fillRadialGradientStartRadius(),B.x,B.y,this.fillRadialGradientEndRadius()),X=0;X<M.length;X+=2)K.addColorStop(M[X],M[X+1]);return K}}getShadowRGBA(){return this._getCache(u,this._getShadowRGBA)}_getShadowRGBA(){if(this.hasShadow()){var M=n.Util.colorToRGBA(this.shadowColor());if(M)return"rgba("+M.r+","+M.g+","+M.b+","+M.a*(this.shadowOpacity()||1)+")"}}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){const M=this.hitStrokeWidth();return M==="auto"?this.hasStroke():this.strokeEnabled()&&!!M}intersects(M){var L=this.getStage();if(!L)return!1;const W=L.bufferHitCanvas;return W.getContext().clear(),this.drawHit(W,void 0,!0),W.context.getImageData(Math.round(M.x),Math.round(M.y),1,1).data[3]>0}destroy(){return a.Node.prototype.destroy.call(this),delete t.shapes[this.colorKey],delete this.colorKey,this}_useBufferCanvas(M){var L;if(!(!((L=this.attrs.perfectDrawEnabled)!==null&&L!==void 0)||L))return!1;const W=M||this.hasFill(),B=this.hasStroke(),K=this.getAbsoluteOpacity()!==1;if(W&&B&&K)return!0;const X=this.hasShadow(),Q=this.shadowForStrokeEnabled();return!!(W&&B&&X&&Q)}setStrokeHitEnabled(M){n.Util.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),M?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){var M=this.size();return{x:this._centroid?-M.width/2:0,y:this._centroid?-M.height/2:0,width:M.width,height:M.height}}getClientRect(M={}){const L=M.skipTransform,W=M.relativeTo,B=this.getSelfRect(),K=!M.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,X=B.width+K,Q=B.height+K,H=!M.skipShadow&&this.hasShadow(),F=H?this.shadowOffsetX():0,Y=H?this.shadowOffsetY():0,Z=X+Math.abs(F),ne=Q+Math.abs(Y),se=H&&this.shadowBlur()||0,ce=Z+se*2,le=ne+se*2,ye={width:ce,height:le,x:-(K/2+se)+Math.min(F,0)+B.x,y:-(K/2+se)+Math.min(Y,0)+B.y};return L?ye:this._transformedRect(ye,W)}drawScene(M,L,W){var B=this.getLayer(),K=M||B.getCanvas(),X=K.getContext(),Q=this._getCanvasCache(),H=this.getSceneFunc(),F=this.hasShadow(),Y,Z,ne=K.isCache,se=L===this;if(!this.isVisible()&&!se)return this;if(Q){X.save();var ce=this.getAbsoluteTransform(L).getMatrix();return X.transform(ce[0],ce[1],ce[2],ce[3],ce[4],ce[5]),this._drawCachedSceneCanvas(X),X.restore(),this}if(!H)return this;if(X.save(),this._useBufferCanvas()&&!ne){Y=this.getStage();const we=W||Y.bufferCanvas;Z=we.getContext(),Z.clear(),Z.save(),Z._applyLineJoin(this);var le=this.getAbsoluteTransform(L).getMatrix();Z.transform(le[0],le[1],le[2],le[3],le[4],le[5]),H.call(this,Z,this),Z.restore();var ye=we.pixelRatio;F&&X._applyShadow(this),X._applyOpacity(this),X._applyGlobalCompositeOperation(this),X.drawImage(we._canvas,0,0,we.width/ye,we.height/ye)}else{if(X._applyLineJoin(this),!se){var le=this.getAbsoluteTransform(L).getMatrix();X.transform(le[0],le[1],le[2],le[3],le[4],le[5]),X._applyOpacity(this),X._applyGlobalCompositeOperation(this)}F&&X._applyShadow(this),H.call(this,X,this)}return X.restore(),this}drawHit(M,L,W=!1){if(!this.shouldDrawHit(L,W))return this;var B=this.getLayer(),K=M||B.hitCanvas,X=K&&K.getContext(),Q=this.hitFunc()||this.sceneFunc(),H=this._getCanvasCache(),F=H&&H.hit;if(this.colorKey||n.Util.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),F){X.save();var Y=this.getAbsoluteTransform(L).getMatrix();return X.transform(Y[0],Y[1],Y[2],Y[3],Y[4],Y[5]),this._drawCachedHitCanvas(X),X.restore(),this}if(!Q)return this;if(X.save(),X._applyLineJoin(this),this!==L){var Z=this.getAbsoluteTransform(L).getMatrix();X.transform(Z[0],Z[1],Z[2],Z[3],Z[4],Z[5])}return Q.call(this,X,this),X.restore(),this}drawHitFromCache(M=0){var L=this._getCanvasCache(),W=this._getCachedSceneCanvas(),B=L.hit,K=B.getContext(),X=B.getWidth(),Q=B.getHeight(),H,F,Y,Z,ne,se;K.clear(),K.drawImage(W._canvas,0,0,X,Q);try{for(H=K.getImageData(0,0,X,Q),F=H.data,Y=F.length,Z=n.Util._hexToRgb(this.colorKey),ne=0;ne<Y;ne+=4)se=F[ne+3],se>M?(F[ne]=Z.r,F[ne+1]=Z.g,F[ne+2]=Z.b,F[ne+3]=255):F[ne+3]=0;K.putImageData(H,0,0)}catch(ce){n.Util.error("Unable to draw hit graph from cached scene canvas. "+ce.message)}return this}hasPointerCapture(M){return s.hasPointerCapture(M,this)}setPointerCapture(M){s.setPointerCapture(M,this)}releaseCapture(M){s.releaseCapture(M,this)}}t.Shape=E,E.prototype._fillFunc=y,E.prototype._strokeFunc=x,E.prototype._fillFuncHit=b,E.prototype._strokeFuncHit=v,E.prototype._centroid=!1,E.prototype.nodeType="Shape",(0,o._registerNode)(E),E.prototype.eventListeners={},E.prototype.on.call(E.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",w),E.prototype.on.call(E.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",S),E.prototype.on.call(E.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",C),E.prototype.on.call(E.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",I),E.prototype.on.call(E.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",_),r.Factory.addGetterSetter(E,"stroke",void 0,(0,i.getStringOrGradientValidator)()),r.Factory.addGetterSetter(E,"strokeWidth",2,(0,i.getNumberValidator)()),r.Factory.addGetterSetter(E,"fillAfterStrokeEnabled",!1),r.Factory.addGetterSetter(E,"hitStrokeWidth","auto",(0,i.getNumberOrAutoValidator)()),r.Factory.addGetterSetter(E,"strokeHitEnabled",!0,(0,i.getBooleanValidator)()),r.Factory.addGetterSetter(E,"perfectDrawEnabled",!0,(0,i.getBooleanValidator)()),r.Factory.addGetterSetter(E,"shadowForStrokeEnabled",!0,(0,i.getBooleanValidator)()),r.Factory.addGetterSetter(E,"lineJoin"),r.Factory.addGetterSetter(E,"lineCap"),r.Factory.addGetterSetter(E,"sceneFunc"),r.Factory.addGetterSetter(E,"hitFunc"),r.Factory.addGetterSetter(E,"dash"),r.Factory.addGetterSetter(E,"dashOffset",0,(0,i.getNumberValidator)()),r.Factory.addGetterSetter(E,"shadowColor",void 0,(0,i.getStringValidator)()),r.Factory.addGetterSetter(E,"shadowBlur",0,(0,i.getNumberValidator)()),r.Factory.addGetterSetter(E,"shadowOpacity",1,(0,i.getNumberValidator)()),r.Factory.addComponentsGetterSetter(E,"shadowOffset",["x","y"]),r.Factory.addGetterSetter(E,"shadowOffsetX",0,(0,i.getNumberValidator)()),r.Factory.addGetterSetter(E,"shadowOffsetY",0,(0,i.getNumberValidator)()),r.Factory.addGetterSetter(E,"fillPatternImage"),r.Factory.addGetterSetter(E,"fill",void 0,(0,i.getStringOrGradientValidator)()),r.Factory.addGetterSetter(E,"fillPatternX",0,(0,i.getNumberValidator)()),r.Factory.addGetterSetter(E,"fillPatternY",0,(0,i.getNumberValidator)()),r.Factory.addGetterSetter(E,"fillLinearGradientColorStops"),r.Factory.addGetterSetter(E,"strokeLinearGradientColorStops"),r.Factory.addGetterSetter(E,"fillRadialGradientStartRadius",0),r.Factory.addGetterSetter(E,"fillRadialGradientEndRadius",0),r.Factory.addGetterSetter(E,"fillRadialGradientColorStops"),r.Factory.addGetterSetter(E,"fillPatternRepeat","repeat"),r.Factory.addGetterSetter(E,"fillEnabled",!0),r.Factory.addGetterSetter(E,"strokeEnabled",!0),r.Factory.addGetterSetter(E,"shadowEnabled",!0),r.Factory.addGetterSetter(E,"dashEnabled",!0),r.Factory.addGetterSetter(E,"strokeScaleEnabled",!0),r.Factory.addGetterSetter(E,"fillPriority","color"),r.Factory.addComponentsGetterSetter(E,"fillPatternOffset",["x","y"]),r.Factory.addGetterSetter(E,"fillPatternOffsetX",0,(0,i.getNumberValidator)()),r.Factory.addGetterSetter(E,"fillPatternOffsetY",0,(0,i.getNumberValidator)()),r.Factory.addComponentsGetterSetter(E,"fillPatternScale",["x","y"]),r.Factory.addGetterSetter(E,"fillPatternScaleX",1,(0,i.getNumberValidator)()),r.Factory.addGetterSetter(E,"fillPatternScaleY",1,(0,i.getNumberValidator)()),r.Factory.addComponentsGetterSetter(E,"fillLinearGradientStartPoint",["x","y"]),r.Factory.addComponentsGetterSetter(E,"strokeLinearGradientStartPoint",["x","y"]),r.Factory.addGetterSetter(E,"fillLinearGradientStartPointX",0),r.Factory.addGetterSetter(E,"strokeLinearGradientStartPointX",0),r.Factory.addGetterSetter(E,"fillLinearGradientStartPointY",0),r.Factory.addGetterSetter(E,"strokeLinearGradientStartPointY",0),r.Factory.addComponentsGetterSetter(E,"fillLinearGradientEndPoint",["x","y"]),r.Factory.addComponentsGetterSetter(E,"strokeLinearGradientEndPoint",["x","y"]),r.Factory.addGetterSetter(E,"fillLinearGradientEndPointX",0),r.Factory.addGetterSetter(E,"strokeLinearGradientEndPointX",0),r.Factory.addGetterSetter(E,"fillLinearGradientEndPointY",0),r.Factory.addGetterSetter(E,"strokeLinearGradientEndPointY",0),r.Factory.addComponentsGetterSetter(E,"fillRadialGradientStartPoint",["x","y"]),r.Factory.addGetterSetter(E,"fillRadialGradientStartPointX",0),r.Factory.addGetterSetter(E,"fillRadialGradientStartPointY",0),r.Factory.addComponentsGetterSetter(E,"fillRadialGradientEndPoint",["x","y"]),r.Factory.addGetterSetter(E,"fillRadialGradientEndPointX",0),r.Factory.addGetterSetter(E,"fillRadialGradientEndPointY",0),r.Factory.addGetterSetter(E,"fillPatternRotation",0),r.Factory.addGetterSetter(E,"fillRule",void 0,(0,i.getStringValidator)()),r.Factory.backCompat(E,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"})})(ur),Object.defineProperty(sf,"__esModule",{value:!0}),sf.Layer=void 0;const gs=Ln,QN=Ou,Nd=Tn,ZN=kt,h6=to,wZ=Ge,kZ=ur,SZ=wt;var CZ="#",NZ="beforeDraw",TZ="draw",f6=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],IZ=f6.length;let Td=class extends QN.Container{constructor(t){super(t),this.canvas=new h6.SceneCanvas,this.hitCanvas=new h6.HitCanvas({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(t){return this.getContext().clear(t),this.getHitCanvas().getContext().clear(t),this}setZIndex(t){super.setZIndex(t);var e=this.getStage();return e&&e.content&&(e.content.removeChild(this.getNativeCanvasElement()),t<e.children.length-1?e.content.insertBefore(this.getNativeCanvasElement(),e.children[t+1].getCanvas()._canvas):e.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){Nd.Node.prototype.moveToTop.call(this);var t=this.getStage();return t&&t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){var t=Nd.Node.prototype.moveUp.call(this);if(!t)return!1;var e=this.getStage();return!e||!e.content?!1:(e.content.removeChild(this.getNativeCanvasElement()),this.index<e.children.length-1?e.content.insertBefore(this.getNativeCanvasElement(),e.children[this.index+1].getCanvas()._canvas):e.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(Nd.Node.prototype.moveDown.call(this)){var t=this.getStage();if(t){var e=t.children;t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.insertBefore(this.getNativeCanvasElement(),e[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(Nd.Node.prototype.moveToBottom.call(this)){var t=this.getStage();if(t){var e=t.children;t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.insertBefore(this.getNativeCanvasElement(),e[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){var t=this.getNativeCanvasElement();return Nd.Node.prototype.remove.call(this),t&&t.parentNode&&gs.Util._isInDocument(t)&&t.parentNode.removeChild(t),this}getStage(){return this.parent}setSize({width:t,height:e}){return this.canvas.setSize(t,e),this.hitCanvas.setSize(t,e),this._setSmoothEnabled(),this}_validateAdd(t){var e=t.getType();e!=="Group"&&e!=="Shape"&&gs.Util.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(t){return t=t||{},t.width=t.width||this.getWidth(),t.height=t.height||this.getHeight(),t.x=t.x!==void 0?t.x:this.x(),t.y=t.y!==void 0?t.y:this.y(),Nd.Node.prototype._toKonvaCanvas.call(this,t)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){gs.Util.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){gs.Util.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,gs.Util.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(t){if(!this.isListening()||!this.isVisible())return null;for(var e=1,n=!1;;){for(let r=0;r<IZ;r++){const a=f6[r],i=this._getIntersection({x:t.x+a.x*e,y:t.y+a.y*e}),o=i.shape;if(o)return o;if(n=!!i.antialiased,!i.antialiased)break}if(n)e+=1;else return null}}_getIntersection(t){const e=this.hitCanvas.pixelRatio,n=this.hitCanvas.context.getImageData(Math.round(t.x*e),Math.round(t.y*e),1,1).data,r=n[3];if(r===255){const a=gs.Util._rgbToHex(n[0],n[1],n[2]),i=kZ.shapes[CZ+a];return i?{shape:i}:{antialiased:!0}}else if(r>0)return{antialiased:!0};return{}}drawScene(t,e){var n=this.getLayer(),r=t||n&&n.getCanvas();return this._fire(NZ,{node:this}),this.clearBeforeDraw()&&r.getContext().clear(),QN.Container.prototype.drawScene.call(this,r,e),this._fire(TZ,{node:this}),this}drawHit(t,e){var n=this.getLayer(),r=t||n&&n.hitCanvas;return n&&n.clearBeforeDraw()&&n.getHitCanvas().getContext().clear(),QN.Container.prototype.drawHit.call(this,r,e),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(t){gs.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(t)}getHitGraphEnabled(t){return gs.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!(!this.parent||!this.parent.content)){var t=this.parent,e=!!this.hitCanvas._canvas.parentNode;e?t.content.removeChild(this.hitCanvas._canvas):t.content.appendChild(this.hitCanvas._canvas)}}destroy(){return gs.Util.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}};sf.Layer=Td,Td.prototype.nodeType="Layer",(0,SZ._registerNode)(Td),ZN.Factory.addGetterSetter(Td,"imageSmoothingEnabled",!0),ZN.Factory.addGetterSetter(Td,"clearBeforeDraw",!0),ZN.Factory.addGetterSetter(Td,"hitGraphEnabled",!0,(0,wZ.getBooleanValidator)());var xy={};Object.defineProperty(xy,"__esModule",{value:!0}),xy.FastLayer=void 0;const EZ=Ln,_Z=sf,OZ=wt;class JN extends _Z.Layer{constructor(e){super(e),this.listening(!1),EZ.Util.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}}xy.FastLayer=JN,JN.prototype.nodeType="FastLayer",(0,OZ._registerNode)(JN);var Id={};Object.defineProperty(Id,"__esModule",{value:!0}),Id.Group=void 0;const $Z=Ln,RZ=Ou,MZ=wt;class e3 extends RZ.Container{_validateAdd(e){var n=e.getType();n!=="Group"&&n!=="Shape"&&$Z.Util.throw("You may only add groups and shapes to groups.")}}Id.Group=e3,e3.prototype.nodeType="Group",(0,MZ._registerNode)(e3);var Ed={};Object.defineProperty(Ed,"__esModule",{value:!0}),Ed.Animation=void 0;const t3=wt,m6=Ln,n3=function(){return t3.glob.performance&&t3.glob.performance.now?function(){return t3.glob.performance.now()}:function(){return new Date().getTime()}}();class jo{constructor(e,n){this.id=jo.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:n3(),frameRate:0},this.func=e,this.setLayers(n)}setLayers(e){let n=[];return e&&(n=Array.isArray(e)?e:[e]),this.layers=n,this}getLayers(){return this.layers}addLayer(e){const n=this.layers,r=n.length;for(let a=0;a<r;a++)if(n[a]._id===e._id)return!1;return this.layers.push(e),!0}isRunning(){const e=jo.animations,n=e.length;for(let r=0;r<n;r++)if(e[r].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=n3(),jo._addAnimation(this),this}stop(){return jo._removeAnimation(this),this}_updateFrameObject(e){this.frame.timeDiff=e-this.frame.lastTime,this.frame.lastTime=e,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(e){this.animations.push(e),this._handleAnimation()}static _removeAnimation(e){const n=e.id,r=this.animations,a=r.length;for(let i=0;i<a;i++)if(r[i].id===n){this.animations.splice(i,1);break}}static _runFrames(){const e={},n=this.animations;for(let r=0;r<n.length;r++){const a=n[r],i=a.layers,o=a.func;a._updateFrameObject(n3());const s=i.length;let l;if(o?l=o.call(a,a.frame)!==!1:l=!0,!!l)for(let u=0;u<s;u++){const c=i[u];c._id!==void 0&&(e[c._id]=c)}}for(let r in e)e.hasOwnProperty(r)&&e[r].batchDraw()}static _animationLoop(){const e=jo;e.animations.length?(e._runFrames(),m6.Util.requestAnimFrame(e._animationLoop)):e.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,m6.Util.requestAnimFrame(this._animationLoop))}}Ed.Animation=jo,jo.animations=[],jo.animIdCounter=0,jo.animRunning=!1;var g6={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Easings=t.Tween=void 0;const e=Ln,n=Ed,r=Tn,a=wt;var i={node:1,duration:1,easing:1,onFinish:1,yoyo:1},o=1,s=2,l=3,u=0,c=["fill","stroke","shadowColor"];class d{constructor(g,y,x,b,v,w,S){this.prop=g,this.propFunc=y,this.begin=b,this._pos=b,this.duration=w,this._change=0,this.prevPos=0,this.yoyo=S,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=x,this._change=v-this.begin,this.pause()}fire(g){var y=this[g];y&&y()}setTime(g){g>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():g<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=g,this.update())}getTime(){return this._time}setPosition(g){this.prevPos=this._pos,this.propFunc(g),this._pos=g}getPosition(g){return g===void 0&&(g=this._time),this.func(g,this.begin,this._change,this.duration)}play(){this.state=s,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=l,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(g){this.pause(),this._time=g,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){var g=this.getTimer()-this._startTime;this.state===s?this.setTime(g):this.state===l&&this.setTime(this.duration-g)}pause(){this.state=o,this.fire("onPause")}getTimer(){return new Date().getTime()}}class p{constructor(g){var y=this,x=g.node,b=x._id,v,w=g.easing||t.Easings.Linear,S=!!g.yoyo,C;typeof g.duration>"u"?v=.3:g.duration===0?v=.001:v=g.duration,this.node=x,this._id=u++;var I=x.getLayer()||(x instanceof a.Konva.Stage?x.getLayers():null);I||e.Util.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new n.Animation(function(){y.tween.onEnterFrame()},I),this.tween=new d(C,function(_){y._tweenFunc(_)},w,0,1,v*1e3,S),this._addListeners(),p.attrs[b]||(p.attrs[b]={}),p.attrs[b][this._id]||(p.attrs[b][this._id]={}),p.tweens[b]||(p.tweens[b]={});for(C in g)i[C]===void 0&&this._addAttr(C,g[C]);this.reset(),this.onFinish=g.onFinish,this.onReset=g.onReset,this.onUpdate=g.onUpdate}_addAttr(g,y){var x=this.node,b=x._id,v,w,S,C,I,_,E,A;if(S=p.tweens[b][g],S&&delete p.attrs[b][S][g],v=x.getAttr(g),e.Util._isArray(y))if(w=[],I=Math.max(y.length,v.length),g==="points"&&y.length!==v.length&&(y.length>v.length?(E=v,v=e.Util._prepareArrayForTween(v,y,x.closed())):(_=y,y=e.Util._prepareArrayForTween(y,v,x.closed()))),g.indexOf("fill")===0)for(C=0;C<I;C++)if(C%2===0)w.push(y[C]-v[C]);else{var M=e.Util.colorToRGBA(v[C]);A=e.Util.colorToRGBA(y[C]),v[C]=M,w.push({r:A.r-M.r,g:A.g-M.g,b:A.b-M.b,a:A.a-M.a})}else for(C=0;C<I;C++)w.push(y[C]-v[C]);else c.indexOf(g)!==-1?(v=e.Util.colorToRGBA(v),A=e.Util.colorToRGBA(y),w={r:A.r-v.r,g:A.g-v.g,b:A.b-v.b,a:A.a-v.a}):w=y-v;p.attrs[b][this._id][g]={start:v,diff:w,end:y,trueEnd:_,trueStart:E},p.tweens[b][g]=this._id}_tweenFunc(g){var y=this.node,x=p.attrs[y._id][this._id],b,v,w,S,C,I,_,E;for(b in x){if(v=x[b],w=v.start,S=v.diff,E=v.end,e.Util._isArray(w))if(C=[],_=Math.max(w.length,E.length),b.indexOf("fill")===0)for(I=0;I<_;I++)I%2===0?C.push((w[I]||0)+S[I]*g):C.push("rgba("+Math.round(w[I].r+S[I].r*g)+","+Math.round(w[I].g+S[I].g*g)+","+Math.round(w[I].b+S[I].b*g)+","+(w[I].a+S[I].a*g)+")");else for(I=0;I<_;I++)C.push((w[I]||0)+S[I]*g);else c.indexOf(b)!==-1?C="rgba("+Math.round(w.r+S.r*g)+","+Math.round(w.g+S.g*g)+","+Math.round(w.b+S.b*g)+","+(w.a+S.a*g)+")":C=w+S*g;y.setAttr(b,C)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{var g=this.node,y=p.attrs[g._id][this._id];y.points&&y.points.trueEnd&&g.setAttr("points",y.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{var g=this.node,y=p.attrs[g._id][this._id];y.points&&y.points.trueStart&&g.points(y.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(g){return this.tween.seek(g*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){var g=this.node._id,y=this._id,x=p.tweens[g],b;this.pause();for(b in x)delete p.tweens[g][b];delete p.attrs[g][y]}}t.Tween=p,p.attrs={},p.tweens={},r.Node.prototype.to=function(f){var g=f.onFinish;f.node=this,f.onFinish=function(){this.destroy(),g&&g()};var y=new p(f);y.play()},t.Easings={BackEaseIn(f,g,y,x){var b=1.70158;return y*(f/=x)*f*((b+1)*f-b)+g},BackEaseOut(f,g,y,x){var b=1.70158;return y*((f=f/x-1)*f*((b+1)*f+b)+1)+g},BackEaseInOut(f,g,y,x){var b=1.70158;return(f/=x/2)<1?y/2*(f*f*(((b*=1.525)+1)*f-b))+g:y/2*((f-=2)*f*(((b*=1.525)+1)*f+b)+2)+g},ElasticEaseIn(f,g,y,x,b,v){var w=0;return f===0?g:(f/=x)===1?g+y:(v||(v=x*.3),!b||b<Math.abs(y)?(b=y,w=v/4):w=v/(2*Math.PI)*Math.asin(y/b),-(b*Math.pow(2,10*(f-=1))*Math.sin((f*x-w)*(2*Math.PI)/v))+g)},ElasticEaseOut(f,g,y,x,b,v){var w=0;return f===0?g:(f/=x)===1?g+y:(v||(v=x*.3),!b||b<Math.abs(y)?(b=y,w=v/4):w=v/(2*Math.PI)*Math.asin(y/b),b*Math.pow(2,-10*f)*Math.sin((f*x-w)*(2*Math.PI)/v)+y+g)},ElasticEaseInOut(f,g,y,x,b,v){var w=0;return f===0?g:(f/=x/2)===2?g+y:(v||(v=x*(.3*1.5)),!b||b<Math.abs(y)?(b=y,w=v/4):w=v/(2*Math.PI)*Math.asin(y/b),f<1?-.5*(b*Math.pow(2,10*(f-=1))*Math.sin((f*x-w)*(2*Math.PI)/v))+g:b*Math.pow(2,-10*(f-=1))*Math.sin((f*x-w)*(2*Math.PI)/v)*.5+y+g)},BounceEaseOut(f,g,y,x){return(f/=x)<1/2.75?y*(7.5625*f*f)+g:f<2/2.75?y*(7.5625*(f-=1.5/2.75)*f+.75)+g:f<2.5/2.75?y*(7.5625*(f-=2.25/2.75)*f+.9375)+g:y*(7.5625*(f-=2.625/2.75)*f+.984375)+g},BounceEaseIn(f,g,y,x){return y-t.Easings.BounceEaseOut(x-f,0,y,x)+g},BounceEaseInOut(f,g,y,x){return f<x/2?t.Easings.BounceEaseIn(f*2,0,y,x)*.5+g:t.Easings.BounceEaseOut(f*2-x,0,y,x)*.5+y*.5+g},EaseIn(f,g,y,x){return y*(f/=x)*f+g},EaseOut(f,g,y,x){return-y*(f/=x)*(f-2)+g},EaseInOut(f,g,y,x){return(f/=x/2)<1?y/2*f*f+g:-y/2*(--f*(f-2)-1)+g},StrongEaseIn(f,g,y,x){return y*(f/=x)*f*f*f*f+g},StrongEaseOut(f,g,y,x){return y*((f=f/x-1)*f*f*f*f+1)+g},StrongEaseInOut(f,g,y,x){return(f/=x/2)<1?y/2*f*f*f*f*f+g:y/2*((f-=2)*f*f*f*f+2)+g},Linear(f,g,y,x){return y*f/x+g}}})(g6),function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Konva=void 0;const e=wt,n=Ln,r=Tn,a=Ou,i=c6,o=sf,s=xy,l=Id,u=my,c=ur,d=Ed,p=g6,f=fs,g=to;t.Konva=n.Util._assign(e.Konva,{Util:n.Util,Transform:n.Transform,Node:r.Node,Container:a.Container,Stage:i.Stage,stages:i.stages,Layer:o.Layer,FastLayer:s.FastLayer,Group:l.Group,DD:u.DD,Shape:c.Shape,shapes:c.shapes,Animation:d.Animation,Tween:p.Tween,Easings:p.Easings,Context:f.Context,Canvas:g.Canvas}),t.default=t.Konva}(cy);var wy={};Object.defineProperty(wy,"__esModule",{value:!0}),wy.Arc=void 0;const ky=kt,AZ=ur,y6=wt,Sy=Ge,PZ=wt;class ys extends AZ.Shape{_sceneFunc(e){var n=y6.Konva.getAngle(this.angle()),r=this.clockwise();e.beginPath(),e.arc(0,0,this.outerRadius(),0,n,r),e.arc(0,0,this.innerRadius(),n,0,!r),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}getSelfRect(){const e=this.innerRadius(),n=this.outerRadius(),r=this.clockwise(),a=y6.Konva.getAngle(r?360-this.angle():this.angle()),i=Math.cos(Math.min(a,Math.PI)),o=1,s=Math.sin(Math.min(Math.max(Math.PI,a),3*Math.PI/2)),l=Math.sin(Math.min(a,Math.PI/2)),u=i*(i>0?e:n),c=o*n,d=s*(s>0?e:n),p=l*(l>0?n:e);return{x:u,y:r?-1*p:d,width:c-u,height:p-d}}}wy.Arc=ys,ys.prototype._centroid=!0,ys.prototype.className="Arc",ys.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,PZ._registerNode)(ys),ky.Factory.addGetterSetter(ys,"innerRadius",0,(0,Sy.getNumberValidator)()),ky.Factory.addGetterSetter(ys,"outerRadius",0,(0,Sy.getNumberValidator)()),ky.Factory.addGetterSetter(ys,"angle",0,(0,Sy.getNumberValidator)()),ky.Factory.addGetterSetter(ys,"clockwise",!1,(0,Sy.getBooleanValidator)());var Cy={},lf={};Object.defineProperty(lf,"__esModule",{value:!0}),lf.Line=void 0;const Ny=kt,DZ=ur,b6=Ge,LZ=wt;function r3(t,e,n,r,a,i,o){var s=Math.sqrt(Math.pow(n-t,2)+Math.pow(r-e,2)),l=Math.sqrt(Math.pow(a-n,2)+Math.pow(i-r,2)),u=o*s/(s+l),c=o*l/(s+l),d=n-u*(a-t),p=r-u*(i-e),f=n+c*(a-t),g=r+c*(i-e);return[d,p,f,g]}function v6(t,e){var n=t.length,r=[],a,i;for(a=2;a<n-2;a+=2)i=r3(t[a-2],t[a-1],t[a],t[a+1],t[a+2],t[a+3],e),!isNaN(i[0])&&(r.push(i[0]),r.push(i[1]),r.push(t[a]),r.push(t[a+1]),r.push(i[2]),r.push(i[3]));return r}class kl extends DZ.Shape{constructor(e){super(e),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(e){var n=this.points(),r=n.length,a=this.tension(),i=this.closed(),o=this.bezier(),s,l,u;if(r){if(e.beginPath(),e.moveTo(n[0],n[1]),a!==0&&r>4){for(s=this.getTensionPoints(),l=s.length,u=i?0:4,i||e.quadraticCurveTo(s[0],s[1],s[2],s[3]);u<l-2;)e.bezierCurveTo(s[u++],s[u++],s[u++],s[u++],s[u++],s[u++]);i||e.quadraticCurveTo(s[l-2],s[l-1],n[r-2],n[r-1])}else if(o)for(u=2;u<r;)e.bezierCurveTo(n[u++],n[u++],n[u++],n[u++],n[u++],n[u++]);else for(u=2;u<r;u+=2)e.lineTo(n[u],n[u+1]);i?(e.closePath(),e.fillStrokeShape(this)):e.strokeShape(this)}}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():v6(this.points(),this.tension())}_getTensionPointsClosed(){var e=this.points(),n=e.length,r=this.tension(),a=r3(e[n-2],e[n-1],e[0],e[1],e[2],e[3],r),i=r3(e[n-4],e[n-3],e[n-2],e[n-1],e[0],e[1],r),o=v6(e,r),s=[a[2],a[3]].concat(o).concat([i[0],i[1],e[n-2],e[n-1],i[2],i[3],a[0],a[1],e[0],e[1]]);return s}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){var e=this.points();if(e.length<4)return{x:e[0]||0,y:e[1]||0,width:0,height:0};this.tension()!==0?e=[e[0],e[1],...this._getTensionPoints(),e[e.length-2],e[e.length-1]]:e=this.points();for(var n=e[0],r=e[0],a=e[1],i=e[1],o,s,l=0;l<e.length/2;l++)o=e[l*2],s=e[l*2+1],n=Math.min(n,o),r=Math.max(r,o),a=Math.min(a,s),i=Math.max(i,s);return{x:n,y:a,width:r-n,height:i-a}}}lf.Line=kl,kl.prototype.className="Line",kl.prototype._attrsAffectingSize=["points","bezier","tension"],(0,LZ._registerNode)(kl),Ny.Factory.addGetterSetter(kl,"closed",!1),Ny.Factory.addGetterSetter(kl,"bezier",!1),Ny.Factory.addGetterSetter(kl,"tension",0,(0,b6.getNumberValidator)()),Ny.Factory.addGetterSetter(kl,"points",[],(0,b6.getNumberArrayValidator)());var _d={},x6={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.t2length=t.getQuadraticArcLength=t.getCubicArcLength=t.binomialCoefficients=t.cValues=t.tValues=void 0,t.tValues=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],t.cValues=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],t.binomialCoefficients=[[1],[1,1],[1,2,1],[1,3,3,1]];const e=(o,s,l)=>{let u,c,d;u=l/2,c=0;for(let p=0;p<20;p++)d=u*t.tValues[20][p]+u,c+=t.cValues[20][p]*r(o,s,d);return u*c};t.getCubicArcLength=e;const n=(o,s,l)=>{l===void 0&&(l=1);const u=o[0]-2*o[1]+o[2],c=s[0]-2*s[1]+s[2],d=2*o[1]-2*o[0],p=2*s[1]-2*s[0],f=4*(u*u+c*c),g=4*(u*d+c*p),y=d*d+p*p;if(f===0)return l*Math.sqrt(Math.pow(o[2]-o[0],2)+Math.pow(s[2]-s[0],2));const x=g/(2*f),b=y/f,v=l+x,w=b-x*x,S=v*v+w>0?Math.sqrt(v*v+w):0,C=x*x+w>0?Math.sqrt(x*x+w):0,I=x+Math.sqrt(x*x+w)!==0?w*Math.log(Math.abs((v+S)/(x+C))):0;return Math.sqrt(f)/2*(v*S-x*C+I)};t.getQuadraticArcLength=n;function r(o,s,l){const u=a(1,l,o),c=a(1,l,s),d=u*u+c*c;return Math.sqrt(d)}const a=(o,s,l)=>{const u=l.length-1;let c,d;if(u===0)return 0;if(o===0){d=0;for(let p=0;p<=u;p++)d+=t.binomialCoefficients[u][p]*Math.pow(1-s,u-p)*Math.pow(s,p)*l[p];return d}else{c=new Array(u);for(let p=0;p<u;p++)c[p]=u*(l[p+1]-l[p]);return a(o-1,s,c)}},i=(o,s,l)=>{let u=1,c=o/s,d=(o-l(c))/s,p=0;for(;u>.001;){const f=l(c+d),g=Math.abs(o-f)/s;if(g<u)u=g,c+=d;else{const y=l(c-d),x=Math.abs(o-y)/s;x<u?(u=x,c-=d):d/=2}if(p++,p>500)break}return c};t.t2length=i})(x6),Object.defineProperty(_d,"__esModule",{value:!0}),_d.Path=void 0;const FZ=kt,BZ=ur,zZ=wt,Od=x6;class mr extends BZ.Shape{constructor(e){super(e),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=mr.parsePathData(this.data()),this.pathLength=mr.getPathLength(this.dataArray)}_sceneFunc(e){var n=this.dataArray;e.beginPath();for(var r=!1,a=0;a<n.length;a++){var i=n[a].command,o=n[a].points;switch(i){case"L":e.lineTo(o[0],o[1]);break;case"M":e.moveTo(o[0],o[1]);break;case"C":e.bezierCurveTo(o[0],o[1],o[2],o[3],o[4],o[5]);break;case"Q":e.quadraticCurveTo(o[0],o[1],o[2],o[3]);break;case"A":var s=o[0],l=o[1],u=o[2],c=o[3],d=o[4],p=o[5],f=o[6],g=o[7],y=u>c?u:c,x=u>c?1:u/c,b=u>c?c/u:1;e.translate(s,l),e.rotate(f),e.scale(x,b),e.arc(0,0,y,d,d+p,1-g),e.scale(1/x,1/b),e.rotate(-f),e.translate(-s,-l);break;case"z":r=!0,e.closePath();break}}!r&&!this.hasFill()?e.strokeShape(this):e.fillStrokeShape(this)}getSelfRect(){var e=[];this.dataArray.forEach(function(u){if(u.command==="A"){var c=u.points[4],d=u.points[5],p=u.points[4]+d,f=Math.PI/180;if(Math.abs(c-p)<f&&(f=Math.abs(c-p)),d<0)for(let g=c-f;g>p;g-=f){const y=mr.getPointOnEllipticalArc(u.points[0],u.points[1],u.points[2],u.points[3],g,0);e.push(y.x,y.y)}else for(let g=c+f;g<p;g+=f){const y=mr.getPointOnEllipticalArc(u.points[0],u.points[1],u.points[2],u.points[3],g,0);e.push(y.x,y.y)}}else if(u.command==="C")for(let g=0;g<=1;g+=.01){const y=mr.getPointOnCubicBezier(g,u.start.x,u.start.y,u.points[0],u.points[1],u.points[2],u.points[3],u.points[4],u.points[5]);e.push(y.x,y.y)}else e=e.concat(u.points)});for(var n=e[0],r=e[0],a=e[1],i=e[1],o,s,l=0;l<e.length/2;l++)o=e[l*2],s=e[l*2+1],isNaN(o)||(n=Math.min(n,o),r=Math.max(r,o)),isNaN(s)||(a=Math.min(a,s),i=Math.max(i,s));return{x:n,y:a,width:r-n,height:i-a}}getLength(){return this.pathLength}getPointAtLength(e){return mr.getPointAtLengthOfDataArray(e,this.dataArray)}static getLineLength(e,n,r,a){return Math.sqrt((r-e)*(r-e)+(a-n)*(a-n))}static getPathLength(e){let n=0;for(var r=0;r<e.length;++r)n+=e[r].pathLength;return n}static getPointAtLengthOfDataArray(e,n){var r,a=0,i=n.length;if(!i)return null;for(;a<i&&e>n[a].pathLength;)e-=n[a].pathLength,++a;if(a===i)return r=n[a-1].points.slice(-2),{x:r[0],y:r[1]};if(e<.01)return r=n[a].points.slice(0,2),{x:r[0],y:r[1]};var o=n[a],s=o.points;switch(o.command){case"L":return mr.getPointOnLine(e,o.start.x,o.start.y,s[0],s[1]);case"C":return mr.getPointOnCubicBezier((0,Od.t2length)(e,mr.getPathLength(n),y=>(0,Od.getCubicArcLength)([o.start.x,s[0],s[2],s[4]],[o.start.y,s[1],s[3],s[5]],y)),o.start.x,o.start.y,s[0],s[1],s[2],s[3],s[4],s[5]);case"Q":return mr.getPointOnQuadraticBezier((0,Od.t2length)(e,mr.getPathLength(n),y=>(0,Od.getQuadraticArcLength)([o.start.x,s[0],s[2]],[o.start.y,s[1],s[3]],y)),o.start.x,o.start.y,s[0],s[1],s[2],s[3]);case"A":var l=s[0],u=s[1],c=s[2],d=s[3],p=s[4],f=s[5],g=s[6];return p+=f*e/o.pathLength,mr.getPointOnEllipticalArc(l,u,c,d,p,g)}return null}static getPointOnLine(e,n,r,a,i,o,s){o===void 0&&(o=n),s===void 0&&(s=r);var l=(i-r)/(a-n+1e-8),u=Math.sqrt(e*e/(1+l*l));a<n&&(u*=-1);var c=l*u,d;if(a===n)d={x:o,y:s+c};else if((s-r)/(o-n+1e-8)===l)d={x:o+u,y:s+c};else{var p,f,g=this.getLineLength(n,r,a,i),y=(o-n)*(a-n)+(s-r)*(i-r);y=y/(g*g),p=n+y*(a-n),f=r+y*(i-r);var x=this.getLineLength(o,s,p,f),b=Math.sqrt(e*e-x*x);u=Math.sqrt(b*b/(1+l*l)),a<n&&(u*=-1),c=l*u,d={x:p+u,y:f+c}}return d}static getPointOnCubicBezier(e,n,r,a,i,o,s,l,u){function c(x){return x*x*x}function d(x){return 3*x*x*(1-x)}function p(x){return 3*x*(1-x)*(1-x)}function f(x){return(1-x)*(1-x)*(1-x)}var g=l*c(e)+o*d(e)+a*p(e)+n*f(e),y=u*c(e)+s*d(e)+i*p(e)+r*f(e);return{x:g,y}}static getPointOnQuadraticBezier(e,n,r,a,i,o,s){function l(f){return f*f}function u(f){return 2*f*(1-f)}function c(f){return(1-f)*(1-f)}var d=o*l(e)+a*u(e)+n*c(e),p=s*l(e)+i*u(e)+r*c(e);return{x:d,y:p}}static getPointOnEllipticalArc(e,n,r,a,i,o){var s=Math.cos(o),l=Math.sin(o),u={x:r*Math.cos(i),y:a*Math.sin(i)};return{x:e+(u.x*s-u.y*l),y:n+(u.x*l+u.y*s)}}static parsePathData(e){if(!e)return[];var n=e,r=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];n=n.replace(new RegExp(" ","g"),",");for(var a=0;a<r.length;a++)n=n.replace(new RegExp(r[a],"g"),"|"+r[a]);var i=n.split("|"),o=[],s=[],l=0,u=0,c=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi,d;for(a=1;a<i.length;a++){var p=i[a],f=p.charAt(0);for(p=p.slice(1),s.length=0;d=c.exec(p);)s.push(d[0]);for(var g=[],y=0,x=s.length;y<x;y++){if(s[y]==="00"){g.push(0,0);continue}var b=parseFloat(s[y]);isNaN(b)?g.push(0):g.push(b)}for(;g.length>0&&!isNaN(g[0]);){var v="",w=[],S=l,C=u,I,_,E,A,M,L,W,B,K,X;switch(f){case"l":l+=g.shift(),u+=g.shift(),v="L",w.push(l,u);break;case"L":l=g.shift(),u=g.shift(),w.push(l,u);break;case"m":var Q=g.shift(),H=g.shift();if(l+=Q,u+=H,v="M",o.length>2&&o[o.length-1].command==="z"){for(var F=o.length-2;F>=0;F--)if(o[F].command==="M"){l=o[F].points[0]+Q,u=o[F].points[1]+H;break}}w.push(l,u),f="l";break;case"M":l=g.shift(),u=g.shift(),v="M",w.push(l,u),f="L";break;case"h":l+=g.shift(),v="L",w.push(l,u);break;case"H":l=g.shift(),v="L",w.push(l,u);break;case"v":u+=g.shift(),v="L",w.push(l,u);break;case"V":u=g.shift(),v="L",w.push(l,u);break;case"C":w.push(g.shift(),g.shift(),g.shift(),g.shift()),l=g.shift(),u=g.shift(),w.push(l,u);break;case"c":w.push(l+g.shift(),u+g.shift(),l+g.shift(),u+g.shift()),l+=g.shift(),u+=g.shift(),v="C",w.push(l,u);break;case"S":_=l,E=u,I=o[o.length-1],I.command==="C"&&(_=l+(l-I.points[2]),E=u+(u-I.points[3])),w.push(_,E,g.shift(),g.shift()),l=g.shift(),u=g.shift(),v="C",w.push(l,u);break;case"s":_=l,E=u,I=o[o.length-1],I.command==="C"&&(_=l+(l-I.points[2]),E=u+(u-I.points[3])),w.push(_,E,l+g.shift(),u+g.shift()),l+=g.shift(),u+=g.shift(),v="C",w.push(l,u);break;case"Q":w.push(g.shift(),g.shift()),l=g.shift(),u=g.shift(),w.push(l,u);break;case"q":w.push(l+g.shift(),u+g.shift()),l+=g.shift(),u+=g.shift(),v="Q",w.push(l,u);break;case"T":_=l,E=u,I=o[o.length-1],I.command==="Q"&&(_=l+(l-I.points[0]),E=u+(u-I.points[1])),l=g.shift(),u=g.shift(),v="Q",w.push(_,E,l,u);break;case"t":_=l,E=u,I=o[o.length-1],I.command==="Q"&&(_=l+(l-I.points[0]),E=u+(u-I.points[1])),l+=g.shift(),u+=g.shift(),v="Q",w.push(_,E,l,u);break;case"A":A=g.shift(),M=g.shift(),L=g.shift(),W=g.shift(),B=g.shift(),K=l,X=u,l=g.shift(),u=g.shift(),v="A",w=this.convertEndpointToCenterParameterization(K,X,l,u,W,B,A,M,L);break;case"a":A=g.shift(),M=g.shift(),L=g.shift(),W=g.shift(),B=g.shift(),K=l,X=u,l+=g.shift(),u+=g.shift(),v="A",w=this.convertEndpointToCenterParameterization(K,X,l,u,W,B,A,M,L);break}o.push({command:v||f,points:w,start:{x:S,y:C},pathLength:this.calcLength(S,C,v||f,w)})}(f==="z"||f==="Z")&&o.push({command:"z",points:[],start:void 0,pathLength:0})}return o}static calcLength(e,n,r,a){var i,o,s,l,u=mr;switch(r){case"L":return u.getLineLength(e,n,a[0],a[1]);case"C":return(0,Od.getCubicArcLength)([e,a[0],a[2],a[4]],[n,a[1],a[3],a[5]],1);case"Q":return(0,Od.getQuadraticArcLength)([e,a[0],a[2]],[n,a[1],a[3]],1);case"A":i=0;var c=a[4],d=a[5],p=a[4]+d,f=Math.PI/180;if(Math.abs(c-p)<f&&(f=Math.abs(c-p)),o=u.getPointOnEllipticalArc(a[0],a[1],a[2],a[3],c,0),d<0)for(l=c-f;l>p;l-=f)s=u.getPointOnEllipticalArc(a[0],a[1],a[2],a[3],l,0),i+=u.getLineLength(o.x,o.y,s.x,s.y),o=s;else for(l=c+f;l<p;l+=f)s=u.getPointOnEllipticalArc(a[0],a[1],a[2],a[3],l,0),i+=u.getLineLength(o.x,o.y,s.x,s.y),o=s;return s=u.getPointOnEllipticalArc(a[0],a[1],a[2],a[3],p,0),i+=u.getLineLength(o.x,o.y,s.x,s.y),i}return 0}static convertEndpointToCenterParameterization(e,n,r,a,i,o,s,l,u){var c=u*(Math.PI/180),d=Math.cos(c)*(e-r)/2+Math.sin(c)*(n-a)/2,p=-1*Math.sin(c)*(e-r)/2+Math.cos(c)*(n-a)/2,f=d*d/(s*s)+p*p/(l*l);f>1&&(s*=Math.sqrt(f),l*=Math.sqrt(f));var g=Math.sqrt((s*s*(l*l)-s*s*(p*p)-l*l*(d*d))/(s*s*(p*p)+l*l*(d*d)));i===o&&(g*=-1),isNaN(g)&&(g=0);var y=g*s*p/l,x=g*-l*d/s,b=(e+r)/2+Math.cos(c)*y-Math.sin(c)*x,v=(n+a)/2+Math.sin(c)*y+Math.cos(c)*x,w=function(M){return Math.sqrt(M[0]*M[0]+M[1]*M[1])},S=function(M,L){return(M[0]*L[0]+M[1]*L[1])/(w(M)*w(L))},C=function(M,L){return(M[0]*L[1]<M[1]*L[0]?-1:1)*Math.acos(S(M,L))},I=C([1,0],[(d-y)/s,(p-x)/l]),_=[(d-y)/s,(p-x)/l],E=[(-1*d-y)/s,(-1*p-x)/l],A=C(_,E);return S(_,E)<=-1&&(A=Math.PI),S(_,E)>=1&&(A=0),o===0&&A>0&&(A=A-2*Math.PI),o===1&&A<0&&(A=A+2*Math.PI),[b,v,s,l,I,A,c,o]}}_d.Path=mr,mr.prototype.className="Path",mr.prototype._attrsAffectingSize=["data"],(0,zZ._registerNode)(mr),FZ.Factory.addGetterSetter(mr,"data"),Object.defineProperty(Cy,"__esModule",{value:!0}),Cy.Arrow=void 0;const Ty=kt,VZ=lf,w6=Ge,WZ=wt,k6=_d;class Ru extends VZ.Line{_sceneFunc(e){super._sceneFunc(e);var n=Math.PI*2,r=this.points(),a=r,i=this.tension()!==0&&r.length>4;i&&(a=this.getTensionPoints());var o=this.pointerLength(),s=r.length,l,u;if(i){const p=[a[a.length-4],a[a.length-3],a[a.length-2],a[a.length-1],r[s-2],r[s-1]],f=k6.Path.calcLength(a[a.length-4],a[a.length-3],"C",p),g=k6.Path.getPointOnQuadraticBezier(Math.min(1,1-o/f),p[0],p[1],p[2],p[3],p[4],p[5]);l=r[s-2]-g.x,u=r[s-1]-g.y}else l=r[s-2]-r[s-4],u=r[s-1]-r[s-3];var c=(Math.atan2(u,l)+n)%n,d=this.pointerWidth();this.pointerAtEnding()&&(e.save(),e.beginPath(),e.translate(r[s-2],r[s-1]),e.rotate(c),e.moveTo(0,0),e.lineTo(-o,d/2),e.lineTo(-o,-d/2),e.closePath(),e.restore(),this.__fillStroke(e)),this.pointerAtBeginning()&&(e.save(),e.beginPath(),e.translate(r[0],r[1]),i?(l=(a[0]+a[2])/2-r[0],u=(a[1]+a[3])/2-r[1]):(l=r[2]-r[0],u=r[3]-r[1]),e.rotate((Math.atan2(-u,-l)+n)%n),e.moveTo(0,0),e.lineTo(-o,d/2),e.lineTo(-o,-d/2),e.closePath(),e.restore(),this.__fillStroke(e))}__fillStroke(e){var n=this.dashEnabled();n&&(this.attrs.dashEnabled=!1,e.setLineDash([])),e.fillStrokeShape(this),n&&(this.attrs.dashEnabled=!0)}getSelfRect(){const e=super.getSelfRect(),n=this.pointerWidth()/2;return{x:e.x-n,y:e.y-n,width:e.width+n*2,height:e.height+n*2}}}Cy.Arrow=Ru,Ru.prototype.className="Arrow",(0,WZ._registerNode)(Ru),Ty.Factory.addGetterSetter(Ru,"pointerLength",10,(0,w6.getNumberValidator)()),Ty.Factory.addGetterSetter(Ru,"pointerWidth",10,(0,w6.getNumberValidator)()),Ty.Factory.addGetterSetter(Ru,"pointerAtBeginning",!1),Ty.Factory.addGetterSetter(Ru,"pointerAtEnding",!0);var Iy={};Object.defineProperty(Iy,"__esModule",{value:!0}),Iy.Circle=void 0;const jZ=kt,UZ=ur,GZ=Ge,HZ=wt;class $d extends UZ.Shape{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius()!==e/2&&this.radius(e/2)}setHeight(e){this.radius()!==e/2&&this.radius(e/2)}}Iy.Circle=$d,$d.prototype._centroid=!0,$d.prototype.className="Circle",$d.prototype._attrsAffectingSize=["radius"],(0,HZ._registerNode)($d),jZ.Factory.addGetterSetter($d,"radius",0,(0,GZ.getNumberValidator)());var Ey={};Object.defineProperty(Ey,"__esModule",{value:!0}),Ey.Ellipse=void 0;const a3=kt,qZ=ur,S6=Ge,KZ=wt;class Sl extends qZ.Shape{_sceneFunc(e){var n=this.radiusX(),r=this.radiusY();e.beginPath(),e.save(),n!==r&&e.scale(1,r/n),e.arc(0,0,n,0,Math.PI*2,!1),e.restore(),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(e){this.radiusX(e/2)}setHeight(e){this.radiusY(e/2)}}Ey.Ellipse=Sl,Sl.prototype.className="Ellipse",Sl.prototype._centroid=!0,Sl.prototype._attrsAffectingSize=["radiusX","radiusY"],(0,KZ._registerNode)(Sl),a3.Factory.addComponentsGetterSetter(Sl,"radius",["x","y"]),a3.Factory.addGetterSetter(Sl,"radiusX",0,(0,S6.getNumberValidator)()),a3.Factory.addGetterSetter(Sl,"radiusY",0,(0,S6.getNumberValidator)());var _y={};Object.defineProperty(_y,"__esModule",{value:!0}),_y.Image=void 0;const i3=Ln,Mu=kt,XZ=ur,YZ=wt,uf=Ge;let Eo=class Jz extends XZ.Shape{constructor(e){super(e),this.on("imageChange.konva",()=>{this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){const e=this.image();e&&e.complete||e&&e.readyState===4||e&&e.addEventListener&&e.addEventListener("load",()=>{this._requestDraw()})}_useBufferCanvas(){return super._useBufferCanvas(!0)}_sceneFunc(e){const n=this.getWidth(),r=this.getHeight(),a=this.cornerRadius(),i=this.attrs.image;let o;if(i){const s=this.attrs.cropWidth,l=this.attrs.cropHeight;s&&l?o=[i,this.cropX(),this.cropY(),s,l,0,0,n,r]:o=[i,0,0,n,r]}(this.hasFill()||this.hasStroke()||a)&&(e.beginPath(),a?i3.Util.drawRoundedRectPath(e,n,r,a):e.rect(0,0,n,r),e.closePath(),e.fillStrokeShape(this)),i&&(a&&e.clip(),e.drawImage.apply(e,o))}_hitFunc(e){var n=this.width(),r=this.height(),a=this.cornerRadius();e.beginPath(),a?i3.Util.drawRoundedRectPath(e,n,r,a):e.rect(0,0,n,r),e.closePath(),e.fillStrokeShape(this)}getWidth(){var e,n;return(e=this.attrs.width)!==null&&e!==void 0?e:(n=this.image())===null||n===void 0?void 0:n.width}getHeight(){var e,n;return(e=this.attrs.height)!==null&&e!==void 0?e:(n=this.image())===null||n===void 0?void 0:n.height}static fromURL(e,n,r=null){var a=i3.Util.createImageElement();a.onload=function(){var i=new Jz({image:a});n(i)},a.onerror=r,a.crossOrigin="Anonymous",a.src=e}};_y.Image=Eo,Eo.prototype.className="Image",(0,YZ._registerNode)(Eo),Mu.Factory.addGetterSetter(Eo,"cornerRadius",0,(0,uf.getNumberOrArrayOfNumbersValidator)(4)),Mu.Factory.addGetterSetter(Eo,"image"),Mu.Factory.addComponentsGetterSetter(Eo,"crop",["x","y","width","height"]),Mu.Factory.addGetterSetter(Eo,"cropX",0,(0,uf.getNumberValidator)()),Mu.Factory.addGetterSetter(Eo,"cropY",0,(0,uf.getNumberValidator)()),Mu.Factory.addGetterSetter(Eo,"cropWidth",0,(0,uf.getNumberValidator)()),Mu.Factory.addGetterSetter(Eo,"cropHeight",0,(0,uf.getNumberValidator)());var Rd={};Object.defineProperty(Rd,"__esModule",{value:!0}),Rd.Tag=Rd.Label=void 0;const Oy=kt,QZ=ur,ZZ=Id,o3=Ge,C6=wt;var N6=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],JZ="Change.konva",eJ="none",s3="up",l3="right",u3="down",c3="left",tJ=N6.length;class d3 extends ZZ.Group{constructor(e){super(e),this.on("add.konva",function(n){this._addListeners(n.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(e){var n=this,r,a=function(){n._sync()};for(r=0;r<tJ;r++)e.on(N6[r]+JZ,a)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){var e=this.getText(),n=this.getTag(),r,a,i,o,s,l,u;if(e&&n){switch(r=e.width(),a=e.height(),i=n.pointerDirection(),o=n.pointerWidth(),u=n.pointerHeight(),s=0,l=0,i){case s3:s=r/2,l=-1*u;break;case l3:s=r+o,l=a/2;break;case u3:s=r/2,l=a+u;break;case c3:s=-1*o,l=a/2;break}n.setAttrs({x:-1*s,y:-1*l,width:r,height:a}),e.setAttrs({x:-1*s,y:-1*l})}}}Rd.Label=d3,d3.prototype.className="Label",(0,C6._registerNode)(d3);class Au extends QZ.Shape{_sceneFunc(e){var n=this.width(),r=this.height(),a=this.pointerDirection(),i=this.pointerWidth(),o=this.pointerHeight(),s=this.cornerRadius();let l=0,u=0,c=0,d=0;typeof s=="number"?l=u=c=d=Math.min(s,n/2,r/2):(l=Math.min(s[0]||0,n/2,r/2),u=Math.min(s[1]||0,n/2,r/2),d=Math.min(s[2]||0,n/2,r/2),c=Math.min(s[3]||0,n/2,r/2)),e.beginPath(),e.moveTo(l,0),a===s3&&(e.lineTo((n-i)/2,0),e.lineTo(n/2,-1*o),e.lineTo((n+i)/2,0)),e.lineTo(n-u,0),e.arc(n-u,u,u,Math.PI*3/2,0,!1),a===l3&&(e.lineTo(n,(r-o)/2),e.lineTo(n+i,r/2),e.lineTo(n,(r+o)/2)),e.lineTo(n,r-d),e.arc(n-d,r-d,d,0,Math.PI/2,!1),a===u3&&(e.lineTo((n+i)/2,r),e.lineTo(n/2,r+o),e.lineTo((n-i)/2,r)),e.lineTo(c,r),e.arc(c,r-c,c,Math.PI/2,Math.PI,!1),a===c3&&(e.lineTo(0,(r+o)/2),e.lineTo(-1*i,r/2),e.lineTo(0,(r-o)/2)),e.lineTo(0,l),e.arc(l,l,l,Math.PI,Math.PI*3/2,!1),e.closePath(),e.fillStrokeShape(this)}getSelfRect(){var e=0,n=0,r=this.pointerWidth(),a=this.pointerHeight(),i=this.pointerDirection(),o=this.width(),s=this.height();return i===s3?(n-=a,s+=a):i===u3?s+=a:i===c3?(e-=r*1.5,o+=r):i===l3&&(o+=r*1.5),{x:e,y:n,width:o,height:s}}}Rd.Tag=Au,Au.prototype.className="Tag",(0,C6._registerNode)(Au),Oy.Factory.addGetterSetter(Au,"pointerDirection",eJ),Oy.Factory.addGetterSetter(Au,"pointerWidth",0,(0,o3.getNumberValidator)()),Oy.Factory.addGetterSetter(Au,"pointerHeight",0,(0,o3.getNumberValidator)()),Oy.Factory.addGetterSetter(Au,"cornerRadius",0,(0,o3.getNumberOrArrayOfNumbersValidator)(4));var cf={};Object.defineProperty(cf,"__esModule",{value:!0}),cf.Rect=void 0;const nJ=kt,rJ=ur,aJ=wt,iJ=Ln,oJ=Ge;class $y extends rJ.Shape{_sceneFunc(e){var n=this.cornerRadius(),r=this.width(),a=this.height();e.beginPath(),n?iJ.Util.drawRoundedRectPath(e,r,a,n):e.rect(0,0,r,a),e.closePath(),e.fillStrokeShape(this)}}cf.Rect=$y,$y.prototype.className="Rect",(0,aJ._registerNode)($y),nJ.Factory.addGetterSetter($y,"cornerRadius",0,(0,oJ.getNumberOrArrayOfNumbersValidator)(4));var Ry={};Object.defineProperty(Ry,"__esModule",{value:!0}),Ry.RegularPolygon=void 0;const T6=kt,sJ=ur,I6=Ge,lJ=wt;class Pu extends sJ.Shape{_sceneFunc(e){const n=this._getPoints();e.beginPath(),e.moveTo(n[0].x,n[0].y);for(var r=1;r<n.length;r++)e.lineTo(n[r].x,n[r].y);e.closePath(),e.fillStrokeShape(this)}_getPoints(){const e=this.attrs.sides,n=this.attrs.radius||0,r=[];for(var a=0;a<e;a++)r.push({x:n*Math.sin(a*2*Math.PI/e),y:-1*n*Math.cos(a*2*Math.PI/e)});return r}getSelfRect(){const e=this._getPoints();var n=e[0].x,r=e[0].y,a=e[0].x,i=e[0].y;return e.forEach(o=>{n=Math.min(n,o.x),r=Math.max(r,o.x),a=Math.min(a,o.y),i=Math.max(i,o.y)}),{x:n,y:a,width:r-n,height:i-a}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius(e/2)}setHeight(e){this.radius(e/2)}}Ry.RegularPolygon=Pu,Pu.prototype.className="RegularPolygon",Pu.prototype._centroid=!0,Pu.prototype._attrsAffectingSize=["radius"],(0,lJ._registerNode)(Pu),T6.Factory.addGetterSetter(Pu,"radius",0,(0,I6.getNumberValidator)()),T6.Factory.addGetterSetter(Pu,"sides",0,(0,I6.getNumberValidator)());var My={};Object.defineProperty(My,"__esModule",{value:!0}),My.Ring=void 0;const E6=kt,uJ=ur,_6=Ge,cJ=wt;var O6=Math.PI*2;class Du extends uJ.Shape{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.innerRadius(),0,O6,!1),e.moveTo(this.outerRadius(),0),e.arc(0,0,this.outerRadius(),O6,0,!0),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}}My.Ring=Du,Du.prototype.className="Ring",Du.prototype._centroid=!0,Du.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,cJ._registerNode)(Du),E6.Factory.addGetterSetter(Du,"innerRadius",0,(0,_6.getNumberValidator)()),E6.Factory.addGetterSetter(Du,"outerRadius",0,(0,_6.getNumberValidator)());var Ay={};Object.defineProperty(Ay,"__esModule",{value:!0}),Ay.Sprite=void 0;const Lu=kt,dJ=ur,pJ=Ed,$6=Ge,hJ=wt;class _o extends dJ.Shape{constructor(e){super(e),this._updated=!0,this.anim=new pJ.Animation(()=>{var n=this._updated;return this._updated=!1,n}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(e){var n=this.animation(),r=this.frameIndex(),a=r*4,i=this.animations()[n],o=this.frameOffsets(),s=i[a+0],l=i[a+1],u=i[a+2],c=i[a+3],d=this.image();if((this.hasFill()||this.hasStroke())&&(e.beginPath(),e.rect(0,0,u,c),e.closePath(),e.fillStrokeShape(this)),d)if(o){var p=o[n],f=r*2;e.drawImage(d,s,l,u,c,p[f+0],p[f+1],u,c)}else e.drawImage(d,s,l,u,c,0,0,u,c)}_hitFunc(e){var n=this.animation(),r=this.frameIndex(),a=r*4,i=this.animations()[n],o=this.frameOffsets(),s=i[a+2],l=i[a+3];if(e.beginPath(),o){var u=o[n],c=r*2;e.rect(u[c+0],u[c+1],s,l)}else e.rect(0,0,s,l);e.closePath(),e.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){var e=this;this.interval=setInterval(function(){e._updateIndex()},1e3/this.frameRate())}start(){if(!this.isRunning()){var e=this.getLayer();this.anim.setLayers(e),this._setInterval(),this.anim.start()}}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){var e=this.frameIndex(),n=this.animation(),r=this.animations(),a=r[n],i=a.length/4;e<i-1?this.frameIndex(e+1):this.frameIndex(0)}}Ay.Sprite=_o,_o.prototype.className="Sprite",(0,hJ._registerNode)(_o),Lu.Factory.addGetterSetter(_o,"animation"),Lu.Factory.addGetterSetter(_o,"animations"),Lu.Factory.addGetterSetter(_o,"frameOffsets"),Lu.Factory.addGetterSetter(_o,"image"),Lu.Factory.addGetterSetter(_o,"frameIndex",0,(0,$6.getNumberValidator)()),Lu.Factory.addGetterSetter(_o,"frameRate",17,(0,$6.getNumberValidator)()),Lu.Factory.backCompat(_o,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"});var Py={};Object.defineProperty(Py,"__esModule",{value:!0}),Py.Star=void 0;const p3=kt,fJ=ur,h3=Ge,mJ=wt;class Cl extends fJ.Shape{_sceneFunc(e){var n=this.innerRadius(),r=this.outerRadius(),a=this.numPoints();e.beginPath(),e.moveTo(0,0-r);for(var i=1;i<a*2;i++){var o=i%2===0?r:n,s=o*Math.sin(i*Math.PI/a),l=-1*o*Math.cos(i*Math.PI/a);e.lineTo(s,l)}e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}}Py.Star=Cl,Cl.prototype.className="Star",Cl.prototype._centroid=!0,Cl.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,mJ._registerNode)(Cl),p3.Factory.addGetterSetter(Cl,"numPoints",5,(0,h3.getNumberValidator)()),p3.Factory.addGetterSetter(Cl,"innerRadius",0,(0,h3.getNumberValidator)()),p3.Factory.addGetterSetter(Cl,"outerRadius",0,(0,h3.getNumberValidator)());var Fu={};Object.defineProperty(Fu,"__esModule",{value:!0}),Fu.Text=Fu.stringToArray=void 0;const f3=Ln,aa=kt,gJ=ur,Nl=Ge,yJ=wt;function R6(t){return Array.from(t)}Fu.stringToArray=R6;var Md="auto",bJ="center",M6="inherit",df="justify",vJ="Change.konva",xJ="2d",A6="-",P6="left",wJ="text",kJ="Text",SJ="top",CJ="bottom",D6="middle",L6="normal",NJ="px ",Dy=" ",TJ="right",F6="rtl",IJ="word",EJ="char",B6="none",m3="\u2026",z6=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],_J=z6.length;function OJ(t){return t.split(",").map(e=>{e=e.trim();const n=e.indexOf(" ")>=0,r=e.indexOf('"')>=0||e.indexOf("'")>=0;return n&&!r&&(e=`"${e}"`),e}).join(", ")}var g3;function y3(){return g3||(g3=f3.Util.createCanvasElement().getContext(xJ),g3)}function $J(t){t.fillText(this._partialText,this._partialTextX,this._partialTextY)}function RJ(t){t.setAttr("miterLimit",2),t.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function MJ(t){return t=t||{},!t.fillLinearGradientColorStops&&!t.fillRadialGradientColorStops&&!t.fillPatternImage&&(t.fill=t.fill||"black"),t}class Wn extends gJ.Shape{constructor(e){super(MJ(e)),this._partialTextX=0,this._partialTextY=0;for(var n=0;n<_J;n++)this.on(z6[n]+vJ,this._setTextData);this._setTextData()}_sceneFunc(e){var n=this.textArr,r=n.length;if(this.text()){var a=this.padding(),i=this.fontSize(),o=this.lineHeight()*i,s=this.verticalAlign(),l=this.direction(),u=0,c=this.align(),d=this.getWidth(),p=this.letterSpacing(),f=this.fill(),g=this.textDecoration(),y=g.indexOf("underline")!==-1,x=g.indexOf("line-through")!==-1,b;l=l===M6?e.direction:l;var v=0,v=o/2,w=0,S=0;for(l===F6&&e.setAttr("direction",l),e.setAttr("font",this._getContextFont()),e.setAttr("textBaseline",D6),e.setAttr("textAlign",P6),s===D6?u=(this.getHeight()-r*o-a*2)/2:s===CJ&&(u=this.getHeight()-r*o-a*2),e.translate(a,u+a),b=0;b<r;b++){var w=0,S=0,C=n[b],I=C.text,_=C.width,E=C.lastInParagraph,A,M,L;if(e.save(),c===TJ?w+=d-_-a*2:c===bJ&&(w+=(d-_-a*2)/2),y){e.save(),e.beginPath(),e.moveTo(w,v+S+Math.round(i/2)),A=I.split(" ").length-1,M=A===0,L=c===df&&!E?d-a*2:_,e.lineTo(w+Math.round(L),v+S+Math.round(i/2)),e.lineWidth=i/15;const H=this._getLinearGradient();e.strokeStyle=H||f,e.stroke(),e.restore()}if(x){e.save(),e.beginPath(),e.moveTo(w,v+S),A=I.split(" ").length-1,M=A===0,L=c===df&&E&&!M?d-a*2:_,e.lineTo(w+Math.round(L),v+S),e.lineWidth=i/15;const H=this._getLinearGradient();e.strokeStyle=H||f,e.stroke(),e.restore()}if(l!==F6&&(p!==0||c===df)){A=I.split(" ").length-1;for(var W=R6(I),B=0;B<W.length;B++){var K=W[B];K===" "&&!E&&c===df&&(w+=(d-a*2-_)/A),this._partialTextX=w,this._partialTextY=v+S,this._partialText=K,e.fillStrokeShape(this),w+=this.measureSize(K).width+p}}else p!==0&&e.setAttr("letterSpacing",`${p}px`),this._partialTextX=w,this._partialTextY=v+S,this._partialText=I,e.fillStrokeShape(this);e.restore(),r>1&&(v+=o)}}}_hitFunc(e){var n=this.getWidth(),r=this.getHeight();e.beginPath(),e.rect(0,0,n,r),e.closePath(),e.fillStrokeShape(this)}setText(e){var n=f3.Util._isString(e)?e:e==null?"":e+"";return this._setAttr(wJ,n),this}getWidth(){var e=this.attrs.width===Md||this.attrs.width===void 0;return e?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){var e=this.attrs.height===Md||this.attrs.height===void 0;return e?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return f3.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(e){var n=y3(),r=this.fontSize(),a;return n.save(),n.font=this._getContextFont(),a=n.measureText(e),n.restore(),{width:a.width,height:r}}_getContextFont(){return this.fontStyle()+Dy+this.fontVariant()+Dy+(this.fontSize()+NJ)+OJ(this.fontFamily())}_addTextLine(e){this.align()===df&&(e=e.trim());var n=this._getTextWidth(e);return this.textArr.push({text:e,width:n,lastInParagraph:!1})}_getTextWidth(e){var n=this.letterSpacing(),r=e.length;return y3().measureText(e).width+(r?n*(r-1):0)}_setTextData(){var e=this.text().split(`
`),n=+this.fontSize(),r=0,a=this.lineHeight()*n,i=this.attrs.width,o=this.attrs.height,s=i!==Md&&i!==void 0,l=o!==Md&&o!==void 0,u=this.padding(),c=i-u*2,d=o-u*2,p=0,f=this.wrap(),g=f!==B6,y=f!==EJ&&g,x=this.ellipsis();this.textArr=[],y3().font=this._getContextFont();for(var b=x?this._getTextWidth(m3):0,v=0,w=e.length;v<w;++v){var S=e[v],C=this._getTextWidth(S);if(s&&C>c)for(;S.length>0;){for(var I=0,_=S.length,E="",A=0;I<_;){var M=I+_>>>1,L=S.slice(0,M+1),W=this._getTextWidth(L)+b;W<=c?(I=M+1,E=L,A=W):_=M}if(E){if(y){var B,K=S[E.length],X=K===Dy||K===A6;X&&A<=c?B=E.length:B=Math.max(E.lastIndexOf(Dy),E.lastIndexOf(A6))+1,B>0&&(I=B,E=E.slice(0,I),A=this._getTextWidth(E))}E=E.trimRight(),this._addTextLine(E),r=Math.max(r,A),p+=a;var Q=this._shouldHandleEllipsis(p);if(Q){this._tryToAddEllipsisToLastLine();break}if(S=S.slice(I),S=S.trimLeft(),S.length>0&&(C=this._getTextWidth(S),C<=c)){this._addTextLine(S),p+=a,r=Math.max(r,C);break}}else break}else this._addTextLine(S),p+=a,r=Math.max(r,C),this._shouldHandleEllipsis(p)&&v<w-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),l&&p+a>d)break}this.textHeight=n,this.textWidth=r}_shouldHandleEllipsis(e){var n=+this.fontSize(),r=this.lineHeight()*n,a=this.attrs.height,i=a!==Md&&a!==void 0,o=this.padding(),s=a-o*2,l=this.wrap(),u=l!==B6;return!u||i&&e+r>s}_tryToAddEllipsisToLastLine(){var e=this.attrs.width,n=e!==Md&&e!==void 0,r=this.padding(),a=e-r*2,i=this.ellipsis(),o=this.textArr[this.textArr.length-1];if(!(!o||!i)){if(n){var s=this._getTextWidth(o.text+m3)<a;s||(o.text=o.text.slice(0,o.text.length-3))}this.textArr.splice(this.textArr.length-1,1),this._addTextLine(o.text+m3)}}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){const e=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,n=this.hasShadow();return e&&n?!0:super._useBufferCanvas()}}Fu.Text=Wn,Wn.prototype._fillFunc=$J,Wn.prototype._strokeFunc=RJ,Wn.prototype.className=kJ,Wn.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"],(0,yJ._registerNode)(Wn),aa.Factory.overWriteSetter(Wn,"width",(0,Nl.getNumberOrAutoValidator)()),aa.Factory.overWriteSetter(Wn,"height",(0,Nl.getNumberOrAutoValidator)()),aa.Factory.addGetterSetter(Wn,"direction",M6),aa.Factory.addGetterSetter(Wn,"fontFamily","Arial"),aa.Factory.addGetterSetter(Wn,"fontSize",12,(0,Nl.getNumberValidator)()),aa.Factory.addGetterSetter(Wn,"fontStyle",L6),aa.Factory.addGetterSetter(Wn,"fontVariant",L6),aa.Factory.addGetterSetter(Wn,"padding",0,(0,Nl.getNumberValidator)()),aa.Factory.addGetterSetter(Wn,"align",P6),aa.Factory.addGetterSetter(Wn,"verticalAlign",SJ),aa.Factory.addGetterSetter(Wn,"lineHeight",1,(0,Nl.getNumberValidator)()),aa.Factory.addGetterSetter(Wn,"wrap",IJ),aa.Factory.addGetterSetter(Wn,"ellipsis",!1,(0,Nl.getBooleanValidator)()),aa.Factory.addGetterSetter(Wn,"letterSpacing",0,(0,Nl.getNumberValidator)()),aa.Factory.addGetterSetter(Wn,"text","",(0,Nl.getStringValidator)()),aa.Factory.addGetterSetter(Wn,"textDecoration","");var Ly={};Object.defineProperty(Ly,"__esModule",{value:!0}),Ly.TextPath=void 0;const b3=Ln,no=kt,AJ=ur,pf=_d,v3=Fu,V6=Ge,PJ=wt;var DJ="",W6="normal";function j6(t){t.fillText(this.partialText,0,0)}function U6(t){t.strokeText(this.partialText,0,0)}class cr extends AJ.Shape{constructor(e){super(e),this.dummyCanvas=b3.Util.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return pf.Path.getPathLength(this.dataArray)}_getPointAtLength(e){if(!this.attrs.data)return null;const n=this.pathLength;return e-1>n?null:pf.Path.getPointAtLengthOfDataArray(e,this.dataArray)}_readDataAttribute(){this.dataArray=pf.Path.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(e){e.setAttr("font",this._getContextFont()),e.setAttr("textBaseline",this.textBaseline()),e.setAttr("textAlign","left"),e.save();var n=this.textDecoration(),r=this.fill(),a=this.fontSize(),i=this.glyphInfo;n==="underline"&&e.beginPath();for(var o=0;o<i.length;o++){e.save();var s=i[o].p0;e.translate(s.x,s.y),e.rotate(i[o].rotation),this.partialText=i[o].text,e.fillStrokeShape(this),n==="underline"&&(o===0&&e.moveTo(0,a/2+1),e.lineTo(a,a/2+1)),e.restore()}n==="underline"&&(e.strokeStyle=r,e.lineWidth=a/20,e.stroke()),e.restore()}_hitFunc(e){e.beginPath();var n=this.glyphInfo;if(n.length>=1){var r=n[0].p0;e.moveTo(r.x,r.y)}for(var a=0;a<n.length;a++){var i=n[a].p1;e.lineTo(i.x,i.y)}e.setAttr("lineWidth",this.fontSize()),e.setAttr("strokeStyle",this.colorKey),e.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return b3.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(e){return v3.Text.prototype.setText.call(this,e)}_getContextFont(){return v3.Text.prototype._getContextFont.call(this)}_getTextSize(e){var n=this.dummyCanvas,r=n.getContext("2d");r.save(),r.font=this._getContextFont();var a=r.measureText(e);return r.restore(),{width:a.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){const{width:e,height:n}=this._getTextSize(this.attrs.text);if(this.textWidth=e,this.textHeight=n,this.glyphInfo=[],!this.attrs.data)return null;const r=this.letterSpacing(),a=this.align(),i=this.kerningFunc(),o=Math.max(this.textWidth+((this.attrs.text||"").length-1)*r,0);let s=0;a==="center"&&(s=Math.max(0,this.pathLength/2-o/2)),a==="right"&&(s=Math.max(0,this.pathLength-o));const l=(0,v3.stringToArray)(this.text());let u=s;for(var c=0;c<l.length;c++){const d=this._getPointAtLength(u);if(!d)return;let p=this._getTextSize(l[c]).width+r;if(l[c]===" "&&a==="justify"){const v=this.text().split(" ").length-1;p+=(this.pathLength-o)/v}const f=this._getPointAtLength(u+p);if(!f)return;const g=pf.Path.getLineLength(d.x,d.y,f.x,f.y);let y=0;if(i)try{y=i(l[c-1],l[c])*this.fontSize()}catch{y=0}d.x+=y,f.x+=y,this.textWidth+=y;const x=pf.Path.getPointOnLine(y+g/2,d.x,d.y,f.x,f.y),b=Math.atan2(f.y-d.y,f.x-d.x);this.glyphInfo.push({transposeX:x.x,transposeY:x.y,text:l[c],rotation:b,p0:d,p1:f}),u+=p}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};var e=[];this.glyphInfo.forEach(function(c){e.push(c.p0.x),e.push(c.p0.y),e.push(c.p1.x),e.push(c.p1.y)});for(var n=e[0]||0,r=e[0]||0,a=e[1]||0,i=e[1]||0,o,s,l=0;l<e.length/2;l++)o=e[l*2],s=e[l*2+1],n=Math.min(n,o),r=Math.max(r,o),a=Math.min(a,s),i=Math.max(i,s);var u=this.fontSize();return{x:n-u/2,y:a-u/2,width:r-n+u,height:i-a+u}}destroy(){return b3.Util.releaseCanvas(this.dummyCanvas),super.destroy()}}Ly.TextPath=cr,cr.prototype._fillFunc=j6,cr.prototype._strokeFunc=U6,cr.prototype._fillFuncHit=j6,cr.prototype._strokeFuncHit=U6,cr.prototype.className="TextPath",cr.prototype._attrsAffectingSize=["text","fontSize","data"],(0,PJ._registerNode)(cr),no.Factory.addGetterSetter(cr,"data"),no.Factory.addGetterSetter(cr,"fontFamily","Arial"),no.Factory.addGetterSetter(cr,"fontSize",12,(0,V6.getNumberValidator)()),no.Factory.addGetterSetter(cr,"fontStyle",W6),no.Factory.addGetterSetter(cr,"align","left"),no.Factory.addGetterSetter(cr,"letterSpacing",0,(0,V6.getNumberValidator)()),no.Factory.addGetterSetter(cr,"textBaseline","middle"),no.Factory.addGetterSetter(cr,"fontVariant",W6),no.Factory.addGetterSetter(cr,"text",DJ),no.Factory.addGetterSetter(cr,"textDecoration",null),no.Factory.addGetterSetter(cr,"kerningFunc",null);var Fy={};Object.defineProperty(Fy,"__esModule",{value:!0}),Fy.Transformer=void 0;const en=Ln,Ut=kt,G6=Tn,LJ=ur,FJ=cf,H6=Id,ro=wt,Tl=Ge,BJ=wt;var q6="tr-konva",zJ=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(t=>t+`.${q6}`).join(" "),K6="nodesRect",VJ=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange"],WJ={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135};const jJ="ontouchstart"in ro.Konva._global;function UJ(t,e,n){if(t==="rotater")return n;e+=en.Util.degToRad(WJ[t]||0);var r=(en.Util.radToDeg(e)%360+360)%360;return en.Util._inRange(r,315+22.5,360)||en.Util._inRange(r,0,22.5)?"ns-resize":en.Util._inRange(r,45-22.5,45+22.5)?"nesw-resize":en.Util._inRange(r,90-22.5,90+22.5)?"ew-resize":en.Util._inRange(r,135-22.5,135+22.5)?"nwse-resize":en.Util._inRange(r,180-22.5,180+22.5)?"ns-resize":en.Util._inRange(r,225-22.5,225+22.5)?"nesw-resize":en.Util._inRange(r,270-22.5,270+22.5)?"ew-resize":en.Util._inRange(r,315-22.5,315+22.5)?"nwse-resize":(en.Util.error("Transformer has unknown angle for cursor detection: "+r),"pointer")}var By=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"],X6=1e8;function GJ(t){return{x:t.x+t.width/2*Math.cos(t.rotation)+t.height/2*Math.sin(-t.rotation),y:t.y+t.height/2*Math.cos(t.rotation)+t.width/2*Math.sin(t.rotation)}}function Y6(t,e,n){const r=n.x+(t.x-n.x)*Math.cos(e)-(t.y-n.y)*Math.sin(e),a=n.y+(t.x-n.x)*Math.sin(e)+(t.y-n.y)*Math.cos(e);return{...t,rotation:t.rotation+e,x:r,y:a}}function HJ(t,e){const n=GJ(t);return Y6(t,e,n)}function qJ(t,e,n){let r=e;for(let a=0;a<t.length;a++){const i=ro.Konva.getAngle(t[a]),o=Math.abs(i-e)%(Math.PI*2);Math.min(o,Math.PI*2-o)<n&&(r=i)}return r}let At=class extends H6.Group{constructor(t){super(t),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(zJ,this.update),this.getNode()&&this.update()}attachTo(t){return this.setNode(t),this}setNode(t){return en.Util.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([t])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return q6+this._id}setNodes(t=[]){this._nodes&&this._nodes.length&&this.detach();const e=t.filter(r=>r.isAncestorOf(this)?(en.Util.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);this._nodes=t=e,t.length===1&&this.useSingleNodeRotation()?this.rotation(t[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(r=>{const a=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()},i=r._attrsAffectingSize.map(o=>o+"Change."+this._getEventNamespace()).join(" ");r.on(i,a),r.on(VJ.map(o=>o+`.${this._getEventNamespace()}`).join(" "),a),r.on(`absoluteTransformChange.${this._getEventNamespace()}`,a),this._proxyDrag(r)}),this._resetTransformCache();var n=!!this.findOne(".top-left");return n&&this.update(),this}_proxyDrag(t){let e;t.on(`dragstart.${this._getEventNamespace()}`,n=>{e=t.getAbsolutePosition(),!this.isDragging()&&t!==this.findOne(".back")&&this.startDrag(n,!1)}),t.on(`dragmove.${this._getEventNamespace()}`,n=>{if(!e)return;const r=t.getAbsolutePosition(),a=r.x-e.x,i=r.y-e.y;this.nodes().forEach(o=>{if(o===t||o.isDragging())return;const s=o.getAbsolutePosition();o.setAbsolutePosition({x:s.x+a,y:s.y+i}),o.startDrag(n)}),e=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(t=>{t.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(K6),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(K6,this.__getNodeRect)}__getNodeShape(t,e=this.rotation(),n){var r=t.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),a=t.getAbsoluteScale(n),i=t.getAbsolutePosition(n),o=r.x*a.x-t.offsetX()*a.x,s=r.y*a.y-t.offsetY()*a.y;const l=(ro.Konva.getAngle(t.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),u={x:i.x+o*Math.cos(l)+s*Math.sin(-l),y:i.y+s*Math.cos(l)+o*Math.sin(l),width:r.width*a.x,height:r.height*a.y,rotation:l};return Y6(u,-ro.Konva.getAngle(e),{x:0,y:0})}__getNodeRect(){var t=this.getNode();if(!t)return{x:-X6,y:-X6,width:0,height:0,rotation:0};const e=[];this.nodes().map(l=>{const u=l.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()});var c=[{x:u.x,y:u.y},{x:u.x+u.width,y:u.y},{x:u.x+u.width,y:u.y+u.height},{x:u.x,y:u.y+u.height}],d=l.getAbsoluteTransform();c.forEach(function(p){var f=d.point(p);e.push(f)})});const n=new en.Transform;n.rotate(-ro.Konva.getAngle(this.rotation()));var r=1/0,a=1/0,i=-1/0,o=-1/0;e.forEach(function(l){var u=n.point(l);r===void 0&&(r=i=u.x,a=o=u.y),r=Math.min(r,u.x),a=Math.min(a,u.y),i=Math.max(i,u.x),o=Math.max(o,u.y)}),n.invert();const s=n.point({x:r,y:a});return{x:s.x,y:s.y,width:i-r,height:o-a,rotation:ro.Konva.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),By.forEach(t=>{this._createAnchor(t)}),this._createAnchor("rotater")}_createAnchor(t){var e=new FJ.Rect({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:t+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:jJ?10:"auto"}),n=this;e.on("mousedown touchstart",function(r){n._handleMouseDown(r)}),e.on("dragstart",r=>{e.stopDrag(),r.cancelBubble=!0}),e.on("dragend",r=>{r.cancelBubble=!0}),e.on("mouseenter",()=>{var r=ro.Konva.getAngle(this.rotation()),a=this.rotateAnchorCursor(),i=UJ(t,r,a);e.getStage().content&&(e.getStage().content.style.cursor=i),this._cursorChange=!0}),e.on("mouseout",()=>{e.getStage().content&&(e.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(e)}_createBack(){var t=new LJ.Shape({name:"back",width:0,height:0,draggable:!0,sceneFunc(e,n){var r=n.getParent(),a=r.padding();e.beginPath(),e.rect(-a,-a,n.width()+a*2,n.height()+a*2),e.moveTo(n.width()/2,-a),r.rotateEnabled()&&r.rotateLineVisible()&&e.lineTo(n.width()/2,-r.rotateAnchorOffset()*en.Util._sign(n.height())-a),e.fillStrokeShape(n)},hitFunc:(e,n)=>{if(this.shouldOverdrawWholeArea()){var r=this.padding();e.beginPath(),e.rect(-r,-r,n.width()+r*2,n.height()+r*2),e.fillStrokeShape(n)}}});this.add(t),this._proxyDrag(t),t.on("dragstart",e=>{e.cancelBubble=!0}),t.on("dragmove",e=>{e.cancelBubble=!0}),t.on("dragend",e=>{e.cancelBubble=!0}),this.on("dragmove",e=>{this.update()})}_handleMouseDown(t){this._movingAnchorName=t.target.name().split(" ")[0];var e=this._getNodeRect(),n=e.width,r=e.height,a=Math.sqrt(Math.pow(n,2)+Math.pow(r,2));this.sin=Math.abs(r/a),this.cos=Math.abs(n/a),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;var i=t.target.getAbsolutePosition(),o=t.target.getStage().getPointerPosition();this._anchorDragOffset={x:o.x-i.x,y:o.y-i.y},this._fire("transformstart",{evt:t.evt,target:this.getNode()}),this._nodes.forEach(s=>{s._fire("transformstart",{evt:t.evt,target:s})})}_handleMouseMove(t){var e,n,r,a=this.findOne("."+this._movingAnchorName),i=a.getStage();i.setPointersPositions(t);const o=i.getPointerPosition();let s={x:o.x-this._anchorDragOffset.x,y:o.y-this._anchorDragOffset.y};const l=a.getAbsolutePosition();this.anchorDragBoundFunc()&&(s=this.anchorDragBoundFunc()(l,s,t)),a.setAbsolutePosition(s);const u=a.getAbsolutePosition();if(!(l.x===u.x&&l.y===u.y)){if(this._movingAnchorName==="rotater"){var c=this._getNodeRect();e=a.x()-c.width/2,n=-a.y()+c.height/2;let W=Math.atan2(-n,e)+Math.PI/2;c.height<0&&(W-=Math.PI);var d=ro.Konva.getAngle(this.rotation());const B=d+W,K=ro.Konva.getAngle(this.rotationSnapTolerance()),X=qJ(this.rotationSnaps(),B,K)-c.rotation,Q=HJ(c,X);this._fitNodesInto(Q,t);return}var p=this.shiftBehavior(),f;p==="inverted"?f=this.keepRatio()&&!t.shiftKey:p==="none"?f=this.keepRatio():f=this.keepRatio()||t.shiftKey;var v=this.centeredScaling()||t.altKey;if(this._movingAnchorName==="top-left"){if(f){var g=v?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};r=Math.sqrt(Math.pow(g.x-a.x(),2)+Math.pow(g.y-a.y(),2));var y=this.findOne(".top-left").x()>g.x?-1:1,x=this.findOne(".top-left").y()>g.y?-1:1;e=r*this.cos*y,n=r*this.sin*x,this.findOne(".top-left").x(g.x-e),this.findOne(".top-left").y(g.y-n)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(a.y());else if(this._movingAnchorName==="top-right"){if(f){var g=v?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};r=Math.sqrt(Math.pow(a.x()-g.x,2)+Math.pow(g.y-a.y(),2));var y=this.findOne(".top-right").x()<g.x?-1:1,x=this.findOne(".top-right").y()>g.y?-1:1;e=r*this.cos*y,n=r*this.sin*x,this.findOne(".top-right").x(g.x+e),this.findOne(".top-right").y(g.y-n)}var b=a.position();this.findOne(".top-left").y(b.y),this.findOne(".bottom-right").x(b.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(a.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(a.x());else if(this._movingAnchorName==="bottom-left"){if(f){var g=v?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};r=Math.sqrt(Math.pow(g.x-a.x(),2)+Math.pow(a.y()-g.y,2));var y=g.x<a.x()?-1:1,x=a.y()<g.y?-1:1;e=r*this.cos*y,n=r*this.sin*x,a.x(g.x-e),a.y(g.y+n)}b=a.position(),this.findOne(".top-left").x(b.x),this.findOne(".bottom-right").y(b.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(a.y());else if(this._movingAnchorName==="bottom-right"){if(f){var g=v?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};r=Math.sqrt(Math.pow(a.x()-g.x,2)+Math.pow(a.y()-g.y,2));var y=this.findOne(".bottom-right").x()<g.x?-1:1,x=this.findOne(".bottom-right").y()<g.y?-1:1;e=r*this.cos*y,n=r*this.sin*x,this.findOne(".bottom-right").x(g.x+e),this.findOne(".bottom-right").y(g.y+n)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));var v=this.centeredScaling()||t.altKey;if(v){var w=this.findOne(".top-left"),S=this.findOne(".bottom-right"),C=w.x(),I=w.y(),_=this.getWidth()-S.x(),E=this.getHeight()-S.y();S.move({x:-C,y:-I}),w.move({x:_,y:E})}var A=this.findOne(".top-left").getAbsolutePosition();e=A.x,n=A.y;var M=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),L=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:e,y:n,width:M,height:L,rotation:ro.Konva.getAngle(this.rotation())},t)}}_handleMouseUp(t){this._removeEvents(t)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(t){if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));var e=this.getNode();this._fire("transformend",{evt:t,target:e}),e&&this._nodes.forEach(n=>{n._fire("transformend",{evt:t,target:n})}),this._movingAnchorName=null}}_fitNodesInto(t,e){var n=this._getNodeRect();const r=1;if(en.Util._inRange(t.width,-this.padding()*2-r,r)){this.update();return}if(en.Util._inRange(t.height,-this.padding()*2-r,r)){this.update();return}var a=new en.Transform;if(a.rotate(ro.Konva.getAngle(this.rotation())),this._movingAnchorName&&t.width<0&&this._movingAnchorName.indexOf("left")>=0){const d=a.point({x:-this.padding()*2,y:0});t.x+=d.x,t.y+=d.y,t.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=d.x,this._anchorDragOffset.y-=d.y}else if(this._movingAnchorName&&t.width<0&&this._movingAnchorName.indexOf("right")>=0){const d=a.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=d.x,this._anchorDragOffset.y-=d.y,t.width+=this.padding()*2}if(this._movingAnchorName&&t.height<0&&this._movingAnchorName.indexOf("top")>=0){const d=a.point({x:0,y:-this.padding()*2});t.x+=d.x,t.y+=d.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=d.x,this._anchorDragOffset.y-=d.y,t.height+=this.padding()*2}else if(this._movingAnchorName&&t.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const d=a.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=d.x,this._anchorDragOffset.y-=d.y,t.height+=this.padding()*2}if(this.boundBoxFunc()){const d=this.boundBoxFunc()(n,t);d?t=d:en.Util.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const i=1e7,o=new en.Transform;o.translate(n.x,n.y),o.rotate(n.rotation),o.scale(n.width/i,n.height/i);const s=new en.Transform,l=t.width/i,u=t.height/i;this.flipEnabled()===!1?(s.translate(t.x,t.y),s.rotate(t.rotation),s.translate(t.width<0?t.width:0,t.height<0?t.height:0),s.scale(Math.abs(l),Math.abs(u))):(s.translate(t.x,t.y),s.rotate(t.rotation),s.scale(l,u));const c=s.multiply(o.invert());this._nodes.forEach(d=>{var p;const f=d.getParent().getAbsoluteTransform(),g=d.getTransform().copy();g.translate(d.offsetX(),d.offsetY());const y=new en.Transform;y.multiply(f.copy().invert()).multiply(c).multiply(f).multiply(g);const x=y.decompose();d.setAttrs(x),this._fire("transform",{evt:e,target:d}),d._fire("transform",{evt:e,target:d}),(p=d.getLayer())===null||p===void 0||p.batchDraw()}),this.rotation(en.Util._getRotation(t.rotation)),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(t,e){this.findOne(t).setAttrs(e)}update(){var t,e=this._getNodeRect();this.rotation(en.Util._getRotation(e.rotation));var n=e.width,r=e.height,a=this.enabledAnchors(),i=this.resizeEnabled(),o=this.padding(),s=this.anchorSize();const l=this.find("._anchor");l.forEach(c=>{c.setAttrs({width:s,height:s,offsetX:s/2,offsetY:s/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:s/2+o,offsetY:s/2+o,visible:i&&a.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:n/2,y:0,offsetY:s/2+o,visible:i&&a.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:n,y:0,offsetX:s/2-o,offsetY:s/2+o,visible:i&&a.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:r/2,offsetX:s/2+o,visible:i&&a.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:n,y:r/2,offsetX:s/2-o,visible:i&&a.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:r,offsetX:s/2+o,offsetY:s/2-o,visible:i&&a.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:n/2,y:r,offsetY:s/2-o,visible:i&&a.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:n,y:r,offsetX:s/2-o,offsetY:s/2-o,visible:i&&a.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:n/2,y:-this.rotateAnchorOffset()*en.Util._sign(r)-o,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:n,height:r,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),x:0,y:0});const u=this.anchorStyleFunc();u&&l.forEach(c=>{u(c)}),(t=this.getLayer())===null||t===void 0||t.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();var t=this.findOne("."+this._movingAnchorName);t&&t.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),H6.Group.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return G6.Node.prototype.toObject.call(this)}clone(t){var e=G6.Node.prototype.clone.call(this,t);return e}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}};Fy.Transformer=At;function KJ(t){return t instanceof Array||en.Util.warn("enabledAnchors value should be an array"),t instanceof Array&&t.forEach(function(e){By.indexOf(e)===-1&&en.Util.warn("Unknown anchor name: "+e+". Available names are: "+By.join(", "))}),t||[]}At.prototype.className="Transformer",(0,BJ._registerNode)(At),Ut.Factory.addGetterSetter(At,"enabledAnchors",By,KJ),Ut.Factory.addGetterSetter(At,"flipEnabled",!0,(0,Tl.getBooleanValidator)()),Ut.Factory.addGetterSetter(At,"resizeEnabled",!0),Ut.Factory.addGetterSetter(At,"anchorSize",10,(0,Tl.getNumberValidator)()),Ut.Factory.addGetterSetter(At,"rotateEnabled",!0),Ut.Factory.addGetterSetter(At,"rotateLineVisible",!0),Ut.Factory.addGetterSetter(At,"rotationSnaps",[]),Ut.Factory.addGetterSetter(At,"rotateAnchorOffset",50,(0,Tl.getNumberValidator)()),Ut.Factory.addGetterSetter(At,"rotateAnchorCursor","crosshair"),Ut.Factory.addGetterSetter(At,"rotationSnapTolerance",5,(0,Tl.getNumberValidator)()),Ut.Factory.addGetterSetter(At,"borderEnabled",!0),Ut.Factory.addGetterSetter(At,"anchorStroke","rgb(0, 161, 255)"),Ut.Factory.addGetterSetter(At,"anchorStrokeWidth",1,(0,Tl.getNumberValidator)()),Ut.Factory.addGetterSetter(At,"anchorFill","white"),Ut.Factory.addGetterSetter(At,"anchorCornerRadius",0,(0,Tl.getNumberValidator)()),Ut.Factory.addGetterSetter(At,"borderStroke","rgb(0, 161, 255)"),Ut.Factory.addGetterSetter(At,"borderStrokeWidth",1,(0,Tl.getNumberValidator)()),Ut.Factory.addGetterSetter(At,"borderDash"),Ut.Factory.addGetterSetter(At,"keepRatio",!0),Ut.Factory.addGetterSetter(At,"shiftBehavior","default"),Ut.Factory.addGetterSetter(At,"centeredScaling",!1),Ut.Factory.addGetterSetter(At,"ignoreStroke",!1),Ut.Factory.addGetterSetter(At,"padding",0,(0,Tl.getNumberValidator)()),Ut.Factory.addGetterSetter(At,"node"),Ut.Factory.addGetterSetter(At,"nodes"),Ut.Factory.addGetterSetter(At,"boundBoxFunc"),Ut.Factory.addGetterSetter(At,"anchorDragBoundFunc"),Ut.Factory.addGetterSetter(At,"anchorStyleFunc"),Ut.Factory.addGetterSetter(At,"shouldOverdrawWholeArea",!1),Ut.Factory.addGetterSetter(At,"useSingleNodeRotation",!0),Ut.Factory.backCompat(At,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"});var zy={};Object.defineProperty(zy,"__esModule",{value:!0}),zy.Wedge=void 0;const Vy=kt,XJ=ur,YJ=wt,Q6=Ge,QJ=wt;class bs extends XJ.Shape{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.radius(),0,YJ.Konva.getAngle(this.angle()),this.clockwise()),e.lineTo(0,0),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius(e/2)}setHeight(e){this.radius(e/2)}}zy.Wedge=bs,bs.prototype.className="Wedge",bs.prototype._centroid=!0,bs.prototype._attrsAffectingSize=["radius"],(0,QJ._registerNode)(bs),Vy.Factory.addGetterSetter(bs,"radius",0,(0,Q6.getNumberValidator)()),Vy.Factory.addGetterSetter(bs,"angle",0,(0,Q6.getNumberValidator)()),Vy.Factory.addGetterSetter(bs,"clockwise",!1),Vy.Factory.backCompat(bs,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"});var Wy={};Object.defineProperty(Wy,"__esModule",{value:!0}),Wy.Blur=void 0;const Z6=kt,ZJ=Tn,JJ=Ge;function J6(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}var eee=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],tee=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function nee(t,e){var n=t.data,r=t.width,a=t.height,i,o,s,l,u,c,d,p,f,g,y,x,b,v,w,S,C,I,_,E,A,M,L,W,B=e+e+1,K=r-1,X=a-1,Q=e+1,H=Q*(Q+1)/2,F=new J6,Y=null,Z=F,ne=null,se=null,ce=eee[e],le=tee[e];for(s=1;s<B;s++)Z=Z.next=new J6,s===Q&&(Y=Z);for(Z.next=F,d=c=0,o=0;o<a;o++){for(S=C=I=_=p=f=g=y=0,x=Q*(E=n[c]),b=Q*(A=n[c+1]),v=Q*(M=n[c+2]),w=Q*(L=n[c+3]),p+=H*E,f+=H*A,g+=H*M,y+=H*L,Z=F,s=0;s<Q;s++)Z.r=E,Z.g=A,Z.b=M,Z.a=L,Z=Z.next;for(s=1;s<Q;s++)l=c+((K<s?K:s)<<2),p+=(Z.r=E=n[l])*(W=Q-s),f+=(Z.g=A=n[l+1])*W,g+=(Z.b=M=n[l+2])*W,y+=(Z.a=L=n[l+3])*W,S+=E,C+=A,I+=M,_+=L,Z=Z.next;for(ne=F,se=Y,i=0;i<r;i++)n[c+3]=L=y*ce>>le,L!==0?(L=255/L,n[c]=(p*ce>>le)*L,n[c+1]=(f*ce>>le)*L,n[c+2]=(g*ce>>le)*L):n[c]=n[c+1]=n[c+2]=0,p-=x,f-=b,g-=v,y-=w,x-=ne.r,b-=ne.g,v-=ne.b,w-=ne.a,l=d+((l=i+e+1)<K?l:K)<<2,S+=ne.r=n[l],C+=ne.g=n[l+1],I+=ne.b=n[l+2],_+=ne.a=n[l+3],p+=S,f+=C,g+=I,y+=_,ne=ne.next,x+=E=se.r,b+=A=se.g,v+=M=se.b,w+=L=se.a,S-=E,C-=A,I-=M,_-=L,se=se.next,c+=4;d+=r}for(i=0;i<r;i++){for(C=I=_=S=f=g=y=p=0,c=i<<2,x=Q*(E=n[c]),b=Q*(A=n[c+1]),v=Q*(M=n[c+2]),w=Q*(L=n[c+3]),p+=H*E,f+=H*A,g+=H*M,y+=H*L,Z=F,s=0;s<Q;s++)Z.r=E,Z.g=A,Z.b=M,Z.a=L,Z=Z.next;for(u=r,s=1;s<=e;s++)c=u+i<<2,p+=(Z.r=E=n[c])*(W=Q-s),f+=(Z.g=A=n[c+1])*W,g+=(Z.b=M=n[c+2])*W,y+=(Z.a=L=n[c+3])*W,S+=E,C+=A,I+=M,_+=L,Z=Z.next,s<X&&(u+=r);for(c=i,ne=F,se=Y,o=0;o<a;o++)l=c<<2,n[l+3]=L=y*ce>>le,L>0?(L=255/L,n[l]=(p*ce>>le)*L,n[l+1]=(f*ce>>le)*L,n[l+2]=(g*ce>>le)*L):n[l]=n[l+1]=n[l+2]=0,p-=x,f-=b,g-=v,y-=w,x-=ne.r,b-=ne.g,v-=ne.b,w-=ne.a,l=i+((l=o+Q)<X?l:X)*r<<2,p+=S+=ne.r=n[l],f+=C+=ne.g=n[l+1],g+=I+=ne.b=n[l+2],y+=_+=ne.a=n[l+3],ne=ne.next,x+=E=se.r,b+=A=se.g,v+=M=se.b,w+=L=se.a,S-=E,C-=A,I-=M,_-=L,se=se.next,c+=r}}const ree=function(t){var e=Math.round(this.blurRadius());e>0&&nee(t,e)};Wy.Blur=ree,Z6.Factory.addGetterSetter(ZJ.Node,"blurRadius",0,(0,JJ.getNumberValidator)(),Z6.Factory.afterSetFilter);var jy={};Object.defineProperty(jy,"__esModule",{value:!0}),jy.Brighten=void 0;const eA=kt,aee=Tn,iee=Ge,oee=function(t){var e=this.brightness()*255,n=t.data,r=n.length,a;for(a=0;a<r;a+=4)n[a]+=e,n[a+1]+=e,n[a+2]+=e};jy.Brighten=oee,eA.Factory.addGetterSetter(aee.Node,"brightness",0,(0,iee.getNumberValidator)(),eA.Factory.afterSetFilter);var Uy={};Object.defineProperty(Uy,"__esModule",{value:!0}),Uy.Contrast=void 0;const tA=kt,see=Tn,lee=Ge,uee=function(t){var e=Math.pow((this.contrast()+100)/100,2),n=t.data,r=n.length,a=150,i=150,o=150,s;for(s=0;s<r;s+=4)a=n[s],i=n[s+1],o=n[s+2],a/=255,a-=.5,a*=e,a+=.5,a*=255,i/=255,i-=.5,i*=e,i+=.5,i*=255,o/=255,o-=.5,o*=e,o+=.5,o*=255,a=a<0?0:a>255?255:a,i=i<0?0:i>255?255:i,o=o<0?0:o>255?255:o,n[s]=a,n[s+1]=i,n[s+2]=o};Uy.Contrast=uee,tA.Factory.addGetterSetter(see.Node,"contrast",0,(0,lee.getNumberValidator)(),tA.Factory.afterSetFilter);var Gy={};Object.defineProperty(Gy,"__esModule",{value:!0}),Gy.Emboss=void 0;const Il=kt,Hy=Tn,cee=Ln,nA=Ge,dee=function(t){var e=this.embossStrength()*10,n=this.embossWhiteLevel()*255,r=this.embossDirection(),a=this.embossBlend(),i=0,o=0,s=t.data,l=t.width,u=t.height,c=l*4,d=u;switch(r){case"top-left":i=-1,o=-1;break;case"top":i=-1,o=0;break;case"top-right":i=-1,o=1;break;case"right":i=0,o=1;break;case"bottom-right":i=1,o=1;break;case"bottom":i=1,o=0;break;case"bottom-left":i=1,o=-1;break;case"left":i=0,o=-1;break;default:cee.Util.error("Unknown emboss direction: "+r)}do{var p=(d-1)*c,f=i;d+f<1&&(f=0),d+f>u&&(f=0);var g=(d-1+f)*l*4,y=l;do{var x=p+(y-1)*4,b=o;y+b<1&&(b=0),y+b>l&&(b=0);var v=g+(y-1+b)*4,w=s[x]-s[v],S=s[x+1]-s[v+1],C=s[x+2]-s[v+2],I=w,_=I>0?I:-I,E=S>0?S:-S,A=C>0?C:-C;if(E>_&&(I=S),A>_&&(I=C),I*=e,a){var M=s[x]+I,L=s[x+1]+I,W=s[x+2]+I;s[x]=M>255?255:M<0?0:M,s[x+1]=L>255?255:L<0?0:L,s[x+2]=W>255?255:W<0?0:W}else{var B=n-I;B<0?B=0:B>255&&(B=255),s[x]=s[x+1]=s[x+2]=B}}while(--y)}while(--d)};Gy.Emboss=dee,Il.Factory.addGetterSetter(Hy.Node,"embossStrength",.5,(0,nA.getNumberValidator)(),Il.Factory.afterSetFilter),Il.Factory.addGetterSetter(Hy.Node,"embossWhiteLevel",.5,(0,nA.getNumberValidator)(),Il.Factory.afterSetFilter),Il.Factory.addGetterSetter(Hy.Node,"embossDirection","top-left",null,Il.Factory.afterSetFilter),Il.Factory.addGetterSetter(Hy.Node,"embossBlend",!1,null,Il.Factory.afterSetFilter);var qy={};Object.defineProperty(qy,"__esModule",{value:!0}),qy.Enhance=void 0;const rA=kt,pee=Tn,hee=Ge;function x3(t,e,n,r,a){var i=n-e,o=a-r,s;return i===0?r+o/2:o===0?r:(s=(t-e)/i,s=o*s+r,s)}const fee=function(t){var e=t.data,n=e.length,r=e[0],a=r,i,o=e[1],s=o,l,u=e[2],c=u,d,p,f=this.enhance();if(f!==0){for(p=0;p<n;p+=4)i=e[p+0],i<r?r=i:i>a&&(a=i),l=e[p+1],l<o?o=l:l>s&&(s=l),d=e[p+2],d<u?u=d:d>c&&(c=d);a===r&&(a=255,r=0),s===o&&(s=255,o=0),c===u&&(c=255,u=0);var g,y,x,b,v,w,S,C,I;for(f>0?(y=a+f*(255-a),x=r-f*(r-0),v=s+f*(255-s),w=o-f*(o-0),C=c+f*(255-c),I=u-f*(u-0)):(g=(a+r)*.5,y=a+f*(a-g),x=r+f*(r-g),b=(s+o)*.5,v=s+f*(s-b),w=o+f*(o-b),S=(c+u)*.5,C=c+f*(c-S),I=u+f*(u-S)),p=0;p<n;p+=4)e[p+0]=x3(e[p+0],r,a,x,y),e[p+1]=x3(e[p+1],o,s,w,v),e[p+2]=x3(e[p+2],u,c,I,C)}};qy.Enhance=fee,rA.Factory.addGetterSetter(pee.Node,"enhance",0,(0,hee.getNumberValidator)(),rA.Factory.afterSetFilter);var Ky={};Object.defineProperty(Ky,"__esModule",{value:!0}),Ky.Grayscale=void 0;const mee=function(t){var e=t.data,n=e.length,r,a;for(r=0;r<n;r+=4)a=.34*e[r]+.5*e[r+1]+.16*e[r+2],e[r]=a,e[r+1]=a,e[r+2]=a};Ky.Grayscale=mee;var Xy={};Object.defineProperty(Xy,"__esModule",{value:!0}),Xy.HSL=void 0;const Ad=kt,w3=Tn,k3=Ge;Ad.Factory.addGetterSetter(w3.Node,"hue",0,(0,k3.getNumberValidator)(),Ad.Factory.afterSetFilter),Ad.Factory.addGetterSetter(w3.Node,"saturation",0,(0,k3.getNumberValidator)(),Ad.Factory.afterSetFilter),Ad.Factory.addGetterSetter(w3.Node,"luminance",0,(0,k3.getNumberValidator)(),Ad.Factory.afterSetFilter);const gee=function(t){var e=t.data,n=e.length,r=1,a=Math.pow(2,this.saturation()),i=Math.abs(this.hue()+360)%360,o=this.luminance()*127,s,l=r*a*Math.cos(i*Math.PI/180),u=r*a*Math.sin(i*Math.PI/180),c=.299*r+.701*l+.167*u,d=.587*r-.587*l+.33*u,p=.114*r-.114*l-.497*u,f=.299*r-.299*l-.328*u,g=.587*r+.413*l+.035*u,y=.114*r-.114*l+.293*u,x=.299*r-.3*l+1.25*u,b=.587*r-.586*l-1.05*u,v=.114*r+.886*l-.2*u,w,S,C,I;for(s=0;s<n;s+=4)w=e[s+0],S=e[s+1],C=e[s+2],I=e[s+3],e[s+0]=c*w+d*S+p*C+o,e[s+1]=f*w+g*S+y*C+o,e[s+2]=x*w+b*S+v*C+o,e[s+3]=I};Xy.HSL=gee;var Yy={};Object.defineProperty(Yy,"__esModule",{value:!0}),Yy.HSV=void 0;const Pd=kt,S3=Tn,C3=Ge,yee=function(t){var e=t.data,n=e.length,r=Math.pow(2,this.value()),a=Math.pow(2,this.saturation()),i=Math.abs(this.hue()+360)%360,o,s=r*a*Math.cos(i*Math.PI/180),l=r*a*Math.sin(i*Math.PI/180),u=.299*r+.701*s+.167*l,c=.587*r-.587*s+.33*l,d=.114*r-.114*s-.497*l,p=.299*r-.299*s-.328*l,f=.587*r+.413*s+.035*l,g=.114*r-.114*s+.293*l,y=.299*r-.3*s+1.25*l,x=.587*r-.586*s-1.05*l,b=.114*r+.886*s-.2*l,v,w,S,C;for(o=0;o<n;o+=4)v=e[o+0],w=e[o+1],S=e[o+2],C=e[o+3],e[o+0]=u*v+c*w+d*S,e[o+1]=p*v+f*w+g*S,e[o+2]=y*v+x*w+b*S,e[o+3]=C};Yy.HSV=yee,Pd.Factory.addGetterSetter(S3.Node,"hue",0,(0,C3.getNumberValidator)(),Pd.Factory.afterSetFilter),Pd.Factory.addGetterSetter(S3.Node,"saturation",0,(0,C3.getNumberValidator)(),Pd.Factory.afterSetFilter),Pd.Factory.addGetterSetter(S3.Node,"value",0,(0,C3.getNumberValidator)(),Pd.Factory.afterSetFilter);var Qy={};Object.defineProperty(Qy,"__esModule",{value:!0}),Qy.Invert=void 0;const bee=function(t){var e=t.data,n=e.length,r;for(r=0;r<n;r+=4)e[r]=255-e[r],e[r+1]=255-e[r+1],e[r+2]=255-e[r+2]};Qy.Invert=bee;var Zy={};Object.defineProperty(Zy,"__esModule",{value:!0}),Zy.Kaleidoscope=void 0;const Jy=kt,aA=Tn,iA=Ln,oA=Ge;var vee=function(t,e,n){var r=t.data,a=e.data,i=t.width,o=t.height,s=n.polarCenterX||i/2,l=n.polarCenterY||o/2,u,c,d,p=0,f=0,g=0,y=0,x,b=Math.sqrt(s*s+l*l);c=i-s,d=o-l,x=Math.sqrt(c*c+d*d),b=x>b?x:b;var v=o,w=i,S,C,I=360/w*Math.PI/180,_,E;for(C=0;C<w;C+=1)for(_=Math.sin(C*I),E=Math.cos(C*I),S=0;S<v;S+=1)c=Math.floor(s+b*S/v*E),d=Math.floor(l+b*S/v*_),u=(d*i+c)*4,p=r[u+0],f=r[u+1],g=r[u+2],y=r[u+3],u=(C+S*i)*4,a[u+0]=p,a[u+1]=f,a[u+2]=g,a[u+3]=y},xee=function(t,e,n){var r=t.data,a=e.data,i=t.width,o=t.height,s=n.polarCenterX||i/2,l=n.polarCenterY||o/2,u,c,d,p,f,g=0,y=0,x=0,b=0,v,w=Math.sqrt(s*s+l*l);c=i-s,d=o-l,v=Math.sqrt(c*c+d*d),w=v>w?v:w;var S=o,C=i,I,_,E=n.polarRotation||0,A,M;for(c=0;c<i;c+=1)for(d=0;d<o;d+=1)p=c-s,f=d-l,I=Math.sqrt(p*p+f*f)*S/w,_=(Math.atan2(f,p)*180/Math.PI+360+E)%360,_=_*C/360,A=Math.floor(_),M=Math.floor(I),u=(M*i+A)*4,g=r[u+0],y=r[u+1],x=r[u+2],b=r[u+3],u=(d*i+c)*4,a[u+0]=g,a[u+1]=y,a[u+2]=x,a[u+3]=b};const wee=function(t){var e=t.width,n=t.height,r,a,i,o,s,l,u,c,d,p,f=Math.round(this.kaleidoscopePower()),g=Math.round(this.kaleidoscopeAngle()),y=Math.floor(e*(g%360)/360);if(!(f<1)){var x=iA.Util.createCanvasElement();x.width=e,x.height=n;var b=x.getContext("2d").getImageData(0,0,e,n);iA.Util.releaseCanvas(x),vee(t,b,{polarCenterX:e/2,polarCenterY:n/2});for(var v=e/Math.pow(2,f);v<=8;)v=v*2,f-=1;v=Math.ceil(v);var w=v,S=0,C=w,I=1;for(y+v>e&&(S=w,C=0,I=-1),a=0;a<n;a+=1)for(r=S;r!==C;r+=I)i=Math.round(r+y)%e,d=(e*a+i)*4,s=b.data[d+0],l=b.data[d+1],u=b.data[d+2],c=b.data[d+3],p=(e*a+r)*4,b.data[p+0]=s,b.data[p+1]=l,b.data[p+2]=u,b.data[p+3]=c;for(a=0;a<n;a+=1)for(w=Math.floor(v),o=0;o<f;o+=1){for(r=0;r<w+1;r+=1)d=(e*a+r)*4,s=b.data[d+0],l=b.data[d+1],u=b.data[d+2],c=b.data[d+3],p=(e*a+w*2-r-1)*4,b.data[p+0]=s,b.data[p+1]=l,b.data[p+2]=u,b.data[p+3]=c;w*=2}xee(b,t,{polarRotation:0})}};Zy.Kaleidoscope=wee,Jy.Factory.addGetterSetter(aA.Node,"kaleidoscopePower",2,(0,oA.getNumberValidator)(),Jy.Factory.afterSetFilter),Jy.Factory.addGetterSetter(aA.Node,"kaleidoscopeAngle",0,(0,oA.getNumberValidator)(),Jy.Factory.afterSetFilter);var eb={};Object.defineProperty(eb,"__esModule",{value:!0}),eb.Mask=void 0;const sA=kt,kee=Tn,See=Ge;function tb(t,e,n){var r=(n*t.width+e)*4,a=[];return a.push(t.data[r++],t.data[r++],t.data[r++],t.data[r++]),a}function hf(t,e){return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2)+Math.pow(t[2]-e[2],2))}function Cee(t){for(var e=[0,0,0],n=0;n<t.length;n++)e[0]+=t[n][0],e[1]+=t[n][1],e[2]+=t[n][2];return e[0]/=t.length,e[1]/=t.length,e[2]/=t.length,e}function Nee(t,e){var n=tb(t,0,0),r=tb(t,t.width-1,0),a=tb(t,0,t.height-1),i=tb(t,t.width-1,t.height-1),o=e||10;if(hf(n,r)<o&&hf(r,i)<o&&hf(i,a)<o&&hf(a,n)<o){for(var s=Cee([r,n,i,a]),l=[],u=0;u<t.width*t.height;u++){var c=hf(s,[t.data[u*4],t.data[u*4+1],t.data[u*4+2]]);l[u]=c<o?0:255}return l}}function Tee(t,e){for(var n=0;n<t.width*t.height;n++)t.data[4*n+3]=e[n]}function Iee(t,e,n){for(var r=[1,1,1,1,0,1,1,1,1],a=Math.round(Math.sqrt(r.length)),i=Math.floor(a/2),o=[],s=0;s<n;s++)for(var l=0;l<e;l++){for(var u=s*e+l,c=0,d=0;d<a;d++)for(var p=0;p<a;p++){var f=s+d-i,g=l+p-i;if(f>=0&&f<n&&g>=0&&g<e){var y=f*e+g,x=r[d*a+p];c+=t[y]*x}}o[u]=c===255*8?255:0}return o}function Eee(t,e,n){for(var r=[1,1,1,1,1,1,1,1,1],a=Math.round(Math.sqrt(r.length)),i=Math.floor(a/2),o=[],s=0;s<n;s++)for(var l=0;l<e;l++){for(var u=s*e+l,c=0,d=0;d<a;d++)for(var p=0;p<a;p++){var f=s+d-i,g=l+p-i;if(f>=0&&f<n&&g>=0&&g<e){var y=f*e+g,x=r[d*a+p];c+=t[y]*x}}o[u]=c>=255*4?255:0}return o}function _ee(t,e,n){for(var r=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],a=Math.round(Math.sqrt(r.length)),i=Math.floor(a/2),o=[],s=0;s<n;s++)for(var l=0;l<e;l++){for(var u=s*e+l,c=0,d=0;d<a;d++)for(var p=0;p<a;p++){var f=s+d-i,g=l+p-i;if(f>=0&&f<n&&g>=0&&g<e){var y=f*e+g,x=r[d*a+p];c+=t[y]*x}}o[u]=c}return o}const Oee=function(t){var e=this.threshold(),n=Nee(t,e);return n&&(n=Iee(n,t.width,t.height),n=Eee(n,t.width,t.height),n=_ee(n,t.width,t.height),Tee(t,n)),t};eb.Mask=Oee,sA.Factory.addGetterSetter(kee.Node,"threshold",0,(0,See.getNumberValidator)(),sA.Factory.afterSetFilter);var nb={};Object.defineProperty(nb,"__esModule",{value:!0}),nb.Noise=void 0;const lA=kt,$ee=Tn,Ree=Ge,Mee=function(t){var e=this.noise()*255,n=t.data,r=n.length,a=e/2,i;for(i=0;i<r;i+=4)n[i+0]+=a-2*a*Math.random(),n[i+1]+=a-2*a*Math.random(),n[i+2]+=a-2*a*Math.random()};nb.Noise=Mee,lA.Factory.addGetterSetter($ee.Node,"noise",.2,(0,Ree.getNumberValidator)(),lA.Factory.afterSetFilter);var rb={};Object.defineProperty(rb,"__esModule",{value:!0}),rb.Pixelate=void 0;const uA=kt,Aee=Ln,Pee=Tn,Dee=Ge,Lee=function(t){var e=Math.ceil(this.pixelSize()),n=t.width,r=t.height,a,i,o,s,l,u,c,d=Math.ceil(n/e),p=Math.ceil(r/e),f,g,y,x,b,v,w,S=t.data;if(e<=0){Aee.Util.error("pixelSize value can not be <= 0");return}for(b=0;b<d;b+=1)for(v=0;v<p;v+=1){for(s=0,l=0,u=0,c=0,f=b*e,g=f+e,y=v*e,x=y+e,w=0,a=f;a<g;a+=1)if(!(a>=n))for(i=y;i<x;i+=1)i>=r||(o=(n*i+a)*4,s+=S[o+0],l+=S[o+1],u+=S[o+2],c+=S[o+3],w+=1);for(s=s/w,l=l/w,u=u/w,c=c/w,a=f;a<g;a+=1)if(!(a>=n))for(i=y;i<x;i+=1)i>=r||(o=(n*i+a)*4,S[o+0]=s,S[o+1]=l,S[o+2]=u,S[o+3]=c)}};rb.Pixelate=Lee,uA.Factory.addGetterSetter(Pee.Node,"pixelSize",8,(0,Dee.getNumberValidator)(),uA.Factory.afterSetFilter);var ab={};Object.defineProperty(ab,"__esModule",{value:!0}),ab.Posterize=void 0;const cA=kt,Fee=Tn,Bee=Ge,zee=function(t){var e=Math.round(this.levels()*254)+1,n=t.data,r=n.length,a=255/e,i;for(i=0;i<r;i+=1)n[i]=Math.floor(n[i]/a)*a};ab.Posterize=zee,cA.Factory.addGetterSetter(Fee.Node,"levels",.5,(0,Bee.getNumberValidator)(),cA.Factory.afterSetFilter);var ib={};Object.defineProperty(ib,"__esModule",{value:!0}),ib.RGB=void 0;const ob=kt,N3=Tn,Vee=Ge,Wee=function(t){var e=t.data,n=e.length,r=this.red(),a=this.green(),i=this.blue(),o,s;for(o=0;o<n;o+=4)s=(.34*e[o]+.5*e[o+1]+.16*e[o+2])/255,e[o]=s*r,e[o+1]=s*a,e[o+2]=s*i,e[o+3]=e[o+3]};ib.RGB=Wee,ob.Factory.addGetterSetter(N3.Node,"red",0,function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)}),ob.Factory.addGetterSetter(N3.Node,"green",0,function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)}),ob.Factory.addGetterSetter(N3.Node,"blue",0,Vee.RGBComponent,ob.Factory.afterSetFilter);var sb={};Object.defineProperty(sb,"__esModule",{value:!0}),sb.RGBA=void 0;const ff=kt,lb=Tn,jee=Ge,Uee=function(t){var e=t.data,n=e.length,r=this.red(),a=this.green(),i=this.blue(),o=this.alpha(),s,l;for(s=0;s<n;s+=4)l=1-o,e[s]=r*o+e[s]*l,e[s+1]=a*o+e[s+1]*l,e[s+2]=i*o+e[s+2]*l};sb.RGBA=Uee,ff.Factory.addGetterSetter(lb.Node,"red",0,function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)}),ff.Factory.addGetterSetter(lb.Node,"green",0,function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)}),ff.Factory.addGetterSetter(lb.Node,"blue",0,jee.RGBComponent,ff.Factory.afterSetFilter),ff.Factory.addGetterSetter(lb.Node,"alpha",1,function(t){return this._filterUpToDate=!1,t>1?1:t<0?0:t});var ub={};Object.defineProperty(ub,"__esModule",{value:!0}),ub.Sepia=void 0;const Gee=function(t){var e=t.data,n=e.length,r,a,i,o;for(r=0;r<n;r+=4)a=e[r+0],i=e[r+1],o=e[r+2],e[r+0]=Math.min(255,a*.393+i*.769+o*.189),e[r+1]=Math.min(255,a*.349+i*.686+o*.168),e[r+2]=Math.min(255,a*.272+i*.534+o*.131)};ub.Sepia=Gee;var cb={};Object.defineProperty(cb,"__esModule",{value:!0}),cb.Solarize=void 0;const Hee=function(t){var e=t.data,n=t.width,r=t.height,a=n*4,i=r;do{var o=(i-1)*a,s=n;do{var l=o+(s-1)*4,u=e[l],c=e[l+1],d=e[l+2];u>127&&(u=255-u),c>127&&(c=255-c),d>127&&(d=255-d),e[l]=u,e[l+1]=c,e[l+2]=d}while(--s)}while(--i)};cb.Solarize=Hee;var db={};Object.defineProperty(db,"__esModule",{value:!0}),db.Threshold=void 0;const dA=kt,qee=Tn,Kee=Ge,Xee=function(t){var e=this.threshold()*255,n=t.data,r=n.length,a;for(a=0;a<r;a+=1)n[a]=n[a]<e?0:255};db.Threshold=Xee,dA.Factory.addGetterSetter(qee.Node,"threshold",.5,(0,Kee.getNumberValidator)(),dA.Factory.afterSetFilter),Object.defineProperty(uy,"__esModule",{value:!0}),uy.Konva=void 0;const pA=cy,Yee=wy,Qee=Cy,Zee=Iy,Jee=Ey,ete=_y,hA=Rd,tte=lf,nte=_d,rte=cf,ate=Ry,ite=My,ote=Ay,ste=Py,lte=Fu,ute=Ly,cte=Fy,dte=zy,pte=Wy,hte=jy,fte=Uy,mte=Gy,gte=qy,yte=Ky,bte=Xy,vte=Yy,xte=Qy,wte=Zy,kte=eb,Ste=nb,Cte=rb,Nte=ab,Tte=ib,Ite=sb,Ete=ub,_te=cb,Ote=db;uy.Konva=pA.Konva.Util._assign(pA.Konva,{Arc:Yee.Arc,Arrow:Qee.Arrow,Circle:Zee.Circle,Ellipse:Jee.Ellipse,Image:ete.Image,Label:hA.Label,Tag:hA.Tag,Line:tte.Line,Path:nte.Path,Rect:rte.Rect,RegularPolygon:ate.RegularPolygon,Ring:ite.Ring,Sprite:ote.Sprite,Star:ste.Star,Text:lte.Text,TextPath:ute.TextPath,Transformer:cte.Transformer,Wedge:dte.Wedge,Filters:{Blur:pte.Blur,Brighten:hte.Brighten,Contrast:fte.Contrast,Emboss:mte.Emboss,Enhance:gte.Enhance,Grayscale:yte.Grayscale,HSL:bte.HSL,HSV:vte.HSV,Invert:xte.Invert,Kaleidoscope:wte.Kaleidoscope,Mask:kte.Mask,Noise:Ste.Noise,Pixelate:Cte.Pixelate,Posterize:Nte.Posterize,RGB:Tte.RGB,RGBA:Ite.RGBA,Sepia:Ete.Sepia,Solarize:_te.Solarize,Threshold:Ote.Threshold}});var $te=ZM.exports;Object.defineProperty($te,"__esModule",{value:!0});const Rte=uy;ZM.exports=Rte.Konva;var T3={exports:{}};(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.Konva=void 0;var n=cy;Object.defineProperty(e,"Konva",{enumerable:!0,get:function(){return n.Konva}});const r=cy;t.exports=r.Konva})(T3,T3.exports);var Mte=T3.exports;const mf=Hi(Mte);var fA={exports:{}};/**
* @license React
* react-reconciler.production.min.js
*
* Copyright (c) Facebook, Inc. and its affiliates.
*
* This source code is licensed under the MIT license found in the
* LICENSE file in the root directory of this source tree.
*/var Ate=function(t){var e={},n=P,r=lh,a=Object.assign;function i(h){for(var m="https://reactjs.org/docs/error-decoder.html?invariant="+h,k=1;k<arguments.length;k++)m+="&args[]="+encodeURIComponent(arguments[k]);return"Minified React error #"+h+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,s=Symbol.for("react.element"),l=Symbol.for("react.portal"),u=Symbol.for("react.fragment"),c=Symbol.for("react.strict_mode"),d=Symbol.for("react.profiler"),p=Symbol.for("react.provider"),f=Symbol.for("react.context"),g=Symbol.for("react.forward_ref"),y=Symbol.for("react.suspense"),x=Symbol.for("react.suspense_list"),b=Symbol.for("react.memo"),v=Symbol.for("react.lazy"),w=Symbol.for("react.offscreen"),S=Symbol.iterator;function C(h){return h===null||typeof h!="object"?null:(h=S&&h[S]||h["@@iterator"],typeof h=="function"?h:null)}function I(h){if(h==null)return null;if(typeof h=="function")return h.displayName||h.name||null;if(typeof h=="string")return h;switch(h){case u:return"Fragment";case l:return"Portal";case d:return"Profiler";case c:return"StrictMode";case y:return"Suspense";case x:return"SuspenseList"}if(typeof h=="object")switch(h.$$typeof){case f:return(h.displayName||"Context")+".Consumer";case p:return(h._context.displayName||"Context")+".Provider";case g:var m=h.render;return h=h.displayName,h||(h=m.displayName||m.name||"",h=h!==""?"ForwardRef("+h+")":"ForwardRef"),h;case b:return m=h.displayName||null,m!==null?m:I(h.type)||"Memo";case v:m=h._payload,h=h._init;try{return I(h(m))}catch{}}return null}function _(h){var m=h.type;switch(h.tag){case 24:return"Cache";case 9:return(m.displayName||"Context")+".Consumer";case 10:return(m._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return h=m.render,h=h.displayName||h.name||"",m.displayName||(h!==""?"ForwardRef("+h+")":"ForwardRef");case 7:return"Fragment";case 5:return m;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return I(m);case 8:return m===c?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof m=="function")return m.displayName||m.name||null;if(typeof m=="string")return m}return null}function E(h){var m=h,k=h;if(h.alternate)for(;m.return;)m=m.return;else{h=m;do m=h,m.flags&4098&&(k=m.return),h=m.return;while(h)}return m.tag===3?k:null}function A(h){if(E(h)!==h)throw Error(i(188))}function M(h){var m=h.alternate;if(!m){if(m=E(h),m===null)throw Error(i(188));return m!==h?null:h}for(var k=h,N=m;;){var T=k.return;if(T===null)break;var $=T.alternate;if($===null){if(N=T.return,N!==null){k=N;continue}break}if(T.child===$.child){for($=T.child;$;){if($===k)return A(T),h;if($===N)return A(T),m;$=$.sibling}throw Error(i(188))}if(k.return!==N.return)k=T,N=$;else{for(var U=!1,ae=T.child;ae;){if(ae===k){U=!0,k=T,N=$;break}if(ae===N){U=!0,N=T,k=$;break}ae=ae.sibling}if(!U){for(ae=$.child;ae;){if(ae===k){U=!0,k=$,N=T;break}if(ae===N){U=!0,N=$,k=T;break}ae=ae.sibling}if(!U)throw Error(i(189))}}if(k.alternate!==N)throw Error(i(190))}if(k.tag!==3)throw Error(i(188));return k.stateNode.current===k?h:m}function L(h){return h=M(h),h!==null?W(h):null}function W(h){if(h.tag===5||h.tag===6)return h;for(h=h.child;h!==null;){var m=W(h);if(m!==null)return m;h=h.sibling}return null}function B(h){if(h.tag===5||h.tag===6)return h;for(h=h.child;h!==null;){if(h.tag!==4){var m=B(h);if(m!==null)return m}h=h.sibling}return null}var K=Array.isArray,X=t.getPublicInstance,Q=t.getRootHostContext,H=t.getChildHostContext,F=t.prepareForCommit,Y=t.resetAfterCommit,Z=t.createInstance,ne=t.appendInitialChild,se=t.finalizeInitialChildren,ce=t.prepareUpdate,le=t.shouldSetTextContent,ye=t.createTextInstance,we=t.scheduleTimeout,q=t.cancelTimeout,ie=t.noTimeout,de=t.isPrimaryRenderer,ke=t.supportsMutation,Ne=t.supportsPersistence,Ie=t.supportsHydration,De=t.getInstanceFromNode,He=t.preparePortalMount,Me=t.getCurrentEventPriority,it=t.detachDeletedInstance,Ye=t.supportsMicrotasks,Ze=t.scheduleMicrotask,Qe=t.supportsTestSelectors,Xt=t.findFiberRoot,Wt=t.getBoundingRect,Ht=t.getTextContent,Yt=t.isHiddenSubtree,jt=t.matchAccessibilityRole,Tt=t.setFocusIfFocusable,Gn=t.setupIntersectionObserver,gr=t.appendChild,Ga=t.appendChildToContainer,_r=t.commitTextUpdate,Li=t.commitMount,Ls=t.commitUpdate,ho=t.insertBefore,rn=t.insertInContainerBefore,Fi=t.removeChild,Fs=t.removeChildFromContainer,fo=t.resetTextContent,$p=t.hideInstance,Ca=t.hideTextInstance,Rp=t.unhideInstance,Ig=t.unhideTextInstance,eu=t.clearContainer,$t=t.cloneInstance,Eg=t.createContainerChildSet,_g=t.appendChildToContainerChildSet,Mp=t.finalizeContainerChildren,tu=t.replaceContainerChildren,Ap=t.cloneHiddenInstance,kc=t.cloneHiddenTextInstance,Og=t.canHydrateInstance,$g=t.canHydrateTextInstance,Rg=t.canHydrateSuspenseInstance,Pp=t.isSuspenseInstancePending,Sc=t.isSuspenseInstanceFallback,q2=t.getSuspenseInstanceFallbackErrorDetails,K2=t.registerSuspenseInstanceRetry,Bi=t.getNextHydratableSibling,Cc=t.getFirstHydratableChild,X2=t.getFirstHydratableChildWithinContainer,Na=t.getFirstHydratableChildWithinSuspenseInstance,Nc=t.hydrateInstance,Dp=t.hydrateTextInstance,nu=t.hydrateSuspenseInstance,Y2=t.getNextHydratableInstanceAfterSuspenseInstance,Q2=t.commitHydratedContainer,Z2=t.commitHydratedSuspenseInstance,Mg=t.clearSuspenseBoundary,J2=t.clearSuspenseBoundaryFromContainer,Tc=t.shouldDeleteUnhydratedTailInstances,Ag=t.didNotMatchHydratedContainerTextInstance,Lp=t.didNotMatchHydratedTextInstance,Uo;function Mt(h){if(Uo===void 0)try{throw Error()}catch(k){var m=k.stack.trim().match(/\n( *(at )?)/);Uo=m&&m[1]||""}return`
`+Uo+h}var Ic=!1;function Fp(h,m){if(!h||Ic)return"";Ic=!0;var k=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(m)if(m=function(){throw Error()},Object.defineProperty(m.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(m,[])}catch(Te){var N=Te}Reflect.construct(h,[],m)}else{try{m.call()}catch(Te){N=Te}h.call(m.prototype)}else{try{throw Error()}catch(Te){N=Te}h()}}catch(Te){if(Te&&N&&typeof Te.stack=="string"){for(var T=Te.stack.split(`
`),$=N.stack.split(`
`),U=T.length-1,ae=$.length-1;1<=U&&0<=ae&&T[U]!==$[ae];)ae--;for(;1<=U&&0<=ae;U--,ae--)if(T[U]!==$[ae]){if(U!==1||ae!==1)do if(U--,ae--,0>ae||T[U]!==$[ae]){var he=`
`+T[U].replace(" at new "," at ");return h.displayName&&he.includes("<anonymous>")&&(he=he.replace("<anonymous>",h.displayName)),he}while(1<=U&&0<=ae);break}}}finally{Ic=!1,Error.prepareStackTrace=k}return(h=h?h.displayName||h.name:"")?Mt(h):""}var ew=Object.prototype.hasOwnProperty,ru=[],Bs=-1;function li(h){return{current:h}}function an(h){0>Bs||(h.current=ru[Bs],ru[Bs]=null,Bs--)}function Qt(h,m){Bs++,ru[Bs]=h.current,h.current=m}var ui={},yr=li(ui),Hr=li(!1),Go=ui;function zs(h,m){var k=h.type.contextTypes;if(!k)return ui;var N=h.stateNode;if(N&&N.__reactInternalMemoizedUnmaskedChildContext===m)return N.__reactInternalMemoizedMaskedChildContext;var T={},$;for($ in k)T[$]=m[$];return N&&(h=h.stateNode,h.__reactInternalMemoizedUnmaskedChildContext=m,h.__reactInternalMemoizedMaskedChildContext=T),T}function qr(h){return h=h.childContextTypes,h!=null}function Ec(){an(Hr),an(yr)}function Pg(h,m,k){if(yr.current!==ui)throw Error(i(168));Qt(yr,m),Qt(Hr,k)}function kn(h,m,k){var N=h.stateNode;if(m=m.childContextTypes,typeof N.getChildContext!="function")return k;N=N.getChildContext();for(var T in N)if(!(T in m))throw Error(i(108,_(h)||"Unknown",T));return a({},k,N)}function mo(h){return h=(h=h.stateNode)&&h.__reactInternalMemoizedMergedChildContext||ui,Go=yr.current,Qt(yr,h),Qt(Hr,Hr.current),!0}function au(h,m,k){var N=h.stateNode;if(!N)throw Error(i(169));k?(h=kn(h,m,Go),N.__reactInternalMemoizedMergedChildContext=h,an(Hr),an(yr),Qt(yr,h)):an(Hr),Qt(Hr,k)}var Ha=Math.clz32?Math.clz32:tw,Dg=Math.log,Bp=Math.LN2;function tw(h){return h>>>=0,h===0?32:31-(Dg(h)/Bp|0)|0}var _c=64,Ho=4194304;function iu(h){switch(h&-h){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return h&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return h&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return h}}function qo(h,m){var k=h.pendingLanes;if(k===0)return 0;var N=0,T=h.suspendedLanes,$=h.pingedLanes,U=k&268435455;if(U!==0){var ae=U&~T;ae!==0?N=iu(ae):($&=U,$!==0&&(N=iu($)))}else U=k&~T,U!==0?N=iu(U):$!==0&&(N=iu($));if(N===0)return 0;if(m!==0&&m!==N&&!(m&T)&&(T=N&-N,$=m&-m,T>=$||T===16&&($&4194240)!==0))return m;if(N&4&&(N|=k&16),m=h.entangledLanes,m!==0)for(h=h.entanglements,m&=N;0<m;)k=31-Ha(m),T=1<<k,N|=h[k],m&=~T;return N}function D(h,m){switch(h){case 1:case 2:case 4:return m+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return m+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function j(h,m){for(var k=h.suspendedLanes,N=h.pingedLanes,T=h.expirationTimes,$=h.pendingLanes;0<$;){var U=31-Ha($),ae=1<<U,he=T[U];he===-1?(!(ae&k)||ae&N)&&(T[U]=D(ae,m)):he<=m&&(h.expiredLanes|=ae),$&=~ae}}function J(h){return h=h.pendingLanes&-1073741825,h!==0?h:h&1073741824?1073741824:0}function re(){var h=_c;return _c<<=1,!(_c&4194240)&&(_c=64),h}function ge(h){for(var m=[],k=0;31>k;k++)m.push(h);return m}function xe(h,m,k){h.pendingLanes|=m,m!==536870912&&(h.suspendedLanes=0,h.pingedLanes=0),h=h.eventTimes,m=31-Ha(m),h[m]=k}function Oe(h,m){var k=h.pendingLanes&~m;h.pendingLanes=m,h.suspendedLanes=0,h.pingedLanes=0,h.expiredLanes&=m,h.mutableReadLanes&=m,h.entangledLanes&=m,m=h.entanglements;var N=h.eventTimes;for(h=h.expirationTimes;0<k;){var T=31-Ha(k),$=1<<T;m[T]=0,N[T]=-1,h[T]=-1,k&=~$}}function Ee(h,m){var k=h.entangledLanes|=m;for(h=h.entanglements;k;){var N=31-Ha(k),T=1<<N;T&m|h[N]&m&&(h[N]|=m),k&=~T}}var Ce=0;function Le(h){return h&=-h,1<h?4<h?h&268435455?16:536870912:4:1}var st=r.unstable_scheduleCallback,Ke=r.unstable_cancelCallback,bt=r.unstable_shouldYield,ct=r.unstable_requestPaint,je=r.unstable_now,tt=r.unstable_ImmediatePriority,rt=r.unstable_UserBlockingPriority,Xe=r.unstable_NormalPriority,dt=r.unstable_IdlePriority,et=null,ut=null;function Fn(h){if(ut&&typeof ut.onCommitFiberRoot=="function")try{ut.onCommitFiberRoot(et,h,void 0,(h.current.flags&128)===128)}catch{}}function Ta(h,m){return h===m&&(h!==0||1/h===1/m)||h!==h&&m!==m}var It=typeof Object.is=="function"?Object.is:Ta,Sn=null,yn=!1,Kr=!1;function fa(h){Sn===null?Sn=[h]:Sn.push(h)}function zi(h){yn=!0,fa(h)}function Yn(){if(!Kr&&Sn!==null){Kr=!0;var h=0,m=Ce;try{var k=Sn;for(Ce=1;h<k.length;h++){var N=k[h];do N=N(!0);while(N!==null)}Sn=null,yn=!1}catch(T){throw Sn!==null&&(Sn=Sn.slice(h+1)),st(tt,Yn),T}finally{Ce=m,Kr=!1}}return null}var at=[],yt=0,Qn=null,Zn=0,qt=[],hn=0,Or=null,Vi=1,$r="";function Ko(h,m){at[yt++]=Zn,at[yt++]=Qn,Qn=h,Zn=m}function zp(h,m,k){qt[hn++]=Vi,qt[hn++]=$r,qt[hn++]=Or,Or=h;var N=Vi;h=$r;var T=32-Ha(N)-1;N&=~(1<<T),k+=1;var $=32-Ha(m)+T;if(30<$){var U=T-T%5;$=(N&(1<<U)-1).toString(32),N>>=U,T-=U,Vi=1<<32-Ha(m)+T|k<<T|N,$r=$+h}else Vi=1<<$|k<<T|N,$r=h}function ma(h){h.return!==null&&(Ko(h,1),zp(h,1,0))}function Xo(h){for(;h===Qn;)Qn=at[--yt],at[yt]=null,Zn=at[--yt],at[yt]=null;for(;h===Or;)Or=qt[--hn],qt[hn]=null,$r=qt[--hn],qt[hn]=null,Vi=qt[--hn],qt[hn]=null}var Bn=null,Rr=null,Bt=!1,Yo=!1,Wi=null;function AE(h,m){var k=fi(5,null,null,0);k.elementType="DELETED",k.stateNode=m,k.return=h,m=h.deletions,m===null?(h.deletions=[k],h.flags|=16):m.push(k)}function PE(h,m){switch(h.tag){case 5:return m=Og(m,h.type,h.pendingProps),m!==null?(h.stateNode=m,Bn=h,Rr=Cc(m),!0):!1;case 6:return m=$g(m,h.pendingProps),m!==null?(h.stateNode=m,Bn=h,Rr=null,!0):!1;case 13:if(m=Rg(m),m!==null){var k=Or!==null?{id:Vi,overflow:$r}:null;return h.memoizedState={dehydrated:m,treeContext:k,retryLane:1073741824},k=fi(18,null,null,0),k.stateNode=m,k.return=h,h.child=k,Bn=h,Rr=null,!0}return!1;default:return!1}}function nw(h){return(h.mode&1)!==0&&(h.flags&128)===0}function rw(h){if(Bt){var m=Rr;if(m){var k=m;if(!PE(h,m)){if(nw(h))throw Error(i(418));m=Bi(k);var N=Bn;m&&PE(h,m)?AE(N,k):(h.flags=h.flags&-4097|2,Bt=!1,Bn=h)}}else{if(nw(h))throw Error(i(418));h.flags=h.flags&-4097|2,Bt=!1,Bn=h}}}function DE(h){for(h=h.return;h!==null&&h.tag!==5&&h.tag!==3&&h.tag!==13;)h=h.return;Bn=h}function Lg(h){if(!Ie||h!==Bn)return!1;if(!Bt)return DE(h),Bt=!0,!1;if(h.tag!==3&&(h.tag!==5||Tc(h.type)&&!le(h.type,h.memoizedProps))){var m=Rr;if(m){if(nw(h))throw LE(),Error(i(418));for(;m;)AE(h,m),m=Bi(m)}}if(DE(h),h.tag===13){if(!Ie)throw Error(i(316));if(h=h.memoizedState,h=h!==null?h.dehydrated:null,!h)throw Error(i(317));Rr=Y2(h)}else Rr=Bn?Bi(h.stateNode):null;return!0}function LE(){for(var h=Rr;h;)h=Bi(h)}function Oc(){Ie&&(Rr=Bn=null,Yo=Bt=!1)}function aw(h){Wi===null?Wi=[h]:Wi.push(h)}var eV=o.ReactCurrentBatchConfig;function Fg(h,m){if(It(h,m))return!0;if(typeof h!="object"||h===null||typeof m!="object"||m===null)return!1;var k=Object.keys(h),N=Object.keys(m);if(k.length!==N.length)return!1;for(N=0;N<k.length;N++){var T=k[N];if(!ew.call(m,T)||!It(h[T],m[T]))return!1}return!0}function tV(h){switch(h.tag){case 5:return Mt(h.type);case 16:return Mt("Lazy");case 13:return Mt("Suspense");case 19:return Mt("SuspenseList");case 0:case 2:case 15:return h=Fp(h.type,!1),h;case 11:return h=Fp(h.type.render,!1),h;case 1:return h=Fp(h.type,!0),h;default:return""}}function ji(h,m){if(h&&h.defaultProps){m=a({},m),h=h.defaultProps;for(var k in h)m[k]===void 0&&(m[k]=h[k]);return m}return m}var Bg=li(null),zg=null,$c=null,iw=null;function ow(){iw=$c=zg=null}function FE(h,m,k){de?(Qt(Bg,m._currentValue),m._currentValue=k):(Qt(Bg,m._currentValue2),m._currentValue2=k)}function sw(h){var m=Bg.current;an(Bg),de?h._currentValue=m:h._currentValue2=m}function lw(h,m,k){for(;h!==null;){var N=h.alternate;if((h.childLanes&m)!==m?(h.childLanes|=m,N!==null&&(N.childLanes|=m)):N!==null&&(N.childLanes&m)!==m&&(N.childLanes|=m),h===k)break;h=h.return}}function Rc(h,m){zg=h,iw=$c=null,h=h.dependencies,h!==null&&h.firstContext!==null&&(h.lanes&m&&(Ia=!0),h.firstContext=null)}function ci(h){var m=de?h._currentValue:h._currentValue2;if(iw!==h)if(h={context:h,memoizedValue:m,next:null},$c===null){if(zg===null)throw Error(i(308));$c=h,zg.dependencies={lanes:0,firstContext:h}}else $c=$c.next=h;return m}var ou=null;function uw(h){ou===null?ou=[h]:ou.push(h)}function BE(h,m,k,N){var T=m.interleaved;return T===null?(k.next=k,uw(m)):(k.next=T.next,T.next=k),m.interleaved=k,go(h,N)}function go(h,m){h.lanes|=m;var k=h.alternate;for(k!==null&&(k.lanes|=m),k=h,h=h.return;h!==null;)h.childLanes|=m,k=h.alternate,k!==null&&(k.childLanes|=m),k=h,h=h.return;return k.tag===3?k.stateNode:null}var Vs=!1;function cw(h){h.updateQueue={baseState:h.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function zE(h,m){h=h.updateQueue,m.updateQueue===h&&(m.updateQueue={baseState:h.baseState,firstBaseUpdate:h.firstBaseUpdate,lastBaseUpdate:h.lastBaseUpdate,shared:h.shared,effects:h.effects})}function Qo(h,m){return{eventTime:h,lane:m,tag:0,payload:null,callback:null,next:null}}function Ws(h,m,k){var N=h.updateQueue;if(N===null)return null;if(N=N.shared,Ct&2){var T=N.pending;return T===null?m.next=m:(m.next=T.next,T.next=m),N.pending=m,go(h,k)}return T=N.interleaved,T===null?(m.next=m,uw(N)):(m.next=T.next,T.next=m),N.interleaved=m,go(h,k)}function Vg(h,m,k){if(m=m.updateQueue,m!==null&&(m=m.shared,(k&4194240)!==0)){var N=m.lanes;N&=h.pendingLanes,k|=N,m.lanes=k,Ee(h,k)}}function VE(h,m){var k=h.updateQueue,N=h.alternate;if(N!==null&&(N=N.updateQueue,k===N)){var T=null,$=null;if(k=k.firstBaseUpdate,k!==null){do{var U={eventTime:k.eventTime,lane:k.lane,tag:k.tag,payload:k.payload,callback:k.callback,next:null};$===null?T=$=U:$=$.next=U,k=k.next}while(k!==null);$===null?T=$=m:$=$.next=m}else T=$=m;k={baseState:N.baseState,firstBaseUpdate:T,lastBaseUpdate:$,shared:N.shared,effects:N.effects},h.updateQueue=k;return}h=k.lastBaseUpdate,h===null?k.firstBaseUpdate=m:h.next=m,k.lastBaseUpdate=m}function Wg(h,m,k,N){var T=h.updateQueue;Vs=!1;var $=T.firstBaseUpdate,U=T.lastBaseUpdate,ae=T.shared.pending;if(ae!==null){T.shared.pending=null;var he=ae,Te=he.next;he.next=null,U===null?$=Te:U.next=Te,U=he;var We=h.alternate;We!==null&&(We=We.updateQueue,ae=We.lastBaseUpdate,ae!==U&&(ae===null?We.firstBaseUpdate=Te:ae.next=Te,We.lastBaseUpdate=he))}if($!==null){var ht=T.baseState;U=0,We=Te=he=null,ae=$;do{var Ae=ae.lane,bn=ae.eventTime;if((N&Ae)===Ae){We!==null&&(We=We.next={eventTime:bn,lane:0,tag:ae.tag,payload:ae.payload,callback:ae.callback,next:null});e:{var on=h,Oa=ae;switch(Ae=m,bn=k,Oa.tag){case 1:if(on=Oa.payload,typeof on=="function"){ht=on.call(bn,ht,Ae);break e}ht=on;break e;case 3:on.flags=on.flags&-65537|128;case 0:if(on=Oa.payload,Ae=typeof on=="function"?on.call(bn,ht,Ae):on,Ae==null)break e;ht=a({},ht,Ae);break e;case 2:Vs=!0}}ae.callback!==null&&ae.lane!==0&&(h.flags|=64,Ae=T.effects,Ae===null?T.effects=[ae]:Ae.push(ae))}else bn={eventTime:bn,lane:Ae,tag:ae.tag,payload:ae.payload,callback:ae.callback,next:null},We===null?(Te=We=bn,he=ht):We=We.next=bn,U|=Ae;if(ae=ae.next,ae===null){if(ae=T.shared.pending,ae===null)break;Ae=ae,ae=Ae.next,Ae.next=null,T.lastBaseUpdate=Ae,T.shared.pending=null}}while(!0);if(We===null&&(he=ht),T.baseState=he,T.firstBaseUpdate=Te,T.lastBaseUpdate=We,m=T.shared.interleaved,m!==null){T=m;do U|=T.lane,T=T.next;while(T!==m)}else $===null&&(T.shared.lanes=0);lu|=U,h.lanes=U,h.memoizedState=ht}}function WE(h,m,k){if(h=m.effects,m.effects=null,h!==null)for(m=0;m<h.length;m++){var N=h[m],T=N.callback;if(T!==null){if(N.callback=null,N=k,typeof T!="function")throw Error(i(191,T));T.call(N)}}}var jE=new n.Component().refs;function dw(h,m,k,N){m=h.memoizedState,k=k(N,m),k=k==null?m:a({},m,k),h.memoizedState=k,h.lanes===0&&(h.updateQueue.baseState=k)}var jg={isMounted:function(h){return(h=h._reactInternals)?E(h)===h:!1},enqueueSetState:function(h,m,k){h=h._reactInternals;var N=Zr(),T=Gs(h),$=Qo(N,T);$.payload=m,k!=null&&($.callback=k),m=Ws(h,$,T),m!==null&&(hi(m,h,T,N),Vg(m,h,T))},enqueueReplaceState:function(h,m,k){h=h._reactInternals;var N=Zr(),T=Gs(h),$=Qo(N,T);$.tag=1,$.payload=m,k!=null&&($.callback=k),m=Ws(h,$,T),m!==null&&(hi(m,h,T,N),Vg(m,h,T))},enqueueForceUpdate:function(h,m){h=h._reactInternals;var k=Zr(),N=Gs(h),T=Qo(k,N);T.tag=2,m!=null&&(T.callback=m),m=Ws(h,T,N),m!==null&&(hi(m,h,N,k),Vg(m,h,N))}};function UE(h,m,k,N,T,$,U){return h=h.stateNode,typeof h.shouldComponentUpdate=="function"?h.shouldComponentUpdate(N,$,U):m.prototype&&m.prototype.isPureReactComponent?!Fg(k,N)||!Fg(T,$):!0}function GE(h,m,k){var N=!1,T=ui,$=m.contextType;return typeof $=="object"&&$!==null?$=ci($):(T=qr(m)?Go:yr.current,N=m.contextTypes,$=(N=N!=null)?zs(h,T):ui),m=new m(k,$),h.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,m.updater=jg,h.stateNode=m,m._reactInternals=h,N&&(h=h.stateNode,h.__reactInternalMemoizedUnmaskedChildContext=T,h.__reactInternalMemoizedMaskedChildContext=$),m}function HE(h,m,k,N){h=m.state,typeof m.componentWillReceiveProps=="function"&&m.componentWillReceiveProps(k,N),typeof m.UNSAFE_componentWillReceiveProps=="function"&&m.UNSAFE_componentWillReceiveProps(k,N),m.state!==h&&jg.enqueueReplaceState(m,m.state,null)}function pw(h,m,k,N){var T=h.stateNode;T.props=k,T.state=h.memoizedState,T.refs=jE,cw(h);var $=m.contextType;typeof $=="object"&&$!==null?T.context=ci($):($=qr(m)?Go:yr.current,T.context=zs(h,$)),T.state=h.memoizedState,$=m.getDerivedStateFromProps,typeof $=="function"&&(dw(h,m,$,k),T.state=h.memoizedState),typeof m.getDerivedStateFromProps=="function"||typeof T.getSnapshotBeforeUpdate=="function"||typeof T.UNSAFE_componentWillMount!="function"&&typeof T.componentWillMount!="function"||(m=T.state,typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount(),m!==T.state&&jg.enqueueReplaceState(T,T.state,null),Wg(h,k,T,N),T.state=h.memoizedState),typeof T.componentDidMount=="function"&&(h.flags|=4194308)}function Vp(h,m,k){if(h=k.ref,h!==null&&typeof h!="function"&&typeof h!="object"){if(k._owner){if(k=k._owner,k){if(k.tag!==1)throw Error(i(309));var N=k.stateNode}if(!N)throw Error(i(147,h));var T=N,$=""+h;return m!==null&&m.ref!==null&&typeof m.ref=="function"&&m.ref._stringRef===$?m.ref:(m=function(U){var ae=T.refs;ae===jE&&(ae=T.refs={}),U===null?delete ae[$]:ae[$]=U},m._stringRef=$,m)}if(typeof h!="string")throw Error(i(284));if(!k._owner)throw Error(i(290,h))}return h}function Ug(h,m){throw h=Object.prototype.toString.call(m),Error(i(31,h==="[object Object]"?"object with keys {"+Object.keys(m).join(", ")+"}":h))}function qE(h){var m=h._init;return m(h._payload)}function KE(h){function m(pe,oe){if(h){var be=pe.deletions;be===null?(pe.deletions=[oe],pe.flags|=16):be.push(oe)}}function k(pe,oe){if(!h)return null;for(;oe!==null;)m(pe,oe),oe=oe.sibling;return null}function N(pe,oe){for(pe=new Map;oe!==null;)oe.key!==null?pe.set(oe.key,oe):pe.set(oe.index,oe),oe=oe.sibling;return pe}function T(pe,oe){return pe=qs(pe,oe),pe.index=0,pe.sibling=null,pe}function $(pe,oe,be){return pe.index=be,h?(be=pe.alternate,be!==null?(be=be.index,be<oe?(pe.flags|=2,oe):be):(pe.flags|=2,oe)):(pe.flags|=1048576,oe)}function U(pe){return h&&pe.alternate===null&&(pe.flags|=2),pe}function ae(pe,oe,be,Pe){return oe===null||oe.tag!==6?(oe=Zw(be,pe.mode,Pe),oe.return=pe,oe):(oe=T(oe,be),oe.return=pe,oe)}function he(pe,oe,be,Pe){var nt=be.type;return nt===u?We(pe,oe,be.props.children,Pe,be.key):oe!==null&&(oe.elementType===nt||typeof nt=="object"&&nt!==null&&nt.$$typeof===v&&qE(nt)===oe.type)?(Pe=T(oe,be.props),Pe.ref=Vp(pe,oe,be),Pe.return=pe,Pe):(Pe=g0(be.type,be.key,be.props,null,pe.mode,Pe),Pe.ref=Vp(pe,oe,be),Pe.return=pe,Pe)}function Te(pe,oe,be,Pe){return oe===null||oe.tag!==4||oe.stateNode.containerInfo!==be.containerInfo||oe.stateNode.implementation!==be.implementation?(oe=Jw(be,pe.mode,Pe),oe.return=pe,oe):(oe=T(oe,be.children||[]),oe.return=pe,oe)}function We(pe,oe,be,Pe,nt){return oe===null||oe.tag!==7?(oe=pu(be,pe.mode,Pe,nt),oe.return=pe,oe):(oe=T(oe,be),oe.return=pe,oe)}function ht(pe,oe,be){if(typeof oe=="string"&&oe!==""||typeof oe=="number")return oe=Zw(""+oe,pe.mode,be),oe.return=pe,oe;if(typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case s:return be=g0(oe.type,oe.key,oe.props,null,pe.mode,be),be.ref=Vp(pe,null,oe),be.return=pe,be;case l:return oe=Jw(oe,pe.mode,be),oe.return=pe,oe;case v:var Pe=oe._init;return ht(pe,Pe(oe._payload),be)}if(K(oe)||C(oe))return oe=pu(oe,pe.mode,be,null),oe.return=pe,oe;Ug(pe,oe)}return null}function Ae(pe,oe,be,Pe){var nt=oe!==null?oe.key:null;if(typeof be=="string"&&be!==""||typeof be=="number")return nt!==null?null:ae(pe,oe,""+be,Pe);if(typeof be=="object"&&be!==null){switch(be.$$typeof){case s:return be.key===nt?he(pe,oe,be,Pe):null;case l:return be.key===nt?Te(pe,oe,be,Pe):null;case v:return nt=be._init,Ae(pe,oe,nt(be._payload),Pe)}if(K(be)||C(be))return nt!==null?null:We(pe,oe,be,Pe,null);Ug(pe,be)}return null}function bn(pe,oe,be,Pe,nt){if(typeof Pe=="string"&&Pe!==""||typeof Pe=="number")return pe=pe.get(be)||null,ae(oe,pe,""+Pe,nt);if(typeof Pe=="object"&&Pe!==null){switch(Pe.$$typeof){case s:return pe=pe.get(Pe.key===null?be:Pe.key)||null,he(oe,pe,Pe,nt);case l:return pe=pe.get(Pe.key===null?be:Pe.key)||null,Te(oe,pe,Pe,nt);case v:var vt=Pe._init;return bn(pe,oe,be,vt(Pe._payload),nt)}if(K(Pe)||C(Pe))return pe=pe.get(be)||null,We(oe,pe,Pe,nt,null);Ug(oe,Pe)}return null}function on(pe,oe,be,Pe){for(var nt=null,vt=null,ft=oe,zt=oe=0,xr=null;ft!==null&&zt<be.length;zt++){ft.index>zt?(xr=ft,ft=null):xr=ft.sibling;var Vt=Ae(pe,ft,be[zt],Pe);if(Vt===null){ft===null&&(ft=xr);break}h&&ft&&Vt.alternate===null&&m(pe,ft),oe=$(Vt,oe,zt),vt===null?nt=Vt:vt.sibling=Vt,vt=Vt,ft=xr}if(zt===be.length)return k(pe,ft),Bt&&Ko(pe,zt),nt;if(ft===null){for(;zt<be.length;zt++)ft=ht(pe,be[zt],Pe),ft!==null&&(oe=$(ft,oe,zt),vt===null?nt=ft:vt.sibling=ft,vt=ft);return Bt&&Ko(pe,zt),nt}for(ft=N(pe,ft);zt<be.length;zt++)xr=bn(ft,pe,zt,be[zt],Pe),xr!==null&&(h&&xr.alternate!==null&&ft.delete(xr.key===null?zt:xr.key),oe=$(xr,oe,zt),vt===null?nt=xr:vt.sibling=xr,vt=xr);return h&&ft.forEach(function(Ks){return m(pe,Ks)}),Bt&&Ko(pe,zt),nt}function Oa(pe,oe,be,Pe){var nt=C(be);if(typeof nt!="function")throw Error(i(150));if(be=nt.call(be),be==null)throw Error(i(151));for(var vt=nt=null,ft=oe,zt=oe=0,xr=null,Vt=be.next();ft!==null&&!Vt.done;zt++,Vt=be.next()){ft.index>zt?(xr=ft,ft=null):xr=ft.sibling;var Ks=Ae(pe,ft,Vt.value,Pe);if(Ks===null){ft===null&&(ft=xr);break}h&&ft&&Ks.alternate===null&&m(pe,ft),oe=$(Ks,oe,zt),vt===null?nt=Ks:vt.sibling=Ks,vt=Ks,ft=xr}if(Vt.done)return k(pe,ft),Bt&&Ko(pe,zt),nt;if(ft===null){for(;!Vt.done;zt++,Vt=be.next())Vt=ht(pe,Vt.value,Pe),Vt!==null&&(oe=$(Vt,oe,zt),vt===null?nt=Vt:vt.sibling=Vt,vt=Vt);return Bt&&Ko(pe,zt),nt}for(ft=N(pe,ft);!Vt.done;zt++,Vt=be.next())Vt=bn(ft,pe,zt,Vt.value,Pe),Vt!==null&&(h&&Vt.alternate!==null&&ft.delete(Vt.key===null?zt:Vt.key),oe=$(Vt,oe,zt),vt===null?nt=Vt:vt.sibling=Vt,vt=Vt);return h&&ft.forEach(function($V){return m(pe,$V)}),Bt&&Ko(pe,zt),nt}function es(pe,oe,be,Pe){if(typeof be=="object"&&be!==null&&be.type===u&&be.key===null&&(be=be.props.children),typeof be=="object"&&be!==null){switch(be.$$typeof){case s:e:{for(var nt=be.key,vt=oe;vt!==null;){if(vt.key===nt){if(nt=be.type,nt===u){if(vt.tag===7){k(pe,vt.sibling),oe=T(vt,be.props.children),oe.return=pe,pe=oe;break e}}else if(vt.elementType===nt||typeof nt=="object"&&nt!==null&&nt.$$typeof===v&&qE(nt)===vt.type){k(pe,vt.sibling),oe=T(vt,be.props),oe.ref=Vp(pe,vt,be),oe.return=pe,pe=oe;break e}k(pe,vt);break}else m(pe,vt);vt=vt.sibling}be.type===u?(oe=pu(be.props.children,pe.mode,Pe,be.key),oe.return=pe,pe=oe):(Pe=g0(be.type,be.key,be.props,null,pe.mode,Pe),Pe.ref=Vp(pe,oe,be),Pe.return=pe,pe=Pe)}return U(pe);case l:e:{for(vt=be.key;oe!==null;){if(oe.key===vt)if(oe.tag===4&&oe.stateNode.containerInfo===be.containerInfo&&oe.stateNode.implementation===be.implementation){k(pe,oe.sibling),oe=T(oe,be.children||[]),oe.return=pe,pe=oe;break e}else{k(pe,oe);break}else m(pe,oe);oe=oe.sibling}oe=Jw(be,pe.mode,Pe),oe.return=pe,pe=oe}return U(pe);case v:return vt=be._init,es(pe,oe,vt(be._payload),Pe)}if(K(be))return on(pe,oe,be,Pe);if(C(be))return Oa(pe,oe,be,Pe);Ug(pe,be)}return typeof be=="string"&&be!==""||typeof be=="number"?(be=""+be,oe!==null&&oe.tag===6?(k(pe,oe.sibling),oe=T(oe,be),oe.return=pe,pe=oe):(k(pe,oe),oe=Zw(be,pe.mode,Pe),oe.return=pe,pe=oe),U(pe)):k(pe,oe)}return es}var Mc=KE(!0),XE=KE(!1),Wp={},di=li(Wp),jp=li(Wp),Ac=li(Wp);function yo(h){if(h===Wp)throw Error(i(174));return h}function hw(h,m){Qt(Ac,m),Qt(jp,h),Qt(di,Wp),h=Q(m),an(di),Qt(di,h)}function Pc(){an(di),an(jp),an(Ac)}function YE(h){var m=yo(Ac.current),k=yo(di.current);m=H(k,h.type,m),k!==m&&(Qt(jp,h),Qt(di,m))}function fw(h){jp.current===h&&(an(di),an(jp))}var On=li(0);function Gg(h){for(var m=h;m!==null;){if(m.tag===13){var k=m.memoizedState;if(k!==null&&(k=k.dehydrated,k===null||Pp(k)||Sc(k)))return m}else if(m.tag===19&&m.memoizedProps.revealOrder!==void 0){if(m.flags&128)return m}else if(m.child!==null){m.child.return=m,m=m.child;continue}if(m===h)break;for(;m.sibling===null;){if(m.return===null||m.return===h)return null;m=m.return}m.sibling.return=m.return,m=m.sibling}return null}var mw=[];function gw(){for(var h=0;h<mw.length;h++){var m=mw[h];de?m._workInProgressVersionPrimary=null:m._workInProgressVersionSecondary=null}mw.length=0}var Hg=o.ReactCurrentDispatcher,yw=o.ReactCurrentBatchConfig,su=0,$n=null,ir=null,br=null,qg=!1,Up=!1,Gp=0,nV=0;function Xr(){throw Error(i(321))}function bw(h,m){if(m===null)return!1;for(var k=0;k<m.length&&k<h.length;k++)if(!It(h[k],m[k]))return!1;return!0}function vw(h,m,k,N,T,$){if(su=$,$n=m,m.memoizedState=null,m.updateQueue=null,m.lanes=0,Hg.current=h===null||h.memoizedState===null?oV:sV,h=k(N,T),Up){$=0;do{if(Up=!1,Gp=0,25<=$)throw Error(i(301));$+=1,br=ir=null,m.updateQueue=null,Hg.current=lV,h=k(N,T)}while(Up)}if(Hg.current=Yg,m=ir!==null&&ir.next!==null,su=0,br=ir=$n=null,qg=!1,m)throw Error(i(300));return h}function xw(){var h=Gp!==0;return Gp=0,h}function bo(){var h={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return br===null?$n.memoizedState=br=h:br=br.next=h,br}function pi(){if(ir===null){var h=$n.alternate;h=h!==null?h.memoizedState:null}else h=ir.next;var m=br===null?$n.memoizedState:br.next;if(m!==null)br=m,ir=h;else{if(h===null)throw Error(i(310));ir=h,h={memoizedState:ir.memoizedState,baseState:ir.baseState,baseQueue:ir.baseQueue,queue:ir.queue,next:null},br===null?$n.memoizedState=br=h:br=br.next=h}return br}function Hp(h,m){return typeof m=="function"?m(h):m}function ww(h){var m=pi(),k=m.queue;if(k===null)throw Error(i(311));k.lastRenderedReducer=h;var N=ir,T=N.baseQueue,$=k.pending;if($!==null){if(T!==null){var U=T.next;T.next=$.next,$.next=U}N.baseQueue=T=$,k.pending=null}if(T!==null){$=T.next,N=N.baseState;var ae=U=null,he=null,Te=$;do{var We=Te.lane;if((su&We)===We)he!==null&&(he=he.next={lane:0,action:Te.action,hasEagerState:Te.hasEagerState,eagerState:Te.eagerState,next:null}),N=Te.hasEagerState?Te.eagerState:h(N,Te.action);else{var ht={lane:We,action:Te.action,hasEagerState:Te.hasEagerState,eagerState:Te.eagerState,next:null};he===null?(ae=he=ht,U=N):he=he.next=ht,$n.lanes|=We,lu|=We}Te=Te.next}while(Te!==null&&Te!==$);he===null?U=N:he.next=ae,It(N,m.memoizedState)||(Ia=!0),m.memoizedState=N,m.baseState=U,m.baseQueue=he,k.lastRenderedState=N}if(h=k.interleaved,h!==null){T=h;do $=T.lane,$n.lanes|=$,lu|=$,T=T.next;while(T!==h)}else T===null&&(k.lanes=0);return[m.memoizedState,k.dispatch]}function kw(h){var m=pi(),k=m.queue;if(k===null)throw Error(i(311));k.lastRenderedReducer=h;var N=k.dispatch,T=k.pending,$=m.memoizedState;if(T!==null){k.pending=null;var U=T=T.next;do $=h($,U.action),U=U.next;while(U!==T);It($,m.memoizedState)||(Ia=!0),m.memoizedState=$,m.baseQueue===null&&(m.baseState=$),k.lastRenderedState=$}return[$,N]}function QE(){}function ZE(h,m){var k=$n,N=pi(),T=m(),$=!It(N.memoizedState,T);if($&&(N.memoizedState=T,Ia=!0),N=N.queue,Sw(t_.bind(null,k,N,h),[h]),N.getSnapshot!==m||$||br!==null&&br.memoizedState.tag&1){if(k.flags|=2048,qp(9,e_.bind(null,k,N,T,m),void 0,null),vr===null)throw Error(i(349));su&30||JE(k,m,T)}return T}function JE(h,m,k){h.flags|=16384,h={getSnapshot:m,value:k},m=$n.updateQueue,m===null?(m={lastEffect:null,stores:null},$n.updateQueue=m,m.stores=[h]):(k=m.stores,k===null?m.stores=[h]:k.push(h))}function e_(h,m,k,N){m.value=k,m.getSnapshot=N,n_(m)&&r_(h)}function t_(h,m,k){return k(function(){n_(m)&&r_(h)})}function n_(h){var m=h.getSnapshot;h=h.value;try{var k=m();return!It(h,k)}catch{return!0}}function r_(h){var m=go(h,1);m!==null&&hi(m,h,1,-1)}function a_(h){var m=bo();return typeof h=="function"&&(h=h()),m.memoizedState=m.baseState=h,h={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Hp,lastRenderedState:h},m.queue=h,h=h.dispatch=iV.bind(null,$n,h),[m.memoizedState,h]}function qp(h,m,k,N){return h={tag:h,create:m,destroy:k,deps:N,next:null},m=$n.updateQueue,m===null?(m={lastEffect:null,stores:null},$n.updateQueue=m,m.lastEffect=h.next=h):(k=m.lastEffect,k===null?m.lastEffect=h.next=h:(N=k.next,k.next=h,h.next=N,m.lastEffect=h)),h}function i_(){return pi().memoizedState}function Kg(h,m,k,N){var T=bo();$n.flags|=h,T.memoizedState=qp(1|m,k,void 0,N===void 0?null:N)}function Xg(h,m,k,N){var T=pi();N=N===void 0?null:N;var $=void 0;if(ir!==null){var U=ir.memoizedState;if($=U.destroy,N!==null&&bw(N,U.deps)){T.memoizedState=qp(m,k,$,N);return}}$n.flags|=h,T.memoizedState=qp(1|m,k,$,N)}function o_(h,m){return Kg(8390656,8,h,m)}function Sw(h,m){return Xg(2048,8,h,m)}function s_(h,m){return Xg(4,2,h,m)}function l_(h,m){return Xg(4,4,h,m)}function u_(h,m){if(typeof m=="function")return h=h(),m(h),function(){m(null)};if(m!=null)return h=h(),m.current=h,function(){m.current=null}}function c_(h,m,k){return k=k!=null?k.concat([h]):null,Xg(4,4,u_.bind(null,m,h),k)}function Cw(){}function d_(h,m){var k=pi();m=m===void 0?null:m;var N=k.memoizedState;return N!==null&&m!==null&&bw(m,N[1])?N[0]:(k.memoizedState=[h,m],h)}function p_(h,m){var k=pi();m=m===void 0?null:m;var N=k.memoizedState;return N!==null&&m!==null&&bw(m,N[1])?N[0]:(h=h(),k.memoizedState=[h,m],h)}function h_(h,m,k){return su&21?(It(k,m)||(k=re(),$n.lanes|=k,lu|=k,h.baseState=!0),m):(h.baseState&&(h.baseState=!1,Ia=!0),h.memoizedState=k)}function rV(h,m){var k=Ce;Ce=k!==0&&4>k?k:4,h(!0);var N=yw.transition;yw.transition={};try{h(!1),m()}finally{Ce=k,yw.transition=N}}function f_(){return pi().memoizedState}function aV(h,m,k){var N=Gs(h);if(k={lane:N,action:k,hasEagerState:!1,eagerState:null,next:null},m_(h))g_(m,k);else if(k=BE(h,m,k,N),k!==null){var T=Zr();hi(k,h,N,T),y_(k,m,N)}}function iV(h,m,k){var N=Gs(h),T={lane:N,action:k,hasEagerState:!1,eagerState:null,next:null};if(m_(h))g_(m,T);else{var $=h.alternate;if(h.lanes===0&&($===null||$.lanes===0)&&($=m.lastRenderedReducer,$!==null))try{var U=m.lastRenderedState,ae=$(U,k);if(T.hasEagerState=!0,T.eagerState=ae,It(ae,U)){var he=m.interleaved;he===null?(T.next=T,uw(m)):(T.next=he.next,he.next=T),m.interleaved=T;return}}catch{}finally{}k=BE(h,m,T,N),k!==null&&(T=Zr(),hi(k,h,N,T),y_(k,m,N))}}function m_(h){var m=h.alternate;return h===$n||m!==null&&m===$n}function g_(h,m){Up=qg=!0;var k=h.pending;k===null?m.next=m:(m.next=k.next,k.next=m),h.pending=m}function y_(h,m,k){if(k&4194240){var N=m.lanes;N&=h.pendingLanes,k|=N,m.lanes=k,Ee(h,k)}}var Yg={readContext:ci,useCallback:Xr,useContext:Xr,useEffect:Xr,useImperativeHandle:Xr,useInsertionEffect:Xr,useLayoutEffect:Xr,useMemo:Xr,useReducer:Xr,useRef:Xr,useState:Xr,useDebugValue:Xr,useDeferredValue:Xr,useTransition:Xr,useMutableSource:Xr,useSyncExternalStore:Xr,useId:Xr,unstable_isNewReconciler:!1},oV={readContext:ci,useCallback:function(h,m){return bo().memoizedState=[h,m===void 0?null:m],h},useContext:ci,useEffect:o_,useImperativeHandle:function(h,m,k){return k=k!=null?k.concat([h]):null,Kg(4194308,4,u_.bind(null,m,h),k)},useLayoutEffect:function(h,m){return Kg(4194308,4,h,m)},useInsertionEffect:function(h,m){return Kg(4,2,h,m)},useMemo:function(h,m){var k=bo();return m=m===void 0?null:m,h=h(),k.memoizedState=[h,m],h},useReducer:function(h,m,k){var N=bo();return m=k!==void 0?k(m):m,N.memoizedState=N.baseState=m,h={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:h,lastRenderedState:m},N.queue=h,h=h.dispatch=aV.bind(null,$n,h),[N.memoizedState,h]},useRef:function(h){var m=bo();return h={current:h},m.memoizedState=h},useState:a_,useDebugValue:Cw,useDeferredValue:function(h){return bo().memoizedState=h},useTransition:function(){var h=a_(!1),m=h[0];return h=rV.bind(null,h[1]),bo().memoizedState=h,[m,h]},useMutableSource:function(){},useSyncExternalStore:function(h,m,k){var N=$n,T=bo();if(Bt){if(k===void 0)throw Error(i(407));k=k()}else{if(k=m(),vr===null)throw Error(i(349));su&30||JE(N,m,k)}T.memoizedState=k;var $={value:k,getSnapshot:m};return T.queue=$,o_(t_.bind(null,N,$,h),[h]),N.flags|=2048,qp(9,e_.bind(null,N,$,k,m),void 0,null),k},useId:function(){var h=bo(),m=vr.identifierPrefix;if(Bt){var k=$r,N=Vi;k=(N&~(1<<32-Ha(N)-1)).toString(32)+k,m=":"+m+"R"+k,k=Gp++,0<k&&(m+="H"+k.toString(32)),m+=":"}else k=nV++,m=":"+m+"r"+k.toString(32)+":";return h.memoizedState=m},unstable_isNewReconciler:!1},sV={readContext:ci,useCallback:d_,useContext:ci,useEffect:Sw,useImperativeHandle:c_,useInsertionEffect:s_,useLayoutEffect:l_,useMemo:p_,useReducer:ww,useRef:i_,useState:function(){return ww(Hp)},useDebugValue:Cw,useDeferredValue:function(h){var m=pi();return h_(m,ir.memoizedState,h)},useTransition:function(){var h=ww(Hp)[0],m=pi().memoizedState;return[h,m]},useMutableSource:QE,useSyncExternalStore:ZE,useId:f_,unstable_isNewReconciler:!1},lV={readContext:ci,useCallback:d_,useContext:ci,useEffect:Sw,useImperativeHandle:c_,useInsertionEffect:s_,useLayoutEffect:l_,useMemo:p_,useReducer:kw,useRef:i_,useState:function(){return kw(Hp)},useDebugValue:Cw,useDeferredValue:function(h){var m=pi();return ir===null?m.memoizedState=h:h_(m,ir.memoizedState,h)},useTransition:function(){var h=kw(Hp)[0],m=pi().memoizedState;return[h,m]},useMutableSource:QE,useSyncExternalStore:ZE,useId:f_,unstable_isNewReconciler:!1};function Dc(h,m){try{var k="",N=m;do k+=tV(N),N=N.return;while(N);var T=k}catch($){T=`
Error generating stack: `+$.message+`
`+$.stack}return{value:h,source:m,stack:T,digest:null}}function Nw(h,m,k){return{value:h,source:null,stack:k??null,digest:m??null}}function Tw(h,m){try{console.error(m.value)}catch(k){setTimeout(function(){throw k})}}var uV=typeof WeakMap=="function"?WeakMap:Map;function b_(h,m,k){k=Qo(-1,k),k.tag=3,k.payload={element:null};var N=m.value;return k.callback=function(){c0||(c0=!0,Gw=N),Tw(h,m)},k}function v_(h,m,k){k=Qo(-1,k),k.tag=3;var N=h.type.getDerivedStateFromError;if(typeof N=="function"){var T=m.value;k.payload=function(){return N(T)},k.callback=function(){Tw(h,m)}}var $=h.stateNode;return $!==null&&typeof $.componentDidCatch=="function"&&(k.callback=function(){Tw(h,m),typeof N!="function"&&(js===null?js=new Set([this]):js.add(this));var U=m.stack;this.componentDidCatch(m.value,{componentStack:U!==null?U:""})}),k}function x_(h,m,k){var N=h.pingCache;if(N===null){N=h.pingCache=new uV;var T=new Set;N.set(m,T)}else T=N.get(m),T===void 0&&(T=new Set,N.set(m,T));T.has(k)||(T.add(k),h=SV.bind(null,h,m,k),m.then(h,h))}function w_(h){do{var m;if((m=h.tag===13)&&(m=h.memoizedState,m=m!==null?m.dehydrated!==null:!0),m)return h;h=h.return}while(h!==null);return null}function k_(h,m,k,N,T){return h.mode&1?(h.flags|=65536,h.lanes=T,h):(h===m?h.flags|=65536:(h.flags|=128,k.flags|=131072,k.flags&=-52805,k.tag===1&&(k.alternate===null?k.tag=17:(m=Qo(-1,1),m.tag=2,Ws(k,m,1))),k.lanes|=1),h)}var cV=o.ReactCurrentOwner,Ia=!1;function ga(h,m,k,N){m.child=h===null?XE(m,null,k,N):Mc(m,h.child,k,N)}function S_(h,m,k,N,T){k=k.render;var $=m.ref;return Rc(m,T),N=vw(h,m,k,N,$,T),k=xw(),h!==null&&!Ia?(m.updateQueue=h.updateQueue,m.flags&=-2053,h.lanes&=~T,Zo(h,m,T)):(Bt&&k&&ma(m),m.flags|=1,ga(h,m,N,T),m.child)}function C_(h,m,k,N,T){if(h===null){var $=k.type;return typeof $=="function"&&!Qw($)&&$.defaultProps===void 0&&k.compare===null&&k.defaultProps===void 0?(m.tag=15,m.type=$,N_(h,m,$,N,T)):(h=g0(k.type,null,N,m,m.mode,T),h.ref=m.ref,h.return=m,m.child=h)}if($=h.child,!(h.lanes&T)){var U=$.memoizedProps;if(k=k.compare,k=k!==null?k:Fg,k(U,N)&&h.ref===m.ref)return Zo(h,m,T)}return m.flags|=1,h=qs($,N),h.ref=m.ref,h.return=m,m.child=h}function N_(h,m,k,N,T){if(h!==null){var $=h.memoizedProps;if(Fg($,N)&&h.ref===m.ref)if(Ia=!1,m.pendingProps=N=$,(h.lanes&T)!==0)h.flags&131072&&(Ia=!0);else return m.lanes=h.lanes,Zo(h,m,T)}return Iw(h,m,k,N,T)}function T_(h,m,k){var N=m.pendingProps,T=N.children,$=h!==null?h.memoizedState:null;if(N.mode==="hidden")if(!(m.mode&1))m.memoizedState={baseLanes:0,cachePool:null,transitions:null},Qt(Fc,qa),qa|=k;else{if(!(k&1073741824))return h=$!==null?$.baseLanes|k:k,m.lanes=m.childLanes=1073741824,m.memoizedState={baseLanes:h,cachePool:null,transitions:null},m.updateQueue=null,Qt(Fc,qa),qa|=h,null;m.memoizedState={baseLanes:0,cachePool:null,transitions:null},N=$!==null?$.baseLanes:k,Qt(Fc,qa),qa|=N}else $!==null?(N=$.baseLanes|k,m.memoizedState=null):N=k,Qt(Fc,qa),qa|=N;return ga(h,m,T,k),m.child}function I_(h,m){var k=m.ref;(h===null&&k!==null||h!==null&&h.ref!==k)&&(m.flags|=512,m.flags|=2097152)}function Iw(h,m,k,N,T){var $=qr(k)?Go:yr.current;return $=zs(m,$),Rc(m,T),k=vw(h,m,k,N,$,T),N=xw(),h!==null&&!Ia?(m.updateQueue=h.updateQueue,m.flags&=-2053,h.lanes&=~T,Zo(h,m,T)):(Bt&&N&&ma(m),m.flags|=1,ga(h,m,k,T),m.child)}function E_(h,m,k,N,T){if(qr(k)){var $=!0;mo(m)}else $=!1;if(Rc(m,T),m.stateNode===null)Zg(h,m),GE(m,k,N),pw(m,k,N,T),N=!0;else if(h===null){var U=m.stateNode,ae=m.memoizedProps;U.props=ae;var he=U.context,Te=k.contextType;typeof Te=="object"&&Te!==null?Te=ci(Te):(Te=qr(k)?Go:yr.current,Te=zs(m,Te));var We=k.getDerivedStateFromProps,ht=typeof We=="function"||typeof U.getSnapshotBeforeUpdate=="function";ht||typeof U.UNSAFE_componentWillReceiveProps!="function"&&typeof U.componentWillReceiveProps!="function"||(ae!==N||he!==Te)&&HE(m,U,N,Te),Vs=!1;var Ae=m.memoizedState;U.state=Ae,Wg(m,N,U,T),he=m.memoizedState,ae!==N||Ae!==he||Hr.current||Vs?(typeof We=="function"&&(dw(m,k,We,N),he=m.memoizedState),(ae=Vs||UE(m,k,ae,N,Ae,he,Te))?(ht||typeof U.UNSAFE_componentWillMount!="function"&&typeof U.componentWillMount!="function"||(typeof U.componentWillMount=="function"&&U.componentWillMount(),typeof U.UNSAFE_componentWillMount=="function"&&U.UNSAFE_componentWillMount()),typeof U.componentDidMount=="function"&&(m.flags|=4194308)):(typeof U.componentDidMount=="function"&&(m.flags|=4194308),m.memoizedProps=N,m.memoizedState=he),U.props=N,U.state=he,U.context=Te,N=ae):(typeof U.componentDidMount=="function"&&(m.flags|=4194308),N=!1)}else{U=m.stateNode,zE(h,m),ae=m.memoizedProps,Te=m.type===m.elementType?ae:ji(m.type,ae),U.props=Te,ht=m.pendingProps,Ae=U.context,he=k.contextType,typeof he=="object"&&he!==null?he=ci(he):(he=qr(k)?Go:yr.current,he=zs(m,he));var bn=k.getDerivedStateFromProps;(We=typeof bn=="function"||typeof U.getSnapshotBeforeUpdate=="function")||typeof U.UNSAFE_componentWillReceiveProps!="function"&&typeof U.componentWillReceiveProps!="function"||(ae!==ht||Ae!==he)&&HE(m,U,N,he),Vs=!1,Ae=m.memoizedState,U.state=Ae,Wg(m,N,U,T);var on=m.memoizedState;ae!==ht||Ae!==on||Hr.current||Vs?(typeof bn=="function"&&(dw(m,k,bn,N),on=m.memoizedState),(Te=Vs||UE(m,k,Te,N,Ae,on,he)||!1)?(We||typeof U.UNSAFE_componentWillUpdate!="function"&&typeof U.componentWillUpdate!="function"||(typeof U.componentWillUpdate=="function"&&U.componentWillUpdate(N,on,he),typeof U.UNSAFE_componentWillUpdate=="function"&&U.UNSAFE_componentWillUpdate(N,on,he)),typeof U.componentDidUpdate=="function"&&(m.flags|=4),typeof U.getSnapshotBeforeUpdate=="function"&&(m.flags|=1024)):(typeof U.componentDidUpdate!="function"||ae===h.memoizedProps&&Ae===h.memoizedState||(m.flags|=4),typeof U.getSnapshotBeforeUpdate!="function"||ae===h.memoizedProps&&Ae===h.memoizedState||(m.flags|=1024),m.memoizedProps=N,m.memoizedState=on),U.props=N,U.state=on,U.context=he,N=Te):(typeof U.componentDidUpdate!="function"||ae===h.memoizedProps&&Ae===h.memoizedState||(m.flags|=4),typeof U.getSnapshotBeforeUpdate!="function"||ae===h.memoizedProps&&Ae===h.memoizedState||(m.flags|=1024),N=!1)}return Ew(h,m,k,N,$,T)}function Ew(h,m,k,N,T,$){I_(h,m);var U=(m.flags&128)!==0;if(!N&&!U)return T&&au(m,k,!1),Zo(h,m,$);N=m.stateNode,cV.current=m;var ae=U&&typeof k.getDerivedStateFromError!="function"?null:N.render();return m.flags|=1,h!==null&&U?(m.child=Mc(m,h.child,null,$),m.child=Mc(m,null,ae,$)):ga(h,m,ae,$),m.memoizedState=N.state,T&&au(m,k,!0),m.child}function __(h){var m=h.stateNode;m.pendingContext?Pg(h,m.pendingContext,m.pendingContext!==m.context):m.context&&Pg(h,m.context,!1),hw(h,m.containerInfo)}function O_(h,m,k,N,T){return Oc(),aw(T),m.flags|=256,ga(h,m,k,N),m.child}var _w={dehydrated:null,treeContext:null,retryLane:0};function Ow(h){return{baseLanes:h,cachePool:null,transitions:null}}function $_(h,m,k){var N=m.pendingProps,T=On.current,$=!1,U=(m.flags&128)!==0,ae;if((ae=U)||(ae=h!==null&&h.memoizedState===null?!1:(T&2)!==0),ae?($=!0,m.flags&=-129):(h===null||h.memoizedState!==null)&&(T|=1),Qt(On,T&1),h===null)return rw(m),h=m.memoizedState,h!==null&&(h=h.dehydrated,h!==null)?(m.mode&1?Sc(h)?m.lanes=8:m.lanes=1073741824:m.lanes=1,null):(U=N.children,h=N.fallback,$?(N=m.mode,$=m.child,U={mode:"hidden",children:U},!(N&1)&&$!==null?($.childLanes=0,$.pendingProps=U):$=y0(U,N,0,null),h=pu(h,N,k,null),$.return=m,h.return=m,$.sibling=h,m.child=$,m.child.memoizedState=Ow(k),m.memoizedState=_w,h):$w(m,U));if(T=h.memoizedState,T!==null&&(ae=T.dehydrated,ae!==null))return dV(h,m,U,N,ae,T,k);if($){$=N.fallback,U=m.mode,T=h.child,ae=T.sibling;var he={mode:"hidden",children:N.children};return!(U&1)&&m.child!==T?(N=m.child,N.childLanes=0,N.pendingProps=he,m.deletions=null):(N=qs(T,he),N.subtreeFlags=T.subtreeFlags&14680064),ae!==null?$=qs(ae,$):($=pu($,U,k,null),$.flags|=2),$.return=m,N.return=m,N.sibling=$,m.child=N,N=$,$=m.child,U=h.child.memoizedState,U=U===null?Ow(k):{baseLanes:U.baseLanes|k,cachePool:null,transitions:U.transitions},$.memoizedState=U,$.childLanes=h.childLanes&~k,m.memoizedState=_w,N}return $=h.child,h=$.sibling,N=qs($,{mode:"visible",children:N.children}),!(m.mode&1)&&(N.lanes=k),N.return=m,N.sibling=null,h!==null&&(k=m.deletions,k===null?(m.deletions=[h],m.flags|=16):k.push(h)),m.child=N,m.memoizedState=null,N}function $w(h,m){return m=y0({mode:"visible",children:m},h.mode,0,null),m.return=h,h.child=m}function Qg(h,m,k,N){return N!==null&&aw(N),Mc(m,h.child,null,k),h=$w(m,m.pendingProps.children),h.flags|=2,m.memoizedState=null,h}function dV(h,m,k,N,T,$,U){if(k)return m.flags&256?(m.flags&=-257,N=Nw(Error(i(422))),Qg(h,m,U,N)):m.memoizedState!==null?(m.child=h.child,m.flags|=128,null):($=N.fallback,T=m.mode,N=y0({mode:"visible",children:N.children},T,0,null),$=pu($,T,U,null),$.flags|=2,N.return=m,$.return=m,N.sibling=$,m.child=N,m.mode&1&&Mc(m,h.child,null,U),m.child.memoizedState=Ow(U),m.memoizedState=_w,$);if(!(m.mode&1))return Qg(h,m,U,null);if(Sc(T))return N=q2(T).digest,$=Error(i(419)),N=Nw($,N,void 0),Qg(h,m,U,N);if(k=(U&h.childLanes)!==0,Ia||k){if(N=vr,N!==null){switch(U&-U){case 4:T=2;break;case 16:T=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:T=32;break;case 536870912:T=268435456;break;default:T=0}T=T&(N.suspendedLanes|U)?0:T,T!==0&&T!==$.retryLane&&($.retryLane=T,go(h,T),hi(N,h,T,-1))}return Yw(),N=Nw(Error(i(421))),Qg(h,m,U,N)}return Pp(T)?(m.flags|=128,m.child=h.child,m=CV.bind(null,h),K2(T,m),null):(h=$.treeContext,Ie&&(Rr=Na(T),Bn=m,Bt=!0,Wi=null,Yo=!1,h!==null&&(qt[hn++]=Vi,qt[hn++]=$r,qt[hn++]=Or,Vi=h.id,$r=h.overflow,Or=m)),m=$w(m,N.children),m.flags|=4096,m)}function R_(h,m,k){h.lanes|=m;var N=h.alternate;N!==null&&(N.lanes|=m),lw(h.return,m,k)}function Rw(h,m,k,N,T){var $=h.memoizedState;$===null?h.memoizedState={isBackwards:m,rendering:null,renderingStartTime:0,last:N,tail:k,tailMode:T}:($.isBackwards=m,$.rendering=null,$.renderingStartTime=0,$.last=N,$.tail=k,$.tailMode=T)}function M_(h,m,k){var N=m.pendingProps,T=N.revealOrder,$=N.tail;if(ga(h,m,N.children,k),N=On.current,N&2)N=N&1|2,m.flags|=128;else{if(h!==null&&h.flags&128)e:for(h=m.child;h!==null;){if(h.tag===13)h.memoizedState!==null&&R_(h,k,m);else if(h.tag===19)R_(h,k,m);else if(h.child!==null){h.child.return=h,h=h.child;continue}if(h===m)break e;for(;h.sibling===null;){if(h.return===null||h.return===m)break e;h=h.return}h.sibling.return=h.return,h=h.sibling}N&=1}if(Qt(On,N),!(m.mode&1))m.memoizedState=null;else switch(T){case"forwards":for(k=m.child,T=null;k!==null;)h=k.alternate,h!==null&&Gg(h)===null&&(T=k),k=k.sibling;k=T,k===null?(T=m.child,m.child=null):(T=k.sibling,k.sibling=null),Rw(m,!1,T,k,$);break;case"backwards":for(k=null,T=m.child,m.child=null;T!==null;){if(h=T.alternate,h!==null&&Gg(h)===null){m.child=T;break}h=T.sibling,T.sibling=k,k=T,T=h}Rw(m,!0,k,null,$);break;case"together":Rw(m,!1,null,null,void 0);break;default:m.memoizedState=null}return m.child}function Zg(h,m){!(m.mode&1)&&h!==null&&(h.alternate=null,m.alternate=null,m.flags|=2)}function Zo(h,m,k){if(h!==null&&(m.dependencies=h.dependencies),lu|=m.lanes,!(k&m.childLanes))return null;if(h!==null&&m.child!==h.child)throw Error(i(153));if(m.child!==null){for(h=m.child,k=qs(h,h.pendingProps),m.child=k,k.return=m;h.sibling!==null;)h=h.sibling,k=k.sibling=qs(h,h.pendingProps),k.return=m;k.sibling=null}return m.child}function pV(h,m,k){switch(m.tag){case 3:__(m),Oc();break;case 5:YE(m);break;case 1:qr(m.type)&&mo(m);break;case 4:hw(m,m.stateNode.containerInfo);break;case 10:FE(m,m.type._context,m.memoizedProps.value);break;case 13:var N=m.memoizedState;if(N!==null)return N.dehydrated!==null?(Qt(On,On.current&1),m.flags|=128,null):k&m.child.childLanes?$_(h,m,k):(Qt(On,On.current&1),h=Zo(h,m,k),h!==null?h.sibling:null);Qt(On,On.current&1);break;case 19:if(N=(k&m.childLanes)!==0,h.flags&128){if(N)return M_(h,m,k);m.flags|=128}var T=m.memoizedState;if(T!==null&&(T.rendering=null,T.tail=null,T.lastEffect=null),Qt(On,On.current),N)break;return null;case 22:case 23:return m.lanes=0,T_(h,m,k)}return Zo(h,m,k)}function vo(h){h.flags|=4}function A_(h,m){if(h!==null&&h.child===m.child)return!0;if(m.flags&16)return!1;for(h=m.child;h!==null;){if(h.flags&12854||h.subtreeFlags&12854)return!1;h=h.sibling}return!0}var Kp,Xp,Jg,e0;if(ke)Kp=function(h,m){for(var k=m.child;k!==null;){if(k.tag===5||k.tag===6)ne(h,k.stateNode);else if(k.tag!==4&&k.child!==null){k.child.return=k,k=k.child;continue}if(k===m)break;for(;k.sibling===null;){if(k.return===null||k.return===m)return;k=k.return}k.sibling.return=k.return,k=k.sibling}},Xp=function(){},Jg=function(h,m,k,N,T){if(h=h.memoizedProps,h!==N){var $=m.stateNode,U=yo(di.current);k=ce($,k,h,N,T,U),(m.updateQueue=k)&&vo(m)}},e0=function(h,m,k,N){k!==N&&vo(m)};else if(Ne){Kp=function(h,m,k,N){for(var T=m.child;T!==null;){if(T.tag===5){var $=T.stateNode;k&&N&&($=Ap($,T.type,T.memoizedProps,T)),ne(h,$)}else if(T.tag===6)$=T.stateNode,k&&N&&($=kc($,T.memoizedProps,T)),ne(h,$);else if(T.tag!==4){if(T.tag===22&&T.memoizedState!==null)$=T.child,$!==null&&($.return=T),Kp(h,T,!0,!0);else if(T.child!==null){T.child.return=T,T=T.child;continue}}if(T===m)break;for(;T.sibling===null;){if(T.return===null||T.return===m)return;T=T.return}T.sibling.return=T.return,T=T.sibling}};var P_=function(h,m,k,N){for(var T=m.child;T!==null;){if(T.tag===5){var $=T.stateNode;k&&N&&($=Ap($,T.type,T.memoizedProps,T)),_g(h,$)}else if(T.tag===6)$=T.stateNode,k&&N&&($=kc($,T.memoizedProps,T)),_g(h,$);else if(T.tag!==4){if(T.tag===22&&T.memoizedState!==null)$=T.child,$!==null&&($.return=T),P_(h,T,!0,!0);else if(T.child!==null){T.child.return=T,T=T.child;continue}}if(T===m)break;for(;T.sibling===null;){if(T.return===null||T.return===m)return;T=T.return}T.sibling.return=T.return,T=T.sibling}};Xp=function(h,m){var k=m.stateNode;if(!A_(h,m)){h=k.containerInfo;var N=Eg(h);P_(N,m,!1,!1),k.pendingChildren=N,vo(m),Mp(h,N)}},Jg=function(h,m,k,N,T){var $=h.stateNode,U=h.memoizedProps;if((h=A_(h,m))&&U===N)m.stateNode=$;else{var ae=m.stateNode,he=yo(di.current),Te=null;U!==N&&(Te=ce(ae,k,U,N,T,he)),h&&Te===null?m.stateNode=$:($=$t($,Te,k,U,N,m,h,ae),se($,k,N,T,he)&&vo(m),m.stateNode=$,h?vo(m):Kp($,m,!1,!1))}},e0=function(h,m,k,N){k!==N?(h=yo(Ac.current),k=yo(di.current),m.stateNode=ye(N,h,k,m),vo(m)):m.stateNode=h.stateNode}}else Xp=function(){},Jg=function(){},e0=function(){};function Yp(h,m){if(!Bt)switch(h.tailMode){case"hidden":m=h.tail;for(var k=null;m!==null;)m.alternate!==null&&(k=m),m=m.sibling;k===null?h.tail=null:k.sibling=null;break;case"collapsed":k=h.tail;for(var N=null;k!==null;)k.alternate!==null&&(N=k),k=k.sibling;N===null?m||h.tail===null?h.tail=null:h.tail.sibling=null:N.sibling=null}}function Yr(h){var m=h.alternate!==null&&h.alternate.child===h.child,k=0,N=0;if(m)for(var T=h.child;T!==null;)k|=T.lanes|T.childLanes,N|=T.subtreeFlags&14680064,N|=T.flags&14680064,T.return=h,T=T.sibling;else for(T=h.child;T!==null;)k|=T.lanes|T.childLanes,N|=T.subtreeFlags,N|=T.flags,T.return=h,T=T.sibling;return h.subtreeFlags|=N,h.childLanes=k,m}function hV(h,m,k){var N=m.pendingProps;switch(Xo(m),m.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Yr(m),null;case 1:return qr(m.type)&&Ec(),Yr(m),null;case 3:return k=m.stateNode,Pc(),an(Hr),an(yr),gw(),k.pendingContext&&(k.context=k.pendingContext,k.pendingContext=null),(h===null||h.child===null)&&(Lg(m)?vo(m):h===null||h.memoizedState.isDehydrated&&!(m.flags&256)||(m.flags|=1024,Wi!==null&&(Kw(Wi),Wi=null))),Xp(h,m),Yr(m),null;case 5:fw(m),k=yo(Ac.current);var T=m.type;if(h!==null&&m.stateNode!=null)Jg(h,m,T,N,k),h.ref!==m.ref&&(m.flags|=512,m.flags|=2097152);else{if(!N){if(m.stateNode===null)throw Error(i(166));return Yr(m),null}if(h=yo(di.current),Lg(m)){if(!Ie)throw Error(i(175));h=Nc(m.stateNode,m.type,m.memoizedProps,k,h,m,!Yo),m.updateQueue=h,h!==null&&vo(m)}else{var $=Z(T,N,k,h,m);Kp($,m,!1,!1),m.stateNode=$,se($,T,N,k,h)&&vo(m)}m.ref!==null&&(m.flags|=512,m.flags|=2097152)}return Yr(m),null;case 6:if(h&&m.stateNode!=null)e0(h,m,h.memoizedProps,N);else{if(typeof N!="string"&&m.stateNode===null)throw Error(i(166));if(h=yo(Ac.current),k=yo(di.current),Lg(m)){if(!Ie)throw Error(i(176));if(h=m.stateNode,k=m.memoizedProps,(N=Dp(h,k,m,!Yo))&&(T=Bn,T!==null))switch(T.tag){case 3:Ag(T.stateNode.containerInfo,h,k,(T.mode&1)!==0);break;case 5:Lp(T.type,T.memoizedProps,T.stateNode,h,k,(T.mode&1)!==0)}N&&vo(m)}else m.stateNode=ye(N,h,k,m)}return Yr(m),null;case 13:if(an(On),N=m.memoizedState,h===null||h.memoizedState!==null&&h.memoizedState.dehydrated!==null){if(Bt&&Rr!==null&&m.mode&1&&!(m.flags&128))LE(),Oc(),m.flags|=98560,T=!1;else if(T=Lg(m),N!==null&&N.dehydrated!==null){if(h===null){if(!T)throw Error(i(318));if(!Ie)throw Error(i(344));if(T=m.memoizedState,T=T!==null?T.dehydrated:null,!T)throw Error(i(317));nu(T,m)}else Oc(),!(m.flags&128)&&(m.memoizedState=null),m.flags|=4;Yr(m),T=!1}else Wi!==null&&(Kw(Wi),Wi=null),T=!0;if(!T)return m.flags&65536?m:null}return m.flags&128?(m.lanes=k,m):(k=N!==null,k!==(h!==null&&h.memoizedState!==null)&&k&&(m.child.flags|=8192,m.mode&1&&(h===null||On.current&1?or===0&&(or=3):Yw())),m.updateQueue!==null&&(m.flags|=4),Yr(m),null);case 4:return Pc(),Xp(h,m),h===null&&He(m.stateNode.containerInfo),Yr(m),null;case 10:return sw(m.type._context),Yr(m),null;case 17:return qr(m.type)&&Ec(),Yr(m),null;case 19:if(an(On),T=m.memoizedState,T===null)return Yr(m),null;if(N=(m.flags&128)!==0,$=T.rendering,$===null)if(N)Yp(T,!1);else{if(or!==0||h!==null&&h.flags&128)for(h=m.child;h!==null;){if($=Gg(h),$!==null){for(m.flags|=128,Yp(T,!1),h=$.updateQueue,h!==null&&(m.updateQueue=h,m.flags|=4),m.subtreeFlags=0,h=k,k=m.child;k!==null;)N=k,T=h,N.flags&=14680066,$=N.alternate,$===null?(N.childLanes=0,N.lanes=T,N.child=null,N.subtreeFlags=0,N.memoizedProps=null,N.memoizedState=null,N.updateQueue=null,N.dependencies=null,N.stateNode=null):(N.childLanes=$.childLanes,N.lanes=$.lanes,N.child=$.child,N.subtreeFlags=0,N.deletions=null,N.memoizedProps=$.memoizedProps,N.memoizedState=$.memoizedState,N.updateQueue=$.updateQueue,N.type=$.type,T=$.dependencies,N.dependencies=T===null?null:{lanes:T.lanes,firstContext:T.firstContext}),k=k.sibling;return Qt(On,On.current&1|2),m.child}h=h.sibling}T.tail!==null&&je()>Uw&&(m.flags|=128,N=!0,Yp(T,!1),m.lanes=4194304)}else{if(!N)if(h=Gg($),h!==null){if(m.flags|=128,N=!0,h=h.updateQueue,h!==null&&(m.updateQueue=h,m.flags|=4),Yp(T,!0),T.tail===null&&T.tailMode==="hidden"&&!$.alternate&&!Bt)return Yr(m),null}else 2*je()-T.renderingStartTime>Uw&&k!==1073741824&&(m.flags|=128,N=!0,Yp(T,!1),m.lanes=4194304);T.isBackwards?($.sibling=m.child,m.child=$):(h=T.last,h!==null?h.sibling=$:m.child=$,T.last=$)}return T.tail!==null?(m=T.tail,T.rendering=m,T.tail=m.sibling,T.renderingStartTime=je(),m.sibling=null,h=On.current,Qt(On,N?h&1|2:h&1),m):(Yr(m),null);case 22:case 23:return Xw(),k=m.memoizedState!==null,h!==null&&h.memoizedState!==null!==k&&(m.flags|=8192),k&&m.mode&1?qa&1073741824&&(Yr(m),ke&&m.subtreeFlags&6&&(m.flags|=8192)):Yr(m),null;case 24:return null;case 25:return null}throw Error(i(156,m.tag))}function fV(h,m){switch(Xo(m),m.tag){case 1:return qr(m.type)&&Ec(),h=m.flags,h&65536?(m.flags=h&-65537|128,m):null;case 3:return Pc(),an(Hr),an(yr),gw(),h=m.flags,h&65536&&!(h&128)?(m.flags=h&-65537|128,m):null;case 5:return fw(m),null;case 13:if(an(On),h=m.memoizedState,h!==null&&h.dehydrated!==null){if(m.alternate===null)throw Error(i(340));Oc()}return h=m.flags,h&65536?(m.flags=h&-65537|128,m):null;case 19:return an(On),null;case 4:return Pc(),null;case 10:return sw(m.type._context),null;case 22:case 23:return Xw(),null;case 24:return null;default:return null}}var t0=!1,Qr=!1,mV=typeof WeakSet=="function"?WeakSet:Set,Fe=null;function Lc(h,m){var k=h.ref;if(k!==null)if(typeof k=="function")try{k(null)}catch(N){Cn(h,m,N)}else k.current=null}function D_(h,m,k){try{k()}catch(N){Cn(h,m,N)}}var L_=!1;function gV(h,m){for(F(h.containerInfo),Fe=m;Fe!==null;)if(h=Fe,m=h.child,(h.subtreeFlags&1028)!==0&&m!==null)m.return=h,Fe=m;else for(;Fe!==null;){h=Fe;try{var k=h.alternate;if(h.flags&1024)switch(h.tag){case 0:case 11:case 15:break;case 1:if(k!==null){var N=k.memoizedProps,T=k.memoizedState,$=h.stateNode,U=$.getSnapshotBeforeUpdate(h.elementType===h.type?N:ji(h.type,N),T);$.__reactInternalSnapshotBeforeUpdate=U}break;case 3:ke&&eu(h.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(i(163))}}catch(ae){Cn(h,h.return,ae)}if(m=h.sibling,m!==null){m.return=h.return,Fe=m;break}Fe=h.return}return k=L_,L_=!1,k}function Qp(h,m,k){var N=m.updateQueue;if(N=N!==null?N.lastEffect:null,N!==null){var T=N=N.next;do{if((T.tag&h)===h){var $=T.destroy;T.destroy=void 0,$!==void 0&&D_(m,k,$)}T=T.next}while(T!==N)}}function n0(h,m){if(m=m.updateQueue,m=m!==null?m.lastEffect:null,m!==null){var k=m=m.next;do{if((k.tag&h)===h){var N=k.create;k.destroy=N()}k=k.next}while(k!==m)}}function Mw(h){var m=h.ref;if(m!==null){var k=h.stateNode;switch(h.tag){case 5:h=X(k);break;default:h=k}typeof m=="function"?m(h):m.current=h}}function F_(h){var m=h.alternate;m!==null&&(h.alternate=null,F_(m)),h.child=null,h.deletions=null,h.sibling=null,h.tag===5&&(m=h.stateNode,m!==null&&it(m)),h.stateNode=null,h.return=null,h.dependencies=null,h.memoizedProps=null,h.memoizedState=null,h.pendingProps=null,h.stateNode=null,h.updateQueue=null}function B_(h){return h.tag===5||h.tag===3||h.tag===4}function z_(h){e:for(;;){for(;h.sibling===null;){if(h.return===null||B_(h.return))return null;h=h.return}for(h.sibling.return=h.return,h=h.sibling;h.tag!==5&&h.tag!==6&&h.tag!==18;){if(h.flags&2||h.child===null||h.tag===4)continue e;h.child.return=h,h=h.child}if(!(h.flags&2))return h.stateNode}}function Aw(h,m,k){var N=h.tag;if(N===5||N===6)h=h.stateNode,m?rn(k,h,m):Ga(k,h);else if(N!==4&&(h=h.child,h!==null))for(Aw(h,m,k),h=h.sibling;h!==null;)Aw(h,m,k),h=h.sibling}function Pw(h,m,k){var N=h.tag;if(N===5||N===6)h=h.stateNode,m?ho(k,h,m):gr(k,h);else if(N!==4&&(h=h.child,h!==null))for(Pw(h,m,k),h=h.sibling;h!==null;)Pw(h,m,k),h=h.sibling}var Mr=null,Ui=!1;function xo(h,m,k){for(k=k.child;k!==null;)Dw(h,m,k),k=k.sibling}function Dw(h,m,k){if(ut&&typeof ut.onCommitFiberUnmount=="function")try{ut.onCommitFiberUnmount(et,k)}catch{}switch(k.tag){case 5:Qr||Lc(k,m);case 6:if(ke){var N=Mr,T=Ui;Mr=null,xo(h,m,k),Mr=N,Ui=T,Mr!==null&&(Ui?Fs(Mr,k.stateNode):Fi(Mr,k.stateNode))}else xo(h,m,k);break;case 18:ke&&Mr!==null&&(Ui?J2(Mr,k.stateNode):Mg(Mr,k.stateNode));break;case 4:ke?(N=Mr,T=Ui,Mr=k.stateNode.containerInfo,Ui=!0,xo(h,m,k),Mr=N,Ui=T):(Ne&&(N=k.stateNode.containerInfo,T=Eg(N),tu(N,T)),xo(h,m,k));break;case 0:case 11:case 14:case 15:if(!Qr&&(N=k.updateQueue,N!==null&&(N=N.lastEffect,N!==null))){T=N=N.next;do{var $=T,U=$.destroy;$=$.tag,U!==void 0&&($&2||$&4)&&D_(k,m,U),T=T.next}while(T!==N)}xo(h,m,k);break;case 1:if(!Qr&&(Lc(k,m),N=k.stateNode,typeof N.componentWillUnmount=="function"))try{N.props=k.memoizedProps,N.state=k.memoizedState,N.componentWillUnmount()}catch(ae){Cn(k,m,ae)}xo(h,m,k);break;case 21:xo(h,m,k);break;case 22:k.mode&1?(Qr=(N=Qr)||k.memoizedState!==null,xo(h,m,k),Qr=N):xo(h,m,k);break;default:xo(h,m,k)}}function V_(h){var m=h.updateQueue;if(m!==null){h.updateQueue=null;var k=h.stateNode;k===null&&(k=h.stateNode=new mV),m.forEach(function(N){var T=NV.bind(null,h,N);k.has(N)||(k.add(N),N.then(T,T))})}}function Gi(h,m){var k=m.deletions;if(k!==null)for(var N=0;N<k.length;N++){var T=k[N];try{var $=h,U=m;if(ke){var ae=U;e:for(;ae!==null;){switch(ae.tag){case 5:Mr=ae.stateNode,Ui=!1;break e;case 3:Mr=ae.stateNode.containerInfo,Ui=!0;break e;case 4:Mr=ae.stateNode.containerInfo,Ui=!0;break e}ae=ae.return}if(Mr===null)throw Error(i(160));Dw($,U,T),Mr=null,Ui=!1}else Dw($,U,T);var he=T.alternate;he!==null&&(he.return=null),T.return=null}catch(Te){Cn(T,m,Te)}}if(m.subtreeFlags&12854)for(m=m.child;m!==null;)W_(m,h),m=m.sibling}function W_(h,m){var k=h.alternate,N=h.flags;switch(h.tag){case 0:case 11:case 14:case 15:if(Gi(m,h),wo(h),N&4){try{Qp(3,h,h.return),n0(3,h)}catch(Ae){Cn(h,h.return,Ae)}try{Qp(5,h,h.return)}catch(Ae){Cn(h,h.return,Ae)}}break;case 1:Gi(m,h),wo(h),N&512&&k!==null&&Lc(k,k.return);break;case 5:if(Gi(m,h),wo(h),N&512&&k!==null&&Lc(k,k.return),ke){if(h.flags&32){var T=h.stateNode;try{fo(T)}catch(Ae){Cn(h,h.return,Ae)}}if(N&4&&(T=h.stateNode,T!=null)){var $=h.memoizedProps;if(k=k!==null?k.memoizedProps:$,N=h.type,m=h.updateQueue,h.updateQueue=null,m!==null)try{Ls(T,m,N,k,$,h)}catch(Ae){Cn(h,h.return,Ae)}}}break;case 6:if(Gi(m,h),wo(h),N&4&&ke){if(h.stateNode===null)throw Error(i(162));T=h.stateNode,$=h.memoizedProps,k=k!==null?k.memoizedProps:$;try{_r(T,k,$)}catch(Ae){Cn(h,h.return,Ae)}}break;case 3:if(Gi(m,h),wo(h),N&4){if(ke&&Ie&&k!==null&&k.memoizedState.isDehydrated)try{Q2(m.containerInfo)}catch(Ae){Cn(h,h.return,Ae)}if(Ne){T=m.containerInfo,$=m.pendingChildren;try{tu(T,$)}catch(Ae){Cn(h,h.return,Ae)}}}break;case 4:if(Gi(m,h),wo(h),N&4&&Ne){$=h.stateNode,T=$.containerInfo,$=$.pendingChildren;try{tu(T,$)}catch(Ae){Cn(h,h.return,Ae)}}break;case 13:Gi(m,h),wo(h),T=h.child,T.flags&8192&&($=T.memoizedState!==null,T.stateNode.isHidden=$,!$||T.alternate!==null&&T.alternate.memoizedState!==null||(jw=je())),N&4&&V_(h);break;case 22:var U=k!==null&&k.memoizedState!==null;if(h.mode&1?(Qr=(k=Qr)||U,Gi(m,h),Qr=k):Gi(m,h),wo(h),N&8192){if(k=h.memoizedState!==null,(h.stateNode.isHidden=k)&&!U&&h.mode&1)for(Fe=h,N=h.child;N!==null;){for(m=Fe=N;Fe!==null;){U=Fe;var ae=U.child;switch(U.tag){case 0:case 11:case 14:case 15:Qp(4,U,U.return);break;case 1:Lc(U,U.return);var he=U.stateNode;if(typeof he.componentWillUnmount=="function"){var Te=U,We=U.return;try{var ht=Te;he.props=ht.memoizedProps,he.state=ht.memoizedState,he.componentWillUnmount()}catch(Ae){Cn(Te,We,Ae)}}break;case 5:Lc(U,U.return);break;case 22:if(U.memoizedState!==null){G_(m);continue}}ae!==null?(ae.return=U,Fe=ae):G_(m)}N=N.sibling}if(ke){e:if(N=null,ke)for(m=h;;){if(m.tag===5){if(N===null){N=m;try{T=m.stateNode,k?$p(T):Rp(m.stateNode,m.memoizedProps)}catch(Ae){Cn(h,h.return,Ae)}}}else if(m.tag===6){if(N===null)try{$=m.stateNode,k?Ca($):Ig($,m.memoizedProps)}catch(Ae){Cn(h,h.return,Ae)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===h)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===h)break e;for(;m.sibling===null;){if(m.return===null||m.return===h)break e;N===m&&(N=null),m=m.return}N===m&&(N=null),m.sibling.return=m.return,m=m.sibling}}}break;case 19:Gi(m,h),wo(h),N&4&&V_(h);break;case 21:break;default:Gi(m,h),wo(h)}}function wo(h){var m=h.flags;if(m&2){try{if(ke){e:{for(var k=h.return;k!==null;){if(B_(k)){var N=k;break e}k=k.return}throw Error(i(160))}switch(N.tag){case 5:var T=N.stateNode;N.flags&32&&(fo(T),N.flags&=-33);var $=z_(h);Pw(h,$,T);break;case 3:case 4:var U=N.stateNode.containerInfo,ae=z_(h);Aw(h,ae,U);break;default:throw Error(i(161))}}}catch(he){Cn(h,h.return,he)}h.flags&=-3}m&4096&&(h.flags&=-4097)}function yV(h,m,k){Fe=h,j_(h)}function j_(h,m,k){for(var N=(h.mode&1)!==0;Fe!==null;){var T=Fe,$=T.child;if(T.tag===22&&N){var U=T.memoizedState!==null||t0;if(!U){var ae=T.alternate,he=ae!==null&&ae.memoizedState!==null||Qr;ae=t0;var Te=Qr;if(t0=U,(Qr=he)&&!Te)for(Fe=T;Fe!==null;)U=Fe,he=U.child,U.tag===22&&U.memoizedState!==null?H_(T):he!==null?(he.return=U,Fe=he):H_(T);for(;$!==null;)Fe=$,j_($),$=$.sibling;Fe=T,t0=ae,Qr=Te}U_(h)}else T.subtreeFlags&8772&&$!==null?($.return=T,Fe=$):U_(h)}}function U_(h){for(;Fe!==null;){var m=Fe;if(m.flags&8772){var k=m.alternate;try{if(m.flags&8772)switch(m.tag){case 0:case 11:case 15:Qr||n0(5,m);break;case 1:var N=m.stateNode;if(m.flags&4&&!Qr)if(k===null)N.componentDidMount();else{var T=m.elementType===m.type?k.memoizedProps:ji(m.type,k.memoizedProps);N.componentDidUpdate(T,k.memoizedState,N.__reactInternalSnapshotBeforeUpdate)}var $=m.updateQueue;$!==null&&WE(m,$,N);break;case 3:var U=m.updateQueue;if(U!==null){if(k=null,m.child!==null)switch(m.child.tag){case 5:k=X(m.child.stateNode);break;case 1:k=m.child.stateNode}WE(m,U,k)}break;case 5:var ae=m.stateNode;k===null&&m.flags&4&&Li(ae,m.type,m.memoizedProps,m);break;case 6:break;case 4:break;case 12:break;case 13:if(Ie&&m.memoizedState===null){var he=m.alternate;if(he!==null){var Te=he.memoizedState;if(Te!==null){var We=Te.dehydrated;We!==null&&Z2(We)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(i(163))}Qr||m.flags&512&&Mw(m)}catch(ht){Cn(m,m.return,ht)}}if(m===h){Fe=null;break}if(k=m.sibling,k!==null){k.return=m.return,Fe=k;break}Fe=m.return}}function G_(h){for(;Fe!==null;){var m=Fe;if(m===h){Fe=null;break}var k=m.sibling;if(k!==null){k.return=m.return,Fe=k;break}Fe=m.return}}function H_(h){for(;Fe!==null;){var m=Fe;try{switch(m.tag){case 0:case 11:case 15:var k=m.return;try{n0(4,m)}catch(he){Cn(m,k,he)}break;case 1:var N=m.stateNode;if(typeof N.componentDidMount=="function"){var T=m.return;try{N.componentDidMount()}catch(he){Cn(m,T,he)}}var $=m.return;try{Mw(m)}catch(he){Cn(m,$,he)}break;case 5:var U=m.return;try{Mw(m)}catch(he){Cn(m,U,he)}}}catch(he){Cn(m,m.return,he)}if(m===h){Fe=null;break}var ae=m.sibling;if(ae!==null){ae.return=m.return,Fe=ae;break}Fe=m.return}}var r0=0,a0=1,i0=2,o0=3,s0=4;if(typeof Symbol=="function"&&Symbol.for){var Zp=Symbol.for;r0=Zp("selector.component"),a0=Zp("selector.has_pseudo_class"),i0=Zp("selector.role"),o0=Zp("selector.test_id"),s0=Zp("selector.text")}function Lw(h){var m=De(h);if(m!=null){if(typeof m.memoizedProps["data-testname"]!="string")throw Error(i(364));return m}if(h=Xt(h),h===null)throw Error(i(362));return h.stateNode.current}function Fw(h,m){switch(m.$$typeof){case r0:if(h.type===m.value)return!0;break;case a0:e:{m=m.value,h=[h,0];for(var k=0;k<h.length;){var N=h[k++],T=h[k++],$=m[T];if(N.tag!==5||!Yt(N)){for(;$!=null&&Fw(N,$);)T++,$=m[T];if(T===m.length){m=!0;break e}else for(N=N.child;N!==null;)h.push(N,T),N=N.sibling}}m=!1}return m;case i0:if(h.tag===5&&jt(h.stateNode,m.value))return!0;break;case s0:if((h.tag===5||h.tag===6)&&(h=Ht(h),h!==null&&0<=h.indexOf(m.value)))return!0;break;case o0:if(h.tag===5&&(h=h.memoizedProps["data-testname"],typeof h=="string"&&h.toLowerCase()===m.value.toLowerCase()))return!0;break;default:throw Error(i(365))}return!1}function Bw(h){switch(h.$$typeof){case r0:return"<"+(I(h.value)||"Unknown")+">";case a0:return":has("+(Bw(h)||"")+")";case i0:return'[role="'+h.value+'"]';case s0:return'"'+h.value+'"';case o0:return'[data-testname="'+h.value+'"]';default:throw Error(i(365))}}function q_(h,m){var k=[];h=[h,0];for(var N=0;N<h.length;){var T=h[N++],$=h[N++],U=m[$];if(T.tag!==5||!Yt(T)){for(;U!=null&&Fw(T,U);)$++,U=m[$];if($===m.length)k.push(T);else for(T=T.child;T!==null;)h.push(T,$),T=T.sibling}}return k}function zw(h,m){if(!Qe)throw Error(i(363));h=Lw(h),h=q_(h,m),m=[],h=Array.from(h);for(var k=0;k<h.length;){var N=h[k++];if(N.tag===5)Yt(N)||m.push(N.stateNode);else for(N=N.child;N!==null;)h.push(N),N=N.sibling}return m}var bV=Math.ceil,l0=o.ReactCurrentDispatcher,Vw=o.ReactCurrentOwner,Hn=o.ReactCurrentBatchConfig,Ct=0,vr=null,Jn=null,Ar=0,qa=0,Fc=li(0),or=0,Jp=null,lu=0,u0=0,Ww=0,eh=null,Ea=null,jw=0,Uw=1/0,Jo=null;function Bc(){Uw=je()+500}var c0=!1,Gw=null,js=null,d0=!1,Us=null,p0=0,th=0,Hw=null,h0=-1,f0=0;function Zr(){return Ct&6?je():h0!==-1?h0:h0=je()}function Gs(h){return h.mode&1?Ct&2&&Ar!==0?Ar&-Ar:eV.transition!==null?(f0===0&&(f0=re()),f0):(h=Ce,h!==0?h:Me()):1}function hi(h,m,k,N){if(50<th)throw th=0,Hw=null,Error(i(185));xe(h,k,N),(!(Ct&2)||h!==vr)&&(h===vr&&(!(Ct&2)&&(u0|=k),or===4&&Hs(h,Ar)),_a(h,N),k===1&&Ct===0&&!(m.mode&1)&&(Bc(),yn&&Yn()))}function _a(h,m){var k=h.callbackNode;j(h,m);var N=qo(h,h===vr?Ar:0);if(N===0)k!==null&&Ke(k),h.callbackNode=null,h.callbackPriority=0;else if(m=N&-N,h.callbackPriority!==m){if(k!=null&&Ke(k),m===1)h.tag===0?zi(X_.bind(null,h)):fa(X_.bind(null,h)),Ye?Ze(function(){!(Ct&6)&&Yn()}):st(tt,Yn),k=null;else{switch(Le(N)){case 1:k=tt;break;case 4:k=rt;break;case 16:k=Xe;break;case 536870912:k=dt;break;default:k=Xe}k=a5(k,K_.bind(null,h))}h.callbackPriority=m,h.callbackNode=k}}function K_(h,m){if(h0=-1,f0=0,Ct&6)throw Error(i(327));var k=h.callbackNode;if(du()&&h.callbackNode!==k)return null;var N=qo(h,h===vr?Ar:0);if(N===0)return null;if(N&30||N&h.expiredLanes||m)m=m0(h,N);else{m=N;var T=Ct;Ct|=2;var $=Z_();(vr!==h||Ar!==m)&&(Jo=null,Bc(),uu(h,m));do try{wV();break}catch(ae){Q_(h,ae)}while(!0);ow(),l0.current=$,Ct=T,Jn!==null?m=0:(vr=null,Ar=0,m=or)}if(m!==0){if(m===2&&(T=J(h),T!==0&&(N=T,m=qw(h,T))),m===1)throw k=Jp,uu(h,0),Hs(h,N),_a(h,je()),k;if(m===6)Hs(h,N);else{if(T=h.current.alternate,!(N&30)&&!vV(T)&&(m=m0(h,N),m===2&&($=J(h),$!==0&&(N=$,m=qw(h,$))),m===1))throw k=Jp,uu(h,0),Hs(h,N),_a(h,je()),k;switch(h.finishedWork=T,h.finishedLanes=N,m){case 0:case 1:throw Error(i(345));case 2:cu(h,Ea,Jo);break;case 3:if(Hs(h,N),(N&130023424)===N&&(m=jw+500-je(),10<m)){if(qo(h,0)!==0)break;if(T=h.suspendedLanes,(T&N)!==N){Zr(),h.pingedLanes|=h.suspendedLanes&T;break}h.timeoutHandle=we(cu.bind(null,h,Ea,Jo),m);break}cu(h,Ea,Jo);break;case 4:if(Hs(h,N),(N&4194240)===N)break;for(m=h.eventTimes,T=-1;0<N;){var U=31-Ha(N);$=1<<U,U=m[U],U>T&&(T=U),N&=~$}if(N=T,N=je()-N,N=(120>N?120:480>N?480:1080>N?1080:1920>N?1920:3e3>N?3e3:4320>N?4320:1960*bV(N/1960))-N,10<N){h.timeoutHandle=we(cu.bind(null,h,Ea,Jo),N);break}cu(h,Ea,Jo);break;case 5:cu(h,Ea,Jo);break;default:throw Error(i(329))}}}return _a(h,je()),h.callbackNode===k?K_.bind(null,h):null}function qw(h,m){var k=eh;return h.current.memoizedState.isDehydrated&&(uu(h,m).flags|=256),h=m0(h,m),h!==2&&(m=Ea,Ea=k,m!==null&&Kw(m)),h}function Kw(h){Ea===null?Ea=h:Ea.push.apply(Ea,h)}function vV(h){for(var m=h;;){if(m.flags&16384){var k=m.updateQueue;if(k!==null&&(k=k.stores,k!==null))for(var N=0;N<k.length;N++){var T=k[N],$=T.getSnapshot;T=T.value;try{if(!It($(),T))return!1}catch{return!1}}}if(k=m.child,m.subtreeFlags&16384&&k!==null)k.return=m,m=k;else{if(m===h)break;for(;m.sibling===null;){if(m.return===null||m.return===h)return!0;m=m.return}m.sibling.return=m.return,m=m.sibling}}return!0}function Hs(h,m){for(m&=~Ww,m&=~u0,h.suspendedLanes|=m,h.pingedLanes&=~m,h=h.expirationTimes;0<m;){var k=31-Ha(m),N=1<<k;h[k]=-1,m&=~N}}function X_(h){if(Ct&6)throw Error(i(327));du();var m=qo(h,0);if(!(m&1))return _a(h,je()),null;var k=m0(h,m);if(h.tag!==0&&k===2){var N=J(h);N!==0&&(m=N,k=qw(h,N))}if(k===1)throw k=Jp,uu(h,0),Hs(h,m),_a(h,je()),k;if(k===6)throw Error(i(345));return h.finishedWork=h.current.alternate,h.finishedLanes=m,cu(h,Ea,Jo),_a(h,je()),null}function Y_(h){Us!==null&&Us.tag===0&&!(Ct&6)&&du();var m=Ct;Ct|=1;var k=Hn.transition,N=Ce;try{if(Hn.transition=null,Ce=1,h)return h()}finally{Ce=N,Hn.transition=k,Ct=m,!(Ct&6)&&Yn()}}function Xw(){qa=Fc.current,an(Fc)}function uu(h,m){h.finishedWork=null,h.finishedLanes=0;var k=h.timeoutHandle;if(k!==ie&&(h.timeoutHandle=ie,q(k)),Jn!==null)for(k=Jn.return;k!==null;){var N=k;switch(Xo(N),N.tag){case 1:N=N.type.childContextTypes,N!=null&&Ec();break;case 3:Pc(),an(Hr),an(yr),gw();break;case 5:fw(N);break;case 4:Pc();break;case 13:an(On);break;case 19:an(On);break;case 10:sw(N.type._context);break;case 22:case 23:Xw()}k=k.return}if(vr=h,Jn=h=qs(h.current,null),Ar=qa=m,or=0,Jp=null,Ww=u0=lu=0,Ea=eh=null,ou!==null){for(m=0;m<ou.length;m++)if(k=ou[m],N=k.interleaved,N!==null){k.interleaved=null;var T=N.next,$=k.pending;if($!==null){var U=$.next;$.next=T,N.next=U}k.pending=N}ou=null}return h}function Q_(h,m){do{var k=Jn;try{if(ow(),Hg.current=Yg,qg){for(var N=$n.memoizedState;N!==null;){var T=N.queue;T!==null&&(T.pending=null),N=N.next}qg=!1}if(su=0,br=ir=$n=null,Up=!1,Gp=0,Vw.current=null,k===null||k.return===null){or=1,Jp=m,Jn=null;break}e:{var $=h,U=k.return,ae=k,he=m;if(m=Ar,ae.flags|=32768,he!==null&&typeof he=="object"&&typeof he.then=="function"){var Te=he,We=ae,ht=We.tag;if(!(We.mode&1)&&(ht===0||ht===11||ht===15)){var Ae=We.alternate;Ae?(We.updateQueue=Ae.updateQueue,We.memoizedState=Ae.memoizedState,We.lanes=Ae.lanes):(We.updateQueue=null,We.memoizedState=null)}var bn=w_(U);if(bn!==null){bn.flags&=-257,k_(bn,U,ae,$,m),bn.mode&1&&x_($,Te,m),m=bn,he=Te;var on=m.updateQueue;if(on===null){var Oa=new Set;Oa.add(he),m.updateQueue=Oa}else on.add(he);break e}else{if(!(m&1)){x_($,Te,m),Yw();break e}he=Error(i(426))}}else if(Bt&&ae.mode&1){var es=w_(U);if(es!==null){!(es.flags&65536)&&(es.flags|=256),k_(es,U,ae,$,m),aw(Dc(he,ae));break e}}$=he=Dc(he,ae),or!==4&&(or=2),eh===null?eh=[$]:eh.push($),$=U;do{switch($.tag){case 3:$.flags|=65536,m&=-m,$.lanes|=m;var pe=b_($,he,m);VE($,pe);break e;case 1:ae=he;var oe=$.type,be=$.stateNode;if(!($.flags&128)&&(typeof oe.getDerivedStateFromError=="function"||be!==null&&typeof be.componentDidCatch=="function"&&(js===null||!js.has(be)))){$.flags|=65536,m&=-m,$.lanes|=m;var Pe=v_($,ae,m);VE($,Pe);break e}}$=$.return}while($!==null)}e5(k)}catch(nt){m=nt,Jn===k&&k!==null&&(Jn=k=k.return);continue}break}while(!0)}function Z_(){var h=l0.current;return l0.current=Yg,h===null?Yg:h}function Yw(){(or===0||or===3||or===2)&&(or=4),vr===null||!(lu&268435455)&&!(u0&268435455)||Hs(vr,Ar)}function m0(h,m){var k=Ct;Ct|=2;var N=Z_();(vr!==h||Ar!==m)&&(Jo=null,uu(h,m));do try{xV();break}catch(T){Q_(h,T)}while(!0);if(ow(),Ct=k,l0.current=N,Jn!==null)throw Error(i(261));return vr=null,Ar=0,or}function xV(){for(;Jn!==null;)J_(Jn)}function wV(){for(;Jn!==null&&!bt();)J_(Jn)}function J_(h){var m=r5(h.alternate,h,qa);h.memoizedProps=h.pendingProps,m===null?e5(h):Jn=m,Vw.current=null}function e5(h){var m=h;do{var k=m.alternate;if(h=m.return,m.flags&32768){if(k=fV(k,m),k!==null){k.flags&=32767,Jn=k;return}if(h!==null)h.flags|=32768,h.subtreeFlags=0,h.deletions=null;else{or=6,Jn=null;return}}else if(k=hV(k,m,qa),k!==null){Jn=k;return}if(m=m.sibling,m!==null){Jn=m;return}Jn=m=h}while(m!==null);or===0&&(or=5)}function cu(h,m,k){var N=Ce,T=Hn.transition;try{Hn.transition=null,Ce=1,kV(h,m,k,N)}finally{Hn.transition=T,Ce=N}return null}function kV(h,m,k,N){do du();while(Us!==null);if(Ct&6)throw Error(i(327));k=h.finishedWork;var T=h.finishedLanes;if(k===null)return null;if(h.finishedWork=null,h.finishedLanes=0,k===h.current)throw Error(i(177));h.callbackNode=null,h.callbackPriority=0;var $=k.lanes|k.childLanes;if(Oe(h,$),h===vr&&(Jn=vr=null,Ar=0),!(k.subtreeFlags&2064)&&!(k.flags&2064)||d0||(d0=!0,a5(Xe,function(){return du(),null})),$=(k.flags&15990)!==0,k.subtreeFlags&15990||$){$=Hn.transition,Hn.transition=null;var U=Ce;Ce=1;var ae=Ct;Ct|=4,Vw.current=null,gV(h,k),W_(k,h),Y(h.containerInfo),h.current=k,yV(k),ct(),Ct=ae,Ce=U,Hn.transition=$}else h.current=k;if(d0&&(d0=!1,Us=h,p0=T),$=h.pendingLanes,$===0&&(js=null),Fn(k.stateNode),_a(h,je()),m!==null)for(N=h.onRecoverableError,k=0;k<m.length;k++)T=m[k],N(T.value,{componentStack:T.stack,digest:T.digest});if(c0)throw c0=!1,h=Gw,Gw=null,h;return p0&1&&h.tag!==0&&du(),$=h.pendingLanes,$&1?h===Hw?th++:(th=0,Hw=h):th=0,Yn(),null}function du(){if(Us!==null){var h=Le(p0),m=Hn.transition,k=Ce;try{if(Hn.transition=null,Ce=16>h?16:h,Us===null)var N=!1;else{if(h=Us,Us=null,p0=0,Ct&6)throw Error(i(331));var T=Ct;for(Ct|=4,Fe=h.current;Fe!==null;){var $=Fe,U=$.child;if(Fe.flags&16){var ae=$.deletions;if(ae!==null){for(var he=0;he<ae.length;he++){var Te=ae[he];for(Fe=Te;Fe!==null;){var We=Fe;switch(We.tag){case 0:case 11:case 15:Qp(8,We,$)}var ht=We.child;if(ht!==null)ht.return=We,Fe=ht;else for(;Fe!==null;){We=Fe;var Ae=We.sibling,bn=We.return;if(F_(We),We===Te){Fe=null;break}if(Ae!==null){Ae.return=bn,Fe=Ae;break}Fe=bn}}}var on=$.alternate;if(on!==null){var Oa=on.child;if(Oa!==null){on.child=null;do{var es=Oa.sibling;Oa.sibling=null,Oa=es}while(Oa!==null)}}Fe=$}}if($.subtreeFlags&2064&&U!==null)U.return=$,Fe=U;else e:for(;Fe!==null;){if($=Fe,$.flags&2048)switch($.tag){case 0:case 11:case 15:Qp(9,$,$.return)}var pe=$.sibling;if(pe!==null){pe.return=$.return,Fe=pe;break e}Fe=$.return}}var oe=h.current;for(Fe=oe;Fe!==null;){U=Fe;var be=U.child;if(U.subtreeFlags&2064&&be!==null)be.return=U,Fe=be;else e:for(U=oe;Fe!==null;){if(ae=Fe,ae.flags&2048)try{switch(ae.tag){case 0:case 11:case 15:n0(9,ae)}}catch(nt){Cn(ae,ae.return,nt)}if(ae===U){Fe=null;break e}var Pe=ae.sibling;if(Pe!==null){Pe.return=ae.return,Fe=Pe;break e}Fe=ae.return}}if(Ct=T,Yn(),ut&&typeof ut.onPostCommitFiberRoot=="function")try{ut.onPostCommitFiberRoot(et,h)}catch{}N=!0}return N}finally{Ce=k,Hn.transition=m}}return!1}function t5(h,m,k){m=Dc(k,m),m=b_(h,m,1),h=Ws(h,m,1),m=Zr(),h!==null&&(xe(h,1,m),_a(h,m))}function Cn(h,m,k){if(h.tag===3)t5(h,h,k);else for(;m!==null;){if(m.tag===3){t5(m,h,k);break}else if(m.tag===1){var N=m.stateNode;if(typeof m.type.getDerivedStateFromError=="function"||typeof N.componentDidCatch=="function"&&(js===null||!js.has(N))){h=Dc(k,h),h=v_(m,h,1),m=Ws(m,h,1),h=Zr(),m!==null&&(xe(m,1,h),_a(m,h));break}}m=m.return}}function SV(h,m,k){var N=h.pingCache;N!==null&&N.delete(m),m=Zr(),h.pingedLanes|=h.suspendedLanes&k,vr===h&&(Ar&k)===k&&(or===4||or===3&&(Ar&130023424)===Ar&&500>je()-jw?uu(h,0):Ww|=k),_a(h,m)}function n5(h,m){m===0&&(h.mode&1?(m=Ho,Ho<<=1,!(Ho&130023424)&&(Ho=4194304)):m=1);var k=Zr();h=go(h,m),h!==null&&(xe(h,m,k),_a(h,k))}function CV(h){var m=h.memoizedState,k=0;m!==null&&(k=m.retryLane),n5(h,k)}function NV(h,m){var k=0;switch(h.tag){case 13:var N=h.stateNode,T=h.memoizedState;T!==null&&(k=T.retryLane);break;case 19:N=h.stateNode;break;default:throw Error(i(314))}N!==null&&N.delete(m),n5(h,k)}var r5;r5=function(h,m,k){if(h!==null)if(h.memoizedProps!==m.pendingProps||Hr.current)Ia=!0;else{if(!(h.lanes&k)&&!(m.flags&128))return Ia=!1,pV(h,m,k);Ia=!!(h.flags&131072)}else Ia=!1,Bt&&m.flags&1048576&&zp(m,Zn,m.index);switch(m.lanes=0,m.tag){case 2:var N=m.type;Zg(h,m),h=m.pendingProps;var T=zs(m,yr.current);Rc(m,k),T=vw(null,m,N,h,T,k);var $=xw();return m.flags|=1,typeof T=="object"&&T!==null&&typeof T.render=="function"&&T.$$typeof===void 0?(m.tag=1,m.memoizedState=null,m.updateQueue=null,qr(N)?($=!0,mo(m)):$=!1,m.memoizedState=T.state!==null&&T.state!==void 0?T.state:null,cw(m),T.updater=jg,m.stateNode=T,T._reactInternals=m,pw(m,N,h,k),m=Ew(null,m,N,!0,$,k)):(m.tag=0,Bt&&$&&ma(m),ga(null,m,T,k),m=m.child),m;case 16:N=m.elementType;e:{switch(Zg(h,m),h=m.pendingProps,T=N._init,N=T(N._payload),m.type=N,T=m.tag=IV(N),h=ji(N,h),T){case 0:m=Iw(null,m,N,h,k);break e;case 1:m=E_(null,m,N,h,k);break e;case 11:m=S_(null,m,N,h,k);break e;case 14:m=C_(null,m,N,ji(N.type,h),k);break e}throw Error(i(306,N,""))}return m;case 0:return N=m.type,T=m.pendingProps,T=m.elementType===N?T:ji(N,T),Iw(h,m,N,T,k);case 1:return N=m.type,T=m.pendingProps,T=m.elementType===N?T:ji(N,T),E_(h,m,N,T,k);case 3:e:{if(__(m),h===null)throw Error(i(387));N=m.pendingProps,$=m.memoizedState,T=$.element,zE(h,m),Wg(m,N,null,k);var U=m.memoizedState;if(N=U.element,Ie&&$.isDehydrated)if($={element:N,isDehydrated:!1,cache:U.cache,pendingSuspenseBoundaries:U.pendingSuspenseBoundaries,transitions:U.transitions},m.updateQueue.baseState=$,m.memoizedState=$,m.flags&256){T=Dc(Error(i(423)),m),m=O_(h,m,N,k,T);break e}else if(N!==T){T=Dc(Error(i(424)),m),m=O_(h,m,N,k,T);break e}else for(Ie&&(Rr=X2(m.stateNode.containerInfo),Bn=m,Bt=!0,Wi=null,Yo=!1),k=XE(m,null,N,k),m.child=k;k;)k.flags=k.flags&-3|4096,k=k.sibling;else{if(Oc(),N===T){m=Zo(h,m,k);break e}ga(h,m,N,k)}m=m.child}return m;case 5:return YE(m),h===null&&rw(m),N=m.type,T=m.pendingProps,$=h!==null?h.memoizedProps:null,U=T.children,le(N,T)?U=null:$!==null&&le(N,$)&&(m.flags|=32),I_(h,m),ga(h,m,U,k),m.child;case 6:return h===null&&rw(m),null;case 13:return $_(h,m,k);case 4:return hw(m,m.stateNode.containerInfo),N=m.pendingProps,h===null?m.child=Mc(m,null,N,k):ga(h,m,N,k),m.child;case 11:return N=m.type,T=m.pendingProps,T=m.elementType===N?T:ji(N,T),S_(h,m,N,T,k);case 7:return ga(h,m,m.pendingProps,k),m.child;case 8:return ga(h,m,m.pendingProps.children,k),m.child;case 12:return ga(h,m,m.pendingProps.children,k),m.child;case 10:e:{if(N=m.type._context,T=m.pendingProps,$=m.memoizedProps,U=T.value,FE(m,N,U),$!==null)if(It($.value,U)){if($.children===T.children&&!Hr.current){m=Zo(h,m,k);break e}}else for($=m.child,$!==null&&($.return=m);$!==null;){var ae=$.dependencies;if(ae!==null){U=$.child;for(var he=ae.firstContext;he!==null;){if(he.context===N){if($.tag===1){he=Qo(-1,k&-k),he.tag=2;var Te=$.updateQueue;if(Te!==null){Te=Te.shared;var We=Te.pending;We===null?he.next=he:(he.next=We.next,We.next=he),Te.pending=he}}$.lanes|=k,he=$.alternate,he!==null&&(he.lanes|=k),lw($.return,k,m),ae.lanes|=k;break}he=he.next}}else if($.tag===10)U=$.type===m.type?null:$.child;else if($.tag===18){if(U=$.return,U===null)throw Error(i(341));U.lanes|=k,ae=U.alternate,ae!==null&&(ae.lanes|=k),lw(U,k,m),U=$.sibling}else U=$.child;if(U!==null)U.return=$;else for(U=$;U!==null;){if(U===m){U=null;break}if($=U.sibling,$!==null){$.return=U.return,U=$;break}U=U.return}$=U}ga(h,m,T.children,k),m=m.child}return m;case 9:return T=m.type,N=m.pendingProps.children,Rc(m,k),T=ci(T),N=N(T),m.flags|=1,ga(h,m,N,k),m.child;case 14:return N=m.type,T=ji(N,m.pendingProps),T=ji(N.type,T),C_(h,m,N,T,k);case 15:return N_(h,m,m.type,m.pendingProps,k);case 17:return N=m.type,T=m.pendingProps,T=m.elementType===N?T:ji(N,T),Zg(h,m),m.tag=1,qr(N)?(h=!0,mo(m)):h=!1,Rc(m,k),GE(m,N,T),pw(m,N,T,k),Ew(null,m,N,!0,h,k);case 19:return M_(h,m,k);case 22:return T_(h,m,k)}throw Error(i(156,m.tag))};function a5(h,m){return st(h,m)}function TV(h,m,k,N){this.tag=h,this.key=k,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=m,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=N,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function fi(h,m,k,N){return new TV(h,m,k,N)}function Qw(h){return h=h.prototype,!(!h||!h.isReactComponent)}function IV(h){if(typeof h=="function")return Qw(h)?1:0;if(h!=null){if(h=h.$$typeof,h===g)return 11;if(h===b)return 14}return 2}function qs(h,m){var k=h.alternate;return k===null?(k=fi(h.tag,m,h.key,h.mode),k.elementType=h.elementType,k.type=h.type,k.stateNode=h.stateNode,k.alternate=h,h.alternate=k):(k.pendingProps=m,k.type=h.type,k.flags=0,k.subtreeFlags=0,k.deletions=null),k.flags=h.flags&14680064,k.childLanes=h.childLanes,k.lanes=h.lanes,k.child=h.child,k.memoizedProps=h.memoizedProps,k.memoizedState=h.memoizedState,k.updateQueue=h.updateQueue,m=h.dependencies,k.dependencies=m===null?null:{lanes:m.lanes,firstContext:m.firstContext},k.sibling=h.sibling,k.index=h.index,k.ref=h.ref,k}function g0(h,m,k,N,T,$){var U=2;if(N=h,typeof h=="function")Qw(h)&&(U=1);else if(typeof h=="string")U=5;else e:switch(h){case u:return pu(k.children,T,$,m);case c:U=8,T|=8;break;case d:return h=fi(12,k,m,T|2),h.elementType=d,h.lanes=$,h;case y:return h=fi(13,k,m,T),h.elementType=y,h.lanes=$,h;case x:return h=fi(19,k,m,T),h.elementType=x,h.lanes=$,h;case w:return y0(k,T,$,m);default:if(typeof h=="object"&&h!==null)switch(h.$$typeof){case p:U=10;break e;case f:U=9;break e;case g:U=11;break e;case b:U=14;break e;case v:U=16,N=null;break e}throw Error(i(130,h==null?h:typeof h,""))}return m=fi(U,k,m,T),m.elementType=h,m.type=N,m.lanes=$,m}function pu(h,m,k,N){return h=fi(7,h,N,m),h.lanes=k,h}function y0(h,m,k,N){return h=fi(22,h,N,m),h.elementType=w,h.lanes=k,h.stateNode={isHidden:!1},h}function Zw(h,m,k){return h=fi(6,h,null,m),h.lanes=k,h}function Jw(h,m,k){return m=fi(4,h.children!==null?h.children:[],h.key,m),m.lanes=k,m.stateNode={containerInfo:h.containerInfo,pendingChildren:null,implementation:h.implementation},m}function EV(h,m,k,N,T){this.tag=m,this.containerInfo=h,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=ie,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ge(0),this.expirationTimes=ge(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ge(0),this.identifierPrefix=N,this.onRecoverableError=T,Ie&&(this.mutableSourceEagerHydrationData=null)}function i5(h,m,k,N,T,$,U,ae,he){return h=new EV(h,m,k,ae,he),m===1?(m=1,$===!0&&(m|=8)):m=0,$=fi(3,null,null,m),h.current=$,$.stateNode=h,$.memoizedState={element:N,isDehydrated:k,cache:null,transitions:null,pendingSuspenseBoundaries:null},cw($),h}function o5(h){if(!h)return ui;h=h._reactInternals;e:{if(E(h)!==h||h.tag!==1)throw Error(i(170));var m=h;do{switch(m.tag){case 3:m=m.stateNode.context;break e;case 1:if(qr(m.type)){m=m.stateNode.__reactInternalMemoizedMergedChildContext;break e}}m=m.return}while(m!==null);throw Error(i(171))}if(h.tag===1){var k=h.type;if(qr(k))return kn(h,k,m)}return m}function s5(h){var m=h._reactInternals;if(m===void 0)throw typeof h.render=="function"?Error(i(188)):(h=Object.keys(h).join(","),Error(i(268,h)));return h=L(m),h===null?null:h.stateNode}function l5(h,m){if(h=h.memoizedState,h!==null&&h.dehydrated!==null){var k=h.retryLane;h.retryLane=k!==0&&k<m?k:m}}function b0(h,m){l5(h,m),(h=h.alternate)&&l5(h,m)}function _V(h){return h=L(h),h===null?null:h.stateNode}function OV(){return null}return e.attemptContinuousHydration=function(h){if(h.tag===13){var m=go(h,134217728);if(m!==null){var k=Zr();hi(m,h,134217728,k)}b0(h,134217728)}},e.attemptDiscreteHydration=function(h){if(h.tag===13){var m=go(h,1);if(m!==null){var k=Zr();hi(m,h,1,k)}b0(h,1)}},e.attemptHydrationAtCurrentPriority=function(h){if(h.tag===13){var m=Gs(h),k=go(h,m);if(k!==null){var N=Zr();hi(k,h,m,N)}b0(h,m)}},e.attemptSynchronousHydration=function(h){switch(h.tag){case 3:var m=h.stateNode;if(m.current.memoizedState.isDehydrated){var k=iu(m.pendingLanes);k!==0&&(Ee(m,k|1),_a(m,je()),!(Ct&6)&&(Bc(),Yn()))}break;case 13:Y_(function(){var N=go(h,1);if(N!==null){var T=Zr();hi(N,h,1,T)}}),b0(h,1)}},e.batchedUpdates=function(h,m){var k=Ct;Ct|=1;try{return h(m)}finally{Ct=k,Ct===0&&(Bc(),yn&&Yn())}},e.createComponentSelector=function(h){return{$$typeof:r0,value:h}},e.createContainer=function(h,m,k,N,T,$,U){return i5(h,m,!1,null,k,N,T,$,U)},e.createHasPseudoClassSelector=function(h){return{$$typeof:a0,value:h}},e.createHydrationContainer=function(h,m,k,N,T,$,U,ae,he){return h=i5(k,N,!0,h,T,$,U,ae,he),h.context=o5(null),k=h.current,N=Zr(),T=Gs(k),$=Qo(N,T),$.callback=m??null,Ws(k,$,T),h.current.lanes=T,xe(h,T,N),_a(h,N),h},e.createPortal=function(h,m,k){var N=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:l,key:N==null?null:""+N,children:h,containerInfo:m,implementation:k}},e.createRoleSelector=function(h){return{$$typeof:i0,value:h}},e.createTestNameSelector=function(h){return{$$typeof:o0,value:h}},e.createTextSelector=function(h){return{$$typeof:s0,value:h}},e.deferredUpdates=function(h){var m=Ce,k=Hn.transition;try{return Hn.transition=null,Ce=16,h()}finally{Ce=m,Hn.transition=k}},e.discreteUpdates=function(h,m,k,N,T){var $=Ce,U=Hn.transition;try{return Hn.transition=null,Ce=1,h(m,k,N,T)}finally{Ce=$,Hn.transition=U,Ct===0&&Bc()}},e.findAllNodes=zw,e.findBoundingRects=function(h,m){if(!Qe)throw Error(i(363));m=zw(h,m),h=[];for(var k=0;k<m.length;k++)h.push(Wt(m[k]));for(m=h.length-1;0<m;m--){k=h[m];for(var N=k.x,T=N+k.width,$=k.y,U=$+k.height,ae=m-1;0<=ae;ae--)if(m!==ae){var he=h[ae],Te=he.x,We=Te+he.width,ht=he.y,Ae=ht+he.height;if(N>=Te&&$>=ht&&T<=We&&U<=Ae){h.splice(m,1);break}else if(N!==Te||k.width!==he.width||Ae<$||ht>U){if(!($!==ht||k.height!==he.height||We<N||Te>T)){Te>N&&(he.width+=Te-N,he.x=N),We<T&&(he.width=T-Te),h.splice(m,1);break}}else{ht>$&&(he.height+=ht-$,he.y=$),Ae<U&&(he.height=U-ht),h.splice(m,1);break}}}return h},e.findHostInstance=s5,e.findHostInstanceWithNoPortals=function(h){return h=M(h),h=h!==null?B(h):null,h===null?null:h.stateNode},e.findHostInstanceWithWarning=function(h){return s5(h)},e.flushControlled=function(h){var m=Ct;Ct|=1;var k=Hn.transition,N=Ce;try{Hn.transition=null,Ce=1,h()}finally{Ce=N,Hn.transition=k,Ct=m,Ct===0&&(Bc(),Yn())}},e.flushPassiveEffects=du,e.flushSync=Y_,e.focusWithin=function(h,m){if(!Qe)throw Error(i(363));for(h=Lw(h),m=q_(h,m),m=Array.from(m),h=0;h<m.length;){var k=m[h++];if(!Yt(k)){if(k.tag===5&&Tt(k.stateNode))return!0;for(k=k.child;k!==null;)m.push(k),k=k.sibling}}return!1},e.getCurrentUpdatePriority=function(){return Ce},e.getFindAllNodesFailureDescription=function(h,m){if(!Qe)throw Error(i(363));var k=0,N=[];h=[Lw(h),0];for(var T=0;T<h.length;){var $=h[T++],U=h[T++],ae=m[U];if(($.tag!==5||!Yt($))&&(Fw($,ae)&&(N.push(Bw(ae)),U++,U>k&&(k=U)),U<m.length))for($=$.child;$!==null;)h.push($,U),$=$.sibling}if(k<m.length){for(h=[];k<m.length;k++)h.push(Bw(m[k]));return`findAllNodes was able to match part of the selector:
  `+(N.join(" > ")+`

No matching component was found for:
  `)+h.join(" > ")}return null},e.getPublicRootInstance=function(h){if(h=h.current,!h.child)return null;switch(h.child.tag){case 5:return X(h.child.stateNode);default:return h.child.stateNode}},e.injectIntoDevTools=function(h){if(h={bundleType:h.bundleType,version:h.version,rendererPackageName:h.rendererPackageName,rendererConfig:h.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:o.ReactCurrentDispatcher,findHostInstanceByFiber:_V,findFiberByHostInstance:h.findFiberByHostInstance||OV,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")h=!1;else{var m=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(m.isDisabled||!m.supportsFiber)h=!0;else{try{et=m.inject(h),ut=m}catch{}h=!!m.checkDCE}}return h},e.isAlreadyRendering=function(){return!1},e.observeVisibleRects=function(h,m,k,N){if(!Qe)throw Error(i(363));h=zw(h,m);var T=Gn(h,k,N).disconnect;return{disconnect:function(){T()}}},e.registerMutableSourceForHydration=function(h,m){var k=m._getVersion;k=k(m._source),h.mutableSourceEagerHydrationData==null?h.mutableSourceEagerHydrationData=[m,k]:h.mutableSourceEagerHydrationData.push(m,k)},e.runWithPriority=function(h,m){var k=Ce;try{return Ce=h,m()}finally{Ce=k}},e.shouldError=function(){return null},e.shouldSuspend=function(){return!1},e.updateContainer=function(h,m,k,N){var T=m.current,$=Zr(),U=Gs(T);return k=o5(k),m.context===null?m.context=k:m.pendingContext=k,m=Qo($,U),m.payload={element:h},N=N===void 0?null:N,N!==null&&(m.callback=N),h=Ws(T,m,U),h!==null&&(hi(h,T,U,$),Vg(h,T,U)),U},e};fA.exports=Ate;var Pte=fA.exports;const Dte=Hi(Pte);var mA={exports:{}},Bu={};/**
* @license React
* react-reconciler-constants.production.min.js
*
* Copyright (c) Facebook, Inc. and its affiliates.
*
* This source code is licensed under the MIT license found in the
* LICENSE file in the root directory of this source tree.
*/Bu.ConcurrentRoot=1,Bu.ContinuousEventPriority=4,Bu.DefaultEventPriority=16,Bu.DiscreteEventPriority=1,Bu.IdleEventPriority=536870912,Bu.LegacyRoot=0,mA.exports=Bu;var gA=mA.exports;const yA={children:!0,ref:!0,key:!0,style:!0,forwardedRef:!0,unstable_applyCache:!0,unstable_applyDrawHitFromCache:!0};let bA=!1,vA=!1;const I3=".react-konva-event",Lte=`ReactKonva: You have a Konva node with draggable = true and position defined but no onDragMove or onDragEnd events are handled.
Position of a node will be changed during drag&drop, so you should update state of the react app as well.
Consider to add onDragMove or onDragEnd events.
For more info see: https://github.com/konvajs/react-konva/issues/256
`,Fte=`ReactKonva: You are using "zIndex" attribute for a Konva node.
react-konva may get confused with ordering. Just define correct order of elements in your render function of a component.
For more info see: https://github.com/konvajs/react-konva/issues/194
`,Bte={};function pb(t,e,n=Bte){if(!bA&&"zIndex"in e&&(console.warn(Fte),bA=!0),!vA&&e.draggable){var r=e.x!==void 0||e.y!==void 0,a=e.onDragEnd||e.onDragMove;r&&!a&&(console.warn(Lte),vA=!0)}for(var i in n)if(!yA[i]){var o=i.slice(0,2)==="on",s=n[i]!==e[i];if(o&&s){var l=i.substr(2).toLowerCase();l.substr(0,7)==="content"&&(l="content"+l.substr(7,1).toUpperCase()+l.substr(8)),t.off(l,n[i])}var u=!e.hasOwnProperty(i);u&&t.setAttr(i,void 0)}var c=e._useStrictMode,d={},p=!1;const f={};for(var i in e)if(!yA[i]){var o=i.slice(0,2)==="on",g=n[i]!==e[i];if(o&&g){var l=i.substr(2).toLowerCase();l.substr(0,7)==="content"&&(l="content"+l.substr(7,1).toUpperCase()+l.substr(8)),e[i]&&(f[l]=e[i])}!o&&(e[i]!==n[i]||c&&e[i]!==t.getAttr(i))&&(p=!0,d[i]=e[i])}p&&(t.setAttrs(d),El(t));for(var l in f)t.on(l+I3,f[l])}function El(t){if(!wt.Konva.autoDrawEnabled){var e=t.getLayer()||t.getStage();e&&e.batchDraw()}}const xA={},zte={};mf.Node.prototype._applyProps=pb;function Vte(t,e){if(typeof e=="string"){console.error(`Do not use plain text as child of Konva.Node. You are using text: ${e}`);return}t.add(e),El(t)}function Wte(t,e,n){let r=mf[t];r||(console.error(`Konva has no node with the type ${t}. Group will be used instead. If you use minimal version of react-konva, just import required nodes into Konva: "import "konva/lib/shapes/${t}"  If you want to render DOM elements as part of canvas tree take a look into this demo: https://konvajs.github.io/docs/react/DOM_Portal.html`),r=mf.Group);const a={},i={};for(var o in e){var s=o.slice(0,2)==="on";s?i[o]=e[o]:a[o]=e[o]}const l=new r(a);return pb(l,i),l}function jte(t,e,n){console.error(`Text components are not supported for now in ReactKonva. Your text is: "${t}"`)}function Ute(t,e,n){return!1}function Gte(t){return t}function Hte(){return null}function qte(){return null}function Kte(t,e,n,r){return zte}function Xte(){}function Yte(t){}function Qte(t,e){return!1}function Zte(){return xA}function Jte(){return xA}const ene=setTimeout,tne=clearTimeout,nne=-1;function rne(t,e){return!1}const ane=!1,ine=!0,one=!0;function sne(t,e){e.parent===t?e.moveToTop():t.add(e),El(t)}function lne(t,e){e.parent===t?e.moveToTop():t.add(e),El(t)}function wA(t,e,n){e._remove(),t.add(e),e.setZIndex(n.getZIndex()),El(t)}function une(t,e,n){wA(t,e,n)}function cne(t,e){e.destroy(),e.off(I3),El(t)}function dne(t,e){e.destroy(),e.off(I3),El(t)}function pne(t,e,n){console.error(`Text components are not yet supported in ReactKonva. You text is: "${n}"`)}function hne(t,e,n){}function fne(t,e,n,r,a){pb(t,a,r)}function mne(t){t.hide(),El(t)}function gne(t){}function yne(t,e){(e.visible==null||e.visible)&&t.show()}function bne(t,e){}function vne(t){}function xne(){}const wne=()=>gA.DefaultEventPriority,kne=Object.freeze(Object.defineProperty({__proto__:null,appendChild:sne,appendChildToContainer:lne,appendInitialChild:Vte,cancelTimeout:tne,clearContainer:vne,commitMount:hne,commitTextUpdate:pne,commitUpdate:fne,createInstance:Wte,createTextInstance:jte,detachDeletedInstance:xne,finalizeInitialChildren:Ute,getChildHostContext:Jte,getCurrentEventPriority:wne,getPublicInstance:Gte,getRootHostContext:Zte,hideInstance:mne,hideTextInstance:gne,idlePriority:lh.unstable_IdlePriority,insertBefore:wA,insertInContainerBefore:une,isPrimaryRenderer:ane,noTimeout:nne,now:lh.unstable_now,prepareForCommit:Hte,preparePortalMount:qte,prepareUpdate:Kte,removeChild:cne,removeChildFromContainer:dne,resetAfterCommit:Xte,resetTextContent:Yte,run:lh.unstable_runWithPriority,scheduleTimeout:ene,shouldDeprioritizeSubtree:Qte,shouldSetTextContent:rne,supportsMutation:one,unhideInstance:yne,unhideTextInstance:bne,warnsIfNotActing:ine},Symbol.toStringTag,{value:"Module"}));var Sne=Object.defineProperty,Cne=Object.defineProperties,Nne=Object.getOwnPropertyDescriptors,kA=Object.getOwnPropertySymbols,Tne=Object.prototype.hasOwnProperty,Ine=Object.prototype.propertyIsEnumerable,SA=(t,e,n)=>e in t?Sne(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,CA=(t,e)=>{for(var n in e||(e={}))Tne.call(e,n)&&SA(t,n,e[n]);if(kA)for(var n of kA(e))Ine.call(e,n)&&SA(t,n,e[n]);return t},Ene=(t,e)=>Cne(t,Nne(e));function NA(t,e,n){if(!t)return;if(n(t)===!0)return t;let r=e?t.return:t.child;for(;r;){const a=NA(r,e,n);if(a)return a;r=e?null:r.sibling}}function TA(t){try{return Object.defineProperties(t,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return t}}const E3=TA(P.createContext(null));class IA extends P.Component{render(){return P.createElement(E3.Provider,{value:this._reactInternals},this.props.children)}}const{ReactCurrentOwner:EA,ReactCurrentDispatcher:_A}=P.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function _ne(){const t=P.useContext(E3);if(t===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=P.useId();return P.useMemo(()=>{for(const n of[EA?.current,t,t?.alternate]){if(!n)continue;const r=NA(n,!1,a=>{let i=a.memoizedState;for(;i;){if(i.memoizedState===e)return!0;i=i.next}});if(r)return r}},[t,e])}function One(){var t,e;const n=_ne(),[r]=P.useState(()=>new Map);r.clear();let a=n;for(;a;){const i=(t=a.type)==null?void 0:t._context;i&&i!==E3&&!r.has(i)&&r.set(i,(e=_A?.current)==null?void 0:e.readContext(TA(i))),a=a.return}return r}function $ne(){const t=One();return P.useMemo(()=>Array.from(t.keys()).reduce((e,n)=>r=>P.createElement(e,null,P.createElement(n.Provider,Ene(CA({},r),{value:t.get(n)}))),e=>P.createElement(IA,CA({},e))),[t])}function Rne(t){const e=G.useRef({});return G.useLayoutEffect(()=>{e.current=t}),G.useLayoutEffect(()=>()=>{e.current={}},[]),e.current}const Mne=t=>{const e=G.useRef(),n=G.useRef(),r=G.useRef(),a=Rne(t),i=$ne(),o=s=>{const{forwardedRef:l}=t;l&&(typeof l=="function"?l(s):l.current=s)};return G.useLayoutEffect(()=>(n.current=new mf.Stage({width:t.width,height:t.height,container:e.current}),o(n.current),r.current=gf.createContainer(n.current,gA.LegacyRoot,!1,null),gf.updateContainer(G.createElement(i,{},t.children),r.current),()=>{mf.isBrowser&&(o(null),gf.updateContainer(null,r.current,null),n.current.destroy())}),[]),G.useLayoutEffect(()=>{o(n.current),pb(n.current,t,a),gf.updateContainer(G.createElement(i,{},t.children),r.current,null)}),G.createElement("div",{ref:e,id:t.id,accessKey:t.accessKey,className:t.className,role:t.role,style:t.style,tabIndex:t.tabIndex,title:t.title})},OA="Layer",$A="Image",Ane="Transformer",gf=Dte(kne);gf.injectIntoDevTools({findHostInstanceByFiber:()=>null,bundleType:0,version:G.version,rendererPackageName:"react-konva"});const Pne=G.forwardRef((t,e)=>G.createElement(IA,{},G.createElement(Mne,{...t,forwardedRef:e})));var zu=P,Dne=function(t,e,n){const r=zu.useRef("loading"),a=zu.useRef(),[i,o]=zu.useState(0),s=zu.useRef(),l=zu.useRef(),u=zu.useRef();return(s.current!==t||l.current!==e||u.current!==n)&&(r.current="loading",a.current=void 0,s.current=t,l.current=e,u.current=n),zu.useLayoutEffect(function(){if(!t)return;var c=document.createElement("img");function d(){r.current="loaded",a.current=c,o(Math.random())}function p(){r.current="failed",a.current=void 0,o(Math.random())}return c.addEventListener("load",d),c.addEventListener("error",p),e&&(c.crossOrigin=e),n&&(c.referrerPolicy=n),c.src=t,function(){c.removeEventListener("load",d),c.removeEventListener("error",p)}},[t,e,n]),[a.current,r.current]};const RA=Hi(Dne);var Lne={BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const MA=t=>{let e;const n=new Set,r=(s,l)=>{const u=typeof s=="function"?s(e):s;if(!Object.is(u,e)){const c=e;e=l??(typeof u!="object"||u===null)?u:Object.assign({},e,u),n.forEach(d=>d(e,c))}},a=()=>e,i={setState:r,getState:a,getInitialState:()=>o,subscribe:s=>(n.add(s),()=>n.delete(s)),destroy:()=>{(Lne?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},o=e=t(r,a,i);return i},Fne=t=>t?MA(t):MA;var AA={exports:{}},PA={},DA={exports:{}},LA={};/**
* @license React
* use-sync-external-store-shim.production.min.js
*
* Copyright (c) Facebook, Inc. and its affiliates.
*
* This source code is licensed under the MIT license found in the
* LICENSE file in the root directory of this source tree.
*/var Dd=P;function Bne(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var zne=typeof Object.is=="function"?Object.is:Bne,Vne=Dd.useState,Wne=Dd.useEffect,jne=Dd.useLayoutEffect,Une=Dd.useDebugValue;function Gne(t,e){var n=e(),r=Vne({inst:{value:n,getSnapshot:e}}),a=r[0].inst,i=r[1];return jne(function(){a.value=n,a.getSnapshot=e,_3(a)&&i({inst:a})},[t,n,e]),Wne(function(){return _3(a)&&i({inst:a}),t(function(){_3(a)&&i({inst:a})})},[t]),Une(n),n}function _3(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!zne(t,n)}catch{return!0}}function Hne(t,e){return e()}var qne=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?Hne:Gne;LA.useSyncExternalStore=Dd.useSyncExternalStore!==void 0?Dd.useSyncExternalStore:qne,DA.exports=LA;var Kne=DA.exports;/**
* @license React
* use-sync-external-store-shim/with-selector.production.min.js
*
* Copyright (c) Facebook, Inc. and its affiliates.
*
* This source code is licensed under the MIT license found in the
* LICENSE file in the root directory of this source tree.
*/var hb=P,Xne=Kne;function Yne(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Qne=typeof Object.is=="function"?Object.is:Yne,Zne=Xne.useSyncExternalStore,Jne=hb.useRef,ere=hb.useEffect,tre=hb.useMemo,nre=hb.useDebugValue;PA.useSyncExternalStoreWithSelector=function(t,e,n,r,a){var i=Jne(null);if(i.current===null){var o={hasValue:!1,value:null};i.current=o}else o=i.current;i=tre(function(){function l(f){if(!u){if(u=!0,c=f,f=r(f),a!==void 0&&o.hasValue){var g=o.value;if(a(g,f))return d=g}return d=f}if(g=d,Qne(c,f))return g;var y=r(f);return a!==void 0&&a(g,y)?g:(c=f,d=y)}var u=!1,c,d,p=n===void 0?null:n;return[function(){return l(e())},p===null?void 0:function(){return l(p())}]},[e,n,r,a]);var s=Zne(t,i[0],i[1]);return ere(function(){o.hasValue=!0,o.value=s},[s]),nre(s),s},AA.exports=PA;var rre=AA.exports;const are=Hi(rre);var FA={BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{useDebugValue:ire}=G,{useSyncExternalStoreWithSelector:ore}=are;let BA=!1;const sre=t=>t;function lre(t,e=sre,n){(FA?"production":void 0)!=="production"&&n&&!BA&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),BA=!0);const r=ore(t.subscribe,t.getState,t.getServerState||t.getInitialState,e,n);return ire(r),r}const zA=t=>{(FA?"production":void 0)!=="production"&&typeof t!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof t=="function"?Fne(t):t,n=(r,a)=>lre(e,r,a);return Object.assign(n,e),n},ure=t=>t?zA(t):zA;var fb={BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const O3=new Map,mb=t=>{const e=O3.get(t);return e?Object.fromEntries(Object.entries(e.stores).map(([n,r])=>[n,r.getState()])):{}},cre=(t,e,n)=>{if(t===void 0)return{type:"untracked",connection:e.connect(n)};const r=O3.get(n.name);if(r)return{type:"tracked",store:t,...r};const a={connection:e.connect(n),stores:{}};return O3.set(n.name,a),{type:"tracked",store:t,...a}},dre=(t,e={})=>(n,r,a)=>{const{enabled:i,anonymousActionType:o,store:s,...l}=e;let u;try{u=(i??(fb?"production":void 0)!=="production")&&window.__REDUX_DEVTOOLS_EXTENSION__}catch{}if(!u)return(fb?"production":void 0)!=="production"&&i&&console.warn("[zustand devtools middleware] Please install/enable Redux devtools extension"),t(n,r,a);const{connection:c,...d}=cre(s,u,l);let p=!0;a.setState=(y,x,b)=>{const v=n(y,x);if(!p)return v;const w=b===void 0?{type:o||"anonymous"}:typeof b=="string"?{type:b}:b;return s===void 0?(c?.send(w,r()),v):(c?.send({...w,type:`${s}/${w.type}`},{...mb(l.name),[s]:a.getState()}),v)};const f=(...y)=>{const x=p;p=!1,n(...y),p=x},g=t(a.setState,r,a);if(d.type==="untracked"?c?.init(g):(d.stores[d.store]=a,c?.init(Object.fromEntries(Object.entries(d.stores).map(([y,x])=>[y,y===d.store?g:x.getState()])))),a.dispatchFromDevtools&&typeof a.dispatch=="function"){let y=!1;const x=a.dispatch;a.dispatch=(...b)=>{(fb?"production":void 0)!=="production"&&b[0].type==="__setState"&&!y&&(console.warn('[zustand devtools middleware] "__setState" action type is reserved to set state from the devtools. Avoid using it.'),y=!0),x(...b)}}return c.subscribe(y=>{var x;switch(y.type){case"ACTION":if(typeof y.payload!="string"){console.error("[zustand devtools middleware] Unsupported action format");return}return $3(y.payload,b=>{if(b.type==="__setState"){if(s===void 0){f(b.state);return}Object.keys(b.state).length!==1&&console.error(`
                    [zustand devtools middleware] Unsupported __setState action format. 
                    When using 'store' option in devtools(), the 'state' should have only one key, which is a value of 'store' that was passed in devtools(),
                    and value of this only key should be a state object. Example: { "type": "__setState", "state": { "abc123Store": { "foo": "bar" } } }
                    `);const v=b.state[s];if(v==null)return;JSON.stringify(a.getState())!==JSON.stringify(v)&&f(v);return}a.dispatchFromDevtools&&typeof a.dispatch=="function"&&a.dispatch(b)});case"DISPATCH":switch(y.payload.type){case"RESET":return f(g),s===void 0?c?.init(a.getState()):c?.init(mb(l.name));case"COMMIT":if(s===void 0){c?.init(a.getState());return}return c?.init(mb(l.name));case"ROLLBACK":return $3(y.state,b=>{if(s===void 0){f(b),c?.init(a.getState());return}f(b[s]),c?.init(mb(l.name))});case"JUMP_TO_STATE":case"JUMP_TO_ACTION":return $3(y.state,b=>{if(s===void 0){f(b);return}JSON.stringify(a.getState())!==JSON.stringify(b[s])&&f(b[s])});case"IMPORT_STATE":{const{nextLiftedState:b}=y.payload,v=(x=b.computedStates.slice(-1)[0])==null?void 0:x.state;if(!v)return;f(s===void 0?v:v[s]),c?.send(null,b);return}case"PAUSE_RECORDING":return p=!p}return}}),g},pre=dre,$3=(t,e)=>{let n;try{n=JSON.parse(t)}catch(r){console.error("[zustand devtools middleware] Could not parse the received json",r)}n!==void 0&&e(n)};function hre(t,e){let n;try{n=t()}catch{return}return{getItem:r=>{var a;const i=s=>s===null?null:JSON.parse(s,e?.reviver),o=(a=n.getItem(r))!=null?a:null;return o instanceof Promise?o.then(i):i(o)},setItem:(r,a)=>n.setItem(r,JSON.stringify(a,e?.replacer)),removeItem:r=>n.removeItem(r)}}const yf=t=>e=>{try{const n=t(e);return n instanceof Promise?n:{then(r){return yf(r)(n)},catch(r){return this}}}catch(n){return{then(r){return this},catch(r){return yf(r)(n)}}}},fre=(t,e)=>(n,r,a)=>{let i={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:x=>x,version:0,merge:(x,b)=>({...b,...x}),...e},o=!1;const s=new Set,l=new Set;let u;try{u=i.getStorage()}catch{}if(!u)return t((...x)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),n(...x)},r,a);const c=yf(i.serialize),d=()=>{const x=i.partialize({...r()});let b;const v=c({state:x,version:i.version}).then(w=>u.setItem(i.name,w)).catch(w=>{b=w});if(b)throw b;return v},p=a.setState;a.setState=(x,b)=>{p(x,b),d()};const f=t((...x)=>{n(...x),d()},r,a);let g;const y=()=>{var x;if(!u)return;o=!1,s.forEach(v=>v(r()));const b=((x=i.onRehydrateStorage)==null?void 0:x.call(i,r()))||void 0;return yf(u.getItem.bind(u))(i.name).then(v=>{if(v)return i.deserialize(v)}).then(v=>{if(v)if(typeof v.version=="number"&&v.version!==i.version){if(i.migrate)return i.migrate(v.state,v.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return v.state}).then(v=>{var w;return g=i.merge(v,(w=r())!=null?w:f),n(g,!0),d()}).then(()=>{b?.(g,void 0),o=!0,l.forEach(v=>v(g))}).catch(v=>{b?.(void 0,v)})};return a.persist={setOptions:x=>{i={...i,...x},x.getStorage&&(u=x.getStorage())},clearStorage:()=>{u?.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>y(),hasHydrated:()=>o,onHydrate:x=>(s.add(x),()=>{s.delete(x)}),onFinishHydration:x=>(l.add(x),()=>{l.delete(x)})},y(),g||f},mre=(t,e)=>(n,r,a)=>{let i={storage:hre(()=>localStorage),partialize:y=>y,version:0,merge:(y,x)=>({...x,...y}),...e},o=!1;const s=new Set,l=new Set;let u=i.storage;if(!u)return t((...y)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),n(...y)},r,a);const c=()=>{const y=i.partialize({...r()});return u.setItem(i.name,{state:y,version:i.version})},d=a.setState;a.setState=(y,x)=>{d(y,x),c()};const p=t((...y)=>{n(...y),c()},r,a);a.getInitialState=()=>p;let f;const g=()=>{var y,x;if(!u)return;o=!1,s.forEach(v=>{var w;return v((w=r())!=null?w:p)});const b=((x=i.onRehydrateStorage)==null?void 0:x.call(i,(y=r())!=null?y:p))||void 0;return yf(u.getItem.bind(u))(i.name).then(v=>{if(v)if(typeof v.version=="number"&&v.version!==i.version){if(i.migrate)return i.migrate(v.state,v.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return v.state}).then(v=>{var w;return f=i.merge(v,(w=r())!=null?w:p),n(f,!0),c()}).then(()=>{b?.(f,void 0),f=r(),o=!0,l.forEach(v=>v(f))}).catch(v=>{b?.(void 0,v)})};return a.persist={setOptions:y=>{i={...i,...y},y.storage&&(u=y.storage)},clearStorage:()=>{u?.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>g(),hasHydrated:()=>o,onHydrate:y=>(s.add(y),()=>{s.delete(y)}),onFinishHydration:y=>(l.add(y),()=>{l.delete(y)})},i.skipHydration||g(),f||p},gre=(t,e)=>"getStorage"in e||"serialize"in e||"deserialize"in e?((fb?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),fre(t,e)):mre(t,e),yre=gre,VA=[{id:1,image:"./frame/frame_1.png",front:"./frame/frame_1_front.png"},{id:2,image:"./frame/frame_2.png",front:"./frame/frame_2_front.png"},{id:3,image:"./frame/frame_3.png",front:"./frame/frame_3_front.png"},{id:4,image:"./frame/frame_4.png",front:"./frame/frame_4_front.png"},{id:5,image:"./frame/frame_5.png",front:"./frame/frame_5_front.png"}],bre=[{id:"Betende_Frau_Maria",image:"./sticker/Betende_Frau_Maria.png"},{id:"Blumentopf",image:"./sticker/Blumentopf.png"},{id:"Blume",image:"./sticker/Blume.png"},{id:"Frau_in_gelbem_Kleid",image:"./sticker/Frau_in_gelbem_Kleid.png"},{id:"Magd",image:"./sticker/Magd.png"},{id:"Mann_liegend",image:"./sticker/Mann_liegend.png"},{id:"Mann",image:"./sticker/Mann.png"},{id:"Mucha_Dekor",image:"./sticker/Mucha_Dekor.png"},{id:"The_Hare",image:"./sticker/The_Hare.png"},{id:"Wasserspeier",image:"./sticker/Wasserspeier.png"}],WA=[{id:"http://www.wikidata.org/entity/Q20355536",name:"A Street in Torello, Italy",year:"1890",country:"Denmark",location:"Statens Museum for Kunst",creator:"Peder Severin Kr\xF8yer",url:"https://api.smk.dk/api/v1/iiif/manifest/?id=KMS1435",identifier:"https://iip.smk.dk/iiif/jp2/z603r155c_KMS1435.tif.reconstructed.tif.jp2",image:"https://iip.smk.dk/iiif/jp2/z603r155c_KMS1435.tif.reconstructed.tif.jp2/full/400,/0/default.jpg",thumbnail:"https://iip.smk.dk/iiif/jp2/z603r155c_KMS1435.tif.reconstructed.tif.jp2/full/100,100/0/default.jpg"},{id:"http://www.wikidata.org/entity/Q20537703",name:"At the French Windows. The Artist's Wife",year:"1897",country:"Denmark",location:"Statens Museum for Kunst",creator:"Laurits Andersen Ring",url:"https://api.smk.dk/api/v1/iiif/manifest/?id=KMS3716",identifier:"https://iip.smk.dk/iiif/jp2/1544bs13w_kms3716.tif.reconstructed.tif.jp2",image:"https://iip.smk.dk/iiif/jp2/1544bs13w_kms3716.tif.reconstructed.tif.jp2/full/400,/0/default.jpg",thumbnail:"https://iip.smk.dk/iiif/jp2/1544bs13w_kms3716.tif.reconstructed.tif.jp2/full/100,100/0/default.jpg"},{id:"http://www.wikidata.org/entity/Q103297795",name:"Brot! (Bread!)",year:"1924",country:"Germany",location:"Vanderbilt University Fine Arts Gallery",creator:"K\xE4the Kollwitz",url:"https://iiif-manifest.library.vanderbilt.edu/gallery/1977/1977.011.json",identifier:"https://iiif.library.vanderbilt.edu/iiif/2/gallery%2F1977%2F1977.011.tif",image:"https://iiif.library.vanderbilt.edu/iiif/2/gallery%2F1977%2F1977.011.tif/full/400,/0/default.jpg",thumbnail:"https://iiif.library.vanderbilt.edu/iiif/2/gallery%2F1977%2F1977.011.tif/full/100,100/0/default.jpg"},{id:"http://www.wikidata.org/entity/Q103297971",name:"Business-Man, ffrom Genius, Zeitschrift f\xFCr werdende und alte Kunst (Magazine for Emerging and Ancient Art), Year 2, no. 1",year:"1920",country:"Belgium",location:"Vanderbilt University Fine Arts Gallery",creator:"Frans Masereel",url:"https://iiif-manifest.library.vanderbilt.edu/gallery/1976/1976.032.json",identifier:"https://iiif.library.vanderbilt.edu/iiif/2/gallery%2F1976%2F1976.032.med.jpg",image:"https://iiif.library.vanderbilt.edu/iiif/2/gallery%2F1976%2F1976.032.med.jpg/full/400,/0/default.jpg",thumbnail:"https://iiif.library.vanderbilt.edu/iiif/2/gallery%2F1976%2F1976.032.med.jpg/full/100,100/0/default.jpg"},{id:"http://www.wikidata.org/entity/Q3698180",name:"Calvary",year:"1475",country:"Belgium",location:"Royal Museum of Fine Arts Antwerp",creator:"Antonello da Messina",url:"https://iiif.kmska.be/iiif/2/5/manifest.json",identifier:"https://iiif.kmska.be/c/iiif/2/public@5.tif",image:"https://iiif.kmska.be/c/iiif/2/public@5.tif/full/400,/0/default.jpg",thumbnail:"https://iiif.kmska.be/c/iiif/2/public@5.tif/full/100,100/0/default.jpg"},{id:"http://www.wikidata.org/entity/Q103300860",name:"Half-Figure Prophet",year:"1450",country:"France",location:"Vanderbilt University Fine Arts Gallery",creator:"http://www.wikidata.org/.well-known/genid/d7c4865c9fae865605be887d7277ab75",url:"https://iiif-manifest.library.vanderbilt.edu/gallery/1975/1975.005.json",identifier:"https://iiif.library.vanderbilt.edu/iiif/2/gallery%2F1975%2F1975.005.jpg",image:"https://iiif.library.vanderbilt.edu/iiif/2/gallery%2F1975%2F1975.005.jpg/full/400,/0/default.jpg",thumbnail:"https://iiif.library.vanderbilt.edu/iiif/2/gallery%2F1975%2F1975.005.jpg/full/100,100/0/default.jpg"},{id:"http://www.wikidata.org/entity/Q102967848",name:"Landscape with Shepherds",year:"",country:"Netherlands",location:"Vanderbilt University Fine Arts Gallery",creator:"Jan Both",url:"https://iiif-manifest.library.vanderbilt.edu/gallery/1979/1979.0195P.json",identifier:"https://iiif.library.vanderbilt.edu/iiif/2/gallery%2F1979%2F1979.0195P.tif",image:"https://iiif.library.vanderbilt.edu/iiif/2/gallery%2F1979%2F1979.0195P.tif/full/400,/0/default.jpg",thumbnail:"https://iiif.library.vanderbilt.edu/iiif/2/gallery%2F1979%2F1979.0195P.tif/full/100,100/0/default.jpg"},{id:"http://www.wikidata.org/entity/Q106582838",name:"The Blacksmith Worker",year:"",country:"Switzerland",location:"Vanderbilt University Fine Arts Gallery",creator:"Antonello da Messina",url:"https://iiif-manifest.library.vanderbilt.edu/gallery/1976/1976.036.json",identifier:"https://iiif.library.vanderbilt.edu/iiif/2/gallery%2F1976%2F1976.036.tif",image:"https://iiif.library.vanderbilt.edu/iiif/2/gallery%2F1976%2F1976.036.tif/full/400,/0/default.jpg",thumbnail:"https://iiif.library.vanderbilt.edu/iiif/2/gallery%2F1976%2F1976.036.tif/full/100,100/0/default.jpg"},{id:"http://www.wikidata.org/entity/Q104032628",name:"The Empty Jug",year:"1653",country:"Netherlands",location:"Vanderbilt University Fine Arts Gallery",creator:"Adriaen van Ostade",url:"https://iiif-manifest.library.vanderbilt.edu/gallery/1979/1979.0845P.json",identifier:"https://iiif.library.vanderbilt.edu/iiif/2/gallery%2F1979%2F1979.0845P.tif",image:"https://iiif.library.vanderbilt.edu/iiif/2/gallery%2F1979%2F1979.0845P.tif/full/400,/0/default.jpg",thumbnail:"https://iiif.library.vanderbilt.edu/iiif/2/gallery%2F1979%2F1979.0845P.tif/full/100,100/0/default.jpg"},{id:"http://www.wikidata.org/entity/Q102975484",name:"Trostung (Consolation), from Genius, Zeitschrift f\xFCr werdende und alte Kunst (Magazine for Emerging and Ancient Art), Year 2, no. 1",year:"1920",country:"Austria",location:"Vanderbilt University Fine Arts Gallery",creator:"Georg Ehrlich",url:"https://iiif-manifest.library.vanderbilt.edu/gallery/1976/1976.031.json",identifier:"https://iiif.library.vanderbilt.edu/iiif/2/gallery%2F1976%2F1976.031.med.jpg",image:"https://iiif.library.vanderbilt.edu/iiif/2/gallery%2F1976%2F1976.031.med.jpg/full/400,/0/default.jpg",thumbnail:"https://iiif.library.vanderbilt.edu/iiif/2/gallery%2F1976%2F1976.031.med.jpg/full/100,100/0/default.jpg"}],vs=ure()(pre(yre(t=>({addToArtwork:(e,n)=>t(r=>({artworkList:[{id:e,image:n},...r.artworkList]})),addToCanvas:(e,n,r)=>t(a=>({canvasList:[...a.canvasList,{brightness:0,height:400,id:`${a.canvasList.length+1}`,image:e,isDragging:!1,opacity:1,width:400,x:n,y:r}]})),addToImageList:e=>t(n=>({imageList:[...n.imageList,...e]})),removeFromImageList:e=>t(n=>({imageList:n.imageList.filter(r=>r.id!==e)})),artworkList:bre,canvasList:[],frame:VA[1],imageList:WA.sort(()=>Math.random()-.5),imageLikeList:[],likeImage:e=>t(n=>({imageLikeList:[...n.imageLikeList,e]})),resetState:()=>t(()=>({imageList:WA.sort(()=>Math.random()-.5),canvasList:[],imageLikeList:[]})),removeFromCanvas:e=>t(n=>({canvasList:n.canvasList.filter(r=>r.id!==e)})),setFrame:e=>t(()=>({frame:VA.find(n=>n.id===e)})),transformCanvasImage:e=>t(n=>({canvasList:n.canvasList.map(r=>r.id!==e.id?r:{...r,height:e.height,width:e.width,x:e.x,y:e.y,brightness:e.brightness,opacity:e.opacity})})),moveCanvasImage:(e,n)=>t(r=>{const a=r.canvasList.findIndex(i=>i.id===e);if(a!==-1){const i=n?a-1:a+1;if(i>=0&&i<r.canvasList.length){const o=[...r.canvasList],[s]=o.splice(a,1);return o.splice(i,0,s),{canvasList:o}}}return{}})}),{name:"glamStore"}))),jA=({front:t})=>{const{frame:e}=vs(),[n]=RA(t?e.front:e.image,"anonymous");return fe.jsx($A,{image:n,draggable:!1})},vre=({canvasImage:t,isSelected:e,onSelect:n})=>{const r=P.useRef(),a=P.useRef(),[i]=RA(t.image),o=vs(c=>c.transformCanvasImage);P.useEffect(()=>{var c;e&&(a.current.nodes([r.current]),(c=a.current.getLayer())==null||c.batchDraw())},[e]),P.useEffect(()=>{const c=new window.Image;c.crossOrigin="Anonymous",c.src=t.image,c.onload=()=>{var d;r.current&&(r.current.image(c),(d=r.current.getLayer())==null||d.batchDraw())}},[t.image]);const s=()=>{o({...t,isDragging:!0})},l=c=>{o({...t,isDragging:!1,x:c.target.x(),y:c.target.y()})},u=()=>{var c;const d=r.current,p=d.scaleX(),f=d.scaleY(),g=Math.max(5,d.width()*p),y=Math.max(d.height()*f);o({...t,x:d.x(),y:d.y(),width:g,height:y}),a.current.nodes([r.current]),(c=a.current.getLayer())==null||c.batchDraw()};return fe.jsxs(fe.Fragment,{children:[fe.jsx($A,{draggable:!0,id:t.id,image:i,onClick:n,onDragEnd:l,onDragStart:s,onTap:n,onTransformEnd:u,ref:r,x:t.x,y:t.y,scaleX:.5,scaleY:.5,opacity:t.opacity||1,brightness:t.brightness||0},t.id),e&&fe.jsx(Ane,{ref:a,flipEnabled:!1,enabledAnchors:["top-left","top-right","bottom-left","bottom-right"]})]})},xre=()=>{const{addToCanvas:t,artworkList:e,canvasList:n,frame:r,moveCanvasImage:a,removeFromCanvas:i,setFrame:o,transformCanvasImage:s}=vs(),l=P.useRef(null),[u,c]=P.useState(""),[d,p]=P.useState(1),[f,g]=P.useState(1),y=1080,x=1080;P.useEffect(()=>{const B=()=>{const K=(window.innerWidth*.8||0)/y;l.current&&(l.current.width(y*K),l.current.height(x*K),l.current.scale({x:K,y:K}))};return B(),window.addEventListener("resize",B),()=>{window.removeEventListener("resize",B)}},[]);const b=B=>{B.target===B.target.getStage()&&c("")},v=B=>{u&&a(u,B)},w=B=>{p(B);const K=n.find(X=>X.id===u);K&&s({...K,brightness:B})},S=B=>{g(B);const K=n.find(X=>X.id===u);K&&s({...K,opacity:B})},C=()=>{i(u),c("")},I=()=>{navigator.share?navigator.share({title:"GLAMorous Europe",text:"Check out my GLAMorous Europe artwork!",url:window.location.href}).then(()=>console.log("Share successful")).catch(B=>console.error("Error sharing:",B)):console.log("Web Share API not supported")},_=()=>{var B;const K=(B=l.current)==null?void 0:B.toDataURL();K&&UK.saveAs(K,"GLAMorousEurope.png")},[{canDrop:E,isOver:A},M]=NU(()=>({accept:"artwork",drop:(B,K)=>{const X=K.getClientOffset();if(B&&X){const Q=e.find(H=>H.id===B.id);if(Q){const H=l.current;if(H){const F=X.x-H.container().getBoundingClientRect().left,Y=X.y-H.container().getBoundingClientRect().top;t(Q.image,F,Y)}}}},collect:B=>({isOver:B.isOver(),canDrop:B.canDrop()})})),L=E&&A;let W="transparent";return L?W="#ebb2ff":E&&(W="#2B2829"),fe.jsxs(fe.Fragment,{children:[fe.jsxs("div",{className:"toolbar",children:[fe.jsx(Br,{className:"p-4 text-xl text-black",rounded:!0,inline:!0,onClick:()=>v(!0),children:fe.jsx(ei,{material:fe.jsx(hK,{className:"w-6 h-6"})})}),fe.jsx(Br,{className:"p-4 text-xl text-black",rounded:!0,inline:!0,onClick:()=>v(!1),children:fe.jsx(ei,{material:fe.jsx(cK,{className:"w-6 h-6"})})}),u&&fe.jsxs("div",{children:[fe.jsx("label",{htmlFor:"brightnessSlider",children:"Brightness:"}),fe.jsx("input",{id:"brightnessSlider",type:"range",min:"0",max:"2",step:"0.01",value:d,onChange:B=>w(parseFloat(B.target.value))}),fe.jsx("label",{htmlFor:"opacitySlider",children:"Opacity:"}),fe.jsx("input",{id:"opacitySlider",type:"range",min:"0",max:"1",step:"0.01",value:f,onChange:B=>S(parseFloat(B.target.value))})]}),fe.jsx(Br,{className:"p-4 text-xl text-black",rounded:!0,inline:!0,onClick:C,children:fe.jsx(ei,{material:fe.jsx(jK,{className:"w-6 h-6"})})})]}),fe.jsxs("div",{className:"mx-auto flex items-center gap-2",ref:M,children:[fe.jsx(Br,{className:"p-4 text-xl text-black",rounded:!0,inline:!0,onClick:()=>o(Math.max(1,r.id-1)),children:fe.jsx(ei,{material:fe.jsx(gK,{className:"w-6 h-6"})})}),fe.jsxs(Pne,{style:{border:"4px solid",borderColor:W},width:y,height:x,ref:l,onMouseDown:b,onTouchStart:b,children:[fe.jsxs(OA,{children:[fe.jsx(jA,{front:!1}),n.map(B=>fe.jsx(vre,{canvasImage:B,isSelected:B.id===u,onSelect:()=>{c(B.id)}},B.id))]}),fe.jsx(OA,{listening:!1,children:fe.jsx(jA,{front:!0})})]}),fe.jsx(Br,{className:"p-4 text-xl text-black",rounded:!0,inline:!0,onClick:()=>o(Math.min(5,r.id+1)),children:fe.jsx(ei,{material:fe.jsx(vK,{className:"w-6 h-6"})})})]}),fe.jsxs("div",{className:"flex gap-2 mx-auto",children:[fe.jsx(Br,{className:"p-4 text-xl text-black",rounded:!0,inline:!0,onClick:I,children:fe.jsx(ei,{material:fe.jsx(LK,{className:"w-6 h-6"})})}),fe.jsx(Br,{className:"p-4 text-xl text-black",rounded:!0,inline:!0,onClick:_,children:fe.jsx(ei,{material:fe.jsx(sK,{className:"w-6 h-6"})})})]})]})};function wre({id:t,image:e}){const[{opacity:n},r,a]=yU(()=>({type:"artwork",item:{id:t},collect:i=>({opacity:i.isDragging()?.4:1})}));return fe.jsxs(fe.Fragment,{children:[fe.jsx(Xj,{connect:a,src:e}),fe.jsx("img",{src:e,alt:t,role:"presentation",style:{display:"block",maxHeight:"150px",width:"auto",height:"auto",cursor:"move",borderRadius:"5px",margin:"4px",opacity:n},ref:r})]})}function kre(){const{t}=Qh(),{artworkList:e}=vs();return fe.jsxs(ds,{className:"flex flex-col flex-wrap gap-4 container justify-center content-center text-center mx-auto",children:[fe.jsx("div",{className:"p-2 m-4",children:fe.jsx("h1",{className:"text-2xl",children:t("artworkTitle")})}),fe.jsx(ds,{className:"flex flex-wrap mx-auto",children:e.map((n,r)=>fe.jsx(wre,{...n},n.id+r))}),e.length===0?fe.jsx(Br,{className:"p-4 text-xl text-black w-2/3 mx-auto h-20",rounded:!0,inline:!0,children:fe.jsx(J1,{to:"/selection",children:t("artworkEmpty")})}):fe.jsx(xre,{})]})}const Sre="modulepreload",Cre=function(t){return"/"+t},UA={},Nre=function(t,e,n){let r=Promise.resolve();if(e&&e.length>0){const a=document.getElementsByTagName("link");r=Promise.all(e.map(i=>{if(i=Cre(i),i in UA)return;UA[i]=!0;const o=i.endsWith(".css"),s=o?'[rel="stylesheet"]':"";if(n)for(let u=a.length-1;u>=0;u--){const c=a[u];if(c.href===i&&(!o||c.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${i}"]${s}`))return;const l=document.createElement("link");if(l.rel=o?"stylesheet":Sre,o||(l.as="script",l.crossOrigin=""),l.href=i,document.head.appendChild(l),o)return new Promise((u,c)=>{l.addEventListener("load",u),l.addEventListener("error",()=>c(new Error(`Unable to preload CSS for ${i}`)))})}))}return r.then(()=>t()).catch(a=>{const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=a,window.dispatchEvent(i),!i.defaultPrevented)throw a})};var GA={exports:{}},Tre="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",Ire=Tre,Ere=Ire;function HA(){}function qA(){}qA.resetWarningCache=HA;var _re=function(){function t(r,a,i,o,s,l){if(l!==Ere){var u=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw u.name="Invariant Violation",u}}t.isRequired=t;function e(){return t}var n={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:qA,resetWarningCache:HA};return n.PropTypes=n,n};GA.exports=_re();var Ore=GA.exports;const zr=Hi(Ore);/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var R3=function(t,e){return R3=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(n[a]=r[a])},R3(t,e)};function KA(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");R3(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var ao=function(){return ao=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])}return t},ao.apply(this,arguments)};function XA(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(t);a<r.length;a++)e.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(t,r[a])&&(n[r[a]]=t[r[a]]);return n}function Vu(t,e){for(var n=0,r=e.length,a=t.length;n<r;n++,a++)t[a]=e[n];return t}var $re=function(t){return Object.keys(t).filter(function(e){return t[e]}).join(" ")},gb=function(t,e){return t.x===e.x&&t.y===e.y},yb=function(t,e){return!t&&e||t&&!e||t.length!==e.length?!1:t.every(function(n,r){return gb(n,e[r])})},Wu=function(t,e){var n=t.x,r=t.y;return e===void 0&&(e=1),{x:Math.round((n+Number.EPSILON)*e)/e,y:Math.round((r+Number.EPSILON)*e)/e}},Rre=function(t,e,n){n===void 0&&(n=0);var r=t.findIndex(function(a){return Math.max(Math.abs(a.x-e.x),Math.abs(a.y-e.y))<=n});return{point:ao({},t[r]||{x:NaN,y:NaN}),index:r}},YA=function(t,e){return Math.hypot(e.x-t.x,e.y-t.y)},QA=function(t,e){return Math.atan2(e.y-t.y,e.x-t.x)},Mre=function(t,e,n){var r=YA(t,e),a=QA(t,e),i=Math.round(a/n)*n;return{x:t.x+r*Math.cos(i),y:t.y+r*Math.sin(i)}},Are=function(t,e,n){var r=YA(t,e),a=QA(t,e),i=n.reduce(function(o,s){return Math.abs(s-a)<Math.abs(o-a)?s:o},1/0);return i!==1/0&&(e.x=t.x+r*Math.cos(i),e.y=t.y+r*Math.sin(i)),e},Pre=function(t){for(var e=[],n=1;n<t.length;n++){var r=Math.atan2(t[n].y-t[n-1].y,t[n].x-t[n-1].x),a=r+Math.PI;e.push(r,a>Math.PI?a-2*Math.PI:a)}return e.filter(function(i,o,s){return s.indexOf(i)===o})};function Dre(t,e,n,r){r===void 0&&(r=!0);var a=new Image;a.crossOrigin="Anonymous";var i=document.createElement("canvas"),o=i.getContext("2d");if(!o)return n(new Error("CTX is null"),i);a.onerror=function(){n(new Error("Failed to load image"),i)},a.onload=function(){try{if(i.width=a.naturalWidth+2,i.height=a.naturalHeight+2,o.drawImage(a,0,0),e.length<3){n(null,i);return}if(o.beginPath(),o.moveTo(0,0),o.lineTo(i.width,0),o.lineTo(i.width,i.height),o.lineTo(0,i.height),o.lineTo(0,0),o.lineTo(e[0].x+1,e[0].y+1),e.slice(1).forEach(function(w){var S=w.x,C=w.y;return o.lineTo(S+1,C+1)}),o.lineTo(e[0].x+1,e[0].y+1),o.lineTo(0,0),o.closePath(),o.clip("evenodd"),o.globalCompositeOperation="destination-out",o.fill(),r){var s=e.map(function(w){var S=w.x;return S+1}),l=e.map(function(w){var S=w.y;return S+1}),u=[Math.min.apply(null,s),Math.min.apply(null,l)],c=u[0],d=u[1],p=[Math.max.apply(null,s),Math.max.apply(null,l)],f=p[0],g=p[1],y=[f-c,g-d],x=y[0],b=y[1],v=o.getImageData(c,d,x,b);i.width=x,i.height=b,o.putImageData(v,0,0)}n(null,i)}catch(w){n(w instanceof Error?w:new Error(String(w)),i)}},a.src=t}var ZA=function(){function t(e){this.getSvgElement=e}return t.prototype.getSvg=function(){var e=this.getSvgElement();if(!e)throw new Error("SVG is null");return e},t.prototype.getCTM=function(){var e=this.getSvg(),n=e.getCTM();if(n===null){var r=e.querySelector('rect[visibility="hidden"]');n=r.getCTM()}if(!n)throw new Error("CTM is null");return n},t.prototype.getViewboxSize=function(){return this.getSvg().viewBox.baseVal},t.prototype.getRealSize=function(){var e=this.getSvg();return{width:e.clientWidth,height:e.clientHeight}},t.prototype.getViewboxOffset=function(){var e=this.getSvg(),n=this.getRealSize(),r=n.width,a=n.height,i=this.getViewboxSize(),o=i.width,s=i.height,l=Object.assign(e.createSVGPoint(),{x:r,y:a}),u=this.getCTM(),c=l.matrixTransform(u.inverse()),d=c.x,p=c.y;return{x:d-o,y:p-s}},t.prototype.convertViewboxPointsToReal=function(e){var n=this.getSvg(),r=this.getCTM();return e.map(function(a){var i=a.x,o=a.y,s=Object.assign(n.createSVGPoint(),{x:i,y:o}).matrixTransform(r);return Wu(s)})},t.prototype.convertRealPointsToViewbox=function(e){var n=this.getSvg(),r=this.getCTM().inverse();return e.map(function(a){var i=a.x,o=a.y,s=Object.assign(n.createSVGPoint(),{x:i,y:o}).matrixTransform(r);return Wu(s,1e3)})},t.prototype.getBorderPoints=function(e){e===void 0&&(e=!0);var n=this.getViewboxSize(),r=n.width,a=n.height,i=this.getViewboxOffset(),o=i.x,s=i.y,l=[{x:-o,y:-s},{x:r+o,y:-s},{x:r+o,y:a+s},{x:-o,y:a+s}];return e&&l.push({x:-o,y:-s}),l},t.prototype.isAboveTheBorder=function(e){var n=e.x,r=e.y,a=this.getViewboxSize(),i=a.width,o=a.height,s=this.getViewboxOffset(),l=s.x,u=s.y;return n<-l||n>i+l||r<-u||r>o+u},t.prototype.getMouseCoordinates=function(e){var n=e,r=n.changedTouches&&n.touches?n.changedTouches[0]||n.touches[0]:n,a=r.clientX,i=r.clientY,o=this.getSvg(),s=o.getScreenCTM();if(!s)throw new Error("ScreenCTM is null");var l=o.createSVGPoint();l.x=a,l.y=i;var u=l.matrixTransform(s.inverse()),c=u.x,d=u.y;return{x:c,y:d}},t}(),JA=function(t){return function(e){KA(n,e);function n(){var r=e!==null&&e.apply(this,arguments)||this;return r.ref=G.createRef(),r.svg=new ZA(function(){var a,i;return(i=(a=r.ref)===null||a===void 0?void 0:a.current)===null||i===void 0?void 0:i.ownerSVGElement}),r.dragLastPosition=null,r.wasMoved=!1,r.onMouseTouchDown=function(a){if(a.target===r.ref.current&&r.props.draggable){a.stopImmediatePropagation(),a.preventDefault();var i=a.target;r.dragLastPosition=r.getMousePosition(a),i.ownerSVGElement&&i.ownerSVGElement.focus({preventScroll:!0})}},r.onMouseTouchMove=function(a){if(r.dragLastPosition){a.stopImmediatePropagation(),a.preventDefault();var i=r.getMousePosition(a),o=i.x,s=i.y,l=o-r.dragLastPosition.x,u=s-r.dragLastPosition.y;!r.wasMoved&&r.props.onDragStart&&r.props.onDragStart({x:r.dragLastPosition.x,y:r.dragLastPosition.y,dx:l,dy:u}),r.props.onDrag&&r.props.onDrag({dx:l,dy:u}),r.dragLastPosition={x:o,y:s},r.wasMoved=!0}},r.onMouseTouchUp=function(a){r.dragLastPosition&&r.wasMoved&&(a.stopImmediatePropagation(),a.preventDefault(),(a instanceof MouseEvent||!a.touches)&&window.addEventListener("click",function(i){return i.stopPropagation()},{capture:!0,once:!0}),r.props.onDragEnd&&r.props.onDragEnd({x:r.dragLastPosition.x,y:r.dragLastPosition.y})),r.dragLastPosition=null,r.wasMoved=!1},r}return n.prototype.render=function(){var r=this.props,a=r.draggable;r.onDrag,r.onDragStart,r.onDragEnd;var i=XA(r,["draggable","onDrag","onDragStart","onDragEnd"]);return G.createElement(t,ao({ref:this.ref},i,{draggable:a}))},n.prototype.componentDidUpdate=function(r){r.draggable&&!this.props.draggable&&this.dragLastPosition&&this.wasMoved&&(this.props.onDragEnd&&this.props.onDragEnd({x:this.dragLastPosition.x,y:this.dragLastPosition.y}),this.dragLastPosition=null,this.wasMoved=!1)},n.prototype.componentDidMount=function(){window.addEventListener("mousedown",this.onMouseTouchDown,!0),window.addEventListener("mousemove",this.onMouseTouchMove,!0),window.addEventListener("mouseup",this.onMouseTouchUp,!0),window.addEventListener("touchstart",this.onMouseTouchDown,!0),window.addEventListener("touchmove",this.onMouseTouchMove,!0),window.addEventListener("touchend",this.onMouseTouchUp,!0)},n.prototype.componentWillUnmount=function(){window.removeEventListener("mousedown",this.onMouseTouchDown),window.removeEventListener("mousemove",this.onMouseTouchMove),window.removeEventListener("mouseup",this.onMouseTouchUp),window.removeEventListener("touchstart",this.onMouseTouchDown),window.removeEventListener("touchmove",this.onMouseTouchMove),window.removeEventListener("touchend",this.onMouseTouchUp)},n.prototype.getMousePosition=function(r){var a=r;return this.svg.getMouseCoordinates(a)},n}(G.Component)},Lre=JA(G.forwardRef(function(t,e){var n=t.path,r=t.animate,a=t.draggable;return G.createElement("polyline",{ref:e,style:{cursor:a?"move":""},points:n.map(function(i){var o=i.x,s=i.y;return o+","+s}).join(" "),fill:"rgba(0,0,0,0)",stroke:"white",strokeWidth:"1.5",shapeRendering:"geometricPrecision",strokeDasharray:"3",strokeDashoffset:"0",vectorEffect:"non-scaling-stroke"},r&&G.createElement("animate",{attributeName:"stroke-dashoffset",values:"0;1000;0",dur:"100s",repeatCount:"indefinite"}))}));function Fre(t){var e=t.path;return G.createElement("polygon",{style:{pointerEvents:"none",transform:"translate(-1px, -1px)"},points:e.map(function(n){var r=n.x,a=n.y;return r+","+a}).join(" "),fill:"rgba(0, 0, 0, 0.5)",fillRule:"evenodd",stroke:"null",shapeRendering:"geometricPrecision"})}var Bre=JA(G.forwardRef(function(t,e){var n=t.x,r=t.y,a=t.onClickTouchEvent,i=t.draggable,o=t.style,s=o.cursor,l=s===void 0?i?"move":"default":s,u=XA(o,["cursor"]);return G.createElement("rect",{style:ao({cursor:l},u),ref:e,x:n-10,y:r-10,onClick:function(c){c.stopPropagation(),c.preventDefault(),a(c)},onTouchEnd:function(c){c.stopPropagation(),c.preventDefault(),a(c)},width:"20px",height:"20",fill:"rgba(0, 0, 0, 0)",stroke:"white",strokeWidth:"1.25",vectorEffect:"non-scaling-stroke"})})),dr;(function(t){t.ADD="ADD",t.DELETE="DELETE",t.MODIFY="MODIFY",t.MOVE="MOVE",t.RESET="RESET",t.CHANGE="CHANGE"})(dr||(dr={}));function zre(t,e){var n=t.points.length;switch(e.type){case dr.ADD:{if(t.closed)return[t,!1];if(n>0&&gb(t.points[n-1],e.payload)||n>1&&gb(t.points[n-2],e.payload))return[t,!1];var r=n>2&&gb(t.points[0],e.payload);return r?[{points:Vu([],t.points),closed:!0},!0]:[{points:Vu(Vu([],t.points,!0),[e.payload]),closed:!1},!0]}case dr.DELETE:return[{points:Vu([],t.points.filter(function(u,c){return e.payload!==c})),closed:n>4&&t.closed},!0];case dr.MODIFY:{var a=t.points[e.payload.index],i=a.x,o=a.y,s=t.points.map(function(u){var c=u.x,d=u.y;return c===i&&d===o?{x:e.payload.x,y:e.payload.y}:{x:c,y:d}});return[{points:s,closed:t.closed},!!(e.payload.x||e.payload.y)]}case dr.MOVE:return[{points:t.points.map(function(u){var c=u.x,d=u.y;return{x:c+e.payload.x,y:d+e.payload.y}}),closed:t.closed},!!(e.payload.x||e.payload.y)];case dr.CHANGE:{var l=!yb(e.payload,t.points);return[{points:e.payload,closed:l?e.payload.length>2:t.closed},l]}case dr.RESET:return[{points:[],closed:!1},!!t.points.length];default:return[t,!1]}}var Vre=function(t){KA(e,t);function e(n){var r=t.call(this,n)||this;return r.imageRef=G.createRef(),r.svgRef=G.createRef(),r.svg=new ZA(function(){var a;return(a=r.svgRef)===null||a===void 0?void 0:a.current}),r.angles=[],r.path={points:[],closed:!1},r.lastEmittedPoints=[],r.lastUpdatedPoints=[],r.imgError=!1,r.setPathFromPropsOnMediaLoad=!0,r.hidePointer=function(){var a=r.path.points[r.path.points.length-1]||{x:0,y:0};r.setPointer(ao({},a),!0)},r.onShapeDrag=function(a){var i=a.dx,o=a.dy,s=r.path.points.map(function(l){var u=l.x,c=l.y;return{x:u+i,y:c+o}});s.some(function(l){return r.svg.isAboveTheBorder(l)})||r.dispatchPathAction({type:dr.MOVE,payload:{x:i,y:o}})},r.onPointDrag=function(a,i){var o=i.dx,s=i.dy,l=ao({},r.path.points[a]);l.x+=o,l.y+=s,r.svg.isAboveTheBorder(l)||r.dispatchPathAction({type:dr.MODIFY,payload:ao(ao({},l),{index:a})})},r.onPointClick=function(a){r.isLoaded()&&!r.props.disabled&&!r.path.closed&&r.dispatchPathAction({type:dr.ADD,payload:r.path.points[a]})},r.onDragEnd=function(){r.checkIfPathUpdated(!1)},r.onMediaLoaded=function(a){r.setPathFromPropsOnMediaLoad&&(r.setPathStateFromProps(),r.setPathFromPropsOnMediaLoad=!1),r.imgError=!1,r.props.onImageLoad(a)},r.onMediaError=function(a){r.dispatchPathAction({type:dr.RESET}),r.imgError=!0,r.props.onImageError(a)},r.onClickTouchEvent=function(a){if(r.isLoaded()&&!r.props.disabled){if(r.path.closed){a.target===r.svgRef.current&&r.dispatchPathAction({type:dr.RESET});return}var i=r.getMousePosition(a)[0];r.svg.isAboveTheBorder(i)?r.hidePointer():r.dispatchPathAction({type:dr.ADD,payload:Wu(i,1e3),pointer:i})}},r.onClick=function(a){r.onClickTouchEvent(a)},r.onTouchEnd=function(a){a.cancelable&&(a.preventDefault(),r.onClickTouchEvent(a)),r.hidePointer()},r.onMouseTouchMove=function(a){if(r.isLoaded()){var i=r.getMousePosition(a)[0];r.setPointer(i)}},r.onContextMenu=function(a){if(r.isLoaded()&&(a.preventDefault(),!r.props.disabled&&!r.path.closed)){var i=r.getMousePosition(a),o=i[0],s=i[1].index;s>-1?r.dispatchPathAction({type:dr.DELETE,payload:s,pointer:o}):r.setPointer(o)}},r.state={path:{points:[],closed:!1},pointer:{x:n.viewBox.width/2,y:n.viewBox.width/2}},r}return e.prototype.render=function(){var n=this;return G.createElement("div",{className:$re({ReactFreeSelect__Component:!0,ReactFreeSelect__Closed:this.state.path.closed,ReactFreeSelect__Disabled:this.props.disabled}),style:ao({display:"inline-block",position:"relative",margin:"0",padding:"0",fontSize:"0",cursor:this.props.disabled?"not-allowed":"default"},this.props.style)},G.createElement("img",{ref:this.imageRef,src:this.props.src,alt:this.props.imageAlt,crossOrigin:this.props.crossOrigin,style:this.props.imageStyle,onLoad:this.onMediaLoaded,onError:this.onMediaError}),G.createElement("svg",{ref:this.svgRef,style:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%",overflow:"hidden",userSelect:"none",touchAction:"none"},viewBox:"0 0 "+this.props.viewBox.width+" "+this.props.viewBox.height,onMouseMove:this.onMouseTouchMove,onTouchMove:this.onMouseTouchMove,onClick:this.onClick,onTouchEnd:this.onTouchEnd,onContextMenu:this.onContextMenu,onMouseLeave:this.hidePointer},G.createElement("rect",{visibility:"hidden"}),!!this.state.path.points.length&&G.createElement(Fre,{path:this.getPolygonPoints()}),G.createElement(Lre,{draggable:this.state.path.closed&&!this.props.disabled,onDrag:this.onShapeDrag,onDragEnd:this.onDragEnd,animate:!this.props.disabled,path:this.getPolylinePoints()}),this.getRoundedPoints().map(function(r,a){var i=r.x,o=r.y;return G.createElement(Bre,{key:a,x:i,y:o,draggable:!n.props.disabled,style:{cursor:!a&&n.state.path.points.length>2&&!n.state.path.closed?"pointer":void 0},onDrag:function(s){var l=s.dx,u=s.dy;return n.onPointDrag(a,{dx:l,dy:u})},onDragEnd:n.onDragEnd,onClickTouchEvent:function(){return n.onPointClick(a)}})})))},e.prototype.componentDidUpdate=function(n){!n.disabled&&this.props.disabled&&!this.path.closed&&this.hidePointer(),n.src&&n.src!==this.props.src?this.dispatchPathAction({type:dr.RESET}):yb(n.value,this.props.value)||(this.isLoaded()?this.setPathStateFromProps():this.setPathFromPropsOnMediaLoad=!0)},e.prototype.convertPoints=function(n){var r=this.getAspectRatio();return this.svg.convertViewboxPointsToReal(n).map(function(a){var i=a.x,o=a.y;return{x:Math.round(i/r.x),y:Math.round(o/r.y)}})},e.prototype.checkIfPathUpdated=function(n){if(this.path.closed||n){var r=this.convertPoints(this.path.points);yb(r,this.lastUpdatedPoints)||(this.emitOnComplete(r),this.lastUpdatedPoints=r.map(function(a){var i=a.x,o=a.y;return{x:i,y:o}}))}},e.prototype.emitOnChange=function(n){var r=n.points;if(this.props.onChange){var a=this.convertPoints(r);this.lastEmittedPoints=a,this.props.onChange(a)}},e.prototype.emitOnComplete=function(n){this.props.onComplete&&this.props.onComplete(n)},e.prototype.setPointer=function(n,r){var a=n.x,i=n.y;r===void 0&&(r=!1),(r||!this.props.disabled)&&this.setState({path:this.path,pointer:{x:a,y:i}})},e.prototype.dispatchPathAction=function(n){var r=this.path.closed,a=zre(this.path,n),i=a[0],o=a[1];i.points=i.points.map(function(s){return Wu(s,1e3)}),o&&(this.path=i,this.setState({pointer:n.pointer||this.path.points[this.path.points.length-1]||{x:0,y:0},path:i}),this.angles=Pre(i.points),this.emitOnChange(i),[dr.MODIFY,dr.MOVE].includes(n.type)||this.checkIfPathUpdated(r))},e.prototype.isLoaded=function(){if(this.imgError||!this.svgRef.current)return!1;var n=this.svgRef.current;return!!(n.width.baseVal.value&&n.height.baseVal.value)},e.prototype.getAspectRatio=function(){return this.imageRef.current?{x:this.imageRef.current.clientWidth/this.imageRef.current.naturalWidth,y:this.imageRef.current.clientHeight/this.imageRef.current.naturalHeight}:{x:NaN,y:NaN}},e.prototype.setPathStateFromProps=function(){if(!yb(this.lastEmittedPoints,this.props.value)){var n=this.getAspectRatio(),r=this.svg.convertRealPointsToViewbox(this.props.value.map(function(a){var i=a.x,o=a.y;return{x:i*n.x,y:o*n.y}}));this.dispatchPathAction({type:dr.CHANGE,payload:r})}},e.prototype.getRoundedPoints=function(){return this.state.path.points.map(function(n){return Wu(n)})},e.prototype.getBorder=function(){return this.svg.getBorderPoints().map(function(n){return Wu(n)}).map(function(n){var r=n.x,a=n.y;return{x:r-1,y:a+1}})},e.prototype.getPolygonPoints=function(){var n=this.getRoundedPoints(),r=this.getBorder();return this.state.path.closed?Vu(Vu(Vu([],r,!0),n,!0),[n[0],r[0]]):r},e.prototype.getPolylinePoints=function(){var n=this.getRoundedPoints();return n.concat(this.state.path.closed?n[0]:Wu(this.state.pointer))},e.prototype.getMousePosition=function(n,r,a){r===void 0&&(r=!0),a===void 0&&(a=!0);var i=this.svg.getMouseCoordinates(n);if(a){var o=navigator.platform.includes("Mac")?n.metaKey:n.ctrlKey,s=this.path.points[this.path.points.length-1];o&&s&&(n.shiftKey?i=Are(s,i,this.angles):i=Mre(s,i,Math.PI/12))}var l=Rre(this.path.points,i,10),u=l.point,c=l.index;return r&&c>-1&&(i=ao({},u)),[i,{point:u,index:c}]},e.propTypes={value:zr.arrayOf(zr.exact({x:zr.number.isRequired,y:zr.number.isRequired})),style:zr.shape({}),viewBox:zr.exact({width:zr.number.isRequired,height:zr.number.isRequired}),disabled:zr.bool,onChange:zr.func,onComplete:zr.func,src:zr.string.isRequired,imageAlt:zr.string,crossOrigin:zr.string,imageStyle:zr.shape({}),onImageLoad:zr.func,onImageError:zr.func},e.defaultProps={value:[],style:{},imageStyle:{},viewBox:{width:1e3,height:1e3},disabled:!1,onImageError:Function.prototype,onImageLoad:Function.prototype},e}(G.Component);/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Wre=1e-7,jre=1e-4;class M3{constructor(e,n){this.backend=e,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,n){this.dataIdsCount++,this.data.set(e,n)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}}class bb{refCount(e){return ni("refCount")}incRef(e){return ni("incRef")}timerAvailable(){return!0}time(e){return ni("time")}read(e){return ni("read")}readSync(e){return ni("readSync")}readToGPU(e,n){return ni("readToGPU")}numDataIds(){return ni("numDataIds")}disposeData(e,n){return ni("disposeData")}write(e,n,r){return ni("write")}move(e,n,r,a,i){return ni("move")}memory(){return ni("memory")}floatPrecision(){return ni("floatPrecision")}epsilon(){return this.floatPrecision()===32?Wre:jre}dispose(){return ni("dispose")}}function ni(t){throw new Error(`'${t}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function eP(t){let e=t.length,n=0;for(;e>0;)n=Math.random()*e|0,e--,xs(t,e,n)}function Ure(t,e){if(t.length!==e.length)throw new Error(`Array sizes must match to be shuffled together First array length was ${t.length}Second array length was ${e.length}`);let n=t.length,r=0;for(;n>0;)r=Math.random()*n|0,n--,xs(t,n,r),xs(e,n,r)}function _l(t,e,n){return Math.max(t,Math.min(e,n))}function vb(t){return t%2===0?t:t+1}function xs(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function tP(t){let e=0;for(let n=0;n<t.length;n++)e+=t[n];return e}function Gre(t,e){const n=Math.random();return e*n+(1-n)*t}function Hre(t,e){let n=0;for(let r=0;r<t.length;r++){const a=Number(t[r])-Number(e[r]);n+=a*a}return n}function V(t,e){if(!t)throw new Error(typeof e=="string"?e:e())}function Sr(t,e,n=""){V(tn(t,e),()=>n+` Shapes ${t} and ${e} must match`)}function ju(t){V(t!=null,()=>"The input to the tensor constructor must be a non-null value.")}function ws(t,e=[],n=!1){if(e==null&&(e=[]),Array.isArray(t)||Vr(t)&&!n)for(let r=0;r<t.length;++r)ws(t[r],e,n);else e.push(t);return e}function me(t){if(t.length===0)return 1;let e=t[0];for(let n=1;n<t.length;n++)e*=t[n];return e}function qre(t){return t.length===0}function tn(t,e){if(t===e)return!0;if(t==null||e==null||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function Uu(t){return t%1===0}function Kre(t){if(Math.tanh!=null)return Math.tanh(t);if(t===1/0)return 1;if(t===-1/0)return-1;{const e=Math.exp(2*t);return(e-1)/(e+1)}}function xb(t){const e=Math.ceil(Math.sqrt(t));return[e,Math.ceil(t/e)]}function Xre(t){const e=new Uint32Array(t);for(let n=0;n<t;++n)e[n]=n;return eP(e),e}function Gu(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)}function A3(t,e=a=>0,n,r=setTimeout){return new Promise((a,i)=>{let o=0;const s=()=>{if(t()){a();return}o++;const l=e(o);if(n!=null&&o>=n){i();return}r(s,l)};s()})}function P3(t,e){let n=1,r=-1;for(let i=0;i<t.length;++i)if(t[i]>=0)n*=t[i];else if(t[i]===-1){if(r!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${r} and dim ${i}`);r=i}else if(t[i]<0)throw Error(`Shapes can not be < 0. Found ${t[i]} at dim ${i}`);if(r===-1){if(e>0&&e!==n)throw Error(`Size(${e}) must match the product of shape ${t}`);return t}if(n===0)throw Error(`Cannot infer the missing size in [${t}] when there are 0 elements`);if(e%n!==0)throw Error(`The implicit shape can't be a fractional number. Got ${e} / ${n}`);const a=t.slice();return a[r]=e/n,a}function Pt(t,e){const n=e.length;return t=t==null?e.map((r,a)=>a):[].concat(t),V(t.every(r=>r>=-n&&r<n),()=>`All values in axis param must be in range [-${n}, ${n}) but got axis ${t}`),V(t.every(r=>Uu(r)),()=>`All values in axis param must be integers but got axis ${t}`),t.map(r=>r<0?n+r:r)}function ks(t,e){const n=[],r=[],a=e!=null&&Array.isArray(e)&&e.length===0,i=e==null||a?null:Pt(e,t).sort();let o=0;for(let s=0;s<t.length;++s){if(i!=null){if(i[o]===s&&t[s]!==1)throw new Error(`Can't squeeze axis ${s} since its dim '${t[s]}' is not 1`);(i[o]==null||i[o]>s)&&t[s]===1&&(n.push(t[s]),r.push(s)),i[o]<=s&&o++}t[s]!==1&&(n.push(t[s]),r.push(s))}return{newShape:n,keptDims:r}}function tr(t,e){let n=null;if(t==null||t==="float32")n=new Float32Array(e);else if(t==="int32")n=new Int32Array(e);else if(t==="bool")n=new Uint8Array(e);else throw new Error(`Unknown data type ${t}`);return n}function nr(t,e){let n=null;if(t==null||t==="float32")n=new Float32Array(e);else if(t==="int32")n=new Int32Array(e);else if(t==="bool")n=new Uint8Array(e);else if(t==="string")n=new Array(e);else throw new Error(`Unknown data type ${t}`);return n}function nP(t,e){for(let n=0;n<t.length;n++){const r=t[n];if(isNaN(r)||!isFinite(r))throw Error(`A tensor of type ${e} being uploaded contains ${r}.`)}}function rP(t){return t==="bool"||t==="complex64"||t==="float32"||t==="int32"||t==="string"}function D3(t,e){return!(e==="complex64"||e==="float32"&&t!=="complex64"||e==="int32"&&t!=="float32"&&t!=="complex64"||e==="bool"&&t==="bool")}function Vr(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray}function wb(t){if(t==="float32"||t==="int32")return 4;if(t==="complex64")return 8;if(t==="bool")return 1;throw new Error(`Unknown dtype ${t}`)}function aP(t){if(t==null)return 0;let e=0;return t.forEach(n=>e+=n.length),e}function Oo(t){return typeof t=="string"||t instanceof String}function iP(t){return typeof t=="boolean"}function oP(t){return typeof t=="number"}function Ld(t){return Array.isArray(t)?Ld(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray?"int32":oP(t)?"float32":Oo(t)?"string":iP(t)?"bool":"float32"}function Ol(t){return!!(t&&t.constructor&&t.call&&t.apply)}function kb(t,e){for(let n=e;n<t;++n)if(t%n===0)return n;return t}function qe(t){const e=t.length;if(e<2)return[];const n=new Array(e-1);n[e-2]=t[e-1];for(let r=e-3;r>=0;--r)n[r]=n[r+1]*t[r+1];return n}function sP(t,e,n,r=!1){const a=new Array;if(e.length===1){const i=e[0]*(r?2:1);for(let o=0;o<i;o++)a[o]=n[t+o]}else{const i=e[0],o=e.slice(1),s=o.reduce((l,u)=>l*u)*(r?2:1);for(let l=0;l<i;l++)a[l]=sP(t+l*s,o,n,r)}return a}function ri(t,e,n=!1){if(t.length===0)return e[0];const r=t.reduce((a,i)=>a*i)*(n?2:1);if(r===0)return[];if(r!==e.length)throw new Error(`[${t}] does not match the input size ${e.length}${n?" for a complex tensor":""}.`);return sP(0,t,e,n)}function Sb(t,e){const n=Cr(t,e);for(let r=0;r<n.length;r++)n[r]=1;return n}function Cr(t,e){if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool")return new Uint8Array(t);throw new Error(`Unknown data type ${e}`)}function L3(t,e){const n=t.reduce((r,a)=>r*a,1);if(e==null||e==="float32")return ri(t,new Float32Array(n));if(e==="int32")return ri(t,new Int32Array(n));if(e==="bool")return ri(t,new Uint8Array(n));throw new Error(`Unknown data type ${e}`)}function F3(t){t.forEach(e=>{V(Number.isInteger(e)&&e>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${t}].`)})}function io(t,e,n){if(e===0)return 0;if(e===1)return t[0];let r=t[t.length-1];for(let a=0;a<t.length-1;++a)r+=n[a]*t[a];return r}function Hu(t,e,n){if(e===0)return[];if(e===1)return[t];const r=new Array(e);for(let a=0;a<r.length-1;++a)r[a]=Math.floor(t/n[a]),t-=r[a]*n[a];return r[r.length-1]=t,r}function qu(t){return t&&t.then&&typeof t.then=="function"}/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const lP="tfjsflags";class uP{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=Yre,this.populateURLFlags()}setPlatform(e,n){this.platform!=null&&(ue().getBool("IS_TEST")||ue().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${e}.`)),this.platformName=e,this.platform=n}registerFlag(e,n,r){if(this.flagRegistry[e]={evaluationFn:n,setHook:r},this.urlFlags[e]!=null){const a=this.urlFlags[e];ue().getBool("IS_TEST")||ue().getBool("PROD")||console.warn(`Setting feature override from URL ${e}: ${a}.`),this.set(e,a)}}async getAsync(e){return e in this.flags?this.flags[e]:(this.flags[e]=await this.evaluateFlag(e),this.flags[e])}get(e){if(e in this.flags)return this.flags[e];const n=this.evaluateFlag(e);if(qu(n))throw new Error(`Flag ${e} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[e]=n,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,n){if(this.flagRegistry[e]==null)throw new Error(`Cannot set flag ${e} as it has not been registered.`);this.flags[e]=n,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(n)}evaluateFlag(e){if(this.flagRegistry[e]==null)throw new Error(`Cannot evaluate flag '${e}': no evaluation function found.`);return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;const e=this.getQueryParams(this.global.location.search);lP in e&&e[lP].split(",").forEach(n=>{const[r,a]=n.split(":");this.urlFlags[r]=Zre(r,a)})}}function Yre(t){const e={};return t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(n,...r)=>(Qre(e,r[0],r[1]),r.join("="))),e}function Qre(t,e,n){t[decodeURIComponent(e)]=decodeURIComponent(n||"")}function Zre(t,e){if(e=e.toLowerCase(),e==="true"||e==="false")return e==="true";if(`${+e}`===e)return+e;throw new Error(`Could not parse value flag value ${e} for flag ${t}.`)}function ue(){return B3}let B3=null;function Jre(t){B3=t}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/let z3;function cP(){if(z3==null){let t;if(typeof window<"u")t=window;else if(typeof global<"u")t=global;else if(typeof process<"u")t=process;else if(typeof self<"u")t=self;else throw new Error("Could not find a global object");z3=t}return z3}function eae(){const t=cP();return t._tfGlobals==null&&(t._tfGlobals=new Map),t._tfGlobals}function V3(t,e){const n=eae();if(n.has(t))return n.get(t);{const r=e();return n.set(t,r),n.get(t)}}const Cb="Abs",bf="Acos",vf="Acosh",Fd="Add",Nb="AddN",Tb="All",Ib="Any",Eb="ArgMax",_b="ArgMin",xf="Asin",wf="Asinh",kf="Atan",Sf="Atanh",Cf="Atan2",Ob="AvgPool",W3="AvgPoolGrad",$b="AvgPool3D",j3="AvgPool3DGrad",Rb="BatchMatMul",Mb="BatchToSpaceND",Ab="Bincount",tae="BroadcastTo",Pb="BroadcastArgs",Nf="Cast",Tf="Ceil",If="ClipByValue",Db="Complex",Lb="ComplexAbs",Fb="Concat",Bb="Conv2D",zb="Conv2DBackpropFilter",Vb="Conv2DBackpropInput",Wb="Conv3D",U3="Conv3DBackpropFilterV2",jb="Conv3DBackpropInputV2",Ef="Cos",_f="Cosh",Ub="Cumprod",Gb="Cumsum",Hb="CropAndResize",qb="DenseBincount",Kb="DepthToSpace",Xb="DepthwiseConv2dNative",Yb="DepthwiseConv2dNativeBackpropFilter",Qb="DepthwiseConv2dNativeBackpropInput",Zb="Diag",Jb="Dilation2D",G3="Dilation2DBackpropInput",H3="Dilation2DBackpropFilter",Of="RealDiv",ev="Einsum",$f="Elu",q3="EluGrad",Rf="Erf",Mf="Equal",Af="Exp",tv="ExpandDims",Pf="Expm1",nv="FFT",rv="Fill",av="FlipLeftRight",Df="Floor",Lf="FloorDiv",iv="FusedBatchNorm",ov="GatherV2",sv="GatherNd",Ff="Greater",Bf="GreaterEqual",zf="Identity",lv="IFFT",uv="Imag",Vf="IsFinite",Wf="IsInf",jf="IsNan",cv="LeakyRelu",Uf="Less",Gf="LessEqual",dv="LinSpace",Hf="Log",qf="Log1p",Kf="LogicalAnd",Xf="LogicalNot",Yf="LogicalOr",nae="LogicalXor",rae="LogSoftmax",aae="LowerBound",pv="LRN",K3="LRNGrad",hv="Max",Qf="Maximum",fv="MaxPool",X3="MaxPoolGrad",mv="MaxPool3D",Y3="MaxPool3DGrad",gv="MaxPoolWithArgmax",yv="Mean",bv="Min",Zf="Minimum",vv="MirrorPad",Jf="Mod",xv="Multinomial",em="Multiply",wv="Neg",tm="NotEqual",kv="NonMaxSuppressionV3",Sv="NonMaxSuppressionV4",Cv="NonMaxSuppressionV5",Nv="OnesLike",Tv="OneHot",Iv="Pack",Ev="PadV2",iae="Pool",nm="Pow",_v="Prelu",Ov="Prod",$v="RaggedGather",Rv="RaggedTensorToTensor",Mv="Range",Av="Real",rm="Reciprocal",am="Relu",Pv="Reshape",Dv="ResizeNearestNeighbor",Q3="ResizeNearestNeighborGrad",Lv="ResizeBilinear",Z3="ResizeBilinearGrad",im="Relu6",Fv="Reverse",om="Round",sm="Rsqrt",Bv="ScatterNd",zv="SearchSorted",Vv="Select",lm="Selu",Wv="Slice",um="Sin",cm="Sinh",dm="Sign",pm="Sigmoid",hm="Softplus",fm="Sqrt",jv="Sum",Uv="SpaceToBatchND",Gv="SplitV",Hv="Softmax",qv="SparseFillEmptyRows",Kv="SparseReshape",Xv="SparseSegmentMean",Yv="SparseSegmentSum",Qv="SparseToDense",mm="SquaredDifference",J3="Square",Zv="StridedSlice",Jv="StringNGrams",ex="StringSplit",tx="StringToHashBucketFast",gm="Sub",ym="Tan",bm="Tanh",vm="Tile",nx="TopK",rx="Transform",Bd="Transpose",ax="Unique",ix="Unpack",ox="UnsortedSegmentSum",oae="UpperBound",sx="ZerosLike",xm="Step",lx="FromPixels",ux="RotateWithOffset",wm="_FusedMatMul",km="FusedConv2D",Sm="FusedDepthwiseConv2D";/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function ai(...t){ue().getBool("IS_TEST")||ue().getBool("PROD")||console.warn(...t)}function sae(...t){ue().getBool("IS_TEST")||ue().getBool("PROD")||console.log(...t)}/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const zd=V3("kernelRegistry",()=>new Map),Cm=V3("gradRegistry",()=>new Map);function cx(t,e){const n=tT(t,e);return zd.get(n)}function eT(t){return Cm.get(t)}function dx(t){const e=zd.entries(),n=[];for(;;){const{done:r,value:a}=e.next();if(r)break;const[i,o]=a,[s]=i.split("_");s===t&&n.push(o)}return n}function px(t){const{kernelName:e,backendName:n}=t,r=tT(e,n);zd.has(r)&&ai(`The kernel '${e}' for backend '${n}' is already registered`),zd.set(r,t)}function lae(t){const{kernelName:e}=t;Cm.has(e)&&ue().getBool("DEBUG")&&ai(`Overriding the gradient for '${e}'`),Cm.set(e,t)}function uae(t,e){const n=tT(t,e);if(!zd.has(n))throw new Error(`The kernel '${t}' for backend '${e}' is not registered`);zd.delete(n)}function cae(t){if(!Cm.has(t))throw new Error(`The gradient '${t}' for backend is not registered`);Cm.delete(t)}function dae(t,e){dx(t).forEach(n=>{const r=Object.assign({},n,{backendName:e});px(r)})}function tT(t,e){return`${e}_${t}`}var dP=mn,Ci=null;try{Ci=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function mn(t,e,n){this.low=t|0,this.high=e|0,this.unsigned=!!n}mn.prototype.__isLong__,Object.defineProperty(mn.prototype,"__isLong__",{value:!0});function Da(t){return(t&&t.__isLong__)===!0}mn.isLong=Da;var pP={},hP={};function Ku(t,e){var n,r,a;return e?(t>>>=0,(a=0<=t&&t<256)&&(r=hP[t],r)?r:(n=gn(t,(t|0)<0?-1:0,!0),a&&(hP[t]=n),n)):(t|=0,(a=-128<=t&&t<128)&&(r=pP[t],r)?r:(n=gn(t,t<0?-1:0,!1),a&&(pP[t]=n),n))}mn.fromInt=Ku;function Ni(t,e){if(isNaN(t))return e?Xu:Ti;if(e){if(t<0)return Xu;if(t>=mP)return xP}else{if(t<=-gP)return La;if(t+1>=gP)return vP}return t<0?Ni(-t,e).neg():gn(t%Vd|0,t/Vd|0,e)}mn.fromNumber=Ni;function gn(t,e,n){return new mn(t,e,n)}mn.fromBits=gn;var hx=Math.pow;function nT(t,e,n){if(t.length===0)throw Error("empty string");if(t==="NaN"||t==="Infinity"||t==="+Infinity"||t==="-Infinity")return Ti;if(typeof e=="number"?(n=e,e=!1):e=!!e,n=n||10,n<2||36<n)throw RangeError("radix");var r;if((r=t.indexOf("-"))>0)throw Error("interior hyphen");if(r===0)return nT(t.substring(1),e,n).neg();for(var a=Ni(hx(n,8)),i=Ti,o=0;o<t.length;o+=8){var s=Math.min(8,t.length-o),l=parseInt(t.substring(o,o+s),n);if(s<8){var u=Ni(hx(n,s));i=i.mul(u).add(Ni(l))}else i=i.mul(a),i=i.add(Ni(l))}return i.unsigned=e,i}mn.fromString=nT;function oo(t,e){return typeof t=="number"?Ni(t,e):typeof t=="string"?nT(t,e):gn(t.low,t.high,typeof e=="boolean"?e:t.unsigned)}mn.fromValue=oo;var fP=65536,pae=1<<24,Vd=fP*fP,mP=Vd*Vd,gP=mP/2,yP=Ku(pae),Ti=Ku(0);mn.ZERO=Ti;var Xu=Ku(0,!0);mn.UZERO=Xu;var Wd=Ku(1);mn.ONE=Wd;var bP=Ku(1,!0);mn.UONE=bP;var rT=Ku(-1);mn.NEG_ONE=rT;var vP=gn(-1,2147483647,!1);mn.MAX_VALUE=vP;var xP=gn(-1,-1,!0);mn.MAX_UNSIGNED_VALUE=xP;var La=gn(0,-2147483648,!1);mn.MIN_VALUE=La;var _e=mn.prototype;_e.toInt=function(){return this.unsigned?this.low>>>0:this.low},_e.toNumber=function(){return this.unsigned?(this.high>>>0)*Vd+(this.low>>>0):this.high*Vd+(this.low>>>0)},_e.toString=function(t){if(t=t||10,t<2||36<t)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(La)){var e=Ni(t),n=this.div(e),r=n.mul(e).sub(this);return n.toString(t)+r.toInt().toString(t)}else return"-"+this.neg().toString(t);for(var a=Ni(hx(t,6),this.unsigned),i=this,o="";;){var s=i.div(a),l=i.sub(s.mul(a)).toInt()>>>0,u=l.toString(t);if(i=s,i.isZero())return u+o;for(;u.length<6;)u="0"+u;o=""+u+o}},_e.getHighBits=function(){return this.high},_e.getHighBitsUnsigned=function(){return this.high>>>0},_e.getLowBits=function(){return this.low},_e.getLowBitsUnsigned=function(){return this.low>>>0},_e.getNumBitsAbs=function(){if(this.isNegative())return this.eq(La)?64:this.neg().getNumBitsAbs();for(var t=this.high!=0?this.high:this.low,e=31;e>0&&!(t&1<<e);e--);return this.high!=0?e+33:e+1},_e.isZero=function(){return this.high===0&&this.low===0},_e.eqz=_e.isZero,_e.isNegative=function(){return!this.unsigned&&this.high<0},_e.isPositive=function(){return this.unsigned||this.high>=0},_e.isOdd=function(){return(this.low&1)===1},_e.isEven=function(){return(this.low&1)===0},_e.equals=function(t){return Da(t)||(t=oo(t)),this.unsigned!==t.unsigned&&this.high>>>31===1&&t.high>>>31===1?!1:this.high===t.high&&this.low===t.low},_e.eq=_e.equals,_e.notEquals=function(t){return!this.eq(t)},_e.neq=_e.notEquals,_e.ne=_e.notEquals,_e.lessThan=function(t){return this.comp(t)<0},_e.lt=_e.lessThan,_e.lessThanOrEqual=function(t){return this.comp(t)<=0},_e.lte=_e.lessThanOrEqual,_e.le=_e.lessThanOrEqual,_e.greaterThan=function(t){return this.comp(t)>0},_e.gt=_e.greaterThan,_e.greaterThanOrEqual=function(t){return this.comp(t)>=0},_e.gte=_e.greaterThanOrEqual,_e.ge=_e.greaterThanOrEqual,_e.compare=function(t){if(Da(t)||(t=oo(t)),this.eq(t))return 0;var e=this.isNegative(),n=t.isNegative();return e&&!n?-1:!e&&n?1:this.unsigned?t.high>>>0>this.high>>>0||t.high===this.high&&t.low>>>0>this.low>>>0?-1:1:this.sub(t).isNegative()?-1:1},_e.comp=_e.compare,_e.negate=function(){return!this.unsigned&&this.eq(La)?La:this.not().add(Wd)},_e.neg=_e.negate,_e.add=function(t){Da(t)||(t=oo(t));var e=this.high>>>16,n=this.high&65535,r=this.low>>>16,a=this.low&65535,i=t.high>>>16,o=t.high&65535,s=t.low>>>16,l=t.low&65535,u=0,c=0,d=0,p=0;return p+=a+l,d+=p>>>16,p&=65535,d+=r+s,c+=d>>>16,d&=65535,c+=n+o,u+=c>>>16,c&=65535,u+=e+i,u&=65535,gn(d<<16|p,u<<16|c,this.unsigned)},_e.subtract=function(t){return Da(t)||(t=oo(t)),this.add(t.neg())},_e.sub=_e.subtract,_e.multiply=function(t){if(this.isZero())return Ti;if(Da(t)||(t=oo(t)),Ci){var e=Ci.mul(this.low,this.high,t.low,t.high);return gn(e,Ci.get_high(),this.unsigned)}if(t.isZero())return Ti;if(this.eq(La))return t.isOdd()?La:Ti;if(t.eq(La))return this.isOdd()?La:Ti;if(this.isNegative())return t.isNegative()?this.neg().mul(t.neg()):this.neg().mul(t).neg();if(t.isNegative())return this.mul(t.neg()).neg();if(this.lt(yP)&&t.lt(yP))return Ni(this.toNumber()*t.toNumber(),this.unsigned);var n=this.high>>>16,r=this.high&65535,a=this.low>>>16,i=this.low&65535,o=t.high>>>16,s=t.high&65535,l=t.low>>>16,u=t.low&65535,c=0,d=0,p=0,f=0;return f+=i*u,p+=f>>>16,f&=65535,p+=a*u,d+=p>>>16,p&=65535,p+=i*l,d+=p>>>16,p&=65535,d+=r*u,c+=d>>>16,d&=65535,d+=a*l,c+=d>>>16,d&=65535,d+=i*s,c+=d>>>16,d&=65535,c+=n*u+r*l+a*s+i*o,c&=65535,gn(p<<16|f,c<<16|d,this.unsigned)},_e.mul=_e.multiply,_e.divide=function(t){if(Da(t)||(t=oo(t)),t.isZero())throw Error("division by zero");if(Ci){if(!this.unsigned&&this.high===-2147483648&&t.low===-1&&t.high===-1)return this;var e=(this.unsigned?Ci.div_u:Ci.div_s)(this.low,this.high,t.low,t.high);return gn(e,Ci.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?Xu:Ti;var n,r,a;if(this.unsigned){if(t.unsigned||(t=t.toUnsigned()),t.gt(this))return Xu;if(t.gt(this.shru(1)))return bP;a=Xu}else{if(this.eq(La)){if(t.eq(Wd)||t.eq(rT))return La;if(t.eq(La))return Wd;var i=this.shr(1);return n=i.div(t).shl(1),n.eq(Ti)?t.isNegative()?Wd:rT:(r=this.sub(t.mul(n)),a=n.add(r.div(t)),a)}else if(t.eq(La))return this.unsigned?Xu:Ti;if(this.isNegative())return t.isNegative()?this.neg().div(t.neg()):this.neg().div(t).neg();if(t.isNegative())return this.div(t.neg()).neg();a=Ti}for(r=this;r.gte(t);){n=Math.max(1,Math.floor(r.toNumber()/t.toNumber()));for(var o=Math.ceil(Math.log(n)/Math.LN2),s=o<=48?1:hx(2,o-48),l=Ni(n),u=l.mul(t);u.isNegative()||u.gt(r);)n-=s,l=Ni(n,this.unsigned),u=l.mul(t);l.isZero()&&(l=Wd),a=a.add(l),r=r.sub(u)}return a},_e.div=_e.divide,_e.modulo=function(t){if(Da(t)||(t=oo(t)),Ci){var e=(this.unsigned?Ci.rem_u:Ci.rem_s)(this.low,this.high,t.low,t.high);return gn(e,Ci.get_high(),this.unsigned)}return this.sub(this.div(t).mul(t))},_e.mod=_e.modulo,_e.rem=_e.modulo,_e.not=function(){return gn(~this.low,~this.high,this.unsigned)},_e.and=function(t){return Da(t)||(t=oo(t)),gn(this.low&t.low,this.high&t.high,this.unsigned)},_e.or=function(t){return Da(t)||(t=oo(t)),gn(this.low|t.low,this.high|t.high,this.unsigned)},_e.xor=function(t){return Da(t)||(t=oo(t)),gn(this.low^t.low,this.high^t.high,this.unsigned)},_e.shiftLeft=function(t){return Da(t)&&(t=t.toInt()),(t&=63)===0?this:t<32?gn(this.low<<t,this.high<<t|this.low>>>32-t,this.unsigned):gn(0,this.low<<t-32,this.unsigned)},_e.shl=_e.shiftLeft,_e.shiftRight=function(t){return Da(t)&&(t=t.toInt()),(t&=63)===0?this:t<32?gn(this.low>>>t|this.high<<32-t,this.high>>t,this.unsigned):gn(this.high>>t-32,this.high>=0?0:-1,this.unsigned)},_e.shr=_e.shiftRight,_e.shiftRightUnsigned=function(t){if(Da(t)&&(t=t.toInt()),t&=63,t===0)return this;var e=this.high;if(t<32){var n=this.low;return gn(n>>>t|e<<32-t,e>>>t,this.unsigned)}else return t===32?gn(e,0,this.unsigned):gn(e>>>t-32,0,this.unsigned)},_e.shru=_e.shiftRightUnsigned,_e.shr_u=_e.shiftRightUnsigned,_e.toSigned=function(){return this.unsigned?gn(this.low,this.high,!1):this},_e.toUnsigned=function(){return this.unsigned?this:gn(this.low,this.high,!0)},_e.toBytes=function(t){return t?this.toBytesLE():this.toBytesBE()},_e.toBytesLE=function(){var t=this.high,e=this.low;return[e&255,e>>>8&255,e>>>16&255,e>>>24,t&255,t>>>8&255,t>>>16&255,t>>>24]},_e.toBytesBE=function(){var t=this.high,e=this.low;return[t>>>24,t>>>16&255,t>>>8&255,t&255,e>>>24,e>>>16&255,e>>>8&255,e&255]},mn.fromBytes=function(t,e,n){return n?mn.fromBytesLE(t,e):mn.fromBytesBE(t,e)},mn.fromBytesLE=function(t,e){return new mn(t[0]|t[1]<<8|t[2]<<16|t[3]<<24,t[4]|t[5]<<8|t[6]<<16|t[7]<<24,e)},mn.fromBytesBE=function(t,e){return new mn(t[4]<<24|t[5]<<16|t[6]<<8|t[7],t[0]<<24|t[1]<<16|t[2]<<8|t[3],e)};const wP=Hi(dP),hae=u5({__proto__:null,default:wP},[dP]);/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Yu=wP||hae;function Nm(t){return Yu.fromString(t,!0,16)}const kP=Nm("c3a5c85c97cb3127"),Qu=Nm("b492b66fbe98f273"),ia=Nm("9ae16a3b2f90404f");function aT(t){return t.xor(t.shru(47))}function SP(t,e,n){const r=t.slice(e,e+n);return Yu.fromBytes(Array.from(r),!0,!0)}function ln(t,e){return SP(t,e,8)}function CP(t,e){return SP(t,e,4)}function pr(t,e){return e===0?t:t.shru(e).or(t.shl(64-e))}function $l(t,e,n=Nm("9ddfea08eb382d69")){let r=t.xor(e).mul(n);r=r.xor(r.shru(47));let a=e.xor(r).mul(n);return a=a.xor(a.shru(47)),a=a.mul(n),a}function fae(t,e,n,r,a,i){a=a.add(t),i=pr(i.add(a).add(r),21);const o=a;return a=a.add(e),a=a.add(n),i=i.add(pr(a,44)),[a.add(r),i.add(o)]}function fx(t,e,n,r){return fae(ln(t,e),ln(t,e+8),ln(t,e+16),ln(t,e+24),n,r)}function mae(t,e=t.length){if(e>=8){const n=ia.add(e*2),r=ln(t,0).add(ia),a=ln(t,e-8),i=pr(a,37).mul(n).add(r),o=pr(r,25).add(a).mul(n);return $l(i,o,n)}if(e>=4){const n=ia.add(e*2),r=CP(t,0);return $l(r.shl(3).add(e),CP(t,e-4),n)}if(e>0){const n=t[0],r=t[e>>1],a=t[e-1],i=n+(r<<8),o=e+(a<<2);return aT(ia.mul(i).xor(kP.mul(o))).mul(ia)}return ia}function gae(t,e=t.length){const n=ia.add(e*2),r=ln(t,0).mul(Qu),a=ln(t,8),i=ln(t,e-8).mul(n),o=ln(t,e-16).mul(ia);return $l(pr(r.add(a),43).add(pr(i,30)).add(o),r.add(pr(a.add(ia),18)).add(i),n)}function yae(t,e=t.length){const n=ia.add(e*2),r=ln(t,0).mul(ia),a=ln(t,8),i=ln(t,e-8).mul(n),o=ln(t,e-16).mul(ia),s=pr(r.add(a),43).add(pr(i,30)).add(o),l=$l(s,r.add(pr(a.add(ia),18)).add(i),n),u=ln(t,16).mul(n),c=ln(t,24),d=s.add(ln(t,e-32)).mul(n),p=l.add(ln(t,e-24)).mul(n);return $l(pr(u.add(c),43).add(pr(d,30)).add(p),u.add(pr(c.add(r),18)).add(d),n)}function NP(t,e=t.length){const n=Yu.fromNumber(81,!0);if(e<=32)return e<=16?mae(t,e):gae(t,e);if(e<=64)return yae(t,e);let r=n,a=n.mul(Qu).add(113),i=aT(a.mul(ia).add(113)).mul(ia),o=[Yu.UZERO,Yu.UZERO],s=[Yu.UZERO,Yu.UZERO];r=r.mul(ia).add(ln(t,0));let l=0;const u=(e-1>>6)*64,c=u+(e-1&63)-63;do r=pr(r.add(a).add(o[0]).add(ln(t,l+8)),37).mul(Qu),a=pr(a.add(o[1]).add(ln(t,l+48)),42).mul(Qu),r=r.xor(s[1]),a=a.add(o[0]).add(ln(t,l+40)),i=pr(i.add(s[0]),33).mul(Qu),o=fx(t,l,o[1].mul(Qu),r.add(s[0])),s=fx(t,l+32,i.add(s[1]),a.add(ln(t,l+16))),[i,r]=[r,i],l+=64;while(l!==u);const d=Qu.add(i.and(255).shl(1));return l=c,s[0]=s[0].add(e-1&63),o[0]=o[0].add(s[0]),s[0]=s[0].add(o[0]),r=pr(r.add(a).add(o[0]).add(ln(t,l+8)),37).mul(d),a=pr(a.add(o[1]).add(ln(t,l+48)),42).mul(d),r=r.xor(s[1].mul(9)),a=a.add(o[0].mul(9).add(ln(t,l+40))),i=pr(i.add(s[0]),33).mul(d),o=fx(t,l,o[1].mul(d),r.add(s[0])),s=fx(t,l+32,i.add(s[1]),a.add(ln(t,l+16))),[i,r]=[r,i],$l($l(o[0],s[0],d).add(aT(a).mul(kP)).add(i),$l(o[1],s[1],d).add(r),d)}/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Ss(t,e){return e==="string"?$o(t):Rl([t],e)}function bae(t,e){return t instanceof Float32Array&&e==="float32"||t instanceof Int32Array&&e==="int32"||t instanceof Uint8Array&&e==="bool"}function Rl(t,e){if(e==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=ws(t)),ue().getBool("DEBUG")&&nP(t,e),bae(t,e))return t;if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool"){const n=new Uint8Array(t.length);for(let r=0;r<n.length;++r)Math.round(t[r])!==0&&(n[r]=1);return n}else throw new Error(`Unknown data type ${e}`)}function Fa(){return ue().platform.now()}function vae(t,e){return ue().platform.fetch(t,e)}function $o(t,e="utf-8"){return e=e||"utf-8",ue().platform.encode(t,e)}function Cs(t,e="utf-8"){return e=e||"utf-8",ue().platform.decode(t,e)}const xae=Object.freeze(Object.defineProperty({__proto__:null,arraysEqual:tn,assert:V,assertNonNegativeIntegerDimensions:F3,assertNonNull:ju,assertShapesMatch:Sr,bytesFromStringArray:aP,bytesPerElement:wb,checkConversionForErrors:nP,clamp:_l,computeStrides:qe,createScalarValue:Ss,createShuffledIndices:Xre,decodeString:Cs,distSquared:Hre,encodeString:$o,fetch:vae,fingerPrint64:NP,flatten:ws,getArrayFromDType:nr,getTypedArrayFromDType:tr,hasEncodingLoss:D3,hexToLong:Nm,indexToLoc:Hu,inferDtype:Ld,inferFromImplicitShape:P3,isBoolean:iP,isFunction:Ol,isInt:Uu,isNumber:oP,isPromise:qu,isScalarShape:qre,isString:Oo,isTypedArray:Vr,isValidDtype:rP,locToIndex:io,makeOnesTypedArray:Sb,makeZerosNestedTypedArray:L3,makeZerosTypedArray:Cr,nearestDivisor:kb,nearestLargerEven:vb,now:Fa,parseAxisParam:Pt,randUniform:Gre,repeatedTry:A3,rightPad:Gu,shuffle:eP,shuffleCombo:Ure,sizeFromShape:me,sizeToSquarishShape:xb,squeezeShape:ks,sum:tP,swap:xs,tanh:Kre,toNestedArray:ri,toTypedArray:Rl},Symbol.toStringTag,{value:"Module"}));/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class wae{constructor(e,n){this.backendTimer=e,this.logger=n,n==null&&(this.logger=new Sae)}profileKernel(e,n,r){let a;const i=()=>{a=r()};let o;const s=Fa();if(this.backendTimer.timerAvailable())o=this.backendTimer.time(i);else{i();for(const l of a)l.dataSync();o=Promise.resolve({kernelMs:Fa()-s})}if(ue().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let l=0;l<a.length;l++){const u=a[l];u.data().then(c=>{kae(c,u.dtype,e)})}return{kernelName:e,outputs:a,inputs:n,timeMs:o.then(l=>l.kernelMs),extraInfo:o.then(l=>l.getExtraProfileInfo!=null?l.getExtraProfileInfo():"")}}logKernelProfile(e){const{kernelName:n,outputs:r,timeMs:a,inputs:i,extraInfo:o}=e;r.forEach(s=>{Promise.all([s.data(),a,o]).then(l=>{this.logger.logKernelProfile(n,s,l[0],l[1],i,l[2])})})}}function kae(t,e,n){if(e!=="float32")return!1;for(let r=0;r<t.length;r++){const a=t[r];if(isNaN(a)||!isFinite(a))return console.warn(`Found ${a} in the result of '${n}'`),!0}return!1}class Sae{logKernelProfile(e,n,r,a,i,o){const s=typeof a=="number"?Gu(`${a}ms`,9):a.error,l=Gu(e,25),u=n.rank,c=n.size,d=Gu(n.shape.toString(),14);let p="";for(const f in i){const g=i[f];if(g!=null){const y=g.shape||n.shape,x=y.length;p+=`${f}: ${x}D ${x>0?y:""} `}}console.log(`%c${l}	%c${s}	%c${u}D ${d}	%c${c}	%c${p}	%c${o}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Cae(t,e,n){const r={},a={};for(let l=0;l<e.length;l++)r[e[l].id]=!0;for(let l=0;l<t.length;l++){const u=t[l],c=u.inputs;for(const d in c){const p=c[d];let f=!1;for(let g=0;g<e.length;g++)if(r[p.id]){u.outputs.forEach(y=>r[y.id]=!0),f=!0,a[u.id]=!0;break}if(f)break}}const i={};i[n.id]=!0;const o={};for(let l=t.length-1;l>=0;l--){const u=t[l],c=u.inputs;for(let d=0;d<u.outputs.length;d++)if(i[u.outputs[d].id]){for(const p in c)i[c[p].id]=!0,o[u.id]=!0;break}}const s=[];for(let l=0;l<t.length;l++){const u=t[l];if(a[u.id]&&o[u.id]){const c={};for(const p in u.inputs){const f=u.inputs[p];r[f.id]&&(c[p]=f)}const d=Object.assign({},u);d.inputs=c,d.outputs=u.outputs,s.push(d)}}return s}function Nae(t,e,n,r){for(let a=e.length-1;a>=0;a--){const i=e[a],o=[];if(i.outputs.forEach(l=>{const u=t[l.id];u!=null?o.push(u):o.push(null)}),i.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${i.kernelName}.`);const s=i.gradient(o);for(const l in i.inputs){if(!(l in s))throw new Error(`Cannot backprop through input ${l}. Available gradients found: ${Object.keys(s)}.`);const u=n(()=>s[l]());if(u.dtype!=="float32")throw new Error(`Error in gradient for op ${i.kernelName}. The gradient of input ${l} must have 'float32' dtype, but has '${u.dtype}'`);const c=i.inputs[l];if(!tn(u.shape,c.shape))throw new Error(`Error in gradient for op ${i.kernelName}. The gradient of input '${l}' has shape '${u.shape}', which does not match the shape of the input '${c.shape}'`);if(t[c.id]==null)t[c.id]=u;else{const d=t[c.id];t[c.id]=r(d,u),d.dispose()}}}}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const TP=20,Tm=3,iT=7;function Tae(t,e,n,r){const a=qe(e),i=Iae(t,e,n,a),o=e.length,s=mx(t,e,n,a,i),l=["Tensor"];return r&&(l.push(`  dtype: ${n}`),l.push(`  rank: ${o}`),l.push(`  shape: [${e}]`),l.push("  values:")),l.push(s.map(u=>"    "+u).join(`
`)),l.join(`
`)}function Iae(t,e,n,r){const a=me(e),i=r[r.length-1],o=new Array(i).fill(0),s=e.length,l=n==="complex64"?Em(t):t;if(s>1)for(let u=0;u<a/i;u++){const c=u*i;for(let d=0;d<i;d++)o[d]=Math.max(o[d],Im(l[c+d],0,n).length)}return o}function Im(t,e,n){let r;return Array.isArray(t)?r=`${parseFloat(t[0].toFixed(iT))} + ${parseFloat(t[1].toFixed(iT))}j`:Oo(t)?r=`'${t}'`:n==="bool"?r=IP(t):r=parseFloat(t.toFixed(iT)).toString(),Gu(r,e)}function IP(t){return t===0?"false":"true"}function mx(t,e,n,r,a,i=!0){const o=n==="complex64"?2:1,s=e[0],l=e.length;if(l===0){if(n==="complex64"){const y=Em(t);return[Im(y[0],0,n)]}return n==="bool"?[IP(t[0])]:[t[0].toString()]}if(l===1){if(s>TP){const y=Tm*o;let x=Array.from(t.slice(0,y)),b=Array.from(t.slice((s-Tm)*o,s*o));return n==="complex64"&&(x=Em(x),b=Em(b)),["["+x.map((v,w)=>Im(v,a[w],n)).join(", ")+", ..., "+b.map((v,w)=>Im(v,a[s-Tm+w],n)).join(", ")+"]"]}return["["+(n==="complex64"?Em(t):Array.from(t)).map((y,x)=>Im(y,a[x],n)).join(", ")+"]"]}const u=e.slice(1),c=r.slice(1),d=r[0]*o,p=[];if(s>TP){for(let y=0;y<Tm;y++){const x=y*d,b=x+d;p.push(...mx(t.slice(x,b),u,n,c,a,!1))}p.push("...");for(let y=s-Tm;y<s;y++){const x=y*d,b=x+d;p.push(...mx(t.slice(x,b),u,n,c,a,y===s-1))}}else for(let y=0;y<s;y++){const x=y*d,b=x+d;p.push(...mx(t.slice(x,b),u,n,c,a,y===s-1))}const f=l===2?",":"";p[0]="["+p[0]+f;for(let y=1;y<p.length-1;y++)p[y]=" "+p[y]+f;let g=`,
`;for(let y=2;y<l;y++)g+=`
`;return p[p.length-1]=" "+p[p.length-1]+"]"+(i?"":g),p}function Em(t){const e=[];for(let n=0;n<t.length;n+=2)e.push([t[n],t[n+1]]);return e}/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class rr{constructor(e,n,r){if(this.dtype=n,this.shape=e.slice(),this.size=me(e),r!=null){const a=r.length;V(a===this.size,()=>`Length of values '${a}' does not match the size inferred by the shape '${this.size}'.`)}if(n==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||nr(n,this.size),this.strides=qe(e)}set(e,...n){n.length===0&&(n=[0]),V(n.length===this.rank,()=>`The number of provided coordinates (${n.length}) must match the rank (${this.rank})`);const r=this.locToIndex(n);this.values[r]=e}get(...e){e.length===0&&(e=[0]);let n=0;for(const a of e){if(a<0||a>=this.shape[n]){const i=`Requested out of range element at ${e}.   Buffer shape=${this.shape}`;throw new Error(i)}n++}let r=e[e.length-1];for(let a=0;a<e.length-1;++a)r+=this.strides[a]*e[a];return this.values[r]}locToIndex(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];let n=e[e.length-1];for(let r=0;r<e.length-1;++r)n+=this.strides[r]*e[r];return n}indexToLoc(e){if(this.rank===0)return[];if(this.rank===1)return[e];const n=new Array(this.shape.length);for(let r=0;r<n.length-1;++r)n[r]=Math.floor(e/this.strides[r]),e-=n[r]*this.strides[r];return n[n.length-1]=e,n}get rank(){return this.shape.length}toTensor(){return so().makeTensor(this.values,this.shape,this.dtype)}}let so=null,jd=null;function Eae(t){so=t}function _ae(t){jd=t}class In{constructor(e,n,r,a){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=n||"float32",this.size=me(e),this.strides=qe(e),this.dataId=r,this.id=a,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const e=await this.data();return jd.buffer(this.shape,this.dtype,e)}bufferSync(){return jd.buffer(this.shape,this.dtype,this.dataSync())}async array(){const e=await this.data();return ri(this.shape,e,this.dtype==="complex64")}arraySync(){return ri(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();const e=so().read(this.dataId);if(this.dtype==="string"){const n=await e;try{return n.map(r=>Cs(r))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),so().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();const e=so().readSync(this.dataId);if(this.dtype==="string")try{return e.map(n=>Cs(n))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();const e=await so().read(this.dataId);return this.dtype==="string"?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(so().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(e=!1){return jd.print(this,e)}clone(){return this.throwIfDisposed(),jd.clone(this)}toString(e=!1){const n=this.dataSync();return Tae(n,this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),jd.cast(this,e)}variable(e=!0,n,r){return this.throwIfDisposed(),so().makeVariable(this,e,n,r)}}Object.defineProperty(In,Symbol.hasInstance,{value:t=>!!t&&t.data!=null&&t.dataSync!=null&&t.throwIfDisposed!=null});function Oae(){return V3("Tensor",()=>In)}Oae();class _m extends In{constructor(e,n,r,a){super(e.shape,e.dtype,e.dataId,a),this.trainable=n,this.name=r}assign(e){if(e.dtype!==this.dtype)throw new Error(`dtype of the new value (${e.dtype}) and previous value (${this.dtype}) must match`);if(!tn(e.shape,this.shape))throw new Error(`shape of the new value (${e.shape}) and previous value (${this.shape}) must match`);so().disposeTensor(this),this.dataId=e.dataId,so().incRef(this,null)}dispose(){so().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(_m,Symbol.hasInstance,{value:t=>t instanceof In&&t.assign!=null&&t.assign instanceof Function});/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/var oT;(function(t){t.R0="R0",t.R1="R1",t.R2="R2",t.R3="R3",t.R4="R4",t.R5="R5",t.R6="R6"})(oT||(oT={}));var sT;(function(t){t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64"})(sT||(sT={}));var lT;(function(t){t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64"})(lT||(lT={}));var uT;(function(t){t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64"})(uT||(uT={}));var cT;(function(t){t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64"})(cT||(cT={}));const $ae={float32:uT,int32:sT,bool:lT,complex64:cT};function ka(t,e){if(t==="string"||e==="string"){if(t==="string"&&e==="string")return"string";throw new Error(`Can not upcast ${t} with ${e}`)}return $ae[t][e]}function gx(t){return ka(t,"int32")}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function En(t,e){if(t.dtype===e.dtype)return[t,e];const n=ka(t.dtype,e.dtype);return[t.cast(n),e.cast(n)]}function EP(t,e){V(t.dtype===e.dtype,()=>`The dtypes of the first(${t.dtype}) and second(${e.dtype}) input must match`)}function Rae(t,e){return e.some(n=>n.id===t.id)}function dT(t){const e=[];return _P(t,e,new Set),e}function _P(t,e,n){if(t==null)return;if(t instanceof In){e.push(t);return}if(!Mae(t))return;const r=t;for(const a in r){const i=r[a];n.has(i)||(n.add(i),_P(i,e,n))}}function Mae(t){return Array.isArray(t)||typeof t=="object"}const Aae=Object.freeze(Object.defineProperty({__proto__:null,assertTypesMatch:EP,getTensorsInContainer:dT,isTensorInList:Rae,makeTypesMatch:En},Symbol.toStringTag,{value:"Module"}));/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function pT(t){return t.kernelName!=null}class OP{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(e=>e.name)))}}}dispose(){for(const e in this.registeredVariables)this.registeredVariables[e].dispose()}}class Op{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new OP}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;const e=this.getSortedBackends();for(let n=0;n<e.length;n++){const r=e[n];if(await this.initializeBackend(r).success){await this.setBackend(r);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){const{name:e,asyncInit:n}=this.initializeBackendsAndReturnBest();if(n)throw new Error(`The highest priority backend '${e}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry))if(e in this.registryFactory){const{asyncInit:n}=this.initializeBackend(e);if(n)return null}else return null;return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,n,r=1){return e in this.registryFactory?(ai(`${e} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[e]={factory:n,priority:r},!0)}async setBackend(e){if(this.registryFactory[e]==null)throw new Error(`Backend name '${e}' not found in registry`);if(this.backendName=e,this.registry[e]==null){this.backendInstance=null;const{success:n,asyncInit:r}=this.initializeBackend(e);if(!(r?await n:n))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new wae(this.backendInstance),!0}setupRegisteredKernels(){dx(this.backendName).forEach(e=>{e.setupFunc!=null&&e.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){dx(e).forEach(n=>{n.disposeFunc!=null&&n.disposeFunc(this.registry[e])})}initializeBackend(e){const n=this.registryFactory[e];if(n==null)throw new Error(`Cannot initialize backend ${e}, no registration found.`);try{const r=n.factory();if(r&&!(r instanceof bb)&&typeof r.then=="function"){const a=++this.pendingBackendInitId,i=r.then(o=>a<this.pendingBackendInitId?!1:(this.registry[e]=o,this.pendingBackendInit=null,!0)).catch(o=>(a<this.pendingBackendInitId||(this.pendingBackendInit=null,ai(`Initialization of backend ${e} failed`),ai(o.stack||o.message)),!1));return this.pendingBackendInit=i,{success:i,asyncInit:!0}}else return this.registry[e]=r,{success:!0,asyncInit:!1}}catch(r){return ai(`Initialization of backend ${e} failed`),ai(r.stack||r.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error(`${e} backend not found in registry`);this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((e,n)=>this.registryFactory[n].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){const e=this.getSortedBackends();for(let n=0;n<e.length;n++){const r=e[n],{success:a,asyncInit:i}=this.initializeBackend(r);if(i||a)return{name:r,asyncInit:i}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,n){const r=this.state.tensorInfo.get(n),a=r.backend,i=this.readSync(n),o=a.refCount(n);a.disposeData(n,!0),r.backend=e,e.move(n,i,r.shape,r.dtype,o),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,n){let r=null;if(n==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");n=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof n!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");r=e}let a;return this.scopedRun(()=>this.startScope(r),()=>this.endScope(a),()=>(a=n(),a instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),a))}scopedRun(e,n,r){e();try{const a=r();return n(),a}catch(a){throw n(),a}}nextTensorId(){return Op.nextTensorId++}nextVariableId(){return Op.nextVariableId++}clone(e){const n=te.runKernel(zf,{x:e}),r={x:e},a=o=>({x:()=>{const s="float32",l={x:o},u={dtype:s};return te.runKernel(Nf,l,u)}}),i=[];return this.addTapeNode(this.state.activeScope.name,r,[n],a,i,{}),n}runKernel(e,n,r){if(this.backendName==null&&this.backend,cx(e,this.backendName)==null)throw new Error(`Kernel '${e}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:e,inputs:n,attrs:r})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,n,r){const a=this.backend.numDataIds();let i=0;r.forEach(l=>{i+=l.dtype==="complex64"?3:1});const o=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],s=a-n-i-o;if(s>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${s} data ids) after running '${e}'`)}runKernelFunc(e){let n,r=[];const a=this.isTapeOn(),i=this.state.numBytes,o=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let s;this.backendName==null&&this.backend;let l;const u=pT(e)?e.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(pT(e)){const{kernelName:g,inputs:y,attrs:x}=e;this.backendName==null&&this.backend;const b=cx(g,this.backendName);V(b!=null,()=>`Cannot find registered kernel '${g}' for backend '${this.backendName}'`),s=()=>{const v=this.backend.numDataIds();l=b.kernelFunc({inputs:y,attrs:x,backend:this.backend});const w=Array.isArray(l)?l:[l];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(g,v,w);const S=w.map(C=>C.rank!=null?C:this.makeTensorFromTensorInfo(C));if(a){const C=this.getTensorsForGradient(g,y,S);r=this.saveTensorsForBackwardMode(C)}return S}}else{const{forwardFunc:g}=e,y=x=>{a&&(r=x.map(b=>this.keep(this.clone(b))))};s=()=>{const x=this.backend.numDataIds();l=this.tidy(()=>g(this.backend,y));const b=Array.isArray(l)?l:[l];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(u,x,b),b}}const{inputs:c,attrs:d}=e,p=pT(e)?null:e.backwardsFunc;let f;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?n=s():(f=this.profiler.profileKernel(u,c,()=>s()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(f),n=f.outputs)}),a&&this.addTapeNode(u,c,n,p,r,d),this.state.profiling&&this.state.activeProfile.kernels.push({name:u,bytesAdded:this.state.numBytes-i,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-o,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(c).map(g=>c[g]!=null?c[g].shape:null),outputShapes:n.map(g=>g.shape),kernelTimeMs:f.timeMs,extraInfo:f.extraInfo}),Array.isArray(l)?n:n[0]}saveTensorsForBackwardMode(e){return e.map(n=>this.keep(this.clone(n)))}getTensorsForGradient(e,n,r){const a=eT(e);if(a!=null){const i=a.inputsToSave||[],o=a.outputsToSave||[];let s;a.saveAllInputs?(V(Array.isArray(n),()=>"saveAllInputs is true, expected inputs to be an array."),s=Object.keys(n).map(u=>n[u])):s=i.map(u=>n[u]);const l=r.filter((u,c)=>o[c]);return s.concat(l)}return[]}makeTensor(e,n,r,a){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");r=r||"float32",a=a||this.backend;let i=e;r==="string"&&Oo(e[0])&&(i=e.map(l=>$o(l)));const o=a.write(i,n,r),s=new In(n,r,o,this.nextTensorId());if(this.trackTensor(s,a),r==="string"){const l=this.state.tensorInfo.get(o),u=aP(i);this.state.numBytes+=u-l.bytes,l.bytes=u}return s}makeTensorFromDataId(e,n,r,a){r=r||"float32";const i={dataId:e,shape:n,dtype:r};return this.makeTensorFromTensorInfo(i,a)}makeTensorFromTensorInfo(e,n){const{dataId:r,shape:a,dtype:i}=e,o=new In(a,i,r,this.nextTensorId());return this.trackTensor(o,n),o}makeVariable(e,n=!0,r,a){r=r||this.nextVariableId().toString(),a!=null&&a!==e.dtype&&(e=e.cast(a));const i=new _m(e,n,r,this.nextTensorId());if(this.state.registeredVariables[i.name]!=null)throw new Error(`Variable with name ${i.name} was already registered`);return this.state.registeredVariables[i.name]=i,this.incRef(i,this.backend),i}trackTensor(e,n){this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++;let r=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(r=e.size*wb(e.dtype)),this.state.numBytes+=r,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:n||this.backend,dtype:e.dtype,shape:e.shape,bytes:r})),e instanceof _m||this.track(e)}incRef(e,n){this.trackTensor(e,n),this.backend.incRef(e.dataId)}removeDataId(e,n){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===n&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;const n=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,e.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=n.bytes),e.dtype!=="complex64"&&e.dtype!=="string"){const r=e.size*wb(e.dtype);this.state.numBytes-=r}n.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,n.backend)}disposeVariables(){for(const e in this.state.registeredVariables){const n=this.state.registeredVariables[e];this.disposeVariable(n)}}disposeVariable(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]}memory(){const e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;const n=this.state.numBytes,r=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(a=>a.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-r;for(const a of this.state.activeProfile.kernels)a.kernelTimeMs=await a.kernelTimeMs,a.extraInfo=await a.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(e,n,r,a,i,o){const s={id:this.state.nextTapeNodeId++,kernelName:e,inputs:n,outputs:r,saved:i},l=eT(e);l!=null&&(a=l.gradFunc),a!=null&&(s.gradient=u=>(u=u.map((c,d)=>{if(c==null){const p=r[d],f=Cr(p.size,p.dtype);return this.makeTensor(f,p.shape,p.dtype)}return c}),a(u.length>1?u:u[0],i,o))),this.state.activeTape.push(s)}keep(e){return e.kept=!0,e}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){const n={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(n.name=e),this.state.scopeStack.push(n),this.state.activeScope=n}endScope(e){const n=dT(e),r=new Set(n.map(i=>i.id));for(let i=0;i<this.state.activeScope.track.length;i++){const o=this.state.activeScope.track[i];!o.kept&&!r.has(o.id)&&o.dispose()}const a=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach(i=>{!i.kept&&i.scopeId===a.id&&this.track(i)})}gradients(e,n,r,a=!1){if(V(n.length>0,()=>"gradients() received an empty list of xs."),r!=null&&r.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${r.dtype}'`);const i=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",e));V(i instanceof In,()=>"The result y returned by f() must be a tensor.");const o=Cae(this.state.activeTape,n,i);if(!a&&o.length===0&&n.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const s={};s[i.id]=r??Pae(i.shape),Nae(s,o,u=>this.tidy(u),Dae);const l=n.map(u=>s[u.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(u=>{for(const c of u.saved)c.dispose()}),this.state.activeTape=null),{value:i,grads:l}})}customGrad(e){return V(Ol(e),()=>"The f passed in customGrad(f) must be a function."),(...n)=>{V(n.every(s=>s instanceof In),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let r;const a={};n.forEach((s,l)=>{a[l]=s});const i=(s,l)=>(r=e(...n,l),V(r.value instanceof In,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),V(Ol(r.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),r.value),o=(s,l)=>{const u=r.gradFunc(s,l),c=Array.isArray(u)?u:[u];V(c.length===n.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),V(c.every(p=>p instanceof In),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const d={};return c.forEach((p,f)=>{d[f]=()=>p}),d};return this.runKernelFunc({forwardFunc:i,backwardsFunc:o,inputs:a})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,n){return this.state.tensorInfo.get(e).backend.readToGPU(e,n)}async time(e){const n=Fa(),r=await this.backend.time(e);return r.wallMs=Fa()-n,r}track(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new OP;for(const e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}Op.nextTensorId=0,Op.nextVariableId=0;function Pae(t){const e=Sb(me(t),"float32");return te.makeTensor(e,t,"float32")}function $P(){const t=cP();if(t._tfengine==null){const e=new uP(t);t._tfengine=new Op(e)}return Jre(t._tfengine.ENV),Eae(()=>t._tfengine),t._tfengine}const te=$P();function Dae(t,e){const n={a:t,b:e};return te.runKernel(Fd,n)}/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Lae(){return typeof navigator<"u"&&navigator!=null}let hT;function Fae(t){hT=t}function fT(t){if(hT!==void 0)return hT;if(t||Lae()){if(t||(t=navigator),t.product==="ReactNative")return!0;const e=t.userAgent||t.vendor||(typeof window<"u"?window.opera:"");if(!e){const n=t;return n.userAgentData&&n.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}return!1}function mT(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}const Bae=Object.freeze(Object.defineProperty({__proto__:null,isBrowser:mT,isMobile:fT,mockIsMobile:Fae},Symbol.toStringTag,{value:"Module"}));/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Ba=ue();Ba.registerFlag("DEBUG",()=>!1,t=>{t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")}),Ba.registerFlag("IS_BROWSER",()=>mT()),Ba.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"),Ba.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)),Ba.registerFlag("PROD",()=>!1),Ba.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>Ba.getBool("DEBUG")),Ba.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0),Ba.registerFlag("IS_TEST",()=>!1),Ba.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>!0),Ba.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1),Ba.registerFlag("ENGINE_COMPILE_ONLY",()=>!1),Ba.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1),Ba.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Ro(t,e){let n=t;if(Vr(t))return e==="string"?[]:[t.length];if(!Array.isArray(t))return[];const r=[];for(;Array.isArray(n)||Vr(n)&&e!=="string";)r.push(n.length),n=n[0];return Array.isArray(t)&&ue().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&RP(t,r,[]),r}function RP(t,e,n){if(n=n||[],!Array.isArray(t)&&!Vr(t)){V(e.length===0,()=>`Element arr[${n.join("][")}] is a primitive, but should be an array/TypedArray of ${e[0]} elements`);return}V(e.length>0,()=>`Element arr[${n.join("][")}] should be a primitive, but is an array of ${t.length} elements`),V(t.length===e[0],()=>`Element arr[${n.join("][")}] should have ${e[0]} elements, but has ${t.length} elements`);const r=e.slice(1);for(let a=0;a<t.length;++a)RP(t[a],r,n.concat(a))}function MP(t,e,n,r){if(t!=="string_or_numeric"){if(t==null)throw new Error("Expected dtype cannot be null.");if(t!=="numeric"&&t!==e||t==="numeric"&&e==="string")throw new Error(`Argument '${n}' passed to '${r}' must be ${t} tensor, but got ${e} tensor`)}}function z(t,e,n,r="numeric"){if(t instanceof In)return MP(r,t.dtype,e,n),t;let a=Ld(t);if(a!=="string"&&["bool","int32","float32"].indexOf(r)>=0&&(a=r),MP(r,a,e,n),t==null||!Vr(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string"){const s=t==null?"null":t.constructor.name;throw new Error(`Argument '${e}' passed to '${n}' must be a Tensor or TensorLike, but got '${s}'`)}const i=Ro(t,a);!Vr(t)&&!Array.isArray(t)&&(t=[t]);const o=a!=="string"?Rl(t,a):ws(t,[],!0);return te.makeTensor(o,i,a)}function Om(t,e,n,r="numeric"){if(!Array.isArray(t))throw new Error(`Argument ${e} passed to ${n} must be a \`Tensor[]\` or \`TensorLike[]\``);return t.map((a,i)=>z(a,`${e}[${i}]`,n,r))}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const gT="__op";function ee(t){const e=Object.keys(t);if(e.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${e.length} keys.`);let n=e[0];const r=t[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n=n+gT;const a=(...i)=>{te.startScope(n);try{const o=r(...i);return qu(o)&&console.error("Cannot return a Promise inside of tidy."),te.endScope(o),o}catch(o){throw te.endScope(null),o}};return Object.defineProperty(a,"name",{value:n,configurable:!0}),a}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function zae(t,e){const n=z(t,"real","complex"),r=z(e,"imag","complex");Sr(n.shape,r.shape,`real and imag shapes, ${n.shape} and ${r.shape}, must match in call to tf.complex().`);const a={real:n,imag:r};return te.runKernel(Db,a)}const Ns=ee({complex_:zae});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Ml(t,e,n,r){if(r==null&&(r=Ld(t)),r==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!Vr(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(e!=null){F3(e);const a=me(e),i=me(n);V(a===i,()=>`Based on the provided shape, [${e}], the tensor should have ${a} values but has ${i}`);for(let o=0;o<n.length;++o){const s=n[o],l=o===n.length-1?s!==me(e.slice(o)):!0;V(n[o]===e[o]||!l,()=>`Error creating a new Tensor. Inferred shape (${n}) does not match the provided shape (${e}). `)}}return!Vr(t)&&!Array.isArray(t)&&(t=[t]),e=e||n,t=r!=="string"?Rl(t,r):ws(t,[],!0),te.makeTensor(t,e,r)}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function lo(t,e,n){const r=Ro(t,n);return Ml(t,e,r,n)}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const yT={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const yx=4;async function Vae(t,e){const n=[],r=[],a=Array.isArray(t)?t.map(o=>o.name):Object.keys(t);for(let o=0;o<a.length;++o){const s=a[o],l=Array.isArray(t)?t[o].tensor:t[s];if(l.dtype!=="float32"&&l.dtype!=="int32"&&l.dtype!=="bool"&&l.dtype!=="string"&&l.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${s}': ${l.dtype}`);const u={name:s,shape:l.shape,dtype:l.dtype};if(l.dtype==="string"){const c=new Promise(async d=>{const p=await l.bytes(),f=p.reduce((x,b)=>x+b.length,0)+yx*p.length,g=new Uint8Array(f);let y=0;for(let x=0;x<p.length;x++){const b=p[x],v=new Uint8Array(new Uint32Array([b.length]).buffer);g.set(v,y),y+=yx,g.set(b,y),y+=b.length}d(g)});r.push(c)}else r.push(l.data());e!=null&&(u.group=e),n.push(u)}const i=await Promise.all(r);return{data:Wae(i),specs:n}}function AP(t,e){const n={};let r,a=0;for(const i of e){const o=i.name,s=i.dtype,l=i.shape,u=me(l);let c;if("quantization"in i){const d=i.quantization;if(d.dtype==="uint8"||d.dtype==="uint16"){if(!("min"in d&&"scale"in d))throw new Error(`Weight ${i.name} with quantization ${d.dtype} doesn't have corresponding metadata min and scale.`)}else if(d.dtype==="float16"){if(s!=="float32")throw new Error(`Weight ${i.name} is quantized with ${d.dtype} which only supports weights of type float32 not ${s}.`)}else throw new Error(`Weight ${i.name} has unknown quantization dtype ${d.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);const p=yT[d.dtype],f=t.slice(a,a+u*p),g=d.dtype==="uint8"?new Uint8Array(f):new Uint16Array(f);if(s==="float32")if(d.dtype==="uint8"||d.dtype==="uint16"){c=new Float32Array(g.length);for(let y=0;y<g.length;y++){const x=g[y];c[y]=x*d.scale+d.min}}else if(d.dtype==="float16")r===void 0&&(r=Kae()),c=r(g);else throw new Error(`Unsupported quantization type ${d.dtype} for weight type float32.`);else if(s==="int32"){if(d.dtype!=="uint8"&&d.dtype!=="uint16")throw new Error(`Unsupported quantization type ${d.dtype} for weight type int32.`);c=new Int32Array(g.length);for(let y=0;y<g.length;y++){const x=g[y];c[y]=Math.round(x*d.scale+d.min)}}else throw new Error(`Unsupported dtype in weight '${o}': ${s}`);a+=u*p}else if(s==="string"){const d=me(i.shape);c=[];for(let p=0;p<d;p++){const f=new Uint32Array(t.slice(a,a+yx))[0];a+=yx;const g=new Uint8Array(t.slice(a,a+f));c.push(g),a+=f}}else{const d=yT[s],p=t.slice(a,a+u*d);if(s==="float32")c=new Float32Array(p);else if(s==="int32")c=new Int32Array(p);else if(s==="bool")c=new Uint8Array(p);else if(s==="complex64"){c=new Float32Array(p);const f=new Float32Array(c.length/2),g=new Float32Array(c.length/2);for(let b=0;b<f.length;b++)f[b]=c[b*2],g[b]=c[b*2+1];const y=lo(f,l,"float32"),x=lo(g,l,"float32");n[o]=Ns(y,x),y.dispose(),x.dispose()}else throw new Error(`Unsupported dtype in weight '${o}': ${s}`);a+=u*d}s!=="complex64"&&(n[o]=lo(c,l,s))}return n}function Wae(t){if(t===null)throw new Error(`Invalid input value: ${JSON.stringify(t)}`);let e=0;const n=[];t.forEach(i=>{if(e+=i.byteLength,n.push(i.byteLength===i.buffer.byteLength?i:new i.constructor(i)),!(i instanceof Float32Array||i instanceof Int32Array||i instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${i.constructor.name}`)});const r=new Uint8Array(e);let a=0;return n.forEach(i=>{r.set(new Uint8Array(i.buffer),a),a+=i.byteLength}),r.buffer}const bT=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function PP(t){return bT?Buffer.byteLength(t):new Blob([t]).size}function jae(t){if(bT)return Buffer.from(t).toString("base64");const e=new Uint8Array(t);let n="";for(let r=0,a=e.length;r<a;r++)n+=String.fromCharCode(e[r]);return btoa(n)}function Uae(t){if(bT){const r=Buffer.from(t,"base64");return r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength)}const e=atob(t),n=new Uint8Array(e.length);for(let r=0;r<e.length;++r)n.set([e.charCodeAt(r)],r);return n.buffer}function vT(t){if(t.length===1)return t[0];let e=0;t.forEach(a=>{e+=a.byteLength});const n=new Uint8Array(e);let r=0;return t.forEach(a=>{n.set(new Uint8Array(a),r),r+=a.byteLength}),n.buffer}function DP(t){const e="/";for(t=t.trim();t.endsWith(e);)t=t.slice(0,t.length-1);const n=t.split(e);return n[n.length-1]}function LP(t,e){const n={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:e};return t.signature!=null&&(n.signature=t.signature),t.userDefinedMetadata!=null&&(n.userDefinedMetadata=t.userDefinedMetadata),t.modelInitializer!=null&&(n.modelInitializer=t.modelInitializer),t.trainingConfig!=null&&(n.trainingConfig=t.trainingConfig),n}function FP(t,e,n){const r={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy};if(t.trainingConfig!=null&&(r.trainingConfig=t.trainingConfig),t.weightsManifest!=null){if(!e)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!n)throw new Error("modelJSON has weightsManifest but weightData is null");r.weightSpecs=e,r.weightData=n}return t.signature!=null&&(r.signature=t.signature),t.userDefinedMetadata!=null&&(r.userDefinedMetadata=t.userDefinedMetadata),t.modelInitializer!=null&&(r.modelInitializer=t.modelInitializer),r}async function xT(t,e){let n,r;return t.weightsManifest!=null&&([n,r]=await e(t.weightsManifest)),FP(t,n,r)}function $m(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:t.modelTopology==null?0:PP(JSON.stringify(t.modelTopology)),weightSpecsBytes:t.weightSpecs==null?0:PP(JSON.stringify(t.weightSpecs)),weightDataBytes:t.weightData==null?0:t.weightData.byteLength}}function BP(t){const e=[];for(const n of t)e.push(...n.weights);return e}function Gae(){const t=n=>{let r=n<<13,a=0;for(;!(r&8388608);)a-=8388608,r<<=1;return r&=-8388609,a+=947912704,r|a},e=new Uint32Array(2048);e[0]=0;for(let n=1;n<1024;n++)e[n]=t(n);for(let n=1024;n<2048;n++)e[n]=939524096+(n-1024<<13);return e}function Hae(){const t=new Uint32Array(64);t[0]=0,t[31]=1199570944,t[32]=2147483648,t[63]=3347054592;for(let e=1;e<31;e++)t[e]=e<<23;for(let e=33;e<63;e++)t[e]=2147483648+(e-32<<23);return t}function qae(){const t=new Uint32Array(64);for(let e=0;e<64;e++)t[e]=1024;return t[0]=t[32]=0,t}function Kae(){const t=Gae(),e=Hae(),n=qae();return r=>{const a=new ArrayBuffer(4*r.length),i=new Uint32Array(a);for(let o=0;o<r.length;o++){const s=r[o],l=t[n[s>>10]+(s&1023)]+e[s>>10];i[o]=l}return new Float32Array(a)}}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class _n{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return _n.instance==null&&(_n.instance=new _n),_n.instance}static registerSaveRouter(e){_n.getInstance().saveRouters.push(e)}static registerLoadRouter(e){_n.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return _n.getHandlers(e,"save")}static getLoadHandlers(e,n){return _n.getHandlers(e,"load",n)}static getHandlers(e,n,r){const a=[];return(n==="load"?_n.getInstance().loadRouters:_n.getInstance().saveRouters).forEach(i=>{const o=i(e,r);o!==null&&a.push(o)}),a}}const Xae=t=>_n.registerSaveRouter(t),Yae=t=>_n.registerLoadRouter(t),Qae=t=>_n.getSaveHandlers(t),Zae=(t,e)=>_n.getLoadHandlers(t,e);/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const wT="tensorflowjs",kT=1,Zu="models_store",Al="model_info_store";function zP(){if(!ue().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const t=typeof window>"u"?self:window,e=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(e==null)throw new Error("The current browser does not appear to support IndexedDB.");return e}function ST(t){const e=t.result;e.createObjectStore(Zu,{keyPath:"modelPath"}),e.createObjectStore(Al,{keyPath:"modelPath"})}class Ju{constructor(e){if(this.indexedDB=zP(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,n){return new Promise((r,a)=>{const i=this.indexedDB.open(wT,kT);i.onupgradeneeded=()=>ST(i),i.onsuccess=()=>{const o=i.result;if(n==null){const s=o.transaction(Zu,"readonly"),l=s.objectStore(Zu).get(this.modelPath);l.onsuccess=()=>{if(l.result==null)return o.close(),a(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));r(l.result.modelArtifacts)},l.onerror=u=>(o.close(),a(l.error)),s.oncomplete=()=>o.close()}else{const s=$m(n),l=o.transaction(Al,"readwrite");let u=l.objectStore(Al);const c=u.put({modelPath:this.modelPath,modelArtifactsInfo:s});let d;c.onsuccess=()=>{d=o.transaction(Zu,"readwrite");const p=d.objectStore(Zu).put({modelPath:this.modelPath,modelArtifacts:n,modelArtifactsInfo:s});p.onsuccess=()=>r({modelArtifactsInfo:s}),p.onerror=f=>{u=l.objectStore(Al);const g=u.delete(this.modelPath);g.onsuccess=()=>(o.close(),a(p.error)),g.onerror=y=>(o.close(),a(p.error))}},c.onerror=p=>(o.close(),a(c.error)),l.oncomplete=()=>{d==null?o.close():d.oncomplete=()=>o.close()}}},i.onerror=o=>a(i.error)})}}Ju.URL_SCHEME="indexeddb://";const VP=t=>ue().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Ju.URL_SCHEME)?Jae(t.slice(Ju.URL_SCHEME.length)):null;_n.registerSaveRouter(VP),_n.registerLoadRouter(VP);function Jae(t){return new Ju(t)}function eie(t){return t.startsWith(Ju.URL_SCHEME)?t.slice(Ju.URL_SCHEME.length):t}class tie{constructor(){this.indexedDB=zP()}async listModels(){return new Promise((e,n)=>{const r=this.indexedDB.open(wT,kT);r.onupgradeneeded=()=>ST(r),r.onsuccess=()=>{const a=r.result,i=a.transaction(Al,"readonly"),o=i.objectStore(Al).getAll();o.onsuccess=()=>{const s={};for(const l of o.result)s[l.modelPath]=l.modelArtifactsInfo;e(s)},o.onerror=s=>(a.close(),n(o.error)),i.oncomplete=()=>a.close()},r.onerror=a=>n(r.error)})}async removeModel(e){return e=eie(e),new Promise((n,r)=>{const a=this.indexedDB.open(wT,kT);a.onupgradeneeded=()=>ST(a),a.onsuccess=()=>{const i=a.result,o=i.transaction(Al,"readwrite"),s=o.objectStore(Al),l=s.get(e);let u;l.onsuccess=()=>{if(l.result==null)return i.close(),r(new Error(`Cannot find model with path '${e}' in IndexedDB.`));{const c=s.delete(e),d=()=>{u=i.transaction(Zu,"readwrite");const p=u.objectStore(Zu).delete(e);p.onsuccess=()=>n(l.result.modelArtifactsInfo),p.onerror=f=>r(l.error)};c.onsuccess=d,c.onerror=p=>(d(),i.close(),r(l.error))}},l.onerror=c=>(i.close(),r(l.error)),o.oncomplete=()=>{u==null?i.close():u.oncomplete=()=>i.close()}},a.onerror=i=>r(a.error)})}}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Ts="/",Ud="tensorflowjs_models",WP="info",nie="model_topology",rie="weight_specs",aie="weight_data",iie="model_metadata";function jP(t){return{info:[Ud,t,WP].join(Ts),topology:[Ud,t,nie].join(Ts),weightSpecs:[Ud,t,rie].join(Ts),weightData:[Ud,t,aie].join(Ts),modelMetadata:[Ud,t,iie].join(Ts)}}function UP(t){for(const e of Object.values(t))window.localStorage.removeItem(e)}function oie(t){const e=t.split(Ts);if(e.length<3)throw new Error(`Invalid key format: ${t}`);return e.slice(1,e.length-1).join(Ts)}function sie(t){return t.startsWith(ec.URL_SCHEME)?t.slice(ec.URL_SCHEME.length):t}class ec{constructor(e){if(!ue().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=jP(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const n=JSON.stringify(e.modelTopology),r=JSON.stringify(e.weightSpecs),a=$m(e);try{this.LS.setItem(this.keys.info,JSON.stringify(a)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,jae(e.weightData));const i={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:e.signature!=null?e.signature:void 0,userDefinedMetadata:e.userDefinedMetadata!=null?e.userDefinedMetadata:void 0,modelInitializer:e.modelInitializer!=null?e.modelInitializer:void 0,trainingConfig:e.trainingConfig!=null?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(i)),{modelArtifactsInfo:a}}catch{throw UP(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${a.modelTopologyBytes}, weightSpecsBytes=${a.weightSpecsBytes}, weightDataBytes=${a.weightDataBytes}.`)}}}async load(){const e=JSON.parse(this.LS.getItem(this.keys.info));if(e==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const n={},r=JSON.parse(this.LS.getItem(this.keys.topology));if(r==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);n.modelTopology=r;const a=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(a==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);n.weightSpecs=a;const i=this.LS.getItem(this.keys.modelMetadata);if(i!=null){const s=JSON.parse(i);n.format=s.format,n.generatedBy=s.generatedBy,n.convertedBy=s.convertedBy,s.signature!=null&&(n.signature=s.signature),s.userDefinedMetadata!=null&&(n.userDefinedMetadata=s.userDefinedMetadata),s.modelInitializer!=null&&(n.modelInitializer=s.modelInitializer),s.trainingConfig!=null&&(n.trainingConfig=s.trainingConfig)}const o=this.LS.getItem(this.keys.weightData);if(o==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return n.weightData=Uae(o),n}}ec.URL_SCHEME="localstorage://";const GP=t=>ue().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(ec.URL_SCHEME)?lie(t.slice(ec.URL_SCHEME.length)):null;_n.registerSaveRouter(GP),_n.registerLoadRouter(GP);function lie(t){return new ec(t)}class uie{constructor(){V(ue().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),V(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const e={},n=Ud+Ts,r=Ts+WP;for(let a=0;a<this.LS.length;++a){const i=this.LS.key(a);if(i.startsWith(n)&&i.endsWith(r)){const o=oie(i);e[o]=JSON.parse(this.LS.getItem(i))}}return e}async removeModel(e){e=sie(e);const n=jP(e);if(this.LS.getItem(n.info)==null)throw new Error(`Cannot find model at path '${e}'`);const r=JSON.parse(this.LS.getItem(n.info));return UP(n),r}}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Gd="://";class ha{constructor(){this.managers={}}static getInstance(){return ha.instance==null&&(ha.instance=new ha),ha.instance}static registerManager(e,n){V(e!=null,()=>"scheme must not be undefined or null."),e.endsWith(Gd)&&(e=e.slice(0,e.indexOf(Gd))),V(e.length>0,()=>"scheme must not be an empty string.");const r=ha.getInstance();V(r.managers[e]==null,()=>`A model store manager is already registered for scheme '${e}'.`),r.managers[e]=n}static getManager(e){const n=ha.getInstance().managers[e];if(n==null)throw new Error(`Cannot find model manager for scheme '${e}'`);return n}static getSchemes(){return Object.keys(ha.getInstance().managers)}}function bx(t){if(t.indexOf(Gd)===-1)throw new Error(`The url string provided does not contain a scheme. Supported schemes are: ${ha.getSchemes().join(",")}`);return{scheme:t.split(Gd)[0],path:t.split(Gd)[1]}}async function HP(t,e,n=!1){V(t!==e,()=>`Old path and new path are the same: '${t}'`);const r=_n.getLoadHandlers(t);V(r.length>0,()=>`Copying failed because no load handler is found for source URL ${t}.`),V(r.length<2,()=>`Copying failed because more than one (${r.length}) load handlers for source URL ${t}.`);const a=r[0],i=_n.getSaveHandlers(e);V(i.length>0,()=>`Copying failed because no save handler is found for destination URL ${e}.`),V(i.length<2,()=>`Copying failed because more than one (${r.length}) save handlers for destination URL ${e}.`);const o=i[0],s=bx(t).scheme,l=bx(t).path,u=s===bx(t).scheme,c=await a.load();n&&u&&await ha.getManager(s).removeModel(l);const d=await o.save(c);return n&&!u&&await ha.getManager(s).removeModel(l),d.modelArtifactsInfo}async function cie(){const t=ha.getSchemes(),e={};for(const n of t){const r=await ha.getManager(n).listModels();for(const a in r){const i=n+Gd+a;e[i]=r[a]}}return e}async function die(t){const e=bx(t);return ha.getManager(e.scheme).removeModel(e.path)}async function pie(t,e){return HP(t,e,!1)}async function hie(t,e){return HP(t,e,!0)}/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class fie{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,n){return fetch(e,n)}now(){return performance.now()}encode(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${n}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,n){return new TextDecoder(n).decode(e)}setTimeoutCustom(e,n){if(!window||!ue().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(e,n);return}this.functionRefs.push(e),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},n),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",r=>{if(r.source===window&&r.data.name===this.messageName){r.stopPropagation();const a=this.functionRefs[r.data.index];a(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}}if(ue().get("IS_BROWSER")){ue().setPlatform("browser",new fie);try{ha.registerManager(ec.URL_SCHEME,new uie)}catch{}try{ha.registerManager(Ju.URL_SCHEME,new tie)}catch{}}/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const mie={importFetch:()=>require("node-fetch")};let CT;class gie{constructor(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}fetch(e,n){return ue().global.fetch!=null?ue().global.fetch(e,n):(CT==null&&(CT=mie.importFetch()),CT(e,n))}now(){const e=process.hrtime();return e[0]*1e3+e[1]/1e6}encode(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${n}`);return this.textEncoder.encode(e)}decode(e,n){return e.length===0?"":new this.util.TextDecoder(n).decode(e)}}ue().get("IS_NODE")&&!ue().get("IS_BROWSER")&&ue().setPlatform("node",new gie);/**
* @license
* Copyright 2020 Google Inc. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function pt(t,e="float32",n){return e=e||"float32",F3(t),new rr(t,e,n)}/**
* @license
* Copyright 2020 Google Inc. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function yie(t,e){const n=z(t,"x","cast");if(!rP(e))throw new Error(`Failed to cast to unknown dtype ${e}`);if(e==="string"&&n.dtype!=="string"||e!=="string"&&n.dtype==="string")throw new Error("Only strings can be casted to strings");const r={x:n},a={dtype:e};return te.runKernel(Nf,r,a)}const wn=ee({cast_:yie});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function bie(t){const e={x:z(t,"x","clone","string_or_numeric")};return te.runKernel(zf,e)}const Is=ee({clone_:bie});/**
* @license
* Copyright 2020 Google Inc. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function NT(t,e=!1){console.log(t.toString(e))}/**
* @license
* Copyright 2020 Google Inc. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/$P();const vie={buffer:pt,cast:wn,clone:Is,print:NT};_ae(vie);/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const xie="model",wie=".json",kie=".weights.bin";function qP(t){return new Promise(e=>setTimeout(e)).then(t)}class xc{constructor(e){if(!ue().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(xc.URL_SCHEME)&&(e=e.slice(xc.URL_SCHEME.length)),(e==null||e.length===0)&&(e=xie),this.modelJsonFileName=e+wie,this.weightDataFileName=e+kie}async save(e){if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");const n=window.URL.createObjectURL(new Blob([e.weightData],{type:"application/octet-stream"}));if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const r=[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}],a=LP(e,r),i=window.URL.createObjectURL(new Blob([JSON.stringify(a)],{type:"application/json"})),o=this.modelJsonAnchor==null?document.createElement("a"):this.modelJsonAnchor;if(o.download=this.modelJsonFileName,o.href=i,await qP(()=>o.dispatchEvent(new MouseEvent("click"))),e.weightData!=null){const s=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor;s.download=this.weightDataFileName,s.href=n,await qP(()=>s.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:$m(e)}}}}xc.URL_SCHEME="downloads://";class Sie{constructor(e){if(e==null||e.length<1)throw new Error(`When calling browserFiles, at least 1 file is required, but received ${e}`);this.jsonFile=e[0],this.weightsFiles=e.slice(1)}async load(){return new Promise((e,n)=>{const r=new FileReader;r.onload=a=>{const i=JSON.parse(a.target.result),o=i.modelTopology;if(o==null){n(new Error(`modelTopology field is missing from file ${this.jsonFile.name}`));return}if(i.weightsManifest==null){n(new Error(`weightManifest field is missing from file ${this.jsonFile.name}`));return}if(this.weightsFiles.length===0){e({modelTopology:o});return}const s=xT(i,l=>this.loadWeights(l));e(s)},r.onerror=a=>n(`Failed to read model topology and weights manifest JSON from file '${this.jsonFile.name}'. BrowserFiles supports loading Keras-style tf.Model artifacts only.`),r.readAsText(this.jsonFile)})}loadWeights(e){const n=[],r=[];for(const o of e)n.push(...o.weights),r.push(...o.paths);const a=this.checkManifestAndWeightFiles(e),i=r.map(o=>this.loadWeightsFile(o,a[o]));return Promise.all(i).then(o=>[n,vT(o)])}loadWeightsFile(e,n){return new Promise((r,a)=>{const i=new FileReader;i.onload=o=>{const s=o.target.result;r(s)},i.onerror=o=>a(`Failed to weights data from file of path '${e}'.`),i.readAsArrayBuffer(n)})}checkManifestAndWeightFiles(e){const n=[],r=this.weightsFiles.map(i=>DP(i.name)),a={};for(const i of e)i.paths.forEach(o=>{const s=DP(o);if(n.indexOf(s)!==-1)throw new Error(`Duplicate file basename found in weights manifest: '${s}'`);if(n.push(s),r.indexOf(s)===-1)throw new Error(`Weight file with basename '${s}' is not provided.`);a[o]=this.weightsFiles[r.indexOf(s)]});if(n.length!==this.weightsFiles.length)throw new Error(`Mismatch in the number of files in weights manifest (${n.length}) and the number of weight files provided (${this.weightsFiles.length}).`);return a}}const Cie=t=>ue().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(xc.URL_SCHEME)?Nie(t.slice(xc.URL_SCHEME.length)):null;_n.registerSaveRouter(Cie);function Nie(t="model"){return new xc(t)}function Tie(t){return new Sie(t)}/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function KP(t,e,n,r){o(t),n=n??0,r=r??1,s(n,r);let a=0;const i=l=>(l.then(u=>{const c=n+ ++a/t.length*(r-n);return e(c),u}),l);function o(l){V(l!=null&&Array.isArray(l)&&l.length>0,()=>"promises must be a none empty array")}function s(l,u){V(l>=0&&l<=1,()=>`Progress fraction must be in range [0, 1], but got startFraction ${l}`),V(u>=0&&u<=1,()=>`Progress fraction must be in range [0, 1], but got endFraction ${u}`),V(u>=l,()=>`startFraction must be no more than endFraction, but got startFraction ${l} and endFraction ${u}`)}return Promise.all(t.map(i))}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/async function XP(t,e){e==null&&(e={});const n=e.fetchFunc==null?ue().platform.fetch:e.fetchFunc,r=t.map(u=>n(u,e.requestInit,{isBinary:!0})),a=0,i=.5,o=(e.onProgress==null?await Promise.all(r):await KP(r,e.onProgress,a,i)).map(u=>u.arrayBuffer());return e.onProgress==null?await Promise.all(o):await KP(o,e.onProgress,.5,1)}async function Iie(t,e="",n,r){return YP(a=>XP(a,{requestInit:r}))(t,e,n)}function YP(t){return async(e,n="",r)=>{const a=e.map(()=>!1),i={},o=r!=null?r.map(()=>!1):[],s=[];if(e.forEach((f,g)=>{let y=0;f.weights.forEach(x=>{const b="quantization"in x?x.quantization.dtype:x.dtype,v=yT[b]*me(x.shape),w=()=>{a[g]=!0,i[g]==null&&(i[g]=[]),i[g].push({manifestEntry:x,groupOffset:y,sizeBytes:v})};r!=null?r.forEach((S,C)=>{S===x.name&&(w(),o[C]=!0)}):w(),s.push(x.name),y+=v})}),!o.every(f=>f)){const f=r.filter((g,y)=>!o[y]);throw new Error(`Could not find weights in manifest with names: ${f.join(", ")}. 
Manifest JSON has weights with names: ${s.join(", ")}.`)}const l=a.reduce((f,g,y)=>(g&&f.push(y),f),[]),u=[];l.forEach(f=>{e[f].paths.forEach(g=>{const y=n+(n.endsWith("/")?"":"/")+g;u.push(y)})});const c=await t(u),d={};let p=0;return l.forEach(f=>{const g=e[f].paths.length;let y=0;for(let w=0;w<g;w++)y+=c[p+w].byteLength;const x=new ArrayBuffer(y),b=new Uint8Array(x);let v=0;for(let w=0;w<g;w++){const S=new Uint8Array(c[p+w]);b.set(S,v),v+=S.byteLength}i[f].forEach(w=>{const S=x.slice(w.groupOffset,w.groupOffset+w.sizeBytes),C=AP(S,[w.manifestEntry]);for(const I in C)d[I]=C[I]}),p+=g}),d}}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Eie="application/octet-stream",_ie="application/json";class TT{constructor(e,n){if(this.DEFAULT_METHOD="POST",n==null&&(n={}),this.weightPathPrefix=n.weightPathPrefix,this.onProgress=n.onProgress,this.weightUrlConverter=n.weightUrlConverter,n.fetchFunc!=null?(V(typeof n.fetchFunc=="function",()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=n.fetchFunc):this.fetch=ue().platform.fetch,V(e!=null&&e.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(e)&&V(e.length===2,()=>`URL paths for http must have a length of 2, (actual length is ${e.length}).`),this.path=e,n.requestInit!=null&&n.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=n.requestInit||{}}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const n=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);n.body=new FormData;const r=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],a=LP(e,r);n.body.append("model.json",new Blob([JSON.stringify(a)],{type:_ie}),"model.json"),e.weightData!=null&&n.body.append("model.weights.bin",new Blob([e.weightData],{type:Eie}),"model.weights.bin");const i=await this.fetch(this.path,n);if(i.ok)return{modelArtifactsInfo:$m(e),responses:[i]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${i.status}.`)}async load(){const e=await this.fetch(this.path,this.requestInit);if(!e.ok)throw new Error(`Request to ${this.path} failed with status code ${e.status}. Please verify this URL points to the model JSON of the model to load.`);let n;try{n=await e.json()}catch{let i=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?i+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":i+=" Please make sure the server is serving valid JSON for this request.",new Error(i)}const r=n.modelTopology,a=n.weightsManifest;if(r==null&&a==null)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);return xT(n,i=>this.loadWeights(i))}async loadWeights(e){const n=Array.isArray(this.path)?this.path[1]:this.path,[r,a]=Oie(n),i=this.weightPathPrefix||r,o=BP(e),s=[],l=[];for(const c of e)for(const d of c.paths)this.weightUrlConverter!=null?l.push(this.weightUrlConverter(d)):s.push(i+d+a);this.weightUrlConverter&&s.push(...await Promise.all(l));const u=await XP(s,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress});return[o,vT(u)]}}TT.URL_SCHEME_REGEX=/^https?:\/\//;function Oie(t){const e=t.lastIndexOf("/"),n=t.lastIndexOf("?"),r=t.substring(0,e),a=n>e?t.substring(n):"";return[r+"/",a]}function IT(t){return t.match(TT.URL_SCHEME_REGEX)!=null}const QP=(t,e)=>{if(typeof fetch>"u"&&(e==null||e.fetchFunc==null))return null;{let n=!0;if(Array.isArray(t)?n=t.every(r=>IT(r)):n=IT(t),n)return ET(t,e)}return null};_n.registerSaveRouter(QP),_n.registerLoadRouter(QP);function ET(t,e){return new TT(t,e)}function $ie(t,e){return ET(t,e)}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class _T{constructor(e){this.modelArtifacts=e}load(){return this.modelArtifacts}}class ZP{constructor(e){this.saveHandler=e}save(e){return this.saveHandler(e)}}class Rie{constructor(e){e.load&&(this.load=()=>Promise.resolve(e.load())),e.save&&(this.save=n=>Promise.resolve(e.save(n)))}}function Mie(t,e,n,r){const a=arguments;return new Rie(JP(...a))}function JP(t,e,n,r){return arguments.length===1?t.modelTopology!=null||t.weightSpecs!=null?new _T(t):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new _T({modelTopology:t})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new _T({modelTopology:t,weightSpecs:e,weightData:n,trainingConfig:r}))}function Aie(t){return new ZP(t)}function Pie(t){return new ZP(t)}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const OT=Object.freeze(Object.defineProperty({__proto__:null,browserFiles:Tie,browserHTTPRequest:$ie,concatenateArrayBuffers:vT,copyModel:pie,decodeWeights:AP,encodeWeights:Vae,fromMemory:Mie,fromMemorySync:JP,getLoadHandlers:Zae,getModelArtifactsForJSON:xT,getModelArtifactsForJSONSync:FP,getModelArtifactsInfoForJSON:$m,getSaveHandlers:Qae,getWeightSpecs:BP,http:ET,isHTTPScheme:IT,listModels:cie,loadWeights:Iie,moveModel:hie,registerLoadRouter:Yae,registerSaveRouter:Xae,removeModel:die,weightsLoaderFactory:YP,withSaveHandler:Aie,withSaveHandlerSync:Pie},Symbol.toStringTag,{value:"Module"}));/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Die(t,e,n=!1,r=!1){let a=z(t,"a","matMul"),i=z(e,"b","matMul");[a,i]=En(a,i);const o={a,b:i},s={transposeA:n,transposeB:r};return te.runKernel(Rb,o,s)}const Gt=ee({matMul_:Die});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Lie(t,e,n=1,r=0,a="int32"){if(e<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${e}`);const i={indices:z(t,"indices","oneHot","int32")},o={dtype:a,depth:e,onValue:n,offValue:r};return te.runKernel(Tv,i,o)}const vx=ee({oneHot_:Lie});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Fie(){ue().set("PROD",!0)}function Bie(){ue().set("DEBUG",!0)}function zie(){ue().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}function Vie(t){ue().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(t+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function Wie(){te.disposeVariables()}function Es(){return te}function jie(){return te.memory()}function Uie(t){return te.profile(t)}function Ot(t,e){return te.tidy(t,e)}function Wr(t){dT(t).forEach(e=>e.dispose())}function Mo(t){return te.keep(t)}function Gie(t){return te.time(t)}function Hie(t){return te.setBackend(t)}function qie(){return te.ready()}function Kie(){return te.backendName}function Xie(t){te.removeBackend(t)}function Yie(t){return te.findBackend(t)}function Qie(t){return te.findBackendFactory(t)}function $T(t,e,n=1){return te.registerBackend(t,e,n)}function Zie(){return te.backend}function Jie(t,e){ue().setPlatform(t,e)}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function eoe(t){const e={input:z(t,"input","imag")};return te.runKernel(uv,e)}const Rm=ee({imag_:eoe});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function toe(t){const e={x:z(t,"x","neg")};return te.runKernel(wv,e)}const Ao=ee({neg_:toe});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function noe(t){const e={input:z(t,"input","real")};return te.runKernel(Av,e)}const Hd=ee({real_:noe});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function roe(t,e,n){const r=z(t,"x","transpose");if(e==null&&(e=r.shape.map((o,s)=>s).reverse()),V(r.rank===e.length,()=>`Error in transpose: rank of input ${r.rank} must match length of perm ${e}.`),e.forEach(o=>{V(o>=0&&o<r.rank,()=>`All entries in 'perm' must be between 0 and ${r.rank-1} but got ${e}`)}),r.rank<=1)return r.clone();const a={x:r},i={perm:e};return r.dtype==="complex64"?Ot(()=>{let o=Hd(r),s=Rm(r);return o=te.runKernel(Bd,{x:o},i),s=te.runKernel(Bd,{x:s},i),n&&(s=Ao(s)),Ns(o,s)}):te.runKernel(Bd,a,i)}const Mm=ee({transpose_:roe});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function aoe(t,e,n){const r=z(t,"labels","confusionMatrix"),a=z(e,"predictions","confusionMatrix");V(n==null||n>0&&Number.isInteger(n),()=>`If provided, numClasses must be a positive integer, but got ${n}`),V(r.rank===1,()=>`Expected the rank of labels to be 1, but got ${r.rank}`),V(a.rank===1,()=>`Expected the rank of predictions to be 1, but got ${a.rank}`),V(r.shape[0]===a.shape[0],()=>`Mismatch in the number of examples: ${r.shape[0]} vs. ${a.shape[0]}. Labels and predictions should have the same number of elements.`),V(n>0&&Number.isInteger(n),()=>`numClasses is required to be a positive integer, but got ${n}`);const i=vx(wn(r,"int32"),n),o=vx(wn(a,"int32"),n),s=Mm(i),l=Gt(s,o);return wn(l,"int32")}const ioe=ee({confusionMatrix_:aoe});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const ooe=Object.freeze(Object.defineProperty({__proto__:null,confusionMatrix:ioe},Symbol.toStringTag,{value:"Module"}));/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function tc(t,e){const n=t.length,r=[];for(let a=0;a<n;a++){const i=n-1-a,o=t[i]||1;(e[e.length-1-a]||1)>1&&o===1&&r.unshift(i)}return r}function RT(t,e){const n=[];for(let r=0;r<e.length;r++){const a=t[t.length-r-1],i=e.length-r-1,o=e[i];(a==null||a===1&&o>1)&&n.unshift(i)}return n}function Nt(t,e){const n=[],r=Math.max(t.length,e.length);for(let a=0;a<r;a++){let i=t[t.length-a-1];i==null&&(i=1);let o=e[e.length-a-1];if(o==null&&(o=1),i===1)n.unshift(o);else if(o===1)n.unshift(i);else if(i!==o){const s=`Operands could not be broadcast together with shapes ${t} and ${e}.`;throw Error(s)}else n.unshift(i)}return n}const soe=Object.freeze(Object.defineProperty({__proto__:null,assertAndGetBroadcastShape:Nt,getBroadcastDims:tc,getReductionAxes:RT},Symbol.toStringTag,{value:"Module"}));/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function MT(t,e,n){if(ju(t),e!=null&&e.length!==3)throw new Error("tensor3d() requires shape to have three numbers");const r=Ro(t,n);if(r.length!==3&&r.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return Ml(t,e,r,n)}/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/let nc;function e8(t,e=3){if(e>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(t==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let n=!1,r=!1,a=!1,i=!1,o=!1,s=!1;if(t.data instanceof Uint8Array)n=!0;else if(typeof ImageData<"u"&&t instanceof ImageData)r=!0;else if(typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement)a=!0;else if(typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement)i=!0;else if(t.getContext!=null)o=!0;else if(typeof ImageBitmap<"u"&&t instanceof ImageBitmap)s=!0;else throw new Error(`pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was ${t.constructor.name}`);if(cx(lx,te.backendName)!=null){const p={pixels:t},f={numChannels:e};return te.runKernel(lx,p,f)}const[l,u]=a?[t.videoWidth,t.videoHeight]:[t.width,t.height];let c;if(o)c=t.getContext("2d").getImageData(0,0,l,u).data;else if(r||n)c=t.data;else if(i||a||s){if(nc==null)if(typeof document>"u")if(typeof OffscreenCanvas<"u"&&typeof OffscreenCanvasRenderingContext2D<"u")nc=new OffscreenCanvas(1,1).getContext("2d");else throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");else nc=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});nc.canvas.width=l,nc.canvas.height=u,nc.drawImage(t,0,0,l,u),c=nc.getImageData(0,0,l,u).data}let d;if(e===4)d=new Int32Array(c);else{const p=l*u;d=new Int32Array(p*e);for(let f=0;f<p;f++)for(let g=0;g<e;++g)d[f*e+g]=c[f*4+g]}return MT(d,[u,l,e],"int32")}function loe(t){return t!=null&&t.data instanceof Uint8Array}function uoe(){return typeof window<"u"&&typeof ImageBitmap<"u"&&window.hasOwnProperty("createImageBitmap")}function coe(t){return t!=null&&t.width!==0&&t.height!==0}function doe(t){return uoe()&&!(t instanceof ImageBitmap)&&coe(t)&&!loe(t)}async function poe(t,e=3){let n=null;if(ue().getBool("WRAP_TO_IMAGEBITMAP")&&doe(t)){let r;try{r=await createImageBitmap(t,{premultiplyAlpha:"none"})}catch{r=null}r!=null&&r.width===t.width&&r.height===t.height?n=r:n=t}else n=t;return e8(n,e)}async function t8(t,e){let n=z(t,"img","toPixels");if(!(t instanceof In)){const u=n;n=wn(u,"int32"),u.dispose()}if(n.rank!==2&&n.rank!==3)throw new Error(`toPixels only supports rank 2 or 3 tensors, got rank ${n.rank}.`);const[r,a]=n.shape.slice(0,2),i=n.rank===2?1:n.shape[2];if(i>4||i===2)throw new Error(`toPixels only supports depth of size 1, 3 or 4 but got ${i}`);if(n.dtype!=="float32"&&n.dtype!=="int32")throw new Error(`Unsupported type for toPixels: ${n.dtype}. Please use float32 or int32 tensors.`);const o=await n.data(),s=n.dtype==="float32"?255:1,l=new Uint8ClampedArray(a*r*4);for(let u=0;u<r*a;++u){const c=[0,0,0,255];for(let p=0;p<i;p++){const f=o[u*i+p];if(n.dtype==="float32"){if(f<0||f>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${f}.`)}else if(n.dtype==="int32"&&(f<0||f>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${f}.`);i===1?(c[0]=f*s,c[1]=f*s,c[2]=f*s):c[p]=f*s}const d=u*4;l[d+0]=Math.round(c[0]),l[d+1]=Math.round(c[1]),l[d+2]=Math.round(c[2]),l[d+3]=Math.round(c[3])}if(e!=null){e.width=a,e.height=r;const u=e.getContext("2d"),c=new ImageData(l,a,r);u.putImageData(c,0,0)}return n!==t&&n.dispose(),l}const n8=ee({fromPixels_:e8}),hoe=Object.freeze(Object.defineProperty({__proto__:null,fromPixels:n8,fromPixelsAsync:poe,toPixels:t8},Symbol.toStringTag,{value:"Module"}));function xx(t,e){const n=t.shape.length,r=e.shape.length;if(n<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${n}.`);if(r<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${r}.`);if(e.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.shape[r-1]>n)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${e.shape[r-1]} vs. ${n}`);if(me(t.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${t.shape}.`);const a=e.shape,i=a[a.length-1];let o=1;for(let d=0;d<a.length-1;++d)o*=a[d];const s=t.shape,l=a.slice();l.pop();let u=1;for(let d=i;d<n;++d)u*=s[d],l.push(s[d]);const c=[...qe(t.shape).map(d=>d/u),1].slice(0,i);return[l,o,u,c]}const foe=Object.freeze(Object.defineProperty({__proto__:null,prepareAndValidate:xx},Symbol.toStringTag,{value:"Module"}));function AT(t,e,n){const r=e.rank>1?e.shape[e.rank-1]:1,a=e.rank>1?e.rank-1:1,i=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${n.shape}, indices.shape: ${e.shape}, shape: ${t}, sliceDim: ${r}, and batchDim: ${a}.`;if(n.rank<a)throw new Error(i+` update.rank < ${a}. `);if(t.length<r+(n.rank-a))throw new Error(i+` Output shape length < ${r+(n.rank-a)}`);if(n.rank!==a+t.length-r)throw new Error(i+` update.rank != ${a+t.length-r}`);for(let o=0;o<a;++o)if(n.shape[o]!==e.shape[o])throw new Error(i+` updates.shape[${o}] (${n.shape[o]}) != indices.shape[${o}] (${e.shape[o]}).`);for(let o=0;o<n.rank-a;++o)if(n.shape[o+a]!==t[o+r])throw new Error(i+` updates.shape[${o+a}] (${n.shape[o+a]}) != shape[${o+a}] (${t[o+a]})`)}function PT(t,e,n){if(e.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${e.rank}.`);if(t.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${t.rank}.`);if(e.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${e.dtype}`);if(n.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${n}`);if(n.length===0){if(e.size===0)throw new Error(`Indices specified for empty output. indices shape: ${e.shape}`);if(t.size===0)throw new Error(`Updates specified for empty output. updates shape: ${t.shape}`)}AT(n,e,t)}function qd(t,e,n){const r=e.shape.length,a=r>1?e.shape[r-1]:1,i=n.length;let o=1;for(let d=a;d<i;++d)o*=n[d];const s=a<1?1:a,l=me(e.shape)/s,u=[...qe(n.slice(0,a)),1],c=me(n);return{sliceRank:a,numUpdates:l,sliceSize:o,strides:u,outputSize:c}}const moe=Object.freeze(Object.defineProperty({__proto__:null,calculateShapes:qd,validateInput:PT,validateUpdateShape:AT},Symbol.toStringTag,{value:"Module"}));/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const DT=-2,goe=-1;function LT(t,e,n){const r=t.shape.length;V(r===e.length,()=>`Error in slice${r}D: Length of begin ${e} must match the rank of the array (${r}).`),V(r===n.length,()=>`Error in slice${r}D: Length of size ${n} must match the rank of the array (${r}).`);for(let a=0;a<r;++a)V(e[a]+n[a]<=t.shape[a],()=>`Error in slice${r}D: begin[${a}] + size[${a}] (${e[a]+n[a]}) would overflow input.shape[${a}] (${t.shape[a]})`)}function yoe(t){const e=[];let n=0;for(;t>0;)t&1&&e.push(n),t/=2,n++;return e}function FT(t,e,n){const r=[];for(let a=0;a<t.length;a++)r[a]=Math.ceil((e[a]-t[a])/n[a]);return r}function r8(t,e,n,r){const a=[...t];for(let i=a.length;i<r.length;i++)a.push(1);for(let i=0;i<n;i++)i===0?a[e]=1:(a.splice(e,0,1),a.pop());return a}function a8(t,e,n){return n<=t?n:n-(e-1)}function i8(t,e){const n=[];for(let r=0;r<t;r++)n.push(e+r);return n}function boe(t,e,n,r,a,i,o,s,l){const u=t.length;let c=new Array(u),d=new Array(u),p=new Array(u);if(e.length&&n>0){const f=e[0],g=n+1;c=o8(o,f,g,r,t),d=s8(s,f,g,a,t),p=r8(i,f,g,t)}else for(let f=0;f<u;f++)c[f]=u8(o,r,i,t,f,l),d[f]=c8(s,a,i,t,f,l),p[f]=l8(i,f,l);return{begin:c,end:d,strides:p}}function o8(t,e,n,r,a){const i=[...a],o=i8(n,e);for(let s=0;s<i.length;s++)if(o.indexOf(s)>-1)i[s]=0;else{const l=a8(e,n,s);let u=r[l];t&1<<l&&(u=0),i[s]=u}return i}function s8(t,e,n,r,a){const i=[...a],o=i8(n,e);for(let s=0;s<i.length;s++)if(o.indexOf(s)>-1)i[s]=Number.MAX_SAFE_INTEGER;else{const l=a8(e,n,s);let u=r[l];t&1<<l&&(u=Number.MAX_SAFE_INTEGER),i[s]=u}for(let s=0;s<i.length;s++){const l=a[s];i[s]<0&&(i[s]+=l),i[s]=_l(0,i[s],a[s])}return i}function l8(t,e,n){let r=t[e];return(n&1<<e||r==null)&&(r=1),r}function u8(t,e,n,r,a,i){let o=e[a];const s=n[a]||1;(t&1<<a||i&1<<a||o==null)&&(s>0?o=Number.MIN_SAFE_INTEGER:o=Number.MAX_SAFE_INTEGER);const l=r[a];return o<0&&(o+=l),o=_l(0,o,l-1),o}function c8(t,e,n,r,a,i){let o=e[a];const s=n[a]||1;(t&1<<a||i&1<<a||o==null)&&(s>0?o=Number.MAX_SAFE_INTEGER:o=Number.MIN_SAFE_INTEGER);const l=r[a];return o<0&&(o+=l),s>0?o=_l(0,o,l):o=_l(-1,o,l-1),o}function BT(t,e,n){let r=n.length;for(let a=0;a<n.length;a++)if(n[a]>1){r=a;break}for(let a=r+1;a<n.length;a++)if(e[a]>0||n[a]!==t[a])return!1;return!0}function zT(t,e){let n=t.length>0?t[t.length-1]:1;for(let r=0;r<t.length-1;r++)n+=t[r]*e[r];return n}function VT(t,e,n){let r;const a=t.shape.length;typeof e=="number"?r=[e,...new Array(a-1).fill(0)]:e.length<a?r=e.concat(new Array(a-e.length).fill(0)):r=e.slice(),r.forEach(o=>{V(o!==-1,()=>"slice() does not support negative begin indexing.")});let i;return n==null?i=new Array(a).fill(-1):typeof n=="number"?i=[n,...new Array(a-1).fill(-1)]:n.length<a?i=n.concat(new Array(a-n.length).fill(-1)):i=n,i=i.map((o,s)=>o>=0?o:(V(o===-1,()=>`Negative size values should be exactly -1 but got ${o} for the slice() size at index ${s}.`),t.shape[s]-r[s])),[r,i]}function WT(t,e,n,r,a,i,o,s,l){let u;if(r==null?(u=new Array(e.length),u.fill(1)):u=r,o!=null&&o&o-1)throw new Error("Multiple ellipses in slice is not allowed.");let c=!1;const d={dims:u.length,numAddAxisAfterEllipsis:0,begin:e.slice(),end:n.slice(),strides:u.slice(),beginMask:a,endMask:i,ellipsisMask:o,newAxisMask:s,shrinkAxisMask:l};for(let v=0;v<d.dims;v++)c&&1<<v&s&&d.numAddAxisAfterEllipsis++,1<<v&o&&(c=!0);c||(d.ellipsisMask|=1<<d.dims,d.dims++);const p={dims:t.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};voe(d,p);let f=!0,g=!0,y=!0;const x=[],b=[];for(let v=0;v<t.length;++v){if(p.strides[v]===0)throw Error(`strides[${v}] must be non-zero`);const w=!!(p.shrinkAxisMask&1<<v),S=t[v];if(S===-1){x.push(w?1:-1);continue}const C=[p.beginMask&1<<v,p.endMask&1<<v],I=[p.strides[v]>0?0:-1,p.strides[v]>0?S:S-1];if(w&&p.strides[v]<=0)throw Error("only stride 1 allowed on non-range indexing.");y=y&&p.strides[v]===1;const _=!!(p.beginMask&1<<v&&p.endMask&1<<v);if(p.beginValid&&p.endValid){if(w){const L=p.begin[v]<0?S+p.begin[v]:p.begin[v];if(p.begin[v]=L,p.end[v]=p.begin[v]+1,L<0||L>=S)throw Error(`slice index ${p.begin[v]} of dimension ${v} out of bounds.`)}else p.begin[v]=d8(p.begin[v],0,p.strides[v],S,C,I),p.end[v]=d8(p.end[v],1,p.strides[v],S,C,I);const M=p.strides[v]===1&&p.begin[v]===0&&p.end[v]===S;f=f&&M,g=g&&(v===0&&p.strides[v]===1||M)}else f=f&&p.strides[v]===1&&_,g=g&&(v===0&&p.strides[v]===1||_);let E,A=!1;if(p.beginValid&&p.endValid?(E=p.end[v]-p.begin[v],A=!0):w?(E=1,A=!0):_&&S>=0&&(p.strides[v]<0?E=-S:E=S,A=!0),A){let M;E===0||E<0!=p.strides[v]<0?M=0:M=Math.trunc(E/p.strides[v])+(E%p.strides[v]!==0?1:0),x.push(M)}else x.push(-1)}for(let v=0;v<p.finalShapeGatherIndices.length;++v){const w=p.finalShapeGatherIndices[v];w>=0?b.push(x[w]):w===DT&&b.push(1)}return{finalShapeSparse:b.filter((v,w)=>p.finalShapeGatherIndices[w]!==DT),finalShape:b,isIdentity:f,sliceDim0:g,isSimpleSlice:y,begin:p.begin,end:p.end,strides:p.strides}}function voe(t,e){e.beginMask=0,e.endMask=0,e.shrinkAxisMask=0;let n=0;e.beginValid=t.begin!=null,e.endValid=t.end!=null,e.begin=new Array(e.dims),e.end=new Array(e.dims),e.strides=new Array(e.dims),e.finalShapeGatherIndices=[],e.finalShapeGatherIndicesSparse=[],e.inputShapeGatherIndicesSparse=new Array(e.dims);for(let r=0;r<t.dims;r++)if(1<<r&t.ellipsisMask){const a=Math.min(e.dims-(t.dims-r)+1+t.numAddAxisAfterEllipsis,e.dims);for(;n<a;n++)e.begin[n]=0,e.end[n]=0,e.strides[n]=1,e.beginMask|=1<<n,e.endMask|=1<<n,e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(-1),e.inputShapeGatherIndicesSparse[n]=r}else if(1<<r&t.newAxisMask)e.finalShapeGatherIndices.push(DT),e.finalShapeGatherIndicesSparse.push(-1);else{if(n===e.begin.length)throw Error(`Index out of range using input dim ${n}; input has only ${e.dims} dims, ${e.begin.length}.`);t.begin!=null&&(e.begin[n]=t.begin[r]),t.end!=null&&(e.end[n]=t.end[r]),e.strides[n]=t.strides[r],t.beginMask&1<<r&&(e.beginMask|=1<<n),t.endMask&1<<r&&(e.endMask|=1<<n),t.shrinkAxisMask&1<<r?(e.finalShapeGatherIndices.push(goe),e.finalShapeGatherIndicesSparse.push(-1),e.shrinkAxisMask|=1<<n):(e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(r)),e.inputShapeGatherIndicesSparse[n]=r,n++}}function d8(t,e,n,r,a,i){if(a[e])return n>0?i[e]:i[e+1&1];{const o=t<0?r+t:t;return o<i[0]?i[0]:o>i[1]?i[1]:o}}const p8=Object.freeze(Object.defineProperty({__proto__:null,assertParamsValid:LT,computeFlatOffset:zT,computeOutShape:FT,getNormalizedAxes:boe,isSliceContinous:BT,maskToAxes:yoe,parseSliceParams:VT,sliceInfo:WT,startForAxis:u8,startIndicesWithElidedDims:o8,stopForAxis:c8,stopIndicesWithElidedDims:s8,stridesForAxis:l8,stridesWithElidedDims:r8},Symbol.toStringTag,{value:"Module"}));/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class h8{getClassName(){return this.constructor.className}static fromConfig(e,n){return new e(n)}}class Jl{constructor(){this.classNameMap={}}static getMap(){return Jl.instance==null&&(Jl.instance=new Jl),Jl.instance}static register(e){Jl.getMap().classNameMap[e.className]=[e,e.fromConfig]}}function Pl(t){V(t.className!=null,()=>"Class being registered does not have the static className property defined."),V(typeof t.className=="string",()=>"className is required to be a string, but got type "+typeof t.className),V(t.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),Jl.register(t)}const xoe=Object.freeze(Object.defineProperty({__proto__:null,Serializable:h8,SerializationMap:Jl,registerClass:Pl},Symbol.toStringTag,{value:"Module"}));/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const woe=.001,f8=.1;function koe(t,e,n){return n==null&&(n=jT()),UT(t,e,(r,a)=>GT(r,a,n))}function jT(){return te.backend.floatPrecision()===32?woe:f8}function UT(t,e,n){let r=!0;if((Vr(t)||Vr(e))&&(r=!1),Vr(t)&&Vr(e)&&(r=!0),r){const o=t.constructor.name,s=e.constructor.name;if(o!==s)throw new Error(`Arrays are of different type. Actual: ${o}. Expected: ${s}`)}if(Array.isArray(t)&&Array.isArray(e)){const o=Ro(t),s=Ro(e);if(!tn(o,s))throw new Error(`Arrays have different shapes. Actual: [${o}]. Expected: [${s}]`)}const a=Vr(t)?t:ws(t),i=Vr(e)?e:ws(e);if(a.length!==i.length)throw new Error(`Arrays have different lengths actual: ${a.length} vs expected: ${i.length}.
Actual:   ${a}.
Expected: ${i}.`);for(let o=0;o<i.length;++o){const s=a[o],l=i[o];if(!n(s,l))throw new Error(`Arrays differ: actual[${o}] = ${s}, expected[${o}] = ${l}.
Actual:   ${a}.
Expected: ${i}.`)}typeof expect<"u"&&expect().nothing()}function Soe(t,e){t().then(()=>e.fail(),()=>e()),typeof expect<"u"&&expect().nothing()}function Coe(t,e){const n=typeof e=="string"||typeof e=="number"||typeof e=="boolean"?[e]:e;return Oo(t)||Oo(t[0])||Oo(e)||Oo(e[0])?UT(t,n,(r,a)=>r==a):UT(t,e,(r,a)=>GT(r,a,0))}function Noe(t,e,n){if(n==null&&(n=jT()),!GT(t,e,n))throw new Error(`Numbers differ: actual === ${t}, expected === ${e}`);typeof expect<"u"&&expect().nothing()}function GT(t,e,n){return!isFinite(t)&&!isFinite(e)?!0:!(isNaN(t)||isNaN(e)||Math.abs(t-e)>n)}function Toe(t,e,n){for(let r=0;r<t.length;r++)if(t[r]<e||t[r]>n)throw new Error(`Value out of range:${t[r]} low: ${e}, high: ${n}`)}function Ioe(t,e){const n=new Float32Array(t),r=new Float32Array(e);if(n.length!==r.length)throw new Error(`Expected ArrayBuffer to be of length ${r.length}, but it was ${n.length}`);for(let a=0;a<r.length;a++)if(n[a]!==r[a])throw new Error(`Expected ArrayBuffer value at ${a} to be ${r[a]} but got ${n[a]} instead`)}function m8(t){for(let e=0;e<t.length;e++){const n=t[e];Array.isArray(n)?m8(n):t[e]=$o(n)}return t}function Eoe(t){const e=document.createElement("video");return"playsInline"in e&&(e.playsInline=!0),e.muted=!0,e.loop=!0,e.style.position="fixed",e.style.left="0px",e.style.top="0px",e.preload="auto",e.appendChild(t),new Promise(n=>{e.addEventListener("loadeddata",r=>n(e)),e.load()})}async function _oe(t){await t.play(),"requestVideoFrameCallback"in t&&await new Promise(e=>{t.requestVideoFrameCallback(e)})}const Ooe=Object.freeze(Object.defineProperty({__proto__:null,TEST_EPSILON_FLOAT16:f8,createVideoElement:Eoe,encodeStrings:m8,expectArrayBuffersEqual:Ioe,expectArraysClose:koe,expectArraysEqual:Coe,expectNumbersClose:Noe,expectPromiseToFail:Soe,expectValuesInRange:Toe,play:_oe,testEpsilon:jT},Symbol.toStringTag,{value:"Module"}));/** @license See the LICENSE file. */const $oe="3.21.0";/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Roe(t,e){let n=z(t,"a","add"),r=z(e,"b","add");[n,r]=En(n,r);const a={a:n,b:r};return te.runKernel(Fd,a)}const ot=ee({add_:Roe});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Moe(t,e){let n=z(t,"a","floorDiv"),r=z(e,"b","floorDiv");[n,r]=En(n,r);const a={a:n,b:r};return te.runKernel(Lf,a)}const HT=ee({floorDiv_:Moe});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Aoe(t,e){let n=z(t,"a","div"),r=z(e,"b","div");if([n,r]=En(n,r),n.dtype==="int32"&&r.dtype==="int32")return HT(n,r);const a={a:n,b:r},i={};return te.runKernel(Of,a,i)}const un=ee({div_:Aoe});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Poe(t,e){let n=z(t,"a","mul"),r=z(e,"b","mul");[n,r]=En(n,r);const a={a:n,b:r};return te.runKernel(em,a)}const $e=ee({mul_:Poe});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Doe(t){const e=z(t,"x","abs");if(e.dtype==="complex64"){const n={x:e};return te.runKernel(Lb,n)}else{const n={x:e};return te.runKernel(Cb,n)}}const za=ee({abs_:Doe});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Loe(t){const e={x:z(t,"x","acos")};return te.runKernel(bf,e)}const g8=ee({acos_:Loe});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Foe(t){const e={x:z(t,"x","acosh")};return te.runKernel(vf,e)}const y8=ee({acosh_:Foe});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Boe(t){V(Array.isArray(t),()=>"The argument passed to tf.addN() must be a list of tensors"),V(t.length>=1,()=>`Must pass at least one tensor to tf.addN(), but got ${t.length}`);const e=t.map((a,i)=>z(a,`tensors${i}`,"addN")),n=e[0];e.forEach(a=>{if(a.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),e.forEach(a=>{if(!tn(a.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});const r=e;return te.runKernel(Nb,r)}const b8=ee({addN_:Boe});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function zoe(t,e=null,n=!1){const r={x:z(t,"x","all","bool")},a={axis:e,keepDims:n};return te.runKernel(Tb,r,a)}const v8=ee({all_:zoe});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Voe(t,e=null,n=!1){const r={x:z(t,"x","any","bool")},a={axis:e,keepDims:n};return te.runKernel(Ib,r,a)}const x8=ee({any_:Voe});/**
* @license
* Copyright 2020 Google Inc. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Woe(t,e=0){const n={x:z(t,"x","argMax")},r={axis:e};return te.runKernel(Eb,n,r)}const w8=ee({argMax_:Woe});/**
* @license
* Copyright 2020 Google Inc. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function joe(t,e=0){const n={x:z(t,"x","argMin")},r={axis:e};return te.runKernel(_b,n,r)}const k8=ee({argMin_:joe});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Uoe(t){const e={x:z(t,"x","asin")};return te.runKernel(xf,e)}const S8=ee({asin_:Uoe});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Goe(t){const e={x:z(t,"x","asinh")};return te.runKernel(wf,e)}const C8=ee({asinh_:Goe});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Hoe(t){const e={x:z(t,"x","atan")};return te.runKernel(kf,e)}const N8=ee({atan_:Hoe});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function qoe(t,e){let n=z(t,"a","atan2"),r=z(e,"b","atan2");[n,r]=En(n,r);const a={a:n,b:r};return te.runKernel(Cf,a)}const T8=ee({atan2_:qoe});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Koe(t){const e={x:z(t,"x","atanh")};return te.runKernel(Sf,e)}const I8=ee({atanh_:Koe});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Am(t,e,n,r,a="NHWC",i){const o=t[3],s=[...e,o],l=Os(a);return hr(t,s,n,i,r,null,null,l)}function Ii(t,e,n,r,a,i,o="channelsLast"){const[s,l]=wx(e);let u;if(o==="channelsLast")u=[s,l,t[3],t[3]];else if(o==="channelsFirst")u=[s,l,t[1],t[1]];else throw new Error(`Unknown dataFormat ${o}`);return hr(t,u,n,r,a,i,!1,o)}function _s(t,e,n,r,a,i,o="NDHWC"){const[s,l,u]=KT(e);let c,d;if(o==="NDHWC")d="channelsLast",c=[s,l,u,t[4],t[4]];else if(o==="NCDHW")d="channelsFirst",c=[s,l,u,t[1],t[1]];else throw new Error(`Unknown dataFormat ${o}`);return Dl(t,c,n,r,a,!1,d,i)}function hr(t,e,n,r,a,i,o=!1,s="channelsLast"){let[l,u,c,d]=[-1,-1,-1,-1];if(s==="channelsLast")[l,u,c,d]=t;else if(s==="channelsFirst")[l,d,u,c]=t;else throw new Error(`Unknown dataFormat ${s}`);const[p,f,,g]=e,[y,x]=wx(n),[b,v]=wx(r),w=Kd(p,b),S=Kd(f,v),{padInfo:C,outHeight:I,outWidth:_}=Qoe(a,u,c,y,x,w,S,i,s),E=o?g*d:g;let A;return s==="channelsFirst"?A=[l,E,I,_]:s==="channelsLast"&&(A=[l,I,_,E]),{batchSize:l,dataFormat:s,inHeight:u,inWidth:c,inChannels:d,outHeight:I,outWidth:_,outChannels:E,padInfo:C,strideHeight:y,strideWidth:x,filterHeight:p,filterWidth:f,effectiveFilterHeight:w,effectiveFilterWidth:S,dilationHeight:b,dilationWidth:v,inShape:t,outShape:A,filterShape:e}}function Dl(t,e,n,r,a,i=!1,o="channelsLast",s){let[l,u,c,d,p]=[-1,-1,-1,-1,-1];if(o==="channelsLast")[l,u,c,d,p]=t;else if(o==="channelsFirst")[l,p,u,c,d]=t;else throw new Error(`Unknown dataFormat ${o}`);const[f,g,y,,x]=e,[b,v,w]=KT(n),[S,C,I]=KT(r),_=Kd(f,S),E=Kd(g,C),A=Kd(y,I),{padInfo:M,outDepth:L,outHeight:W,outWidth:B}=Zoe(a,u,c,d,b,v,w,_,E,A,s),K=i?x*p:x;let X;return o==="channelsFirst"?X=[l,K,L,W,B]:o==="channelsLast"&&(X=[l,L,W,B,K]),{batchSize:l,dataFormat:o,inDepth:u,inHeight:c,inWidth:d,inChannels:p,outDepth:L,outHeight:W,outWidth:B,outChannels:K,padInfo:M,strideDepth:b,strideHeight:v,strideWidth:w,filterDepth:f,filterHeight:g,filterWidth:y,effectiveFilterDepth:_,effectiveFilterHeight:E,effectiveFilterWidth:A,dilationDepth:S,dilationHeight:C,dilationWidth:I,inShape:t,outShape:X,filterShape:e}}function Xoe(t,e,n,r,a){r==null&&(r=qT(t,e,n));const i=t[0],o=t[1],s=rc((i-e+2*r)/n+1,a),l=rc((o-e+2*r)/n+1,a);return[s,l]}function Yoe(t,e,n,r,a,i){a==null&&(a=qT(t,e,r));const o=t[0],s=t[1],l=t[2],u=rc((o-e+2*a)/r+1,i),c=rc((s-e+2*a)/r+1,i),d=rc((l-e+2*a)/r+1,i);return[u,c,d,n]}function qT(t,e,n,r=1){const a=Kd(e,r);return Math.floor((t[0]*(n-1)-n+a)/2)}function wx(t){return typeof t=="number"?[t,t,t]:t.length===2?[t[0],t[1],1]:t}function KT(t){return typeof t=="number"?[t,t,t]:t}function Kd(t,e){return e<=1?t:t+(t-1)*(e-1)}function Qoe(t,e,n,r,a,i,o,s,l){let u,c,d;if(typeof t=="number"){u={top:t,bottom:t,left:t,right:t,type:t===0?"VALID":"NUMBER"};const p=Xoe([e,n],i,r,t,s);c=p[0],d=p[1]}else if(t==="same"){c=Math.ceil(e/r),d=Math.ceil(n/a);const p=Math.max(0,(c-1)*r+i-e),f=Math.max(0,(d-1)*a+o-n),g=Math.floor(p/2),y=p-g,x=Math.floor(f/2),b=f-x;u={top:g,bottom:y,left:x,right:b,type:"SAME"}}else if(t==="valid")u={top:0,bottom:0,left:0,right:0,type:"VALID"},c=Math.ceil((e-i+1)/r),d=Math.ceil((n-o+1)/a);else if(typeof t=="object"){const p=l==="channelsLast"?t[1][0]:t[2][0],f=l==="channelsLast"?t[1][1]:t[2][1],g=l==="channelsLast"?t[2][0]:t[3][0],y=l==="channelsLast"?t[2][1]:t[3][1];u={top:p,bottom:f,left:g,right:y,type:p===0&&f===0&&g===0&&y===0?"VALID":"EXPLICIT"},c=rc((e-i+p+f)/r+1,s),d=rc((n-o+g+y)/a+1,s)}else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:u,outHeight:c,outWidth:d}}function Zoe(t,e,n,r,a,i,o,s,l,u,c){let d,p,f,g;if(typeof t=="number"){d={top:t,bottom:t,left:t,right:t,front:t,back:t,type:t===0?"VALID":"NUMBER"};const y=Yoe([e,n,r,1],s,1,a,t,c);p=y[0],f=y[1],g=y[2]}else if(t==="same"){p=Math.ceil(e/a),f=Math.ceil(n/i),g=Math.ceil(r/o);const y=(p-1)*a+s-e,x=(f-1)*i+l-n,b=(g-1)*o+u-r,v=Math.floor(y/2),w=y-v,S=Math.floor(x/2),C=x-S,I=Math.floor(b/2),_=b-I;d={top:S,bottom:C,left:I,right:_,front:v,back:w,type:"SAME"}}else if(t==="valid")d={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},p=Math.ceil((e-s+1)/a),f=Math.ceil((n-l+1)/i),g=Math.ceil((r-u+1)/o);else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:d,outDepth:p,outHeight:f,outWidth:g}}function rc(t,e){if(!e)return Math.trunc(t);switch(e){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error(`Unknown roundingMode ${e}`)}}function Pm(t){const[e,n,r]=wx(t);return e===1&&n===1&&r===1}function jr(t,e){return Pm(t)||Pm(e)}function Os(t){if(t==="NHWC")return"channelsLast";if(t==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${t}`)}function Ei(t,e,n){if(n!=null){if(typeof e=="string")throw Error(`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);if(typeof e=="number")V(Uu(e),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);else if(typeof e=="object")e.forEach(r=>{r.forEach(a=>{V(Uu(a),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${a}.`)})});else throw Error(`Error in ${t}: Unknown padding parameter: ${e}`)}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Joe(t,e){const n={x:z(t,"x","reshape","string_or_numeric")},r={shape:e};return te.runKernel(Pv,n,r)}const ve=ee({reshape_:Joe});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function ese(t,e,n,r,a){const i=z(t,"x","avgPool","float32"),o=1;V(jr(n,o),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`);let s=i,l=!1;i.rank===3&&(l=!0,s=ve(i,[1,i.shape[0],i.shape[1],i.shape[2]])),V(s.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${s.rank}.`),Ei("avgPool",r,a);const u={x:s},c={filterSize:e,strides:n,pad:r,dimRoundingMode:a};let d=te.runKernel(Ob,u,c);return d=wn(d,i.dtype),l?ve(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const XT=ee({avgPool_:ese});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function tse(t,e,n,r,a,i="NDHWC"){const o=z(t,"x","avgPool3d","float32");let s=o,l=!1;o.rank===4&&(l=!0,s=ve(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),V(s.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${s.rank}.`),V(i==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${i}`),Ei("avgPool3d",r,a);const u={x:s},c={filterSize:e,strides:n,pad:r,dimRoundingMode:a,dataFormat:i};let d=te.runKernel($b,u,c);return d=wn(d,s.dtype),l?ve(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const E8=ee({avgPool3d_:tse});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function nse(t,e=0){V(t.length>=1,()=>"Pass at least one tensor to concat");const n=Om(t,"tensors","concat","string_or_numeric");if(n[0].dtype==="complex64"&&n.forEach(i=>{if(i.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${i.dtype}. `)}),n.length===1)return Is(n[0]);const r=n,a={axis:e};return te.runKernel(Fb,r,a)}const Ur=ee({concat_:nse});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function rse(t){const e={x:z(t,"x","sigmoid","float32")};return te.runKernel(pm,e)}const ac=ee({sigmoid_:rse});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function ase(t,e,n){const r=z(t,"x","slice","string_or_numeric");if(r.rank===0)throw new Error("Slicing scalar is not possible");const a={x:r},i={begin:e,size:n};return te.runKernel(Wv,a,i)}const nn=ee({slice_:ase});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function ise(t){const e={x:z(t,"x","tanh","float32")};return te.runKernel(bm,e)}const kx=ee({tanh_:ise});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function ose(t,e,n,r,a,i){const o=z(t,"forgetBias","basicLSTMCell"),s=z(e,"lstmKernel","basicLSTMCell"),l=z(n,"lstmBias","basicLSTMCell"),u=z(r,"data","basicLSTMCell"),c=z(a,"c","basicLSTMCell"),d=z(i,"h","basicLSTMCell"),p=Ur([u,d],1),f=Gt(p,s),g=ot(f,l),y=g.shape[0],x=g.shape[1]/4,b=[y,x],v=nn(g,[0,0],b),w=nn(g,[0,x],b),S=nn(g,[0,x*2],b),C=nn(g,[0,x*3],b),I=ot($e(ac(v),kx(w)),$e(c,ac(ot(o,S)))),_=$e(kx(I),ac(C));return[I,_]}const _8=ee({basicLSTMCell_:ose});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function sse(t,e,n){const r=z(t,"x","batchToSpaceND"),a=e.reduce((s,l)=>s*l);V(r.rank>=1+e.length,()=>`input rank is ${r.rank} but should be > than blockShape.length ${e.length}`),V(n.length===e.length,()=>`crops.length is ${n.length} but should be equal to blockShape.length  ${e.length}`),V(r.shape[0]%a===0,()=>`input tensor batch is ${r.shape[0]} but is not divisible by the product of the elements of blockShape ${e.join(" * ")} === ${a}`);const i={x:r},o={blockShape:e,crops:n};return te.runKernel(Mb,i,o)}const YT=ee({batchToSpaceND_:sse});function lse(t){let e;return t.rank===0||t.rank===1?e=ve(t,[1,1,1,t.size]):t.rank===2?e=ve(t,[1,1,t.shape[0],t.shape[1]]):t.rank===3?e=ve(t,[1,t.shape[0],t.shape[1],t.shape[2]]):e=t,e}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function use(t,e,n,r,a,i){i==null&&(i=.001);const o=z(t,"x","batchNorm"),s=z(e,"mean","batchNorm"),l=z(n,"variance","batchNorm");let u;a!=null&&(u=z(a,"scale","batchNorm"));let c;r!=null&&(c=z(r,"offset","batchNorm")),V(s.rank===l.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),V(c==null||s.rank===c.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),V(u==null||s.rank===u.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const d={x:lse(o),scale:u,offset:c,mean:s,variance:l},p={varianceEpsilon:i},f=te.runKernel(iv,d,p);return ve(f,o.shape)}const Dm=ee({batchNorm_:use});function cse(t,e,n,r,a,i){const o=z(t,"x","batchNorm"),s=z(e,"mean","batchNorm"),l=z(n,"variance","batchNorm");let u;a!=null&&(u=z(a,"scale","batchNorm"));let c;return r!=null&&(c=z(r,"offset","batchNorm")),V(o.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${o.rank}.`),V(s.rank===2||s.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${s.rank}.`),V(l.rank===2||l.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${l.rank}.`),u!=null&&V(u.rank===2||u.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${u.rank}.`),c!=null&&V(c.rank===2||c.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${c.rank}.`),Dm(o,s,l,c,u,i)}const O8=ee({batchNorm2d_:cse});function dse(t,e,n,r,a,i){const o=z(t,"x","batchNorm"),s=z(e,"mean","batchNorm"),l=z(n,"variance","batchNorm");let u;a!=null&&(u=z(a,"scale","batchNorm"));let c;return r!=null&&(c=z(r,"offset","batchNorm")),V(o.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${o.rank}.`),V(s.rank===3||s.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${s.rank}.`),V(l.rank===3||l.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${l.rank}.`),u!=null&&V(u.rank===3||u.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${u.rank}.`),c!=null&&V(c.rank===3||c.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${c.rank}.`),Dm(o,s,l,c,u,i)}const $8=ee({batchNorm3d_:dse});function pse(t,e,n,r,a,i){const o=z(t,"x","batchNorm"),s=z(e,"mean","batchNorm"),l=z(n,"variance","batchNorm");let u;a!=null&&(u=z(a,"scale","batchNorm"));let c;return r!=null&&(c=z(r,"offset","batchNorm")),V(o.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${o.rank}.`),V(s.rank===4||s.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${s.rank}.`),V(l.rank===4||l.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${l.rank}.`),u!=null&&V(u.rank===4||u.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${u.rank}.`),c!=null&&V(c.rank===4||c.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${c.rank}.`),Dm(o,s,l,c,u,i)}const R8=ee({batchNorm4d_:pse});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function hse(t,e,n){const r=z(t,"x","bincount"),a=z(e,"weights","bincount");V(r.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${r.dtype}`),V(n>=0,()=>`size must be non-negative, but got ${n}.`),V(a.size===r.size||a.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${r.shape}, weights shape: ${a.shape}.`);const i={x:r,weights:a},o={size:n};return te.runKernel(Ab,i,o)}const QT=ee({bincount_:hse});/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function fse(t,e){const n=z(t,"s0","broadcastArgs","int32"),r=z(e,"s1","broadcastArgs","int32");if(n.rank!==1)throw new Error(`broadcastArgs(): first input must be a vector (rank=1). Has rank ${n.rank}`);if(r.rank!==1)throw new Error(`broadcastArgs(): second input must be a vector (rank=1). Has rank ${r.rank}`);const a={s0:n,s1:r};return te.runKernel(Pb,a)}const M8=ee({broadcastArgs_:fse});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function mse(t,e){let n=z(t,"broadcastTo","x");const r=n.shape;if(e.some(l=>!(l>0)||l%1!==0))throw new Error(`broadcastTo(): Invalid broadcast shape [${e}].`);if(e.length<n.rank)throw new Error(`broadcastTo(): shape.length=${e.length} < input.rank=${n.rank}.`);if(e.length>n.rank){const l=n.shape.slice();for(;l.length<e.length;)l.unshift(1);n=ve(n,l)}const a=n.shape,i=Array.from(e);for(let l=e.length-1;l>=0;l--)if(a[l]===e[l])i[l]=1;else if(n.shape[l]!==1)throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${e}].`);if(i.map((l,u)=>l>1?u:-1).filter(l=>l>=0).length===0)return Is(n);const o={x:n},s={reps:i};return te.runKernel(vm,o,s)}const Xd=ee({broadcastTo_:mse});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function gse(t){const e={x:z(t,"x","ceil","float32")};return te.runKernel(Tf,e)}const A8=ee({ceil_:gse});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Yd(t,e,n){const r={shape:t,value:e,dtype:n};return te.runKernel(rv,{},r)}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function yse(t,e,n){const r=z(t,"x","clipByValue");if(V(e<=n,()=>`Error in clip: min (${e}) must be less than or equal to max (${n}).`),e===n)return Yd(r.shape,e,r.dtype);const a={x:r},i={clipValueMin:e,clipValueMax:n};return te.runKernel(If,a,i)}const P8=ee({clipByValue_:yse});function bse(t){return Ur(t,0)}const D8=ee({concat1d_:bse});function vse(t,e){return Ur(t,e)}const L8=ee({concat2d_:vse});function xse(t,e){return Ur(t,e)}const F8=ee({concat3d_:xse});function wse(t,e){return Ur(t,e)}const B8=ee({concat4d_:wse});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function kse(t,e,n,r,a="NHWC",i=[1,1],o){const s=z(t,"x","conv2d","float32"),l=z(e,"filter","conv2d","float32");let u=s,c=!1;s.rank===3&&(c=!0,u=ve(s,[1,s.shape[0],s.shape[1],s.shape[2]])),V(u.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${u.rank}.`),V(l.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${l.rank}.`),Ei("conv2d",r,o);const d=a==="NHWC"?u.shape[3]:u.shape[1];V(d===l.shape[2],()=>`Error in conv2d: depth of input (${d}) must match input depth for filter ${l.shape[2]}.`),V(jr(n,i),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`);const p={x:u,filter:l},f={strides:n,pad:r,dataFormat:a,dilations:i,dimRoundingMode:o},g=te.runKernel(Bb,p,f);return c?ve(g,[g.shape[1],g.shape[2],g.shape[3]]):g}const Lm=ee({conv2d_:kse});function Sse(t,e,n,r,a="NWC",i=1,o){const s=z(t,"x","conv1d"),l=z(e,"filter","conv1d");let u=s,c=!1;s.rank===2&&(c=!0,u=ve(s,[1,s.shape[0],s.shape[1]])),V(u.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${u.rank}.`),V(l.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${l.rank}.`),Ei("conv1d",r,o),V(u.shape[2]===l.shape[1],()=>`Error in conv1d: depth of input (${u.shape[2]}) must match input depth for filter ${l.shape[1]}.`),V(jr(n,i),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${n} and dilation '${i}'`),V(a==="NWC",()=>`Error in conv1d: got dataFormat of ${a} but only NWC is currently supported.`);const d=ve(l,[1,l.shape[0],l.shape[1],l.shape[2]]),p=ve(u,[u.shape[0],1,u.shape[1],u.shape[2]]),f=Lm(p,d,[1,n],r,"NHWC",[1,i],o);return c?ve(f,[f.shape[2],f.shape[3]]):ve(f,[f.shape[0],f.shape[2],f.shape[3]])}const z8=ee({conv1d_:Sse});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Cse(t,e,n,r,a,i="NHWC",o){V(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let s=t,l=e,u=!1;e.rank===3&&(u=!0,l=ve(e,[1,e.shape[0],e.shape[1],e.shape[2]]),s=[1,t[0],t[1],t[2]]),V(s.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${s.length}.`),V(l.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${l.rank}`),V(n.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${n.rank}`);const c=i==="NHWC"?s[3]:s[1],d=i==="NHWC"?l.shape[3]:l.shape[1];V(c===n.shape[2],()=>`Error in conv2dDerInput: depth of input (${c}) must match input depth for filter ${n.shape[2]}.`),V(d===n.shape[3],()=>`Error in conv2dDerInput: depth of output (${d}) must match output depth for filter ${n.shape[3]}.`),Ei("conv2dDerInput",a,o);const p={dy:l,filter:n},f={strides:r,pad:a,dataFormat:i,dimRoundingMode:o,inputShape:s},g=te.runKernel(Vb,p,f);return u?ve(g,[g.shape[1],g.shape[2],g.shape[3]]):g}const V8=ee({conv2DBackpropInput_:Cse});function Nse(t,e,n,r,a,i){const o=z(t,"x","conv2dTranspose"),s=z(e,"filter","conv2dTranspose");return V8(n,o,s,r,a,"NHWC",i)}const W8=ee({conv2dTranspose_:Nse});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Tse(t,e,n,r,a="NDHWC",i=[1,1,1]){const o=z(t,"x","conv3d"),s=z(e,"filter","conv3d");let l=o,u=!1;o.rank===4&&(u=!0,l=ve(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),V(l.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${l.rank}.`),V(s.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${s.rank}.`),V(l.shape[4]===s.shape[3],()=>`Error in conv3d: depth of input (${l.shape[4]}) must match input depth for filter ${s.shape[3]}.`),V(jr(n,i),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`),V(a==="NDHWC",()=>`Error in conv3d: got dataFormat of ${a} but only NDHWC is currently supported.`);const c={x:l,filter:s},d={strides:n,pad:r,dataFormat:a,dilations:i},p=te.runKernel(Wb,c,d);return u?ve(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}const j8=ee({conv3d_:Tse});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Ise(t,e,n,r,a){V(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let i=t,o=e,s=!1;e.rank===4&&(s=!0,o=ve(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),i=[1,t[0],t[1],t[2],t[3]]);const l=i[4],u=o.shape[4];V(i.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${i.length}.`),V(o.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${o.rank}`),V(n.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${n.rank}`),V(l===n.shape[3],()=>`Error in conv3dDerInput: depth of input (${l}) must match input depth for filter ${n.shape[3]}.`),V(u===n.shape[4],()=>`Error in conv3dDerInput: depth of output (${u}) must match output depth for filter ${n.shape[4]}.`);const c={dy:o,filter:n},d={pad:a,strides:r,inputShape:i},p=te.runKernel(jb,c,d);return s?ve(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}const Ese=ee({conv3DBackpropInput_:Ise});function _se(t,e,n,r,a){const i=z(t,"x","conv3dTranspose"),o=z(e,"filter","conv3dTranspose");return Ese(n,i,o,r,a)}const U8=ee({conv3dTranspose_:_se});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Ose(t){const e={x:z(t,"x","cos","float32")};return te.runKernel(Ef,e)}const G8=ee({cos_:Ose});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function $se(t){const e={x:z(t,"x","cosh","float32")};return te.runKernel(_f,e)}const H8=ee({cosh_:$se});/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the 'License');
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an 'AS IS' BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Rse(t,e=0,n=!1,r=!1){const a={x:z(t,"x","cumprod")},i={axis:e,exclusive:n,reverse:r};return te.runKernel(Ub,a,i)}const q8=ee({cumprod_:Rse});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Mse(t,e=0,n=!1,r=!1){const a={x:z(t,"x","cumsum")},i={axis:e,exclusive:n,reverse:r};return te.runKernel(Gb,a,i)}const K8=ee({cumsum_:Mse});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Ase(t,e,n,r=!1){const a=z(t,"x","denseBincount"),i=z(e,"weights","denseBincount");V(a.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${a.dtype}`),V(a.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${a.rank}.`),V(n>=0,()=>`size must be non-negative, but got ${n}.`),V(i.size===a.size||i.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${a.shape}, weights shape: ${i.shape}.`);const o={x:a,weights:i},s={size:n,binaryOutput:r};return te.runKernel(qb,o,s)}const X8=ee({denseBincount_:Ase});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Pse(t,e,n="NHWC"){const r=z(t,"x","depthToSpace","float32"),a=n==="NHWC"?r.shape[1]:r.shape[2],i=n==="NHWC"?r.shape[2]:r.shape[3],o=n==="NHWC"?r.shape[3]:r.shape[1];V(e>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${e}`),V(a*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${a} and ${e}  for depthToSpace with input shape
    ${r.shape}`),V(i*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${i} and ${e} for depthToSpace with input shape
        ${r.shape}`),V(o%(e*e)===0,()=>`Dimension size must be evenly divisible by ${e*e} but is ${o} for depthToSpace with input shape ${r.shape}`);const s={x:r},l={blockSize:e,dataFormat:n};return te.runKernel(Kb,s,l)}const Y8=ee({depthToSpace_:Pse});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Dse(t,e,n,r,a="NHWC",i=[1,1],o){const s=z(t,"x","depthwiseConv2d","float32"),l=z(e,"filter","depthwiseConv2d","float32");let u=s,c=!1;s.rank===3&&(c=!0,u=ve(s,[1,s.shape[0],s.shape[1],s.shape[2]])),V(u.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${u.rank}.`),V(l.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${l.rank}.`);const d=a==="NHWC"?u.shape[3]:u.shape[1];V(d===l.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${d}) must match the inChannels dimension in filter ${l.shape[2]}.`),Ei("depthwiseConv2d",r,o);const p={x:u,filter:l},f={strides:n,pad:r,dataFormat:a,dilations:i,dimRoundingMode:o},g=te.runKernel(Xb,p,f);return c?ve(g,[g.shape[1],g.shape[2],g.shape[3]]):g}const Sx=ee({depthwiseConv2d_:Dse});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Lse(t){const e={x:z(t,"x","diag")};return te.runKernel(Zb,e)}const Q8=ee({diag_:Lse});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Fse(t,e,n,r,a=[1,1],i="NHWC"){const o=z(t,"x","dilation2d"),s=z(e,"filter","dilation2d");V(o.rank===3||o.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${o.rank}.`),V(s.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${s.rank}.`),V(i==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${i}`);let l=o,u=!1;o.rank===3&&(l=ve(o,[1,o.shape[0],o.shape[1],o.shape[2]]),u=!0);const c={x:l,filter:s},d={strides:n,pad:r,dilations:a},p=te.runKernel(Jb,c,d);return u?ve(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const Z8=ee({dilation2d_:Fse});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Bse(t,e){let n=z(t,"a","equal","string_or_numeric"),r=z(e,"b","equal","string_or_numeric");[n,r]=En(n,r),Nt(n.shape,r.shape);const a={a:n,b:r};return te.runKernel(Mf,a)}const ZT=ee({equal_:Bse});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function zse(t,e,n){const r=z(e,"a","where"),a=z(n,"b","where"),i=z(t,"condition","where","bool"),o=Nt(Nt(i.shape,r.shape),a.shape),s=Xd(i,o),l=Xd(r,o),u=Xd(a,o),c={condition:s,t:l,e:u};return te.runKernel(Vv,c)}const ic=ee({where_:zse});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Vse(t){const e={x:z(t,"x","zerosLike")};return te.runKernel(sx,e)}const Va=ee({zerosLike_:Vse});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Wse(t,e){let n=z(t,"a","div"),r=z(e,"b","div");[n,r]=En(n,r);const a=un(n,r),i=Va(a),o=ZT(r,i);return ic(o,i,a)}const J8=ee({divNoNan_:Wse});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function jse(t,e){const n=z(t,"t1","dot"),r=z(e,"t2","dot");V((n.rank===1||n.rank===2)&&(r.rank===1||r.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${n.rank} and ${r.rank}.`);const a=n.rank===1?n.size:n.shape[1],i=r.rank===1?r.size:r.shape[0];if(V(a===i,()=>`Error in dot: inner dimensions of inputs must match, but got ${a} and ${i}.`),n.rank===1&&r.rank===1){const o=ve(n,[1,-1]),s=ve(r,[-1,1]),l=Gt(o,s);return ve(l,[])}else if(n.rank===1&&r.rank===2){const o=ve(n,[1,-1]),s=ve(r,[r.shape[0],r.shape[1]]),l=Gt(o,s);return ve(l,[l.size])}else if(n.rank===2&&r.rank===1){const o=ve(r,[-1,1]),s=Gt(n,o);return ve(s,[s.size])}else{const o=ve(r,[r.shape[0],r.shape[1]]);return Gt(n,o)}}const eD=ee({dot_:jse});/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Use(t,...e){const n=e.map((a,i)=>z(a,`tensors${i}`,"einsum")),r={equation:t};return te.runKernel(ev,n,r)}const tD=ee({einsum_:Use});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Gse(t){const e={x:z(t,"x","elu","float32")};return te.runKernel($f,e)}const JT=ee({elu_:Gse});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Hse(t){let e=z(t,"x","erf");V(e.dtype==="int32"||e.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),e.dtype==="int32"&&(e=wn(e,"float32"));const n={x:e};return te.runKernel(Rf,n)}const nD=ee({erf_:Hse});/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function eI(t,e){for(let n=0;n<t.length;++n)if(t[t.length-n-1]!==e-1-n)return!1;return!0}function rD(t,e,n){const r=t.length+e.length,a=[];let i=0,o=0;for(let s=0;s<r;s++)n.indexOf(s)===-1?a.push(t[i++]):a.push(e[o++]);return a}function Nr(t,e){const n=[],r=t.length;for(let i=0;i<r;i++)e.indexOf(i)===-1&&n.push(t[i]);const a=e.map(i=>t[i]);return[n,a]}function ar(t,e){const n=e.map(r=>1);return rD(t,n,e)}function Tr(t,e,n){V(eI(e,n),()=>`${t} supports only inner-most axes for now. Got axes ${e} and rank-${n} input.`)}function jn(t,e){if(eI(t,e))return null;const n=[];for(let r=0;r<e;++r)t.indexOf(r)===-1&&n.push(r);return t.forEach(r=>n.push(r)),n}function Fm(t){return t.map((e,n)=>[n,e]).sort((e,n)=>e[1]-n[1]).map(e=>e[0])}function Un(t,e){const n=[];for(let r=e-t;r<e;++r)n.push(r);return n}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function qse(t,e=null,n=!1){const r={x:z(t,"x","max")},a={reductionIndices:e,keepDims:n};return te.runKernel(hv,r,a)}const oc=ee({max_:qse});/**
* @license
* Copyright 2020 Google Inc. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Kse(t,e=null,n=!1){const r={x:z(t,"x","min")},a={axis:e,keepDims:n};return te.runKernel(bv,r,a)}const Cx=ee({min_:Kse});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Xse(t,e){let n=z(t,"base","pow"),r=z(e,"exp","pow");[n,r]=En(n,r);const a={a:n,b:r};return te.runKernel(nm,a)}const Qd=ee({pow_:Xse});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function St(t,e){if((Vr(t)&&e!=="string"||Array.isArray(t))&&e!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(e==="string"&&Vr(t)&&!(t instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Ml(t,[],[],e)}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Yse(t){const e={x:z(t,"x","sqrt","float32")};return te.runKernel(fm,e)}const Po=ee({sqrt_:Yse});/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Qse(t){const e=z(t,"x","square"),n={};return te.runKernel("Square",{x:e},n)}const _i=ee({square_:Qse});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Zse(t,e=null,n=!1){let r=z(t,"x","sum");r.dtype==="bool"&&(r=wn(r,"int32"));const a={x:r},i={axis:e,keepDims:n};return te.runKernel(jv,a,i)}const cn=ee({sum_:Zse});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Jse(t,e="euclidean",n=null,r=!1){t=z(t,"x","norm");const a=aD(t,e,n);let i=a.shape;if(r){const o=Pt(n,t.shape);i=ar(a.shape,o)}return ve(a,i)}function aD(t,e,n=null){if(t.rank===0)return za(t);if(t.rank!==1&&n===null)return aD(ve(t,[-1]),e,n);if(t.rank===1||typeof n=="number"||Array.isArray(n)&&n.length===1){if(e===1)return cn(za(t),n);if(e===1/0)return oc(za(t),n);if(e===-1/0)return Cx(za(t),n);if(e==="euclidean"||e===2)return Po(cn(Qd(za(t),St(2,"int32")),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}if(Array.isArray(n)&&n.length===2){if(e===1)return oc(cn(za(t),n[0]),n[1]-1);if(e===1/0)return oc(cn(za(t),n[1]),n[0]);if(e===-1/0)return Cx(cn(za(t),n[1]),n[0]);if(e==="fro"||e==="euclidean")return Po(cn(_i(t),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}throw new Error(`Error in norm: invalid axis: ${n}`)}const Bm=ee({norm_:Jse});/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function ele(t,e=null,n=!1){return Bm(t,"euclidean",e,n)}const iD=ee({euclideanNorm_:ele});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function tle(t){const e={x:z(t,"x","exp")};return te.runKernel(Af,e)}const Ll=ee({exp_:tle});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function nle(t,e=0){const n=z(t,"x","expandDims","string_or_numeric");V(e<=n.rank,()=>"Axis must be <= rank of the tensor");const r={input:n},a={dim:e};return te.runKernel(tv,r,a)}const $s=ee({expandDims_:nle});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function rle(t){const e={x:z(t,"x","expm1")};return te.runKernel(Pf,e)}const oD=ee({expm1_:rle});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function ale(t,e){const n=z(t,"x","tile","string_or_numeric");V(n.rank===e.length,()=>`Error in transpose: rank of input ${n.rank} must match length of reps ${e}.`);const r={x:n},a={reps:e};return te.runKernel(vm,r,a)}const Zd=ee({tile_:ale});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function ile(t,e,n,r="float32"){e==null&&(e=t);const a=pt([t,e],r),i=t<=e?t:e;for(let s=0;s<i;++s)a.set(1,s,s);const o=ve(a.toTensor(),[t,e]);if(n==null)return o;if(n.length===1)return Zd($s(o,0),[n[0],1,1]);if(n.length===2)return Zd($s($s(o,0),0),[n[0],n[1],1,1]);if(n.length===3)return Zd($s($s($s(o,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${n.length}D.`)}const tI=ee({eye_:ile});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function ole(t){const e={x:z(t,"x","floor","float32")};return te.runKernel(Df,e)}const nI=ee({floor_:ole});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function sle(t,e,n=0,r=0){const a=z(t,"x","gather"),i=z(e,"indices","gather","int32"),o={x:a,indices:i},s={axis:n,batchDims:r};return te.runKernel(ov,o,s)}const rI=ee({gather_:sle});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function lle(t,e){let n=z(t,"a","greater","string_or_numeric"),r=z(e,"b","greater","string_or_numeric");[n,r]=En(n,r),Nt(n.shape,r.shape);const a={a:n,b:r};return te.runKernel(Ff,a)}const zm=ee({greater_:lle});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function ule(t,e){let n=z(t,"a","greaterEqual","string_or_numeric"),r=z(e,"b","greaterEqual","string_or_numeric");[n,r]=En(n,r),Nt(n.shape,r.shape);const a={a:n,b:r};return te.runKernel(Bf,a)}const aI=ee({greaterEqual_:ule});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function cle(t){const e={x:z(t,"x","isFinite")};return te.runKernel(Vf,e)}const sD=ee({isFinite_:cle});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function dle(t){const e={x:z(t,"x","isInf")};return te.runKernel(Wf,e)}const lD=ee({isInf_:dle});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function ple(t){const e={x:z(t,"x","isNaN")};return te.runKernel(jf,e)}const uD=ee({isNaN_:ple});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function hle(t,e=.2){const n={x:z(t,"x","leakyRelu")},r={alpha:e};return te.runKernel(cv,n,r)}const iI=ee({leakyRelu_:hle});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function fle(t,e){let n=z(t,"a","less","string_or_numeric"),r=z(e,"b","less","string_or_numeric");[n,r]=En(n,r),Nt(n.shape,r.shape);const a={a:n,b:r};return te.runKernel(Uf,a)}const cD=ee({less_:fle});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function mle(t,e){let n=z(t,"a","lessEqual","string_or_numeric"),r=z(e,"b","lessEqual","string_or_numeric");[n,r]=En(n,r),Nt(n.shape,r.shape);const a={a:n,b:r};return te.runKernel(Gf,a)}const Nx=ee({lessEqual_:mle});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function dD(t,e,n){if(n<=0)throw new Error("The number of values should be positive.");const r={start:t,stop:e,num:n};return te.runKernel(dv,{},r)}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function gle(t,e=5,n=1,r=1,a=.5){const i=z(t,"x","localResponseNormalization");V(i.rank===4||i.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${i.rank}.`),V(Uu(e),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${e}.`);let o=i,s=!1;i.rank===3&&(s=!0,o=ve(i,[1,i.shape[0],i.shape[1],i.shape[2]]));const l={x:o},u={depthRadius:e,bias:n,alpha:r,beta:a},c=te.runKernel(pv,l,u);return s?ve(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const pD=ee({localResponseNormalization_:gle});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function yle(t){const e={x:z(t,"x","log","float32")};return te.runKernel(Hf,e)}const Jd=ee({log_:yle});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function ble(t){const e={x:z(t,"x","log1p")};return te.runKernel(qf,e)}const oI=ee({log1p_:ble});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function vle(t){return V(Ol(t),()=>"The f passed in grad(f) must be a function"),(e,n)=>{const r=z(e,"x","tf.grad","string_or_numeric"),a=n!=null?z(n,"dy","tf.grad"):null;return te.tidy(()=>{const{value:i,grads:o}=te.gradients(()=>t(r),[r],a);return a!=null&&Sr(i.shape,a.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),Tx(o),o[0]})}}function xle(t){return V(Ol(t),()=>"The f passed in grads(f) must be a function"),(e,n)=>{V(Array.isArray(e),()=>"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s");const r=Om(e,"args","tf.grads","string_or_numeric"),a=n!=null?z(n,"dy","tf.grads"):null;return te.tidy(()=>{const{value:i,grads:o}=te.gradients(()=>t(...r),r,a);return a!=null&&Sr(i.shape,a.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),Tx(o),o})}}function wle(t){return V(Ol(t),()=>"The f passed in valueAndGrad(f) must be a function"),(e,n)=>{V(e instanceof In,()=>"The x passed in valueAndGrad(f)(x) must be a tensor"),V(n==null||n instanceof In,()=>"The dy passed in valueAndGrad(f)(x, dy) must be a tensor");const{grads:r,value:a}=te.gradients(()=>t(e),[e],n);return Tx(r),{grad:r[0],value:a}}}function kle(t){return V(Ol(t),()=>"The f passed in valueAndGrads(f) must be a function"),(e,n)=>{V(Array.isArray(e)&&e.every(a=>a instanceof In),()=>"The args passed in valueAndGrads(f)(args) must be array of tensors"),V(n==null||n instanceof In,()=>"The dy passed in valueAndGrads(f)(args, dy) must be a tensor");const r=te.gradients(()=>t(...e),e,n);return n!=null&&Sr(r.value.shape,n.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),Tx(r.grads),r}}function hD(t,e){V(Ol(t),()=>"The f passed in variableGrads(f) must be a function"),V(e==null||Array.isArray(e)&&e.every(u=>u instanceof _m),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const n=e!=null;if(!n){e=[];for(const u in te.registeredVariables)e.push(te.registeredVariables[u])}const r=n?e.filter(u=>!u.trainable):null,a=e.length;e=e.filter(u=>u.trainable),V(e.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${a} variables is trainable.`);const i=!0,{value:o,grads:s}=te.gradients(t,e,null,i);V(s.some(u=>u!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),V(o.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${o.rank} tensor`);const l={};return e.forEach((u,c)=>{s[c]!=null&&(l[u.name]=s[c])}),r?.forEach(u=>l[u.name]=null),{value:o,grads:l}}function Do(t){return te.customGrad(t)}function Tx(t){if(t.filter(e=>e==null).length>0)throw new Error(`Cannot compute gradient of y=f(x) with respect to x. Make sure that
    the f you passed encloses all operations that lead from x to y.`)}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Sle(t){const e={x:z(t,"x","softplus")};return te.runKernel(hm,e)}const sI=ee({softplus_:Sle});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Cle(t){const e=z(t,"x","logSigmoid");return Do(n=>({value:Ao(sI(Ao(n))),gradFunc:r=>$e(r,ac(Ao(n)))}))(e)}const fD=ee({logSigmoid_:Cle});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Nle(t,e){let n=z(t,"a","sub"),r=z(e,"b","sub");[n,r]=En(n,r);const a={a:n,b:r};return te.runKernel(gm,a)}const xt=ee({sub_:Nle});/**
* @license
* Copyright 2020 Google Inc. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Tle(t,e=-1){const n=z(t,"logits","logSoftmax");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and axis was ${e}`);return Do((r,a)=>{const i=oc(r,e,!0),o=xt(r,i),s=xt(wn(o,"float32"),Jd(cn(Ll(o),e,!0)));return a([s]),{value:s,gradFunc:(l,u)=>{const[c]=u,d=!0,p=Ll(c);return xt(l,$e(cn(l,e,d),p))}}})(n)}const mD=ee({logSoftmax_:Tle});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Ile(t,e=null,n=!1){const r=z(t,"x","logSumExp"),a=Pt(e,r.shape),i=oc(r,a,!0),o=xt(r,i),s=Ll(o),l=cn(s,a),u=Jd(l),c=ot(ve(i,u.shape),u);if(n){const d=ar(c.shape,a);return ve(c,d)}return c}const lI=ee({logSumExp_:Ile});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Ele(t,e){const n=z(t,"a","logicalAnd","bool"),r=z(e,"b","logicalAnd","bool");Nt(n.shape,r.shape);const a={a:n,b:r};return te.runKernel(Kf,a)}const Vm=ee({logicalAnd_:Ele});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function _le(t){const e={x:z(t,"x","logicalNot","bool")};return te.runKernel(Xf,e)}const uI=ee({logicalNot_:_le});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Ole(t,e){const n=z(t,"a","logicalOr","bool"),r=z(e,"b","logicalOr","bool");Nt(n.shape,r.shape);const a={a:n,b:r};return te.runKernel(Yf,a)}const cI=ee({logicalOr_:Ole});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function $le(t,e){const n=z(t,"a","logicalXor","bool"),r=z(e,"b","logicalXor","bool");return Nt(n.shape,r.shape),Vm(cI(t,e),uI(Vm(t,e)))}const gD=ee({logicalXor_:$le});/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Ix=2147483648;function Rle(t,e,n="left"){const r=z(t,"sortedSequence","searchSorted"),a=z(e,"values","searchSorted"),i=r.shape[r.shape.length-1],o=a.shape[a.shape.length-1],s=ve(r,[-1,i]),l=ve(a,[-1,o]);if(s.rank<2)throw new Error("Sorted input argument must be at least 2-dimensional");if(s.shape[0]!==l.shape[0])throw new Error("Leading dimension of 'sortedSequence' and 'values' must match.");if(me(l.shape)>=Ix)throw new Error(`values tensor size must less than ${Ix}`);if(s.shape[1]>=Ix)throw new Error(`trailing dim_size must less than ${Ix} for int32 output type, was ${s.shape[1]}`);const u={sortedSequence:s,values:l},c={side:n};return te.runKernel(zv,u,c)}const Ex=ee({searchSorted_:Rle});/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function yD(t,e){return Ex(t,e,"left")}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Mle(t,e,n,r,a){const i=z(t,"x","maxPool"),o=1;let s=i,l=!1;i.rank===3&&(l=!0,s=ve(i,[1,i.shape[0],i.shape[1],i.shape[2]])),V(s.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${s.rank}.`),V(jr(n,o),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`),Ei("maxPool",r,a);const u={x:s},c={filterSize:e,strides:n,pad:r,dimRoundingMode:a},d=te.runKernel(fv,u,c);return l?ve(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const dI=ee({maxPool_:Mle});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Ale(t,e=[1,1,1],n,r,a,i="NDHWC"){const o=z(t,"x","maxPool3d");let s=o,l=!1;o.rank===4&&(l=!0,s=ve(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),V(s.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${s.rank}.`),V(i==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${i}`),Ei("maxPool3d",r,a);const u={x:s},c={filterSize:e,strides:n,pad:r,dimRoundingMode:a,dataFormat:i},d=te.runKernel(mv,u,c);return l?ve(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const bD=ee({maxPool3d_:Ale});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Ple(t,e,n,r,a=!1){const i={x:z(t,"x","maxPoolWithArgmax")},o={filterSize:e,strides:n,pad:r,includeBatchInIndex:a},s=te.runKernel(gv,i,o);return{result:s[0],indexes:s[1]}}const vD=ee({maxPoolWithArgmax_:Ple});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Dle(t,e){let n=z(t,"a","maximum"),r=z(e,"b","maximum");[n,r]=En(n,r),n.dtype==="bool"&&(n=wn(n,"int32"),r=wn(r,"int32")),Nt(n.shape,r.shape);const a={a:n,b:r};return te.runKernel(Qf,a)}const pI=ee({maximum_:Dle});/**
* @license
* Copyright 2020 Google Inc. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Lle(t,e=null,n=!1){const r={x:z(t,"x","mean")},a={axis:e,keepDims:n};return te.runKernel(yv,r,a)}const Wm=ee({mean_:Lle});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Fl(t,e="float32"){if(e==="complex64"){const r=Fl(t,"float32"),a=Fl(t,"float32");return Ns(r,a)}const n=Cr(me(t),e);return te.makeTensor(n,t,e)}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Bl(t,e="float32"){if(e==="complex64"){const r=Bl(t,"float32"),a=Fl(t,"float32");return Ns(r,a)}const n=Sb(me(t),e);return te.makeTensor(n,t,e)}/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function xD(t,e,{indexing:n="xy"}={}){if(n!=="xy"&&n!=="ij")throw new TypeError(`${n} is not a valid third argument to meshgrid`);if(t===void 0)return[];let r=z(t,"x","meshgrid",t instanceof In?t.dtype:"float32");if(e===void 0)return[r];let a=z(e,"y","meshgrid",e instanceof In?e.dtype:"float32");const i=me(r.shape),o=me(a.shape);return n==="xy"?(r=ve(r,[1,-1]),a=ve(a,[-1,1]),[Gt(Bl([o,1],r.dtype),r),Gt(a,Bl([1,i],a.dtype))]):(r=ve(r,[-1,1]),a=ve(a,[1,-1]),[Gt(r,Bl([1,o],r.dtype)),Gt(Bl([i,1],a.dtype),a)])}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Fle(t,e){let n=z(t,"a","minimum"),r=z(e,"b","minimum");[n,r]=En(n,r),n.dtype==="bool"&&(n=wn(n,"int32"),r=wn(r,"int32")),Nt(n.shape,r.shape);const a={a:n,b:r};return te.runKernel(Zf,a)}const hI=ee({minimum_:Fle});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Ble(t,e,n){V(n==="reflect"||n==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${n}.`);const r=z(t,"x","mirrorPad");if(r.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");V(e.length===r.rank,()=>`Padding doesn't match input. Must be ${r.rank}. Got ${e.length}.`);const a=n==="reflect"?1:0;for(let s=0;s<r.rank;s++)V(e[s].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),V(e[s][0]>=0&&e[s][0]<=r.shape[s]-a&&e[s][1]>=0&&e[s][1]<=r.shape[s]-a,()=>`Padding in dimension ${s} cannot be greater than or equal to ${r.shape[s]-a} or less than 0 for input of shape ${r.shape}`);const i={paddings:e,mode:n},o={x:r};return te.runKernel(vv,o,i)}const wD=ee({mirrorPad_:Ble});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function zle(t,e){let n=z(t,"a","mod"),r=z(e,"b","mod");[n,r]=En(n,r);const a={a:n,b:r};return te.runKernel(Jf,a)}const kD=ee({mod_:zle});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Vle(t,e=null,n=!1){t=z(t,"x","moments");const r=Pt(e,t.shape),a=Wm(t,r,n);let i=a.shape;n||(i=ar(a.shape,r));const o=_i(xt(wn(t,"float32"),ve(a,i))),s=Wm(o,r,n);return{mean:a,variance:s}}const SD=ee({moments_:Vle});function Wle(t,e,n,r){const a=z(e,"data","multiRNNCell"),i=Om(n,"c","multiRNNCell"),o=Om(r,"h","multiRNNCell");let s=a;const l=[];for(let d=0;d<t.length;d++){const p=t[d](s,i[d],o[d]);l.push(p[0]),l.push(p[1]),s=p[1]}const u=[],c=[];for(let d=0;d<l.length;d+=2)u.push(l[d]),c.push(l[d+1]);return[u,c]}const CD=ee({multiRNNCell_:Wle});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function jle(t,e,n,r=!1){const a=z(t,"logits","multinomial"),i=a.size,o=a.rank;if(i<2)throw new Error(`Error in multinomial: you need at least 2 outcomes, but got ${i}.`);if(o>2)throw new Error(`Rank of probabilities must be 1 or 2, but is ${o}`);n=n||Math.random();const s={logits:o===1?ve(a,[1,-1]):a},l={numSamples:e,seed:n,normalized:r},u=te.runKernel(xv,s,l);return o===1?ve(u,[u.size]):u}const ND=ee({multinomial_:jle});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Ule(t,e){let n=z(t,"a","notEqual","string_or_numeric"),r=z(e,"b","notEqual","string_or_numeric");[n,r]=En(n,r),Nt(n.shape,r.shape);const a={a:n,b:r};return te.runKernel(tm,a)}const fI=ee({notEqual_:Ule});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Gle(t){const e={x:z(t,"x","onesLike")};return te.runKernel(Nv,e)}const TD=ee({onesLike_:Gle});function Hle(t,e){const n=z(t,"v1","outerProduct"),r=z(e,"v2","outerProduct");V(n.rank===1&&r.rank===1,()=>`Error in outerProduct: inputs must be rank 1, but got ranks ${n.rank} and ${r.rank}.`);const a=ve(n,[-1,1]),i=ve(r,[1,-1]);return Gt(a,i)}const ID=ee({outerProduct_:Hle});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function qle(t,e,n=0){const r=z(t,"x","pad");if(r.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const a={paddings:e,constantValue:n},i={x:r};return te.runKernel(Ev,i,a)}const ep=ee({pad_:qle});function Kle(t,e,n=0){return V(e.length===2,()=>"Invalid number of paddings. Must be length of 2."),ep(t,[e],n)}const ED=ee({pad1d_:Kle});function Xle(t,e,n=0){return V(e.length===2&&e[0].length===2&&e[1].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),ep(t,e,n)}const _D=ee({pad2d_:Xle});function Yle(t,e,n=0){return V(e.length===3&&e[0].length===2&&e[1].length===2&&e[2].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),ep(t,e,n)}const OD=ee({pad3d_:Yle});function Qle(t,e,n=0){return V(e.length===4&&e[0].length===2&&e[1].length===2&&e[2].length===2&&e[3].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),ep(t,e,n)}const $D=ee({pad4d_:Qle});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Zle(t,e,n){const r=z(t,"x","spaceToBatchND");V(r.rank>=1+e.length,()=>`input rank ${r.rank} should be > than [blockShape] ${e.length}`),V(n.length===e.length,()=>`paddings.shape[0] ${n.length} must be equal to [blockShape] ${e.length}`),V(r.shape.reduce((o,s,l)=>l>0&&l<=e.length?o&&(s+n[l-1][0]+n[l-1][1])%e[l-1]===0:o,!0),()=>`input spatial dimensions ${r.shape.slice(1)} with paddings ${n.toString()} must be divisible by blockShapes ${e.toString()}`);const a={x:r},i={blockShape:e,paddings:n};return te.runKernel(Uv,a,i)}const mI=ee({spaceToBatchND_:Zle});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Jle(t,e,n,r,a,i,o){a==null&&(a=[1,1]),i==null&&(i=1),r===0&&(r="valid");const s=z(t,"x","maxPool");let l=s,u=!1;s.rank===3&&(u=!0,l=ve(s,[1,s.shape[0],s.shape[1],s.shape[2]])),V(jr(i,a),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${i} and dilations '${a}'`);const c=Ii(l.shape,e,i,a,r),d=[c.dilationHeight,c.dilationWidth];let p;r==="same"?p=tue([c.filterHeight,c.filterWidth],d):p=[[0,0],[0,0]];const f=d[0]===1&&d[1]===1,[g,y]=eue([c.inHeight,c.inWidth],d,p),x=f?r:"valid",b=f?l:mI(l,d,g),v=(n==="avg"?()=>XT(b,e,i,x,o):()=>dI(b,e,i,x,o))(),w=f?v:YT(v,d,y);return u?ve(w,[w.shape[1],w.shape[2],w.shape[3]]):w}function eue(t,e,n){const r=n.map(c=>c[0]),a=n.map(c=>c[1]),i=t.concat(r,a),o=e.map((c,d)=>(c-i[d]%c)%c),s=a.map((c,d)=>c+o[d]),l=e.map((c,d)=>[r[d],s[d]]),u=e.map((c,d)=>[0,o[d]]);return[l,u]}function tue(t,e){const n=t.map((i,o)=>i+(i-1)*(e[o]-1)).map(i=>i-1),r=n.map(i=>Math.floor(i/2)),a=n.map((i,o)=>i-r[o]);return n.map((i,o)=>[r[o],a[o]])}const RD=ee({pool_:Jle});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function nue(t,e){const n=z(t,"x","prelu"),r=z(e,"alpha","prelu"),a={x:n,alpha:r};return te.runKernel(_v,a)}const gI=ee({prelu_:nue});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function rue(t,e=null,n=!1){let r=z(t,"x","prod");r.dtype==="bool"&&(r=wn(r,"int32"));const a={x:r},i={axis:e,keepDims:n};return te.runKernel(Ov,a,i)}const MD=ee({prod_:rue});/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function aue(t,e,n,r){const a=t.map((c,d)=>z(c,`tensors${d}`,"raggedGather","int32")),i=z(e,"paramsDenseValues","raggedGather"),o=z(n,"indices","raggedGather","int32"),s={paramsNestedSplits:a,paramsDenseValues:i,indices:o},l={outputRaggedRank:r},u=te.runKernel($v,s,l);return{outputNestedSplits:u.slice(0,u.length-1),outputDenseValues:u[u.length-1]}}const AD=ee({raggedGather_:aue});/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function iue(t,e,n,r,a){const i=z(t,"shape","raggedTensorToTensor","int32"),o=z(e,"values","raggedTensorToTensor"),s=z(n,"defaultValue","raggedTensorToTensor",o.dtype),l=r.map((d,p)=>z(d,`tensors${p}`,"raggedTensorToTensor","int32")),u={shape:i,values:o,defaultValue:s,rowPartitionTensors:l},c={rowPartitionTypes:a};return te.runKernel(Rv,u,c)}const PD=ee({raggedTensorToTensor_:iue});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function oue(t,e,n){const r=me(t);let a=null;if(n==null||n==="float32")a=new Float32Array(r);else if(n==="int32")a=new Int32Array(r);else if(n==="bool")a=new Uint8Array(r);else throw new Error(`Unknown data type ${n}`);for(let i=0;i<r;i++)a[i]=e();return te.makeTensor(a,t,n)}const DD=ee({rand_:oue});var yI={exports:{}};yI.exports,function(t){(function(e,n,r){function a(l){var u=this,c=s();u.next=function(){var d=2091639*u.s0+u.c*23283064365386963e-26;return u.s0=u.s1,u.s1=u.s2,u.s2=d-(u.c=d|0)},u.c=1,u.s0=c(" "),u.s1=c(" "),u.s2=c(" "),u.s0-=c(l),u.s0<0&&(u.s0+=1),u.s1-=c(l),u.s1<0&&(u.s1+=1),u.s2-=c(l),u.s2<0&&(u.s2+=1),c=null}function i(l,u){return u.c=l.c,u.s0=l.s0,u.s1=l.s1,u.s2=l.s2,u}function o(l,u){var c=new a(l),d=u&&u.state,p=c.next;return p.int32=function(){return c.next()*4294967296|0},p.double=function(){return p()+(p()*2097152|0)*11102230246251565e-32},p.quick=p,d&&(typeof d=="object"&&i(d,c),p.state=function(){return i(c,{})}),p}function s(){var l=4022871197,u=function(c){c=String(c);for(var d=0;d<c.length;d++){l+=c.charCodeAt(d);var p=.02519603282416938*l;l=p>>>0,p-=l,p*=l,l=p>>>0,p-=l,l+=p*4294967296}return(l>>>0)*23283064365386963e-26};return u}n&&n.exports?n.exports=o:r&&r.amd?r(function(){return o}):this.alea=o})(ya,t,!1)}(yI);var sue=yI.exports,bI={exports:{}};bI.exports,function(t){(function(e,n,r){function a(s){var l=this,u="";l.x=0,l.y=0,l.z=0,l.w=0,l.next=function(){var d=l.x^l.x<<11;return l.x=l.y,l.y=l.z,l.z=l.w,l.w^=l.w>>>19^d^d>>>8},s===(s|0)?l.x=s:u+=s;for(var c=0;c<u.length+64;c++)l.x^=u.charCodeAt(c)|0,l.next()}function i(s,l){return l.x=s.x,l.y=s.y,l.z=s.z,l.w=s.w,l}function o(s,l){var u=new a(s),c=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var p=u.next()>>>11,f=(u.next()>>>0)/4294967296,g=(p+f)/(1<<21);while(g===0);return g},d.int32=u.next,d.quick=d,c&&(typeof c=="object"&&i(c,u),d.state=function(){return i(u,{})}),d}n&&n.exports?n.exports=o:r&&r.amd?r(function(){return o}):this.xor128=o})(ya,t,!1)}(bI);var lue=bI.exports,vI={exports:{}};vI.exports,function(t){(function(e,n,r){function a(s){var l=this,u="";l.next=function(){var d=l.x^l.x>>>2;return l.x=l.y,l.y=l.z,l.z=l.w,l.w=l.v,(l.d=l.d+362437|0)+(l.v=l.v^l.v<<4^(d^d<<1))|0},l.x=0,l.y=0,l.z=0,l.w=0,l.v=0,s===(s|0)?l.x=s:u+=s;for(var c=0;c<u.length+64;c++)l.x^=u.charCodeAt(c)|0,c==u.length&&(l.d=l.x<<10^l.x>>>4),l.next()}function i(s,l){return l.x=s.x,l.y=s.y,l.z=s.z,l.w=s.w,l.v=s.v,l.d=s.d,l}function o(s,l){var u=new a(s),c=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var p=u.next()>>>11,f=(u.next()>>>0)/4294967296,g=(p+f)/(1<<21);while(g===0);return g},d.int32=u.next,d.quick=d,c&&(typeof c=="object"&&i(c,u),d.state=function(){return i(u,{})}),d}n&&n.exports?n.exports=o:r&&r.amd?r(function(){return o}):this.xorwow=o})(ya,t,!1)}(vI);var uue=vI.exports,xI={exports:{}};xI.exports,function(t){(function(e,n,r){function a(s){var l=this;l.next=function(){var c=l.x,d=l.i,p,f;return p=c[d],p^=p>>>7,f=p^p<<24,p=c[d+1&7],f^=p^p>>>10,p=c[d+3&7],f^=p^p>>>3,p=c[d+4&7],f^=p^p<<7,p=c[d+7&7],p=p^p<<13,f^=p^p<<9,c[d]=f,l.i=d+1&7,f};function u(c,d){var p,f=[];if(d===(d|0))f[0]=d;else for(d=""+d,p=0;p<d.length;++p)f[p&7]=f[p&7]<<15^d.charCodeAt(p)+f[p+1&7]<<13;for(;f.length<8;)f.push(0);for(p=0;p<8&&f[p]===0;++p);for(p==8?f[7]=-1:f[p],c.x=f,c.i=0,p=256;p>0;--p)c.next()}u(l,s)}function i(s,l){return l.x=s.x.slice(),l.i=s.i,l}function o(s,l){s==null&&(s=+new Date);var u=new a(s),c=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var p=u.next()>>>11,f=(u.next()>>>0)/4294967296,g=(p+f)/(1<<21);while(g===0);return g},d.int32=u.next,d.quick=d,c&&(c.x&&i(c,u),d.state=function(){return i(u,{})}),d}n&&n.exports?n.exports=o:r&&r.amd?r(function(){return o}):this.xorshift7=o})(ya,t,!1)}(xI);var cue=xI.exports,wI={exports:{}};wI.exports,function(t){(function(e,n,r){function a(s){var l=this;l.next=function(){var c=l.w,d=l.X,p=l.i,f,g;return l.w=c=c+1640531527|0,g=d[p+34&127],f=d[p=p+1&127],g^=g<<13,f^=f<<17,g^=g>>>15,f^=f>>>12,g=d[p]=g^f,l.i=p,g+(c^c>>>16)|0};function u(c,d){var p,f,g,y,x,b=[],v=128;for(d===(d|0)?(f=d,d=null):(d=d+"\0",f=0,v=Math.max(v,d.length)),g=0,y=-32;y<v;++y)d&&(f^=d.charCodeAt((y+32)%d.length)),y===0&&(x=f),f^=f<<10,f^=f>>>15,f^=f<<4,f^=f>>>13,y>=0&&(x=x+1640531527|0,p=b[y&127]^=f+x,g=p==0?g+1:0);for(g>=128&&(b[(d&&d.length||0)&127]=-1),g=127,y=4*128;y>0;--y)f=b[g+34&127],p=b[g=g+1&127],f^=f<<13,p^=p<<17,f^=f>>>15,p^=p>>>12,b[g]=f^p;c.w=x,c.X=b,c.i=g}u(l,s)}function i(s,l){return l.i=s.i,l.w=s.w,l.X=s.X.slice(),l}function o(s,l){s==null&&(s=+new Date);var u=new a(s),c=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var p=u.next()>>>11,f=(u.next()>>>0)/4294967296,g=(p+f)/(1<<21);while(g===0);return g},d.int32=u.next,d.quick=d,c&&(c.X&&i(c,u),d.state=function(){return i(u,{})}),d}n&&n.exports?n.exports=o:r&&r.amd?r(function(){return o}):this.xor4096=o})(ya,t,!1)}(wI);var due=wI.exports,kI={exports:{}};kI.exports,function(t){(function(e,n,r){function a(s){var l=this,u="";l.next=function(){var d=l.b,p=l.c,f=l.d,g=l.a;return d=d<<25^d>>>7^p,p=p-f|0,f=f<<24^f>>>8^g,g=g-d|0,l.b=d=d<<20^d>>>12^p,l.c=p=p-f|0,l.d=f<<16^p>>>16^g,l.a=g-d|0},l.a=0,l.b=0,l.c=-1640531527,l.d=1367130551,s===Math.floor(s)?(l.a=s/4294967296|0,l.b=s|0):u+=s;for(var c=0;c<u.length+20;c++)l.b^=u.charCodeAt(c)|0,l.next()}function i(s,l){return l.a=s.a,l.b=s.b,l.c=s.c,l.d=s.d,l}function o(s,l){var u=new a(s),c=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var p=u.next()>>>11,f=(u.next()>>>0)/4294967296,g=(p+f)/(1<<21);while(g===0);return g},d.int32=u.next,d.quick=d,c&&(typeof c=="object"&&i(c,u),d.state=function(){return i(u,{})}),d}n&&n.exports?n.exports=o:r&&r.amd?r(function(){return o}):this.tychei=o})(ya,t,!1)}(kI);var pue=kI.exports,LD={exports:{}};const hue={},fue=Object.freeze(Object.defineProperty({__proto__:null,default:hue},Symbol.toStringTag,{value:"Module"})),FD=RV(fue);(function(t){(function(e,n,r){var a=256,i=6,o=52,s="random",l=r.pow(a,i),u=r.pow(2,o),c=u*2,d=a-1,p;function f(S,C,I){var _=[];C=C==!0?{entropy:!0}:C||{};var E=b(x(C.entropy?[S,w(n)]:S??v(),3),_),A=new g(_),M=function(){for(var L=A.g(i),W=l,B=0;L<u;)L=(L+B)*a,W*=a,B=A.g(1);for(;L>=c;)L/=2,W/=2,B>>>=1;return(L+B)/W};return M.int32=function(){return A.g(4)|0},M.quick=function(){return A.g(4)/4294967296},M.double=M,b(w(A.S),n),(C.pass||I||function(L,W,B,K){return K&&(K.S&&y(K,A),L.state=function(){return y(A,{})}),B?(r[s]=L,W):L})(M,E,"global"in C?C.global:this==r,C.state)}function g(S){var C,I=S.length,_=this,E=0,A=_.i=_.j=0,M=_.S=[];for(I||(S=[I++]);E<a;)M[E]=E++;for(E=0;E<a;E++)M[E]=M[A=d&A+S[E%I]+(C=M[E])],M[A]=C;(_.g=function(L){for(var W,B=0,K=_.i,X=_.j,Q=_.S;L--;)W=Q[K=d&K+1],B=B*a+Q[d&(Q[K]=Q[X=d&X+W])+(Q[X]=W)];return _.i=K,_.j=X,B})(a)}function y(S,C){return C.i=S.i,C.j=S.j,C.S=S.S.slice(),C}function x(S,C){var I=[],_=typeof S,E;if(C&&_=="object")for(E in S)try{I.push(x(S[E],C-1))}catch{}return I.length?I:_=="string"?S:S+"\0"}function b(S,C){for(var I=S+"",_,E=0;E<I.length;)C[d&E]=d&(_^=C[d&E]*19)+I.charCodeAt(E++);return w(C)}function v(){try{var S;return p&&(S=p.randomBytes)?S=S(a):(S=new Uint8Array(a),(e.crypto||e.msCrypto).getRandomValues(S)),w(S)}catch{var C=e.navigator,I=C&&C.plugins;return[+new Date,e,I,e.screen,w(n)]}}function w(S){return String.fromCharCode.apply(0,S)}if(b(r.random(),n),t.exports){t.exports=f;try{p=FD}catch{}}else r["seed"+s]=f})(typeof self<"u"?self:ya,[],Math)})(LD);var mue=LD.exports,gue=sue,yue=lue,bue=uue,vue=cue,xue=due,wue=pue,sc=mue;sc.alea=gue,sc.xor128=yue,sc.xorwow=bue,sc.xorshift7=vue,sc.xor4096=xue,sc.tychei=wue;var _x=sc;/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class SI{constructor(e,n,r,a,i){this.mean=e,this.stdDev=n,this.dtype=r,this.nextVal=NaN,this.truncated=a,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);const o=i||Math.random();this.random=_x.alea(o.toString())}nextValue(){if(!isNaN(this.nextVal)){const a=this.nextVal;return this.nextVal=NaN,a}let e,n,r=!1;for(;!r;){let a,i,o;do a=2*this.random()-1,i=2*this.random()-1,o=a*a+i*i;while(o>=1||o===0);const s=Math.sqrt(-2*Math.log(o)/o);e=this.mean+this.stdDev*a*s,n=this.mean+this.stdDev*i*s,(!this.truncated||this.isValidTruncated(e))&&(r=!0)}return(!this.truncated||this.isValidTruncated(n))&&(this.nextVal=this.convertValue(n)),this.convertValue(e)}convertValue(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}}class kue{constructor(e,n,r,a){this.alpha=e,this.beta=1/n,this.dtype=r;const i=a||Math.random();this.randu=_x.alea(i.toString()),this.randn=new SI(0,1,r,!1,this.randu()),e<1?this.d=e+2/3:this.d=e-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let e,n,r,a,i,o;for(;;){do a=this.randn.nextValue(),o=1+this.c*a;while(o<=0);if(o*=o*o,e=a*a,n=1-.331*e*e,r=.5*e+this.d*(1-o+Math.log(o)),i=this.randu(),i<n||Math.log(i)<r)break}return o=1/this.beta*this.d*o,this.alpha<1&&(o*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(o)}convertValue(e){return this.dtype==="float32"?e:Math.round(e)}}class Sue{constructor(e=0,n=1,r,a){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=e,this.range=n-e,this.dtype=r,a==null&&(a=Math.random()),typeof a=="number"&&(a=a.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${e} - ${n} <= 1 and dtype is not float`);this.random=_x.alea(a)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Cue(t,e,n=1,r="float32",a){if(n==null&&(n=1),r==null&&(r="float32"),r!=="float32"&&r!=="int32")throw new Error(`Unsupported data type ${r}`);const i=new kue(e,n,r,a),o=pt(t,r);for(let s=0;s<o.values.length;s++)o.values[s]=i.nextValue();return o.toTensor()}const BD=ee({randomGamma_:Cue});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Nue(t,e=0,n=1,r,a){if(r!=null&&r==="bool")throw new Error(`Unsupported data type ${r}`);const i=new SI(e,n,r,!1,a),o=pt(t,r);for(let s=0;s<o.values.length;s++)o.values[s]=i.nextValue();return o.toTensor()}const CI=ee({randomNormal_:Nue});/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Tue(t,e,n){if(e!=null&&e==="bool")throw new Error(`Unsupported data type ${e}`);return CI(t,0,1,e,n)}const zD=ee({randomStandardNormal_:Tue});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Iue(t,e=0,n=1,r="float32",a){const i=pt(t,r),o=new Sue(e,n,null,a);for(let s=0;s<i.values.length;s++)i.values[s]=o.nextValue();return i.toTensor()}const NI=ee({randomUniform_:Iue});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function tp(t,e,n=1,r="float32"){if(n===0)throw new Error("Cannot have a step of zero");const a={start:t,stop:e,step:n,dtype:r};return te.runKernel(Mv,{},a)}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Eue(t){const e={x:z(t,"x","reciprocal")};return te.runKernel(rm,e)}const VD=ee({reciprocal_:Eue});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function _ue(t){const e={x:z(t,"x","relu")};return te.runKernel(am,e)}const jm=ee({relu_:_ue});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Oue(t){const e={x:z(t,"x","relu6")};return te.runKernel(im,e)}const TI=ee({relu6_:Oue});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function $ue(t,e){const n={x:z(t,"x","reverse")},r={dims:e};return te.runKernel(Fv,n,r)}const zl=ee({reverse_:$ue});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Rue(t){const e=z(t,"x","reverse");return V(e.rank===1,()=>`Error in reverse1D: x must be rank 1 but got rank ${e.rank}.`),zl(e,0)}const WD=ee({reverse1d_:Rue});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Mue(t,e){const n=z(t,"x","reverse");return V(n.rank===2,()=>`Error in reverse2D: x must be rank 2 but got rank ${n.rank}.`),zl(n,e)}const jD=ee({reverse2d_:Mue});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Aue(t,e){const n=z(t,"x","reverse");return V(n.rank===3,()=>`Error in reverse3D: x must be rank 3 but got rank ${n.rank}.`),zl(n,e)}const UD=ee({reverse3d_:Aue});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Pue(t,e){const n=z(t,"x","reverse");return V(n.rank===4,()=>`Error in reverse4D: x must be rank 4 but got rank ${n.rank}.`),zl(n,e)}const GD=ee({reverse4d_:Pue});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Due(t){const e={x:z(t,"x","round")};return te.runKernel(om,e)}const II=ee({round_:Due});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Lue(t){const e={x:z(t,"x","rsqrt","float32")};return te.runKernel(sm,e)}const HD=ee({rsqrt_:Lue});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Fue(t){const e={x:z(t,"x","selu")};return te.runKernel(lm,e)}const qD=ee({selu_:Fue});function Bue(t,e,n,r,a,i=[1,1],o="NHWC"){const s=z(t,"x","separableConv2d"),l=z(e,"depthwiseFilter","separableConv2d"),u=z(n,"pointwiseFilter","separableConv2d");let c=s,d=!1;if(s.rank===3&&(d=!0,c=ve(s,[1,s.shape[0],s.shape[1],s.shape[2]])),o==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");V(c.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${c.rank}.`),V(l.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${l.rank}.`),V(u.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${l.rank}.`),V(u.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${u.shape[0]}.`),V(u.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${u.shape[1]}.`);const p=l.shape[2],f=l.shape[3];V(u.shape[2]===p*f,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${p*f}, but got ${u.shape[2]}.`);const g=Sx(c,l,r,a,o,i),y=Lm(g,u,1,"valid",o);return d?ve(y,[y.shape[1],y.shape[2],y.shape[3]]):y}const KD=ee({separableConv2d_:Bue});/**
* @license
* Copyright 2020 Google Inc. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/async function zue(t,e){const n=z(t,"x","setdiff1d"),r=z(e,"y","setdiff1d");V(n.dtype===r.dtype,()=>`x and y should have the same dtype, but got x (${n.dtype}) and y (${r.dtype}).`),V(n.rank===1,()=>`x should be 1D tensor, but got x (${n.shape}).`),V(r.rank===1,()=>`y should be 1D tensor, but got y (${r.shape}).`);const a=await n.data(),i=await r.data(),o=new Set(i);let s=0;for(let c=0;c<a.length;c++)o.has(a[c])||s++;const l=new rr([s],n.dtype),u=new rr([s],"int32");for(let c=0,d=0;c<a.length;c++)o.has(a[c])||(l.values[d]=a[c],u.values[d]=c,d++);return[l.toTensor(),u.toTensor()]}const XD=zue;/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Vue(t){const e={x:z(t,"x","sign")};return te.runKernel(dm,e)}const YD=ee({sign_:Vue});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Wue(t){const e={x:z(t,"x","sin","float32")};return te.runKernel(um,e)}const QD=ee({sin_:Wue});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function jue(t){const e={x:z(t,"x","sinh")};return te.runKernel(cm,e)}const ZD=ee({sinh_:jue});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Uue(t,e,n){const r=z(t,"x","slice1d");return V(r.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${r.rank} tensor`),nn(r,[e],[n])}const JD=ee({slice1d_:Uue});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Gue(t,e,n){const r=z(t,"x","slice2d");return V(r.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${r.rank} tensor`),nn(r,e,n)}const eL=ee({slice2d_:Gue});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Hue(t,e,n){const r=z(t,"x","slice3d");return V(r.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${r.rank} tensor`),nn(r,e,n)}const tL=ee({slice3d_:Hue});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function que(t,e,n){const r=z(t,"x","slice4d");return V(r.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${r.rank} tensor`),nn(r,e,n)}const nL=ee({slice4d_:que});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Kue(t,e=-1){const n=z(t,"logits","softmax","float32");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and dim was ${e}`);const r={logits:n},a={dim:e};return te.runKernel(Hv,r,a)}const rL=ee({softmax_:Kue});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Xue(t){V(t.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${t.dtype}.`);const e={input:t};return te.runKernel(nv,e)}const Ox=ee({fft_:Xue});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Yue(t){V(t.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${t.dtype}.`);const e={input:t};return te.runKernel(lv,e)}const Um=ee({ifft_:Yue});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Que(t){const e=t.shape[t.shape.length-1],n=t.size/e;let r;if(e<=2){const a=ve(t,[n,e]);r=Um(a)}else{const a=[n,2*(e-1)],i=ve(Hd(t),[n,e]),o=ve(Rm(t),[n,e]),s=zl(nn(i,[0,1],[n,e-2]),1),l=$e(zl(nn(o,[0,1],[n,e-2]),1),St(-1)),u=Ur([i,s],1),c=Ur([o,l],1),d=ve(Ns(u,c),[a[0],a[1]]);r=Um(d)}if(r=Hd(r),t.rank===3&&t.shape[0]!==0){const a=r,i=t.shape[0];r=ve(r,[i,r.shape[0]/i,r.shape[1]]),a.dispose()}return r}const EI=ee({irfft_:Que});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Zue(t,e,n=0){const r={x:z(t,"x","split")},a={numOrSizeSplits:e,axis:n};return te.runKernel(Gv,r,a)}const np=ee({split_:Zue});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Jue(t,e){V(t.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${t.dtype}`);let n=t.shape[t.shape.length-1];const r=t.size/n;let a;if(e!=null&&e<n){const g=t.shape.map(x=>0),y=t.shape.map(x=>x);y[t.shape.length-1]=e,a=nn(t,g,y),n=e}else if(e!=null&&e>n){const g=t.shape.map(y=>y);g[t.shape.length-1]=e-n,a=Ur([t,Fl(g)],t.shape.length-1),n=e}else a=t;const i=Va(a),o=ve(Ns(a,i),[r,n]),s=Ox(o),l=Math.floor(n/2)+1,u=Hd(s),c=Rm(s),d=np(u,[l,n-l],u.shape.length-1),p=np(c,[l,n-l],c.shape.length-1),f=a.shape.slice();return f[a.shape.length-1]=l,ve(Ns(d[0],p[0]),f)}const $x=ee({rfft_:Jue});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function ece(t,e){let n=z(t,"a","squaredDifference"),r=z(e,"b","squaredDifference");[n,r]=En(n,r),Nt(n.shape,r.shape);const a={a:n,b:r},i={};return te.runKernel(mm,a,i)}const _I=ee({squaredDifference_:ece});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function tce(t,e){const n=z(t,"x","squeeze","string_or_numeric");return ve(n,ks(n.shape,e).newShape)}const Gm=ee({squeeze_:tce});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function nce(t,e=0){const n=Om(t,"tensors","stack","string_or_numeric");V(n.length>=1,()=>"Pass at least one tensor to tf.stack"),n.length>0&&V(e<=n[0].rank,()=>"Axis must be <= rank of the tensor");const r=n,a={axis:e};return te.runKernel(Iv,r,a)}const Lo=ee({stack_:nce});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function rce(t,e=0){const n={x:z(t,"x","step")},r={alpha:e};return te.runKernel(xm,n,r)}const OI=ee({step_:rce});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function ace(t,e,n,r,a=0,i=0,o=0,s=0,l=0){const u={x:z(t,"x","stridedSlice","string_or_numeric")},c={begin:e,end:n,strides:r,beginMask:a,endMask:i,ellipsisMask:o,newAxisMask:s,shrinkAxisMask:l};return te.runKernel(Zv,u,c)}const aL=ee({stridedSlice_:ace});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function ice(t){const e={x:z(t,"x","tan","float32")};return te.runKernel(ym,e)}const iL=ee({tan_:ice});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Oi(t,e){ju(t);const n=Ro(t,e);if(n.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Ml(t,null,n,e)}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function rp(t,e,n){if(ju(t),e!=null&&e.length!==2)throw new Error("tensor2d() requires shape to have two numbers");const r=Ro(t,n);if(r.length!==2&&r.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Ml(t,e,r,n)}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function oL(t,e,n){if(ju(t),e!=null&&e.length!==4)throw new Error("tensor4d() requires shape to have four numbers");const r=Ro(t,n);if(r.length!==4&&r.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return Ml(t,e,r,n)}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function sL(t,e,n){if(ju(t),e!=null&&e.length!==5)throw new Error("tensor5d() requires shape to have five numbers");const r=Ro(t,n);if(r.length!==5&&r.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return Ml(t,e,r,n)}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function lL(t,e,n){if(ju(t),e!=null&&e.length!==6)throw new Error("tensor6d() requires shape to have six numbers");const r=Ro(t,n);if(r.length!==6&&r.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return e=e||r,Ml(t,e,r,n)}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function oce(t,e=1,n=!0){const r=z(t,"x","topk");if(r.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");const a=r.shape[r.shape.length-1];if(e<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${e}`);if(e>a)throw new Error(`'k' passed to topk() must be <= the last dimension (${a}) but got ${e}`);const i={x:r},o={k:e,sorted:n},[s,l]=te.runKernel(nx,i,o);return{values:s,indices:l}}const uL=ee({topk_:oce});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function sce(t,e=0,n=1,r,a){if(r!=null&&r==="bool")throw new Error("Unsupported data type $ { dtype }");const i=new SI(e,n,r,!0,a),o=pt(t,r);for(let s=0;s<o.values.length;s++)o.values[s]=i.nextValue();return o.toTensor()}const cL=ee({truncatedNormal_:sce});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function lce(t,e=0){const n=z(t,"x","unique","string_or_numeric");V(n.rank>0,()=>"The input tensor must be at least 1D");const r={x:n},a={axis:e},[i,o]=te.runKernel(ax,r,a);return{values:i,indices:o}}const dL=ee({unique_:lce});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function uce(t,e,n){const r=z(t,"x","unsortedSegmentSum"),a=z(e,"segmentIds","unsortedSegmentSum","int32");V(Uu(n),()=>"numSegments must be of dtype int");const i={x:r,segmentIds:a},o={numSegments:n};return te.runKernel(ox,i,o)}const pL=ee({unsortedSegmentSum_:uce});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function cce(t,e=0){const n=z(t,"x","unstack","string_or_numeric");V(e>=-n.shape.length&&e<n.shape.length,()=>`Axis = ${e} is not in [-${n.shape.length}, ${n.shape.length})`);const r={value:n},a={axis:e};return te.runKernel(ix,r,a)}const Vl=ee({unstack_:cce});/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function hL(t,e){return Ex(t,e,"right")}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function fL(t,e=!0,n,r){return te.makeVariable(t,e,n,r)}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Rx(t,e){const n=[];for(let i=0;i<e.length;i++)e[i]&&n.push(i);const r=pt(t,"int32"),a=pt([n.length,t.length],"int32");for(let i=0;i<n.length;i++){const o=r.indexToLoc(n[i]),s=i*t.length;a.values.set(o,s)}return a.toTensor()}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/async function dce(t){const e=z(t,"condition","whereAsync","bool"),n=await e.data(),r=Rx(e.shape,n);return t!==e&&e.dispose(),r}const $I=dce;/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/async function pce(t,e,n){const r=z(t,"tensor","boolMask"),a=z(e,"mask","boolMask","bool"),i=n??0,o=a.rank,s=r.shape;V(o>0,()=>"mask cannot be scalar"),Sr(s.slice(i,i+o),a.shape,"mask's shape must match the first K dimensions of tensor's shape,");let l=1;for(let y=i;y<i+o;y++)l*=s[y];const u=s.slice(0,i).concat([l],s.slice(i+o)),c=ve(r,u),d=ve(a,[-1]),p=await $I(d),f=Gm(p,[1]),g=rI(c,f,i);return t!==r&&r.dispose(),e!==a&&a.dispose(),f.dispose(),c.dispose(),d.dispose(),p.dispose(),g}const mL=pce;/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function hce(t,e,n,r,a=!0){const i=z(t,"v","movingAverage"),o=z(e,"x","movingAverage"),s=z(n,"decay","movingAverage");EP(i,o),V(tn(i.shape,o.shape),()=>"Shape mismatch in v and x");const l=St(1),u=xt(l,s);let c=$e(xt(o,i),u);if(a){V(r!=null,()=>"When using zeroDebias: true, step is required.");const d=z(r,"step","movingAverage");c=un(c,xt(l,Qd(s,d)))}return ot(i,c)}const gL=ee({movingAverage_:hce});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function fce(t,e,n){const r=z(t,"indices","scatterND","int32"),a=z(e,"updates","scatterND");PT(a,r,n);const i={indices:r,updates:a},o={shape:n};return te.runKernel(Bv,i,o)}const yL=ee({scatterND_:fce});function mce(t,e,n,r){if(t.dtype!=="int32")throw new Error(`tf.sparseToDense() expects the indices to be int32 type, but the dtype was ${t.dtype}.`);if(t.rank>2)throw new Error(`sparseIndices should be a scalar, vector, or matrix, but got shape ${t.shape}.`);const a=t.rank>0?t.shape[0]:1,i=t.rank>1?t.shape[1]:1;if(n.length!==i)throw new Error(`outputShape has incorrect number of elements:, ${n.length}, should be: ${i}.`);const o=e.size;if(!(e.rank===0||e.rank===1&&o===a))throw new Error(`sparseValues has incorrect shape ${e.shape}, should be [] or [${a}]`);if(e.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function gce(t,e,n,r=0){const a=z(t,"sparseIndices","sparseToDense","int32"),i=z(e,"sparseValues","sparseToDense","string_or_numeric"),o=z(r,"defaultValue","sparseToDense",i.dtype);mce(a,i,n,o);const s={sparseIndices:a,sparseValues:i,defaultValue:o},l={outputShape:n};return te.runKernel(Qv,s,l)}const bL=ee({sparseToDense_:gce});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function yce(t,e){const n=z(e,"indices","gatherND","int32"),r={params:z(t,"x","gatherND","string_or_numeric"),indices:n};return te.runKernel(sv,r)}const vL=ee({gatherND_:yce});/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function bce(t,e){if(e==null)return t.shape.slice();if(tn(t.shape,e))return e;if(t.shape.length===e.length){const n=[];for(let r=0;r<t.shape.length;r++)e[r]==null&&t.shape[r]!=null?n.push(t.shape[r]):n.push(e[r]);return n}return e}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function vce(t,e,n,r){const a=z(t,"x","dropout");if(V(a.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${a.dtype} tensor instead.`),V(e>=0&&e<1,()=>`rate must be a float in the range [0, 1), but got ${e}.`),e===0)return t instanceof In?a.clone():a;const i=bce(a,n),o=1-e,s=un(nI(ot(NI(i,0,1,"float32",r),o)),o);return $e(a,s)}const xL=ee({dropout_:vce});/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function RI(t){return Math.floor(Math.pow(2,Math.ceil(Math.log(t)/Math.log(2))))}function Mx(t,e,n){const r=1-t%2,a=new Float32Array(t);for(let i=0;i<t;++i){const o=2*Math.PI*i/(t+r-1);a[i]=e-n*Math.cos(o)}return Oi(a,"float32")}/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/async function xce(t,e,n=1){const r=z(t,"predictions","inTopK"),a=z(e,"targets","inTopK");V(r.rank>1,()=>`inTopK() expects the predictions to be of rank 2 or higher, but got ${r.rank}`),V(r.rank-1===a.rank,()=>`predictions rank should be 1 larger than targets rank, but got predictions rank ${r.rank} and targets rank ${a.rank}`),Sr(r.shape.slice(0,r.shape.length-1),a.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");const i=r.shape[r.shape.length-1];V(n>0&&n<=i,()=>`'k' passed to inTopK() must be > 0 && <= the predictions last dimension (${i}), but got ${n}`);const o=await r.data(),s=await a.data(),[l,u]=[o.length/i,i],c=tr("bool",l);for(let d=0;d<l;d++){const p=d*u,f=o.subarray(p,p+u),g=[];for(let y=0;y<f.length;y++)g.push({value:f[y],index:y});g.sort((y,x)=>x.value-y.value),c[d]=0;for(let y=0;y<n;y++)if(g[y].index===s[d]){c[d]=1;break}}return t!==r&&r.dispose(),e!==a&&a.dispose(),lo(c,a.shape,"bool")}const wL=xce;/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function wce(t,e,n,r,a,i="NHWC",o){let s=t;t.rank===3&&(s=ve(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l=e;l.rank===3&&(l=ve(e,[1,e.shape[0],e.shape[1],e.shape[2]])),V(s.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${s.shape}.`),V(l.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${l.shape}.`),V(n.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${n}.`);const u=i==="NHWC"?s.shape[3]:s.shape[1],c=i==="NHWC"?l.shape[3]:l.shape[1];V(u===n[2],()=>`Error in conv2dDerFilter: depth of input ${u}) must match input depth in filter (${n[2]}.`),V(c===n[3],()=>`Error in conv2dDerFilter: depth of dy (${c}) must match output depth for filter (${n[3]}).`),Ei("conv2dDerFilter",a,o);const d={x:s,dy:l},p={strides:r,pad:a,dataFormat:i,dimRoundingMode:o,filterShape:n};return te.runKernel(zb,d,p)}const kce=ee({conv2DBackpropFilter_:wce});/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Ax(t,e,n){if(n==null||n==="linear")return t;if(n==="relu")return $e(t,OI(e));throw new Error(`Cannot compute gradient for fused activation ${n}.`)}function Px(t,e){let n=e;const r=RT(t.shape,e.shape);return r.length>0&&(n=cn(n,r)),ve(n,t.shape)}function Dx(t,e,n,r){if(e==="linear")return t;if(e==="relu")return jm(t);if(e==="elu")return JT(t);if(e==="relu6")return TI(t);if(e==="prelu")return gI(t,n);if(e==="leakyrelu")return iI(t,r);if(e==="sigmoid")return ac(t);throw new Error(`Unknown fused activation ${e}.`)}const Lx=(t,e)=>!(t>0)||e==="linear";/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Sce({x:t,filter:e,strides:n,pad:r,dataFormat:a="NHWC",dilations:i=[1,1],dimRoundingMode:o,bias:s,activation:l="linear",preluActivationWeights:u,leakyreluAlpha:c}){if(l=l||"linear",Lx(te.state.gradientDepth,l)===!1){V(a==="NHWC",()=>`Error in fused conv2d: got dataFormat of ${a} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let I=Lm(t,e,n,r,a,i,o);return s!=null&&(I=ot(I,s)),Dx(I,l,u,c)}const d=z(t,"x","conv2d","float32"),p=z(e,"filter","conv2d","float32");let f=d,g=!1;d.rank===3&&(g=!0,f=ve(d,[1,d.shape[0],d.shape[1],d.shape[2]])),V(f.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${f.rank}.`),V(p.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${p.rank}.`),Ei("fused conv2d",r,o);const y=a==="NHWC"?f.shape[3]:f.shape[1];V(p.shape[2]===y,()=>`Error in conv2d: depth of input (${y}) must match input depth for filter ${p.shape[2]}.`),V(jr(n,i),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`);const x=hr(f.shape,p.shape,n,i,r,o);let b;s!=null&&(b=z(s,"bias","fused conv2d"),[b]=En(b,d),a==="NHWC"?Nt(x.outShape,b.shape):(V(b.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${b.shape.length}.`),V(b.shape.length===0||b.shape[0]===x.outChannels||b.shape[0]===1,()=>`Error in fused conv2d: bias shape (${b.shape}) is not compatible with the number of output channels (${x.outChannels})`)));let v;if(u!=null){const I=u.shape;if(V(I.length<=1||I.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${I.length}.`),I.length===1)V(I[0]===1||I[0]===x.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${I}) is not compatible with the number of output channels (${x.outChannels}).`);else if(I.length===3)try{Nt(I,x.outShape)}catch{const _=`Error in fused conv2d: PReLU activation weights (${I}) is not compatible with the output shape of the conv2d (${x.outShape}).`;throw Error(_)}v=z(u,"prelu weights","fused conv2d")}const w=(I,_)=>{V(a==="NHWC",()=>`Error in gradient of fused conv2D: got dataFormat of ${a} but only NHWC is currently supported.`);const[E,A,M,L]=_,W=Ax(I,M,l);V(Pm(i),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${i}'`);const B=V8(A.shape,W,E,n,r),K=kce(A,W,E.shape,n,r),X=[B,K];if(L!=null){const Q=Px(L,W);X.push(Q)}return X},S={x:f,filter:p,bias:b,preluActivationWeights:v},C={strides:n,pad:r,dataFormat:a,dilations:i,dimRoundingMode:o,activation:l,leakyreluAlpha:c};return s==null?Do((I,_,E)=>{let A=te.runKernel(km,S,C);return E([_,I,A]),g&&(A=ve(A,[A.shape[1],A.shape[2],A.shape[3]])),{value:A,gradFunc:w}})(f,p):Do((I,_,E,A)=>{let M=te.runKernel(km,S,C);return A([_,I,M,E]),g&&(M=ve(M,[M.shape[1],M.shape[2],M.shape[3]])),{value:M,gradFunc:w}})(f,p,b)}const Cce=ee({fusedConv2d_:Sce});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Nce(t,e,n,r,a,i=[1,1],o){let s=t;t.rank===3&&(s=ve(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l=e;l.rank===3&&(l=ve(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const u={x:s,dy:l},c={strides:r,pad:a,dimRoundingMode:o,dilations:i,filterShape:n};return te.runKernel(Yb,u,c)}const Tce=ee({depthwiseConv2dNativeBackpropFilter_:Nce});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Ice(t,e,n,r,a,i=[1,1],o){let s=e,l=!1;e.rank===3&&(l=!0,s=ve(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const u={dy:s,filter:n},c={strides:r,pad:a,dimRoundingMode:o,dilations:i,inputShape:t},d=te.runKernel(Qb,u,c);return l?ve(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const Ece=ee({depthwiseConv2dNativeBackpropInput_:Ice});/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function _ce({x:t,filter:e,strides:n,pad:r,dataFormat:a="NHWC",dilations:i=[1,1],dimRoundingMode:o,bias:s,activation:l="linear",preluActivationWeights:u,leakyreluAlpha:c}){if(Lx(te.state.gradientDepth,l)===!1){let C=Sx(t,e,n,r,a,i,o);return s!=null&&(C=ot(C,s)),Dx(C,l,u,c)}const d=z(t,"x","depthwiseConv2d","float32"),p=z(e,"filter","depthwiseConv2d","float32");let f=d,g=!1;d.rank===3&&(g=!0,f=ve(d,[1,d.shape[0],d.shape[1],d.shape[2]])),V(f.rank===4,()=>`Error in fused depthwiseConv2d: input must be rank 4, but got rank ${f.rank}.`),V(p.rank===4,()=>`Error in fused depthwiseConv2d: filter must be rank 4, but got rank ${p.rank}.`),V(f.shape[3]===p.shape[2],()=>`Error in fused depthwiseConv2d: number of input channels (${f.shape[3]}) must match the inChannels dimension in filter ${p.shape[2]}.`),i==null&&(i=[1,1]),V(jr(n,i),()=>`Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`),Ei("fused depthwiseConv2d",r,o);const y=hr(f.shape,p.shape,n,i,r,o,!0);let x;s!=null&&(x=z(s,"bias","fused conv2d"),[x]=En(x,d),Nt(y.outShape,x.shape));let b;u!=null&&(b=z(u,"prelu weights","fused depthwiseConv2d"));const v=(C,I)=>{V(Pm(i),()=>`Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '${i}'`);const[_,E,A,M]=I,L=Ax(C,A,l),W=Ece(E.shape,L,_,n,r,i,o),B=Tce(E,L,_.shape,n,r,i,o);if(M!=null){const K=Px(x,L);return[W,B,K]}return[W,B]},w={x:f,filter:p,bias:x,preluActivationWeights:b},S={strides:n,pad:r,dataFormat:a,dilations:i,dimRoundingMode:o,activation:l,leakyreluAlpha:c};return s==null?Do((C,I,_)=>{let E=te.runKernel(Sm,w,S);return _([I,C,E]),g&&(E=ve(E,[E.shape[1],E.shape[2],E.shape[3]])),{value:E,gradFunc:v}})(f,p):Do((C,I,_,E)=>{let A=te.runKernel(Sm,w,S);return E([I,C,A,_]),g&&(A=ve(A,[A.shape[1],A.shape[2],A.shape[3]])),{value:A,gradFunc:v}})(f,p,x)}const Oce=ee({fusedDepthwiseConv2d_:_ce});/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function $ce({a:t,b:e,transposeA:n=!1,transposeB:r=!1,bias:a,activation:i="linear",preluActivationWeights:o,leakyreluAlpha:s=.2}){if(Lx(te.state.gradientDepth,i)===!1){let M=Gt(t,e,n,r);return a!=null&&(M=ot(M,a)),Dx(M,i,o,s)}let l=z(t,"a","fused matMul"),u=z(e,"b","fused matMul");[l,u]=En(l,u);const c=n?l.shape[l.rank-2]:l.shape[l.rank-1],d=r?u.shape[u.rank-1]:u.shape[u.rank-2],p=n?l.shape[l.rank-1]:l.shape[l.rank-2],f=r?u.shape[u.rank-2]:u.shape[u.rank-1],g=l.shape.slice(0,-2),y=u.shape.slice(0,-2),x=me(g),b=me(y);V(c===d,()=>`Error in fused matMul: inner shapes (${c}) and (${d}) of Tensors with shapes ${l.shape} and ${u.shape} and transposeA=${n} and transposeB=${r} must match.`);const v=Nt(l.shape.slice(0,-2),u.shape.slice(0,-2)).concat([p,f]),w=n?ve(l,[x,c,p]):ve(l,[x,p,c]),S=r?ve(u,[b,f,d]):ve(u,[b,d,f]);let C;a!=null&&(C=z(a,"bias","fused matMul"),[C]=En(C,l),Nt(v,C.shape));let I;o!=null&&(I=z(o,"prelu weights","fused matMul"));const _=(M,L)=>{const[W,B,K,X]=L,Q=Ax(ve(M,K.shape),K,i);let H,F;if(!n&&!r?(H=Gt(Q,B,!1,!0),F=Gt(W,Q,!0,!1)):!n&&r?(H=Gt(Q,B,!1,!1),F=Gt(Q,W,!0,!1)):n&&!r?(H=Gt(B,Q,!1,!0),F=Gt(W,Q,!1,!1)):(H=Gt(B,Q,!0,!0),F=Gt(Q,W,!0,!0)),a!=null){const Y=Px(X,Q);return[H,F,Y]}else return[H,F]},E={a:w,b:S,bias:C,preluActivationWeights:I},A={transposeA:n,transposeB:r,activation:i,leakyreluAlpha:s};return a==null?Do((M,L,W)=>{const B=te.runKernel(wm,E,A);return W([M,L,B]),{value:ve(B,v),gradFunc:_}})(w,S):Do((M,L,W,B)=>{const K=te.runKernel(wm,E,A);return B([M,L,K,W]),{value:ve(K,v),gradFunc:_}})(w,S,C)}const Rce=ee({fusedMatMul_:$ce});/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const kL=Object.freeze(Object.defineProperty({__proto__:null,conv2d:Cce,depthwiseConv2d:Oce,matMul:Rce},Symbol.toStringTag,{value:"Module"}));/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Mce(t){return Mx(t,.54,.46)}const Ace=ee({hammingWindow_:Mce});/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Pce(t){return Mx(t,.5,.5)}const SL=ee({hannWindow_:Pce});/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Dce(t,e,n,r=!1,a=0){let i=0;const o=[];for(;i+e<=t.size;)o.push(nn(t,i,e)),i+=n;if(r)for(;i<t.size;){const s=i+e-t.size,l=Ur([nn(t,i,e-s),Yd([s],a)]);o.push(l),i+=n}return o.length===0?rp([],[0,e]):ve(Ur(o),[o.length,e])}const CL=ee({frame_:Dce});/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Lce(t,e,n,r,a=SL){r==null&&(r=RI(e));const i=CL(t,e,n),o=$e(i,a(e));return $x(o,r)}const Fce=ee({stft_:Lce});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Bce(t,e,n,r,a="bilinear",i=0){const o=z(t,"image","cropAndResize"),s=z(e,"boxes","cropAndResize","float32"),l=z(n,"boxInd","cropAndResize","int32"),u=s.shape[0];V(o.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${o.rank}.`),V(s.rank===2&&s.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${u},4] but had shape ${s.shape}.`),V(l.rank===1&&l.shape[0]===u,()=>`Error in cropAndResize: boxInd must be have size [${u}] but had shape ${s.shape}.`),V(r.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${r.length}.`),V(r[0]>=1&&r[1]>=1,()=>`cropSize must be atleast [1,1], but was ${r}`),V(a==="bilinear"||a==="nearest",()=>`method must be bilinear or nearest, but was ${a}`);const c={image:o,boxes:s,boxInd:l},d={method:a,extrapolationValue:i,cropSize:r};return te.runKernel(Hb,c,d)}const zce=ee({cropAndResize_:Bce});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Vce(t){const e=z(t,"image","flipLeftRight","float32");V(e.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${e.rank}.`);const n={image:e};return te.runKernel(av,n,{})}const Wce=ee({flipLeftRight_:Vce});/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function jce(t){const e=z(t,"image","grayscaleToRGB"),n=e.rank-1,r=e.shape[n];V(e.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${e.rank}.`),V(r===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${r}.`);const a=new Array(e.rank);return a.fill(1,0,n),a[n]=3,Zd(e,a)}const Uce=ee({grayscaleToRGB_:jce});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Gce(t,e,n=0,r=.5){const a=z(t,"image","rotateWithOffset","float32");V(a.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${a.rank}.`);const i={image:a},o={radians:e,fillValue:n,center:r};return te.runKernel(ux,i,o)}const Hce=ee({rotateWithOffset_:Gce});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function ap(t,e,n,r,a,i){r==null&&(r=.5),a==null&&(a=Number.NEGATIVE_INFINITY),i==null&&(i=0);const o=t.shape[0];return n=Math.min(n,o),V(0<=r&&r<=1,()=>`iouThreshold must be in [0, 1], but was '${r}'`),V(t.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${t.rank}'`),V(t.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${t.shape[1]}`),V(e.rank===1,()=>"scores must be a 1D tensor"),V(e.shape[0]===o,()=>`scores has incompatible shape with boxes. Expected ${o}, but was ${e.shape[0]}`),V(0<=i&&i<=1,()=>`softNmsSigma must be in [0, 1], but was '${i}'`),{maxOutputSize:n,iouThreshold:r,scoreThreshold:a,softNmsSigma:i}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function qce(t,e,n,r=.5,a=Number.NEGATIVE_INFINITY){const i=z(t,"boxes","nonMaxSuppression","float32"),o=z(e,"scores","nonMaxSuppression","float32"),s=ap(i,o,n,r,a);n=s.maxOutputSize,r=s.iouThreshold,a=s.scoreThreshold;const l={maxOutputSize:n,iouThreshold:r,scoreThreshold:a};return te.runKernel(kv,{boxes:i,scores:o},l)}const Kce=ee({nonMaxSuppression_:qce});/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Xce(t,e,n){const r=Yce(t,e,n),a=r<0?-(r+1):r;t.splice(a,0,e)}function Yce(t,e,n){return Zce(t,e,n||Qce)}function Qce(t,e){return t>e?1:t<e?-1:0}function Zce(t,e,n){let r=0,a=t.length,i=0,o=!1;for(;r<a;){i=r+(a-r>>>1);const s=n(e,t[i]);s>0?r=i+1:(a=i,o=!s)}return o?r:-r-1}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Fx(t,e,n,r,a){return MI(t,e,n,r,a,0)}function Bx(t,e,n,r,a,i){return MI(t,e,n,r,a,0,!1,i,!0)}function zx(t,e,n,r,a,i){return MI(t,e,n,r,a,i,!0)}function MI(t,e,n,r,a,i,o=!1,s=!1,l=!1){const u=[];for(let x=0;x<e.length;x++)e[x]>a&&u.push({score:e[x],boxIndex:x,suppressBeginIndex:0});u.sort(NL);const c=i>0?-.5/i:0,d=[],p=[];for(;d.length<n&&u.length>0;){const x=u.pop(),{score:b,boxIndex:v,suppressBeginIndex:w}=x;if(b<a)break;let S=!1;for(let C=d.length-1;C>=w;--C){const I=Jce(t,v,d[C]);if(I>=r){S=!0;break}if(x.score=x.score*ede(r,c,I),x.score<=a)break}x.suppressBeginIndex=d.length,S||(x.score===b?(d.push(v),p.push(x.score)):x.score>a&&Xce(u,x,NL))}const f=d.length,g=n-f;s&&g>0&&(d.push(...new Array(g).fill(0)),p.push(...new Array(g).fill(0)));const y={selectedIndices:d};return o&&(y.selectedScores=p),l&&(y.validOutputs=f),y}function Jce(t,e,n){const r=t.subarray(e*4,e*4+4),a=t.subarray(n*4,n*4+4),i=Math.min(r[0],r[2]),o=Math.min(r[1],r[3]),s=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]),u=Math.min(a[0],a[2]),c=Math.min(a[1],a[3]),d=Math.max(a[0],a[2]),p=Math.max(a[1],a[3]),f=(s-i)*(l-o),g=(d-u)*(p-c);if(f<=0||g<=0)return 0;const y=Math.max(i,u),x=Math.max(o,c),b=Math.min(s,d),v=Math.min(l,p),w=Math.max(b-y,0)*Math.max(v-x,0);return w/(f+g-w)}function ede(t,e,n){const r=Math.exp(e*n*n);return n<=t?r:0}function NL(t,e){return t.score-e.score||t.score===e.score&&e.boxIndex-t.boxIndex}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/async function tde(t,e,n,r=.5,a=Number.NEGATIVE_INFINITY){const i=z(t,"boxes","nonMaxSuppressionAsync"),o=z(e,"scores","nonMaxSuppressionAsync"),s=ap(i,o,n,r,a);n=s.maxOutputSize,r=s.iouThreshold,a=s.scoreThreshold;const l=await Promise.all([i.data(),o.data()]),u=l[0],c=l[1],{selectedIndices:d}=Fx(u,c,n,r,a);return i!==t&&i.dispose(),o!==e&&o.dispose(),Oi(d,"int32")}const nde=tde;/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function rde(t,e,n,r=.5,a=Number.NEGATIVE_INFINITY,i=0){const o=z(t,"boxes","nonMaxSuppression"),s=z(e,"scores","nonMaxSuppression"),l=ap(o,s,n,r,a,i);n=l.maxOutputSize,r=l.iouThreshold,a=l.scoreThreshold,i=l.softNmsSigma;const u={boxes:o,scores:s},c={maxOutputSize:n,iouThreshold:r,scoreThreshold:a,softNmsSigma:i},d=te.runKernel(Cv,u,c);return{selectedIndices:d[0],selectedScores:d[1]}}const ade=ee({nonMaxSuppressionWithScore_:rde});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/async function ide(t,e,n,r=.5,a=Number.NEGATIVE_INFINITY,i=0){const o=z(t,"boxes","nonMaxSuppressionAsync"),s=z(e,"scores","nonMaxSuppressionAsync"),l=ap(o,s,n,r,a,i);n=l.maxOutputSize,r=l.iouThreshold,a=l.scoreThreshold,i=l.softNmsSigma;const u=await Promise.all([o.data(),s.data()]),c=u[0],d=u[1],{selectedIndices:p,selectedScores:f}=zx(c,d,n,r,a,i);return o!==t&&o.dispose(),s!==e&&s.dispose(),{selectedIndices:Oi(p,"int32"),selectedScores:Oi(f)}}const ode=ide;/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function sde(t,e,n,r=.5,a=Number.NEGATIVE_INFINITY,i=!1){const o=z(t,"boxes","nonMaxSuppression"),s=z(e,"scores","nonMaxSuppression"),l=ap(o,s,n,r,a,null),u=l.maxOutputSize,c=l.iouThreshold,d=l.scoreThreshold,p={boxes:o,scores:s},f={maxOutputSize:u,iouThreshold:c,scoreThreshold:d,padToMaxOutputSize:i},g=te.runKernel(Sv,p,f);return{selectedIndices:g[0],validOutputs:g[1]}}const lde=ee({nonMaxSuppressionPadded_:sde});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/async function ude(t,e,n,r=.5,a=Number.NEGATIVE_INFINITY,i=!1){const o=z(t,"boxes","nonMaxSuppressionAsync"),s=z(e,"scores","nonMaxSuppressionAsync"),l=ap(o,s,n,r,a,null),u=l.maxOutputSize,c=l.iouThreshold,d=l.scoreThreshold,[p,f]=await Promise.all([o.data(),s.data()]),{selectedIndices:g,validOutputs:y}=Bx(p,f,u,c,d,i);return o!==t&&o.dispose(),s!==e&&s.dispose(),{selectedIndices:Oi(g,"int32"),validOutputs:St(y,"int32")}}const cde=ude;/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function dde(t,e,n=!1,r=!1){const a=z(t,"images","resizeBilinear");V(a.rank===3||a.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${a.rank}.`),V(e.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${e}.`),V(r===!1||n===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let i=a,o=!1;a.rank===3&&(o=!0,i=ve(a,[1,a.shape[0],a.shape[1],a.shape[2]]));const s={images:i},l={alignCorners:n,halfPixelCenters:r,size:e},u=te.runKernel(Lv,s,l);return o?ve(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const pde=ee({resizeBilinear_:dde});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function hde(t,e,n=!1,r=!1){const a=z(t,"images","resizeNearestNeighbor");V(a.rank===3||a.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${a.rank}.`),V(e.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${e}.`),V(a.dtype==="float32"||a.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),V(r===!1||n===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let i=a,o=!1;a.rank===3&&(o=!0,i=ve(a,[1,a.shape[0],a.shape[1],a.shape[2]]));const s={images:i},l={alignCorners:n,halfPixelCenters:r,size:e},u=te.runKernel(Dv,s,l);return o?ve(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const fde=ee({resizeNearestNeighbor_:hde});/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* https://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function mde(t,e="binary",n=!1,r=.5){const a=z(t,"image","threshold"),i=.2989,o=.587,s=.114,l=a.shape[0]*a.shape[1];let u=$e(Oi([r]),255),c,d,p,f;if(V(a.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${a.rank}.`),V(a.shape[2]===3||a.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${a.shape[2]}.`),V(a.dtype==="int32"||a.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${a.dtype}.`),V(e==="otsu"||e==="binary",()=>`Method must be binary or otsu, but was ${e}`),a.shape[2]===3){[c,d,p]=np(a,[1,1,1],-1);const y=$e(c,i),x=$e(d,o),b=$e(p,s);f=ot(ot(y,x),b)}else f=t;if(e==="otsu"){const y=QT(wn(II(f),"int32"),lo([]),256);u=gde(y,l)}const g=n?Nx(f,u):zm(f,u);return wn($e(g,255),"int32")}function gde(t,e){let n=Oi([-1]),r=Oi([0]),a=Oi([0]),i,o,s,l,u,c;for(let d=0;d<t.size-1;d++){i=nn(t,0,d+1),o=nn(t,d+1),u=un(cn(i),e),c=un(cn(o),e);const p=cn($e(i,tp(0,i.size)));s=un(p,cn(i));const f=Yd(o.shape,i.size),g=ot(tp(0,o.size),f),y=$e(o,g);l=un(cn(y),cn(o));const x=xt(s,l),b=xt(s,l),v=$e(u,c);a=$e($e(v,x),b);const w=zm(a,r);r=ic(w,a,r),n=ic(w,Oi([d]),n)}return n}const yde=ee({threshold_:mde});/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function bde(t,e,n="nearest",r="constant",a=0,i){const o=z(t,"image","transform","float32"),s=z(e,"transforms","transform","float32");V(o.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${o.rank}.`),V(s.rank===2&&(s.shape[0]===o.shape[0]||s.shape[0]===1)&&s.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),V(i==null||i.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${i}.`);const l={image:o,transforms:s},u={interpolation:n,fillMode:r,fillValue:a,outputShape:i};return te.runKernel(rx,l,u)}const vde=ee({transform_:bde});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function xde(t,e,n){V(e%1===0,()=>`bandPart(): numLower must be an integer, got ${e}.`),V(n%1===0,()=>`bandPart(): numUpper must be an integer, got ${n}.`);const r=z(t,"a","bandPart");V(r.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${r.rank}.`);const a=r.shape,[i,o]=r.shape.slice(-2);if(!(e<=i))throw new Error(`bandPart(): numLower (${e}) must not be greater than the number of rows (${i}).`);if(!(n<=o))throw new Error(`bandPart(): numUpper (${n}) must not be greater than the number of columns (${o}).`);e<0&&(e=i),n<0&&(n=o);const s=ve(tp(0,i,1,"int32"),[-1,1]),l=tp(0,o,1,"int32"),u=xt(s,l),c=Vm(Nx(u,St(+e,"int32")),aI(u,St(-n,"int32"))),d=Fl([i,o],r.dtype);return ve(Lo(Vl(ve(r,[-1,i,o])).map(p=>ic(c,p,d))),a)}const wde=ee({bandPart_:xde});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function kde(t){let e;if(Array.isArray(t)){e=!1,V(t!=null&&t.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const a=t[0].shape[0];for(let i=1;i<t.length;++i)V(t[i].shape[0]===a,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${t[i].shape[0]} vs. ${a})`)}else e=!0,t=np(t,t.shape[0],0).map(a=>Gm(a,[0]));V(t.length<=t[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${t.length}) exceeds number of dimensions (${t[0].shape[0]}).`);const n=[],r=t;for(let a=0;a<t.length;++a)n.push(te.tidy(()=>{let i=r[a];if(a>0)for(let o=0;o<a;++o){const s=$e(cn($e(n[o],i)),n[o]);i=xt(i,s)}return un(i,Bm(i,"euclidean"))}));return e?Lo(n,0):n}const Sde=ee({gramSchmidt_:kde});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Cde(t,e=!1){if(V(t.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${t.rank}`),t.rank===2)return TL(t,e);{const n=t.shape.slice(0,t.shape.length-2).reduce((l,u)=>l*u),r=Vl(ve(t,[n,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),a=[],i=[];r.forEach(l=>{const[u,c]=TL(l,e);a.push(u),i.push(c)});const o=ve(Lo(a,0),t.shape),s=ve(Lo(i,0),t.shape);return[o,s]}}function TL(t,e=!1){return te.tidy(()=>{V(t.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${t.shape.length}D Tensor.`);const n=t.shape[0],r=t.shape[1];let a=tI(n),i=Is(t);const o=rp([[1]],[1,1]);let s=Is(o);const l=n>=r?r:n;for(let u=0;u<l;++u){const c=i,d=s,p=a;[s,i,a]=te.tidy(()=>{const f=nn(i,[u,u],[n-u,1]),g=Bm(f),y=nn(i,[u,u],[1,1]),x=ic(zm(y,0),rp([[-1]]),rp([[1]])),b=xt(y,$e(x,g)),v=un(f,b);v.shape[0]===1?s=Is(o):s=Ur([o,nn(v,[1,0],[v.shape[0]-1,v.shape[1]])],0);const w=Ao(un(Gt(x,b),g)),S=nn(i,[u,0],[n-u,r]),C=$e(w,s),I=Mm(s);if(u===0)i=xt(S,Gt(C,Gt(I,S)));else{const A=xt(S,Gt(C,Gt(I,S)));i=Ur([nn(i,[0,0],[u,r]),A],0)}const _=Mm(C),E=nn(a,[0,u],[n,a.shape[1]-u]);if(u===0)a=xt(E,Gt(Gt(E,s),_));else{const A=xt(E,Gt(Gt(E,s),_));a=Ur([nn(a,[0,0],[n,u]),A],1)}return[s,i,a]}),Wr([c,d,p])}return!e&&n>r&&(a=nn(a,[0,0],[n,r]),i=nn(i,[0,0],[r,r])),[a,i]})}const Nde=ee({qr_:Cde});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/var oa;(function(t){t[t.NONE=0]="NONE",t[t.MEAN=1]="MEAN",t[t.SUM=2]="SUM",t[t.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(oa||(oa={}));function Tde(t,e,n=oa.SUM_BY_NONZERO_WEIGHTS){const r=z(t,"losses","computeWeightedLoss");let a=null;e!=null&&(a=z(e,"weights","computeWeightedLoss"));const i=a==null?r:$e(r,a);if(n===oa.NONE)return i;if(n===oa.SUM)return cn(i);if(n===oa.MEAN){if(a==null)return Wm(i);{const o=r.size/a.size,s=un(cn(i),cn(a));return o>1?un(s,St(o)):s}}if(n===oa.SUM_BY_NONZERO_WEIGHTS){if(a==null)return un(cn(i),St(r.size));{const o=$e(a,Bl(r.shape)),s=wn(cn(fI(o,St(0))),"float32");return un(cn(i),s)}}throw Error(`Unknown reduction: ${n}`)}const Rs=ee({computeWeightedLoss_:Tde});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Ide(t,e,n,r=oa.SUM_BY_NONZERO_WEIGHTS){const a=z(t,"labels","absoluteDifference"),i=z(e,"predictions","absoluteDifference");let o=null;n!=null&&(o=z(n,"weights","absoluteDifference")),Sr(a.shape,i.shape,"Error in absoluteDifference: ");const s=za(xt(a,i));return Rs(s,o,r)}const Ede=ee({absoluteDifference_:Ide});function _de(t,e,n,r,a=oa.SUM_BY_NONZERO_WEIGHTS){const i=z(t,"labels","cosineDistance"),o=z(e,"predictions","cosineDistance");let s=null;r!=null&&(s=z(r,"weights","cosineDistance")),Sr(i.shape,o.shape,"Error in cosineDistance: ");const l=St(1),u=xt(l,cn($e(i,o),n,!0));return Rs(u,s,a)}const Ode=ee({cosineDistance_:_de});function $de(t,e,n,r=oa.SUM_BY_NONZERO_WEIGHTS){let a=z(t,"labels","hingeLoss");const i=z(e,"predictions","hingeLoss");let o=null;n!=null&&(o=z(n,"weights","hingeLoss")),Sr(a.shape,i.shape,"Error in hingeLoss: ");const s=St(1);a=xt($e(St(2),a),s);const l=jm(xt(s,$e(a,i)));return Rs(l,o,r)}const Rde=ee({hingeLoss_:$de});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Mde(t,e,n,r=1,a=oa.SUM_BY_NONZERO_WEIGHTS){const i=z(t,"labels","huberLoss"),o=z(e,"predictions","huberLoss");let s=null;n!=null&&(s=z(n,"weights","huberLoss")),Sr(i.shape,o.shape,"Error in huberLoss: ");const l=St(r),u=za(xt(o,i)),c=hI(u,l),d=xt(u,c),p=ot($e(St(.5),_i(c)),$e(l,d));return Rs(p,s,a)}const Ade=ee({huberLoss_:Mde});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Pde(t,e,n,r=1e-7,a=oa.SUM_BY_NONZERO_WEIGHTS){const i=z(t,"labels","logLoss"),o=z(e,"predictions","logLoss");let s=null;n!=null&&(s=z(n,"weights","logLoss")),Sr(i.shape,o.shape,"Error in logLoss: ");const l=St(1),u=St(r),c=Ao($e(i,Jd(ot(o,u)))),d=$e(xt(l,i),Jd(ot(xt(l,o),u))),p=xt(c,d);return Rs(p,s,a)}const Dde=ee({logLoss_:Pde});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Lde(t,e,n,r=oa.SUM_BY_NONZERO_WEIGHTS){const a=z(t,"labels","meanSquaredError"),i=z(e,"predictions","meanSquaredError");let o=null;n!=null&&(o=z(n,"weights","meanSquaredError")),Sr(a.shape,i.shape,"Error in meanSquaredError: ");const s=_I(a,i);return Rs(s,o,r)}const Fde=ee({meanSquaredError_:Lde});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Bde(t,e){const n=z(t,"labels","sigmoidCrossEntropyWithLogits"),r=z(e,"logits","sigmoidCrossEntropyWithLogits");Sr(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");const a=jm(r),i=$e(r,n),o=oI(Ll(Ao(za(r))));return ot(xt(a,i),o)}function zde(t,e,n,r=0,a=oa.SUM_BY_NONZERO_WEIGHTS){let i=z(t,"multiClassLabels","sigmoidCrossEntropy");const o=z(e,"logits","sigmoidCrossEntropy");let s=null;if(n!=null&&(s=z(n,"weights","sigmoidCrossEntropy")),Sr(i.shape,o.shape,"Error in sigmoidCrossEntropy: "),r>0){const u=St(r),c=St(1),d=St(.5);i=ot($e(i,xt(c,u)),$e(d,u))}const l=Bde(i,o);return Rs(l,s,a)}const Vde=ee({sigmoidCrossEntropy_:zde});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Wde(t,e,n=-1){if(n===-1&&(n=e.rank-1),n!==e.rank-1)throw Error(`Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ${e.rank} and dim was ${n}`);return Do((r,a,i)=>{const o=lI(a,[n],!0),s=xt(wn(a,"float32"),o);i([r,s]);const l=Ao($e(s,r));return{value:cn(l,[n]),gradFunc:(u,c)=>{const[d,p]=c,f=ar(u.shape,[n]);return[$e(ve(u,f),xt(wn(d,"float32"),Ll(p))),$e(ve(u,f),xt(Ll(p),wn(d,"float32")))]}}})(t,e)}function jde(t,e,n,r=0,a=oa.SUM_BY_NONZERO_WEIGHTS){let i=z(t,"onehotLabels","softmaxCrossEntropy");const o=z(e,"logits","softmaxCrossEntropy");let s=null;if(n!=null&&(s=z(n,"weights","softmaxCrossEntropy")),Sr(i.shape,o.shape,"Error in softmaxCrossEntropy: "),r>0){const u=St(r),c=St(1),d=St(i.shape[1]);i=ot($e(i,xt(c,u)),un(u,d))}const l=Wde(i,o);return Rs(l,s,a)}const Ude=ee({softmaxCrossEntropy_:jde});/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Gde(t,e,n,r){const a=z(t,"indices","sparseFillEmptyRows","int32"),i=z(e,"values","sparseFillEmptyRows"),o=z(n,"denseShape","sparseFillEmptyRows","int32"),s=z(r,"defaultValue","sparseFillEmptyRows",i.dtype);if(a.rank!==2)throw new Error(`Indices should be Tensor2D but received shape
        ${a.shape}`);if(i.rank!==1)throw new Error(`Values should be Tensor1D but received shape ${i.shape}`);if(o.rank!==1)throw new Error(`Dense shape should be Tensor1D but received shape ${o.shape}`);if(s.rank!==0)throw new Error(`Default value should be a scalar but received shape ${s.shape}`);const l={indices:a,values:i,denseShape:o,defaultValue:s},u=te.runKernel(qv,l);return{outputIndices:u[0],outputValues:u[1],emptyRowIndicator:u[2],reverseIndexMap:u[3]}}const Hde=ee({sparseFillEmptyRows_:Gde});/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function qde(t,e,n){const r=z(t,"inputIndices","sparseReshape","int32"),a=z(e,"inputShape","sparseReshape","int32"),i=z(n,"newShape","sparseReshape","int32");if(r.rank!==2)throw new Error(`Input indices should be Tensor2D but received shape
        ${r.shape}`);if(a.rank!==1)throw new Error(`Input shape should be Tensor1D but received shape ${a.shape}`);if(i.rank!==1)throw new Error(`New shape should be Tensor1D but received shape ${i.shape}`);const o={inputIndices:r,inputShape:a,newShape:i},s=te.runKernel(Kv,o);return{outputIndices:s[0],outputShape:s[1]}}const Kde=ee({sparseReshape_:qde});/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Xde(t,e,n){const r=z(t,"data","sparseSegmentMean"),a=z(e,"indices","sparseSegmentMean","int32"),i=z(n,"segmentIds","sparseSegmentMean","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(a.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
          ${a.shape}`);if(i.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
          ${i.shape}`);const o={data:r,indices:a,segmentIds:i};return te.runKernel(Xv,o)}const Yde=ee({sparseSegmentMean_:Xde});/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Qde(t,e,n){const r=z(t,"data","sparseSegmentSum"),a=z(e,"indices","sparseSegmentSum","int32"),i=z(n,"segmentIds","sparseSegmentSum","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(a.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
         ${a.shape}`);if(i.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
         ${i.shape}`);const o={data:r,indices:a,segmentIds:i};return te.runKernel(Yv,o)}const Zde=ee({sparseSegmentSum_:Qde});/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Jde(t,e,n,r,a,i,o,s){const l=z(t,"data","stringNGrams","string");if(l.dtype!=="string")throw new Error("Data must be of datatype string");if(l.shape.length!==1)throw new Error(`Data must be a vector, saw: ${l.shape}`);const u=z(e,"dataSplits","stringNGrams");if(u.dtype!=="int32")throw new Error("Data splits must be of datatype int32");const c={separator:n,nGramWidths:r,leftPad:a,rightPad:i,padWidth:o,preserveShortSequences:s},d={data:l,dataSplits:u},p=te.runKernel(Jv,d,c);return{nGrams:p[0],nGramsSplits:p[1]}}const epe=ee({stringNGrams_:Jde});/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function tpe(t,e,n=!0){const r=z(t,"input","stringSplit","string"),a=z(e,"delimiter","stringSplit","string");if(r.rank!==1)throw new Error(`Input should be Tensor1D but received shape ${r.shape}`);if(a.rank!==0)throw new Error(`Delimiter should be a scalar but received shape ${a.shape}`);const i={skipEmpty:n},o={input:r,delimiter:a},s=te.runKernel(ex,o,i);return{indices:s[0],values:s[1],shape:s[2]}}const npe=ee({stringSplit_:tpe});/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function rpe(t,e){const n=z(t,"input","stringToHashBucketFast","string"),r={numBuckets:e};if(e<=0)throw new Error("Number of buckets must be at least 1");const a={input:n};return te.runKernel(tx,a,r)}const ape=ee({stringToHashBucketFast_:rpe});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const IL={fft:Ox,ifft:Um,rfft:$x,irfft:EI},EL={hammingWindow:Ace,hannWindow:SL,frame:CL,stft:Fce},AI={flipLeftRight:Wce,grayscaleToRGB:Uce,resizeNearestNeighbor:fde,resizeBilinear:pde,rotateWithOffset:Hce,cropAndResize:zce,nonMaxSuppression:Kce,nonMaxSuppressionAsync:nde,nonMaxSuppressionWithScore:ade,nonMaxSuppressionWithScoreAsync:ode,nonMaxSuppressionPadded:lde,nonMaxSuppressionPaddedAsync:cde,threshold:yde,transform:vde},_L={bandPart:wde,gramSchmidt:Sde,qr:Nde},OL={absoluteDifference:Ede,computeWeightedLoss:Rs,cosineDistance:Ode,hingeLoss:Rde,huberLoss:Ade,logLoss:Dde,meanSquaredError:Fde,sigmoidCrossEntropy:Vde,softmaxCrossEntropy:Ude},$L={sparseFillEmptyRows:Hde,sparseReshape:Kde,sparseSegmentMean:Yde,sparseSegmentSum:Zde},RL={stringNGrams:epe,stringSplit:npe,stringToHashBucketFast:ape};/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class Wl extends h8{minimize(e,n=!1,r){const{value:a,grads:i}=this.computeGradients(e,r);if(r!=null){const o=r.map(s=>({name:s.name,tensor:i[s.name]}));this.applyGradients(o)}else this.applyGradients(i);return Wr(i),n?a:(a.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,n){return hD(e,n)}dispose(){this.iterations_!=null&&Wr(this.iterations_)}async saveIterations(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:St(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(e){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}}Object.defineProperty(Wl,Symbol.hasInstance,{value:t=>t.minimize!=null&&t.computeGradients!=null&&t.applyGradients!=null});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class Vx extends Wl{constructor(e,n,r=null){super(),this.learningRate=e,this.rho=n,this.epsilon=r,this.accumulatedGrads=[],this.accumulatedUpdates=[],r==null&&(this.epsilon=te.backend.epsilon())}applyGradients(e){(Array.isArray(e)?e.map(n=>n.name):Object.keys(e)).forEach((n,r)=>{const a=te.registeredVariables[n],i=!1;this.accumulatedGrads[r]==null&&(this.accumulatedGrads[r]={originalName:`${n}/accum_grad`,variable:Ot(()=>Va(a).variable(i))}),this.accumulatedUpdates[r]==null&&(this.accumulatedUpdates[r]={originalName:`${n}/accum_var`,variable:Ot(()=>Va(a).variable(i))});const o=Array.isArray(e)?e[r].tensor:e[n];if(o==null)return;const s=this.accumulatedGrads[r].variable,l=this.accumulatedUpdates[r].variable;Ot(()=>{const u=ot($e(s,this.rho),$e(_i(o),1-this.rho)),c=$e(un(Po(ot(l,this.epsilon)),Po(ot(s,this.epsilon))),o),d=ot($e(l,this.rho),$e(_i(c),1-this.rho));s.assign(u),l.assign(d);const p=ot($e(c,-this.learningRate),a);a.assign(p)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(Wr(this.accumulatedGrads.map(e=>e.variable)),Wr(this.accumulatedUpdates.map(e=>e.variable)))}async getWeights(){const e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=e.length/2,r=!1;this.accumulatedGrads=e.slice(0,n).map(a=>({originalName:a.name,variable:a.tensor.variable(r)})),this.accumulatedUpdates=e.slice(n,n*2).map(a=>({originalName:a.name,variable:a.tensor.variable(r)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,n){return new e(n.learningRate,n.rho,n.epsilon)}}Vx.className="Adadelta",Pl(Vx);/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class Wx extends Wl{constructor(e,n=.1){super(),this.learningRate=e,this.initialAccumulatorValue=n,this.accumulatedGrads=[]}applyGradients(e){(Array.isArray(e)?e.map(n=>n.name):Object.keys(e)).forEach((n,r)=>{const a=te.registeredVariables[n];this.accumulatedGrads[r]==null&&(this.accumulatedGrads[r]={originalName:`${n}/accumulator`,variable:Ot(()=>Yd(a.shape,this.initialAccumulatorValue).variable(!1))});const i=Array.isArray(e)?e[r].tensor:e[n];if(i==null)return;const o=this.accumulatedGrads[r].variable;Ot(()=>{const s=ot(o,_i(i));o.assign(s);const l=ot($e(un(i,Po(ot(s,te.backend.epsilon()))),-this.learningRate),a);a.assign(l)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&Wr(this.accumulatedGrads.map(e=>e.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=!1;this.accumulatedGrads=e.map(r=>({originalName:r.name,variable:r.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,n){return new e(n.learningRate,n.initialAccumulatorValue)}}Wx.className="Adagrad",Pl(Wx);/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class jx extends Wl{constructor(e,n,r,a=null){super(),this.learningRate=e,this.beta1=n,this.beta2=r,this.epsilon=a,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],Ot(()=>{this.accBeta1=St(n).variable(),this.accBeta2=St(r).variable()}),a==null&&(this.epsilon=te.backend.epsilon())}applyGradients(e){const n=Array.isArray(e)?e.map(r=>r.name):Object.keys(e);Ot(()=>{const r=xt(1,this.accBeta1),a=xt(1,this.accBeta2);n.forEach((i,o)=>{const s=te.registeredVariables[i],l=!1;this.accumulatedFirstMoment[o]==null&&(this.accumulatedFirstMoment[o]={originalName:`${i}/m`,variable:Ot(()=>Va(s).variable(l))}),this.accumulatedSecondMoment[o]==null&&(this.accumulatedSecondMoment[o]={originalName:`${i}/v`,variable:Ot(()=>Va(s).variable(l))});const u=Array.isArray(e)?e[o].tensor:e[i];if(u==null)return;const c=this.accumulatedFirstMoment[o].variable,d=this.accumulatedSecondMoment[o].variable,p=ot($e(c,this.beta1),$e(u,1-this.beta1)),f=ot($e(d,this.beta2),$e(_i(u),1-this.beta2)),g=un(p,r),y=un(f,a);c.assign(p),d.assign(f);const x=ot($e(un(g,ot(Po(y),this.epsilon)),-this.learningRate),s);s.assign(x)}),this.accBeta1.assign($e(this.accBeta1,this.beta1)),this.accBeta2.assign($e(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&Wr(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedSecondMoment!=null&&Wr(this.accumulatedSecondMoment.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e),Ot(()=>{this.accBeta1.assign(Qd(this.beta1,this.iterations_+1)),this.accBeta2.assign(Qd(this.beta2,this.iterations_+1))});const n=e.length/2,r=!1;this.accumulatedFirstMoment=e.slice(0,n).map(a=>({originalName:a.name,variable:a.tensor.variable(r)})),this.accumulatedSecondMoment=e.slice(n,n*2).map(a=>({originalName:a.name,variable:a.tensor.variable(r)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon)}}jx.className="Adam",Pl(jx);/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class Ux extends Wl{constructor(e,n,r,a=null,i=0){super(),this.learningRate=e,this.beta1=n,this.beta2=r,this.epsilon=a,this.decay=i,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],Ot(()=>{this.iteration=St(0).variable(),this.accBeta1=St(n).variable()}),a==null&&(this.epsilon=te.backend.epsilon())}applyGradients(e){const n=Array.isArray(e)?e.map(r=>r.name):Object.keys(e);Ot(()=>{const r=xt(1,this.accBeta1),a=un(-this.learningRate,ot($e(this.iteration,this.decay),1));n.forEach((i,o)=>{const s=te.registeredVariables[i],l=!1;this.accumulatedFirstMoment[o]==null&&(this.accumulatedFirstMoment[o]={originalName:`${i}/m`,variable:Va(s).variable(l)}),this.accumulatedWeightedInfNorm[o]==null&&(this.accumulatedWeightedInfNorm[o]={originalName:`${i}/v`,variable:Va(s).variable(l)});const u=Array.isArray(e)?e[o].tensor:e[i];if(u==null)return;const c=this.accumulatedFirstMoment[o].variable,d=this.accumulatedWeightedInfNorm[o].variable,p=ot($e(c,this.beta1),$e(u,1-this.beta1)),f=$e(d,this.beta2),g=za(u),y=pI(f,g);c.assign(p),d.assign(y);const x=ot($e(un(a,r),un(p,ot(y,this.epsilon))),s);s.assign(x)}),this.iteration.assign(ot(this.iteration,1)),this.accBeta1.assign($e(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&Wr(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedWeightedInfNorm!=null&&Wr(this.accumulatedWeightedInfNorm.map(e=>e.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon,n.decay)}}Ux.className="Adamax",Pl(Ux);/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class Hm extends Wl{constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){(Array.isArray(e)?e.map(n=>n.name):Object.keys(e)).forEach((n,r)=>{const a=Array.isArray(e)?e[r].tensor:e[n];if(a==null)return;const i=te.registeredVariables[n];Ot(()=>{const o=ot($e(this.c,a),i);i.assign(o)})}),this.incrementIterations()}setLearningRate(e){this.learningRate=e,this.c!=null&&this.c.dispose(),this.c=Mo(St(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(e=await this.extractIterations(e),e.length!==0)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,n){return new e(n.learningRate)}}Hm.className="SGD",Pl(Hm);/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class Gx extends Hm{constructor(e,n,r=!1){super(e),this.learningRate=e,this.momentum=n,this.useNesterov=r,this.accumulations=[],this.m=St(this.momentum)}applyGradients(e){(Array.isArray(e)?e.map(n=>n.name):Object.keys(e)).forEach((n,r)=>{const a=te.registeredVariables[n];this.accumulations[r]==null&&(this.accumulations[r]={originalName:`${n}/momentum`,variable:Ot(()=>Va(a).variable(!1))});const i=this.accumulations[r].variable,o=Array.isArray(e)?e[r].tensor:e[n];o!=null&&Ot(()=>{let s;const l=ot($e(this.m,i),o);this.useNesterov?s=ot($e(this.c,ot(o,$e(l,this.m))),a):s=ot($e(this.c,l),a),i.assign(l),a.assign(s)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&Wr(this.accumulations.map(e=>e.variable))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=!1;this.accumulations=e.map(r=>({originalName:r.name,variable:r.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,n){return new e(n.learningRate,n.momentum,n.useNesterov)}}Gx.className="Momentum",Pl(Gx);/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class Hx extends Wl{constructor(e,n=.9,r=0,a=null,i=!1){if(super(),this.learningRate=e,this.decay=n,this.momentum=r,this.epsilon=a,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=i,a==null&&(this.epsilon=te.backend.epsilon()),e==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(e){(Array.isArray(e)?e.map(n=>n.name):Object.keys(e)).forEach((n,r)=>{const a=te.registeredVariables[n],i=!1;this.accumulatedMeanSquares[r]==null&&(this.accumulatedMeanSquares[r]={originalName:`${n}/rms`,variable:Ot(()=>Va(a).variable(i))}),this.accumulatedMoments[r]==null&&(this.accumulatedMoments[r]={originalName:`${n}/momentum`,variable:Ot(()=>Va(a).variable(i))}),this.accumulatedMeanGrads[r]==null&&this.centered&&(this.accumulatedMeanGrads[r]={originalName:`${n}/mg`,variable:Ot(()=>Va(a).variable(i))});const o=Array.isArray(e)?e[r].tensor:e[n];if(o==null)return;const s=this.accumulatedMeanSquares[r].variable,l=this.accumulatedMoments[r].variable;Ot(()=>{const u=ot($e(s,this.decay),$e(_i(o),1-this.decay));if(this.centered){const c=this.accumulatedMeanGrads[r].variable,d=ot($e(c,this.decay),$e(o,1-this.decay)),p=un($e(o,this.learningRate),Po(xt(u,ot(_i(d),this.epsilon)))),f=ot($e(l,this.momentum),p);s.assign(u),c.assign(d),l.assign(f);const g=xt(a,f);a.assign(g)}else{const c=ot($e(s,this.decay),$e(_i(o),1-this.decay)),d=ot($e(l,this.momentum),un($e(o,this.learningRate),Po(ot(c,this.epsilon))));s.assign(c),l.assign(d);const p=xt(a,d);a.assign(p)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&Wr(this.accumulatedMeanSquares.map(e=>e.variable)),this.accumulatedMeanGrads!=null&&this.centered&&Wr(this.accumulatedMeanGrads.map(e=>e.variable)),this.accumulatedMoments!=null&&Wr(this.accumulatedMoments.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=this.centered?e.length/3:e.length/2,r=!1;this.accumulatedMeanSquares=e.slice(0,n).map(a=>({originalName:a.name,variable:a.tensor.variable(r)})),this.accumulatedMoments=e.slice(n,n*2).map(a=>({originalName:a.name,variable:a.tensor.variable(r)})),this.centered&&(this.accumulatedMeanGrads=e.slice(n*2,n*3).map(a=>({originalName:a.name,variable:a.tensor.variable(r)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,n){return new e(n.learningRate,n.decay,n.momentum,n.epsilon,n.centered)}}Hx.className="RMSProp",Pl(Hx);/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class jl{static sgd(e){return new Hm(e)}static momentum(e,n,r=!1){return new Gx(e,n,r)}static rmsprop(e,n=.9,r=0,a=null,i=!1){return new Hx(e,n,r,a,i)}static adam(e=.001,n=.9,r=.999,a=null){return new jx(e,n,r,a)}static adadelta(e=.001,n=.95,r=null){return new Vx(e,n,r)}static adamax(e=.002,n=.9,r=.999,a=null,i=0){return new Ux(e,n,r,a,i)}static adagrad(e,n=.1){return new Wx(e,n)}}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const ipe={sgd:jl.sgd,momentum:jl.momentum,adadelta:jl.adadelta,adagrad:jl.adagrad,rmsprop:jl.rmsprop,adamax:jl.adamax,adam:jl.adam};/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const ope=typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:t=>t();function ML(){return new Promise(t=>ope(()=>t()))}/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function PI(t,e){const n=t[0].length;t.forEach((a,i)=>{V(a.length===n,()=>`Error in concat${n}D: rank of tensors[${i}] must be the same as the rank of the rest (${n})`)}),V(e>=0&&e<n,()=>`Error in concat${n}D: axis must be between 0 and ${n-1}.`);const r=t[0];t.forEach((a,i)=>{for(let o=0;o<n;o++)V(o===e||a[o]===r[o],()=>`Error in concat${n}D: Shape of tensors[${i}] (${a}) does not match the shape of the rest (${r}) along the non-concatenated axis ${i}.`)})}function Fo(t,e){const n=t[0].slice();for(let r=1;r<t.length;r++)n[e]+=t[r][e];return n}/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/var uo;(function(t){t[t.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",t[t.VALUE_ROWIDS=1]="VALUE_ROWIDS",t[t.ROW_LENGTHS=2]="ROW_LENGTHS",t[t.ROW_SPLITS=3]="ROW_SPLITS",t[t.ROW_LIMITS=4]="ROW_LIMITS",t[t.ROW_STARTS=5]="ROW_STARTS"})(uo||(uo={}));function AL(t,e,n){let r=new Array;if(n==null&&e==null)return r;if(e==null)for(;r.length<t+n.length;)r.push(-1);else r=e.slice();if(n==null)return r;if(t+n.length!==r.length)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.rank = ${t+n.length}, but shape.rank = ${r.length}`);for(let a=1;a<n.length;++a){const i=n[a],o=r[r.length-n.length+a],s=r[o];if(i>=0)if(s>=0){if(s!==i)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.shape[${a+t}] = ${i} but shape[${a+t}] = ${s}`)}else r[o]=i}return r}function PL(t){const e={FIRST_DIM_SIZE:uo.FIRST_DIM_SIZE,VALUE_ROWIDS:uo.VALUE_ROWIDS,ROW_LENGTHS:uo.ROW_LENGTHS,ROW_SPLITS:uo.ROW_SPLITS,ROW_LIMITS:uo.ROW_LIMITS,ROW_STARTS:uo.ROW_STARTS},n=[];for(const r of t)if(r in e)n.push(e[r]);else break;return n}function DL(t){return t.length===0?0:t[0]===uo.FIRST_DIM_SIZE?t.length-1:t.length}function LL(t,e){if(t==null||e==null)return;const n=t.length,r=e.length;if(n>=r)throw new Error(`defaultValue.shape=${t} and ragged tensor flatValues.shape=${e}, are incompatible: defaultValue.rank = ${n} must be less than ragged tensor input flatValues.rank = ${r})`);for(let a=0;a<Math.min(n,r-1);++a){const i=t[a],o=e[a+1];if(i>=0&&o>=0&&i!==1&&i!==o)throw new Error(`defaultValue.shape=${t}, and ragged tensor input flatValues.shape=${e} are incompatible: defaultValue.shape[${a-t.length}] = ${i} but ragged tensor input.flatValues.shape[${a-t.length}] = ${o}`)}}/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const DI=30;function qx(t){return t<=DI?t:kb(t,Math.floor(Math.sqrt(t)))}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function LI(t,e,n){const r=n*(typeof t=="number"?t:t[0]),a=e*(typeof t=="number"?t:t[1]);return[r,a]}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function qm(t,e,n,r=!0){let a=[];if(r)a=a.concat(e.slice(0)),a.push(t[0]/n),a=a.concat(t.slice(1));else{a=a.concat(t[0]);const i=e.length;for(let o=0;o<i;++o)a=a.concat([t[o+1]/e[o],e[o]]);a=a.concat(t.slice(i+1))}return a}function Km(t,e,n=!0){const r=[];if(n){r.push(e);for(let a=e+1;a<t;++a)a<=2*e?(r.push(a),r.push(a-(e+1))):r.push(a)}else{const a=[],i=[];for(let o=1;o<t;++o)o>=e*2+1||o%2===1?i.push(o):a.push(o);r.push(...a),r.push(0),r.push(...i)}return r}function Xm(t,e,n,r=!0){const a=[];r?a.push(t[0]/n):a.push(t[0]*n);for(let i=1;i<t.length;++i)i<=e.length?r?a.push(e[i-1]*t[i]):a.push(t[i]/e[i-1]):a.push(t[i]);return a}function FI(t,e){const n=[0];for(let r=0;r<e;++r)n.push(t[r][0]);return n}function BI(t,e,n){const r=t.slice(0,1);for(let a=0;a<n;++a)r.push(t[a+1]-e[a][0]-e[a][1]);return r}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const zI=1.7580993408473768,VI=1.0507009873554805;/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const WI=.3275911,jI=.254829592,UI=-.284496736,GI=1.421413741,HI=-1.453152027,qI=1.061405429;/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Ms(t,e){if(t.length!==e.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${t.length}, imag: ${e.length}.`);const n=new Float32Array(t.length*2);for(let r=0;r<n.length;r+=2)n[r]=t[r/2],n[r+1]=e[r/2];return n}function FL(t){const e=new Float32Array(t.length/2),n=new Float32Array(t.length/2);for(let r=0;r<t.length;r+=2)e[r/2]=t[r],n[r/2]=t[r+1];return{real:e,imag:n}}function BL(t){const e=Math.ceil(t.length/4),n=new Float32Array(e),r=new Float32Array(e);for(let a=0;a<t.length;a+=4)n[Math.floor(a/4)]=t[a],r[Math.floor(a/4)]=t[a+1];return{real:n,imag:r}}function zL(t){const e=Math.floor(t.length/4),n=new Float32Array(e),r=new Float32Array(e);for(let a=2;a<t.length;a+=4)n[Math.floor(a/4)]=t[a],r[Math.floor(a/4)]=t[a+1];return{real:n,imag:r}}function KI(t,e){const n=t[e*2],r=t[e*2+1];return{real:n,imag:r}}function VL(t,e,n,r){t[r*2]=e,t[r*2+1]=n}function WL(t,e){const n=new Float32Array(t/2),r=new Float32Array(t/2);for(let a=0;a<Math.ceil(t/2);a++){const i=(e?2:-2)*Math.PI*(a/t);n[a]=Math.cos(i),r[a]=Math.sin(i)}return{real:n,imag:r}}function jL(t,e,n){const r=(n?2:-2)*Math.PI*(t/e),a=Math.cos(r),i=Math.sin(r);return{real:a,imag:i}}/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const XI="->",spe=/->/g,UL=",",GL="...";function YI(t,e){t=t.replace(/\s/g,"");const n=(t.length-t.replace(spe,"").length)/XI.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error(`Equation must contain exactly one arrow ("${XI}").`);const[r,a]=t.split(XI);V(r.indexOf(GL)===-1,()=>`The ellipsis notation ("${GL}") is not supported yet.`);const i=r.split(UL),o=i.length;if(e!==o)throw new Error(`Expected ${o} input tensors, received ${e}`);if(o>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const s=[];for(let p=0;p<a.length;++p){const f=a[p];if(!i.some(g=>g.indexOf(f)!==-1))throw new Error(`Output subscripts contain the label ${f} not present in the input subscripts.`);s.indexOf(f)===-1&&s.push(f)}for(let p=0;p<r.length;++p){const f=r[p];s.indexOf(f)===-1&&f!==UL&&s.push(f)}const l=new Array(i.length);for(let p=0;p<o;++p){if(new Set(i[p].split("")).size!==i[p].length)throw new Error(`Found duplicate axes in input component ${i[p]}. Support for duplicate axes in input is not implemented yet.`);l[p]=[];for(let f=0;f<i[p].length;++f)l[p].push(s.indexOf(i[p][f]))}const u=s.length,c=a.length,d=[];for(let p=c;p<u;++p)d.push(p);return{allDims:s,summedDims:d,idDims:l}}function QI(t,e){let n=new Array(t);n.fill(-1);for(let a=0;a<e.length;++a)n[e[a]]=a;const r=[];for(let a=0;a<t;++a)n[a]===-1&&r.push(a);return n=n.filter(a=>a!==-1),{permutationIndices:n,expandDims:r}}function ZI(t,e,n){const r=new Array(t);for(let a=0;a<n.length;++a){const i=n[a].shape;for(let o=0;o<e[a].length;++o)r[e[a][o]]===void 0?r[e[a][o]]=i[o]:V(r[e[a][o]]===i[o],()=>`Expected dimension ${r[e[a][o]]} at axis ${o} of input shaped ${JSON.stringify(i)}, but got dimension ${i[o]}`)}}function JI(t,e){const n=t,r=[];let a=0;t.length===0&&n.push(-1),a=t.length+1;for(let o=0;o<a;++o)r.push([]);const i=[];for(let o=0;o<n.length;++o){const s=n[o],l=lpe(e,s);for(const u of l)i.indexOf(u)===-1&&(r[o].push(u),i.push(u))}return{path:n,steps:r}}function e4(t){return t.every((e,n)=>e===n)}function lpe(t,e){const n=[];for(let r=0;r<t.length;++r)(t[r].length===0||t[r].indexOf(e)!==-1||e===-1)&&n.push(r);return n}function t4(t,e,n=0){let r=[];if(typeof e=="number")V(t.shape[n]%e===0,()=>"Number of splits must evenly divide the axis."),r=new Array(e).fill(t.shape[n]/e);else{const a=e.reduce((o,s)=>(s===-1&&(o+=1),o),0);V(a<=1,()=>"There should be only one negative value in split array.");const i=e.indexOf(-1);if(i!==-1){const o=e.reduce((s,l)=>l>0?s+l:s);e[i]=t.shape[n]-o}V(t.shape[n]===e.reduce((o,s)=>o+s),()=>"The sum of sizes must match the size of the axis dimension."),r=e}return r}/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function HL(t){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${t}`}function qL(t,e){return`indices(${t}, 0) is invalid: ${e} < 0`}function KL(t,e,n){return`indices(${t}, 0) is invalid: ${e} >= ${n}`}/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function XL(t,e){return`only one output dimension may be -1, not both ${t} and ${e}`}function YL(t,e){return`size ${t} must be non-negative, not ${e}`}function QL(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function ZL(t,e){const n=me(t),r=me(e);return`Input to reshape is a SparseTensor with ${n}
  dense values, but the requested shape requires a multiple of ${r}. inputShape=${t} outputShape= ${e}`}function JL(t,e){const n=me(t),r=me(e);return`Input to reshape is a tensor with ${n} dense values, but the requested shape has ${r}. inputShape=${t} outputShape=${e}`}/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function n4(){return"segment ids must be >= 0"}function eF(){return"segment ids are not increasing"}function tF(t,e){return`Segment id ${t} out of range [0, ${e}), possibly because segmentIds input is not sorted.`}function nF(t,e,n){return`Bad: indices[${t}] == ${e} out of range [0, ${n})`}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function rF(t,e){let n=!1,r;for(t<=DI?(r=t,n=!0):r=kb(t,Math.floor(Math.sqrt(t)));!n;)r>e||r===t?n=!0:r=kb(t,r+1);return r}function aF(t,e,n){const r=[],a=t.length;for(let i=0;i<a;i++)i!==e?r.push(t[i]):r.push(n);return r}function r4(t,e,n,r){const a=e.shape.length,i=t.shape.length;if(r!==0&&(r<-a||r>a))throw new Error(`Expect batchDims in the range of [-${a}, ${a}], but got ${r}`);if(r<0&&(r+=a),r>i)throw new Error(`batchDims (${r}) must be less than rank(x) (
    ${i}).`);if(n<r)throw new Error(`batchDims (${r}) must be less than or equal to axis (${n}).`);for(let d=0;d<r;++d)if(t.shape[d]!==e.shape[d])throw new Error(`x.shape[${d}]: ${t.shape[d]} should be equal to indices.shape[${d}]: ${e.shape[d]}.`);const o=t.shape[n],s=[];let l=1,u=1,c=1;for(let d=0;d<r;++d)s.push(t.shape[d]),l*=t.shape[d];for(let d=r;d<n;d++)s.push(t.shape[d]),u*=t.shape[d];for(let d=r;d<a;d++)s.push(e.shape[d]);for(let d=n+1;d<i;d++)s.push(t.shape[d]),c*=t.shape[d];return{batchSize:l,sliceSize:c,outerSize:u,dimSize:o,outputShape:s}}const upe=Object.freeze(Object.defineProperty({__proto__:null,collectGatherOpShapeInfo:r4,computeOutShape:aF,segOpComputeOptimalWindowSize:rF},Symbol.toStringTag,{value:"Module"}));/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function lc(t){try{return t.map(e=>Cs(e))}catch(e){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${e}`)}}function iF(t){return t.map(e=>$o(e))}const oF=Object.freeze(Object.defineProperty({__proto__:null,ERF_A1:jI,ERF_A2:UI,ERF_A3:GI,ERF_A4:HI,ERF_A5:qI,ERF_P:WI,PARALLELIZE_THRESHOLD:DI,get RowPartitionType(){return uo},SELU_SCALE:VI,SELU_SCALEALPHA:zI,applyActivation:Dx,assertAndGetBroadcastShape:Nt,assertAxesAreInnerMostDims:Tr,assertParamsConsistent:PI,assignToTypedArray:VL,axesAreInnerMostDims:eI,calculateShapes:qd,checkEinsumDimSizes:ZI,checkPadOnDimRoundingMode:Ei,combineLocations:rD,combineRaggedTensorToTensorShapes:AL,complexWithEvenIndex:BL,complexWithOddIndex:zL,computeConv2DInfo:hr,computeConv3DInfo:Dl,computeDefaultPad:qT,computeDilation2DInfo:Am,computeOptimalWindowSize:qx,computeOutAndReduceShapes:Nr,computeOutShape:Fo,computePool2DInfo:Ii,computePool3DInfo:_s,convertConv2DDataFormat:Os,decodeEinsumEquation:YI,eitherStridesOrDilationsAreOne:jr,expandShapeToKeepDim:ar,exponent:jL,exponents:WL,fromStringArrayToUint8:iF,fromUint8ToStringArray:lc,getAxesPermutation:jn,getBroadcastDims:tc,getComplexWithIndex:KI,getEinsumComputePath:JI,getEinsumPermutation:QI,getFusedBiasGradient:Px,getFusedDyActivation:Ax,getImageCenter:LI,getInnerMostAxes:Un,getPermuted:Km,getRaggedRank:DL,getReductionAxes:RT,getReshaped:qm,getReshapedPermuted:Xm,getRowPartitionTypesHelper:PL,getSliceBeginCoords:FI,getSliceSize:BI,getSparseFillEmptyRowsIndicesDenseShapeMismatch:HL,getSparseFillEmptyRowsNegativeIndexErrorMessage:qL,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:KL,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:QL,getSparseReshapeInputOutputMismatchErrorMessage:JL,getSparseReshapeInputOutputMultipleErrorMessage:ZL,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:XL,getSparseReshapeNegativeOutputDimErrorMessage:YL,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:nF,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:n4,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:eF,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:tF,getUndoAxesPermutation:Fm,isIdentityPermutation:e4,log:sae,mergeRealAndImagArrays:Ms,prepareAndValidate:xx,prepareSplitSize:t4,segment_util:upe,shouldFuse:Lx,slice_util:p8,splitRealAndImagArrays:FL,tupleValuesAreOne:Pm,upcastType:ka,validateDefaultValueShape:LL,validateInput:PT,validateUpdateShape:AT,warn:ai},Symbol.toStringTag,{value:"Module"}));/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const cpe=Object.freeze(Object.defineProperty({__proto__:null,nonMaxSuppressionV3Impl:Fx,nonMaxSuppressionV4Impl:Bx,nonMaxSuppressionV5Impl:zx,whereImpl:Rx},Symbol.toStringTag,{value:"Module"}));/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const dpe=Object.freeze(Object.defineProperty({__proto__:null,Abs:Cb,Acos:bf,Acosh:vf,AdadeltaOptimizer:Vx,AdagradOptimizer:Wx,AdamOptimizer:jx,AdamaxOptimizer:Ux,Add:Fd,AddN:Nb,All:Tb,Any:Ib,ArgMax:Eb,ArgMin:_b,Asin:xf,Asinh:wf,Atan:kf,Atan2:Cf,Atanh:Sf,AvgPool:Ob,AvgPool3D:$b,AvgPool3DGrad:j3,AvgPoolGrad:W3,BatchMatMul:Rb,BatchToSpaceND:Mb,Bincount:Ab,BroadcastArgs:Pb,BroadcastTo:tae,Cast:Nf,Ceil:Tf,ClipByValue:If,Complex:Db,ComplexAbs:Lb,Concat:Fb,Conv2D:Bb,Conv2DBackpropFilter:zb,Conv2DBackpropInput:Vb,Conv3D:Wb,Conv3DBackpropFilterV2:U3,Conv3DBackpropInputV2:jb,Cos:Ef,Cosh:_f,CropAndResize:Hb,Cumprod:Ub,Cumsum:Gb,DataStorage:M3,DenseBincount:qb,DepthToSpace:Kb,DepthwiseConv2dNative:Xb,DepthwiseConv2dNativeBackpropFilter:Yb,DepthwiseConv2dNativeBackpropInput:Qb,Diag:Zb,Dilation2D:Jb,Dilation2DBackpropFilter:H3,Dilation2DBackpropInput:G3,get ENV(){return B3},Einsum:ev,Elu:$f,EluGrad:q3,Environment:uP,Equal:Mf,Erf:Rf,Exp:Af,ExpandDims:tv,Expm1:Pf,FFT:nv,Fill:rv,FlipLeftRight:av,Floor:Df,FloorDiv:Lf,FromPixels:lx,FusedBatchNorm:iv,FusedConv2D:km,FusedDepthwiseConv2D:Sm,GatherNd:sv,GatherV2:ov,Greater:Ff,GreaterEqual:Bf,IFFT:lv,Identity:zf,Imag:uv,IsFinite:Vf,IsInf:Wf,IsNan:jf,KernelBackend:bb,LRN:pv,LRNGrad:K3,LeakyRelu:cv,Less:Uf,LessEqual:Gf,LinSpace:dv,Log:Hf,Log1p:qf,LogSoftmax:rae,LogicalAnd:Kf,LogicalNot:Xf,LogicalOr:Yf,LogicalXor:nae,LowerBound:aae,Max:hv,MaxPool:fv,MaxPool3D:mv,MaxPool3DGrad:Y3,MaxPoolGrad:X3,MaxPoolWithArgmax:gv,Maximum:Qf,Mean:yv,Min:bv,Minimum:Zf,MirrorPad:vv,Mod:Jf,MomentumOptimizer:Gx,Multinomial:xv,Multiply:em,Neg:wv,NonMaxSuppressionV3:kv,NonMaxSuppressionV4:Sv,NonMaxSuppressionV5:Cv,NotEqual:tm,OP_SCOPE_SUFFIX:gT,OneHot:Tv,OnesLike:Nv,Optimizer:Wl,OptimizerConstructors:jl,Pack:Iv,PadV2:Ev,Pool:iae,Pow:nm,Prelu:_v,Prod:Ov,RMSPropOptimizer:Hx,RaggedGather:$v,RaggedTensorToTensor:Rv,Range:Mv,get Rank(){return oT},Real:Av,RealDiv:Of,Reciprocal:rm,get Reduction(){return oa},Relu:am,Relu6:im,Reshape:Pv,ResizeBilinear:Lv,ResizeBilinearGrad:Z3,ResizeNearestNeighbor:Dv,ResizeNearestNeighborGrad:Q3,Reverse:Fv,RotateWithOffset:ux,Round:om,Rsqrt:sm,SGDOptimizer:Hm,ScatterNd:Bv,SearchSorted:zv,Select:Vv,Selu:lm,Sigmoid:pm,Sign:dm,Sin:um,Sinh:cm,Slice:Wv,Softmax:Hv,Softplus:hm,SpaceToBatchND:Uv,SparseFillEmptyRows:qv,SparseReshape:Kv,SparseSegmentMean:Xv,SparseSegmentSum:Yv,SparseToDense:Qv,SplitV:Gv,Sqrt:fm,Square:J3,SquaredDifference:mm,Step:xm,StridedSlice:Zv,StringNGrams:Jv,StringSplit:ex,StringToHashBucketFast:tx,Sub:gm,Sum:jv,Tan:ym,Tanh:bm,Tensor:In,TensorBuffer:rr,Tile:vm,TopK:nx,Transform:rx,Transpose:Bd,Unique:ax,Unpack:ix,UnsortedSegmentSum:ox,UpperBound:oae,Variable:_m,ZerosLike:sx,_FusedMatMul:wm,abs:za,acos:g8,acosh:y8,add:ot,addN:b8,all:v8,any:x8,argMax:w8,argMin:k8,asin:S8,asinh:C8,atan:N8,atan2:T8,atanh:I8,avgPool:XT,avgPool3d:E8,backend:Zie,backend_util:oF,basicLSTMCell:_8,batchNorm:Dm,batchNorm2d:O8,batchNorm3d:$8,batchNorm4d:R8,batchToSpaceND:YT,bincount:QT,booleanMaskAsync:mL,broadcastArgs:M8,broadcastTo:Xd,broadcast_util:soe,browser:hoe,buffer:pt,cast:wn,ceil:A8,clipByValue:P8,clone:Is,complex:Ns,concat:Ur,concat1d:D8,concat2d:L8,concat3d:F8,concat4d:B8,conv1d:z8,conv2d:Lm,conv2dTranspose:W8,conv3d:j8,conv3dTranspose:U8,copyRegisteredKernels:dae,cos:G8,cosh:H8,cosineWindow:Mx,cumprod:q8,cumsum:K8,customGrad:Do,denseBincount:X8,deprecationWarn:Vie,depthToSpace:Y8,depthwiseConv2d:Sx,device_util:Bae,diag:Q8,dilation2d:Z8,disableDeprecationWarnings:zie,dispose:Wr,disposeVariables:Wie,div:un,divNoNan:J8,dot:eD,dropout:xL,einsum:tD,elu:JT,enableDebugMode:Bie,enableProdMode:Fie,enclosingPowerOfTwo:RI,engine:Es,env:ue,equal:ZT,erf:nD,euclideanNorm:iD,exp:Ll,expandDims:$s,expm1:oD,eye:tI,fft:Ox,fill:Yd,findBackend:Yie,findBackendFactory:Qie,floor:nI,floorDiv:HT,fused:kL,gather:rI,gatherND:vL,gather_util:foe,getBackend:Kie,getGradient:eT,getKernel:cx,getKernelsForBackend:dx,grad:vle,grads:xle,greater:zm,greaterEqual:aI,ifft:Um,imag:Rm,image:AI,inTopKAsync:wL,io:OT,irfft:EI,isFinite:sD,isInf:lD,isNaN:uD,keep:Mo,kernel_impls:cpe,leakyRelu:iI,less:cD,lessEqual:Nx,linalg:_L,linspace:dD,localResponseNormalization:pD,log:Jd,log1p:oI,logSigmoid:fD,logSoftmax:mD,logSumExp:lI,logicalAnd:Vm,logicalNot:uI,logicalOr:cI,logicalXor:gD,losses:OL,lowerBound:yD,matMul:Gt,math:ooe,max:oc,maxPool:dI,maxPool3d:bD,maxPoolWithArgmax:vD,maximum:pI,mean:Wm,memory:jie,meshgrid:xD,min:Cx,minimum:hI,mirrorPad:wD,mod:kD,moments:SD,movingAverage:gL,mul:$e,multiRNNCell:CD,multinomial:ND,neg:Ao,nextFrame:ML,norm:Bm,notEqual:fI,oneHot:vx,ones:Bl,onesLike:TD,op:ee,outerProduct:ID,pad:ep,pad1d:ED,pad2d:_D,pad3d:OD,pad4d:$D,pool:RD,pow:Qd,prelu:gI,print:NT,prod:MD,profile:Uie,raggedGather:AD,raggedTensorToTensor:PD,rand:DD,randomGamma:BD,randomNormal:CI,randomStandardNormal:zD,randomUniform:NI,range:tp,ready:qie,real:Hd,reciprocal:VD,registerBackend:$T,registerGradient:lae,registerKernel:px,relu:jm,relu6:TI,removeBackend:Xie,reshape:ve,reverse:zl,reverse1d:WD,reverse2d:jD,reverse3d:UD,reverse4d:GD,rfft:$x,round:II,rsqrt:HD,scalar:St,scatterND:yL,scatter_util:moe,searchSorted:Ex,selu:qD,separableConv2d:KD,serialization:xoe,setBackend:Hie,setPlatform:Jie,setdiff1dAsync:XD,sigmoid:ac,sign:YD,signal:EL,sin:QD,sinh:ZD,slice:nn,slice1d:JD,slice2d:eL,slice3d:tL,slice4d:nL,slice_util:p8,softmax:rL,softplus:sI,spaceToBatchND:mI,sparse:$L,sparseToDense:bL,spectral:IL,split:np,sqrt:Po,square:_i,squaredDifference:_I,squeeze:Gm,stack:Lo,step:OI,stridedSlice:aL,string:RL,sub:xt,sum:cn,sumOutType:gx,tan:iL,tanh:kx,tensor:lo,tensor1d:Oi,tensor2d:rp,tensor3d:MT,tensor4d:oL,tensor5d:sL,tensor6d:lL,tensor_util:Aae,test_util:Ooe,tidy:Ot,tile:Zd,time:Gie,topk:uL,train:ipe,transpose:Mm,truncatedNormal:cL,unique:dL,unregisterGradient:cae,unregisterKernel:uae,unsortedSegmentSum:pL,unstack:Vl,upcastType:ka,upperBound:hL,util:xae,valueAndGrad:wle,valueAndGrads:kle,variable:fL,variableGrads:hD,version_core:$oe,where:ic,whereAsync:$I,zeros:Fl,zerosLike:Va},Symbol.toStringTag,{value:"Module"}));/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const ppe=ue();ppe.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,t=>{t&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*
* =============================================================================
*/var $i;(function(t){t[t.DT_INVALID=0]="DT_INVALID",t[t.DT_FLOAT=1]="DT_FLOAT",t[t.DT_DOUBLE=2]="DT_DOUBLE",t[t.DT_INT32=3]="DT_INT32",t[t.DT_UINT8=4]="DT_UINT8",t[t.DT_INT16=5]="DT_INT16",t[t.DT_INT8=6]="DT_INT8",t[t.DT_STRING=7]="DT_STRING",t[t.DT_COMPLEX64=8]="DT_COMPLEX64",t[t.DT_INT64=9]="DT_INT64",t[t.DT_BOOL=10]="DT_BOOL",t[t.DT_QINT8=11]="DT_QINT8",t[t.DT_QUINT8=12]="DT_QUINT8",t[t.DT_QINT32=13]="DT_QINT32",t[t.DT_BFLOAT16=14]="DT_BFLOAT16",t[t.DT_QINT16=15]="DT_QINT16",t[t.DT_QUINT16=16]="DT_QUINT16",t[t.DT_UINT16=17]="DT_UINT16",t[t.DT_COMPLEX128=18]="DT_COMPLEX128",t[t.DT_HALF=19]="DT_HALF",t[t.DT_RESOURCE=20]="DT_RESOURCE",t[t.DT_VARIANT=21]="DT_VARIANT",t[t.DT_UINT32=22]="DT_UINT32",t[t.DT_UINT64=23]="DT_UINT64",t[t.DT_FLOAT_REF=101]="DT_FLOAT_REF",t[t.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",t[t.DT_INT32_REF=103]="DT_INT32_REF",t[t.DT_UINT8_REF=104]="DT_UINT8_REF",t[t.DT_INT16_REF=105]="DT_INT16_REF",t[t.DT_INT8_REF=106]="DT_INT8_REF",t[t.DT_STRING_REF=107]="DT_STRING_REF",t[t.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",t[t.DT_INT64_REF=109]="DT_INT64_REF",t[t.DT_BOOL_REF=110]="DT_BOOL_REF",t[t.DT_QINT8_REF=111]="DT_QINT8_REF",t[t.DT_QUINT8_REF=112]="DT_QUINT8_REF",t[t.DT_QINT32_REF=113]="DT_QINT32_REF",t[t.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",t[t.DT_QINT16_REF=115]="DT_QINT16_REF",t[t.DT_QUINT16_REF=116]="DT_QUINT16_REF",t[t.DT_UINT16_REF=117]="DT_UINT16_REF",t[t.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",t[t.DT_HALF_REF=119]="DT_HALF_REF",t[t.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",t[t.DT_VARIANT_REF=121]="DT_VARIANT_REF",t[t.DT_UINT32_REF=122]="DT_UINT32_REF",t[t.DT_UINT64_REF=123]="DT_UINT64_REF"})($i||($i={}));var sF;(function(t){(function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"})(t.CheckpointFormatVersion||(t.CheckpointFormatVersion={}))})(sF||(sF={}));/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const hpe={};function lF(t){return hpe[t]}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function O(t,e,n,r,a){const i=e.inputParams[t];if(i&&i.inputIndexStart!==void 0){const s=i.inputIndexStart,l=i.inputIndexEnd===0?void 0:i.inputIndexEnd===void 0?s+1:i.inputIndexEnd;if(i.type==="tensor")return sa(e.inputNames[i.inputIndexStart],n,r,a);if(i.type==="tensors")return e.inputNames.slice(s,l).map(d=>sa(d,n,r,a));const u=sa(e.inputNames.slice(s)[0],n,r,a),c=u.dataSync();return i.type==="number"?c[0]:ri(u.shape,c)}const o=e.attrParams[t];return o&&o.value}function sa(t,e,n,r){const[a,i]=Wa(t);if(r!=null){const s=r.getHashTableHandleByName(a);if(s!=null)return s}const o=n.currentContextIds.find(s=>!!e[Kx(a,s)]);return o!==void 0?e[Kx(a,o)][i]:void 0}function fpe(t,e,n){return e[Kx(t,n.currentContextId)]}function Bo(t,e){const[n,r,a]=Wa(t);return[Kx(n,e&&e.currentContextId),r,a]}function Kx(t,e){return e?`${t}-${e}`:t}function Wa(t){const e=t.split(":");if(e.length===1)return[t,0,void 0];const n=e[0],r=e.length===3?e[1]:void 0,a=Number(e[e.length-1]);return[n,a,r]}function Xx(t,e,n){let r=O("pad",t,e,n);if(r==="explicit"){r=O("explicitPaddings",t,e,n);const a=[[0,0],[0,0],[0,0],[0,0]];for(let i=0;i<4;i++)a[i][0]=r[i*2],a[i][1]=r[i*2+1];return a}return r}function As(t){return t.kept?t:Is(t)}/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const mpe=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],gpe=Object.freeze(Object.defineProperty({__proto__:null,json:mpe},Symbol.toStringTag,{value:"Module"}));/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const ype=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Prod",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axes",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsNan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],bpe=Object.freeze(Object.defineProperty({__proto__:null,json:ype},Symbol.toStringTag,{value:"Module"}));/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const vpe=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcatV2",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListLength",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}]},{tfOpName:"TensorListResize",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"size",type:"number"}]}],xpe=Object.freeze(Object.defineProperty({__proto__:null,json:vpe},Symbol.toStringTag,{value:"Module"}));/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const wpe=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}],kpe=Object.freeze(Object.defineProperty({__proto__:null,json:wpe},Symbol.toStringTag,{value:"Module"}));/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Spe=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomStandardNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],Cpe=Object.freeze(Object.defineProperty({__proto__:null,json:Spe},Symbol.toStringTag,{value:"Module"}));/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Npe=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],Tpe=Object.freeze(Object.defineProperty({__proto__:null,json:Npe},Symbol.toStringTag,{value:"Module"}));/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Ipe=[{tfOpName:"LowerBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"UpperBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}],Epe=Object.freeze(Object.defineProperty({__proto__:null,json:Ipe},Symbol.toStringTag,{value:"Module"}));/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const _pe=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],Ope=Object.freeze(Object.defineProperty({__proto__:null,json:_pe},Symbol.toStringTag,{value:"Module"}));/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const $pe=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]}],Rpe=Object.freeze(Object.defineProperty({__proto__:null,json:$pe},Symbol.toStringTag,{value:"Module"}));/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Mpe=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]},{tfOpName:"ImageProjectiveTransformV3",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"transforms",type:"tensor"},{start:2,name:"outputShape",type:"number[]"},{start:3,name:"fillValue",type:"number"}],attrs:[{tfName:"interpolation",name:"interpolation",type:"string"},{tfName:"fill_mode",name:"fillMode",type:"string"}]}],Ape=Object.freeze(Object.defineProperty({__proto__:null,json:Mpe},Symbol.toStringTag,{value:"Module"}));/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Ppe=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],Dpe=Object.freeze(Object.defineProperty({__proto__:null,json:Ppe},Symbol.toStringTag,{value:"Module"}));/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Lpe=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Einsum",category:"matrices",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"equation",name:"equation",type:"string"},{tfName:"N",name:"n",type:"number",defaultValue:2},{tfName:"T",name:"dtype",type:"dtype"}]}],Fpe=Object.freeze(Object.defineProperty({__proto__:null,json:Lpe},Symbol.toStringTag,{value:"Module"}));/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Bpe=[{tfOpName:"EuclideanNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",defaultValue:!1}]},{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"SparseToDense",category:"normalization",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!0,notSupported:!0}]}],zpe=Object.freeze(Object.defineProperty({__proto__:null,json:Bpe},Symbol.toStringTag,{value:"Module"}));/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Vpe=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Cumprod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}],Wpe=Object.freeze(Object.defineProperty({__proto__:null,json:Vpe},Symbol.toStringTag,{value:"Module"}));/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const jpe=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]}],Upe=Object.freeze(Object.defineProperty({__proto__:null,json:jpe},Symbol.toStringTag,{value:"Module"}));/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Gpe=[{tfOpName:"SparseFillEmptyRows",category:"sparse",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"denseShape",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}]},{tfOpName:"SparseReshape",category:"sparse",inputs:[{start:0,name:"inputIndices",type:"tensor"},{start:1,name:"inputShape",type:"tensor"},{start:2,name:"newShape",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SparseSegmentMean",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]},{tfOpName:"SparseSegmentSum",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]}],Hpe=Object.freeze(Object.defineProperty({__proto__:null,json:Gpe},Symbol.toStringTag,{value:"Module"}));/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const qpe=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],Kpe=Object.freeze(Object.defineProperty({__proto__:null,json:qpe},Symbol.toStringTag,{value:"Module"}));/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Xpe=[{tfOpName:"StringNGrams",category:"string",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"dataSplits",type:"tensor"}],attrs:[{tfName:"separator",name:"separator",type:"string"},{tfName:"ngram_widths",name:"nGramWidths",type:"number[]"},{tfName:"left_pad",name:"leftPad",type:"string"},{tfName:"right_pad",name:"rightPad",type:"string"},{tfName:"pad_width",name:"padWidth",type:"number"},{tfName:"preserve_short_sequences",name:"preserveShortSequences",type:"bool"}],outputs:["ngrams","ngrams_splits"]},{tfOpName:"StringSplit",category:"string",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"delimiter",type:"tensor"}],attrs:[{tfName:"skip_empty",name:"skipEmpty",type:"bool"}],outputs:["indices","values","shape"]},{tfOpName:"StringToHashBucketFast",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"num_buckets",name:"numBuckets",type:"number"}]}],Ype=Object.freeze(Object.defineProperty({__proto__:null,json:Xpe},Symbol.toStringTag,{value:"Module"}));/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Qpe=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]},{tfOpName:"BroadcastArgs",category:"transformation",inputs:[{start:0,name:"s0",type:"tensor"},{start:1,name:"s1",type:"tensor"}],attrs:[]}],Zpe=Object.freeze(Object.defineProperty({__proto__:null,json:Qpe},Symbol.toStringTag,{value:"Module"}));/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class uF{static get Instance(){return this._instance||(this._instance=new this)}constructor(){const e=[gpe,bpe,xpe,kpe,Cpe,Tpe,Epe,Ope,Rpe,Ape,Dpe,Fpe,zpe,Wpe,Upe,Hpe,Kpe,Ype,Zpe],n=[].concat(...e.map(r=>r.json));this.opMappers=n.reduce((r,a)=>(r[a.tfOpName]=a,r),{})}transformGraph(e,n={}){const r=e.node,a=[],i=[],o=[],s=r.reduce((y,x)=>(y[x.name]=this.mapNode(x),x.op.startsWith("Placeholder")?a.push(y[x.name]):x.op==="Const"?i.push(y[x.name]):(x.input==null||x.input.length===0)&&o.push(y[x.name]),y),{});let l=[];const u=[];let c={},d={};n!=null&&(c=this.mapSignatureEntries(n.inputs),d=this.mapSignatureEntries(n.outputs));const p=Object.keys(s);p.forEach(y=>{const x=s[y];x.inputNames.forEach((b,v)=>{const[w,,S]=Bo(b),C=s[w];if(C.outputs!=null){const I=C.outputs.indexOf(S);if(I!==-1){const _=`${w}:${I}`;x.inputNames[v]=_}}x.inputs.push(C),C.children.push(x)})}),Object.keys(d).length===0?p.forEach(y=>{const x=s[y];x.children.length===0&&u.push(x)}):Object.keys(d).forEach(y=>{const[x]=Bo(y),b=s[x];b!=null&&(b.signatureKey=d[y],u.push(b))}),Object.keys(c).length>0?Object.keys(c).forEach(y=>{const[x]=Bo(y),b=s[x];b&&(b.signatureKey=c[y],l.push(b))}):l=a;let f={};e.library!=null&&e.library.function!=null&&(f=e.library.function.reduce((y,x)=>(y[x.signature.name]=this.mapFunction(x),y),{}));const g={nodes:s,inputs:l,outputs:u,weights:i,placeholders:a,signature:n,functions:f};return o.length>0&&(g.initNodes=o),g}mapSignatureEntries(e){return Object.keys(e||{}).reduce((n,r)=>(n[e[r].name]=r,n),{})}mapNode(e){const n=lF(e.op)||this.opMappers[e.op]||{};e.attr==null&&(e.attr={});const r={name:e.name,op:e.op,category:n.category,inputNames:(e.input||[]).map(a=>a.startsWith("^")?a.slice(1):a),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:e.attr,outputs:n.outputs};return n.inputs!=null&&(r.inputParams=n.inputs.reduce((a,i)=>(a[i.name]={type:i.type,inputIndexStart:i.start,inputIndexEnd:i.end},a),{})),n.attrs!=null&&(r.attrParams=n.attrs.reduce((a,i)=>{const o=i.type;let s;switch(i.type){case"string":s=a4(e.attr,i.tfName,i.defaultValue),s===void 0&&i.tfDeprecatedName&&(s=a4(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"string[]":s=p4(e.attr,i.tfName,i.defaultValue),s===void 0&&i.tfDeprecatedName&&(s=p4(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"number":s=o4(e.attr,i.tfName,i.defaultValue||0),s===void 0&&i.tfDeprecatedName&&(s=o4(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"number[]":s=d4(e.attr,i.tfName,i.defaultValue),s===void 0&&i.tfDeprecatedName&&(s=d4(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"bool":s=i4(e.attr,i.tfName,i.defaultValue),s===void 0&&i.tfDeprecatedName&&(s=i4(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"bool[]":s=f4(e.attr,i.tfName,i.defaultValue),s===void 0&&i.tfDeprecatedName&&(s=f4(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"shape":s=c4(e.attr,i.tfName,i.defaultValue),s===void 0&&i.tfDeprecatedName&&(s=c4(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"shape[]":s=h4(e.attr,i.tfName,i.defaultValue),s===void 0&&i.tfDeprecatedName&&(s=h4(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"dtype":s=l4(e.attr,i.tfName,i.defaultValue),s===void 0&&i.tfDeprecatedName&&(s=l4(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"dtype[]":s=u4(e.attr,i.tfName,i.defaultValue),s===void 0&&i.tfDeprecatedName&&(s=u4(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"func":s=dF(e.attr,i.tfName,i.defaultValue),s===void 0&&i.tfDeprecatedName&&(s=dF(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error(`Unsupported param type: ${i.type} for op: ${e.op}`)}return a[i.name]={value:s,type:o},a},{})),r}mapFunction(e){const n=e.nodeDef,r=[],a=[];let i={};n!=null&&(i=n.reduce((c,d)=>(c[d.name]=this.mapNode(d),d.op==="Const"&&a.push(c[d.name]),c),{}));const o=[],s=[];e.signature.inputArg.forEach(c=>{const[d]=Bo(c.name),p={name:d,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:s4(c.type),type:"dtype"}},children:[]};p.signatureKey=c.name,o.push(p),i[d]=p}),Object.keys(i).forEach(c=>{const d=i[c];d.inputNames.forEach((p,f)=>{const[g,,y]=Bo(p),x=i[g];if(x.outputs!=null){const b=x.outputs.indexOf(y);if(b!==-1){const v=`${g}:${b}`;d.inputNames[f]=v}}d.inputs.push(x),x.children.push(d)})});const l=e.ret;e.signature.outputArg.forEach(c=>{const[d,p]=Bo(l[c.name]),f=i[d];f!=null&&(f.defaultOutput=p,s.push(f))});const u=this.mapArgsToSignature(e);return{nodes:i,inputs:o,outputs:s,weights:a,placeholders:r,signature:u}}mapArgsToSignature(e){return{methodName:e.signature.name,inputs:e.signature.inputArg.reduce((n,r)=>(n[r.name]=this.mapArgToTensorInfo(r),n),{}),outputs:e.signature.outputArg.reduce((n,r)=>(n[r.name]=this.mapArgToTensorInfo(r,e.ret),n),{})}}mapArgToTensorInfo(e,n){let r=e.name;return n!=null&&(r=n[r]),{name:r,dtype:e.type}}}function Jpe(t){const e=ue().global;if(typeof e.atob<"u")return e.atob(t);if(typeof Buffer<"u")return new Buffer(t,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}function cF(t,e){const n=Array.isArray(t)?String.fromCharCode.apply(null,t):Jpe(t);return e?n:n.toLowerCase()}function a4(t,e,n,r=!1){const a=t[e];return a!=null?cF(a.s,r):n}function i4(t,e,n){const r=t[e];return r?r.b:n}function o4(t,e,n){const r=t[e]||{},a=r.i!=null?r.i:r.f!=null?r.f:n;return typeof a=="number"?a:parseInt(a,10)}function s4(t){switch(typeof t=="string"&&(t=$i[t]),t){case $i.DT_FLOAT:case $i.DT_HALF:return"float32";case $i.DT_INT32:case $i.DT_INT64:case $i.DT_INT8:case $i.DT_UINT8:return"int32";case $i.DT_BOOL:return"bool";case $i.DT_DOUBLE:return"float32";case $i.DT_STRING:return"string";default:return null}}function dF(t,e,n){const r=t[e];return r&&r.func?r.func.name:n}function l4(t,e,n){const r=t[e];return r&&r.type?s4(r.type):n}function u4(t,e,n){const r=t[e];return r&&r.list&&r.list.type?r.list.type.map(a=>s4(a)):n}function pF(t){if(!t.unknownRank)return t.dim!=null?t.dim.map(e=>typeof e.size=="number"?e.size:parseInt(e.size,10)):[]}function c4(t,e,n){const r=t[e];return r&&r.shape?pF(r.shape):n}function d4(t,e,n){const r=t[e];return r?((r.list.f&&r.list.f.length?r.list.f:r.list.i)||[]).map(a=>typeof a=="number"?a:parseInt(a,10)):n}function p4(t,e,n,r=!1){const a=t[e];return a&&a.list&&a.list.s?a.list.s.map(i=>cF(i,r)):n}function h4(t,e,n){const r=t[e];return r&&r.list&&r.list.shape?r.list.shape.map(a=>pF(a)):n}function f4(t,e,n){const r=t[e];return r&&r.list&&r.list.b?r.list.b:n}/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class ehe{constructor(e,n,r){this.node=e,this.tensorMap=n,this.context=r,this.inputs=[],this.attrs={},this.inputs=e.inputNames.map(a=>this.getInput(a)),e.rawAttrs!=null&&(this.attrs=Object.keys(e.rawAttrs).reduce((a,i)=>(a[i]=this.getAttr(i),a),{}))}getInput(e){return sa(e,this.tensorMap,this.context)}getAttr(e,n){const r=this.node.rawAttrs[e];if(r.tensor!=null)return sa(e,this.tensorMap,this.context);if(r.i!=null||r.f!=null)return o4(this.node.rawAttrs,e,n);if(r.s!=null)return a4(this.node.rawAttrs,e,n);if(r.b!=null)return i4(this.node.rawAttrs,e,n);if(r.shape!=null)return c4(this.node.rawAttrs,e,n);if(r.type!=null)return l4(this.node.rawAttrs,e,n);if(r.list!=null){if(r.list.i!=null||r.list.f!=null)return d4(this.node.rawAttrs,e,n);if(r.list.s!=null)return p4(this.node.rawAttrs,e,n);if(r.list.shape!=null)return h4(this.node.rawAttrs,e,n);if(r.list.b!=null)return f4(this.node.rawAttrs,e,n);if(r.list.type!=null)return u4(this.node.rawAttrs,e,n)}return n}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Gr=Object.freeze(Object.defineProperty({__proto__:null,OP_SCOPE_SUFFIX:gT,abs:za,acos:g8,acosh:y8,add:ot,addN:b8,all:v8,any:x8,argMax:w8,argMin:k8,asin:S8,asinh:C8,atan:N8,atan2:T8,atanh:I8,avgPool:XT,avgPool3d:E8,basicLSTMCell:_8,batchNorm:Dm,batchNorm2d:O8,batchNorm3d:$8,batchNorm4d:R8,batchToSpaceND:YT,bincount:QT,booleanMaskAsync:mL,broadcastArgs:M8,broadcastTo:Xd,buffer:pt,cast:wn,ceil:A8,clipByValue:P8,clone:Is,complex:Ns,concat:Ur,concat1d:D8,concat2d:L8,concat3d:F8,concat4d:B8,conv1d:z8,conv2d:Lm,conv2dTranspose:W8,conv3d:j8,conv3dTranspose:U8,cos:G8,cosh:H8,cosineWindow:Mx,cumprod:q8,cumsum:K8,denseBincount:X8,depthToSpace:Y8,depthwiseConv2d:Sx,diag:Q8,dilation2d:Z8,div:un,divNoNan:J8,dot:eD,dropout:xL,einsum:tD,elu:JT,enclosingPowerOfTwo:RI,equal:ZT,erf:nD,euclideanNorm:iD,exp:Ll,expandDims:$s,expm1:oD,eye:tI,fft:Ox,fill:Yd,floor:nI,floorDiv:HT,fused:kL,gather:rI,gatherND:vL,greater:zm,greaterEqual:aI,ifft:Um,imag:Rm,image:AI,inTopKAsync:wL,irfft:EI,isFinite:sD,isInf:lD,isNaN:uD,leakyRelu:iI,less:cD,lessEqual:Nx,linalg:_L,linspace:dD,localResponseNormalization:pD,log:Jd,log1p:oI,logSigmoid:fD,logSoftmax:mD,logSumExp:lI,logicalAnd:Vm,logicalNot:uI,logicalOr:cI,logicalXor:gD,losses:OL,lowerBound:yD,matMul:Gt,max:oc,maxPool:dI,maxPool3d:bD,maxPoolWithArgmax:vD,maximum:pI,mean:Wm,meshgrid:xD,min:Cx,minimum:hI,mirrorPad:wD,mod:kD,moments:SD,movingAverage:gL,mul:$e,multiRNNCell:CD,multinomial:ND,neg:Ao,norm:Bm,notEqual:fI,oneHot:vx,ones:Bl,onesLike:TD,op:ee,outerProduct:ID,pad:ep,pad1d:ED,pad2d:_D,pad3d:OD,pad4d:$D,pool:RD,pow:Qd,prelu:gI,print:NT,prod:MD,raggedGather:AD,raggedTensorToTensor:PD,rand:DD,randomGamma:BD,randomNormal:CI,randomStandardNormal:zD,randomUniform:NI,range:tp,real:Hd,reciprocal:VD,relu:jm,relu6:TI,reshape:ve,reverse:zl,reverse1d:WD,reverse2d:jD,reverse3d:UD,reverse4d:GD,rfft:$x,round:II,rsqrt:HD,scalar:St,scatterND:yL,searchSorted:Ex,selu:qD,separableConv2d:KD,setdiff1dAsync:XD,sigmoid:ac,sign:YD,signal:EL,sin:QD,sinh:ZD,slice:nn,slice1d:JD,slice2d:eL,slice3d:tL,slice4d:nL,softmax:rL,softplus:sI,spaceToBatchND:mI,sparse:$L,sparseToDense:bL,spectral:IL,split:np,sqrt:Po,square:_i,squaredDifference:_I,squeeze:Gm,stack:Lo,step:OI,stridedSlice:aL,string:RL,sub:xt,sum:cn,tan:iL,tanh:kx,tensor:lo,tensor1d:Oi,tensor2d:rp,tensor3d:MT,tensor4d:oL,tensor5d:sL,tensor6d:lL,tile:Zd,topk:uL,transpose:Mm,truncatedNormal:cL,unique:dL,unsortedSegmentSum:pL,unstack:Vl,upperBound:hL,variable:fL,where:ic,whereAsync:$I,zeros:Fl,zerosLike:Va},Symbol.toStringTag,{value:"Module"}));/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const the=(t,e,n,r=Gr)=>{switch(t.op){case"BiasAdd":case"AddV2":case"Add":return[r.add(O("a",t,e,n),O("b",t,e,n))];case"AddN":return[r.addN(O("tensors",t,e,n))];case"FloorMod":case"Mod":return[r.mod(O("a",t,e,n),O("b",t,e,n))];case"Mul":return[r.mul(O("a",t,e,n),O("b",t,e,n))];case"RealDiv":case"Div":return[r.div(O("a",t,e,n),O("b",t,e,n))];case"DivNoNan":return[r.divNoNan(O("a",t,e,n),O("b",t,e,n))];case"FloorDiv":return[r.floorDiv(O("a",t,e,n),O("b",t,e,n))];case"Sub":return[r.sub(O("a",t,e,n),O("b",t,e,n))];case"Minimum":return[r.minimum(O("a",t,e,n),O("b",t,e,n))];case"Maximum":return[r.maximum(O("a",t,e,n),O("b",t,e,n))];case"Pow":return[r.pow(O("a",t,e,n),O("b",t,e,n))];case"SquaredDifference":return[r.squaredDifference(O("a",t,e,n),O("b",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const nhe=(t,e,n,r=Gr)=>{switch(t.op){case"Abs":case"ComplexAbs":return[r.abs(O("x",t,e,n))];case"Acos":return[r.acos(O("x",t,e,n))];case"Acosh":return[r.acosh(O("x",t,e,n))];case"Asin":return[r.asin(O("x",t,e,n))];case"Asinh":return[r.asinh(O("x",t,e,n))];case"Atan":return[r.atan(O("x",t,e,n))];case"Atan2":return[r.atan2(O("x",t,e,n),O("y",t,e,n))];case"Atanh":return[r.atanh(O("x",t,e,n))];case"Ceil":return[r.ceil(O("x",t,e,n))];case"Complex":return[r.complex(O("real",t,e,n),O("imag",t,e,n))];case"Cos":return[r.cos(O("x",t,e,n))];case"Cosh":return[r.cosh(O("x",t,e,n))];case"Elu":return[r.elu(O("x",t,e,n))];case"Erf":return[r.erf(O("x",t,e,n))];case"Exp":return[r.exp(O("x",t,e,n))];case"Expm1":return[r.expm1(O("x",t,e,n))];case"Floor":return[r.floor(O("x",t,e,n))];case"Log":return[r.log(O("x",t,e,n))];case"Log1p":return[r.log1p(O("x",t,e,n))];case"Imag":return[r.imag(O("x",t,e,n))];case"Neg":return[r.neg(O("x",t,e,n))];case"Reciprocal":return[r.reciprocal(O("x",t,e,n))];case"Real":return[r.real(O("x",t,e,n))];case"Relu":return[r.relu(O("x",t,e,n))];case"Round":return[r.round(O("x",t,e,n))];case"Selu":return[r.selu(O("x",t,e,n))];case"Sigmoid":return[r.sigmoid(O("x",t,e,n))];case"Sin":return[r.sin(O("x",t,e,n))];case"Sign":return[r.sign(O("x",t,e,n))];case"Sinh":return[r.sinh(O("x",t,e,n))];case"Softplus":return[r.softplus(O("x",t,e,n))];case"Sqrt":return[r.sqrt(O("x",t,e,n))];case"Square":return[r.square(O("x",t,e,n))];case"Tanh":return[r.tanh(O("x",t,e,n))];case"Tan":return[r.tan(O("x",t,e,n))];case"ClipByValue":return[r.clipByValue(O("x",t,e,n),O("clipValueMin",t,e,n),O("clipValueMax",t,e,n))];case"Relu6":return[r.relu6(O("x",t,e,n))];case"Rsqrt":return[r.rsqrt(sa(t.inputNames[0],e,n))];case"Prod":return[r.prod(O("x",t,e,n),O("axes",t,e,n))];case"LeakyRelu":return[r.leakyRelu(O("x",t,e,n),O("alpha",t,e,n))];case"Prelu":return[r.prelu(O("x",t,e,n),O("alpha",t,e,n))];case"IsNan":return[r.isNaN(sa(t.inputNames[0],e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Ri(t,e,n=""){if(!(typeof t=="number"||typeof e=="number")){V(t.length===e.length,()=>n+` Shapes ${t} and ${e} must match`);for(let r=0;r<t.length;r++){const a=t[r],i=e[r];V(a<0||i<0||a===i,()=>n+` Shapes ${t} and ${e} must match`)}}}function hF(t){return!(typeof t=="number"||t.some(e=>e<0))}function Ym(t,e,n){let r=m4(t,n);const a=!hF(r);if(a&&e.length===0)throw new Error(`Tried to calculate elements of an empty list with non-fully-defined elementShape: ${r}`);if(a&&e.forEach(i=>{r=m4(i.shape,r)}),!hF(r))throw new Error(`Non-fully-defined elementShape: ${r}`);return r}function m4(t,e){if(typeof t=="number")return e;if(typeof e=="number")return t;if(t.length!==e.length)throw new Error(`Incompatible ranks during merge: ${t} vs. ${e}`);const n=[];for(let r=0;r<t.length;++r){const a=t[r],i=e[r];if(a>=0&&i>=0&&a!==i)throw new Error(`Incompatible shape during merge: ${t} vs. ${e}`);n[r]=a>=0?a:i}return n}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class rhe{constructor(e,n,r,a,i,o,s){this.name=e,this.dtype=n,this.maxSize=r,this.elementShape=a,this.identicalElementShapes=i,this.dynamicSize=o,this.clearAfterRead=s,this.tensors=[],this.closed_=!1,this.idTensor=St(0),Mo(this.idTensor)}get id(){return this.idTensor.id}get closed(){return this.closed_}clearAndClose(e){this.tensors.forEach(n=>{(e==null||!e.has(n.tensor.id))&&n.tensor.dispose()}),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}size(){return this.tensors.length}read(e){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||e>=this.size())throw new Error(`Tried to read from index ${e}, but array size is: ${this.size()}`);const n=this.tensors[e];if(n.cleared)throw new Error(`TensorArray ${this.name}: Could not read index ${e} twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).`);return this.clearAfterRead&&(n.cleared=!0),n.read=!0,n.tensor}readMany(e){return e.map(n=>this.read(n))}write(e,n){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||!this.dynamicSize&&e>=this.maxSize)throw new Error(`Tried to write to index ${e}, but array is not resizeable and size is: ${this.maxSize}`);const r=this.tensors[e]||{};if(n.dtype!==this.dtype)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e},
          because the value dtype is ${n.dtype}, but TensorArray dtype is ${this.dtype}.`);if(this.size()===0&&(this.elementShape==null||this.elementShape.length===0)&&(this.elementShape=n.shape),Ri(this.elementShape,n.shape,`TensorArray ${this.name}: Could not write to TensorArray index ${e}.`),r.read)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been read.`);if(r.written)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been written.`);r.tensor=n,Mo(n),r.written=!0,this.tensors[e]=r}writeMany(e,n){if(e.length!==n.length)throw new Error(`TensorArray ${this.name}: could not write multiple tensors,because the index size: ${e.length} is not the same as tensors size: ${n.length}.`);e.forEach((r,a)=>this.write(r,n[a]))}gather(e,n){if(n&&n!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but gather requested dtype ${n}`);if(e)e=e.slice(0,this.size());else{e=[];for(let a=0;a<this.size();a++)e.push(a)}if(e.length===0)return lo([],[0].concat(this.elementShape));const r=this.readMany(e);return Ri(this.elementShape,r[0].shape,"TensorArray shape mismatch: "),Lo(r,0)}concat(e){if(e&&e!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but concat requested dtype ${e}`);if(this.size()===0)return lo([],[0].concat(this.elementShape));const n=[];for(let a=0;a<this.size();a++)n.push(a);const r=this.readMany(n);return Ri(this.elementShape,r[0].shape,`TensorArray shape mismatch: tensor array shape (${this.elementShape}) vs first tensor shape (${r[0].shape})`),Ur(r,0)}scatter(e,n){if(n.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${n.dtype}`);if(e.length!==n.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${n.shape[0]}`);const r=Math.max(...e);if(!this.dynamicSize&&r>=this.maxSize)throw new Error(`Max index must be < array size (${r}  vs. ${this.maxSize})`);this.writeMany(e,Vl(n,0))}split(e,n){if(n.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${n.dtype}`);let r=0;const a=e.map(l=>(r+=l,r));if(r!==n.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${r}, and tensor's shape is: ${n.shape}`);if(!this.dynamicSize&&e.length!==this.maxSize)throw new Error(`TensorArray's size is not equal to the size of lengths (${this.maxSize} vs. ${e.length}), and the TensorArray is not marked as dynamically resizeable`);const i=r===0?0:n.size/r,o=[];Ot(()=>{n=ve(n,[1,r,i]);for(let l=0;l<e.length;++l){const u=[0,l===0?0:a[l-1],0],c=[1,e[l],i];o[l]=ve(nn(n,u,c),this.elementShape)}return o});const s=[];for(let l=0;l<e.length;l++)s[l]=l;this.writeMany(s,o)}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class wc{constructor(e,n,r,a=-1){this.tensors=e,this.elementShape=n,this.elementDtype=r,e?.forEach(i=>{if(r!==i.dtype)throw new Error(`Invalid data types; op elements ${r}, but list elements ${i.dtype}`);Ri(n,i.shape,"TensorList shape mismatch: "),Mo(i)}),this.idTensor=St(0),this.maxNumElements=a,Mo(this.idTensor)}get id(){return this.idTensor.id}copy(){return new wc([...this.tensors],this.elementShape,this.elementDtype)}clearAndClose(e){this.tensors.forEach(n=>{(e==null||!e.has(n.id))&&n.dispose()}),this.tensors.length=0,this.idTensor.dispose()}size(){return this.tensors.length}stack(e,n,r=-1){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);if(r!==-1&&this.tensors.length!==r)throw new Error(`Operation expected a list with ${r} elements but got a list with ${this.tensors.length} elements.`);Ri(e,this.elementShape,"TensorList shape mismatch: ");const a=Ym(this.elementShape,this.tensors,e);return Ot(()=>{const i=this.tensors.map(o=>ve(o,a));return Lo(i,0)})}popBack(e,n){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);if(this.size()===0)throw new Error("Trying to pop from an empty list.");const r=Ym(this.elementShape,this.tensors,e),a=this.tensors.pop();return a.kept=!1,Ri(a.shape,e,"TensorList shape mismatch: "),ve(a,r)}pushBack(e){if(e.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${e.dtype}, but list elements ${this.elementDtype}`);if(Ri(e.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");Mo(e),this.tensors.push(e)}resize(e){if(e<0)throw new Error(`TensorListResize expects size to be non-negative. Got: ${e}`);if(this.maxNumElements!==-1&&e>this.maxNumElements)throw new Error(`TensorListResize input size ${e} is greater maxNumElement ${this.maxNumElements}.`);const n=new wc([],this.elementShape,this.elementDtype,this.maxNumElements);n.tensors.length=e;for(let r=0;r<Math.min(this.tensors.length,e);++r)n.tensors[r]=this.tensors[r];return n}getItem(e,n,r){if(r!==this.elementDtype)throw new Error(`Invalid data types; op elements ${r}, but list elements ${this.elementDtype}`);if(e<0||e>this.tensors.length)throw new Error(`Trying to access element ${e} in a list with ${this.tensors.length} elements.`);if(this.tensors[e]==null)throw new Error(`element at index ${e} is null.`);Ri(this.tensors[e].shape,n,"TensorList shape mismatch: ");const a=Ym(this.elementShape,this.tensors,n);return ve(this.tensors[e],a)}setItem(e,n){if(n.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n.dtype}, but list elements ${this.elementDtype}`);if(e<0||this.maxNumElements!==-1&&e>=this.maxNumElements)throw new Error(`Trying to set element ${e} in a list with max ${this.maxNumElements} elements.`);Ri(this.elementShape,n.shape,"TensorList shape mismatch: "),Mo(n),this.tensors[e]!=null&&(this.tensors[e].kept=!1),this.tensors[e]=n}gather(e,n,r){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);Ri(this.elementShape,r,"TensorList shape mismatch: "),e=e.slice(0,this.size());const a=Ym(this.elementShape,this.tensors,r);return e.length===0?lo([],[0].concat(a)):Ot(()=>{const i=e.map(o=>ve(this.tensors[o],a));return Lo(i,0)})}concat(e,n){if(e&&e!==this.elementDtype)throw new Error(`TensorList dtype is ${this.elementDtype} but concat requested dtype ${e}`);Ri(this.elementShape,n,"TensorList shape mismatch: ");const r=Ym(this.elementShape,this.tensors,n);return this.size()===0?lo([],[0].concat(r)):Ot(()=>{const a=this.tensors.map(i=>ve(i,r));return Ur(a,0)})}}function ahe(t,e,n){const r=t.dtype;if(t.shape.length<1)throw new Error(`Tensor must be at least a vector, but saw shape: ${t.shape}`);if(t.dtype!==n)throw new Error(`Invalid data types; op elements ${t.dtype}, but list elements ${n}`);const a=t.shape.slice(1);Ri(a,e,"TensorList shape mismatch: ");const i=Vl(t);return new wc(i,e,r)}function ihe(t,e,n,r){return new wc([],t,e,r)}function ohe(t,e,n,r){if(e.length!==t.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${t.shape[0]}`);const a=Math.max(...e);if(r!=null&&r!==-1&&a>=r)throw new Error(`Max index must be < array size (${a}  vs. ${r})`);const i=new wc([],n,t.dtype,r),o=Vl(t,0);return e.forEach((s,l)=>{i.setItem(s,o[l])}),i}function she(t,e,n){let r=0;const a=e.map(c=>(r+=c,r));if(r!==t.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${r}, and tensor's shape is: ${t.shape}`);const i=t.shape.slice(1),o=m4(i,n),s=r===0?0:t.size/r,l=Ot(()=>{const c=[];t=ve(t,[1,r,s]);for(let d=0;d<e.length;++d){const p=[0,d===0?0:a[d-1],0],f=[1,e[d],s];c[d]=ve(nn(t,p,f),o)}return t.dispose(),c}),u=new wc([],n,t.dtype,e.length);for(let c=0;c<l.length;c++)u.setItem(c,l[c]);return u}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const lhe=async(t,e,n)=>{switch(t.op){case"If":case"StatelessIf":{const r=O("thenBranch",t,e,n),a=O("elseBranch",t,e,n),i=O("cond",t,e,n),o=O("args",t,e,n);return(await i.data())[0]?n.functionMap[r].executeFunctionAsync(o,n.tensorArrayMap,n.tensorListMap):n.functionMap[a].executeFunctionAsync(o,n.tensorArrayMap,n.tensorListMap)}case"While":case"StatelessWhile":{const r=O("body",t,e,n),a=O("cond",t,e,n),i=O("args",t,e,n),o=await n.functionMap[a].executeFunctionAsync(i,n.tensorArrayMap,n.tensorListMap),s=i.map(c=>c.id);let l=await o[0].data();o.forEach(c=>{!c.kept&&s.indexOf(c.id)===-1&&c.dispose()});let u=i;for(;l[0];){const c=u;u=await n.functionMap[r].executeFunctionAsync(u,n.tensorArrayMap,n.tensorListMap);const d=u.map(f=>f.id);c.forEach(f=>{!f.kept&&s.indexOf(f.id)===-1&&d.indexOf(f.id)===-1&&f.dispose()});const p=await n.functionMap[a].executeFunctionAsync(u,n.tensorArrayMap,n.tensorListMap);l=await p[0].data(),p.forEach(f=>{!f.kept&&s.indexOf(f.id)===-1&&d.indexOf(f.id)===-1&&f.dispose()})}return u}case"LoopCond":{const r=O("pred",t,e,n);return[As(r)]}case"Switch":{const r=O("pred",t,e,n);let a=O("data",t,e,n);return a.kept||(a=As(a)),(await r.data())[0]?[void 0,a]:[a,void 0]}case"Merge":{const r=t.inputNames.find(a=>sa(a,e,n)!==void 0);if(r){const a=sa(r,e,n);return[As(a)]}return}case"Enter":{const r=O("frameName",t,e,n),a=O("tensor",t,e,n);return n.enterFrame(r),[As(a)]}case"Exit":{const r=O("tensor",t,e,n);return n.exitFrame(),[As(r)]}case"NextIteration":{const r=O("tensor",t,e,n);return n.nextIteration(),[As(r)]}case"TensorArrayV3":{const r=O("size",t,e,n),a=O("dtype",t,e,n),i=O("elementShape",t,e,n),o=O("dynamicSize",t,e,n),s=O("clearAfterRead",t,e,n),l=O("identicalElementShapes",t,e,n),u=O("name",t,e,n),c=new rhe(u,a,r,i,l,o,s);return n.addTensorArray(c),[c.idTensor,St(1)]}case"TensorArrayWriteV3":{const r=O("tensorArrayId",t,e,n),a=O("index",t,e,n),i=O("tensor",t,e,n),o=n.getTensorArray(r.id);return o.write(a,i),[o.idTensor]}case"TensorArrayReadV3":{const r=O("tensorArrayId",t,e,n),a=O("index",t,e,n);return[n.getTensorArray(r.id).read(a)]}case"TensorArrayGatherV3":{const r=O("tensorArrayId",t,e,n),a=O("indices",t,e,n),i=O("dtype",t,e,n);return[n.getTensorArray(r.id).gather(a,i)]}case"TensorArrayScatterV3":{const r=O("tensorArrayId",t,e,n),a=O("indices",t,e,n),i=O("tensor",t,e,n),o=n.getTensorArray(r.id);return o.scatter(a,i),[o.idTensor]}case"TensorArrayConcatV3":{const r=O("tensorArrayId",t,e,n),a=n.getTensorArray(r.id),i=O("dtype",t,e,n);return[a.concat(i)]}case"TensorArraySplitV3":{const r=O("tensorArrayId",t,e,n),a=O("tensor",t,e,n),i=O("lengths",t,e,n),o=n.getTensorArray(r.id);return o.split(i,a),[o.idTensor]}case"TensorArraySizeV3":{const r=O("tensorArrayId",t,e,n),a=n.getTensorArray(r.id);return[St(a.size(),"int32")]}case"TensorArrayCloseV3":{const r=O("tensorArrayId",t,e,n),a=n.getTensorArray(r.id);return a.clearAndClose(),[a.idTensor]}case"TensorListSetItem":{const r=O("tensorListId",t,e,n),a=O("index",t,e,n),i=O("tensor",t,e,n),o=n.getTensorList(r.id);return o.setItem(a,i),[o.idTensor]}case"TensorListGetItem":{const r=O("tensorListId",t,e,n),a=O("index",t,e,n),i=O("elementShape",t,e,n),o=O("elementDType",t,e,n);return[n.getTensorList(r.id).getItem(a,i,o)]}case"TensorListScatterV2":case"TensorListScatter":{const r=O("indices",t,e,n),a=O("tensor",t,e,n),i=O("elementShape",t,e,n),o=O("numElements",t,e,n),s=ohe(a,r,i,o);return n.addTensorList(s),[s.idTensor]}case"TensorListReserve":case"EmptyTensorList":{const r=O("elementShape",t,e,n),a=O("elementDType",t,e,n);let i;t.op==="TensorListReserve"?i="numElements":i="maxNumElements";const o=O(i,t,e,n),s=t.op==="TensorListReserve"?-1:o,l=ihe(r,a,o,s);return n.addTensorList(l),[l.idTensor]}case"TensorListGather":{const r=O("tensorListId",t,e,n),a=O("indices",t,e,n),i=O("elementShape",t,e,n),o=O("elementDType",t,e,n);return[n.getTensorList(r.id).gather(a,o,i)]}case"TensorListStack":{const r=O("tensorListId",t,e,n),a=O("elementShape",t,e,n),i=O("elementDType",t,e,n),o=O("numElements",t,e,n);return[n.getTensorList(r.id).stack(a,i,o)]}case"TensorListFromTensor":{const r=O("tensor",t,e,n),a=O("elementShape",t,e,n),i=O("elementDType",t,e,n),o=ahe(r,a,i);return n.addTensorList(o),[o.idTensor]}case"TensorListConcat":case"TensorListConcatV2":{const r=O("tensorListId",t,e,n),a=n.getTensorList(r.id),i=O("dtype",t,e,n),o=O("elementShape",t,e,n);return[a.concat(i,o)]}case"TensorListPushBack":{const r=O("tensorListId",t,e,n),a=O("tensor",t,e,n),i=n.getTensorList(r.id);return i.pushBack(a),[i.idTensor]}case"TensorListPopBack":{const r=O("tensorListId",t,e,n),a=O("elementShape",t,e,n),i=O("elementDType",t,e,n);return[n.getTensorList(r.id).popBack(a,i)]}case"TensorListSplit":{const r=O("tensor",t,e,n),a=O("elementShape",t,e,n),i=O("lengths",t,e,n),o=she(r,i,a);return n.addTensorList(o),[o.idTensor]}case"TensorListLength":{const r=O("tensorListId",t,e,n),a=n.getTensorList(r.id);return[St(a.size(),"int32")]}case"TensorListResize":{const r=O("tensorListId",t,e,n),a=O("size",t,e,n),i=n.getTensorList(r.id).resize(a);return n.addTensorList(i),[i.idTensor]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function fF(t,e,n){const[r,a]=O("fusedOps",t,e,n),i=r==="biasadd",o=!i,s=a==="prelu",l=r==="fusedbatchnorm",u=O("numArgs",t,e,n);if(i){if(s&&u!==2)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!s&&i&&u!==1)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(l)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported");const c=O("strides",t,e,n),d=Xx(t,e,n),p=O("dataFormat",t,e,n).toUpperCase(),f=O("dilations",t,e,n);let[g,y]=O("args",t,e,n);o&&(y=g,g=void 0);const x=O("leakyreluAlpha",t,e,n);return{stride:c,pad:d,dataFormat:p,dilations:f,biasArg:g,preluArg:y,activationFunc:a,leakyreluAlpha:x}}const uhe=(t,e,n,r=Gr)=>{switch(t.op){case"Conv1D":{const a=O("stride",t,e,n),i=O("pad",t,e,n),o=O("dataFormat",t,e,n).toUpperCase(),s=O("dilation",t,e,n);return[r.conv1d(O("x",t,e,n),O("filter",t,e,n),a,i,o,s)]}case"Conv2D":{const a=O("strides",t,e,n),i=Xx(t,e,n),o=O("dataFormat",t,e,n).toUpperCase(),s=O("dilations",t,e,n);return[r.conv2d(O("x",t,e,n),O("filter",t,e,n),[a[1],a[2]],i,o,[s[1],s[2]])]}case"_FusedConv2D":{const{stride:a,pad:i,dataFormat:o,dilations:s,biasArg:l,preluArg:u,activationFunc:c,leakyreluAlpha:d}=fF(t,e,n);return[r.fused.conv2d({x:O("x",t,e,n),filter:O("filter",t,e,n),strides:[a[1],a[2]],pad:i,dataFormat:o,dilations:[s[1],s[2]],bias:l,activation:c,preluActivationWeights:u,leakyreluAlpha:d})]}case"FusedDepthwiseConv2dNative":{const{stride:a,pad:i,dataFormat:o,dilations:s,biasArg:l,preluArg:u,activationFunc:c,leakyreluAlpha:d}=fF(t,e,n);return[r.fused.depthwiseConv2d({x:O("x",t,e,n),filter:O("filter",t,e,n),strides:[a[1],a[2]],pad:i,dataFormat:o,dilations:[s[1],s[2]],bias:l,activation:c,preluActivationWeights:u,leakyreluAlpha:d})]}case"Conv2DBackpropInput":case"Conv2dTranspose":{const a=O("outputShape",t,e,n),i=O("strides",t,e,n),o=Xx(t,e,n);return[r.conv2dTranspose(O("x",t,e,n),O("filter",t,e,n),a,[i[1],i[2]],o)]}case"DepthwiseConv2dNative":case"DepthwiseConv2d":{const a=O("strides",t,e,n),i=Xx(t,e,n),o=O("dilations",t,e,n),s=O("dataFormat",t,e,n).toUpperCase();return[r.depthwiseConv2d(O("input",t,e,n),O("filter",t,e,n),[a[1],a[2]],i,s,[o[1],o[2]])]}case"Conv3D":{const a=O("strides",t,e,n),i=O("pad",t,e,n),o=O("dataFormat",t,e,n).toUpperCase(),s=O("dilations",t,e,n);return[r.conv3d(O("x",t,e,n),O("filter",t,e,n),[a[1],a[2],a[3]],i,o,[s[1],s[2],s[3]])]}case"AvgPool":{const a=O("strides",t,e,n),i=O("pad",t,e,n),o=O("kernelSize",t,e,n);return[r.avgPool(O("x",t,e,n),[o[1],o[2]],[a[1],a[2]],i)]}case"MaxPool":{const a=O("strides",t,e,n),i=O("pad",t,e,n),o=O("kernelSize",t,e,n);return[r.maxPool(O("x",t,e,n),[o[1],o[2]],[a[1],a[2]],i)]}case"MaxPoolWithArgmax":{const a=O("strides",t,e,n),i=O("pad",t,e,n),o=O("kernelSize",t,e,n),s=O("includeBatchInIndex",t,e,n),{result:l,indexes:u}=r.maxPoolWithArgmax(O("x",t,e,n),[o[1],o[2]],[a[1],a[2]],i,s);return[l,u]}case"AvgPool3D":{const a=O("strides",t,e,n),i=O("pad",t,e,n),o=O("kernelSize",t,e,n);return[r.avgPool3d(O("x",t,e,n),[o[1],o[2],o[3]],[a[1],a[2],a[3]],i)]}case"MaxPool3D":{const a=O("strides",t,e,n),i=O("pad",t,e,n),o=O("kernelSize",t,e,n);return[r.maxPool3d(O("x",t,e,n),[o[1],o[2],o[3]],[a[1],a[2],a[3]],i)]}case"Dilation2D":{const a=O("strides",t,e,n),i=O("pad",t,e,n),o=O("dilations",t,e,n),s=a[1],l=a[2],u=o[1],c=o[2];return[r.dilation2d(O("x",t,e,n),O("filter",t,e,n),[s,l],i,[u,c],"NHWC")]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const che=(t,e,n,r=Gr)=>{switch(t.op){case"Fill":{const a=O("shape",t,e,n),i=O("dtype",t,e,n),o=O("value",t,e,n);return[r.fill(a,o,i)]}case"LinSpace":{const a=O("start",t,e,n),i=O("stop",t,e,n),o=O("num",t,e,n);return[r.linspace(a,i,o)]}case"Multinomial":{const a=O("logits",t,e,n),i=O("numSamples",t,e,n),o=O("seed",t,e,n);return[r.multinomial(a,i,o)]}case"OneHot":{const a=O("indices",t,e,n),i=O("depth",t,e,n),o=O("onValue",t,e,n),s=O("offValue",t,e,n),l=O("dtype",t,e,n);return[r.oneHot(a,i,o,s,l)]}case"Ones":return[r.ones(O("shape",t,e,n),O("dtype",t,e,n))];case"OnesLike":return[r.onesLike(O("x",t,e,n))];case"RandomStandardNormal":return[r.randomStandardNormal(O("shape",t,e,n),O("dtype",t,e,n),O("seed",t,e,n))];case"RandomUniform":return[r.randomUniform(O("shape",t,e,n),O("minval",t,e,n),O("maxval",t,e,n),O("dtype",t,e,n))];case"Range":{const a=O("start",t,e,n),i=O("stop",t,e,n),o=O("step",t,e,n);return[r.range(a,i,o,O("dtype",t,e,n))]}case"TruncatedNormal":{const a=O("shape",t,e,n),i=O("mean",t,e,n),o=O("stdDev",t,e,n),s=O("seed",t,e,n);return[r.truncatedNormal(a,i,o,O("dtype",t,e,n),s)]}case"Zeros":return[r.zeros(O("shape",t,e,n),O("dtype",t,e,n))];case"ZerosLike":return[r.zerosLike(O("x",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function g4(t,e,n){const r=O("boxes",t,e,n),a=O("scores",t,e,n),i=O("maxOutputSize",t,e,n),o=O("iouThreshold",t,e,n),s=O("scoreThreshold",t,e,n),l=O("softNmsSigma",t,e,n);return{boxes:r,scores:a,maxOutputSize:i,iouThreshold:o,scoreThreshold:s,softNmsSigma:l}}const dhe=async(t,e,n,r,a=Gr)=>{switch(t.op){case"NonMaxSuppressionV5":{const{boxes:i,scores:o,maxOutputSize:s,iouThreshold:l,scoreThreshold:u,softNmsSigma:c}=g4(t,e,n),d=await a.image.nonMaxSuppressionWithScoreAsync(i,o,s,l,u,c);return[d.selectedIndices,d.selectedScores]}case"NonMaxSuppressionV4":{const{boxes:i,scores:o,maxOutputSize:s,iouThreshold:l,scoreThreshold:u}=g4(t,e,n),c=O("padToMaxOutputSize",t,e,n),d=await a.image.nonMaxSuppressionPaddedAsync(i,o,s,l,u,c);return[d.selectedIndices,d.validOutputs]}case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":{const{boxes:i,scores:o,maxOutputSize:s,iouThreshold:l,scoreThreshold:u}=g4(t,e,n);return[await a.image.nonMaxSuppressionAsync(i,o,s,l,u)]}case"Where":{const i=a.cast(O("condition",t,e,n),"bool"),o=[await a.whereAsync(i)];return i.dispose(),o}case"ListDiff":return a.setdiff1dAsync(O("x",t,e,n),O("y",t,e,n));default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const phe=(t,e,n,r=Gr)=>{switch(t.op){case"LowerBound":{const a=O("sortedSequence",t,e,n),i=O("values",t,e,n);return[r.lowerBound(a,i)]}case"TopKV2":{const a=O("x",t,e,n),i=O("k",t,e,n),o=O("sorted",t,e,n),s=r.topk(a,i,o);return[s.values,s.indices]}case"UpperBound":{const a=O("sortedSequence",t,e,n),i=O("values",t,e,n);return[r.upperBound(a,i)]}case"Unique":{const a=O("x",t,e,n),i=r.unique(a);return[i.values,i.indices]}case"UniqueV2":{const a=O("x",t,e,n),i=O("axis",t,e,n),o=r.unique(a,i);return[o.values,o.indices]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const hhe=(t,e,n,r=Gr)=>{switch(t.op){case"Const":return e[t.name];case"PlaceholderWithDefault":const a=O("default",t,e,n);return[sa(t.name,e,n)||a];case"Placeholder":return[sa(t.name,e,n)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":{const c=O("x",t,e,n);return[As(c)]}case"IdentityN":return O("x",t,e,n).map(c=>As(c));case"Snapshot":const i=O("x",t,e,n);return[As(i)];case"Shape":return[r.tensor1d(O("x",t,e,n).shape,"int32")];case"ShapeN":return O("x",t,e,n).map(c=>r.tensor1d(c.shape));case"Size":return[r.scalar(O("x",t,e,n).size,"int32")];case"Rank":return[r.scalar(O("x",t,e,n).rank,"int32")];case"NoOp":return[r.scalar(1)];case"Print":const o=O("x",t,e,n),s=O("data",t,e,n),l=O("message",t,e,n),u=O("summarize",t,e,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(l);for(let c=0;c<s.length;c++)console.log(Array.prototype.slice.call(s[c].dataSync()).slice(0,u));return[o];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class fhe{constructor(e,n){this.keyDType=e,this.valueDType=n,this.handle=St(0),this.tensorMap=new Map,Mo(this.handle)}get id(){return this.handle.id}clearAndClose(){this.tensorMap.forEach(e=>e.dispose()),this.tensorMap.clear(),this.handle.dispose()}size(){return this.tensorMap.size}tensorSize(){return St(this.size(),"int32")}async import(e,n){this.checkKeyAndValueTensor(e,n);const r=await e.data();return this.tensorMap.forEach(a=>a.dispose()),this.tensorMap.clear(),Ot(()=>{const a=Vl(n),i=r.length,o=a.length;V(i===o,()=>`The number of elements doesn't match, keys has ${i} elements, the values has ${o} elements.`);for(let s=0;s<i;s++){const l=r[s],u=a[s];Mo(u),this.tensorMap.set(l,u)}return this.handle})}async find(e,n){this.checkKeyAndValueTensor(e,n);const r=await e.data();return Ot(()=>{const a=[];for(let i=0;i<r.length;i++){const o=r[i],s=this.findWithDefault(o,n);a.push(s)}return Lo(a)})}findWithDefault(e,n){return this.tensorMap.get(e)??n}checkKeyAndValueTensor(e,n){if(e.dtype!==this.keyDType)throw new Error(`Expect key dtype ${this.keyDType}, but got ${e.dtype}`);if(n.dtype!==this.valueDType)throw new Error(`Expect value dtype ${this.valueDType}, but got ${n.dtype}`)}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const mhe=async(t,e,n,r)=>{switch(t.op){case"HashTable":case"HashTableV2":{const a=O("keyDType",t,e,n),i=O("valueDType",t,e,n),o=new fhe(a,i);return r.addHashTable(t.name,o),[o.handle]}case"LookupTableImport":case"LookupTableImportV2":{const a=O("tableHandle",t,e,n,r),i=O("keys",t,e,n),o=O("values",t,e,n);return[await r.getHashTableById(a.id).import(i,o)]}case"LookupTableFind":case"LookupTableFindV2":{const a=O("tableHandle",t,e,n,r),i=O("keys",t,e,n),o=O("defaultValue",t,e,n);return[await r.getHashTableById(a.id).find(i,o)]}case"LookupTableSize":case"LookupTableSizeV2":{const a=O("tableHandle",t,e,n,r);return[r.getHashTableById(a.id).tensorSize()]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const ghe=(t,e,n,r=Gr)=>{switch(t.op){case"ResizeBilinear":{const a=O("images",t,e,n),i=O("size",t,e,n),o=O("alignCorners",t,e,n),s=O("halfPixelCenters",t,e,n);return[r.image.resizeBilinear(a,[i[0],i[1]],o,s)]}case"ResizeNearestNeighbor":{const a=O("images",t,e,n),i=O("size",t,e,n),o=O("alignCorners",t,e,n),s=O("halfPixelCenters",t,e,n);return[r.image.resizeNearestNeighbor(a,[i[0],i[1]],o,s)]}case"CropAndResize":{const a=O("image",t,e,n),i=O("boxes",t,e,n),o=O("boxInd",t,e,n),s=O("cropSize",t,e,n),l=O("method",t,e,n),u=O("extrapolationValue",t,e,n);return[r.image.cropAndResize(a,i,o,s,l,u)]}case"ImageProjectiveTransformV3":{const a=O("images",t,e,n),i=O("transforms",t,e,n),o=O("outputShape",t,e,n),s=O("fillValue",t,e,n),l=O("interpolation",t,e,n),u=O("fillMode",t,e,n);return[r.image.transform(a,i,l.toLowerCase(),u.toLowerCase(),s,o)]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const yhe=(t,e,n,r=Gr)=>{switch(t.op){case"Equal":return[r.equal(O("a",t,e,n),O("b",t,e,n))];case"NotEqual":return[r.notEqual(O("a",t,e,n),O("b",t,e,n))];case"Greater":return[r.greater(O("a",t,e,n),O("b",t,e,n))];case"GreaterEqual":return[r.greaterEqual(O("a",t,e,n),O("b",t,e,n))];case"Less":return[r.less(O("a",t,e,n),O("b",t,e,n))];case"LessEqual":return[r.lessEqual(O("a",t,e,n),O("b",t,e,n))];case"LogicalAnd":return[r.logicalAnd(O("a",t,e,n),O("b",t,e,n))];case"LogicalNot":return[r.logicalNot(O("a",t,e,n))];case"LogicalOr":return[r.logicalOr(O("a",t,e,n),O("b",t,e,n))];case"Select":case"SelectV2":return[r.where(O("condition",t,e,n),O("a",t,e,n),O("b",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const bhe=(t,e,n,r=Gr)=>{switch(t.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[r.matMul(O("a",t,e,n),O("b",t,e,n),O("transposeA",t,e,n),O("transposeB",t,e,n))];case"Einsum":return[r.einsum(O("equation",t,e,n),...O("tensors",t,e,n))];case"Transpose":return[r.transpose(O("x",t,e,n),O("perm",t,e,n))];case"_FusedMatMul":const[a,i]=O("fusedOps",t,e,n),o=a==="biasadd",s=i==="prelu",l=O("numArgs",t,e,n),u=O("leakyreluAlpha",t,e,n);if(o){if(s&&l!==2)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!s&&l!==1)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}const[c,d]=O("args",t,e,n);return[r.fused.matMul({a:O("a",t,e,n),b:O("b",t,e,n),transposeA:O("transposeA",t,e,n),transposeB:O("transposeB",t,e,n),bias:c,activation:i,preluActivationWeights:d,leakyreluAlpha:u})];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const vhe=(t,e,n,r=Gr)=>{switch(t.op){case"EuclideanNorm":return[r.euclideanNorm(O("x",t,e,n),O("axis",t,e,n),O("keepDims",t,e,n))];case"FusedBatchNorm":case"FusedBatchNormV2":return[r.batchNorm(O("x",t,e,n),O("mean",t,e,n),O("variance",t,e,n),O("offset",t,e,n),O("scale",t,e,n),O("epsilon",t,e,n))];case"FusedBatchNormV3":return[r.batchNorm(O("x",t,e,n),O("mean",t,e,n),O("variance",t,e,n),O("offset",t,e,n),O("scale",t,e,n),O("epsilon",t,e,n))];case"LRN":return[r.localResponseNormalization(O("x",t,e,n),O("radius",t,e,n),O("bias",t,e,n),O("alpha",t,e,n),O("beta",t,e,n))];case"Softmax":return[r.softmax(O("x",t,e,n))];case"LogSoftmax":return[r.logSoftmax(O("x",t,e,n))];case"SparseToDense":return[r.sparseToDense(O("sparseIndices",t,e,n),O("outputShape",t,e,n),O("sparseValues",t,e,n),O("defaultValue",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const xhe=(t,e,n,r=Gr)=>{switch(t.op){case"Max":{const s=O("axis",t,e,n),l=O("keepDims",t,e,n);return[r.max(O("x",t,e,n),s,l)]}case"Mean":{const s=O("axis",t,e,n),l=O("keepDims",t,e,n);return[r.mean(O("x",t,e,n),s,l)]}case"Min":{const s=O("axis",t,e,n),l=O("keepDims",t,e,n);return[r.min(O("x",t,e,n),s,l)]}case"Sum":{const s=O("axis",t,e,n),l=O("keepDims",t,e,n);return[r.sum(O("x",t,e,n),s,l)]}case"All":{const s=O("axis",t,e,n),l=O("keepDims",t,e,n);return[r.all(O("x",t,e,n),s,l)]}case"Any":{const s=O("axis",t,e,n),l=O("keepDims",t,e,n);return[r.any(O("x",t,e,n),s,l)]}case"ArgMax":{const s=O("axis",t,e,n);return[r.argMax(O("x",t,e,n),s)]}case"ArgMin":{const s=O("axis",t,e,n);return[r.argMin(O("x",t,e,n),s)]}case"Prod":{const s=O("axis",t,e,n),l=O("keepDims",t,e,n);return[r.prod(O("x",t,e,n),s,l)]}case"Cumprod":{const s=O("axis",t,e,n),l=O("exclusive",t,e,n),u=O("reverse",t,e,n);return[r.cumprod(O("x",t,e,n),s,l,u)]}case"Cumsum":{const s=O("axis",t,e,n),l=O("exclusive",t,e,n),u=O("reverse",t,e,n);return[r.cumsum(O("x",t,e,n),s,l,u)]}case"Bincount":const a=O("x",t,e,n),i=O("weights",t,e,n),o=O("size",t,e,n);return[r.bincount(a,i,o)];case"DenseBincount":{const s=O("x",t,e,n),l=O("weights",t,e,n),u=O("size",t,e,n),c=O("binaryOutput",t,e,n);return[r.denseBincount(s,l,u,c)]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const whe=(t,e,n,r=Gr)=>{switch(t.op){case"ConcatV2":case"Concat":{const a=O("n",t,e,n),i=O("axis",t,e,n);let o=O("tensors",t,e,n);return o=o.slice(0,a),[r.concat(o,i)]}case"Gather":{const a=O("x",t,e,n),i=O("indices",t,e,n);return[r.gather(a,r.cast(i,"int32"),0)]}case"GatherV2":{const a=O("axis",t,e,n),i=O("batchDims",t,e,n),o=O("x",t,e,n),s=O("indices",t,e,n);return[r.gather(o,r.cast(s,"int32"),a,i)]}case"Reverse":{const a=O("dims",t,e,n),i=[];for(let s=0;s<a.length;s++)a[s]&&i.push(s);const o=O("x",t,e,n);return[r.reverse(o,i)]}case"ReverseV2":{const a=O("axis",t,e,n),i=O("x",t,e,n);return[r.reverse(i,a)]}case"Slice":{const a=O("begin",t,e,n),i=O("size",t,e,n);return[r.slice(O("x",t,e,n),a,i)]}case"StridedSlice":{const a=O("begin",t,e,n),i=O("end",t,e,n),o=O("strides",t,e,n),s=O("beginMask",t,e,n),l=O("endMask",t,e,n),u=O("ellipsisMask",t,e,n),c=O("newAxisMask",t,e,n),d=O("shrinkAxisMask",t,e,n),p=O("x",t,e,n);return[r.stridedSlice(p,a,i,o,s,l,u,c,d)]}case"Pack":return Ot(()=>{const a=O("axis",t,e,n),i=O("tensors",t,e,n),o=i[0].shape,s=r.squeeze(i[0]).shape,l=i.map(u=>{const c=tn(u.shape,o);if(!c&&!tn(r.squeeze(u).shape,s))throw new Error("the input tensors shape does not match");return c?u:r.reshape(u,o)});return[r.stack(l,a)]});case"Unpack":{const a=O("axis",t,e,n),i=O("tensor",t,e,n);return r.unstack(i,a)}case"Tile":{const a=O("reps",t,e,n);return[r.tile(O("x",t,e,n),a)]}case"Split":case"SplitV":{const a=O("axis",t,e,n),i=O("numOrSizeSplits",t,e,n),o=O("x",t,e,n);return r.split(o,i,a)}case"ScatterNd":{const a=O("indices",t,e,n),i=O("values",t,e,n),o=O("shape",t,e,n);return[r.scatterND(a,i,o)]}case"GatherNd":{const a=O("x",t,e,n),i=O("indices",t,e,n);return[r.gatherND(a,i)]}case"SparseToDense":{const a=O("sparseIndices",t,e,n),i=O("outputShape",t,e,n),o=O("sparseValues",t,e,n),s=O("defaultValue",t,e,n);return[r.sparseToDense(a,o,i,o.dtype===s.dtype?s:r.cast(s,o.dtype))]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const khe=(t,e,n,r=Gr)=>{switch(t.op){case"SparseFillEmptyRows":{const{outputIndices:a,outputValues:i,emptyRowIndicator:o,reverseIndexMap:s}=r.sparse.sparseFillEmptyRows(O("indices",t,e,n),O("values",t,e,n),O("denseShape",t,e,n),O("defaultValue",t,e,n));return[a,i,o,s]}case"SparseReshape":{const{outputIndices:a,outputShape:i}=r.sparse.sparseReshape(O("inputIndices",t,e,n),O("inputShape",t,e,n),O("newShape",t,e,n));return[a,i]}case"SparseSegmentMean":return[r.sparse.sparseSegmentMean(O("data",t,e,n),O("indices",t,e,n),O("segmentIds",t,e,n))];case"SparseSegmentSum":return[r.sparse.sparseSegmentSum(O("data",t,e,n),O("indices",t,e,n),O("segmentIds",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const She=(t,e,n,r=Gr)=>{switch(t.op){case"FFT":return[r.fft(O("x",t,e,n))];case"IFFT":return[r.ifft(O("x",t,e,n))];case"RFFT":return[r.rfft(O("x",t,e,n))];case"IRFFT":return[r.irfft(O("x",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Che=(t,e,n,r=Gr)=>{switch(t.op){case"StringNGrams":{const{nGrams:a,nGramsSplits:i}=r.string.stringNGrams(O("data",t,e,n),O("dataSplits",t,e,n),O("separator",t,e,n),O("nGramWidths",t,e,n),O("leftPad",t,e,n),O("rightPad",t,e,n),O("padWidth",t,e,n),O("preserveShortSequences",t,e,n));return[a,i]}case"StringSplit":{const{indices:a,values:i,shape:o}=r.string.stringSplit(O("input",t,e,n),O("delimiter",t,e,n),O("skipEmpty",t,e,n));return[a,i,o]}case"StringToHashBucketFast":return[r.string.stringToHashBucketFast(O("input",t,e,n),O("numBuckets",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Nhe=(t,e,n,r=Gr)=>{switch(t.op){case"Cast":return[r.cast(O("x",t,e,n),O("dtype",t,e,n))];case"ExpandDims":{const a=O("axis",t,e,n);return[r.expandDims(O("x",t,e,n),a)]}case"Squeeze":{const a=O("axis",t,e,n);return[r.squeeze(O("x",t,e,n),a)]}case"Reshape":return[r.reshape(O("x",t,e,n),O("shape",t,e,n))];case"MirrorPad":return[r.mirrorPad(O("x",t,e,n),O("padding",t,e,n),O("mode",t,e,n))];case"PadV2":case"Pad":return[r.pad(O("x",t,e,n),O("padding",t,e,n),O("constantValue",t,e,n))];case"SpaceToBatchND":{const a=O("blockShape",t,e,n),i=O("paddings",t,e,n);return[r.spaceToBatchND(O("x",t,e,n),a,i)]}case"BatchToSpaceND":{const a=O("blockShape",t,e,n),i=O("crops",t,e,n);return[r.batchToSpaceND(O("x",t,e,n),a,i)]}case"DepthToSpace":{const a=O("blockSize",t,e,n),i=O("dataFormat",t,e,n).toUpperCase();return[r.depthToSpace(O("x",t,e,n),a,i)]}case"BroadcastTo":return[r.broadcastTo(O("x",t,e,n),O("shape",t,e,n))];case"BroadcastArgs":return[r.broadcastArgs(O("s0",t,e,n),O("s1",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function mF(t,e,n,r,a=Ot){const i=((o,s,l)=>{switch(o.category){case"arithmetic":return a(()=>the(o,s,l));case"basic_math":return a(()=>nhe(o,s,l));case"control":return lhe(o,s,l);case"convolution":return a(()=>uhe(o,s,l));case"creation":return a(()=>che(o,s,l));case"dynamic":return dhe(o,s,l);case"evaluation":return a(()=>phe(o,s,l));case"image":return a(()=>ghe(o,s,l));case"graph":return a(()=>hhe(o,s,l));case"logical":return a(()=>yhe(o,s,l));case"matrices":return a(()=>bhe(o,s,l));case"normalization":return a(()=>vhe(o,s,l));case"reduction":return a(()=>xhe(o,s,l));case"slice_join":return a(()=>whe(o,s,l));case"sparse":return a(()=>khe(o,s,l));case"spectral":return a(()=>She(o,s,l));case"string":return a(()=>Che(o,s,l));case"transformation":return a(()=>Nhe(o,s,l));case"hash_table":return mhe(o,s,l,r);case"custom":const u=lF(o.op);if(u&&u.customExecutor)return u.customExecutor(new ehe(o,s,l));throw TypeError(`Custom op ${o.op} is not registered.`);default:throw TypeError(`Unknown op '${o.op}'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()`)}})(t,e,n);return qu(i)?i.then(o=>[].concat(o)):[].concat(i)}class gF{constructor(e={},n={},r={},a={}){this.weightMap=e,this.tensorArrayMap=n,this.tensorListMap=r,this.functionMap=a,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}newFrame(e,n){return{id:e,frameName:n,iterationId:0}}set currentContext(e){this.contexts!==e&&(this.contexts=e,this.generateCurrentContextIds())}get currentContext(){return this.contexts}get currentContextId(){return this._currentContextIds[0]}get currentContextIds(){return this._currentContextIds}generateCurrentContextIds(){const e=[];for(let n=0;n<this.contexts.length-1;n++){const r=this.contexts.slice(0,this.contexts.length-n);e.push(this.contextIdforContexts(r))}e.push(""),this._currentContextIds=e}contextIdforContexts(e){return e?e.map(n=>n.id===0&&n.iterationId===0?"":`${n.frameName}-${n.iterationId}`).join("/"):""}enterFrame(e){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,e)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}exitFrame(){if(this.contexts&&this.contexts.length>1)this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift();else throw new Error("Cannot exit frame, the context is empty")}nextIteration(){if(this.contexts&&this.contexts.length>0){this.contexts=this.contexts.slice(),this.lastId++;const e=Object.assign({},this.contexts[this.contexts.length-1]);e.iterationId+=1,e.id=this.lastId,this.contexts.splice(-1,1,e),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}else throw new Error("Cannot increase frame iteration, the context is empty")}getWeight(e){return this.weightMap[e]}addTensorArray(e){this.tensorArrayMap[e.id]=e}getTensorArray(e){return this.tensorArrayMap[e]}addTensorList(e){this.tensorListMap[e.id]=e}getTensorList(e){return this.tensorListMap[e]}dispose(e){for(const n in this.tensorArrayMap)this.tensorArrayMap[n].clearAndClose(e);for(const n in this.tensorListMap)this.tensorListMap[n].clearAndClose(e)}}/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function yF(t,e,n,r){const a=new Set,i=[];let o=null,s=null;const l=new Set,u=Object.keys(t).map(p=>Wa(p)[0]);let c=[];r!=null&&(c=r.map(p=>Wa(p.name)[0]));const d=[...e];for(;d.length>0;){const p=d.pop();if((bF(p)||Ohe(p)||$he(p))&&o==null&&(o=p,s=o.children.map(f=>f.name).filter(f=>a.has(f))),a.add(p.name),n[p.name]==null&&u.indexOf(p.name)===-1&&c.indexOf(p.name)===-1){if(p.inputs.length===0){i.push(p.name);continue}p.inputs.forEach(f=>{l.has(f.name)||(l.add(f.name),d.push(f))})}}return{inputs:t,outputs:e,usedNodes:a,missingInputs:i,dynamicNode:o,syncInputs:s}}function The(t,e,n){const{usedNodes:r,inputs:a}=n,i=[],o=Object.keys(a).map(c=>Wa(c)[0]).map(c=>t.nodes[c]),s=t.initNodes;o.forEach(c=>{r.has(c.name)&&i.push(c)}),t.weights.forEach(c=>{r.has(c.name)&&i.push(c)}),s?.forEach(c=>{r.has(c.name)&&i.push(c)});const l=new Set,u=[];for(;i.length>0;){const c=i.pop();l.add(c.name),e[c.name]||u.push(c),c.children.forEach(d=>{!l.has(d.name)&&r.has(d.name)&&d.inputs.every(p=>l.has(p.name))&&i.push(d)})}return u}const Ihe=["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"],Ehe=["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"],_he=["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"];function bF(t){return Ihe.indexOf(t.op)>=0}function Ohe(t){return Ehe.indexOf(t.op)>=0}function $he(t){return _he.indexOf(t.op)>=0}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class j2{constructor(e,n){this.graph=e,this.parent=n,this.compiledMap=new Map,this._weightMap={},this.SEPERATOR=",",this._functions={},this._functionExecutorMap={},this.intermediateTensors={},this.keepTensorForDebug=!1,this._outputs=e.outputs,this._inputs=e.inputs,this._initNodes=e.initNodes,this._signature=e.signature,this._functions=e.functions,e.functions!=null&&Object.keys(e.functions).forEach(r=>{this._functionExecutorMap[r]=new j2(e.functions[r],this)})}get weightIds(){return this.parent?this.parent.weightIds:this._weightIds}get functionExecutorMap(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}get weightMap(){return this.parent?this.parent.weightMap:this._weightMap}set weightMap(e){const n=Object.keys(e).map(r=>e[r].map(a=>a.id));this._weightIds=[].concat(...n),this._weightMap=e}set resourceManager(e){this._resourceManager=e}get inputs(){return this._inputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get outputs(){return this._outputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get inputNodes(){return this._inputs.map(e=>e.signatureKey||e.name)}get outputNodes(){return this._outputs.map(e=>{const n=e.signatureKey||e.name;return e.defaultOutput?`${n}:${e.defaultOutput}`:n})}get functions(){return Object.keys(this._functions).reduce((e,n)=>(e[n]=this._functions[n].signature,e),{})}getCompilationKey(e,n){const r=e.map(i=>i.name).sort(),a=n.map(i=>i.name).sort();return r.join(this.SEPERATOR)+"--"+a.join(this.SEPERATOR)}compile(e,n){const r=yF(e,n,this.weightMap,this._initNodes),{missingInputs:a,dynamicNode:i,syncInputs:o}=r;if(i!=null)throw new Error(`This execution contains the node '${i.name}', which has the dynamic op '${i.op}'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs [${o}]`);if(a.length>0){const s=n.map(u=>u.name),l=Object.keys(e);throw new Error(`Cannot compute the outputs [${s}] from the provided inputs [${l}]. Missing the following inputs: [${a}]`)}return The(this.graph,this.weightMap,r)}execute(e,n){e=this.mapInputs(e);const r=Object.keys(e).sort();this.checkInputs(e),this.checkInputShapeAndType(e),n=this.mapOutputs(n),this.checkOutputs(n);const a=r.map(d=>this.graph.nodes[Wa(d)[0]]),i=n.map(d=>Wa(d)[0]);let o=i.map(d=>this.graph.nodes[d]);this.resetIntermediateTensors(),o.length===0&&(o=this._outputs);const s=this.getCompilationKey(a,o);let l=this.compiledMap.get(s);l==null&&(l=this.compile(e,o),this.compiledMap.set(s,l));const u={},c={};return Ot(()=>{const d=new gF(this.weightMap,u,c,this.functionExecutorMap),p=Object.assign({},this.weightMap);Object.keys(e).forEach(y=>{const[x,b]=Wa(y),v=[];v[b]=e[y],p[x]=v});const f=this.getFrozenTensorIds(p),g={};for(let y=0;y<l.length;y++){const x=l[y];if(!p[x.name]){const b=mF(x,p,d,this._resourceManager);if(qu(b))throw new Error(`The execution of the op '${x.op}' returned a promise. Please use model.executeAsync() instead.`);p[x.name]=b,this.checkTensorForDisposal(x.name,x,p,d,f,i,g)}}return this.parent==null&&d.dispose(f),n.map(y=>sa(y,p,d))})}getFrozenTensorIds(e){const n=[].concat.apply([],Object.keys(e).map(r=>e[r]).map(r=>r.map(a=>a.id)));return new Set(n)}checkTensorForDisposal(e,n,r,a,i,o,s){n.category==="control"||o.indexOf(e)!==-1||(r[e].forEach(l=>{l!=null&&(s[l.id]=(s[l.id]||0)+n.children.length)}),n.inputs.forEach(l=>{if(l.category!=="control"){const u=fpe(l.name,r,a);u?.forEach(c=>{if(c&&!c.kept&&!i.has(c.id)){const d=s[c.id];if(d===1){if(!this.keepTensorForDebug)c.dispose();else{const[p,f]=Bo(n.name,a);this.intermediateTensors[p]?this.intermediateTensors[p][f]=c:(this.intermediateTensors[p]=[],this.intermediateTensors[p][f]=c)}delete s[c.id]}else d!=null&&s[c.id]--}})}}))}async executeAsync(e,n){return this._executeAsync(e,n)}disposeIntermediateTensors(){this.intermediateTensors&&(Object.keys(this.intermediateTensors).forEach(e=>this.intermediateTensors[e].forEach(n=>n.dispose())),this.disposeTensorsMap())}disposeTensorsMap(){this.tensorsMap&&Object.keys(this.tensorsMap).forEach(e=>{this.tensorsMap[e].forEach(n=>{n&&!n.kept&&!n.isDisposed&&!this.keepIds.has(n.id)&&n.dispose()})})}getIntermediateTensors(){return this.tensorsMap}resetIntermediateTensors(){for(const e in this.intermediateTensors)this.intermediateTensors[e].forEach(n=>n.dispose()),delete this.intermediateTensors[e]}async _executeAsync(e,n,r=!1,a={},i={}){r||(e=this.mapInputs(e),this.checkInputs(e),this.checkInputShapeAndType(e),n=this.mapOutputs(n),this.checkOutputs(n));try{this.keepTensorForDebug=ue().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(c){console.warn(c.message)}this.resetIntermediateTensors();const o=new gF(this.weightMap,a,i,this.functionExecutorMap);this.tensorsMap=await this.executeWithControlFlow(e,o,n,r);const s=n.map(c=>sa(c,this.tensorsMap,o)),l=s.map(c=>c.id),u=Object.keys(e).map(c=>e[c].id);return this.keepIds=new Set([...l,...u,...this.weightIds]),this.keepTensorForDebug||this.disposeTensorsMap(),this.parent==null&&o.dispose(this.keepIds),s}async executeFunctionAsync(e,n,r){const a=e.reduce((i,o,s)=>(i[this.inputs[s].name]=o,i),{});return this._executeAsync(a,this.outputNodes,!0,n,r)}async executeWithControlFlow(e,n,r,a){const i=Object.keys(e),o=i.map(w=>this.graph.nodes[Wa(w)[0]]),s=r.map(w=>Wa(w)[0]);let l=s.map(w=>this.graph.nodes[w]);l.length===0&&(l=this._outputs);const{usedNodes:u,missingInputs:c,dynamicNode:d,syncInputs:p}=yF(e,l,this.weightMap,this._initNodes),f=[...o,...this.graph.weights,...this._initNodes||[]].map(w=>({node:w,contexts:n.currentContext})),g=Object.assign({},this.weightMap);Object.keys(e).forEach(w=>{const[S,C]=Wa(w),I=[];I[C]=e[w],g[S]=I});const y={},x=this.getFrozenTensorIds(g),b={};for(;f.length>0;){const w=this.processStack(o,f,n,g,b,x,s,y,u);await Promise.all(w)}d==null&&!a&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead.");const v=l.filter(w=>!bF(w)&&!sa(w.name,g,n)).map(w=>w.name);if(v.length>0){let w="";throw d!=null&&(w=`Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs [${p}]`),new Error(`Cannot compute the outputs [${v}] from the provided inputs [${i}]. Consider providing the following inputs: [${c}]. ${w}`)}return g}processStack(e,n,r,a,i,o,s,l,u){const c=[];for(;n.length>0;){const d=n.pop();r.currentContext=d.contexts;let p="";if(d.node.op==="Enter"&&O("isConstant",d.node,a,r)&&([p]=Bo(d.node.name,r)),a[d.node.name]==null){const f=mF(d.node,a,r,this._resourceManager);p||([p]=Bo(d.node.name,r));const g=r.currentContext;qu(f)?c.push(f.then(y=>(a[p]=y,r.currentContext=g,this.checkTensorForDisposal(p,d.node,a,r,o,s,l),this.processChildNodes(d.node,n,r,a,i,u),y))):(a[p]=f,this.checkTensorForDisposal(p,d.node,a,r,o,s,l),this.processChildNodes(d.node,n,r,a,i,u))}else this.processChildNodes(d.node,n,r,a,i,u)}return c}processChildNodes(e,n,r,a,i,o){e.children.forEach(s=>{const[l]=Bo(s.name,r);i[l]||!o.has(s.name)||(s.op==="Merge"?s.inputNames.some(u=>!!sa(u,a,r))&&(i[l]=!0,n.push({contexts:r.currentContext,node:s})):s.inputNames.every(u=>!!sa(u,a,r))&&(i[l]=!0,n.push({contexts:r.currentContext,node:s})))})}dispose(){Object.keys(this.weightMap).forEach(e=>this.weightMap[e].forEach(n=>n.dispose()))}checkInputShapeAndType(e){Object.keys(e).forEach(n=>{const r=e[n],[a]=Wa(n),i=this.graph.nodes[a];if(i.attrParams.shape&&i.attrParams.shape.value){const o=i.attrParams.shape.value,s=o.length===r.shape.length&&r.shape.every((l,u)=>o[u]===-1||o[u]===l);V(s,()=>`The shape of dict['${i.name}'] provided in model.execute(dict) must be [${o}], but was [${r.shape}]`)}i.attrParams.dtype&&i.attrParams.dtype.value&&V(r.dtype===i.attrParams.dtype.value,()=>`The dtype of dict['${i.name}'] provided in model.execute(dict) must be ${i.attrParams.dtype.value}, but was ${r.dtype}`)})}mapInputs(e){const n={};for(const r in e)if(this._signature!=null&&this._signature.inputs!=null&&this._signature.inputs[r]!=null){const a=this._signature.inputs[r];n[a.name]=e[r]}else n[r]=e[r];return n}checkInputs(e){const n=Object.keys(e).filter(r=>{const[a]=Wa(r);return this.graph.nodes[a]==null});if(n.length>0)throw new Error(`The dict provided in model.execute(dict) has keys: [${n}] that are not part of graph`)}mapOutputs(e){return e.map(n=>this._signature!=null&&this._signature.outputs!=null&&this._signature.outputs[n]!=null?this._signature.outputs[n].name:n,{})}checkOutputs(e){e.forEach(n=>{const[r]=Wa(n);if(!this.graph.nodes[r])throw new Error(`The output '${n}' is not found in the graph`)})}}class Rhe{constructor(e={},n={}){this.hashTableNameToHandle=e,this.hashTableMap=n}addHashTable(e,n){this.hashTableNameToHandle[e]=n.handle,this.hashTableMap[n.id]=n}getHashTableHandleByName(e){return this.hashTableNameToHandle[e]}getHashTableById(e){return this.hashTableMap[e]}dispose(){for(const e in this.hashTableMap)this.hashTableMap[e].clearAndClose(),delete this.hashTableMap[e];for(const e in this.hashTableNameToHandle)this.hashTableNameToHandle[e].dispose(),delete this.hashTableNameToHandle[e]}}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Mhe="?tfjs-format=file",Ahe="model.json";class Phe{constructor(e,n={},r=OT){this.modelUrl=e,this.loadOptions=n,this.version="n/a",this.io=r,n==null&&(this.loadOptions={}),this.resourceManager=new Rhe}get modelVersion(){return this.version}get inputNodes(){return this.executor.inputNodes}get outputNodes(){return this.executor.outputNodes}get inputs(){return this.executor.inputs}get outputs(){return this.executor.outputs}get weights(){return this.executor.weightMap}get metadata(){return this.artifacts.userDefinedMetadata}get modelSignature(){return this.signature}get modelStructuredOutputKeys(){return this.structuredOutputKeys}findIOHandler(){const e=this.modelUrl;if(e.load!=null)this.handler=e;else if(this.loadOptions.requestInit!=null)this.handler=this.io.browserHTTPRequest(e,this.loadOptions);else{const n=this.io.getLoadHandlers(e,this.loadOptions);if(n.length===0)n.push(this.io.browserHTTPRequest(e,this.loadOptions));else if(n.length>1)throw new Error(`Found more than one (${n.length}) load handlers for URL '${[e]}'`);this.handler=n[0]}}load(){if(this.findIOHandler(),this.handler.load==null)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const e=this.handler.load();return qu(e)?e.then(n=>this.loadSync(n)):this.loadSync(e)}loadSync(e){this.artifacts=e;const n=this.artifacts.modelTopology;let r=this.artifacts.signature;if(this.artifacts.userDefinedMetadata!=null){const i=this.artifacts.userDefinedMetadata;i.signature!=null&&(r=i.signature),i.structuredOutputKeys!=null&&(this.structuredOutputKeys=i.structuredOutputKeys)}this.signature=r,this.version=`${n.versions.producer}.${n.versions.minConsumer}`;const a=this.io.decodeWeights(this.artifacts.weightData,this.artifacts.weightSpecs);if(this.executor=new j2(uF.Instance.transformGraph(n,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(a),this.executor.resourceManager=this.resourceManager,e.modelInitializer!=null&&e.modelInitializer.node!=null){const i=uF.Instance.transformGraph(e.modelInitializer);this.initializer=new j2(i),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializer.executeAsync({},[])}return!0}async save(e,n){if(typeof e=="string"){const r=this.io.getSaveHandlers(e);if(r.length===0)throw new Error(`Cannot find any save handlers for URL '${e}'`);if(r.length>1)throw new Error(`Found more than one (${r.length}) save handlers for URL '${e}'`);e=r[0]}if(e.save==null)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return e.save(this.artifacts)}predict(e,n){const r=this.execute(e,this.outputNodes);if(this.structuredOutputKeys){const a=r instanceof In?[r]:r,i={};return a.forEach((o,s)=>i[this.structuredOutputKeys[s]]=o),i}return r}normalizeInputs(e){if(!(e instanceof In)&&!Array.isArray(e))return e;if(e=Array.isArray(e)?e:[e],e.length!==this.inputNodes.length)throw new Error(`Input tensor count mismatch,the graph model has ${this.inputNodes.length} placeholders, while there are ${e.length} input tensors.`);return this.inputNodes.reduce((n,r,a)=>(n[r]=e[a],n),{})}normalizeOutputs(e){return e=e||this.outputNodes,Array.isArray(e)?e:[e]}execute(e,n){e=this.normalizeInputs(e),n=this.normalizeOutputs(n);const r=this.executor.execute(e,n);return r.length>1?r:r[0]}async executeAsync(e,n){e=this.normalizeInputs(e),n=this.normalizeOutputs(n);const r=await this.executor.executeAsync(e,n);return r.length>1?r:r[0]}getIntermediateTensors(){return this.executor.getIntermediateTensors()}disposeIntermediateTensors(){this.executor.disposeIntermediateTensors()}convertTensorMapToTensorsMap(e){return Object.keys(e).reduce((n,r)=>(n[r]=[e[r]],n),{})}dispose(){this.executor.dispose(),this.initializer&&this.initializer.dispose(),this.resourceManager.dispose()}}async function Dhe(t,e={},n=OT){if(t==null)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");e==null&&(e={}),e.fromTFHub&&typeof t=="string"&&(t=Lhe(t));const r=new Phe(t,e,n);return await r.load(),r}function Lhe(t){return t.endsWith("/")||(t=t+"/"),`${t}${Ahe}${Mhe}`}/**
* @license
* Copyright 2023 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*//**
* @license
* Copyright 2023 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*//*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function Yx(t,e,n,r){return new(n||(n=Promise))(function(a,i){function o(u){try{l(r.next(u))}catch(c){i(c)}}function s(u){try{l(r.throw(u))}catch(c){i(c)}}function l(u){u.done?a(u.value):new n(function(c){c(u.value)}).then(o,s)}l((r=r.apply(t,e||[])).next())})}function Qx(t,e){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function s(l){return function(u){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&c[0]?r.return:c[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,c[1])).done)return a;switch(r=0,a&&(c=[2&c[0],a.value]),c[0]){case 0:case 1:a=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,r=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(a=o.trys,!((a=a.length>0&&a[a.length-1])||c[0]!==6&&c[0]!==2)){o=0;continue}if(c[0]===3&&(!a||c[1]>a[0]&&c[1]<a[3])){o.label=c[1];break}if(c[0]===6&&o.label<a[1]){o.label=a[1],a=c;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(c);break}a[2]&&o.ops.pop(),o.trys.pop();continue}c=e.call(t,o)}catch(d){c=[6,d],r=0}finally{n=a=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([l,u])}}}/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/var Fhe="https://tfhub.dev/tensorflow/tfjs-model/deeplab",Bhe=513,y4={ADE20K:[[0,0,0],[120,120,120],[180,120,120],[6,230,230],[80,50,50],[4,200,3],[120,120,80],[140,140,140],[204,5,255],[230,230,230],[4,250,7],[224,5,255],[235,255,7],[150,5,61],[120,120,70],[8,255,51],[255,6,82],[143,255,140],[204,255,4],[255,51,7],[204,70,3],[0,102,200],[61,230,250],[255,6,51],[11,102,255],[255,7,71],[255,9,224],[9,7,230],[220,220,220],[255,9,92],[112,9,255],[8,255,214],[7,255,224],[255,184,6],[10,255,71],[255,41,10],[7,255,255],[224,255,8],[102,8,255],[255,61,6],[255,194,7],[255,122,8],[0,255,20],[255,8,41],[255,5,153],[6,51,255],[235,12,255],[160,150,20],[0,163,255],[140,140,140],[250,10,15],[20,255,0],[31,255,0],[255,31,0],[255,224,0],[153,255,0],[0,0,255],[255,71,0],[0,235,255],[0,173,255],[31,0,255],[11,200,200],[255,82,0],[0,255,245],[0,61,255],[0,255,112],[0,255,133],[255,0,0],[255,163,0],[255,102,0],[194,255,0],[0,143,255],[51,255,0],[0,82,255],[0,255,41],[0,255,173],[10,0,255],[173,255,0],[0,255,153],[255,92,0],[255,0,255],[255,0,245],[255,0,102],[255,173,0],[255,0,20],[255,184,184],[0,31,255],[0,255,61],[0,71,255],[255,0,204],[0,255,194],[0,255,82],[0,10,255],[0,112,255],[51,0,255],[0,194,255],[0,122,255],[0,255,163],[255,153,0],[0,255,10],[255,112,0],[143,255,0],[82,0,255],[163,255,0],[255,235,0],[8,184,170],[133,0,255],[0,255,92],[184,0,255],[255,0,31],[0,184,255],[0,214,255],[255,0,112],[92,255,0],[0,224,255],[112,224,255],[70,184,160],[163,0,255],[153,0,255],[71,255,0],[255,0,163],[255,204,0],[255,0,143],[0,255,235],[133,255,0],[255,0,235],[245,0,255],[255,0,122],[255,245,0],[10,190,212],[214,255,0],[0,204,255],[20,0,255],[255,255,0],[0,153,255],[0,41,255],[0,255,204],[41,0,255],[41,255,0],[173,0,255],[0,245,255],[71,0,255],[122,0,255],[0,255,184],[0,92,255],[184,255,0],[0,133,255],[255,214,0],[25,194,194],[102,255,0],[92,0,255]],CITYSCAPES:[[128,64,128],[244,35,232],[70,70,70],[102,102,156],[190,153,153],[153,153,153],[250,170,30],[220,220,0],[107,142,35],[152,251,152],[70,130,180],[220,20,60],[255,0,0],[0,0,142],[0,0,70],[0,60,100],[0,80,100],[0,0,230],[119,11,32]],PASCAL:[[0,0,0],[128,0,0],[0,128,0],[128,128,0],[0,0,128],[128,0,128],[0,128,128],[128,128,128],[64,0,0],[192,0,0],[64,128,0],[192,128,0],[64,0,128],[192,0,128],[64,128,128],[192,128,128],[0,64,0],[128,64,0],[0,192,0],[128,192,0],[0,64,128],[128,64,128],[0,192,128],[128,192,128],[64,64,0],[192,64,0],[64,192,0],[192,192,0],[64,64,128],[192,64,128],[64,192,128],[192,192,128],[0,0,64],[128,0,64],[0,128,64],[128,128,64],[0,0,192],[128,0,192],[0,128,192],[128,128,192],[64,0,64],[192,0,64],[64,128,64],[192,128,64],[64,0,192],[192,0,192],[64,128,192],[192,128,192],[0,64,64],[128,64,64],[0,192,64],[128,192,64],[0,64,192],[128,64,192],[0,192,192],[128,192,192],[64,64,64],[192,64,64],[64,192,64],[192,192,64],[64,64,192],[192,64,192],[64,192,192],[192,192,192],[32,0,0],[160,0,0],[32,128,0],[160,128,0],[32,0,128],[160,0,128],[32,128,128],[160,128,128],[96,0,0],[224,0,0],[96,128,0],[224,128,0],[96,0,128],[224,0,128],[96,128,128],[224,128,128],[32,64,0],[160,64,0],[32,192,0],[160,192,0],[32,64,128],[160,64,128],[32,192,128],[160,192,128],[96,64,0],[224,64,0],[96,192,0],[224,192,0],[96,64,128],[224,64,128],[96,192,128],[224,192,128],[32,0,64],[160,0,64],[32,128,64],[160,128,64],[32,0,192],[160,0,192],[32,128,192],[160,128,192],[96,0,64],[224,0,64],[96,128,64],[224,128,64],[96,0,192],[224,0,192],[96,128,192],[224,128,192],[32,64,64],[160,64,64],[32,192,64],[160,192,64],[32,64,192],[160,64,192],[32,192,192],[160,192,192],[96,64,64],[224,64,64],[96,192,64],[224,192,64],[96,64,192],[224,64,192],[96,192,192],[224,192,192],[0,32,0],[128,32,0],[0,160,0],[128,160,0],[0,32,128],[128,32,128],[0,160,128],[128,160,128],[64,32,0],[192,32,0],[64,160,0],[192,160,0],[64,32,128],[192,32,128],[64,160,128],[192,160,128],[0,96,0],[128,96,0],[0,224,0],[128,224,0],[0,96,128],[128,96,128],[0,224,128],[128,224,128],[64,96,0],[192,96,0],[64,224,0],[192,224,0],[64,96,128],[192,96,128],[64,224,128],[192,224,128],[0,32,64],[128,32,64],[0,160,64],[128,160,64],[0,32,192],[128,32,192],[0,160,192],[128,160,192],[64,32,64],[192,32,64],[64,160,64],[192,160,64],[64,32,192],[192,32,192],[64,160,192],[192,160,192],[0,96,64],[128,96,64],[0,224,64],[128,224,64],[0,96,192],[128,96,192],[0,224,192],[128,224,192],[64,96,64],[192,96,64],[64,224,64],[192,224,64],[64,96,192],[192,96,192],[64,224,192],[192,224,192],[32,32,0],[160,32,0],[32,160,0],[160,160,0],[32,32,128],[160,32,128],[32,160,128],[160,160,128],[96,32,0],[224,32,0],[96,160,0],[224,160,0],[96,32,128],[224,32,128],[96,160,128],[224,160,128],[32,96,0],[160,96,0],[32,224,0],[160,224,0],[32,96,128],[160,96,128],[32,224,128],[160,224,128],[96,96,0],[224,96,0],[96,224,0],[224,224,0],[96,96,128],[224,96,128],[96,224,128],[224,224,128],[32,32,64],[160,32,64],[32,160,64],[160,160,64],[32,32,192],[160,32,192],[32,160,192],[160,160,192],[96,32,64],[224,32,64],[96,160,64],[224,160,64],[96,32,192],[224,32,192],[96,160,192],[224,160,192],[32,96,64],[160,96,64],[32,224,64],[160,224,64],[32,96,192],[160,96,192],[32,224,192],[160,224,192],[96,96,64],[224,96,64],[96,224,64],[224,224,64],[96,96,192],[224,96,192],[96,224,192],[224,224,192]]},b4={PASCAL:["background","aeroplane","bicycle","bird","boat","bottle","bus","car","cat","chair","cow","dining table","dog","horse","motorbike","person","potted plant","sheep","sofa","train","TV"],CITYSCAPES:["road","sidewalk","building","wall","fence","pole","traffic light","traffic sign","vegetation","terrain","sky","person","rider","car","truck","bus","train","motorcycle","bicycle"],ADE20K:["background","wall","building","sky","floor","tree","ceiling","road","bed","windowpane","grass","cabinet","sidewalk","person","earth","door","table","mountain","plant","curtain","chair","car","water","painting","sofa","shelf","house","sea","mirror","rug","field","armchair","seat","fence","desk","rock","wardrobe","lamp","bathtub","railing","cushion","base","box","column","signboard","chest","counter","sand","sink","skyscraper","fireplace","refrigerator","grandstand","path","stairs","runway","case","pool","pillow","screen","stairway","river","bridge","bookcase","blind","coffee","toilet","flower","book","hill","bench","countertop","stove","palm","kitchen","computer","swivel","boat","bar","arcade","hovel","bus","towel","light","truck","tower","chandelier","awning","streetlight","booth","television","airplane","dirt","apparel","pole","land","bannister","escalator","ottoman","bottle","buffet","poster","stage","van","ship","fountain","conveyer","canopy","washer","plaything","swimming","stool","barrel","basket","waterfall","tent","bag","minibike","cradle","oven","ball","food","step","tank","trade","microwave","pot","animal","bicycle","lake","dishwasher","screen","blanket","sculpture","hood","sconce","vase","traffic","tray","ashcan","fan","pier","screen","plate","monitor","bulletin","shower","radiator","glass","clock","flag"]};/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function zhe(t,e){return""+Fhe+"/"+(e===4?t+"/1/default/1/model.json":t+"/1/quantized/"+e+"/1/model.json")+"?tfjs-format=file"}function Vhe(t){if(t==="pascal")return y4.PASCAL;if(t==="ade20k")return y4.ADE20K;if(t==="cityscapes")return y4.CITYSCAPES;throw new Error("SemanticSegmentation cannot be constructed with an invalid base model "+t+". Try one of 'pascal', 'cityscapes' and 'ade20k'.")}function Whe(t){if(t==="pascal")return b4.PASCAL;if(t==="ade20k")return b4.ADE20K;if(t==="cityscapes")return b4.CITYSCAPES;throw new Error("SemanticSegmentation cannot be constructed with an invalid base model "+t+". Try one of 'pascal', 'cityscapes' and 'ade20k'.")}function jhe(t,e,n,r){return Yx(this,void 0,void 0,function(){var a,i,o,s,l,u,c,d,p,f,g,y,x,b;return Qx(this,function(v){switch(v.label){case 0:if(t.length<e.length)throw new Error("The colormap must be expansive enough to encode each label. Aborting, since the given colormap has length "+t.length+", but there are "+e.length+" labels.");return a=n.shape,i=a[0],o=a[1],s=pt([i,o,3],"int32"),[4,n.array()];case 1:for(l=v.sent(),u=new Set,c=0;c<i;++c)for(d=0;d<o;++d)b=l[c][d],u.add(b),s.set(t[b][0],c,d,0),s.set(t[b][1],c,d,1),s.set(t[b][2],c,d,2);return p=s.toTensor(),[4,t8(p,r)];case 2:for(f=v.sent(),Wr(p),g={},y=0,x=Array.from(u);y<x.length;y++)b=x[y],g[e[b]]=t[b];return[2,{legend:g,segmentationMap:f}]}})})}/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Uhe(t){return t===void 0&&(t={base:"pascal",quantizationBytes:2}),Yx(this,void 0,void 0,function(){var e;return Qx(this,function(n){switch(n.label){case 0:if(dpe==null)throw new Error("Cannot find TensorFlow.js. If you are using a <script> tag, please also include @tensorflow/tfjs on the page before using this model.");if(t.base){if(["pascal","cityscapes","ade20k"].indexOf(t.base)===-1)throw new Error("SemanticSegmentation cannot be constructed with an invalid base model "+t.base+". Try one of 'pascal', 'cityscapes' and 'ade20k'.");if([1,2,4].indexOf(t.quantizationBytes)===-1)throw new Error("Only quantization to 1, 2 or 4 bytes is supported.")}else if(!t.modelUrl)throw new Error("SemanticSegmentation can be constructed either by passing the weights URL or one of the supported base model names from 'pascal', 'cityscapes' and 'ade20k',together with the degree of quantization (either 1, 2 or 4).Aborting, since neither has been provided.");return[4,Dhe(t.modelUrl||zhe(t.base,t.quantizationBytes))];case 1:return e=n.sent(),[2,new Ghe(e,t.base)]}})})}var Ghe=function(){function t(e,n){this.model=e,this.base=n}return t.prototype.predict=function(e){var n=this;return Ot(function(){var r=wn(function(a){return Ot(function(){var i=a instanceof In?a:n8(a),o=i.shape,s=o[0],l=o[1],u=Bhe/Math.max(l,s),c=Math.round(s*u),d=Math.round(l*u);return $s(AI.resizeBilinear(i,[c,d]))})}(e),"int32");return Gm(n.model.execute(r))})},t.prototype.segment=function(e,n){return n===void 0&&(n={}),Yx(this,void 0,void 0,function(){var r,a,i,o,s,l,u,c,d,p,f=this;return Qx(this,function(g){switch(g.label){case 0:if(!(n.colormap&&n.labels||this.base))throw new Error("Calling the 'segment' method requires either the 'base' attribute to be defined (e.g. 'pascal', 'cityscapes' or'ade20k'), or 'colormap' and 'labels' options to be set. Aborting, since neither has been provided.");return n.colormap&&n.labels||(n.colormap=Vhe(this.base),n.labels=Whe(this.base)),r=n.colormap,a=n.labels,i=n.canvas,o=Ot(function(){return f.predict(e)}),s=o.shape,l=s[0],u=s[1],[4,jhe(r,a,o,i)];case 1:return c=g.sent(),d=c.legend,p=c.segmentationMap,Wr(o),[2,{legend:d,height:l,width:u,segmentationMap:p}]}})})},t.prototype.dispose=function(){return Yx(this,void 0,void 0,function(){return Qx(this,function(e){return this.model&&this.model.dispose(),[2]})})},t}();/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function ze(t,e){Array.isArray(t)||(t=[t]),t.forEach(n=>{n!=null&&V(n.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the CPU backend.`)})}/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Hhe=Rx;class U2 extends bb{constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new M3(this,Es())}nextDataId(){return U2.nextDataId++}write(e,n,r){this.firstUse&&(this.firstUse=!1,ue().get("IS_NODE")&&ai(`
============================
Hi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. 
============================`));const a={id:this.nextDataId()};return this.data.set(a,{values:e,dtype:r,refCount:1}),a}makeTensorInfo(e,n,r){let a;if(n==="string"&&r!=null&&r.length>0&&Oo(r[0])){const i=r.map(o=>$o(o));a=this.write(i,e,n)}else a=this.write(r,e,n);return{dataId:a,shape:e,dtype:n}}refCount(e){return this.data.has(e)?this.data.get(e).refCount:0}incRef(e){const n=this.data.get(e);n.refCount++}decRef(e){if(this.data.has(e)){const n=this.data.get(e);n.refCount--}}move(e,n,r,a,i){this.data.set(e,{values:n,dtype:a,refCount:i})}numDataIds(){return this.data.numDataIds()}async read(e){return this.readSync(e)}readSync(e){const{dtype:n,complexTensorInfos:r}=this.data.get(e);if(n==="complex64"){const a=this.readSync(r.real.dataId),i=this.readSync(r.imag.dataId);return Ms(a,i)}return this.data.get(e).values}bufferSync(e){const n=this.readSync(e.dataId);if(e.dtype==="string")try{const r=n.map(a=>Cs(a));return pt(e.shape,e.dtype,r)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return pt(e.shape,e.dtype,n)}makeOutput(e,n,r){return Es().makeTensorFromTensorInfo(this.makeTensorInfo(n,r,e),this)}disposeData(e,n=!1){if(this.data.has(e)){if(this.data.get(e).refCount--,!n&&this.data.get(e).refCount>0)return!1;const{complexTensorInfos:r}=this.data.get(e);r!=null&&(this.disposeData(r.real.dataId,!0),this.disposeData(r.imag.dataId,!0)),this.data.delete(e)}return!0}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}async time(e){const n=Fa();return e(),{kernelMs:Fa()-n}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(e){ze([e],"where");const n=this.readSync(e.dataId);return Hhe(e.shape,n)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}U2.nextDataId=0;/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function vF(t){const e=new Float32Array(t.length);for(let n=0;n<t.length;++n)e[n]=Math.abs(t[n]);return e}const qhe=t=>{const{x:e}=t.inputs,n=t.backend;ze(e,"abs");let r=new Float32Array(me(e.shape));const a=n.data.get(e.dataId).values;return r=vF(a),n.makeOutput(r,e.shape,e.dtype)},Khe={kernelName:Cb,backendName:"cpu",kernelFunc:qhe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Xn(t){return(e,n,r,a,i)=>{const o=Nt(e,n),s=o.length,l=qe(o),u=me(o),c=tr(i,u),d=e.length,p=n.length,f=qe(e),g=qe(n),y=tc(e,o),x=tc(n,o);if(y.length+x.length===0)for(let b=0;b<c.length;++b)c[b]=t(r[b%r.length],a[b%a.length]);else for(let b=0;b<c.length;++b){const v=Hu(b,s,l),w=v.slice(-d);y.forEach(_=>w[_]=0);const S=io(w,d,f),C=v.slice(-p);x.forEach(_=>C[_]=0);const I=io(C,p,g);c[b]=t(r[S],a[I])}return[c,o]}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function ja(t){const{inputs:e,backend:n}=t,{real:r,imag:a}=e,i=n.data.get(r.dataId).values,o=n.data.get(a.dataId).values,s=n.makeTensorInfo(r.shape,"complex64"),l=n.data.get(s.dataId);return l.complexTensorInfos={real:n.makeTensorInfo(r.shape,"float32",i),imag:n.makeTensorInfo(a.shape,"float32",o)},s}const Xhe={kernelName:Db,backendName:"cpu",kernelFunc:ja};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Zx(t,e,n="float32"){if(n==="complex64"){const a=Zx(t,e,"float32"),i=Zx(t,e,"float32");return ja({inputs:{real:a,imag:i},backend:t})}const r=Cr(me(e),n);return t.makeTensorInfo(e,n,r)}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function zo(t){const{inputs:e,backend:n}=t,{x:r}=e;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const Yhe={kernelName:zf,backendName:"cpu",kernelFunc:zo};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function uc(t){const{inputs:e,backend:n}=t,{input:r}=e,a=n.data.get(r.dataId).complexTensorInfos.real,i=n.data.get(a.dataId).values;return n.makeTensorInfo(a.shape,a.dtype,i)}const Qhe={kernelName:Av,backendName:"cpu",kernelFunc:uc};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function xF(t,e,n,r){if(r==="int32"){const a=Int32Array.from(t);return[e,"int32",a]}if(r==="bool"){const a=Rl([0],n),[i,o]=Xn((s,l)=>s!==l?1:0)(e,[],t,a,"bool");return[o,"bool",i]}throw new Error(`Error in Cast: failed to cast ${n} to ${r}`)}function Ul(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{dtype:i}=r;if(i==="complex64"){if(a.dtype==="complex64")return zo({inputs:{x:a},backend:n});const c=Zx(n,a.shape,a.dtype),d=Ul({inputs:{x:a},backend:n,attrs:{dtype:"float32"}}),p=ja({inputs:{real:d,imag:c},backend:n});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(d),p}if(a.dtype==="complex64"){const c=uc({inputs:{input:a},backend:n}),d=Ul({inputs:{x:c},backend:n,attrs:{dtype:i}});return n.disposeIntermediateTensorInfo(c),d}if(!D3(a.dtype,i)){const c=zo({inputs:{x:a},backend:n});return{dataId:c.dataId,shape:c.shape,dtype:i}}const o=n.data.get(a.dataId).values,[s,l,u]=xF(o,a.shape,a.dtype,i);return n.makeTensorInfo(s,l,u)}const Zhe={kernelName:Nf,backendName:"cpu",kernelFunc:Ul};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function fr(t,e,n,r){return n==null?({inputs:a,backend:i})=>{const{a:o,b:s}=a,l=i;ze([o,s],t);const u=l.data.get(o.dataId).values,c=l.data.get(s.dataId).values,d=o.dtype==="string"?lc(u):u,p=o.dtype==="string"?lc(c):c,f=r||o.dtype,[g,y]=e(o.shape,s.shape,d,p,f);return l.makeTensorInfo(y,f,g)}:({inputs:a,backend:i})=>{const{a:o,b:s}=a,l=i;if(o.dtype==="complex64"||s.dtype==="complex64"){const u=Ul({inputs:{x:o},backend:l,attrs:{dtype:"complex64"}}),c=l.data.get(u.dataId),d=c.complexTensorInfos.real,p=c.complexTensorInfos.imag,f=l.data.get(d.dataId).values,g=l.data.get(p.dataId).values,y=Ul({inputs:{x:s},backend:l,attrs:{dtype:"complex64"}}),x=l.data.get(y.dataId),b=x.complexTensorInfos.real,v=x.complexTensorInfos.imag,w=l.data.get(b.dataId).values,S=l.data.get(v.dataId).values,[C,I,_]=n(o.shape,s.shape,f,g,w,S),E=l.makeTensorInfo(_,"float32",C),A=l.makeTensorInfo(_,"float32",I),M=ja({inputs:{real:E,imag:A},backend:l});return l.disposeIntermediateTensorInfo(u),l.disposeIntermediateTensorInfo(y),l.disposeIntermediateTensorInfo(E),l.disposeIntermediateTensorInfo(A),M}else{const u=l.data.get(o.dataId).values,c=l.data.get(s.dataId).values,d=r||o.dtype,[p,f]=e(o.shape,s.shape,u,c,d);return l.makeTensorInfo(f,d,p)}}}function v4(t){return(e,n,r,a,i,o)=>{const s=Nt(e,n),l=me(s),u=s.length,c=qe(s),d=tr("float32",l),p=tr("float32",l),f=tc(e,s),g=tc(n,s),y=Ms(r,a),x=Ms(i,o),b=e.length,v=qe(e),w=n.length,S=qe(n);if(f.length+g.length===0)for(let C=0;C<d.length;C++){const I=C%y.length,_=C%x.length,E=t(y[I*2],y[I*2+1],x[_*2],x[_*2+1]);d[C]=E.real,p[C]=E.imag}else for(let C=0;C<d.length;C++){const I=Hu(C,u,c),_=I.slice(-b);f.forEach(W=>_[W]=0);const E=io(_,b,v),A=I.slice(-w);g.forEach(W=>A[W]=0);const M=io(A,w,S),L=t(y[E*2],y[E*2+1],x[M*2],x[M*2+1]);d[C]=L.real,p[C]=L.imag}return[d,p,s]}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const wF=Xn((t,e)=>t+e),Jhe=v4((t,e,n,r)=>({real:t+n,imag:e+r})),ip=fr(Fd,wF,Jhe),efe={kernelName:Fd,backendName:"cpu",kernelFunc:ip};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function x4(t,e,n,r,a){const i=me(r),o=Cr(a,n);for(let s=0;s<t.length;s++){const l=t[s];if(l<0)throw new Error("Input x must be non-negative!");l>=a||(i>0?o[l]+=e[s]:o[l]+=1)}return o}function kF(t,e,n,r=!1){const a=t.shape[0],i=t.shape[1],o=pt([a,n],e.dtype);for(let s=0;s<a;s++)for(let l=0;l<i;l++){const u=t.get(s,l);if(u<0)throw new Error("Input x must be non-negative!");u>=n||(r?o.set(1,s,u):e.size>0?o.set(o.get(s,u)+e.get(s,l),s,u):o.set(o.get(s,u)+1,s,u))}return o}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Gl(t){return(e,n,r)=>{const a=tr(n,e.length);for(let i=0;i<e.length;++i)a[i]=t(e[i],r);return a}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Kt(t,e,n){return({inputs:r,attrs:a,backend:i})=>{const{x:o}=r;if(ze(o,t),o.dtype==="string"||n==="string")throw new Error("unaryKernelFunc does not support string input/output");const s=i,l=s.data.get(o.dataId).values,u=me(o.shape),c=n||o.dtype,d=nr(c,u);for(let p=0;p<u;++p)d[p]=e(l[p],a);return s.makeTensorInfo(o.shape,c,d)}}function op(t,e,n){return({inputs:r,attrs:a,backend:i})=>{const{x:o}=r;if(ze(o,t),o.dtype==="string"||n==="string")throw new Error("unaryKernelFunc does not support string input/output");const s=i,l=s.data.get(o.dataId).values,u=n||o.dtype,c=e(l,u,a);return s.makeTensorInfo(o.shape,u,c)}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const SF=Gl(t=>Math.ceil(t)),tfe=op(Tf,SF),nfe={kernelName:Tf,backendName:"cpu",kernelFunc:tfe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function CF(t,e,n,r){const a=nr(n,me(e));if(r&&n!=="string"){let i=0;t.forEach(o=>{const s=me(o.shape);a.set(o.vals,i),i+=s})}else{let i=0;t.forEach(o=>{const s=n==="string"?lc(o.vals):o.vals;let l=0;for(let u=0;u<o.shape[0];++u){const c=u*e[1]+i;for(let d=0;d<o.shape[1];++d)a[c+d]=s[l++]}i+=o.shape[1]})}return a}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const NF=Xn((t,e)=>t===e?1:0),TF=fr(Mf,NF,null,"bool"),rfe={kernelName:Mf,backendName:"cpu",kernelFunc:TF};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const IF=Gl(t=>Math.exp(t)),EF=op(Af,IF,"float32"),afe={kernelName:Af,backendName:"cpu",kernelFunc:EF};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const _F=Gl(t=>Math.expm1(t)),ife=op(Pf,_F),ofe={kernelName:Pf,backendName:"cpu",kernelFunc:ife};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const OF=Gl(t=>Math.floor(t)),sfe=op(Df,OF),lfe={kernelName:Df,backendName:"cpu",kernelFunc:sfe};/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function $F(t,e,n,r,a,i,o,s,l){const u=pt([r,i],n);for(let c=0;c<r;c++){const d=[];let p=0;for(let f=0;f<a;f++){const g=t[c*a+f];p+=g*o[f],d.push(g)}if(p<0||p>=l/i)throw new Error(`Invalid indices: ${d} does not index into ${s}`);for(let f=0;f<i;f++)u.values[c*i+f]=e.get(...e.indexToLoc(p*i+f))}return u}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function RF(t,e,n){const r=pt(n,t.dtype);for(let a=0;a<r.size;++a){const i=r.indexToLoc(a).slice(),o=i[0],s=i[2],l=e.locToIndex([o,s]);i[2]=e.values[l];const u=t.locToIndex(i);0<=u&&u<t.values.length&&(r.values[a]=t.values[u])}return r}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const MF=Xn((t,e)=>t>e?1:0),ufe=fr(Ff,MF,null,"bool"),cfe={kernelName:Ff,backendName:"cpu",kernelFunc:ufe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const AF=Xn((t,e)=>t>=e?1:0),dfe=fr(Bf,AF,null,"bool"),pfe={kernelName:Bf,backendName:"cpu",kernelFunc:dfe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const PF=Xn((t,e)=>t<e?1:0),hfe=fr(Uf,PF,null,"bool"),ffe={kernelName:Uf,backendName:"cpu",kernelFunc:hfe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const DF=Xn((t,e)=>t<=e?1:0),mfe=fr(Gf,DF,null,"bool"),gfe={kernelName:Gf,backendName:"cpu",kernelFunc:mfe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function LF(t,e,n){const r=(e-t)/(n-1),a=Cr(n,"float32");a[0]=t;for(let i=1;i<a.length;i++)a[i]=a[i-1]+r;return a}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const FF=Gl(t=>Math.log(t)),yfe=op(Hf,FF),bfe={kernelName:Hf,backendName:"cpu",kernelFunc:yfe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function BF(t,e,n,r){const a=tr(r,me(n));for(let i=0;i<a.length;++i){const o=i*e;let s=t[o];for(let l=0;l<e;++l){const u=t[o+l];(Number.isNaN(u)||u>s)&&(s=u)}a[i]=s}return a}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const zF=Xn((t,e)=>Math.max(t,e)),vfe=fr(Qf,zF),xfe={kernelName:Qf,backendName:"cpu",kernelFunc:vfe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const VF=Xn((t,e)=>Math.min(t,e)),wfe=fr(Zf,VF),kfe={kernelName:Zf,backendName:"cpu",kernelFunc:wfe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const w4=Xn((t,e)=>t*e),Sfe=v4((t,e,n,r)=>({real:t*n-e*r,imag:t*r+e*n})),Jx=fr(em,w4,Sfe),Cfe={kernelName:em,backendName:"cpu",kernelFunc:Jx};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function WF(t,e,n){const r=Ss(-1,n);return w4([],e,r,t,n)}function Nfe(t){const{inputs:e,backend:n}=t,{x:r}=e;ze(r,"neg");const a=n.data.get(r.dataId).values,[i,o]=WF(a,r.shape,r.dtype);return n.makeTensorInfo(o,r.dtype,i)}const Tfe={kernelName:wv,backendName:"cpu",kernelFunc:Nfe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const jF=Xn((t,e)=>t!==e?1:0),Ife=fr(tm,jF,null,"bool"),Efe={kernelName:tm,backendName:"cpu",kernelFunc:Ife};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function k4(t,e,n,r,a){const i=e.length,o=me(e),s=qe(e),l=qe(a),u=tr(n,me(a));for(let c=0;c<o;++c){const d=Hu(c,i,s),p=new Array(d.length);for(let g=0;g<p.length;g++)p[g]=d[r[g]];const f=io(p,i,l);u[f]=t[c]}return u}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Sa(t){const{inputs:e,attrs:n,backend:r}=t,{x:a}=e,{perm:i}=n;ze(a,"transpose");const o=a.shape.length,s=new Array(o);for(let c=0;c<s.length;c++)s[c]=a.shape[i[c]];const l=r.data.get(a.dataId).values,u=k4(l,a.shape,a.dtype,i,s);return{dataId:r.write(u,s,a.dtype),shape:s,dtype:a.dtype}}const _fe={kernelName:Bd,backendName:"cpu",kernelFunc:Sa};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function UF(t,e,n,r){const[a,i]=Nr(t,r),o=ka(e,"int32"),s=Cr(me(a),o),l=me(i);for(let u=0;u<s.length;++u){const c=u*l;let d=1;for(let p=0;p<l;++p)d*=n[c+p];s[u]=d}return{outVals:s,outShape:a,outDtype:o}}function Ofe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:i,keepDims:o}=r;ze(a,"prod");const s=a.shape.length,l=Pt(i,a.shape),u=jn(l,s);let c=l,d=a;const p=[];u!=null&&(d=Sa({inputs:{x:a},backend:n,attrs:{perm:u}}),p.push(d),c=Un(c.length,s));const f=n.data.get(d.dataId).values,{outVals:g,outShape:y,outDtype:x}=UF(d.shape,d.dtype,f,c);let b=y;return o&&(b=ar(y,l)),p.forEach(v=>n.disposeIntermediateTensorInfo(v)),n.makeTensorInfo(b,x,g)}const $fe={kernelName:Ov,backendName:"cpu",kernelFunc:Ofe};/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Rfe(t,e,n){t.forEach((r,a)=>{if(r<0||r>=n){const i=Hu(a,e.length,qe(e)).join(",");throw new Error(`indices[${i}] = ${r} is not in [0, ${n})`)}})}function Mfe(t,e){for(let n=0;n<t.length;++n){const r=t[n],a=n===t.length-1?e:t[n+1].length;if(r.length===0)throw new Error("Ragged splits may not be empty");if(r[0]<0)throw new Error("Ragged splits must be non-negative");if(r[r.length-1]>a)throw new Error("Ragged splits must not point past values");for(let i=1;i<r.length;++i)if(r[i-1]>r[i])throw new Error("Ragged splits must be sorted in ascending order")}}function Afe(t,e,n,r){const a=[];let i=0;const o=e.length-1+n.length,s=new Array(o).fill(null).map(()=>[0]);Mfe(n,r);let l=1;for(let u=0;u<e.length-1;++u){l*=e[u];const c=e[u+1];for(let d=1;d<l+1;++d)s[u].push(d*c)}for(let u=0;u<t.length;++u){let c=t[u],d=t[u]+1;for(let p=0;p<n.length;++p){const f=n[p],g=p+e.length-1;if(g>=0){const y=s[g],x=y[y.length-1]-f[c];for(let b=c;b<d;++b)s[g].push(f[b+1]+x)}c=f[c],d=f[d]}d!==c&&(a.push([c,d]),i+=d-c)}return{outSplits:s,valueSlices:a,numValues:i}}function Pfe(t){const e=[];for(let n=0;n<t.length;++n){const r=t[n].length,a=nr("int32",r);e.push(a),t[n].forEach((i,o)=>a[o]=i)}return e}function GF(t,e){const n=t.slice(0,e);for(;n.length<e;)n.push(1);for(let r=e;r<t.length;r++)n[e-1]*=t[r];return n}function Dfe(t,e,n,r,a,i){const o=GF(e,2)[1],s=GF(i,2)[1];let l=0;for(const u of n)for(let c=u[0];c<u[1];++c){for(let d=0;d<r;++d)a[l*s+d]=t[c*o+d];++l}}function Lfe(t,e,n,r,a){const i=e.slice();i[0]=a;const o=nr(n,me(i)),s=t.length,l=s===0?0:s/e[0];return Dfe(t,e,r,l,o,i),[o,i]}function HF(t,e,n,r,a,i,o,s){if(t.length===0)throw new Error("paramsNestedSplits must be non empty");if(e[0].length===0)throw new Error("Split tensors must not be scalars");const l=e[0][0]-1;if(Rfe(i,o,l),r.length===0)throw new Error("params.rank must be nonzero");const u=r[0],{outSplits:c,valueSlices:d,numValues:p}=Afe(i,o,t,u),f=Pfe(c),g=Lfe(n,r,a,d,p);return[f,g[0],g[1]]}/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/var Mi=uo;class G2{constructor(e,n,r,a,i,o,s,l,u,c){this.shape=e,this.shapeShape=n,this.values=r,this.valuesShape=a,this.valuesDType=i,this.defaultValue=o,this.defaultValueShape=s,this.rowPartitionValues=l,this.rowPartitionValuesShapes=u,this.rowPartitionTypes=PL(c),this.raggedRank=DL(this.rowPartitionTypes)}getRowPartitionTypeByDimension(e){return this.rowPartitionTypes[0]===Mi.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}getRowPartitionTensor(e){return this.rowPartitionTypes[0]===Mi.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}getMaxWidth(e){const n=this.getRowPartitionTensor(e-1);switch(this.getRowPartitionTypeByDimension(e-1)){case Mi.VALUE_ROWIDS:return G2.getMaxWidthValueRowID(n);case Mi.ROW_SPLITS:return G2.getMaxWidthRowSplit(n);default:throw new Error(`Cannot handle partition type ${Mi[this.getRowPartitionTypeByDimension(e-1)]}`)}}static getMaxWidthRowSplit(e){const n=e.length;if(n===0||n===1)return 0;let r=0;for(let a=0;a<n-1;++a){const i=e[a+1]-e[a];i>r&&(r=i)}return r}static getMaxWidthValueRowID(e){const n=e.length;if(n===0)return 0;let r=0,a=e[0],i=0;for(let o=1;o<n;++o){const s=e[o];s!==a&&(a=s,i=Math.max(o-r,i),r=o)}return Math.max(n-r,i)}tensorShapeFromTensor(e,n,r=!0){if(n.length===0){if(e[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return KF(e,r)}calculateOutputSize(e){const n=this.valuesShape,r=this.defaultValueShape;LL(r,n);const a=this.tensorShapeFromTensor(this.shape,this.shapeShape),i=AL(this.raggedRank,a,n);i[0]<0&&(i[0]=e);for(let o=1;o<=this.raggedRank;++o)i[o]<0&&(i[o]=this.getMaxWidth(o));return i}calculateFirstParentOutputIndex(e,n,r){const a=Math.min(e,r),i=[];let o=0;for(let s=0;s<a;++s,o+=n)i.push(o);for(let s=a;s<e;++s)i.push(-1);return V(i.length===e,()=>"Final length of result must be equal to firstDimension."),i}calculateOutputIndexRowSplit(e,n,r,a){const i=e.length,o=[];for(let s=0;s<i-1;++s){const l=e[s+1]-e[s];let u=Math.min(a,l),c=n[s];c===-1&&(u=0);for(let d=0;d<u;++d)o.push(c),c+=r;for(let d=0;d<l-u;++d)o.push(-1)}if(i>0&&o.length!==e[i-1])throw new Error("Invalid row split size.");return o}calculateOutputIndexValueRowID(e,n,r,a){const i=e.length,o=[];if(i===0)return[];let s=0,l=e[0];if(l>=n.length)throw new Error(`Got currentValueRowId=${l}, which is not less than ${n.length}`);let u=n[l];o.push(u);for(let c=1;c<i;++c){const d=e[c];if(d===l)u>=0&&(++s,s<a?u+=r:u=-1);else{if(s=0,l=d,d>=n.length)throw new Error(`Got nextValueRowId=${d} which is not less than ${n.length}`);u=n[d]}o.push(u)}if(o.length!==e.length)throw new Error("Invalid row ids.");return o}calculateOutputIndex(e,n,r,a){const i=this.getRowPartitionTensor(e),o=this.getRowPartitionTypeByDimension(e);switch(o){case Mi.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(i,n,r,a);case Mi.ROW_SPLITS:if(i.length-1>n.length)throw new Error(`Row partition size is greater than output size: ${i.length-1} > ${n.length}`);return this.calculateOutputIndexRowSplit(i,n,r,a);default:throw new Error(`Unsupported partition type: ${Mi[o]}`)}}getFirstDimensionSize(){const e=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");const n=this.rowPartitionTypes[0];switch(n){case Mi.FIRST_DIM_SIZE:return e[0];case Mi.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case Mi.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${Mi[n]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const e=this.getFirstDimensionSize(),n=this.calculateOutputSize(e),r=new Array(this.raggedRank+1);r[r.length-1]=1;for(let o=r.length-2;o>=0;--o)r[o]=r[o+1]*n[o+1];const a=KF(n,!1),i=nr(this.valuesDType,me(a));if(r[0]*n[0]>0){let o=this.calculateFirstParentOutputIndex(e,r[0],n[0]);for(let s=1;s<=this.raggedRank;++s)o=this.calculateOutputIndex(s-1,o,r[s],n[s]);this.setOutput(this.raggedRank,o,i,a)}return[a,i]}setOutput(e,n,r,a){if(r.length===0)return;const i=this.values,o=r;let s=a.slice();s=s.slice(e+1);const l=me(s),u=n.length;let c=this.defaultValue;if(c.length!==l&&c.length!==1){const g=this.defaultValueShape;Ot(()=>{const y=ve(c,g);c=Xd(y,s).dataSync()})}let d=0,p=0,f=0;for(let g=0;g<=u;++g){let y=g<u?n[g]:-1;if(y===f){++f;continue}if(p<f){const x=i.subarray(d*l),b=o.subarray(p*l),v=(f-p)*l;qF(b,x,v)}if(g>=u){const x=r.length;y=Math.floor(x/l)}if(y>f)if(this.defaultValue.length===1)o.subarray(f*l,y*l).fill(this.defaultValue[0]),f=y;else for(;y>f;){const x=o.slice(f*l);qF(x,c,l),++f}y<0?(d=g+1,p=f):(d=g,p=f,f=p+1)}}}function qF(t,e,n){for(let r=0;r<n;r++)t[r]=e[r]}function KF(t,e){const n=[];for(let r of t){if(r<0){if(!e)throw new Error(`Dimension ${r} must be >= 0`);if(r<-1)throw new Error(`Dimension ${r} must be >= -1`);r=-1}n.push(r)}return n}function XF(t,e,n,r,a,i,o,s,l,u){return new G2(t,e,n,r,a,i,o,s,l,u).compute()}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function YF(t,e,n,r){const a=t===e,i=t<e&&n<0,o=e<t&&n>1;if(a||i||o)return Cr(0,r);const s=Math.abs(Math.ceil((e-t)/n)),l=Cr(s,r);e<t&&n===1&&(n=-1),l[0]=t;for(let u=1;u<l.length;u++)l[u]=l[u-1]+n;return l}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const QF=Gl(t=>1/Math.sqrt(t)),Ffe=op(sm,QF),Bfe={kernelName:sm,backendName:"cpu",kernelFunc:Ffe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function sp(t,e,n,r,a,i,o,s,l,u){const c=[r/a,a],d=t.values,p=e.values;if(r===0)return pt(n,e.dtype);const f=pt(c,e.dtype);typeof l=="string"||typeof l=="number"?f.values.fill(l):typeof l=="boolean"&&f.values.fill(+l);for(let g=0;g<i;g++){const y=[];let x=0;for(let b=0;b<o;b++){const v=d[g*o+b];y.push(v),x+=v*s[b]}if(x<0||x>=r/a)throw new Error(`Invalid indices: ${y} does not index into ${n}`);for(let b=0;b<a;b++)u?f.values[x*a+b]+=p[g*a+b]:f.values[x*a+b]=e.rank===0?p[0]:p[g*a+b]}return f}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const zfe=Gl(t=>1/(1+Math.exp(-t))),ZF=Kt(pm,t=>1/(1+Math.exp(-t))),Vfe={kernelName:pm,backendName:"cpu",kernelFunc:ZF};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function JF(t,e,n,r,a){const i=BT(r,e,n),o=me(n),s=qe(r);if(i){const d=zT(e,s);return a==="string"?t.slice(d,d+o):t.subarray(d,d+o)}const l=a==="string"?lc(t):t,u=pt(r,a,l),c=pt(n,a);for(let d=0;d<c.size;++d){const p=c.indexToLoc(d),f=p.map((g,y)=>g+e[y]);c.set(u.get(...f),...p)}return a==="string"?iF(c.values):c.values}function cc(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{begin:i,size:o}=r;ze(a,"slice");const[s,l]=VT(a,i,o);LT(a,s,l);const u=n.data.get(a.dataId).values,c=JF(u,s,l,a.shape,a.dtype);return n.makeTensorInfo(l,a.dtype,c)}const Wfe={kernelName:Wv,backendName:"cpu",kernelFunc:cc};/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function e9(t,e,n,r,a,i,o){const s=e[0],l=i[0],u=new Array(l),c=new Array(s),d=e[1];if(l===0){if(s!==0)throw new Error(HL(s));const x=nr(n,0),b=nr(a,0);return[x,[0,d],b,u,c]}let p=!0,f=0;const g=new Array(l).fill(0);for(let x=0;x<s;++x){const b=t[x*d];if(b<0)throw new Error(qL(x,b));if(b>=l)throw new Error(KL(x,b,l));++g[b],p=p&&b>=f,f=b}let y=!0;for(let x=0;x<l;++x){const b=g[x]===0;u[x]=b,y=y&&!b,g[x]=Math.max(g[x],1),x>0&&(g[x]+=g[x-1])}if(y&&p){const x=t,b=r;for(let v=0;v<s;++v)c[v]=v;return[x,[s,d],b,u,c]}else{const x=g[l-1],b=nr(n,x*d),v=nr(a,x),w=new Array(l).fill(0);for(let S=0;S<s;++S){const C=t[S*d],I=w[C],_=(C===0?0:g[C-1])+I;w[C]++;for(let E=0;E<d;++E)b[_*d+E]=t[S*d+E];v[_]=r[S],c[S]=_}for(let S=0;S<l;++S)if(w[S]===0){const C=S===0?0:g[S-1];b[C*d+0]=S;for(let I=1;I<d;++I)b[C*d+I]=0;v[C]=o}return[b,[x,d],v,u,c]}}/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function t9(t,e,n,r,a){const i=me(r),o=e[0],s=a.length,l=[];let u=1,c=-1;for(let y=0;y<s;++y){const x=a[y];if(x===-1){if(c!==-1)throw new Error(XL(c,y));c=y,l.push(1)}else{if(x<0)throw new Error(YL(y,x));u*=x,l.push(x)}}if(c!==-1){if(u<=0)throw new Error(QL());const y=Math.trunc(i/u);if(u*y!==i)throw new Error(ZL(r,l));l[c]=y}if(me(l)!==i)throw new Error(JL(r,l));const d=r.length,p=[];if(d>0){p[d-1]=1;for(let y=d-2;y>=0;--y)p[y]=p[y+1]*r[y+1]}const f=[];if(s>0){f[s-1]=1;for(let y=s-2;y>=0;--y)f[y]=f[y+1]*l[y+1]}const g=nr(n,o*s);for(let y=0;y<o;++y){let x=0;for(let b=0;b<d;++b)x+=t[y*d+b]*p[b];for(let b=0;b<s;++b)g[y*s+b]=Math.trunc(x/f[b]),x%=f[b]}return[g,[o,s],l]}/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function S4(t,e,n,r,a,i=!1,o=0){const s=r.length,l=[e[0],t.length/e[0]],u=l[1],c=s>0?a[s-1]+1:0;if(c<0)throw new Error(n4());const d=e.slice();d[0]=c;const p=d.reduce((v,w)=>v*w,1),f=nr(n,p);if(s===0)return c>0&&f.fill(o),[f,d];if(c<=0)throw new Error(n4());let g=0,y=1,x=0,b=a[g];for(;;){let v=0;if(y<s){if(v=a[y],b===v){++y;continue}if(b>=v)throw new Error(eF())}if(b<0||b>=c)throw new Error(tF(b,c));b>x&&f.fill(o,x*u,b*u);for(let w=g;w<y;++w){const S=r[w];if(S<0||S>=l[0])throw new Error(nF(w,r[w],l[0]));for(let C=0;C<u;C++)f[b*u+C]+=t[S*u+C]}if(i)for(let w=0;w<u;w++)f[b*u+w]/=y-g;if(g=y,++y,x=b+1,b=v,y>s)break}return x<c&&f.fill(o,x*u,c*u),[f,d]}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const jfe=Gl(t=>Math.sqrt(t)),Ufe=Kt(fm,t=>Math.sqrt(t)),Gfe={kernelName:fm,backendName:"cpu",kernelFunc:Ufe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const n9=Xn((t,e)=>{const n=t-e;return n*n}),Hfe=fr(mm,n9),qfe={kernelName:mm,backendName:"cpu",kernelFunc:Hfe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function r9(t,e,n,r){const a=pt(t,e.dtype);for(let i=0;i<a.size;i++){const o=a.indexToLoc(i),s=new Array(o.length);for(let l=0;l<s.length;l++)s[l]=o[l]*n[l]+r[l];a.set(e.get(...s),...o)}return a}/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class Kfe{constructor(e,n,r,a,i,o){this.separator=$o(e),this.nGramWidths=n,this.leftPad=$o(r),this.rightPad=$o(a),this.padWidth=i,this.preserveShort=o}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,n){const r=this.getPadWidth(n);return Math.max(0,e+2*r-n+1)}createNGrams(e,n,r,a,i,o){for(let s=0;s<i;++s){const l=this.getPadWidth(o),u=Math.max(0,l-s),c=Math.max(0,l-(i-(s+1))),d=o-(u+c),p=n+(u>0?0:s-l);let f=0;f+=u*this.leftPad.length;for(let v=0;v<d;++v)f+=e[p+v].length;f+=c*this.rightPad.length;const g=u+c+d-1;f+=g*this.separator.length,r[a+s]=new Uint8Array(f);const y=r[a+s];let x=0;const b=v=>v.forEach(w=>y[x++]=w);for(let v=0;v<u;++v)b(this.leftPad),b(this.separator);for(let v=0;v<d-1;++v)b(e[p+v]),b(this.separator);if(d>0){b(e[p+d-1]);for(let v=0;v<c;++v)b(this.separator),b(this.rightPad)}else{for(let v=0;v<c-1;++v)b(this.rightPad),b(this.separator);b(this.rightPad)}}}compute(e,n){const r=e.length,a=n.length;if(a>0){let l=n[0];if(l!==0)throw new Error(`First split value must be 0, got ${l}`);for(let u=1;u<a;++u){let c=n[u]>=l;if(c=c&&n[u]<=r,!c)throw new Error(`Invalid split value ${n[u]}, must be in [${l}, ${r}]`);l=n[u]}if(l!==r)throw new Error(`Last split value must be data size. Expected ${r}, got ${l}`)}const i=a-1,o=nr("int32",a);if(r===0||a===0){const l=new Array(r);for(let u=0;u<=i;++u)o[u]=0;return[l,o]}o[0]=0;for(let l=1;l<=i;++l){const u=n[l]-n[l-1];let c=0;this.nGramWidths.forEach(d=>{c+=this.getNumNGrams(u,d)}),this.preserveShort&&u>0&&c===0&&(c=1),o[l]=o[l-1]+c}const s=new Array(o[i]);for(let l=0;l<i;++l){const u=n[l];let c=o[l];if(this.nGramWidths.forEach(d=>{const p=n[l+1]-n[l],f=this.getNumNGrams(p,d);this.createNGrams(e,u,s,c,f,d),c+=f}),this.preserveShort&&c===o[l]){const d=n[l+1]-n[l];if(d===0)continue;const p=d+2*this.padWidth;this.createNGrams(e,u,s,c,1,p)}}return[s,o]}}function a9(t,e,n,r,a,i,o,s){return new Kfe(n,r,a,i,o,s).compute(t,e)}/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Xfe(t,e,n,r){if(!t.length)return;if(e.length===0){for(let i=0;i<t.length;++i)r.push(t.subarray(i,i+1));return}if(e.length===1){const i=e[0];let o=t.indexOf(i);for(;o!==-1;){const s=t.subarray(0,o);(!n||s.length!==0)&&r.push(s),t=t.subarray(o+1),o=t.indexOf(i)}(!n||t.length!==0)&&r.push(t);return}let a=0;for(let i=0;i<t.length+1;i++)if(i===t.length||e.indexOf(t[i])!==-1){const o=t.subarray(a,i);(!n||o.length!==0)&&r.push(o),a=i+1}}function i9(t,e,n){const r=t.length,a=[];let i=0,o=0;const s=new Array(r);for(let p=0;p<r;++p){const f=a.length;Xfe(t[p],e,n,a);const g=a.length-f;s[p]=g,i+=g,o=Math.max(o,g)}const l=nr("int32",i*2),u=new Array(i),c=[r,o];let d=0;for(let p=0;p<r;++p)for(let f=0;f<s[p];++f)l[d*2]=p,l[d*2+1]=f,u[d]=a[d],++d;return[l,u,c]}/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function o9(t,e){const n=nr("int32",t.length);for(let r=0;r<t.length;++r)n[r]=NP(t[r]).modulo(e).getLowBitsUnsigned();return n}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const s9=Xn((t,e)=>t-e),Yfe=v4((t,e,n,r)=>({real:t-n,imag:e-r})),C4=fr(gm,s9,Yfe),Qfe={kernelName:gm,backendName:"cpu",kernelFunc:C4};/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function l9(t,e){const n=new Array(t.rank);for(let a=0;a<n.length;a++)n[a]=t.shape[a]*e[a];const r=pt(n,t.dtype);for(let a=0;a<r.values.length;++a){const i=r.indexToLoc(a),o=new Array(t.rank);for(let l=0;l<o.length;l++)o[l]=i[l]%t.shape[l];const s=t.locToIndex(o);r.values[a]=t.values[s]}return r}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Qm=(t,e)=>{const n=e.value-t.value;return n===0?t.index-e.index:n};function u9(t,e,n=0,r=t.length-1){for(;r>n;){if(r-n>600){const s=r-n+1,l=e-n+1,u=Math.log(s),c=.5*Math.exp(2*u/3),d=.5*Math.sqrt(u*c*(s-c)/s)*Math.sign(l-s/2),p=Math.max(n,Math.floor(e-l*c/s+d)),f=Math.min(r,Math.floor(e+(s-l)*c/s+d));u9(t,e,p,f)}const a=t[e];let i=n,o=r;for(xs(t,n,e),Qm(t[r],a)>0&&xs(t,n,r);i<o;){for(xs(t,i,o),i++,o--;Qm(t[i],a)<0;)i=i+1;for(;Qm(t[o],a)>0;)o=o-1}Qm(t[n],a)===0?xs(t,n,o):(o=o+1,xs(t,o,r)),o<=e&&(n=o+1),e<=o&&(r=o-1)}}function c9(t,e,n,r,a){const i=e[e.length-1],[o,s]=[t.length/i,i],l=tr(n,o*r),u=tr("int32",o*r);for(let d=0;d<o;d++){const p=d*s,f=t.subarray(p,p+s);let g=new Array(f.length);f.forEach((v,w)=>g[w]={value:v,index:w}),r<g.length&&(u9(g,r),g=g.slice(0,r)),a&&g.sort(Qm);const y=d*r,x=l.subarray(y,y+r),b=u.subarray(y,y+r);for(let v=0;v<r;v++)x[v]=g[v].value,b[v]=g[v].index}const c=e.slice();return c[c.length-1]=r,[pt(c,n,l),pt(c,"int32",u)]}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function d9(t,e,n,r){const a=Pt(e,n)[0],i=[1,n[0],1];for(let g=0;g<a;g++)i[0]*=n[g];i[1]=n[a];for(let g=a+1;g<n.length;g++)i[2]*=n[g];const o={},s=new Int32Array(n[a]),l=new rr(i,r,t),u=[],c=i[0]===1&&i[2]===1;for(let g=0;g<n[a];g++){let y;if(c)y=t[g].toString();else{const x=[];for(let b=0;b<i[0];b++)for(let v=0;v<i[2];v++)x.push(l.get(b,g,v));y=x.join(",")}if(o[y]!==void 0)s[g]=o[y];else{const x=Object.keys(o).length;o[y]=x,s[g]=x,u.push(g)}}const d=i.slice();d[1]=Object.keys(o).length;const p=new rr(d,r);u.forEach((g,y)=>{for(let x=0;x<i[0];x++)for(let b=0;b<i[2];b++)p.set(l.get(x,g,b),x,y,b)});const f=n.slice();return f[a]=d[1],{outputValues:p.values,outputShape:f,indices:s}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Zfe=Object.freeze(Object.defineProperty({__proto__:null,addImpl:wF,bincountImpl:x4,bincountReduceImpl:kF,castImpl:xF,ceilImpl:SF,concatImpl:CF,equalImpl:NF,expImpl:IF,expm1Impl:_F,floorImpl:OF,gatherNdImpl:$F,gatherV2Impl:RF,greaterEqualImpl:AF,greaterImpl:MF,lessEqualImpl:DF,lessImpl:PF,linSpaceImpl:LF,logImpl:FF,maxImpl:BF,maximumImpl:zF,minimumImpl:VF,multiplyImpl:w4,negImpl:WF,notEqualImpl:jF,prodImpl:UF,raggedGatherImpl:HF,raggedTensorToTensorImpl:XF,rangeImpl:YF,rsqrtImpl:QF,scatterImpl:sp,sigmoidImpl:zfe,simpleAbsImpl:vF,sliceImpl:JF,sparseFillEmptyRowsImpl:e9,sparseReshapeImpl:t9,sparseSegmentReductionImpl:S4,sqrtImpl:jfe,squaredDifferenceImpl:n9,stridedSliceImpl:r9,stringNGramsImpl:a9,stringSplitImpl:i9,stringToHashBucketFastImpl:o9,subImpl:s9,tileImpl:l9,topKImpl:c9,transposeImpl:k4,uniqueImpl:d9},Symbol.toStringTag,{value:"Module"}));/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/$T("cpu",()=>new U2,1);/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const p9=Kt($f,t=>t>=0?t:Math.exp(t)-1),Jfe={kernelName:$f,backendName:"cpu",kernelFunc:p9};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function h9(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{alpha:i}=r;ze([a],"leakyRelu");const o=me(a.shape),s=n.data.get(a.dataId).values,l=tr("float32",o);for(let u=0;u<s.length;u++)l[u]=s[u]<0?i*s[u]:s[u];return n.makeTensorInfo(a.shape,"float32",l)}const eme={kernelName:cv,backendName:"cpu",kernelFunc:h9};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const tme=Xn((t,e)=>t<0?e*t:t);function f9(t){const{inputs:e,backend:n}=t,{x:r,alpha:a}=e;ze([r,a],"prelu");const i=n.data.get(r.dataId).values,o=n.data.get(a.dataId).values,[s,l]=tme(r.shape,a.shape,i,o,"float32");return n.makeTensorInfo(l,"float32",s)}const nme={kernelName:_v,backendName:"cpu",kernelFunc:f9};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const m9=Kt(am,t=>Math.max(0,t)),rme={kernelName:am,backendName:"cpu",kernelFunc:m9};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const g9=Kt(im,t=>Math.min(Math.max(0,t),6)),ame={kernelName:im,backendName:"cpu",kernelFunc:g9};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function e2(t,e,n,r,a){if(n==="linear")return zo({inputs:{x:e},backend:t});if(n==="relu")return m9({inputs:{x:e},backend:t});if(n==="elu")return p9({inputs:{x:e},backend:t});if(n==="relu6")return g9({inputs:{x:e},backend:t});if(n==="prelu")return f9({inputs:{x:e,alpha:r},backend:t});if(n==="leakyrelu")return h9({inputs:{x:e},backend:t,attrs:{alpha:a}});if(n==="sigmoid")return ZF({inputs:{x:e},backend:t});throw new Error(`Activation ${n} has not been implemented for the CPU backend.`)}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function dn(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{shape:i}=r,o=me(a.shape),s=P3(i,o),l=me(s);V(o===l,()=>`The new shape (${s}) has ${l} elements and the old shape (${a.shape}) has ${o} elements. The new shape and old shape must have the same number of elements.`),n.incRef(a.dataId);const u=n.data.get(a.dataId);if(u.complexTensorInfos!=null){const c=u.complexTensorInfos.real,d=u.complexTensorInfos.imag;c.shape=s,d.shape=s}return{dataId:a.dataId,shape:s,dtype:a.dtype}}const ime={kernelName:Pv,backendName:"cpu",kernelFunc:dn};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function y9(t){const{inputs:e,backend:n,attrs:r}=t,{a,b:i}=e,{transposeA:o,transposeB:s}=r;ze([a,i],"matMul");const l=a.shape.length,u=i.shape.length,c=o?a.shape[l-2]:a.shape[l-1],d=s?i.shape[u-1]:i.shape[u-2],p=o?a.shape[l-1]:a.shape[l-2],f=s?i.shape[u-2]:i.shape[u-1],g=a.shape.slice(0,-2),y=i.shape.slice(0,-2),x=me(g),b=me(y),v=Nt(a.shape.slice(0,-2),i.shape.slice(0,-2)).concat([p,f]);V(c===d,()=>`Error in matMul: inner shapes (${c}) and (${d}) of Tensors with shapes ${a.shape} and ${i.shape} and transposeA=${o} and transposeB=${s} must match.`);const w=o?[x,c,p]:[x,p,c],S=s?[b,f,d]:[b,d,f],C=dn({inputs:{x:a},backend:n,attrs:{shape:w}}),I=dn({inputs:{x:i},backend:n,attrs:{shape:S}}),_=o?C.shape[1]:C.shape[2],E=o?C.shape[2]:C.shape[1],A=s?I.shape[1]:I.shape[2],M=Math.max(x,b),L=n.data.get(C.dataId).values,W=n.data.get(I.dataId).values,B=qe(C.shape),K=qe(I.shape),[X,Q,H]=o?[B[0],1,B[1]]:[B[0],B[1],1],[F,Y,Z]=s?[1,K[1],K[0]]:[K[1],1,K[0]],ne=E*A,se=pt([M,E,A],C.dtype),ce=se.values,le=n.blockSize;for(let ye=0;ye<M;ye++)for(let we=0;we<E;we+=le)for(let q=0;q<A;q+=le)for(let ie=0;ie<_;ie+=le){const de=Math.min(we+le,E),ke=Math.min(q+le,A),Ne=Math.min(ie+le,_);for(let Ie=we;Ie<de;Ie++)for(let De=q;De<ke;De++){let He=0;for(let Me=ie;Me<Ne;Me++){const it=Math.min(ye,x-1)*X,Ye=Math.min(ye,b-1)*Z,Ze=L[it+Ie*Q+Me*H],Qe=W[Me*F+De*Y+Ye];He+=Ze*Qe}ce[ye*ne+(Ie*A+De)]+=He}}return n.disposeIntermediateTensorInfo(C),n.disposeIntermediateTensorInfo(I),n.makeTensorInfo(v,se.dtype,se.values)}const ome={kernelName:Rb,backendName:"cpu",kernelFunc:y9};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function sme(t){const{inputs:e,backend:n,attrs:r}=t,{a,b:i,bias:o,preluActivationWeights:s}=e,{transposeA:l,transposeB:u,activation:c,leakyreluAlpha:d}=r;let p,f,g;const y=[];p=y9({inputs:{a,b:i},attrs:{transposeA:l,transposeB:u},backend:n}),o&&(f=ip({inputs:{a:p,b:o},backend:n}),y.push(p),p=f),c&&(g=e2(n,p,c,s,d),y.push(p),p=g);for(const x of y)n.disposeIntermediateTensorInfo(x);return p}const lme={kernelName:wm,backendName:"cpu",kernelFunc:sme};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const ume=Kt(bf,t=>Math.acos(t)),cme={kernelName:bf,backendName:"cpu",kernelFunc:ume};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const dme=Kt(vf,t=>Math.acosh(t)),pme={kernelName:vf,backendName:"cpu",kernelFunc:dme};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function hme(t){const{inputs:e,backend:n}=t,r=e;ze(e,"addN");const a=r.map(s=>n.data.get(s.dataId).values),i=pt(r[0].shape,r[0].dtype),o=i.values;for(let s=0;s<r.length;s++){const l=a[s];for(let u=0;u<o.length;u++)o[u]+=l[u]}return n.makeTensorInfo(i.shape,i.dtype,i.values)}const fme={kernelName:Nb,backendName:"cpu",kernelFunc:hme};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function mme(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:i,keepDims:o}=r;ze(a,"all");const s=Pt(i,a.shape);let l=s;const u=jn(l,a.shape.length);let c=a;u!=null&&(c=Sa({inputs:{x:a},backend:n,attrs:{perm:u}}),l=Un(l.length,a.shape.length)),Tr("all",l,c.shape.length);const[d,p]=Nr(c.shape,l),f=me(p),g=Cr(me(d),c.dtype),y=n.data.get(c.dataId).values;for(let b=0;b<g.length;++b){const v=b*f;let w=y[v];for(let S=0;S<f;++S){const C=y[v+S];w=w&&C}g[b]=w}u!=null&&n.disposeIntermediateTensorInfo(c);const x=n.makeTensorInfo(d,c.dtype,g);if(o){const b=ar(d,s),v=dn({inputs:{x},backend:n,attrs:{shape:b}});return n.disposeIntermediateTensorInfo(x),v}return x}const gme={kernelName:Tb,backendName:"cpu",kernelFunc:mme};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function yme(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:i,keepDims:o}=r;ze(a,"any");const s=Pt(i,a.shape);let l=s;const u=jn(l,a.shape.length);let c=a;u!=null&&(c=Sa({inputs:{x:a},backend:n,attrs:{perm:u}}),l=Un(l.length,a.shape.length)),Tr("any",l,c.shape.length);const[d,p]=Nr(c.shape,l),f=me(p),g=Cr(me(d),c.dtype),y=n.data.get(c.dataId).values;for(let b=0;b<g.length;++b){const v=b*f;let w=y[v];for(let S=0;S<f;++S){const C=y[v+S];w=w||C}g[b]=w}u!=null&&n.disposeIntermediateTensorInfo(c);const x=n.makeTensorInfo(d,c.dtype,g);if(o){const b=ar(d,s),v=dn({inputs:{x},backend:n,attrs:{shape:b}});return n.disposeIntermediateTensorInfo(x),v}return x}const bme={kernelName:Ib,backendName:"cpu",kernelFunc:yme};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function vme(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:i}=r;ze(a,"argMax");let o=Pt(i,a.shape);const s=jn(o,a.shape.length);let l=a;const u=[];s!=null&&(l=Sa({inputs:{x:a},backend:n,attrs:{perm:s}}),u.push(l),o=Un(o.length,l.shape.length)),o=[o[0]],Tr("argMax",o,l.shape.length);const[c,d]=Nr(l.shape,o),p=me(c),f=Cr(p,"int32"),g=me(d),y=n.data.get(l.dataId).values;for(let x=0;x<f.length;++x){const b=x*g;let v=y[b],w=0;for(let S=0;S<g;++S){const C=y[b+S];C>v&&(v=C,w=S)}f[x]=w}return u.forEach(x=>n.disposeIntermediateTensorInfo(x)),n.makeTensorInfo(c,"int32",f)}const xme={kernelName:Eb,backendName:"cpu",kernelFunc:vme};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function wme(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:i}=r;ze(a,"argMin");let o=Pt(i,a.shape);const s=jn(o,a.shape.length);let l=a;const u=[];s!=null&&(l=Sa({inputs:{x:a},backend:n,attrs:{perm:s}}),u.push(l),o=Un(o.length,l.shape.length)),o=[o[0]],Tr("argMin",o,l.shape.length);const[c,d]=Nr(l.shape,o),p=me(c),f=Cr(p,"int32"),g=me(d),y=n.data.get(l.dataId).values;for(let x=0;x<f.length;++x){const b=x*g;let v=y[b],w=0;for(let S=0;S<g;++S){const C=y[b+S];C<v&&(v=C,w=S)}f[x]=w}return u.forEach(x=>n.disposeIntermediateTensorInfo(x)),n.makeTensorInfo(c,"int32",f)}const kme={kernelName:_b,backendName:"cpu",kernelFunc:wme};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Sme=Kt(xf,t=>Math.asin(t)),Cme={kernelName:xf,backendName:"cpu",kernelFunc:Sme};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Nme=Kt(wf,t=>Math.asinh(t)),Tme={kernelName:wf,backendName:"cpu",kernelFunc:Nme};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Ime=Kt(kf,t=>Math.atan(t)),Eme={kernelName:kf,backendName:"cpu",kernelFunc:Ime};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const _me=Xn((t,e)=>Math.atan2(t,e)),Ome=fr(Cf,_me),$me={kernelName:Cf,backendName:"cpu",kernelFunc:Ome};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Rme=Kt(Sf,t=>Math.atanh(t)),Mme={kernelName:Sf,backendName:"cpu",kernelFunc:Rme};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function N4(t,e,n,r,a,i){const o=a.strideHeight,s=a.strideWidth,l=a.dilationHeight,u=a.dilationWidth,c=a.effectiveFilterHeight,d=a.effectiveFilterWidth,p=a.padInfo.top,f=a.padInfo.left,g=i==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,y=pt(a.outShape,n),x=y.values,b=a.outShape[1]*a.outShape[2]*a.outShape[3],v=a.outShape[2]*a.outShape[3],w=a.outShape[3];for(let S=0;S<a.batchSize;++S){const C=S*b,I=S*r[0];for(let _=0;_<a.inChannels;++_)for(let E=0;E<a.outHeight;++E){const A=E*o-p,M=Math.max(0,A),L=Math.min(a.inHeight,c+A),W=C+E*v;for(let B=0;B<a.outWidth;++B){const K=B*s-f,X=Math.max(0,K),Q=Math.min(a.inWidth,d+K);let H=g,F=0,Y=0;for(let ne=M;ne<L;ne+=l){const se=I+ne*r[1];for(let ce=X;ce<Q;ce+=u){const le=se+ce*r[2],ye=t[le+_];i==="max"&&ye>H?H=ye:i==="avg"&&(F+=ye,Y++)}if(isNaN(H))break}const Z=W+B*w+_;x[Z]=i==="avg"?F/Y:H}}}return y}function b9(t,e,n,r,a=!1,i=!1){const o=pt(r.outShape,"int32"),s=r.strideHeight,l=r.strideWidth,u=r.dilationHeight,c=r.dilationWidth,d=r.effectiveFilterHeight,p=r.effectiveFilterWidth,f=r.padInfo.top,g=r.padInfo.left,y=pt(e,n,t);for(let x=0;x<r.batchSize;++x)for(let b=0;b<r.inChannels;++b)for(let v=0;v<r.outHeight;++v){const w=v*s-f;let S=w;for(;S<0;)S+=u;const C=Math.min(r.inHeight,d+w);for(let I=0;I<r.outWidth;++I){const _=I*l-g;let E=_;for(;E<0;)E+=c;const A=Math.min(r.inWidth,p+_);let M=Number.NEGATIVE_INFINITY,L=-1;for(let W=S;W<C;W+=u){const B=W-w;for(let K=E;K<A;K+=c){const X=K-_,Q=y.get(x,W,K,b);Q>M&&(M=Q,a?L=i?((x*r.inHeight+W)*r.inWidth+K)*r.inChannels+b:(W*r.inWidth+K)*r.inChannels+b:L=B*p+X)}}o.set(L,x,v,I,b)}}return o}function v9(t,e,n,r,a,i){const o=a.strideDepth,s=a.strideHeight,l=a.strideWidth,u=a.dilationDepth,c=a.dilationHeight,d=a.dilationWidth,p=a.effectiveFilterDepth,f=a.effectiveFilterHeight,g=a.effectiveFilterWidth,y=a.padInfo.front,x=a.padInfo.top,b=a.padInfo.left,v=i==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,w=pt(a.outShape,n),S=w.values,C=a.outShape[1]*a.outShape[2]*a.outShape[3]*a.outShape[4],I=a.outShape[2]*a.outShape[3]*a.outShape[4],_=a.outShape[3]*a.outShape[4],E=a.outShape[4];for(let A=0;A<a.batchSize;++A){const M=A*C,L=A*r[0];for(let W=0;W<a.inChannels;++W)for(let B=0;B<a.outDepth;++B){const K=B*o-y;let X=K;for(;X<0;)X+=u;const Q=Math.min(a.inDepth,p+K),H=M+B*I;for(let F=0;F<a.outHeight;++F){const Y=F*s-x;let Z=Y;for(;Z<0;)Z+=c;const ne=Math.min(a.inHeight,f+Y),se=H+F*_;for(let ce=0;ce<a.outWidth;++ce){const le=ce*l-b;let ye=le;for(;ye<0;)ye+=d;const we=Math.min(a.inWidth,g+le),q=se+ce*E;let ie=v,de=0,ke=0;for(let Ie=X;Ie<Q;Ie+=u){const De=L+Ie*r[1];for(let He=Z;He<ne;He+=c){const Me=De+He*r[2];for(let it=ye;it<we;it+=d){const Ye=Me+it*r[3],Ze=t[Ye+W];if(i==="max"&&Ze>ie?ie=Ze:i==="avg"&&(de+=Ze,ke++),isNaN(ie))break}if(isNaN(ie))break}if(isNaN(ie))break}const Ne=q+W;S[Ne]=i==="avg"?de/ke:ie}}}}return w}function Ame(t,e){const n=pt(e.outShape,"int32"),r=e.strideDepth,a=e.strideHeight,i=e.strideWidth,o=e.dilationDepth,s=e.dilationHeight,l=e.dilationWidth,u=e.effectiveFilterDepth,c=e.effectiveFilterHeight,d=e.effectiveFilterWidth,p=e.padInfo.front,f=e.padInfo.top,g=e.padInfo.left;for(let y=0;y<e.batchSize;++y)for(let x=0;x<e.inChannels;++x)for(let b=0;b<e.outDepth;++b){const v=b*r-p;let w=v;for(;w<0;)w+=o;const S=Math.min(e.inDepth,u+v);for(let C=0;C<e.outHeight;++C){const I=C*a-f;let _=I;for(;_<0;)_+=s;const E=Math.min(e.inHeight,c+I);for(let A=0;A<e.outWidth;++A){const M=A*i-g;let L=M;for(;L<0;)L+=l;const W=Math.min(e.inWidth,d+M);let B=Number.NEGATIVE_INFINITY,K=-1;for(let X=w;X<S;X+=o){const Q=X-v;for(let H=_;H<E;H+=s){const F=H-I;for(let Y=L;Y<W;Y+=l){const Z=Y-M,ne=t.get(y,X,H,Y,x);ne>=B&&(B=ne,K=Q*c*d+F*c+Z)}}}n.set(K,y,b,C,A,x)}}}return n}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Pme(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e;ze(a,"avgPool");const{filterSize:i,strides:o,pad:s,dimRoundingMode:l}=r,u=1;V(jr(o,u),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${u}'`);const c=Ii(a.shape,i,o,u,s,l);let d;if(c.filterWidth===1&&c.filterHeight===1&&tn(c.inShape,c.outShape))d=zo({inputs:{x:a},backend:n});else{const p=n.data.get(a.dataId).values,f=qe(a.shape),g=N4(p,a.shape,a.dtype,f,c,"avg");d=n.makeTensorInfo(c.outShape,a.dtype,g.values)}return d}const Dme={kernelName:Ob,backendName:"cpu",kernelFunc:Pme};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Lme(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{filterSize:i,strides:o,pad:s,dimRoundingMode:l,dataFormat:u}=r;ze(a,"avgPool3d");const c=_s(a.shape,i,o,1,s,l,u),d=n.data.get(a.dataId).values,p=v9(d,a.shape,a.dtype,qe(a.shape),c,"avg");return n.makeTensorInfo(p.shape,"float32",p.values)}const Fme={kernelName:$b,backendName:"cpu",kernelFunc:Lme};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Bme(t){const{inputs:e,backend:n,attrs:r}=t,{dy:a,input:i}=e,{filterSize:o,strides:s,pad:l,dimRoundingMode:u}=r;ze([a,i],"avgPool3DGrad");const c=_s(i.shape,o,s,1,l,u),d=c.strideDepth,p=c.strideHeight,f=c.strideWidth,g=c.filterDepth,y=c.filterHeight,x=c.filterWidth,b=c.dilationDepth,v=c.dilationHeight,w=c.dilationWidth,S=c.effectiveFilterDepth,C=c.effectiveFilterHeight,I=c.effectiveFilterWidth,_=S-1-c.padInfo.front,E=I-1-c.padInfo.left,A=C-1-c.padInfo.top,M=pt(i.shape,"float32"),L=1/(g*y*x),W=n.bufferSync(a);for(let B=0;B<c.batchSize;++B)for(let K=0;K<c.inChannels;++K)for(let X=0;X<c.inDepth;++X)for(let Q=0;Q<c.inHeight;++Q)for(let H=0;H<c.inWidth;++H){const F=X-_,Y=Q-A,Z=H-E;let ne=0;for(let se=0;se<S;se+=b){const ce=(F+se)/d;if(!(ce<0||ce>=c.outDepth||Math.floor(ce)!==ce))for(let le=0;le<C;le+=v){const ye=(Y+le)/p;if(!(ye<0||ye>=c.outHeight||Math.floor(ye)!==ye))for(let we=0;we<I;we+=w){const q=(Z+we)/f;if(q<0||q>=c.outWidth||Math.floor(q)!==q)continue;const ie=W.get(B,ce,ye,q,K);ne+=ie}}}M.set(ne*L,B,X,Q,H,K)}return n.makeTensorInfo(M.shape,M.dtype,M.values)}const zme={kernelName:j3,backendName:"cpu",kernelFunc:Bme};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Vme(t){const{inputs:e,backend:n,attrs:r}=t,{dy:a,input:i}=e,o=i;ze([a,i],"avgPoolGrad");const{filterSize:s,strides:l,pad:u}=r,c=Ii(o.shape,s,l,1,u),d=c.strideHeight,p=c.strideWidth,f=c.filterHeight,g=c.filterWidth,y=c.dilationHeight,x=c.dilationWidth,b=c.effectiveFilterHeight,v=c.effectiveFilterWidth,w=v-1-c.padInfo.left,S=b-1-c.padInfo.top,C=pt(o.shape,"float32"),I=1/(f*g),_=n.data.get(a.dataId).values,E=pt(a.shape,"float32",_);for(let A=0;A<c.batchSize;++A)for(let M=0;M<c.inChannels;++M)for(let L=0;L<c.inHeight;++L)for(let W=0;W<c.inWidth;++W){const B=L-S,K=W-w;let X=0;for(let Q=0;Q<b;Q+=y){const H=(B+Q)/d;if(!(H<0||H>=c.outHeight||Math.floor(H)!==H))for(let F=0;F<v;F+=x){const Y=(K+F)/p;if(Y<0||Y>=c.outWidth||Math.floor(Y)!==Y)continue;const Z=E.get(A,H,Y,M);X+=Z}}C.set(X*I,A,L,W,M)}return n.makeTensorInfo(C.shape,C.dtype,C.values)}const Wme={kernelName:W3,backendName:"cpu",kernelFunc:Vme};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function jme(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,scale:i,offset:o,mean:s,variance:l}=e;V(s.shape.length===l.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),V(o==null||s.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),V(i==null||s.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),ze([a,s,l,i,o],"batchNorm");let{varianceEpsilon:u}=r;u==null&&(u=.001);const c=n.data.get(a.dataId).values,d=n.data.get(s.dataId).values,p=n.data.get(l.dataId).values,f=i?n.data.get(i.dataId).values:new Float32Array([1]),g=o?n.data.get(o.dataId).values:new Float32Array([0]),y=new Float32Array(c.length),x=g.length,b=f.length,v=p.length,w=d.length;let S=0,C=0,I=0,_=0;for(let E=0;E<c.length;++E)y[E]=g[S++]+(c[E]-d[C++])*f[I++]/Math.sqrt(p[_++]+u),S>=x&&(S=0),C>=w&&(C=0),I>=b&&(I=0),_>=v&&(_=0);return n.makeTensorInfo(a.shape,a.dtype,y)}const Ume={kernelName:iv,backendName:"cpu",kernelFunc:jme};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Gme(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{blockShape:i,crops:o}=r;ze([a],"batchToSpaceND");const s=i.reduce((b,v)=>b*v),l=qm(a.shape,i,s),u=Km(l.length,i.length),c=Xm(a.shape,i,s),d=FI(o,i.length),p=BI(c,o,i.length),f=dn({inputs:{x:a},backend:n,attrs:{shape:l}}),g=Sa({inputs:{x:f},backend:n,attrs:{perm:u}}),y=dn({inputs:{x:g},backend:n,attrs:{shape:c}}),x=cc({inputs:{x:y},backend:n,attrs:{begin:d,size:p}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(y),x}const Hme={kernelName:Mb,backendName:"cpu",kernelFunc:Gme};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function qme(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,weights:i}=e,{size:o}=r,s=n.data.get(a.dataId).values,l=n.data.get(i.dataId).values,u=x4(s,l,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,u)}const Kme={kernelName:Ab,backendName:"cpu",kernelFunc:qme};/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Xme(t){const{inputs:e,backend:n}=t,{s0:r,s1:a}=e,i=n.data.get(r.dataId).values,o=n.data.get(a.dataId).values,s=Nt(Array.from(i),Array.from(o));return n.makeTensorInfo([s.length],"int32",Int32Array.from(s))}const Yme={kernelName:Pb,backendName:"cpu",kernelFunc:Xme};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Qme=Kt(If,(t,e)=>{const n=e;return t>n.clipValueMax?n.clipValueMax:t<n.clipValueMin?n.clipValueMin:t}),Zme={kernelName:If,backendName:"cpu",kernelFunc:Qme};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Jme=t=>{const{x:e}=t.inputs,n=t.backend,r=new Float32Array(me(e.shape)),a=n.data.get(e.dataId),i=a.complexTensorInfos.real,o=a.complexTensorInfos.imag,s=n.data.get(i.dataId).values,l=n.data.get(o.dataId).values;for(let u=0;u<s.length;u++){const c=s[u],d=l[u];r[u]=Math.hypot(c,d)}return n.makeOutput(r,e.shape,"float32")},ege={kernelName:Lb,backendName:"cpu",kernelFunc:Jme};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function lp(t){const{inputs:e,backend:n}=t,{input:r}=e,a=n.data.get(r.dataId).complexTensorInfos.imag,i=n.data.get(a.dataId).values;return n.makeTensorInfo(a.shape,a.dtype,i)}const tge={kernelName:uv,backendName:"cpu",kernelFunc:lp};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function up(t){const{inputs:e,backend:n,attrs:r}=t,{axis:a}=r,i=Pt(a,e[0].shape)[0],o=e.map(y=>y.shape);PI(o,i);let s=Fo(e.map(y=>y.shape),i);if(me(s)===0)return n.makeTensorInfo(s,e[0].dtype,[]);const l=e.filter(y=>me(y.shape)>0);if(l.length===1)return zo({inputs:{x:l[0]},backend:n});if(l[0].dtype==="complex64"){const y=l.map(S=>uc({inputs:{input:S},backend:n})),x=l.map(S=>lp({inputs:{input:S},backend:n})),b=up({inputs:y,backend:n,attrs:{axis:i}}),v=up({inputs:x,backend:n,attrs:{axis:i}}),w=ja({inputs:{real:b,imag:v},backend:n});return y.forEach(S=>n.disposeIntermediateTensorInfo(S)),x.forEach(S=>n.disposeIntermediateTensorInfo(S)),n.disposeIntermediateTensorInfo(b),n.disposeIntermediateTensorInfo(v),w}const u=l.map(y=>{const x=[-1,me(y.shape.slice(i))];return dn({inputs:{x:y},backend:n,attrs:{shape:x}})}),c=u.map(y=>({vals:n.data.get(y.dataId).values,shape:y.shape}));s=Fo(u.map(y=>y.shape),1);const d=u[0].shape[0]===1,p=CF(c,s,e[0].dtype,d),f=Fo(l.map(y=>y.shape),i),g=n.makeTensorInfo(f,e[0].dtype,p);return u.forEach(y=>n.disposeIntermediateTensorInfo(y)),g}const nge={kernelName:Fb,backendName:"cpu",kernelFunc:up};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function x9(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,filter:i}=e,{strides:o,pad:s,dataFormat:l,dilations:u,dimRoundingMode:c}=r;ze([a,i],"conv2d");const d=Os(l),p=hr(a.shape,i.shape,o,u,s,c,!1,d),f=p.filterHeight,g=p.filterWidth,y=p.dilationHeight,x=p.dilationWidth,b=p.padInfo.left,v=p.padInfo.top,w=p.dataFormat==="channelsLast",S=new rr(p.outShape,a.dtype),C=qe(a.shape),I=qe(i.shape),_=C[0],E=w?C[1]:C[2],A=w?C[2]:1,M=w?1:C[1],L=S.strides[0],W=w?S.strides[1]:S.strides[2],B=w?S.strides[2]:1,K=w?1:S.strides[1],X=n.data.get(a.dataId).values,Q=n.data.get(i.dataId).values,H=S.values;for(let F=0;F<p.batchSize;++F){const Y=F*_,Z=F*L;for(let ne=0;ne<p.outHeight;++ne){const se=Z+ne*W,ce=ne*p.strideHeight-v;for(let le=0;le<f;++le){const ye=ce+le*y;if(ye<0||ye>=p.inHeight)continue;const we=le*I[0],q=Y+ye*E;for(let ie=0;ie<p.outWidth;++ie){const de=se+ie*B,ke=ie*p.strideWidth-b;for(let Ne=0;Ne<g;++Ne){const Ie=ke+Ne*x;if(Ie<0||Ie>=p.inWidth)continue;const De=we+Ne*I[1],He=q+Ie*A;let Me=De;for(let it=0;it<p.inChannels;++it){const Ye=X[He+it*M];for(let Ze=0;Ze<p.outChannels;++Ze)H[de+Ze*K]+=Ye*Q[Me+Ze];Me+=p.outChannels}}}}}}return n.makeTensorInfo(S.shape,S.dtype,H)}const rge={kernelName:Bb,backendName:"cpu",kernelFunc:x9};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function age(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,dy:i}=e,{strides:o,pad:s,dataFormat:l,dimRoundingMode:u,filterShape:c}=r;ze([a,i],"conv2dBackpropFilter");const d=Os(l),p=hr(a.shape,c,o,1,s,u,!1,d),{strideHeight:f,strideWidth:g,filterHeight:y,filterWidth:x}=p,b=p.dataFormat==="channelsLast",v=new rr(p.filterShape,"float32"),w=p.padInfo.left,S=p.padInfo.top,C=n.data.get(a.dataId).values,I=n.data.get(i.dataId).values,_=new rr(a.shape,a.dtype,C),E=new rr(i.shape,i.dtype,I);for(let A=0;A<y;++A){const M=Math.max(0,Math.ceil((S-A)/f)),L=Math.min(p.outHeight,(p.inHeight+S-A)/f);for(let W=0;W<x;++W){const B=Math.max(0,Math.ceil((w-W)/g)),K=Math.min(p.outWidth,(p.inWidth+w-W)/g);for(let X=0;X<p.inChannels;++X)for(let Q=0;Q<p.outChannels;++Q){let H=0;for(let F=0;F<p.batchSize;++F)for(let Y=M;Y<L;++Y){const Z=A+Y*f-S;for(let ne=B;ne<K;++ne){const se=W+ne*g-w;b?H+=_.get(F,Z,se,X)*E.get(F,Y,ne,Q):H+=_.get(F,X,Z,se)*E.get(F,Q,Y,ne)}}v.set(H,A,W,X,Q)}}}return n.makeTensorInfo(v.shape,v.dtype,v.values)}const ige={kernelName:zb,backendName:"cpu",kernelFunc:age};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function oge(t){const{inputs:e,backend:n,attrs:r}=t,{dy:a,filter:i}=e,{inputShape:o,strides:s,pad:l,dataFormat:u,dimRoundingMode:c}=r;ze([a,i],"conv2dBackpropInput");const d=qe(i.shape),p=qe(a.shape);let f=Os(u);const g=hr(o,i.shape,s,1,l,c,!1,f),y=new rr(g.inShape,"float32"),x=y.values,b=n.data.get(a.dataId).values,v=n.data.get(i.dataId).values,[w,S,C]=d,{batchSize:I,filterHeight:_,filterWidth:E,inChannels:A,inHeight:M,inWidth:L,outChannels:W,outHeight:B,outWidth:K,strideHeight:X,strideWidth:Q}=g;f=g.dataFormat;const H=_-1-g.padInfo.top,F=E-1-g.padInfo.left,Y=f==="channelsLast",Z=y.strides[0],ne=Y?y.strides[1]:y.strides[2],se=Y?y.strides[2]:1,ce=Y?1:y.strides[1],le=p[0],ye=Y?p[1]:p[2],we=Y?p[2]:1,q=Y?1:p[1];for(let ie=0;ie<I;++ie)for(let de=0;de<A;++de)for(let ke=0;ke<M;++ke){const Ne=ke-H,Ie=Math.max(0,Math.ceil(Ne/X)),De=Math.min(B,(_+Ne)/X);for(let He=0;He<L;++He){const Me=He-F,it=Math.max(0,Math.ceil(Me/Q)),Ye=Math.min(K,(E+Me)/Q);let Ze=0;for(let Xt=Ie;Xt<De;++Xt){const Wt=Xt*X-Ne;for(let Ht=it;Ht<Ye;++Ht){const Yt=Ht*Q-Me,jt=le*ie+ye*Xt+we*Ht,Tt=w*(_-1-Wt)+S*(E-1-Yt)+C*de;for(let Gn=0;Gn<W;++Gn){const gr=b[jt+q*Gn],Ga=v[Tt+Gn];Ze+=gr*Ga}}}const Qe=Z*ie+ne*ke+se*He+ce*de;x[Qe]=Ze}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}const sge={kernelName:Vb,backendName:"cpu",kernelFunc:oge};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function lge(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,filter:i}=e,{strides:o,pad:s,dilations:l}=r;ze([a,i],"conv3d");const u=Dl(a.shape,i.shape,o,l,s),{filterDepth:c,filterHeight:d,filterWidth:p,dilationDepth:f,dilationHeight:g,dilationWidth:y,padInfo:x}=u,b=x.front,v=x.left,w=x.top,S=new rr(u.outShape,a.dtype),C=n.data.get(a.dataId).values,I=n.data.get(i.dataId).values,_=S.values,E=qe(a.shape),A=qe(i.shape);for(let M=0;M<u.batchSize;++M){const L=M*E[0],W=M*S.strides[0];for(let B=0;B<u.outDepth;++B){const K=W+B*S.strides[1],X=B*u.strideDepth-b;for(let Q=0;Q<c;++Q){const H=X+Q*f;if(H<0||H>=u.inDepth)continue;const F=Q*A[0],Y=L+H*E[1];for(let Z=0;Z<u.outHeight;++Z){const ne=K+Z*S.strides[2],se=Z*u.strideHeight-w;for(let ce=0;ce<d;++ce){const le=se+ce*g;if(le<0||le>=u.inHeight)continue;const ye=F+ce*A[1],we=Y+le*E[2];for(let q=0;q<u.outWidth;++q){const ie=ne+q*u.outChannels,de=q*u.strideWidth-v;for(let ke=0;ke<p;++ke){const Ne=de+ke*y;if(Ne<0||Ne>=u.inWidth)continue;const Ie=ye+ke*A[2],De=we+Ne*u.inChannels;let He=Ie;for(let Me=0;Me<u.inChannels;++Me){const it=C[De+Me];for(let Ye=0;Ye<u.outChannels;++Ye)_[ie+Ye]+=it*I[He+Ye];He+=u.outChannels}}}}}}}}return n.makeTensorInfo(S.shape,S.dtype,S.values)}const uge={kernelName:Wb,backendName:"cpu",kernelFunc:lge};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function cge(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,dy:i}=e,{strides:o,pad:s,filterShape:l}=r;ze([a,i],"conv3dBackpropFilterV2");const u=qe(a.shape),c=qe(i.shape),d=Dl(a.shape,l,o,1,s),p=d.strideDepth,f=d.strideHeight,g=d.strideWidth,y=d.filterDepth,x=d.filterHeight,b=d.filterWidth,v=new rr(d.filterShape,"float32"),w=v.values,[S,C,I,_]=v.strides,E=n.data.get(i.dataId).values,[A,M,L,W]=c,B=n.data.get(a.dataId).values,[K,X,Q,H]=u,F=d.padInfo.front,Y=d.padInfo.left,Z=d.padInfo.top;for(let ne=0;ne<y;++ne){const se=Math.max(0,Math.ceil((F-ne)/p)),ce=Math.min(d.outDepth,(d.inDepth+F-ne)/p),le=ne*S;for(let ye=0;ye<x;++ye){const we=Math.max(0,Math.ceil((Z-ye)/f)),q=Math.min(d.outHeight,(d.inHeight+Z-ye)/f),ie=ye*C+le;for(let de=0;de<b;++de){const ke=Math.max(0,Math.ceil((Y-de)/g)),Ne=Math.min(d.outWidth,(d.inWidth+Y-de)/g),Ie=de*I+ie;for(let De=0;De<d.inChannels;++De){const He=De*_+Ie;for(let Me=0;Me<d.outChannels;++Me){let it=0;for(let Ye=0;Ye<d.batchSize;++Ye){const Ze=Ye*K,Qe=Ye*A;for(let Xt=se;Xt<ce;++Xt){const Wt=(ne+Xt*p-F)*X+Ze,Ht=Xt*M+Qe;for(let Yt=we;Yt<q;++Yt){const jt=(ye+Yt*f-Z)*Q+Wt,Tt=Yt*L+Ht;for(let Gn=ke;Gn<Ne;++Gn){const gr=(de+Gn*g-Y)*H+jt,Ga=Gn*W+Tt;it+=B[gr+De]*E[Ga+Me]}}}}w[He+Me]=it}}}}}return n.makeTensorInfo(v.shape,v.dtype,v.values)}const dge={kernelName:U3,backendName:"cpu",kernelFunc:cge};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function pge(t){const{inputs:e,backend:n,attrs:r}=t,{dy:a,filter:i}=e,{pad:o,strides:s,inputShape:l}=r;ze([a],"conv3dBackpropInputV2");const u=qe(a.shape),c=qe(i.shape),d=Dl(l,i.shape,s,1,o),p=new rr(d.inShape,"float32"),f=p.values,[g,y,x,b]=p.strides,v=n.data.get(a.dataId).values,[w,S,C,I]=u,_=n.data.get(i.dataId).values,[E,A,M,L]=c,{batchSize:W,filterDepth:B,filterHeight:K,filterWidth:X,inChannels:Q,inDepth:H,inHeight:F,inWidth:Y,outChannels:Z,outDepth:ne,outHeight:se,outWidth:ce,strideDepth:le,strideHeight:ye,strideWidth:we}=d,q=B-1-d.padInfo.front,ie=K-1-d.padInfo.top,de=X-1-d.padInfo.left;for(let ke=0;ke<W;++ke)for(let Ne=0;Ne<Q;++Ne)for(let Ie=0;Ie<H;++Ie){const De=Ie-q,He=Math.max(0,Math.ceil(De/le)),Me=Math.min(ne,(B+De)/le);for(let it=0;it<F;++it){const Ye=it-ie,Ze=Math.max(0,Math.ceil(Ye/ye)),Qe=Math.min(se,(K+Ye)/ye);for(let Xt=0;Xt<Y;++Xt){const Wt=Xt-de,Ht=Math.max(0,Math.ceil(Wt/we)),Yt=Math.min(ce,(X+Wt)/we);let jt=0;for(let Tt=He;Tt<Me;++Tt){const Gn=Tt*le-De;for(let gr=Ze;gr<Qe;++gr){const Ga=gr*ye-Ye;for(let _r=Ht;_r<Yt;++_r){const Li=_r*we-Wt,Ls=w*ke+S*Tt+C*gr+I*_r,ho=E*(B-1-Gn)+A*(K-1-Ga)+M*(X-1-Li)+L*Ne;for(let rn=0;rn<Z;++rn){const Fi=v[Ls+rn],Fs=_[ho+rn];jt+=Fi*Fs}}}}f[g*ke+y*Ie+x*it+b*Xt+Ne]=jt}}}return n.makeTensorInfo(p.shape,p.dtype,p.values)}const hge={kernelName:jb,backendName:"cpu",kernelFunc:pge};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const fge=Kt(Ef,t=>Math.cos(t)),mge={kernelName:Ef,backendName:"cpu",kernelFunc:fge};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const gge=Kt(_f,t=>Math.cosh(t)),yge={kernelName:_f,backendName:"cpu",kernelFunc:gge};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function bge(t){const{inputs:e,backend:n,attrs:r}=t,{image:a,boxes:i,boxInd:o}=e,{cropSize:s,method:l,extrapolationValue:u}=r,[c,d,p,f]=a.shape,g=i.shape[0],[y,x]=s,b=pt([g,y,x,f],"float32"),v=n.data.get(i.dataId).values,w=n.data.get(o.dataId).values,S=n.data.get(a.dataId).values,C=qe(a.shape),I=qe(b.shape);for(let _=0;_<g;_++){const E=_*4,A=v[E],M=v[E+1],L=v[E+2],W=v[E+3],B=w[_];if(B>=c)continue;const K=y>1?(L-A)*(d-1)/(y-1):0,X=x>1?(W-M)*(p-1)/(x-1):0;for(let Q=0;Q<y;Q++){const H=y>1?A*(d-1)+Q*K:.5*(A+L)*(d-1);if(H<0||H>d-1){for(let F=0;F<x;F++)for(let Y=0;Y<f;Y++){const Z=Y+F*I[2]+Q*I[1]+_*I[0];b.values[Z]=u}continue}if(l==="bilinear"){const F=Math.floor(H),Y=Math.ceil(H),Z=H-F;for(let ne=0;ne<x;ne++){const se=x>1?M*(p-1)+ne*X:.5*(M+W)*(p-1);if(se<0||se>p-1){for(let we=0;we<f;we++){const q=we+ne*I[2]+Q*I[1]+_*I[0];b.values[q]=u}continue}const ce=Math.floor(se),le=Math.ceil(se),ye=se-ce;for(let we=0;we<f;we++){let q=we+ce*C[2]+F*C[1]+B*C[0];const ie=S[q];q=we+le*C[2]+F*C[1]+B*C[0];const de=S[q];q=we+ce*C[2]+Y*C[1]+B*C[0];const ke=S[q];q=we+le*C[2]+Y*C[1]+B*C[0];const Ne=S[q],Ie=ie+(de-ie)*ye,De=ke+(Ne-ke)*ye;q=we+ne*I[2]+Q*I[1]+_*I[0],b.values[q]=Ie+(De-Ie)*Z}}}else for(let F=0;F<x;++F){const Y=x>1?M*(p-1)+F*X:.5*(M+W)*(p-1);if(Y<0||Y>p-1){for(let se=0;se<f;se++){const ce=se+F*I[2]+Q*I[1]+_*I[0];b.values[ce]=u}continue}const Z=Math.round(Y),ne=Math.round(H);for(let se=0;se<f;se++){const ce=se+Z*C[2]+ne*C[1]+B*C[0],le=se+F*I[2]+Q*I[1]+_*I[0];b.values[le]=S[ce]}}}}return n.makeTensorInfo(b.shape,b.dtype,b.values)}const vge={kernelName:Hb,backendName:"cpu",kernelFunc:bge};/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function xge(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:i,exclusive:o,reverse:s}=r;ze(a,"cumprod");const l=jn([i],a.shape.length);let u=a;l!=null&&(u=Sa({inputs:{x:a},backend:n,attrs:{perm:l}}));const c=Un(1,a.shape.length)[0];if(c!==u.shape.length-1)throw new Error(`backend.cumprod in CPU expects an inner-most axis=${u.shape.length-1} but got axis=${c}`);const d=ka(u.dtype,"int32"),p=Sb(me(u.shape),d),f=n.data.get(u.dataId).values,g=u.shape[u.shape.length-1],y=s?(b,v)=>b+g-v-1:(b,v)=>b+v;for(let b=0;b<f.length;b+=g)for(let v=0;v<g;v++){const w=y(b,v);if(v===0)p[w]=o?1:f[w];else{const S=y(b,v-1);p[w]=o?f[S]*p[S]:f[w]*p[S]}}const x=n.makeTensorInfo(u.shape,d,p);if(l!=null){const b=Fm(l),v=Sa({inputs:{x},backend:n,attrs:{perm:b}});return n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(u),v}return x}const wge={kernelName:Ub,backendName:"cpu",kernelFunc:xge};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function kge(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:i,exclusive:o,reverse:s}=r;ze(a,"cumsum");const l=jn([i],a.shape.length);let u=a;l!=null&&(u=Sa({inputs:{x:a},backend:n,attrs:{perm:l}}));const c=Un(1,a.shape.length)[0];if(c!==u.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${u.shape.length-1} but got axis=${c}`);const d=ka(u.dtype,"int32"),p=Cr(me(u.shape),d),f=n.data.get(u.dataId).values,g=u.shape[u.shape.length-1],y=s?(b,v)=>b+g-v-1:(b,v)=>b+v;for(let b=0;b<f.length;b+=g)for(let v=0;v<g;v++){const w=y(b,v);if(v===0)p[w]=o?0:f[w];else{const S=y(b,v-1);p[w]=o?f[S]+p[S]:f[w]+p[S]}}const x=n.makeTensorInfo(u.shape,d,p);if(l!=null){const b=Fm(l),v=Sa({inputs:{x},backend:n,attrs:{perm:b}});return n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(u),v}return x}const Sge={kernelName:Gb,backendName:"cpu",kernelFunc:kge};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Cge(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,weights:i}=e,{size:o,binaryOutput:s}=r;if(a.shape.length===1){const l=n.data.get(a.dataId).values,u=n.data.get(i.dataId).values,c=x4(l,u,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,c)}else if(a.shape.length===2){const l=n.bufferSync(a),u=n.bufferSync(i),c=kF(l,u,o,s);return n.makeTensorInfo(c.shape,i.dtype,c.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${a.shape.length}.`)}const Nge={kernelName:qb,backendName:"cpu",kernelFunc:Cge};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Tge(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{blockSize:i,dataFormat:o}=r;V(o==="NHWC",()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${o}`);const s=a.shape[0],l=a.shape[1],u=a.shape[2],c=a.shape[3],d=l*i,p=u*i,f=c/(i*i),g=n.data.get(a.dataId).values,y=new Float32Array(s*d*p*f);let x=0;for(let b=0;b<s;++b)for(let v=0;v<d;++v){const w=Math.floor(v/i),S=v%i;for(let C=0;C<p;++C){const I=Math.floor(C/i),_=C%i,E=(S*i+_)*f;for(let A=0;A<f;++A){const M=A+E+c*(I+u*(w+l*b));y[x++]=g[M]}}}return n.makeTensorInfo([s,d,p,f],a.dtype,y)}const Ige={kernelName:Kb,backendName:"cpu",kernelFunc:Tge};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function w9(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,filter:i}=e,{strides:o,pad:s,dilations:l,dimRoundingMode:u}=r;ze([a,i],"depthwiseConv2DNative");const c=qe(a.shape),d=qe(i.shape);let p=l;p==null&&(p=[1,1]),V(jr(o,p),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${o} and dilations '${p}'`);const f=hr(a.shape,i.shape,o,p,s,u,!0),{filterHeight:g,filterWidth:y,dilationHeight:x,dilationWidth:b,padInfo:v}=f,w=v.left,S=v.top,C=f.outChannels/f.inChannels,I=new rr(f.outShape,a.dtype),_=n.data.get(a.dataId).values,E=n.data.get(i.dataId).values,A=I.values;for(let M=0;M<f.batchSize;++M){const L=M*c[0],W=M*I.strides[0];for(let B=0;B<f.outHeight;++B){const K=W+B*I.strides[1],X=B*f.strideHeight-S;for(let Q=0;Q<g;++Q){const H=X+Q*x;if(H<0||H>=f.inHeight)continue;const F=Q*d[0],Y=L+H*c[1];for(let Z=0;Z<f.outWidth;++Z){const ne=K+Z*I.strides[2],se=Z*f.strideWidth-w;for(let ce=0;ce<y;++ce){const le=se+ce*b;if(le<0||le>=f.inWidth)continue;const ye=F+ce*d[1],we=Y+le*f.inChannels;let q=ne,ie=ye;for(let de=0;de<f.inChannels;++de){const ke=_[we+de];for(let Ne=0;Ne<C;++Ne)A[q+Ne]+=ke*E[ie+Ne];q+=C,ie+=C}}}}}}return n.makeTensorInfo(I.shape,I.dtype,I.values)}const Ege={kernelName:Xb,backendName:"cpu",kernelFunc:w9};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function _ge(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,dy:i}=e,{strides:o,dilations:s,pad:l,dimRoundingMode:u,filterShape:c}=r;ze([a,i],"depthwiseConv2dNativeBackpropFilter");const d=hr(a.shape,c,o,s,l,u,!0),{strideHeight:p,strideWidth:f,filterHeight:g,filterWidth:y}=d,x=new rr(d.filterShape,"float32"),b=d.padInfo.left,v=d.padInfo.top,w=d.outChannels/d.inChannels,S=n.data.get(a.dataId).values,C=new rr(a.shape,a.dtype,S),I=n.data.get(i.dataId).values,_=new rr(i.shape,i.dtype,I);for(let E=0;E<g;++E){const A=Math.max(0,Math.ceil((v-E)/p)),M=Math.min(d.outHeight,(d.inHeight+v-E)/p);for(let L=0;L<y;++L){const W=Math.max(0,Math.ceil((b-L)/f)),B=Math.min(d.outWidth,(d.inWidth+b-L)/f);for(let K=0;K<d.outChannels;++K){const X=Math.trunc(K/w),Q=K%w;let H=0;for(let F=0;F<d.batchSize;++F)for(let Y=A;Y<M;++Y){const Z=E+Y*p-v;for(let ne=W;ne<B;++ne){const se=L+ne*f-b;H+=C.get(F,Z,se,X)*_.get(F,Y,ne,K)}}x.set(H,E,L,X,Q)}}}return n.makeTensorInfo(x.shape,x.dtype,x.values)}const Oge={kernelName:Yb,backendName:"cpu",kernelFunc:_ge};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function $ge(t){const{inputs:e,backend:n,attrs:r}=t,{dy:a,filter:i}=e,{strides:o,dilations:s,pad:l,dimRoundingMode:u,inputShape:c}=r;ze([a,i],"depthwiseConv2DNativeBackpropInput");const d=qe(a.shape),p=qe(i.shape),f=hr(c,i.shape,o,s,l,u,!0),g=new rr(f.inShape,"float32"),y=g.values,[x,b,v]=g.strides,w=n.data.get(a.dataId).values,[S,C,I]=d,_=n.data.get(i.dataId).values,[E,A,M]=p,{batchSize:L,filterHeight:W,filterWidth:B,inChannels:K,inHeight:X,inWidth:Q,outChannels:H,outHeight:F,outWidth:Y,strideHeight:Z,strideWidth:ne}=f,se=W-1-f.padInfo.top,ce=B-1-f.padInfo.left,le=H/K;for(let ye=0;ye<L;++ye)for(let we=0;we<K;++we)for(let q=0;q<X;++q){const ie=q-se,de=Math.max(0,Math.ceil(ie/Z)),ke=Math.min(F,(W+ie)/Z);for(let Ne=0;Ne<Q;++Ne){const Ie=Ne-ce,De=Math.max(0,Math.ceil(Ie/ne)),He=Math.min(Y,(B+Ie)/ne);let Me=0;for(let it=de;it<ke;++it){const Ye=it*Z-ie;for(let Ze=De;Ze<He;++Ze){const Qe=Ze*ne-Ie,Xt=S*ye+C*it+I*Ze,Wt=E*(W-1-Ye)+A*(B-1-Qe)+M*we;for(let Ht=0;Ht<le;++Ht){const Yt=we*le+Ht,jt=w[Xt+Yt],Tt=_[Wt+Ht];Me+=jt*Tt}}}y[x*ye+b*q+v*Ne+we]=Me}}return n.makeTensorInfo(g.shape,g.dtype,g.values)}const Rge={kernelName:Qb,backendName:"cpu",kernelFunc:$ge};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Mge(t){const{inputs:e,backend:n}=t,{x:r}=e,a=me(r.shape),i=n.data.get(r.dataId).values,o=pt([a,a],r.dtype),s=o.values;for(let u=0;u<i.length;u++)s[u*a+u]=i[u];const l=[...r.shape,...r.shape];return n.makeTensorInfo(l,o.dtype,o.values)}const Age={kernelName:Zb,backendName:"cpu",kernelFunc:Mge};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Pge={kernelName:Jb,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:r,filter:a}=t,{strides:i,pad:o,dilations:s}=n,l=e,u=l.data.get(r.dataId).values,c=r.shape.length,d=l.data.get(a.dataId).values,p=a.shape.length,{batchSize:f,inHeight:g,inWidth:y,inChannels:x,outHeight:b,outWidth:v,padInfo:w,strideHeight:S,strideWidth:C,filterHeight:I,filterWidth:_,dilationHeight:E,dilationWidth:A,outShape:M}=Am(r.shape,a.shape,i,o,"NHWC",s),L=me(M),W=M.length,B=nr(r.dtype,L);for(let K=0;K<f;++K)for(let X=0;X<b;++X){const Q=X*S-w.top;for(let H=0;H<v;++H){const F=H*C-w.left;for(let Y=0;Y<x;++Y){let Z=Number.MIN_SAFE_INTEGER;for(let se=0;se<I;++se){const ce=Q+se*E;if(ce>=0&&ce<g)for(let le=0;le<_;++le){const ye=F+le*A;if(ye>=0&&ye<y){const we=io([K,ce,ye,Y],c,qe(r.shape)),q=io([se,le,Y],p,qe(a.shape)),ie=u[we]+d[q];ie>Z&&(Z=ie)}}}const ne=io([K,X,H,Y],W,qe(M));B[ne]=Z}}}return{dataId:l.write(Rl(B,r.dtype),M,r.dtype),shape:M,dtype:r.dtype}}};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Dge={kernelName:H3,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:r,filter:a,dy:i}=t,{strides:o,pad:s,dilations:l}=n,u=e,c=ri(r.shape,u.data.get(r.dataId).values),d=ri(a.shape,u.data.get(a.dataId).values),{batchSize:p,inHeight:f,inWidth:g,inChannels:y,outHeight:x,outWidth:b,padInfo:v,strideHeight:w,strideWidth:S,filterHeight:C,filterWidth:I,dilationHeight:_,dilationWidth:E,outShape:A}=Am(r.shape,a.shape,o,s,"NHWC",l);V(i.rank===A.length,()=>`Error in ${H3}, dy must have the same rank as output ${A.length}, but got ${i.rank}`);const M=ri(A,u.data.get(i.dataId).values),L=L3(a.shape,a.dtype);for(let W=0;W<p;++W)for(let B=0;B<x;++B){const K=B*w-v.top;for(let X=0;X<b;++X){const Q=X*S-v.left;for(let H=0;H<y;++H){let F=Number.MIN_SAFE_INTEGER,Y=0,Z=0;for(let ne=0;ne<C;++ne){const se=K+ne*_;if(se>=0&&se<f)for(let ce=0;ce<I;++ce){const le=Q+ce*E;if(le>=0&&le<g){const ye=c[W][se][le][H]+d[ne][ce][H];ye>F&&(F=ye,Y=ne,Z=ce)}}}L[Y][Z][H]+=M[W][B][X][H]}}}return{dataId:u.write(Rl(L,r.dtype),a.shape,a.dtype),shape:a.shape,dtype:a.dtype}}};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Lge={kernelName:G3,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:r,filter:a,dy:i}=t,{strides:o,pad:s,dilations:l}=n,u=e,c=ri(r.shape,u.data.get(r.dataId).values),d=ri(a.shape,u.data.get(a.dataId).values),{batchSize:p,inHeight:f,inWidth:g,inChannels:y,outHeight:x,outWidth:b,padInfo:v,strideHeight:w,strideWidth:S,filterHeight:C,filterWidth:I,dilationHeight:_,dilationWidth:E,outShape:A}=Am(r.shape,a.shape,o,s,"NHWC",l);V(i.rank===A.length,()=>`Error in ${G3}, dy must have the same rank as output ${A.length}, but got ${i.rank}`);const M=ri(A,u.data.get(i.dataId).values),L=L3(r.shape,r.dtype);for(let W=0;W<p;++W)for(let B=0;B<x;++B){const K=B*w-v.top;for(let X=0;X<b;++X){const Q=X*S-v.left;for(let H=0;H<y;++H){let F=Number.MIN_SAFE_INTEGER,Y=K<0?0:K,Z=Q<0?0:Q;for(let ne=0;ne<C;++ne){const se=K+ne*_;if(se>=0&&se<f)for(let ce=0;ce<I;++ce){const le=Q+ce*E;if(le>=0&&le<g){const ye=c[W][se][le][H]+d[ne][ce][H];ye>F&&(F=ye,Y=se,Z=le)}}}L[W][Y][Z][H]+=M[W][B][X][H]}}}return{dataId:u.write(Rl(L,r.dtype),r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Zm(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:i,keepDims:o}=r;ze(a,"sum");let s;a.dtype==="bool"?s=Ul({inputs:{x:a},backend:n,attrs:{dtype:"int32"}}):s=zo({inputs:{x:a},backend:n});const l=s.shape.length,u=Pt(i,s.shape),c=jn(u,l);let d=u,p=s;c!=null&&(p=Sa({inputs:{x:s},backend:n,attrs:{perm:c}}),d=Un(d.length,l)),Tr("sum",d,p.shape.length);const[f,g]=Nr(p.shape,d),y=ka(p.dtype,"int32");let x=Zx(n,f,y);const b=me(g),v=n.data.get(x.dataId).values,w=n.data.get(p.dataId).values;for(let S=0;S<v.length;++S){const C=S*b;let I=0;for(let _=0;_<b;++_)I+=w[C+_];v[S]=I}if(o){const S=ar(x.shape,u),C=x;x=dn({inputs:{x},backend:n,attrs:{shape:S}}),n.disposeIntermediateTensorInfo(C)}return n.disposeIntermediateTensorInfo(s),c!=null&&n.disposeIntermediateTensorInfo(p),x}const Fge={kernelName:jv,backendName:"cpu",kernelFunc:Zm};/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Bge(t){const{inputs:e,backend:n,attrs:r}=t,{equation:a}=r,i=e,{allDims:o,summedDims:s,idDims:l}=YI(a,i.length);ZI(o.length,l,i);const{path:u,steps:c}=JI(s,l),d=c.length;let p=null,f=o.length;const g=[];for(let y=0;y<d;++y){for(const x of c[y]){const{permutationIndices:b,expandDims:v}=QI(f,l[x]);let w;e4(b)?w=i[x]:(w=Sa({inputs:{x:i[x]},backend:n,attrs:{perm:b}}),g.push(w));const S=w.shape.slice();for(let C=0;C<v.length;++C)S.splice(v[C],0,1);tn(w.shape,S)||(w=dn({inputs:{x:w},backend:n,attrs:{shape:S}}),g.push(w)),p===null?p=w:(p=Jx({inputs:{a:w,b:p},backend:n}),g.push(p))}y<d-1&&(u[y]>=0&&(p=Zm({inputs:{x:p},backend:n,attrs:{axis:u[y]-(o.length-f),keepDims:!1}}),g.push(p)),f--)}for(const y of g)y!==p&&n.disposeIntermediateTensorInfo(y);return p}const zge={kernelName:ev,backendName:"cpu",kernelFunc:Bge};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Vge(t){const{inputs:e,backend:n}=t,{dy:r,y:a}=e;ze([r,a],"eluGrad");const i=new Float32Array(me(a.shape)),o=n.data.get(a.dataId).values,s=n.data.get(r.dataId).values;for(let l=0;l<o.length;++l){const u=o[l];u>=1?i[l]=s[l]:i[l]=s[l]*(u+1)}return n.makeTensorInfo(a.shape,"float32",i)}const Wge={kernelName:q3,backendName:"cpu",kernelFunc:Vge};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const jge=WI,Uge=jI,Gge=UI,Hge=GI,qge=HI,Kge=qI,Xge=Kt(Rf,t=>{const e=Math.sign(t),n=Math.abs(t),r=1/(1+jge*n);return e*(1-((((Kge*r+qge)*r+Hge)*r+Gge)*r+Uge)*r*Math.exp(-n*n))}),Yge={kernelName:Rf,backendName:"cpu",kernelFunc:Xge};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function t2(t){const{inputs:e,backend:n,attrs:r}=t,{input:a}=e,{dim:i}=r,o=a.shape.length,s=a.shape.slice();let l=i;return i<0&&(V(-(o+1)<=i,()=>`Axis must be in the interval [${-(o+1)}, ${o}]`),l=o+i+1),s.splice(l,0,1),dn({inputs:{x:a},backend:n,attrs:{shape:s}})}const Qge={kernelName:tv,backendName:"cpu",kernelFunc:t2};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Zge=Xn((t,e)=>t/e),T4=fr(Of,Zge),I4={kernelName:Of,backendName:"cpu",kernelFunc:T4};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function k9(t,e,n){const r=t.shape,a=r[0],i=r[1],o=n.data.get(t.dataId),s=o.complexTensorInfos.real,l=o.complexTensorInfos.imag,u=[a,i],c=me(u),d=tr("float32",c),p=tr("float32",c);for(let x=0;x<a;x++){const b=cc({inputs:{x:s},backend:n,attrs:{begin:[x,0],size:[1,i]}}),v=cc({inputs:{x:l},backend:n,attrs:{begin:[x,0],size:[1,i]}}),w=ja({inputs:{real:b,imag:v},backend:n}),{real:S,imag:C}=Jge(w,e,n),I=Ms(S,C);for(let _=0;_<i;_++){const E=KI(I,_);d[x*i+_]=E.real,p[x*i+_]=E.imag}n.disposeIntermediateTensorInfo(b),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(w)}const f=n.makeTensorInfo(u,"float32",d),g=n.makeTensorInfo(u,"float32",p),y=ja({inputs:{real:f,imag:g},backend:n});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(g),y}function Jge(t,e,n){const r=me(t.shape),a=n.data.get(t.dataId),i=n.data.get(a.complexTensorInfos.real.dataId).values,o=n.data.get(a.complexTensorInfos.imag.dataId).values;if(e0e(r)){const s=E4(i,o,r,e,n),l=[t.shape[0],t.shape[1]];if(e){const u=n.makeTensorInfo(l,"float32",s.real),c=n.makeTensorInfo(l,"float32",s.imag),d=n.makeTensorInfo([],"float32",Ss(r,"float32")),p=zo({inputs:{x:d},backend:n}),f=I4.kernelFunc({inputs:{a:u,b:d},backend:n}),g=I4.kernelFunc({inputs:{a:c,b:p},backend:n}),y=n.data.get(f.dataId).values,x=n.data.get(g.dataId).values;return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(g),{real:y,imag:x}}return s}else{const s=Ms(i,o),l=t0e(s,r,e);return FL(l)}}function e0e(t){return(t&t-1)===0}function E4(t,e,n,r,a){if(n===1)return{real:t,imag:e};const i=Ms(t,e),o=n/2,s=BL(i),l=s.real,u=s.imag,c=[l.length],d=a.makeTensorInfo(c,"float32",l),p=a.makeTensorInfo(c,"float32",u),f=ja({inputs:{real:d,imag:p},backend:a}),g=zL(i),y=g.real,x=g.imag,b=[y.length],v=a.makeTensorInfo(b,"float32",y),w=a.makeTensorInfo(b,"float32",x),S=ja({inputs:{real:v,imag:w},backend:a}),C=E4(l,u,o,r,a),I=C.real,_=C.imag,E=[I.length],A=a.makeTensorInfo(E,"float32",I),M=a.makeTensorInfo(E,"float32",_),L=ja({inputs:{real:A,imag:M},backend:a}),W=E4(y,x,o,r,a),B=W.real,K=W.imag,X=[B.length],Q=a.makeTensorInfo(X,"float32",B),H=a.makeTensorInfo(X,"float32",K),F=ja({inputs:{real:Q,imag:H},backend:a}),Y=WL(n,r),Z=[Y.real.length],ne=a.makeTensorInfo(Z,"float32",Y.real),se=a.makeTensorInfo(Z,"float32",Y.imag),ce=ja({inputs:{real:ne,imag:se},backend:a}),le=Jx({inputs:{a:ce,b:F},backend:a}),ye=ip({inputs:{a:L,b:le},backend:a}),we=C4({inputs:{a:L,b:le},backend:a}),q=uc({inputs:{input:ye},backend:a}),ie=uc({inputs:{input:we},backend:a}),de=lp({inputs:{input:ye},backend:a}),ke=lp({inputs:{input:we},backend:a}),Ne=up({inputs:[q,ie],backend:a,attrs:{axis:0}}),Ie=up({inputs:[de,ke],backend:a,attrs:{axis:0}}),De=a.data.get(Ne.dataId).values,He=a.data.get(Ie.dataId).values;return a.disposeIntermediateTensorInfo(d),a.disposeIntermediateTensorInfo(p),a.disposeIntermediateTensorInfo(f),a.disposeIntermediateTensorInfo(v),a.disposeIntermediateTensorInfo(w),a.disposeIntermediateTensorInfo(S),a.disposeIntermediateTensorInfo(A),a.disposeIntermediateTensorInfo(M),a.disposeIntermediateTensorInfo(L),a.disposeIntermediateTensorInfo(Q),a.disposeIntermediateTensorInfo(H),a.disposeIntermediateTensorInfo(F),a.disposeIntermediateTensorInfo(ne),a.disposeIntermediateTensorInfo(se),a.disposeIntermediateTensorInfo(ce),a.disposeIntermediateTensorInfo(le),a.disposeIntermediateTensorInfo(ye),a.disposeIntermediateTensorInfo(we),a.disposeIntermediateTensorInfo(q),a.disposeIntermediateTensorInfo(de),a.disposeIntermediateTensorInfo(ie),a.disposeIntermediateTensorInfo(ke),a.disposeIntermediateTensorInfo(Ne),a.disposeIntermediateTensorInfo(Ie),{real:De,imag:He}}function t0e(t,e,n){const r=new Float32Array(e*2);for(let a=0;a<e;a++){let i=0,o=0;for(let s=0;s<e;s++){const l=jL(a*s,e,n),u=KI(t,s);i+=u.real*l.real-u.imag*l.imag,o+=u.real*l.imag+u.imag*l.real}n&&(i/=e,o/=e),VL(r,i,o,a)}return r}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function n0e(t){const{inputs:e,backend:n}=t,{input:r}=e,a=me(r.shape),i=r.shape[r.shape.length-1],o=a/i,s=dn({inputs:{x:r},backend:n,attrs:{shape:[o,i]}}),l=k9(s,!1,n),u=dn({inputs:{x:l},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(l),u}const r0e={kernelName:nv,backendName:"cpu",kernelFunc:n0e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function _4(t){const{backend:e,attrs:n}=t,{shape:r,value:a,dtype:i}=n,o=i||Ld(a),s=nr(o,me(r));return i0e(s,a,o),e.makeTensorInfo(r,o,s)}const a0e={kernelName:rv,backendName:"cpu",kernelFunc:_4};function i0e(t,e,n){t.fill(e)}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const o0e={kernelName:av,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:r}=t,a=n,i=tr(r.dtype,me(r.shape)),[o,s,l,u]=r.shape,c=a.data.get(r.dataId).values;for(let d=0;d<o;d++){const p=d*l*s*u;for(let f=0;f<s;f++){const g=f*(l*u);for(let y=0;y<l;y++){const x=y*u;for(let b=0;b<u;b++){const v=Math.round(l-y-1),w=p+g+x+b;let S=c[w];if(v>=0&&v<l){const C=v*u,I=p+g+C+b;S=c[I]}i[w]=S}}}}return{dataId:a.write(i,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const s0e=Xn((t,e)=>Math.floor(t/e)),l0e=fr(Lf,s0e,null,"int32"),u0e={kernelName:Lf,backendName:"cpu",kernelFunc:l0e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function c0e(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,filter:i,bias:o,preluActivationWeights:s}=e,{strides:l,pad:u,dataFormat:c,dilations:d,dimRoundingMode:p,activation:f,leakyreluAlpha:g}=r;let y=x9({inputs:{x:a,filter:i},backend:n,attrs:{strides:l,pad:u,dataFormat:c,dilations:d,dimRoundingMode:p}});if(o){const x=y;if(c==="NCHW"&&o.shape.length===1&&o.shape[0]!==1){const b=dn({inputs:{x:o},backend:n,attrs:{shape:[o.shape[0],1,1]}});y=ip({inputs:{a:y,b},backend:n}),n.disposeIntermediateTensorInfo(b)}else y=ip({inputs:{a:y,b:o},backend:n});n.disposeIntermediateTensorInfo(x)}if(f){const x=y;if(c==="NCHW"&&f==="prelu"&&s.shape.length===1&&s.shape[0]!==1){const b=dn({inputs:{x:s},backend:n,attrs:{shape:[s.shape[0],1,1]}});y=e2(n,y,f,b,g),n.disposeIntermediateTensorInfo(b)}else y=e2(n,y,f,s,g);n.disposeIntermediateTensorInfo(x)}return y}const d0e={kernelName:km,backendName:"cpu",kernelFunc:c0e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function p0e(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,filter:i,bias:o,preluActivationWeights:s}=e,{strides:l,pad:u,dataFormat:c,dilations:d,dimRoundingMode:p,activation:f,leakyreluAlpha:g}=r;let y=w9({inputs:{x:a,filter:i},backend:n,attrs:{strides:l,pad:u,dataFormat:c,dilations:d,dimRoundingMode:p}});if(o){const x=y;y=ip({inputs:{a:y,b:o},backend:n}),n.disposeIntermediateTensorInfo(x)}if(f){const x=y;y=e2(n,y,f,s,g),n.disposeIntermediateTensorInfo(x)}return y}const h0e={kernelName:Sm,backendName:"cpu",kernelFunc:p0e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function f0e(t){const{inputs:e,backend:n}=t,{params:r,indices:a}=e,i=me(r.shape),o=a.shape,s=o[o.length-1],[l,u,c,d]=xx(r,a);if(u===0)return n.makeTensorInfo(l,r.dtype,[]);const p=n.data.get(a.dataId).values,f=n.bufferSync(r),g=$F(p,f,r.dtype,u,s,c,d,r.shape,i);return n.makeTensorInfo(l,r.dtype,g.values)}const m0e={kernelName:sv,backendName:"cpu",kernelFunc:f0e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function g0e(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,indices:i}=e,{axis:o,batchDims:s}=r;ze([a,i],"gatherV2");const l=Pt(o,a.shape)[0],u=n.data.get(i.dataId).values,c=a.shape[l];for(let S=0;S<u.length;++S){const C=u[S];V(C<=c-1&&C>=0,()=>`GatherV2: the index value ${C} is not in [0, ${c-1}]`)}let d=s;s==null&&(d=0);const p=me(i.shape),f=r4(a,i,l,d),g=dn({inputs:{x:a},backend:n,attrs:{shape:[f.batchSize,f.outerSize,f.dimSize,f.sliceSize]}}),y=dn({inputs:{x:i},backend:n,attrs:{shape:[f.batchSize,p/f.batchSize]}}),x=[f.batchSize,f.outerSize,p/f.batchSize,f.sliceSize],b=n.bufferSync(y),v=n.bufferSync(g),w=RF(v,b,x);return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(y),n.makeTensorInfo(f.outputShape,w.dtype,w.values)}const y0e={kernelName:ov,backendName:"cpu",kernelFunc:g0e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function b0e(t){const{inputs:e,backend:n}=t,{input:r}=e,a=me(r.shape),i=r.shape[r.shape.length-1],o=a/i,s=dn({inputs:{x:r},backend:n,attrs:{shape:[o,i]}}),l=k9(s,!0,n),u=dn({inputs:{x:l},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(l),u}const v0e={kernelName:lv,backendName:"cpu",kernelFunc:b0e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const x0e=Kt(Vf,t=>Number.isFinite(t)?1:0,"bool"),w0e={kernelName:Vf,backendName:"cpu",kernelFunc:x0e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const k0e=Kt(Wf,t=>Math.abs(t)===1/0?1:0,"bool"),S0e={kernelName:Wf,backendName:"cpu",kernelFunc:k0e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const C0e=Kt(jf,t=>Number.isNaN(t)?1:0,"bool"),N0e={kernelName:jf,backendName:"cpu",kernelFunc:C0e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function T0e(t){const{backend:e,attrs:n}=t,{start:r,stop:a,num:i}=n,o=LF(r,a,i);return e.makeTensorInfo([o.length],"float32",o)}const I0e={kernelName:dv,backendName:"cpu",kernelFunc:T0e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const E0e=Kt(qf,t=>Math.log1p(t)),_0e={kernelName:qf,backendName:"cpu",kernelFunc:E0e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const O0e=Xn((t,e)=>t&&e),$0e=fr(Kf,O0e,null,"bool"),R0e={kernelName:Kf,backendName:"cpu",kernelFunc:$0e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const M0e=Kt(Xf,t=>t?0:1,"bool"),A0e={kernelName:Xf,backendName:"cpu",kernelFunc:M0e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const P0e=Xn((t,e)=>t||e),D0e=fr(Yf,P0e,null,"bool"),L0e={kernelName:Yf,backendName:"cpu",kernelFunc:D0e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function F0e(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{depthRadius:i,bias:o,alpha:s,beta:l}=r;ze(a,"LRN");const u=a.shape[3],c=u-1,d=n.data.get(a.dataId).values,p=me(a.shape),f=new Float32Array(p);function g(y){const x=y%u;let b=y-x+Math.max(0,x-i);const v=y-x+Math.min(x+i,c);let w=0;for(;b<=v;b++){const S=d[b];w+=S*S}return w}for(let y=0;y<p;y++){const x=g(y),b=d[y]*Math.pow(o+s*x,-l);f[y]=b}return n.makeTensorInfo(a.shape,a.dtype,f)}const B0e={kernelName:pv,backendName:"cpu",kernelFunc:F0e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function z0e(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,y:i,dy:o}=e,{depthRadius:s,bias:l,alpha:u,beta:c}=r;ze(o,"LRNGrad");const d=me(o.shape),p=o.shape[3],f=n.data.get(o.dataId).values,g=n.data.get(a.dataId).values,y=n.data.get(i.dataId).values,x=new Float32Array(d),b=d;for(let v=0;v<b;v++){const w=v%p,S=v-w+Math.max(0,w-s),C=v-w+Math.min(p,w+s+1);let I=0;for(let _=S;_<C;_++)I+=Math.pow(g[_],2);I=u*I+l;for(let _=S;_<C;_++){let E=-2*u*c*g[_]*y[v]/I;v===_&&(E+=Math.pow(I,-c)),E*=f[v],x[_]+=E}}return n.makeTensorInfo(o.shape,a.dtype,x)}const V0e={kernelName:K3,backendName:"cpu",kernelFunc:z0e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function S9(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{reductionIndices:i,keepDims:o}=r,s=n;let l=a.shape;const u=l.length,c=Pt(i,l);let d=c;const p=jn(d,u);let f=s.data.get(a.dataId).values;if(p!=null){const S=new Array(u);for(let C=0;C<S.length;C++)S[C]=l[p[C]];f=k4(f,l,a.dtype,p,S),d=Un(d.length,u),l=S}ze(a,"max"),Tr("max",d,u);const[g,y]=Nr(l,d),x=me(y),b=BF(f,x,g,a.dtype),v=s.write(b,g,a.dtype);let w=g;return o&&(w=ar(g,c)),{dataId:v,shape:w,dtype:a.dtype}}const W0e={kernelName:hv,backendName:"cpu",kernelFunc:S9};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function j0e(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e;ze(a,"maxPool");const{filterSize:i,strides:o,pad:s,dimRoundingMode:l}=r,u=1;V(jr(o,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${u}'`);const c=Ii(a.shape,i,o,u,s,l);let d;if(c.filterWidth===1&&c.filterHeight===1&&tn(c.inShape,c.outShape))d=zo({inputs:{x:a},backend:n});else{const p=n.data.get(a.dataId).values,f=qe(a.shape),g=N4(p,a.shape,a.dtype,f,c,"max");d=n.makeTensorInfo(c.outShape,a.dtype,g.values)}return d}const U0e={kernelName:fv,backendName:"cpu",kernelFunc:j0e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function G0e(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{filterSize:i,strides:o,pad:s,dimRoundingMode:l,dataFormat:u}=r;ze(a,"maxPool3d");const c=_s(a.shape,i,o,1,s,l,u),d=n.data.get(a.dataId).values,p=v9(d,a.shape,a.dtype,qe(a.shape),c,"max");return n.makeTensorInfo(p.shape,"float32",p.values)}const H0e={kernelName:mv,backendName:"cpu",kernelFunc:G0e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function q0e(t){const{inputs:e,backend:n,attrs:r}=t,{dy:a,input:i}=e,{filterSize:o,strides:s,pad:l,dimRoundingMode:u}=r;ze([a,i],"maxPool3DGrad");const c=_s(i.shape,o,s,1,l,u),d=n.bufferSync(i),p=Ame(d,c),f=c.strideDepth,g=c.strideHeight,y=c.strideWidth,x=c.dilationDepth,b=c.dilationHeight,v=c.dilationWidth,w=c.effectiveFilterDepth,S=c.effectiveFilterHeight,C=c.effectiveFilterWidth,I=w-1-c.padInfo.front,_=C-1-c.padInfo.left,E=S-1-c.padInfo.top,A=pt(i.shape,"float32"),M=n.bufferSync(a);for(let L=0;L<c.batchSize;++L)for(let W=0;W<c.inChannels;++W)for(let B=0;B<c.inDepth;++B)for(let K=0;K<c.inHeight;++K)for(let X=0;X<c.inWidth;++X){const Q=B-I,H=K-E,F=X-_;let Y=0;for(let Z=0;Z<w;Z+=x){const ne=(Q+Z)/f;if(!(ne<0||ne>=c.outDepth||Math.floor(ne)!==ne))for(let se=0;se<S;se+=b){const ce=(H+se)/g;if(!(ce<0||ce>=c.outHeight||Math.floor(ce)!==ce))for(let le=0;le<C;le+=v){const ye=(F+le)/y;if(ye<0||ye>=c.outWidth||Math.floor(ye)!==ye)continue;const we=w*S*C-1-p.get(L,ne,ce,ye,W),q=Z*S*C+se*C+le,ie=we===q?1:0;if(ie===0)continue;const de=M.get(L,ne,ce,ye,W);Y+=de*ie}}}A.set(Y,L,B,K,X,W)}return n.makeTensorInfo(A.shape,A.dtype,A.values)}const K0e={kernelName:Y3,backendName:"cpu",kernelFunc:q0e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function X0e(t){const{inputs:e,backend:n,attrs:r}=t,{dy:a,input:i,output:o}=e,s=i;ze([i,o],"maxPoolGrad");const{filterSize:l,strides:u,pad:c,dimRoundingMode:d}=r,p=Ii(s.shape,l,u,1,c,d),f=n.data.get(s.dataId).values,g=pt(p.outShape,s.dtype,b9(f,s.shape,s.dtype,p).values),y=p.strideHeight,x=p.strideWidth,b=p.dilationHeight,v=p.dilationWidth,w=p.effectiveFilterHeight,S=p.effectiveFilterWidth,C=S-1-p.padInfo.left,I=w-1-p.padInfo.top,_=pt(s.shape,"float32"),E=n.data.get(a.dataId).values,A=pt(a.shape,"float32",E);for(let M=0;M<p.batchSize;++M)for(let L=0;L<p.inChannels;++L)for(let W=0;W<p.inHeight;++W)for(let B=0;B<p.inWidth;++B){const K=W-I,X=B-C;let Q=0;for(let H=0;H<w;H+=b){const F=(K+H)/y;if(!(F<0||F>=p.outHeight||Math.floor(F)!==F))for(let Y=0;Y<S;Y+=v){const Z=(X+Y)/x;if(Z<0||Z>=p.outWidth||Math.floor(Z)!==Z)continue;const ne=w*S-1-g.get(M,F,Z,L),se=H*S+Y,ce=ne===se?1:0;if(ce===0)continue;const le=A.get(M,F,Z,L);Q+=le*ce}}_.set(Q,M,W,B,L)}return n.makeTensorInfo(_.shape,_.dtype,_.values)}const Y0e={kernelName:X3,backendName:"cpu",kernelFunc:X0e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Q0e(t,e,n,r,a){const i=qe(e),o=N4(t,e,n,i,a,"max"),s=b9(t,e,n,a,!0,r);return[o.values,s.values]}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Z0e={kernelName:gv,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:r}=t,{filterSize:a,strides:i,pad:o,includeBatchInIndex:s}=e,l=n;ze(r,"MaxPoolWithArgmax");const u=l.data.get(r.dataId).values,c=Ii(r.shape,a,i,[1,1],o),[d,p]=Q0e(u,r.shape,r.dtype,s,c),f=l.write(d,c.outShape,r.dtype),g=l.write(p,c.outShape,r.dtype);return[{dataId:f,shape:c.outShape,dtype:r.dtype},{dataId:g,shape:c.outShape,dtype:"int32"}]}};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function J0e(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:i,keepDims:o}=r,s=Pt(i,a.shape),l=Nr(a.shape,s)[1],u=me(l),c=[],d=n.makeTensorInfo([],"float32",new Float32Array([u]));c.push(d);const p=Ul({inputs:{x:a},backend:n,attrs:{dtype:"float32"}});c.push(p);const f=T4({inputs:{a:p,b:d},backend:n});c.push(f);const g=Zm({inputs:{x:f},backend:n,attrs:{axis:i,keepDims:o}});return c.forEach(y=>n.disposeIntermediateTensorInfo(y)),g}const e1e={kernelName:yv,backendName:"cpu",kernelFunc:J0e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function t1e(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:i,keepDims:o}=r;ze(a,"min");const s=Pt(i,a.shape);let l=s;const u=jn(l,a.shape.length);let c=a;u!=null&&(c=Sa({inputs:{x:a},backend:n,attrs:{perm:u}}),l=Un(l.length,a.shape.length)),Tr("min",l,c.shape.length);const[d,p]=Nr(c.shape,l),f=me(p),g=Cr(me(d),c.dtype),y=n.data.get(c.dataId).values;for(let b=0;b<g.length;++b){const v=b*f;let w=y[v];for(let S=0;S<f;++S){const C=y[v+S];(Number.isNaN(C)||C<w)&&(w=C)}g[b]=w}u!=null&&n.disposeIntermediateTensorInfo(c);const x=n.makeTensorInfo(d,c.dtype,g);if(o){const b=ar(d,s),v=dn({inputs:{x},backend:n,attrs:{shape:b}});return n.disposeIntermediateTensorInfo(x),v}return x}const n1e={kernelName:bv,backendName:"cpu",kernelFunc:t1e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function r1e(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{paddings:i,mode:o}=r;ze(a,"mirrorPad");const s=i.map((v,w)=>v[0]+a.shape[w]+v[1]),l=i.map(v=>v[0]),u=i.map((v,w)=>v[0]+a.shape[w]),c=o==="reflect"?0:1,d=n.data.get(a.dataId).values,p=a.shape.length,f=qe(a.shape),g=me(s),y=s.length,x=qe(s),b=tr(a.dtype,g);for(let v=0;v<g;v++){let w=Hu(v,y,x);for(let C=0;C<y;C++)w[C]<l[C]?w[C]=l[C]*2-w[C]-c:w[C]>=u[C]&&(w[C]=(u[C]-1)*2-w[C]+c);w=w.map((C,I)=>C-l[I]);const S=io(w,p,f);b[v]=d[S]}return{dataId:n.write(b,s,a.dtype),shape:s,dtype:a.dtype}}const a1e={kernelName:vv,backendName:"cpu",kernelFunc:r1e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const i1e=Xn((t,e)=>{const n=t%e;return t<0&&e<0||t>=0&&e>=0?n:(n+e)%e}),o1e=fr(Jf,i1e),s1e={kernelName:Jf,backendName:"cpu",kernelFunc:o1e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function C9(t){const{inputs:e,backend:n,attrs:r}=t,{logits:a}=e,{dim:i}=r,o=a.shape.length;let s=i;if(s===-1&&(s=o-1),s!==o-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${o} and dim was ${s}`);const l=Pt([s],a.shape),u=S9({inputs:{x:a},backend:n,attrs:{reductionIndices:l,keepDims:!1}}),c=ar(u.shape,l),d=dn({inputs:{x:u},backend:n,attrs:{shape:c}}),p=C4({inputs:{a,b:d},backend:n}),f=EF({inputs:{x:p},backend:n}),g=Zm({inputs:{x:f},backend:n,attrs:{axis:l,keepDims:!1}}),y=dn({inputs:{x:g},backend:n,attrs:{shape:c}}),x=T4({inputs:{a:f,b:y},backend:n});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(y),x}const l1e={kernelName:Hv,backendName:"cpu",kernelFunc:C9};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function u1e(t){const{inputs:e,backend:n,attrs:r}=t,{logits:a}=e,{numSamples:i,seed:o,normalized:s}=r;ze(a,"multinomial");const l=s?a:C9({inputs:{logits:a},backend:n,attrs:{dim:-1}}),u=l.shape[0],c=l.shape[1],d=n.data.get(l.dataId).values,p=[u,i],f=Cr(me(p),"int32");for(let g=0;g<u;++g){const y=g*c,x=new Float32Array(c-1);x[0]=d[y];for(let w=1;w<x.length;++w)x[w]=x[w-1]+d[y+w];const b=_x.alea(o.toString()),v=g*i;for(let w=0;w<i;++w){const S=b();f[v+w]=x.length;for(let C=0;C<x.length;C++)if(S<x[C]){f[v+w]=C;break}}}return s||n.disposeIntermediateTensorInfo(l),n.makeTensorInfo(p,"int32",f)}const c1e={kernelName:xv,backendName:"cpu",kernelFunc:u1e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const d1e=Fx;function p1e(t){const{inputs:e,backend:n,attrs:r}=t,{boxes:a,scores:i}=e,{maxOutputSize:o,iouThreshold:s,scoreThreshold:l}=r;ze(a,"NonMaxSuppression");const u=n.data.get(a.dataId).values,c=n.data.get(i.dataId).values,{selectedIndices:d}=d1e(u,c,o,s,l);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}const h1e={kernelName:kv,backendName:"cpu",kernelFunc:p1e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const f1e=Bx;function m1e(t){const{inputs:e,backend:n,attrs:r}=t,{boxes:a,scores:i}=e,{maxOutputSize:o,iouThreshold:s,scoreThreshold:l,padToMaxOutputSize:u}=r;ze(a,"NonMaxSuppressionPadded");const c=n.data.get(a.dataId).values,d=n.data.get(i.dataId).values,{selectedIndices:p,validOutputs:f}=f1e(c,d,o,s,l,u);return[n.makeTensorInfo([p.length],"int32",new Int32Array(p)),n.makeTensorInfo([],"int32",new Int32Array([f]))]}const g1e={kernelName:Sv,backendName:"cpu",kernelFunc:m1e};/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const y1e=zx;function b1e(t){const{inputs:e,backend:n,attrs:r}=t,{boxes:a,scores:i}=e,{maxOutputSize:o,iouThreshold:s,scoreThreshold:l,softNmsSigma:u}=r;ze(a,"NonMaxSuppressionWithScore");const c=n.data.get(a.dataId).values,d=n.data.get(i.dataId).values,p=o,f=s,g=l,y=u,{selectedIndices:x,selectedScores:b}=y1e(c,d,p,f,g,y);return[n.makeTensorInfo([x.length],"int32",new Int32Array(x)),n.makeTensorInfo([b.length],"float32",new Float32Array(b))]}const v1e={kernelName:Cv,backendName:"cpu",kernelFunc:b1e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function x1e(t){const{inputs:e,backend:n,attrs:r}=t,{indices:a}=e,{dtype:i,depth:o,onValue:s,offValue:l}=r;ze(a,"oneHot");const u=me(a.shape),c=new Float32Array(u*o);c.fill(l);const d=n.data.get(a.dataId).values;for(let p=0;p<u;++p)d[p]>=0&&d[p]<o&&(c[p*o+d[p]]=s);return n.makeTensorInfo([...a.shape,o],i,c)}const w1e={kernelName:Tv,backendName:"cpu",kernelFunc:x1e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function n2(t){const{inputs:e,backend:n}=t,{x:r}=e;if(r.dtype==="string")throw new Error("zerosLike is not supported for string tensors");if(r.dtype==="complex64"){const a=uc({inputs:{input:r},backend:n}),i=n2({inputs:{x:a},backend:n}),o=lp({inputs:{input:r},backend:n}),s=n2({inputs:{x:o},backend:n}),l=ja({inputs:{real:i,imag:s},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(s),l}else return _4({backend:n,attrs:{shape:r.shape,value:0,dtype:r.dtype}})}const k1e={kernelName:sx,backendName:"cpu",kernelFunc:n2};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function N9(t){const{inputs:e,backend:n}=t,{x:r}=e;if(r.dtype==="string")throw new Error("onesLike is not supported for string tensors");if(r.dtype==="complex64"){const a=uc({inputs:{input:r},backend:n}),i=N9({inputs:{x:a},backend:n}),o=lp({inputs:{input:r},backend:n}),s=n2({inputs:{x:o},backend:n}),l=ja({inputs:{real:i,imag:s},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(s),l}else return _4({backend:n,attrs:{shape:r.shape,value:1,dtype:r.dtype}})}const S1e={kernelName:Nv,backendName:"cpu",kernelFunc:N9};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function T9(t){const{inputs:e,backend:n,attrs:r}=t,{axis:a}=r;if(e.length===1)return t2({inputs:{input:e[0]},backend:n,attrs:{dim:a}});const i=e[0].shape,o=e[0].dtype;e.forEach(c=>{Sr(i,c.shape,"All tensors passed to stack must have matching shapes"),V(o===c.dtype,()=>"All tensors passed to stack must have matching dtypes")});const s=[],l=e.map(c=>{const d=t2({inputs:{input:c},backend:n,attrs:{dim:a}});return s.push(d),d}),u=up({inputs:l,backend:n,attrs:{axis:a}});return s.forEach(c=>n.disposeIntermediateTensorInfo(c)),u}const C1e={kernelName:Iv,backendName:"cpu",kernelFunc:T9};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function N1e(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{paddings:i,constantValue:o}=r;ze(a,"pad");const s=i.map((b,v)=>b[0]+a.shape[v]+b[1]),l=i.map(b=>b[0]),u=n.data.get(a.dataId).values,c=me(a.shape),d=a.shape.length,p=qe(a.shape),f=me(s),g=s.length,y=qe(s),x=tr(a.dtype,f);o!==0&&x.fill(o);for(let b=0;b<c;b++){const v=Hu(b,d,p).map((S,C)=>S+l[C]),w=io(v,g,y);x[w]=u[b]}return{dataId:n.write(x,s,a.dtype),shape:s,dtype:a.dtype}}const I9={kernelName:Ev,backendName:"cpu",kernelFunc:N1e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const T1e=Xn((t,e)=>Math.pow(t,e)),I1e=fr(nm,T1e),E1e={kernelName:nm,backendName:"cpu",kernelFunc:I1e};/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function _1e(t){const{inputs:e,backend:n,attrs:r}=t,{paramsNestedSplits:a,paramsDenseValues:i,indices:o}=e,s=a.map(x=>n.data.get(x.dataId).values),l=a.map(x=>x.shape),u=n.data.get(i.dataId).values,c=n.data.get(o.dataId).values,[d,p,f]=HF(s,l,u,i.shape,i.dtype,c,o.shape),g=d.map(x=>n.makeTensorInfo([x.length],"int32",x)),y=n.makeTensorInfo(f,i.dtype,p);return g.concat([y])}const O1e={kernelName:$v,backendName:"cpu",kernelFunc:_1e};/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function $1e(t){const{inputs:e,backend:n,attrs:r}=t,{shape:a,values:i,defaultValue:o,rowPartitionTensors:s}=e,{rowPartitionTypes:l}=r,u=n.data.get(a.dataId).values,c=n.data.get(i.dataId).values,d=n.data.get(o.dataId).values,p=s.map(x=>n.data.get(x.dataId).values),f=s.map(x=>x.shape),[g,y]=XF(u,a.shape,c,i.shape,i.dtype,d,o.shape,p,f,l);return n.makeTensorInfo(g,i.dtype,y)}const R1e={kernelName:Rv,backendName:"cpu",kernelFunc:$1e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function M1e(t){const{backend:e,attrs:n}=t,{start:r,stop:a,dtype:i,step:o}=n,s=YF(r,a,o,i);return e.makeTensorInfo([s.length],i,s)}const A1e={kernelName:Mv,backendName:"cpu",kernelFunc:M1e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const P1e=Kt(rm,t=>1/t),D1e={kernelName:rm,backendName:"cpu",kernelFunc:P1e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function L1e(t){const{inputs:e,backend:n,attrs:r}=t,{images:a}=e,{alignCorners:i,halfPixelCenters:o,size:s}=r;ze(a,"resizeBilinear");const l=qe(a.shape),[u,c]=s,[d,p,f,g]=a.shape,y=n.data.get(a.dataId).values,x=new Float32Array(me([d,u,c,g])),b=[i&&u>1?p-1:p,i&&c>1?f-1:f],v=[i&&u>1?u-1:u,i&&c>1?c-1:c];let w=0;const S=b[0]/v[0],C=b[1]/v[1];for(let I=0;I<d;I++)for(let _=0;_<u;_++){let E;o?E=S*(_+.5)-.5:E=S*_;const A=Math.max(0,Math.floor(E)),M=E-A,L=Math.min(p-1,Math.ceil(E)),W=I*l[0]+A*l[1],B=I*l[0]+L*l[1];for(let K=0;K<c;K++){let X;o?X=C*(K+.5)-.5:X=C*K;const Q=Math.max(0,Math.floor(X)),H=X-Q,F=Math.min(f-1,Math.ceil(X)),Y=W+Q*l[2],Z=B+Q*l[2],ne=W+F*l[2],se=B+F*l[2];for(let ce=0;ce<g;ce++){const le=y[Y+ce],ye=y[Z+ce],we=y[ne+ce],q=y[se+ce],ie=le+(we-le)*H,de=ye+(q-ye)*H,ke=ie+(de-ie)*M;x[w++]=ke}}}return n.makeTensorInfo([d,u,c,g],"float32",x)}const F1e={kernelName:Lv,backendName:"cpu",kernelFunc:L1e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function B1e(t){const{inputs:e,backend:n,attrs:r}=t,{images:a,dy:i}=e,{alignCorners:o}=r;ze([i,a],"resizeBilinearGrad");const s=qe(a.shape),[l,u,c,d]=a.shape,[,p,f]=i.shape,g=new Float32Array(l*u*c*d),y=[o&&p>1?u-1:u,o&&f>1?c-1:c],x=[o&&p>1?p-1:p,o&&f>1?f-1:f],b=y[0]/x[0],v=y[1]/x[1],w=n.data.get(i.dataId).values;let S=0;for(let C=0;C<l;C++){const I=C*s[0];for(let _=0;_<p;_++){const E=_*b,A=Math.floor(E),M=Math.min(Math.ceil(E),u-1),L=I+A*s[1],W=I+M*s[1],B=E-A,K=1-B;for(let X=0;X<f;X++){const Q=X*v,H=Math.floor(Q),F=Math.min(Math.ceil(Q),c-1),Y=Q-H,Z=1-Y,ne=L+H*s[2],se=L+F*s[2],ce=W+H*s[2],le=W+F*s[2],ye=K*Z,we=K*Y,q=B*Z,ie=B*Y;for(let de=0;de<d;de++){const ke=w[S++];g[ne+de]+=ke*ye,g[se+de]+=ke*we,g[ce+de]+=ke*q,g[le+de]+=ke*ie}}}}return n.makeTensorInfo([l,c,u,d],"float32",g)}const z1e={kernelName:Z3,backendName:"cpu",kernelFunc:B1e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function V1e(t){const{inputs:e,backend:n,attrs:r}=t,{images:a}=e,{alignCorners:i,halfPixelCenters:o,size:s}=r;ze(a,"resizeNearestNeighbor");const l=qe(a.shape),[u,c]=s,[d,p,f,g]=a.shape,y=n.data.get(a.dataId).values,x=new Float32Array(d*u*c*g),b=[i&&u>1?p-1:p,i&&c>1?f-1:f],v=[i&&u>1?u-1:u,i&&c>1?c-1:c],w=b[0]/v[0],S=b[1]/v[1];let C=0;for(let I=0;I<d;I++){const _=I*l[0];for(let E=0;E<u;E++){const A=o?w*(E+.5):w*E;let M=Math.min(p-1,i?Math.round(A):Math.floor(A));o&&(M=Math.max(0,M));const L=_+M*l[1];for(let W=0;W<c;W++){const B=o?S*(W+.5):S*W;let K=Math.min(f-1,i?Math.round(B):Math.floor(B));o&&(K=Math.max(0,K));const X=L+K*l[2];for(let Q=0;Q<g;Q++){const H=y[X+Q];x[C++]=H}}}}return n.makeTensorInfo([d,u,c,g],a.dtype,x)}const W1e={kernelName:Dv,backendName:"cpu",kernelFunc:V1e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function j1e(t){const{inputs:e,backend:n,attrs:r}=t,{images:a,dy:i}=e,{alignCorners:o}=r;ze([i,a],"resizeNearestNeighborGrad");const s=qe(a.shape),l=qe(i.shape),[u,c,d,p]=a.shape,[,f,g]=i.shape,y=new Float32Array(u*c*d*p),x=n.data.get(i.dataId).values,b=[o&&f>1?c-1:c,o&&g>1?d-1:d],v=[o&&f>1?f-1:f,o&&g>1?g-1:g],w=b[0]/v[0],S=b[1]/v[1],C=1/w,I=1/S,_=Math.ceil(C)*2+2,E=Math.ceil(I)*2+2;for(let A=0;A<u;A++){const M=A*s[0];for(let L=0;L<c;L++){const W=M+L*s[1],B=Math.floor(L*C),K=Math.floor(B-_/2);for(let X=0;X<d;X++){const Q=W+X*s[2],H=Math.floor(X*I),F=Math.floor(H-E/2);for(let Y=0;Y<p;Y++){let Z=0;for(let ne=0;ne<_;ne++){const se=ne+K;if(se<0||se>=f)continue;const ce=M+se*l[1],le=se*w,ye=Math.min(c-1,o?Math.round(le):Math.floor(le));if(L===ye)for(let we=0;we<E;we++){const q=we+F;if(q<0||q>=g)continue;const ie=ce+q*l[2],de=q*S,ke=Math.min(d-1,o?Math.round(de):Math.floor(de));X===ke&&(Z+=x[ie+Y])}}y[Q+Y]=Z}}}}return n.makeTensorInfo(a.shape,a.dtype,y)}const U1e={kernelName:Q3,backendName:"cpu",kernelFunc:j1e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function G1e(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{dims:i}=r;ze(a,"reverse");const o=a.shape.length,s=Pt(i,a.shape);if(o===0)return zo({inputs:{x:a},backend:n});const l=new rr(a.shape,a.dtype),u=n.bufferSync(a);for(let c=0;c<l.size;c++){const d=l.indexToLoc(c),p=d.slice();s.forEach(f=>p[f]=a.shape[f]-1-p[f]),l.set(u.get(...p),...d)}return n.makeTensorInfo(l.shape,l.dtype,l.values)}const H1e={kernelName:Fv,backendName:"cpu",kernelFunc:G1e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const q1e={kernelName:ux,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:r}=t,{radians:a,fillValue:i,center:o}=e,s=n,l=tr(r.dtype,me(r.shape)),[u,c,d,p]=r.shape,[f,g]=LI(o,c,d),y=255,x=Math.sin(a),b=Math.cos(a),v=s.data.get(r.dataId).values;for(let w=0;w<u;w++){const S=w*d*c*p;for(let C=0;C<c;C++){const I=C*(d*p);for(let _=0;_<d;_++){const E=_*p;for(let A=0;A<p;A++){const M=[u,C,_,A],L=M[2],W=M[1];let B=(L-f)*b-(W-g)*x,K=(L-f)*x+(W-g)*b;B=Math.round(B+f),K=Math.round(K+g);let X=i;if(typeof i!="number"&&(A===3?X=y:X=i[A]),B>=0&&B<d&&K>=0&&K<c){const H=K*(d*p),F=B*p,Y=S+H+F+A;X=v[Y]}const Q=S+I+E+A;l[Q]=X}}}}return{dataId:s.write(l,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const K1e=Kt(om,t=>{const e=Math.floor(t);return t-e<.5?Math.floor(t):t-e>.5?Math.ceil(t):e%2===0?e:e+1}),X1e={kernelName:om,backendName:"cpu",kernelFunc:K1e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Y1e(t){const{inputs:e,backend:n,attrs:r}=t,{indices:a,updates:i}=e,{shape:o}=r,{sliceRank:s,numUpdates:l,sliceSize:u,strides:c,outputSize:d}=qd(i,a,o),p=!0,f=n.bufferSync(a),g=n.bufferSync(i),y=sp(f,g,o,d,u,l,s,c,0,p);return n.makeTensorInfo(o,y.dtype,y.values)}const Q1e={kernelName:Bv,backendName:"cpu",kernelFunc:Y1e};/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Z1e(t,e){let n=0,r=t.length,a=0;for(;n<r;)a=Math.floor((n+r)/2),t[a]<e?n=a+1:r=a;return r}function J1e(t,e){let n=0,r=t.length,a=0;for(;n<r;)a=Math.floor((n+r)/2),t[a]<=e?n=a+1:r=a;return r}function eye(t,e,n,r,a,i){const o=nr("int32",n*a);for(let s=0;s<n;++s){const l=t.slice(s*r,(s+1)*r),u=s*a;for(let c=0;c<a;++c)o[u+c]=i==="left"?Z1e(l,e[c+u]):J1e(l,e[c+u])}return o}/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function tye(t){const{inputs:e,backend:n,attrs:r}=t,{sortedSequence:a,values:i}=e,{side:o}=r,s=n.data.get(a.dataId).values,l=n.data.get(i.dataId).values,u=eye(s,l,a.shape[0],a.shape[1],i.shape[1],o);return n.makeTensorInfo(i.shape,"int32",u)}const nye={kernelName:zv,backendName:"cpu",kernelFunc:tye};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function rye(t){const{inputs:e,backend:n}=t,{condition:r,t:a,e:i}=e;ze([r,a,i],"select");const o=r.shape.length,s=n.data.get(r.dataId).values,l=n.data.get(a.dataId).values,u=n.data.get(i.dataId).values,c=ka(a.dtype,i.dtype),d=Cr(me(a.shape),c);let p=0;const f=o===0||o>1||a.shape.length===1?1:me(a.shape.slice(1));for(let g=0;g<s.length;g++)for(let y=0;y<f;y++)s[g]===1?d[p++]=l[g]:d[p++]=u[g];return n.makeTensorInfo(a.shape,c,d)}const aye={kernelName:Vv,backendName:"cpu",kernelFunc:rye};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const iye=zI,oye=VI,sye=Kt(lm,t=>t>=0?oye*t:iye*(Math.exp(t)-1)),lye={kernelName:lm,backendName:"cpu",kernelFunc:sye};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const uye=Kt(dm,t=>t<0?-1:t>0?1:0),cye={kernelName:dm,backendName:"cpu",kernelFunc:uye};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const dye=Kt(um,t=>Math.sin(t)),pye={kernelName:um,backendName:"cpu",kernelFunc:dye};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const hye=Kt(cm,t=>Math.sinh(t)),fye={kernelName:cm,backendName:"cpu",kernelFunc:hye};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const mye=11920928955078125e-23,E9=Math.log(mye)+2,gye=Kt(hm,t=>{const e=t>-E9,n=t<E9,r=Math.exp(t);let a;return n?a=r:e?a=t:a=Math.log(1+r),a}),yye={kernelName:hm,backendName:"cpu",kernelFunc:gye};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function bye(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{blockShape:i,paddings:o}=r;ze([a],"spaceToBatchND");const s=me(i),l=[[0,0]];l.push(...o);for(let x=1+i.length;x<a.shape.length;++x)l.push([0,0]);const u=I9.kernelFunc({inputs:{x:a},backend:n,attrs:{paddings:l,constantValue:0}}),c=qm(u.shape,i,s,!1),d=Km(c.length,i.length,!1),p=Xm(u.shape,i,s,!1),f=dn({inputs:{x:u},backend:n,attrs:{shape:c}}),g=Sa({inputs:{x:f},backend:n,attrs:{perm:d}}),y=dn({inputs:{x:g},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(g),y}const vye={kernelName:Uv,backendName:"cpu",kernelFunc:bye};/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function xye(t){const{inputs:e,backend:n}=t,{indices:r,values:a,denseShape:i,defaultValue:o}=e;if(i.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
        ${i.shape}`);if(r.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
        ${r.shape}`);if(a.shape.length!==1)throw new Error(`Values must be a vector, saw:
        ${a.shape}`);if(o.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${o.shape}`);const s=n.data.get(r.dataId).values,l=n.data.get(a.dataId).values,u=n.data.get(i.dataId).values,c=n.data.get(o.dataId).values[0],[d,p,f,g,y]=e9(s,r.shape,r.dtype,l,a.dtype,u,c);return[n.makeTensorInfo(p,r.dtype,d),n.makeTensorInfo([p[0]],a.dtype,f),n.makeTensorInfo([g.length],"bool",new Uint8Array(g.map(x=>Number(x)))),n.makeTensorInfo([y.length],r.dtype,new Int32Array(y))]}const wye={kernelName:qv,backendName:"cpu",kernelFunc:xye};/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function kye(t){const{inputs:e,backend:n}=t,{inputIndices:r,inputShape:a,newShape:i}=e;if(r.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape
        ${r.shape}`);if(a.shape.length!==1)throw new Error(`Input shape should be a vector but received shape
        ${a.shape}`);if(i.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${i.shape}`);const o=Array.from(n.data.get(a.dataId).values),s=n.data.get(r.dataId).values,l=Array.from(n.data.get(i.dataId).values),[u,c,d]=t9(s,r.shape,r.dtype,o,l);return[n.makeTensorInfo(c,r.dtype,u),n.makeTensorInfo([d.length],i.dtype,new Int32Array(d))]}const Sye={kernelName:Kv,backendName:"cpu",kernelFunc:kye};/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Cye(t){const{inputs:e,backend:n}=t,{data:r,indices:a,segmentIds:i}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(a.shape.length!==1)throw new Error(`Indices should be a vector but received shape
          ${a.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
          ${i.shape}`);if(a.shape[0]!==i.shape[0])throw new Error("segmentIds and indices should have same size.");const o=n.data.get(r.dataId).values,s=n.data.get(a.dataId).values,l=n.data.get(i.dataId).values,[u,c]=S4(o,r.shape,r.dtype,s,l,!0);return n.makeTensorInfo(c,r.dtype,u)}const Nye={kernelName:Xv,backendName:"cpu",kernelFunc:Cye};/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Tye(t){const{inputs:e,backend:n}=t,{data:r,indices:a,segmentIds:i}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(a.shape.length!==1)throw new Error(`Indices should be a vector but received shape
         ${a.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
         ${i.shape}`);if(a.shape[0]!==i.shape[0])throw new Error("segmentIds and indices should have same size.");const o=n.data.get(r.dataId).values,s=n.data.get(a.dataId).values,l=n.data.get(i.dataId).values,[u,c]=S4(o,r.shape,r.dtype,s,l);return n.makeTensorInfo(c,r.dtype,u)}const Iye={kernelName:Yv,backendName:"cpu",kernelFunc:Tye};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Eye(t){const{inputs:e,backend:n,attrs:r}=t,{sparseIndices:a,sparseValues:i,defaultValue:o}=e,{outputShape:s}=r,{sliceRank:l,numUpdates:u,sliceSize:c,strides:d,outputSize:p}=qd(i,a,s),f=!1,g=n.bufferSync(a);let y;switch(i.dtype){case"bool":{const x=n.bufferSync(i),b=!!n.data.get(o.dataId).values[0];y=sp(g,x,s,p,c,u,l,d,b,f);break}case"float32":{const x=n.bufferSync(i),b=n.data.get(o.dataId).values[0];y=sp(g,x,s,p,c,u,l,d,b,f);break}case"int32":{const x=n.bufferSync(i),b=n.data.get(o.dataId).values[0];y=sp(g,x,s,p,c,u,l,d,b,f);break}case"string":{const x=n.bufferSync(i),b=Cs(n.data.get(o.dataId).values[0]);y=sp(g,x,s,p,c,u,l,d,b,f);break}default:throw new Error(`Unsupported type ${i.dtype}`)}return n.makeTensorInfo(s,y.dtype,y.values)}const _ye={kernelName:Qv,backendName:"cpu",kernelFunc:Eye};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Oye(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{numOrSizeSplits:i,axis:o}=r,s=Pt(o,a.shape)[0],l=t4(a,i,s),u=new Array(a.shape.length).fill(0),c=a.shape.slice();return l.map(d=>{const p=[...c];p[s]=d;const f=cc({inputs:{x:a},backend:n,attrs:{begin:u,size:p}});return u[s]+=d,f})}const $ye={kernelName:Gv,backendName:"cpu",kernelFunc:Oye};/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Rye={kernelName:J3,backendName:"cpu",kernelFunc:({inputs:t,backend:e})=>{const{x:n}=t,r=e;ze(n,"square");const a=r.data.get(n.dataId).values,i=new Float32Array(a.length);for(let o=0;o<a.length;++o){const s=a[o];i[o]=s*s}return{dataId:r.write(i,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Mye=Kt(xm,(t,e)=>{const n=e;return isNaN(t)?NaN:t>0?1:n.alpha}),Aye={kernelName:xm,backendName:"cpu",kernelFunc:Mye};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Pye(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{begin:i,end:o,strides:s,beginMask:l,endMask:u,ellipsisMask:c,newAxisMask:d,shrinkAxisMask:p}=r;ze(a,"stridedSlice");const{finalShapeSparse:f,finalShape:g,isIdentity:y,sliceDim0:x,isSimpleSlice:b,begin:v,end:w,strides:S}=WT(a.shape,i,o,s,l,u,c,d,p);let C;if(y)C=dn({inputs:{x:a},backend:n,attrs:{shape:g}});else if(x||b){V(a.shape.length>=1,()=>`Input must have rank at least 1, got: ${a.shape.length}`);const I=FT(v,w,S),_=cc({inputs:{x:a},backend:n,attrs:{begin:v,size:I}});C=dn({inputs:{x:_},backend:n,attrs:{shape:g}}),n.disposeIntermediateTensorInfo(_)}else{const I=n.bufferSync(a),_=r9(f,I,S,v);C=n.makeTensorInfo(g,_.dtype,_.values)}return C}const Dye={kernelName:Zv,backendName:"cpu",kernelFunc:Pye};/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Lye(t){const{inputs:e,backend:n,attrs:r}=t,{separator:a,nGramWidths:i,leftPad:o,rightPad:s,padWidth:l,preserveShortSequences:u}=r,{data:c,dataSplits:d}=e,p=n.data.get(c.dataId).values,f=n.data.get(d.dataId).values,[g,y]=a9(p,f,a,i,o,s,l,u);return[n.makeTensorInfo([g.length],"string",g),n.makeTensorInfo(d.shape,"int32",y)]}const Fye={kernelName:Jv,backendName:"cpu",kernelFunc:Lye};/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Bye(t){const{inputs:e,backend:n,attrs:r}=t,{skipEmpty:a}=r,{input:i,delimiter:o}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(i.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${i.shape}`);if(o.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${o.shape}`);const s=n.data.get(i.dataId).values,l=n.data.get(o.dataId).values[0],[u,c,d]=i9(s,l,a),p=c.length;return[n.makeTensorInfo([p,2],"int32",u),n.makeTensorInfo([p],"string",c),n.makeTensorInfo([2],"int32",new Int32Array(d))]}const zye={kernelName:ex,backendName:"cpu",kernelFunc:Bye};/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Vye(t){const{inputs:e,backend:n,attrs:r}=t,{numBuckets:a}=r,{input:i}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(a<=0)throw new Error("Number of buckets must be at least 1");const o=n.data.get(i.dataId).values,s=o9(o,a);return n.makeTensorInfo(i.shape,"int32",s)}const Wye={kernelName:tx,backendName:"cpu",kernelFunc:Vye};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const jye=Kt(ym,t=>Math.tan(t)),Uye={kernelName:ym,backendName:"cpu",kernelFunc:jye};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Gye=Kt(bm,t=>Math.tanh(t)),Hye={kernelName:bm,backendName:"cpu",kernelFunc:Gye};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function qye(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{reps:i}=r;ze(a,"tile");const o=l9(n.bufferSync(a),i);return n.makeTensorInfo(o.shape,o.dtype,o.values)}const Kye={kernelName:vm,backendName:"cpu",kernelFunc:qye};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Xye(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{k:i,sorted:o}=r;ze(a,"topk");const s=n.data.get(a.dataId).values,[l,u]=c9(s,a.shape,a.dtype,i,o);return[n.makeTensorInfo(l.shape,l.dtype,l.values),n.makeTensorInfo(u.shape,u.dtype,u.values)]}const Yye={kernelName:nx,backendName:"cpu",kernelFunc:Xye};/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Qye(t){const{inputs:e,attrs:n,backend:r}=t,{image:a,transforms:i}=e,{interpolation:o,fillMode:s,fillValue:l,outputShape:u}=n,[c,d,p,f]=a.shape,[g,y]=u??[d,p],x=[c,g,y,f],b=qe(a.shape),v=b[0],w=b[1],S=b[2],C=qe(x),I=C[0],_=C[1],E=C[2],A=tr(a.dtype,me(x));A.fill(l);const M=r.data.get(a.dataId).values,L=r.data.get(i.dataId).values;for(let W=0;W<c;++W){const B=i.shape[0]===1?L:L.subarray(W*8,W*8+8);for(let K=0;K<g;++K)for(let X=0;X<y;++X)for(let Q=0;Q<f;++Q){let H;const F=B[6]*X+B[7]*K+1;if(F===0)continue;const Y=(B[0]*X+B[1]*K+B[2])/F,Z=(B[3]*X+B[4]*K+B[5])/F,ne=_9(Y,p,s),se=_9(Z,d,s);switch(o){case"nearest":H=rbe(M,d,p,v,w,S,W,se,ne,Q,l);break;case"bilinear":H=abe(M,d,p,v,w,S,W,se,ne,Q,l);break;default:throw new Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${o}`)}const ce=W*I+K*_+X*E+Q;A[ce]=H}return r.makeTensorInfo(x,a.dtype,A)}return{dataId:r.write(A,x,a.dtype),shape:a.shape,dtype:a.dtype}}const Zye={kernelName:rx,backendName:"cpu",kernelFunc:Qye};function _9(t,e,n){switch(n){case"reflect":return Jye(t,e);case"wrap":return ebe(t,e);case"nearest":return nbe(t,e);case"constant":default:return tbe(t)}}function Jye(t,e){let n=t;if(n<0)if(e<=1)n=0;else{const r=2*e;n<r&&(n=r*Math.trunc(-n/r)+n),n=n<-e?n+r:-n-1}else if(n>e-1)if(e<=1)n=0;else{const r=2*e;n-=r*Math.trunc(n/r),n>=e&&(n=r-n-1)}return _l(0,n,e-1)}function ebe(t,e){let n=t;if(n<0)if(e<=1)n=0;else{const r=e-1;n+=e*(Math.trunc(-n/r)+1)}else if(n>e-1)if(e<=1)n=0;else{const r=e-1;n-=e*Math.trunc(n/r)}return _l(0,n,e-1)}function tbe(t,e){return t}function nbe(t,e){return _l(0,t,e-1)}function Jm(t,e,n,r,a,i,o,s,l,u,c){const d=o*r+s*a+l*i+u;return 0<=s&&s<e&&0<=l&&l<n?t[d]:c}function rbe(t,e,n,r,a,i,o,s,l,u,c){const d=Math.round(s),p=Math.round(l);return Jm(t,e,n,r,a,i,o,d,p,u,c)}function abe(t,e,n,r,a,i,o,s,l,u,c){const d=Math.floor(s),p=Math.floor(l),f=d+1,g=p+1,y=(g-l)*Jm(t,e,n,r,a,i,o,d,p,u,c)+(l-p)*Jm(t,e,n,r,a,i,o,d,g,u,c),x=(g-l)*Jm(t,e,n,r,a,i,o,f,p,u,c)+(l-p)*Jm(t,e,n,r,a,i,o,f,g,u,c);return(f-s)*y+(s-d)*x}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function ibe(t){const{inputs:e,attrs:n,backend:r}=t,{axis:a}=n,{x:i}=e;ze(i,"unique");const o=r.data.get(i.dataId).values,{outputValues:s,outputShape:l,indices:u}=d9(o,a,i.shape,i.dtype);return[r.makeTensorInfo(l,i.dtype,s),r.makeTensorInfo([u.length],"int32",u)]}const obe={kernelName:ax,backendName:"cpu",kernelFunc:ibe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function sbe(t){const{inputs:e,backend:n,attrs:r}=t,{value:a}=e;let{axis:i}=r;i<0&&(i+=a.shape.length);const o=a.shape.length,s=a.shape[i],l=new Array(o-1);let u=0;for(let f=0;f<o;f++)f!==i&&(l[u++]=a.shape[f]);const c=new Array(o).fill(0),d=a.shape.slice();d[i]=1;const p=new Array(s);for(let f=0;f<p.length;f++){c[i]=f;const g=cc({inputs:{x:a},backend:n,attrs:{begin:c,size:d}});p[f]=dn({inputs:{x:g},backend:n,attrs:{shape:l}}),n.disposeIntermediateTensorInfo(g)}return p}const lbe={kernelName:ix,backendName:"cpu",kernelFunc:sbe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function ube(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,segmentIds:i}=e,{numSegments:o}=r;ze(a,"unsortedSegmentSum");const s=a.shape.length,l=i.shape.length,u=[],c=[],d=s-l;let p=i;for(let g=0;g<d;++g){const y=t2({inputs:{input:p},backend:n,attrs:{dim:g+1}});p=y,c.push(y)}for(let g=0;g<o;++g){const y=Ss(g,"int32"),x=n.makeTensorInfo([],"int32",y),b=TF({inputs:{a:x,b:p},backend:n}),v=Ul({inputs:{x:b},backend:n,attrs:{dtype:"float32"}}),w=Jx({inputs:{a:v,b:a},backend:n}),S=Zm({inputs:{x:w},backend:n,attrs:{axis:0,keepDims:!1}});u.push(S),c.push(x),c.push(b),c.push(v),c.push(w),c.push(S)}const f=T9({inputs:u,backend:n,attrs:{axis:0}});return c.forEach(g=>n.disposeIntermediateTensorInfo(g)),f}const cbe={kernelName:ox,backendName:"cpu",kernelFunc:ube};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const dbe=[lme,Khe,cme,pme,efe,fme,gme,bme,xme,kme,Cme,Tme,Eme,$me,Mme,Dme,Fme,zme,Wme,ome,Ume,Hme,Kme,Yme,Zhe,nfe,Zme,Xhe,ege,nge,rge,ige,sge,uge,dge,hge,mge,yge,vge,wge,Sge,Nge,Ige,Ege,Oge,Rge,Age,Pge,Dge,Lge,zge,Jfe,Wge,rfe,Yge,afe,Qge,ofe,r0e,a0e,o0e,lfe,u0e,d0e,h0e,m0e,y0e,cfe,pfe,Yhe,v0e,tge,w0e,S0e,N0e,eme,ffe,gfe,I0e,bfe,_0e,R0e,A0e,L0e,B0e,V0e,W0e,xfe,U0e,H0e,K0e,Y0e,Z0e,e1e,n1e,kfe,a1e,s1e,c1e,Cfe,Tfe,h1e,g1e,v1e,Efe,w1e,S1e,C1e,I9,E1e,nme,$fe,O1e,R1e,A1e,Qhe,I4,D1e,rme,ame,ime,F1e,z1e,W1e,U1e,H1e,q1e,X1e,Bfe,Q1e,nye,aye,lye,Vfe,cye,pye,fye,Wfe,l1e,yye,vye,wye,Sye,Nye,Iye,_ye,$ye,Gfe,Rye,qfe,Aye,Dye,Fye,zye,Wye,Qfe,Fge,Uye,Hye,Kye,Yye,Zye,_fe,obe,lbe,cbe,k1e];for(const t of dbe)px(t);/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const dc={},r2={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function pbe(t,e){dc[t]=e}function co(t,e){if(!(t in dc)||e!=null){const r=fbe(t,e);if(r!==null)dc[t]=r;else return console.log("Could not get context for WebGL version",t),null}const n=dc[t];return n==null||n.isContextLost()?(delete dc[t],co(t)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),dc[t])}function hbe(t){if(typeof OffscreenCanvas<"u"&&t===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function fbe(t,e){if(t!==1&&t!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const n=e??hbe(t);return n.addEventListener("webglcontextlost",r=>{r.preventDefault(),delete dc[t]},!1),ue().getBool("SOFTWARE_WEBGL_ENABLED")&&(r2.failIfMajorPerformanceCaveat=!1),t===1?n.getContext("webgl",r2)||n.getContext("experimental-webgl",r2):n.getContext("webgl2",r2)}/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/var eg;(function(t){t[t.DENSE=0]="DENSE",t[t.SHARED_BATCH=1]="SHARED_BATCH"})(eg||(eg={}));var ii;(function(t){t[t.RENDER=0]="RENDER",t[t.UPLOAD=1]="UPLOAD",t[t.PIXELS=2]="PIXELS",t[t.DOWNLOAD=3]="DOWNLOAD"})(ii||(ii={}));var Ir;(function(t){t[t.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",t[t.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",t[t.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",t[t.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",t[t.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(Ir||(Ir={}));function tg(t,e){return[e,t]}function mbe(t,e){return t*e}function a2(t){const e=me(t),n=Math.ceil(e/4);return xb(n)}function cp(t,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(t/2))]}function gbe(t,e){const[n,r]=cp(t,e);return n*r*4}function O4(t,e){const n=t;let r,a,i,o,s,l,u,c,d,p;return ue().getNumber("WEBGL_VERSION")===2?(r=n.R32F,a=n.R16F,i=n.RGBA16F,o=n.RGBA32F,s=n.RED,u=4,c=1,d=n.HALF_FLOAT,p=n.FLOAT,l=n.RGBA8):(r=t.RGBA,a=t.RGBA,i=t.RGBA,o=n.RGBA,s=t.RGBA,u=4,c=4,d=e!=null?e.HALF_FLOAT_OES:null,p=t.FLOAT,l=t.RGBA),{internalFormatFloat:r,internalFormatHalfFloat:a,internalFormatPackedHalfFloat:i,internalFormatPackedFloat:o,textureFormatFloat:s,downloadTextureFormat:l,downloadUnpackNumChannels:u,defaultNumChannels:c,textureTypeHalfFloat:d,textureTypeFloat:p}}/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Ve(t,e){const n=e();return ue().getBool("DEBUG")&&ybe(t),n}function ybe(t){const e=t.getError();if(e!==t.NO_ERROR)throw new Error("WebGL Error: "+wbe(t,e))}const bbe=596e-10,vbe=65504;function xbe(t){return!!(ue().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||t===0||bbe<Math.abs(t)&&Math.abs(t)<vbe)}function wbe(t,e){switch(e){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case t.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${e}`}}function i2(t,e){return Ps(t,()=>t.getExtension(e),'Extension "'+e+'" not supported on this browser.')}function kbe(t,e){const n=Ps(t,()=>t.createShader(t.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(Ve(t,()=>t.shaderSource(n,e)),Ve(t,()=>t.compileShader(n)),t.getShaderParameter(n,t.COMPILE_STATUS)===!1)throw console.log(t.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}function Sbe(t,e){const n=Ps(t,()=>t.createShader(t.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(Ve(t,()=>t.shaderSource(n,e)),Ve(t,()=>t.compileShader(n)),ue().get("ENGINE_COMPILE_ONLY"))return n;if(t.getShaderParameter(n,t.COMPILE_STATUS)===!1)throw O9(e,t.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}const Cbe=/ERROR: [0-9]+:([0-9]+):/g;function O9(t,e){const n=Cbe.exec(e);if(n==null){console.log(`Couldn't parse line number in error: ${e}`),console.log(t);return}const r=+n[1],a=t.split(`
`),i=a.length.toString().length+2,o=a.map((d,p)=>Gu((p+1).toString(),i)+d);let s=0;for(let d=0;d<o.length;d++)s=Math.max(o[d].length,s);const l=o.slice(0,r-1),u=o.slice(r-1,r),c=o.slice(r);console.log(l.join(`
`)),console.log(e.split(`
`)[0]),console.log(`%c ${Gu(u[0],s)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(c.join(`
`))}function Nbe(t){return Ps(t,()=>t.createProgram(),"Unable to create WebGLProgram.")}function Tbe(t,e){if(Ve(t,()=>t.linkProgram(e)),!ue().get("ENGINE_COMPILE_ONLY")&&t.getProgramParameter(e,t.LINK_STATUS)===!1)throw console.log(t.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}function $4(t,e){if(Ve(t,()=>t.validateProgram(e)),t.getProgramParameter(e,t.VALIDATE_STATUS)===!1)throw console.log(t.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function Ibe(t,e){const n=Ps(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return Ve(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),Ve(t,()=>t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW)),n}function Ebe(t,e){const n=Ps(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return Ve(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n)),Ve(t,()=>t.bufferData(t.ELEMENT_ARRAY_BUFFER,e,t.STATIC_DRAW)),n}function _be(t){return Ps(t,()=>t.createTexture(),"Unable to create WebGLTexture.")}function Obe(t,e){const n=ue().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t<=0||e<=0){const r=`[${t}x${e}]`;throw new Error("Requested texture size "+r+" is invalid.")}if(t>n||e>n){const r=`[${t}x${e}]`,a=`[${n}x${n}]`;throw new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU "+a+".")}}function $be(t){return Ps(t,()=>t.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function $9(t,e,n,r,a,i,o){const s=t.getAttribLocation(e,n);return s===-1?!1:(Ve(t,()=>t.bindBuffer(t.ARRAY_BUFFER,r)),Ve(t,()=>t.vertexAttribPointer(s,a,t.FLOAT,!1,i,o)),Ve(t,()=>t.enableVertexAttribArray(s)),!0)}function Rbe(t,e,n){Lbe(t,n),Ve(t,()=>t.activeTexture(t.TEXTURE0+n)),Ve(t,()=>t.bindTexture(t.TEXTURE_2D,e))}function Mbe(t,e,n){return Ps(t,()=>t.getUniformLocation(e,n),'uniform "'+n+'" not present in program.')}function Abe(t,e,n){return t.getUniformLocation(e,n)}function Pbe(t,e,n,r){Ve(t,()=>Rbe(t,e,r)),Ve(t,()=>t.uniform1i(n,r))}function R4(t,e,n){Ve(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,n)),Ve(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0))}function R9(t,e){Ve(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,e)),Ve(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0))}function o2(t){const e=t.checkFramebufferStatus(t.FRAMEBUFFER);if(e!==t.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+Dbe(t,e))}function Dbe(t,e){switch(e){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case t.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${e}`}}function Ps(t,e,n){const r=Ve(t,()=>e());if(r==null)throw new Error(n);return r}function Lbe(t,e){const n=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=e+t.TEXTURE0;if(r<t.TEXTURE0||r>n){const a=`[gl.TEXTURE0, gl.TEXTURE${n}]`;throw new Error(`textureUnit must be in ${a}.`)}}function dp(t,e=2){return me(t.slice(0,t.length-e))}function pp(t){if(t.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[t.length>1?t[t.length-2]:1,t[t.length-1]]}function M4(t){let e=[1,1,1];return t.length===0||t.length===1&&t[0]===1||(e=[dp(t),...pp(t)]),e}function Fbe(t,e=!1){let n=ue().getNumber("WEBGL_MAX_TEXTURE_SIZE"),r=ue().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");r===1/0&&ue().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(r=n/2),e&&(n=n*2,r=r*2,t=t.map((s,l)=>l>=t.length-2?vb(t[l]):t[l]),t.length===1&&(t=[2,t[0]])),t.length!==2&&(t=ks(t).newShape);let a=me(t),i=null;t.length<=1&&a<=n?i=[1,a]:t.length===2&&t[0]<=n&&t[1]<=n?i=t:t.length===3&&t[0]*t[1]<=n&&t[2]<=n?i=[t[0]*t[1],t[2]]:t.length===3&&t[0]<=n&&t[1]*t[2]<=n?i=[t[0],t[1]*t[2]]:t.length===4&&t[0]*t[1]*t[2]<=n&&t[3]<=n?i=[t[0]*t[1]*t[2],t[3]]:t.length===4&&t[0]<=n&&t[1]*t[2]*t[3]<=n&&(i=[t[0],t[1]*t[2]*t[3]]);const o=i!=null&&Math.max(...i)>r&&Math.min(...i)<=(e?2:1)&&Math.min(...i)>0;if(i==null||o)if(e){const s=dp(t);let l=2,u=2;t.length&&([l,u]=pp(t)),a=s*(l/2)*(u/2),i=xb(a).map(c=>c*2)}else i=xb(a);return i}function s2(t){return t%2===0}function l2(t,e){if(t=t.slice(-2),e=e.slice(-2),tn(t,e)||!t.length||!e.length||t[0]===0||t[1]===0||e[0]===0||e[1]===0)return!0;if(t.length!==e.length){const n=t.slice(-1)[0],r=e.slice(-1)[0];if(n===r||s2(n)&&s2(r)&&(t[0]===1||e[0]===1))return!0}return t[1]===e[1]&&s2(t[0])&&s2(e[0])}let A4,P4;function Bbe(t){if(A4==null){const e=co(t);A4=e.getParameter(e.MAX_TEXTURE_SIZE)}return A4}function zbe(t){if(P4==null){const e=co(t);P4=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,P4)}function Vbe(t){if(t===0)return 0;let e;const n=co(t);return Ai(n,"EXT_disjoint_timer_query_webgl2")&&t===2?e=2:Ai(n,"EXT_disjoint_timer_query")?e=1:e=0,e}function Ai(t,e){return t.getExtension(e)!=null}function M9(t){try{if(co(t)!=null)return!0}catch(e){return console.log("Error when getting WebGL context: ",e),!1}return!1}function Wbe(t){if(t===0)return!1;const e=co(t);if(t===1){if(!Ai(e,"OES_texture_float"))return!1}else if(!Ai(e,"EXT_color_buffer_float"))return!1;return D4(e)}function jbe(t){if(t===0)return!1;const e=co(t);if(t===1){if(!Ai(e,"OES_texture_float")||!Ai(e,"WEBGL_color_buffer_float"))return!1}else{if(Ai(e,"EXT_color_buffer_float"))return D4(e);const n="EXT_color_buffer_half_float";if(Ai(e,n)){const r=e.getExtension(n);return Ube(e,r)}return!1}return D4(e)}function D4(t){const e=O4(t),n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n),t.texImage2D(t.TEXTURE_2D,0,e.internalFormatFloat,1,1,0,e.textureFormatFloat,e.textureTypeFloat,null);const i=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,i),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0);const o=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(n),t.deleteFramebuffer(i),o}function Ube(t,e){const n=O4(t,e),r=t.createTexture();t.bindTexture(t.TEXTURE_2D,r),t.texImage2D(t.TEXTURE_2D,0,n.internalFormatHalfFloat,1,1,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);const o=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,o),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0);const s=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(r),t.deleteFramebuffer(o),s}function Gbe(t){return t!==2?!1:co(t).fenceSync!=null}function ng(t,e){Array.isArray(t)||(t=[t]),t.forEach(n=>{n!=null&&V(n.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the WebGL backend.`)})}/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Ue=ue();Ue.registerFlag("HAS_WEBGL",()=>Ue.getNumber("WEBGL_VERSION")>0),Ue.registerFlag("WEBGL_VERSION",()=>M9(2)?2:M9(1)?1:0),Ue.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1),Ue.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>Ue.get("WEBGL_VERSION")===2),Ue.registerFlag("WEBGL_CPU_FORWARD",()=>!0),Ue.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1),Ue.registerFlag("WEBGL_PACK",()=>Ue.getBool("HAS_WEBGL")),Ue.registerFlag("WEBGL_PACK_NORMALIZATION",()=>Ue.getBool("WEBGL_PACK")),Ue.registerFlag("WEBGL_PACK_CLIP",()=>Ue.getBool("WEBGL_PACK")),Ue.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>Ue.getBool("WEBGL_PACK")),Ue.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>Ue.getBool("WEBGL_PACK")),Ue.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>Ue.getBool("WEBGL_PACK")),Ue.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>Ue.getBool("WEBGL_PACK")),Ue.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>Ue.getBool("WEBGL_PACK")),Ue.registerFlag("WEBGL_PACK_REDUCE",()=>Ue.getBool("WEBGL_PACK")),Ue.registerFlag("WEBGL_LAZILY_UNPACK",()=>Ue.getBool("WEBGL_PACK")),Ue.registerFlag("WEBGL_CONV_IM2COL",()=>Ue.getBool("WEBGL_PACK")),Ue.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>Bbe(Ue.getNumber("WEBGL_VERSION"))),Ue.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>zbe(Ue.getNumber("WEBGL_VERSION"))),Ue.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const t=Ue.getNumber("WEBGL_VERSION");return t===0?0:Vbe(t)}),Ue.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>Ue.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!fT()),Ue.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>Wbe(Ue.getNumber("WEBGL_VERSION"))),Ue.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>Ue.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:Ue.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")),Ue.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>jbe(Ue.getNumber("WEBGL_VERSION"))),Ue.registerFlag("WEBGL_FENCE_API_ENABLED",()=>Gbe(Ue.getNumber("WEBGL_VERSION"))),Ue.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>Ue.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0),Ue.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,t=>{if(t<0&&t!==-1)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${t}.`)}),Ue.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>fT()?1:-1,t=>{if(t<0&&t!==-1)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${t}.`)}),Ue.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128),Ue.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1),Ue.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5),Ue.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128),Ue.registerFlag("WEBGL_EXP_CONV",()=>!1),Ue.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>Ue.getBool("IS_TEST")),Ue.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0),Ue.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1),Ue.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1);/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function la(){let t,e,n,r,a,i,o,s,l,u;return ue().getNumber("WEBGL_VERSION")===2?(t="#version 300 es",e="in",n="out",r="in",a="texture",i="outputColor",o="out vec4 outputColor;",s=ue().getBool("WEBGL2_ISNAN_CUSTOM")?`
      bool isnan_custom(float val) {
        uint floatToUint = floatBitsToUint(val);
        return (floatToUint & 0x7fffffffu) > 0x7f800000u;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `:"",l="",u=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(t="",e="attribute",n="varying",r="varying",a="texture2D",i="gl_FragColor",o="",s=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,l=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,u=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:t,attribute:e,varyingVs:n,varyingFs:r,texture2D:a,output:i,defineOutput:o,defineSpecialNaN:s,defineSpecialInf:l,defineRound:u}}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function pc(t,e,n="index"){const r=qe(e);return r.map((a,i)=>{const o=`int ${t[i]} = ${n} / ${a}`,s=i===r.length-1?`int ${t[i+1]} = ${n} - ${t[i]} * ${a}`:`index -= ${t[i]} * ${a}`;return`${o}; ${s};`}).join("")}function u2(t,e,n="index"){const r=qe(e);return r.map((a,i)=>{const o=`int ${t[i]} = ${n} / outShapeStrides[${i}]`,s=i===r.length-1?`int ${t[i+1]} = ${n} - ${t[i]} * outShapeStrides[${i}]`:`index -= ${t[i]} * outShapeStrides[${i}]`;return`${o}; ${s};`}).join("")}function Hbe(t,e){const n=t.length,r=t.map(i=>`${e}[${i}]`),a=new Array(n-1);a[n-2]=r[n-1];for(let i=n-3;i>=0;--i)a[i]=`(${a[i+1]} * ${r[i+1]})`;return a}function qbe(t,e,n="index"){const r=t.map((i,o)=>o),a=Hbe(r,e);return a.map((i,o)=>{const s=`int ${t[o]} = ${n} / ${a[o]}`,l=o===a.length-1?`int ${t[o+1]} = ${n} - ${t[o]} * ${a[o]}`:`index -= ${t[o]} * ${a[o]}`;return`${s}; ${l};`}).join("")}function L4(t){const e=qe(t).map(n=>n.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${e[0]} + coords.y * ${e[1]} + coords.z;
  }
`}function F4(){return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`}const A9=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const{getBroadcastDims:P9}=oF;function Kbe(t,e,n){const r=[];if(t.forEach(p=>{const f=me(p.shapeInfo.logicalShape);if(p.shapeInfo.isUniform?r.push(`uniform float ${p.name}${f>1?`[${f}]`:""};`):(r.push(`uniform sampler2D ${p.name};`),r.push(`uniform int offset${p.name};`)),n.enableShapeUniforms){const{uniformShape:g}=B4(n.packedInputs,p.shapeInfo.logicalShape,p.shapeInfo.texShape);switch(g.length){case 1:r.push(`uniform int ${p.name}Shape;`);break;case 2:r.push(`uniform ivec2 ${p.name}Shape;`);break;case 3:r.push(`uniform ivec3 ${p.name}Shape;`);break;case 4:r.push(`uniform ivec4 ${p.name}Shape;`);break}r.push(`uniform ivec2 ${p.name}TexShape;`)}}),n.enableShapeUniforms){switch(e.logicalShape.length){case 1:r.push("uniform int outShape;");break;case 2:r.push("uniform ivec2 outShape;"),r.push("uniform int outShapeStrides;");break;case 3:r.push("uniform ivec3 outShape;"),r.push("uniform ivec2 outShapeStrides;");break;case 4:r.push("uniform ivec4 outShape;"),r.push("uniform ivec3 outShapeStrides;");break}r.push("uniform ivec2 outTexShape;")}n.customUniforms&&n.customUniforms.forEach(p=>{r.push(`uniform ${p.type} ${p.name}${p.arrayIndex?`[${p.arrayIndex}]`:""};`)});const a=r.join(`
`),i=t.map(p=>Xbe(p,e,n.packedInputs,n.enableShapeUniforms)).join(`
`),o=e.texShape,s=la(),l=Zbe(s);let u,c,d=tve(s);return e.isPacked?(u=Ybe(e.logicalShape,o,n.enableShapeUniforms),c=eve(s)):(u=Qbe(e.logicalShape,o,n.enableShapeUniforms),c=Jbe(s)),n.packedInputs&&(d+=ive),[d,l,c,a,u,i,n.userCode].join(`
`)}function hp(t,e=!1){const n=t.shapeInfo.logicalShape;switch(n.length){case 0:return yve(t,e);case 1:return vve(t,e);case 2:return wve(t,e);case 3:return Sve(t,e);case 4:return Nve(t,e);case 5:return Tve(t);case 6:return Ive(t);default:throw new Error(`${n.length}-D input sampling is not yet supported`)}}function D9(t,e){switch(t.shapeInfo.logicalShape.length){case 0:return gve(t);case 1:return bve(t,e);case 2:return xve(t,e);case 3:return kve(t,e);default:return Cve(t,e)}}function Xbe(t,e,n=!1,r){let a="";n?a+=D9(t,r):a+=hp(t,r);const i=t.shapeInfo.logicalShape,o=e.logicalShape;return i.length<=o.length&&(n?a+=Eve(t,e):a+=_ve(t,e)),a}function Ybe(t,e,n){switch(t.length){case 0:return L9();case 1:return ove(t,e,n);case 2:return fve(t,e,n);case 3:return lve(t,e,n);default:return cve(t,e,n)}}function Qbe(t,e,n){switch(t.length){case 0:return L9();case 1:return sve(t,e,n);case 2:return mve(t,e,n);case 3:return uve(t,e,n);case 4:return dve(t,e,n);case 5:return pve(t,e);case 6:return hve(t,e);default:throw new Error(`${t.length}-D output sampling is not yet supported`)}}function Zbe(t){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return ${t.texture2D}(textureSampler, uv).r;
    }
  `}function Jbe(t){return`
    void setOutput(float val) {
      ${t.output} = vec4(val, 0, 0, 0);
    }
  `}function eve(t){return`
    void setOutput(vec4 val) {
      ${t.output} = val;
    }
  `}function tve(t){return`${t.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${t.varyingFs} vec2 resultUV;
    ${t.defineOutput}
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    ${t.defineSpecialNaN}
    ${t.defineSpecialInf}
    ${t.defineRound}

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${nve}
    ${rve}
    ${ave}
  `}const nve=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,rve=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,ave=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,ive=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function L9(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function ove(t,e,n){const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];return r[0]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ${r[1]}.0);
      }
    `:r[1]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ${r[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      return 2 * (resTexRC.x * ${r[1]} + resTexRC.y);
    }
  `}function sve(t,e,n){return e[0]===1?n?`
      int getOutputCoords() {
        return int(resultUV.x * float(outTexShape[1]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.x * ${e[1]}.0);
      }
    `:e[1]===1?n?`
      int getOutputCoords() {
        return int(resultUV.y * float(outTexShape[0]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.y * ${e[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      return resTexRC.x * outTexShape[1] + resTexRC.y;
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      return resTexRC.x * ${e[1]} + resTexRC.y;
    }
  `}function lve(t,e,n){if(n)return`
    ivec3 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec3(b, r, c);
    }
  `;const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],a=Math.ceil(t[2]/2),i=a*Math.ceil(t[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      int index = resTexRC.x * ${r[1]} + resTexRC.y;

      int b = index / ${i};
      index -= b * ${i};

      int r = 2 * (index / ${a});
      int c = imod(index, ${a}) * 2;

      return ivec3(b, r, c);
    }
  `}function uve(t,e,n){if(n)return`
  ivec3 getOutputCoords() {
    ivec2 resTexRC = ivec2(resultUV.yx *
                           vec2(outTexShape[0], outTexShape[1]));
    int index = resTexRC.x * outTexShape[1] + resTexRC.y;
    ${u2(["r","c","d"],t)}
    return ivec3(r, c, d);
  }
`;const r=pc(["r","c","d"],t);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${r}
      return ivec3(r, c, d);
    }
  `}function cve(t,e,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatchN = texelsInBatch * outShape[1];

      int b2 = index / texelsInBatchN;
      index -= b2 * texelsInBatchN;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec4(b2, b, r, c);
    }
  `;const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],a=Math.ceil(t[t.length-1]/2),i=a*Math.ceil(t[t.length-2]/2);let o=i,s="",l="b, r, c";for(let u=2;u<t.length-1;u++)o*=t[t.length-u-1],s=`
      int b${u} = index / ${o};
      index -= b${u} * ${o};
    `+s,l=`b${u}, `+l;return`
    ivec${t.length} getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      int index = resTexRC.x * ${r[1]} + resTexRC.y;

      ${s}

      int b = index / ${i};
      index -= b * ${i};

      int r = 2 * (index / ${a});
      int c = imod(index, ${a}) * 2;

      return ivec${t.length}(${l});
    }
  `}function dve(t,e,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      ${u2(["r","c","d","d2"],t)}
      return ivec4(r, c, d, d2);
    }
  `;const r=pc(["r","c","d","d2"],t);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${r}
      return ivec4(r, c, d, d2);
    }
  `}function pve(t,e){const n=pc(["r","c","d","d2","d3"],t);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${e[0]},
                             ${e[1]}));

      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${n}

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}function hve(t,e){const n=pc(["r","c","d","d2","d3","d4"],t);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${n}

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}function fve(t,e,n){const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(tn(t,e))return n?`
      ivec2 getOutputCoords() {
        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(${r[0]}, ${r[1]}));
      }
    `;const a=Math.ceil(t[1]/2);return n?`
    ivec2 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));

      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;
      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));

      int index = resTexRC.x * ${r[1]} + resTexRC.y;
      int r = 2 * (index / ${a});
      int c = imod(index, ${a}) * 2;

      return ivec2(r, c);
    }
  `}function mve(t,e,n){return tn(t,e)?n?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(${e[0]}, ${e[1]}));
      }
    `:t[1]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(index, 0);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(index, 0);
      }
    `:t[0]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(0, index);
      }
    `:n?`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      int r = index / outShape[1];
      int c = index - r * outShape[1];
      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      int r = index / ${t[1]};
      int c = index - r * ${t[1]};
      return ivec2(r, c);
    }
  `}function hc(t){return`offset${t}`}function gve(t){const e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),r=la();return`
    vec4 ${n}() {
      return ${r.texture2D}(${e}, halfCR);
    }
  `}function yve(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`float ${r}() {return ${n};}`;const[a,i]=t.shapeInfo.texShape;if(a===1&&i===1)return`
      float ${r}() {
        return sampleTexture(${n}, halfCR);
      }
    `;const o=hc(n);if(e)return`
    float ${r}() {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], ${o});
      return sampleTexture(${n}, uv);
    }
  `;const[s,l]=t.shapeInfo.texShape;return`
    float ${r}() {
      vec2 uv = uvFromFlat(${s}, ${l}, ${o});
      return sampleTexture(${n}, uv);
    }
  `}function bve(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=t.shapeInfo.texShape,i=la();if(e)return`
    vec4 ${r}(int index) {
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      vec2 uv = packedUVfrom1D(
        packedTexShape[0], packedTexShape[1], index);
      return ${i.texture2D}(${n}, uv);
    }
  `;const o=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)];return`
    vec4 ${r}(int index) {
      vec2 uv = packedUVfrom1D(
        ${o[0]}, ${o[1]}, index);
      return ${i.texture2D}(${n}, uv);
    }
  `}function vve(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`
      float ${r}(int index) {
        ${fp(t)}
      }
    `;const a=t.shapeInfo.texShape,i=a[0],o=a[1];if(o===1&&i===1)return`
      float ${r}(int index) {
        return sampleTexture(${n}, halfCR);
      }
    `;const s=hc(n);return o===1?e?`
      float ${r}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${s}) + 0.5) / float(${n}TexShape[0]));
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${r}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${s}) + 0.5) / ${i}.0);
        return sampleTexture(${n}, uv);
      }
    `:i===1?e?`
      float ${r}(int index) {
        vec2 uv = vec2((float(index + ${s}) + 0.5) / float(${n}TexShape[1]), 0.5);
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${r}(int index) {
        vec2 uv = vec2((float(index + ${s}) + 0.5) / ${o}.0, 0.5);
        return sampleTexture(${n}, uv);
      }
    `:e?`
    float ${r}(int index) {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], index + ${s});
      return sampleTexture(${n}, uv);
    }
  `:`
    float ${r}(int index) {
      vec2 uv = uvFromFlat(${i}, ${o}, index + ${s});
      return sampleTexture(${n}, uv);
    }
  `}function xve(t,e){const n=t.shapeInfo.logicalShape,r=t.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=t.shapeInfo.texShape,o=i[0],s=i[1],l=la();if(i!=null&&tn(n,i))return e?`
      vec4 ${a}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);

        return ${l.texture2D}(${r}, uv);
      }
    `:`
      vec4 ${a}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${s}.0, ${o}.0);

        return ${l.texture2D}(${r}, uv);
      }
    `;if(e)return`
    vec4 ${a}(int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${r}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);
      return ${l.texture2D}(${r}, uv);
    }
  `;const u=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)],c=Math.ceil(n[1]/2);return`
    vec4 ${a}(int row, int col) {
      vec2 uv = packedUVfrom2D(${c}, ${u[0]}, ${u[1]}, row, col);
      return ${l.texture2D}(${r}, uv);
    }
  `}function wve(t,e){const n=t.shapeInfo.logicalShape,r=t.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=t.shapeInfo.texShape;if(i!=null&&tn(n,i)){if(e)return`
      float ${a}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `;const p=i[0],f=i[1];return`
    float ${a}(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(${f}.0, ${p}.0);
      return sampleTexture(${r}, uv);
    }
  `}const{newShape:o,keptDims:s}=ks(n),l=o;if(l.length<n.length){const p=mp(t,l),f=["row","col"];return`
      ${hp(p,e)}
      float ${a}(int row, int col) {
        return ${a}(${gp(f,s)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${a}(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(${n[1]}, 1)));
        ${fp(t)}
      }
    `;const u=i[0],c=i[1],d=hc(r);return c===1?e?`
      float ${a}(int row, int col) {
        float index = dot(vec3(row, col, ${d}), vec3(${r}Shape[1], 1, 1));
        vec2 uv = vec2(0.5, (index + 0.5) / float(${r}TexShape[0]));
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${a}(int row, int col) {
      float index = dot(vec3(row, col, ${d}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / ${u}.0);
      return sampleTexture(${r}, uv);
    }
  `:u===1?e?`
      float ${a}(int row, int col) {
        float index = dot(vec3(row, col, ${d}), vec3(${r}Shape[1], 1, 1));
        vec2 uv = vec2((index + 0.5) / float(${r}TexShape[1]), 0.5);
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${a}(int row, int col) {
      float index = dot(vec3(row, col, ${d}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2((index + 0.5) / ${c}.0, 0.5);
      return sampleTexture(${r}, uv);
    }
  `:e?`
      float ${a}(int row, int col) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${r}Shape[1] + col + ${d};
        vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);
        return sampleTexture(${r}, uv);
      }
    `:`
  float ${a}(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * ${n[1]} + col + ${d};
    vec2 uv = uvFromFlat(${u}, ${c}, index);
    return sampleTexture(${r}, uv);
  }
`}function kve(t,e){const n=t.shapeInfo.logicalShape,r=t.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=t.shapeInfo.texShape,o=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];if(n[0]===1){const p=n.slice(1),f=[1,2],g=mp(t,p),y=["b","row","col"];return`
        ${D9(g,e)}
        vec4 ${a}(int b, int row, int col) {
          return ${a}(${gp(y,f)});
        }
      `}const s=la();if(e)return`
    vec4 ${a}(int b, int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${r}Shape[2]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${r}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom3D(
        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);
      return ${s.texture2D}(${r}, uv);
    }
  `;const l=o[0],u=o[1],c=Math.ceil(n[2]/2),d=c*Math.ceil(n[1]/2);return`
    vec4 ${a}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${l}, ${u}, ${d}, ${c}, b, row, col);
      return ${s.texture2D}(${r}, uv);
    }
  `}function Sve(t,e){const n=t.shapeInfo.logicalShape,r=t.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=n[1]*n[2],o=n[2],{newShape:s,keptDims:l}=ks(n),u=s;if(u.length<n.length){const y=mp(t,u),x=["row","col","depth"];return`
        ${hp(y,e)}
        float ${a}(int row, int col, int depth) {
          return ${a}(${gp(x,l)});
        }
      `}if(t.shapeInfo.isUniform)return`
      float ${a}(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(${i}, ${o}, 1)));
        ${fp(t)}
      }
    `;const c=t.shapeInfo.texShape,d=c[0],p=c[1],f=t.shapeInfo.flatOffset;if(p===i&&f==null)return e?`
      float ${a}(int row, int col, int depth) {
        int stride1 = ${r}Shape[2];
        float texR = float(row);
        float texC = dot(vec2(col, depth), vec2(stride1, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
        float ${a}(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(${o}, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(${p}.0, ${d}.0);
          return sampleTexture(${r}, uv);
        }
      `;if(p===o&&f==null)return e?`
      float ${a}(int row, int col, int depth) {
        float texR = dot(vec2(row, col), vec2(${r}Shape[1], 1));
        float texC = float(depth);
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${a}(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(${n[1]}, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${p}.0, ${d}.0);
      return sampleTexture(${r}, uv);
    }
  `;const g=hc(r);return e?`
    float ${a}(int row, int col, int depth) {
      // Explicitly use integer operations as dot() only works on floats.
      int stride0 = ${r}Shape[1] * ${r}Shape[2];
      int stride1 = ${r}Shape[2];
      int index = row * stride0 + col * stride1 + depth + ${g};
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);
      return sampleTexture(${r}, uv);
    }
    `:`
      float ${a}(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${i} + col * ${o} + depth + ${g};
        vec2 uv = uvFromFlat(${d}, ${p}, index);
        return sampleTexture(${r}, uv);
      }
  `}function Cve(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=la();if(e)return`
    vec4 ${r}(int b2, int b, int row, int col) {
      int valuesPerRow = int(ceil(float(${n}Shape[3]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${n}Shape[2]) / 2.0));
      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);
      texelsInBatch *= ${n}Shape[1];
      index = b2 * texelsInBatch + index;
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      int texR = index / packedTexShape[1];
      int texC = index - texR * packedTexShape[1];
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${a.texture2D}(${n}, uv);
    }
  `;const i=t.shapeInfo.logicalShape,o=i.length,s=t.shapeInfo.texShape,l=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)],u=l[0],c=l[1],d=Math.ceil(i[o-1]/2);let p=d*Math.ceil(i[o-2]/2),f="int b, int row, int col",g=`b * ${p} + (row / 2) * ${d} + (col / 2)`;for(let y=2;y<o-1;y++)f=`int b${y}, `+f,p*=i[o-y-1],g=`b${y} * ${p} + `+g;return`
    vec4 ${r}(${f}) {
      int index = ${g};
      int texR = index / ${c};
      int texC = index - texR * ${c};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${c}, ${u});
      return ${a.texture2D}(${n}, uv);
    }
  `}function Nve(t,e){const n=t.shapeInfo.logicalShape,r=t.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=n[3],o=n[2]*i,s=n[1]*o,{newShape:l,keptDims:u}=ks(n);if(l.length<n.length){const v=mp(t,l),w=["row","col","depth","depth2"];return`
      ${hp(v,e)}
      float ${a}(int row, int col, int depth, int depth2) {
        return ${a}(${gp(w,u)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${a}(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(${s}, ${o}, ${i}, 1)));
        ${fp(t)}
      }
    `;const c=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,p=d[0],f=d[1],g=`int stride2 = ${r}Shape[3];`,y=`int stride1 = ${r}Shape[2] * stride2;`,x=`int stride0 = ${r}Shape[1] * stride1;`;if(f===s&&c==null)return e?`
      float ${a}(int row, int col, int depth, int depth2) {
        ${g}
        ${y}
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(stride1, stride2, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${a}(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(${o}, ${i}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${f}.0, ${p}.0);
        return sampleTexture(${r}, uv);
      }
    `;if(f===i&&c==null)return e?`
      float ${a}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${r}Shape[1] * ${r}Shape[2], ${r}Shape[2], 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${a}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${n[1]*n[2]}, ${n[2]}, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${f}.0, ${p}.0);
        return sampleTexture(${r}, uv);
      }
    `;const b=hc(r);return e?`
    float ${a}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      ${g}
      ${y}
      ${x}
      int index = row * stride0 + col * stride1 +
          depth * stride2 + depth2;
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index + ${b});
      return sampleTexture(${r}, uv);
    }
  `:`
    float ${a}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${s} + col * ${o} +
          depth * ${i} + depth2;
      vec2 uv = uvFromFlat(${p}, ${f}, index + ${b});
      return sampleTexture(${r}, uv);
    }
  `}function Tve(t){const e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=e[4],i=e[3]*a,o=e[2]*i,s=e[1]*o,{newShape:l,keptDims:u}=ks(e);if(l.length<e.length){const y=mp(t,l),x=["row","col","depth","depth2","depth3"];return`
      ${hp(y)}
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        return ${r}(${gp(x,u)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(${s}, ${o}, ${i}, ${a})) +
          depth3;
        ${fp(t)}
      }
    `;const c=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,p=d[0],f=d[1];if(f===s&&c==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(${o}, ${i}, ${a}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${f}.0, ${p}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(f===a&&c==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]},
               ${e[2]*e[3]}, ${e[3]}, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${f}.0, ${p}.0);
        return sampleTexture(${n}, uv);
      }
    `;const g=hc(n);return`
    float ${r}(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${s} + col * ${o} + depth * ${i} +
          depth2 * ${a} + depth3 + ${g};
      vec2 uv = uvFromFlat(${p}, ${f}, index);
      return sampleTexture(${n}, uv);
    }
  `}function Ive(t){const e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),{newShape:a,keptDims:i}=ks(e);if(a.length<e.length){const x=mp(t,a),b=["row","col","depth","depth2","depth3","depth4"];return`
      ${hp(x)}
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return ${r}(${gp(b,i)});
      }
    `}const o=e[5],s=e[4]*o,l=e[3]*s,u=e[2]*l,c=e[1]*u;if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(${c}, ${u}, ${l}, ${s})) +
          dot(
            vec2(depth3, depth4),
            vec2(${o}, 1)));
        ${fp(t)}
      }
    `;const d=t.shapeInfo.flatOffset,p=t.shapeInfo.texShape,f=p[0],g=p[1];if(g===c&&d==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(${u}, ${l}, ${s}, ${o})) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${g}.0, ${f}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(g===o&&d==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]*e[4]},
               ${e[2]*e[3]*e[4]},
               ${e[3]*e[4]},
               ${e[4]})) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${g}.0, ${f}.0);
        return sampleTexture(${n}, uv);
      }
    `;const y=hc(n);return`
    float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${c} + col * ${u} + depth * ${l} +
          depth2 * ${s} + depth3 * ${o} + depth4 + ${y};
      vec2 uv = uvFromFlat(${f}, ${g}, index);
      return sampleTexture(${n}, uv);
    }
  `}function fp(t){const e=t.name,n=me(t.shapeInfo.logicalShape);return n<2?`return ${e};`:`
    for (int i = 0; i < ${n}; i++) {
      if (i == index) {
        return ${e}[i];
      }
    }
  `}function Eve(t,e){const n=t.name,r=n.charAt(0).toUpperCase()+n.slice(1),a="get"+r+"AtOutCoords",i=t.shapeInfo.logicalShape.length,o=e.logicalShape.length,s=P9(t.shapeInfo.logicalShape,e.logicalShape),l=pn(o),u=o-i;let c;const d=["x","y","z","w","u","v"];i===0?c="":o<2&&s.length>=1?c="coords = 0;":c=s.map(x=>`coords.${d[x+u]} = 0;`).join(`
`);let p="";o<2&&i>0?p="coords":p=t.shapeInfo.logicalShape.map((x,b)=>`coords.${d[b+u]}`).join(", ");let f="return outputValue;";const g=me(t.shapeInfo.logicalShape)===1,y=me(e.logicalShape)===1;if(i===1&&!g&&!y)f=`
      return vec4(outputValue.xy, outputValue.xy);
    `;else if(g&&!y)o===1?f=`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:f=`
        return vec4(outputValue.x);
      `;else if(s.length){const x=i-2,b=i-1;s.indexOf(x)>-1&&s.indexOf(b)>-1?f="return vec4(outputValue.x);":s.indexOf(x)>-1?f="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":s.indexOf(b)>-1&&(f="return vec4(outputValue.xx, outputValue.zz);")}return`
    vec4 ${a}() {
      ${l} coords = getOutputCoords();
      ${c}
      vec4 outputValue = get${r}(${p});
      ${f}
    }
  `}function _ve(t,e){const n=t.name,r=n.charAt(0).toUpperCase()+n.slice(1),a="get"+r+"AtOutCoords",i=e.texShape,o=t.shapeInfo.texShape,s=t.shapeInfo.logicalShape.length,l=e.logicalShape.length;if(!t.shapeInfo.isUniform&&s===l&&t.shapeInfo.flatOffset==null&&tn(o,i))return`
      float ${a}() {
        return sampleTexture(${n}, resultUV);
      }
    `;const u=pn(l),c=P9(t.shapeInfo.logicalShape,e.logicalShape),d=l-s;let p;const f=["x","y","z","w","u","v"];s===0?p="":l<2&&c.length>=1?p="coords = 0;":p=c.map(y=>`coords.${f[y+d]} = 0;`).join(`
`);let g="";return l<2&&s>0?g="coords":g=t.shapeInfo.logicalShape.map((y,x)=>`coords.${f[x+d]}`).join(", "),`
    float ${a}() {
      ${u} coords = getOutputCoords();
      ${p}
      return get${r}(${g});
    }
  `}function pn(t){if(t<=1)return"int";if(t===2)return"ivec2";if(t===3)return"ivec3";if(t===4)return"ivec4";if(t===5)return"ivec5";if(t===6)return"ivec6";throw Error(`GPU for rank ${t} is not yet supported`)}function B4(t,e,n){const{newShape:r,keptDims:a}=ks(e),i=e.length,o=t&&i===3&&e[0]===1,s=o?e.slice(1):r,l=!t&&i>1&&!tn(e,n)&&r.length<i||o;return{useSqueezeShape:l,uniformShape:l?s:e,keptDims:a}}function mp(t,e){const n=JSON.parse(JSON.stringify(t));return n.shapeInfo.logicalShape=e,n}function gp(t,e){return e.map(n=>t[n]).join(", ")}/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Ove(t,e,n,r){const a=n.map((c,d)=>{const p={logicalShape:c.shape,texShape:c.isUniform?null:c.texData.texShape,isUniform:c.isUniform,isPacked:c.isUniform?!1:c.texData.isPacked,flatOffset:null};return c.texData!=null&&c.texData.slice!=null&&c.texData.slice.flatOffset>0&&(p.flatOffset=c.texData.slice.flatOffset),{name:e.variableNames[d],shapeInfo:p}}),i=a.map(c=>c.shapeInfo),o={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},s=Kbe(a,o,e),l=Sbe(t.gl,s),u=t.createProgram(l);return ue().get("ENGINE_COMPILE_ONLY")?{program:e,fragmentShader:l,source:s,webGLProgram:u,inShapeInfos:i,outShapeInfo:o,uniformLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,inShapesLocations:null,inTexShapesLocations:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:Object.assign({program:e,fragmentShader:l,source:s,webGLProgram:u,inShapeInfos:i,outShapeInfo:o},F9(t,e,u))}function F9(t,e,n){const r={},a={},i={},o=[];let s,l,u,c=null,d=null;d=t.getUniformLocation(n,"NAN",!1),ue().getNumber("WEBGL_VERSION")===1&&(c=t.getUniformLocation(n,"INFINITY",!1));const p=!1;for(let f=0;f<e.variableNames.length;f++){const g=e.variableNames[f];r[g]=t.getUniformLocation(n,g,p),r[`offset${g}`]=t.getUniformLocation(n,`offset${g}`,p),e.enableShapeUniforms&&(a[`${g}Shape`]=t.getUniformLocation(n,`${g}Shape`,p),i[`${g}TexShape`]=t.getUniformLocation(n,`${g}TexShape`,p))}return e.enableShapeUniforms&&(s=t.getUniformLocation(n,"outShape",p),u=t.getUniformLocation(n,"outShapeStrides",p),l=t.getUniformLocation(n,"outTexShape",p)),e.customUniforms&&e.customUniforms.forEach((f,g)=>{o[g]=t.getUniformLocation(n,f.name,p)}),{uniformLocations:r,customUniformLocations:o,infLoc:c,nanLoc:d,inShapesLocations:a,inTexShapesLocations:i,outShapeLocation:s,outShapeStridesLocation:u,outTexShapeLocation:l}}function B9(t,e){if(t.length!==e.length)throw Error(`Binary was compiled with ${t.length} inputs, but was executed with ${e.length} inputs`);t.forEach((n,r)=>{const a=n.logicalShape,i=e[r],o=i.shape;if(!tn(a,o))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${a} and ${o} must match`);if(n.isUniform&&i.isUniform)return;const s=n.texShape,l=i.isUniform?null:i.texData.texShape;if(!tn(s,l))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${s} and ${l} must match`)})}function $ve(t,e,n,r,a){e.program.enableShapeUniforms||(B9(e.inShapeInfos,n),B9([e.outShapeInfo],[r]));const i=r.texData.texture,o=r.texData.texShape;r.texData.isPacked?t.setOutputPackedMatrixTexture(i.texture,o[0],o[1]):t.setOutputMatrixTexture(i.texture,o[0],o[1]),t.setProgram(e.webGLProgram),ue().getNumber("WEBGL_VERSION")===1&&e.infLoc!==null&&t.gl.uniform1f(e.infLoc,1/0),e.nanLoc!==null&&t.gl.uniform1f(e.nanLoc,NaN),n.forEach((l,u)=>{const c=e.program.variableNames[u],d=e.uniformLocations[c],p=e.uniformLocations[`offset${c}`],f=e.inShapesLocations[`${c}Shape`],g=e.inTexShapesLocations[`${c}TexShape`];if(f){const{uniformShape:y}=B4(e.program.packedInputs,l.shape,l.texData.texShape);switch(y.length){case 1:t.gl.uniform1iv(f,new Int32Array(y));break;case 2:t.gl.uniform2iv(f,new Int32Array(y));break;case 3:t.gl.uniform3iv(f,new Int32Array(y));break;case 4:t.gl.uniform4iv(f,new Int32Array(y));break}}if(g&&t.gl.uniform2i(g,l.texData.texShape[0],l.texData.texShape[1]),d!=null){if(l.isUniform){if(me(l.shape)<2)t.gl.uniform1f(d,l.uniformValues[0]);else{let y=l.uniformValues;y instanceof Float32Array||(y=new Float32Array(y)),t.gl.uniform1fv(d,y)}return}l.texData.slice!=null&&p!=null&&t.gl.uniform1i(p,l.texData.slice.flatOffset),t.setInputMatrixTexture(l.texData.texture.texture,d,u)}});const s=e.outShapeLocation;if(s)switch(r.shape.length){case 1:t.gl.uniform1iv(s,new Int32Array(r.shape));break;case 2:t.gl.uniform2iv(s,new Int32Array(r.shape));break;case 3:t.gl.uniform3iv(s,new Int32Array(r.shape));break;case 4:t.gl.uniform4iv(s,new Int32Array(r.shape));break}if(e.outShapeStridesLocation){const l=qe(r.shape);switch(r.shape.length){case 2:t.gl.uniform1iv(e.outShapeStridesLocation,new Int32Array(l));break;case 3:t.gl.uniform2iv(e.outShapeStridesLocation,new Int32Array(l));break;case 4:t.gl.uniform3iv(e.outShapeStridesLocation,new Int32Array(l));break}}e.outTexShapeLocation&&t.gl.uniform2i(e.outTexShapeLocation,r.texData.texShape[0],r.texData.texShape[1]),e.program.customUniforms&&a&&e.program.customUniforms.forEach((l,u)=>{const c=e.customUniformLocations[u],d=a[u];if(l.type==="float")t.gl.uniform1fv(c,d);else if(l.type==="vec2")t.gl.uniform2fv(c,d);else if(l.type==="vec3")t.gl.uniform3fv(c,d);else if(l.type==="vec4")t.gl.uniform4fv(c,d);else if(l.type==="int")t.gl.uniform1iv(c,d);else if(l.type==="ivec2")t.gl.uniform2iv(c,d);else if(l.type==="ivec3")t.gl.uniform3iv(c,d);else if(l.type==="ivec4")t.gl.uniform4iv(c,d);else throw Error(`uniform type ${l.type} is not supported yet.`)}),t.executeProgram()}function Rve(t,e,n){let r="";e.concat(n).forEach(o=>{const s=o.texData!=null&&o.texData.slice!=null&&o.texData.slice.flatOffset>0;if(t.enableShapeUniforms&&!o.isUniform){const l=o.texData.texShape,{useSqueezeShape:u,uniformShape:c,keptDims:d}=B4(t.packedInputs,o.shape,l);let p="",f="",g="";if(c.length===1&&t.packedInputs){const C=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)];p=`${C[0]>1}_${C[1]>1}`}else if(c.length===2&&!t.packedInputs)f=`${c[0]>1}_${c[1]>1}`;else if(c.length>2&&!t.packedInputs){const C=qe(c);g=`${C[0]===l[1]}_${C[C.length-1]===l[1]}`}const y=o.shape.length,x=c.length===2&&tn(o.shape,l),b=me(o.shape)===1,v=tc(o.shape,n.shape),w=!t.packedInputs&&y===n.shape.length&&tn(l,n.texData.texShape),S=t.packedInputs||c.length>2?"":`${l[0]>1}_${l[1]>1}`;r+=`${y}_${w}_${u?d:""}_${c.length}_${b}_${v}_${x}_${p}_${f}_${g}_${S}_${s}`}else{const l=o.isUniform?"uniform":o.texData.texShape;r+=`${o.shape}_${l}_${s}`}});const a=t.userCode;let i=t.constructor.name;return i+="_"+r+"_"+a+`${ue().getNumber("WEBGL_VERSION")}`,i}function ua(t){return ue().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&t<=4}/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class Mve{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=eg.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=la();this.outputShape=e,this.enableShapeUniforms=ua(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?u2(["r","c","d"],e):pc(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${n.output} = result;
      }
    `}}/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class Ave{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=eg.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=la();this.outputShape=e,this.enableShapeUniforms=ua(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?u2(["r","c","d"],e):pc(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${n.output} = result;
      }
    `}}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class Pve{constructor(e){this.variableNames=["A"],this.outTexUsage=ii.DOWNLOAD;const n=la();this.outputShape=e,this.userCode=`
      ${A9}

      void main() {
        float x = getAAtOutCoords();
        ${n.output} = encode_float(x);
      }
    `}}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class Dve{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=ii.DOWNLOAD;const n=la();this.outputShape=e,this.userCode=`
      ${A9}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${n.output} = encode_float(x);
      }
    `}}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class Lve{constructor(e,n=!1){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const r=la();this.outputShape=e,this.enableShapeUniforms=ua(this.outputShape.length);let a="result";n&&(a="floor(result * 255. + 0.5)"),this.userCode=`
      ${this.enableShapeUniforms?F4():L4(e)}

      void main() {
        ivec3 coords = getOutputCoords();

        int flatIndex = getFlatIndex(coords);
        int offset = imod(flatIndex, 4);

        flatIndex = idiv(flatIndex, 4, 1.);

        int r = flatIndex / texShape[1];
        int c = imod(flatIndex, texShape[1]);
        vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
        vec4 values = ${r.texture2D}(A, uv);

        float result;

        if(offset == 0) {
          result = values[0];
        } else if(offset == 1) {
          result = values[1];
        } else if(offset == 2) {
          result = values[2];
        } else {
          result = values[3];
        }

        ${r.output} = vec4(${a}, 0., 0., 0.);
      }
    `}}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class Fve{constructor(e,n=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const r=la();this.outputShape=e,this.enableShapeUniforms=ua(this.outputShape.length);let a="",i="result";n&&(i="floor(result * 255. + 0.5)");for(let o=0;o<=1;o++)for(let s=0;s<=1;s++){const l=o*2+s;a+=`
          localCoords = coords;
          if(localCoords[2] + ${s} < ${this.enableShapeUniforms?"outShape[2]":`${e[2]}`}) {
          localCoords[2] += ${s};
          if (localCoords[1] + ${o} < ${this.enableShapeUniforms?"outShape[1]":`${e[1]}`}) {
            localCoords[1] += ${o};

            flatIndex = getFlatIndex(localCoords);
            offset = imod(flatIndex, 4);

            flatIndex = idiv(flatIndex, 4, 1.);

            int r = flatIndex / texShape[1];
            int c = imod(flatIndex, texShape[1]);
            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
            values = ${r.texture2D}(A, uv);

            if (offset == 0) {
              result[${l}] = values[0];
            } else if (offset == 1) {
              result[${l}] = values[1];
            } else if (offset == 2) {
              result[${l}] = values[2];
            } else {
              result[${l}] = values[3];
            }
          }
        }
        `}this.userCode=`
        ${this.enableShapeUniforms?F4():L4(e)}

        void main() {
          ivec3 coords = getOutputCoords();

          vec4 result = vec4(0.);
          int flatIndex, r, c, offset;
          ivec3 localCoords;
          vec2 uv;
          vec4 values;

          ${a}

          ${r.output} = ${i};
        }
    `}}/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Bve(t){const e=la(),n=`${e.version}
    precision highp float;
    ${e.attribute} vec3 clipSpacePos;
    ${e.attribute} vec2 uv;
    ${e.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return kbe(t,n)}function zve(t){const e=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return Ibe(t,e)}function Vve(t){const e=new Uint16Array([0,1,2,2,1,3]);return Ebe(t,e)}function rg(t,e,n,r,a,i){Obe(e,n);const o=_be(t),s=t.TEXTURE_2D;return Ve(t,()=>t.bindTexture(s,o)),Ve(t,()=>t.texParameteri(s,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE)),Ve(t,()=>t.texParameteri(s,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)),Ve(t,()=>t.texParameteri(s,t.TEXTURE_MIN_FILTER,t.NEAREST)),Ve(t,()=>t.texParameteri(s,t.TEXTURE_MAG_FILTER,t.NEAREST)),ue().getNumber("WEBGL_VERSION")===1?Ve(t,()=>t.texImage2D(s,0,r,e,n,0,a,i,null)):Ve(t,()=>t.texStorage2D(s,1,r,e,n)),Ve(t,()=>t.bindTexture(t.TEXTURE_2D,null)),{texture:o,texShape:[n,e]}}function z9(t){return t.internalFormatFloat}function Wve(t,e,n,r){const[a,i]=tg(e,n);return rg(t,a,i,z9(r),r.textureFormatFloat,t.FLOAT)}function V9(t){return t.internalFormatHalfFloat}function jve(t,e,n,r){const[a,i]=tg(e,n);return rg(t,a,i,V9(r),r.textureFormatFloat,r.textureTypeHalfFloat)}function W9(t){return t.downloadTextureFormat}function Uve(t,e,n,r){const[a,i]=tg(e,n);return rg(t,a,i,W9(r),t.RGBA,t.UNSIGNED_BYTE)}function j9(t){return t.internalFormatPackedFloat}function Gve(t,e,n,r){const[a,i]=cp(e,n);return rg(t,a,i,j9(r),t.RGBA,t.FLOAT)}function U9(t){return t.internalFormatPackedHalfFloat}function Hve(t,e,n,r){const[a,i]=cp(e,n);return rg(t,a,i,U9(r),t.RGBA,r.textureTypeHalfFloat)}function qve(t,e,n){return Ve(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),$9(t,e,"clipSpacePos",n,3,20,0)&&$9(t,e,"uv",n,2,20,12)}function Kve(t,e,n,r,a,i){Ve(t,()=>t.bindTexture(t.TEXTURE_2D,e));let o,s,l;a instanceof Uint8Array?(o=new Uint8Array(n*r*4),s=t.UNSIGNED_BYTE,l=t.RGBA):(o=new Float32Array(n*r*4),s=t.FLOAT,l=i.internalFormatPackedFloat),o.set(a),ue().getNumber("WEBGL_VERSION")===2?Ve(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n,r,t.RGBA,s,o)):Ve(t,()=>t.texImage2D(t.TEXTURE_2D,0,l,n,r,0,t.RGBA,s,o)),Ve(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function Xve(t,e,n){Ve(t,()=>t.bindTexture(t.TEXTURE_2D,e)),n.data instanceof Uint8Array?ue().getNumber("WEBGL_VERSION")===2?Ve(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n.width,n.height,t.RGBA,t.UNSIGNED_BYTE,n.data)):Ve(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,n.width,n.height,0,t.RGBA,t.UNSIGNED_BYTE,n.data)):ue().getNumber("WEBGL_VERSION")===2?Ve(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,t.RGBA,t.UNSIGNED_BYTE,n)):Ve(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,n)),Ve(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function Yve(t,e,n,r){const a=t.createBuffer();Ve(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,a));const i=4*4*e*n;return Ve(t,()=>t.bufferData(t.PIXEL_PACK_BUFFER,i,t.STREAM_READ)),Ve(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,0)),Ve(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,null)),a}function Qve(t,e,n){const r=t,a=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,e),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,a),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),a}function Zve(t,e,n,r){const[a,i]=tg(e,n),o=4,s=new Uint8Array(mbe(e*n,o));return Ve(t,()=>t.readPixels(0,0,a,i,r.downloadTextureFormat,t.UNSIGNED_BYTE,s)),new Float32Array(s.buffer)}function Jve(t,e,n,r,a,i,o,s){const l=t,u=new Float32Array(gbe(i,o));return l.bindBuffer(l.PIXEL_PACK_BUFFER,e),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,u),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),u}function exe(t,e,n){const r=new Float32Array(e*n*4);return Ve(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,r)),r}/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class z4{constructor(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];const n=ue().getNumber("WEBGL_VERSION");e!=null?(this.gl=e,pbe(n,e)):this.gl=co(n);let r="WEBGL_color_buffer_float";const a="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),ue().getNumber("WEBGL_VERSION")===1){const i="OES_texture_float",o="OES_texture_half_float";if(this.textureFloatExtension=i2(this.gl,i),Ai(this.gl,o))this.textureHalfFloatExtension=i2(this.gl,o);else if(ue().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),Ai(this.gl,a))this.colorBufferHalfFloatExtension=i2(this.gl,a);else if(ue().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",Ai(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else if(Ai(this.gl,a))this.colorBufferHalfFloatExtension=this.gl.getExtension(a);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=zve(this.gl),this.indexBuffer=Vve(this.gl),this.framebuffer=$be(this.gl),this.textureConfig=O4(this.gl,this.textureHalfFloatExtension)}get debug(){return ue().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const e=this.gl;Ve(e,()=>e.finish()),Ve(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),Ve(e,()=>e.deleteFramebuffer(this.framebuffer)),Ve(e,()=>e.bindBuffer(e.ARRAY_BUFFER,null)),Ve(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)),Ve(e,()=>e.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(e,n){return this.throwIfDisposed(),Wve(this.gl,e,n,this.textureConfig)}createFloat16MatrixTexture(e,n){return this.throwIfDisposed(),jve(this.gl,e,n,this.textureConfig)}createUnsignedBytesMatrixTexture(e,n){return this.throwIfDisposed(),Uve(this.gl,e,n,this.textureConfig)}uploadPixelDataToTexture(e,n){this.throwIfDisposed(),Xve(this.gl,e,n)}uploadDenseMatrixToTexture(e,n,r,a){this.throwIfDisposed(),Kve(this.gl,e,n,r,a,this.textureConfig)}createFloat16PackedMatrixTexture(e,n){return this.throwIfDisposed(),Hve(this.gl,e,n,this.textureConfig)}createPackedMatrixTexture(e,n){return this.throwIfDisposed(),Gve(this.gl,e,n,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(R9(this.gl,this.framebuffer),this.outputTexture=null),Ve(this.gl,()=>this.gl.deleteTexture(e))}downloadByteEncodedFloatMatrixFromOutputTexture(e,n,r){return this.downloadMatrixDriver(e,()=>Zve(this.gl,n,r,this.textureConfig))}downloadPackedMatrixFromBuffer(e,n,r,a,i,o){return Jve(this.gl,e,n,r,a,i,o,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,n){return Qve(this.gl,e,n)}createBufferFromTexture(e,n,r){this.bindTextureToFrameBuffer(e);const a=Yve(this.gl,n,r,this.textureConfig);return this.unbindTextureToFrameBuffer(),a}createAndWaitForFence(){const e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let n,r;if(ue().getBool("WEBGL_FENCE_API_ENABLED")){const a=e,i=a.fenceSync(a.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),r=()=>{const o=a.clientWaitSync(i,0,0);return o===a.ALREADY_SIGNALED||o===a.CONDITION_SATISFIED},n=i}else ue().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(n=this.beginQuery(),this.endQuery(),r=()=>this.isQueryAvailable(n,ue().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):r=()=>!0;return{query:n,isFencePassed:r}}downloadMatrixFromPackedTexture(e,n,r){return this.downloadMatrixDriver(e,()=>exe(this.gl,n,r))}createProgram(e){this.throwIfDisposed();const n=this.gl;this.vertexShader==null&&(this.vertexShader=Bve(n));const r=Nbe(n);return Ve(n,()=>n.attachShader(r,this.vertexShader)),Ve(n,()=>n.attachShader(r,e)),Tbe(n,r),this.debug&&$4(n,r),this.vertexAttrsAreBound||(this.setProgram(r),this.vertexAttrsAreBound=qve(n,this.program,this.vertexBuffer)),r}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),e!=null&&Ve(this.gl,()=>this.gl.deleteProgram(e))}setProgram(e){this.throwIfDisposed(),this.program=e,this.program!=null&&this.debug&&$4(this.gl,this.program),Ve(this.gl,()=>this.gl.useProgram(e))}getUniformLocation(e,n,r=!0){return this.throwIfDisposed(),r?Mbe(this.gl,e,n):Abe(this.gl,e,n)}getAttributeLocation(e,n){return this.throwIfDisposed(),Ve(this.gl,()=>this.gl.getAttribLocation(e,n))}getUniformLocationNoThrow(e,n){return this.throwIfDisposed(),this.gl.getUniformLocation(e,n)}setInputMatrixTexture(e,n,r){this.throwIfDisposed(),this.throwIfNoProgram(),Pbe(this.gl,e,n,r)}setOutputMatrixTexture(e,n,r){this.setOutputMatrixTextureDriver(e,r,n)}setOutputPackedMatrixTexture(e,n,r){this.throwIfDisposed();const[a,i]=cp(n,r);this.setOutputMatrixTextureDriver(e,a,i)}setOutputMatrixWriteRegion(e,n,r,a){this.setOutputMatrixWriteRegionDriver(r,e,a,n)}setOutputPackedMatrixWriteRegion(e,n,r,a){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&$4(this.gl,this.program),o2(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const e=this.gl;this.debug&&this.debugValidate(),Ve(e,()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),Ve(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=i2(this.gl,ue().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(ue().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const r=this.gl,a=this.getQueryTimerExtensionWebGL2(),i=r.createQuery();return r.beginQuery(a.TIME_ELAPSED_EXT,i),i}const e=this.getQueryTimerExtensionWebGL1(),n=e.createQueryEXT();return e.beginQueryEXT(e.TIME_ELAPSED_EXT,n),n}endQuery(){if(ue().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const n=this.gl,r=this.getQueryTimerExtensionWebGL2();n.endQuery(r.TIME_ELAPSED_EXT);return}const e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(e){return await A3(()=>this.disposed||this.isQueryAvailable(e,ue().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(e,ue().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(e,n){if(n===0)return null;if(n===2){const r=this.gl;return r.getQueryParameter(e,r.QUERY_RESULT)/1e6}else{const r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(e,r.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(e,n){if(n===0)return!0;if(n===2){const r=this.gl,a=this.getQueryTimerExtensionWebGL2(),i=r.getQueryParameter(e,r.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(a.GPU_DISJOINT_EXT)),i&&!this.disjoint}else{const r=this.getQueryTimerExtensionWebGL1(),a=r.getQueryObjectEXT(e,r.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),a&&!this.disjoint}}pollFence(e){return new Promise(n=>{this.addItemToPoll(()=>e.isFencePassed(),()=>n())})}pollItems(){const e=txe(this.itemsToPoll.map(n=>n.isDoneFn));for(let n=0;n<=e;++n){const{resolveFn:r}=this.itemsToPoll[n];r()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,n){if(this.itemsToPoll.push({isDoneFn:e,resolveFn:n}),this.itemsToPoll.length>1)return;let r;"setTimeoutCustom"in ue().platform&&(r=ue().platform.setTimeoutCustom.bind(ue().platform)),A3(()=>(this.pollItems(),this.itemsToPoll.length===0),()=>0,null,r)}bindTextureToFrameBuffer(e){this.throwIfDisposed(),R4(this.gl,e,this.framebuffer),this.debug&&o2(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(R4(this.gl,this.outputTexture,this.framebuffer),this.debug&&o2(this.gl)):R9(this.gl,this.framebuffer)}downloadMatrixDriver(e,n){this.bindTextureToFrameBuffer(e);const r=n();return this.unbindTextureToFrameBuffer(),r}setOutputMatrixTextureDriver(e,n,r){this.throwIfDisposed();const a=this.gl;R4(a,e,this.framebuffer),this.debug&&o2(a),this.outputTexture=e,Ve(a,()=>a.viewport(0,0,n,r)),Ve(a,()=>a.scissor(0,0,n,r))}setOutputMatrixWriteRegionDriver(e,n,r,a){this.throwIfDisposed(),Ve(this.gl,()=>this.gl.scissor(e,n,r,a))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}}function txe(t){let e=0;for(;e<t.length&&t[e]();++e);return e-1}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const{addImpl:nxe,bincountImpl:G9,bincountReduceImpl:rxe,castImpl:axe,ceilImpl:ixe,concatImpl:oxe,equalImpl:sxe,expImpl:lxe,expm1Impl:uxe,floorImpl:cxe,gatherNdImpl:dxe,gatherV2Impl:pxe,greaterImpl:hxe,greaterEqualImpl:fxe,lessImpl:mxe,lessEqualImpl:gxe,linSpaceImpl:yxe,logImpl:bxe,maxImpl:vxe,maximumImpl:xxe,minimumImpl:wxe,multiplyImpl:kxe,negImpl:Sxe,notEqualImpl:Cxe,prodImpl:Nxe,raggedGatherImpl:Txe,raggedTensorToTensorImpl:Ixe,rangeImpl:Exe,rsqrtImpl:_xe,scatterImpl:Oxe,sigmoidImpl:$xe,simpleAbsImpl:H9,sliceImpl:Rxe,sparseFillEmptyRowsImpl:Mxe,sparseReshapeImpl:Axe,sparseSegmentReductionImpl:q9,sqrtImpl:Pxe,stridedSliceImpl:Dxe,stringNGramsImpl:Lxe,stringSplitImpl:Fxe,stringToHashBucketFastImpl:Bxe,subImpl:zxe,tileImpl:Vxe,topKImpl:Wxe,transposeImpl:V4,uniqueImpl:jxe}=Zfe;/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function K9(t,e){return["x","y","z","w","u","v"].slice(0,e).map(n=>`${t}.${n}`)}function ca(t,e){return e===1?[t]:K9(t,e)}function Uxe(t,e){if(t===1)return"rc";let n="";for(let r=0;r<t;r++)n+=e[r],r<t-1&&(n+=",");return n}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class Gxe{constructor(e){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.enableShapeUniforms=ua(this.outputShape.length),this.rank===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{const n=ca("rc",this.rank),r=pn(this.rank),a=this.getOutOfBoundsCondition(n),i=this.getSetup(n),o=this.getOutput(n);this.userCode=`
        void main() {
          ${r} rc = getOutputCoords();

          if(${a}) {
            setOutput(vec4(0));
          } else {
            ${i}

            setOutput(vec4(${o}));
          }
        }
      `}}getSourceCoordsArr(e){const n=[];for(let r=0;r<=1;r++)for(let a=0;a<=1;a++){let i=`${r===0?"r":"rp1"}, ${a===0?"c":"cp1"}`;for(let o=2;o<this.rank;o++)i=`${e[e.length-1-o]},`+i;n.push(i)}return n}getOutOfBoundsCondition(e){if(this.rank===1)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let n="";for(let r=this.rank-2;r<this.rank;r++)n+=`${e[r]} >= ${this.enableShapeUniforms?`outShape[${r}]`:this.outputShape[r]}`,r<this.rank-1&&(n+="||");return n}getSetup(e){if(this.rank===1)return"";const n=e.slice(-2),r=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],a=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`
      int r = ${n[0]};
      int c = ${n[1]};
      int rp1 = r + 1;
      int cp1 = c + 1;

      bool cEdge = cp1 >= ${r};
      bool rEdge = rp1 >= ${a};
    `}getOutput(e){const n=this.getSourceCoordsArr(e);return this.rank===1?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${n[0]}),
            cEdge ? 0. : getA(${n[1]}),
            rEdge ? 0. : getA(${n[2]}),
            rEdge || cEdge ? 0. : getA(${n[3]})`}}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class X9{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=e,this.enableShapeUniforms=ua(this.outputShape.length);let r="";for(let a=0;a<4;a++){let i="thisRC = rc;";a%2===1&&(i+="thisRC.z += 1;"),a>1&&(i+="thisRC.y += 1;"),r+=`
        ${i}
        ${a>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${a}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${a>0?"}":""}
      `}this.userCode=`
      ${Hxe(n,this.enableShapeUniforms)}
      ${this.enableShapeUniforms?F4():L4(e)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${this.enableShapeUniforms?"outShape[1]":e[1]};
        int cols = ${this.enableShapeUniforms?"outShape[2]":e[2]};

        ${r}

        setOutput(result);
      }
    `}}function Hxe(t,e){return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${e?qbe(["r","c","d"],"inputShape"):pc(["r","c","d"],t)}
      return ivec3(r, c, d);
    }
  `}/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class qxe{constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}acquireTexture(e,n,r){const a=Q9(n,r),i=Z9(e,a,r);i in this.freeTextures||(this.freeTextures[i]=[]),i in this.usedTextures||(this.usedTextures[i]=[]);const o=Y9(e,a,this.gpgpu.gl,this.gpgpu.textureConfig,r);if(this.freeTextures[i].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=o,this.log();const l=this.freeTextures[i].shift();return this.usedTextures[i].push(l),l}let s;return a===Ir.PACKED_2X2_FLOAT32?s=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):a===Ir.PACKED_2X2_FLOAT16?s=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):a===Ir.UNPACKED_FLOAT32?s=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):a===Ir.UNPACKED_FLOAT16?s=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):a===Ir.PACKED_4X1_UNSIGNED_BYTE&&(s=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[i].push(s),this.numUsedTextures++,this._numBytesAllocated+=o,this.log(),s}releaseTexture(e,n,r,a){if(this.freeTextures==null)return;const i=Q9(r,a),o=Z9(n,i,a);o in this.freeTextures||(this.freeTextures[o]=[]);const s=Y9(n,i,this.gpgpu.gl,this.gpgpu.textureConfig,a),l=ue().get("WEBGL_DELETE_TEXTURE_THRESHOLD");l!==-1&&this._numBytesAllocated>l?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=s):(this.freeTextures[o].push(e),this.numFreeTextures++,this._numBytesFree+=s),this.numUsedTextures--;const u=this.usedTextures[o],c=u.indexOf(e);if(c<0)throw new Error("Cannot release a texture that was never provided by this texture manager");u.splice(c,1),this.log()}log(){if(!this.logEnabled)return;const e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${e})`);const n=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*n)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(const e in this.freeTextures)this.freeTextures[e].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});for(const e in this.usedTextures)this.usedTextures[e].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function Kxe(t,e){const n=t;if(e===n.R32F)return 4;if(e===n.R16F)return 2;if(e===n.RGBA32F||e===t.RGBA)return 16;if(e===n.RGBA16F)return 8;if(e===n.RGBA8)return 4;throw new Error(`Unknown internal format ${e}`)}function Y9(t,e,n,r,a){const i=Xxe(e,r);let o;if(a){const[l,u]=cp(t[0],t[1]);o=l*u}else{const[l,u]=tg(t[0],t[1]);o=l*u}const s=Kxe(n,i);return o*s}function Xxe(t,e){switch(t){case Ir.PACKED_2X2_FLOAT32:return j9(e);case Ir.PACKED_2X2_FLOAT16:return U9(e);case Ir.UNPACKED_FLOAT32:return z9(e);case Ir.UNPACKED_FLOAT16:return V9(e);case Ir.PACKED_4X1_UNSIGNED_BYTE:return W9(e);default:throw new Error(`Unknown physical texture type ${t}`)}}function Yxe(t){return ue().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?t?Ir.PACKED_2X2_FLOAT32:Ir.UNPACKED_FLOAT32:t?Ir.PACKED_2X2_FLOAT16:Ir.UNPACKED_FLOAT16}function Q9(t,e){if(t===ii.UPLOAD)return Ir.PACKED_2X2_FLOAT32;if(t===ii.RENDER||t==null)return Yxe(e);if(t===ii.DOWNLOAD||t===ii.PIXELS)return Ir.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${t}`)}function Z9(t,e,n){return`${t[0]}_${t[1]}_${e}_${n}`}/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class Ds{constructor(e,n){this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=ua(this.outputShape.length),this.userCode=`
      float unaryOperation(float x) {
        ${n}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}}const Pi="if (isnan(x)) return x;",Qxe="return x;",J9="return abs(x);",Zxe="return (x >= 0.0) ? x : (exp(x) - 1.0);",Jxe=Pi+`
  return (x < 0.0) ? 0.0 : x;
`,e2e=Pi+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,yp="return x;",t2e="return 1.0 / (1.0 + exp(-1.0 * x));";/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const n2e="return x;",r2e=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,a2e=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,i2e=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,o2e="return 1.0 / (1.0 + exp(-1.0 * x));";class fc{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=ua(this.outputShape.length),this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${n}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class s2e{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e,this.enableShapeUniforms=ua(this.outputShape.length);const n=e.length,r=ca("rc",n),a=pn(n),i=Uxe(n,r),o=r.slice(-2),s=n<=1?"rc":`vec2(${o.join(",")})`;this.userCode=`
      void main() {
        ${a} rc = getOutputCoords();
        vec4 packedInput = getA(${i});

        setOutput(getChannel(packedInput, ${s}));
      }
    `}}/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const l2e=Rx,u2e=1e-7,c2e=1e-4,W4={};function d2e(t){return t in W4||(W4[t]={}),W4[t]}const p2e=ue().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),h2e=600;function f2e(){return ue().global.screen==null?1024:ue().global.screen.height*ue().global.screen.width*window.devicePixelRatio*h2e/1024/1024}class H2 extends bb{constructor(e){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!ue().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let n;if(e!=null){if(e instanceof z4)n=e;else{const r=co(ue().getNumber("WEBGL_VERSION"),e);n=new z4(r)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const r=co(ue().getNumber("WEBGL_VERSION"));n=new z4(r),this.binaryCache=d2e(ue().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=n,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new qxe(this.gpgpu),this.numMBBeforeWarning=f2e(),this.texData=new M3(this,Es())}nextDataId(){return H2.nextDataId++}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}write(e,n,r){if((ue().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||ue().getBool("DEBUG"))&&this.checkNumericalProblems(e),r==="complex64"&&e!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const a={id:this.nextDataId()};return this.texData.set(a,{shape:n,dtype:r,values:e,usage:ii.UPLOAD,refCount:1}),a}refCount(e){return this.texData.has(e)?this.texData.get(e).refCount:0}incRef(e){const n=this.texData.get(e);n.refCount++}decRef(e){if(this.texData.has(e)){const n=this.texData.get(e);n.refCount--}}move(e,n,r,a,i){if(ue().getBool("DEBUG")&&this.checkNumericalProblems(n),a==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:r,dtype:a,values:n,usage:ii.UPLOAD,refCount:i})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){const n=this.texData.get(e),{values:r,dtype:a,complexTensorInfos:i,slice:o,shape:s,isPacked:l}=n;if(o!=null){let p;l?p=new fc(s,yp):p=new Ds(s,yp);const f=this.runWebGLProgram(p,[{dataId:e,shape:s,dtype:a}],a),g=this.readSync(f.dataId);return this.disposeIntermediateTensorInfo(f),g}if(r!=null)return this.convertAndCacheOnCPU(e);if(a==="string")return r;const u=this.activeTimers!=null;let c;u&&(c=Fa());let d;if(a==="complex64"){const p=this.readSync(i.real.dataId),f=this.readSync(i.imag.dataId);d=Ms(p,f)}else d=this.getValuesFromTexture(e);return u&&(this.downloadWaitMs+=Fa()-c),this.convertAndCacheOnCPU(e,d)}async read(e){if(this.pendingRead.has(e)){const g=this.pendingRead.get(e);return new Promise(y=>g.push(y))}const n=this.texData.get(e),{values:r,shape:a,slice:i,dtype:o,complexTensorInfos:s,isPacked:l}=n;if(i!=null){let g;l?g=new fc(a,yp):g=new Ds(a,yp);const y=this.runWebGLProgram(g,[{dataId:e,shape:a,dtype:o}],o),x=this.read(y.dataId);return this.disposeIntermediateTensorInfo(y),x}if(r!=null)return this.convertAndCacheOnCPU(e);if(ue().getBool("DEBUG")&&!ue().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&ue().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let u=null,c;if(o!=="complex64"&&ue().get("WEBGL_BUFFER_SUPPORTED")){c=this.decode(e);const g=this.texData.get(c.dataId);u=this.gpgpu.createBufferFromTexture(g.texture.texture,...a2(a))}this.pendingRead.set(e,[]),o!=="complex64"&&await this.gpgpu.createAndWaitForFence();let d;if(o==="complex64"){const g=await Promise.all([this.read(s.real.dataId),this.read(s.imag.dataId)]),y=g[0],x=g[1];d=Ms(y,x)}else if(u==null)d=this.getValuesFromTexture(e);else{const g=me(a);d=this.gpgpu.downloadFloat32MatrixFromBuffer(u,g)}if(c!=null&&this.disposeIntermediateTensorInfo(c),u!=null){const g=this.gpgpu.gl;Ve(g,()=>g.deleteBuffer(u))}const p=this.convertAndCacheOnCPU(e,d),f=this.pendingRead.get(e);return this.pendingRead.delete(e),f.forEach(g=>g(p)),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)&&Es().removeDataId(e,this),this.pendingDeletes--),p}readToGPU(e,n={}){const r=this.texData.get(e),{values:a,shape:i,slice:o,dtype:s,isPacked:l,texture:u}=r;if(s==="complex64")throw new Error("Does not support reading texture for complex64 dtype.");if(o!=null){let f;l?f=new fc(i,yp):f=new Ds(i,yp);const g=this.runWebGLProgram(f,[{dataId:e,shape:i,dtype:s}],s),y=this.readToGPU(g,n);return this.disposeIntermediateTensorInfo(g),y}if(u==null)throw a!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const c=this.decode(e,n.customTexShape),d=Es().makeTensorFromTensorInfo(c),p=this.texData.get(c.dataId);return Object.assign({tensorRef:d},p.texture)}bufferSync(e){const n=this.readSync(e.dataId);if(e.dtype==="string")try{const r=n.map(a=>Cs(a));return pt(e.shape,e.dtype,r)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return pt(e.shape,e.dtype,n)}checkNumericalProblems(e){if(e!=null)for(let n=0;n<e.length;n++){const r=e[n];if(!xbe(r))throw ue().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${r} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${r} cannot be represented on this device.`)}}getValuesFromTexture(e){const{shape:n,dtype:r,isPacked:a}=this.texData.get(e),i=me(n);if(ue().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const p=this.decode(e),f=this.texData.get(p.dataId),g=this.gpgpu.downloadMatrixFromPackedTexture(f.texture.texture,...a2(n)).subarray(0,i);return this.disposeIntermediateTensorInfo(p),g}const o=ue().getBool("WEBGL_PACK")&&a===!0,s=o?M4(n):n,l=o?new Dve(s):new Pve(s),u=this.runWebGLProgram(l,[{shape:s,dtype:r,dataId:e}],"float32"),c=this.texData.get(u.dataId),d=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(c.texture.texture,c.texShape[0],c.texShape[1]).subarray(0,i);return this.disposeIntermediateTensorInfo(u),d}timerAvailable(){return ue().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){const n=this.activeTimers,r=[];let a=!1;this.programTimersStack==null?(this.programTimersStack=r,a=!0):this.activeTimers.push(r),this.activeTimers=r,e();const i=ws(this.activeTimers.map(l=>l.query)).filter(l=>l!=null),o=ws(this.activeTimers.map(l=>l.name)).filter(l=>l!=null);this.activeTimers=n,a&&(this.programTimersStack=null);const s={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(ue().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const l=await Promise.all(i);s.kernelMs=tP(l),s.getExtraProfileInfo=()=>l.map((u,c)=>({name:o[c],ms:u})).map(u=>`${u.name}: ${u.ms}`).join(", ")}else s.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,s})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return ue().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:Fa(),endMs:null}}endTimer(e){return ue().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=Fa(),e)}async getQueryTime(e){if(ue().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(e);const n=e;return n.endMs-n.startMs}disposeData(e,n=!1){if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(n?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!n&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);const{complexTensorInfos:r}=this.texData.get(e);return r!=null&&(this.disposeData(r.real.dataId,n),this.disposeData(r.imag.dataId,n)),this.texData.delete(e),!0}releaseGPUData(e){const{texture:n,dtype:r,texShape:a,usage:i,isPacked:o,slice:s}=this.texData.get(e),l=s&&s.origDataId||e,u=this.dataRefCount.get(l);u>1?this.dataRefCount.set(l,u-1):(this.dataRefCount.delete(l),n!=null&&(this.numBytesInGPU-=this.computeBytes(a,r),this.textureManager.releaseTexture(n,a,i,o)));const c=this.texData.get(e);c.texture=null,c.texShape=null,c.isPacked=!1,c.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e,n=p2e){return ue().getBool("WEBGL_CPU_FORWARD")&&e.every(r=>this.texData.get(r.dataId).texture==null&&me(r.shape)<n)}getGPGPUContext(){return this.gpgpu}where(e){ai("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const n=e.dataSync();return l2e(e.shape,n)}packedUnaryOp(e,n,r){const a=new fc(e.shape,n),i=this.compileAndRun(a,[e],r);return Es().makeTensorFromTensorInfo(i)}abs(e){if(this.shouldExecuteOnCPU([e])&&e.dtype!=="complex64"){const a=H9(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,a)}if(ue().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,J9,e.dtype);const n=new Ds(e.shape,J9),r=this.compileAndRun(n,[e]);return Es().makeTensorFromTensorInfo(r)}makeTensorInfo(e,n,r){let a;if(n==="string"&&r!=null&&r.length>0&&Oo(r[0])){const i=r.map(o=>$o(o));a=this.write(i,e,n)}else a=this.write(r,e,n);return this.texData.get(a).usage=null,{dataId:a,shape:e,dtype:n}}makeOutput(e,n,r){return Es().makeTensorFromTensorInfo(this.makeTensorInfo(e,n,r),this)}unpackTensor(e){const n=new s2e(e.shape);return this.runWebGLProgram(n,[e],e.dtype)}packTensor(e){const n=new Gxe(e.shape);return this.runWebGLProgram(n,[e],e.dtype,null,!0)}packedReshape(e,n){const r=[dp(e.shape),...pp(e.shape)],a={dtype:e.dtype,shape:r,dataId:e.dataId},i=[dp(n),...pp(n)],o=new X9(i,r),s=!0,l=[r],u=this.runWebGLProgram(o,[a],e.dtype,l,s);return{dataId:u.dataId,shape:n,dtype:u.dtype}}decode(e,n){const r=this.texData.get(e),{isPacked:a,shape:i,dtype:o}=r;if(n!=null){const p=me(i),f=n[0]*n[1]*4;V(p<=f,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}const s=M4(i);let l;a?l=new Ave(s):l=new Mve(s);const u=!0,c=[n??a2(s)],d=this.runWebGLProgram(l,[{shape:s,dtype:o,dataId:e}],o,c,u,n);return{dtype:o,shape:i,dataId:d.dataId}}runWebGLProgram(e,n,r,a,i=!1,o){const s=this.makeTensorInfo(e.outputShape,r),l=this.texData.get(s.dataId);if(e.packedOutput&&(l.isPacked=!0),e.outPackingScheme===eg.DENSE){const b=o??a2(e.outputShape);l.texShape=b.map(v=>v*2)}if(e.outTexUsage!=null&&(l.usage=e.outTexUsage),me(s.shape)===0)return l.values=tr(s.dtype,0),s;const u=[],c=n.map(b=>{if(b.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let v=this.texData.get(b.dataId);if(v.texture==null){if(!e.packedInputs&&me(b.shape)<=ue().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:b.shape,texData:null,isUniform:!0,uniformValues:v.values};e.packedInputs&&(v.isPacked=!0,v.shape=b.shape)}if(this.uploadToGPU(b.dataId),!!v.isPacked!=!!e.packedInputs)b=v.isPacked?this.unpackTensor(b):this.packTensor(b),u.push(b),v=this.texData.get(b.dataId);else if(v.isPacked&&!l2(v.shape,b.shape)){const w=b,S=b.shape;b.shape=v.shape,b=this.packedReshape(b,S),u.push(b),v=this.texData.get(b.dataId),w.shape=S}return{shape:b.shape,texData:v,isUniform:!1}});this.uploadToGPU(s.dataId);const d={shape:s.shape,texData:l,isUniform:!1},p=Rve(e,c,d),f=this.getAndSaveBinary(p,()=>Ove(this.gpgpu,e,c,d)),g=this.activeTimers!=null;let y;g&&(y=this.startTimer()),ue().get("ENGINE_COMPILE_ONLY")||$ve(this.gpgpu,f,c,d,a),u.forEach(b=>this.disposeIntermediateTensorInfo(b)),g&&(y=this.endTimer(y),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(y)}));const x=ue().get("WEBGL_FLUSH_THRESHOLD");if(x>0){const b=Fa();b-this.lastGlFlushTime>x&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=b)}if(!ue().getBool("WEBGL_LAZILY_UNPACK")&&l.isPacked&&i===!1){const b=this.unpackTensor(s);return this.disposeIntermediateTensorInfo(s),b}return s}compileAndRun(e,n,r,a,i=!1){return r=r||n[0].dtype,this.runWebGLProgram(e,n,r,a,i)}getAndSaveBinary(e,n){return e in this.binaryCache||(this.binaryCache[e]=n()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(ue().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(e=>{this.gpgpu.deleteProgram(this.binaryCache[e].webGLProgram),delete this.binaryCache[e]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=Ot(()=>{if(!ue().get("WEBGL_RENDER_FLOAT32_ENABLED")){const e=ue().getBool("DEBUG");ue().set("DEBUG",!1);const n=this.abs(St(1e-8)).dataSync()[0];if(ue().set("DEBUG",e),n>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?u2e:c2e}uploadToGPU(e){const n=this.texData.get(e),{shape:r,dtype:a,values:i,texture:o,usage:s,isPacked:l}=n;if(o!=null)return;const u=this.activeTimers!=null;let c;u&&(c=Fa());let d=n.texShape;if(d==null&&(d=Fbe(r,l),n.texShape=d),i!=null){const p=M4(r);let f,g=d[1],y=d[0];const x=i instanceof Uint8Array||i instanceof Uint8ClampedArray;(l||!x)&&([g,y]=cp(d[0],d[1])),l?f=new Fve(p,x):f=new Lve(p,x);const b=x?[y,g]:d,v=this.makeTensorInfo(b,a),w=this.texData.get(v.dataId);x?w.usage=ii.PIXELS:w.usage=ii.UPLOAD,w.texShape=b,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(v.dataId),g,y,i);const S=[[y,g]],C=!0,I=this.runWebGLProgram(f,[v],a,S,C),_=this.texData.get(I.dataId);n.texShape=_.texShape,n.isPacked=_.isPacked,n.usage=_.usage,ue().get("ENGINE_COMPILE_ONLY")?this.disposeData(I.dataId):(n.texture=_.texture,n.values=null,this.texData.delete(I.dataId)),this.disposeIntermediateTensorInfo(v),u&&(this.uploadWaitMs+=Fa()-c)}else{const p=this.acquireTexture(d,s,a,l);n.texture=p}}convertAndCacheOnCPU(e,n){const r=this.texData.get(e),{dtype:a}=r;return this.releaseGPUData(e),n!=null&&(r.values=m2e(n,a)),r.values}acquireTexture(e,n,r,a){if(this.numBytesInGPU+=this.computeBytes(e,r),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){const i=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${i} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(e,n,a)}computeBytes(e,n){return e[0]*e[1]*wb(n)}checkCompileCompletion(){for(const[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}async checkCompileCompletionAsync(){const e=[];if(this.gpgpu.parallelCompilationExtension){for(const[,n]of Object.entries(this.binaryCache))e.push(this.checkCompletionAsync_(n));return Promise.all(e)}else{for(const[,n]of Object.entries(this.binaryCache)){const r=new Promise(a=>{try{this.checkCompletion_(n),a(!0)}catch(i){throw i}});e.push(r)}return Promise.all(e)}}async checkCompletionAsync_(e){return this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(e):(await ML(),this.checkCompletionAsync_(e))}checkCompletion_(e){if(this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)===!1)throw console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)===!1?(O9(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(const[,e]of Object.entries(this.binaryCache)){const{uniformLocations:n,customUniformLocations:r,infLoc:a,nanLoc:i,inShapesLocations:o,inTexShapesLocations:s,outShapeLocation:l,outShapeStridesLocation:u,outTexShapeLocation:c}=F9(this.gpgpu,e.program,e.webGLProgram);e.uniformLocations=n,e.customUniformLocations=r,e.infLoc=a,e.nanLoc=i,e.inShapesLocations=o,e.inTexShapesLocations=s,e.outShapeLocation=l,e.outShapeStridesLocation=u,e.outTexShapeLocation=c}}}H2.nextDataId=0;function m2e(t,e){if(e==="float32"||e==="complex64")return t;if(e==="int32"||e==="bool"){const n=e==="int32"?new Int32Array(t.length):new Uint8Array(t.length);for(let r=0;r<n.length;++r)n[r]=Math.round(t[r]);return n}else throw new Error(`Unknown dtype ${e}`)}/**
* @license
* Copyright 2020 Google Inc. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/mT()&&$T("webgl",()=>new H2,2);/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const j4=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`;class bp{constructor(e,n,r){this.variableNames=["A","B"],this.outputShape=Nt(n,r),this.enableShapeUniforms=ua(this.outputShape.length),this.userCode=`
      float binaryOperation(float a, float b) {
        ${e}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const ag=`
  result.r = isNaN.r ? NAN : result.r;
  result.g = isNaN.g ? NAN : result.g;
  result.b = isNaN.b ? NAN : result.b;
  result.a = isNaN.a ? NAN : result.a;
`;class ig{constructor(e,n,r,a=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Nt(n,r);const i=this.outputShape.length;this.enableShapeUniforms=ua(i);let o="";if(a)if(i===0||me(this.outputShape)===1)o=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(o=`
          ${pn(i)} coords = getOutputCoords();
        `,i===1)this.enableShapeUniforms?o+=`
            result.y = (coords + 1) >= outShape ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `:o+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{const s=ca("coords",i);this.enableShapeUniforms?o+=`
            bool nextRowOutOfBounds =
              (${s[i-2]} + 1) >= outShape[${i} - 2];
            bool nextColOutOfBounds =
              (${s[i-1]} + 1) >= outShape[${i} - 1];
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `:o+=`
            bool nextRowOutOfBounds =
              (${s[i-2]} + 1) >= ${this.outputShape[i-2]};
            bool nextColOutOfBounds =
              (${s[i-1]} + 1) >= ${this.outputShape[i-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${e}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${o}

        setOutput(result);
      }
    `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Ua(t){const{inputs:e,backend:n}=t,{x:r}=e;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const g2e={kernelName:zf,backendName:"webgl",kernelFunc:Ua};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Hl(t){const{inputs:e,backend:n}=t,{real:r,imag:a}=e,i=n.makeTensorInfo(r.shape,"complex64"),o=n.texData.get(i.dataId),s=Ua({inputs:{x:r},backend:n}),l=Ua({inputs:{x:a},backend:n});return o.complexTensorInfos={real:s,imag:l},i}const y2e={kernelName:Db,backendName:"webgl",kernelFunc:Hl};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const e7="return (a < 0.) ? b * a : a;",t7=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function b2e(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{alpha:i}=r,o=n.makeTensorInfo([],"float32",Ss(i,"float32")),s=ue().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ig(t7,a.shape,o.shape):new bp(e7,a.shape,o.shape),l=n.runWebGLProgram(s,[a,o],"float32");return n.disposeIntermediateTensorInfo(o),l}const v2e={kernelName:cv,backendName:"webgl",kernelFunc:b2e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const n7="return (a < 0.) ? b * a : a;",r7=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function x2e(t){const{inputs:e,backend:n}=t,{x:r,alpha:a}=e,i=ue().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ig(r7,r.shape,a.shape):new bp(n7,r.shape,a.shape);return n.runWebGLProgram(i,[r,a],"float32")}const w2e={kernelName:_v,backendName:"webgl",kernelFunc:x2e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const vp="if (isnan(x)) return x;";function Rt({opSnippet:t,packedOpSnippet:e,cpuKernelImpl:n,dtype:r}){return({inputs:a,backend:i})=>{const{x:o}=a,s=i,l=r||o.dtype;if(s.shouldExecuteOnCPU([o])&&n!=null){const d=s.texData.get(o.dataId),p=n(d.values,l);return s.makeTensorInfo(o.shape,l,p)}const u=ue().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&e!=null;let c;return u?c=new fc(o.shape,e):c=new Ds(o.shape,t),s.runWebGLProgram(c,[o],l)}}function Er({opSnippet:t,packedOpSnippet:e,checkOutOfBounds:n=!1,supportsComplex:r=!1,cpuKernelImpl:a,dtype:i}){return({inputs:o,backend:s})=>{const{a:l,b:u}=o,c=s;if(r&&l.dtype==="complex64"){const g=c.texData.get(l.dataId),y=c.texData.get(u.dataId),[x,b]=[[g.complexTensorInfos.real,y.complexTensorInfos.real],[g.complexTensorInfos.imag,y.complexTensorInfos.imag]].map(w=>{const[S,C]=w,I={dataId:S.dataId,dtype:S.dtype,shape:l.shape},_={dataId:C.dataId,dtype:C.dtype,shape:u.shape},E=new bp(t,l.shape,u.shape);return c.runWebGLProgram(E,[I,_],ka(S.dtype,C.dtype))}),v=Hl({inputs:{real:x,imag:b},backend:c});return c.disposeIntermediateTensorInfo(x),c.disposeIntermediateTensorInfo(b),v}const d=i||ka(l.dtype,u.dtype);if((l.dtype==="string"||u.dtype==="string"||c.shouldExecuteOnCPU([l,u]))&&a!=null){const g=c.texData.get(l.dataId).values,y=c.texData.get(u.dataId).values,x=l.dtype==="string"?lc(g):g,b=l.dtype==="string"?lc(y):y,[v,w]=a(l.shape,u.shape,x,b,d),S=c.makeTensorInfo(w,d),C=c.texData.get(S.dataId);return C.values=v,S}const p=ue().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&e!=null;let f;return p?f=new ig(e,l.shape,u.shape,n):f=new bp(t,l.shape,u.shape),c.runWebGLProgram(f,[l,u],d)}}function og(t,e=!1){if(t==="linear")return e?n2e:Qxe;if(t==="relu")return e?a2e:Jxe;if(t==="elu")return e?r2e:Zxe;if(t==="relu6")return e?i2e:e2e;if(t==="prelu")return e?r7:n7;if(t==="leakyrelu")return e?t7:e7;if(t==="sigmoid")return e?o2e:t2e;throw new Error(`Activation ${t} has not been implemented for the WebGL backend.`)}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class a7{constructor(e,n,r,a=!1,i=!1,o=!1,s=null,l=!1,u=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r,this.enableShapeUniforms=ua(this.outputShape.length);const c=a?e[1]:e[2],d=Math.ceil(c/2),p=a?"i * 2, rc.y":"rc.y, i * 2",f=i?"rc.z, i * 2":"i * 2, rc.z",g=a?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],y=i?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let x="",b="";s&&(l?x=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:u?x=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:x=`vec4 activation(vec4 x) {
          ${s}
        }`,b="result = activation(result);");const v=o?"result += getBiasAtOutCoords();":"";o&&this.variableNames.push("bias"),l&&this.variableNames.push("preluActivationWeights"),u&&this.variableNames.push("leakyreluAlpha");let w="rc.x",S="rc.x";e[0]<n[0]?w=`int(min(float(rc.x), ${e[0]-1}.))`:n[0]<e[0]&&(S=`int(min(float(rc.x), ${n[0]-1}.))`),this.userCode=`
      ${x}
      // Don't use uniform for sharedDimensionPacked for performance.
      const float sharedDimension = ${d}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        for (int i = 0; i < ${d}; i++) {
          int batchA = ${w};
          int batchB = ${S};
          vec4 a = getMatrixA(batchA, ${p});
          vec4 b = getMatrixB(batchB, ${f});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${g[0]} * ${y[0]});
          result += (${g[1]} * ${y[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${v}

        ${b}

        setOutput(result);
      }
    `}}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const i7={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class o7{constructor(e,n,r){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=Nt(n,r),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${e}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const s7="return a * b;";function U4(t){const{inputs:e,backend:n}=t,{a:r,b:a}=e,i=ka(r.dtype,a.dtype);if(r.dtype==="complex64"){const s=n.texData.get(r.dataId),l=n.texData.get(a.dataId),u=new o7(i7.REAL,r.shape,a.shape),c=new o7(i7.IMAG,r.shape,a.shape),d=[{dataId:s.complexTensorInfos.real.dataId,dtype:s.complexTensorInfos.real.dtype,shape:r.shape},{dataId:s.complexTensorInfos.imag.dataId,dtype:s.complexTensorInfos.imag.dtype,shape:r.shape},{dataId:l.complexTensorInfos.real.dataId,dtype:l.complexTensorInfos.real.dtype,shape:a.shape},{dataId:l.complexTensorInfos.imag.dataId,dtype:l.complexTensorInfos.imag.dtype,shape:a.shape}],p=n.runWebGLProgram(u,d,"float32"),f=n.runWebGLProgram(c,d,"float32"),g=Hl({inputs:{real:p,imag:f},backend:n});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),g}if(n.shouldExecuteOnCPU([r,a])){const s=n.texData.get(r.dataId),l=n.texData.get(a.dataId),[u,c]=kxe(r.shape,a.shape,s.values,l.values,i),d=n.makeTensorInfo(c,i),p=n.texData.get(d.dataId);return p.values=u,d}let o;return ue().getBool("WEBGL_PACK_BINARY_OPERATIONS")?o=new ig(s7,r.shape,a.shape):o=new bp(s7,r.shape,a.shape),n.runWebGLProgram(o,[r,a],i)}const k2e={kernelName:em,backendName:"webgl",kernelFunc:U4};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function S2e(t,e,n){const r=[dp(t.shape),...pp(t.shape)],a={dtype:t.dtype,shape:r,dataId:t.dataId},i=[dp(e),...pp(e)],o=new X9(i,r),s=!0,l=[r],u=n.runWebGLProgram(o,[a],t.dtype,l,s);return{dataId:u.dataId,shape:e,dtype:u.dtype}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Re(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{shape:i}=r,o=n,s=me(a.shape),l=P3(i,s),u=me(l);V(s===u,()=>`The new shape (${l}) has ${u} elements and the old shape (${a.shape}) has ${s} elements. The new shape and old shape must have the same number of elements.`);const c=o.texData.get(a.dataId);return c.isPacked&&!l2(a.shape,l)&&!(c.texture!==null&&l2(c.shape,l))?S2e(a,l,o):(o.incRef(a.dataId),{dataId:a.dataId,shape:l,dtype:a.dtype})}const C2e={kernelName:Pv,backendName:"webgl",kernelFunc:Re};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class l7{constructor(e,n){this.variableNames=["x"];const{windowSize:r,batchSize:a,inSize:i,outSize:o}=e;this.outputShape=[a,o];const s=Math.floor(r/4)*4,l=r%4;let u="sumValue += dot(values, ones);";if(n!=null){const d=1/n;u=`sumValue += dot(values * ${Uu(d)?d.toPrecision(2):d}, ones);`}let c="";i%r>0&&(c=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${c}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        float sumValue = 0.0;

        for (int i = 0; i < ${s}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${u}
        }

        int inIdx = inOffset + ${s};
        if (${l===1}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${u}
        } else if (${l===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${u}
        } else if (${l===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${u}
        }
        setOutput(sumValue);
      }
    `}}/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class N2e{constructor(e,n){this.variableNames=["x"];const{windowSize:r,batchSize:a,inSize:i,outSize:o}=e;this.outputShape=[a,o];let s="0.0",l="";n==="prod"?s="1.0":n==="min"?(s="1.0 / 1e-20",l="min"):n==="max"&&(s="-1.0 / 1e-20",l="max");let u=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="sum"?u="sumValue":n==="prod"?u="prodValue":n==="all"?u="allValue":n==="any"&&(u="anyValue");const c=Math.floor(r/4)*4,d=r%4;let p=`
      if (${n==="sum"}) {
        sumValue += dot(values, ones);
      } else if (${n==="prod"}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${l}(values, minMaxValue);
        if (${n==="min"} || ${n==="max"}) {
          minMaxValue = ${l}(values, minMaxValue);
          bvec4 isNaN = isnan(values);
          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {
            minMaxValue = vec4(NAN);
          }
        }
      }
    `,f="vec4";n==="all"?(s="1.0",p=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,f="bvec4"):n==="any"&&(s="0.0",p=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,f="bvec4");let g="";i%r>0&&(g=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${s};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${g}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        vec4 minMaxValue = vec4(${s});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${c}; i += 4) {
          int inIdx = inOffset + i;
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${p}
        }

        int inIdx = inOffset + ${c};
        if (${d===1}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${p}
        } else if (${d===2}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${p}
        } else if (${d===3}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${p}
        }
        setOutput(${u});
      }
    `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function T2e(t){const e=[];for(;e.length===0||e[e.length-1].outSize!==1;){const n=e.length?e[e.length-1].outSize:t[1],r=qx(n);e.push({inSize:n,windowSize:r,outSize:Math.ceil(n/r)})}return e}function mc(t,e,n,r){const a=T2e(t.shape);let i=t;for(let o=0;o<a.length;o++){const{inSize:s,windowSize:l,outSize:u}=a[o];let c,d;n==="mean"?c=o===0?new l7({windowSize:l,inSize:s,batchSize:t.shape[0],outSize:u},s):new l7({windowSize:l,inSize:s,batchSize:t.shape[0],outSize:u}):c=new N2e({windowSize:l,inSize:s,batchSize:t.shape[0],outSize:u},n),d=i,i=r.runWebGLProgram(c,[i],e),d.dataId!==t.dataId&&r.disposeIntermediateTensorInfo(d)}return i}/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class I2e{constructor(e,n){this.variableNames=["A"];const r=new Array(e.length);for(let o=0;o<r.length;o++)r[o]=e[n[o]];this.outputShape=r,this.rank=r.length;const a=pn(this.rank),i=E2e(n);this.userCode=`
    void main() {
      ${a} resRC = getOutputCoords();
      setOutput(getA(${i}));
    }
    `}}function E2e(t){const e=t.length;if(e>6)throw Error(`Transpose for rank ${e} is not yet supported`);const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(e);for(let a=0;a<t.length;a++)r[t[a]]=n[a];return r.join()}/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class _2e{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const r=new Array(e.length);for(let c=0;c<r.length;c++)r[c]=e[n[c]];if(this.outputShape=r,this.rank=r.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const a=pn(this.rank),i=K9("rc",this.rank),o=new Array(this.rank);for(let c=0;c<n.length;c++)o[n[c]]=i[c];const s=`vec2(${o.slice(-2).join()})`,l=`++${i[this.rank-1]} < ${r[this.rank-1]}`,u=`getChannel(getA(${o.join()}), ${s})`;this.userCode=`
    void main() {
      ${a} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${u};
      if(${l}) {
        result[1] = ${u};
      }
      --${i[this.rank-1]};
      if(++${i[this.rank-2]} < ${r[this.rank-2]}) {
        result[2] = ${u};
        if(${l}) {
          result[3] = ${u};
        }
      }
      setOutput(result);
    }
    `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function c2(t,e,n){const r=ue().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new _2e(t.shape,e):new I2e(t.shape,e);return n.runWebGLProgram(r,[t],t.dtype)}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function O2e(t,e,n,r){const a=e,i=t.shape.length,o=Pt(a,t.shape);let s=o;const l=jn(s,i),u=l!=null;let c=t;u&&(c=c2(t,l,r),s=Un(s.length,i)),Tr("sum",s,i);const[d,p]=Nr(c.shape,s);let f=d;n&&(f=ar(d,o));const g=me(p),y=me(t.shape)/g,x=Re({inputs:{x:c},attrs:{shape:[y,g]},backend:r}),b=gx(t.dtype),v=mc(x,b,"sum",r),w=Re({inputs:{x:v},attrs:{shape:f},backend:r});return r.disposeIntermediateTensorInfo(x),r.disposeIntermediateTensorInfo(v),u&&r.disposeIntermediateTensorInfo(c),w}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function d2(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:i,keepDims:o}=r;return O2e(a,i,o,n)}const $2e={kernelName:jv,backendName:"webgl",kernelFunc:d2};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function da(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{perm:i}=r,o=n,s=a.shape.length,l=new Array(s);for(let c=0;c<l.length;c++)l[c]=a.shape[i[c]];let u;if(o.shouldExecuteOnCPU([a])){const c=o.texData.get(a.dataId).values,d=V4(c,a.shape,a.dtype,i,l);u=o.makeTensorInfo(l,a.dtype);const p=o.texData.get(u.dataId);p.values=d}else u=c2(a,i,o);return u}const R2e={kernelName:Bd,backendName:"webgl",kernelFunc:da};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const u7=1e3;function p2({a:t,b:e,transposeA:n,transposeB:r,backend:a,bias:i=null,preluActivationWeights:o=null,leakyreluAlpha:s=0,activation:l=null}){const u=t.shape.length,c=e.shape.length,d=n?t.shape[u-2]:t.shape[u-1],p=r?e.shape[c-1]:e.shape[c-2],f=n?t.shape[u-1]:t.shape[u-2],g=r?e.shape[c-2]:e.shape[c-1],y=t.shape.slice(0,-2),x=e.shape.slice(0,-2),b=me(y),v=me(x),w=Nt(t.shape.slice(0,-2),e.shape.slice(0,-2)).concat([f,g]);V(d===p,()=>`Error in matMul: inner shapes (${d}) and (${p}) of Tensors with shapes ${t.shape} and ${e.shape} and transposeA=${n} and transposeB=${r} must match.`);const S=n?[b,d,f]:[b,f,d],C=r?[v,g,p]:[v,p,g],I=Re({inputs:{x:t},backend:a,attrs:{shape:S}}),_=Re({inputs:{x:e},backend:a,attrs:{shape:C}}),E=[I,_],A=Math.max(b,v),M=n?I.shape[1]:I.shape[2],L=i!=null,W=o!=null,B=l==="leakyrelu",K=l!=null?og(l,!0):null,X=L||W||B||K!=null;let Q;if((f===1||g===1)&&M>u7&&X===!1){let F=I,Y=_;n&&(F=da({inputs:{x:I},backend:a,attrs:{perm:[0,2,1]}}),E.push(F)),r&&(Y=da({inputs:{x:_},backend:a,attrs:{perm:[0,2,1]}}),E.push(Y));const Z=g!==1,ne=g===1;let se=F;Z&&(se=Re({inputs:{x:F},backend:a,attrs:{shape:[A,M,1]}}),E.push(se));const ce=g===1?2:1;let le=Y;ne&&(le=Re({inputs:{x:Y},backend:a,attrs:{shape:[A,1,M]}}),E.push(le));const ye=U4({inputs:{a:se,b:le},backend:a});Q=d2({inputs:{x:ye},backend:a,attrs:{axis:ce,keepDims:!0}}),E.push(ye)}else{const F=ka(t.dtype,e.dtype),Y=new a7(S,C,[A,f,g],n,r,L,K,W,B),Z=[I,_];if(i!=null&&Z.push(i),W&&Z.push(o),B){const ne=a.makeTensorInfo([],"float32",Ss(s,"float32"));Z.push(ne),E.push(ne)}Q=a.runWebGLProgram(Y,Z,F)}const H=Re({inputs:{x:Q},backend:a,attrs:{shape:w}});E.push(Q);for(const F of E)a.disposeIntermediateTensorInfo(F);return H}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function M2e(t){const{inputs:e,backend:n,attrs:r}=t,{a,b:i,bias:o,preluActivationWeights:s}=e,{transposeA:l,transposeB:u,activation:c,leakyreluAlpha:d}=r;return p2({a,b:i,transposeA:l,transposeB:u,backend:n,bias:o,preluActivationWeights:s,leakyreluAlpha:d,activation:c})}const A2e={kernelName:wm,backendName:"webgl",kernelFunc:M2e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const c7="return abs(x);";function P2e(t){const{inputs:e,backend:n}=t,{x:r}=e;if(n.shouldExecuteOnCPU([r])&&r.dtype!=="complex64"){const i=n.texData.get(r.dataId),o=H9(i.values);return n.makeTensorInfo(r.shape,r.dtype,o)}let a;return ue().getBool("WEBGL_PACK_UNARY_OPERATIONS")?a=new fc(r.shape,c7):a=new Ds(r.shape,c7),n.runWebGLProgram(a,[r],r.dtype)}const D2e={kernelName:Cb,backendName:"webgl",kernelFunc:P2e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const L2e=Pi+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,F2e=Rt({opSnippet:L2e}),B2e={kernelName:bf,backendName:"webgl",kernelFunc:F2e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const z2e=Pi+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`,V2e=Rt({opSnippet:z2e}),W2e={kernelName:vf,backendName:"webgl",kernelFunc:V2e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const d7="return a + b;",j2e=Er({opSnippet:d7,packedOpSnippet:d7,supportsComplex:!0,cpuKernelImpl:nxe}),U2e={kernelName:Fd,backendName:"webgl",kernelFunc:j2e};/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class G2e{constructor(e,n){this.outputShape=[],this.outputShape=e,this.variableNames=n.map((i,o)=>`T${o}`);const r=[];this.variableNames.forEach(i=>{r.push(`float v${i} = get${i}AtOutCoords();`)});const a=this.variableNames.map(i=>`v${i}`).join(" + ");this.userCode=`
      void main() {
        ${r.join(`
        `)}

        float result = ${a};
        setOutput(result);
      }
    `}}/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class H2e{constructor(e,n){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=n.map((i,o)=>`T${o}`);const r=[];this.variableNames.forEach(i=>{r.push(`vec4 v${i} = get${i}AtOutCoords();`)});const a=this.variableNames.map(i=>`v${i}`).join(" + ");this.userCode=`
      void main() {
        ${r.join(`
        `)}

        vec4 result = ${a};
        setOutput(result);
      }
    `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function h2(t){const{inputs:e,backend:n}=t,r=e;if(r.length===1)return Ua({inputs:{x:r[0]},backend:n});if(r.length>ue().get("WEBGL_MAX_TEXTURES_IN_SHADER")){const s=Math.floor(r.length/2),l=h2({inputs:r.slice(0,s),backend:n}),u=h2({inputs:r.slice(s),backend:n});return h2({inputs:[l,u],backend:n})}const a=r.map(s=>s.dtype).reduce((s,l)=>ka(s,l)),i=r.map(s=>s.shape),o=ue().getBool("WEBGL_PACK")?new H2e(r[0].shape,i):new G2e(r[0].shape,i);return n.runWebGLProgram(o,r,a)}const q2e={kernelName:Nb,backendName:"webgl",kernelFunc:h2};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function K2e(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:i,keepDims:o}=r,s=a.shape.length,l=Pt(i,a.shape);let u=l;const c=jn(u,s);let d=a;c!=null&&(d=da({inputs:{x:a},backend:n,attrs:{perm:c}}),u=Un(u.length,s)),Tr("all",u,s);const[p,f]=Nr(d.shape,u),g=me(f),y=Re({inputs:{x:d},backend:n,attrs:{shape:[-1,g]}}),x=mc(y,y.dtype,"all",n);let b;if(o){const v=ar(p,l);b=Re({inputs:{x},backend:n,attrs:{shape:v}})}else b=Re({inputs:{x},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(x),c!=null&&n.disposeIntermediateTensorInfo(d),b}const X2e={kernelName:Tb,backendName:"webgl",kernelFunc:K2e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Y2e(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:i,keepDims:o}=r,s=a.shape.length,l=Pt(i,a.shape);let u=l;const c=jn(u,s);let d=a;c!=null&&(d=da({inputs:{x:a},backend:n,attrs:{perm:c}}),u=Un(u.length,s)),Tr("any",u,s);const[p,f]=Nr(d.shape,u),g=me(f),y=Re({inputs:{x:d},backend:n,attrs:{shape:[-1,g]}}),x=mc(y,y.dtype,"any",n);let b;if(o){const v=ar(p,l);b=Re({inputs:{x},backend:n,attrs:{shape:v}})}else b=Re({inputs:{x},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(x),c!=null&&n.disposeIntermediateTensorInfo(d),b}const Q2e={kernelName:Ib,backendName:"webgl",kernelFunc:Y2e};/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class Z2e{constructor(e,n,r){this.variableNames=["A"];const{windowSize:a,batchSize:i,outSize:o}=e;r||this.variableNames.push("bestIndicesA"),this.outputShape=[i,o];const s=n==="max"?">":"<",l=r?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${a};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${a}; i++) {
          int inIdx = ${l};
          float candidate = getA(batch, inIdx);
          if (candidate ${s} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}}/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class J2e{constructor(e,n,r,a){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,V(e.length>2,()=>`Packed arg${r.charAt(0).toUpperCase()+r.slice(1)} supports only inputs with rank above 2.`);const i=e[e.length-1],o=Math.ceil(i/n);this.outputShape=e.slice(0,-1),o>1&&this.outputShape.push(o),a||this.variableNames.push("bestIndicesA");const s=this.outputShape,l=s.length,u=pn(l),c=ca("coords",l);let d,p;if(o===1){p=l+1;const E=pn(p);d=`
        ${E} sourceLocR = ${E}(${c.join()}, 0);
        ++${c[l-1]};
        ${E} sourceLocG = ${E}(${c.join()}, 0);
        ++${c[l-2]};
        ${E} sourceLocA = ${E}(${c.join()}, 0);
        --${c[l-1]};
        ${E} sourceLocB = ${E}(${c.join()}, 0);
        --${c[l-2]};`}else p=l,d=`
        ${u} sourceLocR = coords;
        ++${c[l-1]};
        ${u} sourceLocG = coords;
        ++${c[l-2]};
        ${u} sourceLocA = coords;
        --${c[l-1]};
        ${u} sourceLocB = coords;
        --${c[l-2]};`;const f=["x","y","z","w","u","v"].slice(0,p),g="."+f[p-1],y=f.map(E=>"int "+E),x=ca("sourceLocR",p-1).concat("inIdx.r"),b=ca("sourceLocG",p-1).concat("inIdx.g"),v=ca("sourceLocB",p-1).concat("inIdx.b"),w=ca("sourceLocA",p-1).concat("inIdx.a"),S=r==="max"?"greaterThan":"lessThan",C=a?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${x.join()}),
                             getBestIndicesAChannel(${b.join()}),
                             getBestIndicesAChannel(${v.join()}),
                             getBestIndicesAChannel(${w.join()})));`,I=`vec4(
            getAChannel(${x.join()}),
            hasNextCol ? getAChannel(${b.join()}) : 0.,
            hasNextRow ? getAChannel(${v.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${w.join()}) : 0.)`,_=a?"":`
      float getBestIndicesAChannel(${y.join()}) {
        return getChannel(getBestIndicesA(${f.join()}),
                                          vec2(${f.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${y.join()}) {
        return getChannel(getA(${f.join()}),
                               vec2(${f.slice(-2).join()}));
      }
      ${_}
      void main() {
        ${u} coords = getOutputCoords();
        bool hasNextCol = ${c[l-1]} < ${s[l-1]-1};
        bool hasNextRow = ${c[l-2]} < ${s[l-2]-1};
        ${d}
        ivec4 srcIdx = ivec4(sourceLocR${g}, sourceLocG${g},
          sourceLocB${g}, sourceLocA${g}) * ${n};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${I};

        for (int i = 0; i < ${n}; i++) {
          inIdx = srcIdx;
          ${C}
          vec4 candidate = ${I};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${S}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function p7(t,e,n,r=null){let a=e.shape[0],i=e.shape[1];r!=null&&(a=r.shape[0],i=r.shape[1]);const o=qx(i),s={windowSize:o,inSize:i,batchSize:a,outSize:Math.ceil(i/o)},l=new Z2e(s,n,r==null),u=[e];r!=null&&u.push(r);const c=t.runWebGLProgram(l,u,"int32");if(c.shape[1]===1)return c;const d=p7(t,e,n,c);return t.disposeIntermediateTensorInfo(c),d}function h7(t,e,n,r=null){const a=r!=null?r.shape:e.shape,i=a[a.length-1],o=qx(i),s=new J2e(a,o,n,r==null),l=r==null?[e]:[e,r],u=t.runWebGLProgram(s,l,"int32");if(u.shape.length===e.shape.length){const c=h7(t,e,n,u);return t.disposeIntermediateTensorInfo(u),c}return u}function f7(t,e,n,r){const a=[n];if(Tr("arg"+r.charAt(0).toUpperCase()+r.slice(1),a,e.shape.length),!ue().getBool("WEBGL_PACK_REDUCE")||e.shape.length<=2){const i=[],o=t.texData.get(e.dataId),s=o!==null&&o.isPacked;let l=e;s&&(l=t.unpackTensor(e),i.push(l));const[u,c]=Nr(l.shape,a),d=me(c),p=Re({inputs:{x:l},backend:t,attrs:{shape:[-1,d]}});i.push(p);const f=p7(t,p,r);i.push(f);const g=Re({inputs:{x:f},backend:t,attrs:{shape:u}});return i.forEach(y=>t.disposeIntermediateTensorInfo(y)),g}return h7(t,e,r)}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function ewe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:i}=r;let o=Pt(i,a.shape);const s=jn(o,a.shape.length);let l=a;const u=[];s!=null&&(l=da({inputs:{x:a},backend:n,attrs:{perm:s}}),u.push(l),o=Un(o.length,l.shape.length)),Tr("argMax",[o[0]],l.shape.length);const c=f7(n,l,o[0],"max");return u.forEach(d=>n.disposeIntermediateTensorInfo(d)),c}const twe={kernelName:Eb,backendName:"webgl",kernelFunc:ewe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function nwe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:i}=r;let o=Pt(i,a.shape);const s=jn(o,a.shape.length);let l=a;const u=[];s!=null&&(l=da({inputs:{x:a},backend:n,attrs:{perm:s}}),u.push(l),o=Un(o.length,l.shape.length)),Tr("argMin",[o[0]],l.shape.length);const c=f7(n,l,o[0],"min");return u.forEach(d=>n.disposeIntermediateTensorInfo(d)),c}const rwe={kernelName:_b,backendName:"webgl",kernelFunc:nwe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const awe=Pi+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,iwe=Rt({opSnippet:awe}),owe={kernelName:xf,backendName:"webgl",kernelFunc:iwe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const swe=Pi+"return log(x + sqrt(x * x + 1.0));",lwe=Rt({opSnippet:swe}),uwe={kernelName:wf,backendName:"webgl",kernelFunc:lwe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const cwe=Pi+`
  return atan(x);
`,dwe=Rt({opSnippet:cwe}),pwe={kernelName:kf,backendName:"webgl",kernelFunc:dwe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const hwe=j4+`
  return atan(a, b);
`,fwe=`
  vec4 result = atan(a, b);
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+ag+`
  return result;
`,mwe=Er({opSnippet:hwe,packedOpSnippet:fwe}),gwe={kernelName:Cf,backendName:"webgl",kernelFunc:mwe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const ywe=Pi+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,bwe=Rt({opSnippet:ywe}),vwe={kernelName:Sf,backendName:"webgl",kernelFunc:bwe};/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class sg{constructor(e,n,r,a=!1,i=!1){if(this.variableNames=["x"],n==="avg"&&r)throw new Error("Cannot compute positions for average pool.");const o=e.filterWidth,s=e.strideHeight,l=e.strideWidth,u=e.dilationHeight,c=e.dilationWidth,d=e.effectiveFilterHeight,p=e.effectiveFilterWidth,f=e.padInfo.top,g=e.padInfo.left;this.outputShape=e.outShape;const y=n==="avg",x=`((batch  * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + d`,b=`(xR * ${e.inWidth} + xC) * ${e.inChannels} + d`;let v="0.0";if(y||(v="-1.0 / 1e-20"),r){const E=">=";this.userCode=`
        const ivec2 strides = ivec2(${s}, ${l});
        const ivec2 pads = ivec2(${f}, ${g});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${d};
              wR += ${u}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${p};
                wC += ${c}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value ${E} currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${a?i?x:b:`wR * ${p} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const w="max";let S=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(S="avgValue / count");const C=Math.floor(o/4)*4,I=o%4,_=`
      if (${y}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${w}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${s}, ${l});
      const ivec2 pads = ivec2(${f}, ${g});
      const float initializationValue = ${v};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${v});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${d};
            wR += ${u}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${C}; wC += 4) {
            int xC = xCCorner + wC * ${c};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              getValue(batch, xR, xC + 2 * ${c}, d),
              getValue(batch, xR, xC + 3 * ${c}, d)
            );

            ${_}
          }

          int xC = xCCorner + ${C};
          if (${I===1}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${_}
          } else if (${I===2}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              initializationValue,
              initializationValue
            );

            ${_}
          } else if (${I===3}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              getValue(batch, xR, xC + 2 * ${c}, d),
              initializationValue
            );

            ${_}
          }
        }
        setOutput(${S});
      }
    `}}class G4{constructor(e,n,r,a=!1,i=!1){if(this.variableNames=["x"],n==="avg"&&r)throw new Error("Cannot compute positions for average pool.");const o=e.filterWidth,s=e.strideDepth,l=e.strideHeight,u=e.strideWidth,c=e.dilationDepth,d=e.dilationHeight,p=e.dilationWidth,f=e.effectiveFilterDepth,g=e.effectiveFilterHeight,y=e.effectiveFilterWidth,x=e.padInfo.front,b=e.padInfo.top,v=e.padInfo.left;this.outputShape=e.outShape;const w=n==="avg";let S="0.0";if(w||(S="-1.0 / 1e-20"),r){const M=">=";this.userCode=`
        const ivec3 strides =
            ivec3(${s}, ${l}, ${u});
        const ivec3 pads = ivec3(${x}, ${b}, ${v});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${f};
              wD += ${c}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${e.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${g};
                wR += ${d}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${y};
                  wC += ${p}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value ${M} currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${a?i?`(((batch * ${e.inDepth} + xD) * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`((xD * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`wD * ${g} * ${y} +
                      wR * ${y} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const C="max";let I=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(I="avgValue / count");const _=Math.floor(o/4)*4,E=o%4,A=`
      if (${w}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${C}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${s}, ${l}, ${u});
      const ivec3 pads = ivec3(${x}, ${b}, ${v});
      const float initializationValue = ${S};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${S});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${f};
            wD += ${c}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${g};
            wR += ${d}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${_}; wC += 4) {
              int xC = xCCorner + wC * ${p};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${p}, ch),
                getValue(batch, xD, xR, xC + 2 * ${p}, ch),
                getValue(batch, xD, xR, xC + 3 * ${p}, ch)
              );

              ${A}
            }

            int xC = xCCorner + ${_};
            if (${E===1}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${A}
            } else if (${E===2}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${p}, ch),
                initializationValue,
                initializationValue
              );

              ${A}
            } else if (${E===3}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${p}, ch),
                getValue(batch, xD, xR, xC + 2 * ${p}, ch),
                initializationValue
              );

              ${A}
            }
          }
          setOutput(${I});
        }
      }
    `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function xwe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e;ng(a,"avgPool");const{filterSize:i,strides:o,pad:s,dimRoundingMode:l}=r,u=1;V(jr(o,u),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${u}'`);const c=Ii(a.shape,i,o,u,s,l);if(c.filterWidth===1&&c.filterHeight===1&&tn(c.inShape,c.outShape))return Ua({inputs:{x:a},backend:n});const d=new sg(c,"avg",!1);return n.runWebGLProgram(d,[a],"float32")}const wwe={kernelName:Ob,backendName:"webgl",kernelFunc:xwe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function kwe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{filterSize:i,strides:o,pad:s,dimRoundingMode:l,dataFormat:u}=r,c=[1,1,1],d=_s(a.shape,i,o,c,s,l,u),p=new G4(d,"avg",!1);return n.runWebGLProgram(p,[a],"float32")}const Swe={kernelName:$b,backendName:"webgl",kernelFunc:kwe};/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class Cwe{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const n=e.filterHeight,r=e.filterWidth,a=e.strideHeight,i=e.strideWidth,o=e.dilationHeight,s=e.dilationWidth,l=e.effectiveFilterHeight,u=e.effectiveFilterWidth,c=l-1-e.padInfo.top,d=u-1-e.padInfo.left,p=1/(n*r);this.userCode=`
      const ivec2 pads = ivec2(${c}, ${d});
      const float avgMultiplier = float(${p});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${l};
            wR += ${o}) {
          float dyR = float(dyRCorner + wR) / ${a}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${u};
            wC+= ${s}) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}}class Nwe{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const n=e.filterDepth,r=e.filterHeight,a=e.filterWidth,i=e.strideDepth,o=e.strideHeight,s=e.strideWidth,l=e.dilationDepth,u=e.dilationHeight,c=e.dilationWidth,d=e.effectiveFilterDepth,p=e.effectiveFilterHeight,f=e.effectiveFilterWidth,g=d-1-e.padInfo.front,y=p-1-e.padInfo.top,x=f-1-e.padInfo.left,b=1/(n*r*a);this.userCode=`
      const ivec3 pads = ivec3(${g}, ${y}, ${x});
      const float avgMultiplier = float(${b});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${d};
            wD += ${l}) {
          float dyD = float(dyDCorner + wD) / ${i}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${p};
              wR += ${u}) {
            float dyR = float(dyRCorner + wR) / ${o}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${f};
                wC += ${c}) {
              float dyC = float(dyCCorner + wC) / ${s}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Twe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:a,input:i}=e,o=i,{filterSize:s,strides:l,pad:u,dimRoundingMode:c}=r,d=[1,1,1],p=_s(o.shape,s,l,d,u,c),f=new Nwe(p);return n.runWebGLProgram(f,[a],o.dtype)}const Iwe={kernelName:j3,backendName:"webgl",kernelFunc:Twe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Ewe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:a,input:i}=e,o=i;ng([a,i],"avgPoolGrad");const{filterSize:s,strides:l,pad:u}=r,c=Ii(o.shape,s,l,1,u),d=new Cwe(c);return n.runWebGLProgram(d,[a],o.dtype)}const _we={kernelName:W3,backendName:"webgl",kernelFunc:Ewe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Owe(t){const{inputs:e,backend:n,attrs:r}=t,{a,b:i}=e,{transposeA:o,transposeB:s}=r;return p2({a,b:i,transposeA:o,transposeB:s,backend:n})}const $we={kernelName:Rb,backendName:"webgl",kernelFunc:Owe};/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class Rwe{constructor(e,n,r,a,i,o){this.outputShape=[],this.variableNames=["x","mean","variance"],Nt(e,n),Nt(e,r);let s="0.0";a!=null&&(Nt(e,a),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");let l="1.0";i!=null&&(Nt(e,i),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${s};
        float scale = ${l};
        float inv = scale * inversesqrt(variance + float(${o}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class Mwe{constructor(e,n,r,a,i,o){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],Nt(e,n),Nt(e,r);let s="vec4(0.0)";a!=null&&(Nt(e,a),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");let l="vec4(1.0)";i!=null&&(Nt(e,i),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = ${s};
        vec4 scale = ${l};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${o}));

        setOutput((x - mean) * inv + offset);
      }
    `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Awe=({inputs:t,backend:e,attrs:n})=>{const{x:r,mean:a,variance:i,offset:o,scale:s}=t;V(a.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),V(o==null||a.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),V(s==null||a.shape.length===s.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:l}=n;l==null&&(l=.001);const u=[r,a,i];let c=null;o!=null&&(c=o.shape,u.push(o));let d=null;s!=null&&(d=s.shape,u.push(s));const p=ue().getBool("WEBGL_PACK_NORMALIZATION")?new Mwe(r.shape,a.shape,i.shape,c,d,l):new Rwe(r.shape,a.shape,i.shape,c,d,l);return e.runWebGLProgram(p,u,u[0].dtype)},Pwe={kernelName:iv,backendName:"webgl",kernelFunc:Awe};/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class Dwe{constructor(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;const n=pn(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const r=Lwe(this.rank);let a;const i=e.map((o,s)=>`sourceLoc.${H4[s]} = start[${s}] + coords.${H4[s]};`);a=`
        ${n} sourceLoc;
        ${n} coords = getOutputCoords();
        ${i.join(`
`)}
      `,this.userCode=`
      void main() {
        ${a}
        setOutput(getSource(${r}));
      }
    `}}const H4=["x","y","z","w","u","v"];function Lwe(t){if(t===1)return"sourceLoc";if(t<=6)return H4.slice(0,t).map(e=>"sourceLoc."+e).join(",");throw Error(`Slicing for rank ${t} is not yet supported`)}/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class Fwe{constructor(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const n=pn(this.rank),r=ca("coords",this.rank),a=ca("sourceLoc",this.rank),i=this.rank===1?"sourceLoc":`vec2(${a.slice(-2).join()})`,o=`getChannel(getSource(${a.join()}), ${i})`,s=`
      result.x = ${o};
      if (++${r[this.rank-1]} < ${e[this.rank-1]}) {
        ++${a[this.rank-1]};
        result.y = ${o};
        --${a[this.rank-1]};
      }
    `,l=this.rank===1?"":`
      --${r[this.rank-1]};
      if (++${r[this.rank-2]} < ${e[this.rank-2]}) {
        ++${a[this.rank-2]};
        result.z = ${o};
        if (++${r[this.rank-1]} < ${e[this.rank-1]}) {
          ++${a[this.rank-1]};
          result.w = ${o};
        }
      }
    `,u=this.rank<=4?`sourceLoc = coords +
            ${n}(${e.map((c,d)=>`start[${d}]`).join()});`:e.map((c,d)=>`${a[d]} = ${r[d]} + start[${d}];`).join(`
`);this.userCode=`
      void main() {
        ${n} coords = getOutputCoords();
        ${n} sourceLoc;
        ${u}
        vec4 result = vec4(0.);
        ${s}
        ${l}
        setOutput(result);
      }
    `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Bwe(t,e,n,r){const a=r.texData.get(t.dataId),i=r.makeTensorInfo(n,t.dtype),o=r.texData.get(i.dataId);Object.assign(o,a),o.refCount=1,o.shape=n,o.dtype=t.dtype;let s=zT(e,qe(t.shape));a.slice&&(s+=a.slice.flatOffset),o.slice={flatOffset:s,origDataId:a.slice&&a.slice.origDataId||t.dataId};const l=r.dataRefCount.get(o.slice.origDataId)||1;return r.dataRefCount.set(o.slice.origDataId,l+1),i}function xp(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{begin:i,size:o}=r,[s,l]=VT(a,i,o);if(LT(a,s,l),me(l)===0)return n.makeTensorInfo(l,a.dtype,[]);if(n.shouldExecuteOnCPU([a])||a.dtype==="string"){const d=n.texData.get(a.dataId),p=Rxe(d.values,s,l,a.shape,a.dtype);return n.makeTensorInfo(l,a.dtype,p)}const{isPacked:u}=n.texData.get(a.dataId),c=BT(a.shape,s,l);if(u||!c){const d=ue().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Fwe(l):new Dwe(l),p=[s];return n.runWebGLProgram(d,[a],a.dtype,p)}return n.uploadToGPU(a.dataId),Bwe(a,s,l,n)}const zwe={kernelName:Wv,backendName:"webgl",kernelFunc:xp};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Vwe=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{blockShape:i,crops:o}=r;V(a.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const s=i.reduce((v,w)=>v*w),l=qm(a.shape,i,s),u=Km(l.length,i.length),c=Xm(a.shape,i,s),d=FI(o,i.length),p=BI(c,o,i.length),f=[],g=Re({inputs:{x:a},backend:n,attrs:{shape:l}}),y=da({inputs:{x:g},backend:n,attrs:{perm:u}}),x=Re({inputs:{x:y},backend:n,attrs:{shape:c}}),b=xp({inputs:{x},backend:n,attrs:{begin:d,size:p}});return f.push(g),f.push(y),f.push(x),f.forEach(v=>n.disposeIntermediateTensorInfo(v)),b},Wwe={kernelName:Mb,backendName:"webgl",kernelFunc:Vwe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function jwe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,weights:i}=e,{size:o}=r,s=n.readSync(a.dataId),l=n.readSync(i.dataId),u=G9(s,l,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,u)}const Uwe={kernelName:Ab,backendName:"webgl",kernelFunc:jwe};/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Gwe(t){const{inputs:e,backend:n}=t,{s0:r,s1:a}=e,i=n.readSync(r.dataId),o=n.readSync(a.dataId),s=Nt(Array.from(i),Array.from(o));return n.makeTensorInfo([s.length],"int32",Int32Array.from(s))}const Hwe={kernelName:Pb,backendName:"webgl",kernelFunc:Gwe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const qwe="return float(a != b);",m7=Er({opSnippet:qwe,cpuKernelImpl:Cxe,dtype:"bool"}),Kwe={kernelName:tm,backendName:"webgl",kernelFunc:m7};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function lg(t){const{inputs:e,backend:n}=t,{input:r}=e,a=n.texData.get(r.dataId);return Ua({inputs:{x:a.complexTensorInfos.real},backend:n})}const Xwe={kernelName:Av,backendName:"webgl",kernelFunc:lg};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Ywe="return float(int(x));";function Qwe(t,e){const n=new Ds(t.shape,Ywe),r=e.runWebGLProgram(n,[t],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function q4(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{dtype:i}=r;if(i==="complex64"){if(a.dtype==="complex64")return Ua({inputs:{x:a},backend:n});const o=Fl(a.shape),s=q4({inputs:{x:a},backend:n,attrs:{dtype:"float32"}}),l=Hl({inputs:{real:s,imag:o},backend:n});return o.dispose(),n.disposeIntermediateTensorInfo(s),l}if(a.dtype==="complex64"){const o=lg({inputs:{input:a},backend:n}),s=q4({inputs:{x:o},backend:n,attrs:{dtype:i}});return n.disposeIntermediateTensorInfo(o),s}if(!D3(a.dtype,i)){const o=Ua({inputs:{x:a},backend:n});return{dataId:o.dataId,shape:o.shape,dtype:i}}if(n.shouldExecuteOnCPU([a])){const o=n.texData.get(a.dataId).values,[s,l,u]=axe(o,a.shape,a.dtype,i);return n.makeTensorInfo(s,l,u)}if(i==="int32")return Qwe(a,n);if(i==="bool"){const o=n.makeTensorInfo([],"bool",tr("bool",1)),s=m7({inputs:{a,b:o},backend:n});return n.disposeIntermediateTensorInfo(o),s}throw new Error(`Error in Cast: failed to cast ${a.dtype} to ${i}`)}const Zwe={kernelName:Nf,backendName:"webgl",kernelFunc:q4};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const g7="return ceil(x);",Jwe=Rt({opSnippet:g7,packedOpSnippet:g7,cpuKernelImpl:ixe}),eke={kernelName:Tf,backendName:"webgl",kernelFunc:Jwe};/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class tke{constructor(e){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class nke{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`
      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function rke(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{clipValueMin:i,clipValueMax:o}=r;let s;ue().getBool("WEBGL_PACK_CLIP")?s=new nke(a.shape):s=new tke(a.shape);const l=[[i],[o]];return n.runWebGLProgram(s,[a],a.dtype,l)}const ake={kernelName:If,backendName:"webgl",kernelFunc:rke};/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class ike{constructor(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function y7(t,e){return{dataId:e.dataId,dtype:e.dtype,shape:t.shape}}function oke(t){const{inputs:e,backend:n}=t,{x:r}=e,a=n.texData.get(r.dataId),i=new ike(r.shape),o=[y7(r,a.complexTensorInfos.real),y7(r,a.complexTensorInfos.imag)];return n.runWebGLProgram(i,o,o[0].dtype)}const ske={kernelName:Lb,backendName:"webgl",kernelFunc:oke};/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class lke{constructor(e){this.outputShape=[],this.outputShape=Fo(e,1),this.variableNames=e.map((o,s)=>`T${s}`);const n=new Array(e.length-1);n[0]=e[0][1];for(let o=1;o<n.length;o++)n[o]=n[o-1]+e[o][1];const r=[`if (yC < ${n[0]}) setOutput(getT0(yR, yC));`];for(let o=1;o<n.length;o++){const s=n[o-1];r.push(`else if (yC < ${n[o]}) setOutput(getT${o}(yR, yC-${s}));`)}const a=n.length,i=n[n.length-1];r.push(`else setOutput(getT${a}(yR, yC-${i}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${r.join(`
        `)}
      }
    `}}/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class uke{constructor(e,n){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=Fo(e,n);const r=this.outputShape,a=r.length,i=pn(a),o=ca("coords",a),s=["x","y","z","w","u","v"].slice(0,a);this.variableNames=e.map((y,x)=>`T${x}`);const l=new Array(e.length-1);l[0]=e[0][n];for(let y=1;y<l.length;y++)l[y]=l[y-1]+e[y][n];const u=s[n],c=s.slice(-2),d=s.join();let p=`if (${u} < ${l[0]}) {
        return getChannel(
            getT0(${d}), vec2(${c.join()}));
        }`;for(let y=1;y<l.length;y++){const x=l[y-1];p+=`
        if (${u} < ${l[y]}  && ${u} >= ${l[y-1]}) {
          return getChannel(
            getT${y}(${f2(s,u,x)}),
            vec2(${f2(c,u,x)}));
        }`}const f=l.length,g=l[l.length-1];p+=`
        return getChannel(
          getT${f}(${f2(s,u,g)}),
          vec2(${f2(c,u,g)}));`,this.userCode=`
      float getValue(${s.map(y=>"int "+y)}) {
        ${p}
      }

      void main() {
        ${i} coords = getOutputCoords();
        vec4 result = vec4(getValue(${o}), 0., 0., 0.);

        ${o[a-1]} = ${o[a-1]} + 1;
        if (${o[a-1]} < ${r[a-1]}) {
          result.g = getValue(${o});
        }

        ${o[a-2]} = ${o[a-2]} + 1;
        if (${o[a-2]} < ${r[a-2]}) {
          result.a = getValue(${o});
        }

        ${o[a-1]} = ${o[a-1]} - 1;
        if (${o[a-2]} < ${r[a-2]} &&
            ${o[a-1]} < ${r[a-1]}) {
          result.b = getValue(${o});
        }
        setOutput(result);
      }
    `}}function f2(t,e,n){const r=t.indexOf(e);return t.map((a,i)=>i===r?`${a} - ${n}`:a).join()}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function m2(t){const{inputs:e,backend:n}=t,{input:r}=e,a=n.texData.get(r.dataId);return Ua({inputs:{x:a.complexTensorInfos.imag},backend:n})}const cke={kernelName:uv,backendName:"webgl",kernelFunc:m2};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function ug(t,e,n){const r=t[0].dtype;if(r==="complex64"){const d=t.map(x=>lg({inputs:{input:x},backend:n})),p=t.map(x=>m2({inputs:{input:x},backend:n})),f=ug(d,e,n),g=ug(p,e,n),y=Hl({inputs:{real:f,imag:g},backend:n});return d.forEach(x=>n.disposeIntermediateTensorInfo(x)),p.forEach(x=>n.disposeIntermediateTensorInfo(x)),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(g),y}let a=n.shouldExecuteOnCPU(t);if(r==="string"&&(a=!0),a){const d=t.map(v=>{const w=[-1,me(v.shape.slice(e))];return Re({inputs:{x:v},backend:n,attrs:{shape:w}})}),p=d.map(v=>({vals:n.readSync(v.dataId),shape:v.shape})),f=Fo(d.map(v=>v.shape),1),g=d[0].shape[0]===1,y=oxe(p,f,r,g),x=Fo(t.map(v=>v.shape),e),b=n.makeTensorInfo(x,r,y);return d.forEach(v=>n.disposeIntermediateTensorInfo(v)),b}const i=ue().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(t.length>i){const d=[];for(let f=0;f<t.length;f+=i){const g=t.slice(f,f+i);d.push(ug(g,e,n))}const p=ug(d,e,n);for(const f of d)n.disposeIntermediateTensorInfo(f);return p}if(ue().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&t[0].shape.length>1){const d=new uke(t.map(p=>p.shape),e);return n.runWebGLProgram(d,t,r)}const{tensors2D:o,outShape:s}=dke(t,e,n),l=new lke(o.map(d=>d.shape)),u=n.runWebGLProgram(l,o,r);o.forEach(d=>n.disposeIntermediateTensorInfo(d));const c=Re({inputs:{x:u},attrs:{shape:s},backend:n});return n.disposeIntermediateTensorInfo(u),c}function dke(t,e,n){const r=Fo(t.map(a=>a.shape),e);return{tensors2D:t.map(a=>Re({inputs:{x:a},attrs:{shape:[-1,me(a.shape.slice(e))]},backend:n})),outShape:r}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function b7(t){const{inputs:e,backend:n,attrs:r}=t,{axis:a}=r,i=Pt(a,e[0].shape)[0],o=e.map(u=>u.shape);PI(o,i);const s=Fo(e.map(u=>u.shape),i);if(me(s)===0)return n.makeTensorInfo(s,e[0].dtype,[]);const l=e.filter(u=>me(u.shape)>0);return l.length===1?Ua({inputs:{x:l[0]},backend:n}):ug(l,i,n)}const pke={kernelName:Fb,backendName:"webgl",kernelFunc:b7};/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class v7{constructor(e,n=!1,r=null,a=!1,i=!1){this.variableNames=["x","W"],this.outputShape=e.outShape;const o=e.padInfo.top,s=e.padInfo.left,l=e.strideHeight,u=e.strideWidth,c=e.dilationHeight,d=e.dilationWidth,p=e.filterHeight,f=e.filterWidth,g=Math.floor(e.inChannels/4)*4,y=e.inChannels%4,x=e.dataFormat==="channelsLast",b=x?1:2,v=x?2:3,w=x?3:1;let S="",C="";r&&(a?S=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:i?S=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:S=`
          float activation(float x) {
            ${r}
          }
        `,C="result = activation(result);");const I=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${S}

      const ivec2 strides = ivec2(${l}, ${u});
      const ivec2 pads = ivec2(${o}, ${s});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${w}];

        ivec2 xRCCorner =
            ivec2(coords[${b}], coords[${v}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${p}; wR++) {
          int xR = xRCorner + wR * ${c};

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${f}; wC++) {
            int xC = xCCorner + wC * ${d};

            if (xC < 0 || xC >= ${e.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${g}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${x}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${y===1}) {

              if (${x}) {
                dotProd +=
                    getX(batch, xR, xC, ${g}) *
                    getW(wR, wC, ${g}, d2);
              } else {
                dotProd +=
                    getX(batch, ${g}, xR, xC) *
                    getW(wR, wC, ${g}, d2);
              }

            } else if (${y===2}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${g}, d2),
                getW(wR, wC, ${g} + 1, d2)
              );

              if (${x}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${g}),
                  getX(batch, xR, xC, ${g} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${g}, xR, xC),
                  getX(batch, ${g} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${y===3}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${g}, d2),
                getW(wR, wC, ${g} + 1, d2),
                getW(wR, wC, ${g} + 2, d2)
              );

              if (${x}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${g}),
                  getX(batch, xR, xC, ${g} + 1),
                  getX(batch, xR, xC, ${g} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${g}, xR, xC),
                  getX(batch, ${g} + 1, xR, xC),
                  getX(batch, ${g} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${I}
        ${C}
        setOutput(result);
      }
    `}}class hke{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const n=e.padInfo.front,r=e.padInfo.top,a=e.padInfo.left,i=e.strideDepth,o=e.strideHeight,s=e.strideWidth,l=e.dilationDepth,u=e.dilationHeight,c=e.dilationWidth,d=e.filterDepth,p=e.filterHeight,f=e.filterWidth,g=Math.floor(e.inChannels/4)*4,y=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${i}, ${o}, ${s});
      const ivec3 pads = ivec3(${n}, ${r}, ${a});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${d}; wF++) {
          int xF = xFCorner + wF * ${l};

          if (xF < 0 || xF >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${p}; wR++) {
            int xR = xRCorner + wR * ${u};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${f}; wC++) {
              int xC = xCCorner + wC * ${c};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${g}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${y===1}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${g}) *
                  getW(wF, wR, wC, ${g}, d2);
              } else if (${y===2}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${g}),
                  getX(batch, xF, xR, xC, ${g} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${g}, d2),
                  getW(wF, wR, wC, ${g} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${y===3}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${g}),
                  getX(batch, xF, xR, xC, ${g} + 1),
                  getX(batch, xF, xR, xC, ${g} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${g}, d2),
                  getW(wF, wR, wC, ${g} + 1, d2),
                  getW(wF, wR, wC, ${g} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class x7{constructor(e,n=!1,r=null,a=!1,i=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=ua(this.outputShape.length);const o=e.padInfo.left,s=e.strideWidth,l=e.dilationWidth,u=e.filterHeight,c=e.filterWidth,d=c;let p=`
       int xR; int xC; int xCOffset;
       vec4 wTexel; vec4 previous; vec4 final;`;for(let x=0;x<c;x++)p+=`
           vec4 xTexelC${x*2};
           int xTexelC${x*2}Ready;
           vec4 xTexelC${x*2+1};
           int xTexelC${x*2+1}Ready;
           vec4 xC${x};`;p+=`
     for (int r = 0; r < ${u}; r++) {
      for (int d1 = 0; d1 < ${e.inChannels}; d1 += 2) {
       `;for(let x=0;x<c;x++)p+=`
           xTexelC${x*2} = vec4(0.0);
           xTexelC${x*2}Ready = 0;
           xTexelC${x*2+1} = vec4(0.0);
           xTexelC${x*2+1}Ready = 0;
           xC${x} = vec4(0.0);`;p+=`
         xR = xRCorner + r * dilations[0];
         if (xR >=0 && xR < inDims[0]) {
       `;for(let x=0;x<(d+1)/2;x++){const b=x*2;if(p+=`
           xC = xCCorner + ${b*l};
           `,s===1){if(b<c&&(o%2===1?(p+=`
                 xCOffset = xC + 1;
                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b}Ready == 0) {
                   xTexelC${b} = getX(batch, xR, xCOffset, d1);

                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${b}.zw = vec2(0.0);
                   }
                   xTexelC${b}Ready = 1;
                 }
               `,l===1&&b>0?p+=`
                 xC${b} = vec4(xTexelC${b-2}.zw, xTexelC${b}.xy);
                 `:p+=`
                   xCOffset = xC + 1 - 2;

                   if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       previous.zw = vec2(0.0);
                     }

                     xC${b} = vec4(previous.zw, xTexelC${b}.xy);
                   } else {
                     xC${b} = vec4(0.0, 0.0, xTexelC${b}.xy);
                   }
                   `):p+=`
                 if (xC >= 0 && xC < inDims[1] && xTexelC${b}Ready == 0) {
                   xTexelC${b} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${b}.zw = vec2(0.0);
                   }
                   xTexelC${b}Ready = 1;
                 }

                 xC${b} = xTexelC${b};
                 `,b+1<c)){const v=o%2===0?vb(l):l;l%2===0&&o%2===1||l%2!==0&&o%2!==1?(p+=`
                   xCOffset = xC + imod(pads[1], 2) + ${v};

                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b+1}Ready == 0) {
                     xTexelC${b+1} = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       xTexelC${b+1}.zw = vec2(0.0);
                     }
                     xTexelC${b+1}Ready = 1;
                   }
                   `,l>1?p+=`
                     xCOffset -= 2;
                     if (xCOffset >= 0 && xCOffset < inDims[1]) {
                      previous = getX(batch, xR, xCOffset, d1);
                      xC${b+1} = vec4(previous.zw, xTexelC${b+1}.xy);
                     } else {
                      xC${b+1} = vec4(0.0, 0.0, xTexelC${b+1}.xy);
                     }
                     `:p+=`
                     xC${b+1} = vec4(xTexelC${b}.zw, xTexelC${b+1}.xy);
                     `):v===1?p+=`
                     xC${b+1} = xTexelC${b};
                     `:p+=`
                     xCOffset = xC + ${v};

                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b+1}Ready == 0) {
                       xTexelC${b+1} = getX(batch, xR, xCOffset, d1);
                       if (xCOffset + 1 >= inDims[1]) {
                         xTexelC${b+1}.zw = vec2(0.0);
                       }
                       xTexelC${b+1}Ready = 1;
                     }

                     xC${b+1} = xTexelC${b+1};
                     `}}else b<c&&(o%2===1?(p+=`
                 xCOffset = xC + 1 - strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b}Ready == 0) {
                   xTexelC${b} = getX(batch, xR, xCOffset, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${b}.zw = vec2(0.0);
                   }
                   xTexelC${b}Ready = 1;
                 }

                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${b+1}Ready == 0) {
                   xTexelC${b+1} = getX(batch, xR, xC + 1, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xC + 2 >= inDims[1]) {
                     xTexelC${b+1}.zw = vec2(0.0);
                   }
                   xTexelC${b+1}Ready = 1;
                 }

                 xC${b} = vec4(xTexelC${b}.zw, xTexelC${b+1}.zw);
               `,b+1<c&&(p+=`
                   final = vec4(0.0);
                   xCOffset = xC + 1 + strides[1];
                   if(xCOffset >= 0 && xCOffset < inDims[1]) {
                     final = getX(batch, xR, xCOffset, d1);
                   }
                   xC${b+1} = vec4(xTexelC${b+1}.xy, final.xy);
                 `)):(p+=`
                 if(xC >= 0 && xC < inDims[1] && xTexelC${b}Ready == 0) {
                   xTexelC${b} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${b}.zw = vec2(0.0);
                   }
                   xTexelC${b}Ready = 1;
                 }

                 xCOffset = xC + strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b+1}Ready == 0) {
                   xTexelC${b+1} = getX(batch, xR, xCOffset, d1);
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${b+1}.zw = vec2(0.);
                   }
                   xTexelC${b+1}Ready = 1;
                 }

                 xC${b} = vec4(
                   xTexelC${b}.xy, xTexelC${b+1}.xy);
               `,b+1<c&&(p+=`
                   xC${b+1} = vec4(xTexelC${b}.zw, xTexelC${b+1}.zw);
                 `)));b<c&&(p+=`
             wTexel = getW(r, ${b}, d1, d2);
             dotProd += xC${b}.xxzz * vec4(wTexel.xy, wTexel.xy);
             if(d1 + 1 < ${e.inChannels}) {
               dotProd += xC${b}.yyww * vec4(wTexel.zw, wTexel.zw);
             }
           `,b+1<c&&(p+=`
               wTexel = getW(r, ${b+1}, d1, d2);
               dotProd += xC${b+1}.xxzz * vec4(wTexel.xy, wTexel.xy);
               if(d1 + 1 < ${e.inChannels}) {
                 dotProd += xC${b+1}.yyww * vec4(wTexel.zw, wTexel.zw);
               }
             `))}p+=`
     }
   `,p+=`
     }
   `,p+=`
     }
   `;let f="",g="";r&&(a?f=`vec4 activation(vec4 a) {
           vec4 b = getPreluActivationWeightsAtOutCoords();
           ${r}
         }`:i?f=`vec4 activation(vec4 a) {
           vec4 b = getLeakyreluAlphaAtOutCoords();
           ${r}
         }`:f=`vec4 activation(vec4 x) {
           ${r}
         }`,g="result = activation(result);");const y=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
       ${f}

       void main() {
         ivec4 coords = getOutputCoords();
         int batch = coords.x;
         ivec2 xRCCorner = coords.yz * strides - pads;
         int d2 = coords.w;
         int xRCorner = xRCCorner.x;
         int xCCorner = xRCCorner.y;

         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
         vec4 dotProd = vec4(0.000000000000001);

         ${p}

         vec4 result = dotProd - vec4(0.000000000000001);
         ${y}
         ${g}
         setOutput(result);
       }
     `}}/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class fke{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=e,this.enableShapeUniforms=ua(this.outputShape.length);const{dataFormat:r}=n,a=la(),i=r==="channelsLast",o=i?1:2,s=i?2:3,l=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${e[2]} && pos < ${e[1]}) {`;let u="";for(let c=0;c<=1;c++)for(let d=0;d<=1;d++)u+=`
          blockIndex = rc.z + ${d};
          pos = rc.y + ${c};

          ${l}
            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];
            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);

            if(d0 < inputShape[${o}] && d0 >= 0) {
              // Use custom imod instead mod. On Intel GPU, mod may generate
              // unexpected value.
              // https://github.com/tensorflow/tfjs/issues/5447
              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];
              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /
                  inChannels);

              if(d1 < inputShape[${s}] && d1 >= 0) {

                ch = imod(pos, inChannels);

                if (${i}) {
                  innerDims = vec2(d1, ch);
                  result[${c*2+d}] = getChannel(
                    getA(rc.x, d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${c*2+d}] = getChannel(
                    getA(rc.x, ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${u}

        ${a.output} = result;
      }
    `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function g2(t,e){const n=t.length;return n>=3?e?[...t.slice(0,-3),t[n-3]*t[n-2],t[n-1]]:[...t.slice(0,-3),t[n-3],t[n-2]*t[n-1]]:!e&&n===1&&t[0]>1?[t[0],1]:null}function w7({x:t,filter:e,convInfo:n,backend:r,bias:a=null,preluActivationWeights:i=null,leakyreluAlpha:o=0,activation:s=null}){const l=t.shape,u=r.texData.get(t.dataId),c=n.inChannels,d=l[0]*l[1]*l[2],p=n.outChannels,f=n.dataFormat==="channelsLast",g=!1,y=!1;let x;const b=[];if(i!=null){const v=g2(i.shape,f);v!=null&&(i=Re({inputs:{x:i},backend:r,attrs:{shape:v}}),b.push(i))}if(a!=null){const v=g2(a.shape,f);v!=null&&(a=Re({inputs:{x:a},backend:r,attrs:{shape:v}}),b.push(a))}if(!((d===1||p===1)&&c>u7)&&u.isPacked&&f&&u.texture!=null&&l[2]%2!==0&&tn(u.shape.slice(-3),l.slice(-3))){const v=l[0]*l[1]*(l[2]+1),w={dataId:t.dataId,shape:[1,v,n.inChannels],dtype:t.dtype},S=u.shape;u.shape=u.shape.slice(),u.shape[u.shape.length-2]++,V(l2(u.shape,w.shape),()=>`packed reshape ${u.shape} to ${w.shape} isn't free`);const C=Re({inputs:{x:e},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}});b.push(C);const I=p2({a:w,b:C,backend:r,transposeA:g,transposeB:y,bias:a,activation:s,preluActivationWeights:i,leakyreluAlpha:o}),_=r.texData.get(I.dataId);V(_.isPacked,()=>"batchMatMul result is expected to be packed"),u.shape=S,_.shape=n.outShape,x=Ua({inputs:{x:I},backend:r}),x.shape=n.outShape,b.push(I)}else{const v=n.outHeight*n.outWidth,w=Re({inputs:{x:t},backend:r,attrs:{shape:f?[n.batchSize,v,n.inChannels]:[n.batchSize,n.inChannels,v]}}),S=Re({inputs:{x:e},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}}),C=p2({a:f?w:S,b:f?S:w,transposeA:!f,transposeB:y,backend:r,bias:a,activation:s,preluActivationWeights:i,leakyreluAlpha:o});x=Re({inputs:{x:C},backend:r,attrs:{shape:n.outShape}}),b.push(w),b.push(S),b.push(C)}for(const v of b)r.disposeIntermediateTensorInfo(v);return x}function k7({x:t,filter:e,convInfo:n,backend:r,bias:a=null,preluActivationWeights:i=null,leakyreluAlpha:o=0,activation:s=null}){const{filterWidth:l,filterHeight:u,inChannels:c,outWidth:d,outHeight:p,dataFormat:f}=n,g=f==="channelsLast",y=l*u*c,x=p*d,b=[n.batchSize,y,x],v=!0,w=!1,S=[];if(i!=null){const F=g2(i.shape,g);F!=null&&(i=Re({inputs:{x:i},backend:r,attrs:{shape:F}}),S.push(i))}if(a!=null){const F=g2(a.shape,g);F!=null&&(a=Re({inputs:{x:a},backend:r,attrs:{shape:F}}),S.push(a))}const C=Re({inputs:{x:e},backend:r,attrs:{shape:[1,y,me(e.shape)/y]}});S.push(C);const I=new fke(b,n),_=[t.shape,[n.padInfo.top,n.padInfo.left],[n.strideHeight,n.strideWidth],[n.dilationHeight,n.dilationWidth],[n.inChannels],[n.filterWidth*n.inChannels],[n.outWidth]],E=r.runWebGLProgram(I,[t],"float32",_),A=Re({inputs:{x:E},backend:r,attrs:{shape:b}});S.push(E),S.push(A);const M=a!=null,L=i!=null,W=s==="leakyrelu",B=s?og(s,!0):null,K=new a7(g?A.shape:C.shape,g?C.shape:A.shape,g?[n.batchSize,x,n.outChannels]:[n.batchSize,n.outChannels,x],v,w,M,B,L,W),X=g?[A,C]:[C,A];if(a&&X.push(a),L&&X.push(i),W){const F=r.makeTensorInfo([],"float32",Ss(o,"float32"));X.push(F),S.push(F)}const Q=r.runWebGLProgram(K,X,"float32"),H=Re({inputs:{x:Q},backend:r,attrs:{shape:n.outShape}});S.push(Q);for(const F of S)r.disposeIntermediateTensorInfo(F);return H}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function mke(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,filter:i}=e,{strides:o,pad:s,dataFormat:l,dilations:u,dimRoundingMode:c}=r,d=Os(l),p=hr(a.shape,i.shape,o,u,s,c,!1,d);let f;if(p.filterHeight===1&&p.filterWidth===1&&p.dilationHeight===1&&p.dilationWidth===1&&p.strideHeight===1&&p.strideWidth===1&&(p.padInfo.type==="SAME"||p.padInfo.type==="VALID"))f=w7({x:a,filter:i,convInfo:p,backend:n});else if(p.strideWidth<=2&&d==="channelsLast"&&ue().getBool("WEBGL_EXP_CONV")){const y=new x7(p),x=[[p.padInfo.top,p.padInfo.left],[p.strideHeight,p.strideWidth],[p.dilationHeight,p.dilationWidth],[p.inHeight,p.inWidth]];f=n.runWebGLProgram(y,[a,i],"float32",x)}else if(ue().getBool("WEBGL_CONV_IM2COL"))f=k7({x:a,filter:i,convInfo:p,backend:n});else{const y=new v7(p);f=n.runWebGLProgram(y,[a,i],"float32")}const g=Re({inputs:{x:f},backend:n,attrs:{shape:p.outShape}});return n.disposeIntermediateTensorInfo(f),g}const gke={kernelName:Bb,backendName:"webgl",kernelFunc:mke};/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class yke{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideHeight,r=e.strideWidth,a=e.padInfo.top,i=e.padInfo.left,o=e.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${a};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${r} - ${i};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              if (${o}) {
                float dyValue = getDy(b, yR, yC, d2);
                float xValue = getX(b, xR, xC, d1);
                dotProd += (xValue * dyValue);
              } else {
                float dyValue = getDy(b, d2, yR, yC);
                float xValue = getX(b, d1, xR, xC);
                dotProd += (xValue * dyValue);
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class bke{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterHeight,r=e.filterWidth,a=e.strideHeight,i=e.strideWidth,o=e.dataFormat==="channelsLast",s=n-1-e.padInfo.top,l=r-1-e.padInfo.left,u=o?1:2,c=o?2:3,d=o?3:1;this.userCode=`
      const ivec2 pads = ivec2(${s}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${d}];

        ivec2 dyCorner = ivec2(coords[${u}], coords[${c}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${a}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${r} - 1 - wC;

            for (int d2 = 0; d2 < ${e.outChannels}; d2++) {

              if (${o}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class vke{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideDepth,r=e.strideHeight,a=e.strideWidth,i=e.padInfo.front,o=e.padInfo.top,s=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yF = 0; yF < ${e.outDepth}; yF++) {
            int xF = wF + yF * ${n} - ${i};

            if (xF < 0 || xF >= ${e.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${e.outHeight}; yR++) {
              int xR = wR + yR * ${r} - ${o};

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${e.outWidth}; yC++) {
                int xC = wC + yC * ${a} - ${s};

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class xke{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterDepth,r=e.filterHeight,a=e.filterWidth,i=e.strideDepth,o=e.strideHeight,s=e.strideWidth,l=n-1-e.padInfo.front,u=r-1-e.padInfo.top,c=a-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${l}, ${u}, ${c});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${n}; wF++) {
          float dyF = float(dyFCorner + wF) / ${i}.0;

          if (dyF < 0.0 || dyF >= ${e.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${n} - 1 - wF;

          for (int wR = 0; wR < ${r}; wR++) {
            float dyR = float(dyRCorner + wR) / ${o}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${r} - 1 - wR;

            for (int wC = 0; wC < ${a}; wC++) {
              float dyC = float(dyCCorner + wC) / ${s}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${a} - 1 - wC;

              for (int d2 = 0; d2 < ${e.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function wke(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,dy:i}=e,{strides:o,pad:s,dataFormat:l,dimRoundingMode:u,filterShape:c}=r,d=Os(l),p=hr(a.shape,c,o,1,s,u,!1,d),f=new yke(p);return n.runWebGLProgram(f,[a,i],"float32")}const kke={kernelName:zb,backendName:"webgl",kernelFunc:wke};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Ske(t){const{inputs:e,backend:n,attrs:r}=t,{dy:a,filter:i}=e,{inputShape:o,strides:s,pad:l,dataFormat:u,dimRoundingMode:c}=r,d=Os(u),p=hr(o,i.shape,s,1,l,c,!1,d),f=new bke(p);return n.runWebGLProgram(f,[a,i],"float32")}const Cke={kernelName:Vb,backendName:"webgl",kernelFunc:Ske};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Nke(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,filter:i}=e,{strides:o,pad:s,dilations:l}=r,u=Dl(a.shape,i.shape,o,l,s),c=new hke(u);return n.runWebGLProgram(c,[a,i],"float32")}const Tke={kernelName:Wb,backendName:"webgl",kernelFunc:Nke};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Ike(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,dy:i}=e,{strides:o,pad:s,filterShape:l}=r,u=Dl(a.shape,l,o,1,s),c=new vke(u);return n.runWebGLProgram(c,[a,i],"float32")}const Eke={kernelName:U3,backendName:"webgl",kernelFunc:Ike};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function _ke(t){const{inputs:e,backend:n,attrs:r}=t,{dy:a,filter:i}=e,{pad:o,strides:s,inputShape:l}=r,u=Dl(l,i.shape,s,1,o),c=new xke(u);return n.runWebGLProgram(c,[a,i],"float32")}const Oke={kernelName:jb,backendName:"webgl",kernelFunc:_ke};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const $ke=vp+`
  return cos(x);
`,Rke=Rt({opSnippet:$ke}),Mke={kernelName:Ef,backendName:"webgl",kernelFunc:Rke};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Ake=`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`,Pke=Rt({opSnippet:Ake}),Dke={kernelName:_f,backendName:"webgl",kernelFunc:Pke};/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class Lke{constructor(e,n,r,a,i){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[o,s,l,u]=e,[c]=n,[d,p]=r;this.outputShape=[c,d,p,u];const f=a==="bilinear"?1:0,[g,y]=[`${s-1}.0`,`${l-1}.0`],[x,b,v]=d>1?[`${(s-1)/(d-1)}`,"(y2-y1) * height_ratio",`y1*${g} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${g}`],[w,S,C]=p>1?[`${(l-1)/(p-1)}`,"(x2-x1) * width_ratio",`x1*${y} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${y}`];this.userCode=`
      const float height_ratio = float(${x});
      const float width_ratio = float(${w});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${o}) {
          return;
        }

        float height_scale = ${b};
        float width_scale = ${S};

        float in_y = ${v};
        if( in_y < 0.0 || in_y > ${g} ) {
          setOutput(float(${i}));
          return;
        }
        float in_x = ${C};
        if( in_x < 0.0 || in_x > ${y} ) {
          setOutput(float(${i}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${f} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Fke=t=>{const{inputs:e,backend:n,attrs:r}=t,{image:a,boxes:i,boxInd:o}=e,{cropSize:s,method:l,extrapolationValue:u}=r,c=new Lke(a.shape,i.shape,s,l,u);return n.runWebGLProgram(c,[a,i,o],"float32")},Bke={kernelName:Hb,backendName:"webgl",kernelFunc:Fke};var cg;(function(t){t.Prod="*",t.Sum="+"})(cg||(cg={}));class S7{constructor(e,n,r,a){this.op=e,this.outputShape=n,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const i=this.outputShape.length,o=this.op===cg.Prod?"1.0":"0.0",s=r?o:`getX(${C7(i,"coords",this.op)})`,l=this.outputShape[this.outputShape.length-1];let u="",c="";r?(u=a?`end != ${l-1}`:"end != 0",c=a?"end + 1":"end - 1"):(u=a?`end + pow2 < ${l}`:"end >= pow2",c=a?"end + pow2":"end - pow2"),this.userCode=`
      void main() {
        ${pn(i)} coords = getOutputCoords();
        int end = ${N7(i,"coords",this.op)};
        float val = ${s};
        int pow2 = int(pow(2.0, index));
        if (${u}) {
          int idx = ${c};
          ${N7(i,"coords",this.op)} = idx;
          val ${this.op}= getX(${C7(i,"coords",this.op)});
        }
        setOutput(val);
      }
    `}}function C7(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.x, ${e}.y`;if(t===3)return`${e}.x, ${e}.y, ${e}.z`;if(t===4)return`${e}.x, ${e}.y, ${e}.z, ${e}.w`;throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}function N7(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.y`;if(t===3)return`${e}.z`;if(t===4)return`${e}.w`;throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function T7(t,e,n,r,a,i){const o=e.shape.length,s=jn([r],o);let l=e;s!=null&&(l=da({inputs:{x:e},backend:n,attrs:{perm:s}}));const u=Un(1,o)[0];if(u!==o-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${e.shape.length-1} but got axis=${r}`);const c=l.shape[u];let d=Ua({inputs:{x:l},backend:n});for(let p=0;p<=Math.ceil(Math.log2(c))-1;p++){const f=new S7(t,l.shape,!1,i),g=[[p]],y=d;d=n.runWebGLProgram(f,[d],d.dtype,g),n.disposeIntermediateTensorInfo(y)}if(a){const p=new S7(t,l.shape,a,i),f=d;d=n.runWebGLProgram(p,[d],d.dtype),n.disposeIntermediateTensorInfo(f)}if(s!=null){const p=Fm(s),f=da({inputs:{x:d},backend:n,attrs:{perm:p}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(l),f}return d}/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function zke(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:i,exclusive:o,reverse:s}=r;return T7(cg.Prod,a,n,i,o,s)}const Vke={kernelName:Ub,backendName:"webgl",kernelFunc:zke};/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Wke(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:i,exclusive:o,reverse:s}=r;return T7(cg.Sum,a,n,i,o,s)}const jke={kernelName:Gb,backendName:"webgl",kernelFunc:Wke};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Uke(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,weights:i}=e,{size:o,binaryOutput:s}=r;if(a.shape.length===1){const l=n.readSync(a.dataId),u=n.readSync(i.dataId),c=G9(l,u,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,c)}else if(a.shape.length===2){const l=n.bufferSync(a),u=n.bufferSync(i),c=rxe(l,u,o,s);return n.makeTensorInfo(c.shape,i.dtype,c.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${a.shape.length}.`)}const Gke={kernelName:qb,backendName:"webgl",kernelFunc:Uke};/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class Hke{constructor(e,n,r){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=n,this.dataFormat=r,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${n};
      int offset_h = imod(h, ${n});
      int in_w = w / ${n};
      int offset_w = imod(w, ${n});
      int offset_d = (offset_h * ${n} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function qke(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{blockSize:i,dataFormat:o}=r,s=a.shape[0],l=o==="NHWC"?a.shape[1]:a.shape[2],u=o==="NHWC"?a.shape[2]:a.shape[3],c=o==="NHWC"?a.shape[3]:a.shape[1],d=l*i,p=u*i,f=c/(i*i),g=o==="NHWC"?[s,d,p,f]:[s,f,d,p],y=new Hke(g,i,o);return n.runWebGLProgram(y,[a],a.dtype)}const Kke={kernelName:Kb,backendName:"webgl",kernelFunc:qke};/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class I7{constructor(e,n=!1,r=null,a=!1,i=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=ua(this.outputShape.length);const o=e.filterHeight,s=e.filterWidth,l=e.outChannels/e.inChannels;let u="",c="";r&&(a?u=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:i?u=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:u=`
          float activation(float x) {
            ${r}
          }
        `,c="result = activation(result);");const d=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${u}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${l};
        int q = d2 - d1 * ${l};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${o}; wR++) {
          int xR = xRCorner + wR * dilations[0];

          if (xR < 0 || xR >= inDims[0]) {
            continue;
          }

          for (int wC = 0; wC < ${s}; wC++) {
            int xC = xCCorner + wC * dilations[1];

            if (xC < 0 || xC >= inDims[1]) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${d}
        ${c}
        setOutput(result);
      }
    `}}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class E7{constructor(e,n=!1,r=null,a=!1,i=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=ua(this.outputShape.length);const o=e.outChannels/e.inChannels,s=e.padInfo.left,l=e.strideWidth,u=e.dilationWidth,c=e.filterHeight,d=e.filterWidth,p=d;let f=`
      int xR; int xC; int xCOffset;
      vec4 wTexel; vec4 previous; vec4 final;`;for(let b=0;b<d;b++)f+=`
          vec4 xTexelC${b*2};
          int xTexelC${b*2}Ready;
          vec4 xTexelC${b*2+1};
          int xTexelC${b*2+1}Ready;
          vec4 xC${b};`;f+=`
    for (int r = 0; r < ${c}; r++) {
      `;for(let b=0;b<d;b++)f+=`
          xTexelC${b*2} = vec4(0.0);
          xTexelC${b*2}Ready = 0;
          xTexelC${b*2+1} = vec4(0.0);
          xTexelC${b*2+1}Ready = 0;
          xC${b} = vec4(0.0);`;f+=`
        xR = xRCorner + r * dilations[0];
        if (xR >=0 && xR < inDims[0]) {
      `;for(let b=0;b<(p+1)/2;b++){const v=b*2;if(f+=`
          xC = xCCorner + ${v*u};
          `,l===1){if(v<d&&(s%2===1?(f+=`
                xCOffset = xC + 1;
                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v}Ready == 0) {
                  xTexelC${v} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${v}.zw = vec2(0.0);
                  }
                  xTexelC${v}Ready = 1;
                }
              `,u===1&&v>0?f+=`
                xC${v} = vec4(xTexelC${v-2}.zw, xTexelC${v}.xy);
                `:f+=`
                  xCOffset = xC + 1 - 2;

                  if (xCOffset >= 0 && xCOffset < inDims[1]) {
                    previous = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      previous.zw = vec2(0.0);
                    }

                    xC${v} = vec4(previous.zw, xTexelC${v}.xy);
                  } else {
                    xC${v} = vec4(0.0, 0.0, xTexelC${v}.xy);
                  }
                  `):f+=`
                if (xC >= 0 && xC < inDims[1] && xTexelC${v}Ready == 0) {
                  xTexelC${v} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${v}.zw = vec2(0.0);
                  }
                  xTexelC${v}Ready = 1;
                }

                xC${v} = xTexelC${v};
                `,v+1<d)){const w=s%2===0?vb(u):u;u%2===0&&s%2===1||u%2!==0&&s%2!==1?(f+=`
                  xCOffset = xC + imod(pads[1], 2) + ${w};

                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v+1}Ready == 0) {
                    xTexelC${v+1} = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      xTexelC${v+1}.zw = vec2(0.0);
                    }
                    xTexelC${v+1}Ready = 1;
                  }
                  `,u>1?f+=`
                    xCOffset -= 2;
                    if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);
                     xC${v+1} = vec4(previous.zw, xTexelC${v+1}.xy);
                    } else {
                     xC${v+1} = vec4(0.0, 0.0, xTexelC${v+1}.xy);
                    }
                    `:f+=`
                    xC${v+1} = vec4(xTexelC${v}.zw, xTexelC${v+1}.xy);
                    `):w===1?f+=`
                    xC${v+1} = xTexelC${v};
                    `:f+=`
                    xCOffset = xC + ${w};

                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v+1}Ready == 0) {
                      xTexelC${v+1} = getX(batch, xR, xCOffset, d1);
                      if (xCOffset + 1 >= inDims[1]) {
                        xTexelC${v+1}.zw = vec2(0.0);
                      }
                      xTexelC${v+1}Ready = 1;
                    }

                    xC${v+1} = xTexelC${v+1};
                    `}}else v<d&&(s%2===1?(f+=`
                xCOffset = xC + 1 - strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v}Ready == 0) {
                  xTexelC${v} = getX(batch, xR, xCOffset, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${v}.zw = vec2(0.0);
                  }
                  xTexelC${v}Ready = 1;
                }

                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${v+1}Ready == 0) {
                  xTexelC${v+1} = getX(batch, xR, xC + 1, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xC + 2 >= inDims[1]) {
                    xTexelC${v+1}.zw = vec2(0.0);
                  }
                  xTexelC${v+1}Ready = 1;
                }

                xC${v} = vec4(xTexelC${v}.zw, xTexelC${v+1}.zw);
              `,v+1<d&&(f+=`
                  final = vec4(0.0);
                  xCOffset = xC + 1 + strides[1];
                  if(xCOffset >= 0 && xCOffset < inDims[1]) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xC${v+1} = vec4(xTexelC${v+1}.xy, final.xy);
                `)):(f+=`
                if(xC >= 0 && xC < inDims[1] && xTexelC${v}Ready == 0) {
                  xTexelC${v} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${v}.zw = vec2(0.0);
                  }
                  xTexelC${v}Ready = 1;
                }

                xCOffset = xC + strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v+1}Ready == 0) {
                  xTexelC${v+1} = getX(batch, xR, xCOffset, d1);
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${v+1}.zw = vec2(0.);
                  }
                  xTexelC${v+1}Ready = 1;
                }

                xC${v} = vec4(
                  xTexelC${v}.xy, xTexelC${v+1}.xy);
              `,v+1<d&&(f+=`
                  xC${v+1} = vec4(xTexelC${v}.zw, xTexelC${v+1}.zw);
                `)));v<d&&(f+=`
            wTexel = getW(r, ${v}, d1, q);
            dotProd += xC${v} * vec4(wTexel.xz, wTexel.xz);
          `,v+1<d&&(f+=`
              wTexel = getW(r, ${v+1}, d1, q);
              dotProd += xC${v+1} * vec4(wTexel.xz, wTexel.xz);
            `))}f+=`
    }
  `,f+=`
      }
    `;let g="",y="";r&&(a?g=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:i?g=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:g=`vec4 activation(vec4 x) {
          ${r}
        }`,y="result = activation(result);");const x=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${g}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${o};
        int q = d2 - d1 * ${o};
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
        vec4 dotProd = vec4(0.000000000000001);

        ${f}

        vec4 result = dotProd - vec4(0.000000000000001);
        ${x}
        ${y}
        setOutput(result);
      }
    `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Xke(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,filter:i}=e,{strides:o,pad:s,dilations:l,dimRoundingMode:u}=r;let c=l;c==null&&(c=[1,1]),V(jr(o,c),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${o} and dilations '${c}'`);const d=hr(a.shape,i.shape,o,c,s,u,!0);let p;ue().getBool("WEBGL_PACK_DEPTHWISECONV")&&d.strideWidth<=2&&d.outChannels/d.inChannels===1?p=new E7(d):p=new I7(d);const f=[[d.padInfo.top,d.padInfo.left],[d.strideHeight,d.strideWidth],[d.dilationHeight,d.dilationWidth],[d.inHeight,d.inWidth]];return n.runWebGLProgram(p,[a,i],"float32",f)}const Yke={kernelName:Xb,backendName:"webgl",kernelFunc:Xke};/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class Qke{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideHeight,r=e.strideWidth,a=e.padInfo.top,i=e.padInfo.left,o=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${o} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${a};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${r} - ${i};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class Zke{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterHeight,r=e.filterWidth,a=e.strideHeight,i=e.strideWidth,o=n-1-e.padInfo.top,s=r-1-e.padInfo.left,l=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${o}, ${s});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${a}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${r} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${l}; dm++) {
              int d2 = d1 * ${l} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Jke(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,dy:i}=e,{strides:o,dilations:s,pad:l,dimRoundingMode:u,filterShape:c}=r,d=hr(a.shape,c,o,s,l,u,!0),p=new Qke(d);return n.runWebGLProgram(p,[a,i],"float32")}const eSe={kernelName:Yb,backendName:"webgl",kernelFunc:Jke};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function tSe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:a,filter:i}=e,{strides:o,dilations:s,pad:l,dimRoundingMode:u,inputShape:c}=r,d=hr(c,i.shape,o,s,l,u,!0),p=new Zke(d);return n.runWebGLProgram(p,[a,i],"float32")}const nSe={kernelName:Qb,backendName:"webgl",kernelFunc:tSe};/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class rSe{constructor(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function aSe(t){const{inputs:e,backend:n}=t,{x:r}=e,a=[...r.shape,...r.shape],i=me(r.shape),o=Re({inputs:{x:r},backend:n,attrs:{shape:[i]}}),s=new rSe(i),l=n.runWebGLProgram(s,[o],o.dtype),u=Re({inputs:{x:l},backend:n,attrs:{shape:a}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(l),u}const iSe={kernelName:Zb,backendName:"webgl",kernelFunc:aSe};/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class oSe{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const{inHeight:n,inWidth:r,padInfo:a,strideHeight:i,strideWidth:o,filterHeight:s,filterWidth:l,dilationHeight:u,dilationWidth:c}=e,{top:d,left:p}=a;this.userCode=`
      const ivec2 strides = ivec2(${i}, ${o});
      const ivec2 pads = ivec2(${d}, ${p});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${s}; h++) {
          int hIn = hBeg + h * ${u};

          if (hIn >= 0 && hIn < ${n}) {
            for (int w = 0; w < ${l}; w++) {
              int wIn = wBeg + w * ${c};

              if (wIn >= 0 && wIn < ${r}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function sSe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,filter:i}=e,{strides:o,pad:s,dilations:l}=r,u=Am(a.shape,i.shape,o,s,"NHWC",l);let c;const d=new oSe(u);c=n.runWebGLProgram(d,[a,i],"float32");const p=Re({inputs:{x:c},backend:n,attrs:{shape:u.outShape}});return n.disposeIntermediateTensorInfo(c),p}const lSe={kernelName:Jb,backendName:"webgl",kernelFunc:sSe};/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function uSe(t){const{inputs:e,backend:n,attrs:r}=t,{equation:a}=r,i=e,{allDims:o,summedDims:s,idDims:l}=YI(a,i.length);ZI(o.length,l,i);const{path:u,steps:c}=JI(s,l),d=c.length;let p=null,f=o.length;const g=[];for(let y=0;y<d;++y){for(const x of c[y]){const{permutationIndices:b,expandDims:v}=QI(f,l[x]);let w;e4(b)?w=i[x]:(w=da({inputs:{x:i[x]},backend:n,attrs:{perm:b}}),g.push(w));const S=w.shape.slice();for(let C=0;C<v.length;++C)S.splice(v[C],0,1);tn(w.shape,S)||(w=Re({inputs:{x:w},backend:n,attrs:{shape:S}}),g.push(w)),p===null?p=w:(p=U4({inputs:{a:w,b:p},backend:n}),g.push(p))}y<d-1&&(u[y]>=0&&(p=d2({inputs:{x:p},backend:n,attrs:{axis:u[y]-(o.length-f),keepDims:!1}}),g.push(p)),f--)}for(const y of g)y!==p&&n.disposeIntermediateTensorInfo(y);return p}const cSe={kernelName:ev,backendName:"webgl",kernelFunc:uSe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const dSe="return (x >= 0.0) ? x : (exp(x) - 1.0);",pSe=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,hSe=Rt({opSnippet:dSe,packedOpSnippet:pSe}),fSe={kernelName:$f,backendName:"webgl",kernelFunc:hSe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const mSe="return (b >= 1.0) ? a : a * (b + 1.0);",gSe=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,ySe=t=>{const{inputs:e,backend:n}=t,{dy:r,y:a}=e,i=ue().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ig(gSe,r.shape,a.shape):new bp(mSe,r.shape,a.shape);return n.runWebGLProgram(i,[r,a],r.dtype)},bSe={kernelName:q3,backendName:"webgl",kernelFunc:ySe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const vSe=`
  return vec4(equal(a, b));
`,xSe="return float(a == b);",wSe=Er({opSnippet:xSe,packedOpSnippet:vSe,dtype:"bool",cpuKernelImpl:sxe}),kSe={kernelName:Mf,backendName:"webgl",kernelFunc:wSe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const SSe=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${WI};
  float a1 = ${jI};
  float a2 = ${UI};
  float a3 = ${GI};
  float a4 = ${HI};
  float a5 = ${qI};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`,CSe=Rt({opSnippet:SSe}),NSe={kernelName:Rf,backendName:"webgl",kernelFunc:CSe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const TSe=vp+`
  return exp(x);
`,ISe=`
  vec4 result = exp(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,_7=Rt({opSnippet:TSe,packedOpSnippet:ISe,cpuKernelImpl:lxe,dtype:"float32"}),ESe={kernelName:Af,backendName:"webgl",kernelFunc:_7};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function K4(t){const{inputs:e,attrs:n,backend:r}=t,{dim:a}=n,{input:i}=e,o=i.shape.length,s=i.shape.slice();let l=a;return a<0&&(V(-(o+1)<=a,()=>`Axis must be in the interval [${-(o+1)}, ${o}]`),l=o+a+1),s.splice(l,0,1),Re({inputs:{x:i},backend:r,attrs:{shape:s}})}const _Se={kernelName:tv,backendName:"webgl",kernelFunc:K4};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const O7="return exp(x) - 1.0;",OSe=Rt({opSnippet:O7,packedOpSnippet:O7,cpuKernelImpl:uxe}),$Se={kernelName:Pf,backendName:"webgl",kernelFunc:OSe};/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class $7{constructor(e,n,r){this.variableNames=["real","imag"];const a=n[1];this.outputShape=n;const i=r?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,o=r?`${a}.0`:"1.0";let s;if(e==="real")s="return real * expR - imag * expI;";else if(e==="imag")s="return real * expI + imag * expR;";else throw new Error(`FFT component must be either "real" or "imag", got ${e}.`);this.userCode=`
      const float exponentMultiplier = ${i};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${s}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${a});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${a}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${o};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function R7(t,e,n){const r=n.texData.get(t.dataId),a=me(t.shape),i=t.shape[t.shape.length-1],o=a/i,s=Re({inputs:{x:t},backend:n,attrs:{shape:[o,i]}}),l=s.shape,u=new $7("real",l,e),c=new $7("imag",l,e),d=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:l},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:l}],p=n.runWebGLProgram(u,d,"float32"),f=n.runWebGLProgram(c,d,"float32"),g=Hl({inputs:{real:p,imag:f},backend:n});n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f);const y=Re({inputs:{x:g},backend:n,attrs:{shape:t.shape}});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(g),y}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function RSe(t){const{inputs:e,backend:n}=t,{input:r}=e;return R7(r,!1,n)}const MSe={kernelName:nv,backendName:"webgl",kernelFunc:RSe};/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class ASe{constructor(e,n){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode=`
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function dg(t){const{backend:e,attrs:n}=t,{shape:r,value:a}=n;let{dtype:i}=n;if(i=i||Ld(a),i==="string"){const o=nr(i,me(r));return o.fill(a),e.makeTensorInfo(r,i,o)}else{const o=new ASe(r,a),s=[[a]];return e.runWebGLProgram(o,[],i,s)}}const PSe={kernelName:rv,backendName:"webgl",kernelFunc:dg};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class DSe{constructor(e){this.variableNames=["Image"],this.outputShape=[];const n=e[2];this.outputShape=e,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${n} - x - 1;
          float outputValue;
          if(coordX >= 0 && coordX < ${n}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const LSe={kernelName:av,backendName:"webgl",kernelFunc:({inputs:t,backend:e})=>{const{image:n}=t,r=e,a=new DSe(n.shape);return r.runWebGLProgram(a,[n],n.dtype)}};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const M7="return floor(x);",FSe=Rt({opSnippet:M7,packedOpSnippet:M7,cpuKernelImpl:cxe}),BSe={kernelName:Df,backendName:"webgl",kernelFunc:FSe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const zSe=`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,VSe=`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,WSe=Er({opSnippet:zSe,packedOpSnippet:VSe,dtype:"int32"}),jSe={kernelName:Lf,backendName:"webgl",kernelFunc:WSe};/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class USe{constructor(e){this.variableNames=["A"];const n=la(),[r,a]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${a}.0, ${r}.0);

        vec4 values = ${n.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class GSe{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const n=la(),[r,a]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${a}.0, ${r}.0);
            vec4 values = ${n.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${n.output} = result;
      }
    `}}/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const HSe={kernelName:lx,backendName:"webgl",kernelFunc:qSe};let wp,X4=ue().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function qSe(t){const{inputs:e,backend:n,attrs:r}=t;let{pixels:a}=e;const{numChannels:i}=r,o=typeof HTMLVideoElement<"u"&&a instanceof HTMLVideoElement,s=typeof HTMLImageElement<"u"&&a instanceof HTMLImageElement,[l,u]=o?[a.videoWidth,a.videoHeight]:[a.width,a.height],c=[u,l],d=[u,l,i];if(s||o){const y=ue().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(wp==null||y!==X4)&&(X4=y,wp=document.createElement("canvas").getContext("2d",{willReadFrequently:X4})),wp.canvas.width=l,wp.canvas.height=u,wp.drawImage(a,0,0,l,u),a=wp.canvas}const p=n.makeTensorInfo(c,"int32");n.texData.get(p.dataId).usage=ii.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(p.dataId),a);const f=ue().getBool("WEBGL_PACK")?new GSe(d):new USe(d),g=n.runWebGLProgram(f,[p],"int32");return n.disposeData(p.dataId),g}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function KSe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,filter:i,bias:o,preluActivationWeights:s}=e,{strides:l,pad:u,dataFormat:c,dilations:d,dimRoundingMode:p,activation:f,leakyreluAlpha:g}=r,y=Os(c),x=hr(a.shape,i.shape,l,d,u,p,!1,y);let b;const v=[],w=o!=null,S=s!=null,C=f==="leakyrelu",I=()=>{const E=[a,i],A=(M,L)=>{if(L==="NCHW"&&M.shape.length===1&&M.shape[0]!==1){const W=Re({inputs:{x:M},backend:n,attrs:{shape:[M.shape[0],1,1]}});return v.push(W),W}return M};if(w&&E.push(A(o,c)),S&&E.push(A(s,c)),C){const M=n.makeTensorInfo([],"float32",Ss(g,"float32"));E.push(M),v.push(M)}return E};if(x.filterHeight===1&&x.filterWidth===1&&x.dilationHeight===1&&x.dilationWidth===1&&x.strideHeight===1&&x.strideWidth===1&&(x.padInfo.type==="SAME"||x.padInfo.type==="VALID"))b=w7({x:a,filter:i,convInfo:x,backend:n,bias:o,activation:f,preluActivationWeights:s,leakyreluAlpha:g});else if(x.strideWidth<=2&&y==="channelsLast"&&ue().getBool("WEBGL_EXP_CONV")){const E=f?og(f,!0):null,A=new x7(x,w,E,S,C),M=[[x.padInfo.top,x.padInfo.left],[x.strideHeight,x.strideWidth],[x.dilationHeight,x.dilationWidth],[x.inHeight,x.inWidth]],L=I();b=n.runWebGLProgram(A,L,"float32",M)}else if(ue().getBool("WEBGL_CONV_IM2COL"))b=k7({x:a,filter:i,convInfo:x,backend:n,bias:o,activation:f,preluActivationWeights:s,leakyreluAlpha:g});else{const E=f?og(f,!1):null,A=new v7(x,w,E,S,C),M=I();b=n.runWebGLProgram(A,M,"float32")}const _=Re({inputs:{x:b},backend:n,attrs:{shape:x.outShape}});return v.push(b),v.forEach(E=>n.disposeIntermediateTensorInfo(E)),_}const XSe={kernelName:km,backendName:"webgl",kernelFunc:KSe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function YSe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,filter:i,bias:o,preluActivationWeights:s}=e,{strides:l,pad:u,dilations:c,dimRoundingMode:d,activation:p,leakyreluAlpha:f}=r,g=[];let y=c;y==null&&(y=[1,1]),V(jr(l,y),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${l} and dilations '${y}'`);const x=hr(a.shape,i.shape,l,y,u,d,!0),b=ue().getBool("WEBGL_PACK_DEPTHWISECONV")&&x.strideWidth<=2&&x.outChannels/x.inChannels===1,v=p?og(p,b):null,w=[a,i],S=o!=null,C=s!=null,I=p==="leakyrelu";if(S&&w.push(o),C&&w.push(s),I){const M=n.makeTensorInfo([],"float32",Ss(f,"float32"));w.push(M),g.push(M)}let _;b?_=new E7(x,S,v,C,I):_=new I7(x,S,v,C,I);const E=[[x.padInfo.top,x.padInfo.left],[x.strideHeight,x.strideWidth],[x.dilationHeight,x.dilationWidth],[x.inHeight,x.inWidth]],A=n.runWebGLProgram(_,w,"float32",E);return g.forEach(M=>n.disposeIntermediateTensorInfo(M)),A}const QSe={kernelName:Sm,backendName:"webgl",kernelFunc:YSe};class ZSe{constructor(e,n,r,a){this.sliceDim=e,this.strides=n,this.paramsShape=a,this.variableNames=["x","indices"],this.outputShape=r;const i=pn(r.length);let o=`
    int index;`;for(let s=0;s<this.sliceDim;s++)o+=`
          index = round(getIndices(coords[0], ${s}));
          out_of_bounds = out_of_bounds || index < 0;
          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[s]};
          flattenIndex += index * ${this.strides[s]};`;this.userCode=`
         void main() {
          ${i} coords = getOutputCoords();
          int flattenIndex = 0;
          bool out_of_bounds = false;

          ${o}

          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));
        }
      `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function JSe(t){const{inputs:e,backend:n}=t,{params:r,indices:a}=e,i=a.shape,o=i[i.length-1],s=me(r.shape),[l,u,c,d]=xx(r,a),p=Re({inputs:{x:a},backend:n,attrs:{shape:[u,o]}}),f=Re({inputs:{x:r},backend:n,attrs:{shape:[me(r.shape)/c,c]}});if(n.shouldExecuteOnCPU([r,a])||r.dtype==="string"){const b=n.readSync(a.dataId),v=n.bufferSync(r),w=dxe(b,v,r.dtype,u,o,c,d,r.shape,s);return n.makeTensorInfo(l,r.dtype,w.values)}const g=new ZSe(o,d,[u,c],r.shape),y=n.runWebGLProgram(g,[f,p],f.dtype),x=Re({inputs:{x:y},backend:n,attrs:{shape:l}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(y),x}const eCe={kernelName:sv,backendName:"webgl",kernelFunc:JSe};/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class tCe{constructor(e,n){this.variableNames=["A","indices"],this.outputShape=n,this.rank=n.length;const r=pn(this.rank),a=nCe(e);this.userCode=`
      void main() {
        ${r} resRC = getOutputCoords();
        int index = int(getIndices(resRC.x, resRC.z));
        float inBounds = (index >= 0) && (index < ${e[2]}) ? 1.0 : 0.0;
        setOutput(inBounds * getA(${a}));
      }
    `}}function nCe(t,e){const n=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[];for(let a=0;a<t.length;a++)a===2?r.push("index"):r.push(`${n[a]}`);return r.join()}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function A7(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,indices:i}=e,{axis:o,batchDims:s}=r,l=Pt(o,a.shape)[0];if(ue().get("DEBUG")){const v=n.readSync(i.dataId),w=a.shape[l];for(let S=0;S<v.length;++S){const C=v[S];V(C<=w-1&&C>=0,()=>`GatherV2: the index value ${C} is not in [0, ${w-1}]`)}}const u=r4(a,i,l,s),c=me(i.shape),d=[],p=Re({inputs:{x:a},backend:n,attrs:{shape:[u.batchSize,u.outerSize,u.dimSize,u.sliceSize]}}),f=Re({inputs:{x:i},backend:n,attrs:{shape:[u.batchSize,c/u.batchSize]}});d.push(p),d.push(f);const g=[u.batchSize,u.outerSize,c/u.batchSize,u.sliceSize];if(n.shouldExecuteOnCPU([a,i])||a.dtype==="string"){const v=n.bufferSync(f),w=n.bufferSync(p),S=pxe(w,v,g);return d.forEach(C=>n.disposeIntermediateTensorInfo(C)),n.makeTensorInfo(u.outputShape,S.dtype,S.values)}const y=new tCe(p.shape,g),x=n.runWebGLProgram(y,[p,f],p.dtype);d.push(x);const b=Re({inputs:{x},backend:n,attrs:{shape:u.outputShape}});return d.forEach(v=>n.disposeIntermediateTensorInfo(v)),b}const rCe={kernelName:ov,backendName:"webgl",kernelFunc:A7};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const aCe="return float(a > b);",iCe=`
  return vec4(greaterThan(a, b));
`,oCe=Er({opSnippet:aCe,packedOpSnippet:iCe,cpuKernelImpl:hxe,dtype:"bool"}),sCe={kernelName:Ff,backendName:"webgl",kernelFunc:oCe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const lCe="return float(a >= b);",uCe=`
  return vec4(greaterThanEqual(a, b));
`,cCe=Er({opSnippet:lCe,packedOpSnippet:uCe,dtype:"bool",cpuKernelImpl:fxe}),dCe={kernelName:Bf,backendName:"webgl",kernelFunc:cCe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function pCe(t){const{inputs:e,backend:n}=t,{input:r}=e;return R7(r,!0,n)}const hCe={kernelName:lv,backendName:"webgl",kernelFunc:pCe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const fCe="return float(!isnan(x) && !isinf(x));",mCe=Rt({opSnippet:fCe,dtype:"bool"}),gCe={kernelName:Vf,backendName:"webgl",kernelFunc:mCe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const yCe="return float(isinf(x));",bCe=Rt({opSnippet:yCe,dtype:"bool"}),vCe={kernelName:Wf,backendName:"webgl",kernelFunc:bCe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const xCe="return float(isnan(x));",wCe=Rt({opSnippet:xCe,dtype:"bool"}),kCe={kernelName:jf,backendName:"webgl",kernelFunc:wCe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const SCe="return float(a < b);",CCe=`
  return vec4(lessThan(a, b));
`,NCe=Er({opSnippet:SCe,packedOpSnippet:CCe,cpuKernelImpl:mxe,dtype:"bool"}),TCe={kernelName:Uf,backendName:"webgl",kernelFunc:NCe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const ICe="return float(a <= b);",ECe=`
  return vec4(lessThanEqual(a, b));
`,_Ce=Er({opSnippet:ICe,packedOpSnippet:ECe,cpuKernelImpl:gxe,dtype:"bool"}),OCe={kernelName:Gf,backendName:"webgl",kernelFunc:_Ce};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function $Ce(t){const{backend:e,attrs:n}=t,{start:r,stop:a,num:i}=n,o=yxe(r,a,i);return e.makeTensorInfo([o.length],"float32",o)}const RCe={kernelName:dv,backendName:"webgl",kernelFunc:$Ce};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const MCe=vp+`
  return x < 0.0 ? 0./0. : log(x);
`,ACe=`
  vec4 result = log(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);
  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);
  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);
  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);
  return result;
`,PCe=Rt({opSnippet:MCe,packedOpSnippet:ACe,cpuKernelImpl:bxe}),DCe={kernelName:Hf,backendName:"webgl",kernelFunc:PCe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const LCe=vp+`
  return log(1.0 + x);
`,FCe=Rt({opSnippet:LCe}),BCe={kernelName:qf,backendName:"webgl",kernelFunc:FCe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const zCe="return float(a >= 1.0 && b >= 1.0);",VCe=`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,WCe=Er({opSnippet:zCe,packedOpSnippet:VCe,dtype:"bool"}),jCe={kernelName:Kf,backendName:"webgl",kernelFunc:WCe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const UCe="return float(!(x >= 1.0));",GCe=Rt({opSnippet:UCe}),HCe={kernelName:Xf,backendName:"webgl",kernelFunc:GCe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const qCe="return float(a >= 1.0 || b >= 1.0);",KCe=`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,XCe=Er({opSnippet:qCe,packedOpSnippet:KCe,dtype:"bool"}),YCe={kernelName:Yf,backendName:"webgl",kernelFunc:XCe};/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class QCe{constructor(e,n,r,a,i){this.variableNames=["x"],this.outputShape=[];const o=n,s=e[3]-1;this.outputShape=e;let l;const u=`float(${r}) + float(${a}) * sum`;i===.5?l=`inversesqrt(${u})`:i===1?l=`1.0/(${u})`:l=`exp(log(${u}) * float(-${i}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${o}; j <= ${o}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${s}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${l};
        setOutput(val);
      }
    `}}/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class ZCe{constructor(e,n,r,a,i){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const o=n,s=e[3]-1;this.outputShape=e;let l;const u=`float(${r}) + float(${a}) * sum`;i===.5?l=`inversesqrt(${u})`:i===1?l=`1.0/(${u})`:l=`exp(log(${u}) * float(-${i}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${o};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${o}; j <= ${o}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${s}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${l};
        setOutput(result);
      }
    `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const JCe=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{depthRadius:i,bias:o,alpha:s,beta:l}=r,u=ue().getBool("WEBGL_PACK_NORMALIZATION")?new ZCe(a.shape,i,o,s,l):new QCe(a.shape,i,o,s,l);return n.runWebGLProgram(u,[a],a.dtype)},eNe={kernelName:pv,backendName:"webgl",kernelFunc:JCe};/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class tNe{constructor(e,n,r,a,i){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=n,this.bias=r,this.alpha=a,this.beta=i,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${n})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${n} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${a}) * norm + float(${r});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${a})
                * float(${i})
                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${i});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const nNe=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:a,y:i,dy:o}=e,{depthRadius:s,bias:l,alpha:u,beta:c}=r,d=new tNe(a.shape,s,l,u,c);return n.runWebGLProgram(d,[a,i,o],a.dtype)},rNe={kernelName:K3,backendName:"webgl",kernelFunc:nNe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function aNe(t,e,n,r){const a=me(e),i=me(t.shape)/a,o=Re({inputs:{x:t},attrs:{shape:[i,a]},backend:r}),s=mc(o,t.dtype,"max",r),l=Re({inputs:{x:s},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(o),r.disposeIntermediateTensorInfo(s),l}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function P7(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{reductionIndices:i,keepDims:o}=r,s=a.shape.length,l=Pt(i,a.shape);let u=l;const c=jn(u,s),d=c!=null,p=n.shouldExecuteOnCPU([a]);let f=a;if(d){if(p){const v=n.texData.get(f.dataId).values,w=new Array(s);for(let I=0;I<w.length;I++)w[I]=a.shape[c[I]];const S=V4(v,a.shape,a.dtype,c,w);f=n.makeTensorInfo(w,a.dtype);const C=n.texData.get(f.dataId);C.values=S}else f=c2(a,c,n);u=Un(u.length,s)}Tr("max",u,s);const[g,y]=Nr(f.shape,u);let x=g;o&&(x=ar(g,l));let b;if(p){const v=n.texData.get(f.dataId).values,w=vxe(v,me(y),x,a.dtype);b=n.makeTensorInfo(x,a.dtype);const S=n.texData.get(b.dataId);S.values=w}else b=aNe(f,y,x,n);return d&&n.disposeIntermediateTensorInfo(f),b}const iNe={kernelName:hv,backendName:"webgl",kernelFunc:P7};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const oNe=j4+`
  return max(a, b);
`,sNe=`
  vec4 result = vec4(max(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+ag+`
  return result;
`,lNe=Er({opSnippet:oNe,packedOpSnippet:sNe,cpuKernelImpl:xxe}),uNe={kernelName:Qf,backendName:"webgl",kernelFunc:lNe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function cNe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e;ng(a,"maxPool");const{filterSize:i,strides:o,pad:s,dimRoundingMode:l}=r,u=1;V(jr(o,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${u}'`);const c=Ii(a.shape,i,o,u,s,l);if(c.filterWidth===1&&c.filterHeight===1&&tn(c.inShape,c.outShape))return Ua({inputs:{x:a},backend:n});const d=new sg(c,"max",!1);return n.runWebGLProgram(d,[a],a.dtype)}const dNe={kernelName:fv,backendName:"webgl",kernelFunc:cNe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function pNe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{filterSize:i,strides:o,pad:s,dataFormat:l,dimRoundingMode:u}=r,c=[1,1,1],d=_s(a.shape,i,o,c,s,u,l),p=new G4(d,"max",!1);return n.runWebGLProgram(p,[a],a.dtype)}const hNe={kernelName:mv,backendName:"webgl",kernelFunc:pNe};/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class fNe{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const n=e.strideHeight,r=e.strideWidth,a=e.dilationHeight,i=e.effectiveFilterHeight,o=e.effectiveFilterWidth,s=i-1-e.padInfo.top,l=o-1-e.padInfo.left,u=i*o-1;this.userCode=`
      const ivec2 pads = ivec2(${s}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${i};
          wR += ${a}) {
          float dyR = float(dyRCorner + wR) / ${n}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${o}; wC++) {
            float dyC = float(dyCCorner + wC) / ${r}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${u} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${o} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}}class mNe{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const n=e.strideDepth,r=e.strideHeight,a=e.strideWidth,i=e.dilationDepth,o=e.dilationHeight,s=e.dilationWidth,l=e.effectiveFilterDepth,u=e.effectiveFilterHeight,c=e.effectiveFilterWidth,d=l-1-e.padInfo.front,p=u-1-e.padInfo.top,f=c-1-e.padInfo.left,g=l*u*c-1;this.userCode=`
      const ivec3 pads = ivec3(${d}, ${p}, ${f});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${l};
           wD += ${i}) {
          float dyD = float(dyDCorner + wD) / ${n}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${u};
              wR += ${o}) {
            float dyR = float(dyRCorner + wR) / ${r}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${c};
                wC += ${s}) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${g} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${u} * ${c} +
                  wR * ${c} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function gNe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:a,input:i}=e,o=i,{filterSize:s,strides:l,pad:u,dimRoundingMode:c}=r,d=[1,1,1],p=_s(o.shape,s,l,d,u,c),f=new G4(p,"max",!0),g=n.runWebGLProgram(f,[o],o.dtype),y=new mNe(p),x=n.runWebGLProgram(y,[a,g],o.dtype);return n.disposeIntermediateTensorInfo(g),x}const yNe={kernelName:Y3,backendName:"webgl",kernelFunc:gNe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function bNe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:a,input:i,output:o}=e,s=i;ng([i,o],"maxPoolGrad");const{filterSize:l,strides:u,pad:c,dimRoundingMode:d}=r,p=Ii(s.shape,l,u,1,c,d),f=!0,g=new sg(p,"max",f),y=n.runWebGLProgram(g,[s],s.dtype),x=new fNe(p),b=n.runWebGLProgram(x,[a,y],s.dtype);return n.disposeIntermediateTensorInfo(y),b}const vNe={kernelName:X3,backendName:"webgl",kernelFunc:bNe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function xNe(t,e,n,r){let a=new sg(n,"max",!1);const i=r.runWebGLProgram(a,[t],"float32");a=new sg(n,"max",!0,!0,e);const o=r.runWebGLProgram(a,[t],"float32");return[i,o]}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const wNe={kernelName:gv,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:r}=t,{filterSize:a,strides:i,pad:o,includeBatchInIndex:s}=e,l=n;V(r.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${r.shape.length}.`);const u=[1,1];V(jr(i,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${u}'`);const c=Ii(r.shape,a,i,u,o),[d,p]=xNe(r,s,c,l);return[d,p]}};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function kNe(t,e,n,r){const a=me(e),i=me(t.shape)/a,o=Re({inputs:{x:t},attrs:{shape:[i,a]},backend:r}),s=mc(o,"float32","mean",r),l=Re({inputs:{x:s},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(o),r.disposeIntermediateTensorInfo(s),l}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const SNe={kernelName:yv,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:r}=t,{keepDims:a,axis:i}=e,o=n,s=r.shape.length,l=Pt(i,r.shape);let u=l;const c=jn(u,s),d=c!=null,p=o.shouldExecuteOnCPU([r]),f=[];let g=r;if(d){if(p){const w=o.texData.get(g.dataId).values,S=new Array(s);for(let _=0;_<S.length;_++)S[_]=r.shape[c[_]];const C=V4(w,r.shape,r.dtype,c,S);g=o.makeTensorInfo(S,r.dtype);const I=o.texData.get(g.dataId);I.values=C}else g=c2(r,c,o);f.push(g),u=Un(u.length,s)}Tr("sum",u,s);const[y,x]=Nr(g.shape,u);let b=y;a&&(b=ar(y,l));const v=kNe(g,x,b,o);for(const w of f)o.disposeIntermediateTensorInfo(w);return v}};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function CNe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:i,keepDims:o}=r,s=a.shape.length,l=Pt(i,a.shape);let u=l;const c=jn(u,s);let d=a;c!=null&&(d=da({inputs:{x:a},backend:n,attrs:{perm:c}}),u=Un(u.length,a.shape.length)),Tr("min",u,s);const[p,f]=Nr(d.shape,u),g=me(f),y=Re({inputs:{x:d},backend:n,attrs:{shape:[-1,g]}}),x=mc(y,y.dtype,"min",n);let b;if(o){const v=ar(p,l);b=Re({inputs:{x},backend:n,attrs:{shape:v}})}else b=Re({inputs:{x},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(x),c!=null&&n.disposeIntermediateTensorInfo(d),b}const NNe={kernelName:bv,backendName:"webgl",kernelFunc:CNe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const TNe=j4+`
  return min(a, b);
`,INe=`
  vec4 result = vec4(min(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+ag+`
  return result;
`,ENe=Er({opSnippet:TNe,packedOpSnippet:INe,cpuKernelImpl:wxe}),_Ne={kernelName:Zf,backendName:"webgl",kernelFunc:ENe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class ONe{constructor(e,n,r){this.variableNames=["x"],this.outputShape=n.map((c,d)=>c[0]+e[d]+c[1]);const a=e.length,i=pn(a),o=n.map(c=>c[0]).join(","),s=n.map((c,d)=>c[0]+e[d]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,a),u=r==="reflect"?0:1;if(a===1){this.userCode=`
        int start = ${o};
        int end = ${s};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${u};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${u};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${i} start = ${i}(${o});
      ${i} end = ${i}(${s});

      void main() {
        ${i} outC = getOutputCoords();
        for (int i = 0; i < ${a}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${u};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${u};
          }
        }
        ${i} coords = outC - start;
        setOutput(getX(${l}));
      }
    `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class $Ne{constructor(e,n,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.map((g,y)=>g[0]+e[y]+g[1]);const a=e.length,i=pn(a),o=n.map(g=>g[0]).join(","),s=n.map((g,y)=>g[0]+e[y]).join(","),l=ca("rc",a),u=ca("source",a),c=`${l[a-1]} < ${this.outputShape[a-1]}`,d=a===1?"source":`vec2(${u.slice(-2).join()})`,p=r==="reflect"?0:1;let f="";if(a===1){const g=`
        ${i} source = rc;
        if (source < start) {
          source = start * 2 - source - ${p};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${p};
        }
        source -= start;
      `;f=`
        ${i} rc = outputLoc;
        ${g}
        result[0] = getChannel(getX(${u.join()}), ${d});
        ${l[a-1]} += 1;
        if(${c}) {
          ${g}
          result[1] = getChannel(getX(${u.join()}), ${d});
        }
      `}else{const g=`
        ${i} source = rc;
        ${i} lt = ${i}(lessThan(source, start));
        ${i} gte = ${i}(greaterThanEqual(source, end));
        ${i} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${p}) +
                gte * ((end - 1) * 2 - source + ${p});
        source -= start;
      `;f=`
        ${i} rc = outputLoc;
        ${g}
        result[0] = getChannel(getX(${u.join()}), ${d});
        ${l[a-1]} += 1;
        if(${c}) {
          ${g}
          result[1] = getChannel(getX(${u.join()}), ${d});
        }
        rc = outputLoc;
        ${l[a-2]} += 1;
        if(${l[a-2]} < ${this.outputShape[a-2]}) {
          ${g}
          result[2] = getChannel(getX(${u.join()}), ${d});
          ${l[a-1]} += 1;
          if(${c}) {
            ${g}
            result[3] = getChannel(getX(${u.join()}), ${d});
          }
        }
      `}this.userCode=`
      const ${i} start = ${i}(${o});
      const ${i} end = ${i}(${s});

      void main() {
        ${i} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${f}
        setOutput(result);
      }
    `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const RNe=({inputs:t,backend:e,attrs:n})=>{const{x:r}=t,{paddings:a,mode:i}=n,o=ue().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new $Ne(r.shape,a,i):new ONe(r.shape,a,i);return e.runWebGLProgram(o,[r],r.dtype)},MNe={kernelName:vv,backendName:"webgl",kernelFunc:RNe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const ANe=`if (b == 0.0) return NAN;
  return mod(a, b);`,PNe=`
  vec4 result = mod(a, b);
  bvec4 isNaN = equal(b, vec4(0.0));
  `+ag+`
  return result;
`,DNe=Er({opSnippet:ANe,packedOpSnippet:PNe}),LNe={kernelName:Jf,backendName:"webgl",kernelFunc:DNe};/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class FNe{constructor(e,n,r){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[e,r],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${n-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${n-1}));
      }
    `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const BNe=`
if (a == b) {
  return 1.0;
};
return a / b;`,zNe=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,D7=Er({opSnippet:BNe,packedOpSnippet:zNe,checkOutOfBounds:!0}),VNe={kernelName:Of,backendName:"webgl",kernelFunc:D7};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const L7="return a - b;",F7=Er({opSnippet:L7,packedOpSnippet:L7,supportsComplex:!0,cpuKernelImpl:zxe}),WNe={kernelName:gm,backendName:"webgl",kernelFunc:F7};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function B7(t){const{inputs:e,backend:n,attrs:r}=t,{logits:a}=e,{dim:i}=r,o=Pt([i],a.shape),s=P7({inputs:{x:a},backend:n,attrs:{reductionIndices:o,keepDims:!1}}),l=ar(s.shape,o),u=Re({inputs:{x:s},backend:n,attrs:{shape:l}}),c=F7({inputs:{a,b:u},backend:n}),d=_7({inputs:{x:c},backend:n}),p=d2({inputs:{x:d},backend:n,attrs:{axis:o,keepDims:!1}}),f=Re({inputs:{x:p},backend:n,attrs:{shape:l}}),g=D7({inputs:{a:d,b:f},backend:n});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),g}const jNe={kernelName:Hv,backendName:"webgl",kernelFunc:B7};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function UNe(t){const{inputs:e,backend:n,attrs:r}=t,{logits:a}=e,{numSamples:i,seed:o,normalized:s}=r,l=s?a:B7({inputs:{logits:a},backend:n,attrs:{dim:a.shape.length-1}}),u=l.shape[0],c=l.shape[1],d=new FNe(u,c,i),p=[[o]],f=n.runWebGLProgram(d,[l],"int32",p);return s||n.disposeIntermediateTensorInfo(l),f}const GNe={kernelName:xv,backendName:"webgl",kernelFunc:UNe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const HNe=Pi+`
  return -x;
`,qNe=`
  vec4 result = -x;
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`;function KNe(t){const{inputs:e,backend:n}=t,{x:r}=e;if(n.shouldExecuteOnCPU([r])){const i=n.texData.get(r.dataId),[o,s]=Sxe(i.values,r.shape,r.dtype);return n.makeTensorInfo(s,r.dtype,o)}let a;return ue().getBool("WEBGL_PACK_UNARY_OPERATIONS")?a=new fc(r.shape,qNe):a=new Ds(r.shape,HNe),n.runWebGLProgram(a,[r],r.dtype)}const XNe={kernelName:wv,backendName:"webgl",kernelFunc:KNe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const YNe=Fx;function QNe(t){ai("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:a,scores:i}=e,{maxOutputSize:o,iouThreshold:s,scoreThreshold:l}=r,u=n.readSync(a.dataId),c=n.readSync(i.dataId),{selectedIndices:d}=YNe(u,c,o,s,l);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}const ZNe={kernelName:kv,backendName:"webgl",kernelFunc:QNe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const JNe=Bx;function e3e(t){ai("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:a,scores:i}=e,{maxOutputSize:o,iouThreshold:s,scoreThreshold:l,padToMaxOutputSize:u}=r,c=n.readSync(a.dataId),d=n.readSync(i.dataId),{selectedIndices:p,validOutputs:f}=JNe(c,d,o,s,l,u);return[n.makeTensorInfo([p.length],"int32",new Int32Array(p)),n.makeTensorInfo([],"int32",new Int32Array([f]))]}const t3e={kernelName:Sv,backendName:"webgl",kernelFunc:e3e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const n3e=zx;function r3e(t){ai("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:a,scores:i}=e,{maxOutputSize:o,iouThreshold:s,scoreThreshold:l,softNmsSigma:u}=r,c=n.readSync(a.dataId),d=n.readSync(i.dataId),p=o,f=s,g=l,y=u,{selectedIndices:x,selectedScores:b}=n3e(c,d,p,f,g,y);return[n.makeTensorInfo([x.length],"int32",new Int32Array(x)),n.makeTensorInfo([b.length],"float32",new Float32Array(b))]}const a3e={kernelName:Cv,backendName:"webgl",kernelFunc:r3e};/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class i3e{constructor(e,n,r,a){this.variableNames=["indices"],this.outputShape=[e,n],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${a}), float(${r}),
                      float(index == coords.y)));
      }
    `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const o3e=t=>{const{inputs:e,backend:n,attrs:r}=t,{indices:a}=e,{dtype:i,depth:o,onValue:s,offValue:l}=r,u=me(a.shape),c=new i3e(u,o,s,l),d=Re({inputs:{x:a},backend:n,attrs:{shape:[u]}}),p=n.runWebGLProgram(c,[d],i);n.disposeIntermediateTensorInfo(d);const f=[...a.shape,o],g=Re({inputs:{x:p},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(p),g},s3e={kernelName:Tv,backendName:"webgl",kernelFunc:o3e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function y2(t){const{inputs:e,backend:n}=t,{x:r}=e;if(r.dtype==="complex64"){const a=lg({inputs:{input:r},backend:n}),i=y2({inputs:{x:a},backend:n}),o=m2({inputs:{input:r},backend:n}),s=y2({inputs:{x:o},backend:n}),l=Hl({inputs:{real:i,imag:s},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(s),l}else return dg({attrs:{shape:r.shape,dtype:r.dtype,value:r.dtype==="string"?"":0},backend:n})}const l3e={kernelName:sx,backendName:"webgl",kernelFunc:y2};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function z7(t){const{inputs:e,backend:n}=t,{x:r}=e;if(r.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(r.dtype==="complex64"){const a=lg({inputs:{input:r},backend:n}),i=z7({inputs:{x:a},backend:n}),o=m2({inputs:{input:r},backend:n}),s=y2({inputs:{x:o},backend:n}),l=Hl({inputs:{real:i,imag:s},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(s),l}else return dg({attrs:{shape:r.shape,dtype:r.dtype,value:1},backend:n})}const u3e={kernelName:Nv,backendName:"webgl",kernelFunc:z7};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function c3e(t){const{inputs:e,backend:n,attrs:r}=t,{axis:a}=r;if(e.length===1)return K4({inputs:{input:e[0]},backend:n,attrs:{dim:a}});const i=e[0].shape,o=e[0].dtype;e.forEach(c=>{Sr(i,c.shape,"All tensors passed to stack must have matching shapes"),V(o===c.dtype,()=>"All tensors passed to stack must have matching dtypes")});const s=[],l=e.map(c=>{const d=K4({inputs:{input:c},backend:n,attrs:{dim:a}});return s.push(d),d}),u=b7({inputs:l,backend:n,attrs:{axis:a}});return s.forEach(c=>n.disposeIntermediateTensorInfo(c)),u}const d3e={kernelName:Iv,backendName:"webgl",kernelFunc:c3e};/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class p3e{constructor(e,n,r){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((u,c)=>u[0]+e[c]+u[1]);const a=e.length,i=pn(a),o=n.map(u=>u[0]).join(","),s=n.map((u,c)=>u[0]+e[c]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,a);if(a===1){this.userCode=`
        int start = ${o};
        int end = ${s};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(value);
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${i} start = ${i}(${o});
      ${i} end = ${i}(${s});

      void main() {
        ${i} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(value);
        } else {
          ${i} coords = outC - start;
          setOutput(getX(${l}));
        }
      }
    `}}/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class h3e{constructor(e,n,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((y,x)=>y[0]+e[x]+y[1]);const a=e.length,i=pn(a),o=n.map(y=>y[0]).join(","),s=n.map((y,x)=>y[0]+e[x]).join(","),l=ca("rc",a),u=ca("source",a),c=`${l[a-1]} < ${this.outputShape[a-1]}`,d=a===1?"source":`vec2(${u.slice(-2).join()})`,p=[`${i} rc = outputLoc;`,`${l[a-1]} += 1;
       if(${c}) {
      `,a===1?"":`}
       rc = outputLoc;
       ${l[a-2]} += 1;
       if(${l[a-2]} < ${this.outputShape[a-2]}) {`,a===1?"":`  ${l[a-1]} += 1;
         if(${c}) {`],f=a===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let g="";for(let y=0,x=a===1?2:4;y<x;y++)g+=`
        ${p[y]}
        if (${f}) {
          result[${y}] = float(value);
        } else {
          ${i} source = rc - start;
          result[${y}] = getChannel(getX(${u.join()}), ${d});
        }
      `;g+=a===1?"} ":"}}",this.userCode=`
      const ${i} start = ${i}(${o});
      const ${i} end = ${i}(${s});

      void main() {
        ${i} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${g}
        setOutput(result);
      }
    `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const V7=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{paddings:i,constantValue:o}=r;if(me(a.shape)===0){const u=i.map((c,d)=>c[0]+a.shape[d]+c[1]);return dg({backend:n,attrs:{shape:u,value:o,dtype:a.dtype}})}const s=ue().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new h3e(a.shape,i,o):new p3e(a.shape,i,o),l=[[o]];return n.runWebGLProgram(s,[a],a.dtype,l)},f3e={kernelName:Ev,backendName:"webgl",kernelFunc:V7};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const m3e=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,g3e=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  bvec4 isNaN1 = lessThan(a, vec4(0.0));
  bvec4 isNaN2 = lessThan(floor(b), b);
  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);
  `+ag+`
  return result;
`,y3e=Er({opSnippet:m3e,packedOpSnippet:g3e}),b3e={kernelName:nm,backendName:"webgl",kernelFunc:y3e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function v3e(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:i,keepDims:o}=r,s=a.shape.length,l=[],u=Pt(i,a.shape);let c=u;const d=jn(c,s);let p=a;d!=null&&(p=da({inputs:{x:a},backend:n,attrs:{perm:d}}),c=Un(c.length,s),l.push(p)),Tr("prod",c,s);let f;if(n.shouldExecuteOnCPU([p])){const g=n.texData.get(p.dataId).values,{outVals:y,outShape:x,outDtype:b}=Nxe(p.shape,p.dtype,g,c);f=n.makeTensorInfo(x,b,y)}else{const[g,y]=Nr(p.shape,c),x=me(y),b=Re({inputs:{x:p},backend:n,attrs:{shape:[-1,x]}}),v=gx(a.dtype),w=mc(b,v,"prod",n);f=Re({inputs:{x:w},backend:n,attrs:{shape:g}}),l.push(b),l.push(w)}if(o){l.push(f);const g=ar(f.shape,u);f=Re({inputs:{x:f},backend:n,attrs:{shape:g}})}return l.forEach(g=>n.disposeIntermediateTensorInfo(g)),f}const x3e={kernelName:Ov,backendName:"webgl",kernelFunc:v3e};/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function w3e(t){const{inputs:e,backend:n,attrs:r}=t,{paramsNestedSplits:a,paramsDenseValues:i,indices:o}=e,{outputRaggedRank:s}=r,l=a.map(b=>n.readSync(b.dataId)),u=a.map(b=>b.shape),c=n.readSync(i.dataId),d=n.readSync(o.dataId),[p,f,g]=Txe(l,u,c,i.shape,i.dtype,d,o.shape,s),y=p.map(b=>n.makeTensorInfo([b.length],"int32",b)),x=n.makeTensorInfo(g,i.dtype,f);return y.concat([x])}const k3e={kernelName:$v,backendName:"webgl",kernelFunc:w3e};/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function S3e(t){const{inputs:e,backend:n,attrs:r}=t,{shape:a,values:i,defaultValue:o,rowPartitionTensors:s}=e,{rowPartitionTypes:l}=r,u=n.readSync(a.dataId),c=n.readSync(i.dataId),d=n.readSync(o.dataId),p=s.map(x=>n.readSync(x.dataId)),f=s.map(x=>x.shape),[g,y]=Ixe(u,a.shape,c,i.shape,i.dtype,d,o.shape,p,f,l);return n.makeTensorInfo(g,i.dtype,y)}const C3e={kernelName:Rv,backendName:"webgl",kernelFunc:S3e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const W7=t=>{const{backend:e,attrs:n}=t,{start:r,stop:a,step:i,dtype:o}=n,s=Exe(r,a,i,o);return e.makeTensorInfo([s.length],o,s)},N3e={kernelName:Mv,backendName:"webgl",kernelFunc:W7};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const T3e="return 1.0 / x;",I3e=Rt({opSnippet:T3e}),E3e={kernelName:rm,backendName:"webgl",kernelFunc:I3e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const _3e=Pi+`
  return (x < 0.0) ? 0.0 : x;
`,O3e=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,$3e=Rt({opSnippet:_3e,packedOpSnippet:O3e}),R3e={kernelName:am,backendName:"webgl",kernelFunc:$3e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const M3e=Pi+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,A3e=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,P3e=Rt({opSnippet:M3e,packedOpSnippet:A3e}),D3e={kernelName:im,backendName:"webgl",kernelFunc:P3e};/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class L3e{constructor(e,n,r,a,i){this.variableNames=["A"],this.outputShape=[];const[o,s,l,u]=e;this.outputShape=[o,n,r,u];const c=[a&&n>1?s-1:s,a&&r>1?l-1:l],d=[a&&n>1?n-1:n,a&&r>1?r-1:r];let p;i?p="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":p="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${c[0]/d[0]},
          ${c[1]/d[1]});
      const vec2 inputShapeRC = vec2(${s}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${p};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}}/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class F3e{constructor(e,n,r,a,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[o,s,l,u]=e;this.outputShape=[o,n,r,u];const c=[a&&n>1?s-1:s,a&&r>1?l-1:l],d=[a&&n>1?n-1:n,a&&r>1?r-1:r];let p;i?p="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":p="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${c[0]/d[0]},
          ${c[1]/d[1]},
          ${c[1]/d[1]});
      const vec3 inputShapeRC = vec3(${s}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${p};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${u-1};
        bool hasNextRow = coords.z < ${r-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function B3e(t){const{inputs:e,backend:n,attrs:r}=t,{images:a}=e,{alignCorners:i,halfPixelCenters:o,size:s}=r,[l,u]=s,c=ue().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new F3e(a.shape,l,u,i,o):new L3e(a.shape,l,u,i,o);return n.runWebGLProgram(c,[a],"float32")}const z3e={kernelName:Lv,backendName:"webgl",kernelFunc:B3e};/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class V3e{constructor(e,n,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,a,i]=n,[,o,s]=e,l=[r&&o>1?a-1:a,r&&s>1?i-1:i],u=[r&&o>1?o-1:o,r&&s>1?s-1:s],c=l[0]/u[0],d=l[1]/u[1],p=1/c,f=1/d,g=Math.ceil(p)*2+2,y=Math.ceil(f)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${c});
        const float widthScale = float(${d});

        const float invHeightScale = float(${p});
        const float invWidthScale = float(${f});

        const int winHeight = int(${g});
        const int winWidth = int(${y});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${o}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${s}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${a-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${i-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function W3e(t){const{inputs:e,backend:n,attrs:r}=t,{images:a,dy:i}=e,{alignCorners:o}=r,s=new V3e(i.shape,a.shape,o);return n.runWebGLProgram(s,[i],i.dtype)}const j3e={kernelName:Z3,backendName:"webgl",kernelFunc:W3e};/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class U3e{constructor(e,n,r,a,i){this.variableNames=["A"],this.outputShape=[];const[o,s,l,u]=e;this.outputShape=[o,n,r,u];const c=[a&&n>1?s-1:s,a&&r>1?l-1:l],d=[a&&n>1?n-1:n,a&&r>1?r-1:r],p=a?"0.5":"0.0";let f;i?f="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":f="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${c[0]/d[0]},
          ${c[1]/d[1]});
      const vec2 inputShapeRC = vec2(${s}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${f};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${p})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}}/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class G3e{constructor(e,n,r,a,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[o,s,l,u]=e;this.outputShape=[o,n,r,u];const c=[a&&n>1?s-1:s,a&&r>1?l-1:l],d=[a&&n>1?n-1:n,a&&r>1?r-1:r],p=a?"0.5":"0.0";let f;i?f="max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":f="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${c[0]/d[0]},
          ${c[1]/d[1]},
          ${c[1]/d[1]});
      const vec3 inputShapeRC = vec3(${s}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${f};

        // Compute the coordinators of nearest neighbor point.
        ivec3 sourceNearestRC = ivec3(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${p})));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${u-1};
        bool hasNextRow = coords.z < ${r-1};

        vec4 newValue = vec4(
          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),
          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);

        setOutput(newValue);
      }
    `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function H3e(t){const{inputs:e,backend:n,attrs:r}=t,{images:a}=e,{alignCorners:i,halfPixelCenters:o,size:s}=r,[l,u]=s,c=ue().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new G3e(a.shape,l,u,i,o):new U3e(a.shape,l,u,i,o);return n.runWebGLProgram(c,[a],a.dtype)}const q3e={kernelName:Dv,backendName:"webgl",kernelFunc:H3e};/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class K3e{constructor(e,n,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,a,i]=n,[,o,s]=e,l=[r&&o>1?a-1:a,r&&s>1?i-1:i],u=[r&&o>1?o-1:o,r&&s>1?s-1:s],c=l[0]/u[0],d=l[1]/u[1],p=1/c,f=1/d,g=Math.ceil(p)*2+2,y=Math.ceil(f)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${c});
        const float widthScale = float(${d});

        const float invHeightScale = float(${p});
        const float invWidthScale = float(${f});

        const int winHeight = int(${g});
        const int winWidth = int(${y});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${o}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${s}) {
              continue;
            }

            float sourceFracRow =
              float(${l[0]}) *
                (float(dyR) / float(${u[0]}));

            float sourceFracCol =
                float(${l[1]}) *
                  (float(dyC) / float(${u[1]}));

            int sourceNearestRow = int(min(
                float(int(${a}) - 1),
                ${r} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${i}) - 1),
                ${r} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function X3e(t){const{inputs:e,backend:n,attrs:r}=t,{images:a,dy:i}=e,{alignCorners:o}=r,s=new K3e(i.shape,a.shape,o);return n.runWebGLProgram(s,[i],i.dtype)}const Y3e={kernelName:Q3,backendName:"webgl",kernelFunc:X3e};/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class Q3e{constructor(e,n){this.variableNames=["x"];const r=e.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);if(this.outputShape=e,r===1){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${e[0]} - coord - 1));
        }
      `;return}const a=s=>n.indexOf(s)!==-1&&e[s]!==1?`${e[s]} - coords[${s}] - 1`:`coords[${s}]`,i=e.map((s,l)=>a(l)).join(","),o=pn(r);this.userCode=`
      void main() {
        ${o} coords = getOutputCoords();
        setOutput(getX(${i}));
      }
    `}}/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class Z3e{constructor(e,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const r=e.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);this.outputShape=e;const a=ca("rc",r),i=`${a[r-1]} + 1 < ${this.outputShape[r-1]}`,o=`${a[r-2]} + 1 < ${this.outputShape[r-2]}`,s=pn(r);r===1?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${e[0]} - rc - 1),
            ${e[0]} - rc - 1);
          if(${i}){
              result.g = getChannel(getX(${e[0]} - (rc  + 1) - 1),
                ${e[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${s} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${l(a.slice())};
          if(${i}){
            result.g = ${u(a.slice())};
          }
          if(${o}) {
            result.b = ${c(a.slice())};
            if(${i}) {
              result.a = ${d(a.slice())};
            }
          }
          setOutput(result);
        }
    `;function l(g){return p(g)}function u(g){return g[r-1]="("+g[r-1]+" + 1)",p(g)}function c(g){return g[r-2]="("+g[r-2]+" + 1)",p(g)}function d(g){return g[r-1]="("+g[r-1]+" + 1)",g[r-2]="("+g[r-2]+" + 1)",p(g)}function p(g){const y=e.map((v,w)=>f(w,g)),x=y.join(","),b=y.slice(-2).join(",");return`getChannel(getX(${x}), vec2(${b}))`}function f(g,y){return n.indexOf(g)!==-1&&e[g]!==1?`${e[g]} - ${y[g]} - 1`:`${y[g]}`}}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function J3e(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{dims:i}=r,o=a.shape.length,s=Pt(i,a.shape);if(o===0)return Ua({inputs:{x:a},backend:n});const l=ue().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Z3e(a.shape,s):new Q3e(a.shape,s);return n.runWebGLProgram(l,[a],a.dtype)}const eTe={kernelName:Fv,backendName:"webgl",kernelFunc:J3e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class tTe{constructor(e,n){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const r=e[1],a=e[2];this.outputShape=e;let i="";typeof n=="number"?i=`float outputValue = ${n.toFixed(2)};`:i=`
        vec3 fill = vec3(${n.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - params[0]) * params[3] -
            (float(y) - params[1]) * params[2];
          float coordYFloat = (float(x) - params[0]) * params[2] +
            (float(y) - params[1]) * params[3];
          int coordX = int(round(coordXFloat + params[0]));
          int coordY = int(round(coordYFloat + params[1]));
          ${i}
          if(coordX >= 0 && coordX < ${a} && coordY >= 0 && coordY < ${r}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const nTe={kernelName:ux,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:r}=t,{radians:a,fillValue:i,center:o}=e,s=n,l=new tTe(r.shape,i),[u,c]=LI(o,r.shape[1],r.shape[2]),d=[[u,c,Math.sin(a),Math.cos(a)]];return s.runWebGLProgram(l,[r],r.dtype,d)}};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const rTe=`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`,aTe=Rt({opSnippet:rTe}),iTe={kernelName:om,backendName:"webgl",kernelFunc:aTe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const oTe="return inversesqrt(x);",sTe=Rt({opSnippet:oTe,cpuKernelImpl:_xe}),lTe={kernelName:sm,backendName:"webgl",kernelFunc:sTe};/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class j7{constructor(e,n,r,a,i,o,s=!0){this.variableNames=["updates","indices","defaultValue"],this.outputShape=o;const l=pn(i.length),u=pn(o.length);let c="";r===1?c="i":r===2&&(c="i, j");const d=`getIndices(${c})`;let p="";a===1?p="i":a===2&&(p="i, coords[1]");const f=`getUpdates(${p})`,g=n>1?"strides[j]":"strides";this.userCode=`
        ${l} strides = ${l}(${i});

        void main() {
          ${u} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${e}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${n}; j++) {
              int index = round(${d});
              flattenedIndex += index * ${g};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${f};
              found = true;
            }
          }
          setOutput(mix(getDefaultValue(), sum, float(found)));
        }
      `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function uTe(t){const{inputs:e,backend:n,attrs:r}=t,{indices:a,updates:i}=e,{shape:o}=r,{sliceRank:s,numUpdates:l,sliceSize:u,strides:c,outputSize:d}=qd(i,a,o),p=[d/u,u];if(d===0)return n.makeTensorInfo(o,a.dtype);const f=Re({inputs:{x:a},backend:n,attrs:{shape:[l,s]}}),g=Re({inputs:{x:i},backend:n,attrs:{shape:[l,u]}}),y=n.makeTensorInfo([],"float32",new Float32Array([0])),x=new j7(l,s,f.shape.length,g.shape.length,c,p),b=n.runWebGLProgram(x,[g,f,y],g.dtype),v=Re({inputs:{x:b},backend:n,attrs:{shape:o}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(b),n.disposeIntermediateTensorInfo(y),v}const cTe={kernelName:Bv,backendName:"webgl",kernelFunc:uTe};/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class dTe{constructor(e,n,r,a){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[e,r];const i="while (left < right) {",o=`for (int i = 0; i < ${Math.ceil(Math.log2(n+1))}; ++i) { if (left >= right) break;`,s=ue().getNumber("WEBGL_VERSION")===2?i:o,l=a==="left"?"<":"<=";this.userCode=`
       int findBound(int batch, float value) {
         int left = 0;
         int right = numInputs;
         int mid;
         ${s}
           mid = (left + right) / 2;
           if (getSortedSequence(batch, mid) ${l} value) {
             left = mid + 1;
           } else {
             right = mid;
           }
         }
         return right;
       }

       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int valueIndex = coords[1];

         float value = getValues(batch, valueIndex);

         setOutput(float(findBound(batch, value)));
       }
     `}}/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function pTe(t){const{inputs:e,backend:n,attrs:r}=t,{sortedSequence:a,values:i}=e,{side:o}=r,s=new dTe(a.shape[0],a.shape[1],i.shape[1],o),l=[[a.shape[1]]];return n.runWebGLProgram(s,[a,i],"int32",l)}const hTe={kernelName:zv,backendName:"webgl",kernelFunc:pTe};/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class fTe{constructor(e,n,r){this.variableNames=["c","a","b"],this.outputShape=n;let a,i;if(r>4)throw Error(`Where for rank ${r} is not yet supported`);if(r===1)i="resRC",a="resRC";else{const s=["resRC.x","resRC.y","resRC.z","resRC.w"],l=[],u=[];for(let c=0;c<n.length;c++)u.push(`${s[c]}`),c<e&&l.push(`${s[c]}`);a=l.join(),i=u.join()}const o=pn(r);this.userCode=`
      void main() {
        ${o} resRC = getOutputCoords();
        float cVal = getC(${a});
        if (cVal >= 1.0) {
          setOutput(getA(${i}));
        } else {
          setOutput(getB(${i}));
        }
      }
    `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function mTe(t){const{inputs:e,backend:n}=t,{condition:r,t:a,e:i}=e,o=new fTe(r.shape.length,a.shape,a.shape.length);return n.runWebGLProgram(o,[r,a,i],ka(a.dtype,i.dtype))}const gTe={kernelName:Vv,backendName:"webgl",kernelFunc:mTe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const yTe=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${zI};
  float scale = ${VI};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,bTe=Rt({opSnippet:yTe}),vTe={kernelName:lm,backendName:"webgl",kernelFunc:bTe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const xTe=vp+`
  return 1.0 / (1.0 + exp(-1.0 * x));
`,wTe=`
  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,kTe=Rt({opSnippet:xTe,packedOpSnippet:wTe,cpuKernelImpl:$xe}),STe={kernelName:pm,backendName:"webgl",kernelFunc:kTe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const CTe=`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`,NTe=Rt({opSnippet:CTe}),TTe={kernelName:dm,backendName:"webgl",kernelFunc:NTe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const ITe=vp+`
  return sin(x);
`,ETe=Rt({opSnippet:ITe}),_Te={kernelName:um,backendName:"webgl",kernelFunc:ETe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const OTe=`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`,$Te=Rt({opSnippet:OTe}),RTe={kernelName:cm,backendName:"webgl",kernelFunc:$Te};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const MTe=`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`,ATe=Rt({opSnippet:MTe}),PTe={kernelName:hm,backendName:"webgl",kernelFunc:ATe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const DTe=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{blockShape:i,paddings:o}=r;V(a.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const s=i.reduce((b,v)=>b*v),l=[[0,0]];l.push(...o);for(let b=1+i.length;b<a.shape.length;++b)l.push([0,0]);const u=[],c=V7({inputs:{x:a},backend:n,attrs:{paddings:l,constantValue:0}}),d=qm(c.shape,i,s,!1),p=Km(d.length,i.length,!1),f=Xm(c.shape,i,s,!1),g=Re({inputs:{x:c},backend:n,attrs:{shape:d}}),y=da({inputs:{x:g},backend:n,attrs:{perm:p}}),x=Re({inputs:{x:y},backend:n,attrs:{shape:f}});return u.push(c),u.push(g),u.push(y),u.forEach(b=>n.disposeIntermediateTensorInfo(b)),x},LTe={kernelName:Uv,backendName:"webgl",kernelFunc:DTe};/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function FTe(t){const{inputs:e,backend:n}=t,{indices:r,values:a,denseShape:i,defaultValue:o}=e;if(i.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
         ${i.shape}`);if(r.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
         ${r.shape}`);if(a.shape.length!==1)throw new Error(`Values must be a vector, saw:
         ${a.shape}`);if(o.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${o.shape}`);const s=n.readSync(r.dataId),l=n.readSync(a.dataId),u=n.readSync(i.dataId),c=n.readSync(o.dataId)[0],[d,p,f,g,y]=Mxe(s,r.shape,r.dtype,l,a.dtype,u,c);return[n.makeTensorInfo(p,r.dtype,d),n.makeTensorInfo([p[0]],a.dtype,f),n.makeTensorInfo([g.length],"bool",new Uint8Array(g.map(x=>Number(x)))),n.makeTensorInfo([y.length],r.dtype,new Int32Array(y))]}const BTe={kernelName:qv,backendName:"webgl",kernelFunc:FTe};/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function zTe(t){const{inputs:e,backend:n}=t,{inputIndices:r,inputShape:a,newShape:i}=e;if(r.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape ${r.shape}`);if(a.shape.length!==1)throw new Error(`Input shape should be a vector but received shape ${a.shape}`);if(i.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${i.shape}`);const o=Array.from(n.readSync(a.dataId)),s=n.readSync(r.dataId),l=Array.from(n.readSync(i.dataId)),[u,c,d]=Axe(s,r.shape,r.dtype,o,l);return[n.makeTensorInfo(c,r.dtype,u),n.makeTensorInfo([d.length],i.dtype,new Int32Array(d))]}const VTe={kernelName:Kv,backendName:"webgl",kernelFunc:zTe};/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function WTe(t){const{inputs:e,backend:n}=t,{data:r,indices:a,segmentIds:i}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(a.shape.length!==1)throw new Error(`Indices should be a vector but received shape
              ${a.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
              ${i.shape}`);const o=n.readSync(r.dataId),s=n.readSync(a.dataId),l=n.readSync(i.dataId),[u,c]=q9(o,r.shape,r.dtype,s,l,!0);return n.makeTensorInfo(c,r.dtype,u)}const jTe={kernelName:Xv,backendName:"webgl",kernelFunc:WTe};/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function UTe(t){const{inputs:e,backend:n}=t,{data:r,indices:a,segmentIds:i}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(a.shape.length!==1)throw new Error(`Indices should be a vector but received shape
             ${a.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
             ${i.shape}`);const o=n.readSync(r.dataId),s=n.readSync(a.dataId),l=n.readSync(i.dataId),[u,c]=q9(o,r.shape,r.dtype,s,l);return n.makeTensorInfo(c,r.dtype,u)}const GTe={kernelName:Yv,backendName:"webgl",kernelFunc:UTe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function HTe(t){const{inputs:e,backend:n,attrs:r}=t,{sparseIndices:a,sparseValues:i,defaultValue:o}=e,{outputShape:s}=r,{sliceRank:l,numUpdates:u,sliceSize:c,strides:d,outputSize:p}=qd(i,a,s),f=!1;if(i.dtype==="string"){const b=n.bufferSync(a),v=n.bufferSync(i),w=Cs(n.readSync(o.dataId)[0]),S=Oxe(b,v,s,p,c,u,l,d,w,f);return n.makeTensorInfo(s,S.dtype,S.values)}const g=new j7(u,l,a.shape.length,i.shape.length,d,[p,1],f),y=n.runWebGLProgram(g,[i,a,o],i.dtype),x=Re({inputs:{x:y},backend:n,attrs:{shape:s}});return n.disposeIntermediateTensorInfo(y),x}const qTe={kernelName:Qv,backendName:"webgl",kernelFunc:HTe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function KTe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{numOrSizeSplits:i,axis:o}=r,s=Pt(o,a.shape)[0],l=t4(a,i,s),u=a.shape.length,c=new Array(u).fill(0),d=a.shape.slice();return l.map(p=>{const f=[...d];f[s]=p;const g=xp({inputs:{x:a},backend:n,attrs:{begin:c,size:f}});return c[s]+=p,g})}const XTe={kernelName:Gv,backendName:"webgl",kernelFunc:KTe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const U7="return sqrt(x);",YTe=Rt({opSnippet:U7,packedOpSnippet:U7,cpuKernelImpl:Pxe}),QTe={kernelName:fm,backendName:"webgl",kernelFunc:YTe};/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const ZTe="return x * x;",JTe=Rt({opSnippet:ZTe}),eIe={kernelName:J3,backendName:"webgl",kernelFunc:JTe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const G7="return (a - b) * (a - b);",tIe=Er({opSnippet:G7,packedOpSnippet:G7}),nIe={kernelName:mm,backendName:"webgl",kernelFunc:tIe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function rIe({inputs:t,attrs:e,backend:n}){const{x:r}=t,a=Pi+`
    return x > 0.0 ? 1.0 : float(${e.alpha});
  `,i=new Ds(r.shape,a);return n.runWebGLProgram(i,[r],r.dtype)}const aIe={kernelName:xm,backendName:"webgl",kernelFunc:rIe};/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class iIe{constructor(e,n,r){this.variableNames=["x"],this.outputShape=r;const a=r.length,i=pn(r.length),o=pn(r.length);let s="";if(a===1)s="coords * strides + begin";else{let l=0;s=r.map((u,c)=>(l++,r.length===1?`coords * strides[${c}] + begin[${c}]`:`coords[${l-1}] * strides[${c}] + begin[${c}]`)).join(",")}this.userCode=`
      ${i} begin = ${i}(${e});
      ${i} strides = ${i}(${n});

      void main() {
        ${o} coords = getOutputCoords();
        setOutput(getX(${s}));
      }
    `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function oIe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{begin:i,end:o,strides:s,beginMask:l,endMask:u,ellipsisMask:c,newAxisMask:d,shrinkAxisMask:p}=r,{finalShapeSparse:f,finalShape:g,isIdentity:y,sliceDim0:x,isSimpleSlice:b,begin:v,end:w,strides:S}=WT(a.shape,i,o,s,l,u,c,d,p);let C;if(y)C=Re({inputs:{x:a},backend:n,attrs:{shape:g}});else if(x||b){V(a.shape.length>=1,()=>`Input must have rank at least 1, got: ${a.shape.length}`);const _=FT(v,w,S),E=xp({inputs:{x:a},backend:n,attrs:{begin:v,size:_}});C=Re({inputs:{x:E},backend:n,attrs:{shape:g}}),n.disposeIntermediateTensorInfo(E)}else if(n.shouldExecuteOnCPU([a])){const _=n.readSync(a.dataId),E=pt(a.shape,a.dtype,_),A=Dxe(f,E,S,v);C=n.makeTensorInfo(g,a.dtype,A.values)}else{const _=new iIe(v,S,f);C=n.runWebGLProgram(_,[a],a.dtype)}const I=Re({inputs:{x:C},backend:n,attrs:{shape:g}});return n.disposeIntermediateTensorInfo(C),I}const sIe={kernelName:Zv,backendName:"webgl",kernelFunc:oIe};/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function lIe(t){const{inputs:e,backend:n,attrs:r}=t,{separator:a,nGramWidths:i,leftPad:o,rightPad:s,padWidth:l,preserveShortSequences:u}=r,{data:c,dataSplits:d}=e,p=n.readSync(c.dataId),f=n.readSync(d.dataId),[g,y]=Lxe(p,f,a,i,o,s,l,u);return[n.makeTensorInfo([g.length],"string",g),n.makeTensorInfo(d.shape,"int32",y)]}const uIe={kernelName:Jv,backendName:"webgl",kernelFunc:lIe};/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function cIe(t){const{inputs:e,backend:n,attrs:r}=t,{skipEmpty:a}=r,{input:i,delimiter:o}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(i.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${i.shape}`);if(o.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${o.shape}`);const s=n.readSync(i.dataId),l=n.readSync(o.dataId)[0],[u,c,d]=Fxe(s,l,a),p=c.length;return[n.makeTensorInfo([p,2],"int32",u),n.makeTensorInfo([p],"string",c),n.makeTensorInfo([2],"int32",new Int32Array(d))]}const dIe={kernelName:ex,backendName:"webgl",kernelFunc:cIe};/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function pIe(t){const{inputs:e,backend:n,attrs:r}=t,{numBuckets:a}=r,{input:i}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(a<=0)throw new Error("Number of buckets must be at least 1");const o=n.readSync(i.dataId),s=Bxe(o,a);return n.makeTensorInfo(i.shape,"int32",s)}const hIe={kernelName:tx,backendName:"webgl",kernelFunc:pIe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const fIe="return tan(x);",mIe=Rt({opSnippet:fIe}),gIe={kernelName:ym,backendName:"webgl",kernelFunc:mIe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const yIe=`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`,bIe=Rt({opSnippet:yIe}),vIe={kernelName:bm,backendName:"webgl",kernelFunc:bIe};/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class xIe{constructor(e,n){this.variableNames=["A"];const r=new Array(e.length);for(let o=0;o<r.length;o++)r[o]=e[o]*n[o];this.outputShape=r,this.rank=r.length;const a=pn(this.rank),i=wIe(e);this.userCode=`
      void main() {
        ${a} resRC = getOutputCoords();
        setOutput(getA(${i}));
      }
    `}}function wIe(t){const e=t.length;if(e>5)throw Error(`Tile for rank ${e} is not yet supported`);if(e===1)return`imod(resRC, ${t[0]})`;const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[];for(let a=0;a<t.length;a++)r.push(`imod(${n[a]}, ${t[a]})`);return r.join()}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function H7(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{reps:i}=r;if(a.dtype==="string"||a.shape.length>5){const s=n.readSync(a.dataId),l=a.dtype==="string"?s.map(d=>Cs(d)):s,u=pt(a.shape,a.dtype,l),c=Vxe(u,i);return n.makeTensorInfo(c.shape,c.dtype,c.values)}const o=new xIe(a.shape,i);return n.runWebGLProgram(o,[a],a.dtype)}const kIe={kernelName:vm,backendName:"webgl",kernelFunc:H7};class SIe{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=e,this.userCode=`
       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // We compare elements pair-wise within a group of size 2 * inc.
         // The comparing rule for each group alternates between ascending
         // and descending. Within each group, we compare each pair at
         // positions i and i+inc. To decide whether an element at position i
         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
         // inc, it is in the first half of the group, we denote it as x0,
         // otherwise we denote it as x1.
         // For example, as shown in the Bitonic top K paper referenced above,
         // Figure5(a) shows that element[1] is in the
         // second half of the group when group size is 2, but it is in the
         // first half of the group when group size is 4.

         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;
         int i = isFirstInPair ? elemIdx : elemIdx - inc;

         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));
         float x0 = i0 < n ? getX(batch, i0) : negativeInf;
         float x1 = i1 < n ? getX(batch, i1) : negativeInf;

         // Denotes which direction indices are in (ascending or descending).
         bool reverse = imod(elemIdx, 2 * dir) >= dir;
         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
         if (reverse == isGreater) { // Elements in opposite order of direction
           int iTemp = i0;
           i0 = i1;
           i1 = iTemp;
         }
         if (isFirstInPair) {
            setOutput(float(i0));
         } else {
            setOutput(float(i1));
         }
       }
     `}}class CIe{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=e,this.userCode=`
    void main() {
         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // The output size is half of the previous size.
         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),
         // we only need to output the indices at positions |, the indices at
         // positions _ can be thrown away, see Figure5(b) After Phase 2
         // (Merge phase) in the Bitonic Top K paper referenced above.
         // For example, the paper shows we only need to output the orange bars.
         // The output sequence should look like this | | | | | | | |.
         // Because the sequence is halved, to map the output index back
         // to the previous sequence to find the corresponding value,
         // we need to double the index. When we double the index,
         // we basically interpolate a position, so 2i looks like
         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position
         // of each 2k positions by - elemIdx % k. E.g. for output at
         // index 4,5,6,7, we want to get the corresponding element at
         // original index 8,9,10,11, for output at index 8,9,10,11,
         // we want to get the corresponding element at original index
         // 16,17,18,19, so on and so forth.

         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));
         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));

         float x0 = getX(batch, i0);
         float x1 = i1 < n ? getX(batch, i1) : x0;

         setOutput(x0 >= x1 ? float(i0) : float(i1));
       }
     `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function gc(t,e){e!==null&&t.disposeIntermediateTensorInfo(e)}function q7(t){let e=1;for(;e<t;)e*=2;return e}function NIe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{k:i,sorted:o}=r,s=ue().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),l=ue().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),u=a.shape,c=u[u.length-1];if(n.shouldExecuteOnCPU([a])||c<s||i>l){const A=n.readSync(a.dataId),[M,L]=Wxe(A,u,a.dtype,i,o);return[n.makeTensorInfo(M.shape,M.dtype,M.values),n.makeTensorInfo(L.shape,L.dtype,L.values)]}if(i===0)return u[u.length-1]=0,[n.makeTensorInfo(u,a.dtype,[]),n.makeTensorInfo(u,"int32",[])];if(c===1)return[a,dg({attrs:{shape:u,dtype:"int32",value:0},backend:n})];const d=n.texData.get(a.dataId),p=d!==null&&d.isPacked,f=p?n.unpackTensor(a):a,g=me(u)/c,y=Re({inputs:{x:f},attrs:{shape:[g,c]},backend:n});p&&gc(n,f);const x=q7(i),b=q7(c);let v=null;const w=()=>v===null?[y,y]:[y,v],S=(A,M,L)=>{const W=w(),B=new SIe(L),K=[[c],[v===null?1:0],[Number.NEGATIVE_INFINITY],[A],[M]],X=v;v=n.runWebGLProgram(B,W,"int32",K),gc(n,X)};for(let A=1;A<x;A*=2){const M=A*2;for(let L=A;L>=1;L/=2)S(M,L,[g,b])}for(let A=b;A>x;A/=2){const M=w(),L=new CIe([g,A/2]),W=[[c],[v===null?1:0],[x]],B=v;v=n.runWebGLProgram(L,M,"int32",W),gc(n,B);const K=x/2,X=K*2;for(let Q=K;Q>=1;Q/=2)S(X,Q,v.shape)}let C=v;v=xp({inputs:{x:v},backend:n,attrs:{begin:0,size:[g,i]}}),gc(n,C);let I=A7({inputs:{x:y,indices:v},backend:n,attrs:{axis:1,batchDims:1}});gc(n,y);const _=u.slice(0,-1);_.push(i),C=v,v=Re({inputs:{x:v},attrs:{shape:_},backend:n}),gc(n,C);const E=I;return I=Re({inputs:{x:I},attrs:{shape:_},backend:n}),gc(n,E),[I,v]}const TIe={kernelName:nx,backendName:"webgl",kernelFunc:NIe};/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class IIe{constructor(e,n,r,a,i,o){this.variableNames=["Image","Transforms"],this.outputShape=o;const s=r==="nearest"?1:2;let l;switch(a){case"constant":l=1;break;case"reflect":l=2;break;case"wrap":l=3;break;case"nearest":l=4;break;default:l=1;break}this.userCode=`
            float mapCoord(float outCoord, float len) {
              float inCoord = outCoord;
              if(${l} == 2) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    if (inCoord < sz2) {
                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +
                      inCoord;
                    }
                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    inCoord -= sz2 * float(int(float(inCoord / sz2)));
                    if (inCoord >= len) {
                      inCoord = sz2 - inCoord - 1.0;
                    }
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 3) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord -= len * float(int(float(inCoord / sz)));
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 4) {
                return clamp(outCoord, 0.0, len - 1.0);
              } else {
                return outCoord;
              }
            }

            float readWithFillValue(int batch, int coordY, int coordX,
              int channel) {
              float outputValue;
              if (0 <= coordY && coordY < ${e} && 0 <= coordX && coordX < ${n}) {
                  outputValue = getImage(batch, coordY, coordX, channel);
              } else {
                outputValue = float(${i});
              }
              return outputValue;
            }

            void main() {
              ivec4 coords = getOutputCoords();
              float outputValue;
              int batch = coords[0];
              int x = coords[2];
              int y = coords[1];
              int channel = coords[3];
              float xf = float(x);
              float yf = float(y);
              float a1 = getTransforms(batch, 0);
              float a2 = getTransforms(batch, 1);
              float a3 = getTransforms(batch, 2);
              float b1 = getTransforms(batch, 3);
              float b2 = getTransforms(batch, 4);
              float b3 = getTransforms(batch, 5);
              float c1 = getTransforms(batch, 6);
              float c2 = getTransforms(batch, 7);
              float projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = float(${i});
              } else {
                float inX = (a1 * xf + a2 * yf + a3) / projection;
                float inY = (b1 * xf + b2 * yf + b3) / projection;
                float mapX = mapCoord(inX, float(${n}));
                float mapY = mapCoord(inY, float(${e}));

                if (${s} == 1) {
                  int coordY = int(round(mapY));
                  int coordX = int(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  float yFloor = floor(mapY);
                  float xFloor = floor(mapX);
                  float yCeil = yFloor + 1.0;
                  float xCeil = xFloor + 1.0;
                  float valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);
                  float valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutput(outputValue);
            }
        `}}/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function EIe(t){const{inputs:e,backend:n,attrs:r}=t,{image:a,transforms:i}=e,{interpolation:o,fillMode:s,fillValue:l,outputShape:u}=r,[c,d,p,f]=a.shape,[g,y]=u??[d,p],x=[c,g,y,f],b=new IIe(d,p,o,s,l,x);return n.runWebGLProgram(b,[a,i],"float32")}const _Ie={kernelName:rx,backendName:"webgl",kernelFunc:EIe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function OIe(t){const{inputs:e,attrs:n,backend:r}=t,{axis:a}=n,{x:i}=e;ng(i,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const o=r.readSync(i.dataId),{outputValues:s,outputShape:l,indices:u}=jxe(o,a,i.shape,i.dtype);return[r.makeTensorInfo(l,i.dtype,s),r.makeTensorInfo([u.length],"int32",u)]}const $Ie={kernelName:ax,backendName:"webgl",kernelFunc:OIe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function RIe(t){const{inputs:e,backend:n,attrs:r}=t,{value:a}=e;let{axis:i}=r;i<0&&(i+=a.shape.length);const o=a,s=o.shape.length,l=a.shape[i],u=new Array(s-1);let c=0;for(let y=0;y<s;y++)y!==i&&(u[c++]=o.shape[y]);const d=[],p=new Array(s).fill(0),f=o.shape.slice();f[i]=1;const g=new Array(l);for(let y=0;y<g.length;y++){p[i]=y;const x=xp({inputs:{x:o},backend:n,attrs:{begin:p,size:f}}),b=Re({inputs:{x},backend:n,attrs:{shape:u}});g[y]=b,d.push(x)}return d.forEach(y=>n.disposeIntermediateTensorInfo(y)),g}const MIe={kernelName:ix,backendName:"webgl",kernelFunc:RIe};/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class AIe{constructor(e,n){this.variableNames=["x","segmentIds"];const r=e.windowSize,a=e.batchSize,i=e.inSize,o=e.numSegments,s=o*Math.ceil(i/r);this.outputShape=[a,s];const l="0.0",u="sumValue",c=Math.floor(r/4)*4,d=r%4,p=`
        sumValue += dot(values, segFilter);
    `;let f="";i%r>0&&(f=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return initializationValue;
        }
      `);let g="";i%r>0&&(g=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = ${l};

      float getValue(int batch, int inIdx) {
        ${f}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${g}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${o})) * float(${r}));
        int currentSeg = int(mod(float(outIdx), float(${o})));

        float sumValue = 0.0;

        for (int i = 0; i < ${c}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${p}
        }

        int inIdx = inOffset + ${c};
        if (${d===1}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${p}
        } else if (${d===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${p}
        } else if (${d===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${p}
        }
        setOutput(${u});
      }
    `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function PIe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,segmentIds:i}=e,{numSegments:o}=r,s=a.shape.length,l=[];let u=0;const c=jn([u],s);let d=a;c!=null&&(d=da({inputs:{x:a},backend:n,attrs:{perm:c}}),l.push(d),u=Un(1,s)[0]);const p=aF(d.shape,u,o),f=me([d.shape[u]]),g=Re({inputs:{x:d},backend:n,attrs:{shape:[-1,f]}});l.push(g);const y=gx(a.dtype),x=(S,C,I,_,E)=>{const A=S.shape[0],M=S.shape[1],L=rF(M,E),W={windowSize:L,inSize:M,batchSize:A,numSegments:E},B=new AIe(W,C),K=n.compileAndRun(B,[S,I],_);if(l.push(K),K.shape[1]===E)return K;const X=W7({backend:n,attrs:{start:0,stop:E,step:1,dtype:"float32"}}),Q=H7({inputs:{x:X},backend:n,attrs:{reps:[M/L]}});return l.push(X),l.push(Q),x(K,C,Q,_,E)},b=x(g,"unsortedSegmentSum",i,y,o),v=Re({inputs:{x:b},backend:n,attrs:{shape:p}});let w=v;if(c!=null){l.push(v);const S=Fm(c);w=da({inputs:{x:w},backend:n,attrs:{perm:S}})}return l.forEach(S=>n.disposeIntermediateTensorInfo(S)),w}const DIe={kernelName:ox,backendName:"webgl",kernelFunc:PIe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const LIe=[A2e,D2e,B2e,W2e,U2e,q2e,X2e,Q2e,twe,rwe,owe,uwe,pwe,gwe,vwe,wwe,Swe,Iwe,_we,$we,Pwe,Wwe,Uwe,Hwe,Zwe,eke,ake,y2e,ske,pke,gke,kke,Cke,Tke,Eke,Oke,Mke,Dke,Bke,Vke,jke,Gke,Kke,Yke,eSe,nSe,iSe,lSe,cSe,fSe,bSe,kSe,NSe,ESe,_Se,$Se,MSe,PSe,LSe,BSe,jSe,HSe,XSe,QSe,eCe,rCe,sCe,dCe,g2e,hCe,cke,gCe,vCe,kCe,v2e,TCe,OCe,RCe,DCe,BCe,jCe,HCe,YCe,eNe,rNe,iNe,uNe,dNe,hNe,yNe,vNe,wNe,SNe,NNe,_Ne,MNe,LNe,GNe,k2e,XNe,ZNe,t3e,a3e,Kwe,s3e,u3e,d3e,f3e,b3e,w2e,x3e,k3e,C3e,N3e,Xwe,VNe,E3e,R3e,D3e,C2e,z3e,j3e,q3e,Y3e,eTe,nTe,iTe,lTe,cTe,hTe,gTe,vTe,STe,TTe,_Te,RTe,zwe,jNe,PTe,LTe,BTe,VTe,jTe,GTe,qTe,XTe,QTe,eIe,nIe,aIe,sIe,uIe,dIe,hIe,WNe,$2e,gIe,vIe,kIe,TIe,_Ie,R2e,$Ie,MIe,DIe,l3e];for(const t of LIe)px(t);async function FIe(){return await Uhe({base:"pascal",quantizationBytes:2})}async function BIe(t,e){const n=await t.segment(e);return VIe(e,n)}function zIe(t,e,n,r,a){const i=document.createElement("canvas"),o=document.createElement("canvas"),s=i.getContext("2d"),l=o.getContext("2d");i.width=r,i.height=a,o.width=r,o.height=a,s.drawImage(e,0,0,r,a),l.putImageData(n,0,0);const u=s.getImageData(0,0,r,a),c=u.data,d=l.getImageData(0,0,r,a).data;for(let p=0,f=d.length;p<f;p+=4)d[p]===t[0]&&d[p+1]===t[1]&&d[p+2]===t[2]&&(c[p+3]=0);return s.putImageData(u,0,0),i.toDataURL()}function VIe(t,e){const{height:n,width:r,segmentationMap:a}=e,i=new ImageData(a,r,n);return zIe([0,0,0],t,i,r,n)}const WIe=()=>{const t=P.useRef(),e=async n=>await BIe(t.current,n);return P.useEffect(()=>{FIe().then(n=>{t.current=n})}),{autoRemoveBackground:e}};async function jIe(t){try{const e=await fetch(t);if(!e.ok)throw new Error(e.statusText);const n=await e.json();return"@type"in n?n["@type"]!="sc:Manifest"?(console.log("The JSON for this Manifest doesn't look like a Manifest. It should have either a @type of sc:Manifest but has a type of: "+n["@type"]),null):GIe(n):"type"in n?n.type!="Manifest"?(console.log("The JSON for this Manifest doesn't look like a Manifest. It should have either a type of Manifest but has a type of: "+n.type),null):HIe(n):(console.log("The JSON for this Manifest doesn't look like a Manifest. It should have either a @type or type value of Manifest"),null)}catch(e){return console.log("I was unable to get the Manifest you supplied due to: "+e),null}}function UIe(t){return typeof t=="object"&&!Array.isArray(t)&&t!==null}function GIe(t){var e,n,r;if("sequences"in t){let a=t.sequences;UIe(a)&&(a=[a]);let i=!1;for(const o of a)if("canvases"in o){i=!0;for(const s of o.canvases){const l=(r=(n=(e=s.images[0])==null?void 0:e.resource)==null?void 0:n.service)==null?void 0:r["@id"];if(l)return l}}else i||console.log("The manifest you supplied contains no canvases so there are no images to show.")}else console.log("The manifest you supplied contains no sequence so there are no images to show.");return null}function HIe(t){if("items"in t){const e=t.items;for(const n of e){const r=n.items[0].items[0].body.service[0]["@id"];if(r)return r}}else console.log("The manifest you supplied contains no sequence so there are no images to show.");return null}function K7(t,e){const n=window.getComputedStyle(t);return parseInt(n.getPropertyValue(e),10)}function qIe(t,e){const{width:n,height:r}=e,a=1080,i="0",o="default",s=".jpg",l=document.querySelector(".displayregioncontainer"),u=document.querySelector(".displayregion");if(!l||!u)throw new Error("Canvas or selection element not found");const{clientWidth:c,clientHeight:d}=l,p=n*d/r,f=(c-p)/2,g=n/p,y=9,x=K7(u,"left"),b=K7(u,"top"),v=Math.round(u.clientWidth+y),w=Math.round(u.clientHeight+y),S=Math.max(Math.round((x-f)*g),0),C=Math.max(Math.round(b*g),0),I=Math.min(Math.round(v*g),n),_=Math.min(Math.round(w*g),r),E=`${S},${C},${I},${_}`;return console.log(`Calculated selection region (x, y, width, height): ${E}`),`${t}/${E}/${a},/${i}/${o}${s}`}const X7={fetchIIIFIdentifier:async t=>{try{return await jIe(t)}catch(e){return console.error(e),null}},getCroppedImagePath:async t=>{try{const e=t+"/info.json",n=await fetch(e);if(!n.ok)throw new Error(n.statusText);const r=await n.json();return qIe(t,r)}catch(e){console.error(e)}}},KIe=P.lazy(()=>Nre(()=>import("./index-MRzlPgmJ.js"),V2([]))),XIe={canvasBackgroundColor:"010A01",gestureSettingsTouch:{dragToPan:!1,dblClickToZoom:!1,dblClickDragToZoom:!1,flickEnabled:!1,pinchRotate:!0},informationPanel:{open:!1},openSeadragon:{loadTilesWithAjax:!0,showNavigationControl:!1,showHomeControl:!1,showFullPageControl:!1,showRotationControl:!1,showFlipControl:!1},showTitle:!1,showIIIFBadge:!1,showZoomControl:!1},YIe={colors:{primary:"#BC13FE",accent:"#BC13FE",secondary:"#EDECEA"}};function QIe(){const{t}=Qh(),{imageLikeList:e}=vs(),n=vs(v=>v.addToArtwork),[r,a]=P.useState(e[0]||null),[i,o]=P.useState(""),[s,l]=P.useState("");P.useEffect(()=>{i&&setTimeout(()=>{l(document.querySelectorAll("canvas")[0].toDataURL())},1e3)},[i]);const u=v=>{a(v)},[c,d]=P.useState([]),[p,f]=P.useState(),{autoRemoveBackground:g}=WIe(),y=v=>{const w=new Image;w.src=v,g(w).then(S=>{console.log(S),f(S)})},x=async(v,w)=>{try{const S=await X7.getCroppedImagePath(w);console.log("Cropped image path: ",S),S&&n(v,S)}catch(S){console.error("Error:",S)}},b=v=>{v&&console.log(o(v))};return fe.jsxs(ds,{className:"flex flex-col flex-wrap gap-4 container justify-center content-center text-center mx-auto",children:[fe.jsx("div",{className:"p-2 m-4",children:fe.jsx("h1",{className:"text-2xl",children:t("collectionTitle")})}),fe.jsx(ds,{className:"flex flex-wrap mx-auto",children:e.map(v=>fe.jsx("img",{src:v.thumbnail,alt:v.name,onClick:()=>u(v),style:{cursor:"pointer",margin:"4px"},role:"presentation"},v.id))}),r&&fe.jsxs(ds,{className:"space-y-4",children:[fe.jsx(Vre,{value:c,src:s,onChange:v=>{d(v)},onComplete:v=>{v.length&&Dre(s,v,(w,S)=>{w||(f(S.toDataURL()),n("1",S.toDataURL()))})}}),fe.jsx("div",{children:fe.jsx("img",{src:p,alt:""})}),p&&fe.jsx(Br,{onClick:()=>y(p),children:"Remove Background"}),fe.jsx(P.Suspense,{fallback:fe.jsxs("h2",{children:["\u{1F300} ",t("collectionLoading")]}),children:fe.jsx(KIe,{iiifContent:r.url,options:XIe,customTheme:YIe,canvasIdCallback:b})}),fe.jsx(Br,{className:"p-4 text-xl text-black w-2/3 mx-auto h-16",rounded:!0,inline:!0,onClick:()=>x(r?.id,r?.identifier),children:t("collectionAddText")})]})]})}function ZIe(){const{t}=Qh();return fe.jsx(VM,{theme:"material",children:fe.jsxs(SN,{children:[fe.jsxs(QM,{labels:!0,icons:!0,className:"left-0 bottom-0 fixed k-color-brand-primary text-center",innerClassName:"tabbar-inner",children:[fe.jsx(nf,{active:xl({path:ki("/").pathname,end:!0}),to:"/",component:ey,icon:fe.jsx(ei,{material:fe.jsx($K,{className:"w-10 h-10"}),className:`transition duration-300 ${xl({path:ki("/").pathname,end:!0})&&"animate-pulse"}`}),label:t("start"),touchRipple:!1}),fe.jsx(nf,{active:xl({path:ki("/selection").pathname,end:!0}),to:"/selection",component:ey,icon:fe.jsx(ei,{material:fe.jsx(EK,{className:"w-10 h-10"}),className:`transition duration-300 ${xl({path:ki("/selection").pathname,end:!0})&&"animate-pulse"}`}),label:t("selection"),touchRipple:!1}),fe.jsx(nf,{active:xl({path:ki("/collection").pathname,end:!0}),to:"/collection",component:ey,icon:fe.jsx(ei,{material:fe.jsx(zK,{className:"w-10 h-10"}),className:`transition duration-300 ${xl({path:ki("/collection").pathname,end:!0})&&"animate-pulse"}`}),label:t("collection"),touchRipple:!1}),fe.jsx(nf,{active:xl({path:ki("/creation").pathname,end:!0}),to:"/creation",component:ey,icon:fe.jsx(ei,{material:fe.jsx(AK,{className:"w-10 h-10"}),className:`transition duration-300 ${xl({path:ki("/creation").pathname,end:!0})&&"animate-pulse"}`}),label:t("artwork"),touchRipple:!1})]}),fe.jsx("main",{className:"h-[calc(100%_-_128px)] overflow-auto",children:fe.jsx(jq,{})})]})})}var Y7={exports:{}},Q7={exports:{}},Z7={exports:{}},J7={exports:{}},eB={exports:{}},Y4=Object.defineProperty,JIe=Object.getOwnPropertyDescriptor,e4e=Object.getOwnPropertyNames,t4e=Object.prototype.hasOwnProperty,tB=(t,e)=>{for(var n in e)Y4(t,n,{get:e[n],enumerable:!0})},n4e=(t,e,n,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let a of e4e(e))!t4e.call(t,a)&&a!==n&&Y4(t,a,{get:()=>e[a],enumerable:!(r=JIe(e,a))||r.enumerable});return t},r4e=t=>n4e(Y4({},"__esModule",{value:!0}),t),nB={};tB(nB,{FluidValue:()=>k4e,Globals:()=>rB,addFluidObserver:()=>S4e,callFluidObserver:()=>AB,callFluidObservers:()=>w4e,clamp:()=>bB,colorToRgba:()=>lE,colors:()=>h4e,createInterpolator:()=>uE,createStringInterpolator:()=>_4e,defineHidden:()=>o4e,deprecateDirectCall:()=>M4e,deprecateInterpolate:()=>$4e,each:()=>cB,eachProp:()=>l4e,easings:()=>b4e,flush:()=>dB,flushCalls:()=>c4e,frameLoop:()=>mB,getFluidObservers:()=>x4e,getFluidValue:()=>MB,hasFluidValue:()=>v4e,hex3:()=>SB,hex4:()=>CB,hex6:()=>NB,hex8:()=>TB,hsl:()=>wB,hsla:()=>kB,is:()=>Vo,isAnimatedString:()=>A4e,isEqual:()=>s4e,isSSR:()=>v2,noop:()=>uB,onResize:()=>BB,onScroll:()=>W4e,once:()=>dE,prefix:()=>_2,raf:()=>Lt,removeFluidObserver:()=>C4e,rgb:()=>vB,rgba:()=>xB,setFluidGetter:()=>PB,toArray:()=>u4e,useConstant:()=>U4e,useForceUpdate:()=>K4e,useIsomorphicLayoutEffect:()=>hE,useMemoOne:()=>X4e,useOnce:()=>Z4e,usePrev:()=>eEe,useReducedMotion:()=>nEe});var a4e=r4e(nB),rB={};tB(rB,{assign:()=>fB,colors:()=>Xl,createStringInterpolator:()=>rE,skipAnimation:()=>hB,to:()=>pB,willAdvance:()=>aE});var Q4=hg(),Lt=t=>pg(t,Q4),Z4=hg();Lt.write=t=>pg(t,Z4);var b2=hg();Lt.onStart=t=>pg(t,b2);var J4=hg();Lt.onFrame=t=>pg(t,J4);var eE=hg();Lt.onFinish=t=>pg(t,eE);var kp=[];Lt.setTimeout=(t,e)=>{let n=Lt.now()+e,r=()=>{let i=kp.findIndex(o=>o.cancel==r);~i&&kp.splice(i,1),Kl-=~i?1:0},a={time:n,handler:t,cancel:r};return kp.splice(aB(n),0,a),Kl+=1,iB(),a};var aB=t=>~(~kp.findIndex(e=>e.time>t)||~kp.length);Lt.cancel=t=>{b2.delete(t),J4.delete(t),eE.delete(t),Q4.delete(t),Z4.delete(t)},Lt.sync=t=>{nE=!0,Lt.batchedUpdates(t),nE=!1},Lt.throttle=t=>{let e;function n(){try{t(...e)}finally{e=null}}function r(...a){e=a,Lt.onStart(n)}return r.handler=t,r.cancel=()=>{b2.delete(n),e=null},r};var tE=typeof window<"u"?window.requestAnimationFrame:()=>{};Lt.use=t=>tE=t,Lt.now=typeof performance<"u"?()=>performance.now():Date.now,Lt.batchedUpdates=t=>t(),Lt.catch=console.error,Lt.frameLoop="always",Lt.advance=()=>{Lt.frameLoop!=="demand"?console.warn("Cannot call the manual advancement of rafz whilst frameLoop is not set as demand"):sB()};var ql=-1,Kl=0,nE=!1;function pg(t,e){nE?(e.delete(t),t(0)):(e.add(t),iB())}function iB(){ql<0&&(ql=0,Lt.frameLoop!=="demand"&&tE(oB))}function i4e(){ql=-1}function oB(){~ql&&(tE(oB),Lt.batchedUpdates(sB))}function sB(){let t=ql;ql=Lt.now();let e=aB(ql);if(e&&(lB(kp.splice(0,e),n=>n.handler()),Kl-=e),!Kl){i4e();return}b2.flush(),Q4.flush(t?Math.min(64,ql-t):16.667),J4.flush(),Z4.flush(),eE.flush()}function hg(){let t=new Set,e=t;return{add(n){Kl+=e==t&&!t.has(n)?1:0,t.add(n)},delete(n){return Kl-=e==t&&t.has(n)?1:0,t.delete(n)},flush(n){e.size&&(t=new Set,Kl-=e.size,lB(e,r=>r(n)&&t.add(r)),Kl+=t.size,e=t)}}}function lB(t,e){t.forEach(n=>{try{e(n)}catch(r){Lt.catch(r)}})}function uB(){}var o4e=(t,e,n)=>Object.defineProperty(t,e,{value:n,writable:!0,configurable:!0}),Vo={arr:Array.isArray,obj:t=>!!t&&t.constructor.name==="Object",fun:t=>typeof t=="function",str:t=>typeof t=="string",num:t=>typeof t=="number",und:t=>t===void 0};function s4e(t,e){if(Vo.arr(t)){if(!Vo.arr(e)||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}return t===e}var cB=(t,e)=>t.forEach(e);function l4e(t,e,n){if(Vo.arr(t)){for(let r=0;r<t.length;r++)e.call(n,t[r],`${r}`);return}for(let r in t)t.hasOwnProperty(r)&&e.call(n,t[r],r)}var u4e=t=>Vo.und(t)?[]:Vo.arr(t)?t:[t];function dB(t,e){if(t.size){let n=Array.from(t);t.clear(),cB(n,e)}}var c4e=(t,...e)=>dB(t,n=>n(...e)),v2=()=>typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),rE,pB,Xl=null,hB=!1,aE=uB,fB=t=>{t.to&&(pB=t.to),t.now&&(Lt.now=t.now),t.colors!==void 0&&(Xl=t.colors),t.skipAnimation!=null&&(hB=t.skipAnimation),t.createStringInterpolator&&(rE=t.createStringInterpolator),t.requestAnimationFrame&&Lt.use(t.requestAnimationFrame),t.batchedUpdates&&(Lt.batchedUpdates=t.batchedUpdates),t.willAdvance&&(aE=t.willAdvance),t.frameLoop&&(Lt.frameLoop=t.frameLoop)},fg=new Set,Di=[],iE=[],x2=0,mB={get idle(){return!fg.size&&!Di.length},start(t){x2>t.priority?(fg.add(t),Lt.onStart(d4e)):(gB(t),Lt(oE))},advance:oE,sort(t){if(x2)Lt.onFrame(()=>mB.sort(t));else{let e=Di.indexOf(t);~e&&(Di.splice(e,1),yB(t))}},clear(){Di=[],fg.clear()}};function d4e(){fg.forEach(gB),fg.clear(),Lt(oE)}function gB(t){Di.includes(t)||yB(t)}function yB(t){Di.splice(p4e(Di,e=>e.priority>t.priority),0,t)}function oE(t){let e=iE;for(let n=0;n<Di.length;n++){let r=Di[n];x2=r.priority,r.idle||(aE(r),r.advance(t),r.idle||e.push(r))}return x2=0,iE=Di,iE.length=0,Di=e,Di.length>0}function p4e(t,e){let n=t.findIndex(e);return n<0?t.length:n}var bB=(t,e,n)=>Math.min(Math.max(n,t),e),h4e={transparent:0,aliceblue:4042850303,antiquewhite:4209760255,aqua:16777215,aquamarine:2147472639,azure:4043309055,beige:4126530815,bisque:4293182719,black:255,blanchedalmond:4293643775,blue:65535,blueviolet:2318131967,brown:2771004159,burlywood:3736635391,burntsienna:3934150143,cadetblue:1604231423,chartreuse:2147418367,chocolate:3530104575,coral:4286533887,cornflowerblue:1687547391,cornsilk:4294499583,crimson:3692313855,cyan:16777215,darkblue:35839,darkcyan:9145343,darkgoldenrod:3095792639,darkgray:2846468607,darkgreen:6553855,darkgrey:2846468607,darkkhaki:3182914559,darkmagenta:2332068863,darkolivegreen:1433087999,darkorange:4287365375,darkorchid:2570243327,darkred:2332033279,darksalmon:3918953215,darkseagreen:2411499519,darkslateblue:1211993087,darkslategray:793726975,darkslategrey:793726975,darkturquoise:13554175,darkviolet:2483082239,deeppink:4279538687,deepskyblue:12582911,dimgray:1768516095,dimgrey:1768516095,dodgerblue:512819199,firebrick:2988581631,floralwhite:4294635775,forestgreen:579543807,fuchsia:4278255615,gainsboro:3705462015,ghostwhite:4177068031,gold:4292280575,goldenrod:3668254975,gray:2155905279,green:8388863,greenyellow:2919182335,grey:2155905279,honeydew:4043305215,hotpink:4285117695,indianred:3445382399,indigo:1258324735,ivory:4294963455,khaki:4041641215,lavender:3873897215,lavenderblush:4293981695,lawngreen:2096890111,lemonchiffon:4294626815,lightblue:2916673279,lightcoral:4034953471,lightcyan:3774873599,lightgoldenrodyellow:4210742015,lightgray:3553874943,lightgreen:2431553791,lightgrey:3553874943,lightpink:4290167295,lightsalmon:4288707327,lightseagreen:548580095,lightskyblue:2278488831,lightslategray:2005441023,lightslategrey:2005441023,lightsteelblue:2965692159,lightyellow:4294959359,lime:16711935,limegreen:852308735,linen:4210091775,magenta:4278255615,maroon:2147483903,mediumaquamarine:1724754687,mediumblue:52735,mediumorchid:3126187007,mediumpurple:2473647103,mediumseagreen:1018393087,mediumslateblue:2070474495,mediumspringgreen:16423679,mediumturquoise:1221709055,mediumvioletred:3340076543,midnightblue:421097727,mintcream:4127193855,mistyrose:4293190143,moccasin:4293178879,navajowhite:4292783615,navy:33023,oldlace:4260751103,olive:2155872511,olivedrab:1804477439,orange:4289003775,orangered:4282712319,orchid:3664828159,palegoldenrod:4008225535,palegreen:2566625535,paleturquoise:2951671551,palevioletred:3681588223,papayawhip:4293907967,peachpuff:4292524543,peru:3448061951,pink:4290825215,plum:3718307327,powderblue:2967529215,purple:2147516671,rebeccapurple:1714657791,red:4278190335,rosybrown:3163525119,royalblue:1097458175,saddlebrown:2336560127,salmon:4202722047,sandybrown:4104413439,seagreen:780883967,seashell:4294307583,sienna:2689740287,silver:3233857791,skyblue:2278484991,slateblue:1784335871,slategray:1887473919,slategrey:1887473919,snow:4294638335,springgreen:16744447,steelblue:1182971135,tan:3535047935,teal:8421631,thistle:3636451583,tomato:4284696575,turquoise:1088475391,violet:4001558271,wheat:4125012991,white:4294967295,whitesmoke:4126537215,yellow:4294902015,yellowgreen:2597139199},po="[-+]?\\d*\\.?\\d+",w2=po+"%";function k2(...t){return"\\(\\s*("+t.join(")\\s*,\\s*(")+")\\s*\\)"}var vB=new RegExp("rgb"+k2(po,po,po)),xB=new RegExp("rgba"+k2(po,po,po,po)),wB=new RegExp("hsl"+k2(po,w2,w2)),kB=new RegExp("hsla"+k2(po,w2,w2,po)),SB=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,CB=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,NB=/^#([0-9a-fA-F]{6})$/,TB=/^#([0-9a-fA-F]{8})$/;function f4e(t){let e;return typeof t=="number"?t>>>0===t&&t>=0&&t<=4294967295?t:null:(e=NB.exec(t))?parseInt(e[1]+"ff",16)>>>0:Xl&&Xl[t]!==void 0?Xl[t]:(e=vB.exec(t))?(Sp(e[1])<<24|Sp(e[2])<<16|Sp(e[3])<<8|255)>>>0:(e=xB.exec(t))?(Sp(e[1])<<24|Sp(e[2])<<16|Sp(e[3])<<8|_B(e[4]))>>>0:(e=SB.exec(t))?parseInt(e[1]+e[1]+e[2]+e[2]+e[3]+e[3]+"ff",16)>>>0:(e=TB.exec(t))?parseInt(e[1],16)>>>0:(e=CB.exec(t))?parseInt(e[1]+e[1]+e[2]+e[2]+e[3]+e[3]+e[4]+e[4],16)>>>0:(e=wB.exec(t))?(IB(EB(e[1]),S2(e[2]),S2(e[3]))|255)>>>0:(e=kB.exec(t))?(IB(EB(e[1]),S2(e[2]),S2(e[3]))|_B(e[4]))>>>0:null}function sE(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function IB(t,e,n){let r=n<.5?n*(1+e):n+e-n*e,a=2*n-r,i=sE(a,r,t+1/3),o=sE(a,r,t),s=sE(a,r,t-1/3);return Math.round(i*255)<<24|Math.round(o*255)<<16|Math.round(s*255)<<8}function Sp(t){let e=parseInt(t,10);return e<0?0:e>255?255:e}function EB(t){return(parseFloat(t)%360+360)%360/360}function _B(t){let e=parseFloat(t);return e<0?0:e>1?255:Math.round(e*255)}function S2(t){let e=parseFloat(t);return e<0?0:e>100?1:e/100}function lE(t){let e=f4e(t);if(e===null)return t;e=e||0;let n=(e&4278190080)>>>24,r=(e&16711680)>>>16,a=(e&65280)>>>8,i=(e&255)/255;return`rgba(${n}, ${r}, ${a}, ${i})`}var uE=(t,e,n)=>{if(Vo.fun(t))return t;if(Vo.arr(t))return uE({range:t,output:e,extrapolate:n});if(Vo.str(t.output[0]))return rE(t);let r=t,a=r.output,i=r.range||[0,1],o=r.extrapolateLeft||r.extrapolate||"extend",s=r.extrapolateRight||r.extrapolate||"extend",l=r.easing||(u=>u);return u=>{let c=g4e(u,i);return m4e(u,i[c],i[c+1],a[c],a[c+1],l,o,s,r.map)}};function m4e(t,e,n,r,a,i,o,s,l){let u=l?l(t):t;if(u<e){if(o==="identity")return u;o==="clamp"&&(u=e)}if(u>n){if(s==="identity")return u;s==="clamp"&&(u=n)}return r===a?r:e===n?t<=e?r:a:(e===-1/0?u=-u:n===1/0?u=u-e:u=(u-e)/(n-e),u=i(u),r===-1/0?u=-u:a===1/0?u=u+r:u=u*(a-r)+r,u)}function g4e(t,e){for(var n=1;n<e.length-1&&!(e[n]>=t);++n);return n-1}var y4e=(t,e="end")=>n=>{n=e==="end"?Math.min(n,.999):Math.max(n,.001);let r=n*t,a=e==="end"?Math.floor(r):Math.ceil(r);return bB(0,1,a/t)},C2=1.70158,N2=C2*1.525,OB=C2+1,$B=2*Math.PI/3,RB=2*Math.PI/4.5,T2=t=>t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375,b4e={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>1-(1-t)*(1-t),easeInOutQuad:t=>t<.5?2*t*t:1-Math.pow(-2*t+2,2)/2,easeInCubic:t=>t*t*t,easeOutCubic:t=>1-Math.pow(1-t,3),easeInOutCubic:t=>t<.5?4*t*t*t:1-Math.pow(-2*t+2,3)/2,easeInQuart:t=>t*t*t*t,easeOutQuart:t=>1-Math.pow(1-t,4),easeInOutQuart:t=>t<.5?8*t*t*t*t:1-Math.pow(-2*t+2,4)/2,easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>1-Math.pow(1-t,5),easeInOutQuint:t=>t<.5?16*t*t*t*t*t:1-Math.pow(-2*t+2,5)/2,easeInSine:t=>1-Math.cos(t*Math.PI/2),easeOutSine:t=>Math.sin(t*Math.PI/2),easeInOutSine:t=>-(Math.cos(Math.PI*t)-1)/2,easeInExpo:t=>t===0?0:Math.pow(2,10*t-10),easeOutExpo:t=>t===1?1:1-Math.pow(2,-10*t),easeInOutExpo:t=>t===0?0:t===1?1:t<.5?Math.pow(2,20*t-10)/2:(2-Math.pow(2,-20*t+10))/2,easeInCirc:t=>1-Math.sqrt(1-Math.pow(t,2)),easeOutCirc:t=>Math.sqrt(1-Math.pow(t-1,2)),easeInOutCirc:t=>t<.5?(1-Math.sqrt(1-Math.pow(2*t,2)))/2:(Math.sqrt(1-Math.pow(-2*t+2,2))+1)/2,easeInBack:t=>OB*t*t*t-C2*t*t,easeOutBack:t=>1+OB*Math.pow(t-1,3)+C2*Math.pow(t-1,2),easeInOutBack:t=>t<.5?Math.pow(2*t,2)*((N2+1)*2*t-N2)/2:(Math.pow(2*t-2,2)*((N2+1)*(t*2-2)+N2)+2)/2,easeInElastic:t=>t===0?0:t===1?1:-Math.pow(2,10*t-10)*Math.sin((t*10-10.75)*$B),easeOutElastic:t=>t===0?0:t===1?1:Math.pow(2,-10*t)*Math.sin((t*10-.75)*$B)+1,easeInOutElastic:t=>t===0?0:t===1?1:t<.5?-(Math.pow(2,20*t-10)*Math.sin((20*t-11.125)*RB))/2:Math.pow(2,-20*t+10)*Math.sin((20*t-11.125)*RB)/2+1,easeInBounce:t=>1-T2(1-t),easeOutBounce:T2,easeInOutBounce:t=>t<.5?(1-T2(1-2*t))/2:(1+T2(2*t-1))/2,steps:y4e},mg=Symbol.for("FluidValue.get"),Cp=Symbol.for("FluidValue.observers"),v4e=t=>!!(t&&t[mg]),MB=t=>t&&t[mg]?t[mg]():t,x4e=t=>t[Cp]||null;function AB(t,e){t.eventObserved?t.eventObserved(e):t(e)}function w4e(t,e){let n=t[Cp];n&&n.forEach(r=>{AB(r,e)})}var k4e=class{constructor(t){if(!t&&!(t=this.get))throw Error("Unknown getter");PB(this,t)}},PB=(t,e)=>DB(t,mg,e);function S4e(t,e){if(t[mg]){let n=t[Cp];n||DB(t,Cp,n=new Set),n.has(e)||(n.add(e),t.observerAdded&&t.observerAdded(n.size,e))}return e}function C4e(t,e){let n=t[Cp];if(n&&n.has(e)){let r=n.size-1;r?n.delete(e):t[Cp]=null,t.observerRemoved&&t.observerRemoved(r,e)}}var DB=(t,e,n)=>Object.defineProperty(t,e,{value:n,writable:!0,configurable:!0}),I2=/[+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,N4e=/(#(?:[0-9a-f]{2}){2,4}|(#[0-9a-f]{3})|(rgb|hsl)a?\((-?\d+%?[,\s]+){2,3}\s*[\d\.]+%?\))/gi,LB=new RegExp(`(${I2.source})(%|[a-z]+)`,"i"),T4e=/rgba\(([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+)\)/gi,E2=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/,FB=t=>{let[e,n]=I4e(t);if(!e||v2())return t;let r=window.getComputedStyle(document.documentElement).getPropertyValue(e);return r?r.trim():n&&n.startsWith("--")?window.getComputedStyle(document.documentElement).getPropertyValue(n)||t:n&&E2.test(n)?FB(n):n||t},I4e=t=>{let e=E2.exec(t);if(!e)return[,];let[,n,r]=e;return[n,r]},cE,E4e=(t,e,n,r,a)=>`rgba(${Math.round(e)}, ${Math.round(n)}, ${Math.round(r)}, ${a})`,_4e=t=>{cE||(cE=Xl?new RegExp(`(${Object.keys(Xl).join("|")})(?!\\w)`,"g"):/^\b$/);let e=t.output.map(a=>MB(a).replace(E2,FB).replace(N4e,lE).replace(cE,lE)),n=e.map(a=>a.match(I2).map(Number)),r=n[0].map((a,i)=>n.map(o=>{if(!(i in o))throw Error('The arity of each "output" value must be equal');return o[i]})).map(a=>uE({...t,output:a}));return a=>{var i;let o=!LB.test(e[0])&&((i=e.find(l=>LB.test(l)))==null?void 0:i.replace(I2,"")),s=0;return e[0].replace(I2,()=>`${r[s++](a)}${o||""}`).replace(T4e,E4e)}},_2="react-spring: ",dE=t=>{let e=t,n=!1;if(typeof e!="function")throw new TypeError(`${_2}once requires a function parameter`);return(...r)=>{n||(e(...r),n=!0)}},O4e=dE(console.warn);function $4e(){O4e(`${_2}The "interpolate" function is deprecated in v9 (use "to" instead)`)}var R4e=dE(console.warn);function M4e(){R4e(`${_2}Directly calling start instead of using the api object is deprecated in v9 (use ".start" instead), this will be removed in later 0.X.0 versions`)}function A4e(t){return Vo.str(t)&&(t[0]=="#"||/\d/.test(t)||!v2()&&E2.test(t)||t in(Xl||{}))}var Np,O2=new WeakMap,P4e=t=>t.forEach(({target:e,contentRect:n})=>{var r;return(r=O2.get(e))==null?void 0:r.forEach(a=>a(n))});function D4e(t,e){Np||typeof ResizeObserver<"u"&&(Np=new ResizeObserver(P4e));let n=O2.get(e);return n||(n=new Set,O2.set(e,n)),n.add(t),Np&&Np.observe(e),()=>{let r=O2.get(e);r&&(r.delete(t),!r.size&&Np&&Np.unobserve(e))}}var $2=new Set,gg,L4e=()=>{let t=()=>{$2.forEach(e=>e({width:window.innerWidth,height:window.innerHeight}))};return window.addEventListener("resize",t),()=>{window.removeEventListener("resize",t)}},F4e=t=>($2.add(t),gg||(gg=L4e()),()=>{$2.delete(t),!$2.size&&gg&&(gg(),gg=void 0)}),BB=(t,{container:e=document.documentElement}={})=>e===document.documentElement?F4e(t):D4e(t,e),B4e=(t,e,n)=>e-t===0?1:(n-t)/(e-t),z4e={x:{length:"Width",position:"Left"},y:{length:"Height",position:"Top"}},V4e=class{constructor(t,e){this.createAxis=()=>({current:0,progress:0,scrollLength:0}),this.updateAxis=n=>{let r=this.info[n],{length:a,position:i}=z4e[n];r.current=this.container[`scroll${i}`],r.scrollLength=this.container["scroll"+a]-this.container["client"+a],r.progress=B4e(0,r.scrollLength,r.current)},this.update=()=>{this.updateAxis("x"),this.updateAxis("y")},this.sendEvent=()=>{this.callback(this.info)},this.advance=()=>{this.update(),this.sendEvent()},this.callback=t,this.container=e,this.info={time:0,x:this.createAxis(),y:this.createAxis()}}},yg=new WeakMap,zB=new WeakMap,pE=new WeakMap,VB=t=>t===document.documentElement?window:t,W4e=(t,{container:e=document.documentElement}={})=>{let n=pE.get(e);n||(n=new Set,pE.set(e,n));let r=new V4e(t,e);if(n.add(r),!yg.has(e)){let i=()=>(n?.forEach(s=>s.advance()),!0);yg.set(e,i);let o=VB(e);window.addEventListener("resize",i,{passive:!0}),e!==document.documentElement&&zB.set(e,BB(i,{container:e})),o.addEventListener("scroll",i,{passive:!0})}let a=yg.get(e);return Lt(a),()=>{var i;Lt.cancel(a);let o=pE.get(e);if(!o||(o.delete(r),o.size))return;let s=yg.get(e);yg.delete(e),s&&(VB(e).removeEventListener("scroll",s),window.removeEventListener("resize",s),(i=zB.get(e))==null||i())}},j4e=P;function U4e(t){let e=(0,j4e.useRef)(null);return e.current===null&&(e.current=t()),e.current}var G4e=P,H4e=P,WB=P,hE=v2()?WB.useEffect:WB.useLayoutEffect,q4e=()=>{let t=(0,H4e.useRef)(!1);return hE(()=>(t.current=!0,()=>{t.current=!1}),[]),t};function K4e(){let t=(0,G4e.useState)()[1],e=q4e();return()=>{e.current&&t(Math.random())}}var fE=P;function X4e(t,e){let[n]=(0,fE.useState)(()=>({inputs:e,result:t()})),r=(0,fE.useRef)(),a=r.current,i=a;return i?e&&i.inputs&&Y4e(e,i.inputs)||(i={inputs:e,result:t()}):i=n,(0,fE.useEffect)(()=>{r.current=i,a==n&&(n.inputs=n.result=void 0)},[i]),i.result}function Y4e(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}var Q4e=P,Z4e=t=>(0,Q4e.useEffect)(t,J4e),J4e=[],jB=P;function eEe(t){let e=(0,jB.useRef)();return(0,jB.useEffect)(()=>{e.current=t}),e.current}var tEe=P,nEe=()=>{let[t,e]=(0,tEe.useState)(null);return hE(()=>{let n=window.matchMedia("(prefers-reduced-motion)"),r=a=>{e(a.matches),fB({skipAnimation:a.matches})};return r(n),n.addEventListener("change",r),()=>{n.removeEventListener("change",r)}},[]),t};eB.exports=a4e;var Ft=eB.exports,UB={exports:{}},rEe=Object.create,R2=Object.defineProperty,aEe=Object.getOwnPropertyDescriptor,iEe=Object.getOwnPropertyNames,oEe=Object.getPrototypeOf,sEe=Object.prototype.hasOwnProperty,lEe=(t,e)=>{for(var n in e)R2(t,n,{get:e[n],enumerable:!0})},GB=(t,e,n,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let a of iEe(e))!sEe.call(t,a)&&a!==n&&R2(t,a,{get:()=>e[a],enumerable:!(r=aEe(e,a))||r.enumerable});return t},uEe=(t,e,n)=>(n=t!=null?rEe(oEe(t)):{},GB(e||!t||!t.__esModule?R2(n,"default",{value:t,enumerable:!0}):n,t)),cEe=t=>GB(R2({},"__esModule",{value:!0}),t),HB={};lEe(HB,{Animated:()=>mE,AnimatedArray:()=>bE,AnimatedObject:()=>P2,AnimatedString:()=>M2,AnimatedValue:()=>vg,createHost:()=>xEe,getAnimated:()=>KB,getAnimatedType:()=>mEe,getPayload:()=>YB,isAnimated:()=>qB,setAnimated:()=>XB});var dEe=cEe(HB),pEe=Ft,bg=Symbol.for("Animated:node"),qB=t=>!!t&&t[bg]===t,KB=t=>t&&t[bg],XB=(t,e)=>(0,pEe.defineHidden)(t,bg,e),YB=t=>t&&t[bg]&&t[bg].getPayload(),mE=class{constructor(){XB(this,this)}getPayload(){return this.payload||[]}},gE=Ft,vg=class extends mE{constructor(t){super(),this._value=t,this.done=!0,this.durationProgress=0,gE.is.num(this._value)&&(this.lastPosition=this._value)}static create(t){return new vg(t)}getPayload(){return[this]}getValue(){return this._value}setValue(t,e){return gE.is.num(t)&&(this.lastPosition=t,e&&(t=Math.round(t/e)*e,this.done&&(this.lastPosition=t))),this._value===t?!1:(this._value=t,!0)}reset(){let{done:t}=this;this.done=!1,gE.is.num(this._value)&&(this.elapsedTime=0,this.durationProgress=0,this.lastPosition=this._value,t&&(this.lastVelocity=null),this.v0=null)}},yE=Ft,M2=class extends vg{constructor(t){super(0),this._string=null,this._toString=(0,yE.createInterpolator)({output:[t,t]})}static create(t){return new M2(t)}getValue(){return this._string??(this._string=this._toString(this._value))}setValue(t){if(yE.is.str(t)){if(t==this._string)return!1;this._string=t,this._value=1}else if(super.setValue(t))this._string=null;else return!1;return!0}reset(t){t&&(this._toString=(0,yE.createInterpolator)({output:[this.getValue(),t]})),this._value=0,super.reset()}},hEe=Ft,yc=Ft,A2={dependencies:null},P2=class extends mE{constructor(t){super(),this.source=t,this.setValue(t)}getValue(t){let e={};return(0,yc.eachProp)(this.source,(n,r)=>{qB(n)?e[r]=n.getValue(t):(0,yc.hasFluidValue)(n)?e[r]=(0,yc.getFluidValue)(n):t||(e[r]=n)}),e}setValue(t){this.source=t,this.payload=this._makePayload(t)}reset(){this.payload&&(0,yc.each)(this.payload,t=>t.reset())}_makePayload(t){if(t){let e=new Set;return(0,yc.eachProp)(t,this._addToPayload,e),Array.from(e)}}_addToPayload(t){A2.dependencies&&(0,yc.hasFluidValue)(t)&&A2.dependencies.add(t);let e=YB(t);e&&(0,yc.each)(e,n=>this.add(n))}},bE=class extends P2{constructor(t){super(t)}static create(t){return new bE(t)}getValue(){return this.source.map(t=>t.getValue())}setValue(t){let e=this.getPayload();return t.length==e.length?e.map((n,r)=>n.setValue(t[r])).some(Boolean):(super.setValue(t.map(fEe)),!0)}};function fEe(t){return((0,hEe.isAnimatedString)(t)?M2:vg).create(t)}var QB=Ft;function mEe(t){let e=KB(t);return e?e.constructor:QB.is.arr(t)?bE:(0,QB.isAnimatedString)(t)?M2:vg}var Tp=Ft,gEe=uEe(P),xg=P,oi=Ft,ZB=(t,e)=>{let n=!oi.is.fun(t)||t.prototype&&t.prototype.isReactComponent;return(0,xg.forwardRef)((r,a)=>{let i=(0,xg.useRef)(null),o=n&&(0,xg.useCallback)(g=>{i.current=vEe(a,g)},[a]),[s,l]=bEe(r,e),u=(0,oi.useForceUpdate)(),c=()=>{let g=i.current;n&&!g||(g?e.applyAnimatedValues(g,s.getValue(!0)):!1)===!1&&u()},d=new yEe(c,l),p=(0,xg.useRef)();(0,oi.useIsomorphicLayoutEffect)(()=>(p.current=d,(0,oi.each)(l,g=>(0,oi.addFluidObserver)(g,d)),()=>{p.current&&((0,oi.each)(p.current.deps,g=>(0,oi.removeFluidObserver)(g,p.current)),oi.raf.cancel(p.current.update))})),(0,xg.useEffect)(c,[]),(0,oi.useOnce)(()=>()=>{let g=p.current;(0,oi.each)(g.deps,y=>(0,oi.removeFluidObserver)(y,g))});let f=e.getComponentProps(s.getValue());return gEe.createElement(t,{...f,ref:o})})},yEe=class{constructor(t,e){this.update=t,this.deps=e}eventObserved(t){t.type=="change"&&oi.raf.write(this.update)}};function bEe(t,e){let n=new Set;return A2.dependencies=n,t.style&&(t={...t,style:e.createAnimatedStyle(t.style)}),t=new P2(t),A2.dependencies=null,[t,n]}function vEe(t,e){return t&&(oi.is.fun(t)?t(e):t.current=e),e}var JB=Symbol.for("AnimatedComponent"),xEe=(t,{applyAnimatedValues:e=()=>!1,createAnimatedStyle:n=a=>new P2(a),getComponentProps:r=a=>a}={})=>{let a={applyAnimatedValues:e,createAnimatedStyle:n,getComponentProps:r},i=o=>{let s=ez(o)||"Anonymous";return Tp.is.str(o)?o=i[o]||(i[o]=ZB(o,a)):o=o[JB]||(o[JB]=ZB(o,a)),o.displayName=`Animated(${s})`,o};return(0,Tp.eachProp)(t,(o,s)=>{Tp.is.arr(t)&&(s=ez(o)),i[s]=i(o)}),{animated:i}},ez=t=>Tp.is.str(t)?t:t&&Tp.is.str(t.displayName)?t.displayName:Tp.is.fun(t)&&t.name||null;UB.exports=dEe;var wg=UB.exports,tz={exports:{}},vE,nz;function wEe(){if(nz)return vE;nz=1;var t=Object.defineProperty,e=Object.getOwnPropertyDescriptor,n=Object.getOwnPropertyNames,r=Object.prototype.hasOwnProperty,a=(u,c)=>{for(var d in c)t(u,d,{get:c[d],enumerable:!0})},i=(u,c,d,p)=>{if(c&&typeof c=="object"||typeof c=="function")for(let f of n(c))!r.call(u,f)&&f!==d&&t(u,f,{get:()=>c[f],enumerable:!(p=e(c,f))||p.enumerable});return u},o=u=>i(t({},"__esModule",{value:!0}),u),s={};a(s,{Any:()=>l}),vE=o(s);var l=class{};return vE}var rz;function kEe(){return rz||(rz=1,tz.exports=wEe()),tz.exports}(function(t){var e=Object.create,n=Object.defineProperty,r=Object.getOwnPropertyDescriptor,a=Object.getOwnPropertyNames,i=Object.getPrototypeOf,o=Object.prototype.hasOwnProperty,s=(D,j)=>{for(var J in j)n(D,J,{get:j[J],enumerable:!0})},l=(D,j,J,re)=>{if(j&&typeof j=="object"||typeof j=="function")for(let ge of a(j))!o.call(D,ge)&&ge!==J&&n(D,ge,{get:()=>j[ge],enumerable:!(re=r(j,ge))||re.enumerable});return D},u=(D,j,J)=>(l(D,j,"default"),J&&l(J,j,"default")),c=(D,j,J)=>(J=D!=null?e(i(D)):{},l(j||!D||!D.__esModule?n(J,"default",{value:D,enumerable:!0}):J,D)),d=D=>l(n({},"__esModule",{value:!0}),D),p={};s(p,{BailSignal:()=>Ye,Controller:()=>Mp,FrameValue:()=>Yt,Globals:()=>Ho.Globals,Interpolation:()=>au,Spring:()=>Go,SpringContext:()=>Bi,SpringRef:()=>Nc,SpringValue:()=>rn,Trail:()=>qr,Transition:()=>Ec,config:()=>ne,createInterpolator:()=>qo.createInterpolator,easings:()=>qo.easings,inferTo:()=>E,interpolate:()=>_c,to:()=>tw,update:()=>iu,useChain:()=>K,useInView:()=>Hr,useIsomorphicLayoutEffect:()=>qo.useIsomorphicLayoutEffect,useReducedMotion:()=>qo.useReducedMotion,useResize:()=>an,useScroll:()=>Bs,useSpring:()=>nu,useSpringRef:()=>Z2,useSpringValue:()=>J2,useSprings:()=>Dp,useTrail:()=>Ag,useTransition:()=>Ic}),t.exports=d(p);var f=Ft,g=Ft;function y(D,...j){return g.is.fun(D)?D(...j):D}var x=(D,j)=>D===!0||!!(j&&D&&(g.is.fun(D)?D(j):(0,g.toArray)(D).includes(j))),b=(D,j)=>g.is.obj(D)?j&&D[j]:D,v=(D,j)=>D.default===!0?D[j]:D.default?D.default[j]:void 0,w=D=>D,S=(D,j=w)=>{let J=C;D.default&&D.default!==!0&&(D=D.default,J=Object.keys(D));let re={};for(let ge of J){let xe=j(D[ge],ge);g.is.und(xe)||(re[ge]=xe)}return re},C=["config","onProps","onStart","onChange","onPause","onResume","onRest"],I={config:1,from:1,to:1,ref:1,loop:1,reset:1,pause:1,cancel:1,reverse:1,immediate:1,default:1,delay:1,onProps:1,onStart:1,onChange:1,onPause:1,onResume:1,onRest:1,onResolve:1,items:1,trail:1,sort:1,expires:1,initial:1,enter:1,update:1,leave:1,children:1,onDestroyed:1,keys:1,callId:1,parentId:1};function _(D){let j={},J=0;if((0,g.eachProp)(D,(re,ge)=>{I[ge]||(j[ge]=re,J++)}),J)return j}function E(D){let j=_(D);if(j){let J={to:j};return(0,g.eachProp)(D,(re,ge)=>ge in j||(J[ge]=re)),J}return{...D}}function A(D){return D=(0,g.getFluidValue)(D),g.is.arr(D)?D.map(A):(0,g.isAnimatedString)(D)?g.Globals.createStringInterpolator({range:[0,1],output:[D,D]})(1):D}function M(D){for(let j in D)return!0;return!1}function L(D){return g.is.fun(D)||g.is.arr(D)&&g.is.obj(D[0])}function W(D,j){var J;(J=D.ref)==null||J.delete(D),j?.delete(D)}function B(D,j){var J;j&&D.ref!==j&&((J=D.ref)==null||J.delete(D),j.add(D),D.ref=j)}function K(D,j,J=1e3){(0,f.useIsomorphicLayoutEffect)(()=>{if(j){let re=0;(0,f.each)(D,(ge,xe)=>{let Oe=ge.current;if(Oe.length){let Ee=J*j[xe];isNaN(Ee)?Ee=re:re=Ee,(0,f.each)(Oe,Ce=>{(0,f.each)(Ce.queue,Le=>{let st=Le.delay;Le.delay=Ke=>Ee+y(st||0,Ke)})}),ge.start()}})}else{let re=Promise.resolve();(0,f.each)(D,ge=>{let xe=ge.current;if(xe.length){let Oe=xe.map(Ee=>{let Ce=Ee.queue;return Ee.queue=[],Ce});re=re.then(()=>((0,f.each)(xe,(Ee,Ce)=>(0,f.each)(Oe[Ce]||[],Le=>Ee.queue.push(Le))),Promise.all(ge.start())))}})}})}var X=Ft,Q=P,H=Ft,F=Ft,Y=wg,Z=Ft,ne={default:{tension:170,friction:26},gentle:{tension:120,friction:14},wobbly:{tension:180,friction:12},stiff:{tension:210,friction:20},slow:{tension:280,friction:60},molasses:{tension:280,friction:120}},se={...ne.default,mass:1,damping:1,easing:Z.easings.linear,clamp:!1},ce=class{constructor(){this.velocity=0,Object.assign(this,se)}};function le(D,j,J){J&&(J={...J},ye(J,j),j={...J,...j}),ye(D,j),Object.assign(D,j);for(let Oe in se)D[Oe]==null&&(D[Oe]=se[Oe]);let{frequency:re,damping:ge}=D,{mass:xe}=D;return Z.is.und(re)||(re<.01&&(re=.01),ge<0&&(ge=0),D.tension=Math.pow(2*Math.PI/re,2)*xe,D.friction=4*Math.PI*ge*xe/re),D}function ye(D,j){if(!Z.is.und(j.decay))D.duration=void 0;else{let J=!Z.is.und(j.tension)||!Z.is.und(j.friction);(J||!Z.is.und(j.frequency)||!Z.is.und(j.damping)||!Z.is.und(j.mass))&&(D.duration=void 0,D.decay=void 0),J&&(D.frequency=void 0)}}var we=[],q=class{constructor(){this.changed=!1,this.values=we,this.toValues=null,this.fromValues=we,this.config=new ce,this.immediate=!1}},ie=Ft;function de(D,{key:j,props:J,defaultProps:re,state:ge,actions:xe}){return new Promise((Oe,Ee)=>{let Ce,Le,st=x(J.cancel??re?.cancel,j);if(st)ct();else{ie.is.und(J.pause)||(ge.paused=x(J.pause,j));let je=re?.pause;je!==!0&&(je=ge.paused||x(je,j)),Ce=y(J.delay||0,j),je?(ge.resumeQueue.add(bt),xe.pause()):(xe.resume(),bt())}function Ke(){ge.resumeQueue.add(bt),ge.timeouts.delete(Le),Le.cancel(),Ce=Le.time-ie.raf.now()}function bt(){Ce>0&&!ie.Globals.skipAnimation?(ge.delayed=!0,Le=ie.raf.setTimeout(ct,Ce),ge.pauseQueue.add(Ke),ge.timeouts.add(Le)):ct()}function ct(){ge.delayed&&(ge.delayed=!1),ge.pauseQueue.delete(Ke),ge.timeouts.delete(Le),D<=(ge.cancelId||0)&&(st=!0);try{xe.start({...J,callId:D,cancel:st},Oe)}catch(je){Ee(je)}}})}var ke=Ft,Ne=(D,j)=>j.length==1?j[0]:j.some(J=>J.cancelled)?He(D.get()):j.every(J=>J.noop)?Ie(D.get()):De(D.get(),j.every(J=>J.finished)),Ie=D=>({value:D,noop:!0,finished:!0,cancelled:!1}),De=(D,j,J=!1)=>({value:D,finished:j,cancelled:J}),He=D=>({value:D,cancelled:!0,finished:!1});function Me(D,j,J,re){let{callId:ge,parentId:xe,onRest:Oe}=j,{asyncTo:Ee,promise:Ce}=J;return!xe&&D===Ee&&!j.reset?Ce:J.promise=(async()=>{J.asyncId=ge,J.asyncTo=D;let Le=S(j,(rt,Xe)=>Xe==="onRest"?void 0:rt),st,Ke,bt=new Promise((rt,Xe)=>(st=rt,Ke=Xe)),ct=rt=>{let Xe=ge<=(J.cancelId||0)&&He(re)||ge!==J.asyncId&&De(re,!1);if(Xe)throw rt.result=Xe,Ke(rt),rt},je=(rt,Xe)=>{let dt=new Ye,et=new Ze;return(async()=>{if(ke.Globals.skipAnimation)throw it(J),et.result=De(re,!1),Ke(et),et;ct(dt);let ut=ke.is.obj(rt)?{...rt}:{...Xe,to:rt};ut.parentId=ge,(0,ke.eachProp)(Le,(Ta,It)=>{ke.is.und(ut[It])&&(ut[It]=Ta)});let Fn=await re.start(ut);return ct(dt),J.paused&&await new Promise(Ta=>{J.resumeQueue.add(Ta)}),Fn})()},tt;if(ke.Globals.skipAnimation)return it(J),De(re,!1);try{let rt;ke.is.arr(D)?rt=(async Xe=>{for(let dt of Xe)await je(dt)})(D):rt=Promise.resolve(D(je,re.stop.bind(re))),await Promise.all([rt.then(st),bt]),tt=De(re.get(),!0,!1)}catch(rt){if(rt instanceof Ye)tt=rt.result;else if(rt instanceof Ze)tt=rt.result;else throw rt}finally{ge==J.asyncId&&(J.asyncId=xe,J.asyncTo=xe?Ee:void 0,J.promise=xe?Ce:void 0)}return ke.is.fun(Oe)&&ke.raf.batchedUpdates(()=>{Oe(tt,re,re.item)}),tt})()}function it(D,j){(0,ke.flush)(D.timeouts,J=>J.cancel()),D.pauseQueue.clear(),D.resumeQueue.clear(),D.asyncId=D.asyncTo=D.promise=void 0,j&&(D.cancelId=j)}var Ye=class extends Error{constructor(){super("An async animation has been interrupted. You see this error because you forgot to use `await` or `.catch(...)` on its returned promise.")}},Ze=class extends Error{constructor(){super("SkipAnimationSignal")}},Qe=Ft,Xt=wg,Wt=D=>D instanceof Yt,Ht=1,Yt=class extends Qe.FluidValue{constructor(){super(...arguments),this.id=Ht++,this._priority=0}get priority(){return this._priority}set priority(D){this._priority!=D&&(this._priority=D,this._onPriorityChange(D))}get(){let D=(0,Xt.getAnimated)(this);return D&&D.getValue()}to(...D){return Qe.Globals.to(this,D)}interpolate(...D){return(0,Qe.deprecateInterpolate)(),Qe.Globals.to(this,D)}toJSON(){return this.get()}observerAdded(D){D==1&&this._attach()}observerRemoved(D){D==0&&this._detach()}_attach(){}_detach(){}_onChange(D,j=!1){(0,Qe.callFluidObservers)(this,{type:"change",parent:this,value:D,idle:j})}_onPriorityChange(D){this.idle||Qe.frameLoop.sort(this),(0,Qe.callFluidObservers)(this,{type:"priority",parent:this,priority:D})}},jt=Symbol.for("SpringPhase"),Tt=1,Gn=2,gr=4,Ga=D=>(D[jt]&Tt)>0,_r=D=>(D[jt]&Gn)>0,Li=D=>(D[jt]&gr)>0,Ls=(D,j)=>j?D[jt]|=Gn|Tt:D[jt]&=~Gn,ho=(D,j)=>j?D[jt]|=gr:D[jt]&=~gr,rn=class extends Yt{constructor(D,j){if(super(),this.animation=new q,this.defaultProps={},this._state={paused:!1,delayed:!1,pauseQueue:new Set,resumeQueue:new Set,timeouts:new Set},this._pendingCalls=new Set,this._lastCallId=0,this._lastToId=0,this._memoizedDuration=0,!F.is.und(D)||!F.is.und(j)){let J=F.is.obj(D)?{...D}:{...j,from:D};F.is.und(J.default)&&(J.default=!0),this.start(J)}}get idle(){return!(_r(this)||this._state.asyncTo)||Li(this)}get goal(){return(0,F.getFluidValue)(this.animation.to)}get velocity(){let D=(0,Y.getAnimated)(this);return D instanceof Y.AnimatedValue?D.lastVelocity||0:D.getPayload().map(j=>j.lastVelocity||0)}get hasAnimated(){return Ga(this)}get isAnimating(){return _r(this)}get isPaused(){return Li(this)}get isDelayed(){return this._state.delayed}advance(D){let j=!0,J=!1,re=this.animation,{toValues:ge}=re,{config:xe}=re,Oe=(0,Y.getPayload)(re.to);!Oe&&(0,F.hasFluidValue)(re.to)&&(ge=(0,F.toArray)((0,F.getFluidValue)(re.to))),re.values.forEach((Le,st)=>{if(Le.done)return;let Ke=Le.constructor==Y.AnimatedString?1:Oe?Oe[st].lastPosition:ge[st],bt=re.immediate,ct=Ke;if(!bt){if(ct=Le.lastPosition,xe.tension<=0){Le.done=!0;return}let je=Le.elapsedTime+=D,tt=re.fromValues[st],rt=Le.v0!=null?Le.v0:Le.v0=F.is.arr(xe.velocity)?xe.velocity[st]:xe.velocity,Xe,dt=xe.precision||(tt==Ke?.005:Math.min(1,Math.abs(Ke-tt)*.001));if(F.is.und(xe.duration))if(xe.decay){let et=xe.decay===!0?.998:xe.decay,ut=Math.exp(-(1-et)*je);ct=tt+rt/(1-et)*(1-ut),bt=Math.abs(Le.lastPosition-ct)<=dt,Xe=rt*ut}else{Xe=Le.lastVelocity==null?rt:Le.lastVelocity;let et=xe.restVelocity||dt/10,ut=xe.clamp?0:xe.bounce,Fn=!F.is.und(ut),Ta=tt==Ke?Le.v0>0:tt<Ke,It,Sn=!1,yn=1,Kr=Math.ceil(D/yn);for(let fa=0;fa<Kr&&(It=Math.abs(Xe)>et,!(!It&&(bt=Math.abs(Ke-ct)<=dt,bt)));++fa){Fn&&(Sn=ct==Ke||ct>Ke==Ta,Sn&&(Xe=-Xe*ut,ct=Ke));let zi=-xe.tension*1e-6*(ct-Ke),Yn=-xe.friction*.001*Xe,at=(zi+Yn)/xe.mass;Xe=Xe+at*yn,ct=ct+Xe*yn}}else{let et=1;xe.duration>0&&(this._memoizedDuration!==xe.duration&&(this._memoizedDuration=xe.duration,Le.durationProgress>0&&(Le.elapsedTime=xe.duration*Le.durationProgress,je=Le.elapsedTime+=D)),et=(xe.progress||0)+je/this._memoizedDuration,et=et>1?1:et<0?0:et,Le.durationProgress=et),ct=tt+xe.easing(et)*(Ke-tt),Xe=(ct-Le.lastPosition)/D,bt=et==1}Le.lastVelocity=Xe,Number.isNaN(ct)&&(console.warn("Got NaN while animating:",this),bt=!0)}Oe&&!Oe[st].done&&(bt=!1),bt?Le.done=!0:j=!1,Le.setValue(ct,xe.round)&&(J=!0)});let Ee=(0,Y.getAnimated)(this),Ce=Ee.getValue();if(j){let Le=(0,F.getFluidValue)(re.to);(Ce!==Le||J)&&!xe.decay?(Ee.setValue(Le),this._onChange(Le)):J&&xe.decay&&this._onChange(Ce),this._stop()}else J&&this._onChange(Ce)}set(D){return F.raf.batchedUpdates(()=>{this._stop(),this._focus(D),this._set(D)}),this}pause(){this._update({pause:!0})}resume(){this._update({pause:!1})}finish(){if(_r(this)){let{to:D,config:j}=this.animation;F.raf.batchedUpdates(()=>{this._onStart(),j.decay||this._set(D,!1),this._stop()})}return this}update(D){return(this.queue||(this.queue=[])).push(D),this}start(D,j){let J;return F.is.und(D)?(J=this.queue||[],this.queue=[]):J=[F.is.obj(D)?D:{...j,to:D}],Promise.all(J.map(re=>this._update(re))).then(re=>Ne(this,re))}stop(D){let{to:j}=this.animation;return this._focus(this.get()),it(this._state,D&&this._lastCallId),F.raf.batchedUpdates(()=>this._stop(j,D)),this}reset(){this._update({reset:!0})}eventObserved(D){D.type=="change"?this._start():D.type=="priority"&&(this.priority=D.priority+1)}_prepareNode(D){let j=this.key||"",{to:J,from:re}=D;J=F.is.obj(J)?J[j]:J,(J==null||L(J))&&(J=void 0),re=F.is.obj(re)?re[j]:re,re==null&&(re=void 0);let ge={to:J,from:re};return Ga(this)||(D.reverse&&([J,re]=[re,J]),re=(0,F.getFluidValue)(re),F.is.und(re)?(0,Y.getAnimated)(this)||this._set(J):this._set(re)),ge}_update({...D},j){let{key:J,defaultProps:re}=this;D.default&&Object.assign(re,S(D,(Oe,Ee)=>/^on/.test(Ee)?b(Oe,J):Oe)),Ig(this,D,"onProps"),eu(this,"onProps",D,this);let ge=this._prepareNode(D);if(Object.isFrozen(this))throw Error("Cannot animate a `SpringValue` object that is frozen. Did you forget to pass your component to `animated(...)` before animating its props?");let xe=this._state;return de(++this._lastCallId,{key:J,props:D,defaultProps:re,state:xe,actions:{pause:()=>{Li(this)||(ho(this,!0),(0,F.flushCalls)(xe.pauseQueue),eu(this,"onPause",De(this,Fi(this,this.animation.to)),this))},resume:()=>{Li(this)&&(ho(this,!1),_r(this)&&this._resume(),(0,F.flushCalls)(xe.resumeQueue),eu(this,"onResume",De(this,Fi(this,this.animation.to)),this))},start:this._merge.bind(this,ge)}}).then(Oe=>{if(D.loop&&Oe.finished&&!(j&&Oe.noop)){let Ee=Fs(D);if(Ee)return this._update(Ee,!0)}return Oe})}_merge(D,j,J){if(j.cancel)return this.stop(!0),J(He(this));let re=!F.is.und(D.to),ge=!F.is.und(D.from);if(re||ge)if(j.callId>this._lastToId)this._lastToId=j.callId;else return J(He(this));let{key:xe,defaultProps:Oe,animation:Ee}=this,{to:Ce,from:Le}=Ee,{to:st=Ce,from:Ke=Le}=D;ge&&!re&&(!j.default||F.is.und(st))&&(st=Ke),j.reverse&&([st,Ke]=[Ke,st]);let bt=!(0,F.isEqual)(Ke,Le);bt&&(Ee.from=Ke),Ke=(0,F.getFluidValue)(Ke);let ct=!(0,F.isEqual)(st,Ce);ct&&this._focus(st);let je=L(j.to),{config:tt}=Ee,{decay:rt,velocity:Xe}=tt;(re||ge)&&(tt.velocity=0),j.config&&!je&&le(tt,y(j.config,xe),j.config!==Oe.config?y(Oe.config,xe):void 0);let dt=(0,Y.getAnimated)(this);if(!dt||F.is.und(st))return J(De(this,!0));let et=F.is.und(j.reset)?ge&&!j.default:!F.is.und(Ke)&&x(j.reset,xe),ut=et?Ke:this.get(),Fn=A(st),Ta=F.is.num(Fn)||F.is.arr(Fn)||(0,F.isAnimatedString)(Fn),It=!je&&(!Ta||x(Oe.immediate||j.immediate,xe));if(ct){let fa=(0,Y.getAnimatedType)(st);if(fa!==dt.constructor)if(It)dt=this._set(Fn);else throw Error(`Cannot animate between ${dt.constructor.name} and ${fa.name}, as the "to" prop suggests`)}let Sn=dt.constructor,yn=(0,F.hasFluidValue)(st),Kr=!1;if(!yn){let fa=et||!Ga(this)&&bt;(ct||fa)&&(Kr=(0,F.isEqual)(A(ut),Fn),yn=!Kr),(!(0,F.isEqual)(Ee.immediate,It)&&!It||!(0,F.isEqual)(tt.decay,rt)||!(0,F.isEqual)(tt.velocity,Xe))&&(yn=!0)}if(Kr&&_r(this)&&(Ee.changed&&!et?yn=!0:yn||this._stop(Ce)),!je&&((yn||(0,F.hasFluidValue)(Ce))&&(Ee.values=dt.getPayload(),Ee.toValues=(0,F.hasFluidValue)(st)?null:Sn==Y.AnimatedString?[1]:(0,F.toArray)(Fn)),Ee.immediate!=It&&(Ee.immediate=It,!It&&!et&&this._set(Ce)),yn)){let{onRest:fa}=Ee;(0,F.each)(Rp,Yn=>Ig(this,j,Yn));let zi=De(this,Fi(this,Ce));(0,F.flushCalls)(this._pendingCalls,zi),this._pendingCalls.add(J),Ee.changed&&F.raf.batchedUpdates(()=>{var Yn;Ee.changed=!et,fa?.(zi,this),et?y(Oe.onRest,zi):(Yn=Ee.onStart)==null||Yn.call(Ee,zi,this)})}et&&this._set(ut),je?J(Me(j.to,j,this._state,this)):yn?this._start():_r(this)&&!ct?this._pendingCalls.add(J):J(Ie(ut))}_focus(D){let j=this.animation;D!==j.to&&((0,F.getFluidObservers)(this)&&this._detach(),j.to=D,(0,F.getFluidObservers)(this)&&this._attach())}_attach(){let D=0,{to:j}=this.animation;(0,F.hasFluidValue)(j)&&((0,F.addFluidObserver)(j,this),Wt(j)&&(D=j.priority+1)),this.priority=D}_detach(){let{to:D}=this.animation;(0,F.hasFluidValue)(D)&&(0,F.removeFluidObserver)(D,this)}_set(D,j=!0){let J=(0,F.getFluidValue)(D);if(!F.is.und(J)){let re=(0,Y.getAnimated)(this);if(!re||!(0,F.isEqual)(J,re.getValue())){let ge=(0,Y.getAnimatedType)(J);!re||re.constructor!=ge?(0,Y.setAnimated)(this,ge.create(J)):re.setValue(J),re&&F.raf.batchedUpdates(()=>{this._onChange(J,j)})}}return(0,Y.getAnimated)(this)}_onStart(){let D=this.animation;D.changed||(D.changed=!0,eu(this,"onStart",De(this,Fi(this,D.to)),this))}_onChange(D,j){j||(this._onStart(),y(this.animation.onChange,D,this)),y(this.defaultProps.onChange,D,this),super._onChange(D,j)}_start(){let D=this.animation;(0,Y.getAnimated)(this).reset((0,F.getFluidValue)(D.to)),D.immediate||(D.fromValues=D.values.map(j=>j.lastPosition)),_r(this)||(Ls(this,!0),Li(this)||this._resume())}_resume(){F.Globals.skipAnimation?this.finish():F.frameLoop.start(this)}_stop(D,j){if(_r(this)){Ls(this,!1);let J=this.animation;(0,F.each)(J.values,ge=>{ge.done=!0}),J.toValues&&(J.onChange=J.onPause=J.onResume=void 0),(0,F.callFluidObservers)(this,{type:"idle",parent:this});let re=j?He(this.get()):De(this.get(),Fi(this,D??J.to));(0,F.flushCalls)(this._pendingCalls,re),J.changed&&(J.changed=!1,eu(this,"onRest",re,this))}}};function Fi(D,j){let J=A(j),re=A(D.get());return(0,F.isEqual)(re,J)}function Fs(D,j=D.loop,J=D.to){let re=y(j);if(re){let ge=re!==!0&&E(re),xe=(ge||D).reverse,Oe=!ge||ge.reset;return fo({...D,loop:j,default:!1,pause:void 0,to:!xe||L(J)?J:void 0,from:Oe?D.from:void 0,reset:Oe,...ge})}}function fo(D){let{to:j,from:J}=D=E(D),re=new Set;return F.is.obj(j)&&Ca(j,re),F.is.obj(J)&&Ca(J,re),D.keys=re.size?Array.from(re):null,D}function $p(D){let j=fo(D);return F.is.und(j.default)&&(j.default=S(j)),j}function Ca(D,j){(0,F.eachProp)(D,(J,re)=>J!=null&&j.add(re))}var Rp=["onStart","onRest","onChange","onPause","onResume"];function Ig(D,j,J){D.animation[J]=j[J]!==v(j,J)?b(j[J],D.key):void 0}function eu(D,j,...J){var re,ge,xe,Oe;(ge=(re=D.animation)[j])==null||ge.call(re,...J),(Oe=(xe=D.defaultProps)[j])==null||Oe.call(xe,...J)}var $t=Ft,Eg=["onStart","onChange","onRest"],_g=1,Mp=class{constructor(D,j){this.id=_g++,this.springs={},this.queue=[],this._lastAsyncId=0,this._active=new Set,this._changed=new Set,this._started=!1,this._state={paused:!1,pauseQueue:new Set,resumeQueue:new Set,timeouts:new Set},this._events={onStart:new Map,onChange:new Map,onRest:new Map},this._onFrame=this._onFrame.bind(this),j&&(this._flush=j),D&&this.start({default:!0,...D})}get idle(){return!this._state.asyncTo&&Object.values(this.springs).every(D=>D.idle&&!D.isDelayed&&!D.isPaused)}get item(){return this._item}set item(D){this._item=D}get(){let D={};return this.each((j,J)=>D[J]=j.get()),D}set(D){for(let j in D){let J=D[j];$t.is.und(J)||this.springs[j].set(J)}}update(D){return D&&this.queue.push(fo(D)),this}start(D){let{queue:j}=this;return D?j=(0,$t.toArray)(D).map(fo):this.queue=[],this._flush?this._flush(this,j):(Pp(this,j),tu(this,j))}stop(D,j){if(D!==!!D&&(j=D),j){let J=this.springs;(0,$t.each)((0,$t.toArray)(j),re=>J[re].stop(!!D))}else it(this._state,this._lastAsyncId),this.each(J=>J.stop(!!D));return this}pause(D){if($t.is.und(D))this.start({pause:!0});else{let j=this.springs;(0,$t.each)((0,$t.toArray)(D),J=>j[J].pause())}return this}resume(D){if($t.is.und(D))this.start({pause:!1});else{let j=this.springs;(0,$t.each)((0,$t.toArray)(D),J=>j[J].resume())}return this}each(D){(0,$t.eachProp)(this.springs,D)}_onFrame(){let{onStart:D,onChange:j,onRest:J}=this._events,re=this._active.size>0,ge=this._changed.size>0;(re&&!this._started||ge&&!this._started)&&(this._started=!0,(0,$t.flush)(D,([Ee,Ce])=>{Ce.value=this.get(),Ee(Ce,this,this._item)}));let xe=!re&&this._started,Oe=ge||xe&&J.size?this.get():null;ge&&j.size&&(0,$t.flush)(j,([Ee,Ce])=>{Ce.value=Oe,Ee(Ce,this,this._item)}),xe&&(this._started=!1,(0,$t.flush)(J,([Ee,Ce])=>{Ce.value=Oe,Ee(Ce,this,this._item)}))}eventObserved(D){if(D.type=="change")this._changed.add(D.parent),D.idle||this._active.add(D.parent);else if(D.type=="idle")this._active.delete(D.parent);else return;$t.raf.onFrame(this._onFrame)}};function tu(D,j){return Promise.all(j.map(J=>Ap(D,J))).then(J=>Ne(D,J))}async function Ap(D,j,J){let{keys:re,to:ge,from:xe,loop:Oe,onRest:Ee,onResolve:Ce}=j,Le=$t.is.obj(j.default)&&j.default;Oe&&(j.loop=!1),ge===!1&&(j.to=null),xe===!1&&(j.from=null);let st=$t.is.arr(ge)||$t.is.fun(ge)?ge:void 0;st?(j.to=void 0,j.onRest=void 0,Le&&(Le.onRest=void 0)):(0,$t.each)(Eg,tt=>{let rt=j[tt];if($t.is.fun(rt)){let Xe=D._events[tt];j[tt]=({finished:dt,cancelled:et})=>{let ut=Xe.get(rt);ut?(dt||(ut.finished=!1),et&&(ut.cancelled=!0)):Xe.set(rt,{value:null,finished:dt||!1,cancelled:et||!1})},Le&&(Le[tt]=j[tt])}});let Ke=D._state;j.pause===!Ke.paused?(Ke.paused=j.pause,(0,$t.flushCalls)(j.pause?Ke.pauseQueue:Ke.resumeQueue)):Ke.paused&&(j.pause=!0);let bt=(re||Object.keys(D.springs)).map(tt=>D.springs[tt].start(j)),ct=j.cancel===!0||v(j,"cancel")===!0;(st||ct&&Ke.asyncId)&&bt.push(de(++D._lastAsyncId,{props:j,state:Ke,actions:{pause:$t.noop,resume:$t.noop,start(tt,rt){ct?(it(Ke,D._lastAsyncId),rt(He(D))):(tt.onRest=Ee,rt(Me(st,tt,Ke,D)))}}})),Ke.paused&&await new Promise(tt=>{Ke.resumeQueue.add(tt)});let je=Ne(D,await Promise.all(bt));if(Oe&&je.finished&&!(J&&je.noop)){let tt=Fs(j,Oe,ge);if(tt)return Pp(D,[tt]),Ap(D,tt,!0)}return Ce&&$t.raf.batchedUpdates(()=>Ce(je,D,D.item)),je}function kc(D,j){let J={...D.springs};return j&&(0,$t.each)((0,$t.toArray)(j),re=>{$t.is.und(re.keys)&&(re=fo(re)),$t.is.obj(re.to)||(re={...re,to:void 0}),Rg(J,re,ge=>$g(ge))}),Og(D,J),J}function Og(D,j){(0,$t.eachProp)(j,(J,re)=>{D.springs[re]||(D.springs[re]=J,(0,$t.addFluidObserver)(J,D))})}function $g(D,j){let J=new rn;return J.key=D,j&&(0,$t.addFluidObserver)(J,j),J}function Rg(D,j,J){j.keys&&(0,$t.each)(j.keys,re=>{(D[re]||(D[re]=J(re)))._prepareNode(j)})}function Pp(D,j){(0,$t.each)(j,J=>{Rg(D.springs,J,re=>$g(re,D))})}var Sc=c(P),q2=P,K2=Ft,Bi=({children:D,...j})=>{let J=(0,q2.useContext)(Cc),re=j.pause||!!J.pause,ge=j.immediate||!!J.immediate;j=(0,K2.useMemoOne)(()=>({pause:re,immediate:ge}),[re,ge]);let{Provider:xe}=Cc;return Sc.createElement(xe,{value:j},D)},Cc=X2(Bi,{});Bi.Provider=Cc.Provider,Bi.Consumer=Cc.Consumer;function X2(D,j){return Object.assign(D,Sc.createContext(j)),D.Provider._context=D,D.Consumer._context=D,D}var Na=Ft,Nc=()=>{let D=[],j=function(re){(0,Na.deprecateDirectCall)();let ge=[];return(0,Na.each)(D,(xe,Oe)=>{if(Na.is.und(re))ge.push(xe.start());else{let Ee=J(re,xe,Oe);Ee&&ge.push(xe.start(Ee))}}),ge};j.current=D,j.add=function(re){D.includes(re)||D.push(re)},j.delete=function(re){let ge=D.indexOf(re);~ge&&D.splice(ge,1)},j.pause=function(){return(0,Na.each)(D,re=>re.pause(...arguments)),this},j.resume=function(){return(0,Na.each)(D,re=>re.resume(...arguments)),this},j.set=function(re){(0,Na.each)(D,(ge,xe)=>{let Oe=Na.is.fun(re)?re(xe,ge):re;Oe&&ge.set(Oe)})},j.start=function(re){let ge=[];return(0,Na.each)(D,(xe,Oe)=>{if(Na.is.und(re))ge.push(xe.start());else{let Ee=this._getProps(re,xe,Oe);Ee&&ge.push(xe.start(Ee))}}),ge},j.stop=function(){return(0,Na.each)(D,re=>re.stop(...arguments)),this},j.update=function(re){return(0,Na.each)(D,(ge,xe)=>ge.update(this._getProps(re,ge,xe))),this};let J=function(re,ge,xe){return Na.is.fun(re)?re(xe,ge):re};return j._getProps=J,j};function Dp(D,j,J){let re=H.is.fun(j)&&j;re&&!J&&(J=[]);let ge=(0,Q.useMemo)(()=>re||arguments.length==3?Nc():void 0,[]),xe=(0,Q.useRef)(0),Oe=(0,H.useForceUpdate)(),Ee=(0,Q.useMemo)(()=>({ctrls:[],queue:[],flush(Xe,dt){let et=kc(Xe,dt);return xe.current>0&&!Ee.queue.length&&!Object.keys(et).some(ut=>!Xe.springs[ut])?tu(Xe,dt):new Promise(ut=>{Og(Xe,et),Ee.queue.push(()=>{ut(tu(Xe,dt))}),Oe()})}}),[]),Ce=(0,Q.useRef)([...Ee.ctrls]),Le=[],st=(0,H.usePrev)(D)||0;(0,Q.useMemo)(()=>{(0,H.each)(Ce.current.slice(D,st),Xe=>{W(Xe,ge),Xe.stop(!0)}),Ce.current.length=D,Ke(st,D)},[D]),(0,Q.useMemo)(()=>{Ke(0,Math.min(st,D))},J);function Ke(Xe,dt){for(let et=Xe;et<dt;et++){let ut=Ce.current[et]||(Ce.current[et]=new Mp(null,Ee.flush)),Fn=re?re(et,ut):j[et];Fn&&(Le[et]=$p(Fn))}}let bt=Ce.current.map((Xe,dt)=>kc(Xe,Le[dt])),ct=(0,Q.useContext)(Bi),je=(0,H.usePrev)(ct),tt=ct!==je&&M(ct);(0,H.useIsomorphicLayoutEffect)(()=>{xe.current++,Ee.ctrls=Ce.current;let{queue:Xe}=Ee;Xe.length&&(Ee.queue=[],(0,H.each)(Xe,dt=>dt())),(0,H.each)(Ce.current,(dt,et)=>{ge?.add(dt),tt&&dt.start({default:ct});let ut=Le[et];ut&&(B(dt,ut.ref),dt.ref?dt.queue.push(ut):dt.start(ut))})}),(0,H.useOnce)(()=>()=>{(0,H.each)(Ee.ctrls,Xe=>Xe.stop(!0))});let rt=bt.map(Xe=>({...Xe}));return ge?[rt,ge]:rt}function nu(D,j){let J=X.is.fun(D),[[re],ge]=Dp(1,J?D:[D],J?j||[]:j);return J||arguments.length==2?[re,ge]:re}var Y2=P,Q2=()=>Nc(),Z2=()=>(0,Y2.useState)(Q2)[0],Mg=Ft,J2=(D,j)=>{let J=(0,Mg.useConstant)(()=>new rn(D,j));return(0,Mg.useOnce)(()=>()=>{J.stop()}),J},Tc=Ft;function Ag(D,j,J){let re=Tc.is.fun(j)&&j;re&&!J&&(J=[]);let ge=!0,xe,Oe=Dp(D,(Ee,Ce)=>{let Le=re?re(Ee,Ce):j;return xe=Le.ref,ge=ge&&Le.reverse,Le},J||[{}]);if((0,Tc.useIsomorphicLayoutEffect)(()=>{(0,Tc.each)(Oe[1].current,(Ee,Ce)=>{let Le=Oe[1].current[Ce+(ge?1:-1)];if(B(Ee,xe),Ee.ref){Le&&Ee.update({to:Le.springs});return}Le?Ee.start({to:Le.springs}):Ee.start()})},J),re||arguments.length==3){let Ee=xe??Oe[1];return Ee._getProps=(Ce,Le,st)=>{let Ke=Tc.is.fun(Ce)?Ce(st,Le):Ce;if(Ke){let bt=Ee.current[st+(Ke.reverse?1:-1)];return bt&&(Ke.to=bt.springs),Ke}},Oe}return Oe[0]}var Lp=c(P),Uo=P,Mt=Ft;function Ic(D,j,J){let re=Mt.is.fun(j)&&j,{reset:ge,sort:xe,trail:Oe=0,expires:Ee=!0,exitBeforeEnter:Ce=!1,onDestroyed:Le,ref:st,config:Ke}=re?re():j,bt=(0,Uo.useMemo)(()=>re||arguments.length==3?Nc():void 0,[]),ct=(0,Mt.toArray)(D),je=[],tt=(0,Uo.useRef)(null),rt=ge?null:tt.current;(0,Mt.useIsomorphicLayoutEffect)(()=>{tt.current=je}),(0,Mt.useOnce)(()=>((0,Mt.each)(je,at=>{bt?.add(at.ctrl),at.ctrl.ref=bt}),()=>{(0,Mt.each)(tt.current,at=>{at.expired&&clearTimeout(at.expirationId),W(at.ctrl,bt),at.ctrl.stop(!0)})}));let Xe=ew(ct,re?re():j,rt),dt=ge&&tt.current||[];(0,Mt.useIsomorphicLayoutEffect)(()=>(0,Mt.each)(dt,({ctrl:at,item:yt,key:Qn})=>{W(at,bt),y(Le,yt,Qn)}));let et=[];if(rt&&(0,Mt.each)(rt,(at,yt)=>{at.expired?(clearTimeout(at.expirationId),dt.push(at)):(yt=et[yt]=Xe.indexOf(at.key),~yt&&(je[yt]=at))}),(0,Mt.each)(ct,(at,yt)=>{je[yt]||(je[yt]={key:Xe[yt],item:at,phase:"mount",ctrl:new Mp},je[yt].ctrl.item=at)}),et.length){let at=-1,{leave:yt}=re?re():j;(0,Mt.each)(et,(Qn,Zn)=>{let qt=rt[Zn];~Qn?(at=je.indexOf(qt),je[at]={...qt,item:ct[Qn]}):yt&&je.splice(++at,0,qt)})}Mt.is.fun(xe)&&je.sort((at,yt)=>xe(at.item,yt.item));let ut=-Oe,Fn=(0,Mt.useForceUpdate)(),Ta=S(j),It=new Map,Sn=(0,Uo.useRef)(new Map),yn=(0,Uo.useRef)(!1);(0,Mt.each)(je,(at,yt)=>{let Qn=at.key,Zn=at.phase,qt=re?re():j,hn,Or,Vi=y(qt.delay||0,Qn);if(Zn=="mount")hn=qt.enter,Or="enter";else{let ma=Xe.indexOf(Qn)<0;if(Zn!="leave")if(ma)hn=qt.leave,Or="leave";else if(hn=qt.update)Or="update";else return;else if(!ma)hn=qt.enter,Or="enter";else return}if(hn=y(hn,at.item,yt),hn=Mt.is.obj(hn)?E(hn):{to:hn},!hn.config){let ma=Ke||Ta.config;hn.config=y(ma,at.item,yt,Or)}ut+=Oe;let $r={...Ta,delay:Vi+ut,ref:st,immediate:qt.immediate,reset:!1,...hn};if(Or=="enter"&&Mt.is.und($r.from)){let ma=re?re():j,Xo=Mt.is.und(ma.initial)||rt?ma.from:ma.initial;$r.from=y(Xo,at.item,yt)}let{onResolve:Ko}=$r;$r.onResolve=ma=>{y(Ko,ma);let Xo=tt.current,Bn=Xo.find(Rr=>Rr.key===Qn);if(Bn&&!(ma.cancelled&&Bn.phase!="update")&&Bn.ctrl.idle){let Rr=Xo.every(Bt=>Bt.ctrl.idle);if(Bn.phase=="leave"){let Bt=y(Ee,Bn.item);if(Bt!==!1){let Yo=Bt===!0?0:Bt;if(Bn.expired=!0,!Rr&&Yo>0){Yo<=2147483647&&(Bn.expirationId=setTimeout(Fn,Yo));return}}}Rr&&Xo.some(Bt=>Bt.expired)&&(Sn.current.delete(Bn),Ce&&(yn.current=!0),Fn())}};let zp=kc(at.ctrl,$r);Or==="leave"&&Ce?Sn.current.set(at,{phase:Or,springs:zp,payload:$r}):It.set(at,{phase:Or,springs:zp,payload:$r})});let Kr=(0,Uo.useContext)(Bi),fa=(0,Mt.usePrev)(Kr),zi=Kr!==fa&&M(Kr);(0,Mt.useIsomorphicLayoutEffect)(()=>{zi&&(0,Mt.each)(je,at=>{at.ctrl.start({default:Kr})})},[Kr]),(0,Mt.each)(It,(at,yt)=>{if(Sn.current.size){let Qn=je.findIndex(Zn=>Zn.key===yt.key);je.splice(Qn,1)}}),(0,Mt.useIsomorphicLayoutEffect)(()=>{(0,Mt.each)(Sn.current.size?Sn.current:It,({phase:at,payload:yt},Qn)=>{let{ctrl:Zn}=Qn;Qn.phase=at,bt?.add(Zn),zi&&at=="enter"&&Zn.start({default:Kr}),yt&&(B(Zn,yt.ref),(Zn.ref||bt)&&!yn.current?Zn.update(yt):(Zn.start(yt),yn.current&&(yn.current=!1)))})},ge?void 0:J);let Yn=at=>Lp.createElement(Lp.Fragment,null,je.map((yt,Qn)=>{let{springs:Zn}=It.get(yt)||yt.ctrl,qt=at({...Zn},yt.item,yt,Qn);return qt&&qt.type?Lp.createElement(qt.type,{...qt.props,key:Mt.is.str(yt.key)||Mt.is.num(yt.key)?yt.key:yt.ctrl.id,ref:qt.ref}):qt}));return bt?[Yn,bt]:Yn}var Fp=1;function ew(D,{key:j,keys:J=j},re){if(J===null){let ge=new Set;return D.map(xe=>{let Oe=re&&re.find(Ee=>Ee.item===xe&&Ee.phase!=="leave"&&!ge.has(Ee));return Oe?(ge.add(Oe),Oe.key):Fp++})}return Mt.is.und(J)?D:Mt.is.fun(J)?D.map(J):(0,Mt.toArray)(J)}var ru=Ft,Bs=({container:D,...j}={})=>{let[J,re]=nu(()=>({scrollX:0,scrollY:0,scrollXProgress:0,scrollYProgress:0,...j}),[]);return(0,ru.useIsomorphicLayoutEffect)(()=>{let ge=(0,ru.onScroll)(({x:xe,y:Oe})=>{re.start({scrollX:xe.current,scrollXProgress:xe.progress,scrollY:Oe.current,scrollYProgress:Oe.progress})},{container:D?.current||void 0});return()=>{(0,ru.each)(Object.values(J),xe=>xe.stop()),ge()}},[]),J},li=Ft,an=({container:D,...j})=>{let[J,re]=nu(()=>({width:0,height:0,...j}),[]);return(0,li.useIsomorphicLayoutEffect)(()=>{let ge=(0,li.onResize)(({width:xe,height:Oe})=>{re.start({width:xe,height:Oe,immediate:J.width.get()===0||J.height.get()===0})},{container:D?.current||void 0});return()=>{(0,li.each)(Object.values(J),xe=>xe.stop()),ge()}},[]),J},Qt=P,ui=Ft,yr={any:0,all:1};function Hr(D,j){let[J,re]=(0,Qt.useState)(!1),ge=(0,Qt.useRef)(),xe=ui.is.fun(D)&&D,Oe=xe?xe():{},{to:Ee={},from:Ce={},...Le}=Oe,st=xe?j:D,[Ke,bt]=nu(()=>({from:Ce,...Le}),[]);return(0,ui.useIsomorphicLayoutEffect)(()=>{let ct=ge.current,{root:je,once:tt,amount:rt="any",...Xe}=st??{};if(!ct||tt&&J||typeof IntersectionObserver>"u")return;let dt=new WeakMap,et=()=>(Ee&&bt.start(Ee),re(!0),tt?void 0:()=>{Ce&&bt.start(Ce),re(!1)}),ut=Ta=>{Ta.forEach(It=>{let Sn=dt.get(It.target);if(It.isIntersecting!==!!Sn)if(It.isIntersecting){let yn=et();ui.is.fun(yn)?dt.set(It.target,yn):Fn.unobserve(It.target)}else Sn&&(Sn(),dt.delete(It.target))})},Fn=new IntersectionObserver(ut,{root:je&&je.current||void 0,threshold:typeof rt=="number"||Array.isArray(rt)?rt:yr[rt],...Xe});return Fn.observe(ct),()=>Fn.unobserve(ct)},[st]),xe?[ge,Ke]:[ge,J]}function Go({children:D,...j}){return D(nu(j))}var zs=Ft;function qr({items:D,children:j,...J}){let re=Ag(D.length,J);return D.map((ge,xe)=>{let Oe=j(ge,xe);return zs.is.fun(Oe)?Oe(re[xe]):Oe})}function Ec({items:D,children:j,...J}){return Ic(D,J)(j)}var Pg=Ft,kn=Ft,mo=wg,au=class extends Yt{constructor(D,j){super(),this.source=D,this.idle=!0,this._active=new Set,this.calc=(0,kn.createInterpolator)(...j);let J=this._get(),re=(0,mo.getAnimatedType)(J);(0,mo.setAnimated)(this,re.create(J))}advance(D){let j=this._get(),J=this.get();(0,kn.isEqual)(j,J)||((0,mo.getAnimated)(this).setValue(j),this._onChange(j,this.idle)),!this.idle&&Dg(this._active)&&Bp(this)}_get(){let D=kn.is.arr(this.source)?this.source.map(kn.getFluidValue):(0,kn.toArray)((0,kn.getFluidValue)(this.source));return this.calc(...D)}_start(){this.idle&&!Dg(this._active)&&(this.idle=!1,(0,kn.each)((0,mo.getPayload)(this),D=>{D.done=!1}),kn.Globals.skipAnimation?(kn.raf.batchedUpdates(()=>this.advance()),Bp(this)):kn.frameLoop.start(this))}_attach(){let D=1;(0,kn.each)((0,kn.toArray)(this.source),j=>{(0,kn.hasFluidValue)(j)&&(0,kn.addFluidObserver)(j,this),Wt(j)&&(j.idle||this._active.add(j),D=Math.max(D,j.priority+1))}),this.priority=D,this._start()}_detach(){(0,kn.each)((0,kn.toArray)(this.source),D=>{(0,kn.hasFluidValue)(D)&&(0,kn.removeFluidObserver)(D,this)}),this._active.clear(),Bp(this)}eventObserved(D){D.type=="change"?D.idle?this.advance():(this._active.add(D.parent),this._start()):D.type=="idle"?this._active.delete(D.parent):D.type=="priority"&&(this.priority=(0,kn.toArray)(this.source).reduce((j,J)=>Math.max(j,(Wt(J)?J.priority:0)+1),0))}};function Ha(D){return D.idle!==!1}function Dg(D){return!D.size||Array.from(D).every(Ha)}function Bp(D){D.idle||(D.idle=!0,(0,kn.each)((0,mo.getPayload)(D),j=>{j.done=!0}),(0,kn.callFluidObservers)(D,{type:"idle",parent:D}))}var tw=(D,...j)=>new au(D,j),_c=(D,...j)=>((0,Pg.deprecateInterpolate)(),new au(D,j)),Ho=Ft;Ho.Globals.assign({createStringInterpolator:Ho.createStringInterpolator,to:(D,j)=>new au(D,j)});var iu=Ho.frameLoop.advance,qo=Ft;u(p,kEe(),t.exports)})(J7);var SEe=J7.exports;Z7.exports=SEe;var az=Z7.exports;(function(t){var e=Object.defineProperty,n=Object.getOwnPropertyDescriptor,r=Object.getOwnPropertyNames,a=Object.prototype.hasOwnProperty,i=(H,F)=>{for(var Y in F)e(H,Y,{get:F[Y],enumerable:!0})},o=(H,F,Y,Z)=>{if(F&&typeof F=="object"||typeof F=="function")for(let ne of r(F))!a.call(H,ne)&&ne!==Y&&e(H,ne,{get:()=>F[ne],enumerable:!(Z=n(F,ne))||Z.enumerable});return H},s=(H,F,Y)=>(o(H,F,"default"),Y&&o(Y,F,"default")),l=H=>o(e({},"__esModule",{value:!0}),H),u={};i(u,{a:()=>Q,animated:()=>Q}),t.exports=l(u);var c=az,d=H1,p=Ft,f=wg,g=/^--/;function y(H,F){return F==null||typeof F=="boolean"||F===""?"":typeof F=="number"&&F!==0&&!g.test(H)&&!(v.hasOwnProperty(H)&&v[H])?F+"px":(""+F).trim()}var x={};function b(H,F){if(!H.nodeType||!H.setAttribute)return!1;let Y=H.nodeName==="filter"||H.parentNode&&H.parentNode.nodeName==="filter",{style:Z,children:ne,scrollTop:se,scrollLeft:ce,viewBox:le,...ye}=F,we=Object.values(ye),q=Object.keys(ye).map(ie=>Y||H.hasAttribute(ie)?ie:x[ie]||(x[ie]=ie.replace(/([A-Z])/g,de=>"-"+de.toLowerCase())));ne!==void 0&&(H.textContent=ne);for(let ie in Z)if(Z.hasOwnProperty(ie)){let de=y(ie,Z[ie]);g.test(ie)?H.style.setProperty(ie,de):H.style[ie]=de}q.forEach((ie,de)=>{H.setAttribute(ie,we[de])}),se!==void 0&&(H.scrollTop=se),ce!==void 0&&(H.scrollLeft=ce),le!==void 0&&H.setAttribute("viewBox",le)}var v={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},w=(H,F)=>H+F.charAt(0).toUpperCase()+F.substring(1),S=["Webkit","Ms","Moz","O"];v=Object.keys(v).reduce((H,F)=>(S.forEach(Y=>H[w(Y,F)]=H[F]),H),v);var C=wg,I=Ft,_=/^(matrix|translate|scale|rotate|skew)/,E=/^(translate)/,A=/^(rotate|skew)/,M=(H,F)=>I.is.num(H)&&H!==0?H+F:H,L=(H,F)=>I.is.arr(H)?H.every(Y=>L(Y,F)):I.is.num(H)?H===F:parseFloat(H)===F,W=class extends C.AnimatedObject{constructor({x:H,y:F,z:Y,...Z}){let ne=[],se=[];(H||F||Y)&&(ne.push([H||0,F||0,Y||0]),se.push(ce=>[`translate3d(${ce.map(le=>M(le,"px")).join(",")})`,L(ce,0)])),(0,I.eachProp)(Z,(ce,le)=>{if(le==="transform")ne.push([ce||""]),se.push(ye=>[ye,ye===""]);else if(_.test(le)){if(delete Z[le],I.is.und(ce))return;let ye=E.test(le)?"px":A.test(le)?"deg":"";ne.push((0,I.toArray)(ce)),se.push(le==="rotate3d"?([we,q,ie,de])=>[`rotate3d(${we},${q},${ie},${M(de,ye)})`,L(de,0)]:we=>[`${le}(${we.map(q=>M(q,ye)).join(",")})`,L(we,le.startsWith("scale")?1:0)])}}),ne.length&&(Z.transform=new B(ne,se)),super(Z)}},B=class extends I.FluidValue{constructor(H,F){super(),this.inputs=H,this.transforms=F,this._value=null}get(){return this._value||(this._value=this._get())}_get(){let H="",F=!0;return(0,I.each)(this.inputs,(Y,Z)=>{let ne=(0,I.getFluidValue)(Y[0]),[se,ce]=this.transforms[Z](I.is.arr(ne)?ne:Y.map(I.getFluidValue));H+=" "+se,F=F&&ce}),F?"none":H}observerAdded(H){H==1&&(0,I.each)(this.inputs,F=>(0,I.each)(F,Y=>(0,I.hasFluidValue)(Y)&&(0,I.addFluidObserver)(Y,this)))}observerRemoved(H){H==0&&(0,I.each)(this.inputs,F=>(0,I.each)(F,Y=>(0,I.hasFluidValue)(Y)&&(0,I.removeFluidObserver)(Y,this)))}eventObserved(H){H.type=="change"&&(this._value=null),(0,I.callFluidObservers)(this,H)}},K=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"];s(u,az,t.exports),c.Globals.assign({batchedUpdates:d.unstable_batchedUpdates,createStringInterpolator:p.createStringInterpolator,colors:p.colors});var X=(0,f.createHost)(K,{applyAnimatedValues:b,createAnimatedStyle:H=>new W(H),getComponentProps:({scrollTop:H,scrollLeft:F,...Y})=>Y}),Q=X.animated})(Q7);var CEe=Q7.exports;Y7.exports=CEe;var NEe=Y7.exports;const{useState:TEe,useEffect:IEe}=P;function EEe(){const[t,e]=TEe({width:void 0,height:void 0});return IEe(()=>{function n(){e({width:window.innerWidth,height:window.innerHeight})}return window.addEventListener("resize",n),n(),()=>window.removeEventListener("resize",n)},[]),t}var _Ee=EEe;const Ip=P,{useSpring:OEe,animated:$Ee}=NEe,REe=_Ee,Yl={maxTilt:25,rotationPower:50,swipeThreshold:.5},xE={touchResponsive:{friction:50,tension:2e3},animateOut:{friction:30,tension:400},animateBack:{friction:10,tension:200}},iz=(t,e)=>Math.sqrt(Math.pow(t,2)+Math.pow(e,2)),MEe=t=>{const e=Math.sqrt(Math.pow(t.x,2)+Math.pow(t.y,2));return{x:t.x/e,y:t.y/e}},kg=async(t,e,n,r)=>{const a=iz(n,r),i=iz(t.x,t.y),o=a*t.x,s=a*t.y,l=t.x*45,u=a/i;return e.start({xyrot:[o,s,l],config:{duration:u}}),await new Promise(c=>setTimeout(()=>{c()},u))},oz=t=>new Promise(e=>{t.start({xyrot:[0,0,0],config:xE.animateBack,onRest:e})}),sz=t=>{if(Math.abs(t.x)>Math.abs(t.y)){if(t.x>Yl.swipeThreshold)return"right";if(t.x<-Yl.swipeThreshold)return"left"}else{if(t.y>Yl.swipeThreshold)return"down";if(t.y<-Yl.swipeThreshold)return"up"}return"none"},AEe=$Ee.div,PEe=Ip.forwardRef(({flickOnSwipe:t=!0,children:e,onSwipe:n,onCardLeftScreen:r,className:a,preventSwipe:i=[],swipeRequirementType:o="velocity",swipeThreshold:s=Yl.swipeThreshold,onSwipeRequirementFulfilled:l,onSwipeRequirementUnfulfilled:u},c)=>{const{width:d,height:p}=REe(),[{xyrot:f},g]=OEe(()=>({xyrot:[0,0,0],config:xE.touchResponsive}));Yl.swipeThreshold=s,Ip.useImperativeHandle(c,()=>({async swipe(w="right"){n&&n(w);const S=1.3,C=(Math.random()-.5)/2;w==="right"?await kg({x:S,y:C},g,d,p):w==="left"?await kg({x:-S,y:C},g,d,p):w==="up"?await kg({x:C,y:-S},g,d,p):w==="down"&&await kg({x:C,y:S},g,d,p),r&&r(w)},async restoreCard(){await oz(g)}}));const y=Ip.useCallback(async(w,S)=>{const C=sz({x:o==="velocity"?S.vx:S.dx,y:o==="velocity"?S.vy:S.dy});if(C!=="none"&&t&&!i.includes(C)){n&&n(C),await kg(o==="velocity"?{x:S.vx,y:S.vy}:MEe({x:S.dx,y:S.dy}),w,d,p),r&&r(C);return}oz(w)},[o,t,i,n,r,d,p]);let x="none";const b=(w,S,C,I)=>{let _=I?w.touches[0].clientX-S.x:w.clientX-S.x,E=I?w.touches[0].clientY-S.y:w.clientY-S.y;S.x===0&&S.y===0&&(_=0,E=0);const A=-(_-C.dx)/(C.timeStamp-Date.now()),M=-(E-C.dy)/(C.timeStamp-Date.now());return{dx:_,dy:E,vx:A,vy:M,timeStamp:Date.now()}};Ip.useLayoutEffect(()=>{let w={x:0,y:0},S={dx:0,dy:0,vx:0,vy:0,timeStamp:Date.now()},C=!1;const I=B=>{!B.srcElement.className.includes("pressable")&&B.cancelable&&B.preventDefault(),S=b(B,w,S,!0),w={x:B.touches[0].clientX,y:B.touches[0].clientY}};v.current.addEventListener("touchstart",I);const _=B=>{C=!0,S=b(B,w,S,!1),w={x:B.clientX,y:B.clientY}};v.current.addEventListener("mousedown",_);const E=B=>{if(l||u){const X=sz({x:o==="velocity"?B.vx:B.dx,y:o==="velocity"?B.vy:B.dy});X!==x&&(x=X,x==="none"?u&&u():l&&l(X))}let K=B.vx*15;isNaN(K)&&(K=0),K=Math.max(Math.min(K,Yl.maxTilt),-Yl.maxTilt),g.start({xyrot:[B.dx,B.dy,K],config:xE.touchResponsive})},A=B=>{if(!C)return;const K=b(B,w,S,!1);S=K,E(K)};window.addEventListener("mousemove",A);const M=B=>{C&&(C=!1,y(g,S),w={x:0,y:0},S={dx:0,dy:0,vx:0,vy:0,timeStamp:Date.now()})};window.addEventListener("mouseup",M);const L=B=>{const K=b(B,w,S,!0);S=K,E(K)};v.current.addEventListener("touchmove",L);const W=B=>{y(g,S),w={x:0,y:0},S={dx:0,dy:0,vx:0,vy:0,timeStamp:Date.now()}};return v.current.addEventListener("touchend",W),()=>{v.current.removeEventListener("touchstart",I),v.current.removeEventListener("touchmove",L),v.current.removeEventListener("touchend",W),window.removeEventListener("mousemove",A),window.removeEventListener("mouseup",M),v.current.removeEventListener("mousedown",_)}},[y,g,l,u]);const v=Ip.useRef();return Ip.createElement(AEe,{ref:v,className:a,style:{transform:f.to((w,S,C)=>`translate3d(${w}px, ${S}px, 0px) rotate(${C}deg)`)},children:e})});var DEe=PEe;const LEe=Hi(DEe);function si(t){return e=>typeof e=="string"&&new RegExp(t.source,t.flags).test(e)}const FEe=si(/^[1-9][0-9]*$/),wE=si(/^((Q|P|L|M)[1-9][0-9]*|L[1-9][0-9]*-(F|S)[1-9][0-9]*)$/),BEe=si(/^E[1-9][0-9]*$/),D2=si(/^Q[1-9][0-9]*$/),L2=si(/^P[1-9][0-9]*$/),lz=si(/^L[1-9][0-9]*$/),uz=si(/^L[1-9][0-9]*-F[1-9][0-9]*$/),cz=si(/^L[1-9][0-9]*-S[1-9][0-9]*$/),zEe=si(/^M[1-9][0-9]*$/),VEe=si(/^((Q|P|L|M)[1-9][0-9]*|L[1-9][0-9]*-(F|S)[1-9][0-9]*)\$[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i),WEe=si(/^[0-9a-f]{40}$/),dz=si(/^\d+$/),pz=si(/^(Q|P|L|M)[1-9][0-9]*$/);function jEe(t){if(typeof t!="string")return!1;const[e,n]=t.split("#");return wE(e)&&L2(n)}function hz(t){return typeof t!="string"?!1:t.startsWith("Item:")?D2(t.substring(5)):t.startsWith("Lexeme:")?lz(t.substring(7)):t.startsWith("Property:")?L2(t.substring(9)):D2(t)}function UEe(t){if(!pz(t))throw new Error(`invalid entity id: ${t}`);return t.replace(/^(Q|P|L|M)/,"")}function GEe(t,e){let n=`https://commons.wikimedia.org/wiki/Special:FilePath/${t}`;return typeof e=="number"&&(n+=`?width=${e}`),n}function HEe(t){const e=t.split(/[$-]/);if(e.length===6)return e[0].toUpperCase();if(e.length===7)return e.slice(0,2).join("-").toUpperCase();throw new Error(`invalid guid: ${t}`)}const qEe=Object.freeze(Object.defineProperty({__proto__:null,getEntityIdFromGuid:HEe,getImageUrl:GEe,getNumericId:UEe,isEntityId:wE,isEntityPageTitle:hz,isEntitySchemaId:BEe,isFormId:uz,isGuid:VEe,isHash:WEe,isItemId:D2,isLexemeId:lz,isMediaInfoId:zEe,isNonNestedEntityId:pz,isNumericId:FEe,isPropertyClaimsId:jEe,isPropertyId:L2,isRevisionId:dz,isSenseId:cz},Symbol.toStringTag,{value:"Module"}));function Wo(t){return typeof t=="string"?[t]:Array.isArray(t)?[...t]:[]}function fz(t){return!!t&&typeof t=="object"&&!Array.isArray(t)}const mz=t=>encodeURIComponent(t).replace(/[!'()*]/g,YEe),KEe=t=>t.replace(/\s/g,"_");function XEe(t){return Array.from(new Set(t))}const YEe=t=>"%"+t.charCodeAt(0).toString(16);function Ql(t){if(t.length!==1||!fz(t[0]))throw new Error(`Since wikibase-sdk v9.0.0, this function expects arguments to be passed in an object
    See https://github.com/maxlath/wikibase-sdk/blob/main/CHANGELOG.md`)}function Sg(t,e){return typeof e=="string"&&t.includes(e)}function kE(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function SE(t){return Object.entries(t)}function CE(t){typeof t=="object"&&(t=t.time);const e=t[0];let[n,r]=t.slice(1).split("T");n=n.replace(/-00/g,"-01");const a=`${n}T${r}`;return QEe(e,a)}const QEe=(t,e)=>{const n=e.split("-")[0];return t==="-"||n.length>4?ZEe(t,e,n):new Date(e)},ZEe=(t,e,n)=>{let r;return n.length===4?r=`${t}00${e}`:n.length===5?r=`${t}0${e}`:r=t+e,new Date(r)};function NE(t){return e=>{try{return t(e)}catch{e=typeof e=="string"?e:e.time;const n=e[0];let[r,a]=e.slice(1).split("T");if(!n||!r||!a)throw new Error("TimeInput is invalid: "+JSON.stringify(e));return r=r.replace(/-00/g,"-01"),`${n}${r}T${a}`}}}const JEe=t=>CE(t).getTime(),e_e=t=>CE(t).toISOString(),t_e=t=>{if(typeof t=="object"){const{time:e,precision:n}=t;n===9?t=e.replace("-01-01T","-00-00T"):n===10?t=e.replace("-01T","-00T"):t=e}return t.split("T")[0].replace(/^\+/,"").replace(/^(-?)0+/,"$1").replace(/-00$/,"").replace(/-00$/,"")},gz=NE(JEe),yz=NE(e_e),bz=NE(t_e),n_e=Object.freeze(Object.defineProperty({__proto__:null,wikibaseTimeToDateObject:CE,wikibaseTimeToEpochTime:gz,wikibaseTimeToISOString:yz,wikibaseTimeToSimpleDay:bz},Symbol.toStringTag,{value:"Module"})),Zl=t=>t.value,r_e=(t,e)=>e.keepRichValues?t.value:t.value.text,Ep=(t,e)=>i_e(t,e.entityPrefix),a_e={item:"Q",lexeme:"L",property:"P"},i_e=(t,e)=>{const{value:n}=t,r=n.id||a_e[n["entity-type"]]+n["numeric-id"];return typeof e=="string"?`${e}:${r}`:r},o_e=(t,e)=>{const{value:n}=t,r=parseFloat(n.amount);if(e.keepRichValues){const a={amount:parseFloat(n.amount),unit:n.unit.replace(/^https?:\/\/.*\/entity\//,"")};return n.upperBound!=null&&(a.upperBound=parseFloat(n.upperBound)),n.lowerBound!=null&&(a.lowerBound=parseFloat(n.lowerBound)),a}else return r},s_e=(t,e)=>e.keepRichValues?t.value:[t.value.latitude,t.value.longitude],l_e=(t,e)=>{let n;if(typeof e.timeConverter=="function"?n=e.timeConverter(t.value):n=u_e(e.timeConverter)(t.value),e.keepRichValues){const{timezone:r,before:a,after:i,precision:o,calendarmodel:s}=t.value;return{time:n,timezone:r,before:a,after:i,precision:o,calendarmodel:s}}else return n},u_e=(t="iso")=>{const e=c_e[t];if(!e)throw new Error(`invalid converter key: ${JSON.stringify(t).substring(0,100)}`);return e},c_e={iso:yz,epoch:gz,"simple-day":bz,none:t=>typeof t=="string"?t:t.time},d_e={commonsMedia:Zl,"external-id":Zl,"geo-shape":Zl,"globe-coordinate":s_e,math:Zl,monolingualtext:r_e,"musical-notation":Zl,quantity:o_e,string:Zl,"tabular-data":Zl,time:l_e,url:Zl,"wikibase-entityid":Ep,"wikibase-form":Ep,"wikibase-item":Ep,"wikibase-lexeme":Ep,"wikibase-property":Ep,"wikibase-sense":Ep},vz=t=>t.toLowerCase().replace(/[\s-]/g,""),xz={};for(const[t,e]of Object.entries(d_e))xz[vz(t)]=e;function p_e(t,e,n,r){t=t||e.type;try{const a=xz[vz(t)];return a(e,n)}catch(a){throw a.message==="parsers[datatype] is not a function"&&(a.message=`${t} claim parser isn't implemented
      Claim id: ${r}
      Please report to https://github.com/maxlath/wikibase-sdk/issues`),a}}function TE(t){const e={};for(const n of t){const{rank:r}=n;e[r]=e[r]||[],e[r].push(n)}return e.preferred||e.normal||[]}function wz(t){return t.filter(e=>e.rank!=="deprecated")}function h_e(t){const e={};for(const[n,r]of SE(t))e[n]=TE(r);return e}const f_e=Object.freeze(Object.defineProperty({__proto__:null,nonDeprecatedPropertyClaims:wz,truthyClaims:h_e,truthyPropertyClaims:TE},Symbol.toStringTag,{value:"Module"}));function IE(t,e){const{propertyPrefix:n}=e,r={};for(let a in t){const i=t[a];n&&(a=n+":"+a),r[a]=EE(i,e)}return r}function EE(t,e){if(t==null||t.length===0)return[];const{keepNonTruthy:n,keepNonDeprecated:r,areSubSnaks:a}=Tz(e);return r?t=wz(t):n||a||(t=TE(t)),t=t.map(i=>_E(i,e)).filter(i=>i!==void 0),t[0]&&typeof t[0]!="object"?XEe(t):t}function kz(t,e){const{keepQualifiers:n,keepReferences:r,keepIds:a,keepHashes:i,keepTypes:o,keepSnaktypes:s,keepRanks:l}=Tz(e),{mainsnak:u,rank:c}=t;let d,p,f,g,y,x;if(u?(p=u.datatype,f=u.datavalue,g=u.snaktype):(f=t.datavalue,p=t.datatype,g=t.snaktype,t.hash?y=!0:x=!0),f)d=p_e(p,f,e,t.id);else if(g==="somevalue")d=e.somevalueValue;else if(g==="novalue")d=e.novalueValue;else throw new Error("no datavalue or special snaktype found");if(y){if(!(i||o||s))return d;const w={value:d};return i&&(w.hash=t.hash),o&&(w.type=p),s&&(w.snaktype=g),w}if(x)return o?{type:p,value:d}:d;if(!(n||r||a||o||s||l))return d;const b={value:d};o&&(b.type=p),s&&(b.snaktype=g),l&&(b.rank=c);const v=F2(e);return v.keepHashes=i,n&&(b.qualifiers=Cz(t.qualifiers,v)),r&&(t.references=t.references||[],b.references=Nz(t.references,v)),a&&(b.id=t.id),b}function _p(t,e={}){return IE(t,e)}function Sz(t,e={}){return EE(t,e)}function _E(t,e={}){return kz(t,e)}function Cz(t,e={}){return IE(t,F2(e))}function m_e(t,e={}){return EE(t,F2(e))}function g_e(t,e={}){return kz(t,e)}function Nz(t,e={}){return t.map(n=>y_e(n,e))}function y_e(t,e={}){const n=F2(e),r=IE(t.snaks,n);return n.keepHashes?{snaks:r,hash:t.hash}:r}const F2=(t={})=>t.areSubSnaks?t:Object.assign({},t,{areSubSnaks:!0}),b_e=["keepQualifiers","keepReferences","keepIds","keepHashes","keepTypes","keepSnaktypes","keepRanks","keepRichValues"],Tz=(t={})=>(t.keepAll&&b_e.forEach(e=>{t[e]==null&&(t[e]=!0)}),t);function Cg(t){const e={};for(const[n,r]of SE(t))e[n]=r!=null?r.value:null;return e}function v_e(t){const e={};for(const[n,r]of SE(t))e[n]=r!=null?r.map(a=>a.value):[];return e}function Iz(t){return Cg(t)}function Ez(t){return Cg(t)}function _z(t){return v_e(t)}function Oz(t){return Cg(t)}function $z(t){return Cg(t)}function Rz(t){return Cg(t)}const Mz=(t,e={})=>{const{id:n,representations:r,grammaticalFeatures:a,claims:i}=t;if(!uz(n))throw new Error("invalid form object");return{id:n,representations:$z(r),grammaticalFeatures:a,claims:_p(i,e)}},Az=(t,e={})=>t.map(n=>Mz(n,e)),Pz=(t,e={})=>{const{id:n,glosses:r,claims:a}=t;if(!cz(n))throw new Error("invalid sense object");return{id:n,glosses:Rz(r),claims:_p(a,e)}};function Dz(t,e={}){return t.map(n=>Pz(n,e))}const OE={commonswiki:"commons",foundationwiki:"foundation",mediawikiwiki:"mediawiki",metawiki:"meta",outreachwiki:"outreach",sourceswiki:"sources",specieswiki:"species",wikidatawiki:"wikidata",wikifunctionswiki:"wikifunctions",wikimaniawiki:"wikimania"},$E=["aawiki","aawikibooks","aawiktionary","abwiki","abwiktionary","acewiki","adywiki","afwiki","afwikibooks","afwikiquote","afwiktionary","akwiki","akwikibooks","akwiktionary","alswiki","alswikibooks","alswikiquote","alswiktionary","altwiki","amiwiki","amwiki","amwikiquote","amwiktionary","angwiki","angwikibooks","angwikiquote","angwikisource","angwiktionary","anpwiki","anwiki","anwiktionary","arcwiki","arwiki","arwikibooks","arwikinews","arwikiquote","arwikisource","arwikiversity","arwiktionary","arywiki","arzwiki","astwiki","astwikibooks","astwikiquote","astwiktionary","aswiki","aswikibooks","aswikiquote","aswikisource","aswiktionary","atjwiki","avkwiki","avwiki","avwiktionary","awawiki","aywiki","aywikibooks","aywiktionary","azbwiki","azwiki","azwikibooks","azwikiquote","azwikisource","azwiktionary","banwiki","banwikisource","barwiki","bat_smgwiki","bawiki","bawikibooks","bbcwiki","bclwiki","bclwikiquote","bclwiktionary","be_x_oldwiki","bewiki","bewikibooks","bewikiquote","bewikisource","bewiktionary","bgwiki","bgwikibooks","bgwikinews","bgwikiquote","bgwikisource","bgwiktionary","bhwiki","bhwiktionary","biwiki","biwikibooks","biwiktionary","bjnwiki","bjnwikiquote","bjnwiktionary","blkwiki","blkwiktionary","bmwiki","bmwikibooks","bmwikiquote","bmwiktionary","bnwiki","bnwikibooks","bnwikiquote","bnwikisource","bnwikivoyage","bnwiktionary","bowiki","bowikibooks","bowiktionary","bpywiki","brwiki","brwikiquote","brwikisource","brwiktionary","bswiki","bswikibooks","bswikinews","bswikiquote","bswikisource","bswiktionary","btmwiktionary","bugwiki","bxrwiki","cawiki","cawikibooks","cawikinews","cawikiquote","cawikisource","cawiktionary","cbk_zamwiki","cdowiki","cebwiki","cewiki","chowiki","chrwiki","chrwiktionary","chwiki","chwikibooks","chwiktionary","chywiki","ckbwiki","ckbwiktionary","commonswiki","cowiki","cowikibooks","cowikiquote","cowiktionary","crhwiki","crwiki","crwikiquote","crwiktionary","csbwiki","csbwiktionary","cswiki","cswikibooks","cswikinews","cswikiquote","cswikisource","cswikiversity","cswiktionary","cuwiki","cvwiki","cvwikibooks","cywiki","cywikibooks","cywikiquote","cywikisource","cywiktionary","dagwiki","dawiki","dawikibooks","dawikiquote","dawikisource","dawiktionary","dewiki","dewikibooks","dewikinews","dewikiquote","dewikisource","dewikiversity","dewikivoyage","dewiktionary","dgawiki","dinwiki","diqwiki","diqwiktionary","dsbwiki","dtywiki","dvwiki","dvwiktionary","dzwiki","dzwiktionary","eewiki","elwiki","elwikibooks","elwikinews","elwikiquote","elwikisource","elwikiversity","elwikivoyage","elwiktionary","emlwiki","enwiki","enwikibooks","enwikinews","enwikiquote","enwikisource","enwikiversity","enwikivoyage","enwiktionary","eowiki","eowikibooks","eowikinews","eowikiquote","eowikisource","eowikivoyage","eowiktionary","eswiki","eswikibooks","eswikinews","eswikiquote","eswikisource","eswikiversity","eswikivoyage","eswiktionary","etwiki","etwikibooks","etwikiquote","etwikisource","etwiktionary","euwiki","euwikibooks","euwikiquote","euwikisource","euwiktionary","extwiki","fatwiki","fawiki","fawikibooks","fawikinews","fawikiquote","fawikisource","fawikivoyage","fawiktionary","ffwiki","fiu_vrowiki","fiwiki","fiwikibooks","fiwikinews","fiwikiquote","fiwikisource","fiwikiversity","fiwikivoyage","fiwiktionary","fjwiki","fjwiktionary","fonwiki","foundationwiki","fowiki","fowikisource","fowiktionary","frpwiki","frrwiki","frwiki","frwikibooks","frwikinews","frwikiquote","frwikisource","frwikiversity","frwikivoyage","frwiktionary","furwiki","fywiki","fywikibooks","fywiktionary","gagwiki","ganwiki","gawiki","gawikibooks","gawikiquote","gawiktionary","gcrwiki","gdwiki","gdwiktionary","glkwiki","glwiki","glwikibooks","glwikiquote","glwikisource","glwiktionary","gnwiki","gnwikibooks","gnwiktionary","gomwiki","gomwiktionary","gorwiki","gorwiktionary","gotwiki","gotwikibooks","gpewiki","gucwiki","gurwiki","guwiki","guwikibooks","guwikiquote","guwikisource","guwiktionary","guwwiki","guwwikinews","guwwikiquote","guwwiktionary","gvwiki","gvwiktionary","hakwiki","hawiki","hawiktionary","hawwiki","hewiki","hewikibooks","hewikinews","hewikiquote","hewikisource","hewikivoyage","hewiktionary","hifwiki","hifwiktionary","hiwiki","hiwikibooks","hiwikiquote","hiwikisource","hiwikiversity","hiwikivoyage","hiwiktionary","howiki","hrwiki","hrwikibooks","hrwikiquote","hrwikisource","hrwiktionary","hsbwiki","hsbwiktionary","htwiki","htwikisource","huwiki","huwikibooks","huwikinews","huwikiquote","huwikisource","huwiktionary","hywiki","hywikibooks","hywikiquote","hywikisource","hywiktionary","hywwiki","hzwiki","iawiki","iawikibooks","iawiktionary","idwiki","idwikibooks","idwikiquote","idwikisource","idwiktionary","iewiki","iewikibooks","iewiktionary","igwiki","igwikiquote","igwiktionary","iiwiki","ikwiki","ikwiktionary","ilowiki","inhwiki","iowiki","iowiktionary","iswiki","iswikibooks","iswikiquote","iswikisource","iswiktionary","itwiki","itwikibooks","itwikinews","itwikiquote","itwikisource","itwikiversity","itwikivoyage","itwiktionary","iuwiki","iuwiktionary","jamwiki","jawiki","jawikibooks","jawikinews","jawikiquote","jawikisource","jawikiversity","jawikivoyage","jawiktionary","jbowiki","jbowiktionary","jvwiki","jvwikisource","jvwiktionary","kaawiki","kabwiki","kawiki","kawikibooks","kawikiquote","kawiktionary","kbdwiki","kbdwiktionary","kbpwiki","kcgwiki","kcgwiktionary","kgwiki","kiwiki","kjwiki","kkwiki","kkwikibooks","kkwikiquote","kkwiktionary","klwiki","klwiktionary","kmwiki","kmwikibooks","kmwiktionary","knwiki","knwikibooks","knwikiquote","knwikisource","knwiktionary","koiwiki","kowiki","kowikibooks","kowikinews","kowikiquote","kowikisource","kowikiversity","kowiktionary","krcwiki","krwiki","krwikiquote","kshwiki","kswiki","kswikibooks","kswikiquote","kswiktionary","kuwiki","kuwikibooks","kuwikiquote","kuwiktionary","kvwiki","kwwiki","kwwikiquote","kwwiktionary","kywiki","kywikibooks","kywikiquote","kywiktionary","ladwiki","lawiki","lawikibooks","lawikiquote","lawikisource","lawiktionary","lbewiki","lbwiki","lbwikibooks","lbwikiquote","lbwiktionary","lezwiki","lfnwiki","lgwiki","lijwiki","lijwikisource","liwiki","liwikibooks","liwikinews","liwikiquote","liwikisource","liwiktionary","lldwiki","lmowiki","lmowiktionary","lnwiki","lnwikibooks","lnwiktionary","lowiki","lowiktionary","lrcwiki","ltgwiki","ltwiki","ltwikibooks","ltwikiquote","ltwikisource","ltwiktionary","lvwiki","lvwikibooks","lvwiktionary","madwiki","maiwiki","map_bmswiki","mdfwiki","mediawikiwiki","metawiki","mgwiki","mgwikibooks","mgwiktionary","mhrwiki","mhwiki","mhwiktionary","minwiki","minwiktionary","miwiki","miwikibooks","miwiktionary","mkwiki","mkwikibooks","mkwikisource","mkwiktionary","mlwiki","mlwikibooks","mlwikiquote","mlwikisource","mlwiktionary","mniwiki","mniwiktionary","mnwiki","mnwikibooks","mnwiktionary","mnwwiki","mnwwiktionary","mowiki","mowiktionary","mrjwiki","mrwiki","mrwikibooks","mrwikiquote","mrwikisource","mrwiktionary","mswiki","mswikibooks","mswiktionary","mtwiki","mtwiktionary","muswiki","mwlwiki","myvwiki","mywiki","mywikibooks","mywiktionary","mznwiki","nahwiki","nahwikibooks","nahwiktionary","napwiki","napwikisource","nawiki","nawikibooks","nawikiquote","nawiktionary","nds_nlwiki","ndswiki","ndswikibooks","ndswikiquote","ndswiktionary","newiki","newikibooks","newiktionary","newwiki","ngwiki","niawiki","niawiktionary","nlwiki","nlwikibooks","nlwikinews","nlwikiquote","nlwikisource","nlwikivoyage","nlwiktionary","nnwiki","nnwikiquote","nnwiktionary","novwiki","nowiki","nowikibooks","nowikinews","nowikiquote","nowikisource","nowiktionary","nqowiki","nrmwiki","nsowiki","nvwiki","nywiki","ocwiki","ocwikibooks","ocwiktionary","olowiki","omwiki","omwiktionary","orwiki","orwikisource","orwiktionary","oswiki","outreachwiki","pagwiki","pamwiki","papwiki","pawiki","pawikibooks","pawikisource","pawiktionary","pcdwiki","pcmwiki","pdcwiki","pflwiki","pihwiki","piwiki","piwiktionary","plwiki","plwikibooks","plwikinews","plwikiquote","plwikisource","plwikivoyage","plwiktionary","pmswiki","pmswikisource","pnbwiki","pnbwiktionary","pntwiki","pswiki","pswikibooks","pswikivoyage","pswiktionary","ptwiki","ptwikibooks","ptwikinews","ptwikiquote","ptwikisource","ptwikiversity","ptwikivoyage","ptwiktionary","pwnwiki","quwiki","quwikibooks","quwikiquote","quwiktionary","rmwiki","rmwikibooks","rmwiktionary","rmywiki","rnwiki","rnwiktionary","roa_rupwiki","roa_rupwiktionary","roa_tarawiki","rowiki","rowikibooks","rowikinews","rowikiquote","rowikisource","rowikivoyage","rowiktionary","ruewiki","ruwiki","ruwikibooks","ruwikinews","ruwikiquote","ruwikisource","ruwikiversity","ruwikivoyage","ruwiktionary","rwwiki","rwwiktionary","sahwiki","sahwikiquote","sahwikisource","satwiki","sawiki","sawikibooks","sawikiquote","sawikisource","sawiktionary","scnwiki","scnwiktionary","scowiki","scwiki","scwiktionary","sdwiki","sdwikinews","sdwiktionary","sewiki","sewikibooks","sgwiki","sgwiktionary","shiwiki","shnwiki","shnwikibooks","shnwikivoyage","shnwiktionary","shwiki","shwiktionary","shywiktionary","simplewiki","simplewikibooks","simplewikiquote","simplewiktionary","siwiki","siwikibooks","siwiktionary","skrwiki","skrwiktionary","skwiki","skwikibooks","skwikiquote","skwikisource","skwiktionary","slwiki","slwikibooks","slwikiquote","slwikisource","slwikiversity","slwiktionary","smnwiki","smwiki","smwiktionary","snwiki","snwiktionary","sourceswiki","sowiki","sowiktionary","specieswiki","sqwiki","sqwikibooks","sqwikinews","sqwikiquote","sqwiktionary","srnwiki","srwiki","srwikibooks","srwikinews","srwikiquote","srwikisource","srwiktionary","sswiki","sswiktionary","stqwiki","stwiki","stwiktionary","suwiki","suwikibooks","suwikiquote","suwikisource","suwiktionary","svwiki","svwikibooks","svwikinews","svwikiquote","svwikisource","svwikiversity","svwikivoyage","svwiktionary","swwiki","swwikibooks","swwiktionary","szlwiki","szywiki","tawiki","tawikibooks","tawikinews","tawikiquote","tawikisource","tawiktionary","taywiki","tcywiki","tetwiki","tewiki","tewikibooks","tewikiquote","tewikisource","tewiktionary","tgwiki","tgwikibooks","tgwiktionary","thwiki","thwikibooks","thwikinews","thwikiquote","thwikisource","thwiktionary","tiwiki","tiwiktionary","tkwiki","tkwikibooks","tkwikiquote","tkwiktionary","tlwiki","tlwikibooks","tlwikiquote","tlwiktionary","tlywiki","tnwiki","tnwiktionary","towiki","towiktionary","tpiwiki","tpiwiktionary","trvwiki","trwiki","trwikibooks","trwikinews","trwikiquote","trwikisource","trwikivoyage","trwiktionary","tswiki","tswiktionary","ttwiki","ttwikibooks","ttwikiquote","ttwiktionary","tumwiki","twwiki","twwiktionary","tyvwiki","tywiki","udmwiki","ugwiki","ugwikibooks","ugwikiquote","ugwiktionary","ukwiki","ukwikibooks","ukwikinews","ukwikiquote","ukwikisource","ukwikivoyage","ukwiktionary","urwiki","urwikibooks","urwikiquote","urwiktionary","uzwiki","uzwikibooks","uzwikiquote","uzwiktionary","vecwiki","vecwikisource","vecwiktionary","vepwiki","vewiki","viwiki","viwikibooks","viwikiquote","viwikisource","viwikivoyage","viwiktionary","vlswiki","vowiki","vowikibooks","vowikiquote","vowiktionary","warwiki","wawiki","wawikibooks","wawikisource","wawiktionary","wikidatawiki","wikifunctionswiki","wikimaniawiki","wowiki","wowikiquote","wowiktionary","wuuwiki","xalwiki","xhwiki","xhwikibooks","xhwiktionary","xmfwiki","yiwiki","yiwikisource","yiwiktionary","yowiki","yowikibooks","yowiktionary","yuewiktionary","zawiki","zawikibooks","zawikiquote","zawiktionary","zeawiki","zghwiki","zh_classicalwiki","zh_min_nanwiki","zh_min_nanwikibooks","zh_min_nanwikiquote","zh_min_nanwikisource","zh_min_nanwiktionary","zh_yuewiki","zhwiki","zhwikibooks","zhwikinews","zhwikiquote","zhwikisource","zhwikiversity","zhwikivoyage","zhwiktionary","zuwiki","zuwikibooks","zuwiktionary"],x_e="https://www.wikidata.org/wiki/";function Lz({site:t,title:e}){if(Ql(arguments),!t)throw new Error("missing a site");if(!e)throw new Error("missing a title");if(kE(B2,t))return B2[t](e);const n=t.replace(/wiki$/,"");if(kE(B2,n))return B2[n](e);const{lang:r,project:a}=Fz(t);return e=mz(KEe(e)),`https://${r}.${a}.org/wiki/${e}`}const bc=t=>e=>`https://${t}.wikimedia.org/wiki/${e}`,B2={commons:bc("commons"),foundation:bc("foundation"),mediawiki:t=>`https://www.mediawiki.org/wiki/${t}`,meta:bc("meta"),outreach:bc("outreach"),sources:t=>`https://wikisource.org/wiki/${t}`,species:bc("species"),wikidata:t=>{const e=w_e[t[0]];let n=e?`${e}:${t}`:t;return n=n.replace("-","#"),`${x_e}${n}`},wikifunctions:bc("wikifunctions"),wikimania:bc("wikimania")},w_e={E:"EntitySchema",L:"Lexeme",P:"Property"},k_e=/^https?:\/\/([\w-]{2,10})\.(\w+)\.org\/\w+\/(.*)/;function Fz(t){if(t.startsWith("http")){const e=t,n=e.match(k_e);if(!n)throw new Error(`invalid sitelink url: ${e}`);let[r,a,i]=n.slice(1);if(i=decodeURIComponent(i),r==="commons")return{lang:"en",project:"commons",key:"commons",title:i,url:e};if(!Sg(C_e,a))throw new Error(`project is unknown: ${a}`);if(r==="www")return{lang:"en",project:a,key:a,title:i,url:e};const o=`${r.replace(/-/g,"_")}${a}`.replace("wikipedia","wiki");return{lang:r,project:a,key:o,title:i,url:e}}else{if(kE(OE,t))return{lang:"en",project:OE[t],key:t};if(!Sg($E,t))throw new Error(`site not found: ${t}. Updating wikibase-sdk to a more recent version might fix the issue.`);let[e,n,r]=t.split("wik");if(r!=null)throw new Error(`invalid sitelink key: ${t}`);e=e.replace(/_/g,"-");const a=zz[n];if(!a)throw new Error(`sitelink project not found: ${a}`);return{lang:e,project:a,key:t}}}const Bz=t=>Sg($E,t),S_e=Bz,zz={i:"wikipedia",isource:"wikisource",iquote:"wikiquote",tionary:"wiktionary",ibooks:"wikibooks",iversity:"wikiversity",ivoyage:"wikivoyage",inews:"wikinews"},C_e=[...Object.values(zz),...Object.values(OE)],N_e=Object.freeze(Object.defineProperty({__proto__:null,getSitelinkData:Fz,getSitelinkUrl:Lz,isSite:Bz,isSitelinkKey:S_e},Symbol.toStringTag,{value:"Module"}));function Vz(t,e={}){let{addUrl:n,keepBadges:r,keepAll:a}=e;return r=r||a,Object.keys(t).reduce(T_e({sitelinks:t,addUrl:n,keepBadges:r}),{})}const T_e=({sitelinks:t,addUrl:e,keepBadges:n})=>(r,a)=>{if(t[a]==null)return r[a]=t[a],r;const{title:i,badges:o}=t[a];return e||n?(r[a]={title:i},e&&(r[a].url=Lz({site:a,title:i})),n&&(r[a].badges=o)):r[a]=i,r},I_e={labels:Iz,descriptions:Ez,aliases:_z,claims:_p,statements:_p,sitelinks:Vz,lemmas:Oz,forms:Az,senses:Dz},Wz=(t,e={})=>{const{type:n}=t,r={id:t.id,type:n,modified:t.modified};return n==="item"?(pa(t,r,"labels"),pa(t,r,"descriptions"),pa(t,r,"aliases"),pa(t,r,"claims",e),pa(t,r,"sitelinks",e)):n==="property"?(r.datatype=t.datatype,pa(t,r,"labels"),pa(t,r,"descriptions"),pa(t,r,"aliases"),pa(t,r,"claims",e)):n==="lexeme"?(pa(t,r,"lemmas"),r.lexicalCategory=t.lexicalCategory,r.language=t.language,pa(t,r,"claims",e),pa(t,r,"forms",e),pa(t,r,"senses",e)):n==="mediainfo"&&(pa(t,r,"labels"),pa(t,r,"descriptions"),pa(t,r,"statements",e)),r},pa=(t,e,n,r)=>{t[n]!=null&&(e[n]=I_e[n](t[n],r))},jz=(t,e={})=>{t.entities&&(t=t.entities);const{entityPrefix:n}=e,r={};for(const[a,i]of Object.entries(t)){const o=n?`${n}:${a}`:a;r[o]=Wz(i,e)}return r};function E_e(t){t=t.body||t;const{entities:e}=t;return jz(e)}function __e(t){return t=t.body||t,t.query.search.map(e=>e.title)}const O_e=Object.freeze(Object.defineProperty({__proto__:null,entities:E_e,pagesTitles:__e},Symbol.toStringTag,{value:"Module"}));function $_e(t,e={}){typeof t=="string"&&(t=JSON.parse(t));const{vars:n}=t.head,r=t.results.bindings;if(n.length===1&&e.minimize){const s=n[0];return r.map(l=>RE(l[s])).filter(l=>l!=null)}const{richVars:a,associatedVars:i,standaloneVars:o}=A_e(n);return r.map(s=>P_e(a,i,o,s))}function RE(t){if(!t||t.type==="bnode")return null;const{value:e}=t;if(t.type==="uri")return R_e(e);const n=(t.datatype||"").replace("http://www.w3.org/2001/XMLSchema#","");return n==="decimal"||n==="integer"||n==="float"||n==="double"?parseFloat(e):n==="boolean"?e==="true":e}function R_e(t){return t.match(/http.*\/entity\/statement\//)?M_e(t):t.replace(/^https?:\/\/.*\/entity\//,"").replace(/^https?:\/\/.*\/prop\/direct\//,"")}function M_e(t){t=t.replace(/^https?:\/\/.*\/entity\/statement\//,"");const e=t.split("-");return e[0]+"$"+e.slice(1).join("-")}function A_e(t){let e=t.filter(i=>{const o=new RegExp(`^${i}[A-Z]\\w+`);return t.some(s=>o.test(s))});e=e.filter(i=>!e.some(o=>i!==o&&i.startsWith(o)));const n=new RegExp(`^(${e.join("|")})[A-Z]`),r=t.filter(i=>n.test(i)),a=t.filter(i=>!e.includes(i)&&!n.test(i));return{richVars:e,associatedVars:r,standaloneVars:a}}function P_e(t,e,n,r){const a={};for(const i of t){const o={},s=RE(r[i]);s!=null&&(o.value=s);for(const l of e)l.startsWith(i)&&D_e(r,i,l,o);Object.keys(o).length>0&&(a[i]=o)}for(const i of n){const o=RE(r[i]);o!=null&&(a[i]=o)}return a}function D_e(t,e,n,r){let a=n.split(e)[1];a=a[0].toLowerCase()+a.slice(1),a=a==="altLabel"?"aliases":a;const i=t[n];i!=null&&(r[a]=i.value)}const L_e=Object.freeze(Object.defineProperty({__proto__:null,aliases:_z,claim:_E,claims:_p,descriptions:Ez,entities:jz,entity:Wz,form:Mz,forms:Az,glosses:Rz,labels:Iz,lemmas:Oz,propertyClaims:Sz,propertyQualifiers:m_e,propertySnaks:Sz,qualifier:g_e,qualifiers:Cz,references:Nz,representations:$z,sense:Pz,senses:Dz,sitelinks:Vz,snak:_E,snaks:_p,sparqlResults:$_e},Symbol.toStringTag,{value:"Module"})),F_e=/^\d+[|\d]*$/;function B_e(t){return function(e){Ql(arguments);for(const[f,g]of Object.entries(e))if(f.startsWith("sr")){const y=f.replace(/^sr/,"");if(e[y]!=null)throw new Error(`${y} and ${f} are the same`);e[y]=g}const{search:n,haswbstatement:r,format:a="json",limit:i,offset:o,profile:s,sort:l}=e;let{namespace:u,prop:c}=e;if(!(n||r))throw new Error('missing "search" or "haswbstatement" parameter');let d="";if(n&&(d+=n),r){const f=r instanceof Array?r:[r];for(const g of f)g[0]==="-"?d+=` -haswbstatement:${g.slice(1)}`:d+=` haswbstatement:${g}`}if(i!=null&&(typeof i!="number"||i<1))throw new Error(`invalid limit: ${i}`);if(o!=null&&(typeof o!="number"||o<0))throw new Error(`invalid offset: ${o}`);if(u instanceof Array?u=u.join("|"):typeof u=="number"&&(u=u.toString()),u&&!F_e.test(u))throw new Error(`invalid namespace: ${u}`);if(s!=null&&typeof s!="string")throw new Error(`invalid profile: ${s} (${typeof s}, expected string)`);if(l!=null&&typeof l!="string")throw new Error(`invalid sort: ${l} (${typeof l}, expected string)`);let p;if(c!=null){if(c instanceof Array&&(c=c.join("|")),typeof c!="string")throw new Error(`invalid prop: ${c} (${typeof c}, expected string)`);p=c.toString()}return t({action:"query",list:"search",srsearch:d.trim(),format:a,srnamespace:u,srlimit:i,sroffset:o,srqiprofile:s,srsort:l,srprop:p})}}function z2(t,e){return function(n){if(!e(n))throw new Error(`invalid ${t}: ${n} (type: ${j_e(n)})`)}}const Uz=z2("entity id",wE),z_e=z2("property id",L2),V_e=z2("entity page title",hz),W_e=z2("revision id",dz);function j_e(t){const e=typeof t;if(e==="object"){if(t===null)return"null";if(t instanceof Array)return"array";if(t instanceof Promise)return"promise"}return e==="number"&&Number.isNaN(t)?"NaN":e}function Gz(t){return function({ids:e,languages:n,props:r,format:a="json",redirects:i}){if(Ql(arguments),!(e&&e.length>0))throw new Error("no id provided");e=Wo(e),e.forEach(s=>Uz(s)),e.length>50&&console.warn(`getEntities accepts 50 ids max to match Wikidata API limitations:
      this request won't get all the desired entities.
      You can use getManyEntities instead to generate several request urls
      to work around this limitation`);const o={action:"wbgetentities",ids:e.join("|"),format:a};return i===!1&&(o.redirects="no"),n&&(n=Wo(n),o.languages=n.join("|")),r&&r.length>0&&(o.props=Wo(r).join("|")),t(o)}}function U_e(t){return function({titles:e,sites:n,languages:r,props:a,format:i="json",redirects:o}){if(Ql(arguments),!(e&&e.length>0))throw new Error("no titles provided");n&&n.length>0||(n=["enwiki"]),e=Wo(e),n=Wo(n).map(G_e),a=Wo(a);const s={action:"wbgetentities",titles:e.join("|"),sites:n.join("|"),format:i};return n.length===1&&e.length===1&&(s.normalize=!0),r&&(r=Wo(r),s.languages=r.join("|")),a.length>0&&(s.props=a.join("|")),o===!1&&(s.redirects="no"),t(s)}}function G_e(t){return Sg($E,t)?t:t.replace(/-/g,"_")+"wiki"}function H_e(t,e){return function({id:n,revision:r}){return Ql(arguments),Uz(n),W_e(r),`${t}/${e}/index.php?title=Special:EntityData/${n}.json&revision=${r}`}}function q_e(t){const e=Gz(t);return function({ids:n,languages:r,props:a,format:i,redirects:o}){if(Ql(arguments),!(n instanceof Array))throw new Error("getManyEntities expects an array of ids");return K_e(n).map(s=>e({ids:s,languages:r,props:a,format:i,redirects:o}))}}function K_e(t){const e=[];for(;t.length>0;){const n=t.slice(0,50);t=t.slice(50),e.push(n)}return e}function Hz(t){return function(e){const n=mz(e);return`${t}?format=json&query=${n}`}}const X_e="FILTER NOT EXISTS { ?subject rdf:type wikibase:Property . } ",Y_e=t=>{const e=Hz(t);return function(n){let{properties:r}=n;const{values:a,limit:i,caseInsensitive:o,keepProperties:s}=n,l=o?J_e:Z_e,u=s?"":X_e;r=Wo(r),r.forEach(d=>z_e(d));let c=`SELECT DISTINCT ?subject WHERE { ${Q_e(a,l,r,u)} }`;return i&&(c+=` LIMIT ${i}`),e(c)}},Q_e=(t,e,n,r)=>(n=n.map(e5e).join("|"),t instanceof Array?"{ "+t.map(qz).map(a=>e(n,a,r)).join("} UNION {")+" }":e(n,qz(t),r)),qz=t=>(D2(t)?t=`wd:${t}`:typeof t=="string"&&(t=`'${t}'`),t),Z_e=(t,e,n)=>`?subject ${t} ${e} .
    ${n}`,J_e=(t,e,n)=>`?subject ${t} ?value .
    FILTER (lcase(?value) = ${e.toLowerCase()})
    ${n}`,e5e=t=>"wdt:"+t;function t5e(t){return function({ids:e,format:n,limit:r,start:a,end:i,prop:o,user:s,excludeuser:l,tag:u}){Ql(arguments),e=Wo(e),e.forEach(p=>V_e(p));const c=e.length===1,d={action:"query",prop:"revisions"};return d.titles=e.join("|"),d.format=n||"json",c&&(d.rvlimit=r||"max"),c&&a&&(d.rvstart=Kz(a)),c&&i&&(d.rvend=Kz(i)),o?d.rvprop=Wo(o).join("|"):d.rvprop="ids|flags|timestamp|user|userid|size|slotsize|sha1|slotsha1|contentmodel|comment|parsedcomment|content|tags|roles|oresscores",d.rvslots="*",s&&(d.rvuser=s),l&&(d.rvexcludeuser=l),u&&(d.rvtag=u),t(d)}}const Kz=t=>typeof t=="number"&&t<n5e?t:Math.trunc(new Date(t).getTime()/1e3),n5e=new Date("2000-01-01").getTime(),r5e=["item","property","lexeme","form","sense"],a5e=t=>function({search:e,language:n="en",uselang:r,limit:a="20",continue:i="0",format:o="json",type:s="item"}){if(Ql(arguments),r=r||n,!(e&&e.length>0))throw new Error("search can't be empty");if(!Sg(r5e,s))throw new Error(`invalid type: ${s}`);return t({action:"wbsearchentities",search:e,language:n,limit:a,continue:i,format:o,uselang:r,type:s})},i5e=typeof location<"u"&&typeof document<"u";function o5e(t){return e=>{i5e&&(e=Object.assign(Object.assign({},e),{origin:"*"}));const n=Object.entries(e).filter(([,a])=>a!=null).map(([a,i])=>[a,String(i)]),r=new URLSearchParams(n).toString();return t+"?"+r}}const s5e=`Tip: if you just want to access functions that don't need an instance or a sparqlEndpoint,
those are also exposed directly on the module object. Exemple:
import { isItemId, simplify } from 'wikibase-sdk'`,l5e=Object.assign(Object.assign(Object.assign(Object.assign({simplify:L_e,parse:O_e},qEe),N_e),f_e),n_e);function u5e(t){if(!fz(t))throw new Error("invalid config");const{instance:e,sparqlEndpoint:n}=t;let{wgScriptPath:r="w"}=t;if(r=r.replace(/^\//,""),!(e||n))throw new Error(`one of instance or sparqlEndpoint should be set at initialization.
${s5e}`);let a,i,o;if(e){Xz("instance",e),i=e.replace(/\/$/,"").replace(`/${r}/api.php`,""),o=`${i}/${r}/api.php`;const l=o5e(o);a={searchEntities:a5e(l),cirrusSearchPages:B_e(l),getEntities:Gz(l),getManyEntities:q_e(l),getRevisions:t5e(l),getEntityRevision:H_e(e,r),getEntitiesFromSitelinks:U_e(l)}}else a={searchEntities:vc("searchEntities"),cirrusSearchPages:vc("cirrusSearchPages"),getEntities:vc("getEntities"),getManyEntities:vc("getManyEntities"),getRevisions:vc("getRevisions"),getEntityRevision:vc("getEntityRevision"),getEntitiesFromSitelinks:vc("getEntitiesFromSitelinks")};let s;return n?(Xz("sparqlEndpoint",n),s={sparqlQuery:Hz(n),getReverseClaims:Y_e(n)}):s={sparqlQuery:Qz("sparqlQuery"),getReverseClaims:Qz("getReverseClaims")},Object.assign(Object.assign(Object.assign({instance:{root:i,apiEndpoint:o}},l5e),a),s)}const Xz=(t,e)=>{if(!(typeof e=="string"&&e.startsWith("http")))throw new Error(`invalid ${t}: ${e}`)},Yz=t=>e=>()=>{throw new Error(`${e} requires ${t} to be set at initialization`)},Qz=Yz("a sparqlEndpoint"),vc=Yz("an instance"),c5e={sparqlQuery:(t="")=>{const e=u5e({instance:"https://www.wikidata.org",sparqlEndpoint:"https://query.wikidata.org/sparql"}),n=`
      SELECT ?item ?itemLabel ?artworkLabel ?countryLabel ?genreLabel ?year ?locationLabel ?creatorLabel ?materialLabel ?depictsLabel ?collectionLabel ?iiifManifest
      WITH {    
        SELECT ?item (SAMPLE(?artwork) as ?artwork) (SAMPLE(?country) as ?country) (SAMPLE(?genre) as ?genre) (SAMPLE(YEAR(?inception)) as ?year) (SAMPLE(?location) as ?location) (SAMPLE(?creator) as ?creator) (SAMPLE(?material) as ?material) (SAMPLE(?depicts) as ?depicts) (SAMPLE(?collection) as ?collection) (SAMPLE(?iiifManifest) as ?iiifManifest)
        WHERE {
          ?item wdt:P6108 ?iiifManifest ;
                wdt:P195 ?collection ;
                wdt:P31 ?artwork .
                FILTER ( ?artwork = wd:Q3305213 || ?artwork = wd:Q93184 || ?artwork = wd:Q11060274 || ?artwork = wd:Q860861 || ?artwork = wd:Q125191 )
                ${t!==""?`FILTER ( ?material = ${t} )`:""}
                OPTIONAL {
                  ?item wdt:P495 ?countryOfOrigin.
                  FILTER(?countryOfOrigin = wd:Q31 || ?countryOfOrigin = wd:Q213 || ?countryOfOrigin = wd:Q35 || ?countryOfOrigin = wd:Q142 || ?countryOfOrigin = wd:Q36 || ?countryOfOrigin = wd:Q39 || ?countryOfOrigin = wd:Q32 || ?countryOfOrigin = wd:Q40 || ?countryOfOrigin = wd:Q55 || ?countryOfOrigin = wd:Q183 )
                }
                OPTIONAL {
                  ?collection wdt:P17 ?country.
                  FILTER(?country = wd:Q31 || ?country = wd:Q213 || ?country = wd:Q35 || ?country = wd:Q142 || ?country = wd:Q36 || ?country = wd:Q39 || ?country = wd:Q32 || ?country = wd:Q40 || ?country = wd:Q55 || ?country = wd:Q183 )
                }
                BIND(COALESCE(?countryOfOrigin, ?country) AS ?country)
                FILTER(BOUND(?country))

                OPTIONAL { ?item wdt:P136 ?genre. }
                OPTIONAL { ?item wdt:P571 ?inception. }
                OPTIONAL { ?item wdt:P276 ?location. }
                OPTIONAL { ?item wdt:P170 ?creator. }
                OPTIONAL { ?item wdt:P186 ?material. }
                OPTIONAL { ?item wdt:P180 ?depicts. }
        }
        GROUP BY ?item
        LIMIT 10
      } AS %result
      WHERE {
        INCLUDE %result.
        SERVICE wikibase:label { bd:serviceParam wikibase:language "[AUTO_LANGUAGE],en". }
      } ORDER BY ?itemLabel
    `;return e.sparqlQuery(n)}},d5e=()=>{const[t,e]=P.useState([]),[n,r]=P.useState(!0),[a,i]=P.useState(null);return P.useEffect(()=>{(async()=>{try{const o=await fetch(c5e.sparqlQuery());if(!o.ok)throw new Error(`Error: ${o.status} - ${o.statusText}`);const s=await o.json();e(s.results.bindings)}catch(o){i(o.message)}finally{r(!1)}})()},[]),{data:t,loading:n,error:a}},Zz=({onClick:t,materialIcon:e})=>fe.jsx(Br,{className:"p-4 text-xl text-black",onClick:t,rounded:!0,inline:!0,children:fe.jsx(ei,{material:e})});function p5e(){const{t}=Qh(),[e,n]=P.useState(0),{addToImageList:r,imageList:a,removeFromImageList:i}=vs(),{data:o}=d5e(),s=vs(b=>b.likeImage),l=P.useRef(e),u=P.useRef(null),c=P.useCallback(async b=>{if(!b)return;const v=async S=>{try{return await X7.fetchIIIFIdentifier(S)}catch(C){return console.error("Error:",C),null}},w=(await Promise.all(b.map(async S=>{var C,I,_,E,A;try{const M=await v(S.iiifManifest.value);return M!==null?{id:S.item.value,name:S.itemLabel.value||"",year:((C=S.year)==null?void 0:C.value)||"",country:(I=S.countryLabel)==null?void 0:I.value,location:((_=S?.locationLabel)==null?void 0:_.value)||"",creator:((E=S.creatorLabel)==null?void 0:E.value)||"",url:(A=S.iiifManifest)==null?void 0:A.value,identifier:M,image:`${M}/full/400,/0/default.jpg`,thumbnail:`${M}/full/100,100/0/default.jpg`}:null}catch(M){return console.error("Error processing image:",M),null}}))).filter(S=>S!==null);r(w)},[r]);P.useEffect(()=>{o.length>0&&c(o)},[o,c]);const d=b=>{n(b),l.current=b},p=e>=0,f=(b,v)=>{b==="right"&&s(x),i(x.id),d(v+1)},g=b=>{var v;l.current>=b&&((v=u.current)==null||v.restoreCard())},y=async b=>{var v;p&&e<a.length&&await((v=u.current)==null?void 0:v.swipe(b))},x=a[e];return fe.jsxs(ds,{className:"flex flex-col flex-wrap gap-4 container justify-center content-center text-center mx-auto",children:[fe.jsx("div",{className:"p-2 m-4",children:fe.jsx("h1",{className:"text-2xl",children:t("selectionTitle")})}),fe.jsx("div",{className:"mx-auto h-2/3",children:fe.jsx(UM,{className:"flex shadow-md shadow-[#BC13FE]/90",children:x&&fe.jsxs(fe.Fragment,{children:[fe.jsx(LEe,{ref:u,className:"mb-4",onSwipe:b=>f(b,e),onCardLeftScreen:()=>g(e),preventSwipe:["up","down"],children:fe.jsx("img",{alt:x.name,src:x.image})},x.id),fe.jsxs("div",{className:"flex justify-between",children:[fe.jsx(Zz,{onClick:()=>y("left"),materialIcon:fe.jsx(kK,{className:"w-6 h-6"})}),fe.jsx(Zz,{onClick:()=>y("right"),materialIcon:fe.jsx(NK,{className:"w-6 h-6"})})]})]})})}),fe.jsxs("div",{className:"mb-8 p-4 bg-white rounded h-1/3 opacity-90 max-w-lg w-2/3 text-center mx-auto shadow-md shadow-[#BC13FE]/90",children:[fe.jsx("h2",{className:"text-2xl font-bold mb-4 text-black",children:x?.name}),fe.jsxs("p",{className:"text-gray-600",children:[t("selectionYear")," ",x?.year!==""?x?.year:t("selectionUnknown")]}),fe.jsxs("p",{className:"text-gray-600",children:[t("selectionCreator")," ",x?.creator!==""?x?.creator:t("selectionUnknown")]}),fe.jsxs("p",{className:"text-gray-600",children:[t("selectionLocation")," ",x?.location!==""?x?.location:t("selectionUnknown")]})]})]})}const h5e="/collage.webp",f5e="/logo_animated.svg",m5e=()=>fe.jsx("img",{src:f5e,alt:"Logo GLAMorous Europe",className:"w-96 m-auto"}),g5e=()=>fe.jsx("img",{src:h5e,alt:"Collage GLAMorous Europe",className:"w-96 m-auto",decoding:"async"});function y5e(){const{t}=Qh(),{imageLikeList:e,resetState:n}=vs(),[r,a]=P.useState(!1),i=()=>{e.length>0?a(!0):window.location.href="/selection"},o=()=>{a(!1)},s=()=>{a(!1),n()};return fe.jsxs(ds,{className:"flex flex-col flex-wrap gap-4 container justify-center content-center text-center mx-auto",children:[fe.jsx(m5e,{}),fe.jsx("h1",{className:"text-3xl",children:t("startTitle")}),fe.jsx("h2",{className:"text-xl",children:t("startSubtitle")}),fe.jsx(g5e,{}),fe.jsx("p",{className:"text-xl",children:t("startText")}),fe.jsx(Br,{large:!0,className:"text-4xl w-1/2 mx-auto h-16",rounded:!0,inline:!0,onClick:i,children:t("startButtonText")}),r&&fe.jsx(YM,{opened:r,onBackdropClick:()=>a(!1),children:fe.jsxs(SN,{children:[fe.jsx(KM,{title:t("discardModalTitle"),right:fe.jsx(J1,{to:"/",onClick:o,children:t("discardModalCancel")})}),fe.jsxs(ds,{className:"space-y-4",children:[fe.jsx("p",{children:t("discardModalMessage")}),fe.jsx(Br,{className:"p-4 rounded-full text-xl bg-red-500 text-white",children:fe.jsx(J1,{to:"/selection",onClick:s,children:t("discardModalConfirm")})}),fe.jsx(Br,{className:"p-4 rounded-full text-xl bg-red-500 text-white",onClick:o,children:t("discardModalNotConfirm")})]})]})})]})}function b5e(){return fe.jsx(Gq,{children:fe.jsxs(Sd,{path:"/",element:fe.jsx(ZIe,{}),children:[fe.jsx(Sd,{index:!0,element:fe.jsx(y5e,{})}),fe.jsx(Sd,{path:"selection",element:fe.jsx(p5e,{})}),fe.jsx(Sd,{path:"collection",element:fe.jsx(QIe,{})}),fe.jsx(Sd,{path:"creation",element:fe.jsx(kre,{})})]})})}const v5e={artwork:"Meine Leinwand",artworkEmpty:"F\xFCge deine pers\xF6nlichen Favoriten hinzu",artworkTitle:"Gestalte mit einzelnen Bildelementen dein ganz eigenes europ\xE4isches Kunstwerk und teile es mit anderen.",chooseLanguage:"Sprache w\xE4hlen:",collection:"Meine Sammlung",collectionAddText:"Ausschnitt meiner Leinwand hinzuf\xFCgen",collectionClose:"Schlie\xDFen",collectionLoading:"Lade...",collectionTitle:"Hier ist deine Auswahl der Favoriten. W\xE4hle einen Auschnitt aus den Bildern f\xFCr deine Leinwand.",discardModalCancel:"Abbrechen",discardModalConfirm:"Ja",discardModalMessage:"M\xF6chtest du die bestehende Auswahl verwerfen?",discardModalNotConfirm:"Nein",discardModalTitle:"Meine Auswahl bereits vorhanden",selection:"Meine Auswahl",selectionCreator:"Urheber:in:",selectionLocation:"Ort:",selectionTitle:"W\xE4hle deine pers\xF6nlichen Favoriten aus.",selectionUnknown:"Unbekannt",selectionYear:"Jahr:",start:"Start",startButtonText:"Los geht's!",startSubtitle:"Entdecke hier die sch\xF6nsten Sammlungsobjekte aus Museen, Galerien, Bibliotheken und Archiven verschiedener L\xE4nder Europas.",startText:"Lass dich von der k\xFCnstlerischen Vielfalt Europas inspirieren!",startTitle:"Herzlich willkommen in der schillernden Welt von GLAMorous Europe!"},x5e={translation:v5e},w5e={artwork:"My Artwork",artworkEmpty:"Add your personal favourites.",artworkTitle:"Use individual picture elements to create your very own European work of art and share it with others.",chooseLanguage:"Choose Language:",collection:"My Collection",collectionAddText:"Add to my artwork",collectionClose:"Close",collectionLoading:"Loading...",collectionTitle:"Open the door to new paintings, sculptures and photographs that perfectly match your taste.",discardModalCancel:"Close",discardModalConfirm:"Yes",discardModalMessage:"Do you want to discard the existing selection?",discardModalNotConfirm:"No",discardModalTitle:"Current selection",selection:"My Selection",selectionCreator:"Creator:",selectionLocation:"Location:",selectionTitle:"Choose your personal favourites.",selectionUnknown:"Unknown",selectionYear:"Year:",start:"start",startButtonText:"Let's go!",startSubtitle:"Discover the most beautiful collection objects from museums, galleries, libraries and archives from various European countries.",startText:"Be inspired by the artistic diversity of Europe!",startTitle:"Welcome to the glittering world of GLAMorous Europe!"},k5e={translation:w5e};Pr.init({interpolation:{escapeValue:!1},lng:"auto",fallbackLng:"de",resources:{de:{...x5e},en:{...k5e}}}),hM(document.getElementById("root")).render(fe.jsx(G.StrictMode,{children:fe.jsx(JH,{i18n:Pr,children:fe.jsx(Hj,{backend:PU,children:fe.jsx(Jq,{children:fe.jsx(b5e,{})})})})}));export{k5 as $,lk as a,OW as b,_W as c,B5 as d,H1 as e,G as f,ya as g,FD as h,Hi as i,FH as j,P as r};function V2(t){return V2.viteFileDeps||(V2.viteFileDeps=[]),t.map(e=>V2.viteFileDeps[e])}
