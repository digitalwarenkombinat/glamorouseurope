var Kx=Object.defineProperty;var Yx=(_r,Tr,Ar)=>Tr in _r?Kx(_r,Tr,{enumerable:!0,configurable:!0,writable:!0,value:Ar}):_r[Tr]=Ar;var ap=(_r,Tr,Ar)=>(Yx(_r,typeof Tr!="symbol"?Tr+"":Tr,Ar),Ar);function _mergeNamespaces(_r,Tr){for(var Ar=0;Ar<Tr.length;Ar++){const Rr=Tr[Ar];if(typeof Rr!="string"&&!Array.isArray(Rr)){for(const Pr in Rr)if(Pr!=="default"&&!(Pr in _r)){const Dr=Object.getOwnPropertyDescriptor(Rr,Pr);Dr&&Object.defineProperty(_r,Pr,Dr.get?Dr:{enumerable:!0,get:()=>Rr[Pr]})}}}return Object.freeze(Object.defineProperty(_r,Symbol.toStringTag,{value:"Module"}))}(function(){const Tr=document.createElement("link").relList;if(Tr&&Tr.supports&&Tr.supports("modulepreload"))return;for(const Pr of document.querySelectorAll('link[rel="modulepreload"]'))Rr(Pr);new MutationObserver(Pr=>{for(const Dr of Pr)if(Dr.type==="childList")for(const Mr of Dr.addedNodes)Mr.tagName==="LINK"&&Mr.rel==="modulepreload"&&Rr(Mr)}).observe(document,{childList:!0,subtree:!0});function Ar(Pr){const Dr={};return Pr.integrity&&(Dr.integrity=Pr.integrity),Pr.referrerPolicy&&(Dr.referrerPolicy=Pr.referrerPolicy),Pr.crossOrigin==="use-credentials"?Dr.credentials="include":Pr.crossOrigin==="anonymous"?Dr.credentials="omit":Dr.credentials="same-origin",Dr}function Rr(Pr){if(Pr.ep)return;Pr.ep=!0;const Dr=Ar(Pr);fetch(Pr.href,Dr)}})();var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs$1(_r){return _r&&_r.__esModule&&Object.prototype.hasOwnProperty.call(_r,"default")?_r.default:_r}function getAugmentedNamespace(_r){if(_r.__esModule)return _r;var Tr=_r.default;if(typeof Tr=="function"){var Ar=function Rr(){return this instanceof Rr?Reflect.construct(Tr,arguments,this.constructor):Tr.apply(this,arguments)};Ar.prototype=Tr.prototype}else Ar={};return Object.defineProperty(Ar,"__esModule",{value:!0}),Object.keys(_r).forEach(function(Rr){var Pr=Object.getOwnPropertyDescriptor(_r,Rr);Object.defineProperty(Ar,Rr,Pr.get?Pr:{enumerable:!0,get:function(){return _r[Rr]}})}),Ar}var jsxRuntime={exports:{}},reactJsxRuntime_production_min={},react={exports:{}},react_production_min={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l$3=Symbol.for("react.element"),n$3=Symbol.for("react.portal"),p$5=Symbol.for("react.fragment"),q$5=Symbol.for("react.strict_mode"),r$1=Symbol.for("react.profiler"),t$2=Symbol.for("react.provider"),u$3=Symbol.for("react.context"),v$3=Symbol.for("react.forward_ref"),w$2=Symbol.for("react.suspense"),x$4=Symbol.for("react.memo"),y$3=Symbol.for("react.lazy"),z$4=Symbol.iterator;function A$4(_r){return _r===null||typeof _r!="object"?null:(_r=z$4&&_r[z$4]||_r["@@iterator"],typeof _r=="function"?_r:null)}var B$4={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C$3=Object.assign,D$4={};function E$4(_r,Tr,Ar){this.props=_r,this.context=Tr,this.refs=D$4,this.updater=Ar||B$4}E$4.prototype.isReactComponent={};E$4.prototype.setState=function(_r,Tr){if(typeof _r!="object"&&typeof _r!="function"&&_r!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,_r,Tr,"setState")};E$4.prototype.forceUpdate=function(_r){this.updater.enqueueForceUpdate(this,_r,"forceUpdate")};function F$4(){}F$4.prototype=E$4.prototype;function G$5(_r,Tr,Ar){this.props=_r,this.context=Tr,this.refs=D$4,this.updater=Ar||B$4}var H$4=G$5.prototype=new F$4;H$4.constructor=G$5;C$3(H$4,E$4.prototype);H$4.isPureReactComponent=!0;var I$4=Array.isArray,J$3=Object.prototype.hasOwnProperty,K$5={current:null},L$3={key:!0,ref:!0,__self:!0,__source:!0};function M$5(_r,Tr,Ar){var Rr,Pr={},Dr=null,Mr=null;if(Tr!=null)for(Rr in Tr.ref!==void 0&&(Mr=Tr.ref),Tr.key!==void 0&&(Dr=""+Tr.key),Tr)J$3.call(Tr,Rr)&&!L$3.hasOwnProperty(Rr)&&(Pr[Rr]=Tr[Rr]);var Fr=arguments.length-2;if(Fr===1)Pr.children=Ar;else if(1<Fr){for(var zr=Array(Fr),jr=0;jr<Fr;jr++)zr[jr]=arguments[jr+2];Pr.children=zr}if(_r&&_r.defaultProps)for(Rr in Fr=_r.defaultProps,Fr)Pr[Rr]===void 0&&(Pr[Rr]=Fr[Rr]);return{$$typeof:l$3,type:_r,key:Dr,ref:Mr,props:Pr,_owner:K$5.current}}function N$5(_r,Tr){return{$$typeof:l$3,type:_r.type,key:Tr,ref:_r.ref,props:_r.props,_owner:_r._owner}}function O$4(_r){return typeof _r=="object"&&_r!==null&&_r.$$typeof===l$3}function escape(_r){var Tr={"=":"=0",":":"=2"};return"$"+_r.replace(/[=:]/g,function(Ar){return Tr[Ar]})}var P$5=/\/+/g;function Q$5(_r,Tr){return typeof _r=="object"&&_r!==null&&_r.key!=null?escape(""+_r.key):Tr.toString(36)}function R$5(_r,Tr,Ar,Rr,Pr){var Dr=typeof _r;(Dr==="undefined"||Dr==="boolean")&&(_r=null);var Mr=!1;if(_r===null)Mr=!0;else switch(Dr){case"string":case"number":Mr=!0;break;case"object":switch(_r.$$typeof){case l$3:case n$3:Mr=!0}}if(Mr)return Mr=_r,Pr=Pr(Mr),_r=Rr===""?"."+Q$5(Mr,0):Rr,I$4(Pr)?(Ar="",_r!=null&&(Ar=_r.replace(P$5,"$&/")+"/"),R$5(Pr,Tr,Ar,"",function(jr){return jr})):Pr!=null&&(O$4(Pr)&&(Pr=N$5(Pr,Ar+(!Pr.key||Mr&&Mr.key===Pr.key?"":(""+Pr.key).replace(P$5,"$&/")+"/")+_r)),Tr.push(Pr)),1;if(Mr=0,Rr=Rr===""?".":Rr+":",I$4(_r))for(var Fr=0;Fr<_r.length;Fr++){Dr=_r[Fr];var zr=Rr+Q$5(Dr,Fr);Mr+=R$5(Dr,Tr,Ar,zr,Pr)}else if(zr=A$4(_r),typeof zr=="function")for(_r=zr.call(_r),Fr=0;!(Dr=_r.next()).done;)Dr=Dr.value,zr=Rr+Q$5(Dr,Fr++),Mr+=R$5(Dr,Tr,Ar,zr,Pr);else if(Dr==="object")throw Tr=String(_r),Error("Objects are not valid as a React child (found: "+(Tr==="[object Object]"?"object with keys {"+Object.keys(_r).join(", ")+"}":Tr)+"). If you meant to render a collection of children, use an array instead.");return Mr}function S$5(_r,Tr,Ar){if(_r==null)return _r;var Rr=[],Pr=0;return R$5(_r,Rr,"","",function(Dr){return Tr.call(Ar,Dr,Pr++)}),Rr}function T$4(_r){if(_r._status===-1){var Tr=_r._result;Tr=Tr(),Tr.then(function(Ar){(_r._status===0||_r._status===-1)&&(_r._status=1,_r._result=Ar)},function(Ar){(_r._status===0||_r._status===-1)&&(_r._status=2,_r._result=Ar)}),_r._status===-1&&(_r._status=0,_r._result=Tr)}if(_r._status===1)return _r._result.default;throw _r._result}var U$5={current:null},V$5={transition:null},W$5={ReactCurrentDispatcher:U$5,ReactCurrentBatchConfig:V$5,ReactCurrentOwner:K$5};react_production_min.Children={map:S$5,forEach:function(_r,Tr,Ar){S$5(_r,function(){Tr.apply(this,arguments)},Ar)},count:function(_r){var Tr=0;return S$5(_r,function(){Tr++}),Tr},toArray:function(_r){return S$5(_r,function(Tr){return Tr})||[]},only:function(_r){if(!O$4(_r))throw Error("React.Children.only expected to receive a single React element child.");return _r}};react_production_min.Component=E$4;react_production_min.Fragment=p$5;react_production_min.Profiler=r$1;react_production_min.PureComponent=G$5;react_production_min.StrictMode=q$5;react_production_min.Suspense=w$2;react_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=W$5;react_production_min.cloneElement=function(_r,Tr,Ar){if(_r==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+_r+".");var Rr=C$3({},_r.props),Pr=_r.key,Dr=_r.ref,Mr=_r._owner;if(Tr!=null){if(Tr.ref!==void 0&&(Dr=Tr.ref,Mr=K$5.current),Tr.key!==void 0&&(Pr=""+Tr.key),_r.type&&_r.type.defaultProps)var Fr=_r.type.defaultProps;for(zr in Tr)J$3.call(Tr,zr)&&!L$3.hasOwnProperty(zr)&&(Rr[zr]=Tr[zr]===void 0&&Fr!==void 0?Fr[zr]:Tr[zr])}var zr=arguments.length-2;if(zr===1)Rr.children=Ar;else if(1<zr){Fr=Array(zr);for(var jr=0;jr<zr;jr++)Fr[jr]=arguments[jr+2];Rr.children=Fr}return{$$typeof:l$3,type:_r.type,key:Pr,ref:Dr,props:Rr,_owner:Mr}};react_production_min.createContext=function(_r){return _r={$$typeof:u$3,_currentValue:_r,_currentValue2:_r,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},_r.Provider={$$typeof:t$2,_context:_r},_r.Consumer=_r};react_production_min.createElement=M$5;react_production_min.createFactory=function(_r){var Tr=M$5.bind(null,_r);return Tr.type=_r,Tr};react_production_min.createRef=function(){return{current:null}};react_production_min.forwardRef=function(_r){return{$$typeof:v$3,render:_r}};react_production_min.isValidElement=O$4;react_production_min.lazy=function(_r){return{$$typeof:y$3,_payload:{_status:-1,_result:_r},_init:T$4}};react_production_min.memo=function(_r,Tr){return{$$typeof:x$4,type:_r,compare:Tr===void 0?null:Tr}};react_production_min.startTransition=function(_r){var Tr=V$5.transition;V$5.transition={};try{_r()}finally{V$5.transition=Tr}};react_production_min.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};react_production_min.useCallback=function(_r,Tr){return U$5.current.useCallback(_r,Tr)};react_production_min.useContext=function(_r){return U$5.current.useContext(_r)};react_production_min.useDebugValue=function(){};react_production_min.useDeferredValue=function(_r){return U$5.current.useDeferredValue(_r)};react_production_min.useEffect=function(_r,Tr){return U$5.current.useEffect(_r,Tr)};react_production_min.useId=function(){return U$5.current.useId()};react_production_min.useImperativeHandle=function(_r,Tr,Ar){return U$5.current.useImperativeHandle(_r,Tr,Ar)};react_production_min.useInsertionEffect=function(_r,Tr){return U$5.current.useInsertionEffect(_r,Tr)};react_production_min.useLayoutEffect=function(_r,Tr){return U$5.current.useLayoutEffect(_r,Tr)};react_production_min.useMemo=function(_r,Tr){return U$5.current.useMemo(_r,Tr)};react_production_min.useReducer=function(_r,Tr,Ar){return U$5.current.useReducer(_r,Tr,Ar)};react_production_min.useRef=function(_r){return U$5.current.useRef(_r)};react_production_min.useState=function(_r){return U$5.current.useState(_r)};react_production_min.useSyncExternalStore=function(_r,Tr,Ar){return U$5.current.useSyncExternalStore(_r,Tr,Ar)};react_production_min.useTransition=function(){return U$5.current.useTransition()};react_production_min.version="18.2.0";react.exports=react_production_min;var reactExports=react.exports;const React$1=getDefaultExportFromCjs$1(reactExports),$2AODx$react=_mergeNamespaces({__proto__:null,default:React$1},[reactExports]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f$3=reactExports,k$4=Symbol.for("react.element"),l$2=Symbol.for("react.fragment"),m$4=Object.prototype.hasOwnProperty,n$2=f$3.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p$4={key:!0,ref:!0,__self:!0,__source:!0};function q$4(_r,Tr,Ar){var Rr,Pr={},Dr=null,Mr=null;Ar!==void 0&&(Dr=""+Ar),Tr.key!==void 0&&(Dr=""+Tr.key),Tr.ref!==void 0&&(Mr=Tr.ref);for(Rr in Tr)m$4.call(Tr,Rr)&&!p$4.hasOwnProperty(Rr)&&(Pr[Rr]=Tr[Rr]);if(_r&&_r.defaultProps)for(Rr in Tr=_r.defaultProps,Tr)Pr[Rr]===void 0&&(Pr[Rr]=Tr[Rr]);return{$$typeof:k$4,type:_r,key:Dr,ref:Mr,props:Pr,_owner:n$2.current}}reactJsxRuntime_production_min.Fragment=l$2;reactJsxRuntime_production_min.jsx=q$4;reactJsxRuntime_production_min.jsxs=q$4;jsxRuntime.exports=reactJsxRuntime_production_min;var jsxRuntimeExports=jsxRuntime.exports,client={},reactDom={exports:{}},reactDom_production_min={},scheduler={exports:{}},scheduler_production_min={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(_r){function Tr(vs,Ds){var js=vs.length;vs.push(Ds);e:for(;0<js;){var zs=js-1>>>1,qs=vs[zs];if(0<Pr(qs,Ds))vs[zs]=Ds,vs[js]=qs,js=zs;else break e}}function Ar(vs){return vs.length===0?null:vs[0]}function Rr(vs){if(vs.length===0)return null;var Ds=vs[0],js=vs.pop();if(js!==Ds){vs[0]=js;e:for(var zs=0,qs=vs.length,fo=qs>>>1;zs<fo;){var Qs=2*(zs+1)-1,no=vs[Qs],yo=Qs+1,Js=vs[yo];if(0>Pr(no,js))yo<qs&&0>Pr(Js,no)?(vs[zs]=Js,vs[yo]=js,zs=yo):(vs[zs]=no,vs[Qs]=js,zs=Qs);else if(yo<qs&&0>Pr(Js,js))vs[zs]=Js,vs[yo]=js,zs=yo;else break e}}return Ds}function Pr(vs,Ds){var js=vs.sortIndex-Ds.sortIndex;return js!==0?js:vs.id-Ds.id}if(typeof performance=="object"&&typeof performance.now=="function"){var Dr=performance;_r.unstable_now=function(){return Dr.now()}}else{var Mr=Date,Fr=Mr.now();_r.unstable_now=function(){return Mr.now()-Fr}}var zr=[],jr=[],Gr=1,Nr=null,Lr=3,Ur=!1,Vr=!1,Wr=!1,qr=typeof setTimeout=="function"?setTimeout:null,Kr=typeof clearTimeout=="function"?clearTimeout:null,Xr=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function Zr(vs){for(var Ds=Ar(jr);Ds!==null;){if(Ds.callback===null)Rr(jr);else if(Ds.startTime<=vs)Rr(jr),Ds.sortIndex=Ds.expirationTime,Tr(zr,Ds);else break;Ds=Ar(jr)}}function _i(vs){if(Wr=!1,Zr(vs),!Vr)if(Ar(zr)!==null)Vr=!0,ys(Jr);else{var Ds=Ar(jr);Ds!==null&&ps(_i,Ds.startTime-vs)}}function Jr(vs,Ds){Vr=!1,Wr&&(Wr=!1,Kr(is),is=-1),Ur=!0;var js=Lr;try{for(Zr(Ds),Nr=Ar(zr);Nr!==null&&(!(Nr.expirationTime>Ds)||vs&&!ls());){var zs=Nr.callback;if(typeof zs=="function"){Nr.callback=null,Lr=Nr.priorityLevel;var qs=zs(Nr.expirationTime<=Ds);Ds=_r.unstable_now(),typeof qs=="function"?Nr.callback=qs:Nr===Ar(zr)&&Rr(zr),Zr(Ds)}else Rr(zr);Nr=Ar(zr)}if(Nr!==null)var fo=!0;else{var Qs=Ar(jr);Qs!==null&&ps(_i,Qs.startTime-Ds),fo=!1}return fo}finally{Nr=null,Lr=js,Ur=!1}}var es=!1,ts=null,is=-1,rs=5,as=-1;function ls(){return!(_r.unstable_now()-as<rs)}function fs(){if(ts!==null){var vs=_r.unstable_now();as=vs;var Ds=!0;try{Ds=ts(!0,vs)}finally{Ds?Ts():(es=!1,ts=null)}}else es=!1}var Ts;if(typeof Xr=="function")Ts=function(){Xr(fs)};else if(typeof MessageChannel<"u"){var $s=new MessageChannel,xs=$s.port2;$s.port1.onmessage=fs,Ts=function(){xs.postMessage(null)}}else Ts=function(){qr(fs,0)};function ys(vs){ts=vs,es||(es=!0,Ts())}function ps(vs,Ds){is=qr(function(){vs(_r.unstable_now())},Ds)}_r.unstable_IdlePriority=5,_r.unstable_ImmediatePriority=1,_r.unstable_LowPriority=4,_r.unstable_NormalPriority=3,_r.unstable_Profiling=null,_r.unstable_UserBlockingPriority=2,_r.unstable_cancelCallback=function(vs){vs.callback=null},_r.unstable_continueExecution=function(){Vr||Ur||(Vr=!0,ys(Jr))},_r.unstable_forceFrameRate=function(vs){0>vs||125<vs?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):rs=0<vs?Math.floor(1e3/vs):5},_r.unstable_getCurrentPriorityLevel=function(){return Lr},_r.unstable_getFirstCallbackNode=function(){return Ar(zr)},_r.unstable_next=function(vs){switch(Lr){case 1:case 2:case 3:var Ds=3;break;default:Ds=Lr}var js=Lr;Lr=Ds;try{return vs()}finally{Lr=js}},_r.unstable_pauseExecution=function(){},_r.unstable_requestPaint=function(){},_r.unstable_runWithPriority=function(vs,Ds){switch(vs){case 1:case 2:case 3:case 4:case 5:break;default:vs=3}var js=Lr;Lr=vs;try{return Ds()}finally{Lr=js}},_r.unstable_scheduleCallback=function(vs,Ds,js){var zs=_r.unstable_now();switch(typeof js=="object"&&js!==null?(js=js.delay,js=typeof js=="number"&&0<js?zs+js:zs):js=zs,vs){case 1:var qs=-1;break;case 2:qs=250;break;case 5:qs=1073741823;break;case 4:qs=1e4;break;default:qs=5e3}return qs=js+qs,vs={id:Gr++,callback:Ds,priorityLevel:vs,startTime:js,expirationTime:qs,sortIndex:-1},js>zs?(vs.sortIndex=js,Tr(jr,vs),Ar(zr)===null&&vs===Ar(jr)&&(Wr?(Kr(is),is=-1):Wr=!0,ps(_i,js-zs))):(vs.sortIndex=qs,Tr(zr,vs),Vr||Ur||(Vr=!0,ys(Jr))),vs},_r.unstable_shouldYield=ls,_r.unstable_wrapCallback=function(vs){var Ds=Lr;return function(){var js=Lr;Lr=Ds;try{return vs.apply(this,arguments)}finally{Lr=js}}}})(scheduler_production_min);scheduler.exports=scheduler_production_min;var schedulerExports=scheduler.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aa=reactExports,ca=schedulerExports;function p$3(_r){for(var Tr="https://reactjs.org/docs/error-decoder.html?invariant="+_r,Ar=1;Ar<arguments.length;Ar++)Tr+="&args[]="+encodeURIComponent(arguments[Ar]);return"Minified React error #"+_r+"; visit "+Tr+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var da=new Set,ea={};function fa(_r,Tr){ha(_r,Tr),ha(_r+"Capture",Tr)}function ha(_r,Tr){for(ea[_r]=Tr,_r=0;_r<Tr.length;_r++)da.add(Tr[_r])}var ia=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ja=Object.prototype.hasOwnProperty,ka=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,la={},ma={};function oa(_r){return ja.call(ma,_r)?!0:ja.call(la,_r)?!1:ka.test(_r)?ma[_r]=!0:(la[_r]=!0,!1)}function pa(_r,Tr,Ar,Rr){if(Ar!==null&&Ar.type===0)return!1;switch(typeof Tr){case"function":case"symbol":return!0;case"boolean":return Rr?!1:Ar!==null?!Ar.acceptsBooleans:(_r=_r.toLowerCase().slice(0,5),_r!=="data-"&&_r!=="aria-");default:return!1}}function qa(_r,Tr,Ar,Rr){if(Tr===null||typeof Tr>"u"||pa(_r,Tr,Ar,Rr))return!0;if(Rr)return!1;if(Ar!==null)switch(Ar.type){case 3:return!Tr;case 4:return Tr===!1;case 5:return isNaN(Tr);case 6:return isNaN(Tr)||1>Tr}return!1}function v$2(_r,Tr,Ar,Rr,Pr,Dr,Mr){this.acceptsBooleans=Tr===2||Tr===3||Tr===4,this.attributeName=Rr,this.attributeNamespace=Pr,this.mustUseProperty=Ar,this.propertyName=_r,this.type=Tr,this.sanitizeURL=Dr,this.removeEmptyString=Mr}var z$3={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(_r){z$3[_r]=new v$2(_r,0,!1,_r,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(_r){var Tr=_r[0];z$3[Tr]=new v$2(Tr,1,!1,_r[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(_r){z$3[_r]=new v$2(_r,2,!1,_r.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(_r){z$3[_r]=new v$2(_r,2,!1,_r,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(_r){z$3[_r]=new v$2(_r,3,!1,_r.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(_r){z$3[_r]=new v$2(_r,3,!0,_r,null,!1,!1)});["capture","download"].forEach(function(_r){z$3[_r]=new v$2(_r,4,!1,_r,null,!1,!1)});["cols","rows","size","span"].forEach(function(_r){z$3[_r]=new v$2(_r,6,!1,_r,null,!1,!1)});["rowSpan","start"].forEach(function(_r){z$3[_r]=new v$2(_r,5,!1,_r.toLowerCase(),null,!1,!1)});var ra=/[\-:]([a-z])/g;function sa(_r){return _r[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(_r){var Tr=_r.replace(ra,sa);z$3[Tr]=new v$2(Tr,1,!1,_r,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(_r){var Tr=_r.replace(ra,sa);z$3[Tr]=new v$2(Tr,1,!1,_r,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(_r){var Tr=_r.replace(ra,sa);z$3[Tr]=new v$2(Tr,1,!1,_r,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(_r){z$3[_r]=new v$2(_r,1,!1,_r.toLowerCase(),null,!1,!1)});z$3.xlinkHref=new v$2("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(_r){z$3[_r]=new v$2(_r,1,!1,_r.toLowerCase(),null,!0,!0)});function ta(_r,Tr,Ar,Rr){var Pr=z$3.hasOwnProperty(Tr)?z$3[Tr]:null;(Pr!==null?Pr.type!==0:Rr||!(2<Tr.length)||Tr[0]!=="o"&&Tr[0]!=="O"||Tr[1]!=="n"&&Tr[1]!=="N")&&(qa(Tr,Ar,Pr,Rr)&&(Ar=null),Rr||Pr===null?oa(Tr)&&(Ar===null?_r.removeAttribute(Tr):_r.setAttribute(Tr,""+Ar)):Pr.mustUseProperty?_r[Pr.propertyName]=Ar===null?Pr.type===3?!1:"":Ar:(Tr=Pr.attributeName,Rr=Pr.attributeNamespace,Ar===null?_r.removeAttribute(Tr):(Pr=Pr.type,Ar=Pr===3||Pr===4&&Ar===!0?"":""+Ar,Rr?_r.setAttributeNS(Rr,Tr,Ar):_r.setAttribute(Tr,Ar))))}var ua=aa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,va=Symbol.for("react.element"),wa=Symbol.for("react.portal"),ya=Symbol.for("react.fragment"),za=Symbol.for("react.strict_mode"),Aa=Symbol.for("react.profiler"),Ba=Symbol.for("react.provider"),Ca=Symbol.for("react.context"),Da=Symbol.for("react.forward_ref"),Ea=Symbol.for("react.suspense"),Fa=Symbol.for("react.suspense_list"),Ga=Symbol.for("react.memo"),Ha=Symbol.for("react.lazy"),Ia=Symbol.for("react.offscreen"),Ja=Symbol.iterator;function Ka(_r){return _r===null||typeof _r!="object"?null:(_r=Ja&&_r[Ja]||_r["@@iterator"],typeof _r=="function"?_r:null)}var A$3=Object.assign,La;function Ma(_r){if(La===void 0)try{throw Error()}catch(Ar){var Tr=Ar.stack.trim().match(/\n( *(at )?)/);La=Tr&&Tr[1]||""}return`
`+La+_r}var Na=!1;function Oa(_r,Tr){if(!_r||Na)return"";Na=!0;var Ar=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(Tr)if(Tr=function(){throw Error()},Object.defineProperty(Tr.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Tr,[])}catch(jr){var Rr=jr}Reflect.construct(_r,[],Tr)}else{try{Tr.call()}catch(jr){Rr=jr}_r.call(Tr.prototype)}else{try{throw Error()}catch(jr){Rr=jr}_r()}}catch(jr){if(jr&&Rr&&typeof jr.stack=="string"){for(var Pr=jr.stack.split(`
`),Dr=Rr.stack.split(`
`),Mr=Pr.length-1,Fr=Dr.length-1;1<=Mr&&0<=Fr&&Pr[Mr]!==Dr[Fr];)Fr--;for(;1<=Mr&&0<=Fr;Mr--,Fr--)if(Pr[Mr]!==Dr[Fr]){if(Mr!==1||Fr!==1)do if(Mr--,Fr--,0>Fr||Pr[Mr]!==Dr[Fr]){var zr=`
`+Pr[Mr].replace(" at new "," at ");return _r.displayName&&zr.includes("<anonymous>")&&(zr=zr.replace("<anonymous>",_r.displayName)),zr}while(1<=Mr&&0<=Fr);break}}}finally{Na=!1,Error.prepareStackTrace=Ar}return(_r=_r?_r.displayName||_r.name:"")?Ma(_r):""}function Pa(_r){switch(_r.tag){case 5:return Ma(_r.type);case 16:return Ma("Lazy");case 13:return Ma("Suspense");case 19:return Ma("SuspenseList");case 0:case 2:case 15:return _r=Oa(_r.type,!1),_r;case 11:return _r=Oa(_r.type.render,!1),_r;case 1:return _r=Oa(_r.type,!0),_r;default:return""}}function Qa(_r){if(_r==null)return null;if(typeof _r=="function")return _r.displayName||_r.name||null;if(typeof _r=="string")return _r;switch(_r){case ya:return"Fragment";case wa:return"Portal";case Aa:return"Profiler";case za:return"StrictMode";case Ea:return"Suspense";case Fa:return"SuspenseList"}if(typeof _r=="object")switch(_r.$$typeof){case Ca:return(_r.displayName||"Context")+".Consumer";case Ba:return(_r._context.displayName||"Context")+".Provider";case Da:var Tr=_r.render;return _r=_r.displayName,_r||(_r=Tr.displayName||Tr.name||"",_r=_r!==""?"ForwardRef("+_r+")":"ForwardRef"),_r;case Ga:return Tr=_r.displayName||null,Tr!==null?Tr:Qa(_r.type)||"Memo";case Ha:Tr=_r._payload,_r=_r._init;try{return Qa(_r(Tr))}catch{}}return null}function Ra(_r){var Tr=_r.type;switch(_r.tag){case 24:return"Cache";case 9:return(Tr.displayName||"Context")+".Consumer";case 10:return(Tr._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return _r=Tr.render,_r=_r.displayName||_r.name||"",Tr.displayName||(_r!==""?"ForwardRef("+_r+")":"ForwardRef");case 7:return"Fragment";case 5:return Tr;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Qa(Tr);case 8:return Tr===za?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof Tr=="function")return Tr.displayName||Tr.name||null;if(typeof Tr=="string")return Tr}return null}function Sa(_r){switch(typeof _r){case"boolean":case"number":case"string":case"undefined":return _r;case"object":return _r;default:return""}}function Ta(_r){var Tr=_r.type;return(_r=_r.nodeName)&&_r.toLowerCase()==="input"&&(Tr==="checkbox"||Tr==="radio")}function Ua(_r){var Tr=Ta(_r)?"checked":"value",Ar=Object.getOwnPropertyDescriptor(_r.constructor.prototype,Tr),Rr=""+_r[Tr];if(!_r.hasOwnProperty(Tr)&&typeof Ar<"u"&&typeof Ar.get=="function"&&typeof Ar.set=="function"){var Pr=Ar.get,Dr=Ar.set;return Object.defineProperty(_r,Tr,{configurable:!0,get:function(){return Pr.call(this)},set:function(Mr){Rr=""+Mr,Dr.call(this,Mr)}}),Object.defineProperty(_r,Tr,{enumerable:Ar.enumerable}),{getValue:function(){return Rr},setValue:function(Mr){Rr=""+Mr},stopTracking:function(){_r._valueTracker=null,delete _r[Tr]}}}}function Va(_r){_r._valueTracker||(_r._valueTracker=Ua(_r))}function Wa(_r){if(!_r)return!1;var Tr=_r._valueTracker;if(!Tr)return!0;var Ar=Tr.getValue(),Rr="";return _r&&(Rr=Ta(_r)?_r.checked?"true":"false":_r.value),_r=Rr,_r!==Ar?(Tr.setValue(_r),!0):!1}function Xa(_r){if(_r=_r||(typeof document<"u"?document:void 0),typeof _r>"u")return null;try{return _r.activeElement||_r.body}catch{return _r.body}}function Ya(_r,Tr){var Ar=Tr.checked;return A$3({},Tr,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:Ar??_r._wrapperState.initialChecked})}function Za(_r,Tr){var Ar=Tr.defaultValue==null?"":Tr.defaultValue,Rr=Tr.checked!=null?Tr.checked:Tr.defaultChecked;Ar=Sa(Tr.value!=null?Tr.value:Ar),_r._wrapperState={initialChecked:Rr,initialValue:Ar,controlled:Tr.type==="checkbox"||Tr.type==="radio"?Tr.checked!=null:Tr.value!=null}}function ab(_r,Tr){Tr=Tr.checked,Tr!=null&&ta(_r,"checked",Tr,!1)}function bb(_r,Tr){ab(_r,Tr);var Ar=Sa(Tr.value),Rr=Tr.type;if(Ar!=null)Rr==="number"?(Ar===0&&_r.value===""||_r.value!=Ar)&&(_r.value=""+Ar):_r.value!==""+Ar&&(_r.value=""+Ar);else if(Rr==="submit"||Rr==="reset"){_r.removeAttribute("value");return}Tr.hasOwnProperty("value")?cb(_r,Tr.type,Ar):Tr.hasOwnProperty("defaultValue")&&cb(_r,Tr.type,Sa(Tr.defaultValue)),Tr.checked==null&&Tr.defaultChecked!=null&&(_r.defaultChecked=!!Tr.defaultChecked)}function db(_r,Tr,Ar){if(Tr.hasOwnProperty("value")||Tr.hasOwnProperty("defaultValue")){var Rr=Tr.type;if(!(Rr!=="submit"&&Rr!=="reset"||Tr.value!==void 0&&Tr.value!==null))return;Tr=""+_r._wrapperState.initialValue,Ar||Tr===_r.value||(_r.value=Tr),_r.defaultValue=Tr}Ar=_r.name,Ar!==""&&(_r.name=""),_r.defaultChecked=!!_r._wrapperState.initialChecked,Ar!==""&&(_r.name=Ar)}function cb(_r,Tr,Ar){(Tr!=="number"||Xa(_r.ownerDocument)!==_r)&&(Ar==null?_r.defaultValue=""+_r._wrapperState.initialValue:_r.defaultValue!==""+Ar&&(_r.defaultValue=""+Ar))}var eb=Array.isArray;function fb(_r,Tr,Ar,Rr){if(_r=_r.options,Tr){Tr={};for(var Pr=0;Pr<Ar.length;Pr++)Tr["$"+Ar[Pr]]=!0;for(Ar=0;Ar<_r.length;Ar++)Pr=Tr.hasOwnProperty("$"+_r[Ar].value),_r[Ar].selected!==Pr&&(_r[Ar].selected=Pr),Pr&&Rr&&(_r[Ar].defaultSelected=!0)}else{for(Ar=""+Sa(Ar),Tr=null,Pr=0;Pr<_r.length;Pr++){if(_r[Pr].value===Ar){_r[Pr].selected=!0,Rr&&(_r[Pr].defaultSelected=!0);return}Tr!==null||_r[Pr].disabled||(Tr=_r[Pr])}Tr!==null&&(Tr.selected=!0)}}function gb(_r,Tr){if(Tr.dangerouslySetInnerHTML!=null)throw Error(p$3(91));return A$3({},Tr,{value:void 0,defaultValue:void 0,children:""+_r._wrapperState.initialValue})}function hb(_r,Tr){var Ar=Tr.value;if(Ar==null){if(Ar=Tr.children,Tr=Tr.defaultValue,Ar!=null){if(Tr!=null)throw Error(p$3(92));if(eb(Ar)){if(1<Ar.length)throw Error(p$3(93));Ar=Ar[0]}Tr=Ar}Tr==null&&(Tr=""),Ar=Tr}_r._wrapperState={initialValue:Sa(Ar)}}function ib(_r,Tr){var Ar=Sa(Tr.value),Rr=Sa(Tr.defaultValue);Ar!=null&&(Ar=""+Ar,Ar!==_r.value&&(_r.value=Ar),Tr.defaultValue==null&&_r.defaultValue!==Ar&&(_r.defaultValue=Ar)),Rr!=null&&(_r.defaultValue=""+Rr)}function jb(_r){var Tr=_r.textContent;Tr===_r._wrapperState.initialValue&&Tr!==""&&Tr!==null&&(_r.value=Tr)}function kb(_r){switch(_r){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lb(_r,Tr){return _r==null||_r==="http://www.w3.org/1999/xhtml"?kb(Tr):_r==="http://www.w3.org/2000/svg"&&Tr==="foreignObject"?"http://www.w3.org/1999/xhtml":_r}var mb,nb=function(_r){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(Tr,Ar,Rr,Pr){MSApp.execUnsafeLocalFunction(function(){return _r(Tr,Ar,Rr,Pr)})}:_r}(function(_r,Tr){if(_r.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in _r)_r.innerHTML=Tr;else{for(mb=mb||document.createElement("div"),mb.innerHTML="<svg>"+Tr.valueOf().toString()+"</svg>",Tr=mb.firstChild;_r.firstChild;)_r.removeChild(_r.firstChild);for(;Tr.firstChild;)_r.appendChild(Tr.firstChild)}});function ob(_r,Tr){if(Tr){var Ar=_r.firstChild;if(Ar&&Ar===_r.lastChild&&Ar.nodeType===3){Ar.nodeValue=Tr;return}}_r.textContent=Tr}var pb={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},qb=["Webkit","ms","Moz","O"];Object.keys(pb).forEach(function(_r){qb.forEach(function(Tr){Tr=Tr+_r.charAt(0).toUpperCase()+_r.substring(1),pb[Tr]=pb[_r]})});function rb(_r,Tr,Ar){return Tr==null||typeof Tr=="boolean"||Tr===""?"":Ar||typeof Tr!="number"||Tr===0||pb.hasOwnProperty(_r)&&pb[_r]?(""+Tr).trim():Tr+"px"}function sb(_r,Tr){_r=_r.style;for(var Ar in Tr)if(Tr.hasOwnProperty(Ar)){var Rr=Ar.indexOf("--")===0,Pr=rb(Ar,Tr[Ar],Rr);Ar==="float"&&(Ar="cssFloat"),Rr?_r.setProperty(Ar,Pr):_r[Ar]=Pr}}var tb=A$3({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ub(_r,Tr){if(Tr){if(tb[_r]&&(Tr.children!=null||Tr.dangerouslySetInnerHTML!=null))throw Error(p$3(137,_r));if(Tr.dangerouslySetInnerHTML!=null){if(Tr.children!=null)throw Error(p$3(60));if(typeof Tr.dangerouslySetInnerHTML!="object"||!("__html"in Tr.dangerouslySetInnerHTML))throw Error(p$3(61))}if(Tr.style!=null&&typeof Tr.style!="object")throw Error(p$3(62))}}function vb(_r,Tr){if(_r.indexOf("-")===-1)return typeof Tr.is=="string";switch(_r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wb=null;function xb(_r){return _r=_r.target||_r.srcElement||window,_r.correspondingUseElement&&(_r=_r.correspondingUseElement),_r.nodeType===3?_r.parentNode:_r}var yb=null,zb=null,Ab=null;function Bb(_r){if(_r=Cb(_r)){if(typeof yb!="function")throw Error(p$3(280));var Tr=_r.stateNode;Tr&&(Tr=Db(Tr),yb(_r.stateNode,_r.type,Tr))}}function Eb(_r){zb?Ab?Ab.push(_r):Ab=[_r]:zb=_r}function Fb(){if(zb){var _r=zb,Tr=Ab;if(Ab=zb=null,Bb(_r),Tr)for(_r=0;_r<Tr.length;_r++)Bb(Tr[_r])}}function Gb(_r,Tr){return _r(Tr)}function Hb(){}var Ib=!1;function Jb(_r,Tr,Ar){if(Ib)return _r(Tr,Ar);Ib=!0;try{return Gb(_r,Tr,Ar)}finally{Ib=!1,(zb!==null||Ab!==null)&&(Hb(),Fb())}}function Kb(_r,Tr){var Ar=_r.stateNode;if(Ar===null)return null;var Rr=Db(Ar);if(Rr===null)return null;Ar=Rr[Tr];e:switch(Tr){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(Rr=!Rr.disabled)||(_r=_r.type,Rr=!(_r==="button"||_r==="input"||_r==="select"||_r==="textarea")),_r=!Rr;break e;default:_r=!1}if(_r)return null;if(Ar&&typeof Ar!="function")throw Error(p$3(231,Tr,typeof Ar));return Ar}var Lb=!1;if(ia)try{var Mb={};Object.defineProperty(Mb,"passive",{get:function(){Lb=!0}}),window.addEventListener("test",Mb,Mb),window.removeEventListener("test",Mb,Mb)}catch{Lb=!1}function Nb(_r,Tr,Ar,Rr,Pr,Dr,Mr,Fr,zr){var jr=Array.prototype.slice.call(arguments,3);try{Tr.apply(Ar,jr)}catch(Gr){this.onError(Gr)}}var Ob=!1,Pb=null,Qb=!1,Rb=null,Sb={onError:function(_r){Ob=!0,Pb=_r}};function Tb(_r,Tr,Ar,Rr,Pr,Dr,Mr,Fr,zr){Ob=!1,Pb=null,Nb.apply(Sb,arguments)}function Ub(_r,Tr,Ar,Rr,Pr,Dr,Mr,Fr,zr){if(Tb.apply(this,arguments),Ob){if(Ob){var jr=Pb;Ob=!1,Pb=null}else throw Error(p$3(198));Qb||(Qb=!0,Rb=jr)}}function Vb(_r){var Tr=_r,Ar=_r;if(_r.alternate)for(;Tr.return;)Tr=Tr.return;else{_r=Tr;do Tr=_r,Tr.flags&4098&&(Ar=Tr.return),_r=Tr.return;while(_r)}return Tr.tag===3?Ar:null}function Wb(_r){if(_r.tag===13){var Tr=_r.memoizedState;if(Tr===null&&(_r=_r.alternate,_r!==null&&(Tr=_r.memoizedState)),Tr!==null)return Tr.dehydrated}return null}function Xb(_r){if(Vb(_r)!==_r)throw Error(p$3(188))}function Yb(_r){var Tr=_r.alternate;if(!Tr){if(Tr=Vb(_r),Tr===null)throw Error(p$3(188));return Tr!==_r?null:_r}for(var Ar=_r,Rr=Tr;;){var Pr=Ar.return;if(Pr===null)break;var Dr=Pr.alternate;if(Dr===null){if(Rr=Pr.return,Rr!==null){Ar=Rr;continue}break}if(Pr.child===Dr.child){for(Dr=Pr.child;Dr;){if(Dr===Ar)return Xb(Pr),_r;if(Dr===Rr)return Xb(Pr),Tr;Dr=Dr.sibling}throw Error(p$3(188))}if(Ar.return!==Rr.return)Ar=Pr,Rr=Dr;else{for(var Mr=!1,Fr=Pr.child;Fr;){if(Fr===Ar){Mr=!0,Ar=Pr,Rr=Dr;break}if(Fr===Rr){Mr=!0,Rr=Pr,Ar=Dr;break}Fr=Fr.sibling}if(!Mr){for(Fr=Dr.child;Fr;){if(Fr===Ar){Mr=!0,Ar=Dr,Rr=Pr;break}if(Fr===Rr){Mr=!0,Rr=Dr,Ar=Pr;break}Fr=Fr.sibling}if(!Mr)throw Error(p$3(189))}}if(Ar.alternate!==Rr)throw Error(p$3(190))}if(Ar.tag!==3)throw Error(p$3(188));return Ar.stateNode.current===Ar?_r:Tr}function Zb(_r){return _r=Yb(_r),_r!==null?$b(_r):null}function $b(_r){if(_r.tag===5||_r.tag===6)return _r;for(_r=_r.child;_r!==null;){var Tr=$b(_r);if(Tr!==null)return Tr;_r=_r.sibling}return null}var ac=ca.unstable_scheduleCallback,bc=ca.unstable_cancelCallback,cc=ca.unstable_shouldYield,dc=ca.unstable_requestPaint,B$3=ca.unstable_now,ec=ca.unstable_getCurrentPriorityLevel,fc=ca.unstable_ImmediatePriority,gc=ca.unstable_UserBlockingPriority,hc=ca.unstable_NormalPriority,ic=ca.unstable_LowPriority,jc=ca.unstable_IdlePriority,kc=null,lc=null;function mc(_r){if(lc&&typeof lc.onCommitFiberRoot=="function")try{lc.onCommitFiberRoot(kc,_r,void 0,(_r.current.flags&128)===128)}catch{}}var oc=Math.clz32?Math.clz32:nc,pc=Math.log,qc=Math.LN2;function nc(_r){return _r>>>=0,_r===0?32:31-(pc(_r)/qc|0)|0}var rc=64,sc=4194304;function tc(_r){switch(_r&-_r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return _r&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return _r&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return _r}}function uc(_r,Tr){var Ar=_r.pendingLanes;if(Ar===0)return 0;var Rr=0,Pr=_r.suspendedLanes,Dr=_r.pingedLanes,Mr=Ar&268435455;if(Mr!==0){var Fr=Mr&~Pr;Fr!==0?Rr=tc(Fr):(Dr&=Mr,Dr!==0&&(Rr=tc(Dr)))}else Mr=Ar&~Pr,Mr!==0?Rr=tc(Mr):Dr!==0&&(Rr=tc(Dr));if(Rr===0)return 0;if(Tr!==0&&Tr!==Rr&&!(Tr&Pr)&&(Pr=Rr&-Rr,Dr=Tr&-Tr,Pr>=Dr||Pr===16&&(Dr&4194240)!==0))return Tr;if(Rr&4&&(Rr|=Ar&16),Tr=_r.entangledLanes,Tr!==0)for(_r=_r.entanglements,Tr&=Rr;0<Tr;)Ar=31-oc(Tr),Pr=1<<Ar,Rr|=_r[Ar],Tr&=~Pr;return Rr}function vc(_r,Tr){switch(_r){case 1:case 2:case 4:return Tr+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return Tr+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function wc(_r,Tr){for(var Ar=_r.suspendedLanes,Rr=_r.pingedLanes,Pr=_r.expirationTimes,Dr=_r.pendingLanes;0<Dr;){var Mr=31-oc(Dr),Fr=1<<Mr,zr=Pr[Mr];zr===-1?(!(Fr&Ar)||Fr&Rr)&&(Pr[Mr]=vc(Fr,Tr)):zr<=Tr&&(_r.expiredLanes|=Fr),Dr&=~Fr}}function xc(_r){return _r=_r.pendingLanes&-1073741825,_r!==0?_r:_r&1073741824?1073741824:0}function yc(){var _r=rc;return rc<<=1,!(rc&4194240)&&(rc=64),_r}function zc(_r){for(var Tr=[],Ar=0;31>Ar;Ar++)Tr.push(_r);return Tr}function Ac(_r,Tr,Ar){_r.pendingLanes|=Tr,Tr!==536870912&&(_r.suspendedLanes=0,_r.pingedLanes=0),_r=_r.eventTimes,Tr=31-oc(Tr),_r[Tr]=Ar}function Bc(_r,Tr){var Ar=_r.pendingLanes&~Tr;_r.pendingLanes=Tr,_r.suspendedLanes=0,_r.pingedLanes=0,_r.expiredLanes&=Tr,_r.mutableReadLanes&=Tr,_r.entangledLanes&=Tr,Tr=_r.entanglements;var Rr=_r.eventTimes;for(_r=_r.expirationTimes;0<Ar;){var Pr=31-oc(Ar),Dr=1<<Pr;Tr[Pr]=0,Rr[Pr]=-1,_r[Pr]=-1,Ar&=~Dr}}function Cc(_r,Tr){var Ar=_r.entangledLanes|=Tr;for(_r=_r.entanglements;Ar;){var Rr=31-oc(Ar),Pr=1<<Rr;Pr&Tr|_r[Rr]&Tr&&(_r[Rr]|=Tr),Ar&=~Pr}}var C$2=0;function Dc(_r){return _r&=-_r,1<_r?4<_r?_r&268435455?16:536870912:4:1}var Ec,Fc,Gc,Hc,Ic,Jc=!1,Kc=[],Lc=null,Mc=null,Nc=null,Oc=new Map,Pc=new Map,Qc=[],Rc="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Sc(_r,Tr){switch(_r){case"focusin":case"focusout":Lc=null;break;case"dragenter":case"dragleave":Mc=null;break;case"mouseover":case"mouseout":Nc=null;break;case"pointerover":case"pointerout":Oc.delete(Tr.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pc.delete(Tr.pointerId)}}function Tc(_r,Tr,Ar,Rr,Pr,Dr){return _r===null||_r.nativeEvent!==Dr?(_r={blockedOn:Tr,domEventName:Ar,eventSystemFlags:Rr,nativeEvent:Dr,targetContainers:[Pr]},Tr!==null&&(Tr=Cb(Tr),Tr!==null&&Fc(Tr)),_r):(_r.eventSystemFlags|=Rr,Tr=_r.targetContainers,Pr!==null&&Tr.indexOf(Pr)===-1&&Tr.push(Pr),_r)}function Uc(_r,Tr,Ar,Rr,Pr){switch(Tr){case"focusin":return Lc=Tc(Lc,_r,Tr,Ar,Rr,Pr),!0;case"dragenter":return Mc=Tc(Mc,_r,Tr,Ar,Rr,Pr),!0;case"mouseover":return Nc=Tc(Nc,_r,Tr,Ar,Rr,Pr),!0;case"pointerover":var Dr=Pr.pointerId;return Oc.set(Dr,Tc(Oc.get(Dr)||null,_r,Tr,Ar,Rr,Pr)),!0;case"gotpointercapture":return Dr=Pr.pointerId,Pc.set(Dr,Tc(Pc.get(Dr)||null,_r,Tr,Ar,Rr,Pr)),!0}return!1}function Vc(_r){var Tr=Wc(_r.target);if(Tr!==null){var Ar=Vb(Tr);if(Ar!==null){if(Tr=Ar.tag,Tr===13){if(Tr=Wb(Ar),Tr!==null){_r.blockedOn=Tr,Ic(_r.priority,function(){Gc(Ar)});return}}else if(Tr===3&&Ar.stateNode.current.memoizedState.isDehydrated){_r.blockedOn=Ar.tag===3?Ar.stateNode.containerInfo:null;return}}}_r.blockedOn=null}function Xc(_r){if(_r.blockedOn!==null)return!1;for(var Tr=_r.targetContainers;0<Tr.length;){var Ar=Yc(_r.domEventName,_r.eventSystemFlags,Tr[0],_r.nativeEvent);if(Ar===null){Ar=_r.nativeEvent;var Rr=new Ar.constructor(Ar.type,Ar);wb=Rr,Ar.target.dispatchEvent(Rr),wb=null}else return Tr=Cb(Ar),Tr!==null&&Fc(Tr),_r.blockedOn=Ar,!1;Tr.shift()}return!0}function Zc(_r,Tr,Ar){Xc(_r)&&Ar.delete(Tr)}function $c(){Jc=!1,Lc!==null&&Xc(Lc)&&(Lc=null),Mc!==null&&Xc(Mc)&&(Mc=null),Nc!==null&&Xc(Nc)&&(Nc=null),Oc.forEach(Zc),Pc.forEach(Zc)}function ad(_r,Tr){_r.blockedOn===Tr&&(_r.blockedOn=null,Jc||(Jc=!0,ca.unstable_scheduleCallback(ca.unstable_NormalPriority,$c)))}function bd(_r){function Tr(Pr){return ad(Pr,_r)}if(0<Kc.length){ad(Kc[0],_r);for(var Ar=1;Ar<Kc.length;Ar++){var Rr=Kc[Ar];Rr.blockedOn===_r&&(Rr.blockedOn=null)}}for(Lc!==null&&ad(Lc,_r),Mc!==null&&ad(Mc,_r),Nc!==null&&ad(Nc,_r),Oc.forEach(Tr),Pc.forEach(Tr),Ar=0;Ar<Qc.length;Ar++)Rr=Qc[Ar],Rr.blockedOn===_r&&(Rr.blockedOn=null);for(;0<Qc.length&&(Ar=Qc[0],Ar.blockedOn===null);)Vc(Ar),Ar.blockedOn===null&&Qc.shift()}var cd=ua.ReactCurrentBatchConfig,dd=!0;function ed(_r,Tr,Ar,Rr){var Pr=C$2,Dr=cd.transition;cd.transition=null;try{C$2=1,fd(_r,Tr,Ar,Rr)}finally{C$2=Pr,cd.transition=Dr}}function gd(_r,Tr,Ar,Rr){var Pr=C$2,Dr=cd.transition;cd.transition=null;try{C$2=4,fd(_r,Tr,Ar,Rr)}finally{C$2=Pr,cd.transition=Dr}}function fd(_r,Tr,Ar,Rr){if(dd){var Pr=Yc(_r,Tr,Ar,Rr);if(Pr===null)hd(_r,Tr,Rr,id,Ar),Sc(_r,Rr);else if(Uc(Pr,_r,Tr,Ar,Rr))Rr.stopPropagation();else if(Sc(_r,Rr),Tr&4&&-1<Rc.indexOf(_r)){for(;Pr!==null;){var Dr=Cb(Pr);if(Dr!==null&&Ec(Dr),Dr=Yc(_r,Tr,Ar,Rr),Dr===null&&hd(_r,Tr,Rr,id,Ar),Dr===Pr)break;Pr=Dr}Pr!==null&&Rr.stopPropagation()}else hd(_r,Tr,Rr,null,Ar)}}var id=null;function Yc(_r,Tr,Ar,Rr){if(id=null,_r=xb(Rr),_r=Wc(_r),_r!==null)if(Tr=Vb(_r),Tr===null)_r=null;else if(Ar=Tr.tag,Ar===13){if(_r=Wb(Tr),_r!==null)return _r;_r=null}else if(Ar===3){if(Tr.stateNode.current.memoizedState.isDehydrated)return Tr.tag===3?Tr.stateNode.containerInfo:null;_r=null}else Tr!==_r&&(_r=null);return id=_r,null}function jd(_r){switch(_r){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ec()){case fc:return 1;case gc:return 4;case hc:case ic:return 16;case jc:return 536870912;default:return 16}default:return 16}}var kd=null,ld=null,md=null;function nd(){if(md)return md;var _r,Tr=ld,Ar=Tr.length,Rr,Pr="value"in kd?kd.value:kd.textContent,Dr=Pr.length;for(_r=0;_r<Ar&&Tr[_r]===Pr[_r];_r++);var Mr=Ar-_r;for(Rr=1;Rr<=Mr&&Tr[Ar-Rr]===Pr[Dr-Rr];Rr++);return md=Pr.slice(_r,1<Rr?1-Rr:void 0)}function od(_r){var Tr=_r.keyCode;return"charCode"in _r?(_r=_r.charCode,_r===0&&Tr===13&&(_r=13)):_r=Tr,_r===10&&(_r=13),32<=_r||_r===13?_r:0}function pd(){return!0}function qd(){return!1}function rd(_r){function Tr(Ar,Rr,Pr,Dr,Mr){this._reactName=Ar,this._targetInst=Pr,this.type=Rr,this.nativeEvent=Dr,this.target=Mr,this.currentTarget=null;for(var Fr in _r)_r.hasOwnProperty(Fr)&&(Ar=_r[Fr],this[Fr]=Ar?Ar(Dr):Dr[Fr]);return this.isDefaultPrevented=(Dr.defaultPrevented!=null?Dr.defaultPrevented:Dr.returnValue===!1)?pd:qd,this.isPropagationStopped=qd,this}return A$3(Tr.prototype,{preventDefault:function(){this.defaultPrevented=!0;var Ar=this.nativeEvent;Ar&&(Ar.preventDefault?Ar.preventDefault():typeof Ar.returnValue!="unknown"&&(Ar.returnValue=!1),this.isDefaultPrevented=pd)},stopPropagation:function(){var Ar=this.nativeEvent;Ar&&(Ar.stopPropagation?Ar.stopPropagation():typeof Ar.cancelBubble!="unknown"&&(Ar.cancelBubble=!0),this.isPropagationStopped=pd)},persist:function(){},isPersistent:pd}),Tr}var sd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(_r){return _r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},td=rd(sd),ud=A$3({},sd,{view:0,detail:0}),vd=rd(ud),wd,xd,yd,Ad=A$3({},ud,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zd,button:0,buttons:0,relatedTarget:function(_r){return _r.relatedTarget===void 0?_r.fromElement===_r.srcElement?_r.toElement:_r.fromElement:_r.relatedTarget},movementX:function(_r){return"movementX"in _r?_r.movementX:(_r!==yd&&(yd&&_r.type==="mousemove"?(wd=_r.screenX-yd.screenX,xd=_r.screenY-yd.screenY):xd=wd=0,yd=_r),wd)},movementY:function(_r){return"movementY"in _r?_r.movementY:xd}}),Bd=rd(Ad),Cd=A$3({},Ad,{dataTransfer:0}),Dd=rd(Cd),Ed=A$3({},ud,{relatedTarget:0}),Fd=rd(Ed),Gd=A$3({},sd,{animationName:0,elapsedTime:0,pseudoElement:0}),Hd=rd(Gd),Id=A$3({},sd,{clipboardData:function(_r){return"clipboardData"in _r?_r.clipboardData:window.clipboardData}}),Jd=rd(Id),Kd=A$3({},sd,{data:0}),Ld=rd(Kd),Md={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Nd={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Od={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Pd(_r){var Tr=this.nativeEvent;return Tr.getModifierState?Tr.getModifierState(_r):(_r=Od[_r])?!!Tr[_r]:!1}function zd(){return Pd}var Qd=A$3({},ud,{key:function(_r){if(_r.key){var Tr=Md[_r.key]||_r.key;if(Tr!=="Unidentified")return Tr}return _r.type==="keypress"?(_r=od(_r),_r===13?"Enter":String.fromCharCode(_r)):_r.type==="keydown"||_r.type==="keyup"?Nd[_r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zd,charCode:function(_r){return _r.type==="keypress"?od(_r):0},keyCode:function(_r){return _r.type==="keydown"||_r.type==="keyup"?_r.keyCode:0},which:function(_r){return _r.type==="keypress"?od(_r):_r.type==="keydown"||_r.type==="keyup"?_r.keyCode:0}}),Rd=rd(Qd),Sd=A$3({},Ad,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Td=rd(Sd),Ud=A$3({},ud,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zd}),Vd=rd(Ud),Wd=A$3({},sd,{propertyName:0,elapsedTime:0,pseudoElement:0}),Xd=rd(Wd),Yd=A$3({},Ad,{deltaX:function(_r){return"deltaX"in _r?_r.deltaX:"wheelDeltaX"in _r?-_r.wheelDeltaX:0},deltaY:function(_r){return"deltaY"in _r?_r.deltaY:"wheelDeltaY"in _r?-_r.wheelDeltaY:"wheelDelta"in _r?-_r.wheelDelta:0},deltaZ:0,deltaMode:0}),Zd=rd(Yd),$d=[9,13,27,32],ae$2=ia&&"CompositionEvent"in window,be$2=null;ia&&"documentMode"in document&&(be$2=document.documentMode);var ce$2=ia&&"TextEvent"in window&&!be$2,de$1=ia&&(!ae$2||be$2&&8<be$2&&11>=be$2),ee$3=String.fromCharCode(32),fe$2=!1;function ge$2(_r,Tr){switch(_r){case"keyup":return $d.indexOf(Tr.keyCode)!==-1;case"keydown":return Tr.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function he$2(_r){return _r=_r.detail,typeof _r=="object"&&"data"in _r?_r.data:null}var ie$2=!1;function je$1(_r,Tr){switch(_r){case"compositionend":return he$2(Tr);case"keypress":return Tr.which!==32?null:(fe$2=!0,ee$3);case"textInput":return _r=Tr.data,_r===ee$3&&fe$2?null:_r;default:return null}}function ke$2(_r,Tr){if(ie$2)return _r==="compositionend"||!ae$2&&ge$2(_r,Tr)?(_r=nd(),md=ld=kd=null,ie$2=!1,_r):null;switch(_r){case"paste":return null;case"keypress":if(!(Tr.ctrlKey||Tr.altKey||Tr.metaKey)||Tr.ctrlKey&&Tr.altKey){if(Tr.char&&1<Tr.char.length)return Tr.char;if(Tr.which)return String.fromCharCode(Tr.which)}return null;case"compositionend":return de$1&&Tr.locale!=="ko"?null:Tr.data;default:return null}}var le$2={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function me$1(_r){var Tr=_r&&_r.nodeName&&_r.nodeName.toLowerCase();return Tr==="input"?!!le$2[_r.type]:Tr==="textarea"}function ne$2(_r,Tr,Ar,Rr){Eb(Rr),Tr=oe$2(Tr,"onChange"),0<Tr.length&&(Ar=new td("onChange","change",null,Ar,Rr),_r.push({event:Ar,listeners:Tr}))}var pe$2=null,qe$1=null;function re$3(_r){se$2(_r,0)}function te$3(_r){var Tr=ue$1(_r);if(Wa(Tr))return _r}function ve$2(_r,Tr){if(_r==="change")return Tr}var we$2=!1;if(ia){var xe$2;if(ia){var ye$2="oninput"in document;if(!ye$2){var ze$2=document.createElement("div");ze$2.setAttribute("oninput","return;"),ye$2=typeof ze$2.oninput=="function"}xe$2=ye$2}else xe$2=!1;we$2=xe$2&&(!document.documentMode||9<document.documentMode)}function Ae$2(){pe$2&&(pe$2.detachEvent("onpropertychange",Be$2),qe$1=pe$2=null)}function Be$2(_r){if(_r.propertyName==="value"&&te$3(qe$1)){var Tr=[];ne$2(Tr,qe$1,_r,xb(_r)),Jb(re$3,Tr)}}function Ce$2(_r,Tr,Ar){_r==="focusin"?(Ae$2(),pe$2=Tr,qe$1=Ar,pe$2.attachEvent("onpropertychange",Be$2)):_r==="focusout"&&Ae$2()}function De$1(_r){if(_r==="selectionchange"||_r==="keyup"||_r==="keydown")return te$3(qe$1)}function Ee$2(_r,Tr){if(_r==="click")return te$3(Tr)}function Fe$2(_r,Tr){if(_r==="input"||_r==="change")return te$3(Tr)}function Ge$1(_r,Tr){return _r===Tr&&(_r!==0||1/_r===1/Tr)||_r!==_r&&Tr!==Tr}var He$2=typeof Object.is=="function"?Object.is:Ge$1;function Ie$2(_r,Tr){if(He$2(_r,Tr))return!0;if(typeof _r!="object"||_r===null||typeof Tr!="object"||Tr===null)return!1;var Ar=Object.keys(_r),Rr=Object.keys(Tr);if(Ar.length!==Rr.length)return!1;for(Rr=0;Rr<Ar.length;Rr++){var Pr=Ar[Rr];if(!ja.call(Tr,Pr)||!He$2(_r[Pr],Tr[Pr]))return!1}return!0}function Je$2(_r){for(;_r&&_r.firstChild;)_r=_r.firstChild;return _r}function Ke$1(_r,Tr){var Ar=Je$2(_r);_r=0;for(var Rr;Ar;){if(Ar.nodeType===3){if(Rr=_r+Ar.textContent.length,_r<=Tr&&Rr>=Tr)return{node:Ar,offset:Tr-_r};_r=Rr}e:{for(;Ar;){if(Ar.nextSibling){Ar=Ar.nextSibling;break e}Ar=Ar.parentNode}Ar=void 0}Ar=Je$2(Ar)}}function Le$2(_r,Tr){return _r&&Tr?_r===Tr?!0:_r&&_r.nodeType===3?!1:Tr&&Tr.nodeType===3?Le$2(_r,Tr.parentNode):"contains"in _r?_r.contains(Tr):_r.compareDocumentPosition?!!(_r.compareDocumentPosition(Tr)&16):!1:!1}function Me$2(){for(var _r=window,Tr=Xa();Tr instanceof _r.HTMLIFrameElement;){try{var Ar=typeof Tr.contentWindow.location.href=="string"}catch{Ar=!1}if(Ar)_r=Tr.contentWindow;else break;Tr=Xa(_r.document)}return Tr}function Ne$1(_r){var Tr=_r&&_r.nodeName&&_r.nodeName.toLowerCase();return Tr&&(Tr==="input"&&(_r.type==="text"||_r.type==="search"||_r.type==="tel"||_r.type==="url"||_r.type==="password")||Tr==="textarea"||_r.contentEditable==="true")}function Oe$1(_r){var Tr=Me$2(),Ar=_r.focusedElem,Rr=_r.selectionRange;if(Tr!==Ar&&Ar&&Ar.ownerDocument&&Le$2(Ar.ownerDocument.documentElement,Ar)){if(Rr!==null&&Ne$1(Ar)){if(Tr=Rr.start,_r=Rr.end,_r===void 0&&(_r=Tr),"selectionStart"in Ar)Ar.selectionStart=Tr,Ar.selectionEnd=Math.min(_r,Ar.value.length);else if(_r=(Tr=Ar.ownerDocument||document)&&Tr.defaultView||window,_r.getSelection){_r=_r.getSelection();var Pr=Ar.textContent.length,Dr=Math.min(Rr.start,Pr);Rr=Rr.end===void 0?Dr:Math.min(Rr.end,Pr),!_r.extend&&Dr>Rr&&(Pr=Rr,Rr=Dr,Dr=Pr),Pr=Ke$1(Ar,Dr);var Mr=Ke$1(Ar,Rr);Pr&&Mr&&(_r.rangeCount!==1||_r.anchorNode!==Pr.node||_r.anchorOffset!==Pr.offset||_r.focusNode!==Mr.node||_r.focusOffset!==Mr.offset)&&(Tr=Tr.createRange(),Tr.setStart(Pr.node,Pr.offset),_r.removeAllRanges(),Dr>Rr?(_r.addRange(Tr),_r.extend(Mr.node,Mr.offset)):(Tr.setEnd(Mr.node,Mr.offset),_r.addRange(Tr)))}}for(Tr=[],_r=Ar;_r=_r.parentNode;)_r.nodeType===1&&Tr.push({element:_r,left:_r.scrollLeft,top:_r.scrollTop});for(typeof Ar.focus=="function"&&Ar.focus(),Ar=0;Ar<Tr.length;Ar++)_r=Tr[Ar],_r.element.scrollLeft=_r.left,_r.element.scrollTop=_r.top}}var Pe$2=ia&&"documentMode"in document&&11>=document.documentMode,Qe$2=null,Re$2=null,Se$2=null,Te$2=!1;function Ue$1(_r,Tr,Ar){var Rr=Ar.window===Ar?Ar.document:Ar.nodeType===9?Ar:Ar.ownerDocument;Te$2||Qe$2==null||Qe$2!==Xa(Rr)||(Rr=Qe$2,"selectionStart"in Rr&&Ne$1(Rr)?Rr={start:Rr.selectionStart,end:Rr.selectionEnd}:(Rr=(Rr.ownerDocument&&Rr.ownerDocument.defaultView||window).getSelection(),Rr={anchorNode:Rr.anchorNode,anchorOffset:Rr.anchorOffset,focusNode:Rr.focusNode,focusOffset:Rr.focusOffset}),Se$2&&Ie$2(Se$2,Rr)||(Se$2=Rr,Rr=oe$2(Re$2,"onSelect"),0<Rr.length&&(Tr=new td("onSelect","select",null,Tr,Ar),_r.push({event:Tr,listeners:Rr}),Tr.target=Qe$2)))}function Ve$2(_r,Tr){var Ar={};return Ar[_r.toLowerCase()]=Tr.toLowerCase(),Ar["Webkit"+_r]="webkit"+Tr,Ar["Moz"+_r]="moz"+Tr,Ar}var We$1={animationend:Ve$2("Animation","AnimationEnd"),animationiteration:Ve$2("Animation","AnimationIteration"),animationstart:Ve$2("Animation","AnimationStart"),transitionend:Ve$2("Transition","TransitionEnd")},Xe$1={},Ye$2={};ia&&(Ye$2=document.createElement("div").style,"AnimationEvent"in window||(delete We$1.animationend.animation,delete We$1.animationiteration.animation,delete We$1.animationstart.animation),"TransitionEvent"in window||delete We$1.transitionend.transition);function Ze$1(_r){if(Xe$1[_r])return Xe$1[_r];if(!We$1[_r])return _r;var Tr=We$1[_r],Ar;for(Ar in Tr)if(Tr.hasOwnProperty(Ar)&&Ar in Ye$2)return Xe$1[_r]=Tr[Ar];return _r}var $e$2=Ze$1("animationend"),af=Ze$1("animationiteration"),bf=Ze$1("animationstart"),cf=Ze$1("transitionend"),df=new Map,ef="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ff(_r,Tr){df.set(_r,Tr),fa(Tr,[_r])}for(var gf=0;gf<ef.length;gf++){var hf=ef[gf],jf=hf.toLowerCase(),kf=hf[0].toUpperCase()+hf.slice(1);ff(jf,"on"+kf)}ff($e$2,"onAnimationEnd");ff(af,"onAnimationIteration");ff(bf,"onAnimationStart");ff("dblclick","onDoubleClick");ff("focusin","onFocus");ff("focusout","onBlur");ff(cf,"onTransitionEnd");ha("onMouseEnter",["mouseout","mouseover"]);ha("onMouseLeave",["mouseout","mouseover"]);ha("onPointerEnter",["pointerout","pointerover"]);ha("onPointerLeave",["pointerout","pointerover"]);fa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));fa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));fa("onBeforeInput",["compositionend","keypress","textInput","paste"]);fa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var lf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mf=new Set("cancel close invalid load scroll toggle".split(" ").concat(lf));function nf(_r,Tr,Ar){var Rr=_r.type||"unknown-event";_r.currentTarget=Ar,Ub(Rr,Tr,void 0,_r),_r.currentTarget=null}function se$2(_r,Tr){Tr=(Tr&4)!==0;for(var Ar=0;Ar<_r.length;Ar++){var Rr=_r[Ar],Pr=Rr.event;Rr=Rr.listeners;e:{var Dr=void 0;if(Tr)for(var Mr=Rr.length-1;0<=Mr;Mr--){var Fr=Rr[Mr],zr=Fr.instance,jr=Fr.currentTarget;if(Fr=Fr.listener,zr!==Dr&&Pr.isPropagationStopped())break e;nf(Pr,Fr,jr),Dr=zr}else for(Mr=0;Mr<Rr.length;Mr++){if(Fr=Rr[Mr],zr=Fr.instance,jr=Fr.currentTarget,Fr=Fr.listener,zr!==Dr&&Pr.isPropagationStopped())break e;nf(Pr,Fr,jr),Dr=zr}}}if(Qb)throw _r=Rb,Qb=!1,Rb=null,_r}function D$3(_r,Tr){var Ar=Tr[of];Ar===void 0&&(Ar=Tr[of]=new Set);var Rr=_r+"__bubble";Ar.has(Rr)||(pf(Tr,_r,2,!1),Ar.add(Rr))}function qf(_r,Tr,Ar){var Rr=0;Tr&&(Rr|=4),pf(Ar,_r,Rr,Tr)}var rf="_reactListening"+Math.random().toString(36).slice(2);function sf(_r){if(!_r[rf]){_r[rf]=!0,da.forEach(function(Ar){Ar!=="selectionchange"&&(mf.has(Ar)||qf(Ar,!1,_r),qf(Ar,!0,_r))});var Tr=_r.nodeType===9?_r:_r.ownerDocument;Tr===null||Tr[rf]||(Tr[rf]=!0,qf("selectionchange",!1,Tr))}}function pf(_r,Tr,Ar,Rr){switch(jd(Tr)){case 1:var Pr=ed;break;case 4:Pr=gd;break;default:Pr=fd}Ar=Pr.bind(null,Tr,Ar,_r),Pr=void 0,!Lb||Tr!=="touchstart"&&Tr!=="touchmove"&&Tr!=="wheel"||(Pr=!0),Rr?Pr!==void 0?_r.addEventListener(Tr,Ar,{capture:!0,passive:Pr}):_r.addEventListener(Tr,Ar,!0):Pr!==void 0?_r.addEventListener(Tr,Ar,{passive:Pr}):_r.addEventListener(Tr,Ar,!1)}function hd(_r,Tr,Ar,Rr,Pr){var Dr=Rr;if(!(Tr&1)&&!(Tr&2)&&Rr!==null)e:for(;;){if(Rr===null)return;var Mr=Rr.tag;if(Mr===3||Mr===4){var Fr=Rr.stateNode.containerInfo;if(Fr===Pr||Fr.nodeType===8&&Fr.parentNode===Pr)break;if(Mr===4)for(Mr=Rr.return;Mr!==null;){var zr=Mr.tag;if((zr===3||zr===4)&&(zr=Mr.stateNode.containerInfo,zr===Pr||zr.nodeType===8&&zr.parentNode===Pr))return;Mr=Mr.return}for(;Fr!==null;){if(Mr=Wc(Fr),Mr===null)return;if(zr=Mr.tag,zr===5||zr===6){Rr=Dr=Mr;continue e}Fr=Fr.parentNode}}Rr=Rr.return}Jb(function(){var jr=Dr,Gr=xb(Ar),Nr=[];e:{var Lr=df.get(_r);if(Lr!==void 0){var Ur=td,Vr=_r;switch(_r){case"keypress":if(od(Ar)===0)break e;case"keydown":case"keyup":Ur=Rd;break;case"focusin":Vr="focus",Ur=Fd;break;case"focusout":Vr="blur",Ur=Fd;break;case"beforeblur":case"afterblur":Ur=Fd;break;case"click":if(Ar.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ur=Bd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ur=Dd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ur=Vd;break;case $e$2:case af:case bf:Ur=Hd;break;case cf:Ur=Xd;break;case"scroll":Ur=vd;break;case"wheel":Ur=Zd;break;case"copy":case"cut":case"paste":Ur=Jd;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ur=Td}var Wr=(Tr&4)!==0,qr=!Wr&&_r==="scroll",Kr=Wr?Lr!==null?Lr+"Capture":null:Lr;Wr=[];for(var Xr=jr,Zr;Xr!==null;){Zr=Xr;var _i=Zr.stateNode;if(Zr.tag===5&&_i!==null&&(Zr=_i,Kr!==null&&(_i=Kb(Xr,Kr),_i!=null&&Wr.push(tf(Xr,_i,Zr)))),qr)break;Xr=Xr.return}0<Wr.length&&(Lr=new Ur(Lr,Vr,null,Ar,Gr),Nr.push({event:Lr,listeners:Wr}))}}if(!(Tr&7)){e:{if(Lr=_r==="mouseover"||_r==="pointerover",Ur=_r==="mouseout"||_r==="pointerout",Lr&&Ar!==wb&&(Vr=Ar.relatedTarget||Ar.fromElement)&&(Wc(Vr)||Vr[uf]))break e;if((Ur||Lr)&&(Lr=Gr.window===Gr?Gr:(Lr=Gr.ownerDocument)?Lr.defaultView||Lr.parentWindow:window,Ur?(Vr=Ar.relatedTarget||Ar.toElement,Ur=jr,Vr=Vr?Wc(Vr):null,Vr!==null&&(qr=Vb(Vr),Vr!==qr||Vr.tag!==5&&Vr.tag!==6)&&(Vr=null)):(Ur=null,Vr=jr),Ur!==Vr)){if(Wr=Bd,_i="onMouseLeave",Kr="onMouseEnter",Xr="mouse",(_r==="pointerout"||_r==="pointerover")&&(Wr=Td,_i="onPointerLeave",Kr="onPointerEnter",Xr="pointer"),qr=Ur==null?Lr:ue$1(Ur),Zr=Vr==null?Lr:ue$1(Vr),Lr=new Wr(_i,Xr+"leave",Ur,Ar,Gr),Lr.target=qr,Lr.relatedTarget=Zr,_i=null,Wc(Gr)===jr&&(Wr=new Wr(Kr,Xr+"enter",Vr,Ar,Gr),Wr.target=Zr,Wr.relatedTarget=qr,_i=Wr),qr=_i,Ur&&Vr)t:{for(Wr=Ur,Kr=Vr,Xr=0,Zr=Wr;Zr;Zr=vf(Zr))Xr++;for(Zr=0,_i=Kr;_i;_i=vf(_i))Zr++;for(;0<Xr-Zr;)Wr=vf(Wr),Xr--;for(;0<Zr-Xr;)Kr=vf(Kr),Zr--;for(;Xr--;){if(Wr===Kr||Kr!==null&&Wr===Kr.alternate)break t;Wr=vf(Wr),Kr=vf(Kr)}Wr=null}else Wr=null;Ur!==null&&wf(Nr,Lr,Ur,Wr,!1),Vr!==null&&qr!==null&&wf(Nr,qr,Vr,Wr,!0)}}e:{if(Lr=jr?ue$1(jr):window,Ur=Lr.nodeName&&Lr.nodeName.toLowerCase(),Ur==="select"||Ur==="input"&&Lr.type==="file")var Jr=ve$2;else if(me$1(Lr))if(we$2)Jr=Fe$2;else{Jr=De$1;var es=Ce$2}else(Ur=Lr.nodeName)&&Ur.toLowerCase()==="input"&&(Lr.type==="checkbox"||Lr.type==="radio")&&(Jr=Ee$2);if(Jr&&(Jr=Jr(_r,jr))){ne$2(Nr,Jr,Ar,Gr);break e}es&&es(_r,Lr,jr),_r==="focusout"&&(es=Lr._wrapperState)&&es.controlled&&Lr.type==="number"&&cb(Lr,"number",Lr.value)}switch(es=jr?ue$1(jr):window,_r){case"focusin":(me$1(es)||es.contentEditable==="true")&&(Qe$2=es,Re$2=jr,Se$2=null);break;case"focusout":Se$2=Re$2=Qe$2=null;break;case"mousedown":Te$2=!0;break;case"contextmenu":case"mouseup":case"dragend":Te$2=!1,Ue$1(Nr,Ar,Gr);break;case"selectionchange":if(Pe$2)break;case"keydown":case"keyup":Ue$1(Nr,Ar,Gr)}var ts;if(ae$2)e:{switch(_r){case"compositionstart":var is="onCompositionStart";break e;case"compositionend":is="onCompositionEnd";break e;case"compositionupdate":is="onCompositionUpdate";break e}is=void 0}else ie$2?ge$2(_r,Ar)&&(is="onCompositionEnd"):_r==="keydown"&&Ar.keyCode===229&&(is="onCompositionStart");is&&(de$1&&Ar.locale!=="ko"&&(ie$2||is!=="onCompositionStart"?is==="onCompositionEnd"&&ie$2&&(ts=nd()):(kd=Gr,ld="value"in kd?kd.value:kd.textContent,ie$2=!0)),es=oe$2(jr,is),0<es.length&&(is=new Ld(is,_r,null,Ar,Gr),Nr.push({event:is,listeners:es}),ts?is.data=ts:(ts=he$2(Ar),ts!==null&&(is.data=ts)))),(ts=ce$2?je$1(_r,Ar):ke$2(_r,Ar))&&(jr=oe$2(jr,"onBeforeInput"),0<jr.length&&(Gr=new Ld("onBeforeInput","beforeinput",null,Ar,Gr),Nr.push({event:Gr,listeners:jr}),Gr.data=ts))}se$2(Nr,Tr)})}function tf(_r,Tr,Ar){return{instance:_r,listener:Tr,currentTarget:Ar}}function oe$2(_r,Tr){for(var Ar=Tr+"Capture",Rr=[];_r!==null;){var Pr=_r,Dr=Pr.stateNode;Pr.tag===5&&Dr!==null&&(Pr=Dr,Dr=Kb(_r,Ar),Dr!=null&&Rr.unshift(tf(_r,Dr,Pr)),Dr=Kb(_r,Tr),Dr!=null&&Rr.push(tf(_r,Dr,Pr))),_r=_r.return}return Rr}function vf(_r){if(_r===null)return null;do _r=_r.return;while(_r&&_r.tag!==5);return _r||null}function wf(_r,Tr,Ar,Rr,Pr){for(var Dr=Tr._reactName,Mr=[];Ar!==null&&Ar!==Rr;){var Fr=Ar,zr=Fr.alternate,jr=Fr.stateNode;if(zr!==null&&zr===Rr)break;Fr.tag===5&&jr!==null&&(Fr=jr,Pr?(zr=Kb(Ar,Dr),zr!=null&&Mr.unshift(tf(Ar,zr,Fr))):Pr||(zr=Kb(Ar,Dr),zr!=null&&Mr.push(tf(Ar,zr,Fr)))),Ar=Ar.return}Mr.length!==0&&_r.push({event:Tr,listeners:Mr})}var xf=/\r\n?/g,yf=/\u0000|\uFFFD/g;function zf(_r){return(typeof _r=="string"?_r:""+_r).replace(xf,`
`).replace(yf,"")}function Af(_r,Tr,Ar){if(Tr=zf(Tr),zf(_r)!==Tr&&Ar)throw Error(p$3(425))}function Bf(){}var Cf=null,Df=null;function Ef(_r,Tr){return _r==="textarea"||_r==="noscript"||typeof Tr.children=="string"||typeof Tr.children=="number"||typeof Tr.dangerouslySetInnerHTML=="object"&&Tr.dangerouslySetInnerHTML!==null&&Tr.dangerouslySetInnerHTML.__html!=null}var Ff=typeof setTimeout=="function"?setTimeout:void 0,Gf=typeof clearTimeout=="function"?clearTimeout:void 0,Hf=typeof Promise=="function"?Promise:void 0,Jf=typeof queueMicrotask=="function"?queueMicrotask:typeof Hf<"u"?function(_r){return Hf.resolve(null).then(_r).catch(If)}:Ff;function If(_r){setTimeout(function(){throw _r})}function Kf(_r,Tr){var Ar=Tr,Rr=0;do{var Pr=Ar.nextSibling;if(_r.removeChild(Ar),Pr&&Pr.nodeType===8)if(Ar=Pr.data,Ar==="/$"){if(Rr===0){_r.removeChild(Pr),bd(Tr);return}Rr--}else Ar!=="$"&&Ar!=="$?"&&Ar!=="$!"||Rr++;Ar=Pr}while(Ar);bd(Tr)}function Lf(_r){for(;_r!=null;_r=_r.nextSibling){var Tr=_r.nodeType;if(Tr===1||Tr===3)break;if(Tr===8){if(Tr=_r.data,Tr==="$"||Tr==="$!"||Tr==="$?")break;if(Tr==="/$")return null}}return _r}function Mf(_r){_r=_r.previousSibling;for(var Tr=0;_r;){if(_r.nodeType===8){var Ar=_r.data;if(Ar==="$"||Ar==="$!"||Ar==="$?"){if(Tr===0)return _r;Tr--}else Ar==="/$"&&Tr++}_r=_r.previousSibling}return null}var Nf=Math.random().toString(36).slice(2),Of="__reactFiber$"+Nf,Pf="__reactProps$"+Nf,uf="__reactContainer$"+Nf,of="__reactEvents$"+Nf,Qf="__reactListeners$"+Nf,Rf="__reactHandles$"+Nf;function Wc(_r){var Tr=_r[Of];if(Tr)return Tr;for(var Ar=_r.parentNode;Ar;){if(Tr=Ar[uf]||Ar[Of]){if(Ar=Tr.alternate,Tr.child!==null||Ar!==null&&Ar.child!==null)for(_r=Mf(_r);_r!==null;){if(Ar=_r[Of])return Ar;_r=Mf(_r)}return Tr}_r=Ar,Ar=_r.parentNode}return null}function Cb(_r){return _r=_r[Of]||_r[uf],!_r||_r.tag!==5&&_r.tag!==6&&_r.tag!==13&&_r.tag!==3?null:_r}function ue$1(_r){if(_r.tag===5||_r.tag===6)return _r.stateNode;throw Error(p$3(33))}function Db(_r){return _r[Pf]||null}var Sf=[],Tf=-1;function Uf(_r){return{current:_r}}function E$3(_r){0>Tf||(_r.current=Sf[Tf],Sf[Tf]=null,Tf--)}function G$4(_r,Tr){Tf++,Sf[Tf]=_r.current,_r.current=Tr}var Vf={},H$3=Uf(Vf),Wf=Uf(!1),Xf=Vf;function Yf(_r,Tr){var Ar=_r.type.contextTypes;if(!Ar)return Vf;var Rr=_r.stateNode;if(Rr&&Rr.__reactInternalMemoizedUnmaskedChildContext===Tr)return Rr.__reactInternalMemoizedMaskedChildContext;var Pr={},Dr;for(Dr in Ar)Pr[Dr]=Tr[Dr];return Rr&&(_r=_r.stateNode,_r.__reactInternalMemoizedUnmaskedChildContext=Tr,_r.__reactInternalMemoizedMaskedChildContext=Pr),Pr}function Zf(_r){return _r=_r.childContextTypes,_r!=null}function $f(){E$3(Wf),E$3(H$3)}function ag(_r,Tr,Ar){if(H$3.current!==Vf)throw Error(p$3(168));G$4(H$3,Tr),G$4(Wf,Ar)}function bg(_r,Tr,Ar){var Rr=_r.stateNode;if(Tr=Tr.childContextTypes,typeof Rr.getChildContext!="function")return Ar;Rr=Rr.getChildContext();for(var Pr in Rr)if(!(Pr in Tr))throw Error(p$3(108,Ra(_r)||"Unknown",Pr));return A$3({},Ar,Rr)}function cg(_r){return _r=(_r=_r.stateNode)&&_r.__reactInternalMemoizedMergedChildContext||Vf,Xf=H$3.current,G$4(H$3,_r),G$4(Wf,Wf.current),!0}function dg(_r,Tr,Ar){var Rr=_r.stateNode;if(!Rr)throw Error(p$3(169));Ar?(_r=bg(_r,Tr,Xf),Rr.__reactInternalMemoizedMergedChildContext=_r,E$3(Wf),E$3(H$3),G$4(H$3,_r)):E$3(Wf),G$4(Wf,Ar)}var eg=null,fg=!1,gg=!1;function hg(_r){eg===null?eg=[_r]:eg.push(_r)}function ig(_r){fg=!0,hg(_r)}function jg(){if(!gg&&eg!==null){gg=!0;var _r=0,Tr=C$2;try{var Ar=eg;for(C$2=1;_r<Ar.length;_r++){var Rr=Ar[_r];do Rr=Rr(!0);while(Rr!==null)}eg=null,fg=!1}catch(Pr){throw eg!==null&&(eg=eg.slice(_r+1)),ac(fc,jg),Pr}finally{C$2=Tr,gg=!1}}return null}var kg=[],lg=0,mg=null,ng=0,og=[],pg=0,qg=null,rg=1,sg="";function tg(_r,Tr){kg[lg++]=ng,kg[lg++]=mg,mg=_r,ng=Tr}function ug(_r,Tr,Ar){og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,qg=_r;var Rr=rg;_r=sg;var Pr=32-oc(Rr)-1;Rr&=~(1<<Pr),Ar+=1;var Dr=32-oc(Tr)+Pr;if(30<Dr){var Mr=Pr-Pr%5;Dr=(Rr&(1<<Mr)-1).toString(32),Rr>>=Mr,Pr-=Mr,rg=1<<32-oc(Tr)+Pr|Ar<<Pr|Rr,sg=Dr+_r}else rg=1<<Dr|Ar<<Pr|Rr,sg=_r}function vg(_r){_r.return!==null&&(tg(_r,1),ug(_r,1,0))}function wg(_r){for(;_r===mg;)mg=kg[--lg],kg[lg]=null,ng=kg[--lg],kg[lg]=null;for(;_r===qg;)qg=og[--pg],og[pg]=null,sg=og[--pg],og[pg]=null,rg=og[--pg],og[pg]=null}var xg=null,yg=null,I$3=!1,zg=null;function Ag(_r,Tr){var Ar=Bg(5,null,null,0);Ar.elementType="DELETED",Ar.stateNode=Tr,Ar.return=_r,Tr=_r.deletions,Tr===null?(_r.deletions=[Ar],_r.flags|=16):Tr.push(Ar)}function Cg(_r,Tr){switch(_r.tag){case 5:var Ar=_r.type;return Tr=Tr.nodeType!==1||Ar.toLowerCase()!==Tr.nodeName.toLowerCase()?null:Tr,Tr!==null?(_r.stateNode=Tr,xg=_r,yg=Lf(Tr.firstChild),!0):!1;case 6:return Tr=_r.pendingProps===""||Tr.nodeType!==3?null:Tr,Tr!==null?(_r.stateNode=Tr,xg=_r,yg=null,!0):!1;case 13:return Tr=Tr.nodeType!==8?null:Tr,Tr!==null?(Ar=qg!==null?{id:rg,overflow:sg}:null,_r.memoizedState={dehydrated:Tr,treeContext:Ar,retryLane:1073741824},Ar=Bg(18,null,null,0),Ar.stateNode=Tr,Ar.return=_r,_r.child=Ar,xg=_r,yg=null,!0):!1;default:return!1}}function Dg(_r){return(_r.mode&1)!==0&&(_r.flags&128)===0}function Eg(_r){if(I$3){var Tr=yg;if(Tr){var Ar=Tr;if(!Cg(_r,Tr)){if(Dg(_r))throw Error(p$3(418));Tr=Lf(Ar.nextSibling);var Rr=xg;Tr&&Cg(_r,Tr)?Ag(Rr,Ar):(_r.flags=_r.flags&-4097|2,I$3=!1,xg=_r)}}else{if(Dg(_r))throw Error(p$3(418));_r.flags=_r.flags&-4097|2,I$3=!1,xg=_r}}}function Fg(_r){for(_r=_r.return;_r!==null&&_r.tag!==5&&_r.tag!==3&&_r.tag!==13;)_r=_r.return;xg=_r}function Gg(_r){if(_r!==xg)return!1;if(!I$3)return Fg(_r),I$3=!0,!1;var Tr;if((Tr=_r.tag!==3)&&!(Tr=_r.tag!==5)&&(Tr=_r.type,Tr=Tr!=="head"&&Tr!=="body"&&!Ef(_r.type,_r.memoizedProps)),Tr&&(Tr=yg)){if(Dg(_r))throw Hg(),Error(p$3(418));for(;Tr;)Ag(_r,Tr),Tr=Lf(Tr.nextSibling)}if(Fg(_r),_r.tag===13){if(_r=_r.memoizedState,_r=_r!==null?_r.dehydrated:null,!_r)throw Error(p$3(317));e:{for(_r=_r.nextSibling,Tr=0;_r;){if(_r.nodeType===8){var Ar=_r.data;if(Ar==="/$"){if(Tr===0){yg=Lf(_r.nextSibling);break e}Tr--}else Ar!=="$"&&Ar!=="$!"&&Ar!=="$?"||Tr++}_r=_r.nextSibling}yg=null}}else yg=xg?Lf(_r.stateNode.nextSibling):null;return!0}function Hg(){for(var _r=yg;_r;)_r=Lf(_r.nextSibling)}function Ig(){yg=xg=null,I$3=!1}function Jg(_r){zg===null?zg=[_r]:zg.push(_r)}var Kg=ua.ReactCurrentBatchConfig;function Lg(_r,Tr){if(_r&&_r.defaultProps){Tr=A$3({},Tr),_r=_r.defaultProps;for(var Ar in _r)Tr[Ar]===void 0&&(Tr[Ar]=_r[Ar]);return Tr}return Tr}var Mg=Uf(null),Ng=null,Og=null,Pg=null;function Qg(){Pg=Og=Ng=null}function Rg(_r){var Tr=Mg.current;E$3(Mg),_r._currentValue=Tr}function Sg(_r,Tr,Ar){for(;_r!==null;){var Rr=_r.alternate;if((_r.childLanes&Tr)!==Tr?(_r.childLanes|=Tr,Rr!==null&&(Rr.childLanes|=Tr)):Rr!==null&&(Rr.childLanes&Tr)!==Tr&&(Rr.childLanes|=Tr),_r===Ar)break;_r=_r.return}}function Tg(_r,Tr){Ng=_r,Pg=Og=null,_r=_r.dependencies,_r!==null&&_r.firstContext!==null&&(_r.lanes&Tr&&(Ug=!0),_r.firstContext=null)}function Vg(_r){var Tr=_r._currentValue;if(Pg!==_r)if(_r={context:_r,memoizedValue:Tr,next:null},Og===null){if(Ng===null)throw Error(p$3(308));Og=_r,Ng.dependencies={lanes:0,firstContext:_r}}else Og=Og.next=_r;return Tr}var Wg=null;function Xg(_r){Wg===null?Wg=[_r]:Wg.push(_r)}function Yg(_r,Tr,Ar,Rr){var Pr=Tr.interleaved;return Pr===null?(Ar.next=Ar,Xg(Tr)):(Ar.next=Pr.next,Pr.next=Ar),Tr.interleaved=Ar,Zg(_r,Rr)}function Zg(_r,Tr){_r.lanes|=Tr;var Ar=_r.alternate;for(Ar!==null&&(Ar.lanes|=Tr),Ar=_r,_r=_r.return;_r!==null;)_r.childLanes|=Tr,Ar=_r.alternate,Ar!==null&&(Ar.childLanes|=Tr),Ar=_r,_r=_r.return;return Ar.tag===3?Ar.stateNode:null}var $g=!1;function ah(_r){_r.updateQueue={baseState:_r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function bh(_r,Tr){_r=_r.updateQueue,Tr.updateQueue===_r&&(Tr.updateQueue={baseState:_r.baseState,firstBaseUpdate:_r.firstBaseUpdate,lastBaseUpdate:_r.lastBaseUpdate,shared:_r.shared,effects:_r.effects})}function ch(_r,Tr){return{eventTime:_r,lane:Tr,tag:0,payload:null,callback:null,next:null}}function dh(_r,Tr,Ar){var Rr=_r.updateQueue;if(Rr===null)return null;if(Rr=Rr.shared,K$4&2){var Pr=Rr.pending;return Pr===null?Tr.next=Tr:(Tr.next=Pr.next,Pr.next=Tr),Rr.pending=Tr,Zg(_r,Ar)}return Pr=Rr.interleaved,Pr===null?(Tr.next=Tr,Xg(Rr)):(Tr.next=Pr.next,Pr.next=Tr),Rr.interleaved=Tr,Zg(_r,Ar)}function eh(_r,Tr,Ar){if(Tr=Tr.updateQueue,Tr!==null&&(Tr=Tr.shared,(Ar&4194240)!==0)){var Rr=Tr.lanes;Rr&=_r.pendingLanes,Ar|=Rr,Tr.lanes=Ar,Cc(_r,Ar)}}function fh(_r,Tr){var Ar=_r.updateQueue,Rr=_r.alternate;if(Rr!==null&&(Rr=Rr.updateQueue,Ar===Rr)){var Pr=null,Dr=null;if(Ar=Ar.firstBaseUpdate,Ar!==null){do{var Mr={eventTime:Ar.eventTime,lane:Ar.lane,tag:Ar.tag,payload:Ar.payload,callback:Ar.callback,next:null};Dr===null?Pr=Dr=Mr:Dr=Dr.next=Mr,Ar=Ar.next}while(Ar!==null);Dr===null?Pr=Dr=Tr:Dr=Dr.next=Tr}else Pr=Dr=Tr;Ar={baseState:Rr.baseState,firstBaseUpdate:Pr,lastBaseUpdate:Dr,shared:Rr.shared,effects:Rr.effects},_r.updateQueue=Ar;return}_r=Ar.lastBaseUpdate,_r===null?Ar.firstBaseUpdate=Tr:_r.next=Tr,Ar.lastBaseUpdate=Tr}function gh(_r,Tr,Ar,Rr){var Pr=_r.updateQueue;$g=!1;var Dr=Pr.firstBaseUpdate,Mr=Pr.lastBaseUpdate,Fr=Pr.shared.pending;if(Fr!==null){Pr.shared.pending=null;var zr=Fr,jr=zr.next;zr.next=null,Mr===null?Dr=jr:Mr.next=jr,Mr=zr;var Gr=_r.alternate;Gr!==null&&(Gr=Gr.updateQueue,Fr=Gr.lastBaseUpdate,Fr!==Mr&&(Fr===null?Gr.firstBaseUpdate=jr:Fr.next=jr,Gr.lastBaseUpdate=zr))}if(Dr!==null){var Nr=Pr.baseState;Mr=0,Gr=jr=zr=null,Fr=Dr;do{var Lr=Fr.lane,Ur=Fr.eventTime;if((Rr&Lr)===Lr){Gr!==null&&(Gr=Gr.next={eventTime:Ur,lane:0,tag:Fr.tag,payload:Fr.payload,callback:Fr.callback,next:null});e:{var Vr=_r,Wr=Fr;switch(Lr=Tr,Ur=Ar,Wr.tag){case 1:if(Vr=Wr.payload,typeof Vr=="function"){Nr=Vr.call(Ur,Nr,Lr);break e}Nr=Vr;break e;case 3:Vr.flags=Vr.flags&-65537|128;case 0:if(Vr=Wr.payload,Lr=typeof Vr=="function"?Vr.call(Ur,Nr,Lr):Vr,Lr==null)break e;Nr=A$3({},Nr,Lr);break e;case 2:$g=!0}}Fr.callback!==null&&Fr.lane!==0&&(_r.flags|=64,Lr=Pr.effects,Lr===null?Pr.effects=[Fr]:Lr.push(Fr))}else Ur={eventTime:Ur,lane:Lr,tag:Fr.tag,payload:Fr.payload,callback:Fr.callback,next:null},Gr===null?(jr=Gr=Ur,zr=Nr):Gr=Gr.next=Ur,Mr|=Lr;if(Fr=Fr.next,Fr===null){if(Fr=Pr.shared.pending,Fr===null)break;Lr=Fr,Fr=Lr.next,Lr.next=null,Pr.lastBaseUpdate=Lr,Pr.shared.pending=null}}while(1);if(Gr===null&&(zr=Nr),Pr.baseState=zr,Pr.firstBaseUpdate=jr,Pr.lastBaseUpdate=Gr,Tr=Pr.shared.interleaved,Tr!==null){Pr=Tr;do Mr|=Pr.lane,Pr=Pr.next;while(Pr!==Tr)}else Dr===null&&(Pr.shared.lanes=0);hh|=Mr,_r.lanes=Mr,_r.memoizedState=Nr}}function ih(_r,Tr,Ar){if(_r=Tr.effects,Tr.effects=null,_r!==null)for(Tr=0;Tr<_r.length;Tr++){var Rr=_r[Tr],Pr=Rr.callback;if(Pr!==null){if(Rr.callback=null,Rr=Ar,typeof Pr!="function")throw Error(p$3(191,Pr));Pr.call(Rr)}}}var jh=new aa.Component().refs;function kh(_r,Tr,Ar,Rr){Tr=_r.memoizedState,Ar=Ar(Rr,Tr),Ar=Ar==null?Tr:A$3({},Tr,Ar),_r.memoizedState=Ar,_r.lanes===0&&(_r.updateQueue.baseState=Ar)}var nh={isMounted:function(_r){return(_r=_r._reactInternals)?Vb(_r)===_r:!1},enqueueSetState:function(_r,Tr,Ar){_r=_r._reactInternals;var Rr=L$2(),Pr=lh(_r),Dr=ch(Rr,Pr);Dr.payload=Tr,Ar!=null&&(Dr.callback=Ar),Tr=dh(_r,Dr,Pr),Tr!==null&&(mh(Tr,_r,Pr,Rr),eh(Tr,_r,Pr))},enqueueReplaceState:function(_r,Tr,Ar){_r=_r._reactInternals;var Rr=L$2(),Pr=lh(_r),Dr=ch(Rr,Pr);Dr.tag=1,Dr.payload=Tr,Ar!=null&&(Dr.callback=Ar),Tr=dh(_r,Dr,Pr),Tr!==null&&(mh(Tr,_r,Pr,Rr),eh(Tr,_r,Pr))},enqueueForceUpdate:function(_r,Tr){_r=_r._reactInternals;var Ar=L$2(),Rr=lh(_r),Pr=ch(Ar,Rr);Pr.tag=2,Tr!=null&&(Pr.callback=Tr),Tr=dh(_r,Pr,Rr),Tr!==null&&(mh(Tr,_r,Rr,Ar),eh(Tr,_r,Rr))}};function oh(_r,Tr,Ar,Rr,Pr,Dr,Mr){return _r=_r.stateNode,typeof _r.shouldComponentUpdate=="function"?_r.shouldComponentUpdate(Rr,Dr,Mr):Tr.prototype&&Tr.prototype.isPureReactComponent?!Ie$2(Ar,Rr)||!Ie$2(Pr,Dr):!0}function ph(_r,Tr,Ar){var Rr=!1,Pr=Vf,Dr=Tr.contextType;return typeof Dr=="object"&&Dr!==null?Dr=Vg(Dr):(Pr=Zf(Tr)?Xf:H$3.current,Rr=Tr.contextTypes,Dr=(Rr=Rr!=null)?Yf(_r,Pr):Vf),Tr=new Tr(Ar,Dr),_r.memoizedState=Tr.state!==null&&Tr.state!==void 0?Tr.state:null,Tr.updater=nh,_r.stateNode=Tr,Tr._reactInternals=_r,Rr&&(_r=_r.stateNode,_r.__reactInternalMemoizedUnmaskedChildContext=Pr,_r.__reactInternalMemoizedMaskedChildContext=Dr),Tr}function qh(_r,Tr,Ar,Rr){_r=Tr.state,typeof Tr.componentWillReceiveProps=="function"&&Tr.componentWillReceiveProps(Ar,Rr),typeof Tr.UNSAFE_componentWillReceiveProps=="function"&&Tr.UNSAFE_componentWillReceiveProps(Ar,Rr),Tr.state!==_r&&nh.enqueueReplaceState(Tr,Tr.state,null)}function rh(_r,Tr,Ar,Rr){var Pr=_r.stateNode;Pr.props=Ar,Pr.state=_r.memoizedState,Pr.refs=jh,ah(_r);var Dr=Tr.contextType;typeof Dr=="object"&&Dr!==null?Pr.context=Vg(Dr):(Dr=Zf(Tr)?Xf:H$3.current,Pr.context=Yf(_r,Dr)),Pr.state=_r.memoizedState,Dr=Tr.getDerivedStateFromProps,typeof Dr=="function"&&(kh(_r,Tr,Dr,Ar),Pr.state=_r.memoizedState),typeof Tr.getDerivedStateFromProps=="function"||typeof Pr.getSnapshotBeforeUpdate=="function"||typeof Pr.UNSAFE_componentWillMount!="function"&&typeof Pr.componentWillMount!="function"||(Tr=Pr.state,typeof Pr.componentWillMount=="function"&&Pr.componentWillMount(),typeof Pr.UNSAFE_componentWillMount=="function"&&Pr.UNSAFE_componentWillMount(),Tr!==Pr.state&&nh.enqueueReplaceState(Pr,Pr.state,null),gh(_r,Ar,Pr,Rr),Pr.state=_r.memoizedState),typeof Pr.componentDidMount=="function"&&(_r.flags|=4194308)}function sh(_r,Tr,Ar){if(_r=Ar.ref,_r!==null&&typeof _r!="function"&&typeof _r!="object"){if(Ar._owner){if(Ar=Ar._owner,Ar){if(Ar.tag!==1)throw Error(p$3(309));var Rr=Ar.stateNode}if(!Rr)throw Error(p$3(147,_r));var Pr=Rr,Dr=""+_r;return Tr!==null&&Tr.ref!==null&&typeof Tr.ref=="function"&&Tr.ref._stringRef===Dr?Tr.ref:(Tr=function(Mr){var Fr=Pr.refs;Fr===jh&&(Fr=Pr.refs={}),Mr===null?delete Fr[Dr]:Fr[Dr]=Mr},Tr._stringRef=Dr,Tr)}if(typeof _r!="string")throw Error(p$3(284));if(!Ar._owner)throw Error(p$3(290,_r))}return _r}function th(_r,Tr){throw _r=Object.prototype.toString.call(Tr),Error(p$3(31,_r==="[object Object]"?"object with keys {"+Object.keys(Tr).join(", ")+"}":_r))}function uh(_r){var Tr=_r._init;return Tr(_r._payload)}function vh(_r){function Tr(Kr,Xr){if(_r){var Zr=Kr.deletions;Zr===null?(Kr.deletions=[Xr],Kr.flags|=16):Zr.push(Xr)}}function Ar(Kr,Xr){if(!_r)return null;for(;Xr!==null;)Tr(Kr,Xr),Xr=Xr.sibling;return null}function Rr(Kr,Xr){for(Kr=new Map;Xr!==null;)Xr.key!==null?Kr.set(Xr.key,Xr):Kr.set(Xr.index,Xr),Xr=Xr.sibling;return Kr}function Pr(Kr,Xr){return Kr=wh(Kr,Xr),Kr.index=0,Kr.sibling=null,Kr}function Dr(Kr,Xr,Zr){return Kr.index=Zr,_r?(Zr=Kr.alternate,Zr!==null?(Zr=Zr.index,Zr<Xr?(Kr.flags|=2,Xr):Zr):(Kr.flags|=2,Xr)):(Kr.flags|=1048576,Xr)}function Mr(Kr){return _r&&Kr.alternate===null&&(Kr.flags|=2),Kr}function Fr(Kr,Xr,Zr,_i){return Xr===null||Xr.tag!==6?(Xr=xh(Zr,Kr.mode,_i),Xr.return=Kr,Xr):(Xr=Pr(Xr,Zr),Xr.return=Kr,Xr)}function zr(Kr,Xr,Zr,_i){var Jr=Zr.type;return Jr===ya?Gr(Kr,Xr,Zr.props.children,_i,Zr.key):Xr!==null&&(Xr.elementType===Jr||typeof Jr=="object"&&Jr!==null&&Jr.$$typeof===Ha&&uh(Jr)===Xr.type)?(_i=Pr(Xr,Zr.props),_i.ref=sh(Kr,Xr,Zr),_i.return=Kr,_i):(_i=yh(Zr.type,Zr.key,Zr.props,null,Kr.mode,_i),_i.ref=sh(Kr,Xr,Zr),_i.return=Kr,_i)}function jr(Kr,Xr,Zr,_i){return Xr===null||Xr.tag!==4||Xr.stateNode.containerInfo!==Zr.containerInfo||Xr.stateNode.implementation!==Zr.implementation?(Xr=zh(Zr,Kr.mode,_i),Xr.return=Kr,Xr):(Xr=Pr(Xr,Zr.children||[]),Xr.return=Kr,Xr)}function Gr(Kr,Xr,Zr,_i,Jr){return Xr===null||Xr.tag!==7?(Xr=Ah(Zr,Kr.mode,_i,Jr),Xr.return=Kr,Xr):(Xr=Pr(Xr,Zr),Xr.return=Kr,Xr)}function Nr(Kr,Xr,Zr){if(typeof Xr=="string"&&Xr!==""||typeof Xr=="number")return Xr=xh(""+Xr,Kr.mode,Zr),Xr.return=Kr,Xr;if(typeof Xr=="object"&&Xr!==null){switch(Xr.$$typeof){case va:return Zr=yh(Xr.type,Xr.key,Xr.props,null,Kr.mode,Zr),Zr.ref=sh(Kr,null,Xr),Zr.return=Kr,Zr;case wa:return Xr=zh(Xr,Kr.mode,Zr),Xr.return=Kr,Xr;case Ha:var _i=Xr._init;return Nr(Kr,_i(Xr._payload),Zr)}if(eb(Xr)||Ka(Xr))return Xr=Ah(Xr,Kr.mode,Zr,null),Xr.return=Kr,Xr;th(Kr,Xr)}return null}function Lr(Kr,Xr,Zr,_i){var Jr=Xr!==null?Xr.key:null;if(typeof Zr=="string"&&Zr!==""||typeof Zr=="number")return Jr!==null?null:Fr(Kr,Xr,""+Zr,_i);if(typeof Zr=="object"&&Zr!==null){switch(Zr.$$typeof){case va:return Zr.key===Jr?zr(Kr,Xr,Zr,_i):null;case wa:return Zr.key===Jr?jr(Kr,Xr,Zr,_i):null;case Ha:return Jr=Zr._init,Lr(Kr,Xr,Jr(Zr._payload),_i)}if(eb(Zr)||Ka(Zr))return Jr!==null?null:Gr(Kr,Xr,Zr,_i,null);th(Kr,Zr)}return null}function Ur(Kr,Xr,Zr,_i,Jr){if(typeof _i=="string"&&_i!==""||typeof _i=="number")return Kr=Kr.get(Zr)||null,Fr(Xr,Kr,""+_i,Jr);if(typeof _i=="object"&&_i!==null){switch(_i.$$typeof){case va:return Kr=Kr.get(_i.key===null?Zr:_i.key)||null,zr(Xr,Kr,_i,Jr);case wa:return Kr=Kr.get(_i.key===null?Zr:_i.key)||null,jr(Xr,Kr,_i,Jr);case Ha:var es=_i._init;return Ur(Kr,Xr,Zr,es(_i._payload),Jr)}if(eb(_i)||Ka(_i))return Kr=Kr.get(Zr)||null,Gr(Xr,Kr,_i,Jr,null);th(Xr,_i)}return null}function Vr(Kr,Xr,Zr,_i){for(var Jr=null,es=null,ts=Xr,is=Xr=0,rs=null;ts!==null&&is<Zr.length;is++){ts.index>is?(rs=ts,ts=null):rs=ts.sibling;var as=Lr(Kr,ts,Zr[is],_i);if(as===null){ts===null&&(ts=rs);break}_r&&ts&&as.alternate===null&&Tr(Kr,ts),Xr=Dr(as,Xr,is),es===null?Jr=as:es.sibling=as,es=as,ts=rs}if(is===Zr.length)return Ar(Kr,ts),I$3&&tg(Kr,is),Jr;if(ts===null){for(;is<Zr.length;is++)ts=Nr(Kr,Zr[is],_i),ts!==null&&(Xr=Dr(ts,Xr,is),es===null?Jr=ts:es.sibling=ts,es=ts);return I$3&&tg(Kr,is),Jr}for(ts=Rr(Kr,ts);is<Zr.length;is++)rs=Ur(ts,Kr,is,Zr[is],_i),rs!==null&&(_r&&rs.alternate!==null&&ts.delete(rs.key===null?is:rs.key),Xr=Dr(rs,Xr,is),es===null?Jr=rs:es.sibling=rs,es=rs);return _r&&ts.forEach(function(ls){return Tr(Kr,ls)}),I$3&&tg(Kr,is),Jr}function Wr(Kr,Xr,Zr,_i){var Jr=Ka(Zr);if(typeof Jr!="function")throw Error(p$3(150));if(Zr=Jr.call(Zr),Zr==null)throw Error(p$3(151));for(var es=Jr=null,ts=Xr,is=Xr=0,rs=null,as=Zr.next();ts!==null&&!as.done;is++,as=Zr.next()){ts.index>is?(rs=ts,ts=null):rs=ts.sibling;var ls=Lr(Kr,ts,as.value,_i);if(ls===null){ts===null&&(ts=rs);break}_r&&ts&&ls.alternate===null&&Tr(Kr,ts),Xr=Dr(ls,Xr,is),es===null?Jr=ls:es.sibling=ls,es=ls,ts=rs}if(as.done)return Ar(Kr,ts),I$3&&tg(Kr,is),Jr;if(ts===null){for(;!as.done;is++,as=Zr.next())as=Nr(Kr,as.value,_i),as!==null&&(Xr=Dr(as,Xr,is),es===null?Jr=as:es.sibling=as,es=as);return I$3&&tg(Kr,is),Jr}for(ts=Rr(Kr,ts);!as.done;is++,as=Zr.next())as=Ur(ts,Kr,is,as.value,_i),as!==null&&(_r&&as.alternate!==null&&ts.delete(as.key===null?is:as.key),Xr=Dr(as,Xr,is),es===null?Jr=as:es.sibling=as,es=as);return _r&&ts.forEach(function(fs){return Tr(Kr,fs)}),I$3&&tg(Kr,is),Jr}function qr(Kr,Xr,Zr,_i){if(typeof Zr=="object"&&Zr!==null&&Zr.type===ya&&Zr.key===null&&(Zr=Zr.props.children),typeof Zr=="object"&&Zr!==null){switch(Zr.$$typeof){case va:e:{for(var Jr=Zr.key,es=Xr;es!==null;){if(es.key===Jr){if(Jr=Zr.type,Jr===ya){if(es.tag===7){Ar(Kr,es.sibling),Xr=Pr(es,Zr.props.children),Xr.return=Kr,Kr=Xr;break e}}else if(es.elementType===Jr||typeof Jr=="object"&&Jr!==null&&Jr.$$typeof===Ha&&uh(Jr)===es.type){Ar(Kr,es.sibling),Xr=Pr(es,Zr.props),Xr.ref=sh(Kr,es,Zr),Xr.return=Kr,Kr=Xr;break e}Ar(Kr,es);break}else Tr(Kr,es);es=es.sibling}Zr.type===ya?(Xr=Ah(Zr.props.children,Kr.mode,_i,Zr.key),Xr.return=Kr,Kr=Xr):(_i=yh(Zr.type,Zr.key,Zr.props,null,Kr.mode,_i),_i.ref=sh(Kr,Xr,Zr),_i.return=Kr,Kr=_i)}return Mr(Kr);case wa:e:{for(es=Zr.key;Xr!==null;){if(Xr.key===es)if(Xr.tag===4&&Xr.stateNode.containerInfo===Zr.containerInfo&&Xr.stateNode.implementation===Zr.implementation){Ar(Kr,Xr.sibling),Xr=Pr(Xr,Zr.children||[]),Xr.return=Kr,Kr=Xr;break e}else{Ar(Kr,Xr);break}else Tr(Kr,Xr);Xr=Xr.sibling}Xr=zh(Zr,Kr.mode,_i),Xr.return=Kr,Kr=Xr}return Mr(Kr);case Ha:return es=Zr._init,qr(Kr,Xr,es(Zr._payload),_i)}if(eb(Zr))return Vr(Kr,Xr,Zr,_i);if(Ka(Zr))return Wr(Kr,Xr,Zr,_i);th(Kr,Zr)}return typeof Zr=="string"&&Zr!==""||typeof Zr=="number"?(Zr=""+Zr,Xr!==null&&Xr.tag===6?(Ar(Kr,Xr.sibling),Xr=Pr(Xr,Zr),Xr.return=Kr,Kr=Xr):(Ar(Kr,Xr),Xr=xh(Zr,Kr.mode,_i),Xr.return=Kr,Kr=Xr),Mr(Kr)):Ar(Kr,Xr)}return qr}var Bh=vh(!0),Ch=vh(!1),Dh={},Eh=Uf(Dh),Fh=Uf(Dh),Gh=Uf(Dh);function Hh(_r){if(_r===Dh)throw Error(p$3(174));return _r}function Ih(_r,Tr){switch(G$4(Gh,Tr),G$4(Fh,_r),G$4(Eh,Dh),_r=Tr.nodeType,_r){case 9:case 11:Tr=(Tr=Tr.documentElement)?Tr.namespaceURI:lb(null,"");break;default:_r=_r===8?Tr.parentNode:Tr,Tr=_r.namespaceURI||null,_r=_r.tagName,Tr=lb(Tr,_r)}E$3(Eh),G$4(Eh,Tr)}function Jh(){E$3(Eh),E$3(Fh),E$3(Gh)}function Kh(_r){Hh(Gh.current);var Tr=Hh(Eh.current),Ar=lb(Tr,_r.type);Tr!==Ar&&(G$4(Fh,_r),G$4(Eh,Ar))}function Lh(_r){Fh.current===_r&&(E$3(Eh),E$3(Fh))}var M$4=Uf(0);function Mh(_r){for(var Tr=_r;Tr!==null;){if(Tr.tag===13){var Ar=Tr.memoizedState;if(Ar!==null&&(Ar=Ar.dehydrated,Ar===null||Ar.data==="$?"||Ar.data==="$!"))return Tr}else if(Tr.tag===19&&Tr.memoizedProps.revealOrder!==void 0){if(Tr.flags&128)return Tr}else if(Tr.child!==null){Tr.child.return=Tr,Tr=Tr.child;continue}if(Tr===_r)break;for(;Tr.sibling===null;){if(Tr.return===null||Tr.return===_r)return null;Tr=Tr.return}Tr.sibling.return=Tr.return,Tr=Tr.sibling}return null}var Nh=[];function Oh(){for(var _r=0;_r<Nh.length;_r++)Nh[_r]._workInProgressVersionPrimary=null;Nh.length=0}var Ph=ua.ReactCurrentDispatcher,Qh=ua.ReactCurrentBatchConfig,Rh=0,N$4=null,O$3=null,P$4=null,Sh=!1,Th=!1,Uh=0,Vh=0;function Q$4(){throw Error(p$3(321))}function Wh(_r,Tr){if(Tr===null)return!1;for(var Ar=0;Ar<Tr.length&&Ar<_r.length;Ar++)if(!He$2(_r[Ar],Tr[Ar]))return!1;return!0}function Xh(_r,Tr,Ar,Rr,Pr,Dr){if(Rh=Dr,N$4=Tr,Tr.memoizedState=null,Tr.updateQueue=null,Tr.lanes=0,Ph.current=_r===null||_r.memoizedState===null?Yh:Zh,_r=Ar(Rr,Pr),Th){Dr=0;do{if(Th=!1,Uh=0,25<=Dr)throw Error(p$3(301));Dr+=1,P$4=O$3=null,Tr.updateQueue=null,Ph.current=$h,_r=Ar(Rr,Pr)}while(Th)}if(Ph.current=ai,Tr=O$3!==null&&O$3.next!==null,Rh=0,P$4=O$3=N$4=null,Sh=!1,Tr)throw Error(p$3(300));return _r}function bi(){var _r=Uh!==0;return Uh=0,_r}function ci(){var _r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return P$4===null?N$4.memoizedState=P$4=_r:P$4=P$4.next=_r,P$4}function di(){if(O$3===null){var _r=N$4.alternate;_r=_r!==null?_r.memoizedState:null}else _r=O$3.next;var Tr=P$4===null?N$4.memoizedState:P$4.next;if(Tr!==null)P$4=Tr,O$3=_r;else{if(_r===null)throw Error(p$3(310));O$3=_r,_r={memoizedState:O$3.memoizedState,baseState:O$3.baseState,baseQueue:O$3.baseQueue,queue:O$3.queue,next:null},P$4===null?N$4.memoizedState=P$4=_r:P$4=P$4.next=_r}return P$4}function ei(_r,Tr){return typeof Tr=="function"?Tr(_r):Tr}function fi(_r){var Tr=di(),Ar=Tr.queue;if(Ar===null)throw Error(p$3(311));Ar.lastRenderedReducer=_r;var Rr=O$3,Pr=Rr.baseQueue,Dr=Ar.pending;if(Dr!==null){if(Pr!==null){var Mr=Pr.next;Pr.next=Dr.next,Dr.next=Mr}Rr.baseQueue=Pr=Dr,Ar.pending=null}if(Pr!==null){Dr=Pr.next,Rr=Rr.baseState;var Fr=Mr=null,zr=null,jr=Dr;do{var Gr=jr.lane;if((Rh&Gr)===Gr)zr!==null&&(zr=zr.next={lane:0,action:jr.action,hasEagerState:jr.hasEagerState,eagerState:jr.eagerState,next:null}),Rr=jr.hasEagerState?jr.eagerState:_r(Rr,jr.action);else{var Nr={lane:Gr,action:jr.action,hasEagerState:jr.hasEagerState,eagerState:jr.eagerState,next:null};zr===null?(Fr=zr=Nr,Mr=Rr):zr=zr.next=Nr,N$4.lanes|=Gr,hh|=Gr}jr=jr.next}while(jr!==null&&jr!==Dr);zr===null?Mr=Rr:zr.next=Fr,He$2(Rr,Tr.memoizedState)||(Ug=!0),Tr.memoizedState=Rr,Tr.baseState=Mr,Tr.baseQueue=zr,Ar.lastRenderedState=Rr}if(_r=Ar.interleaved,_r!==null){Pr=_r;do Dr=Pr.lane,N$4.lanes|=Dr,hh|=Dr,Pr=Pr.next;while(Pr!==_r)}else Pr===null&&(Ar.lanes=0);return[Tr.memoizedState,Ar.dispatch]}function gi(_r){var Tr=di(),Ar=Tr.queue;if(Ar===null)throw Error(p$3(311));Ar.lastRenderedReducer=_r;var Rr=Ar.dispatch,Pr=Ar.pending,Dr=Tr.memoizedState;if(Pr!==null){Ar.pending=null;var Mr=Pr=Pr.next;do Dr=_r(Dr,Mr.action),Mr=Mr.next;while(Mr!==Pr);He$2(Dr,Tr.memoizedState)||(Ug=!0),Tr.memoizedState=Dr,Tr.baseQueue===null&&(Tr.baseState=Dr),Ar.lastRenderedState=Dr}return[Dr,Rr]}function hi(){}function ii(_r,Tr){var Ar=N$4,Rr=di(),Pr=Tr(),Dr=!He$2(Rr.memoizedState,Pr);if(Dr&&(Rr.memoizedState=Pr,Ug=!0),Rr=Rr.queue,ji(ki.bind(null,Ar,Rr,_r),[_r]),Rr.getSnapshot!==Tr||Dr||P$4!==null&&P$4.memoizedState.tag&1){if(Ar.flags|=2048,li(9,mi.bind(null,Ar,Rr,Pr,Tr),void 0,null),R$4===null)throw Error(p$3(349));Rh&30||ni(Ar,Tr,Pr)}return Pr}function ni(_r,Tr,Ar){_r.flags|=16384,_r={getSnapshot:Tr,value:Ar},Tr=N$4.updateQueue,Tr===null?(Tr={lastEffect:null,stores:null},N$4.updateQueue=Tr,Tr.stores=[_r]):(Ar=Tr.stores,Ar===null?Tr.stores=[_r]:Ar.push(_r))}function mi(_r,Tr,Ar,Rr){Tr.value=Ar,Tr.getSnapshot=Rr,oi(Tr)&&pi(_r)}function ki(_r,Tr,Ar){return Ar(function(){oi(Tr)&&pi(_r)})}function oi(_r){var Tr=_r.getSnapshot;_r=_r.value;try{var Ar=Tr();return!He$2(_r,Ar)}catch{return!0}}function pi(_r){var Tr=Zg(_r,1);Tr!==null&&mh(Tr,_r,1,-1)}function qi(_r){var Tr=ci();return typeof _r=="function"&&(_r=_r()),Tr.memoizedState=Tr.baseState=_r,_r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ei,lastRenderedState:_r},Tr.queue=_r,_r=_r.dispatch=ri.bind(null,N$4,_r),[Tr.memoizedState,_r]}function li(_r,Tr,Ar,Rr){return _r={tag:_r,create:Tr,destroy:Ar,deps:Rr,next:null},Tr=N$4.updateQueue,Tr===null?(Tr={lastEffect:null,stores:null},N$4.updateQueue=Tr,Tr.lastEffect=_r.next=_r):(Ar=Tr.lastEffect,Ar===null?Tr.lastEffect=_r.next=_r:(Rr=Ar.next,Ar.next=_r,_r.next=Rr,Tr.lastEffect=_r)),_r}function si(){return di().memoizedState}function ti(_r,Tr,Ar,Rr){var Pr=ci();N$4.flags|=_r,Pr.memoizedState=li(1|Tr,Ar,void 0,Rr===void 0?null:Rr)}function ui(_r,Tr,Ar,Rr){var Pr=di();Rr=Rr===void 0?null:Rr;var Dr=void 0;if(O$3!==null){var Mr=O$3.memoizedState;if(Dr=Mr.destroy,Rr!==null&&Wh(Rr,Mr.deps)){Pr.memoizedState=li(Tr,Ar,Dr,Rr);return}}N$4.flags|=_r,Pr.memoizedState=li(1|Tr,Ar,Dr,Rr)}function vi(_r,Tr){return ti(8390656,8,_r,Tr)}function ji(_r,Tr){return ui(2048,8,_r,Tr)}function wi(_r,Tr){return ui(4,2,_r,Tr)}function xi(_r,Tr){return ui(4,4,_r,Tr)}function yi(_r,Tr){if(typeof Tr=="function")return _r=_r(),Tr(_r),function(){Tr(null)};if(Tr!=null)return _r=_r(),Tr.current=_r,function(){Tr.current=null}}function zi(_r,Tr,Ar){return Ar=Ar!=null?Ar.concat([_r]):null,ui(4,4,yi.bind(null,Tr,_r),Ar)}function Ai(){}function Bi(_r,Tr){var Ar=di();Tr=Tr===void 0?null:Tr;var Rr=Ar.memoizedState;return Rr!==null&&Tr!==null&&Wh(Tr,Rr[1])?Rr[0]:(Ar.memoizedState=[_r,Tr],_r)}function Ci(_r,Tr){var Ar=di();Tr=Tr===void 0?null:Tr;var Rr=Ar.memoizedState;return Rr!==null&&Tr!==null&&Wh(Tr,Rr[1])?Rr[0]:(_r=_r(),Ar.memoizedState=[_r,Tr],_r)}function Di(_r,Tr,Ar){return Rh&21?(He$2(Ar,Tr)||(Ar=yc(),N$4.lanes|=Ar,hh|=Ar,_r.baseState=!0),Tr):(_r.baseState&&(_r.baseState=!1,Ug=!0),_r.memoizedState=Ar)}function Ei(_r,Tr){var Ar=C$2;C$2=Ar!==0&&4>Ar?Ar:4,_r(!0);var Rr=Qh.transition;Qh.transition={};try{_r(!1),Tr()}finally{C$2=Ar,Qh.transition=Rr}}function Fi(){return di().memoizedState}function Gi(_r,Tr,Ar){var Rr=lh(_r);if(Ar={lane:Rr,action:Ar,hasEagerState:!1,eagerState:null,next:null},Hi(_r))Ii(Tr,Ar);else if(Ar=Yg(_r,Tr,Ar,Rr),Ar!==null){var Pr=L$2();mh(Ar,_r,Rr,Pr),Ji(Ar,Tr,Rr)}}function ri(_r,Tr,Ar){var Rr=lh(_r),Pr={lane:Rr,action:Ar,hasEagerState:!1,eagerState:null,next:null};if(Hi(_r))Ii(Tr,Pr);else{var Dr=_r.alternate;if(_r.lanes===0&&(Dr===null||Dr.lanes===0)&&(Dr=Tr.lastRenderedReducer,Dr!==null))try{var Mr=Tr.lastRenderedState,Fr=Dr(Mr,Ar);if(Pr.hasEagerState=!0,Pr.eagerState=Fr,He$2(Fr,Mr)){var zr=Tr.interleaved;zr===null?(Pr.next=Pr,Xg(Tr)):(Pr.next=zr.next,zr.next=Pr),Tr.interleaved=Pr;return}}catch{}finally{}Ar=Yg(_r,Tr,Pr,Rr),Ar!==null&&(Pr=L$2(),mh(Ar,_r,Rr,Pr),Ji(Ar,Tr,Rr))}}function Hi(_r){var Tr=_r.alternate;return _r===N$4||Tr!==null&&Tr===N$4}function Ii(_r,Tr){Th=Sh=!0;var Ar=_r.pending;Ar===null?Tr.next=Tr:(Tr.next=Ar.next,Ar.next=Tr),_r.pending=Tr}function Ji(_r,Tr,Ar){if(Ar&4194240){var Rr=Tr.lanes;Rr&=_r.pendingLanes,Ar|=Rr,Tr.lanes=Ar,Cc(_r,Ar)}}var ai={readContext:Vg,useCallback:Q$4,useContext:Q$4,useEffect:Q$4,useImperativeHandle:Q$4,useInsertionEffect:Q$4,useLayoutEffect:Q$4,useMemo:Q$4,useReducer:Q$4,useRef:Q$4,useState:Q$4,useDebugValue:Q$4,useDeferredValue:Q$4,useTransition:Q$4,useMutableSource:Q$4,useSyncExternalStore:Q$4,useId:Q$4,unstable_isNewReconciler:!1},Yh={readContext:Vg,useCallback:function(_r,Tr){return ci().memoizedState=[_r,Tr===void 0?null:Tr],_r},useContext:Vg,useEffect:vi,useImperativeHandle:function(_r,Tr,Ar){return Ar=Ar!=null?Ar.concat([_r]):null,ti(4194308,4,yi.bind(null,Tr,_r),Ar)},useLayoutEffect:function(_r,Tr){return ti(4194308,4,_r,Tr)},useInsertionEffect:function(_r,Tr){return ti(4,2,_r,Tr)},useMemo:function(_r,Tr){var Ar=ci();return Tr=Tr===void 0?null:Tr,_r=_r(),Ar.memoizedState=[_r,Tr],_r},useReducer:function(_r,Tr,Ar){var Rr=ci();return Tr=Ar!==void 0?Ar(Tr):Tr,Rr.memoizedState=Rr.baseState=Tr,_r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:_r,lastRenderedState:Tr},Rr.queue=_r,_r=_r.dispatch=Gi.bind(null,N$4,_r),[Rr.memoizedState,_r]},useRef:function(_r){var Tr=ci();return _r={current:_r},Tr.memoizedState=_r},useState:qi,useDebugValue:Ai,useDeferredValue:function(_r){return ci().memoizedState=_r},useTransition:function(){var _r=qi(!1),Tr=_r[0];return _r=Ei.bind(null,_r[1]),ci().memoizedState=_r,[Tr,_r]},useMutableSource:function(){},useSyncExternalStore:function(_r,Tr,Ar){var Rr=N$4,Pr=ci();if(I$3){if(Ar===void 0)throw Error(p$3(407));Ar=Ar()}else{if(Ar=Tr(),R$4===null)throw Error(p$3(349));Rh&30||ni(Rr,Tr,Ar)}Pr.memoizedState=Ar;var Dr={value:Ar,getSnapshot:Tr};return Pr.queue=Dr,vi(ki.bind(null,Rr,Dr,_r),[_r]),Rr.flags|=2048,li(9,mi.bind(null,Rr,Dr,Ar,Tr),void 0,null),Ar},useId:function(){var _r=ci(),Tr=R$4.identifierPrefix;if(I$3){var Ar=sg,Rr=rg;Ar=(Rr&~(1<<32-oc(Rr)-1)).toString(32)+Ar,Tr=":"+Tr+"R"+Ar,Ar=Uh++,0<Ar&&(Tr+="H"+Ar.toString(32)),Tr+=":"}else Ar=Vh++,Tr=":"+Tr+"r"+Ar.toString(32)+":";return _r.memoizedState=Tr},unstable_isNewReconciler:!1},Zh={readContext:Vg,useCallback:Bi,useContext:Vg,useEffect:ji,useImperativeHandle:zi,useInsertionEffect:wi,useLayoutEffect:xi,useMemo:Ci,useReducer:fi,useRef:si,useState:function(){return fi(ei)},useDebugValue:Ai,useDeferredValue:function(_r){var Tr=di();return Di(Tr,O$3.memoizedState,_r)},useTransition:function(){var _r=fi(ei)[0],Tr=di().memoizedState;return[_r,Tr]},useMutableSource:hi,useSyncExternalStore:ii,useId:Fi,unstable_isNewReconciler:!1},$h={readContext:Vg,useCallback:Bi,useContext:Vg,useEffect:ji,useImperativeHandle:zi,useInsertionEffect:wi,useLayoutEffect:xi,useMemo:Ci,useReducer:gi,useRef:si,useState:function(){return gi(ei)},useDebugValue:Ai,useDeferredValue:function(_r){var Tr=di();return O$3===null?Tr.memoizedState=_r:Di(Tr,O$3.memoizedState,_r)},useTransition:function(){var _r=gi(ei)[0],Tr=di().memoizedState;return[_r,Tr]},useMutableSource:hi,useSyncExternalStore:ii,useId:Fi,unstable_isNewReconciler:!1};function Ki(_r,Tr){try{var Ar="",Rr=Tr;do Ar+=Pa(Rr),Rr=Rr.return;while(Rr);var Pr=Ar}catch(Dr){Pr=`
Error generating stack: `+Dr.message+`
`+Dr.stack}return{value:_r,source:Tr,stack:Pr,digest:null}}function Li(_r,Tr,Ar){return{value:_r,source:null,stack:Ar??null,digest:Tr??null}}function Mi(_r,Tr){try{console.error(Tr.value)}catch(Ar){setTimeout(function(){throw Ar})}}var Ni=typeof WeakMap=="function"?WeakMap:Map;function Oi(_r,Tr,Ar){Ar=ch(-1,Ar),Ar.tag=3,Ar.payload={element:null};var Rr=Tr.value;return Ar.callback=function(){Pi||(Pi=!0,Qi=Rr),Mi(_r,Tr)},Ar}function Ri(_r,Tr,Ar){Ar=ch(-1,Ar),Ar.tag=3;var Rr=_r.type.getDerivedStateFromError;if(typeof Rr=="function"){var Pr=Tr.value;Ar.payload=function(){return Rr(Pr)},Ar.callback=function(){Mi(_r,Tr)}}var Dr=_r.stateNode;return Dr!==null&&typeof Dr.componentDidCatch=="function"&&(Ar.callback=function(){Mi(_r,Tr),typeof Rr!="function"&&(Si===null?Si=new Set([this]):Si.add(this));var Mr=Tr.stack;this.componentDidCatch(Tr.value,{componentStack:Mr!==null?Mr:""})}),Ar}function Ti(_r,Tr,Ar){var Rr=_r.pingCache;if(Rr===null){Rr=_r.pingCache=new Ni;var Pr=new Set;Rr.set(Tr,Pr)}else Pr=Rr.get(Tr),Pr===void 0&&(Pr=new Set,Rr.set(Tr,Pr));Pr.has(Ar)||(Pr.add(Ar),_r=Ui.bind(null,_r,Tr,Ar),Tr.then(_r,_r))}function Vi(_r){do{var Tr;if((Tr=_r.tag===13)&&(Tr=_r.memoizedState,Tr=Tr!==null?Tr.dehydrated!==null:!0),Tr)return _r;_r=_r.return}while(_r!==null);return null}function Wi(_r,Tr,Ar,Rr,Pr){return _r.mode&1?(_r.flags|=65536,_r.lanes=Pr,_r):(_r===Tr?_r.flags|=65536:(_r.flags|=128,Ar.flags|=131072,Ar.flags&=-52805,Ar.tag===1&&(Ar.alternate===null?Ar.tag=17:(Tr=ch(-1,1),Tr.tag=2,dh(Ar,Tr,1))),Ar.lanes|=1),_r)}var Xi=ua.ReactCurrentOwner,Ug=!1;function Yi(_r,Tr,Ar,Rr){Tr.child=_r===null?Ch(Tr,null,Ar,Rr):Bh(Tr,_r.child,Ar,Rr)}function Zi(_r,Tr,Ar,Rr,Pr){Ar=Ar.render;var Dr=Tr.ref;return Tg(Tr,Pr),Rr=Xh(_r,Tr,Ar,Rr,Dr,Pr),Ar=bi(),_r!==null&&!Ug?(Tr.updateQueue=_r.updateQueue,Tr.flags&=-2053,_r.lanes&=~Pr,$i(_r,Tr,Pr)):(I$3&&Ar&&vg(Tr),Tr.flags|=1,Yi(_r,Tr,Rr,Pr),Tr.child)}function aj(_r,Tr,Ar,Rr,Pr){if(_r===null){var Dr=Ar.type;return typeof Dr=="function"&&!bj(Dr)&&Dr.defaultProps===void 0&&Ar.compare===null&&Ar.defaultProps===void 0?(Tr.tag=15,Tr.type=Dr,cj(_r,Tr,Dr,Rr,Pr)):(_r=yh(Ar.type,null,Rr,Tr,Tr.mode,Pr),_r.ref=Tr.ref,_r.return=Tr,Tr.child=_r)}if(Dr=_r.child,!(_r.lanes&Pr)){var Mr=Dr.memoizedProps;if(Ar=Ar.compare,Ar=Ar!==null?Ar:Ie$2,Ar(Mr,Rr)&&_r.ref===Tr.ref)return $i(_r,Tr,Pr)}return Tr.flags|=1,_r=wh(Dr,Rr),_r.ref=Tr.ref,_r.return=Tr,Tr.child=_r}function cj(_r,Tr,Ar,Rr,Pr){if(_r!==null){var Dr=_r.memoizedProps;if(Ie$2(Dr,Rr)&&_r.ref===Tr.ref)if(Ug=!1,Tr.pendingProps=Rr=Dr,(_r.lanes&Pr)!==0)_r.flags&131072&&(Ug=!0);else return Tr.lanes=_r.lanes,$i(_r,Tr,Pr)}return dj(_r,Tr,Ar,Rr,Pr)}function ej(_r,Tr,Ar){var Rr=Tr.pendingProps,Pr=Rr.children,Dr=_r!==null?_r.memoizedState:null;if(Rr.mode==="hidden")if(!(Tr.mode&1))Tr.memoizedState={baseLanes:0,cachePool:null,transitions:null},G$4(fj,gj),gj|=Ar;else{if(!(Ar&1073741824))return _r=Dr!==null?Dr.baseLanes|Ar:Ar,Tr.lanes=Tr.childLanes=1073741824,Tr.memoizedState={baseLanes:_r,cachePool:null,transitions:null},Tr.updateQueue=null,G$4(fj,gj),gj|=_r,null;Tr.memoizedState={baseLanes:0,cachePool:null,transitions:null},Rr=Dr!==null?Dr.baseLanes:Ar,G$4(fj,gj),gj|=Rr}else Dr!==null?(Rr=Dr.baseLanes|Ar,Tr.memoizedState=null):Rr=Ar,G$4(fj,gj),gj|=Rr;return Yi(_r,Tr,Pr,Ar),Tr.child}function hj(_r,Tr){var Ar=Tr.ref;(_r===null&&Ar!==null||_r!==null&&_r.ref!==Ar)&&(Tr.flags|=512,Tr.flags|=2097152)}function dj(_r,Tr,Ar,Rr,Pr){var Dr=Zf(Ar)?Xf:H$3.current;return Dr=Yf(Tr,Dr),Tg(Tr,Pr),Ar=Xh(_r,Tr,Ar,Rr,Dr,Pr),Rr=bi(),_r!==null&&!Ug?(Tr.updateQueue=_r.updateQueue,Tr.flags&=-2053,_r.lanes&=~Pr,$i(_r,Tr,Pr)):(I$3&&Rr&&vg(Tr),Tr.flags|=1,Yi(_r,Tr,Ar,Pr),Tr.child)}function ij(_r,Tr,Ar,Rr,Pr){if(Zf(Ar)){var Dr=!0;cg(Tr)}else Dr=!1;if(Tg(Tr,Pr),Tr.stateNode===null)jj(_r,Tr),ph(Tr,Ar,Rr),rh(Tr,Ar,Rr,Pr),Rr=!0;else if(_r===null){var Mr=Tr.stateNode,Fr=Tr.memoizedProps;Mr.props=Fr;var zr=Mr.context,jr=Ar.contextType;typeof jr=="object"&&jr!==null?jr=Vg(jr):(jr=Zf(Ar)?Xf:H$3.current,jr=Yf(Tr,jr));var Gr=Ar.getDerivedStateFromProps,Nr=typeof Gr=="function"||typeof Mr.getSnapshotBeforeUpdate=="function";Nr||typeof Mr.UNSAFE_componentWillReceiveProps!="function"&&typeof Mr.componentWillReceiveProps!="function"||(Fr!==Rr||zr!==jr)&&qh(Tr,Mr,Rr,jr),$g=!1;var Lr=Tr.memoizedState;Mr.state=Lr,gh(Tr,Rr,Mr,Pr),zr=Tr.memoizedState,Fr!==Rr||Lr!==zr||Wf.current||$g?(typeof Gr=="function"&&(kh(Tr,Ar,Gr,Rr),zr=Tr.memoizedState),(Fr=$g||oh(Tr,Ar,Fr,Rr,Lr,zr,jr))?(Nr||typeof Mr.UNSAFE_componentWillMount!="function"&&typeof Mr.componentWillMount!="function"||(typeof Mr.componentWillMount=="function"&&Mr.componentWillMount(),typeof Mr.UNSAFE_componentWillMount=="function"&&Mr.UNSAFE_componentWillMount()),typeof Mr.componentDidMount=="function"&&(Tr.flags|=4194308)):(typeof Mr.componentDidMount=="function"&&(Tr.flags|=4194308),Tr.memoizedProps=Rr,Tr.memoizedState=zr),Mr.props=Rr,Mr.state=zr,Mr.context=jr,Rr=Fr):(typeof Mr.componentDidMount=="function"&&(Tr.flags|=4194308),Rr=!1)}else{Mr=Tr.stateNode,bh(_r,Tr),Fr=Tr.memoizedProps,jr=Tr.type===Tr.elementType?Fr:Lg(Tr.type,Fr),Mr.props=jr,Nr=Tr.pendingProps,Lr=Mr.context,zr=Ar.contextType,typeof zr=="object"&&zr!==null?zr=Vg(zr):(zr=Zf(Ar)?Xf:H$3.current,zr=Yf(Tr,zr));var Ur=Ar.getDerivedStateFromProps;(Gr=typeof Ur=="function"||typeof Mr.getSnapshotBeforeUpdate=="function")||typeof Mr.UNSAFE_componentWillReceiveProps!="function"&&typeof Mr.componentWillReceiveProps!="function"||(Fr!==Nr||Lr!==zr)&&qh(Tr,Mr,Rr,zr),$g=!1,Lr=Tr.memoizedState,Mr.state=Lr,gh(Tr,Rr,Mr,Pr);var Vr=Tr.memoizedState;Fr!==Nr||Lr!==Vr||Wf.current||$g?(typeof Ur=="function"&&(kh(Tr,Ar,Ur,Rr),Vr=Tr.memoizedState),(jr=$g||oh(Tr,Ar,jr,Rr,Lr,Vr,zr)||!1)?(Gr||typeof Mr.UNSAFE_componentWillUpdate!="function"&&typeof Mr.componentWillUpdate!="function"||(typeof Mr.componentWillUpdate=="function"&&Mr.componentWillUpdate(Rr,Vr,zr),typeof Mr.UNSAFE_componentWillUpdate=="function"&&Mr.UNSAFE_componentWillUpdate(Rr,Vr,zr)),typeof Mr.componentDidUpdate=="function"&&(Tr.flags|=4),typeof Mr.getSnapshotBeforeUpdate=="function"&&(Tr.flags|=1024)):(typeof Mr.componentDidUpdate!="function"||Fr===_r.memoizedProps&&Lr===_r.memoizedState||(Tr.flags|=4),typeof Mr.getSnapshotBeforeUpdate!="function"||Fr===_r.memoizedProps&&Lr===_r.memoizedState||(Tr.flags|=1024),Tr.memoizedProps=Rr,Tr.memoizedState=Vr),Mr.props=Rr,Mr.state=Vr,Mr.context=zr,Rr=jr):(typeof Mr.componentDidUpdate!="function"||Fr===_r.memoizedProps&&Lr===_r.memoizedState||(Tr.flags|=4),typeof Mr.getSnapshotBeforeUpdate!="function"||Fr===_r.memoizedProps&&Lr===_r.memoizedState||(Tr.flags|=1024),Rr=!1)}return kj(_r,Tr,Ar,Rr,Dr,Pr)}function kj(_r,Tr,Ar,Rr,Pr,Dr){hj(_r,Tr);var Mr=(Tr.flags&128)!==0;if(!Rr&&!Mr)return Pr&&dg(Tr,Ar,!1),$i(_r,Tr,Dr);Rr=Tr.stateNode,Xi.current=Tr;var Fr=Mr&&typeof Ar.getDerivedStateFromError!="function"?null:Rr.render();return Tr.flags|=1,_r!==null&&Mr?(Tr.child=Bh(Tr,_r.child,null,Dr),Tr.child=Bh(Tr,null,Fr,Dr)):Yi(_r,Tr,Fr,Dr),Tr.memoizedState=Rr.state,Pr&&dg(Tr,Ar,!0),Tr.child}function lj(_r){var Tr=_r.stateNode;Tr.pendingContext?ag(_r,Tr.pendingContext,Tr.pendingContext!==Tr.context):Tr.context&&ag(_r,Tr.context,!1),Ih(_r,Tr.containerInfo)}function mj(_r,Tr,Ar,Rr,Pr){return Ig(),Jg(Pr),Tr.flags|=256,Yi(_r,Tr,Ar,Rr),Tr.child}var nj={dehydrated:null,treeContext:null,retryLane:0};function oj(_r){return{baseLanes:_r,cachePool:null,transitions:null}}function pj(_r,Tr,Ar){var Rr=Tr.pendingProps,Pr=M$4.current,Dr=!1,Mr=(Tr.flags&128)!==0,Fr;if((Fr=Mr)||(Fr=_r!==null&&_r.memoizedState===null?!1:(Pr&2)!==0),Fr?(Dr=!0,Tr.flags&=-129):(_r===null||_r.memoizedState!==null)&&(Pr|=1),G$4(M$4,Pr&1),_r===null)return Eg(Tr),_r=Tr.memoizedState,_r!==null&&(_r=_r.dehydrated,_r!==null)?(Tr.mode&1?_r.data==="$!"?Tr.lanes=8:Tr.lanes=1073741824:Tr.lanes=1,null):(Mr=Rr.children,_r=Rr.fallback,Dr?(Rr=Tr.mode,Dr=Tr.child,Mr={mode:"hidden",children:Mr},!(Rr&1)&&Dr!==null?(Dr.childLanes=0,Dr.pendingProps=Mr):Dr=qj(Mr,Rr,0,null),_r=Ah(_r,Rr,Ar,null),Dr.return=Tr,_r.return=Tr,Dr.sibling=_r,Tr.child=Dr,Tr.child.memoizedState=oj(Ar),Tr.memoizedState=nj,_r):rj(Tr,Mr));if(Pr=_r.memoizedState,Pr!==null&&(Fr=Pr.dehydrated,Fr!==null))return sj(_r,Tr,Mr,Rr,Fr,Pr,Ar);if(Dr){Dr=Rr.fallback,Mr=Tr.mode,Pr=_r.child,Fr=Pr.sibling;var zr={mode:"hidden",children:Rr.children};return!(Mr&1)&&Tr.child!==Pr?(Rr=Tr.child,Rr.childLanes=0,Rr.pendingProps=zr,Tr.deletions=null):(Rr=wh(Pr,zr),Rr.subtreeFlags=Pr.subtreeFlags&14680064),Fr!==null?Dr=wh(Fr,Dr):(Dr=Ah(Dr,Mr,Ar,null),Dr.flags|=2),Dr.return=Tr,Rr.return=Tr,Rr.sibling=Dr,Tr.child=Rr,Rr=Dr,Dr=Tr.child,Mr=_r.child.memoizedState,Mr=Mr===null?oj(Ar):{baseLanes:Mr.baseLanes|Ar,cachePool:null,transitions:Mr.transitions},Dr.memoizedState=Mr,Dr.childLanes=_r.childLanes&~Ar,Tr.memoizedState=nj,Rr}return Dr=_r.child,_r=Dr.sibling,Rr=wh(Dr,{mode:"visible",children:Rr.children}),!(Tr.mode&1)&&(Rr.lanes=Ar),Rr.return=Tr,Rr.sibling=null,_r!==null&&(Ar=Tr.deletions,Ar===null?(Tr.deletions=[_r],Tr.flags|=16):Ar.push(_r)),Tr.child=Rr,Tr.memoizedState=null,Rr}function rj(_r,Tr){return Tr=qj({mode:"visible",children:Tr},_r.mode,0,null),Tr.return=_r,_r.child=Tr}function tj(_r,Tr,Ar,Rr){return Rr!==null&&Jg(Rr),Bh(Tr,_r.child,null,Ar),_r=rj(Tr,Tr.pendingProps.children),_r.flags|=2,Tr.memoizedState=null,_r}function sj(_r,Tr,Ar,Rr,Pr,Dr,Mr){if(Ar)return Tr.flags&256?(Tr.flags&=-257,Rr=Li(Error(p$3(422))),tj(_r,Tr,Mr,Rr)):Tr.memoizedState!==null?(Tr.child=_r.child,Tr.flags|=128,null):(Dr=Rr.fallback,Pr=Tr.mode,Rr=qj({mode:"visible",children:Rr.children},Pr,0,null),Dr=Ah(Dr,Pr,Mr,null),Dr.flags|=2,Rr.return=Tr,Dr.return=Tr,Rr.sibling=Dr,Tr.child=Rr,Tr.mode&1&&Bh(Tr,_r.child,null,Mr),Tr.child.memoizedState=oj(Mr),Tr.memoizedState=nj,Dr);if(!(Tr.mode&1))return tj(_r,Tr,Mr,null);if(Pr.data==="$!"){if(Rr=Pr.nextSibling&&Pr.nextSibling.dataset,Rr)var Fr=Rr.dgst;return Rr=Fr,Dr=Error(p$3(419)),Rr=Li(Dr,Rr,void 0),tj(_r,Tr,Mr,Rr)}if(Fr=(Mr&_r.childLanes)!==0,Ug||Fr){if(Rr=R$4,Rr!==null){switch(Mr&-Mr){case 4:Pr=2;break;case 16:Pr=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:Pr=32;break;case 536870912:Pr=268435456;break;default:Pr=0}Pr=Pr&(Rr.suspendedLanes|Mr)?0:Pr,Pr!==0&&Pr!==Dr.retryLane&&(Dr.retryLane=Pr,Zg(_r,Pr),mh(Rr,_r,Pr,-1))}return uj(),Rr=Li(Error(p$3(421))),tj(_r,Tr,Mr,Rr)}return Pr.data==="$?"?(Tr.flags|=128,Tr.child=_r.child,Tr=vj.bind(null,_r),Pr._reactRetry=Tr,null):(_r=Dr.treeContext,yg=Lf(Pr.nextSibling),xg=Tr,I$3=!0,zg=null,_r!==null&&(og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,rg=_r.id,sg=_r.overflow,qg=Tr),Tr=rj(Tr,Rr.children),Tr.flags|=4096,Tr)}function wj(_r,Tr,Ar){_r.lanes|=Tr;var Rr=_r.alternate;Rr!==null&&(Rr.lanes|=Tr),Sg(_r.return,Tr,Ar)}function xj(_r,Tr,Ar,Rr,Pr){var Dr=_r.memoizedState;Dr===null?_r.memoizedState={isBackwards:Tr,rendering:null,renderingStartTime:0,last:Rr,tail:Ar,tailMode:Pr}:(Dr.isBackwards=Tr,Dr.rendering=null,Dr.renderingStartTime=0,Dr.last=Rr,Dr.tail=Ar,Dr.tailMode=Pr)}function yj(_r,Tr,Ar){var Rr=Tr.pendingProps,Pr=Rr.revealOrder,Dr=Rr.tail;if(Yi(_r,Tr,Rr.children,Ar),Rr=M$4.current,Rr&2)Rr=Rr&1|2,Tr.flags|=128;else{if(_r!==null&&_r.flags&128)e:for(_r=Tr.child;_r!==null;){if(_r.tag===13)_r.memoizedState!==null&&wj(_r,Ar,Tr);else if(_r.tag===19)wj(_r,Ar,Tr);else if(_r.child!==null){_r.child.return=_r,_r=_r.child;continue}if(_r===Tr)break e;for(;_r.sibling===null;){if(_r.return===null||_r.return===Tr)break e;_r=_r.return}_r.sibling.return=_r.return,_r=_r.sibling}Rr&=1}if(G$4(M$4,Rr),!(Tr.mode&1))Tr.memoizedState=null;else switch(Pr){case"forwards":for(Ar=Tr.child,Pr=null;Ar!==null;)_r=Ar.alternate,_r!==null&&Mh(_r)===null&&(Pr=Ar),Ar=Ar.sibling;Ar=Pr,Ar===null?(Pr=Tr.child,Tr.child=null):(Pr=Ar.sibling,Ar.sibling=null),xj(Tr,!1,Pr,Ar,Dr);break;case"backwards":for(Ar=null,Pr=Tr.child,Tr.child=null;Pr!==null;){if(_r=Pr.alternate,_r!==null&&Mh(_r)===null){Tr.child=Pr;break}_r=Pr.sibling,Pr.sibling=Ar,Ar=Pr,Pr=_r}xj(Tr,!0,Ar,null,Dr);break;case"together":xj(Tr,!1,null,null,void 0);break;default:Tr.memoizedState=null}return Tr.child}function jj(_r,Tr){!(Tr.mode&1)&&_r!==null&&(_r.alternate=null,Tr.alternate=null,Tr.flags|=2)}function $i(_r,Tr,Ar){if(_r!==null&&(Tr.dependencies=_r.dependencies),hh|=Tr.lanes,!(Ar&Tr.childLanes))return null;if(_r!==null&&Tr.child!==_r.child)throw Error(p$3(153));if(Tr.child!==null){for(_r=Tr.child,Ar=wh(_r,_r.pendingProps),Tr.child=Ar,Ar.return=Tr;_r.sibling!==null;)_r=_r.sibling,Ar=Ar.sibling=wh(_r,_r.pendingProps),Ar.return=Tr;Ar.sibling=null}return Tr.child}function zj(_r,Tr,Ar){switch(Tr.tag){case 3:lj(Tr),Ig();break;case 5:Kh(Tr);break;case 1:Zf(Tr.type)&&cg(Tr);break;case 4:Ih(Tr,Tr.stateNode.containerInfo);break;case 10:var Rr=Tr.type._context,Pr=Tr.memoizedProps.value;G$4(Mg,Rr._currentValue),Rr._currentValue=Pr;break;case 13:if(Rr=Tr.memoizedState,Rr!==null)return Rr.dehydrated!==null?(G$4(M$4,M$4.current&1),Tr.flags|=128,null):Ar&Tr.child.childLanes?pj(_r,Tr,Ar):(G$4(M$4,M$4.current&1),_r=$i(_r,Tr,Ar),_r!==null?_r.sibling:null);G$4(M$4,M$4.current&1);break;case 19:if(Rr=(Ar&Tr.childLanes)!==0,_r.flags&128){if(Rr)return yj(_r,Tr,Ar);Tr.flags|=128}if(Pr=Tr.memoizedState,Pr!==null&&(Pr.rendering=null,Pr.tail=null,Pr.lastEffect=null),G$4(M$4,M$4.current),Rr)break;return null;case 22:case 23:return Tr.lanes=0,ej(_r,Tr,Ar)}return $i(_r,Tr,Ar)}var Aj,Bj,Cj,Dj;Aj=function(_r,Tr){for(var Ar=Tr.child;Ar!==null;){if(Ar.tag===5||Ar.tag===6)_r.appendChild(Ar.stateNode);else if(Ar.tag!==4&&Ar.child!==null){Ar.child.return=Ar,Ar=Ar.child;continue}if(Ar===Tr)break;for(;Ar.sibling===null;){if(Ar.return===null||Ar.return===Tr)return;Ar=Ar.return}Ar.sibling.return=Ar.return,Ar=Ar.sibling}};Bj=function(){};Cj=function(_r,Tr,Ar,Rr){var Pr=_r.memoizedProps;if(Pr!==Rr){_r=Tr.stateNode,Hh(Eh.current);var Dr=null;switch(Ar){case"input":Pr=Ya(_r,Pr),Rr=Ya(_r,Rr),Dr=[];break;case"select":Pr=A$3({},Pr,{value:void 0}),Rr=A$3({},Rr,{value:void 0}),Dr=[];break;case"textarea":Pr=gb(_r,Pr),Rr=gb(_r,Rr),Dr=[];break;default:typeof Pr.onClick!="function"&&typeof Rr.onClick=="function"&&(_r.onclick=Bf)}ub(Ar,Rr);var Mr;Ar=null;for(jr in Pr)if(!Rr.hasOwnProperty(jr)&&Pr.hasOwnProperty(jr)&&Pr[jr]!=null)if(jr==="style"){var Fr=Pr[jr];for(Mr in Fr)Fr.hasOwnProperty(Mr)&&(Ar||(Ar={}),Ar[Mr]="")}else jr!=="dangerouslySetInnerHTML"&&jr!=="children"&&jr!=="suppressContentEditableWarning"&&jr!=="suppressHydrationWarning"&&jr!=="autoFocus"&&(ea.hasOwnProperty(jr)?Dr||(Dr=[]):(Dr=Dr||[]).push(jr,null));for(jr in Rr){var zr=Rr[jr];if(Fr=Pr!=null?Pr[jr]:void 0,Rr.hasOwnProperty(jr)&&zr!==Fr&&(zr!=null||Fr!=null))if(jr==="style")if(Fr){for(Mr in Fr)!Fr.hasOwnProperty(Mr)||zr&&zr.hasOwnProperty(Mr)||(Ar||(Ar={}),Ar[Mr]="");for(Mr in zr)zr.hasOwnProperty(Mr)&&Fr[Mr]!==zr[Mr]&&(Ar||(Ar={}),Ar[Mr]=zr[Mr])}else Ar||(Dr||(Dr=[]),Dr.push(jr,Ar)),Ar=zr;else jr==="dangerouslySetInnerHTML"?(zr=zr?zr.__html:void 0,Fr=Fr?Fr.__html:void 0,zr!=null&&Fr!==zr&&(Dr=Dr||[]).push(jr,zr)):jr==="children"?typeof zr!="string"&&typeof zr!="number"||(Dr=Dr||[]).push(jr,""+zr):jr!=="suppressContentEditableWarning"&&jr!=="suppressHydrationWarning"&&(ea.hasOwnProperty(jr)?(zr!=null&&jr==="onScroll"&&D$3("scroll",_r),Dr||Fr===zr||(Dr=[])):(Dr=Dr||[]).push(jr,zr))}Ar&&(Dr=Dr||[]).push("style",Ar);var jr=Dr;(Tr.updateQueue=jr)&&(Tr.flags|=4)}};Dj=function(_r,Tr,Ar,Rr){Ar!==Rr&&(Tr.flags|=4)};function Ej(_r,Tr){if(!I$3)switch(_r.tailMode){case"hidden":Tr=_r.tail;for(var Ar=null;Tr!==null;)Tr.alternate!==null&&(Ar=Tr),Tr=Tr.sibling;Ar===null?_r.tail=null:Ar.sibling=null;break;case"collapsed":Ar=_r.tail;for(var Rr=null;Ar!==null;)Ar.alternate!==null&&(Rr=Ar),Ar=Ar.sibling;Rr===null?Tr||_r.tail===null?_r.tail=null:_r.tail.sibling=null:Rr.sibling=null}}function S$4(_r){var Tr=_r.alternate!==null&&_r.alternate.child===_r.child,Ar=0,Rr=0;if(Tr)for(var Pr=_r.child;Pr!==null;)Ar|=Pr.lanes|Pr.childLanes,Rr|=Pr.subtreeFlags&14680064,Rr|=Pr.flags&14680064,Pr.return=_r,Pr=Pr.sibling;else for(Pr=_r.child;Pr!==null;)Ar|=Pr.lanes|Pr.childLanes,Rr|=Pr.subtreeFlags,Rr|=Pr.flags,Pr.return=_r,Pr=Pr.sibling;return _r.subtreeFlags|=Rr,_r.childLanes=Ar,Tr}function Fj(_r,Tr,Ar){var Rr=Tr.pendingProps;switch(wg(Tr),Tr.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return S$4(Tr),null;case 1:return Zf(Tr.type)&&$f(),S$4(Tr),null;case 3:return Rr=Tr.stateNode,Jh(),E$3(Wf),E$3(H$3),Oh(),Rr.pendingContext&&(Rr.context=Rr.pendingContext,Rr.pendingContext=null),(_r===null||_r.child===null)&&(Gg(Tr)?Tr.flags|=4:_r===null||_r.memoizedState.isDehydrated&&!(Tr.flags&256)||(Tr.flags|=1024,zg!==null&&(Gj(zg),zg=null))),Bj(_r,Tr),S$4(Tr),null;case 5:Lh(Tr);var Pr=Hh(Gh.current);if(Ar=Tr.type,_r!==null&&Tr.stateNode!=null)Cj(_r,Tr,Ar,Rr,Pr),_r.ref!==Tr.ref&&(Tr.flags|=512,Tr.flags|=2097152);else{if(!Rr){if(Tr.stateNode===null)throw Error(p$3(166));return S$4(Tr),null}if(_r=Hh(Eh.current),Gg(Tr)){Rr=Tr.stateNode,Ar=Tr.type;var Dr=Tr.memoizedProps;switch(Rr[Of]=Tr,Rr[Pf]=Dr,_r=(Tr.mode&1)!==0,Ar){case"dialog":D$3("cancel",Rr),D$3("close",Rr);break;case"iframe":case"object":case"embed":D$3("load",Rr);break;case"video":case"audio":for(Pr=0;Pr<lf.length;Pr++)D$3(lf[Pr],Rr);break;case"source":D$3("error",Rr);break;case"img":case"image":case"link":D$3("error",Rr),D$3("load",Rr);break;case"details":D$3("toggle",Rr);break;case"input":Za(Rr,Dr),D$3("invalid",Rr);break;case"select":Rr._wrapperState={wasMultiple:!!Dr.multiple},D$3("invalid",Rr);break;case"textarea":hb(Rr,Dr),D$3("invalid",Rr)}ub(Ar,Dr),Pr=null;for(var Mr in Dr)if(Dr.hasOwnProperty(Mr)){var Fr=Dr[Mr];Mr==="children"?typeof Fr=="string"?Rr.textContent!==Fr&&(Dr.suppressHydrationWarning!==!0&&Af(Rr.textContent,Fr,_r),Pr=["children",Fr]):typeof Fr=="number"&&Rr.textContent!==""+Fr&&(Dr.suppressHydrationWarning!==!0&&Af(Rr.textContent,Fr,_r),Pr=["children",""+Fr]):ea.hasOwnProperty(Mr)&&Fr!=null&&Mr==="onScroll"&&D$3("scroll",Rr)}switch(Ar){case"input":Va(Rr),db(Rr,Dr,!0);break;case"textarea":Va(Rr),jb(Rr);break;case"select":case"option":break;default:typeof Dr.onClick=="function"&&(Rr.onclick=Bf)}Rr=Pr,Tr.updateQueue=Rr,Rr!==null&&(Tr.flags|=4)}else{Mr=Pr.nodeType===9?Pr:Pr.ownerDocument,_r==="http://www.w3.org/1999/xhtml"&&(_r=kb(Ar)),_r==="http://www.w3.org/1999/xhtml"?Ar==="script"?(_r=Mr.createElement("div"),_r.innerHTML="<script><\/script>",_r=_r.removeChild(_r.firstChild)):typeof Rr.is=="string"?_r=Mr.createElement(Ar,{is:Rr.is}):(_r=Mr.createElement(Ar),Ar==="select"&&(Mr=_r,Rr.multiple?Mr.multiple=!0:Rr.size&&(Mr.size=Rr.size))):_r=Mr.createElementNS(_r,Ar),_r[Of]=Tr,_r[Pf]=Rr,Aj(_r,Tr,!1,!1),Tr.stateNode=_r;e:{switch(Mr=vb(Ar,Rr),Ar){case"dialog":D$3("cancel",_r),D$3("close",_r),Pr=Rr;break;case"iframe":case"object":case"embed":D$3("load",_r),Pr=Rr;break;case"video":case"audio":for(Pr=0;Pr<lf.length;Pr++)D$3(lf[Pr],_r);Pr=Rr;break;case"source":D$3("error",_r),Pr=Rr;break;case"img":case"image":case"link":D$3("error",_r),D$3("load",_r),Pr=Rr;break;case"details":D$3("toggle",_r),Pr=Rr;break;case"input":Za(_r,Rr),Pr=Ya(_r,Rr),D$3("invalid",_r);break;case"option":Pr=Rr;break;case"select":_r._wrapperState={wasMultiple:!!Rr.multiple},Pr=A$3({},Rr,{value:void 0}),D$3("invalid",_r);break;case"textarea":hb(_r,Rr),Pr=gb(_r,Rr),D$3("invalid",_r);break;default:Pr=Rr}ub(Ar,Pr),Fr=Pr;for(Dr in Fr)if(Fr.hasOwnProperty(Dr)){var zr=Fr[Dr];Dr==="style"?sb(_r,zr):Dr==="dangerouslySetInnerHTML"?(zr=zr?zr.__html:void 0,zr!=null&&nb(_r,zr)):Dr==="children"?typeof zr=="string"?(Ar!=="textarea"||zr!=="")&&ob(_r,zr):typeof zr=="number"&&ob(_r,""+zr):Dr!=="suppressContentEditableWarning"&&Dr!=="suppressHydrationWarning"&&Dr!=="autoFocus"&&(ea.hasOwnProperty(Dr)?zr!=null&&Dr==="onScroll"&&D$3("scroll",_r):zr!=null&&ta(_r,Dr,zr,Mr))}switch(Ar){case"input":Va(_r),db(_r,Rr,!1);break;case"textarea":Va(_r),jb(_r);break;case"option":Rr.value!=null&&_r.setAttribute("value",""+Sa(Rr.value));break;case"select":_r.multiple=!!Rr.multiple,Dr=Rr.value,Dr!=null?fb(_r,!!Rr.multiple,Dr,!1):Rr.defaultValue!=null&&fb(_r,!!Rr.multiple,Rr.defaultValue,!0);break;default:typeof Pr.onClick=="function"&&(_r.onclick=Bf)}switch(Ar){case"button":case"input":case"select":case"textarea":Rr=!!Rr.autoFocus;break e;case"img":Rr=!0;break e;default:Rr=!1}}Rr&&(Tr.flags|=4)}Tr.ref!==null&&(Tr.flags|=512,Tr.flags|=2097152)}return S$4(Tr),null;case 6:if(_r&&Tr.stateNode!=null)Dj(_r,Tr,_r.memoizedProps,Rr);else{if(typeof Rr!="string"&&Tr.stateNode===null)throw Error(p$3(166));if(Ar=Hh(Gh.current),Hh(Eh.current),Gg(Tr)){if(Rr=Tr.stateNode,Ar=Tr.memoizedProps,Rr[Of]=Tr,(Dr=Rr.nodeValue!==Ar)&&(_r=xg,_r!==null))switch(_r.tag){case 3:Af(Rr.nodeValue,Ar,(_r.mode&1)!==0);break;case 5:_r.memoizedProps.suppressHydrationWarning!==!0&&Af(Rr.nodeValue,Ar,(_r.mode&1)!==0)}Dr&&(Tr.flags|=4)}else Rr=(Ar.nodeType===9?Ar:Ar.ownerDocument).createTextNode(Rr),Rr[Of]=Tr,Tr.stateNode=Rr}return S$4(Tr),null;case 13:if(E$3(M$4),Rr=Tr.memoizedState,_r===null||_r.memoizedState!==null&&_r.memoizedState.dehydrated!==null){if(I$3&&yg!==null&&Tr.mode&1&&!(Tr.flags&128))Hg(),Ig(),Tr.flags|=98560,Dr=!1;else if(Dr=Gg(Tr),Rr!==null&&Rr.dehydrated!==null){if(_r===null){if(!Dr)throw Error(p$3(318));if(Dr=Tr.memoizedState,Dr=Dr!==null?Dr.dehydrated:null,!Dr)throw Error(p$3(317));Dr[Of]=Tr}else Ig(),!(Tr.flags&128)&&(Tr.memoizedState=null),Tr.flags|=4;S$4(Tr),Dr=!1}else zg!==null&&(Gj(zg),zg=null),Dr=!0;if(!Dr)return Tr.flags&65536?Tr:null}return Tr.flags&128?(Tr.lanes=Ar,Tr):(Rr=Rr!==null,Rr!==(_r!==null&&_r.memoizedState!==null)&&Rr&&(Tr.child.flags|=8192,Tr.mode&1&&(_r===null||M$4.current&1?T$3===0&&(T$3=3):uj())),Tr.updateQueue!==null&&(Tr.flags|=4),S$4(Tr),null);case 4:return Jh(),Bj(_r,Tr),_r===null&&sf(Tr.stateNode.containerInfo),S$4(Tr),null;case 10:return Rg(Tr.type._context),S$4(Tr),null;case 17:return Zf(Tr.type)&&$f(),S$4(Tr),null;case 19:if(E$3(M$4),Dr=Tr.memoizedState,Dr===null)return S$4(Tr),null;if(Rr=(Tr.flags&128)!==0,Mr=Dr.rendering,Mr===null)if(Rr)Ej(Dr,!1);else{if(T$3!==0||_r!==null&&_r.flags&128)for(_r=Tr.child;_r!==null;){if(Mr=Mh(_r),Mr!==null){for(Tr.flags|=128,Ej(Dr,!1),Rr=Mr.updateQueue,Rr!==null&&(Tr.updateQueue=Rr,Tr.flags|=4),Tr.subtreeFlags=0,Rr=Ar,Ar=Tr.child;Ar!==null;)Dr=Ar,_r=Rr,Dr.flags&=14680066,Mr=Dr.alternate,Mr===null?(Dr.childLanes=0,Dr.lanes=_r,Dr.child=null,Dr.subtreeFlags=0,Dr.memoizedProps=null,Dr.memoizedState=null,Dr.updateQueue=null,Dr.dependencies=null,Dr.stateNode=null):(Dr.childLanes=Mr.childLanes,Dr.lanes=Mr.lanes,Dr.child=Mr.child,Dr.subtreeFlags=0,Dr.deletions=null,Dr.memoizedProps=Mr.memoizedProps,Dr.memoizedState=Mr.memoizedState,Dr.updateQueue=Mr.updateQueue,Dr.type=Mr.type,_r=Mr.dependencies,Dr.dependencies=_r===null?null:{lanes:_r.lanes,firstContext:_r.firstContext}),Ar=Ar.sibling;return G$4(M$4,M$4.current&1|2),Tr.child}_r=_r.sibling}Dr.tail!==null&&B$3()>Hj&&(Tr.flags|=128,Rr=!0,Ej(Dr,!1),Tr.lanes=4194304)}else{if(!Rr)if(_r=Mh(Mr),_r!==null){if(Tr.flags|=128,Rr=!0,Ar=_r.updateQueue,Ar!==null&&(Tr.updateQueue=Ar,Tr.flags|=4),Ej(Dr,!0),Dr.tail===null&&Dr.tailMode==="hidden"&&!Mr.alternate&&!I$3)return S$4(Tr),null}else 2*B$3()-Dr.renderingStartTime>Hj&&Ar!==1073741824&&(Tr.flags|=128,Rr=!0,Ej(Dr,!1),Tr.lanes=4194304);Dr.isBackwards?(Mr.sibling=Tr.child,Tr.child=Mr):(Ar=Dr.last,Ar!==null?Ar.sibling=Mr:Tr.child=Mr,Dr.last=Mr)}return Dr.tail!==null?(Tr=Dr.tail,Dr.rendering=Tr,Dr.tail=Tr.sibling,Dr.renderingStartTime=B$3(),Tr.sibling=null,Ar=M$4.current,G$4(M$4,Rr?Ar&1|2:Ar&1),Tr):(S$4(Tr),null);case 22:case 23:return Ij(),Rr=Tr.memoizedState!==null,_r!==null&&_r.memoizedState!==null!==Rr&&(Tr.flags|=8192),Rr&&Tr.mode&1?gj&1073741824&&(S$4(Tr),Tr.subtreeFlags&6&&(Tr.flags|=8192)):S$4(Tr),null;case 24:return null;case 25:return null}throw Error(p$3(156,Tr.tag))}function Jj(_r,Tr){switch(wg(Tr),Tr.tag){case 1:return Zf(Tr.type)&&$f(),_r=Tr.flags,_r&65536?(Tr.flags=_r&-65537|128,Tr):null;case 3:return Jh(),E$3(Wf),E$3(H$3),Oh(),_r=Tr.flags,_r&65536&&!(_r&128)?(Tr.flags=_r&-65537|128,Tr):null;case 5:return Lh(Tr),null;case 13:if(E$3(M$4),_r=Tr.memoizedState,_r!==null&&_r.dehydrated!==null){if(Tr.alternate===null)throw Error(p$3(340));Ig()}return _r=Tr.flags,_r&65536?(Tr.flags=_r&-65537|128,Tr):null;case 19:return E$3(M$4),null;case 4:return Jh(),null;case 10:return Rg(Tr.type._context),null;case 22:case 23:return Ij(),null;case 24:return null;default:return null}}var Kj=!1,U$4=!1,Lj=typeof WeakSet=="function"?WeakSet:Set,V$4=null;function Mj(_r,Tr){var Ar=_r.ref;if(Ar!==null)if(typeof Ar=="function")try{Ar(null)}catch(Rr){W$4(_r,Tr,Rr)}else Ar.current=null}function Nj(_r,Tr,Ar){try{Ar()}catch(Rr){W$4(_r,Tr,Rr)}}var Oj=!1;function Pj(_r,Tr){if(Cf=dd,_r=Me$2(),Ne$1(_r)){if("selectionStart"in _r)var Ar={start:_r.selectionStart,end:_r.selectionEnd};else e:{Ar=(Ar=_r.ownerDocument)&&Ar.defaultView||window;var Rr=Ar.getSelection&&Ar.getSelection();if(Rr&&Rr.rangeCount!==0){Ar=Rr.anchorNode;var Pr=Rr.anchorOffset,Dr=Rr.focusNode;Rr=Rr.focusOffset;try{Ar.nodeType,Dr.nodeType}catch{Ar=null;break e}var Mr=0,Fr=-1,zr=-1,jr=0,Gr=0,Nr=_r,Lr=null;t:for(;;){for(var Ur;Nr!==Ar||Pr!==0&&Nr.nodeType!==3||(Fr=Mr+Pr),Nr!==Dr||Rr!==0&&Nr.nodeType!==3||(zr=Mr+Rr),Nr.nodeType===3&&(Mr+=Nr.nodeValue.length),(Ur=Nr.firstChild)!==null;)Lr=Nr,Nr=Ur;for(;;){if(Nr===_r)break t;if(Lr===Ar&&++jr===Pr&&(Fr=Mr),Lr===Dr&&++Gr===Rr&&(zr=Mr),(Ur=Nr.nextSibling)!==null)break;Nr=Lr,Lr=Nr.parentNode}Nr=Ur}Ar=Fr===-1||zr===-1?null:{start:Fr,end:zr}}else Ar=null}Ar=Ar||{start:0,end:0}}else Ar=null;for(Df={focusedElem:_r,selectionRange:Ar},dd=!1,V$4=Tr;V$4!==null;)if(Tr=V$4,_r=Tr.child,(Tr.subtreeFlags&1028)!==0&&_r!==null)_r.return=Tr,V$4=_r;else for(;V$4!==null;){Tr=V$4;try{var Vr=Tr.alternate;if(Tr.flags&1024)switch(Tr.tag){case 0:case 11:case 15:break;case 1:if(Vr!==null){var Wr=Vr.memoizedProps,qr=Vr.memoizedState,Kr=Tr.stateNode,Xr=Kr.getSnapshotBeforeUpdate(Tr.elementType===Tr.type?Wr:Lg(Tr.type,Wr),qr);Kr.__reactInternalSnapshotBeforeUpdate=Xr}break;case 3:var Zr=Tr.stateNode.containerInfo;Zr.nodeType===1?Zr.textContent="":Zr.nodeType===9&&Zr.documentElement&&Zr.removeChild(Zr.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(p$3(163))}}catch(_i){W$4(Tr,Tr.return,_i)}if(_r=Tr.sibling,_r!==null){_r.return=Tr.return,V$4=_r;break}V$4=Tr.return}return Vr=Oj,Oj=!1,Vr}function Qj(_r,Tr,Ar){var Rr=Tr.updateQueue;if(Rr=Rr!==null?Rr.lastEffect:null,Rr!==null){var Pr=Rr=Rr.next;do{if((Pr.tag&_r)===_r){var Dr=Pr.destroy;Pr.destroy=void 0,Dr!==void 0&&Nj(Tr,Ar,Dr)}Pr=Pr.next}while(Pr!==Rr)}}function Rj(_r,Tr){if(Tr=Tr.updateQueue,Tr=Tr!==null?Tr.lastEffect:null,Tr!==null){var Ar=Tr=Tr.next;do{if((Ar.tag&_r)===_r){var Rr=Ar.create;Ar.destroy=Rr()}Ar=Ar.next}while(Ar!==Tr)}}function Sj(_r){var Tr=_r.ref;if(Tr!==null){var Ar=_r.stateNode;switch(_r.tag){case 5:_r=Ar;break;default:_r=Ar}typeof Tr=="function"?Tr(_r):Tr.current=_r}}function Tj(_r){var Tr=_r.alternate;Tr!==null&&(_r.alternate=null,Tj(Tr)),_r.child=null,_r.deletions=null,_r.sibling=null,_r.tag===5&&(Tr=_r.stateNode,Tr!==null&&(delete Tr[Of],delete Tr[Pf],delete Tr[of],delete Tr[Qf],delete Tr[Rf])),_r.stateNode=null,_r.return=null,_r.dependencies=null,_r.memoizedProps=null,_r.memoizedState=null,_r.pendingProps=null,_r.stateNode=null,_r.updateQueue=null}function Uj(_r){return _r.tag===5||_r.tag===3||_r.tag===4}function Vj(_r){e:for(;;){for(;_r.sibling===null;){if(_r.return===null||Uj(_r.return))return null;_r=_r.return}for(_r.sibling.return=_r.return,_r=_r.sibling;_r.tag!==5&&_r.tag!==6&&_r.tag!==18;){if(_r.flags&2||_r.child===null||_r.tag===4)continue e;_r.child.return=_r,_r=_r.child}if(!(_r.flags&2))return _r.stateNode}}function Wj(_r,Tr,Ar){var Rr=_r.tag;if(Rr===5||Rr===6)_r=_r.stateNode,Tr?Ar.nodeType===8?Ar.parentNode.insertBefore(_r,Tr):Ar.insertBefore(_r,Tr):(Ar.nodeType===8?(Tr=Ar.parentNode,Tr.insertBefore(_r,Ar)):(Tr=Ar,Tr.appendChild(_r)),Ar=Ar._reactRootContainer,Ar!=null||Tr.onclick!==null||(Tr.onclick=Bf));else if(Rr!==4&&(_r=_r.child,_r!==null))for(Wj(_r,Tr,Ar),_r=_r.sibling;_r!==null;)Wj(_r,Tr,Ar),_r=_r.sibling}function Xj(_r,Tr,Ar){var Rr=_r.tag;if(Rr===5||Rr===6)_r=_r.stateNode,Tr?Ar.insertBefore(_r,Tr):Ar.appendChild(_r);else if(Rr!==4&&(_r=_r.child,_r!==null))for(Xj(_r,Tr,Ar),_r=_r.sibling;_r!==null;)Xj(_r,Tr,Ar),_r=_r.sibling}var X$4=null,Yj=!1;function Zj(_r,Tr,Ar){for(Ar=Ar.child;Ar!==null;)ak(_r,Tr,Ar),Ar=Ar.sibling}function ak(_r,Tr,Ar){if(lc&&typeof lc.onCommitFiberUnmount=="function")try{lc.onCommitFiberUnmount(kc,Ar)}catch{}switch(Ar.tag){case 5:U$4||Mj(Ar,Tr);case 6:var Rr=X$4,Pr=Yj;X$4=null,Zj(_r,Tr,Ar),X$4=Rr,Yj=Pr,X$4!==null&&(Yj?(_r=X$4,Ar=Ar.stateNode,_r.nodeType===8?_r.parentNode.removeChild(Ar):_r.removeChild(Ar)):X$4.removeChild(Ar.stateNode));break;case 18:X$4!==null&&(Yj?(_r=X$4,Ar=Ar.stateNode,_r.nodeType===8?Kf(_r.parentNode,Ar):_r.nodeType===1&&Kf(_r,Ar),bd(_r)):Kf(X$4,Ar.stateNode));break;case 4:Rr=X$4,Pr=Yj,X$4=Ar.stateNode.containerInfo,Yj=!0,Zj(_r,Tr,Ar),X$4=Rr,Yj=Pr;break;case 0:case 11:case 14:case 15:if(!U$4&&(Rr=Ar.updateQueue,Rr!==null&&(Rr=Rr.lastEffect,Rr!==null))){Pr=Rr=Rr.next;do{var Dr=Pr,Mr=Dr.destroy;Dr=Dr.tag,Mr!==void 0&&(Dr&2||Dr&4)&&Nj(Ar,Tr,Mr),Pr=Pr.next}while(Pr!==Rr)}Zj(_r,Tr,Ar);break;case 1:if(!U$4&&(Mj(Ar,Tr),Rr=Ar.stateNode,typeof Rr.componentWillUnmount=="function"))try{Rr.props=Ar.memoizedProps,Rr.state=Ar.memoizedState,Rr.componentWillUnmount()}catch(Fr){W$4(Ar,Tr,Fr)}Zj(_r,Tr,Ar);break;case 21:Zj(_r,Tr,Ar);break;case 22:Ar.mode&1?(U$4=(Rr=U$4)||Ar.memoizedState!==null,Zj(_r,Tr,Ar),U$4=Rr):Zj(_r,Tr,Ar);break;default:Zj(_r,Tr,Ar)}}function bk(_r){var Tr=_r.updateQueue;if(Tr!==null){_r.updateQueue=null;var Ar=_r.stateNode;Ar===null&&(Ar=_r.stateNode=new Lj),Tr.forEach(function(Rr){var Pr=ck.bind(null,_r,Rr);Ar.has(Rr)||(Ar.add(Rr),Rr.then(Pr,Pr))})}}function dk(_r,Tr){var Ar=Tr.deletions;if(Ar!==null)for(var Rr=0;Rr<Ar.length;Rr++){var Pr=Ar[Rr];try{var Dr=_r,Mr=Tr,Fr=Mr;e:for(;Fr!==null;){switch(Fr.tag){case 5:X$4=Fr.stateNode,Yj=!1;break e;case 3:X$4=Fr.stateNode.containerInfo,Yj=!0;break e;case 4:X$4=Fr.stateNode.containerInfo,Yj=!0;break e}Fr=Fr.return}if(X$4===null)throw Error(p$3(160));ak(Dr,Mr,Pr),X$4=null,Yj=!1;var zr=Pr.alternate;zr!==null&&(zr.return=null),Pr.return=null}catch(jr){W$4(Pr,Tr,jr)}}if(Tr.subtreeFlags&12854)for(Tr=Tr.child;Tr!==null;)ek(Tr,_r),Tr=Tr.sibling}function ek(_r,Tr){var Ar=_r.alternate,Rr=_r.flags;switch(_r.tag){case 0:case 11:case 14:case 15:if(dk(Tr,_r),fk(_r),Rr&4){try{Qj(3,_r,_r.return),Rj(3,_r)}catch(Wr){W$4(_r,_r.return,Wr)}try{Qj(5,_r,_r.return)}catch(Wr){W$4(_r,_r.return,Wr)}}break;case 1:dk(Tr,_r),fk(_r),Rr&512&&Ar!==null&&Mj(Ar,Ar.return);break;case 5:if(dk(Tr,_r),fk(_r),Rr&512&&Ar!==null&&Mj(Ar,Ar.return),_r.flags&32){var Pr=_r.stateNode;try{ob(Pr,"")}catch(Wr){W$4(_r,_r.return,Wr)}}if(Rr&4&&(Pr=_r.stateNode,Pr!=null)){var Dr=_r.memoizedProps,Mr=Ar!==null?Ar.memoizedProps:Dr,Fr=_r.type,zr=_r.updateQueue;if(_r.updateQueue=null,zr!==null)try{Fr==="input"&&Dr.type==="radio"&&Dr.name!=null&&ab(Pr,Dr),vb(Fr,Mr);var jr=vb(Fr,Dr);for(Mr=0;Mr<zr.length;Mr+=2){var Gr=zr[Mr],Nr=zr[Mr+1];Gr==="style"?sb(Pr,Nr):Gr==="dangerouslySetInnerHTML"?nb(Pr,Nr):Gr==="children"?ob(Pr,Nr):ta(Pr,Gr,Nr,jr)}switch(Fr){case"input":bb(Pr,Dr);break;case"textarea":ib(Pr,Dr);break;case"select":var Lr=Pr._wrapperState.wasMultiple;Pr._wrapperState.wasMultiple=!!Dr.multiple;var Ur=Dr.value;Ur!=null?fb(Pr,!!Dr.multiple,Ur,!1):Lr!==!!Dr.multiple&&(Dr.defaultValue!=null?fb(Pr,!!Dr.multiple,Dr.defaultValue,!0):fb(Pr,!!Dr.multiple,Dr.multiple?[]:"",!1))}Pr[Pf]=Dr}catch(Wr){W$4(_r,_r.return,Wr)}}break;case 6:if(dk(Tr,_r),fk(_r),Rr&4){if(_r.stateNode===null)throw Error(p$3(162));Pr=_r.stateNode,Dr=_r.memoizedProps;try{Pr.nodeValue=Dr}catch(Wr){W$4(_r,_r.return,Wr)}}break;case 3:if(dk(Tr,_r),fk(_r),Rr&4&&Ar!==null&&Ar.memoizedState.isDehydrated)try{bd(Tr.containerInfo)}catch(Wr){W$4(_r,_r.return,Wr)}break;case 4:dk(Tr,_r),fk(_r);break;case 13:dk(Tr,_r),fk(_r),Pr=_r.child,Pr.flags&8192&&(Dr=Pr.memoizedState!==null,Pr.stateNode.isHidden=Dr,!Dr||Pr.alternate!==null&&Pr.alternate.memoizedState!==null||(gk=B$3())),Rr&4&&bk(_r);break;case 22:if(Gr=Ar!==null&&Ar.memoizedState!==null,_r.mode&1?(U$4=(jr=U$4)||Gr,dk(Tr,_r),U$4=jr):dk(Tr,_r),fk(_r),Rr&8192){if(jr=_r.memoizedState!==null,(_r.stateNode.isHidden=jr)&&!Gr&&_r.mode&1)for(V$4=_r,Gr=_r.child;Gr!==null;){for(Nr=V$4=Gr;V$4!==null;){switch(Lr=V$4,Ur=Lr.child,Lr.tag){case 0:case 11:case 14:case 15:Qj(4,Lr,Lr.return);break;case 1:Mj(Lr,Lr.return);var Vr=Lr.stateNode;if(typeof Vr.componentWillUnmount=="function"){Rr=Lr,Ar=Lr.return;try{Tr=Rr,Vr.props=Tr.memoizedProps,Vr.state=Tr.memoizedState,Vr.componentWillUnmount()}catch(Wr){W$4(Rr,Ar,Wr)}}break;case 5:Mj(Lr,Lr.return);break;case 22:if(Lr.memoizedState!==null){hk(Nr);continue}}Ur!==null?(Ur.return=Lr,V$4=Ur):hk(Nr)}Gr=Gr.sibling}e:for(Gr=null,Nr=_r;;){if(Nr.tag===5){if(Gr===null){Gr=Nr;try{Pr=Nr.stateNode,jr?(Dr=Pr.style,typeof Dr.setProperty=="function"?Dr.setProperty("display","none","important"):Dr.display="none"):(Fr=Nr.stateNode,zr=Nr.memoizedProps.style,Mr=zr!=null&&zr.hasOwnProperty("display")?zr.display:null,Fr.style.display=rb("display",Mr))}catch(Wr){W$4(_r,_r.return,Wr)}}}else if(Nr.tag===6){if(Gr===null)try{Nr.stateNode.nodeValue=jr?"":Nr.memoizedProps}catch(Wr){W$4(_r,_r.return,Wr)}}else if((Nr.tag!==22&&Nr.tag!==23||Nr.memoizedState===null||Nr===_r)&&Nr.child!==null){Nr.child.return=Nr,Nr=Nr.child;continue}if(Nr===_r)break e;for(;Nr.sibling===null;){if(Nr.return===null||Nr.return===_r)break e;Gr===Nr&&(Gr=null),Nr=Nr.return}Gr===Nr&&(Gr=null),Nr.sibling.return=Nr.return,Nr=Nr.sibling}}break;case 19:dk(Tr,_r),fk(_r),Rr&4&&bk(_r);break;case 21:break;default:dk(Tr,_r),fk(_r)}}function fk(_r){var Tr=_r.flags;if(Tr&2){try{e:{for(var Ar=_r.return;Ar!==null;){if(Uj(Ar)){var Rr=Ar;break e}Ar=Ar.return}throw Error(p$3(160))}switch(Rr.tag){case 5:var Pr=Rr.stateNode;Rr.flags&32&&(ob(Pr,""),Rr.flags&=-33);var Dr=Vj(_r);Xj(_r,Dr,Pr);break;case 3:case 4:var Mr=Rr.stateNode.containerInfo,Fr=Vj(_r);Wj(_r,Fr,Mr);break;default:throw Error(p$3(161))}}catch(zr){W$4(_r,_r.return,zr)}_r.flags&=-3}Tr&4096&&(_r.flags&=-4097)}function ik(_r,Tr,Ar){V$4=_r,jk(_r)}function jk(_r,Tr,Ar){for(var Rr=(_r.mode&1)!==0;V$4!==null;){var Pr=V$4,Dr=Pr.child;if(Pr.tag===22&&Rr){var Mr=Pr.memoizedState!==null||Kj;if(!Mr){var Fr=Pr.alternate,zr=Fr!==null&&Fr.memoizedState!==null||U$4;Fr=Kj;var jr=U$4;if(Kj=Mr,(U$4=zr)&&!jr)for(V$4=Pr;V$4!==null;)Mr=V$4,zr=Mr.child,Mr.tag===22&&Mr.memoizedState!==null?kk(Pr):zr!==null?(zr.return=Mr,V$4=zr):kk(Pr);for(;Dr!==null;)V$4=Dr,jk(Dr),Dr=Dr.sibling;V$4=Pr,Kj=Fr,U$4=jr}lk(_r)}else Pr.subtreeFlags&8772&&Dr!==null?(Dr.return=Pr,V$4=Dr):lk(_r)}}function lk(_r){for(;V$4!==null;){var Tr=V$4;if(Tr.flags&8772){var Ar=Tr.alternate;try{if(Tr.flags&8772)switch(Tr.tag){case 0:case 11:case 15:U$4||Rj(5,Tr);break;case 1:var Rr=Tr.stateNode;if(Tr.flags&4&&!U$4)if(Ar===null)Rr.componentDidMount();else{var Pr=Tr.elementType===Tr.type?Ar.memoizedProps:Lg(Tr.type,Ar.memoizedProps);Rr.componentDidUpdate(Pr,Ar.memoizedState,Rr.__reactInternalSnapshotBeforeUpdate)}var Dr=Tr.updateQueue;Dr!==null&&ih(Tr,Dr,Rr);break;case 3:var Mr=Tr.updateQueue;if(Mr!==null){if(Ar=null,Tr.child!==null)switch(Tr.child.tag){case 5:Ar=Tr.child.stateNode;break;case 1:Ar=Tr.child.stateNode}ih(Tr,Mr,Ar)}break;case 5:var Fr=Tr.stateNode;if(Ar===null&&Tr.flags&4){Ar=Fr;var zr=Tr.memoizedProps;switch(Tr.type){case"button":case"input":case"select":case"textarea":zr.autoFocus&&Ar.focus();break;case"img":zr.src&&(Ar.src=zr.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(Tr.memoizedState===null){var jr=Tr.alternate;if(jr!==null){var Gr=jr.memoizedState;if(Gr!==null){var Nr=Gr.dehydrated;Nr!==null&&bd(Nr)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(p$3(163))}U$4||Tr.flags&512&&Sj(Tr)}catch(Lr){W$4(Tr,Tr.return,Lr)}}if(Tr===_r){V$4=null;break}if(Ar=Tr.sibling,Ar!==null){Ar.return=Tr.return,V$4=Ar;break}V$4=Tr.return}}function hk(_r){for(;V$4!==null;){var Tr=V$4;if(Tr===_r){V$4=null;break}var Ar=Tr.sibling;if(Ar!==null){Ar.return=Tr.return,V$4=Ar;break}V$4=Tr.return}}function kk(_r){for(;V$4!==null;){var Tr=V$4;try{switch(Tr.tag){case 0:case 11:case 15:var Ar=Tr.return;try{Rj(4,Tr)}catch(zr){W$4(Tr,Ar,zr)}break;case 1:var Rr=Tr.stateNode;if(typeof Rr.componentDidMount=="function"){var Pr=Tr.return;try{Rr.componentDidMount()}catch(zr){W$4(Tr,Pr,zr)}}var Dr=Tr.return;try{Sj(Tr)}catch(zr){W$4(Tr,Dr,zr)}break;case 5:var Mr=Tr.return;try{Sj(Tr)}catch(zr){W$4(Tr,Mr,zr)}}}catch(zr){W$4(Tr,Tr.return,zr)}if(Tr===_r){V$4=null;break}var Fr=Tr.sibling;if(Fr!==null){Fr.return=Tr.return,V$4=Fr;break}V$4=Tr.return}}var mk=Math.ceil,nk=ua.ReactCurrentDispatcher,ok=ua.ReactCurrentOwner,pk=ua.ReactCurrentBatchConfig,K$4=0,R$4=null,Y$4=null,Z$3=0,gj=0,fj=Uf(0),T$3=0,qk=null,hh=0,rk=0,sk=0,tk=null,uk=null,gk=0,Hj=1/0,vk=null,Pi=!1,Qi=null,Si=null,wk=!1,xk=null,yk=0,zk=0,Ak=null,Bk=-1,Ck=0;function L$2(){return K$4&6?B$3():Bk!==-1?Bk:Bk=B$3()}function lh(_r){return _r.mode&1?K$4&2&&Z$3!==0?Z$3&-Z$3:Kg.transition!==null?(Ck===0&&(Ck=yc()),Ck):(_r=C$2,_r!==0||(_r=window.event,_r=_r===void 0?16:jd(_r.type)),_r):1}function mh(_r,Tr,Ar,Rr){if(50<zk)throw zk=0,Ak=null,Error(p$3(185));Ac(_r,Ar,Rr),(!(K$4&2)||_r!==R$4)&&(_r===R$4&&(!(K$4&2)&&(rk|=Ar),T$3===4&&Dk(_r,Z$3)),Ek(_r,Rr),Ar===1&&K$4===0&&!(Tr.mode&1)&&(Hj=B$3()+500,fg&&jg()))}function Ek(_r,Tr){var Ar=_r.callbackNode;wc(_r,Tr);var Rr=uc(_r,_r===R$4?Z$3:0);if(Rr===0)Ar!==null&&bc(Ar),_r.callbackNode=null,_r.callbackPriority=0;else if(Tr=Rr&-Rr,_r.callbackPriority!==Tr){if(Ar!=null&&bc(Ar),Tr===1)_r.tag===0?ig(Fk.bind(null,_r)):hg(Fk.bind(null,_r)),Jf(function(){!(K$4&6)&&jg()}),Ar=null;else{switch(Dc(Rr)){case 1:Ar=fc;break;case 4:Ar=gc;break;case 16:Ar=hc;break;case 536870912:Ar=jc;break;default:Ar=hc}Ar=Gk(Ar,Hk.bind(null,_r))}_r.callbackPriority=Tr,_r.callbackNode=Ar}}function Hk(_r,Tr){if(Bk=-1,Ck=0,K$4&6)throw Error(p$3(327));var Ar=_r.callbackNode;if(Ik()&&_r.callbackNode!==Ar)return null;var Rr=uc(_r,_r===R$4?Z$3:0);if(Rr===0)return null;if(Rr&30||Rr&_r.expiredLanes||Tr)Tr=Jk(_r,Rr);else{Tr=Rr;var Pr=K$4;K$4|=2;var Dr=Kk();(R$4!==_r||Z$3!==Tr)&&(vk=null,Hj=B$3()+500,Lk(_r,Tr));do try{Mk();break}catch(Fr){Nk(_r,Fr)}while(1);Qg(),nk.current=Dr,K$4=Pr,Y$4!==null?Tr=0:(R$4=null,Z$3=0,Tr=T$3)}if(Tr!==0){if(Tr===2&&(Pr=xc(_r),Pr!==0&&(Rr=Pr,Tr=Ok(_r,Pr))),Tr===1)throw Ar=qk,Lk(_r,0),Dk(_r,Rr),Ek(_r,B$3()),Ar;if(Tr===6)Dk(_r,Rr);else{if(Pr=_r.current.alternate,!(Rr&30)&&!Pk(Pr)&&(Tr=Jk(_r,Rr),Tr===2&&(Dr=xc(_r),Dr!==0&&(Rr=Dr,Tr=Ok(_r,Dr))),Tr===1))throw Ar=qk,Lk(_r,0),Dk(_r,Rr),Ek(_r,B$3()),Ar;switch(_r.finishedWork=Pr,_r.finishedLanes=Rr,Tr){case 0:case 1:throw Error(p$3(345));case 2:Qk(_r,uk,vk);break;case 3:if(Dk(_r,Rr),(Rr&130023424)===Rr&&(Tr=gk+500-B$3(),10<Tr)){if(uc(_r,0)!==0)break;if(Pr=_r.suspendedLanes,(Pr&Rr)!==Rr){L$2(),_r.pingedLanes|=_r.suspendedLanes&Pr;break}_r.timeoutHandle=Ff(Qk.bind(null,_r,uk,vk),Tr);break}Qk(_r,uk,vk);break;case 4:if(Dk(_r,Rr),(Rr&4194240)===Rr)break;for(Tr=_r.eventTimes,Pr=-1;0<Rr;){var Mr=31-oc(Rr);Dr=1<<Mr,Mr=Tr[Mr],Mr>Pr&&(Pr=Mr),Rr&=~Dr}if(Rr=Pr,Rr=B$3()-Rr,Rr=(120>Rr?120:480>Rr?480:1080>Rr?1080:1920>Rr?1920:3e3>Rr?3e3:4320>Rr?4320:1960*mk(Rr/1960))-Rr,10<Rr){_r.timeoutHandle=Ff(Qk.bind(null,_r,uk,vk),Rr);break}Qk(_r,uk,vk);break;case 5:Qk(_r,uk,vk);break;default:throw Error(p$3(329))}}}return Ek(_r,B$3()),_r.callbackNode===Ar?Hk.bind(null,_r):null}function Ok(_r,Tr){var Ar=tk;return _r.current.memoizedState.isDehydrated&&(Lk(_r,Tr).flags|=256),_r=Jk(_r,Tr),_r!==2&&(Tr=uk,uk=Ar,Tr!==null&&Gj(Tr)),_r}function Gj(_r){uk===null?uk=_r:uk.push.apply(uk,_r)}function Pk(_r){for(var Tr=_r;;){if(Tr.flags&16384){var Ar=Tr.updateQueue;if(Ar!==null&&(Ar=Ar.stores,Ar!==null))for(var Rr=0;Rr<Ar.length;Rr++){var Pr=Ar[Rr],Dr=Pr.getSnapshot;Pr=Pr.value;try{if(!He$2(Dr(),Pr))return!1}catch{return!1}}}if(Ar=Tr.child,Tr.subtreeFlags&16384&&Ar!==null)Ar.return=Tr,Tr=Ar;else{if(Tr===_r)break;for(;Tr.sibling===null;){if(Tr.return===null||Tr.return===_r)return!0;Tr=Tr.return}Tr.sibling.return=Tr.return,Tr=Tr.sibling}}return!0}function Dk(_r,Tr){for(Tr&=~sk,Tr&=~rk,_r.suspendedLanes|=Tr,_r.pingedLanes&=~Tr,_r=_r.expirationTimes;0<Tr;){var Ar=31-oc(Tr),Rr=1<<Ar;_r[Ar]=-1,Tr&=~Rr}}function Fk(_r){if(K$4&6)throw Error(p$3(327));Ik();var Tr=uc(_r,0);if(!(Tr&1))return Ek(_r,B$3()),null;var Ar=Jk(_r,Tr);if(_r.tag!==0&&Ar===2){var Rr=xc(_r);Rr!==0&&(Tr=Rr,Ar=Ok(_r,Rr))}if(Ar===1)throw Ar=qk,Lk(_r,0),Dk(_r,Tr),Ek(_r,B$3()),Ar;if(Ar===6)throw Error(p$3(345));return _r.finishedWork=_r.current.alternate,_r.finishedLanes=Tr,Qk(_r,uk,vk),Ek(_r,B$3()),null}function Rk(_r,Tr){var Ar=K$4;K$4|=1;try{return _r(Tr)}finally{K$4=Ar,K$4===0&&(Hj=B$3()+500,fg&&jg())}}function Sk(_r){xk!==null&&xk.tag===0&&!(K$4&6)&&Ik();var Tr=K$4;K$4|=1;var Ar=pk.transition,Rr=C$2;try{if(pk.transition=null,C$2=1,_r)return _r()}finally{C$2=Rr,pk.transition=Ar,K$4=Tr,!(K$4&6)&&jg()}}function Ij(){gj=fj.current,E$3(fj)}function Lk(_r,Tr){_r.finishedWork=null,_r.finishedLanes=0;var Ar=_r.timeoutHandle;if(Ar!==-1&&(_r.timeoutHandle=-1,Gf(Ar)),Y$4!==null)for(Ar=Y$4.return;Ar!==null;){var Rr=Ar;switch(wg(Rr),Rr.tag){case 1:Rr=Rr.type.childContextTypes,Rr!=null&&$f();break;case 3:Jh(),E$3(Wf),E$3(H$3),Oh();break;case 5:Lh(Rr);break;case 4:Jh();break;case 13:E$3(M$4);break;case 19:E$3(M$4);break;case 10:Rg(Rr.type._context);break;case 22:case 23:Ij()}Ar=Ar.return}if(R$4=_r,Y$4=_r=wh(_r.current,null),Z$3=gj=Tr,T$3=0,qk=null,sk=rk=hh=0,uk=tk=null,Wg!==null){for(Tr=0;Tr<Wg.length;Tr++)if(Ar=Wg[Tr],Rr=Ar.interleaved,Rr!==null){Ar.interleaved=null;var Pr=Rr.next,Dr=Ar.pending;if(Dr!==null){var Mr=Dr.next;Dr.next=Pr,Rr.next=Mr}Ar.pending=Rr}Wg=null}return _r}function Nk(_r,Tr){do{var Ar=Y$4;try{if(Qg(),Ph.current=ai,Sh){for(var Rr=N$4.memoizedState;Rr!==null;){var Pr=Rr.queue;Pr!==null&&(Pr.pending=null),Rr=Rr.next}Sh=!1}if(Rh=0,P$4=O$3=N$4=null,Th=!1,Uh=0,ok.current=null,Ar===null||Ar.return===null){T$3=1,qk=Tr,Y$4=null;break}e:{var Dr=_r,Mr=Ar.return,Fr=Ar,zr=Tr;if(Tr=Z$3,Fr.flags|=32768,zr!==null&&typeof zr=="object"&&typeof zr.then=="function"){var jr=zr,Gr=Fr,Nr=Gr.tag;if(!(Gr.mode&1)&&(Nr===0||Nr===11||Nr===15)){var Lr=Gr.alternate;Lr?(Gr.updateQueue=Lr.updateQueue,Gr.memoizedState=Lr.memoizedState,Gr.lanes=Lr.lanes):(Gr.updateQueue=null,Gr.memoizedState=null)}var Ur=Vi(Mr);if(Ur!==null){Ur.flags&=-257,Wi(Ur,Mr,Fr,Dr,Tr),Ur.mode&1&&Ti(Dr,jr,Tr),Tr=Ur,zr=jr;var Vr=Tr.updateQueue;if(Vr===null){var Wr=new Set;Wr.add(zr),Tr.updateQueue=Wr}else Vr.add(zr);break e}else{if(!(Tr&1)){Ti(Dr,jr,Tr),uj();break e}zr=Error(p$3(426))}}else if(I$3&&Fr.mode&1){var qr=Vi(Mr);if(qr!==null){!(qr.flags&65536)&&(qr.flags|=256),Wi(qr,Mr,Fr,Dr,Tr),Jg(Ki(zr,Fr));break e}}Dr=zr=Ki(zr,Fr),T$3!==4&&(T$3=2),tk===null?tk=[Dr]:tk.push(Dr),Dr=Mr;do{switch(Dr.tag){case 3:Dr.flags|=65536,Tr&=-Tr,Dr.lanes|=Tr;var Kr=Oi(Dr,zr,Tr);fh(Dr,Kr);break e;case 1:Fr=zr;var Xr=Dr.type,Zr=Dr.stateNode;if(!(Dr.flags&128)&&(typeof Xr.getDerivedStateFromError=="function"||Zr!==null&&typeof Zr.componentDidCatch=="function"&&(Si===null||!Si.has(Zr)))){Dr.flags|=65536,Tr&=-Tr,Dr.lanes|=Tr;var _i=Ri(Dr,Fr,Tr);fh(Dr,_i);break e}}Dr=Dr.return}while(Dr!==null)}Tk(Ar)}catch(Jr){Tr=Jr,Y$4===Ar&&Ar!==null&&(Y$4=Ar=Ar.return);continue}break}while(1)}function Kk(){var _r=nk.current;return nk.current=ai,_r===null?ai:_r}function uj(){(T$3===0||T$3===3||T$3===2)&&(T$3=4),R$4===null||!(hh&268435455)&&!(rk&268435455)||Dk(R$4,Z$3)}function Jk(_r,Tr){var Ar=K$4;K$4|=2;var Rr=Kk();(R$4!==_r||Z$3!==Tr)&&(vk=null,Lk(_r,Tr));do try{Uk();break}catch(Pr){Nk(_r,Pr)}while(1);if(Qg(),K$4=Ar,nk.current=Rr,Y$4!==null)throw Error(p$3(261));return R$4=null,Z$3=0,T$3}function Uk(){for(;Y$4!==null;)Vk(Y$4)}function Mk(){for(;Y$4!==null&&!cc();)Vk(Y$4)}function Vk(_r){var Tr=Wk(_r.alternate,_r,gj);_r.memoizedProps=_r.pendingProps,Tr===null?Tk(_r):Y$4=Tr,ok.current=null}function Tk(_r){var Tr=_r;do{var Ar=Tr.alternate;if(_r=Tr.return,Tr.flags&32768){if(Ar=Jj(Ar,Tr),Ar!==null){Ar.flags&=32767,Y$4=Ar;return}if(_r!==null)_r.flags|=32768,_r.subtreeFlags=0,_r.deletions=null;else{T$3=6,Y$4=null;return}}else if(Ar=Fj(Ar,Tr,gj),Ar!==null){Y$4=Ar;return}if(Tr=Tr.sibling,Tr!==null){Y$4=Tr;return}Y$4=Tr=_r}while(Tr!==null);T$3===0&&(T$3=5)}function Qk(_r,Tr,Ar){var Rr=C$2,Pr=pk.transition;try{pk.transition=null,C$2=1,Xk(_r,Tr,Ar,Rr)}finally{pk.transition=Pr,C$2=Rr}return null}function Xk(_r,Tr,Ar,Rr){do Ik();while(xk!==null);if(K$4&6)throw Error(p$3(327));Ar=_r.finishedWork;var Pr=_r.finishedLanes;if(Ar===null)return null;if(_r.finishedWork=null,_r.finishedLanes=0,Ar===_r.current)throw Error(p$3(177));_r.callbackNode=null,_r.callbackPriority=0;var Dr=Ar.lanes|Ar.childLanes;if(Bc(_r,Dr),_r===R$4&&(Y$4=R$4=null,Z$3=0),!(Ar.subtreeFlags&2064)&&!(Ar.flags&2064)||wk||(wk=!0,Gk(hc,function(){return Ik(),null})),Dr=(Ar.flags&15990)!==0,Ar.subtreeFlags&15990||Dr){Dr=pk.transition,pk.transition=null;var Mr=C$2;C$2=1;var Fr=K$4;K$4|=4,ok.current=null,Pj(_r,Ar),ek(Ar,_r),Oe$1(Df),dd=!!Cf,Df=Cf=null,_r.current=Ar,ik(Ar),dc(),K$4=Fr,C$2=Mr,pk.transition=Dr}else _r.current=Ar;if(wk&&(wk=!1,xk=_r,yk=Pr),Dr=_r.pendingLanes,Dr===0&&(Si=null),mc(Ar.stateNode),Ek(_r,B$3()),Tr!==null)for(Rr=_r.onRecoverableError,Ar=0;Ar<Tr.length;Ar++)Pr=Tr[Ar],Rr(Pr.value,{componentStack:Pr.stack,digest:Pr.digest});if(Pi)throw Pi=!1,_r=Qi,Qi=null,_r;return yk&1&&_r.tag!==0&&Ik(),Dr=_r.pendingLanes,Dr&1?_r===Ak?zk++:(zk=0,Ak=_r):zk=0,jg(),null}function Ik(){if(xk!==null){var _r=Dc(yk),Tr=pk.transition,Ar=C$2;try{if(pk.transition=null,C$2=16>_r?16:_r,xk===null)var Rr=!1;else{if(_r=xk,xk=null,yk=0,K$4&6)throw Error(p$3(331));var Pr=K$4;for(K$4|=4,V$4=_r.current;V$4!==null;){var Dr=V$4,Mr=Dr.child;if(V$4.flags&16){var Fr=Dr.deletions;if(Fr!==null){for(var zr=0;zr<Fr.length;zr++){var jr=Fr[zr];for(V$4=jr;V$4!==null;){var Gr=V$4;switch(Gr.tag){case 0:case 11:case 15:Qj(8,Gr,Dr)}var Nr=Gr.child;if(Nr!==null)Nr.return=Gr,V$4=Nr;else for(;V$4!==null;){Gr=V$4;var Lr=Gr.sibling,Ur=Gr.return;if(Tj(Gr),Gr===jr){V$4=null;break}if(Lr!==null){Lr.return=Ur,V$4=Lr;break}V$4=Ur}}}var Vr=Dr.alternate;if(Vr!==null){var Wr=Vr.child;if(Wr!==null){Vr.child=null;do{var qr=Wr.sibling;Wr.sibling=null,Wr=qr}while(Wr!==null)}}V$4=Dr}}if(Dr.subtreeFlags&2064&&Mr!==null)Mr.return=Dr,V$4=Mr;else e:for(;V$4!==null;){if(Dr=V$4,Dr.flags&2048)switch(Dr.tag){case 0:case 11:case 15:Qj(9,Dr,Dr.return)}var Kr=Dr.sibling;if(Kr!==null){Kr.return=Dr.return,V$4=Kr;break e}V$4=Dr.return}}var Xr=_r.current;for(V$4=Xr;V$4!==null;){Mr=V$4;var Zr=Mr.child;if(Mr.subtreeFlags&2064&&Zr!==null)Zr.return=Mr,V$4=Zr;else e:for(Mr=Xr;V$4!==null;){if(Fr=V$4,Fr.flags&2048)try{switch(Fr.tag){case 0:case 11:case 15:Rj(9,Fr)}}catch(Jr){W$4(Fr,Fr.return,Jr)}if(Fr===Mr){V$4=null;break e}var _i=Fr.sibling;if(_i!==null){_i.return=Fr.return,V$4=_i;break e}V$4=Fr.return}}if(K$4=Pr,jg(),lc&&typeof lc.onPostCommitFiberRoot=="function")try{lc.onPostCommitFiberRoot(kc,_r)}catch{}Rr=!0}return Rr}finally{C$2=Ar,pk.transition=Tr}}return!1}function Yk(_r,Tr,Ar){Tr=Ki(Ar,Tr),Tr=Oi(_r,Tr,1),_r=dh(_r,Tr,1),Tr=L$2(),_r!==null&&(Ac(_r,1,Tr),Ek(_r,Tr))}function W$4(_r,Tr,Ar){if(_r.tag===3)Yk(_r,_r,Ar);else for(;Tr!==null;){if(Tr.tag===3){Yk(Tr,_r,Ar);break}else if(Tr.tag===1){var Rr=Tr.stateNode;if(typeof Tr.type.getDerivedStateFromError=="function"||typeof Rr.componentDidCatch=="function"&&(Si===null||!Si.has(Rr))){_r=Ki(Ar,_r),_r=Ri(Tr,_r,1),Tr=dh(Tr,_r,1),_r=L$2(),Tr!==null&&(Ac(Tr,1,_r),Ek(Tr,_r));break}}Tr=Tr.return}}function Ui(_r,Tr,Ar){var Rr=_r.pingCache;Rr!==null&&Rr.delete(Tr),Tr=L$2(),_r.pingedLanes|=_r.suspendedLanes&Ar,R$4===_r&&(Z$3&Ar)===Ar&&(T$3===4||T$3===3&&(Z$3&130023424)===Z$3&&500>B$3()-gk?Lk(_r,0):sk|=Ar),Ek(_r,Tr)}function Zk(_r,Tr){Tr===0&&(_r.mode&1?(Tr=sc,sc<<=1,!(sc&130023424)&&(sc=4194304)):Tr=1);var Ar=L$2();_r=Zg(_r,Tr),_r!==null&&(Ac(_r,Tr,Ar),Ek(_r,Ar))}function vj(_r){var Tr=_r.memoizedState,Ar=0;Tr!==null&&(Ar=Tr.retryLane),Zk(_r,Ar)}function ck(_r,Tr){var Ar=0;switch(_r.tag){case 13:var Rr=_r.stateNode,Pr=_r.memoizedState;Pr!==null&&(Ar=Pr.retryLane);break;case 19:Rr=_r.stateNode;break;default:throw Error(p$3(314))}Rr!==null&&Rr.delete(Tr),Zk(_r,Ar)}var Wk;Wk=function(_r,Tr,Ar){if(_r!==null)if(_r.memoizedProps!==Tr.pendingProps||Wf.current)Ug=!0;else{if(!(_r.lanes&Ar)&&!(Tr.flags&128))return Ug=!1,zj(_r,Tr,Ar);Ug=!!(_r.flags&131072)}else Ug=!1,I$3&&Tr.flags&1048576&&ug(Tr,ng,Tr.index);switch(Tr.lanes=0,Tr.tag){case 2:var Rr=Tr.type;jj(_r,Tr),_r=Tr.pendingProps;var Pr=Yf(Tr,H$3.current);Tg(Tr,Ar),Pr=Xh(null,Tr,Rr,_r,Pr,Ar);var Dr=bi();return Tr.flags|=1,typeof Pr=="object"&&Pr!==null&&typeof Pr.render=="function"&&Pr.$$typeof===void 0?(Tr.tag=1,Tr.memoizedState=null,Tr.updateQueue=null,Zf(Rr)?(Dr=!0,cg(Tr)):Dr=!1,Tr.memoizedState=Pr.state!==null&&Pr.state!==void 0?Pr.state:null,ah(Tr),Pr.updater=nh,Tr.stateNode=Pr,Pr._reactInternals=Tr,rh(Tr,Rr,_r,Ar),Tr=kj(null,Tr,Rr,!0,Dr,Ar)):(Tr.tag=0,I$3&&Dr&&vg(Tr),Yi(null,Tr,Pr,Ar),Tr=Tr.child),Tr;case 16:Rr=Tr.elementType;e:{switch(jj(_r,Tr),_r=Tr.pendingProps,Pr=Rr._init,Rr=Pr(Rr._payload),Tr.type=Rr,Pr=Tr.tag=$k(Rr),_r=Lg(Rr,_r),Pr){case 0:Tr=dj(null,Tr,Rr,_r,Ar);break e;case 1:Tr=ij(null,Tr,Rr,_r,Ar);break e;case 11:Tr=Zi(null,Tr,Rr,_r,Ar);break e;case 14:Tr=aj(null,Tr,Rr,Lg(Rr.type,_r),Ar);break e}throw Error(p$3(306,Rr,""))}return Tr;case 0:return Rr=Tr.type,Pr=Tr.pendingProps,Pr=Tr.elementType===Rr?Pr:Lg(Rr,Pr),dj(_r,Tr,Rr,Pr,Ar);case 1:return Rr=Tr.type,Pr=Tr.pendingProps,Pr=Tr.elementType===Rr?Pr:Lg(Rr,Pr),ij(_r,Tr,Rr,Pr,Ar);case 3:e:{if(lj(Tr),_r===null)throw Error(p$3(387));Rr=Tr.pendingProps,Dr=Tr.memoizedState,Pr=Dr.element,bh(_r,Tr),gh(Tr,Rr,null,Ar);var Mr=Tr.memoizedState;if(Rr=Mr.element,Dr.isDehydrated)if(Dr={element:Rr,isDehydrated:!1,cache:Mr.cache,pendingSuspenseBoundaries:Mr.pendingSuspenseBoundaries,transitions:Mr.transitions},Tr.updateQueue.baseState=Dr,Tr.memoizedState=Dr,Tr.flags&256){Pr=Ki(Error(p$3(423)),Tr),Tr=mj(_r,Tr,Rr,Ar,Pr);break e}else if(Rr!==Pr){Pr=Ki(Error(p$3(424)),Tr),Tr=mj(_r,Tr,Rr,Ar,Pr);break e}else for(yg=Lf(Tr.stateNode.containerInfo.firstChild),xg=Tr,I$3=!0,zg=null,Ar=Ch(Tr,null,Rr,Ar),Tr.child=Ar;Ar;)Ar.flags=Ar.flags&-3|4096,Ar=Ar.sibling;else{if(Ig(),Rr===Pr){Tr=$i(_r,Tr,Ar);break e}Yi(_r,Tr,Rr,Ar)}Tr=Tr.child}return Tr;case 5:return Kh(Tr),_r===null&&Eg(Tr),Rr=Tr.type,Pr=Tr.pendingProps,Dr=_r!==null?_r.memoizedProps:null,Mr=Pr.children,Ef(Rr,Pr)?Mr=null:Dr!==null&&Ef(Rr,Dr)&&(Tr.flags|=32),hj(_r,Tr),Yi(_r,Tr,Mr,Ar),Tr.child;case 6:return _r===null&&Eg(Tr),null;case 13:return pj(_r,Tr,Ar);case 4:return Ih(Tr,Tr.stateNode.containerInfo),Rr=Tr.pendingProps,_r===null?Tr.child=Bh(Tr,null,Rr,Ar):Yi(_r,Tr,Rr,Ar),Tr.child;case 11:return Rr=Tr.type,Pr=Tr.pendingProps,Pr=Tr.elementType===Rr?Pr:Lg(Rr,Pr),Zi(_r,Tr,Rr,Pr,Ar);case 7:return Yi(_r,Tr,Tr.pendingProps,Ar),Tr.child;case 8:return Yi(_r,Tr,Tr.pendingProps.children,Ar),Tr.child;case 12:return Yi(_r,Tr,Tr.pendingProps.children,Ar),Tr.child;case 10:e:{if(Rr=Tr.type._context,Pr=Tr.pendingProps,Dr=Tr.memoizedProps,Mr=Pr.value,G$4(Mg,Rr._currentValue),Rr._currentValue=Mr,Dr!==null)if(He$2(Dr.value,Mr)){if(Dr.children===Pr.children&&!Wf.current){Tr=$i(_r,Tr,Ar);break e}}else for(Dr=Tr.child,Dr!==null&&(Dr.return=Tr);Dr!==null;){var Fr=Dr.dependencies;if(Fr!==null){Mr=Dr.child;for(var zr=Fr.firstContext;zr!==null;){if(zr.context===Rr){if(Dr.tag===1){zr=ch(-1,Ar&-Ar),zr.tag=2;var jr=Dr.updateQueue;if(jr!==null){jr=jr.shared;var Gr=jr.pending;Gr===null?zr.next=zr:(zr.next=Gr.next,Gr.next=zr),jr.pending=zr}}Dr.lanes|=Ar,zr=Dr.alternate,zr!==null&&(zr.lanes|=Ar),Sg(Dr.return,Ar,Tr),Fr.lanes|=Ar;break}zr=zr.next}}else if(Dr.tag===10)Mr=Dr.type===Tr.type?null:Dr.child;else if(Dr.tag===18){if(Mr=Dr.return,Mr===null)throw Error(p$3(341));Mr.lanes|=Ar,Fr=Mr.alternate,Fr!==null&&(Fr.lanes|=Ar),Sg(Mr,Ar,Tr),Mr=Dr.sibling}else Mr=Dr.child;if(Mr!==null)Mr.return=Dr;else for(Mr=Dr;Mr!==null;){if(Mr===Tr){Mr=null;break}if(Dr=Mr.sibling,Dr!==null){Dr.return=Mr.return,Mr=Dr;break}Mr=Mr.return}Dr=Mr}Yi(_r,Tr,Pr.children,Ar),Tr=Tr.child}return Tr;case 9:return Pr=Tr.type,Rr=Tr.pendingProps.children,Tg(Tr,Ar),Pr=Vg(Pr),Rr=Rr(Pr),Tr.flags|=1,Yi(_r,Tr,Rr,Ar),Tr.child;case 14:return Rr=Tr.type,Pr=Lg(Rr,Tr.pendingProps),Pr=Lg(Rr.type,Pr),aj(_r,Tr,Rr,Pr,Ar);case 15:return cj(_r,Tr,Tr.type,Tr.pendingProps,Ar);case 17:return Rr=Tr.type,Pr=Tr.pendingProps,Pr=Tr.elementType===Rr?Pr:Lg(Rr,Pr),jj(_r,Tr),Tr.tag=1,Zf(Rr)?(_r=!0,cg(Tr)):_r=!1,Tg(Tr,Ar),ph(Tr,Rr,Pr),rh(Tr,Rr,Pr,Ar),kj(null,Tr,Rr,!0,_r,Ar);case 19:return yj(_r,Tr,Ar);case 22:return ej(_r,Tr,Ar)}throw Error(p$3(156,Tr.tag))};function Gk(_r,Tr){return ac(_r,Tr)}function al(_r,Tr,Ar,Rr){this.tag=_r,this.key=Ar,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=Tr,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=Rr,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bg(_r,Tr,Ar,Rr){return new al(_r,Tr,Ar,Rr)}function bj(_r){return _r=_r.prototype,!(!_r||!_r.isReactComponent)}function $k(_r){if(typeof _r=="function")return bj(_r)?1:0;if(_r!=null){if(_r=_r.$$typeof,_r===Da)return 11;if(_r===Ga)return 14}return 2}function wh(_r,Tr){var Ar=_r.alternate;return Ar===null?(Ar=Bg(_r.tag,Tr,_r.key,_r.mode),Ar.elementType=_r.elementType,Ar.type=_r.type,Ar.stateNode=_r.stateNode,Ar.alternate=_r,_r.alternate=Ar):(Ar.pendingProps=Tr,Ar.type=_r.type,Ar.flags=0,Ar.subtreeFlags=0,Ar.deletions=null),Ar.flags=_r.flags&14680064,Ar.childLanes=_r.childLanes,Ar.lanes=_r.lanes,Ar.child=_r.child,Ar.memoizedProps=_r.memoizedProps,Ar.memoizedState=_r.memoizedState,Ar.updateQueue=_r.updateQueue,Tr=_r.dependencies,Ar.dependencies=Tr===null?null:{lanes:Tr.lanes,firstContext:Tr.firstContext},Ar.sibling=_r.sibling,Ar.index=_r.index,Ar.ref=_r.ref,Ar}function yh(_r,Tr,Ar,Rr,Pr,Dr){var Mr=2;if(Rr=_r,typeof _r=="function")bj(_r)&&(Mr=1);else if(typeof _r=="string")Mr=5;else e:switch(_r){case ya:return Ah(Ar.children,Pr,Dr,Tr);case za:Mr=8,Pr|=8;break;case Aa:return _r=Bg(12,Ar,Tr,Pr|2),_r.elementType=Aa,_r.lanes=Dr,_r;case Ea:return _r=Bg(13,Ar,Tr,Pr),_r.elementType=Ea,_r.lanes=Dr,_r;case Fa:return _r=Bg(19,Ar,Tr,Pr),_r.elementType=Fa,_r.lanes=Dr,_r;case Ia:return qj(Ar,Pr,Dr,Tr);default:if(typeof _r=="object"&&_r!==null)switch(_r.$$typeof){case Ba:Mr=10;break e;case Ca:Mr=9;break e;case Da:Mr=11;break e;case Ga:Mr=14;break e;case Ha:Mr=16,Rr=null;break e}throw Error(p$3(130,_r==null?_r:typeof _r,""))}return Tr=Bg(Mr,Ar,Tr,Pr),Tr.elementType=_r,Tr.type=Rr,Tr.lanes=Dr,Tr}function Ah(_r,Tr,Ar,Rr){return _r=Bg(7,_r,Rr,Tr),_r.lanes=Ar,_r}function qj(_r,Tr,Ar,Rr){return _r=Bg(22,_r,Rr,Tr),_r.elementType=Ia,_r.lanes=Ar,_r.stateNode={isHidden:!1},_r}function xh(_r,Tr,Ar){return _r=Bg(6,_r,null,Tr),_r.lanes=Ar,_r}function zh(_r,Tr,Ar){return Tr=Bg(4,_r.children!==null?_r.children:[],_r.key,Tr),Tr.lanes=Ar,Tr.stateNode={containerInfo:_r.containerInfo,pendingChildren:null,implementation:_r.implementation},Tr}function bl(_r,Tr,Ar,Rr,Pr){this.tag=Tr,this.containerInfo=_r,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=zc(0),this.expirationTimes=zc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zc(0),this.identifierPrefix=Rr,this.onRecoverableError=Pr,this.mutableSourceEagerHydrationData=null}function cl(_r,Tr,Ar,Rr,Pr,Dr,Mr,Fr,zr){return _r=new bl(_r,Tr,Ar,Fr,zr),Tr===1?(Tr=1,Dr===!0&&(Tr|=8)):Tr=0,Dr=Bg(3,null,null,Tr),_r.current=Dr,Dr.stateNode=_r,Dr.memoizedState={element:Rr,isDehydrated:Ar,cache:null,transitions:null,pendingSuspenseBoundaries:null},ah(Dr),_r}function dl(_r,Tr,Ar){var Rr=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:wa,key:Rr==null?null:""+Rr,children:_r,containerInfo:Tr,implementation:Ar}}function el(_r){if(!_r)return Vf;_r=_r._reactInternals;e:{if(Vb(_r)!==_r||_r.tag!==1)throw Error(p$3(170));var Tr=_r;do{switch(Tr.tag){case 3:Tr=Tr.stateNode.context;break e;case 1:if(Zf(Tr.type)){Tr=Tr.stateNode.__reactInternalMemoizedMergedChildContext;break e}}Tr=Tr.return}while(Tr!==null);throw Error(p$3(171))}if(_r.tag===1){var Ar=_r.type;if(Zf(Ar))return bg(_r,Ar,Tr)}return Tr}function fl(_r,Tr,Ar,Rr,Pr,Dr,Mr,Fr,zr){return _r=cl(Ar,Rr,!0,_r,Pr,Dr,Mr,Fr,zr),_r.context=el(null),Ar=_r.current,Rr=L$2(),Pr=lh(Ar),Dr=ch(Rr,Pr),Dr.callback=Tr??null,dh(Ar,Dr,Pr),_r.current.lanes=Pr,Ac(_r,Pr,Rr),Ek(_r,Rr),_r}function gl(_r,Tr,Ar,Rr){var Pr=Tr.current,Dr=L$2(),Mr=lh(Pr);return Ar=el(Ar),Tr.context===null?Tr.context=Ar:Tr.pendingContext=Ar,Tr=ch(Dr,Mr),Tr.payload={element:_r},Rr=Rr===void 0?null:Rr,Rr!==null&&(Tr.callback=Rr),_r=dh(Pr,Tr,Mr),_r!==null&&(mh(_r,Pr,Mr,Dr),eh(_r,Pr,Mr)),Mr}function hl(_r){if(_r=_r.current,!_r.child)return null;switch(_r.child.tag){case 5:return _r.child.stateNode;default:return _r.child.stateNode}}function il(_r,Tr){if(_r=_r.memoizedState,_r!==null&&_r.dehydrated!==null){var Ar=_r.retryLane;_r.retryLane=Ar!==0&&Ar<Tr?Ar:Tr}}function jl(_r,Tr){il(_r,Tr),(_r=_r.alternate)&&il(_r,Tr)}function kl(){return null}var ll=typeof reportError=="function"?reportError:function(_r){console.error(_r)};function ml(_r){this._internalRoot=_r}nl.prototype.render=ml.prototype.render=function(_r){var Tr=this._internalRoot;if(Tr===null)throw Error(p$3(409));gl(_r,Tr,null,null)};nl.prototype.unmount=ml.prototype.unmount=function(){var _r=this._internalRoot;if(_r!==null){this._internalRoot=null;var Tr=_r.containerInfo;Sk(function(){gl(null,_r,null,null)}),Tr[uf]=null}};function nl(_r){this._internalRoot=_r}nl.prototype.unstable_scheduleHydration=function(_r){if(_r){var Tr=Hc();_r={blockedOn:null,target:_r,priority:Tr};for(var Ar=0;Ar<Qc.length&&Tr!==0&&Tr<Qc[Ar].priority;Ar++);Qc.splice(Ar,0,_r),Ar===0&&Vc(_r)}};function ol(_r){return!(!_r||_r.nodeType!==1&&_r.nodeType!==9&&_r.nodeType!==11)}function pl(_r){return!(!_r||_r.nodeType!==1&&_r.nodeType!==9&&_r.nodeType!==11&&(_r.nodeType!==8||_r.nodeValue!==" react-mount-point-unstable "))}function ql(){}function rl(_r,Tr,Ar,Rr,Pr){if(Pr){if(typeof Rr=="function"){var Dr=Rr;Rr=function(){var jr=hl(Mr);Dr.call(jr)}}var Mr=fl(Tr,Rr,_r,0,null,!1,!1,"",ql);return _r._reactRootContainer=Mr,_r[uf]=Mr.current,sf(_r.nodeType===8?_r.parentNode:_r),Sk(),Mr}for(;Pr=_r.lastChild;)_r.removeChild(Pr);if(typeof Rr=="function"){var Fr=Rr;Rr=function(){var jr=hl(zr);Fr.call(jr)}}var zr=cl(_r,0,!1,null,null,!1,!1,"",ql);return _r._reactRootContainer=zr,_r[uf]=zr.current,sf(_r.nodeType===8?_r.parentNode:_r),Sk(function(){gl(Tr,zr,Ar,Rr)}),zr}function sl(_r,Tr,Ar,Rr,Pr){var Dr=Ar._reactRootContainer;if(Dr){var Mr=Dr;if(typeof Pr=="function"){var Fr=Pr;Pr=function(){var zr=hl(Mr);Fr.call(zr)}}gl(Tr,Mr,_r,Pr)}else Mr=rl(Ar,Tr,_r,Pr,Rr);return hl(Mr)}Ec=function(_r){switch(_r.tag){case 3:var Tr=_r.stateNode;if(Tr.current.memoizedState.isDehydrated){var Ar=tc(Tr.pendingLanes);Ar!==0&&(Cc(Tr,Ar|1),Ek(Tr,B$3()),!(K$4&6)&&(Hj=B$3()+500,jg()))}break;case 13:Sk(function(){var Rr=Zg(_r,1);if(Rr!==null){var Pr=L$2();mh(Rr,_r,1,Pr)}}),jl(_r,1)}};Fc=function(_r){if(_r.tag===13){var Tr=Zg(_r,134217728);if(Tr!==null){var Ar=L$2();mh(Tr,_r,134217728,Ar)}jl(_r,134217728)}};Gc=function(_r){if(_r.tag===13){var Tr=lh(_r),Ar=Zg(_r,Tr);if(Ar!==null){var Rr=L$2();mh(Ar,_r,Tr,Rr)}jl(_r,Tr)}};Hc=function(){return C$2};Ic=function(_r,Tr){var Ar=C$2;try{return C$2=_r,Tr()}finally{C$2=Ar}};yb=function(_r,Tr,Ar){switch(Tr){case"input":if(bb(_r,Ar),Tr=Ar.name,Ar.type==="radio"&&Tr!=null){for(Ar=_r;Ar.parentNode;)Ar=Ar.parentNode;for(Ar=Ar.querySelectorAll("input[name="+JSON.stringify(""+Tr)+'][type="radio"]'),Tr=0;Tr<Ar.length;Tr++){var Rr=Ar[Tr];if(Rr!==_r&&Rr.form===_r.form){var Pr=Db(Rr);if(!Pr)throw Error(p$3(90));Wa(Rr),bb(Rr,Pr)}}}break;case"textarea":ib(_r,Ar);break;case"select":Tr=Ar.value,Tr!=null&&fb(_r,!!Ar.multiple,Tr,!1)}};Gb=Rk;Hb=Sk;var tl={usingClientEntryPoint:!1,Events:[Cb,ue$1,Db,Eb,Fb,Rk]},ul={findFiberByHostInstance:Wc,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},vl={bundleType:ul.bundleType,version:ul.version,rendererPackageName:ul.rendererPackageName,rendererConfig:ul.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ua.ReactCurrentDispatcher,findHostInstanceByFiber:function(_r){return _r=Zb(_r),_r===null?null:_r.stateNode},findFiberByHostInstance:ul.findFiberByHostInstance||kl,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var wl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!wl.isDisabled&&wl.supportsFiber)try{kc=wl.inject(vl),lc=wl}catch{}}reactDom_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tl;reactDom_production_min.createPortal=function(_r,Tr){var Ar=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ol(Tr))throw Error(p$3(200));return dl(_r,Tr,null,Ar)};reactDom_production_min.createRoot=function(_r,Tr){if(!ol(_r))throw Error(p$3(299));var Ar=!1,Rr="",Pr=ll;return Tr!=null&&(Tr.unstable_strictMode===!0&&(Ar=!0),Tr.identifierPrefix!==void 0&&(Rr=Tr.identifierPrefix),Tr.onRecoverableError!==void 0&&(Pr=Tr.onRecoverableError)),Tr=cl(_r,1,!1,null,null,Ar,!1,Rr,Pr),_r[uf]=Tr.current,sf(_r.nodeType===8?_r.parentNode:_r),new ml(Tr)};reactDom_production_min.findDOMNode=function(_r){if(_r==null)return null;if(_r.nodeType===1)return _r;var Tr=_r._reactInternals;if(Tr===void 0)throw typeof _r.render=="function"?Error(p$3(188)):(_r=Object.keys(_r).join(","),Error(p$3(268,_r)));return _r=Zb(Tr),_r=_r===null?null:_r.stateNode,_r};reactDom_production_min.flushSync=function(_r){return Sk(_r)};reactDom_production_min.hydrate=function(_r,Tr,Ar){if(!pl(Tr))throw Error(p$3(200));return sl(null,_r,Tr,!0,Ar)};reactDom_production_min.hydrateRoot=function(_r,Tr,Ar){if(!ol(_r))throw Error(p$3(405));var Rr=Ar!=null&&Ar.hydratedSources||null,Pr=!1,Dr="",Mr=ll;if(Ar!=null&&(Ar.unstable_strictMode===!0&&(Pr=!0),Ar.identifierPrefix!==void 0&&(Dr=Ar.identifierPrefix),Ar.onRecoverableError!==void 0&&(Mr=Ar.onRecoverableError)),Tr=fl(Tr,null,_r,1,Ar??null,Pr,!1,Dr,Mr),_r[uf]=Tr.current,sf(_r),Rr)for(_r=0;_r<Rr.length;_r++)Ar=Rr[_r],Pr=Ar._getVersion,Pr=Pr(Ar._source),Tr.mutableSourceEagerHydrationData==null?Tr.mutableSourceEagerHydrationData=[Ar,Pr]:Tr.mutableSourceEagerHydrationData.push(Ar,Pr);return new nl(Tr)};reactDom_production_min.render=function(_r,Tr,Ar){if(!pl(Tr))throw Error(p$3(200));return sl(null,_r,Tr,!1,Ar)};reactDom_production_min.unmountComponentAtNode=function(_r){if(!pl(_r))throw Error(p$3(40));return _r._reactRootContainer?(Sk(function(){sl(null,null,_r,!1,function(){_r._reactRootContainer=null,_r[uf]=null})}),!0):!1};reactDom_production_min.unstable_batchedUpdates=Rk;reactDom_production_min.unstable_renderSubtreeIntoContainer=function(_r,Tr,Ar,Rr){if(!pl(Ar))throw Error(p$3(200));if(_r==null||_r._reactInternals===void 0)throw Error(p$3(38));return sl(_r,Tr,Ar,!1,Rr)};reactDom_production_min.version="18.2.0-next-9e3b772b8-20220608";function checkDCE(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(checkDCE)}catch(_r){console.error(_r)}}checkDCE(),reactDom.exports=reactDom_production_min;var reactDomExports=reactDom.exports,m$3=reactDomExports;client.createRoot=m$3.createRoot,client.hydrateRoot=m$3.hydrateRoot;const App$1="",CardPanel$1="";function bind(_r,Tr){return function(){return _r.apply(Tr,arguments)}}const{toString}=Object.prototype,{getPrototypeOf}=Object,kindOf=(_r=>Tr=>{const Ar=toString.call(Tr);return _r[Ar]||(_r[Ar]=Ar.slice(8,-1).toLowerCase())})(Object.create(null)),kindOfTest=_r=>(_r=_r.toLowerCase(),Tr=>kindOf(Tr)===_r),typeOfTest=_r=>Tr=>typeof Tr===_r,{isArray}=Array,isUndefined=typeOfTest("undefined");function isBuffer(_r){return _r!==null&&!isUndefined(_r)&&_r.constructor!==null&&!isUndefined(_r.constructor)&&isFunction(_r.constructor.isBuffer)&&_r.constructor.isBuffer(_r)}const isArrayBuffer=kindOfTest("ArrayBuffer");function isArrayBufferView(_r){let Tr;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?Tr=ArrayBuffer.isView(_r):Tr=_r&&_r.buffer&&isArrayBuffer(_r.buffer),Tr}const isString=typeOfTest("string"),isFunction=typeOfTest("function"),isNumber=typeOfTest("number"),isObject$2=_r=>_r!==null&&typeof _r=="object",isBoolean=_r=>_r===!0||_r===!1,isPlainObject$5=_r=>{if(kindOf(_r)!=="object")return!1;const Tr=getPrototypeOf(_r);return(Tr===null||Tr===Object.prototype||Object.getPrototypeOf(Tr)===null)&&!(Symbol.toStringTag in _r)&&!(Symbol.iterator in _r)},isDate=kindOfTest("Date"),isFile=kindOfTest("File"),isBlob=kindOfTest("Blob"),isFileList=kindOfTest("FileList"),isStream=_r=>isObject$2(_r)&&isFunction(_r.pipe),isFormData=_r=>{let Tr;return _r&&(typeof FormData=="function"&&_r instanceof FormData||isFunction(_r.append)&&((Tr=kindOf(_r))==="formdata"||Tr==="object"&&isFunction(_r.toString)&&_r.toString()==="[object FormData]"))},isURLSearchParams=kindOfTest("URLSearchParams"),trim=_r=>_r.trim?_r.trim():_r.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function forEach(_r,Tr,{allOwnKeys:Ar=!1}={}){if(_r===null||typeof _r>"u")return;let Rr,Pr;if(typeof _r!="object"&&(_r=[_r]),isArray(_r))for(Rr=0,Pr=_r.length;Rr<Pr;Rr++)Tr.call(null,_r[Rr],Rr,_r);else{const Dr=Ar?Object.getOwnPropertyNames(_r):Object.keys(_r),Mr=Dr.length;let Fr;for(Rr=0;Rr<Mr;Rr++)Fr=Dr[Rr],Tr.call(null,_r[Fr],Fr,_r)}}function findKey(_r,Tr){Tr=Tr.toLowerCase();const Ar=Object.keys(_r);let Rr=Ar.length,Pr;for(;Rr-- >0;)if(Pr=Ar[Rr],Tr===Pr.toLowerCase())return Pr;return null}const _global=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),isContextDefined=_r=>!isUndefined(_r)&&_r!==_global;function merge$1(){const{caseless:_r}=isContextDefined(this)&&this||{},Tr={},Ar=(Rr,Pr)=>{const Dr=_r&&findKey(Tr,Pr)||Pr;isPlainObject$5(Tr[Dr])&&isPlainObject$5(Rr)?Tr[Dr]=merge$1(Tr[Dr],Rr):isPlainObject$5(Rr)?Tr[Dr]=merge$1({},Rr):isArray(Rr)?Tr[Dr]=Rr.slice():Tr[Dr]=Rr};for(let Rr=0,Pr=arguments.length;Rr<Pr;Rr++)arguments[Rr]&&forEach(arguments[Rr],Ar);return Tr}const extend=(_r,Tr,Ar,{allOwnKeys:Rr}={})=>(forEach(Tr,(Pr,Dr)=>{Ar&&isFunction(Pr)?_r[Dr]=bind(Pr,Ar):_r[Dr]=Pr},{allOwnKeys:Rr}),_r),stripBOM=_r=>(_r.charCodeAt(0)===65279&&(_r=_r.slice(1)),_r),inherits=(_r,Tr,Ar,Rr)=>{_r.prototype=Object.create(Tr.prototype,Rr),_r.prototype.constructor=_r,Object.defineProperty(_r,"super",{value:Tr.prototype}),Ar&&Object.assign(_r.prototype,Ar)},toFlatObject=(_r,Tr,Ar,Rr)=>{let Pr,Dr,Mr;const Fr={};if(Tr=Tr||{},_r==null)return Tr;do{for(Pr=Object.getOwnPropertyNames(_r),Dr=Pr.length;Dr-- >0;)Mr=Pr[Dr],(!Rr||Rr(Mr,_r,Tr))&&!Fr[Mr]&&(Tr[Mr]=_r[Mr],Fr[Mr]=!0);_r=Ar!==!1&&getPrototypeOf(_r)}while(_r&&(!Ar||Ar(_r,Tr))&&_r!==Object.prototype);return Tr},endsWith=(_r,Tr,Ar)=>{_r=String(_r),(Ar===void 0||Ar>_r.length)&&(Ar=_r.length),Ar-=Tr.length;const Rr=_r.indexOf(Tr,Ar);return Rr!==-1&&Rr===Ar},toArray=_r=>{if(!_r)return null;if(isArray(_r))return _r;let Tr=_r.length;if(!isNumber(Tr))return null;const Ar=new Array(Tr);for(;Tr-- >0;)Ar[Tr]=_r[Tr];return Ar},isTypedArray=(_r=>Tr=>_r&&Tr instanceof _r)(typeof Uint8Array<"u"&&getPrototypeOf(Uint8Array)),forEachEntry=(_r,Tr)=>{const Rr=(_r&&_r[Symbol.iterator]).call(_r);let Pr;for(;(Pr=Rr.next())&&!Pr.done;){const Dr=Pr.value;Tr.call(_r,Dr[0],Dr[1])}},matchAll=(_r,Tr)=>{let Ar;const Rr=[];for(;(Ar=_r.exec(Tr))!==null;)Rr.push(Ar);return Rr},isHTMLForm=kindOfTest("HTMLFormElement"),toCamelCase=_r=>_r.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(Ar,Rr,Pr){return Rr.toUpperCase()+Pr}),hasOwnProperty=(({hasOwnProperty:_r})=>(Tr,Ar)=>_r.call(Tr,Ar))(Object.prototype),isRegExp=kindOfTest("RegExp"),reduceDescriptors=(_r,Tr)=>{const Ar=Object.getOwnPropertyDescriptors(_r),Rr={};forEach(Ar,(Pr,Dr)=>{let Mr;(Mr=Tr(Pr,Dr,_r))!==!1&&(Rr[Dr]=Mr||Pr)}),Object.defineProperties(_r,Rr)},freezeMethods=_r=>{reduceDescriptors(_r,(Tr,Ar)=>{if(isFunction(_r)&&["arguments","caller","callee"].indexOf(Ar)!==-1)return!1;const Rr=_r[Ar];if(isFunction(Rr)){if(Tr.enumerable=!1,"writable"in Tr){Tr.writable=!1;return}Tr.set||(Tr.set=()=>{throw Error("Can not rewrite read-only method '"+Ar+"'")})}})},toObjectSet=(_r,Tr)=>{const Ar={},Rr=Pr=>{Pr.forEach(Dr=>{Ar[Dr]=!0})};return isArray(_r)?Rr(_r):Rr(String(_r).split(Tr)),Ar},noop$1=()=>{},toFiniteNumber=(_r,Tr)=>(_r=+_r,Number.isFinite(_r)?_r:Tr),ALPHA="abcdefghijklmnopqrstuvwxyz",DIGIT="0123456789",ALPHABET={DIGIT,ALPHA,ALPHA_DIGIT:ALPHA+ALPHA.toUpperCase()+DIGIT},generateString=(_r=16,Tr=ALPHABET.ALPHA_DIGIT)=>{let Ar="";const{length:Rr}=Tr;for(;_r--;)Ar+=Tr[Math.random()*Rr|0];return Ar};function isSpecCompliantForm(_r){return!!(_r&&isFunction(_r.append)&&_r[Symbol.toStringTag]==="FormData"&&_r[Symbol.iterator])}const toJSONObject=_r=>{const Tr=new Array(10),Ar=(Rr,Pr)=>{if(isObject$2(Rr)){if(Tr.indexOf(Rr)>=0)return;if(!("toJSON"in Rr)){Tr[Pr]=Rr;const Dr=isArray(Rr)?[]:{};return forEach(Rr,(Mr,Fr)=>{const zr=Ar(Mr,Pr+1);!isUndefined(zr)&&(Dr[Fr]=zr)}),Tr[Pr]=void 0,Dr}}return Rr};return Ar(_r,0)},isAsyncFn=kindOfTest("AsyncFunction"),isThenable=_r=>_r&&(isObject$2(_r)||isFunction(_r))&&isFunction(_r.then)&&isFunction(_r.catch),utils$1={isArray,isArrayBuffer,isBuffer,isFormData,isArrayBufferView,isString,isNumber,isBoolean,isObject:isObject$2,isPlainObject:isPlainObject$5,isUndefined,isDate,isFile,isBlob,isRegExp,isFunction,isStream,isURLSearchParams,isTypedArray,isFileList,forEach,merge:merge$1,extend,trim,stripBOM,inherits,toFlatObject,kindOf,kindOfTest,endsWith,toArray,forEachEntry,matchAll,isHTMLForm,hasOwnProperty,hasOwnProp:hasOwnProperty,reduceDescriptors,freezeMethods,toObjectSet,toCamelCase,noop:noop$1,toFiniteNumber,findKey,global:_global,isContextDefined,ALPHABET,generateString,isSpecCompliantForm,toJSONObject,isAsyncFn,isThenable};function AxiosError(_r,Tr,Ar,Rr,Pr){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=_r,this.name="AxiosError",Tr&&(this.code=Tr),Ar&&(this.config=Ar),Rr&&(this.request=Rr),Pr&&(this.response=Pr)}utils$1.inherits(AxiosError,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:utils$1.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const prototype$1=AxiosError.prototype,descriptors={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(_r=>{descriptors[_r]={value:_r}});Object.defineProperties(AxiosError,descriptors);Object.defineProperty(prototype$1,"isAxiosError",{value:!0});AxiosError.from=(_r,Tr,Ar,Rr,Pr,Dr)=>{const Mr=Object.create(prototype$1);return utils$1.toFlatObject(_r,Mr,function(zr){return zr!==Error.prototype},Fr=>Fr!=="isAxiosError"),AxiosError.call(Mr,_r.message,Tr,Ar,Rr,Pr),Mr.cause=_r,Mr.name=_r.name,Dr&&Object.assign(Mr,Dr),Mr};const httpAdapter=null;function isVisitable(_r){return utils$1.isPlainObject(_r)||utils$1.isArray(_r)}function removeBrackets(_r){return utils$1.endsWith(_r,"[]")?_r.slice(0,-2):_r}function renderKey(_r,Tr,Ar){return _r?_r.concat(Tr).map(function(Pr,Dr){return Pr=removeBrackets(Pr),!Ar&&Dr?"["+Pr+"]":Pr}).join(Ar?".":""):Tr}function isFlatArray(_r){return utils$1.isArray(_r)&&!_r.some(isVisitable)}const predicates=utils$1.toFlatObject(utils$1,{},null,function(Tr){return/^is[A-Z]/.test(Tr)});function toFormData(_r,Tr,Ar){if(!utils$1.isObject(_r))throw new TypeError("target must be an object");Tr=Tr||new FormData,Ar=utils$1.toFlatObject(Ar,{metaTokens:!0,dots:!1,indexes:!1},!1,function(Wr,qr){return!utils$1.isUndefined(qr[Wr])});const Rr=Ar.metaTokens,Pr=Ar.visitor||Gr,Dr=Ar.dots,Mr=Ar.indexes,zr=(Ar.Blob||typeof Blob<"u"&&Blob)&&utils$1.isSpecCompliantForm(Tr);if(!utils$1.isFunction(Pr))throw new TypeError("visitor must be a function");function jr(Vr){if(Vr===null)return"";if(utils$1.isDate(Vr))return Vr.toISOString();if(!zr&&utils$1.isBlob(Vr))throw new AxiosError("Blob is not supported. Use a Buffer instead.");return utils$1.isArrayBuffer(Vr)||utils$1.isTypedArray(Vr)?zr&&typeof Blob=="function"?new Blob([Vr]):Buffer.from(Vr):Vr}function Gr(Vr,Wr,qr){let Kr=Vr;if(Vr&&!qr&&typeof Vr=="object"){if(utils$1.endsWith(Wr,"{}"))Wr=Rr?Wr:Wr.slice(0,-2),Vr=JSON.stringify(Vr);else if(utils$1.isArray(Vr)&&isFlatArray(Vr)||(utils$1.isFileList(Vr)||utils$1.endsWith(Wr,"[]"))&&(Kr=utils$1.toArray(Vr)))return Wr=removeBrackets(Wr),Kr.forEach(function(Zr,_i){!(utils$1.isUndefined(Zr)||Zr===null)&&Tr.append(Mr===!0?renderKey([Wr],_i,Dr):Mr===null?Wr:Wr+"[]",jr(Zr))}),!1}return isVisitable(Vr)?!0:(Tr.append(renderKey(qr,Wr,Dr),jr(Vr)),!1)}const Nr=[],Lr=Object.assign(predicates,{defaultVisitor:Gr,convertValue:jr,isVisitable});function Ur(Vr,Wr){if(!utils$1.isUndefined(Vr)){if(Nr.indexOf(Vr)!==-1)throw Error("Circular reference detected in "+Wr.join("."));Nr.push(Vr),utils$1.forEach(Vr,function(Kr,Xr){(!(utils$1.isUndefined(Kr)||Kr===null)&&Pr.call(Tr,Kr,utils$1.isString(Xr)?Xr.trim():Xr,Wr,Lr))===!0&&Ur(Kr,Wr?Wr.concat(Xr):[Xr])}),Nr.pop()}}if(!utils$1.isObject(_r))throw new TypeError("data must be an object");return Ur(_r),Tr}function encode$2(_r){const Tr={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(_r).replace(/[!'()~]|%20|%00/g,function(Rr){return Tr[Rr]})}function AxiosURLSearchParams(_r,Tr){this._pairs=[],_r&&toFormData(_r,this,Tr)}const prototype=AxiosURLSearchParams.prototype;prototype.append=function(Tr,Ar){this._pairs.push([Tr,Ar])};prototype.toString=function(Tr){const Ar=Tr?function(Rr){return Tr.call(this,Rr,encode$2)}:encode$2;return this._pairs.map(function(Pr){return Ar(Pr[0])+"="+Ar(Pr[1])},"").join("&")};function encode$1(_r){return encodeURIComponent(_r).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function buildURL(_r,Tr,Ar){if(!Tr)return _r;const Rr=Ar&&Ar.encode||encode$1,Pr=Ar&&Ar.serialize;let Dr;if(Pr?Dr=Pr(Tr,Ar):Dr=utils$1.isURLSearchParams(Tr)?Tr.toString():new AxiosURLSearchParams(Tr,Ar).toString(Rr),Dr){const Mr=_r.indexOf("#");Mr!==-1&&(_r=_r.slice(0,Mr)),_r+=(_r.indexOf("?")===-1?"?":"&")+Dr}return _r}class InterceptorManager{constructor(){this.handlers=[]}use(Tr,Ar,Rr){return this.handlers.push({fulfilled:Tr,rejected:Ar,synchronous:Rr?Rr.synchronous:!1,runWhen:Rr?Rr.runWhen:null}),this.handlers.length-1}eject(Tr){this.handlers[Tr]&&(this.handlers[Tr]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(Tr){utils$1.forEach(this.handlers,function(Rr){Rr!==null&&Tr(Rr)})}}const InterceptorManager$1=InterceptorManager,transitionalDefaults={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},URLSearchParams$1=typeof URLSearchParams<"u"?URLSearchParams:AxiosURLSearchParams,FormData$1=typeof FormData<"u"?FormData:null,Blob$1=typeof Blob<"u"?Blob:null,isStandardBrowserEnv=(()=>{let _r;return typeof navigator<"u"&&((_r=navigator.product)==="ReactNative"||_r==="NativeScript"||_r==="NS")?!1:typeof window<"u"&&typeof document<"u"})(),isStandardBrowserWebWorkerEnv=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),platform$1={isBrowser:!0,classes:{URLSearchParams:URLSearchParams$1,FormData:FormData$1,Blob:Blob$1},isStandardBrowserEnv,isStandardBrowserWebWorkerEnv,protocols:["http","https","file","blob","url","data"]};function toURLEncodedForm(_r,Tr){return toFormData(_r,new platform$1.classes.URLSearchParams,Object.assign({visitor:function(Ar,Rr,Pr,Dr){return platform$1.isNode&&utils$1.isBuffer(Ar)?(this.append(Rr,Ar.toString("base64")),!1):Dr.defaultVisitor.apply(this,arguments)}},Tr))}function parsePropPath(_r){return utils$1.matchAll(/\w+|\[(\w*)]/g,_r).map(Tr=>Tr[0]==="[]"?"":Tr[1]||Tr[0])}function arrayToObject(_r){const Tr={},Ar=Object.keys(_r);let Rr;const Pr=Ar.length;let Dr;for(Rr=0;Rr<Pr;Rr++)Dr=Ar[Rr],Tr[Dr]=_r[Dr];return Tr}function formDataToJSON(_r){function Tr(Ar,Rr,Pr,Dr){let Mr=Ar[Dr++];const Fr=Number.isFinite(+Mr),zr=Dr>=Ar.length;return Mr=!Mr&&utils$1.isArray(Pr)?Pr.length:Mr,zr?(utils$1.hasOwnProp(Pr,Mr)?Pr[Mr]=[Pr[Mr],Rr]:Pr[Mr]=Rr,!Fr):((!Pr[Mr]||!utils$1.isObject(Pr[Mr]))&&(Pr[Mr]=[]),Tr(Ar,Rr,Pr[Mr],Dr)&&utils$1.isArray(Pr[Mr])&&(Pr[Mr]=arrayToObject(Pr[Mr])),!Fr)}if(utils$1.isFormData(_r)&&utils$1.isFunction(_r.entries)){const Ar={};return utils$1.forEachEntry(_r,(Rr,Pr)=>{Tr(parsePropPath(Rr),Pr,Ar,0)}),Ar}return null}function stringifySafely(_r,Tr,Ar){if(utils$1.isString(_r))try{return(Tr||JSON.parse)(_r),utils$1.trim(_r)}catch(Rr){if(Rr.name!=="SyntaxError")throw Rr}return(Ar||JSON.stringify)(_r)}const defaults$1={transitional:transitionalDefaults,adapter:platform$1.isNode?"http":"xhr",transformRequest:[function(Tr,Ar){const Rr=Ar.getContentType()||"",Pr=Rr.indexOf("application/json")>-1,Dr=utils$1.isObject(Tr);if(Dr&&utils$1.isHTMLForm(Tr)&&(Tr=new FormData(Tr)),utils$1.isFormData(Tr))return Pr&&Pr?JSON.stringify(formDataToJSON(Tr)):Tr;if(utils$1.isArrayBuffer(Tr)||utils$1.isBuffer(Tr)||utils$1.isStream(Tr)||utils$1.isFile(Tr)||utils$1.isBlob(Tr))return Tr;if(utils$1.isArrayBufferView(Tr))return Tr.buffer;if(utils$1.isURLSearchParams(Tr))return Ar.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),Tr.toString();let Fr;if(Dr){if(Rr.indexOf("application/x-www-form-urlencoded")>-1)return toURLEncodedForm(Tr,this.formSerializer).toString();if((Fr=utils$1.isFileList(Tr))||Rr.indexOf("multipart/form-data")>-1){const zr=this.env&&this.env.FormData;return toFormData(Fr?{"files[]":Tr}:Tr,zr&&new zr,this.formSerializer)}}return Dr||Pr?(Ar.setContentType("application/json",!1),stringifySafely(Tr)):Tr}],transformResponse:[function(Tr){const Ar=this.transitional||defaults$1.transitional,Rr=Ar&&Ar.forcedJSONParsing,Pr=this.responseType==="json";if(Tr&&utils$1.isString(Tr)&&(Rr&&!this.responseType||Pr)){const Mr=!(Ar&&Ar.silentJSONParsing)&&Pr;try{return JSON.parse(Tr)}catch(Fr){if(Mr)throw Fr.name==="SyntaxError"?AxiosError.from(Fr,AxiosError.ERR_BAD_RESPONSE,this,null,this.response):Fr}}return Tr}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:platform$1.classes.FormData,Blob:platform$1.classes.Blob},validateStatus:function(Tr){return Tr>=200&&Tr<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};utils$1.forEach(["delete","get","head","post","put","patch"],_r=>{defaults$1.headers[_r]={}});const defaults$2=defaults$1,ignoreDuplicateOf=utils$1.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),parseHeaders=_r=>{const Tr={};let Ar,Rr,Pr;return _r&&_r.split(`
`).forEach(function(Mr){Pr=Mr.indexOf(":"),Ar=Mr.substring(0,Pr).trim().toLowerCase(),Rr=Mr.substring(Pr+1).trim(),!(!Ar||Tr[Ar]&&ignoreDuplicateOf[Ar])&&(Ar==="set-cookie"?Tr[Ar]?Tr[Ar].push(Rr):Tr[Ar]=[Rr]:Tr[Ar]=Tr[Ar]?Tr[Ar]+", "+Rr:Rr)}),Tr},$internals=Symbol("internals");function normalizeHeader(_r){return _r&&String(_r).trim().toLowerCase()}function normalizeValue(_r){return _r===!1||_r==null?_r:utils$1.isArray(_r)?_r.map(normalizeValue):String(_r)}function parseTokens(_r){const Tr=Object.create(null),Ar=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let Rr;for(;Rr=Ar.exec(_r);)Tr[Rr[1]]=Rr[2];return Tr}const isValidHeaderName=_r=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(_r.trim());function matchHeaderValue(_r,Tr,Ar,Rr,Pr){if(utils$1.isFunction(Rr))return Rr.call(this,Tr,Ar);if(Pr&&(Tr=Ar),!!utils$1.isString(Tr)){if(utils$1.isString(Rr))return Tr.indexOf(Rr)!==-1;if(utils$1.isRegExp(Rr))return Rr.test(Tr)}}function formatHeader(_r){return _r.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(Tr,Ar,Rr)=>Ar.toUpperCase()+Rr)}function buildAccessors(_r,Tr){const Ar=utils$1.toCamelCase(" "+Tr);["get","set","has"].forEach(Rr=>{Object.defineProperty(_r,Rr+Ar,{value:function(Pr,Dr,Mr){return this[Rr].call(this,Tr,Pr,Dr,Mr)},configurable:!0})})}class AxiosHeaders{constructor(Tr){Tr&&this.set(Tr)}set(Tr,Ar,Rr){const Pr=this;function Dr(Fr,zr,jr){const Gr=normalizeHeader(zr);if(!Gr)throw new Error("header name must be a non-empty string");const Nr=utils$1.findKey(Pr,Gr);(!Nr||Pr[Nr]===void 0||jr===!0||jr===void 0&&Pr[Nr]!==!1)&&(Pr[Nr||zr]=normalizeValue(Fr))}const Mr=(Fr,zr)=>utils$1.forEach(Fr,(jr,Gr)=>Dr(jr,Gr,zr));return utils$1.isPlainObject(Tr)||Tr instanceof this.constructor?Mr(Tr,Ar):utils$1.isString(Tr)&&(Tr=Tr.trim())&&!isValidHeaderName(Tr)?Mr(parseHeaders(Tr),Ar):Tr!=null&&Dr(Ar,Tr,Rr),this}get(Tr,Ar){if(Tr=normalizeHeader(Tr),Tr){const Rr=utils$1.findKey(this,Tr);if(Rr){const Pr=this[Rr];if(!Ar)return Pr;if(Ar===!0)return parseTokens(Pr);if(utils$1.isFunction(Ar))return Ar.call(this,Pr,Rr);if(utils$1.isRegExp(Ar))return Ar.exec(Pr);throw new TypeError("parser must be boolean|regexp|function")}}}has(Tr,Ar){if(Tr=normalizeHeader(Tr),Tr){const Rr=utils$1.findKey(this,Tr);return!!(Rr&&this[Rr]!==void 0&&(!Ar||matchHeaderValue(this,this[Rr],Rr,Ar)))}return!1}delete(Tr,Ar){const Rr=this;let Pr=!1;function Dr(Mr){if(Mr=normalizeHeader(Mr),Mr){const Fr=utils$1.findKey(Rr,Mr);Fr&&(!Ar||matchHeaderValue(Rr,Rr[Fr],Fr,Ar))&&(delete Rr[Fr],Pr=!0)}}return utils$1.isArray(Tr)?Tr.forEach(Dr):Dr(Tr),Pr}clear(Tr){const Ar=Object.keys(this);let Rr=Ar.length,Pr=!1;for(;Rr--;){const Dr=Ar[Rr];(!Tr||matchHeaderValue(this,this[Dr],Dr,Tr,!0))&&(delete this[Dr],Pr=!0)}return Pr}normalize(Tr){const Ar=this,Rr={};return utils$1.forEach(this,(Pr,Dr)=>{const Mr=utils$1.findKey(Rr,Dr);if(Mr){Ar[Mr]=normalizeValue(Pr),delete Ar[Dr];return}const Fr=Tr?formatHeader(Dr):String(Dr).trim();Fr!==Dr&&delete Ar[Dr],Ar[Fr]=normalizeValue(Pr),Rr[Fr]=!0}),this}concat(...Tr){return this.constructor.concat(this,...Tr)}toJSON(Tr){const Ar=Object.create(null);return utils$1.forEach(this,(Rr,Pr)=>{Rr!=null&&Rr!==!1&&(Ar[Pr]=Tr&&utils$1.isArray(Rr)?Rr.join(", "):Rr)}),Ar}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([Tr,Ar])=>Tr+": "+Ar).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(Tr){return Tr instanceof this?Tr:new this(Tr)}static concat(Tr,...Ar){const Rr=new this(Tr);return Ar.forEach(Pr=>Rr.set(Pr)),Rr}static accessor(Tr){const Rr=(this[$internals]=this[$internals]={accessors:{}}).accessors,Pr=this.prototype;function Dr(Mr){const Fr=normalizeHeader(Mr);Rr[Fr]||(buildAccessors(Pr,Mr),Rr[Fr]=!0)}return utils$1.isArray(Tr)?Tr.forEach(Dr):Dr(Tr),this}}AxiosHeaders.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);utils$1.reduceDescriptors(AxiosHeaders.prototype,({value:_r},Tr)=>{let Ar=Tr[0].toUpperCase()+Tr.slice(1);return{get:()=>_r,set(Rr){this[Ar]=Rr}}});utils$1.freezeMethods(AxiosHeaders);const AxiosHeaders$1=AxiosHeaders;function transformData(_r,Tr){const Ar=this||defaults$2,Rr=Tr||Ar,Pr=AxiosHeaders$1.from(Rr.headers);let Dr=Rr.data;return utils$1.forEach(_r,function(Fr){Dr=Fr.call(Ar,Dr,Pr.normalize(),Tr?Tr.status:void 0)}),Pr.normalize(),Dr}function isCancel(_r){return!!(_r&&_r.__CANCEL__)}function CanceledError(_r,Tr,Ar){AxiosError.call(this,_r??"canceled",AxiosError.ERR_CANCELED,Tr,Ar),this.name="CanceledError"}utils$1.inherits(CanceledError,AxiosError,{__CANCEL__:!0});function settle(_r,Tr,Ar){const Rr=Ar.config.validateStatus;!Ar.status||!Rr||Rr(Ar.status)?_r(Ar):Tr(new AxiosError("Request failed with status code "+Ar.status,[AxiosError.ERR_BAD_REQUEST,AxiosError.ERR_BAD_RESPONSE][Math.floor(Ar.status/100)-4],Ar.config,Ar.request,Ar))}const cookies=platform$1.isStandardBrowserEnv?function(){return{write:function(Ar,Rr,Pr,Dr,Mr,Fr){const zr=[];zr.push(Ar+"="+encodeURIComponent(Rr)),utils$1.isNumber(Pr)&&zr.push("expires="+new Date(Pr).toGMTString()),utils$1.isString(Dr)&&zr.push("path="+Dr),utils$1.isString(Mr)&&zr.push("domain="+Mr),Fr===!0&&zr.push("secure"),document.cookie=zr.join("; ")},read:function(Ar){const Rr=document.cookie.match(new RegExp("(^|;\\s*)("+Ar+")=([^;]*)"));return Rr?decodeURIComponent(Rr[3]):null},remove:function(Ar){this.write(Ar,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}();function isAbsoluteURL(_r){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(_r)}function combineURLs(_r,Tr){return Tr?_r.replace(/\/+$/,"")+"/"+Tr.replace(/^\/+/,""):_r}function buildFullPath(_r,Tr){return _r&&!isAbsoluteURL(Tr)?combineURLs(_r,Tr):Tr}const isURLSameOrigin=platform$1.isStandardBrowserEnv?function(){const Tr=/(msie|trident)/i.test(navigator.userAgent),Ar=document.createElement("a");let Rr;function Pr(Dr){let Mr=Dr;return Tr&&(Ar.setAttribute("href",Mr),Mr=Ar.href),Ar.setAttribute("href",Mr),{href:Ar.href,protocol:Ar.protocol?Ar.protocol.replace(/:$/,""):"",host:Ar.host,search:Ar.search?Ar.search.replace(/^\?/,""):"",hash:Ar.hash?Ar.hash.replace(/^#/,""):"",hostname:Ar.hostname,port:Ar.port,pathname:Ar.pathname.charAt(0)==="/"?Ar.pathname:"/"+Ar.pathname}}return Rr=Pr(window.location.href),function(Mr){const Fr=utils$1.isString(Mr)?Pr(Mr):Mr;return Fr.protocol===Rr.protocol&&Fr.host===Rr.host}}():function(){return function(){return!0}}();function parseProtocol(_r){const Tr=/^([-+\w]{1,25})(:?\/\/|:)/.exec(_r);return Tr&&Tr[1]||""}function speedometer(_r,Tr){_r=_r||10;const Ar=new Array(_r),Rr=new Array(_r);let Pr=0,Dr=0,Mr;return Tr=Tr!==void 0?Tr:1e3,function(zr){const jr=Date.now(),Gr=Rr[Dr];Mr||(Mr=jr),Ar[Pr]=zr,Rr[Pr]=jr;let Nr=Dr,Lr=0;for(;Nr!==Pr;)Lr+=Ar[Nr++],Nr=Nr%_r;if(Pr=(Pr+1)%_r,Pr===Dr&&(Dr=(Dr+1)%_r),jr-Mr<Tr)return;const Ur=Gr&&jr-Gr;return Ur?Math.round(Lr*1e3/Ur):void 0}}function progressEventReducer(_r,Tr){let Ar=0;const Rr=speedometer(50,250);return Pr=>{const Dr=Pr.loaded,Mr=Pr.lengthComputable?Pr.total:void 0,Fr=Dr-Ar,zr=Rr(Fr),jr=Dr<=Mr;Ar=Dr;const Gr={loaded:Dr,total:Mr,progress:Mr?Dr/Mr:void 0,bytes:Fr,rate:zr||void 0,estimated:zr&&Mr&&jr?(Mr-Dr)/zr:void 0,event:Pr};Gr[Tr?"download":"upload"]=!0,_r(Gr)}}const isXHRAdapterSupported=typeof XMLHttpRequest<"u",xhrAdapter=isXHRAdapterSupported&&function(_r){return new Promise(function(Ar,Rr){let Pr=_r.data;const Dr=AxiosHeaders$1.from(_r.headers).normalize(),Mr=_r.responseType;let Fr;function zr(){_r.cancelToken&&_r.cancelToken.unsubscribe(Fr),_r.signal&&_r.signal.removeEventListener("abort",Fr)}utils$1.isFormData(Pr)&&(platform$1.isStandardBrowserEnv||platform$1.isStandardBrowserWebWorkerEnv?Dr.setContentType(!1):Dr.setContentType("multipart/form-data;",!1));let jr=new XMLHttpRequest;if(_r.auth){const Ur=_r.auth.username||"",Vr=_r.auth.password?unescape(encodeURIComponent(_r.auth.password)):"";Dr.set("Authorization","Basic "+btoa(Ur+":"+Vr))}const Gr=buildFullPath(_r.baseURL,_r.url);jr.open(_r.method.toUpperCase(),buildURL(Gr,_r.params,_r.paramsSerializer),!0),jr.timeout=_r.timeout;function Nr(){if(!jr)return;const Ur=AxiosHeaders$1.from("getAllResponseHeaders"in jr&&jr.getAllResponseHeaders()),Wr={data:!Mr||Mr==="text"||Mr==="json"?jr.responseText:jr.response,status:jr.status,statusText:jr.statusText,headers:Ur,config:_r,request:jr};settle(function(Kr){Ar(Kr),zr()},function(Kr){Rr(Kr),zr()},Wr),jr=null}if("onloadend"in jr?jr.onloadend=Nr:jr.onreadystatechange=function(){!jr||jr.readyState!==4||jr.status===0&&!(jr.responseURL&&jr.responseURL.indexOf("file:")===0)||setTimeout(Nr)},jr.onabort=function(){jr&&(Rr(new AxiosError("Request aborted",AxiosError.ECONNABORTED,_r,jr)),jr=null)},jr.onerror=function(){Rr(new AxiosError("Network Error",AxiosError.ERR_NETWORK,_r,jr)),jr=null},jr.ontimeout=function(){let Vr=_r.timeout?"timeout of "+_r.timeout+"ms exceeded":"timeout exceeded";const Wr=_r.transitional||transitionalDefaults;_r.timeoutErrorMessage&&(Vr=_r.timeoutErrorMessage),Rr(new AxiosError(Vr,Wr.clarifyTimeoutError?AxiosError.ETIMEDOUT:AxiosError.ECONNABORTED,_r,jr)),jr=null},platform$1.isStandardBrowserEnv){const Ur=(_r.withCredentials||isURLSameOrigin(Gr))&&_r.xsrfCookieName&&cookies.read(_r.xsrfCookieName);Ur&&Dr.set(_r.xsrfHeaderName,Ur)}Pr===void 0&&Dr.setContentType(null),"setRequestHeader"in jr&&utils$1.forEach(Dr.toJSON(),function(Vr,Wr){jr.setRequestHeader(Wr,Vr)}),utils$1.isUndefined(_r.withCredentials)||(jr.withCredentials=!!_r.withCredentials),Mr&&Mr!=="json"&&(jr.responseType=_r.responseType),typeof _r.onDownloadProgress=="function"&&jr.addEventListener("progress",progressEventReducer(_r.onDownloadProgress,!0)),typeof _r.onUploadProgress=="function"&&jr.upload&&jr.upload.addEventListener("progress",progressEventReducer(_r.onUploadProgress)),(_r.cancelToken||_r.signal)&&(Fr=Ur=>{jr&&(Rr(!Ur||Ur.type?new CanceledError(null,_r,jr):Ur),jr.abort(),jr=null)},_r.cancelToken&&_r.cancelToken.subscribe(Fr),_r.signal&&(_r.signal.aborted?Fr():_r.signal.addEventListener("abort",Fr)));const Lr=parseProtocol(Gr);if(Lr&&platform$1.protocols.indexOf(Lr)===-1){Rr(new AxiosError("Unsupported protocol "+Lr+":",AxiosError.ERR_BAD_REQUEST,_r));return}jr.send(Pr||null)})},knownAdapters={http:httpAdapter,xhr:xhrAdapter};utils$1.forEach(knownAdapters,(_r,Tr)=>{if(_r){try{Object.defineProperty(_r,"name",{value:Tr})}catch{}Object.defineProperty(_r,"adapterName",{value:Tr})}});const adapters={getAdapter:_r=>{_r=utils$1.isArray(_r)?_r:[_r];const{length:Tr}=_r;let Ar,Rr;for(let Pr=0;Pr<Tr&&(Ar=_r[Pr],!(Rr=utils$1.isString(Ar)?knownAdapters[Ar.toLowerCase()]:Ar));Pr++);if(!Rr)throw Rr===!1?new AxiosError(`Adapter ${Ar} is not supported by the environment`,"ERR_NOT_SUPPORT"):new Error(utils$1.hasOwnProp(knownAdapters,Ar)?`Adapter '${Ar}' is not available in the build`:`Unknown adapter '${Ar}'`);if(!utils$1.isFunction(Rr))throw new TypeError("adapter is not a function");return Rr},adapters:knownAdapters};function throwIfCancellationRequested(_r){if(_r.cancelToken&&_r.cancelToken.throwIfRequested(),_r.signal&&_r.signal.aborted)throw new CanceledError(null,_r)}function dispatchRequest(_r){return throwIfCancellationRequested(_r),_r.headers=AxiosHeaders$1.from(_r.headers),_r.data=transformData.call(_r,_r.transformRequest),["post","put","patch"].indexOf(_r.method)!==-1&&_r.headers.setContentType("application/x-www-form-urlencoded",!1),adapters.getAdapter(_r.adapter||defaults$2.adapter)(_r).then(function(Rr){return throwIfCancellationRequested(_r),Rr.data=transformData.call(_r,_r.transformResponse,Rr),Rr.headers=AxiosHeaders$1.from(Rr.headers),Rr},function(Rr){return isCancel(Rr)||(throwIfCancellationRequested(_r),Rr&&Rr.response&&(Rr.response.data=transformData.call(_r,_r.transformResponse,Rr.response),Rr.response.headers=AxiosHeaders$1.from(Rr.response.headers))),Promise.reject(Rr)})}const headersToObject=_r=>_r instanceof AxiosHeaders$1?_r.toJSON():_r;function mergeConfig$1(_r,Tr){Tr=Tr||{};const Ar={};function Rr(jr,Gr,Nr){return utils$1.isPlainObject(jr)&&utils$1.isPlainObject(Gr)?utils$1.merge.call({caseless:Nr},jr,Gr):utils$1.isPlainObject(Gr)?utils$1.merge({},Gr):utils$1.isArray(Gr)?Gr.slice():Gr}function Pr(jr,Gr,Nr){if(utils$1.isUndefined(Gr)){if(!utils$1.isUndefined(jr))return Rr(void 0,jr,Nr)}else return Rr(jr,Gr,Nr)}function Dr(jr,Gr){if(!utils$1.isUndefined(Gr))return Rr(void 0,Gr)}function Mr(jr,Gr){if(utils$1.isUndefined(Gr)){if(!utils$1.isUndefined(jr))return Rr(void 0,jr)}else return Rr(void 0,Gr)}function Fr(jr,Gr,Nr){if(Nr in Tr)return Rr(jr,Gr);if(Nr in _r)return Rr(void 0,jr)}const zr={url:Dr,method:Dr,data:Dr,baseURL:Mr,transformRequest:Mr,transformResponse:Mr,paramsSerializer:Mr,timeout:Mr,timeoutMessage:Mr,withCredentials:Mr,adapter:Mr,responseType:Mr,xsrfCookieName:Mr,xsrfHeaderName:Mr,onUploadProgress:Mr,onDownloadProgress:Mr,decompress:Mr,maxContentLength:Mr,maxBodyLength:Mr,beforeRedirect:Mr,transport:Mr,httpAgent:Mr,httpsAgent:Mr,cancelToken:Mr,socketPath:Mr,responseEncoding:Mr,validateStatus:Fr,headers:(jr,Gr)=>Pr(headersToObject(jr),headersToObject(Gr),!0)};return utils$1.forEach(Object.keys(Object.assign({},_r,Tr)),function(Gr){const Nr=zr[Gr]||Pr,Lr=Nr(_r[Gr],Tr[Gr],Gr);utils$1.isUndefined(Lr)&&Nr!==Fr||(Ar[Gr]=Lr)}),Ar}const VERSION="1.5.0",validators$1={};["object","boolean","number","function","string","symbol"].forEach((_r,Tr)=>{validators$1[_r]=function(Rr){return typeof Rr===_r||"a"+(Tr<1?"n ":" ")+_r}});const deprecatedWarnings={};validators$1.transitional=function(Tr,Ar,Rr){function Pr(Dr,Mr){return"[Axios v"+VERSION+"] Transitional option '"+Dr+"'"+Mr+(Rr?". "+Rr:"")}return(Dr,Mr,Fr)=>{if(Tr===!1)throw new AxiosError(Pr(Mr," has been removed"+(Ar?" in "+Ar:"")),AxiosError.ERR_DEPRECATED);return Ar&&!deprecatedWarnings[Mr]&&(deprecatedWarnings[Mr]=!0,console.warn(Pr(Mr," has been deprecated since v"+Ar+" and will be removed in the near future"))),Tr?Tr(Dr,Mr,Fr):!0}};function assertOptions(_r,Tr,Ar){if(typeof _r!="object")throw new AxiosError("options must be an object",AxiosError.ERR_BAD_OPTION_VALUE);const Rr=Object.keys(_r);let Pr=Rr.length;for(;Pr-- >0;){const Dr=Rr[Pr],Mr=Tr[Dr];if(Mr){const Fr=_r[Dr],zr=Fr===void 0||Mr(Fr,Dr,_r);if(zr!==!0)throw new AxiosError("option "+Dr+" must be "+zr,AxiosError.ERR_BAD_OPTION_VALUE);continue}if(Ar!==!0)throw new AxiosError("Unknown option "+Dr,AxiosError.ERR_BAD_OPTION)}}const validator={assertOptions,validators:validators$1},validators=validator.validators;class Axios{constructor(Tr){this.defaults=Tr,this.interceptors={request:new InterceptorManager$1,response:new InterceptorManager$1}}request(Tr,Ar){typeof Tr=="string"?(Ar=Ar||{},Ar.url=Tr):Ar=Tr||{},Ar=mergeConfig$1(this.defaults,Ar);const{transitional:Rr,paramsSerializer:Pr,headers:Dr}=Ar;Rr!==void 0&&validator.assertOptions(Rr,{silentJSONParsing:validators.transitional(validators.boolean),forcedJSONParsing:validators.transitional(validators.boolean),clarifyTimeoutError:validators.transitional(validators.boolean)},!1),Pr!=null&&(utils$1.isFunction(Pr)?Ar.paramsSerializer={serialize:Pr}:validator.assertOptions(Pr,{encode:validators.function,serialize:validators.function},!0)),Ar.method=(Ar.method||this.defaults.method||"get").toLowerCase();let Mr=Dr&&utils$1.merge(Dr.common,Dr[Ar.method]);Dr&&utils$1.forEach(["delete","get","head","post","put","patch","common"],Vr=>{delete Dr[Vr]}),Ar.headers=AxiosHeaders$1.concat(Mr,Dr);const Fr=[];let zr=!0;this.interceptors.request.forEach(function(Wr){typeof Wr.runWhen=="function"&&Wr.runWhen(Ar)===!1||(zr=zr&&Wr.synchronous,Fr.unshift(Wr.fulfilled,Wr.rejected))});const jr=[];this.interceptors.response.forEach(function(Wr){jr.push(Wr.fulfilled,Wr.rejected)});let Gr,Nr=0,Lr;if(!zr){const Vr=[dispatchRequest.bind(this),void 0];for(Vr.unshift.apply(Vr,Fr),Vr.push.apply(Vr,jr),Lr=Vr.length,Gr=Promise.resolve(Ar);Nr<Lr;)Gr=Gr.then(Vr[Nr++],Vr[Nr++]);return Gr}Lr=Fr.length;let Ur=Ar;for(Nr=0;Nr<Lr;){const Vr=Fr[Nr++],Wr=Fr[Nr++];try{Ur=Vr(Ur)}catch(qr){Wr.call(this,qr);break}}try{Gr=dispatchRequest.call(this,Ur)}catch(Vr){return Promise.reject(Vr)}for(Nr=0,Lr=jr.length;Nr<Lr;)Gr=Gr.then(jr[Nr++],jr[Nr++]);return Gr}getUri(Tr){Tr=mergeConfig$1(this.defaults,Tr);const Ar=buildFullPath(Tr.baseURL,Tr.url);return buildURL(Ar,Tr.params,Tr.paramsSerializer)}}utils$1.forEach(["delete","get","head","options"],function(Tr){Axios.prototype[Tr]=function(Ar,Rr){return this.request(mergeConfig$1(Rr||{},{method:Tr,url:Ar,data:(Rr||{}).data}))}});utils$1.forEach(["post","put","patch"],function(Tr){function Ar(Rr){return function(Dr,Mr,Fr){return this.request(mergeConfig$1(Fr||{},{method:Tr,headers:Rr?{"Content-Type":"multipart/form-data"}:{},url:Dr,data:Mr}))}}Axios.prototype[Tr]=Ar(),Axios.prototype[Tr+"Form"]=Ar(!0)});const Axios$1=Axios;class CancelToken{constructor(Tr){if(typeof Tr!="function")throw new TypeError("executor must be a function.");let Ar;this.promise=new Promise(function(Dr){Ar=Dr});const Rr=this;this.promise.then(Pr=>{if(!Rr._listeners)return;let Dr=Rr._listeners.length;for(;Dr-- >0;)Rr._listeners[Dr](Pr);Rr._listeners=null}),this.promise.then=Pr=>{let Dr;const Mr=new Promise(Fr=>{Rr.subscribe(Fr),Dr=Fr}).then(Pr);return Mr.cancel=function(){Rr.unsubscribe(Dr)},Mr},Tr(function(Dr,Mr,Fr){Rr.reason||(Rr.reason=new CanceledError(Dr,Mr,Fr),Ar(Rr.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(Tr){if(this.reason){Tr(this.reason);return}this._listeners?this._listeners.push(Tr):this._listeners=[Tr]}unsubscribe(Tr){if(!this._listeners)return;const Ar=this._listeners.indexOf(Tr);Ar!==-1&&this._listeners.splice(Ar,1)}static source(){let Tr;return{token:new CancelToken(function(Pr){Tr=Pr}),cancel:Tr}}}const CancelToken$1=CancelToken;function spread(_r){return function(Ar){return _r.apply(null,Ar)}}function isAxiosError(_r){return utils$1.isObject(_r)&&_r.isAxiosError===!0}const HttpStatusCode={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(HttpStatusCode).forEach(([_r,Tr])=>{HttpStatusCode[Tr]=_r});const HttpStatusCode$1=HttpStatusCode;function createInstance(_r){const Tr=new Axios$1(_r),Ar=bind(Axios$1.prototype.request,Tr);return utils$1.extend(Ar,Axios$1.prototype,Tr,{allOwnKeys:!0}),utils$1.extend(Ar,Tr,null,{allOwnKeys:!0}),Ar.create=function(Pr){return createInstance(mergeConfig$1(_r,Pr))},Ar}const axios=createInstance(defaults$2);axios.Axios=Axios$1;axios.CanceledError=CanceledError;axios.CancelToken=CancelToken$1;axios.isCancel=isCancel;axios.VERSION=VERSION;axios.toFormData=toFormData;axios.AxiosError=AxiosError;axios.Cancel=axios.CanceledError;axios.all=function(Tr){return Promise.all(Tr)};axios.spread=spread;axios.isAxiosError=isAxiosError;axios.mergeConfig=mergeConfig$1;axios.AxiosHeaders=AxiosHeaders$1;axios.formToJSON=_r=>formDataToJSON(utils$1.isHTMLForm(_r)?new FormData(_r):_r);axios.getAdapter=adapters.getAdapter;axios.HttpStatusCode=HttpStatusCode$1;axios.default=axios;const axios$1=axios;var cjs$5={exports:{}},reactSpring_web_production_min={exports:{}},cjs$4={exports:{}},reactSpring_core_production_min={exports:{}},cjs$3={exports:{}},Y$3=Object.defineProperty,ut$1=Object.getOwnPropertyDescriptor,lt$1=Object.getOwnPropertyNames,ct$1=Object.prototype.hasOwnProperty,ke$1=(_r,Tr)=>{for(var Ar in Tr)Y$3(_r,Ar,{get:Tr[Ar],enumerable:!0})},dt$1=(_r,Tr,Ar,Rr)=>{if(Tr&&typeof Tr=="object"||typeof Tr=="function")for(let Pr of lt$1(Tr))!ct$1.call(_r,Pr)&&Pr!==Ar&&Y$3(_r,Pr,{get:()=>Tr[Pr],enumerable:!(Rr=ut$1(Tr,Pr))||Rr.enumerable});return _r},pt$1=_r=>dt$1(Y$3({},"__esModule",{value:!0}),_r),Jt$1={};ke$1(Jt$1,{FluidValue:()=>ge$1,Globals:()=>x$3,addFluidObserver:()=>Mt$1,callFluidObserver:()=>Ke,callFluidObservers:()=>At$1,clamp:()=>ue,colorToRgba:()=>G$3,colors:()=>Et$1,createInterpolator:()=>H$2,createStringInterpolator:()=>Vt$1,defineHidden:()=>bt$1,deprecateDirectCall:()=>Ut$1,deprecateInterpolate:()=>Pt$1,each:()=>ze$1,eachProp:()=>ht$1,easings:()=>kt$1,flush:()=>Le$1,flushCalls:()=>gt$1,frameLoop:()=>Pe$1,getFluidObservers:()=>Rt$1,getFluidValue:()=>ve$1,hasFluidValue:()=>St$1,hex3:()=>me,hex4:()=>be$1,hex6:()=>xe$1,hex8:()=>he$1,hsl:()=>de,hsla:()=>pe$1,is:()=>l$1,isAnimatedString:()=>$t$1,isEqual:()=>xt$1,isSSR:()=>h$2,noop:()=>ae$1,onResize:()=>Te$1,onScroll:()=>jt$1,once:()=>Fe$1,prefix:()=>W$3,raf:()=>f$2,removeFluidObserver:()=>Ct$1,rgb:()=>le$1,rgba:()=>ce$1,setFluidGetter:()=>_e,toArray:()=>yt$1,useConstant:()=>Dt$1,useForceUpdate:()=>Wt$1,useIsomorphicLayoutEffect:()=>C$1,useMemoOne:()=>Kt$1,useOnce:()=>Nt$1,usePrev:()=>Xt$1,useReducedMotion:()=>Yt$1});var reactSpring_shared_production_min=pt$1(Jt$1),x$3={};ke$1(x$3,{assign:()=>fe$1,colors:()=>d$3,createStringInterpolator:()=>V$3,skipAnimation:()=>qe,to:()=>Ve$1,willAdvance:()=>q$3});var ee$2=k$3(),f$2=_r=>I$2(_r,ee$2),te$2=k$3();f$2.write=_r=>I$2(_r,te$2);var L$1=k$3();f$2.onStart=_r=>I$2(_r,L$1);var re$2=k$3();f$2.onFrame=_r=>I$2(_r,re$2);var ne$1=k$3();f$2.onFinish=_r=>I$2(_r,ne$1);var w$1=[];f$2.setTimeout=(_r,Tr)=>{let Ar=f$2.now()+Tr,Rr=()=>{let Dr=w$1.findIndex(Mr=>Mr.cancel==Rr);~Dr&&w$1.splice(Dr,1),b$2-=~Dr?1:0},Pr={time:Ar,handler:_r,cancel:Rr};return w$1.splice(Se$1(Ar),0,Pr),b$2+=1,Re$1(),Pr};var Se$1=_r=>~(~w$1.findIndex(Tr=>Tr.time>_r)||~w$1.length);f$2.cancel=_r=>{L$1.delete(_r),re$2.delete(_r),ne$1.delete(_r),ee$2.delete(_r),te$2.delete(_r)};f$2.sync=_r=>{J$2=!0,f$2.batchedUpdates(_r),J$2=!1};f$2.throttle=_r=>{let Tr;function Ar(){try{_r(...Tr)}finally{Tr=null}}function Rr(...Pr){Tr=Pr,f$2.onStart(Ar)}return Rr.handler=_r,Rr.cancel=()=>{L$1.delete(Ar),Tr=null},Rr};var oe$1=typeof window<"u"?window.requestAnimationFrame:()=>{};f$2.use=_r=>oe$1=_r;f$2.now=typeof performance<"u"?()=>performance.now():Date.now;f$2.batchedUpdates=_r=>_r();f$2.catch=console.error;f$2.frameLoop="always";f$2.advance=()=>{f$2.frameLoop!=="demand"?console.warn("Cannot call the manual advancement of rafz whilst frameLoop is not set as demand"):Me$1()};var m$2=-1,b$2=0,J$2=!1;function I$2(_r,Tr){J$2?(Tr.delete(_r),_r(0)):(Tr.add(_r),Re$1())}function Re$1(){m$2<0&&(m$2=0,f$2.frameLoop!=="demand"&&oe$1(Ae$1))}function mt$1(){m$2=-1}function Ae$1(){~m$2&&(oe$1(Ae$1),f$2.batchedUpdates(Me$1))}function Me$1(){let _r=m$2;m$2=f$2.now();let Tr=Se$1(m$2);if(Tr&&(Ce$1(w$1.splice(0,Tr),Ar=>Ar.handler()),b$2-=Tr),!b$2){mt$1();return}L$1.flush(),ee$2.flush(_r?Math.min(64,m$2-_r):16.667),re$2.flush(),te$2.flush(),ne$1.flush()}function k$3(){let _r=new Set,Tr=_r;return{add(Ar){b$2+=Tr==_r&&!_r.has(Ar)?1:0,_r.add(Ar)},delete(Ar){return b$2-=Tr==_r&&_r.has(Ar)?1:0,_r.delete(Ar)},flush(Ar){Tr.size&&(_r=new Set,b$2-=Tr.size,Ce$1(Tr,Rr=>Rr(Ar)&&_r.add(Rr)),b$2+=_r.size,Tr=_r)}}}function Ce$1(_r,Tr){_r.forEach(Ar=>{try{Tr(Ar)}catch(Rr){f$2.catch(Rr)}})}function ae$1(){}var bt$1=(_r,Tr,Ar)=>Object.defineProperty(_r,Tr,{value:Ar,writable:!0,configurable:!0}),l$1={arr:Array.isArray,obj:_r=>!!_r&&_r.constructor.name==="Object",fun:_r=>typeof _r=="function",str:_r=>typeof _r=="string",num:_r=>typeof _r=="number",und:_r=>_r===void 0};function xt$1(_r,Tr){if(l$1.arr(_r)){if(!l$1.arr(Tr)||_r.length!==Tr.length)return!1;for(let Ar=0;Ar<_r.length;Ar++)if(_r[Ar]!==Tr[Ar])return!1;return!0}return _r===Tr}var ze$1=(_r,Tr)=>_r.forEach(Tr);function ht$1(_r,Tr,Ar){if(l$1.arr(_r)){for(let Rr=0;Rr<_r.length;Rr++)Tr.call(Ar,_r[Rr],`${Rr}`);return}for(let Rr in _r)_r.hasOwnProperty(Rr)&&Tr.call(Ar,_r[Rr],Rr)}var yt$1=_r=>l$1.und(_r)?[]:l$1.arr(_r)?_r:[_r];function Le$1(_r,Tr){if(_r.size){let Ar=Array.from(_r);_r.clear(),ze$1(Ar,Tr)}}var gt$1=(_r,...Tr)=>Le$1(_r,Ar=>Ar(...Tr)),h$2=()=>typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),V$3,Ve$1,d$3=null,qe=!1,q$3=ae$1,fe$1=_r=>{_r.to&&(Ve$1=_r.to),_r.now&&(f$2.now=_r.now),_r.colors!==void 0&&(d$3=_r.colors),_r.skipAnimation!=null&&(qe=_r.skipAnimation),_r.createStringInterpolator&&(V$3=_r.createStringInterpolator),_r.requestAnimationFrame&&f$2.use(_r.requestAnimationFrame),_r.batchedUpdates&&(f$2.batchedUpdates=_r.batchedUpdates),_r.willAdvance&&(q$3=_r.willAdvance),_r.frameLoop&&(f$2.frameLoop=_r.frameLoop)},S$3=new Set,c$2=[],ie$1=[],P$3=0,Pe$1={get idle(){return!S$3.size&&!c$2.length},start(_r){P$3>_r.priority?(S$3.add(_r),f$2.onStart(vt$1)):(Qe$1(_r),f$2(se$1))},advance:se$1,sort(_r){if(P$3)f$2.onFrame(()=>Pe$1.sort(_r));else{let Tr=c$2.indexOf(_r);~Tr&&(c$2.splice(Tr,1),Ue(_r))}},clear(){c$2=[],S$3.clear()}};function vt$1(){S$3.forEach(Qe$1),S$3.clear(),f$2(se$1)}function Qe$1(_r){c$2.includes(_r)||Ue(_r)}function Ue(_r){c$2.splice(wt$1(c$2,Tr=>Tr.priority>_r.priority),0,_r)}function se$1(_r){let Tr=ie$1;for(let Ar=0;Ar<c$2.length;Ar++){let Rr=c$2[Ar];P$3=Rr.priority,Rr.idle||(q$3(Rr),Rr.advance(_r),Rr.idle||Tr.push(Rr))}return P$3=0,ie$1=c$2,ie$1.length=0,c$2=Tr,c$2.length>0}function wt$1(_r,Tr){let Ar=_r.findIndex(Tr);return Ar<0?_r.length:Ar}var ue=(_r,Tr,Ar)=>Math.min(Math.max(Ar,_r),Tr),Et$1={transparent:0,aliceblue:4042850303,antiquewhite:4209760255,aqua:16777215,aquamarine:2147472639,azure:4043309055,beige:4126530815,bisque:4293182719,black:255,blanchedalmond:4293643775,blue:65535,blueviolet:2318131967,brown:2771004159,burlywood:3736635391,burntsienna:3934150143,cadetblue:1604231423,chartreuse:2147418367,chocolate:3530104575,coral:4286533887,cornflowerblue:1687547391,cornsilk:4294499583,crimson:3692313855,cyan:16777215,darkblue:35839,darkcyan:9145343,darkgoldenrod:3095792639,darkgray:2846468607,darkgreen:6553855,darkgrey:2846468607,darkkhaki:3182914559,darkmagenta:2332068863,darkolivegreen:1433087999,darkorange:4287365375,darkorchid:2570243327,darkred:2332033279,darksalmon:3918953215,darkseagreen:2411499519,darkslateblue:1211993087,darkslategray:793726975,darkslategrey:793726975,darkturquoise:13554175,darkviolet:2483082239,deeppink:4279538687,deepskyblue:12582911,dimgray:1768516095,dimgrey:1768516095,dodgerblue:512819199,firebrick:2988581631,floralwhite:4294635775,forestgreen:579543807,fuchsia:4278255615,gainsboro:3705462015,ghostwhite:4177068031,gold:4292280575,goldenrod:3668254975,gray:2155905279,green:8388863,greenyellow:2919182335,grey:2155905279,honeydew:4043305215,hotpink:4285117695,indianred:3445382399,indigo:1258324735,ivory:4294963455,khaki:4041641215,lavender:3873897215,lavenderblush:4293981695,lawngreen:2096890111,lemonchiffon:4294626815,lightblue:2916673279,lightcoral:4034953471,lightcyan:3774873599,lightgoldenrodyellow:4210742015,lightgray:3553874943,lightgreen:2431553791,lightgrey:3553874943,lightpink:4290167295,lightsalmon:4288707327,lightseagreen:548580095,lightskyblue:2278488831,lightslategray:2005441023,lightslategrey:2005441023,lightsteelblue:2965692159,lightyellow:4294959359,lime:16711935,limegreen:852308735,linen:4210091775,magenta:4278255615,maroon:2147483903,mediumaquamarine:1724754687,mediumblue:52735,mediumorchid:3126187007,mediumpurple:2473647103,mediumseagreen:1018393087,mediumslateblue:2070474495,mediumspringgreen:16423679,mediumturquoise:1221709055,mediumvioletred:3340076543,midnightblue:421097727,mintcream:4127193855,mistyrose:4293190143,moccasin:4293178879,navajowhite:4292783615,navy:33023,oldlace:4260751103,olive:2155872511,olivedrab:1804477439,orange:4289003775,orangered:4282712319,orchid:3664828159,palegoldenrod:4008225535,palegreen:2566625535,paleturquoise:2951671551,palevioletred:3681588223,papayawhip:4293907967,peachpuff:4292524543,peru:3448061951,pink:4290825215,plum:3718307327,powderblue:2967529215,purple:2147516671,rebeccapurple:1714657791,red:4278190335,rosybrown:3163525119,royalblue:1097458175,saddlebrown:2336560127,salmon:4202722047,sandybrown:4104413439,seagreen:780883967,seashell:4294307583,sienna:2689740287,silver:3233857791,skyblue:2278484991,slateblue:1784335871,slategray:1887473919,slategrey:1887473919,snow:4294638335,springgreen:16744447,steelblue:1182971135,tan:3535047935,teal:8421631,thistle:3636451583,tomato:4284696575,turquoise:1088475391,violet:4001558271,wheat:4125012991,white:4294967295,whitesmoke:4126537215,yellow:4294902015,yellowgreen:2597139199},p$2="[-+]?\\d*\\.?\\d+",Q$3=p$2+"%";function U$3(..._r){return"\\(\\s*("+_r.join(")\\s*,\\s*(")+")\\s*\\)"}var le$1=new RegExp("rgb"+U$3(p$2,p$2,p$2)),ce$1=new RegExp("rgba"+U$3(p$2,p$2,p$2,p$2)),de=new RegExp("hsl"+U$3(p$2,Q$3,Q$3)),pe$1=new RegExp("hsla"+U$3(p$2,Q$3,Q$3,p$2)),me=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,be$1=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,xe$1=/^#([0-9a-fA-F]{6})$/,he$1=/^#([0-9a-fA-F]{8})$/;function Be$1(_r){let Tr;return typeof _r=="number"?_r>>>0===_r&&_r>=0&&_r<=4294967295?_r:null:(Tr=xe$1.exec(_r))?parseInt(Tr[1]+"ff",16)>>>0:d$3&&d$3[_r]!==void 0?d$3[_r]:(Tr=le$1.exec(_r))?(E$2(Tr[1])<<24|E$2(Tr[2])<<16|E$2(Tr[3])<<8|255)>>>0:(Tr=ce$1.exec(_r))?(E$2(Tr[1])<<24|E$2(Tr[2])<<16|E$2(Tr[3])<<8|He$1(Tr[4]))>>>0:(Tr=me.exec(_r))?parseInt(Tr[1]+Tr[1]+Tr[2]+Tr[2]+Tr[3]+Tr[3]+"ff",16)>>>0:(Tr=he$1.exec(_r))?parseInt(Tr[1],16)>>>0:(Tr=be$1.exec(_r))?parseInt(Tr[1]+Tr[1]+Tr[2]+Tr[2]+Tr[3]+Tr[3]+Tr[4]+Tr[4],16)>>>0:(Tr=de.exec(_r))?($e$1(Ge(Tr[1]),$$1(Tr[2]),$$1(Tr[3]))|255)>>>0:(Tr=pe$1.exec(_r))?($e$1(Ge(Tr[1]),$$1(Tr[2]),$$1(Tr[3]))|He$1(Tr[4]))>>>0:null}function ye$1(_r,Tr,Ar){return Ar<0&&(Ar+=1),Ar>1&&(Ar-=1),Ar<1/6?_r+(Tr-_r)*6*Ar:Ar<1/2?Tr:Ar<2/3?_r+(Tr-_r)*(2/3-Ar)*6:_r}function $e$1(_r,Tr,Ar){let Rr=Ar<.5?Ar*(1+Tr):Ar+Tr-Ar*Tr,Pr=2*Ar-Rr,Dr=ye$1(Pr,Rr,_r+1/3),Mr=ye$1(Pr,Rr,_r),Fr=ye$1(Pr,Rr,_r-1/3);return Math.round(Dr*255)<<24|Math.round(Mr*255)<<16|Math.round(Fr*255)<<8}function E$2(_r){let Tr=parseInt(_r,10);return Tr<0?0:Tr>255?255:Tr}function Ge(_r){return(parseFloat(_r)%360+360)%360/360}function He$1(_r){let Tr=parseFloat(_r);return Tr<0?0:Tr>1?255:Math.round(Tr*255)}function $$1(_r){let Tr=parseFloat(_r);return Tr<0?0:Tr>100?1:Tr/100}function G$3(_r){let Tr=Be$1(_r);if(Tr===null)return _r;Tr=Tr||0;let Ar=(Tr&4278190080)>>>24,Rr=(Tr&16711680)>>>16,Pr=(Tr&65280)>>>8,Dr=(Tr&255)/255;return`rgba(${Ar}, ${Rr}, ${Pr}, ${Dr})`}var H$2=(_r,Tr,Ar)=>{if(l$1.fun(_r))return _r;if(l$1.arr(_r))return H$2({range:_r,output:Tr,extrapolate:Ar});if(l$1.str(_r.output[0]))return V$3(_r);let Rr=_r,Pr=Rr.output,Dr=Rr.range||[0,1],Mr=Rr.extrapolateLeft||Rr.extrapolate||"extend",Fr=Rr.extrapolateRight||Rr.extrapolate||"extend",zr=Rr.easing||(jr=>jr);return jr=>{let Gr=Tt$1(jr,Dr);return Ft$1(jr,Dr[Gr],Dr[Gr+1],Pr[Gr],Pr[Gr+1],zr,Mr,Fr,Rr.map)}};function Ft$1(_r,Tr,Ar,Rr,Pr,Dr,Mr,Fr,zr){let jr=zr?zr(_r):_r;if(jr<Tr){if(Mr==="identity")return jr;Mr==="clamp"&&(jr=Tr)}if(jr>Ar){if(Fr==="identity")return jr;Fr==="clamp"&&(jr=Ar)}return Rr===Pr?Rr:Tr===Ar?_r<=Tr?Rr:Pr:(Tr===-1/0?jr=-jr:Ar===1/0?jr=jr-Tr:jr=(jr-Tr)/(Ar-Tr),jr=Dr(jr),Rr===-1/0?jr=-jr:Pr===1/0?jr=jr+Rr:jr=jr*(Pr-Rr)+Rr,jr)}function Tt$1(_r,Tr){for(var Ar=1;Ar<Tr.length-1&&!(Tr[Ar]>=_r);++Ar);return Ar-1}var It$1=(_r,Tr="end")=>Ar=>{Ar=Tr==="end"?Math.min(Ar,.999):Math.max(Ar,.001);let Rr=Ar*_r,Pr=Tr==="end"?Math.floor(Rr):Math.ceil(Rr);return ue(0,1,Pr/_r)},D$2=1.70158,B$2=D$2*1.525,je=D$2+1,De=2*Math.PI/3,We=2*Math.PI/4.5,j$3=_r=>_r<1/2.75?7.5625*_r*_r:_r<2/2.75?7.5625*(_r-=1.5/2.75)*_r+.75:_r<2.5/2.75?7.5625*(_r-=2.25/2.75)*_r+.9375:7.5625*(_r-=2.625/2.75)*_r+.984375,kt$1={linear:_r=>_r,easeInQuad:_r=>_r*_r,easeOutQuad:_r=>1-(1-_r)*(1-_r),easeInOutQuad:_r=>_r<.5?2*_r*_r:1-Math.pow(-2*_r+2,2)/2,easeInCubic:_r=>_r*_r*_r,easeOutCubic:_r=>1-Math.pow(1-_r,3),easeInOutCubic:_r=>_r<.5?4*_r*_r*_r:1-Math.pow(-2*_r+2,3)/2,easeInQuart:_r=>_r*_r*_r*_r,easeOutQuart:_r=>1-Math.pow(1-_r,4),easeInOutQuart:_r=>_r<.5?8*_r*_r*_r*_r:1-Math.pow(-2*_r+2,4)/2,easeInQuint:_r=>_r*_r*_r*_r*_r,easeOutQuint:_r=>1-Math.pow(1-_r,5),easeInOutQuint:_r=>_r<.5?16*_r*_r*_r*_r*_r:1-Math.pow(-2*_r+2,5)/2,easeInSine:_r=>1-Math.cos(_r*Math.PI/2),easeOutSine:_r=>Math.sin(_r*Math.PI/2),easeInOutSine:_r=>-(Math.cos(Math.PI*_r)-1)/2,easeInExpo:_r=>_r===0?0:Math.pow(2,10*_r-10),easeOutExpo:_r=>_r===1?1:1-Math.pow(2,-10*_r),easeInOutExpo:_r=>_r===0?0:_r===1?1:_r<.5?Math.pow(2,20*_r-10)/2:(2-Math.pow(2,-20*_r+10))/2,easeInCirc:_r=>1-Math.sqrt(1-Math.pow(_r,2)),easeOutCirc:_r=>Math.sqrt(1-Math.pow(_r-1,2)),easeInOutCirc:_r=>_r<.5?(1-Math.sqrt(1-Math.pow(2*_r,2)))/2:(Math.sqrt(1-Math.pow(-2*_r+2,2))+1)/2,easeInBack:_r=>je*_r*_r*_r-D$2*_r*_r,easeOutBack:_r=>1+je*Math.pow(_r-1,3)+D$2*Math.pow(_r-1,2),easeInOutBack:_r=>_r<.5?Math.pow(2*_r,2)*((B$2+1)*2*_r-B$2)/2:(Math.pow(2*_r-2,2)*((B$2+1)*(_r*2-2)+B$2)+2)/2,easeInElastic:_r=>_r===0?0:_r===1?1:-Math.pow(2,10*_r-10)*Math.sin((_r*10-10.75)*De),easeOutElastic:_r=>_r===0?0:_r===1?1:Math.pow(2,-10*_r)*Math.sin((_r*10-.75)*De)+1,easeInOutElastic:_r=>_r===0?0:_r===1?1:_r<.5?-(Math.pow(2,20*_r-10)*Math.sin((20*_r-11.125)*We))/2:Math.pow(2,-20*_r+10)*Math.sin((20*_r-11.125)*We)/2+1,easeInBounce:_r=>1-j$3(1-_r),easeOutBounce:j$3,easeInOutBounce:_r=>_r<.5?(1-j$3(1-2*_r))/2:(1+j$3(2*_r-1))/2,steps:It$1},O$2=Symbol.for("FluidValue.get"),y$2=Symbol.for("FluidValue.observers"),St$1=_r=>!!(_r&&_r[O$2]),ve$1=_r=>_r&&_r[O$2]?_r[O$2]():_r,Rt$1=_r=>_r[y$2]||null;function Ke(_r,Tr){_r.eventObserved?_r.eventObserved(Tr):_r(Tr)}function At$1(_r,Tr){let Ar=_r[y$2];Ar&&Ar.forEach(Rr=>{Ke(Rr,Tr)})}var ge$1=class{constructor(Tr){if(!Tr&&!(Tr=this.get))throw Error("Unknown getter");_e(this,Tr)}},_e=(_r,Tr)=>Ne(_r,O$2,Tr);function Mt$1(_r,Tr){if(_r[O$2]){let Ar=_r[y$2];Ar||Ne(_r,y$2,Ar=new Set),Ar.has(Tr)||(Ar.add(Tr),_r.observerAdded&&_r.observerAdded(Ar.size,Tr))}return Tr}function Ct$1(_r,Tr){let Ar=_r[y$2];if(Ar&&Ar.has(Tr)){let Rr=Ar.size-1;Rr?Ar.delete(Tr):_r[y$2]=null,_r.observerRemoved&&_r.observerRemoved(Rr,Tr)}}var Ne=(_r,Tr,Ar)=>Object.defineProperty(_r,Tr,{value:Ar,writable:!0,configurable:!0}),R$3=/[+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,Ze=/(#(?:[0-9a-f]{2}){2,4}|(#[0-9a-f]{3})|(rgb|hsl)a?\((-?\d+%?[,\s]+){2,3}\s*[\d\.]+%?\))/gi,we$1=new RegExp(`(${R$3.source})(%|[a-z]+)`,"i"),Xe=/rgba\(([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+)\)/gi,g$2=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/,Ee$1=_r=>{let[Tr,Ar]=zt$1(_r);if(!Tr||h$2())return _r;let Rr=window.getComputedStyle(document.documentElement).getPropertyValue(Tr);return Rr?Rr.trim():Ar&&Ar.startsWith("--")?window.getComputedStyle(document.documentElement).getPropertyValue(Ar)||_r:Ar&&g$2.test(Ar)?Ee$1(Ar):Ar||_r},zt$1=_r=>{let Tr=g$2.exec(_r);if(!Tr)return[,];let[,Ar,Rr]=Tr;return[Ar,Rr]},Oe,Lt$1=(_r,Tr,Ar,Rr,Pr)=>`rgba(${Math.round(Tr)}, ${Math.round(Ar)}, ${Math.round(Rr)}, ${Pr})`,Vt$1=_r=>{Oe||(Oe=d$3?new RegExp(`(${Object.keys(d$3).join("|")})(?!\\w)`,"g"):/^\b$/);let Tr=_r.output.map(Pr=>ve$1(Pr).replace(g$2,Ee$1).replace(Ze,G$3).replace(Oe,G$3)),Ar=Tr.map(Pr=>Pr.match(R$3).map(Number)),Rr=Ar[0].map((Pr,Dr)=>Ar.map(Mr=>{if(!(Dr in Mr))throw Error('The arity of each "output" value must be equal');return Mr[Dr]})).map(Pr=>H$2({..._r,output:Pr}));return Pr=>{var Fr;let Dr=!we$1.test(Tr[0])&&((Fr=Tr.find(zr=>we$1.test(zr)))==null?void 0:Fr.replace(R$3,"")),Mr=0;return Tr[0].replace(R$3,()=>`${Rr[Mr++](Pr)}${Dr||""}`).replace(Xe,Lt$1)}},W$3="react-spring: ",Fe$1=_r=>{let Tr=_r,Ar=!1;if(typeof Tr!="function")throw new TypeError(`${W$3}once requires a function parameter`);return(...Rr)=>{Ar||(Tr(...Rr),Ar=!0)}},qt$1=Fe$1(console.warn);function Pt$1(){qt$1(`${W$3}The "interpolate" function is deprecated in v9 (use "to" instead)`)}var Qt$1=Fe$1(console.warn);function Ut$1(){Qt$1(`${W$3}Directly calling start instead of using the api object is deprecated in v9 (use ".start" instead), this will be removed in later 0.X.0 versions`)}function $t$1(_r){return l$1.str(_r)&&(_r[0]=="#"||/\d/.test(_r)||!h$2()&&g$2.test(_r)||_r in(d$3||{}))}var F$3,K$3=new WeakMap,Gt$1=_r=>_r.forEach(({target:Tr,contentRect:Ar})=>{var Rr;return(Rr=K$3.get(Tr))==null?void 0:Rr.forEach(Pr=>Pr(Ar))});function Ye$1(_r,Tr){F$3||typeof ResizeObserver<"u"&&(F$3=new ResizeObserver(Gt$1));let Ar=K$3.get(Tr);return Ar||(Ar=new Set,K$3.set(Tr,Ar)),Ar.add(_r),F$3&&F$3.observe(Tr),()=>{let Rr=K$3.get(Tr);Rr&&(Rr.delete(_r),!Rr.size&&F$3&&F$3.unobserve(Tr))}}var _$1=new Set,A$2,Ht$1=()=>{let _r=()=>{_$1.forEach(Tr=>Tr({width:window.innerWidth,height:window.innerHeight}))};return window.addEventListener("resize",_r),()=>{window.removeEventListener("resize",_r)}},Je$1=_r=>(_$1.add(_r),A$2||(A$2=Ht$1()),()=>{_$1.delete(_r),!_$1.size&&A$2&&(A$2(),A$2=void 0)}),Te$1=(_r,{container:Tr=document.documentElement}={})=>Tr===document.documentElement?Je$1(_r):Ye$1(_r,Tr),et$1=(_r,Tr,Ar)=>Tr-_r===0?1:(Ar-_r)/(Tr-_r),Bt$1={x:{length:"Width",position:"Left"},y:{length:"Height",position:"Top"}},N$3=class{constructor(Tr,Ar){this.createAxis=()=>({current:0,progress:0,scrollLength:0}),this.updateAxis=Rr=>{let Pr=this.info[Rr],{length:Dr,position:Mr}=Bt$1[Rr];Pr.current=this.container[`scroll${Mr}`],Pr.scrollLength=this.container["scroll"+Dr]-this.container["client"+Dr],Pr.progress=et$1(0,Pr.scrollLength,Pr.current)},this.update=()=>{this.updateAxis("x"),this.updateAxis("y")},this.sendEvent=()=>{this.callback(this.info)},this.advance=()=>{this.update(),this.sendEvent()},this.callback=Tr,this.container=Ar,this.info={time:0,x:this.createAxis(),y:this.createAxis()}}},M$3=new WeakMap,tt$1=new WeakMap,Ie$1=new WeakMap,rt$1=_r=>_r===document.documentElement?window:_r,jt$1=(_r,{container:Tr=document.documentElement}={})=>{let Ar=Ie$1.get(Tr);Ar||(Ar=new Set,Ie$1.set(Tr,Ar));let Rr=new N$3(_r,Tr);if(Ar.add(Rr),!M$3.has(Tr)){let Dr=()=>(Ar==null||Ar.forEach(Fr=>Fr.advance()),!0);M$3.set(Tr,Dr);let Mr=rt$1(Tr);window.addEventListener("resize",Dr,{passive:!0}),Tr!==document.documentElement&&tt$1.set(Tr,Te$1(Dr,{container:Tr})),Mr.addEventListener("scroll",Dr,{passive:!0})}let Pr=M$3.get(Tr);return f$2(Pr),()=>{var Fr;f$2.cancel(Pr);let Dr=Ie$1.get(Tr);if(!Dr||(Dr.delete(Rr),Dr.size))return;let Mr=M$3.get(Tr);M$3.delete(Tr),Mr&&(rt$1(Tr).removeEventListener("scroll",Mr),window.removeEventListener("resize",Mr),(Fr=tt$1.get(Tr))==null||Fr())}},nt$1=reactExports;function Dt$1(_r){let Tr=(0,nt$1.useRef)(null);return Tr.current===null&&(Tr.current=_r()),Tr.current}var ft$1=reactExports,ot$1=reactExports,Z$2=reactExports,C$1=h$2()?Z$2.useEffect:Z$2.useLayoutEffect,at$1=()=>{let _r=(0,ot$1.useRef)(!1);return C$1(()=>(_r.current=!0,()=>{_r.current=!1}),[]),_r};function Wt$1(){let _r=(0,ft$1.useState)()[1],Tr=at$1();return()=>{Tr.current&&_r(Math.random())}}var T$2=reactExports;function Kt$1(_r,Tr){let[Ar]=(0,T$2.useState)(()=>({inputs:Tr,result:_r()})),Rr=(0,T$2.useRef)(),Pr=Rr.current,Dr=Pr;return Dr?Tr&&Dr.inputs&&_t$1(Tr,Dr.inputs)||(Dr={inputs:Tr,result:_r()}):Dr=Ar,(0,T$2.useEffect)(()=>{Rr.current=Dr,Pr==Ar&&(Ar.inputs=Ar.result=void 0)},[Dr]),Dr.result}function _t$1(_r,Tr){if(_r.length!==Tr.length)return!1;for(let Ar=0;Ar<_r.length;Ar++)if(_r[Ar]!==Tr[Ar])return!1;return!0}var it$1=reactExports,Nt$1=_r=>(0,it$1.useEffect)(_r,Zt$1),Zt$1=[],X$3=reactExports;function Xt$1(_r){let Tr=(0,X$3.useRef)();return(0,X$3.useEffect)(()=>{Tr.current=_r}),Tr.current}var st$1=reactExports,Yt$1=()=>{let[_r,Tr]=(0,st$1.useState)(null);return C$1(()=>{let Ar=window.matchMedia("(prefers-reduced-motion)"),Rr=Pr=>{Tr(Pr.matches),fe$1({skipAnimation:Pr.matches})};return Rr(Ar),Ar.addEventListener("change",Rr),()=>{Ar.removeEventListener("change",Rr)}},[]),_r};cjs$3.exports=reactSpring_shared_production_min;var cjsExports$3=cjs$3.exports,cjs$2={exports:{}},D$1=Object.create,T$1=Object.defineProperty,K$2=Object.getOwnPropertyDescriptor,M$2=Object.getOwnPropertyNames,q$2=Object.getPrototypeOf,z$2=Object.prototype.hasOwnProperty,G$2=(_r,Tr)=>{for(var Ar in Tr)T$1(_r,Ar,{get:Tr[Ar],enumerable:!0})},E$1=(_r,Tr,Ar,Rr)=>{if(Tr&&typeof Tr=="object"||typeof Tr=="function")for(let Pr of M$2(Tr))!z$2.call(_r,Pr)&&Pr!==Ar&&T$1(_r,Pr,{get:()=>Tr[Pr],enumerable:!(Rr=K$2(Tr,Pr))||Rr.enumerable});return _r},J$1=(_r,Tr,Ar)=>(Ar=_r!=null?D$1(q$2(_r)):{},E$1(Tr||!_r||!_r.__esModule?T$1(Ar,"default",{value:_r,enumerable:!0}):Ar,_r)),Q$2=_r=>E$1(T$1({},"__esModule",{value:!0}),_r),re$1={};G$2(re$1,{Animated:()=>h$1,AnimatedArray:()=>g$1,AnimatedObject:()=>p$1,AnimatedString:()=>m$1,AnimatedValue:()=>d$2,createHost:()=>te$1,getAnimated:()=>v$1,getAnimatedType:()=>Y$2,getPayload:()=>k$2,isAnimated:()=>S$2,setAnimated:()=>N$2});var reactSpring_animated_production_min=Q$2(re$1),O$1=cjsExports$3,b$1=Symbol.for("Animated:node"),S$2=_r=>!!_r&&_r[b$1]===_r,v$1=_r=>_r&&_r[b$1],N$2=(_r,Tr)=>(0,O$1.defineHidden)(_r,b$1,Tr),k$2=_r=>_r&&_r[b$1]&&_r[b$1].getPayload(),h$1=class{constructor(){N$2(this,this)}getPayload(){return this.payload||[]}},P$2=cjsExports$3,d$2=class extends h$1{constructor(Tr){super(),this._value=Tr,this.done=!0,this.durationProgress=0,P$2.is.num(this._value)&&(this.lastPosition=this._value)}static create(Tr){return new d$2(Tr)}getPayload(){return[this]}getValue(){return this._value}setValue(Tr,Ar){return P$2.is.num(Tr)&&(this.lastPosition=Tr,Ar&&(Tr=Math.round(Tr/Ar)*Ar,this.done&&(this.lastPosition=Tr))),this._value===Tr?!1:(this._value=Tr,!0)}reset(){let{done:Tr}=this;this.done=!1,P$2.is.num(this._value)&&(this.elapsedTime=0,this.durationProgress=0,this.lastPosition=this._value,Tr&&(this.lastVelocity=null),this.v0=null)}},x$2=cjsExports$3,m$1=class extends d$2{constructor(Tr){super(0),this._string=null,this._toString=(0,x$2.createInterpolator)({output:[Tr,Tr]})}static create(Tr){return new m$1(Tr)}getValue(){return this._string??(this._string=this._toString(this._value))}setValue(Tr){if(x$2.is.str(Tr)){if(Tr==this._string)return!1;this._string=Tr,this._value=1}else if(super.setValue(Tr))this._string=null;else return!1;return!0}reset(Tr){Tr&&(this._toString=(0,x$2.createInterpolator)({output:[this.getValue(),Tr]})),this._value=0,super.reset()}},U$2=cjsExports$3,u$2=cjsExports$3,V$2={dependencies:null},p$1=class extends h$1{constructor(Tr){super(),this.source=Tr,this.setValue(Tr)}getValue(Tr){let Ar={};return(0,u$2.eachProp)(this.source,(Rr,Pr)=>{S$2(Rr)?Ar[Pr]=Rr.getValue(Tr):(0,u$2.hasFluidValue)(Rr)?Ar[Pr]=(0,u$2.getFluidValue)(Rr):Tr||(Ar[Pr]=Rr)}),Ar}setValue(Tr){this.source=Tr,this.payload=this._makePayload(Tr)}reset(){this.payload&&(0,u$2.each)(this.payload,Tr=>Tr.reset())}_makePayload(Tr){if(Tr){let Ar=new Set;return(0,u$2.eachProp)(Tr,this._addToPayload,Ar),Array.from(Ar)}}_addToPayload(Tr){V$2.dependencies&&(0,u$2.hasFluidValue)(Tr)&&V$2.dependencies.add(Tr);let Ar=k$2(Tr);Ar&&(0,u$2.each)(Ar,Rr=>this.add(Rr))}},g$1=class extends p$1{constructor(Tr){super(Tr)}static create(Tr){return new g$1(Tr)}getValue(){return this.source.map(Tr=>Tr.getValue())}setValue(Tr){let Ar=this.getPayload();return Tr.length==Ar.length?Ar.map((Rr,Pr)=>Rr.setValue(Tr[Pr])).some(Boolean):(super.setValue(Tr.map(X$2)),!0)}};function X$2(_r){return((0,U$2.isAnimatedString)(_r)?m$1:d$2).create(_r)}var _=cjsExports$3;function Y$2(_r){let Tr=v$1(_r);return Tr?Tr.constructor:_.is.arr(_r)?g$1:(0,_.isAnimatedString)(_r)?m$1:d$2}var f$1=cjsExports$3,j$2=J$1(reactExports),c$1=reactExports,o$2=cjsExports$3,R$2=(_r,Tr)=>{let Ar=!o$2.is.fun(_r)||_r.prototype&&_r.prototype.isReactComponent;return(0,c$1.forwardRef)((Rr,Pr)=>{let Dr=(0,c$1.useRef)(null),Mr=Ar&&(0,c$1.useCallback)(Vr=>{Dr.current=ee$1(Pr,Vr)},[Pr]),[Fr,zr]=Z$1(Rr,Tr),jr=(0,o$2.useForceUpdate)(),Gr=()=>{let Vr=Dr.current;Ar&&!Vr||(Vr?Tr.applyAnimatedValues(Vr,Fr.getValue(!0)):!1)===!1&&jr()},Nr=new F$2(Gr,zr),Lr=(0,c$1.useRef)();(0,o$2.useIsomorphicLayoutEffect)(()=>(Lr.current=Nr,(0,o$2.each)(zr,Vr=>(0,o$2.addFluidObserver)(Vr,Nr)),()=>{Lr.current&&((0,o$2.each)(Lr.current.deps,Vr=>(0,o$2.removeFluidObserver)(Vr,Lr.current)),o$2.raf.cancel(Lr.current.update))})),(0,c$1.useEffect)(Gr,[]),(0,o$2.useOnce)(()=>()=>{let Vr=Lr.current;(0,o$2.each)(Vr.deps,Wr=>(0,o$2.removeFluidObserver)(Wr,Vr))});let Ur=Tr.getComponentProps(Fr.getValue());return j$2.createElement(_r,{...Ur,ref:Mr})})},F$2=class{constructor(Tr,Ar){this.update=Tr,this.deps=Ar}eventObserved(Tr){Tr.type=="change"&&o$2.raf.write(this.update)}};function Z$1(_r,Tr){let Ar=new Set;return V$2.dependencies=Ar,_r.style&&(_r={..._r,style:Tr.createAnimatedStyle(_r.style)}),_r=new p$1(_r),V$2.dependencies=null,[_r,Ar]}function ee$1(_r,Tr){return _r&&(o$2.is.fun(_r)?_r(Tr):_r.current=Tr),Tr}var I$1=Symbol.for("AnimatedComponent"),te$1=(_r,{applyAnimatedValues:Tr=()=>!1,createAnimatedStyle:Ar=Pr=>new p$1(Pr),getComponentProps:Rr=Pr=>Pr}={})=>{let Pr={applyAnimatedValues:Tr,createAnimatedStyle:Ar,getComponentProps:Rr},Dr=Mr=>{let Fr=W$2(Mr)||"Anonymous";return f$1.is.str(Mr)?Mr=Dr[Mr]||(Dr[Mr]=R$2(Mr,Pr)):Mr=Mr[I$1]||(Mr[I$1]=R$2(Mr,Pr)),Mr.displayName=`Animated(${Fr})`,Mr};return(0,f$1.eachProp)(_r,(Mr,Fr)=>{f$1.is.arr(_r)&&(Fr=W$2(Mr)),Dr[Fr]=Dr(Mr)}),{animated:Dr}},W$2=_r=>f$1.is.str(_r)?_r:_r&&f$1.is.str(_r.displayName)?_r.displayName:f$1.is.fun(_r)&&_r.name||null;cjs$2.exports=reactSpring_animated_production_min;var cjsExports$2=cjs$2.exports,cjs$1={exports:{}},reactSpring_types_production_min,hasRequiredReactSpring_types_production_min;function requireReactSpring_types_production_min(){if(hasRequiredReactSpring_types_production_min)return reactSpring_types_production_min;hasRequiredReactSpring_types_production_min=1;var _r=Object.defineProperty,Tr=Object.getOwnPropertyDescriptor,Ar=Object.getOwnPropertyNames,Rr=Object.prototype.hasOwnProperty,Pr=(jr,Gr)=>{for(var Nr in Gr)_r(jr,Nr,{get:Gr[Nr],enumerable:!0})},Dr=(jr,Gr,Nr,Lr)=>{if(Gr&&typeof Gr=="object"||typeof Gr=="function")for(let Ur of Ar(Gr))!Rr.call(jr,Ur)&&Ur!==Nr&&_r(jr,Ur,{get:()=>Gr[Ur],enumerable:!(Lr=Tr(Gr,Ur))||Lr.enumerable});return jr},Mr=jr=>Dr(_r({},"__esModule",{value:!0}),jr),Fr={};Pr(Fr,{Any:()=>zr}),reactSpring_types_production_min=Mr(Fr);var zr=class{};return reactSpring_types_production_min}var hasRequiredCjs;function requireCjs(){return hasRequiredCjs||(hasRequiredCjs=1,cjs$1.exports=requireReactSpring_types_production_min()),cjs$1.exports}(function(_r){var Tr=Object.create,Ar=Object.defineProperty,Rr=Object.getOwnPropertyDescriptor,Pr=Object.getOwnPropertyNames,Dr=Object.getPrototypeOf,Mr=Object.prototype.hasOwnProperty,Fr=(ss,bs)=>{for(var _s in bs)Ar(ss,_s,{get:bs[_s],enumerable:!0})},zr=(ss,bs,_s,Es)=>{if(bs&&typeof bs=="object"||typeof bs=="function")for(let As of Pr(bs))!Mr.call(ss,As)&&As!==_s&&Ar(ss,As,{get:()=>bs[As],enumerable:!(Es=Rr(bs,As))||Es.enumerable});return ss},jr=(ss,bs,_s)=>(zr(ss,bs,"default"),_s&&zr(_s,bs,"default")),Gr=(ss,bs,_s)=>(_s=ss!=null?Tr(Dr(ss)):{},zr(bs||!ss||!ss.__esModule?Ar(_s,"default",{value:ss,enumerable:!0}):_s,ss)),Nr=ss=>zr(Ar({},"__esModule",{value:!0}),ss),Lr={};Fr(Lr,{BailSignal:()=>io,Controller:()=>zo,FrameValue:()=>Io,Globals:()=>os.Globals,Interpolation:()=>Cs,Spring:()=>mp,SpringContext:()=>Ru,SpringRef:()=>Ll,SpringValue:()=>Fs,Trail:()=>yp,Transition:()=>Ju,config:()=>zs,createInterpolator:()=>Ss.createInterpolator,easings:()=>Ss.easings,inferTo:()=>is,interpolate:()=>ms,to:()=>po,update:()=>us,useChain:()=>$s,useInView:()=>eu,useIsomorphicLayoutEffect:()=>Ss.useIsomorphicLayoutEffect,useReducedMotion:()=>Ss.useReducedMotion,useResize:()=>pp,useScroll:()=>Fl,useSpring:()=>Ou,useSpringRef:()=>cp,useSpringValue:()=>Rp,useSprings:()=>Vu,useTrail:()=>fp,useTransition:()=>hp}),_r.exports=Nr(Lr);var Ur=cjsExports$3,Vr=cjsExports$3;function Wr(ss,...bs){return Vr.is.fun(ss)?ss(...bs):ss}var qr=(ss,bs)=>ss===!0||!!(bs&&ss&&(Vr.is.fun(ss)?ss(bs):(0,Vr.toArray)(ss).includes(bs))),Kr=(ss,bs)=>Vr.is.obj(ss)?bs&&ss[bs]:ss,Xr=(ss,bs)=>ss.default===!0?ss[bs]:ss.default?ss.default[bs]:void 0,Zr=ss=>ss,_i=(ss,bs=Zr)=>{let _s=Jr;ss.default&&ss.default!==!0&&(ss=ss.default,_s=Object.keys(ss));let Es={};for(let As of _s){let Ms=bs(ss[As],As);Vr.is.und(Ms)||(Es[As]=Ms)}return Es},Jr=["config","onProps","onStart","onChange","onPause","onResume","onRest"],es={config:1,from:1,to:1,ref:1,loop:1,reset:1,pause:1,cancel:1,reverse:1,immediate:1,default:1,delay:1,onProps:1,onStart:1,onChange:1,onPause:1,onResume:1,onRest:1,onResolve:1,items:1,trail:1,sort:1,expires:1,initial:1,enter:1,update:1,leave:1,children:1,onDestroyed:1,keys:1,callId:1,parentId:1};function ts(ss){let bs={},_s=0;if((0,Vr.eachProp)(ss,(Es,As)=>{es[As]||(bs[As]=Es,_s++)}),_s)return bs}function is(ss){let bs=ts(ss);if(bs){let _s={to:bs};return(0,Vr.eachProp)(ss,(Es,As)=>As in bs||(_s[As]=Es)),_s}return{...ss}}function rs(ss){return ss=(0,Vr.getFluidValue)(ss),Vr.is.arr(ss)?ss.map(rs):(0,Vr.isAnimatedString)(ss)?Vr.Globals.createStringInterpolator({range:[0,1],output:[ss,ss]})(1):ss}function as(ss){for(let bs in ss)return!0;return!1}function ls(ss){return Vr.is.fun(ss)||Vr.is.arr(ss)&&Vr.is.obj(ss[0])}function fs(ss,bs){var _s;(_s=ss.ref)==null||_s.delete(ss),bs==null||bs.delete(ss)}function Ts(ss,bs){var _s;bs&&ss.ref!==bs&&((_s=ss.ref)==null||_s.delete(ss),bs.add(ss),ss.ref=bs)}function $s(ss,bs,_s=1e3){(0,Ur.useIsomorphicLayoutEffect)(()=>{if(bs){let Es=0;(0,Ur.each)(ss,(As,Ms)=>{let Vs=As.current;if(Vs.length){let so=_s*bs[Ms];isNaN(so)?so=Es:Es=so,(0,Ur.each)(Vs,_o=>{(0,Ur.each)(_o.queue,Ao=>{let Go=Ao.delay;Ao.delay=Oo=>so+Wr(Go||0,Oo)})}),As.start()}})}else{let Es=Promise.resolve();(0,Ur.each)(ss,As=>{let Ms=As.current;if(Ms.length){let Vs=Ms.map(so=>{let _o=so.queue;return so.queue=[],_o});Es=Es.then(()=>((0,Ur.each)(Ms,(so,_o)=>(0,Ur.each)(Vs[_o]||[],Ao=>so.queue.push(Ao))),Promise.all(As.start())))}})}})}var xs=cjsExports$3,ys=reactExports,ps=cjsExports$3,vs=cjsExports$3,Ds=cjsExports$2,js=cjsExports$3,zs={default:{tension:170,friction:26},gentle:{tension:120,friction:14},wobbly:{tension:180,friction:12},stiff:{tension:210,friction:20},slow:{tension:280,friction:60},molasses:{tension:280,friction:120}},qs={...zs.default,mass:1,damping:1,easing:js.easings.linear,clamp:!1},fo=class{constructor(){this.velocity=0,Object.assign(this,qs)}};function Qs(ss,bs,_s){_s&&(_s={..._s},no(_s,bs),bs={..._s,...bs}),no(ss,bs),Object.assign(ss,bs);for(let Vs in qs)ss[Vs]==null&&(ss[Vs]=qs[Vs]);let{frequency:Es,damping:As}=ss,{mass:Ms}=ss;return js.is.und(Es)||(Es<.01&&(Es=.01),As<0&&(As=0),ss.tension=Math.pow(2*Math.PI/Es,2)*Ms,ss.friction=4*Math.PI*As*Ms/Es),ss}function no(ss,bs){if(!js.is.und(bs.decay))ss.duration=void 0;else{let _s=!js.is.und(bs.tension)||!js.is.und(bs.friction);(_s||!js.is.und(bs.frequency)||!js.is.und(bs.damping)||!js.is.und(bs.mass))&&(ss.duration=void 0,ss.decay=void 0),_s&&(ss.frequency=void 0)}}var yo=[],Js=class{constructor(){this.changed=!1,this.values=yo,this.toValues=null,this.fromValues=yo,this.config=new fo,this.immediate=!1}},lo=cjsExports$3;function vo(ss,{key:bs,props:_s,defaultProps:Es,state:As,actions:Ms}){return new Promise((Vs,so)=>{let _o,Ao,Go=qr(_s.cancel??(Es==null?void 0:Es.cancel),bs);if(Go)Ko();else{lo.is.und(_s.pause)||(As.paused=qr(_s.pause,bs));let Wo=Es==null?void 0:Es.pause;Wo!==!0&&(Wo=As.paused||qr(Wo,bs)),_o=Wr(_s.delay||0,bs),Wo?(As.resumeQueue.add(Zo),Ms.pause()):(Ms.resume(),Zo())}function Oo(){As.resumeQueue.add(Zo),As.timeouts.delete(Ao),Ao.cancel(),_o=Ao.time-lo.raf.now()}function Zo(){_o>0&&!lo.Globals.skipAnimation?(As.delayed=!0,Ao=lo.raf.setTimeout(Ko,_o),As.pauseQueue.add(Oo),As.timeouts.add(Ao)):Ko()}function Ko(){As.delayed&&(As.delayed=!1),As.pauseQueue.delete(Oo),As.timeouts.delete(Ao),ss<=(As.cancelId||0)&&(Go=!0);try{Ms.start({..._s,callId:ss,cancel:Go},Vs)}catch(Wo){so(Wo)}}})}var Ro=cjsExports$3,Co=(ss,bs)=>bs.length==1?bs[0]:bs.some(_s=>_s.cancelled)?Os(ss.get()):bs.every(_s=>_s.noop)?Do(ss.get()):ds(ss.get(),bs.every(_s=>_s.finished)),Do=ss=>({value:ss,noop:!0,finished:!0,cancelled:!1}),ds=(ss,bs,_s=!1)=>({value:ss,finished:bs,cancelled:_s}),Os=ss=>({value:ss,cancelled:!0,finished:!1});function Ws(ss,bs,_s,Es){let{callId:As,parentId:Ms,onRest:Vs}=bs,{asyncTo:so,promise:_o}=_s;return!Ms&&ss===so&&!bs.reset?_o:_s.promise=(async()=>{_s.asyncId=As,_s.asyncTo=ss;let Ao=_i(bs,(Fo,Bo)=>Bo==="onRest"?void 0:Fo),Go,Oo,Zo=new Promise((Fo,Bo)=>(Go=Fo,Oo=Bo)),Ko=Fo=>{let Bo=As<=(_s.cancelId||0)&&Os(Es)||As!==_s.asyncId&&ds(Es,!1);if(Bo)throw Fo.result=Bo,Oo(Fo),Fo},Wo=(Fo,Bo)=>{let Qo=new io,jo=new ko;return(async()=>{if(Ro.Globals.skipAnimation)throw to(_s),jo.result=ds(Es,!1),Oo(jo),jo;Ko(Qo);let _a=Ro.is.obj(Fo)?{...Fo}:{...Bo,to:Fo};_a.parentId=As,(0,Ro.eachProp)(Ao,(Hl,Rl)=>{Ro.is.und(_a[Rl])&&(_a[Rl]=Hl)});let _l=await Es.start(_a);return Ko(Qo),_s.paused&&await new Promise(Hl=>{_s.resumeQueue.add(Hl)}),_l})()},No;if(Ro.Globals.skipAnimation)return to(_s),ds(Es,!1);try{let Fo;Ro.is.arr(ss)?Fo=(async Bo=>{for(let Qo of Bo)await Wo(Qo)})(ss):Fo=Promise.resolve(ss(Wo,Es.stop.bind(Es))),await Promise.all([Fo.then(Go),Zo]),No=ds(Es.get(),!0,!1)}catch(Fo){if(Fo instanceof io)No=Fo.result;else if(Fo instanceof ko)No=Fo.result;else throw Fo}finally{As==_s.asyncId&&(_s.asyncId=Ms,_s.asyncTo=Ms?so:void 0,_s.promise=Ms?_o:void 0)}return Ro.is.fun(Vs)&&Ro.raf.batchedUpdates(()=>{Vs(No,Es,Es.item)}),No})()}function to(ss,bs){(0,Ro.flush)(ss.timeouts,_s=>_s.cancel()),ss.pauseQueue.clear(),ss.resumeQueue.clear(),ss.asyncId=ss.asyncTo=ss.promise=void 0,bs&&(ss.cancelId=bs)}var io=class extends Error{constructor(){super("An async animation has been interrupted. You see this error because you forgot to use `await` or `.catch(...)` on its returned promise.")}},ko=class extends Error{constructor(){super("SkipAnimationSignal")}},go=cjsExports$3,To=cjsExports$2,Ho=ss=>ss instanceof Io,Uo=1,Io=class extends go.FluidValue{constructor(){super(...arguments),this.id=Uo++,this._priority=0}get priority(){return this._priority}set priority(ss){this._priority!=ss&&(this._priority=ss,this._onPriorityChange(ss))}get(){let ss=(0,To.getAnimated)(this);return ss&&ss.getValue()}to(...ss){return go.Globals.to(this,ss)}interpolate(...ss){return(0,go.deprecateInterpolate)(),go.Globals.to(this,ss)}toJSON(){return this.get()}observerAdded(ss){ss==1&&this._attach()}observerRemoved(ss){ss==0&&this._detach()}_attach(){}_detach(){}_onChange(ss,bs=!1){(0,go.callFluidObservers)(this,{type:"change",parent:this,value:ss,idle:bs})}_onPriorityChange(ss){this.idle||go.frameLoop.sort(this),(0,go.callFluidObservers)(this,{type:"priority",parent:this,priority:ss})}},xl=Symbol.for("SpringPhase"),Xo=1,El=2,Dl=4,ru=ss=>(ss[xl]&Xo)>0,Ul=ss=>(ss[xl]&El)>0,Kl=ss=>(ss[xl]&Dl)>0,vu=(ss,bs)=>bs?ss[xl]|=El|Xo:ss[xl]&=~El,Vo=(ss,bs)=>bs?ss[xl]|=Dl:ss[xl]&=~Dl,Fs=class extends Io{constructor(ss,bs){if(super(),this.animation=new Js,this.defaultProps={},this._state={paused:!1,delayed:!1,pauseQueue:new Set,resumeQueue:new Set,timeouts:new Set},this._pendingCalls=new Set,this._lastCallId=0,this._lastToId=0,this._memoizedDuration=0,!vs.is.und(ss)||!vs.is.und(bs)){let _s=vs.is.obj(ss)?{...ss}:{...bs,from:ss};vs.is.und(_s.default)&&(_s.default=!0),this.start(_s)}}get idle(){return!(Ul(this)||this._state.asyncTo)||Kl(this)}get goal(){return(0,vs.getFluidValue)(this.animation.to)}get velocity(){let ss=(0,Ds.getAnimated)(this);return ss instanceof Ds.AnimatedValue?ss.lastVelocity||0:ss.getPayload().map(bs=>bs.lastVelocity||0)}get hasAnimated(){return ru(this)}get isAnimating(){return Ul(this)}get isPaused(){return Kl(this)}get isDelayed(){return this._state.delayed}advance(ss){let bs=!0,_s=!1,Es=this.animation,{toValues:As}=Es,{config:Ms}=Es,Vs=(0,Ds.getPayload)(Es.to);!Vs&&(0,vs.hasFluidValue)(Es.to)&&(As=(0,vs.toArray)((0,vs.getFluidValue)(Es.to))),Es.values.forEach((Ao,Go)=>{if(Ao.done)return;let Oo=Ao.constructor==Ds.AnimatedString?1:Vs?Vs[Go].lastPosition:As[Go],Zo=Es.immediate,Ko=Oo;if(!Zo){if(Ko=Ao.lastPosition,Ms.tension<=0){Ao.done=!0;return}let Wo=Ao.elapsedTime+=ss,No=Es.fromValues[Go],Fo=Ao.v0!=null?Ao.v0:Ao.v0=vs.is.arr(Ms.velocity)?Ms.velocity[Go]:Ms.velocity,Bo,Qo=Ms.precision||(No==Oo?.005:Math.min(1,Math.abs(Oo-No)*.001));if(vs.is.und(Ms.duration))if(Ms.decay){let jo=Ms.decay===!0?.998:Ms.decay,_a=Math.exp(-(1-jo)*Wo);Ko=No+Fo/(1-jo)*(1-_a),Zo=Math.abs(Ao.lastPosition-Ko)<=Qo,Bo=Fo*_a}else{Bo=Ao.lastVelocity==null?Fo:Ao.lastVelocity;let jo=Ms.restVelocity||Qo/10,_a=Ms.clamp?0:Ms.bounce,_l=!vs.is.und(_a),Hl=No==Oo?Ao.v0>0:No<Oo,Rl,Ql=!1,Wl=1,pu=Math.ceil(ss/Wl);for(let du=0;du<pu&&(Rl=Math.abs(Bo)>jo,!(!Rl&&(Zo=Math.abs(Oo-Ko)<=Qo,Zo)));++du){_l&&(Ql=Ko==Oo||Ko>Oo==Hl,Ql&&(Bo=-Bo*_a,Ko=Oo));let wu=-Ms.tension*1e-6*(Ko-Oo),ou=-Ms.friction*.001*Bo,$a=(wu+ou)/Ms.mass;Bo=Bo+$a*Wl,Ko=Ko+Bo*Wl}}else{let jo=1;Ms.duration>0&&(this._memoizedDuration!==Ms.duration&&(this._memoizedDuration=Ms.duration,Ao.durationProgress>0&&(Ao.elapsedTime=Ms.duration*Ao.durationProgress,Wo=Ao.elapsedTime+=ss)),jo=(Ms.progress||0)+Wo/this._memoizedDuration,jo=jo>1?1:jo<0?0:jo,Ao.durationProgress=jo),Ko=No+Ms.easing(jo)*(Oo-No),Bo=(Ko-Ao.lastPosition)/ss,Zo=jo==1}Ao.lastVelocity=Bo,Number.isNaN(Ko)&&(console.warn("Got NaN while animating:",this),Zo=!0)}Vs&&!Vs[Go].done&&(Zo=!1),Zo?Ao.done=!0:bs=!1,Ao.setValue(Ko,Ms.round)&&(_s=!0)});let so=(0,Ds.getAnimated)(this),_o=so.getValue();if(bs){let Ao=(0,vs.getFluidValue)(Es.to);(_o!==Ao||_s)&&!Ms.decay?(so.setValue(Ao),this._onChange(Ao)):_s&&Ms.decay&&this._onChange(_o),this._stop()}else _s&&this._onChange(_o)}set(ss){return vs.raf.batchedUpdates(()=>{this._stop(),this._focus(ss),this._set(ss)}),this}pause(){this._update({pause:!0})}resume(){this._update({pause:!1})}finish(){if(Ul(this)){let{to:ss,config:bs}=this.animation;vs.raf.batchedUpdates(()=>{this._onStart(),bs.decay||this._set(ss,!1),this._stop()})}return this}update(ss){return(this.queue||(this.queue=[])).push(ss),this}start(ss,bs){let _s;return vs.is.und(ss)?(_s=this.queue||[],this.queue=[]):_s=[vs.is.obj(ss)?ss:{...bs,to:ss}],Promise.all(_s.map(Es=>this._update(Es))).then(Es=>Co(this,Es))}stop(ss){let{to:bs}=this.animation;return this._focus(this.get()),to(this._state,ss&&this._lastCallId),vs.raf.batchedUpdates(()=>this._stop(bs,ss)),this}reset(){this._update({reset:!0})}eventObserved(ss){ss.type=="change"?this._start():ss.type=="priority"&&(this.priority=ss.priority+1)}_prepareNode(ss){let bs=this.key||"",{to:_s,from:Es}=ss;_s=vs.is.obj(_s)?_s[bs]:_s,(_s==null||ls(_s))&&(_s=void 0),Es=vs.is.obj(Es)?Es[bs]:Es,Es==null&&(Es=void 0);let As={to:_s,from:Es};return ru(this)||(ss.reverse&&([_s,Es]=[Es,_s]),Es=(0,vs.getFluidValue)(Es),vs.is.und(Es)?(0,Ds.getAnimated)(this)||this._set(_s):this._set(Es)),As}_update({...ss},bs){let{key:_s,defaultProps:Es}=this;ss.default&&Object.assign(Es,_i(ss,(Vs,so)=>/^on/.test(so)?Kr(Vs,_s):Vs)),bo(this,ss,"onProps"),ho(this,"onProps",ss,this);let As=this._prepareNode(ss);if(Object.isFrozen(this))throw Error("Cannot animate a `SpringValue` object that is frozen. Did you forget to pass your component to `animated(...)` before animating its props?");let Ms=this._state;return vo(++this._lastCallId,{key:_s,props:ss,defaultProps:Es,state:Ms,actions:{pause:()=>{Kl(this)||(Vo(this,!0),(0,vs.flushCalls)(Ms.pauseQueue),ho(this,"onPause",ds(this,Ks(this,this.animation.to)),this))},resume:()=>{Kl(this)&&(Vo(this,!1),Ul(this)&&this._resume(),(0,vs.flushCalls)(Ms.resumeQueue),ho(this,"onResume",ds(this,Ks(this,this.animation.to)),this))},start:this._merge.bind(this,As)}}).then(Vs=>{if(ss.loop&&Vs.finished&&!(bs&&Vs.noop)){let so=gs(ss);if(so)return this._update(so,!0)}return Vs})}_merge(ss,bs,_s){if(bs.cancel)return this.stop(!0),_s(Os(this));let Es=!vs.is.und(ss.to),As=!vs.is.und(ss.from);if(Es||As)if(bs.callId>this._lastToId)this._lastToId=bs.callId;else return _s(Os(this));let{key:Ms,defaultProps:Vs,animation:so}=this,{to:_o,from:Ao}=so,{to:Go=_o,from:Oo=Ao}=ss;As&&!Es&&(!bs.default||vs.is.und(Go))&&(Go=Oo),bs.reverse&&([Go,Oo]=[Oo,Go]);let Zo=!(0,vs.isEqual)(Oo,Ao);Zo&&(so.from=Oo),Oo=(0,vs.getFluidValue)(Oo);let Ko=!(0,vs.isEqual)(Go,_o);Ko&&this._focus(Go);let Wo=ls(bs.to),{config:No}=so,{decay:Fo,velocity:Bo}=No;(Es||As)&&(No.velocity=0),bs.config&&!Wo&&Qs(No,Wr(bs.config,Ms),bs.config!==Vs.config?Wr(Vs.config,Ms):void 0);let Qo=(0,Ds.getAnimated)(this);if(!Qo||vs.is.und(Go))return _s(ds(this,!0));let jo=vs.is.und(bs.reset)?As&&!bs.default:!vs.is.und(Oo)&&qr(bs.reset,Ms),_a=jo?Oo:this.get(),_l=rs(Go),Hl=vs.is.num(_l)||vs.is.arr(_l)||(0,vs.isAnimatedString)(_l),Rl=!Wo&&(!Hl||qr(Vs.immediate||bs.immediate,Ms));if(Ko){let du=(0,Ds.getAnimatedType)(Go);if(du!==Qo.constructor)if(Rl)Qo=this._set(_l);else throw Error(`Cannot animate between ${Qo.constructor.name} and ${du.name}, as the "to" prop suggests`)}let Ql=Qo.constructor,Wl=(0,vs.hasFluidValue)(Go),pu=!1;if(!Wl){let du=jo||!ru(this)&&Zo;(Ko||du)&&(pu=(0,vs.isEqual)(rs(_a),_l),Wl=!pu),(!(0,vs.isEqual)(so.immediate,Rl)&&!Rl||!(0,vs.isEqual)(No.decay,Fo)||!(0,vs.isEqual)(No.velocity,Bo))&&(Wl=!0)}if(pu&&Ul(this)&&(so.changed&&!jo?Wl=!0:Wl||this._stop(_o)),!Wo&&((Wl||(0,vs.hasFluidValue)(_o))&&(so.values=Qo.getPayload(),so.toValues=(0,vs.hasFluidValue)(Go)?null:Ql==Ds.AnimatedString?[1]:(0,vs.toArray)(_l)),so.immediate!=Rl&&(so.immediate=Rl,!Rl&&!jo&&this._set(_o)),Wl)){let{onRest:du}=so;(0,vs.each)(Zs,ou=>bo(this,bs,ou));let wu=ds(this,Ks(this,_o));(0,vs.flushCalls)(this._pendingCalls,wu),this._pendingCalls.add(_s),so.changed&&vs.raf.batchedUpdates(()=>{var ou;so.changed=!jo,du==null||du(wu,this),jo?Wr(Vs.onRest,wu):(ou=so.onStart)==null||ou.call(so,wu,this)})}jo&&this._set(_a),Wo?_s(Ws(bs.to,bs,this._state,this)):Wl?this._start():Ul(this)&&!Ko?this._pendingCalls.add(_s):_s(Do(_a))}_focus(ss){let bs=this.animation;ss!==bs.to&&((0,vs.getFluidObservers)(this)&&this._detach(),bs.to=ss,(0,vs.getFluidObservers)(this)&&this._attach())}_attach(){let ss=0,{to:bs}=this.animation;(0,vs.hasFluidValue)(bs)&&((0,vs.addFluidObserver)(bs,this),Ho(bs)&&(ss=bs.priority+1)),this.priority=ss}_detach(){let{to:ss}=this.animation;(0,vs.hasFluidValue)(ss)&&(0,vs.removeFluidObserver)(ss,this)}_set(ss,bs=!0){let _s=(0,vs.getFluidValue)(ss);if(!vs.is.und(_s)){let Es=(0,Ds.getAnimated)(this);if(!Es||!(0,vs.isEqual)(_s,Es.getValue())){let As=(0,Ds.getAnimatedType)(_s);!Es||Es.constructor!=As?(0,Ds.setAnimated)(this,As.create(_s)):Es.setValue(_s),Es&&vs.raf.batchedUpdates(()=>{this._onChange(_s,bs)})}}return(0,Ds.getAnimated)(this)}_onStart(){let ss=this.animation;ss.changed||(ss.changed=!0,ho(this,"onStart",ds(this,Ks(this,ss.to)),this))}_onChange(ss,bs){bs||(this._onStart(),Wr(this.animation.onChange,ss,this)),Wr(this.defaultProps.onChange,ss,this),super._onChange(ss,bs)}_start(){let ss=this.animation;(0,Ds.getAnimated)(this).reset((0,vs.getFluidValue)(ss.to)),ss.immediate||(ss.fromValues=ss.values.map(bs=>bs.lastPosition)),Ul(this)||(vu(this,!0),Kl(this)||this._resume())}_resume(){vs.Globals.skipAnimation?this.finish():vs.frameLoop.start(this)}_stop(ss,bs){if(Ul(this)){vu(this,!1);let _s=this.animation;(0,vs.each)(_s.values,As=>{As.done=!0}),_s.toValues&&(_s.onChange=_s.onPause=_s.onResume=void 0),(0,vs.callFluidObservers)(this,{type:"idle",parent:this});let Es=bs?Os(this.get()):ds(this.get(),Ks(this,ss??_s.to));(0,vs.flushCalls)(this._pendingCalls,Es),_s.changed&&(_s.changed=!1,ho(this,"onRest",Es,this))}}};function Ks(ss,bs){let _s=rs(bs),Es=rs(ss.get());return(0,vs.isEqual)(Es,_s)}function gs(ss,bs=ss.loop,_s=ss.to){let Es=Wr(bs);if(Es){let As=Es!==!0&&is(Es),Ms=(As||ss).reverse,Vs=!As||As.reset;return hs({...ss,loop:bs,default:!1,pause:void 0,to:!Ms||ls(_s)?_s:void 0,from:Vs?ss.from:void 0,reset:Vs,...As})}}function hs(ss){let{to:bs,from:_s}=ss=is(ss),Es=new Set;return vs.is.obj(bs)&&ks(bs,Es),vs.is.obj(_s)&&ks(_s,Es),ss.keys=Es.size?Array.from(Es):null,ss}function Ps(ss){let bs=hs(ss);return vs.is.und(bs.default)&&(bs.default=_i(bs)),bs}function ks(ss,bs){(0,vs.eachProp)(ss,(_s,Es)=>_s!=null&&bs.add(Es))}var Zs=["onStart","onRest","onChange","onPause","onResume"];function bo(ss,bs,_s){ss.animation[_s]=bs[_s]!==Xr(bs,_s)?Kr(bs[_s],ss.key):void 0}function ho(ss,bs,..._s){var Es,As,Ms,Vs;(As=(Es=ss.animation)[bs])==null||As.call(Es,..._s),(Vs=(Ms=ss.defaultProps)[bs])==null||Vs.call(Ms,..._s)}var eo=cjsExports$3,Po=["onStart","onChange","onRest"],qo=1,zo=class{constructor(ss,bs){this.id=qo++,this.springs={},this.queue=[],this._lastAsyncId=0,this._active=new Set,this._changed=new Set,this._started=!1,this._state={paused:!1,pauseQueue:new Set,resumeQueue:new Set,timeouts:new Set},this._events={onStart:new Map,onChange:new Map,onRest:new Map},this._onFrame=this._onFrame.bind(this),bs&&(this._flush=bs),ss&&this.start({default:!0,...ss})}get idle(){return!this._state.asyncTo&&Object.values(this.springs).every(ss=>ss.idle&&!ss.isDelayed&&!ss.isPaused)}get item(){return this._item}set item(ss){this._item=ss}get(){let ss={};return this.each((bs,_s)=>ss[_s]=bs.get()),ss}set(ss){for(let bs in ss){let _s=ss[bs];eo.is.und(_s)||this.springs[bs].set(_s)}}update(ss){return ss&&this.queue.push(hs(ss)),this}start(ss){let{queue:bs}=this;return ss?bs=(0,eo.toArray)(ss).map(hs):this.queue=[],this._flush?this._flush(this,bs):(_f(this,bs),Hs(this,bs))}stop(ss,bs){if(ss!==!!ss&&(bs=ss),bs){let _s=this.springs;(0,eo.each)((0,eo.toArray)(bs),Es=>_s[Es].stop(!!ss))}else to(this._state,this._lastAsyncId),this.each(_s=>_s.stop(!!ss));return this}pause(ss){if(eo.is.und(ss))this.start({pause:!0});else{let bs=this.springs;(0,eo.each)((0,eo.toArray)(ss),_s=>bs[_s].pause())}return this}resume(ss){if(eo.is.und(ss))this.start({pause:!1});else{let bs=this.springs;(0,eo.each)((0,eo.toArray)(ss),_s=>bs[_s].resume())}return this}each(ss){(0,eo.eachProp)(this.springs,ss)}_onFrame(){let{onStart:ss,onChange:bs,onRest:_s}=this._events,Es=this._active.size>0,As=this._changed.size>0;(Es&&!this._started||As&&!this._started)&&(this._started=!0,(0,eo.flush)(ss,([so,_o])=>{_o.value=this.get(),so(_o,this,this._item)}));let Ms=!Es&&this._started,Vs=As||Ms&&_s.size?this.get():null;As&&bs.size&&(0,eo.flush)(bs,([so,_o])=>{_o.value=Vs,so(_o,this,this._item)}),Ms&&(this._started=!1,(0,eo.flush)(_s,([so,_o])=>{_o.value=Vs,so(_o,this,this._item)}))}eventObserved(ss){if(ss.type=="change")this._changed.add(ss.parent),ss.idle||this._active.add(ss.parent);else if(ss.type=="idle")this._active.delete(ss.parent);else return;eo.raf.onFrame(this._onFrame)}};function Hs(ss,bs){return Promise.all(bs.map(_s=>wo(ss,_s))).then(_s=>Co(ss,_s))}async function wo(ss,bs,_s){let{keys:Es,to:As,from:Ms,loop:Vs,onRest:so,onResolve:_o}=bs,Ao=eo.is.obj(bs.default)&&bs.default;Vs&&(bs.loop=!1),As===!1&&(bs.to=null),Ms===!1&&(bs.from=null);let Go=eo.is.arr(As)||eo.is.fun(As)?As:void 0;Go?(bs.to=void 0,bs.onRest=void 0,Ao&&(Ao.onRest=void 0)):(0,eo.each)(Po,No=>{let Fo=bs[No];if(eo.is.fun(Fo)){let Bo=ss._events[No];bs[No]=({finished:Qo,cancelled:jo})=>{let _a=Bo.get(Fo);_a?(Qo||(_a.finished=!1),jo&&(_a.cancelled=!0)):Bo.set(Fo,{value:null,finished:Qo||!1,cancelled:jo||!1})},Ao&&(Ao[No]=bs[No])}});let Oo=ss._state;bs.pause===!Oo.paused?(Oo.paused=bs.pause,(0,eo.flushCalls)(bs.pause?Oo.pauseQueue:Oo.resumeQueue)):Oo.paused&&(bs.pause=!0);let Zo=(Es||Object.keys(ss.springs)).map(No=>ss.springs[No].start(bs)),Ko=bs.cancel===!0||Xr(bs,"cancel")===!0;(Go||Ko&&Oo.asyncId)&&Zo.push(vo(++ss._lastAsyncId,{props:bs,state:Oo,actions:{pause:eo.noop,resume:eo.noop,start(No,Fo){Ko?(to(Oo,ss._lastAsyncId),Fo(Os(ss))):(No.onRest=so,Fo(Ws(Go,No,Oo,ss)))}}})),Oo.paused&&await new Promise(No=>{Oo.resumeQueue.add(No)});let Wo=Co(ss,await Promise.all(Zo));if(Vs&&Wo.finished&&!(_s&&Wo.noop)){let No=gs(bs,Vs,As);if(No)return _f(ss,[No]),wo(ss,No,!0)}return _o&&eo.raf.batchedUpdates(()=>_o(Wo,ss,ss.item)),Wo}function xo(ss,bs){let _s={...ss.springs};return bs&&(0,eo.each)((0,eo.toArray)(bs),Es=>{eo.is.und(Es.keys)&&(Es=hs(Es)),eo.is.obj(Es.to)||(Es={...Es,to:void 0}),ju(_s,Es,As=>xu(As))}),Yl(ss,_s),_s}function Yl(ss,bs){(0,eo.eachProp)(bs,(_s,Es)=>{ss.springs[Es]||(ss.springs[Es]=_s,(0,eo.addFluidObserver)(_s,ss))})}function xu(ss,bs){let _s=new Fs;return _s.key=ss,bs&&(0,eo.addFluidObserver)(_s,bs),_s}function ju(ss,bs,_s){bs.keys&&(0,eo.each)(bs.keys,Es=>{(ss[Es]||(ss[Es]=_s(Es)))._prepareNode(bs)})}function _f(ss,bs){(0,eo.each)(bs,_s=>{ju(ss.springs,_s,Es=>xu(Es,ss))})}var zu=Gr(reactExports),_h=reactExports,ep=cjsExports$3,Ru=({children:ss,...bs})=>{let _s=(0,_h.useContext)(Su),Es=bs.pause||!!_s.pause,As=bs.immediate||!!_s.immediate;bs=(0,ep.useMemoOne)(()=>({pause:Es,immediate:As}),[Es,As]);let{Provider:Ms}=Su;return zu.createElement(Ms,{value:bs},ss)},Su=lp(Ru,{});Ru.Provider=Su.Provider,Ru.Consumer=Su.Consumer;function lp(ss,bs){return Object.assign(ss,zu.createContext(bs)),ss.Provider._context=ss,ss.Consumer._context=ss,ss}var cu=cjsExports$3,Ll=()=>{let ss=[],bs=function(Es){(0,cu.deprecateDirectCall)();let As=[];return(0,cu.each)(ss,(Ms,Vs)=>{if(cu.is.und(Es))As.push(Ms.start());else{let so=_s(Es,Ms,Vs);so&&As.push(Ms.start(so))}}),As};bs.current=ss,bs.add=function(Es){ss.includes(Es)||ss.push(Es)},bs.delete=function(Es){let As=ss.indexOf(Es);~As&&ss.splice(As,1)},bs.pause=function(){return(0,cu.each)(ss,Es=>Es.pause(...arguments)),this},bs.resume=function(){return(0,cu.each)(ss,Es=>Es.resume(...arguments)),this},bs.set=function(Es){(0,cu.each)(ss,(As,Ms)=>{let Vs=cu.is.fun(Es)?Es(Ms,As):Es;Vs&&As.set(Vs)})},bs.start=function(Es){let As=[];return(0,cu.each)(ss,(Ms,Vs)=>{if(cu.is.und(Es))As.push(Ms.start());else{let so=this._getProps(Es,Ms,Vs);so&&As.push(Ms.start(so))}}),As},bs.stop=function(){return(0,cu.each)(ss,Es=>Es.stop(...arguments)),this},bs.update=function(Es){return(0,cu.each)(ss,(As,Ms)=>As.update(this._getProps(Es,As,Ms))),this};let _s=function(Es,As,Ms){return cu.is.fun(Es)?Es(Ms,As):Es};return bs._getProps=_s,bs};function Vu(ss,bs,_s){let Es=ps.is.fun(bs)&&bs;Es&&!_s&&(_s=[]);let As=(0,ys.useMemo)(()=>Es||arguments.length==3?Ll():void 0,[]),Ms=(0,ys.useRef)(0),Vs=(0,ps.useForceUpdate)(),so=(0,ys.useMemo)(()=>({ctrls:[],queue:[],flush(Bo,Qo){let jo=xo(Bo,Qo);return Ms.current>0&&!so.queue.length&&!Object.keys(jo).some(_a=>!Bo.springs[_a])?Hs(Bo,Qo):new Promise(_a=>{Yl(Bo,jo),so.queue.push(()=>{_a(Hs(Bo,Qo))}),Vs()})}}),[]),_o=(0,ys.useRef)([...so.ctrls]),Ao=[],Go=(0,ps.usePrev)(ss)||0;(0,ys.useMemo)(()=>{(0,ps.each)(_o.current.slice(ss,Go),Bo=>{fs(Bo,As),Bo.stop(!0)}),_o.current.length=ss,Oo(Go,ss)},[ss]),(0,ys.useMemo)(()=>{Oo(0,Math.min(Go,ss))},_s);function Oo(Bo,Qo){for(let jo=Bo;jo<Qo;jo++){let _a=_o.current[jo]||(_o.current[jo]=new zo(null,so.flush)),_l=Es?Es(jo,_a):bs[jo];_l&&(Ao[jo]=Ps(_l))}}let Zo=_o.current.map((Bo,Qo)=>xo(Bo,Ao[Qo])),Ko=(0,ys.useContext)(Ru),Wo=(0,ps.usePrev)(Ko),No=Ko!==Wo&&as(Ko);(0,ps.useIsomorphicLayoutEffect)(()=>{Ms.current++,so.ctrls=_o.current;let{queue:Bo}=so;Bo.length&&(so.queue=[],(0,ps.each)(Bo,Qo=>Qo())),(0,ps.each)(_o.current,(Qo,jo)=>{As==null||As.add(Qo),No&&Qo.start({default:Ko});let _a=Ao[jo];_a&&(Ts(Qo,_a.ref),Qo.ref?Qo.queue.push(_a):Qo.start(_a))})}),(0,ps.useOnce)(()=>()=>{(0,ps.each)(so.ctrls,Bo=>Bo.stop(!0))});let Fo=Zo.map(Bo=>({...Bo}));return As?[Fo,As]:Fo}function Ou(ss,bs){let _s=xs.is.fun(ss),[[Es],As]=Vu(1,_s?ss:[ss],_s?bs||[]:bs);return _s||arguments.length==2?[Es,As]:Es}var tp=reactExports,up=()=>Ll(),cp=()=>(0,tp.useState)(up)[0],dp=cjsExports$3,Rp=(ss,bs)=>{let _s=(0,dp.useConstant)(()=>new Fs(ss,bs));return(0,dp.useOnce)(()=>()=>{_s.stop()}),_s},Zu=cjsExports$3;function fp(ss,bs,_s){let Es=Zu.is.fun(bs)&&bs;Es&&!_s&&(_s=[]);let As=!0,Ms,Vs=Vu(ss,(so,_o)=>{let Ao=Es?Es(so,_o):bs;return Ms=Ao.ref,As=As&&Ao.reverse,Ao},_s||[{}]);if((0,Zu.useIsomorphicLayoutEffect)(()=>{(0,Zu.each)(Vs[1].current,(so,_o)=>{let Ao=Vs[1].current[_o+(As?1:-1)];if(Ts(so,Ms),so.ref){Ao&&so.update({to:Ao.springs});return}Ao?so.start({to:Ao.springs}):so.start()})},_s),Es||arguments.length==3){let so=Ms??Vs[1];return so._getProps=(_o,Ao,Go)=>{let Oo=Zu.is.fun(_o)?_o(Go,Ao):_o;if(Oo){let Zo=so.current[Go+(Oo.reverse?1:-1)];return Zo&&(Oo.to=Zo.springs),Oo}},Vs}return Vs[0]}var Qu=Gr(reactExports),Hu=reactExports,Pl=cjsExports$3;function hp(ss,bs,_s){let Es=Pl.is.fun(bs)&&bs,{reset:As,sort:Ms,trail:Vs=0,expires:so=!0,exitBeforeEnter:_o=!1,onDestroyed:Ao,ref:Go,config:Oo}=Es?Es():bs,Zo=(0,Hu.useMemo)(()=>Es||arguments.length==3?Ll():void 0,[]),Ko=(0,Pl.toArray)(ss),Wo=[],No=(0,Hu.useRef)(null),Fo=As?null:No.current;(0,Pl.useIsomorphicLayoutEffect)(()=>{No.current=Wo}),(0,Pl.useOnce)(()=>((0,Pl.each)(Wo,$a=>{Zo==null||Zo.add($a.ctrl),$a.ctrl.ref=Zo}),()=>{(0,Pl.each)(No.current,$a=>{$a.expired&&clearTimeout($a.expirationId),fs($a.ctrl,Zo),$a.ctrl.stop(!0)})}));let Bo=Ip(Ko,Es?Es():bs,Fo),Qo=As&&No.current||[];(0,Pl.useIsomorphicLayoutEffect)(()=>(0,Pl.each)(Qo,({ctrl:$a,item:Il,key:Jl})=>{fs($a,Zo),Wr(Ao,Il,Jl)}));let jo=[];if(Fo&&(0,Pl.each)(Fo,($a,Il)=>{$a.expired?(clearTimeout($a.expirationId),Qo.push($a)):(Il=jo[Il]=Bo.indexOf($a.key),~Il&&(Wo[Il]=$a))}),(0,Pl.each)(Ko,($a,Il)=>{Wo[Il]||(Wo[Il]={key:Bo[Il],item:$a,phase:"mount",ctrl:new zo},Wo[Il].ctrl.item=$a)}),jo.length){let $a=-1,{leave:Il}=Es?Es():bs;(0,Pl.each)(jo,(Jl,fu)=>{let gu=Fo[fu];~Jl?($a=Wo.indexOf(gu),Wo[$a]={...gu,item:Ko[Jl]}):Il&&Wo.splice(++$a,0,gu)})}Pl.is.fun(Ms)&&Wo.sort(($a,Il)=>Ms($a.item,Il.item));let _a=-Vs,_l=(0,Pl.useForceUpdate)(),Hl=_i(bs),Rl=new Map,Ql=(0,Hu.useRef)(new Map),Wl=(0,Hu.useRef)(!1);(0,Pl.each)(Wo,($a,Il)=>{let Jl=$a.key,fu=$a.phase,gu=Es?Es():bs,hu,au,v0=Wr(gu.delay||0,Jl);if(fu=="mount")hu=gu.enter,au="enter";else{let ro=Bo.indexOf(Jl)<0;if(fu!="leave")if(ro)hu=gu.leave,au="leave";else if(hu=gu.update)au="update";else return;else if(!ro)hu=gu.enter,au="enter";else return}if(hu=Wr(hu,$a.item,Il),hu=Pl.is.obj(hu)?is(hu):{to:hu},!hu.config){let ro=Oo||Hl.config;hu.config=Wr(ro,$a.item,Il,au)}_a+=Vs;let vp={...Hl,delay:v0+_a,ref:Go,immediate:gu.immediate,reset:!1,...hu};if(au=="enter"&&Pl.is.und(vp.from)){let ro=Es?Es():bs,oo=Pl.is.und(ro.initial)||Fo?ro.from:ro.initial;vp.from=Wr(oo,$a.item,Il)}let{onResolve:Kp}=vp;vp.onResolve=ro=>{Wr(Kp,ro);let oo=No.current,So=oo.find(ba=>ba.key===Jl);if(So&&!(ro.cancelled&&So.phase!="update")&&So.ctrl.idle){let ba=oo.every($l=>$l.ctrl.idle);if(So.phase=="leave"){let $l=Wr(so,So.item);if($l!==!1){let tu=$l===!0?0:$l;if(So.expired=!0,!ba&&tu>0){tu<=2147483647&&(So.expirationId=setTimeout(_l,tu));return}}}ba&&oo.some($l=>$l.expired)&&(Ql.current.delete(So),_o&&(Wl.current=!0),_l())}};let Ys=xo($a.ctrl,vp);au==="leave"&&_o?Ql.current.set($a,{phase:au,springs:Ys,payload:vp}):Rl.set($a,{phase:au,springs:Ys,payload:vp})});let pu=(0,Hu.useContext)(Ru),du=(0,Pl.usePrev)(pu),wu=pu!==du&&as(pu);(0,Pl.useIsomorphicLayoutEffect)(()=>{wu&&(0,Pl.each)(Wo,$a=>{$a.ctrl.start({default:pu})})},[pu]),(0,Pl.each)(Rl,($a,Il)=>{if(Ql.current.size){let Jl=Wo.findIndex(fu=>fu.key===Il.key);Wo.splice(Jl,1)}}),(0,Pl.useIsomorphicLayoutEffect)(()=>{(0,Pl.each)(Ql.current.size?Ql.current:Rl,({phase:$a,payload:Il},Jl)=>{let{ctrl:fu}=Jl;Jl.phase=$a,Zo==null||Zo.add(fu),wu&&$a=="enter"&&fu.start({default:pu}),Il&&(Ts(fu,Il.ref),(fu.ref||Zo)&&!Wl.current?fu.update(Il):(fu.start(Il),Wl.current&&(Wl.current=!1)))})},As?void 0:_s);let ou=$a=>Qu.createElement(Qu.Fragment,null,Wo.map((Il,Jl)=>{let{springs:fu}=Rl.get(Il)||Il.ctrl,gu=$a({...fu},Il.item,Il,Jl);return gu&&gu.type?Qu.createElement(gu.type,{...gu.props,key:Pl.is.str(Il.key)||Pl.is.num(Il.key)?Il.key:Il.ctrl.id,ref:gu.ref}):gu}));return Zo?[ou,Zo]:ou}var Cp=1;function Ip(ss,{key:bs,keys:_s=bs},Es){if(_s===null){let As=new Set;return ss.map(Ms=>{let Vs=Es&&Es.find(so=>so.item===Ms&&so.phase!=="leave"&&!As.has(so));return Vs?(As.add(Vs),Vs.key):Cp++})}return Pl.is.und(_s)?ss:Pl.is.fun(_s)?ss.map(_s):(0,Pl.toArray)(_s)}var Ml=cjsExports$3,Fl=({container:ss,...bs}={})=>{let[_s,Es]=Ou(()=>({scrollX:0,scrollY:0,scrollXProgress:0,scrollYProgress:0,...bs}),[]);return(0,Ml.useIsomorphicLayoutEffect)(()=>{let As=(0,Ml.onScroll)(({x:Ms,y:Vs})=>{Es.start({scrollX:Ms.current,scrollXProgress:Ms.progress,scrollY:Vs.current,scrollYProgress:Vs.progress})},{container:(ss==null?void 0:ss.current)||void 0});return()=>{(0,Ml.each)(Object.values(_s),Ms=>Ms.stop()),As()}},[]),_s},Nu=cjsExports$3,pp=({container:ss,...bs})=>{let[_s,Es]=Ou(()=>({width:0,height:0,...bs}),[]);return(0,Nu.useIsomorphicLayoutEffect)(()=>{let As=(0,Nu.onResize)(({width:Ms,height:Vs})=>{Es.start({width:Ms,height:Vs,immediate:_s.width.get()===0||_s.height.get()===0})},{container:(ss==null?void 0:ss.current)||void 0});return()=>{(0,Nu.each)(Object.values(_s),Ms=>Ms.stop()),As()}},[]),_s},gp=reactExports,Fu=cjsExports$3,Pp={any:0,all:1};function eu(ss,bs){let[_s,Es]=(0,gp.useState)(!1),As=(0,gp.useRef)(),Ms=Fu.is.fun(ss)&&ss,Vs=Ms?Ms():{},{to:so={},from:_o={},...Ao}=Vs,Go=Ms?bs:ss,[Oo,Zo]=Ou(()=>({from:_o,...Ao}),[]);return(0,Fu.useIsomorphicLayoutEffect)(()=>{let Ko=As.current,{root:Wo,once:No,amount:Fo="any",...Bo}=Go??{};if(!Ko||No&&_s||typeof IntersectionObserver>"u")return;let Qo=new WeakMap,jo=()=>(so&&Zo.start(so),Es(!0),No?void 0:()=>{_o&&Zo.start(_o),Es(!1)}),_a=Hl=>{Hl.forEach(Rl=>{let Ql=Qo.get(Rl.target);if(Rl.isIntersecting!==!!Ql)if(Rl.isIntersecting){let Wl=jo();Fu.is.fun(Wl)?Qo.set(Rl.target,Wl):_l.unobserve(Rl.target)}else Ql&&(Ql(),Qo.delete(Rl.target))})},_l=new IntersectionObserver(_a,{root:Wo&&Wo.current||void 0,threshold:typeof Fo=="number"||Array.isArray(Fo)?Fo:Pp[Fo],...Bo});return _l.observe(Ko),()=>_l.unobserve(Ko)},[Go]),Ms?[As,Oo]:[As,_s]}function mp({children:ss,...bs}){return ss(Ou(bs))}var iu=cjsExports$3;function yp({items:ss,children:bs,..._s}){let Es=fp(ss.length,_s);return ss.map((As,Ms)=>{let Vs=bs(As,Ms);return iu.is.fun(Vs)?Vs(Es[Ms]):Vs})}function Ju({items:ss,children:bs,..._s}){return hp(ss,_s)(bs)}var Nl=cjsExports$3,zl=cjsExports$3,Eu=cjsExports$2,Cs=class extends Io{constructor(ss,bs){super(),this.source=ss,this.idle=!0,this._active=new Set,this.calc=(0,zl.createInterpolator)(...bs);let _s=this._get(),Es=(0,Eu.getAnimatedType)(_s);(0,Eu.setAnimated)(this,Es.create(_s))}advance(ss){let bs=this._get(),_s=this.get();(0,zl.isEqual)(bs,_s)||((0,Eu.getAnimated)(this).setValue(bs),this._onChange(bs,this.idle)),!this.idle&&Us(this._active)&&Xs(this)}_get(){let ss=zl.is.arr(this.source)?this.source.map(zl.getFluidValue):(0,zl.toArray)((0,zl.getFluidValue)(this.source));return this.calc(...ss)}_start(){this.idle&&!Us(this._active)&&(this.idle=!1,(0,zl.each)((0,Eu.getPayload)(this),ss=>{ss.done=!1}),zl.Globals.skipAnimation?(zl.raf.batchedUpdates(()=>this.advance()),Xs(this)):zl.frameLoop.start(this))}_attach(){let ss=1;(0,zl.each)((0,zl.toArray)(this.source),bs=>{(0,zl.hasFluidValue)(bs)&&(0,zl.addFluidObserver)(bs,this),Ho(bs)&&(bs.idle||this._active.add(bs),ss=Math.max(ss,bs.priority+1))}),this.priority=ss,this._start()}_detach(){(0,zl.each)((0,zl.toArray)(this.source),ss=>{(0,zl.hasFluidValue)(ss)&&(0,zl.removeFluidObserver)(ss,this)}),this._active.clear(),Xs(this)}eventObserved(ss){ss.type=="change"?ss.idle?this.advance():(this._active.add(ss.parent),this._start()):ss.type=="idle"?this._active.delete(ss.parent):ss.type=="priority"&&(this.priority=(0,zl.toArray)(this.source).reduce((bs,_s)=>Math.max(bs,(Ho(_s)?_s.priority:0)+1),0))}};function Ls(ss){return ss.idle!==!1}function Us(ss){return!ss.size||Array.from(ss).every(Ls)}function Xs(ss){ss.idle||(ss.idle=!0,(0,zl.each)((0,Eu.getPayload)(ss),bs=>{bs.done=!0}),(0,zl.callFluidObservers)(ss,{type:"idle",parent:ss}))}var po=(ss,...bs)=>new Cs(ss,bs),ms=(ss,...bs)=>((0,Nl.deprecateInterpolate)(),new Cs(ss,bs)),os=cjsExports$3;os.Globals.assign({createStringInterpolator:os.createStringInterpolator,to:(ss,bs)=>new Cs(ss,bs)});var us=os.frameLoop.advance,Ss=cjsExports$3;jr(Lr,requireCjs(),_r.exports)})(reactSpring_core_production_min);var reactSpring_core_production_minExports=reactSpring_core_production_min.exports;cjs$4.exports=reactSpring_core_production_minExports;var cjsExports$1=cjs$4.exports;(function(_r){var Tr=Object.defineProperty,Ar=Object.getOwnPropertyDescriptor,Rr=Object.getOwnPropertyNames,Pr=Object.prototype.hasOwnProperty,Dr=(ps,vs)=>{for(var Ds in vs)Tr(ps,Ds,{get:vs[Ds],enumerable:!0})},Mr=(ps,vs,Ds,js)=>{if(vs&&typeof vs=="object"||typeof vs=="function")for(let zs of Rr(vs))!Pr.call(ps,zs)&&zs!==Ds&&Tr(ps,zs,{get:()=>vs[zs],enumerable:!(js=Ar(vs,zs))||js.enumerable});return ps},Fr=(ps,vs,Ds)=>(Mr(ps,vs,"default"),Ds&&Mr(Ds,vs,"default")),zr=ps=>Mr(Tr({},"__esModule",{value:!0}),ps),jr={};Dr(jr,{a:()=>ys,animated:()=>ys}),_r.exports=zr(jr);var Gr=cjsExports$1,Nr=reactDomExports,Lr=cjsExports$3,Ur=cjsExports$2,Vr=/^--/;function Wr(ps,vs){return vs==null||typeof vs=="boolean"||vs===""?"":typeof vs=="number"&&vs!==0&&!Vr.test(ps)&&!(Xr.hasOwnProperty(ps)&&Xr[ps])?vs+"px":(""+vs).trim()}var qr={};function Kr(ps,vs){if(!ps.nodeType||!ps.setAttribute)return!1;let Ds=ps.nodeName==="filter"||ps.parentNode&&ps.parentNode.nodeName==="filter",{style:js,children:zs,scrollTop:qs,scrollLeft:fo,viewBox:Qs,...no}=vs,yo=Object.values(no),Js=Object.keys(no).map(lo=>Ds||ps.hasAttribute(lo)?lo:qr[lo]||(qr[lo]=lo.replace(/([A-Z])/g,vo=>"-"+vo.toLowerCase())));zs!==void 0&&(ps.textContent=zs);for(let lo in js)if(js.hasOwnProperty(lo)){let vo=Wr(lo,js[lo]);Vr.test(lo)?ps.style.setProperty(lo,vo):ps.style[lo]=vo}Js.forEach((lo,vo)=>{ps.setAttribute(lo,yo[vo])}),qs!==void 0&&(ps.scrollTop=qs),fo!==void 0&&(ps.scrollLeft=fo),Qs!==void 0&&ps.setAttribute("viewBox",Qs)}var Xr={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Zr=(ps,vs)=>ps+vs.charAt(0).toUpperCase()+vs.substring(1),_i=["Webkit","Ms","Moz","O"];Xr=Object.keys(Xr).reduce((ps,vs)=>(_i.forEach(Ds=>ps[Zr(Ds,vs)]=ps[vs]),ps),Xr);var Jr=cjsExports$2,es=cjsExports$3,ts=/^(matrix|translate|scale|rotate|skew)/,is=/^(translate)/,rs=/^(rotate|skew)/,as=(ps,vs)=>es.is.num(ps)&&ps!==0?ps+vs:ps,ls=(ps,vs)=>es.is.arr(ps)?ps.every(Ds=>ls(Ds,vs)):es.is.num(ps)?ps===vs:parseFloat(ps)===vs,fs=class extends Jr.AnimatedObject{constructor({x:ps,y:vs,z:Ds,...js}){let zs=[],qs=[];(ps||vs||Ds)&&(zs.push([ps||0,vs||0,Ds||0]),qs.push(fo=>[`translate3d(${fo.map(Qs=>as(Qs,"px")).join(",")})`,ls(fo,0)])),(0,es.eachProp)(js,(fo,Qs)=>{if(Qs==="transform")zs.push([fo||""]),qs.push(no=>[no,no===""]);else if(ts.test(Qs)){if(delete js[Qs],es.is.und(fo))return;let no=is.test(Qs)?"px":rs.test(Qs)?"deg":"";zs.push((0,es.toArray)(fo)),qs.push(Qs==="rotate3d"?([yo,Js,lo,vo])=>[`rotate3d(${yo},${Js},${lo},${as(vo,no)})`,ls(vo,0)]:yo=>[`${Qs}(${yo.map(Js=>as(Js,no)).join(",")})`,ls(yo,Qs.startsWith("scale")?1:0)])}}),zs.length&&(js.transform=new Ts(zs,qs)),super(js)}},Ts=class extends es.FluidValue{constructor(ps,vs){super(),this.inputs=ps,this.transforms=vs,this._value=null}get(){return this._value||(this._value=this._get())}_get(){let ps="",vs=!0;return(0,es.each)(this.inputs,(Ds,js)=>{let zs=(0,es.getFluidValue)(Ds[0]),[qs,fo]=this.transforms[js](es.is.arr(zs)?zs:Ds.map(es.getFluidValue));ps+=" "+qs,vs=vs&&fo}),vs?"none":ps}observerAdded(ps){ps==1&&(0,es.each)(this.inputs,vs=>(0,es.each)(vs,Ds=>(0,es.hasFluidValue)(Ds)&&(0,es.addFluidObserver)(Ds,this)))}observerRemoved(ps){ps==0&&(0,es.each)(this.inputs,vs=>(0,es.each)(vs,Ds=>(0,es.hasFluidValue)(Ds)&&(0,es.removeFluidObserver)(Ds,this)))}eventObserved(ps){ps.type=="change"&&(this._value=null),(0,es.callFluidObservers)(this,ps)}},$s=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"];Fr(jr,cjsExports$1,_r.exports),Gr.Globals.assign({batchedUpdates:Nr.unstable_batchedUpdates,createStringInterpolator:Lr.createStringInterpolator,colors:Lr.colors});var xs=(0,Ur.createHost)($s,{applyAnimatedValues:Kr,createAnimatedStyle:ps=>new fs(ps),getComponentProps:({scrollTop:ps,scrollLeft:vs,...Ds})=>Ds}),ys=xs.animated})(reactSpring_web_production_min);var reactSpring_web_production_minExports=reactSpring_web_production_min.exports;cjs$5.exports=reactSpring_web_production_minExports;var cjsExports=cjs$5.exports;const{useState,useEffect}=reactExports;function useWindowSize$1(){const[_r,Tr]=useState({width:void 0,height:void 0});return useEffect(()=>{function Ar(){Tr({width:window.innerWidth,height:window.innerHeight})}return window.addEventListener("resize",Ar),Ar(),()=>window.removeEventListener("resize",Ar)},[]),_r}var useWindowSize_1=useWindowSize$1;const React=reactExports,{useSpring,animated}=cjsExports,useWindowSize=useWindowSize_1,settings={maxTilt:25,rotationPower:50,swipeThreshold:.5},physics={touchResponsive:{friction:50,tension:2e3},animateOut:{friction:30,tension:400},animateBack:{friction:10,tension:200}},pythagoras=(_r,Tr)=>Math.sqrt(Math.pow(_r,2)+Math.pow(Tr,2)),normalize$1=_r=>{const Tr=Math.sqrt(Math.pow(_r.x,2)+Math.pow(_r.y,2));return{x:_r.x/Tr,y:_r.y/Tr}},animateOut=async(_r,Tr,Ar,Rr)=>{const Pr=pythagoras(Ar,Rr),Dr=pythagoras(_r.x,_r.y),Mr=Pr*_r.x,Fr=Pr*_r.y,zr=_r.x*45,jr=Pr/Dr;return Tr.start({xyrot:[Mr,Fr,zr],config:{duration:jr}}),await new Promise(Gr=>setTimeout(()=>{Gr()},jr))},animateBack=_r=>new Promise(Tr=>{_r.start({xyrot:[0,0,0],config:physics.animateBack,onRest:Tr})}),getSwipeDirection=_r=>{if(Math.abs(_r.x)>Math.abs(_r.y)){if(_r.x>settings.swipeThreshold)return"right";if(_r.x<-settings.swipeThreshold)return"left"}else{if(_r.y>settings.swipeThreshold)return"down";if(_r.y<-settings.swipeThreshold)return"up"}return"none"},AnimatedDiv=animated.div,TinderCard=React.forwardRef(({flickOnSwipe:_r=!0,children:Tr,onSwipe:Ar,onCardLeftScreen:Rr,className:Pr,preventSwipe:Dr=[],swipeRequirementType:Mr="velocity",swipeThreshold:Fr=settings.swipeThreshold,onSwipeRequirementFulfilled:zr,onSwipeRequirementUnfulfilled:jr},Gr)=>{const{width:Nr,height:Lr}=useWindowSize(),[{xyrot:Ur},Vr]=useSpring(()=>({xyrot:[0,0,0],config:physics.touchResponsive}));settings.swipeThreshold=Fr,React.useImperativeHandle(Gr,()=>({async swipe(Zr="right"){Ar&&Ar(Zr);const _i=1.3,Jr=(Math.random()-.5)/2;Zr==="right"?await animateOut({x:_i,y:Jr},Vr,Nr,Lr):Zr==="left"?await animateOut({x:-_i,y:Jr},Vr,Nr,Lr):Zr==="up"?await animateOut({x:Jr,y:-_i},Vr,Nr,Lr):Zr==="down"&&await animateOut({x:Jr,y:_i},Vr,Nr,Lr),Rr&&Rr(Zr)},async restoreCard(){await animateBack(Vr)}}));const Wr=React.useCallback(async(Zr,_i)=>{const Jr=getSwipeDirection({x:Mr==="velocity"?_i.vx:_i.dx,y:Mr==="velocity"?_i.vy:_i.dy});if(Jr!=="none"&&_r&&!Dr.includes(Jr)){Ar&&Ar(Jr),await animateOut(Mr==="velocity"?{x:_i.vx,y:_i.vy}:normalize$1({x:_i.dx,y:_i.dy}),Zr,Nr,Lr),Rr&&Rr(Jr);return}animateBack(Zr)},[Mr,_r,Dr,Ar,Rr,Nr,Lr]);let qr="none";const Kr=(Zr,_i,Jr,es)=>{let ts=es?Zr.touches[0].clientX-_i.x:Zr.clientX-_i.x,is=es?Zr.touches[0].clientY-_i.y:Zr.clientY-_i.y;_i.x===0&&_i.y===0&&(ts=0,is=0);const rs=-(ts-Jr.dx)/(Jr.timeStamp-Date.now()),as=-(is-Jr.dy)/(Jr.timeStamp-Date.now());return{dx:ts,dy:is,vx:rs,vy:as,timeStamp:Date.now()}};React.useLayoutEffect(()=>{let Zr={x:0,y:0},_i={dx:0,dy:0,vx:0,vy:0,timeStamp:Date.now()},Jr=!1;Xr.current.addEventListener("touchstart",ts=>{!ts.srcElement.className.includes("pressable")&&ts.cancelable&&ts.preventDefault(),_i=Kr(ts,Zr,_i,!0),Zr={x:ts.touches[0].clientX,y:ts.touches[0].clientY}}),Xr.current.addEventListener("mousedown",ts=>{Jr=!0,_i=Kr(ts,Zr,_i,!1),Zr={x:ts.clientX,y:ts.clientY}});const es=ts=>{if(zr||jr){const rs=getSwipeDirection({x:Mr==="velocity"?ts.vx:ts.dx,y:Mr==="velocity"?ts.vy:ts.dy});rs!==qr&&(qr=rs,qr==="none"?jr&&jr():zr&&zr(rs))}let is=ts.vx*15;isNaN(is)&&(is=0),is=Math.max(Math.min(is,settings.maxTilt),-settings.maxTilt),Vr.start({xyrot:[ts.dx,ts.dy,is],config:physics.touchResponsive})};window.addEventListener("mousemove",ts=>{if(!Jr)return;const is=Kr(ts,Zr,_i,!1);_i=is,es(is)}),window.addEventListener("mouseup",ts=>{Jr&&(Jr=!1,Wr(Vr,_i),Zr={x:0,y:0},_i={dx:0,dy:0,vx:0,vy:0,timeStamp:Date.now()})}),Xr.current.addEventListener("touchmove",ts=>{const is=Kr(ts,Zr,_i,!0);_i=is,es(is)}),Xr.current.addEventListener("touchend",ts=>{Wr(Vr,_i),Zr={x:0,y:0},_i={dx:0,dy:0,vx:0,vy:0,timeStamp:Date.now()}})});const Xr=React.useRef();return React.createElement(AnimatedDiv,{ref:Xr,className:Pr,style:{transform:Ur.to((Zr,_i,Jr)=>`translate3d(${Zr}px, ${_i}px, 0px) rotate(${Jr}deg)`)},children:Tr})});var reactTinderCard=TinderCard;const TinderCard$1=getDefaultExportFromCjs$1(reactTinderCard);var __defProp=Object.defineProperty,__defNormalProp=(_r,Tr,Ar)=>Tr in _r?__defProp(_r,Tr,{enumerable:!0,configurable:!0,writable:!0,value:Ar}):_r[Tr]=Ar,__publicField=(_r,Tr,Ar)=>(__defNormalProp(_r,typeof Tr!="symbol"?Tr+"":Tr,Ar),Ar);const EMPTY=[];Object.freeze(EMPTY);const emptyAnnotationPage={id:"https://iiif-parser/annotation-page",type:"AnnotationPage",behavior:EMPTY,motivation:null,label:null,thumbnail:EMPTY,summary:null,requiredStatement:null,metadata:EMPTY,rights:null,provider:EMPTY,items:EMPTY,seeAlso:EMPTY,homepage:EMPTY,logo:EMPTY,rendering:EMPTY,service:EMPTY},emptyCanvas={id:"https://iiif-parser/empty-canvas",type:"Canvas",label:null,behavior:EMPTY,motivation:null,thumbnail:EMPTY,posterCanvas:null,accompanyingCanvas:null,placeholderCanvas:null,summary:null,requiredStatement:null,metadata:EMPTY,rights:null,navDate:null,provider:EMPTY,items:EMPTY,annotations:EMPTY,seeAlso:EMPTY,homepage:EMPTY,logo:EMPTY,partOf:EMPTY,rendering:EMPTY,service:EMPTY,duration:0,height:0,width:0},emptyCollection={id:"https://iiif-parser/empty-collection",type:"Collection",label:null,viewingDirection:"left-to-right",behavior:EMPTY,motivation:null,thumbnail:EMPTY,posterCanvas:null,accompanyingCanvas:null,placeholderCanvas:null,summary:null,requiredStatement:null,metadata:EMPTY,rights:null,navDate:null,provider:EMPTY,items:EMPTY,annotations:EMPTY,seeAlso:EMPTY,homepage:EMPTY,logo:EMPTY,partOf:EMPTY,rendering:EMPTY,service:EMPTY,services:EMPTY},emptyManifest={id:"https://iiif-parser/empty-manifest",type:"Manifest",annotations:EMPTY,behavior:EMPTY,homepage:EMPTY,items:EMPTY,label:null,logo:EMPTY,metadata:EMPTY,motivation:null,navDate:null,provider:EMPTY,partOf:EMPTY,posterCanvas:null,accompanyingCanvas:null,placeholderCanvas:null,rendering:EMPTY,requiredStatement:null,rights:null,seeAlso:EMPTY,service:EMPTY,services:EMPTY,start:null,structures:EMPTY,summary:null,thumbnail:EMPTY,viewingDirection:"left-to-right"},emptyRange={id:"https://iiif-parser/empty-canvas",type:"Range",label:null,behavior:EMPTY,motivation:null,thumbnail:EMPTY,posterCanvas:null,accompanyingCanvas:null,placeholderCanvas:null,summary:null,requiredStatement:null,metadata:EMPTY,rights:null,navDate:null,provider:EMPTY,items:EMPTY,annotations:EMPTY,seeAlso:EMPTY,homepage:EMPTY,logo:EMPTY,partOf:EMPTY,rendering:EMPTY,service:EMPTY,start:null,supplementary:null,viewingDirection:"left-to-right"},emptyAgent={id:"https://iiif-parser/empty-agent",type:"Agent",label:{},logo:EMPTY,seeAlso:EMPTY,homepage:EMPTY};function ensureArray$1(_r){return Array.isArray(_r)?_r:[_r]}const types$1=["Collection","Manifest","Canvas","AnnotationPage","AnnotationCollection","Annotation","ContentResource","Range","Service","Selector","Agent"];function identifyResource$1(_r){if(typeof _r>"u"||_r===null)throw new Error("Null or undefined is not a valid entity.");if(Array.isArray(_r))throw new Error("Array is not a valid entity");if(typeof _r!="object")throw new Error(`${typeof _r} is not a valid entity`);if(typeof _r.type=="string"){const Tr=types$1.indexOf(_r.type);if(Tr!==-1)return types$1[Tr]}if(_r.profile)return"Service";throw new Error("Resource type is not known")}class Traverse$1{constructor(Tr,Ar={}){__publicField(this,"traversals"),__publicField(this,"options"),this.traversals={collection:[],manifest:[],canvas:[],annotationCollection:[],annotationPage:[],annotation:[],contentResource:[],choice:[],range:[],service:[],agent:[],...Tr},this.options={allowUndefinedReturn:!1,...Ar}}static all(Tr){return new Traverse$1({collection:[Tr],manifest:[Tr],canvas:[Tr],annotationCollection:[Tr],annotationPage:[Tr],annotation:[Tr],contentResource:[Tr],choice:[Tr],range:[Tr],service:[Tr]})}traverseDescriptive(Tr){return Tr.thumbnail&&(Tr.thumbnail=Tr.thumbnail.map(Ar=>this.traverseType(Ar,this.traversals.contentResource))),Tr.provider&&(Tr.provider=Tr.provider.map(Ar=>this.traverseAgent(Ar))),Tr}traverseLinking(Tr){return Tr.seeAlso&&(Tr.seeAlso=Tr.seeAlso.map(Ar=>this.traverseType(Ar,this.traversals.contentResource))),Tr.service&&(Tr.service=ensureArray$1(Tr.service).map(Ar=>this.traverseType(Ar,this.traversals.service))),Tr.services&&(Tr.services=Tr.services.map(Ar=>this.traverseType(Ar,this.traversals.service))),Tr.logo&&(Tr.logo=Tr.logo.map(Ar=>this.traverseType(Ar,this.traversals.contentResource))),Tr.homepage&&(Tr.homepage=Tr.homepage.map(Ar=>this.traverseType(Ar,this.traversals.contentResource))),Tr.partOf&&(Tr.partOf=Tr.partOf.map(Ar=>typeof Ar=="string"||!Ar.type?this.traverseType(Ar,this.traversals.contentResource):Ar.type==="Canvas"?this.traverseType(Ar,this.traversals.canvas):Ar.type==="AnnotationCollection"?this.traverseType(Ar,this.traversals.annotationCollection):Ar.type==="Collection"?this.traverseType(Ar,this.traversals.collection):this.traverseType(Ar,this.traversals.contentResource))),Tr.start&&(Tr.start=Tr.start?this.traverseType(Tr.start,this.traversals.canvas):null),Tr.rendering&&(Tr.rendering=Tr.rendering.map(Ar=>this.traverseType(Ar,this.traversals.contentResource))),Tr.supplementary&&(Tr.supplementary=Tr.supplementary.map(Ar=>this.traverseType(Ar,this.traversals.contentResource))),Tr}traverseCollectionItems(Tr){return Tr.items&&Tr.items.map(Ar=>Ar.type==="Collection"?this.traverseCollection(Ar):this.traverseManifest(Ar)),Tr}traverseCollection(Tr){return this.traverseType(this.traverseDescriptive(this.traverseInlineAnnotationPages(this.traverseLinking(this.traversePosterCanvas(this.traverseCollectionItems(Tr))))),this.traversals.collection)}traverseManifestItems(Tr){return Tr.items&&(Tr.items=Tr.items.map(Ar=>this.traverseCanvas(Ar))),Tr}traverseManifestStructures(Tr){return Tr.structures&&(Tr.structures=Tr.structures.map(Ar=>this.traverseRange(Ar))),Tr}traverseManifest(Tr){return this.traverseType(this.traverseInlineAnnotationPages(this.traverseManifestStructures(this.traversePosterCanvas(this.traverseDescriptive(this.traverseLinking(this.traverseManifestItems(Tr)))))),this.traversals.manifest)}traverseCanvasItems(Tr){return Tr.items=(Tr.items||[]).map(Ar=>this.traverseAnnotationPage(Ar)),Tr}traverseInlineAnnotationPages(Tr){return typeof Tr=="string"||!Tr||Tr.annotations&&(Tr.annotations=Tr.annotations.map(Ar=>this.traverseAnnotationPage(Ar))),Tr}traverseCanvas(Tr){return this.traverseType(this.traverseInlineAnnotationPages(this.traversePosterCanvas(this.traverseDescriptive(this.traverseLinking(this.traverseCanvasItems(Tr))))),this.traversals.canvas)}traverseAnnotationPageItems(Tr){return Tr.items&&(Tr.items=Tr.items.map(Ar=>this.traverseAnnotation(Ar))),Tr}traverseAnnotationPage(Tr){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseAnnotationPageItems(Tr))),this.traversals.annotationPage)}traverseAnnotationBody(Tr){return Array.isArray(Tr.body)?Tr.body=Tr.body.map(Ar=>this.traverseContentResource(Ar)):Tr.body&&(Tr.body=this.traverseContentResource(Tr.body)),Tr}traversePosterCanvas(Tr){return Tr.posterCanvas&&(Tr.posterCanvas=this.traverseCanvas(Tr.posterCanvas)),Tr.placeholderCanvas&&(Tr.placeholderCanvas=this.traverseCanvas(Tr.placeholderCanvas)),Tr.accompanyingCanvas&&(Tr.accompanyingCanvas=this.traverseCanvas(Tr.accompanyingCanvas)),Tr}traverseAnnotation(Tr){return this.traverseType(this.traverseLinking(this.traverseAnnotationBody(Tr)),this.traversals.annotation)}traverseContentResourceLinking(Tr){return typeof Tr=="string"||!Tr||Tr&&Tr.service&&(Tr.service=ensureArray$1(Tr.service||[]).map(Ar=>this.traverseType(Ar,this.traversals.service))),Tr}traverseContentResource(Tr){return Tr.type==="Choice"&&(Tr.items=Tr.items.map(Ar=>this.traverseContentResource(Ar))),this.traverseType(this.traverseInlineAnnotationPages(this.traverseContentResourceLinking(Tr)),this.traversals.contentResource)}traverseRangeRanges(Tr){return Tr.items&&(Tr.items=Tr.items.map(Ar=>typeof Ar=="string"?this.traverseCanvas({id:Ar,type:"Canvas"}):Ar.type==="Manifest"?this.traverseManifest(Ar):this.traverseRange(Ar))),Tr}traverseRange(Tr){return this.traverseType(this.traversePosterCanvas(this.traverseDescriptive(this.traverseLinking(this.traverseRangeRanges(Tr)))),this.traversals.range)}traverseAgent(Tr){return this.traverseType(this.traverseDescriptive(this.traverseLinking(Tr)),this.traversals.agent)}traverseType(Tr,Ar){return Ar.reduce((Rr,Pr)=>{const Dr=Pr(Rr);return typeof Dr>"u"&&!this.options.allowUndefinedReturn?Rr:Dr},Tr)}traverseService(Tr){return this.traverseType(Tr,this.traversals.service)}traverseUnknown(Tr){const Ar=identifyResource$1(Tr);switch(Ar){case"Collection":return this.traverseCollection(Tr);case"Manifest":return this.traverseManifest(Tr);case"Canvas":return this.traverseCanvas(Tr);case"AnnotationPage":return this.traverseAnnotationPage(Tr);case"Annotation":return this.traverseAnnotation(Tr);case"ContentResource":return this.traverseContentResource(Tr);case"Range":return this.traverseRange(Tr);case"Service":return this.traverseService(Tr);case"Agent":return this.traverseAgent(Tr);default:throw new Error(`Unknown or unsupported resource type of ${Ar}`)}}}const types=["sc:Collection","sc:Manifest","sc:Canvas","sc:AnnotationList","oa:Annotation","sc:Range","sc:Layer","sc:Sequence","oa:Choice","Service","ContentResource"];function identifyResource(_r){if(typeof _r>"u"||_r===null)throw new Error("Null or undefined is not a valid entity.");if(Array.isArray(_r))throw new Error("Array is not a valid entity");if(typeof _r!="object")throw new Error(`${typeof _r} is not a valid entity`);if(typeof _r["@type"]=="string"){const Tr=types.indexOf(_r["@type"]);if(Tr!==-1)return types[Tr]}if(_r.profile)return"Service";if(_r.format||_r["@type"])return"ContentResource";throw new Error("Resource type is not known")}class Traverse{constructor(Tr,Ar={}){__publicField(this,"traversals"),__publicField(this,"options"),this.traversals={collection:[],manifest:[],canvas:[],annotationList:[],sequence:[],annotation:[],contentResource:[],choice:[],range:[],service:[],layer:[],...Tr},this.options={convertPropsToArray:!0,mergeMemberProperties:!0,allowUndefinedReturn:!1,...Ar}}static all(Tr){return new Traverse({collection:[Tr],manifest:[Tr],canvas:[Tr],annotationList:[Tr],sequence:[Tr],annotation:[Tr],contentResource:[Tr],choice:[Tr],range:[Tr],service:[Tr],layer:[Tr]})}traverseCollection(Tr){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseCollectionItems(Tr))),this.traversals.collection)}traverseCollectionItems(Tr){if(this.options.mergeMemberProperties){const Ar=[...(Tr.manifests||[]).map(Rr=>typeof Rr=="string"?{"@id":Rr,"@type":"sc:Manifest"}:Rr),...(Tr.collections||[]).map(Rr=>typeof Rr=="string"?{"@id":Rr,"@type":"sc:Collection"}:Rr),...Tr.members||[]];delete Tr.collections,delete Tr.manifests,Tr.members=Ar}return Tr.manifests&&(Tr.manifests=Tr.manifests.map(Ar=>this.traverseManifest(typeof Ar=="string"?{"@id":Ar,"@type":"sc:Manifest"}:Ar))),Tr.collections&&(Tr.collections=Tr.collections.map(Ar=>this.traverseCollection(typeof Ar=="string"?{"@id":Ar,"@type":"sc:Collection"}:Ar))),Tr.members&&(Tr.members=Tr.members.map(Ar=>typeof Ar=="string"?Ar:this.traverseUnknown(Ar))),Tr}traverseManifest(Tr){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseManifestItems(Tr))),this.traversals.manifest)}traverseManifestItems(Tr){return Tr.sequences&&(Tr.sequences=Tr.sequences.map(Ar=>this.traverseSequence(Ar))),Tr.structures&&(Tr.structures=Tr.structures.map(Ar=>this.traverseRange(Ar))),Tr}traverseSequence(Tr){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseSequenceItems(Tr))),this.traversals.sequence)}traverseSequenceItems(Tr){return Tr.canvases&&(Tr.canvases=Tr.canvases.map(Ar=>this.traverseCanvas(Ar))),Tr}traverseCanvas(Tr){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseCanvasItems(Tr))),this.traversals.canvas)}traverseCanvasItems(Tr){return Tr.images&&(Tr.images=Tr.images.map(Ar=>this.traverseAnnotation(Ar))),Tr.otherContent&&(Tr.otherContent=Tr.otherContent.map(Ar=>this.traverseAnnotationList(Ar))),Tr}traverseRange(Tr){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseRangeItems(Tr))),this.traversals.range)}traverseRangeItems(Tr){if(this.options.mergeMemberProperties){const Ar=[...(Tr.ranges||[]).map(Rr=>typeof Rr=="string"?{"@id":Rr,"@type":"sc:Range"}:Rr),...(Tr.canvases||[]).map(Rr=>typeof Rr=="string"?{"@id":Rr,"@type":"sc:Canvas"}:Rr),...Tr.members||[]];delete Tr.ranges,delete Tr.canvases,Tr.members=Ar.length?Ar.map(Rr=>this.traverseUnknown(Rr)):void 0}return Tr}traverseAnnotationList(Tr){const Ar=typeof Tr=="string"?{"@id":Tr,"@type":"sc:AnnotationList"}:Tr;return this.traverseType(this.traverseDescriptive(this.traverseAnnotationListItems(Ar)),this.traversals.annotationList)}traverseAnnotationListItems(Tr){return Tr.resources&&(Tr.resources=Tr.resources.map(Ar=>this.traverseAnnotation(Ar))),Tr}traverseAnnotation(Tr){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseAnnotationItems(Tr))),this.traversals.annotation)}traverseAnnotationItems(Tr){return Tr.resource&&(Array.isArray(Tr.resource)?Tr.resource=Tr.resource.map(Ar=>this.traverseContentResource(Ar)):Tr.resource=this.traverseContentResource(Tr.resource)),Tr.on,Tr}traverseLayer(Tr){return this.traverseType(this.traverseLinking(this.traverseLayerItems(Tr)),this.traversals.layer)}traverseLayerItems(Tr){return Tr.otherContent&&(Tr.otherContent=Tr.otherContent.map(Ar=>this.traverseAnnotationList(Ar))),Tr}traverseChoice(Tr){return this.traverseType(this.traverseChoiceItems(Tr),this.traversals.choice)}traverseChoiceItems(Tr){return Tr.default&&Tr.default!=="rdf:nil"&&(Tr.default=this.traverseContentResource(Tr.default)),Tr.item&&Tr.item!=="rdf:nil"&&(Tr.item=Tr.item.map(Ar=>this.traverseContentResource(Ar))),Tr}traverseService(Tr){return this.traverseType(this.traverseLinking(Tr),this.traversals.service)}traverseContentResource(Tr){return Tr["@type"]==="oa:Choice"?this.traverseChoice(Tr):this.traverseType(this.traverseDescriptive(this.traverseLinking(Tr)),this.traversals.contentResource)}traverseUnknown(Tr){if(!Tr["@type"]||typeof Tr=="string")return Tr;switch(identifyResource(Tr)){case"sc:Collection":return this.traverseCollection(Tr);case"sc:Manifest":return this.traverseManifest(Tr);case"sc:Canvas":return this.traverseCanvas(Tr);case"sc:Sequence":return this.traverseSequence(Tr);case"sc:Range":return this.traverseRange(Tr);case"oa:Annotation":return this.traverseAnnotation(Tr);case"sc:AnnotationList":return this.traverseAnnotationList(Tr);case"sc:Layer":return this.traverseLayer(Tr);case"Service":return this.traverseService(Tr);case"oa:Choice":return this.traverseChoice(Tr);case"ContentResource":return this.traverseContentResource(Tr)}return Tr.profile?this.traverseService(Tr):Tr}traverseImageResource(Tr){const Ar=Array.isArray(Tr),Rr=Array.isArray(Tr)?Tr:[Tr],Pr=[];for(const Dr of Rr)typeof Dr=="string"?Pr.push(this.traverseContentResource({"@id":Dr,"@type":"dctypes:Image"})):Pr.push(this.traverseContentResource(Dr));return!Ar&&!this.options.convertPropsToArray?Pr[0]:Pr}traverseDescriptive(Tr){return Tr.thumbnail&&(Tr.thumbnail=this.traverseImageResource(Tr.thumbnail)),Tr.logo&&(Tr.logo=this.traverseImageResource(Tr.logo)),Tr}traverseOneOrMoreServices(Tr){const Ar=Array.isArray(Tr),Rr=Array.isArray(Tr)?Tr:[Tr],Pr=[];for(const Dr of Rr)Pr.push(this.traverseService(Dr));return!Ar&&!this.options.convertPropsToArray?Pr[0]:Pr}traverseLinking(Tr){return Tr.related&&(Tr.related=this.traverseOneOrManyType(Tr.related,this.traversals.contentResource)),Tr.rendering&&(Tr.rendering=this.traverseOneOrManyType(Tr.rendering,this.traversals.contentResource)),Tr.service&&(Tr.service=this.traverseOneOrMoreServices(Tr.service)),Tr.seeAlso&&(Tr.seeAlso=this.traverseOneOrManyType(Tr.seeAlso,this.traversals.contentResource)),Tr.within&&(typeof Tr.within=="string"||(Tr.within=this.traverseOneOrManyType(Tr.within,this.traversals.contentResource))),Tr.startCanvas&&(typeof Tr.startCanvas=="string"?Tr.startCanvas=this.traverseType({"@id":Tr.startCanvas,"@type":"sc:Canvas"},this.traversals.canvas):Tr.startCanvas&&this.traverseType(Tr.startCanvas,this.traversals.canvas)),Tr.contentLayer&&(typeof Tr.contentLayer=="string"?Tr.contentLayer=this.traverseLayer({"@id":Tr.contentLayer,"@type":"sc:Layer"}):Tr.contentLayer=this.traverseLayer(Tr.contentLayer)),Tr}traverseOneOrManyType(Tr,Ar){if(!Array.isArray(Tr))if(this.options.convertPropsToArray)Tr=[Tr];else return this.traverseType(Tr,Ar);return Tr.map(Rr=>this.traverseType(Rr,Ar))}traverseType(Tr,Ar){return Ar.reduce((Rr,Pr)=>{const Dr=Pr(Rr);return typeof Dr>"u"&&!this.options.allowUndefinedReturn?Rr:Dr},Tr)}}const STANFORD_IIIF_IMAGE_COMPLIANCE_0="http://library.stanford.edu/iiif/image-api/compliance.html#level0",STANFORD_IIIF_IMAGE_COMPLIANCE_1="http://library.stanford.edu/iiif/image-api/compliance.html#level1",STANFORD_IIIF_IMAGE_COMPLIANCE_2="http://library.stanford.edu/iiif/image-api/compliance.html#level2",STANFORD_IIIF_IMAGE_CONFORMANCE_0="http://library.stanford.edu/iiif/image-api/conformance.html#level0",STANFORD_IIIF_IMAGE_CONFORMANCE_1="http://library.stanford.edu/iiif/image-api/conformance.html#level1",STANFORD_IIIF_IMAGE_CONFORMANCE_2="http://library.stanford.edu/iiif/image-api/conformance.html#level2",STANFORD_IIIF_1_IMAGE_COMPLIANCE_0="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level0",STANFORD_IIIF_1_IMAGE_COMPLIANCE_1="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level1",STANFORD_IIIF_1_IMAGE_COMPLIANCE_2="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2",STANFORD_IIIF_1_IMAGE_CONFORMANCE_0="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level0",STANFORD_IIIF_1_IMAGE_CONFORMANCE_1="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level1",STANFORD_IIIF_1_IMAGE_CONFORMANCE_2="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level2",IIIF_1_IMAGE_LEVEL_0="http://iiif.io/api/image/1/level0.json",IIIF_1_IMAGE_LEVEL_0_PROFILE="http://iiif.io/api/image/1/profiles/level0.json",IIIF_1_IMAGE_LEVEL_1="http://iiif.io/api/image/1/level1.json",IIIF_1_IMAGE_LEVEL_1_PROFILE="http://iiif.io/api/image/1/profiles/level1.json",IIIF_1_IMAGE_LEVEL_2="http://iiif.io/api/image/1/level2.json",IIIF_1_IMAGE_LEVEL_2_PROFILE="http://iiif.io/api/image/1/profiles/level2.json",IIIF_2_IMAGE_LEVEL_0="http://iiif.io/api/image/2/level0.json",IIIF_2_IMAGE_LEVEL_0_PROFILE="http://iiif.io/api/image/2/profiles/level0.json",IIIF_2_IMAGE_LEVEL_1="http://iiif.io/api/image/2/level1.json",IIIF_2_IMAGE_LEVEL_1_PROFILE="http://iiif.io/api/image/2/profiles/level1.json",IIIF_2_IMAGE_LEVEL_2="http://iiif.io/api/image/2/level2.json",IIIF_2_IMAGE_LEVEL_2_PROFILE="http://iiif.io/api/image/2/profiles/level2.json",IIIF_3_IMAGE_LEVEL_0="level0",IIIF_3_IMAGE_LEVEL_1="level1",IIIF_3_IMAGE_LEVEL_2="level2",IIIF_2_IMAGE_LEVEL_0_NO_JSON="http://iiif.io/api/image/2/level0",IIIF_2_IMAGE_LEVEL_1_NO_JSON="http://iiif.io/api/image/2/level1",IIIF_2_IMAGE_LEVEL_2_NO_JSON="http://iiif.io/api/image/2/level2",level1Support=[IIIF_2_IMAGE_LEVEL_1_NO_JSON,IIIF_2_IMAGE_LEVEL_2_NO_JSON,STANFORD_IIIF_IMAGE_COMPLIANCE_1,STANFORD_IIIF_IMAGE_COMPLIANCE_2,STANFORD_IIIF_IMAGE_CONFORMANCE_1,STANFORD_IIIF_IMAGE_CONFORMANCE_2,STANFORD_IIIF_1_IMAGE_COMPLIANCE_1,STANFORD_IIIF_1_IMAGE_COMPLIANCE_2,STANFORD_IIIF_1_IMAGE_CONFORMANCE_1,STANFORD_IIIF_1_IMAGE_CONFORMANCE_2,IIIF_1_IMAGE_LEVEL_1,IIIF_1_IMAGE_LEVEL_1_PROFILE,IIIF_1_IMAGE_LEVEL_2,IIIF_1_IMAGE_LEVEL_2_PROFILE,IIIF_2_IMAGE_LEVEL_1,IIIF_2_IMAGE_LEVEL_1_PROFILE,IIIF_2_IMAGE_LEVEL_2,IIIF_2_IMAGE_LEVEL_2_PROFILE,IIIF_3_IMAGE_LEVEL_1,IIIF_3_IMAGE_LEVEL_2],imageServiceProfiles=[IIIF_2_IMAGE_LEVEL_0_NO_JSON,IIIF_2_IMAGE_LEVEL_1_NO_JSON,IIIF_2_IMAGE_LEVEL_2_NO_JSON,STANFORD_IIIF_IMAGE_COMPLIANCE_0,STANFORD_IIIF_IMAGE_COMPLIANCE_1,STANFORD_IIIF_IMAGE_COMPLIANCE_2,STANFORD_IIIF_IMAGE_CONFORMANCE_0,STANFORD_IIIF_IMAGE_CONFORMANCE_1,STANFORD_IIIF_IMAGE_CONFORMANCE_2,STANFORD_IIIF_1_IMAGE_COMPLIANCE_0,STANFORD_IIIF_1_IMAGE_COMPLIANCE_1,STANFORD_IIIF_1_IMAGE_COMPLIANCE_2,STANFORD_IIIF_1_IMAGE_CONFORMANCE_0,STANFORD_IIIF_1_IMAGE_CONFORMANCE_1,STANFORD_IIIF_1_IMAGE_CONFORMANCE_2,IIIF_1_IMAGE_LEVEL_0,IIIF_1_IMAGE_LEVEL_0_PROFILE,IIIF_1_IMAGE_LEVEL_1,IIIF_1_IMAGE_LEVEL_1_PROFILE,IIIF_1_IMAGE_LEVEL_2,IIIF_1_IMAGE_LEVEL_2_PROFILE,IIIF_2_IMAGE_LEVEL_0,IIIF_2_IMAGE_LEVEL_0_PROFILE,IIIF_2_IMAGE_LEVEL_1,IIIF_2_IMAGE_LEVEL_1_PROFILE,IIIF_2_IMAGE_LEVEL_2,IIIF_2_IMAGE_LEVEL_2_PROFILE,IIIF_3_IMAGE_LEVEL_0,IIIF_3_IMAGE_LEVEL_1,IIIF_3_IMAGE_LEVEL_2],configuration={attributionLabel:"Attribution",lang:"none",providerId:"http://example.org/provider",providerName:"Unknown"};function convertLanguageMapping(_r,Tr="none"){if(!_r)return{};const Ar=Array.isArray(_r)?_r:[_r],Rr={};for(const Pr of Ar){if(typeof Pr=="string"){Rr[Tr]=Rr[Tr]?Rr[Tr]:[],Rr[Tr].push(Pr||"");continue}if(!Pr["@language"]){Rr[Tr]=Rr[Tr]?Rr[Tr]:[],Rr[Tr].push(Pr["@value"]||"");continue}const Dr=Pr["@language"];Rr[Dr]=Rr[Dr]?Rr[Dr]:[],Rr[Dr].push(Pr["@value"]||"")}return Rr}function getProfile(_r){if(Array.isArray(_r))return getProfile(_r.find(Tr=>typeof Tr=="string"));if(imageServiceProfiles.indexOf(_r)!==-1)return"level2";if(level1Support.indexOf(_r)!==-1)return"level1";if(typeof _r=="string")return _r}function getTypeFromContext(_r){const Tr=Array.isArray(_r)?_r:[_r];for(const Ar of Tr)switch(Ar){case"http://iiif.io/api/image/2/context.json":case"http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2":return"ImageService2";case"http://iiif.io/api/image/1/context.json":case"http://library.stanford.edu/iiif/image-api/1.1/context.json":return"ImageService1";case"http://iiif.io/api/annex/openannotation/context.json":return"ImageApiSelector"}}function getTypeFromProfile(_r){switch(_r){case"http://iiif.io/api/image/2/level0.json":case"http://iiif.io/api/image/2/level1.json":case"http://iiif.io/api/image/2/level2.json":return"ImageService2";case"http://iiif.io/api/auth/1/kiosk":case"http://iiif.io/api/auth/1/login":case"http://iiif.io/api/auth/1/clickthrough":case"http://iiif.io/api/auth/1/external":case"http://iiif.io/api/auth/0/kiosk":case"http://iiif.io/api/auth/0/login":case"http://iiif.io/api/auth/0/clickthrough":case"http://iiif.io/api/auth/0/external":return"AuthCookieService1";case"http://iiif.io/api/auth/1/token":case"http://iiif.io/api/auth/0/token":return"AuthTokenService1";case"http://iiif.io/api/auth/1/logout":case"http://iiif.io/api/auth/0/logout":return"AuthLogoutService1";case"http://iiif.io/api/search/1/search":case"http://iiif.io/api/search/0/search":return"SearchService1";case"http://iiif.io/api/search/1/autocomplete":case"http://iiif.io/api/search/0/autocomplete":return"AutoCompleteService1"}}function removePrefix(_r){for(const Tr of["sc","oa","dcterms","dctypes","iiif"])if(_r.startsWith(`${Tr}:`))return _r.slice(Tr.length+1);return _r}const knownTypes=["Collection","Manifest","Annotation","AnnotationPage","Range","Service"];function getNewType(_r){const Tr=_r["@id"]||_r.id;let Ar=_r["@type"]||_r.type;const Rr=_r.profile||void 0,Pr=_r["@context"]||void 0;if(Rr){const Dr=getTypeFromProfile(Rr);if(Dr)return Dr}if(Pr){const Dr=getTypeFromContext(Pr);if(Dr)return Dr}if(Ar){if(Array.isArray(Ar)){if(Ar.indexOf("oa:CssStylesheet")!==-1)return"CssStylesheet";if(Ar.indexOf("cnt:ContentAsText")!==-1)return"TextualBody";Ar=Ar[0]}for(const Dr of["sc","oa","dcterms","dctypes","iiif"])if(Ar.startsWith(`${Dr}:`)){Ar=Ar.slice(Dr.length+1);break}switch(Ar){case"Layer":return"AnnotationCollection";case"AnnotationList":return"AnnotationPage";case"cnt:ContentAsText":return"TextualBody"}}if(Ar&&knownTypes.indexOf(Ar)!==-1)return Ar;if(_r.format){if(_r.format.startsWith("image/"))return"Image";if(_r.format.startsWith("text/")||_r.format==="application/pdf")return"Text";if(_r.format.startsWith("application/"))return"Dataset"}return Tr&&(Tr.endsWith(".jpg")||Tr.endsWith(".png")||Tr.endsWith(".jpeg"))?"Image":Ar||"unknown"}const licenseRegex=/http(s)?:\/\/(creativecommons.org|rightsstatements.org)[^"'\\<\n]+/gm;function extractLicense(_r){const Tr=_r.match(licenseRegex);return Tr?Tr[0]:_r}function fixLicense(_r,Tr="Rights/License",Ar="none"){let Rr=null;const Pr=[],Dr=Array.isArray(_r)?_r:[_r];for(const Mr of Dr){const Fr=Mr?extractLicense(Mr):void 0;if(Fr&&(Fr.indexOf("creativecommons.org")!==-1||Fr.indexOf("rightsstatements.org")!==-1)){Fr.startsWith("https://")?Rr=`http://${Fr.slice(8)}`:Rr=Fr;continue}Fr&&Pr.push({label:{[Ar]:[Tr]},value:{[Ar]:[Fr]}})}return[Rr,Pr]}const removeContexts=["http://iiif.io/api/presentation/2/context.json","http://iiif.io/api/image/2/context.json","http://iiif.io/api/image/1/context.json","http://library.stanford.edu/iiif/image-api/1.1/context.json","http://iiif.io/api/search/1/context.json","http://iiif.io/api/search/0/context.json","http://iiif.io/api/auth/1/context.json","http://iiif.io/api/auth/0/context.json","http://iiif.io/api/annex/openannotation/context.json"];function fixContext(_r){if(_r){const Tr=Array.isArray(_r)?_r:[_r],Ar=[];for(const Rr of Tr)Rr==="http://iiif.io/api/presentation/2/context.json"&&Ar.push("http://iiif.io/api/presentation/3/context.json"),removeContexts.indexOf(Rr)===-1&&Ar.push(Rr);if(Tr.length)return Ar.length===1?Ar[0]:Ar}}function convertMetadata(_r){return _r?_r.map(Tr=>({label:convertLanguageMapping(Tr.label),value:convertLanguageMapping(Tr.value)})):[]}function removeUndefinedProperties(_r){for(const Tr in _r)(typeof _r[Tr]>"u"||_r[Tr]===null)&&delete _r[Tr];return _r}let mintedIdCounter=0;function mintNewIdFromResource(_r,Tr){const Ar=encodeURI(_r.id||_r["@id"]||"").trim();return Ar&&Tr?`${Ar}/${Tr}`:Ar||(mintedIdCounter++,`http://example.org/${_r["@type"]}${Tr?`/${Tr}`:""}/${mintedIdCounter}`)}function technicalProperties$2(_r){const Tr=[..._r.behavior||[]];_r.viewingHint&&Tr.push(_r.viewingHint);let Ar;return Array.isArray(_r.motivation)?Ar=_r.motivation.map(removePrefix):_r.motivation&&(Ar=removePrefix(_r.motivation)),{"@context":_r["@context"]?fixContext(_r["@context"]):void 0,id:(_r["@id"]||mintNewIdFromResource(_r)).trim(),type:getNewType(_r),behavior:Tr.length?Tr:void 0,height:_r.height?_r.height:void 0,width:_r.width?_r.width:void 0,motivation:Ar,viewingDirection:_r.viewingDirection,profile:_r.profile,format:_r.format?_r.format:void 0,duration:void 0,timeMode:void 0}}function descriptiveProperties$2(_r){const[Tr,Ar]=fixLicense(_r.license),Rr=[..._r.metadata?convertMetadata(_r.metadata):[],...Ar];return{rights:Tr,metadata:Rr.length?Rr:void 0,label:_r.label?convertLanguageMapping(_r.label):void 0,requiredStatement:_r.attribution?{label:convertLanguageMapping(configuration.attributionLabel),value:convertLanguageMapping(_r.attribution)}:void 0,navDate:_r.navDate,summary:_r.description?convertLanguageMapping(_r.description):void 0,thumbnail:_r.thumbnail}}function parseWithin(_r){if(!_r.within)return;const Tr=Array.isArray(_r.within)?_r.within:[_r.within],Ar=[];for(const Rr of Tr)if(typeof Rr=="string"){if(Rr)switch(_r["@type"]){case"sc:Manifest":Ar.push({id:Rr,type:"Collection"});break}}else Rr["@id"]&&Ar.push({id:Rr["@id"],type:getNewType(Rr)});return Ar.length?Ar:void 0}function linkingProperties$2(_r){const Tr=_r.related?Array.isArray(_r.related)?_r.related:[_r.related]:[],Ar=_r.contentLayer;return{provider:_r.logo||Tr.length?[{id:configuration.providerId,type:"Agent",homepage:Tr.length?[Tr[0]]:void 0,logo:_r.logo?Array.isArray(_r.logo)?_r.logo:[_r.logo]:void 0,label:convertLanguageMapping(configuration.providerName)}]:void 0,partOf:parseWithin(_r),rendering:_r.rendering,seeAlso:_r.seeAlso,start:_r.startCanvas,service:_r.service?ensureArray$1(_r.service):void 0,supplementary:Ar?[Ar]:void 0}}function embeddedContentProperties(_r){return{chars:_r.chars,format:_r.format?_r.format:void 0,language:_r.language}}function upgradeCollection(_r){return removeUndefinedProperties({...technicalProperties$2(_r),...descriptiveProperties$2(_r),...linkingProperties$2(_r),items:_r.members})}function upgradeManifest(_r){const Tr=[],Ar=[];for(const Pr of _r.sequences||[])Pr.canvases.length&&Tr.push(...Pr.canvases),Pr.behavior&&Ar.push(...Pr.behavior);const Rr=technicalProperties$2(_r);return Ar.length&&(Rr.behavior?Rr.behavior.push(...Ar):Rr.behavior=Ar),removeUndefinedProperties({...Rr,...descriptiveProperties$2(_r),...linkingProperties$2(_r),items:Tr,structures:_r.structures})}function upgradeCanvas(_r){return removeUndefinedProperties({...technicalProperties$2(_r),...descriptiveProperties$2(_r),...linkingProperties$2(_r),annotations:_r.otherContent&&_r.otherContent.length?_r.otherContent:void 0,items:_r.images&&_r.images.length?[{id:mintNewIdFromResource(_r,"annotation-page"),type:"AnnotationPage",items:_r.images}]:void 0})}function upgradeAnnotationList(_r){return removeUndefinedProperties({...technicalProperties$2(_r),...descriptiveProperties$2(_r),...linkingProperties$2(_r),items:_r.resources&&_r.resources.length?_r.resources:void 0})}function upgradeSequence(_r){return!_r.canvases||_r.canvases.length===0?{canvases:[],behavior:[]}:{canvases:_r.canvases,behavior:_r.viewingHint?[_r.viewingHint]:[]}}function upgradeAnnotation(_r){function Tr(Ar){if(Array.isArray(Ar)){if(Ar.length>1)return{type:"List",items:Ar.map(Tr)};Ar=Ar[0]}if(typeof Ar=="string")return encodeURI(Ar).trim();if("@type"in Ar){let Rr;if(typeof Ar.full=="string")Rr=Ar.full;else if(Ar.full["@type"]==="dctypes:Image")Rr={id:Ar.full["@id"],type:"Image"};else if(Ar.full["@type"]==="sc:Canvas")Rr={id:Ar.full["@id"],type:"Canvas"};else throw new Error(`Unsupported source type on annotation: ${Ar.full["@type"]}`);return{type:"SpecificResource",source:Rr,selector:upgradeSelector(Ar.selector)}}else return encodeURI(Ar["@id"]).trim()}return removeUndefinedProperties({...technicalProperties$2(_r),...descriptiveProperties$2(_r),...linkingProperties$2(_r),target:Tr(_r.on),body:Array.isArray(_r.resource)?_r.resource.map(upgradeContentResource):upgradeContentResource(_r.resource)})}function upgradeContentResource(_r){const Tr=_r;return removeUndefinedProperties({...technicalProperties$2(Tr),...descriptiveProperties$2(Tr),...linkingProperties$2(Tr),...embeddedContentProperties(Tr)})}function upgradeChoice(_r){const Tr=[];return _r.default&&_r.default!=="rdf:nil"&&Tr.push(_r.default),_r.item&&_r.item!=="rdf:nil"&&Tr.push(..._r.item),{...technicalProperties$2(_r),...descriptiveProperties$2(_r),items:Tr}}function upgradeRange(_r){return removeUndefinedProperties({...technicalProperties$2(_r),...descriptiveProperties$2(_r),...linkingProperties$2(_r),items:_r.members})}function upgradeService(_r){const{"@id":Tr,"@type":Ar,"@context":Rr,profile:Pr,...Dr}=_r,Mr={};return Tr&&(Mr["@id"]=Tr),Mr["@type"]=getNewType(_r),Mr["@type"]==="unknown"&&(Rr&&Rr.length&&(Mr["@context"]=Rr),Mr["@type"]="Service"),Pr&&(Mr.profile=getProfile(Pr)),removeUndefinedProperties({...Mr,...Dr})}function upgradeLayer(_r){return removeUndefinedProperties({...technicalProperties$2(_r),...descriptiveProperties$2(_r),...linkingProperties$2(_r)})}const presentation2to3=new Traverse({collection:[upgradeCollection],manifest:[upgradeManifest],canvas:[upgradeCanvas],annotationList:[upgradeAnnotationList],sequence:[upgradeSequence],annotation:[upgradeAnnotation],contentResource:[upgradeContentResource],choice:[upgradeChoice],range:[upgradeRange],service:[upgradeService],layer:[upgradeLayer]});function convertPresentation2(_r){return _r&&_r["@context"]&&(_r["@context"]==="http://iiif.io/api/presentation/2/context.json"||_r["@context"].indexOf("http://iiif.io/api/presentation/2/context.json")!==-1||_r["@context"]==="http://www.shared-canvas.org/ns/context.json")||_r["@context"]==="http://iiif.io/api/image/2/context.json"?presentation2to3.traverseUnknown(_r):_r}function upgradeSelector(_r){if((Array.isArray(_r["@type"])&&_r["@type"].includes("oa:SvgSelector")||_r["@type"]=="oa:SvgSelector")&&("chars"in _r||"value"in _r))return{type:"SvgSelector",value:"chars"in _r?_r.chars:_r.value};if(_r["@type"]==="oa:FragmentSelector")return{type:"FragmentSelector",value:_r.value};if(_r["@type"]==="oa:Choice")return[upgradeSelector(_r.default),...(Array.isArray(_r.item)?_r.item:[_r.item]).map(upgradeSelector)];if(_r["@type"]=="iiif:ImageApiSelector")return{type:"ImageApiSelector",region:"region"in _r?_r.region:void 0,rotation:"rotation"in _r?_r.rotation:void 0};throw new Error(`Unsupported selector type: ${_r["@type"]}`)}function getDefaultEntities$1(){return{Collection:{},Manifest:{},Canvas:{},AnnotationPage:{},AnnotationCollection:{},Annotation:{},ContentResource:{},Range:{},Service:{},Selector:{},Agent:{}}}function getResource(_r,Tr){if(typeof _r=="string")return{id:_r,type:Tr};if(!_r.id)throw new Error(`Invalid resource does not have an ID (${Tr})`);return _r}function mapToEntities(_r){return(Tr,Ar)=>{const Rr=_r[Tr]?_r[Tr]:{};return Pr=>{const Dr=getResource(Pr,Ar||Tr);return Dr&&Dr.id&&Tr?(Rr[Dr.id]=Rr[Dr.id]?mergeEntities(Rr[Dr.id],Dr):Object.assign({},Dr),{id:Dr.id,type:Tr==="ContentResource"?Tr:Dr.type}):Dr}}}function merge(_r,Tr){if(!Tr)return _r;if(Array.isArray(_r)){if(!Array.isArray(Tr))throw new Error("Cannot merge array with non-array");const Ar=[..._r];for(const Rr of Tr)if(Rr!=null)if(Array.isArray(Rr))Ar.push(Rr);else if(typeof Rr=="object"&&Rr.id&&Rr.type){const Pr=Ar.findIndex(Dr=>Dr.id===Rr.id&&Dr.type===Rr.type);Pr>=0&&(Ar[Pr]=merge(Ar[Pr],Rr))}else _r.indexOf(Rr)===-1&&Ar.push(Rr);return Ar}else if(typeof _r=="object"){if(Array.isArray(Tr)||typeof Tr!="object")throw new Error("Cannot merge object with non-object");const Ar={..._r};for(const[Rr,Pr]of Object.entries(Tr)){const Dr=Ar[Rr];Dr===EMPTY||!Dr?Ar[Rr]=Pr:Ar[Rr]=merge(Dr,Pr)}return Ar}else if(_r)return _r;return Tr}function mergeEntities(_r,Tr){if(typeof _r=="string")return _r;if(Tr.id!==_r.id||Tr.type!==_r.type)throw new Error("Can only merge entities with identical identifiers and type!");return merge({..._r},Tr)}function recordTypeInMapping(_r){return(Tr,Ar)=>Rr=>{const{id:Pr,type:Dr}=getResource(Rr,Ar||Tr);if(typeof Pr>"u")throw new Error("Found invalid entity without an ID.");return Tr==="ContentResource"?_r[Pr]=Tr:_r[Pr]=Dr,Rr}}function hash$1(_r){const Tr=JSON.stringify(_r);let Ar=5381,Rr=Tr.length;for(;Rr;)Ar=Ar*33^Tr.charCodeAt(--Rr);const Dr=(Ar>>>0).toString(16);return Dr.length%2?"0"+Dr:Dr}function addMissingIdToContentResource(_r){return Tr=>typeof Tr=="string"?{id:Tr,type:_r}:Tr.id?Tr.type?Tr:{type:_r,...Tr}:{id:`vault://${hash$1(Tr)}`,type:_r,...Tr}}function ensureDefaultFields(_r){return Tr=>({..._r,...Tr})}function ensureArray(_r){return Array.isArray(_r)?_r:[_r]}function ensureArrayOnAnnotation(_r){return _r.body&&(_r.body=ensureArray(_r.body)),_r.seeAlso&&(_r.seeAlso=ensureArray(_r.seeAlso)),_r.body&&(_r.body=ensureArray(_r.body)),_r.audience&&(_r.audience=ensureArray(_r.audience)),_r.accessibility&&(_r.accessibility=ensureArray(_r.accessibility)),_r.motivation&&(_r.motivation=ensureArray(_r.motivation)),_r}function normalize(_r){const Tr=convertPresentation2(_r),Ar=getDefaultEntities$1(),Rr={},Pr=mapToEntities(Ar),Dr=recordTypeInMapping(Rr),Fr=new Traverse$1({collection:[ensureDefaultFields(emptyCollection),Dr("Collection"),Pr("Collection")],manifest:[ensureDefaultFields(emptyManifest),Dr("Manifest"),Pr("Manifest")],canvas:[ensureDefaultFields(emptyCanvas),Dr("Canvas"),Pr("Canvas")],annotationPage:[addMissingIdToContentResource("AnnotationPage"),ensureDefaultFields(emptyAnnotationPage),Dr("AnnotationPage"),Pr("AnnotationPage")],annotation:[addMissingIdToContentResource("Annotation"),ensureArrayOnAnnotation,Dr("Annotation"),Pr("Annotation")],contentResource:[addMissingIdToContentResource("ContentResource"),Dr("ContentResource"),Pr("ContentResource")],range:[ensureDefaultFields(emptyRange),Dr("Range","Canvas"),Pr("Range","Canvas")],agent:[ensureDefaultFields(emptyAgent),Dr("Agent"),Pr("Agent")]}).traverseUnknown(Tr);return{entities:Ar,resource:Fr,mapping:Rr}}const UNSET="__$UNSET$__",UNWRAP="__$UNWRAP$__";function resolveIfExists$1(_r,Tr){const Ar=_r.requests[Tr],Rr=_r.mapping[Tr];if(!(!Rr||Ar&&Ar.resourceUri&&!_r.entities[Rr][Ar.resourceUri]))return _r.entities[Rr][Ar?Ar.resourceUri:Tr]}function serializedFieldsToObject(_r){const Tr={};for(const[Ar,Rr]of _r){if(Ar===UNWRAP&&Rr!==UNSET)return Rr;Rr!==UNSET&&typeof Rr<"u"&&Rr!==null&&(Tr[Ar]=Rr)}return Tr}function serialize(_r,Tr,Ar){if(!Tr.type||!Tr.id)throw new Error("Unknown entity");if(!Ar[Tr.type])throw new Error(`Serializer not found for ${Tr.type}`);function Rr(Pr){const Dr=Ar[Pr.type];if(!Dr)return UNSET;const Mr=resolveIfExists$1(_r,Pr.id)||(Pr.id&&Pr.type?Pr:null);if(!Mr)return UNSET;const Fr=Dr(Mr,_r,{isTopLevel:Tr.id===Pr.id});let zr=Fr.next();for(;!zr.done;){const jr=zr.value;let Gr=UNSET;if(jr)if(Array.isArray(jr)){const Nr=[];for(const Lr of jr)Nr.push(Rr(Lr));Gr=Nr}else Gr=Rr(jr);zr=Fr.next(Gr)}return zr.value===UNSET?UNSET:serializedFieldsToObject(zr.value)}return Rr(Tr)}function languageString2to3(_r){if(!_r)return;const Tr=Object.keys(_r);if(Tr.length!==0){if(Tr.length===1){const Ar=Tr[0];if(!Ar)return"";const Rr=(_r[Ar]||[]).join("");return Ar==="@none"||Ar==="none"||Ar==="en"?Rr:{"@language":Ar,"@value":Rr}}return Tr.map(Ar=>({"@language":Ar,"@value":(_r[Ar]||[]).join("")}))}}function parseCanvasTarget(_r){return Array.isArray(_r)?_r.map(Tr=>parseCanvasTarget(Tr)):typeof _r=="string"?_r:_r.type&&_r.type==="Canvas"?_r.id:_r}function unNestArray(_r,Tr=!1){if(_r)return _r.length>1&&!Tr?_r:_r[0]||void 0}function convertService(_r){if(_r){if(typeof _r=="string")return{"@id":_r};if("@id"in _r){const Tr={..._r};return delete Tr["@type"],Tr}return{"@context":"http://iiif.io/api/image/2/context.json","@id":_r.id,profile:`http://iiif.io/api/image/2/profiles/${_r.profile}.json`}}}function technicalProperties$1(_r,Tr){return[["@id",_r.id],["@type",Tr],["format",_r.format],["height",_r.height],["width",_r.width],["viewingDirection",_r.viewingDirection!=="left-to-right"?_r.viewingDirection:void 0]]}function*descriptiveProperties$1(_r){const Tr=_r.provider?yield _r.provider[0]:void 0;return[["label",languageString2to3(_r.label)],["metadata",_r.metadata&&_r.metadata.length?_r.metadata.map(Ar=>({label:languageString2to3(Ar.label)||"",value:languageString2to3(Ar.value)||""})):void 0],["description",languageString2to3(_r.summary)],["thumbnail",unNestArray(yield _r.thumbnail)],["navDate",_r.navDate],["logo",Tr?unNestArray(Tr.logo):void 0],["homepage",Tr?Tr.homepage:void 0],["attribution",_r.requiredStatement?languageString2to3(_r.requiredStatement.value):void 0]]}function*linkingProperties$1(_r){return[["seeAlso",unNestArray(yield _r.seeAlso)],["service",unNestArray((_r.service||[]).map(convertService))],["rendering",unNestArray(yield _r.rendering)],["startCanvas",_r.start?_r.start.id:void 0]]}const serializeConfigPresentation2={Manifest:function*(_r){return[...technicalProperties$1(_r,"sc:Manifest"),...yield*descriptiveProperties$1(_r),...yield*linkingProperties$1(_r),["sequences",[{"@id":`${_r.id}/sequence0`,"@type":"sc:Sequence",canvases:yield _r.items}]],["structures",yield _r.structures]]},Canvas:function*(_r){const Ar=(yield _r.items)[0];return[...technicalProperties$1(_r,"sc:Canvas"),...yield*descriptiveProperties$1(_r),...yield*linkingProperties$1(_r),["images",Ar?[Ar.resources]:void 0],["annotations",_r.annotations&&_r.annotations.length?unNestArray(yield _r.annotations):void 0]]},AnnotationPage:function*(_r){return[...technicalProperties$1(_r,"sc:AnnotationList"),...yield*descriptiveProperties$1(_r),["resources",_r.items&&_r.items.length?unNestArray(yield _r.items):void 0]]},Annotation:function*(_r){return[["@id",_r.id],["@type","oa:Annotation"],["motivation","sc:painting"],["on",parseCanvasTarget(_r.target)],["resource",unNestArray(yield _r.body,!0)]]},ContentResource:function*(_r){switch(_r.type){case"Image":return[...technicalProperties$1(_r,"dctypes:Image"),...yield*descriptiveProperties$1(_r),...yield*linkingProperties$1(_r)];case"Text":case"Dataset":default:return[...technicalProperties$1(_r,void 0),...yield*descriptiveProperties$1(_r)]}},AnnotationCollection:function*(_r){return[["@id",_r.id],["@type","sc:Layer"],["label",languageString2to3(_r.label)]]},Collection:function*(_r){return[...technicalProperties$1(_r,"sc:Collection"),...yield*descriptiveProperties$1(_r),...yield*linkingProperties$1(_r),["members",yield*_r.items]]},Range:function*(_r){const Tr=[],Ar=[];if(_r.items)for(const Rr of _r.items){const Pr=yield Rr;Tr.push({"@id":Rr.id,"@type":Rr.type,label:Pr?Pr.label:void 0,within:_r.id}),Rr.type==="Canvas"&&Ar.push(Rr.id)}return[...technicalProperties$1(_r,"sc:Range"),...yield*descriptiveProperties$1(_r),...yield*linkingProperties$1(_r),["canvases",Ar.length===Tr.length?Ar:void 0],["members",Ar.length!==Tr.length?Tr:void 0]]}};function technicalProperties(_r){var Tr;return[["id",(Tr=_r.id)!=null&&Tr.startsWith("vault://")?void 0:_r.id],["type",_r.type],["format",_r.format],["profile",_r.profile],["height",_r.height],["width",_r.width],["duration",_r.duration||void 0],["viewingDirection",_r.viewingDirection!=="left-to-right"?_r.viewingDirection:void 0],["behavior",_r.behavior&&_r.behavior.length?_r.behavior:void 0],["timeMode",_r.timeMode],["motivation",Array.isArray(_r.motivation)?_r.motivation[0]:_r.motivation]]}function filterEmpty(_r){if(!(!_r||_r.length===0))return _r}function service2compat(_r){if(_r&&_r.type&&_r.type==="ImageService2"){const{id:Tr,type:Ar,profile:Rr,...Pr}=_r,Dr=typeof Rr=="string"?Rr:Array.isArray(Rr)?Rr.find(Mr=>typeof Mr=="string"):"";return{"@id":Tr,"@type":Ar,profile:Dr?Dr.startsWith("http")?Dr:`http://iiif.io/api/image/2/${Dr}.json`:"http://iiif.io/api/image/2/level0.json",...Pr}}return _r}function filterService2Compat(_r){if(!(!_r||_r.length===0))return _r.map(service2compat)}function*descriptiveProperties(_r){return[["label",_r.label],["metadata",filterEmpty(_r.metadata)],["summary",_r.summary],["requiredStatement",_r.requiredStatement],["rights",_r.rights],["navDate",_r.navDate],["language",_r.language],["thumbnail",filterEmpty(yield _r.thumbnail)],["placeholderCanvas",yield _r.placeholderCanvas],["accompanyingCanvas",yield _r.accompanyingCanvas],["provider",filterEmpty(yield _r.provider)]]}function*linkingProperties(_r){return[["seeAlso",filterEmpty(yield _r.seeAlso)],["service",filterService2Compat(_r.service)],["services",filterService2Compat(_r.services)],["rendering",filterEmpty(yield _r.rendering)],["supplementary",filterEmpty(yield _r.supplementary)],["homepage",filterEmpty(yield _r.homepage)],["logo",filterEmpty(yield _r.logo)],["partOf",filterEmpty(yield _r.partOf)],["start",_r.start]]}const serializeConfigPresentation3={Manifest:function*(_r,Tr,{isTopLevel:Ar}){return Ar?[["@context","http://iiif.io/api/presentation/3/context.json"],...technicalProperties(_r),...yield*descriptiveProperties(_r),...yield*linkingProperties(_r),["items",yield _r.items],["structures",filterEmpty(yield _r.structures)],["annotations",filterEmpty(yield _r.annotations)]]:[...technicalProperties(_r),...yield*descriptiveProperties(_r)]},Canvas:function*(_r){return[...technicalProperties(_r),...yield*descriptiveProperties(_r),...yield*linkingProperties(_r),["items",yield _r.items],["annotations",filterEmpty(yield _r.annotations)]]},Agent:function*(_r){return[["id",_r.id],["type","Agent"],["label",_r.label],...yield*linkingProperties(_r)]},AnnotationPage:function*(_r){return[...Object.entries(_r).map(([Ar,Rr])=>[Ar,Array.isArray(Rr)?filterEmpty(Rr):Rr]).filter(([Ar,Rr])=>Ar!=="items"),...yield*linkingProperties(_r),["items",yield _r.items]]},Service:function*(_r){return[[UNWRAP,service2compat(_r)]]},Annotation:function*(_r){const Tr=Object.entries(_r).map(([Rr,Pr])=>Rr==="motivation"?[Rr,Array.isArray(Pr)?Pr[0]:Pr]:[Rr,Array.isArray(Pr)?filterEmpty(Pr):Pr]).filter(([Rr])=>Rr!=="body"),Ar=yield _r.body;return[...Tr,["body",Ar.length===1?Ar[0]:Ar]]},ContentResource:function*(_r){return[...technicalProperties(_r),...yield*descriptiveProperties(_r),...yield*linkingProperties(_r),["annotations",filterEmpty(yield _r.annotations)],["items",filterEmpty(yield _r.items)]]},AnnotationCollection:function*(_r){return[["id",_r.id],["type","AnnotationCollection"],["label",_r.label]]},Collection:function*(_r,Tr,{isTopLevel:Ar}){return Ar?[["@context","http://iiif.io/api/presentation/3/context.json"],...technicalProperties(_r),...yield*descriptiveProperties(_r),...yield*linkingProperties(_r),["items",filterEmpty(yield _r.items)]]:[...technicalProperties(_r),...yield*descriptiveProperties(_r)]},Range:function*(_r){const Tr=[];for(const Ar of _r.items)Ar.type==="Range"?Tr.push(yield Ar):Tr.push(Ar);return[...technicalProperties(_r),...yield*descriptiveProperties(_r),...yield*linkingProperties(_r),["items",Tr],["annotations",filterEmpty(yield _r.annotations)]]}};function n$1(_r){return _r==null}function t$1(_r){throw new Error("Argument "+_r+" is empty.")}function o$1(_r){return typeof _r=="string"||typeof _r=="symbol"}function u$1(_r){return!o$1(_r)}function a$1(_r){throw new Error("Argument "+_r+" is invalid, it should be an action type of type: string | symbol")}function s$1(_r,Tr){return n$1(_r)&&t$1(1),u$1(_r)&&a$1(1),Object.assign(function(){var Ar=Tr!=null?Tr.apply(void 0,arguments):void 0;return Object.assign({type:_r},Ar)},{getType:function(){return _r},toString:function(){return _r}})}function y$1(_r,Tr,Ar){return n$1(_r)&&t$1(1),u$1(_r)&&a$1(1),function(){return s$1(_r,function(){var Rr=arguments.length<=0?void 0:arguments[0],Pr=arguments.length<=1?void 0:arguments[1];return Tr==null&&Ar==null||(Rr=Tr!=null?Tr.apply(void 0,arguments):void 0,Pr=Ar!=null?Ar.apply(void 0,arguments):void 0),Object.assign({},Rr!==void 0&&{payload:Rr},{},Pr!==void 0&&{meta:Pr})})}}function _typeof(_r){"@babel/helpers - typeof";return _typeof=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Tr){return typeof Tr}:function(Tr){return Tr&&typeof Symbol=="function"&&Tr.constructor===Symbol&&Tr!==Symbol.prototype?"symbol":typeof Tr},_typeof(_r)}function _toPrimitive$1(_r,Tr){if(_typeof(_r)!=="object"||_r===null)return _r;var Ar=_r[Symbol.toPrimitive];if(Ar!==void 0){var Rr=Ar.call(_r,Tr||"default");if(_typeof(Rr)!=="object")return Rr;throw new TypeError("@@toPrimitive must return a primitive value.")}return(Tr==="string"?String:Number)(_r)}function _toPropertyKey$1(_r){var Tr=_toPrimitive$1(_r,"string");return _typeof(Tr)==="symbol"?Tr:String(Tr)}function _defineProperty$1(_r,Tr,Ar){return Tr=_toPropertyKey$1(Tr),Tr in _r?Object.defineProperty(_r,Tr,{value:Ar,enumerable:!0,configurable:!0,writable:!0}):_r[Tr]=Ar,_r}function ownKeys$1(_r,Tr){var Ar=Object.keys(_r);if(Object.getOwnPropertySymbols){var Rr=Object.getOwnPropertySymbols(_r);Tr&&(Rr=Rr.filter(function(Pr){return Object.getOwnPropertyDescriptor(_r,Pr).enumerable})),Ar.push.apply(Ar,Rr)}return Ar}function _objectSpread2$1(_r){for(var Tr=1;Tr<arguments.length;Tr++){var Ar=arguments[Tr]!=null?arguments[Tr]:{};Tr%2?ownKeys$1(Object(Ar),!0).forEach(function(Rr){_defineProperty$1(_r,Rr,Ar[Rr])}):Object.getOwnPropertyDescriptors?Object.defineProperties(_r,Object.getOwnPropertyDescriptors(Ar)):ownKeys$1(Object(Ar)).forEach(function(Rr){Object.defineProperty(_r,Rr,Object.getOwnPropertyDescriptor(Ar,Rr))})}return _r}function formatProdErrorMessage(_r){return"Minified Redux error #"+_r+"; visit https://redux.js.org/Errors?code="+_r+" for the full message or use the non-minified dev environment for full errors. "}var $$observable=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}(),randomString=function(){return Math.random().toString(36).substring(7).split("").join(".")},ActionTypes={INIT:"@@redux/INIT"+randomString(),REPLACE:"@@redux/REPLACE"+randomString(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+randomString()}};function isPlainObject$4(_r){if(typeof _r!="object"||_r===null)return!1;for(var Tr=_r;Object.getPrototypeOf(Tr)!==null;)Tr=Object.getPrototypeOf(Tr);return Object.getPrototypeOf(_r)===Tr}function createStore$1(_r,Tr,Ar){var Rr;if(typeof Tr=="function"&&typeof Ar=="function"||typeof Ar=="function"&&typeof arguments[3]=="function")throw new Error(formatProdErrorMessage(0));if(typeof Tr=="function"&&typeof Ar>"u"&&(Ar=Tr,Tr=void 0),typeof Ar<"u"){if(typeof Ar!="function")throw new Error(formatProdErrorMessage(1));return Ar(createStore$1)(_r,Tr)}if(typeof _r!="function")throw new Error(formatProdErrorMessage(2));var Pr=_r,Dr=Tr,Mr=[],Fr=Mr,zr=!1;function jr(){Fr===Mr&&(Fr=Mr.slice())}function Gr(){if(zr)throw new Error(formatProdErrorMessage(3));return Dr}function Nr(Wr){if(typeof Wr!="function")throw new Error(formatProdErrorMessage(4));if(zr)throw new Error(formatProdErrorMessage(5));var qr=!0;return jr(),Fr.push(Wr),function(){if(qr){if(zr)throw new Error(formatProdErrorMessage(6));qr=!1,jr();var Xr=Fr.indexOf(Wr);Fr.splice(Xr,1),Mr=null}}}function Lr(Wr){if(!isPlainObject$4(Wr))throw new Error(formatProdErrorMessage(7));if(typeof Wr.type>"u")throw new Error(formatProdErrorMessage(8));if(zr)throw new Error(formatProdErrorMessage(9));try{zr=!0,Dr=Pr(Dr,Wr)}finally{zr=!1}for(var qr=Mr=Fr,Kr=0;Kr<qr.length;Kr++){var Xr=qr[Kr];Xr()}return Wr}function Ur(Wr){if(typeof Wr!="function")throw new Error(formatProdErrorMessage(10));Pr=Wr,Lr({type:ActionTypes.REPLACE})}function Vr(){var Wr,qr=Nr;return Wr={subscribe:function(Xr){if(typeof Xr!="object"||Xr===null)throw new Error(formatProdErrorMessage(11));function Zr(){Xr.next&&Xr.next(Gr())}Zr();var _i=qr(Zr);return{unsubscribe:_i}}},Wr[$$observable]=function(){return this},Wr}return Lr({type:ActionTypes.INIT}),Rr={dispatch:Lr,subscribe:Nr,getState:Gr,replaceReducer:Ur},Rr[$$observable]=Vr,Rr}function assertReducerShape(_r){Object.keys(_r).forEach(function(Tr){var Ar=_r[Tr],Rr=Ar(void 0,{type:ActionTypes.INIT});if(typeof Rr>"u")throw new Error(formatProdErrorMessage(12));if(typeof Ar(void 0,{type:ActionTypes.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(formatProdErrorMessage(13))})}function combineReducers(_r){for(var Tr=Object.keys(_r),Ar={},Rr=0;Rr<Tr.length;Rr++){var Pr=Tr[Rr];typeof _r[Pr]=="function"&&(Ar[Pr]=_r[Pr])}var Dr=Object.keys(Ar),Mr;try{assertReducerShape(Ar)}catch(Fr){Mr=Fr}return function(zr,jr){if(zr===void 0&&(zr={}),Mr)throw Mr;for(var Gr=!1,Nr={},Lr=0;Lr<Dr.length;Lr++){var Ur=Dr[Lr],Vr=Ar[Ur],Wr=zr[Ur],qr=Vr(Wr,jr);if(typeof qr>"u")throw jr&&jr.type,new Error(formatProdErrorMessage(14));Nr[Ur]=qr,Gr=Gr||qr!==Wr}return Gr=Gr||Dr.length!==Object.keys(zr).length,Gr?Nr:zr}}function compose(){for(var _r=arguments.length,Tr=new Array(_r),Ar=0;Ar<_r;Ar++)Tr[Ar]=arguments[Ar];return Tr.length===0?function(Rr){return Rr}:Tr.length===1?Tr[0]:Tr.reduce(function(Rr,Pr){return function(){return Rr(Pr.apply(void 0,arguments))}})}function applyMiddleware(){for(var _r=arguments.length,Tr=new Array(_r),Ar=0;Ar<_r;Ar++)Tr[Ar]=arguments[Ar];return function(Rr){return function(){var Pr=Rr.apply(void 0,arguments),Dr=function(){throw new Error(formatProdErrorMessage(15))},Mr={getState:Pr.getState,dispatch:function(){return Dr.apply(void 0,arguments)}},Fr=Tr.map(function(zr){return zr(Mr)});return Dr=compose.apply(void 0,Fr)(Pr.dispatch),_objectSpread2$1(_objectSpread2$1({},Pr),{},{dispatch:Dr})}}}const IMPORT_ENTITIES="@iiif/IMPORT_ENTITIES",MODIFY_ENTITY_FIELD="@iiif/MODIFY_ENTITY_FIELD",REORDER_ENTITY_FIELD="@iiif/REORDER_ENTITY_FIELD",ADD_REFERENCE="@iiif/ADD_REFERENCE",REMOVE_REFERENCE="@iiif/REMOVE_REFERENCE",importEntities=y$1(IMPORT_ENTITIES)(),modifyEntityField=y$1(MODIFY_ENTITY_FIELD)(),reorderEntityField=y$1(REORDER_ENTITY_FIELD)(),addReference=y$1(ADD_REFERENCE)(),removeReference=y$1(REMOVE_REFERENCE)(),entityActions={importEntities,modifyEntityField,reorderEntityField,addReference,removeReference},ADD_MAPPING="@iiif/ADD_MAPPING",ADD_MAPPINGS="@iiif/ADD_MAPPINGS",addMapping=y$1(ADD_MAPPING)(),addMappings=y$1(ADD_MAPPINGS)(),SET_META_VALUE="@iiif/SET_META_VALUE",SET_META_VALUE_DYNAMIC="@iiif/SET_META_VALUE_DYNAMIC",UNSET_META_VALUE="@iiif/UNSET_META_VALUE",setMetaValue=y$1(SET_META_VALUE)(),setMetaValueDynamic=y$1(SET_META_VALUE_DYNAMIC)(),unsetMetaValue=y$1(UNSET_META_VALUE)(),metaActions={setMetaValue,setMetaValueDynamic,unsetMetaValue},RESOURCE_ERROR="RESOURCE_ERROR",RESOURCE_LOADING="RESOURCE_LOADING",RESOURCE_READY="RESOURCE_READY",REQUEST_RESOURCE="@iiif/REQUEST_RESOURCE",REQUEST_ERROR="@iiif/REQUEST_ERROR",REQUEST_MISMATCH="@iiif/REQUEST_MISMATCH",REQUEST_COMPLETE="@iiif/REQUEST_COMPLETE",REQUEST_OFFLINE_RESOURCE="@iiif/REQUEST_OFFLINE_RESOURCE",requestResource=y$1(REQUEST_RESOURCE)(),requestError=y$1(REQUEST_ERROR)(),requestMismatch=y$1(REQUEST_MISMATCH)(),requestComplete=y$1(REQUEST_COMPLETE)();y$1(REQUEST_OFFLINE_RESOURCE)();const BATCH_ACTIONS="@iiif/BATCH",BATCH_IMPORT="@iiif/BATCH_IMPORT",batchActions=y$1(BATCH_ACTIONS)();y$1(BATCH_IMPORT)();const actionListFromResource=(_r,Tr)=>{const{entities:Ar,resource:Rr,mapping:Pr}=normalize(Tr);if(Rr.id===void 0)return[requestError({id:_r,message:"ID is not defined in resource."})];const Dr=[importEntities({entities:Ar}),addMappings({mapping:Pr})];return Rr.id!==_r&&(Dr.push(addMapping({id:_r,type:Rr.type})),Dr.push(requestMismatch({requestId:_r,actualId:Rr.id}))),Dr.push(requestComplete({id:_r})),Dr},safeIsNaN=Number.isNaN||function(Tr){return typeof Tr=="number"&&Tr!==Tr};function isEqual(_r,Tr){return!!(_r===Tr||safeIsNaN(_r)&&safeIsNaN(Tr))}function areInputsEqual(_r,Tr){if(!Array.isArray(_r)||!Array.isArray(Tr))return _r===Tr;if(_r.length!==Tr.length)return!1;for(let Ar=0;Ar<_r.length;Ar++)if(!isEqual(_r[Ar],Tr[Ar]))return!1;return!0}function resolveIfExists(_r,Tr){const Ar=_r.iiif.requests[Tr],Rr=_r.iiif.mapping[Tr];if(!(!Rr||!_r.iiif.entities[Rr][Ar.resourceUri]))return _r.iiif.entities[Rr][Ar.resourceUri]}function createFetchHelper(_r,Tr,{waitTimeout:Ar=30}={}){return async(Rr,Pr)=>{const Dr=_r.getState(),Mr=Dr.iiif.requests[Rr];if(Mr)switch(Mr.loadingState){case RESOURCE_ERROR:break;case RESOURCE_LOADING:{let Fr,zr=!1;try{const jr=await Promise.race([new Promise((Gr,Nr)=>{zr||(Fr=_r.subscribe(()=>{const Lr=_r.getState();if(Lr.iiif.requests[Rr].loadingState===RESOURCE_ERROR){Nr();return}if(Lr.iiif.requests[Rr].loadingState===RESOURCE_READY){const Ur=resolveIfExists(Lr,Rr);Ur?Gr(Ur):Nr()}}))}),new Promise((Gr,Nr)=>setTimeout(()=>{zr=!0,Nr()},Ar*60))]);if(Fr&&Fr(),jr)return jr}catch{Fr&&Fr();break}break}case RESOURCE_READY:{const Fr=resolveIfExists(Dr,Rr);if(Fr)return Fr;break}}_r.dispatch(requestResource({id:Rr}));try{const Fr=await Tr(Rr,Pr);!Fr.id&&!Fr["@id"]&&(Fr["@type"]&&(Fr["@id"]=Rr),Fr.id=Rr);const zr=actionListFromResource(Rr,Fr);return _r.dispatch(batchActions({actions:zr})),resolveIfExists(_r.getState(),Rr)}catch(Fr){throw _r.dispatch(requestError({id:Rr,message:Fr.toString()})),Fr}}}function getDefaultEntities(){return{Collection:{},Manifest:{},Canvas:{},AnnotationPage:{},AnnotationCollection:{},Annotation:{},ContentResource:{},Range:{},Service:{},Selector:{},Agent:{}}}const mappingReducer=(_r={},Tr)=>{switch(Tr.type){case ADD_MAPPING:return{..._r,[Tr.payload.id]:Tr.payload.type};case ADD_MAPPINGS:return{..._r,...Tr.payload.mapping};default:return _r}};function isReferenceList(_r,Tr,Ar,Rr){return!(!_r[Ar]||!_r[Ar][Tr]||!_r[Ar][Tr][Rr]||!Array.isArray(_r[Ar][Tr][Rr]))}function quickMerge(_r,Tr){const Ar={},Rr=[];for(const[Pr,Dr]of Object.entries(_r||{})){Rr.push(Pr);const Mr=(Tr||{})[Pr];if(!Mr||Mr.length===0){Ar[Pr]=Dr;continue}Ar[Pr]=Mr}for(const[Pr,Dr]of Object.entries(Tr||{}))Rr.indexOf(Pr)===-1&&(Ar[Pr]=Dr);return Ar}const entitiesReducer=(_r=getDefaultEntities(),Tr)=>{var Ar;switch(Tr.type){case MODIFY_ENTITY_FIELD:{if(!_r[Tr.payload.type]||!_r[Tr.payload.type][Tr.payload.id])return _r;const Rr=_r[Tr.payload.type][Tr.payload.id];return typeof Rr=="string"?_r:{..._r,[Tr.payload.type]:{..._r[Tr.payload.type],[Tr.payload.id]:{...Rr,[Tr.payload.key]:Tr.payload.value}}}}case REORDER_ENTITY_FIELD:{if(!isReferenceList(_r,Tr.payload.id,Tr.payload.type,Tr.payload.key))return _r;const Rr=_r[Tr.payload.type][Tr.payload.id];if(typeof Rr=="string")return _r;const Pr=Array.from(Rr[Tr.payload.key]),[Dr]=Pr.splice(Tr.payload.startIndex,1);return Pr.splice(Tr.payload.endIndex,0,Dr),{..._r,[Tr.payload.type]:{..._r[Tr.payload.type],[Tr.payload.id]:{...Rr,[Tr.payload.key]:Pr}}}}case IMPORT_ENTITIES:{const Rr=Object.keys(Tr.payload.entities),Pr={..._r};for(const Dr of Rr){const Mr=Tr.payload.entities[Dr],Fr={..._r[Dr]||{}};let zr=!1;const jr=Object.keys(Mr||{})||[];if(Mr&&jr){for(const Gr of jr)zr=!0,Fr[Gr]=_r[Dr][Gr]?quickMerge(_r[Dr][Gr],Mr[Gr]):Mr[Gr];zr&&(Pr[Dr]=Fr)}}return Pr}case ADD_REFERENCE:{if(!isReferenceList(_r,Tr.payload.id,Tr.payload.type,Tr.payload.key))return _r;const Rr=_r[Tr.payload.type][Tr.payload.id],Pr=Array.from(Rr[Tr.payload.key]);return Pr.splice(Tr.payload.index||Pr.length+1,0,Tr.payload.reference),{..._r,[Tr.payload.type]:{..._r[Tr.payload.type],[Tr.payload.id]:{...Rr,[Tr.payload.key]:Pr}}}}case REMOVE_REFERENCE:{if(!isReferenceList(_r,Tr.payload.id,Tr.payload.type,Tr.payload.key))return _r;const Rr=_r[Tr.payload.type][Tr.payload.id],Pr=Array.from(Rr[Tr.payload.key]),Dr=Tr.payload.index||Pr.findIndex(Mr=>Mr&&Mr.id===Tr.payload.reference.id);return Dr===-1||((Ar=Pr[Dr])==null?void 0:Ar.id)!==Tr.payload.reference.id?_r:(Pr.splice(Dr,1),{..._r,[Tr.payload.type]:{..._r[Tr.payload.type],[Tr.payload.id]:{...Rr,[Tr.payload.key]:Pr}}})}default:return _r}},requestReducer=(_r={},Tr)=>{switch(Tr.type){case REQUEST_RESOURCE:case REQUEST_OFFLINE_RESOURCE:return{..._r,[Tr.payload.id]:{requestUri:Tr.payload.id,loadingState:RESOURCE_LOADING,uriMismatch:!1,resourceUri:Tr.payload.id}};case REQUEST_MISMATCH:return{..._r,[Tr.payload.requestId]:{..._r[Tr.payload.requestId]||{},uriMismatch:!0,resourceUri:Tr.payload.actualId},[Tr.payload.actualId]:{requestUri:Tr.payload.requestId,loadingState:_r[Tr.payload.requestId].loadingState,uriMismatch:!0,resourceUri:Tr.payload.actualId}};case REQUEST_ERROR:return{..._r,[Tr.payload.id]:{..._r[Tr.payload.id]||{},loadingState:RESOURCE_ERROR,error:Tr.payload.message}};case REQUEST_COMPLETE:return{..._r,[Tr.payload.id]:{..._r[Tr.payload.id]||{},loadingState:RESOURCE_READY,error:void 0}}}return _r},metaReducer=(_r={},Tr)=>{const{id:Ar,updateValue:Rr,value:Pr,meta:Dr,key:Mr}=Tr&&Tr.payload||{};switch(Tr.type){case SET_META_VALUE:return{..._r,[Ar]:{..._r[Ar]||{},[Dr]:{..._r[Ar]?_r[Ar][Dr]||{}:{},[Mr]:Pr}}};case SET_META_VALUE_DYNAMIC:return{..._r,[Ar]:{..._r[Ar]||{},[Dr]:{..._r[Ar]?_r[Ar][Dr]||{}:{},[Mr]:_r[Ar]&&_r[Ar][Dr]?Rr(_r[Ar][Dr][Mr]):Rr(void 0)}}};case UNSET_META_VALUE:return _r[Ar]&&_r[Ar][Dr]&&_r[Ar][Dr][Mr]?{..._r,[Ar]:{..._r[Ar]||{},[Dr]:{..._r[Ar]?_r[Ar][Dr]||{}:{},[Mr]:void 0}}}:_r;default:return _r}};function createBatchReducer(_r){return(Tr,Ar)=>Ar&&Ar.type===BATCH_ACTIONS?Ar.payload.actions.reduce(_r,Tr):Ar&&Ar.type===BATCH_IMPORT?Ar.payload.state:_r(Tr,Ar)}const reducers=combineReducers({mapping:mappingReducer,entities:entitiesReducer,requests:requestReducer,meta:metaReducer}),composeEnhancers=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||compose;function createStore(_r={}){const{enableDevtools:Tr=!0,iiifStoreName:Ar="iiif",defaultState:Rr={},extraMiddleware:Pr=[],customReducers:Dr={}}=_r,Mr=combineReducers({[Ar]:reducers,...Dr});return createStore$1(createBatchReducer(Mr),Rr,Tr?composeEnhancers(applyMiddleware(...Pr)):compose(applyMiddleware(...Pr)))}function mitt(_r){return{all:_r=_r||new Map,on:function(Tr,Ar){var Rr=_r.get(Tr);Rr?Rr.push(Ar):_r.set(Tr,[Ar])},off:function(Tr,Ar){var Rr=_r.get(Tr);Rr&&(Ar?Rr.splice(Rr.indexOf(Ar)>>>0,1):_r.set(Tr,[]))},emit:function(Tr,Ar){var Rr=_r.get(Tr);Rr&&Rr.slice().map(function(Pr){Pr(Ar)}),(Rr=_r.get("*"))&&Rr.slice().map(function(Pr){Pr(Tr,Ar)})}}}class Vault{constructor(Tr,Ar){ap(this,"options");ap(this,"store");ap(this,"emitter");ap(this,"isBatching",!1);ap(this,"batchQueue",[]);ap(this,"remoteFetcher");ap(this,"staticFetcher");ap(this,"defaultFetcher",Tr=>fetch(Tr).then(Ar=>Ar.json()));ap(this,"middleware",Tr=>Ar=>Rr=>{if(Rr.type===BATCH_ACTIONS){for(const Mr of Rr.payload.actions)this.emitter.emit(Mr.type,{realAction:Mr,state:Tr.getState()});const Dr=Ar(Rr);for(const Mr of Rr.payload.actions)this.emitter.emit(`after:${Rr.type}`,{action:Rr,state:Dr});return Dr}this.emitter.emit(Rr.type,{action:Rr,state:Tr.getState()});const Pr=Ar(Rr);return this.emitter.emit(`after:${Rr.type}`,{action:Rr,state:Pr}),Pr});this.options=Object.assign({reducers:{},middleware:[],defaultState:{},customFetcher:this.defaultFetcher,enableDevtools:!0},Tr||{}),this.store=Ar||createStore({customReducers:this.options.reducers,extraMiddleware:[...this.options.middleware,this.middleware],defaultState:this.options.defaultState,enableDevtools:this.options.enableDevtools}),this.emitter=mitt(),this.remoteFetcher=createFetchHelper(this.store,this.options.customFetcher),this.staticFetcher=createFetchHelper(this.store,(Rr,Pr)=>Pr)}batch(Tr){this.isBatching=!0;try{Tr(this),this.store.dispatch(batchActions({actions:this.batchQueue}))}catch(Ar){throw this.batchQueue=[],this.isBatching=!1,Ar}this.batchQueue=[],this.isBatching=!1}async asyncBatch(Tr){this.isBatching=!0;try{await Tr(this),this.store.dispatch(batchActions({actions:this.batchQueue}))}catch(Ar){throw this.batchQueue=[],this.isBatching=!1,Ar}this.batchQueue=[],this.isBatching=!1}modifyEntityField(Tr,Ar,Rr){this.dispatch(entityActions.modifyEntityField({id:Tr.id,type:Tr.type,key:Ar,value:Rr}))}dispatch(Tr){this.isBatching?this.batchQueue.push(Tr):this.store.dispatch(Tr)}serialize(Tr,Ar){return serialize(this.getState().iiif,Tr,Ar)}toPresentation2(Tr){return this.serialize(Tr,serializeConfigPresentation2)}toPresentation3(Tr){return this.serialize(Tr,serializeConfigPresentation3)}hydrate(Tr,Ar){return this.get(Tr,Ar,{skipSelfReturn:!1})}get(Tr,Ar,Rr={}){typeof Ar!="string"&&(Rr=Ar||{},Ar=void 0);const{skipSelfReturn:Pr=!0}=Rr||{};if(Array.isArray(Tr))return Tr.map(jr=>this.get(jr,Rr));const Dr=this.getState();if(typeof Tr=="string"){const jr=Ar||Dr.iiif.mapping[Tr];if(!jr)return Pr?null:{id:Tr,type:"unknown"};Tr={id:Tr,type:jr}}const Mr=Ar||Tr.type,Fr=Tr.id,zr=Dr.iiif.entities[Mr];if(!zr){const jr=Dr.iiif.requests[Fr];return jr&&jr.resourceUri!==Fr?this.get(jr.resourceUri,Rr):Pr?null:Tr}return zr[Tr.id]||(Pr?null:Tr)}select(Tr){return Tr(this.getState())}getStore(){return this.store}getState(){return this.store.getState()}loadManifest(Tr,Ar){const Rr=typeof Tr=="string"?Tr:Tr.id;return this.load(Rr,Ar)}loadCollection(Tr,Ar){const Rr=typeof Tr=="string"?Tr:Tr.id;return this.load(Rr,Ar)}load(Tr,Ar){const Rr=typeof Tr=="string"?Tr:Tr.id;return Ar?this.staticFetcher(Rr,Ar):this.remoteFetcher(Rr)}areInputsEqual(Tr,Ar){return areInputsEqual(Tr,Ar)}subscribe(Tr,Ar,Rr){typeof Rr>"u"&&(typeof Ar>"u"||Ar===!1||Ar===!0)&&(Rr=Ar,Ar=Tr,Tr=Dr=>Dr);let Pr=Rr?null:Tr(this.store.getState());return Rr||Ar(Pr,this),this.store.subscribe(()=>{const Dr=this.store.getState(),Mr=Tr(Dr);Pr!==Mr&&!areInputsEqual(Pr,Mr)&&Ar(Mr,this),Pr=Mr})}async ensureLoaded(Tr){const Ar=typeof Tr=="string"?Tr:Tr.id;this.requestStatus(Ar)||await this.load(Ar)}requestStatus(Tr){return this.select(Ar=>Ar.iiif.requests[Tr])}getResourceMeta(Tr,Ar){const Rr=this.getState().iiif.meta[Tr];if(Rr)return Ar?Rr[Ar]:Rr}setMetaValue([Tr,Ar,Rr],Pr){this.dispatch(typeof Pr=="function"?metaActions.setMetaValueDynamic({id:Tr,meta:Ar,key:Rr,updateValue:Pr}):metaActions.setMetaValue({id:Tr,meta:Ar,key:Rr,value:Pr}))}}function _extends$1(){return _extends$1=Object.assign?Object.assign.bind():function(_r){for(var Tr=1;Tr<arguments.length;Tr++){var Ar=arguments[Tr];for(var Rr in Ar)Object.prototype.hasOwnProperty.call(Ar,Rr)&&(_r[Rr]=Ar[Rr])}return _r},_extends$1.apply(this,arguments)}function $e42e1063c40fb3ef$export$b9ecd428b558ff10(_r,Tr,{checkForDefaultPrevented:Ar=!0}={}){return function(Pr){if(_r==null||_r(Pr),Ar===!1||!Pr.defaultPrevented)return Tr==null?void 0:Tr(Pr)}}function $c512c27ab02ef895$export$50c7b4e9d9f19c1(_r,Tr=[]){let Ar=[];function Rr(Dr,Mr){const Fr=reactExports.createContext(Mr),zr=Ar.length;Ar=[...Ar,Mr];function jr(Nr){const{scope:Lr,children:Ur,...Vr}=Nr,Wr=(Lr==null?void 0:Lr[_r][zr])||Fr,qr=reactExports.useMemo(()=>Vr,Object.values(Vr));return reactExports.createElement(Wr.Provider,{value:qr},Ur)}function Gr(Nr,Lr){const Ur=(Lr==null?void 0:Lr[_r][zr])||Fr,Vr=reactExports.useContext(Ur);if(Vr)return Vr;if(Mr!==void 0)return Mr;throw new Error(`\`${Nr}\` must be used within \`${Dr}\``)}return jr.displayName=Dr+"Provider",[jr,Gr]}const Pr=()=>{const Dr=Ar.map(Mr=>reactExports.createContext(Mr));return function(Fr){const zr=(Fr==null?void 0:Fr[_r])||Dr;return reactExports.useMemo(()=>({[`__scope${_r}`]:{...Fr,[_r]:zr}}),[Fr,zr])}};return Pr.scopeName=_r,[Rr,$c512c27ab02ef895$var$composeContextScopes(Pr,...Tr)]}function $c512c27ab02ef895$var$composeContextScopes(..._r){const Tr=_r[0];if(_r.length===1)return Tr;const Ar=()=>{const Rr=_r.map(Pr=>({useScope:Pr(),scopeName:Pr.scopeName}));return function(Dr){const Mr=Rr.reduce((Fr,{useScope:zr,scopeName:jr})=>{const Nr=zr(Dr)[`__scope${jr}`];return{...Fr,...Nr}},{});return reactExports.useMemo(()=>({[`__scope${Tr.scopeName}`]:Mr}),[Mr])}};return Ar.scopeName=Tr.scopeName,Ar}function $b1b2314f5f9a1d84$export$25bec8c6f54ee79a(_r){const Tr=reactExports.useRef(_r);return reactExports.useEffect(()=>{Tr.current=_r}),reactExports.useMemo(()=>(...Ar)=>{var Rr;return(Rr=Tr.current)===null||Rr===void 0?void 0:Rr.call(Tr,...Ar)},[])}function $71cd76cc60e0454e$export$6f32135080cb4c3({prop:_r,defaultProp:Tr,onChange:Ar=()=>{}}){const[Rr,Pr]=$71cd76cc60e0454e$var$useUncontrolledState({defaultProp:Tr,onChange:Ar}),Dr=_r!==void 0,Mr=Dr?_r:Rr,Fr=$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(Ar),zr=reactExports.useCallback(jr=>{if(Dr){const Nr=typeof jr=="function"?jr(_r):jr;Nr!==_r&&Fr(Nr)}else Pr(jr)},[Dr,_r,Pr,Fr]);return[Mr,zr]}function $71cd76cc60e0454e$var$useUncontrolledState({defaultProp:_r,onChange:Tr}){const Ar=reactExports.useState(_r),[Rr]=Ar,Pr=reactExports.useRef(Rr),Dr=$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(Tr);return reactExports.useEffect(()=>{Pr.current!==Rr&&(Dr(Rr),Pr.current=Rr)},[Rr,Pr,Dr]),Ar}const $9f79659886946c16$export$e5c5a5f917a5871c=globalThis!=null&&globalThis.document?reactExports.useLayoutEffect:()=>{};function $6ed0406888f73fc4$var$setRef(_r,Tr){typeof _r=="function"?_r(Tr):_r!=null&&(_r.current=Tr)}function $6ed0406888f73fc4$export$43e446d32b3d21af(..._r){return Tr=>_r.forEach(Ar=>$6ed0406888f73fc4$var$setRef(Ar,Tr))}function $6ed0406888f73fc4$export$c7b2cbe3552a0d05(..._r){return reactExports.useCallback($6ed0406888f73fc4$export$43e446d32b3d21af(..._r),_r)}const $5e63c961fc1ce211$export$8c6ed5c666ac1360=reactExports.forwardRef((_r,Tr)=>{const{children:Ar,...Rr}=_r,Pr=reactExports.Children.toArray(Ar),Dr=Pr.find($5e63c961fc1ce211$var$isSlottable);if(Dr){const Mr=Dr.props.children,Fr=Pr.map(zr=>zr===Dr?reactExports.Children.count(Mr)>1?reactExports.Children.only(null):reactExports.isValidElement(Mr)?Mr.props.children:null:zr);return reactExports.createElement($5e63c961fc1ce211$var$SlotClone,_extends$1({},Rr,{ref:Tr}),reactExports.isValidElement(Mr)?reactExports.cloneElement(Mr,void 0,Fr):null)}return reactExports.createElement($5e63c961fc1ce211$var$SlotClone,_extends$1({},Rr,{ref:Tr}),Ar)});$5e63c961fc1ce211$export$8c6ed5c666ac1360.displayName="Slot";const $5e63c961fc1ce211$var$SlotClone=reactExports.forwardRef((_r,Tr)=>{const{children:Ar,...Rr}=_r;return reactExports.isValidElement(Ar)?reactExports.cloneElement(Ar,{...$5e63c961fc1ce211$var$mergeProps(Rr,Ar.props),ref:Tr?$6ed0406888f73fc4$export$43e446d32b3d21af(Tr,Ar.ref):Ar.ref}):reactExports.Children.count(Ar)>1?reactExports.Children.only(null):null});$5e63c961fc1ce211$var$SlotClone.displayName="SlotClone";const $5e63c961fc1ce211$export$d9f1ccf0bdb05d45=({children:_r})=>reactExports.createElement(reactExports.Fragment,null,_r);function $5e63c961fc1ce211$var$isSlottable(_r){return reactExports.isValidElement(_r)&&_r.type===$5e63c961fc1ce211$export$d9f1ccf0bdb05d45}function $5e63c961fc1ce211$var$mergeProps(_r,Tr){const Ar={...Tr};for(const Rr in Tr){const Pr=_r[Rr],Dr=Tr[Rr];/^on[A-Z]/.test(Rr)?Pr&&Dr?Ar[Rr]=(...Fr)=>{Dr(...Fr),Pr(...Fr)}:Pr&&(Ar[Rr]=Pr):Rr==="style"?Ar[Rr]={...Pr,...Dr}:Rr==="className"&&(Ar[Rr]=[Pr,Dr].filter(Boolean).join(" "))}return{..._r,...Ar}}const $8927f6f2acc4f386$var$NODES=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],$8927f6f2acc4f386$export$250ffa63cdc0d034=$8927f6f2acc4f386$var$NODES.reduce((_r,Tr)=>{const Ar=reactExports.forwardRef((Rr,Pr)=>{const{asChild:Dr,...Mr}=Rr,Fr=Dr?$5e63c961fc1ce211$export$8c6ed5c666ac1360:Tr;return reactExports.useEffect(()=>{window[Symbol.for("radix-ui")]=!0},[]),reactExports.createElement(Fr,_extends$1({},Mr,{ref:Pr}))});return Ar.displayName=`Primitive.${Tr}`,{..._r,[Tr]:Ar}},{});function $8927f6f2acc4f386$export$6d1a0317bde7de7f(_r,Tr){_r&&reactDomExports.flushSync(()=>_r.dispatchEvent(Tr))}function $fe963b355347cc68$export$3e6543de14f8614f(_r,Tr){return reactExports.useReducer((Ar,Rr)=>{const Pr=Tr[Ar][Rr];return Pr??Ar},_r)}const $921a889cee6df7e8$export$99c2b779aa4e8b8b=_r=>{const{present:Tr,children:Ar}=_r,Rr=$921a889cee6df7e8$var$usePresence(Tr),Pr=typeof Ar=="function"?Ar({present:Rr.isPresent}):reactExports.Children.only(Ar),Dr=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(Rr.ref,Pr.ref);return typeof Ar=="function"||Rr.isPresent?reactExports.cloneElement(Pr,{ref:Dr}):null};$921a889cee6df7e8$export$99c2b779aa4e8b8b.displayName="Presence";function $921a889cee6df7e8$var$usePresence(_r){const[Tr,Ar]=reactExports.useState(),Rr=reactExports.useRef({}),Pr=reactExports.useRef(_r),Dr=reactExports.useRef("none"),Mr=_r?"mounted":"unmounted",[Fr,zr]=$fe963b355347cc68$export$3e6543de14f8614f(Mr,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return reactExports.useEffect(()=>{const jr=$921a889cee6df7e8$var$getAnimationName(Rr.current);Dr.current=Fr==="mounted"?jr:"none"},[Fr]),$9f79659886946c16$export$e5c5a5f917a5871c(()=>{const jr=Rr.current,Gr=Pr.current;if(Gr!==_r){const Lr=Dr.current,Ur=$921a889cee6df7e8$var$getAnimationName(jr);_r?zr("MOUNT"):Ur==="none"||(jr==null?void 0:jr.display)==="none"?zr("UNMOUNT"):zr(Gr&&Lr!==Ur?"ANIMATION_OUT":"UNMOUNT"),Pr.current=_r}},[_r,zr]),$9f79659886946c16$export$e5c5a5f917a5871c(()=>{if(Tr){const jr=Nr=>{const Ur=$921a889cee6df7e8$var$getAnimationName(Rr.current).includes(Nr.animationName);Nr.target===Tr&&Ur&&reactDomExports.flushSync(()=>zr("ANIMATION_END"))},Gr=Nr=>{Nr.target===Tr&&(Dr.current=$921a889cee6df7e8$var$getAnimationName(Rr.current))};return Tr.addEventListener("animationstart",Gr),Tr.addEventListener("animationcancel",jr),Tr.addEventListener("animationend",jr),()=>{Tr.removeEventListener("animationstart",Gr),Tr.removeEventListener("animationcancel",jr),Tr.removeEventListener("animationend",jr)}}else zr("ANIMATION_END")},[Tr,zr]),{isPresent:["mounted","unmountSuspended"].includes(Fr),ref:reactExports.useCallback(jr=>{jr&&(Rr.current=getComputedStyle(jr)),Ar(jr)},[])}}function $921a889cee6df7e8$var$getAnimationName(_r){return(_r==null?void 0:_r.animationName)||"none"}const $1746a345f3d73bb7$var$useReactId=$2AODx$react["useId".toString()]||(()=>{});let $1746a345f3d73bb7$var$count=0;function $1746a345f3d73bb7$export$f680877a34711e37(_r){const[Tr,Ar]=reactExports.useState($1746a345f3d73bb7$var$useReactId());return $9f79659886946c16$export$e5c5a5f917a5871c(()=>{_r||Ar(Rr=>Rr??String($1746a345f3d73bb7$var$count++))},[_r]),_r||(Tr?`radix-${Tr}`:"")}const $409067139f391064$var$COLLAPSIBLE_NAME="Collapsible",[$409067139f391064$var$createCollapsibleContext,$409067139f391064$export$952b32dcbe73087a]=$c512c27ab02ef895$export$50c7b4e9d9f19c1($409067139f391064$var$COLLAPSIBLE_NAME),[$409067139f391064$var$CollapsibleProvider,$409067139f391064$var$useCollapsibleContext]=$409067139f391064$var$createCollapsibleContext($409067139f391064$var$COLLAPSIBLE_NAME),$409067139f391064$export$6eb0f7ddcda6131f=reactExports.forwardRef((_r,Tr)=>{const{__scopeCollapsible:Ar,open:Rr,defaultOpen:Pr,disabled:Dr,onOpenChange:Mr,...Fr}=_r,[zr=!1,jr]=$71cd76cc60e0454e$export$6f32135080cb4c3({prop:Rr,defaultProp:Pr,onChange:Mr});return reactExports.createElement($409067139f391064$var$CollapsibleProvider,{scope:Ar,disabled:Dr,contentId:$1746a345f3d73bb7$export$f680877a34711e37(),open:zr,onOpenToggle:reactExports.useCallback(()=>jr(Gr=>!Gr),[jr])},reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.div,_extends$1({"data-state":$409067139f391064$var$getState(zr),"data-disabled":Dr?"":void 0},Fr,{ref:Tr})))}),$409067139f391064$var$TRIGGER_NAME="CollapsibleTrigger",$409067139f391064$export$c135dce7b15bbbdc=reactExports.forwardRef((_r,Tr)=>{const{__scopeCollapsible:Ar,...Rr}=_r,Pr=$409067139f391064$var$useCollapsibleContext($409067139f391064$var$TRIGGER_NAME,Ar);return reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.button,_extends$1({type:"button","aria-controls":Pr.contentId,"aria-expanded":Pr.open||!1,"data-state":$409067139f391064$var$getState(Pr.open),"data-disabled":Pr.disabled?"":void 0,disabled:Pr.disabled},Rr,{ref:Tr,onClick:$e42e1063c40fb3ef$export$b9ecd428b558ff10(_r.onClick,Pr.onOpenToggle)}))}),$409067139f391064$var$CONTENT_NAME="CollapsibleContent",$409067139f391064$export$aadde00976f34151=reactExports.forwardRef((_r,Tr)=>{const{forceMount:Ar,...Rr}=_r,Pr=$409067139f391064$var$useCollapsibleContext($409067139f391064$var$CONTENT_NAME,_r.__scopeCollapsible);return reactExports.createElement($921a889cee6df7e8$export$99c2b779aa4e8b8b,{present:Ar||Pr.open},({present:Dr})=>reactExports.createElement($409067139f391064$var$CollapsibleContentImpl,_extends$1({},Rr,{ref:Tr,present:Dr})))}),$409067139f391064$var$CollapsibleContentImpl=reactExports.forwardRef((_r,Tr)=>{const{__scopeCollapsible:Ar,present:Rr,children:Pr,...Dr}=_r,Mr=$409067139f391064$var$useCollapsibleContext($409067139f391064$var$CONTENT_NAME,Ar),[Fr,zr]=reactExports.useState(Rr),jr=reactExports.useRef(null),Gr=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(Tr,jr),Nr=reactExports.useRef(0),Lr=Nr.current,Ur=reactExports.useRef(0),Vr=Ur.current,Wr=Mr.open||Fr,qr=reactExports.useRef(Wr),Kr=reactExports.useRef();return reactExports.useEffect(()=>{const Xr=requestAnimationFrame(()=>qr.current=!1);return()=>cancelAnimationFrame(Xr)},[]),$9f79659886946c16$export$e5c5a5f917a5871c(()=>{const Xr=jr.current;if(Xr){Kr.current=Kr.current||{transitionDuration:Xr.style.transitionDuration,animationName:Xr.style.animationName},Xr.style.transitionDuration="0s",Xr.style.animationName="none";const Zr=Xr.getBoundingClientRect();Nr.current=Zr.height,Ur.current=Zr.width,qr.current||(Xr.style.transitionDuration=Kr.current.transitionDuration,Xr.style.animationName=Kr.current.animationName),zr(Rr)}},[Mr.open,Rr]),reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.div,_extends$1({"data-state":$409067139f391064$var$getState(Mr.open),"data-disabled":Mr.disabled?"":void 0,id:Mr.contentId,hidden:!Wr},Dr,{ref:Gr,style:{"--radix-collapsible-content-height":Lr?`${Lr}px`:void 0,"--radix-collapsible-content-width":Vr?`${Vr}px`:void 0,..._r.style}}),Wr&&Pr)});function $409067139f391064$var$getState(_r){return _r?"open":"closed"}const $409067139f391064$export$be92b6f5f03c0fe9=$409067139f391064$export$6eb0f7ddcda6131f,$409067139f391064$export$41fb9f06171c75f4=$409067139f391064$export$c135dce7b15bbbdc,$409067139f391064$export$7c6e2c02157bb7d2=$409067139f391064$export$aadde00976f34151,ErrorBoundaryContext=reactExports.createContext(null),initialState={didCatch:!1,error:null};class ErrorBoundary extends reactExports.Component{constructor(Tr){super(Tr),this.resetErrorBoundary=this.resetErrorBoundary.bind(this),this.state=initialState}static getDerivedStateFromError(Tr){return{didCatch:!0,error:Tr}}resetErrorBoundary(){const{error:Tr}=this.state;if(Tr!==null){for(var Ar,Rr,Pr=arguments.length,Dr=new Array(Pr),Mr=0;Mr<Pr;Mr++)Dr[Mr]=arguments[Mr];(Ar=(Rr=this.props).onReset)===null||Ar===void 0||Ar.call(Rr,{args:Dr,reason:"imperative-api"}),this.setState(initialState)}}componentDidCatch(Tr,Ar){var Rr,Pr;(Rr=(Pr=this.props).onError)===null||Rr===void 0||Rr.call(Pr,Tr,Ar)}componentDidUpdate(Tr,Ar){const{didCatch:Rr}=this.state,{resetKeys:Pr}=this.props;if(Rr&&Ar.error!==null&&hasArrayChanged(Tr.resetKeys,Pr)){var Dr,Mr;(Dr=(Mr=this.props).onReset)===null||Dr===void 0||Dr.call(Mr,{next:Pr,prev:Tr.resetKeys,reason:"keys"}),this.setState(initialState)}}render(){const{children:Tr,fallbackRender:Ar,FallbackComponent:Rr,fallback:Pr}=this.props,{didCatch:Dr,error:Mr}=this.state;let Fr=Tr;if(Dr){const zr={error:Mr,resetErrorBoundary:this.resetErrorBoundary};if(reactExports.isValidElement(Pr))Fr=Pr;else if(typeof Ar=="function")Fr=Ar(zr);else if(Rr)Fr=reactExports.createElement(Rr,zr);else throw Mr}return reactExports.createElement(ErrorBoundaryContext.Provider,{value:{didCatch:Dr,error:Mr,resetErrorBoundary:this.resetErrorBoundary}},Fr)}}function hasArrayChanged(){let _r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],Tr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return _r.length!==Tr.length||_r.some((Ar,Rr)=>!Object.is(Ar,Tr[Rr]))}var e="colors",t="sizes",r="space",n={gap:r,gridGap:r,columnGap:r,gridColumnGap:r,rowGap:r,gridRowGap:r,inset:r,insetBlock:r,insetBlockEnd:r,insetBlockStart:r,insetInline:r,insetInlineEnd:r,insetInlineStart:r,margin:r,marginTop:r,marginRight:r,marginBottom:r,marginLeft:r,marginBlock:r,marginBlockEnd:r,marginBlockStart:r,marginInline:r,marginInlineEnd:r,marginInlineStart:r,padding:r,paddingTop:r,paddingRight:r,paddingBottom:r,paddingLeft:r,paddingBlock:r,paddingBlockEnd:r,paddingBlockStart:r,paddingInline:r,paddingInlineEnd:r,paddingInlineStart:r,top:r,right:r,bottom:r,left:r,scrollMargin:r,scrollMarginTop:r,scrollMarginRight:r,scrollMarginBottom:r,scrollMarginLeft:r,scrollMarginX:r,scrollMarginY:r,scrollMarginBlock:r,scrollMarginBlockEnd:r,scrollMarginBlockStart:r,scrollMarginInline:r,scrollMarginInlineEnd:r,scrollMarginInlineStart:r,scrollPadding:r,scrollPaddingTop:r,scrollPaddingRight:r,scrollPaddingBottom:r,scrollPaddingLeft:r,scrollPaddingX:r,scrollPaddingY:r,scrollPaddingBlock:r,scrollPaddingBlockEnd:r,scrollPaddingBlockStart:r,scrollPaddingInline:r,scrollPaddingInlineEnd:r,scrollPaddingInlineStart:r,fontSize:"fontSizes",background:e,backgroundColor:e,backgroundImage:e,borderImage:e,border:e,borderBlock:e,borderBlockEnd:e,borderBlockStart:e,borderBottom:e,borderBottomColor:e,borderColor:e,borderInline:e,borderInlineEnd:e,borderInlineStart:e,borderLeft:e,borderLeftColor:e,borderRight:e,borderRightColor:e,borderTop:e,borderTopColor:e,caretColor:e,color:e,columnRuleColor:e,fill:e,outline:e,outlineColor:e,stroke:e,textDecorationColor:e,fontFamily:"fonts",fontWeight:"fontWeights",lineHeight:"lineHeights",letterSpacing:"letterSpacings",blockSize:t,minBlockSize:t,maxBlockSize:t,inlineSize:t,minInlineSize:t,maxInlineSize:t,width:t,minWidth:t,maxWidth:t,height:t,minHeight:t,maxHeight:t,flexBasis:t,gridTemplateColumns:t,gridTemplateRows:t,borderWidth:"borderWidths",borderTopWidth:"borderWidths",borderRightWidth:"borderWidths",borderBottomWidth:"borderWidths",borderLeftWidth:"borderWidths",borderStyle:"borderStyles",borderTopStyle:"borderStyles",borderRightStyle:"borderStyles",borderBottomStyle:"borderStyles",borderLeftStyle:"borderStyles",borderRadius:"radii",borderTopLeftRadius:"radii",borderTopRightRadius:"radii",borderBottomRightRadius:"radii",borderBottomLeftRadius:"radii",boxShadow:"shadows",textShadow:"shadows",transition:"transitions",zIndex:"zIndices"},i=(_r,Tr)=>typeof Tr=="function"?{"()":Function.prototype.toString.call(Tr)}:Tr,o=()=>{const _r=Object.create(null);return(Tr,Ar,...Rr)=>{const Pr=(Dr=>JSON.stringify(Dr,i))(Tr);return Pr in _r?_r[Pr]:_r[Pr]=Ar(Tr,...Rr)}},l=Symbol.for("sxs.internal"),s=(_r,Tr)=>Object.defineProperties(_r,Object.getOwnPropertyDescriptors(Tr)),a=_r=>{for(const Tr in _r)return!0;return!1},{hasOwnProperty:c}=Object.prototype,d$1=_r=>_r.includes("-")?_r:_r.replace(/[A-Z]/g,Tr=>"-"+Tr.toLowerCase()),g=/\s+(?![^()]*\))/,p=_r=>Tr=>_r(...typeof Tr=="string"?String(Tr).split(g):[Tr]),u={appearance:_r=>({WebkitAppearance:_r,appearance:_r}),backfaceVisibility:_r=>({WebkitBackfaceVisibility:_r,backfaceVisibility:_r}),backdropFilter:_r=>({WebkitBackdropFilter:_r,backdropFilter:_r}),backgroundClip:_r=>({WebkitBackgroundClip:_r,backgroundClip:_r}),boxDecorationBreak:_r=>({WebkitBoxDecorationBreak:_r,boxDecorationBreak:_r}),clipPath:_r=>({WebkitClipPath:_r,clipPath:_r}),content:_r=>({content:_r.includes('"')||_r.includes("'")||/^([A-Za-z]+\([^]*|[^]*-quote|inherit|initial|none|normal|revert|unset)$/.test(_r)?_r:`"${_r}"`}),hyphens:_r=>({WebkitHyphens:_r,hyphens:_r}),maskImage:_r=>({WebkitMaskImage:_r,maskImage:_r}),maskSize:_r=>({WebkitMaskSize:_r,maskSize:_r}),tabSize:_r=>({MozTabSize:_r,tabSize:_r}),textSizeAdjust:_r=>({WebkitTextSizeAdjust:_r,textSizeAdjust:_r}),userSelect:_r=>({WebkitUserSelect:_r,userSelect:_r}),marginBlock:p((_r,Tr)=>({marginBlockStart:_r,marginBlockEnd:Tr||_r})),marginInline:p((_r,Tr)=>({marginInlineStart:_r,marginInlineEnd:Tr||_r})),maxSize:p((_r,Tr)=>({maxBlockSize:_r,maxInlineSize:Tr||_r})),minSize:p((_r,Tr)=>({minBlockSize:_r,minInlineSize:Tr||_r})),paddingBlock:p((_r,Tr)=>({paddingBlockStart:_r,paddingBlockEnd:Tr||_r})),paddingInline:p((_r,Tr)=>({paddingInlineStart:_r,paddingInlineEnd:Tr||_r}))},h=/([\d.]+)([^]*)/,f=(_r,Tr)=>_r.length?_r.reduce((Ar,Rr)=>(Ar.push(...Tr.map(Pr=>Pr.includes("&")?Pr.replace(/&/g,/[ +>|~]/.test(Rr)&&/&.*&/.test(Pr)?`:is(${Rr})`:Rr):Rr+" "+Pr)),Ar),[]):Tr,m=(_r,Tr)=>_r in b&&typeof Tr=="string"?Tr.replace(/^((?:[^]*[^\w-])?)(fit-content|stretch)((?:[^\w-][^]*)?)$/,(Ar,Rr,Pr,Dr)=>Rr+(Pr==="stretch"?`-moz-available${Dr};${d$1(_r)}:${Rr}-webkit-fill-available`:`-moz-fit-content${Dr};${d$1(_r)}:${Rr}fit-content`)+Dr):String(Tr),b={blockSize:1,height:1,inlineSize:1,maxBlockSize:1,maxHeight:1,maxInlineSize:1,maxWidth:1,minBlockSize:1,minHeight:1,minInlineSize:1,minWidth:1,width:1},S$1=_r=>_r?_r+"-":"",k$1=(_r,Tr,Ar)=>_r.replace(/([+-])?((?:\d+(?:\.\d*)?|\.\d+)(?:[Ee][+-]?\d+)?)?(\$|--)([$\w-]+)/g,(Rr,Pr,Dr,Mr,Fr)=>Mr=="$"==!!Dr?Rr:(Pr||Mr=="--"?"calc(":"")+"var(--"+(Mr==="$"?S$1(Tr)+(Fr.includes("$")?"":S$1(Ar))+Fr.replace(/\$/g,"-"):Fr)+")"+(Pr||Mr=="--"?"*"+(Pr||"")+(Dr||"1")+")":"")),y=/\s*,\s*(?![^()]*\))/,B$1=Object.prototype.toString,$=(_r,Tr,Ar,Rr,Pr)=>{let Dr,Mr,Fr;const zr=(jr,Gr,Nr)=>{let Lr,Ur;const Vr=Wr=>{for(Lr in Wr){const Xr=Lr.charCodeAt(0)===64,Zr=Xr&&Array.isArray(Wr[Lr])?Wr[Lr]:[Wr[Lr]];for(Ur of Zr){const _i=/[A-Z]/.test(Kr=Lr)?Kr:Kr.replace(/-[^]/g,es=>es[1].toUpperCase()),Jr=typeof Ur=="object"&&Ur&&Ur.toString===B$1&&(!Rr.utils[_i]||!Gr.length);if(_i in Rr.utils&&!Jr){const es=Rr.utils[_i];if(es!==Mr){Mr=es,Vr(es(Ur)),Mr=null;continue}}else if(_i in u){const es=u[_i];if(es!==Fr){Fr=es,Vr(es(Ur)),Fr=null;continue}}if(Xr&&(qr=Lr.slice(1)in Rr.media?"@media "+Rr.media[Lr.slice(1)]:Lr,Lr=qr.replace(/\(\s*([\w-]+)\s*(=|<|<=|>|>=)\s*([\w-]+)\s*(?:(<|<=|>|>=)\s*([\w-]+)\s*)?\)/g,(es,ts,is,rs,as,ls)=>{const fs=h.test(ts),Ts=.0625*(fs?-1:1),[$s,xs]=fs?[rs,ts]:[ts,rs];return"("+(is[0]==="="?"":is[0]===">"===fs?"max-":"min-")+$s+":"+(is[0]!=="="&&is.length===1?xs.replace(h,(ys,ps,vs)=>Number(ps)+Ts*(is===">"?1:-1)+vs):xs)+(as?") and ("+(as[0]===">"?"min-":"max-")+$s+":"+(as.length===1?ls.replace(h,(ys,ps,vs)=>Number(ps)+Ts*(as===">"?-1:1)+vs):ls):"")+")"})),Jr){const es=Xr?Nr.concat(Lr):[...Nr],ts=Xr?[...Gr]:f(Gr,Lr.split(y));Dr!==void 0&&Pr(x$1(...Dr)),Dr=void 0,zr(Ur,ts,es)}else Dr===void 0&&(Dr=[[],Gr,Nr]),Lr=Xr||Lr.charCodeAt(0)!==36?Lr:`--${S$1(Rr.prefix)}${Lr.slice(1).replace(/\$/g,"-")}`,Ur=Jr?Ur:typeof Ur=="number"?Ur&&_i in I?String(Ur)+"px":String(Ur):k$1(m(_i,Ur??""),Rr.prefix,Rr.themeMap[_i]),Dr[0].push(`${Xr?`${Lr} `:`${d$1(Lr)}:`}${Ur}`)}}var qr,Kr};Vr(jr),Dr!==void 0&&Pr(x$1(...Dr)),Dr=void 0};zr(_r,Tr,Ar)},x$1=(_r,Tr,Ar)=>`${Ar.map(Rr=>`${Rr}{`).join("")}${Tr.length?`${Tr.join(",")}{`:""}${_r.join(";")}${Tr.length?"}":""}${Array(Ar.length?Ar.length+1:0).join("}")}`,I={animationDelay:1,animationDuration:1,backgroundSize:1,blockSize:1,border:1,borderBlock:1,borderBlockEnd:1,borderBlockEndWidth:1,borderBlockStart:1,borderBlockStartWidth:1,borderBlockWidth:1,borderBottom:1,borderBottomLeftRadius:1,borderBottomRightRadius:1,borderBottomWidth:1,borderEndEndRadius:1,borderEndStartRadius:1,borderInlineEnd:1,borderInlineEndWidth:1,borderInlineStart:1,borderInlineStartWidth:1,borderInlineWidth:1,borderLeft:1,borderLeftWidth:1,borderRadius:1,borderRight:1,borderRightWidth:1,borderSpacing:1,borderStartEndRadius:1,borderStartStartRadius:1,borderTop:1,borderTopLeftRadius:1,borderTopRightRadius:1,borderTopWidth:1,borderWidth:1,bottom:1,columnGap:1,columnRule:1,columnRuleWidth:1,columnWidth:1,containIntrinsicSize:1,flexBasis:1,fontSize:1,gap:1,gridAutoColumns:1,gridAutoRows:1,gridTemplateColumns:1,gridTemplateRows:1,height:1,inlineSize:1,inset:1,insetBlock:1,insetBlockEnd:1,insetBlockStart:1,insetInline:1,insetInlineEnd:1,insetInlineStart:1,left:1,letterSpacing:1,margin:1,marginBlock:1,marginBlockEnd:1,marginBlockStart:1,marginBottom:1,marginInline:1,marginInlineEnd:1,marginInlineStart:1,marginLeft:1,marginRight:1,marginTop:1,maxBlockSize:1,maxHeight:1,maxInlineSize:1,maxWidth:1,minBlockSize:1,minHeight:1,minInlineSize:1,minWidth:1,offsetDistance:1,offsetRotate:1,outline:1,outlineOffset:1,outlineWidth:1,overflowClipMargin:1,padding:1,paddingBlock:1,paddingBlockEnd:1,paddingBlockStart:1,paddingBottom:1,paddingInline:1,paddingInlineEnd:1,paddingInlineStart:1,paddingLeft:1,paddingRight:1,paddingTop:1,perspective:1,right:1,rowGap:1,scrollMargin:1,scrollMarginBlock:1,scrollMarginBlockEnd:1,scrollMarginBlockStart:1,scrollMarginBottom:1,scrollMarginInline:1,scrollMarginInlineEnd:1,scrollMarginInlineStart:1,scrollMarginLeft:1,scrollMarginRight:1,scrollMarginTop:1,scrollPadding:1,scrollPaddingBlock:1,scrollPaddingBlockEnd:1,scrollPaddingBlockStart:1,scrollPaddingBottom:1,scrollPaddingInline:1,scrollPaddingInlineEnd:1,scrollPaddingInlineStart:1,scrollPaddingLeft:1,scrollPaddingRight:1,scrollPaddingTop:1,shapeMargin:1,textDecoration:1,textDecorationThickness:1,textIndent:1,textUnderlineOffset:1,top:1,transitionDelay:1,transitionDuration:1,verticalAlign:1,width:1,wordSpacing:1},R$1=_r=>String.fromCharCode(_r+(_r>25?39:97)),z$1=_r=>(Tr=>{let Ar,Rr="";for(Ar=Math.abs(Tr);Ar>52;Ar=Ar/52|0)Rr=R$1(Ar%52)+Rr;return R$1(Ar%52)+Rr})(((Tr,Ar)=>{let Rr=Ar.length;for(;Rr;)Tr=33*Tr^Ar.charCodeAt(--Rr);return Tr})(5381,JSON.stringify(_r))>>>0),W$1=["themed","global","styled","onevar","resonevar","allvar","inline"],j$1=_r=>{if(_r.href&&!_r.href.startsWith(location.origin))return!1;try{return!!_r.cssRules}catch{return!1}},E=_r=>{let Tr;const Ar=()=>{const{cssRules:Pr}=Tr.sheet;return[].map.call(Pr,(Dr,Mr)=>{const{cssText:Fr}=Dr;let zr="";if(Fr.startsWith("--sxs"))return"";if(Pr[Mr-1]&&(zr=Pr[Mr-1].cssText).startsWith("--sxs")){if(!Dr.cssRules.length)return"";for(const jr in Tr.rules)if(Tr.rules[jr].group===Dr)return`--sxs{--sxs:${[...Tr.rules[jr].cache].join(" ")}}${Fr}`;return Dr.cssRules.length?`${zr}${Fr}`:""}return Fr}).join("")},Rr=()=>{if(Tr){const{rules:Fr,sheet:zr}=Tr;if(!zr.deleteRule){for(;Object(Object(zr.cssRules)[0]).type===3;)zr.cssRules.splice(0,1);zr.cssRules=[]}for(const jr in Fr)delete Fr[jr]}const Pr=Object(_r).styleSheets||[];for(const Fr of Pr)if(j$1(Fr)){for(let zr=0,jr=Fr.cssRules;jr[zr];++zr){const Gr=Object(jr[zr]);if(Gr.type!==1)continue;const Nr=Object(jr[zr+1]);if(Nr.type!==4)continue;++zr;const{cssText:Lr}=Gr;if(!Lr.startsWith("--sxs"))continue;const Ur=Lr.slice(14,-3).trim().split(/\s+/),Vr=W$1[Ur[0]];Vr&&(Tr||(Tr={sheet:Fr,reset:Rr,rules:{},toString:Ar}),Tr.rules[Vr]={group:Nr,index:zr,cache:new Set(Ur)})}if(Tr)break}if(!Tr){const Fr=(zr,jr)=>({type:jr,cssRules:[],insertRule(Gr,Nr){this.cssRules.splice(Nr,0,Fr(Gr,{import:3,undefined:1}[(Gr.toLowerCase().match(/^@([a-z]+)/)||[])[1]]||4))},get cssText(){return zr==="@media{}"?`@media{${[].map.call(this.cssRules,Gr=>Gr.cssText).join("")}}`:zr}});Tr={sheet:_r?(_r.head||_r).appendChild(document.createElement("style")).sheet:Fr("","text/css"),rules:{},reset:Rr,toString:Ar}}const{sheet:Dr,rules:Mr}=Tr;for(let Fr=W$1.length-1;Fr>=0;--Fr){const zr=W$1[Fr];if(!Mr[zr]){const jr=W$1[Fr+1],Gr=Mr[jr]?Mr[jr].index:Dr.cssRules.length;Dr.insertRule("@media{}",Gr),Dr.insertRule(`--sxs{--sxs:${Fr}}`,Gr),Mr[zr]={group:Dr.cssRules[Gr+1],index:Gr,cache:new Set([Fr])}}v(Mr[zr])}};return Rr(),Tr},v=_r=>{const Tr=_r.group;let Ar=Tr.cssRules.length;_r.apply=Rr=>{try{Tr.insertRule(Rr,Ar),++Ar}catch{}}},T=Symbol(),w=o(),M$1=(_r,Tr)=>w(_r,()=>(...Ar)=>{let Rr={type:null,composers:new Set};for(const Pr of Ar)if(Pr!=null)if(Pr[l]){Rr.type==null&&(Rr.type=Pr[l].type);for(const Dr of Pr[l].composers)Rr.composers.add(Dr)}else Pr.constructor!==Object||Pr.$$typeof?Rr.type==null&&(Rr.type=Pr):Rr.composers.add(C(Pr,_r));return Rr.type==null&&(Rr.type="span"),Rr.composers.size||Rr.composers.add(["PJLV",{},[],[],{},[]]),P$1(_r,Rr,Tr)}),C=({variants:_r,compoundVariants:Tr,defaultVariants:Ar,...Rr},Pr)=>{const Dr=`${S$1(Pr.prefix)}c-${z$1(Rr)}`,Mr=[],Fr=[],zr=Object.create(null),jr=[];for(const Lr in Ar)zr[Lr]=String(Ar[Lr]);if(typeof _r=="object"&&_r)for(const Lr in _r){Gr=zr,Nr=Lr,c.call(Gr,Nr)||(zr[Lr]="undefined");const Ur=_r[Lr];for(const Vr in Ur){const Wr={[Lr]:String(Vr)};String(Vr)==="undefined"&&jr.push(Lr);const qr=Ur[Vr],Kr=[Wr,qr,!a(qr)];Mr.push(Kr)}}var Gr,Nr;if(typeof Tr=="object"&&Tr)for(const Lr of Tr){let{css:Ur,...Vr}=Lr;Ur=typeof Ur=="object"&&Ur||{};for(const qr in Vr)Vr[qr]=String(Vr[qr]);const Wr=[Vr,Ur,!a(Ur)];Fr.push(Wr)}return[Dr,Rr,Mr,Fr,zr,jr]},P$1=(_r,Tr,Ar)=>{const[Rr,Pr,Dr,Mr]=L(Tr.composers),Fr=typeof Tr.type=="function"||Tr.type.$$typeof?(Nr=>{function Lr(){for(let Ur=0;Ur<Lr[T].length;Ur++){const[Vr,Wr]=Lr[T][Ur];Nr.rules[Vr].apply(Wr)}return Lr[T]=[],null}return Lr[T]=[],Lr.rules={},W$1.forEach(Ur=>Lr.rules[Ur]={apply:Vr=>Lr[T].push([Ur,Vr])}),Lr})(Ar):null,zr=(Fr||Ar).rules,jr=`.${Rr}${Pr.length>1?`:where(.${Pr.slice(1).join(".")})`:""}`,Gr=Nr=>{Nr=typeof Nr=="object"&&Nr||A$1;const{css:Lr,...Ur}=Nr,Vr={};for(const Kr in Dr)if(delete Ur[Kr],Kr in Nr){let Xr=Nr[Kr];typeof Xr=="object"&&Xr?Vr[Kr]={"@initial":Dr[Kr],...Xr}:(Xr=String(Xr),Vr[Kr]=Xr!=="undefined"||Mr.has(Kr)?Xr:Dr[Kr])}else Vr[Kr]=Dr[Kr];const Wr=new Set([...Pr]);for(const[Kr,Xr,Zr,_i]of Tr.composers){Ar.rules.styled.cache.has(Kr)||(Ar.rules.styled.cache.add(Kr),$(Xr,[`.${Kr}`],[],_r,ts=>{zr.styled.apply(ts)}));const Jr=O(Zr,Vr,_r.media),es=O(_i,Vr,_r.media,!0);for(const ts of Jr)if(ts!==void 0)for(const[is,rs,as]of ts){const ls=`${Kr}-${z$1(rs)}-${is}`;Wr.add(ls);const fs=(as?Ar.rules.resonevar:Ar.rules.onevar).cache,Ts=as?zr.resonevar:zr.onevar;fs.has(ls)||(fs.add(ls),$(rs,[`.${ls}`],[],_r,$s=>{Ts.apply($s)}))}for(const ts of es)if(ts!==void 0)for(const[is,rs]of ts){const as=`${Kr}-${z$1(rs)}-${is}`;Wr.add(as),Ar.rules.allvar.cache.has(as)||(Ar.rules.allvar.cache.add(as),$(rs,[`.${as}`],[],_r,ls=>{zr.allvar.apply(ls)}))}}if(typeof Lr=="object"&&Lr){const Kr=`${Rr}-i${z$1(Lr)}-css`;Wr.add(Kr),Ar.rules.inline.cache.has(Kr)||(Ar.rules.inline.cache.add(Kr),$(Lr,[`.${Kr}`],[],_r,Xr=>{zr.inline.apply(Xr)}))}for(const Kr of String(Nr.className||"").trim().split(/\s+/))Kr&&Wr.add(Kr);const qr=Ur.className=[...Wr].join(" ");return{type:Tr.type,className:qr,selector:jr,props:Ur,toString:()=>qr,deferredInjector:Fr}};return s(Gr,{className:Rr,selector:jr,[l]:Tr,toString:()=>(Ar.rules.styled.cache.has(Rr)||Gr(),Rr)})},L=_r=>{let Tr="";const Ar=[],Rr={},Pr=[];for(const[Dr,,,,Mr,Fr]of _r){Tr===""&&(Tr=Dr),Ar.push(Dr),Pr.push(...Fr);for(const zr in Mr){const jr=Mr[zr];(Rr[zr]===void 0||jr!=="undefined"||Fr.includes(jr))&&(Rr[zr]=jr)}}return[Tr,Ar,Rr,new Set(Pr)]},O=(_r,Tr,Ar,Rr)=>{const Pr=[];e:for(let[Dr,Mr,Fr]of _r){if(Fr)continue;let zr,jr=0,Gr=!1;for(zr in Dr){const Nr=Dr[zr];let Lr=Tr[zr];if(Lr!==Nr){if(typeof Lr!="object"||!Lr)continue e;{let Ur,Vr,Wr=0;for(const qr in Lr){if(Nr===String(Lr[qr])){if(qr!=="@initial"){const Kr=qr.slice(1);(Vr=Vr||[]).push(Kr in Ar?Ar[Kr]:qr.replace(/^@media ?/,"")),Gr=!0}jr+=Wr,Ur=!0}++Wr}if(Vr&&Vr.length&&(Mr={["@media "+Vr.join(", ")]:Mr}),!Ur)continue e}}}(Pr[jr]=Pr[jr]||[]).push([Rr?"cv":`${zr}-${Dr[zr]}`,Mr,Gr])}return Pr},A$1={},N$1=o(),D=(_r,Tr)=>N$1(_r,()=>(...Ar)=>{const Rr=()=>{for(let Pr of Ar){Pr=typeof Pr=="object"&&Pr||{};let Dr=z$1(Pr);if(!Tr.rules.global.cache.has(Dr)){if(Tr.rules.global.cache.add(Dr),"@import"in Pr){let Mr=[].indexOf.call(Tr.sheet.cssRules,Tr.rules.themed.group)-1;for(let Fr of[].concat(Pr["@import"]))Fr=Fr.includes('"')||Fr.includes("'")?Fr:`"${Fr}"`,Tr.sheet.insertRule(`@import ${Fr};`,Mr++);delete Pr["@import"]}$(Pr,[],[],_r,Mr=>{Tr.rules.global.apply(Mr)})}}return""};return s(Rr,{toString:Rr})}),H$1=o(),V$1=(_r,Tr)=>H$1(_r,()=>Ar=>{const Rr=`${S$1(_r.prefix)}k-${z$1(Ar)}`,Pr=()=>{if(!Tr.rules.global.cache.has(Rr)){Tr.rules.global.cache.add(Rr);const Dr=[];$(Ar,[],[],_r,Fr=>Dr.push(Fr));const Mr=`@keyframes ${Rr}{${Dr.join("")}}`;Tr.rules.global.apply(Mr)}return Rr};return s(Pr,{get name(){return Pr()},toString:Pr})}),G$1=class{constructor(Tr,Ar,Rr,Pr){this.token=Tr==null?"":String(Tr),this.value=Ar==null?"":String(Ar),this.scale=Rr==null?"":String(Rr),this.prefix=Pr==null?"":String(Pr)}get computedValue(){return"var("+this.variable+")"}get variable(){return"--"+S$1(this.prefix)+S$1(this.scale)+this.token}toString(){return this.computedValue}},F$1=o(),J=(_r,Tr)=>F$1(_r,()=>(Ar,Rr)=>{Rr=typeof Ar=="object"&&Ar||Object(Rr);const Pr=`.${Ar=(Ar=typeof Ar=="string"?Ar:"")||`${S$1(_r.prefix)}t-${z$1(Rr)}`}`,Dr={},Mr=[];for(const zr in Rr){Dr[zr]={};for(const jr in Rr[zr]){const Gr=`--${S$1(_r.prefix)}${zr}-${jr}`,Nr=k$1(String(Rr[zr][jr]),_r.prefix,zr);Dr[zr][jr]=new G$1(jr,Nr,zr,_r.prefix),Mr.push(`${Gr}:${Nr}`)}}const Fr=()=>{if(Mr.length&&!Tr.rules.themed.cache.has(Ar)){Tr.rules.themed.cache.add(Ar);const zr=`${Rr===_r.theme?":root,":""}.${Ar}{${Mr.join(";")}}`;Tr.rules.themed.apply(zr)}return Ar};return{...Dr,get className(){return Fr()},selector:Pr,toString:Fr}}),U$1=o(),X$1,Y$1=o(),q$1=_r=>{const Tr=(Ar=>{let Rr=!1;const Pr=U$1(Ar,Dr=>{Rr=!0;const Mr="prefix"in(Dr=typeof Dr=="object"&&Dr||{})?String(Dr.prefix):"",Fr=typeof Dr.media=="object"&&Dr.media||{},zr=typeof Dr.root=="object"?Dr.root||null:globalThis.document||null,jr=typeof Dr.theme=="object"&&Dr.theme||{},Gr={prefix:Mr,media:Fr,theme:jr,themeMap:typeof Dr.themeMap=="object"&&Dr.themeMap||{...n},utils:typeof Dr.utils=="object"&&Dr.utils||{}},Nr=E(zr),Lr={css:M$1(Gr,Nr),globalCss:D(Gr,Nr),keyframes:V$1(Gr,Nr),createTheme:J(Gr,Nr),reset(){Nr.reset(),Lr.theme.toString()},theme:{},sheet:Nr,config:Gr,prefix:Mr,getCssText:Nr.toString,toString:Nr.toString};return String(Lr.theme=Lr.createTheme(jr)),Lr});return Rr||Pr.reset(),Pr})(_r);return Tr.styled=(({config:Ar,sheet:Rr})=>Y$1(Ar,()=>{const Pr=M$1(Ar,Rr);return(...Dr)=>{const Mr=Pr(...Dr),Fr=Mr[l].type,zr=React$1.forwardRef((jr,Gr)=>{const Nr=jr&&jr.as||Fr,{props:Lr,deferredInjector:Ur}=Mr(jr);return delete Lr.as,Lr.ref=Gr,Ur?React$1.createElement(React$1.Fragment,null,React$1.createElement(Nr,Lr),React$1.createElement(Ur,null)):React$1.createElement(Nr,Lr)});return zr.className=Mr.className,zr.displayName=`Styled.${Fr.displayName||Fr.name||Fr}`,zr.selector=Mr.selector,zr.toString=()=>Mr.selector,zr[l]=Mr[l],zr}}))(Tr),Tr},K$1=()=>X$1||(X$1=q$1()),Q$1=(..._r)=>K$1().createTheme(..._r);function $e02a7d9cb1dc128c$export$c74125a8e3af6bb2(_r){const Tr=_r+"CollectionProvider",[Ar,Rr]=$c512c27ab02ef895$export$50c7b4e9d9f19c1(Tr),[Pr,Dr]=Ar(Tr,{collectionRef:{current:null},itemMap:new Map}),Mr=Ur=>{const{scope:Vr,children:Wr}=Ur,qr=React$1.useRef(null),Kr=React$1.useRef(new Map).current;return React$1.createElement(Pr,{scope:Vr,itemMap:Kr,collectionRef:qr},Wr)},Fr=_r+"CollectionSlot",zr=React$1.forwardRef((Ur,Vr)=>{const{scope:Wr,children:qr}=Ur,Kr=Dr(Fr,Wr),Xr=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(Vr,Kr.collectionRef);return React$1.createElement($5e63c961fc1ce211$export$8c6ed5c666ac1360,{ref:Xr},qr)}),jr=_r+"CollectionItemSlot",Gr="data-radix-collection-item",Nr=React$1.forwardRef((Ur,Vr)=>{const{scope:Wr,children:qr,...Kr}=Ur,Xr=React$1.useRef(null),Zr=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(Vr,Xr),_i=Dr(jr,Wr);return React$1.useEffect(()=>(_i.itemMap.set(Xr,{ref:Xr,...Kr}),()=>void _i.itemMap.delete(Xr))),React$1.createElement($5e63c961fc1ce211$export$8c6ed5c666ac1360,{[Gr]:"",ref:Zr},qr)});function Lr(Ur){const Vr=Dr(_r+"CollectionConsumer",Ur);return React$1.useCallback(()=>{const qr=Vr.collectionRef.current;if(!qr)return[];const Kr=Array.from(qr.querySelectorAll(`[${Gr}]`));return Array.from(Vr.itemMap.values()).sort((_i,Jr)=>Kr.indexOf(_i.ref.current)-Kr.indexOf(Jr.ref.current))},[Vr.collectionRef,Vr.itemMap])}return[{Provider:Mr,Slot:zr,ItemSlot:Nr},Lr,Rr]}const $f631663db3294ace$var$DirectionContext=reactExports.createContext(void 0);function $f631663db3294ace$export$b39126d51d94e6f3(_r){const Tr=reactExports.useContext($f631663db3294ace$var$DirectionContext);return _r||Tr||"ltr"}const $d7bdfb9eb0fdf311$var$ENTRY_FOCUS="rovingFocusGroup.onEntryFocus",$d7bdfb9eb0fdf311$var$EVENT_OPTIONS={bubbles:!1,cancelable:!0},$d7bdfb9eb0fdf311$var$GROUP_NAME="RovingFocusGroup",[$d7bdfb9eb0fdf311$var$Collection,$d7bdfb9eb0fdf311$var$useCollection,$d7bdfb9eb0fdf311$var$createCollectionScope]=$e02a7d9cb1dc128c$export$c74125a8e3af6bb2($d7bdfb9eb0fdf311$var$GROUP_NAME),[$d7bdfb9eb0fdf311$var$createRovingFocusGroupContext,$d7bdfb9eb0fdf311$export$c7109489551a4f4]=$c512c27ab02ef895$export$50c7b4e9d9f19c1($d7bdfb9eb0fdf311$var$GROUP_NAME,[$d7bdfb9eb0fdf311$var$createCollectionScope]),[$d7bdfb9eb0fdf311$var$RovingFocusProvider,$d7bdfb9eb0fdf311$var$useRovingFocusContext]=$d7bdfb9eb0fdf311$var$createRovingFocusGroupContext($d7bdfb9eb0fdf311$var$GROUP_NAME),$d7bdfb9eb0fdf311$export$8699f7c8af148338=reactExports.forwardRef((_r,Tr)=>reactExports.createElement($d7bdfb9eb0fdf311$var$Collection.Provider,{scope:_r.__scopeRovingFocusGroup},reactExports.createElement($d7bdfb9eb0fdf311$var$Collection.Slot,{scope:_r.__scopeRovingFocusGroup},reactExports.createElement($d7bdfb9eb0fdf311$var$RovingFocusGroupImpl,_extends$1({},_r,{ref:Tr}))))),$d7bdfb9eb0fdf311$var$RovingFocusGroupImpl=reactExports.forwardRef((_r,Tr)=>{const{__scopeRovingFocusGroup:Ar,orientation:Rr,loop:Pr=!1,dir:Dr,currentTabStopId:Mr,defaultCurrentTabStopId:Fr,onCurrentTabStopIdChange:zr,onEntryFocus:jr,...Gr}=_r,Nr=reactExports.useRef(null),Lr=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(Tr,Nr),Ur=$f631663db3294ace$export$b39126d51d94e6f3(Dr),[Vr=null,Wr]=$71cd76cc60e0454e$export$6f32135080cb4c3({prop:Mr,defaultProp:Fr,onChange:zr}),[qr,Kr]=reactExports.useState(!1),Xr=$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(jr),Zr=$d7bdfb9eb0fdf311$var$useCollection(Ar),_i=reactExports.useRef(!1),[Jr,es]=reactExports.useState(0);return reactExports.useEffect(()=>{const ts=Nr.current;if(ts)return ts.addEventListener($d7bdfb9eb0fdf311$var$ENTRY_FOCUS,Xr),()=>ts.removeEventListener($d7bdfb9eb0fdf311$var$ENTRY_FOCUS,Xr)},[Xr]),reactExports.createElement($d7bdfb9eb0fdf311$var$RovingFocusProvider,{scope:Ar,orientation:Rr,dir:Ur,loop:Pr,currentTabStopId:Vr,onItemFocus:reactExports.useCallback(ts=>Wr(ts),[Wr]),onItemShiftTab:reactExports.useCallback(()=>Kr(!0),[]),onFocusableItemAdd:reactExports.useCallback(()=>es(ts=>ts+1),[]),onFocusableItemRemove:reactExports.useCallback(()=>es(ts=>ts-1),[])},reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.div,_extends$1({tabIndex:qr||Jr===0?-1:0,"data-orientation":Rr},Gr,{ref:Lr,style:{outline:"none",..._r.style},onMouseDown:$e42e1063c40fb3ef$export$b9ecd428b558ff10(_r.onMouseDown,()=>{_i.current=!0}),onFocus:$e42e1063c40fb3ef$export$b9ecd428b558ff10(_r.onFocus,ts=>{const is=!_i.current;if(ts.target===ts.currentTarget&&is&&!qr){const rs=new CustomEvent($d7bdfb9eb0fdf311$var$ENTRY_FOCUS,$d7bdfb9eb0fdf311$var$EVENT_OPTIONS);if(ts.currentTarget.dispatchEvent(rs),!rs.defaultPrevented){const as=Zr().filter(xs=>xs.focusable),ls=as.find(xs=>xs.active),fs=as.find(xs=>xs.id===Vr),$s=[ls,fs,...as].filter(Boolean).map(xs=>xs.ref.current);$d7bdfb9eb0fdf311$var$focusFirst($s)}}_i.current=!1}),onBlur:$e42e1063c40fb3ef$export$b9ecd428b558ff10(_r.onBlur,()=>Kr(!1))})))}),$d7bdfb9eb0fdf311$var$ITEM_NAME="RovingFocusGroupItem",$d7bdfb9eb0fdf311$export$ab9df7c53fe8454=reactExports.forwardRef((_r,Tr)=>{const{__scopeRovingFocusGroup:Ar,focusable:Rr=!0,active:Pr=!1,tabStopId:Dr,...Mr}=_r,Fr=$1746a345f3d73bb7$export$f680877a34711e37(),zr=Dr||Fr,jr=$d7bdfb9eb0fdf311$var$useRovingFocusContext($d7bdfb9eb0fdf311$var$ITEM_NAME,Ar),Gr=jr.currentTabStopId===zr,Nr=$d7bdfb9eb0fdf311$var$useCollection(Ar),{onFocusableItemAdd:Lr,onFocusableItemRemove:Ur}=jr;return reactExports.useEffect(()=>{if(Rr)return Lr(),()=>Ur()},[Rr,Lr,Ur]),reactExports.createElement($d7bdfb9eb0fdf311$var$Collection.ItemSlot,{scope:Ar,id:zr,focusable:Rr,active:Pr},reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.span,_extends$1({tabIndex:Gr?0:-1,"data-orientation":jr.orientation},Mr,{ref:Tr,onMouseDown:$e42e1063c40fb3ef$export$b9ecd428b558ff10(_r.onMouseDown,Vr=>{Rr?jr.onItemFocus(zr):Vr.preventDefault()}),onFocus:$e42e1063c40fb3ef$export$b9ecd428b558ff10(_r.onFocus,()=>jr.onItemFocus(zr)),onKeyDown:$e42e1063c40fb3ef$export$b9ecd428b558ff10(_r.onKeyDown,Vr=>{if(Vr.key==="Tab"&&Vr.shiftKey){jr.onItemShiftTab();return}if(Vr.target!==Vr.currentTarget)return;const Wr=$d7bdfb9eb0fdf311$var$getFocusIntent(Vr,jr.orientation,jr.dir);if(Wr!==void 0){Vr.preventDefault();let Kr=Nr().filter(Xr=>Xr.focusable).map(Xr=>Xr.ref.current);if(Wr==="last")Kr.reverse();else if(Wr==="prev"||Wr==="next"){Wr==="prev"&&Kr.reverse();const Xr=Kr.indexOf(Vr.currentTarget);Kr=jr.loop?$d7bdfb9eb0fdf311$var$wrapArray(Kr,Xr+1):Kr.slice(Xr+1)}setTimeout(()=>$d7bdfb9eb0fdf311$var$focusFirst(Kr))}})})))}),$d7bdfb9eb0fdf311$var$MAP_KEY_TO_FOCUS_INTENT={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function $d7bdfb9eb0fdf311$var$getDirectionAwareKey(_r,Tr){return Tr!=="rtl"?_r:_r==="ArrowLeft"?"ArrowRight":_r==="ArrowRight"?"ArrowLeft":_r}function $d7bdfb9eb0fdf311$var$getFocusIntent(_r,Tr,Ar){const Rr=$d7bdfb9eb0fdf311$var$getDirectionAwareKey(_r.key,Ar);if(!(Tr==="vertical"&&["ArrowLeft","ArrowRight"].includes(Rr))&&!(Tr==="horizontal"&&["ArrowUp","ArrowDown"].includes(Rr)))return $d7bdfb9eb0fdf311$var$MAP_KEY_TO_FOCUS_INTENT[Rr]}function $d7bdfb9eb0fdf311$var$focusFirst(_r){const Tr=document.activeElement;for(const Ar of _r)if(Ar===Tr||(Ar.focus(),document.activeElement!==Tr))return}function $d7bdfb9eb0fdf311$var$wrapArray(_r,Tr){return _r.map((Ar,Rr)=>_r[(Tr+Rr)%_r.length])}const $d7bdfb9eb0fdf311$export$be92b6f5f03c0fe9=$d7bdfb9eb0fdf311$export$8699f7c8af148338,$d7bdfb9eb0fdf311$export$6d08773d2e66f8f2=$d7bdfb9eb0fdf311$export$ab9df7c53fe8454,$69cb30bb0017df05$var$TABS_NAME="Tabs",[$69cb30bb0017df05$var$createTabsContext,$69cb30bb0017df05$export$355f5bd209d7b13a]=$c512c27ab02ef895$export$50c7b4e9d9f19c1($69cb30bb0017df05$var$TABS_NAME,[$d7bdfb9eb0fdf311$export$c7109489551a4f4]),$69cb30bb0017df05$var$useRovingFocusGroupScope=$d7bdfb9eb0fdf311$export$c7109489551a4f4(),[$69cb30bb0017df05$var$TabsProvider,$69cb30bb0017df05$var$useTabsContext]=$69cb30bb0017df05$var$createTabsContext($69cb30bb0017df05$var$TABS_NAME),$69cb30bb0017df05$export$b2539bed5023c21c=reactExports.forwardRef((_r,Tr)=>{const{__scopeTabs:Ar,value:Rr,onValueChange:Pr,defaultValue:Dr,orientation:Mr="horizontal",dir:Fr,activationMode:zr="automatic",...jr}=_r,Gr=$f631663db3294ace$export$b39126d51d94e6f3(Fr),[Nr,Lr]=$71cd76cc60e0454e$export$6f32135080cb4c3({prop:Rr,onChange:Pr,defaultProp:Dr});return reactExports.createElement($69cb30bb0017df05$var$TabsProvider,{scope:Ar,baseId:$1746a345f3d73bb7$export$f680877a34711e37(),value:Nr,onValueChange:Lr,orientation:Mr,dir:Gr,activationMode:zr},reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.div,_extends$1({dir:Gr,"data-orientation":Mr},jr,{ref:Tr})))}),$69cb30bb0017df05$var$TAB_LIST_NAME="TabsList",$69cb30bb0017df05$export$9712d22edc0d78c1=reactExports.forwardRef((_r,Tr)=>{const{__scopeTabs:Ar,loop:Rr=!0,...Pr}=_r,Dr=$69cb30bb0017df05$var$useTabsContext($69cb30bb0017df05$var$TAB_LIST_NAME,Ar),Mr=$69cb30bb0017df05$var$useRovingFocusGroupScope(Ar);return reactExports.createElement($d7bdfb9eb0fdf311$export$be92b6f5f03c0fe9,_extends$1({asChild:!0},Mr,{orientation:Dr.orientation,dir:Dr.dir,loop:Rr}),reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.div,_extends$1({role:"tablist","aria-orientation":Dr.orientation},Pr,{ref:Tr})))}),$69cb30bb0017df05$var$TRIGGER_NAME="TabsTrigger",$69cb30bb0017df05$export$8114b9fdfdf9f3ba=reactExports.forwardRef((_r,Tr)=>{const{__scopeTabs:Ar,value:Rr,disabled:Pr=!1,...Dr}=_r,Mr=$69cb30bb0017df05$var$useTabsContext($69cb30bb0017df05$var$TRIGGER_NAME,Ar),Fr=$69cb30bb0017df05$var$useRovingFocusGroupScope(Ar),zr=$69cb30bb0017df05$var$makeTriggerId(Mr.baseId,Rr),jr=$69cb30bb0017df05$var$makeContentId(Mr.baseId,Rr),Gr=Rr===Mr.value;return reactExports.createElement($d7bdfb9eb0fdf311$export$6d08773d2e66f8f2,_extends$1({asChild:!0},Fr,{focusable:!Pr,active:Gr}),reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.button,_extends$1({type:"button",role:"tab","aria-selected":Gr,"aria-controls":jr,"data-state":Gr?"active":"inactive","data-disabled":Pr?"":void 0,disabled:Pr,id:zr},Dr,{ref:Tr,onMouseDown:$e42e1063c40fb3ef$export$b9ecd428b558ff10(_r.onMouseDown,Nr=>{!Pr&&Nr.button===0&&Nr.ctrlKey===!1?Mr.onValueChange(Rr):Nr.preventDefault()}),onKeyDown:$e42e1063c40fb3ef$export$b9ecd428b558ff10(_r.onKeyDown,Nr=>{[" ","Enter"].includes(Nr.key)&&Mr.onValueChange(Rr)}),onFocus:$e42e1063c40fb3ef$export$b9ecd428b558ff10(_r.onFocus,()=>{const Nr=Mr.activationMode!=="manual";!Gr&&!Pr&&Nr&&Mr.onValueChange(Rr)})})))}),$69cb30bb0017df05$var$CONTENT_NAME="TabsContent",$69cb30bb0017df05$export$bd905d70e8fd2ebb=reactExports.forwardRef((_r,Tr)=>{const{__scopeTabs:Ar,value:Rr,forceMount:Pr,children:Dr,...Mr}=_r,Fr=$69cb30bb0017df05$var$useTabsContext($69cb30bb0017df05$var$CONTENT_NAME,Ar),zr=$69cb30bb0017df05$var$makeTriggerId(Fr.baseId,Rr),jr=$69cb30bb0017df05$var$makeContentId(Fr.baseId,Rr),Gr=Rr===Fr.value,Nr=reactExports.useRef(Gr);return reactExports.useEffect(()=>{const Lr=requestAnimationFrame(()=>Nr.current=!1);return()=>cancelAnimationFrame(Lr)},[]),reactExports.createElement($921a889cee6df7e8$export$99c2b779aa4e8b8b,{present:Pr||Gr},({present:Lr})=>reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.div,_extends$1({"data-state":Gr?"active":"inactive","data-orientation":Fr.orientation,role:"tabpanel","aria-labelledby":zr,hidden:!Lr,id:jr,tabIndex:0},Mr,{ref:Tr,style:{..._r.style,animationDuration:Nr.current?"0s":void 0}}),Lr&&Dr))});function $69cb30bb0017df05$var$makeTriggerId(_r,Tr){return`${_r}-trigger-${Tr}`}function $69cb30bb0017df05$var$makeContentId(_r,Tr){return`${_r}-content-${Tr}`}const $69cb30bb0017df05$export$be92b6f5f03c0fe9=$69cb30bb0017df05$export$b2539bed5023c21c,$69cb30bb0017df05$export$54c2e3dc7acea9f5=$69cb30bb0017df05$export$9712d22edc0d78c1,$69cb30bb0017df05$export$41fb9f06171c75f4=$69cb30bb0017df05$export$8114b9fdfdf9f3ba,$69cb30bb0017df05$export$7c6e2c02157bb7d2=$69cb30bb0017df05$export$bd905d70e8fd2ebb;var lib$5={},Parser$3={},Tokenizer={},decode={},decodeDataHtml={};Object.defineProperty(decodeDataHtml,"__esModule",{value:!0});decodeDataHtml.default=new Uint16Array('<\0\0\0\0\0\0EMabcfglmnoprstu\\bfmsligP&cutereve;iyx}rc;r;ravepha;acr;d;gpon;f;plyFunction;ingcsr;ign;ildemlaceforsucrkslash;;ed;y;crtause;noullis;a;r;pf;eve;cmpeq;HOacdefhilorsucy;PYcpyute;;italDifferentialD;leys;aeioron;dilrc;nint;ot;dnilla;terDot;i;rcleDMPTot;inus;lus;imes;ocskwiseContourIntegral;eCurlyDQoubleQuote;uote;lnpuon;e;gitruent;nt;ourIntegral;fr;oduct;nterClockwiseContourIntegral;oss;cr;p;Cap;DJSZacefios;otrahd;cy;cy;cy;grsger;r;hv;ayron;;l;ta;r;afcmriticalADGTcute;o;bleAcute;rave;ilde;ond;ferentialD;\0\0\0\0f;;DEot;qual;bleCDLRUVontourIntegrao\0\0nArrow;eoftARTrrow;ightArrow;engLReftARrrow;ightArrow;ightArrow;ightATrrow;ee;p\0\0rrow;ownArrow;erticalBar;nABLRTarrow;BUar;pArrow;reve;eft\0\0ightVector;eeVector;ector;Bar;ight\0eeVector;ector;Bar;ee;Arrow;ctr;rok;NTacdfglmopqstuxG;Hcuteaiyron;rc;ot;r;raveement;apcr;ty\0\0mallSquare;erySmallSquare;gpon;f;silon;uail;Tilde;librium;cir;m;a;mlipsts;onentialE;cfiosy;r;lled\0\0mallSquare;erySmallSquare;\0\0\0f;All;riertrf;cJTabcdfgorstcy;>mma;d;reve;eiydil;rc;;ot;r;;pf;eaterEFGLSTqual;Less;ullEqual;reater;ess;lantEqual;ilde;cr;;AacfiosuRDcy;ctek;;irc;r;lbertSpace;\0f;izontalLine;ctrok;mpownHumqual;EJOacdfgmnostucy;lig;cy;cuteiyrc;ot;r;rave;apcgr;inaryI;lie\0;egrral;section;isibleCTomma;imes;gpton;f;a;cr;ilde;\0cy;lcfosuiyrc;;r;pf;\0r;rcy;kcy;HJacfoscy;cy;ppa;eydil;;r;pf;cr;JTaceflmostcy;<cmnprute;bda;g;lacetrf;r;aeyron;dil;;fstACDFRTUVarnrgleBracket;row;BRar;ightArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ightAVrrow;ector;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;ightsEFGLSTqualGreater;ullEqual;reater;ess;lantEqual;ilde;r;;eftarrow;idot;npwgLRlreftARrrow;ightArrow;ightArrow;eftarightightf;erLReftArrow;ightArrow;cht;rok;;acefiosup;y;dliumSpace;lintrf;r;nusPlus;pf;c;Jacefostucy;cute;aeyron;dil;;gswativeMTVediumSpace;hicneryThitedGLreaterGreateessLesLine;r;Bnptreak;BreakingSpace;f;;CDEGHLNPRSTVoungruent;pCap;oubleVerticalBar;lqxement;ual;Tilde;ists;reater;EFGLSTqual;ullEqual;reater;ess;lantEqual;ilde;umpownHump;qual;efstTriangle;BEar;qual;s;EGLSTqual;reater;ess;lantEqual;ilde;estedGLreaterGreater;essLess;recedes;ESqual;lantEqual;eiverseElement;ghtTriangle;BEar;qual;quuareSubpset;Equal;erset;Equal;bcpset;Equal;ceeds;ESTqual;lantEqual;ilde;erset;Equal;ilde;EFTqual;ullEqual;ilde;erticalBar;cr;ilde;Eacdfgmoprstuvlig;cuteiyrc;blac;r;raveaeicr;ga;cron;pf;enCurlyDQoubleQuote;uote;;clr;ashidees;mlerBParr;acek;et;arenthesis;acfhilorsrtialD;y;r;i;;usMinus;ipncareplanf;;eiocedes;ESTqual;lantEqual;ilde;me;dpuct;ortion;al;cir;;UfosOT"r;pf;cr;BEacefhiorsuarr;Gcnrute;g;r;tl;aeyron;dil;;;verseEUlqement;uilibrium;pEquilibrium;ro;ghtACDFTUVanrgleBracket;row;BLar;eftArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;puf;ndImplies;ightarrow;chr;;leDelayed;HOacfhimoqstuCcHcy;y;FTcy;cute;;aeiyron;dil;rc;;r;ortDLRUownArroweftArrowightArrowpArrow;gma;allCircle;pf;\0\0t;are;ISUntersection;ubpset;Equal;erset;Equal;nion;cr;ar;bcmp;set;Equal;cheeds;ESTqual;lantEqual;ilde;Th;;esrset;Equal;etHRSacfhiorsORNADE;Hccy;y;bu;;aeyron;dil;;r;ei\0efore;a;cnkSpace;Space;lde;EFTqual;ullEqual;ilde;pf;ipleDot;ctr;rok;\0\0\0\0\0\0\0cruter;ocir;r\0y;ve;iyrc;blac;r;raveacr;dierBParr;acek;et;arenthesis;on;Plus;gpon;f;ADETadpsrrow;BDar;ownArrow;ownArrow;quilibrium;ee;Arrow;ownerLReftArrow;ightArrow;i;lon;ing;cr;ilde;mlDbcdefosvash;ar;y;ash;l;er;btyar;;icalBLSTar;ine;eparator;ilde;ThinSpace;r;pf;cr;dash;cefosirc;dge;r;pf;cr;fiosr;;pf;cr;AIUacfosucy;cy;cy;cuteiyrc;;r;pf;cr;ml;Hacdefoscy;cute;ayron;;ot;\0oWidta;r;pf;cr;\0\0\0\0\0\0\0cutereve;;Ediuy;;rcte;lig;r;raveepfpsym;ha;apcclr;g;\0\0;adsvnd;;lope;;;elmrsz;esd;a;;;;;;;;t;vb;d;pth;arr;gpon;f;;Eaeiop;cir;;d;s;rox;eingctyr;;mp;eildemlcioninnt;Nabcdefiklnoprsuot;crkcepsong;psilon;rime;im;eq;ee;ed;gerk;tbrk;oy;quo;cmprtaus;eptyv;snoahw;;een;r;gcostuvwaiurc;pdptot;lus;imes;\0\0cup;ar;riangleduown;p;plus;earow;akocnklstozenge;riangle;dlrown;eft;ight;k;\0\0;;4;ck;eo;q=uiv;t;ptwxf;;tomtie;DHUVbdhmptuvLRlr;;;;;DUdu;;;;LRlr;;;;;HLRhlr;;;;;;ox;LRlr;;;;;DUdu;;;;inus;lus;imes;LRlr;;;;;HLRhlr;;;;;;evbarceior;mi;m;el;bh;sub;l;etp;Ee;;q\0\0\0\0\0\0\0\0\0\0cprute;;abcdsnd;rcup;aup;p;ot;;eot;aeiu\0s;on;dilrc;ps;sm;ot;dmnilptyv;t;err;ceiy;ck;mark;r;Ecefms;;elq;e\0\0rrowlreft;ight;RSacd;st;irc;ash;nint;id;cir;ubs;uit\0on;e;q\0\0a;t;;flemxente\0;dot;nfry;o;sr;aorr;ss;cur;bp;e;;e;dot;delprvwarrlr;;\0\0r;c;arr;p;;bcdosrcap;aup;p;ot;r;;alrvrr;m;yevwq\0\0reuee;edge;enearrowlreftightecioninnt;lcty;AHabcdefhijlorstuwzrar;glrsger;eth;h;varow;aayron;;;aogrr;tseq;glmta;ptyv;irsht;;arlraegsvm;osnd;suit;amma;in;;iode;ontimes;ncy;c\0\0rn;op;lptuwlar;f;;empsq;dot;inus;lus;quare;blebarwedgnadhownarrowarpoonlrefighkaro\0\0rn;op;cotry;;l;rok;drot;i;fahraangle;ciy;grarr;DacdefglmnopqrstuxDoocsuteter;aioyron;r;clon;;ot;Drot;;;rsave;dot;;ilsnters;;;dot;apscr;ty;svetp1;;;gs;p;gpon;f;alsr;sl;us;i;lvon;csuviorc\0\0antgltressaeils;st;v;DD;parsl;Daot;rr;cdir;oah;mrlo;cipl;seoctationential\0\0\0\0\0\0\0llingdotsey;male;ilrlig;\0\0g;ig;;lig;lig;fjaltt;ig;ns;of;\0f;ak;v;artint;aocs\0\0;;;;\0;;\0\0;;5;\0;;8;l;wn;cr;Eabcdefgijlnorstv;l;cmpute;ma;d;reve;iyrc;;ot;;lqs;qslan;cdlc;ot;o;l;;es;r;;gmel;cy;;Eaj;;;Eaes;p;prox;q;qim;pf;cir;m;el;;>;cdlqrci;r;ot;Par;uest;adels\0pror;qlqlesienrtneqq;Aabcefkosyrilmrrsfildrcy;;cwir;;ar;irc;alrrts;uitlip;con;r;sewarow;arow;amoprrr;tht;klreftarrow;ightarrow;f;bar;cltr;asrok;bpull;hen\0\0\0\0\0\0cute;iyrc;cxy;clfr;rave;inoinnt;t;fin;ta;lig;aopcgtr;elpinarh;f;ed;;cfotare;in;tie;do;celpal;grerarhk;rod;cgpty;on;f;a;uestcir;n;Edsv;ot;;v;;ilde;\0cy;lcfmosuiyrc;;r;ath;pf;\0r;rcy;kcy;acfghjosppa;v;eydil;;r;reen;cy;cy;pf;cr;ABEHabcdefghjlmnoprstuvartrail;arr;;g;ar;\0\0\0\0\0\0\0\0\0ute;mptyv;rabda;g;dl;;uor;bfhlpst;fs;s;p;l;im;l;;aeil;;s;abrrr;rk;akcek;;es;ldu;;aeuyron;diil;;cqrsa;uo;rduhar;shar;h;;fgqstahlrtrrow;taarpoonduownpeftarrows;ightahsrrow;sarpoonquigarrohreetimes;;qslan;cdgsc;ot;o;r;;es;adegspproot;qgqgtiilrsht;;;E;rdu;l;lk;cy;;achtrorneard;ri;iodot;ust;acheEaes;p;prox;q;qim;abnoptwznrg;r;rglmreftarightapsto;ightparrowlrefight;aflr;;us;imes;st;;efngear;lt;achmtrornear;d;;ri;achiqtquo;r;m;eg;;buo;r;rok;<;cdhilqrci;r;remes;arr;uest;Piar;;efrdushar;har;enrtneqq;DacdefhilnopsuDot;clprret;;ese;sto;dluowefker;oymma;;ash;asuredangler;o;cdnro;acdsir;otus;bd;u;p;dpels;f;ctr;pos;lmtimap;GLRVabcdefghijlmoprstuvwgt;;veltftarrrow;ightarrow;;;vightarrow;Ddash;ash;bcnptlaute;g;;Eiop;d;s;rour;al;s\0pmp;eaeouy\0;on;dil;ng;dot;p;;ash;;Aadqsxrr;rhrk;;oot;uieiar;ist;sr;Eest;qs;qslani;rAaprrr;ar;;sv;d;cy;AEadestr;rr;r;;fqstarrroightarro;qslan;si;ri;eiptf;;inn;Edv;ot;;;i;v;;aorr;astllel;;lint;;ceu;c;eAaitrrr;cw;;ghtarrowri;echimpqu;ceru;ort\0\0arm;e;qsubpbcp;Ees;et;eq;qc;e;Ees;et;eq;qgilrldeianglelreft;eight;e;m;esro;p;DHadgilrsash;arr;p;ash;et;;>nfin;Aetrr;;;r<ie;Atrr;rie;im;Aanrr;rhrk;;oear;\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0csuteiyr;c;abioslac;v;old;lig;crir;;\0\0\0n;ave;bmar;acitrirr;oss;n;aeicr;ga;cdnron;;pf;aelr;rp;;adiosvr;efmr;ofgof;r;lope;;cloashl;idees;as;mlbar;\0\0\0\0\0\0\0\0\0r;ast;lle\0\0m;;y;rcimptnt;od;il;enk;r;imo;v;mane;;tvchfork;aunckk;h;s;abcdemstcir;ir;ou;;nim;wo;ipuntint;f;nd;Eaceinosu;p;u;c;acenspprourlyeaespprox;qq;im;ime;sEasdfpalslar;ine;urf;;trel;cir;;ncsp;fiopsur;pf;rime;cr;aeoteirnionnt;st;eABHabcdefhilmnoprstuxartrail;arar;cdenqrteu;te;imptyv;g;del;;uor;abcfhlpstwp;;fs;;s;l;im;l;;aiil;o;nalabrrrk;akcek;;es;ldu;;aeuyron;diil;;clqsa;dhar;uo;rh;acgl;ipsnart;ilrsht;;aordu;l;;v;gnshtahlrstrrow;taarpoonduowpeftahrrowarpoonightarrows;quigarrohreetimes;g;ingdotseahmra;oust;achemid;abptnrg;r;raflr;;us;imes;apr;gt;olint;arachqquo;r;buo;rhirremes;i;efltri;luhar;;\0\0\0\0\0\0\0cute;qu;Eaceinpsy;\0;on;u;dil;rc;Eas;p;im;olint;i;ot;be;Aacmstxrr;rhr;oti;war;minnut;r;oacoyrp;hycy;;rt\0\0iaragmma;fv;;deglnprot;;q;E;;E;e;lus;arr;araeitlslsetmhp;parsl;dle;;e;s;flptcy;;b;ar;f;adres;uitcsuaup;s;p;s;ubp;eset;e;eset;e;afrarcemtr;tmiararr;fanighteppsilohsbcmnp;Edemnprs;ot;;dot;ult;Ee;;lus;arr;eiut;enq;qeq;qm;bp;;c;acenspprourlyeaespproqg;123;Edehlmnps;ost;ub;;dot;soul;b;arr;ult;Ee;;lus;eiut;enq;qeq;qm;bp;;Aanrr;rhr;owar;lig\0\0\0\0\0\0\0\0\0\0\0\0get;;raeyron;dil;;lrec;r;eiko\0e4fa;svym;cnkaspproimsasrnes;bd;ar;;eps;bcfot;ir;;ork;rime;aipdadempstngle;dlqrowneft;e;ight;eot;inus;lus;b;ime;ezium;chtry;;cy;rok;ioxheadlreftarroightarrowAHabcdfghlmoprstuwrar;cruter\0y;ve;iyrc;abhrlac;airsht;;raverlrlk;ct\0\0rn;erop;ri;alcr;gpon;f;adhlsuownarpoonlrefighi;hlonparrows;cit\0\0rn;erop;ng;ri;cr;dirot;lde;i;famrlangle;ABDacdeflnoprszrar;v;asnrgrt;eknprstappothinhirop;hiugmbpsetneq;q;setneq;q;hretianglelreftighty;ashelr;bear;q;lip;btar;trsubppf;rotrcur;bpnEenEeigzag;cefoprsirc;dibgar;e;q;erp;r;pf;;eatcr;\0\0\0\0\0\0\0trr;Aarr;Aarrais;dptfl;imAarrcqr;ptracefiosucuyte;iyrc;;nr;cy;pf;cr;cmy;lacdefhioswcute;ayron;;ot;ettra;r;cy;grarr;pf;cr;jn;j;'.split("").map(function(_r){return _r.charCodeAt(0)}));var decodeDataXml={};Object.defineProperty(decodeDataXml,"__esModule",{value:!0});decodeDataXml.default=new Uint16Array("aglq	\x1B\0\0p;os;t;t;uot;".split("").map(function(_r){return _r.charCodeAt(0)}));var decode_codepoint={};(function(_r){var Tr;Object.defineProperty(_r,"__esModule",{value:!0}),_r.replaceCodePoint=_r.fromCodePoint=void 0;var Ar=new Map([[0,65533],[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]);_r.fromCodePoint=(Tr=String.fromCodePoint)!==null&&Tr!==void 0?Tr:function(Dr){var Mr="";return Dr>65535&&(Dr-=65536,Mr+=String.fromCharCode(Dr>>>10&1023|55296),Dr=56320|Dr&1023),Mr+=String.fromCharCode(Dr),Mr};function Rr(Dr){var Mr;return Dr>=55296&&Dr<=57343||Dr>1114111?65533:(Mr=Ar.get(Dr))!==null&&Mr!==void 0?Mr:Dr}_r.replaceCodePoint=Rr;function Pr(Dr){return(0,_r.fromCodePoint)(Rr(Dr))}_r.default=Pr})(decode_codepoint);(function(_r){var Tr=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(ls,fs,Ts,$s){$s===void 0&&($s=Ts);var xs=Object.getOwnPropertyDescriptor(fs,Ts);(!xs||("get"in xs?!fs.__esModule:xs.writable||xs.configurable))&&(xs={enumerable:!0,get:function(){return fs[Ts]}}),Object.defineProperty(ls,$s,xs)}:function(ls,fs,Ts,$s){$s===void 0&&($s=Ts),ls[$s]=fs[Ts]}),Ar=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(ls,fs){Object.defineProperty(ls,"default",{enumerable:!0,value:fs})}:function(ls,fs){ls.default=fs}),Rr=commonjsGlobal&&commonjsGlobal.__importStar||function(ls){if(ls&&ls.__esModule)return ls;var fs={};if(ls!=null)for(var Ts in ls)Ts!=="default"&&Object.prototype.hasOwnProperty.call(ls,Ts)&&Tr(fs,ls,Ts);return Ar(fs,ls),fs},Pr=commonjsGlobal&&commonjsGlobal.__importDefault||function(ls){return ls&&ls.__esModule?ls:{default:ls}};Object.defineProperty(_r,"__esModule",{value:!0}),_r.decodeXML=_r.decodeHTMLStrict=_r.decodeHTMLAttribute=_r.decodeHTML=_r.determineBranch=_r.EntityDecoder=_r.DecodingMode=_r.BinTrieFlags=_r.fromCodePoint=_r.replaceCodePoint=_r.decodeCodePoint=_r.xmlDecodeTree=_r.htmlDecodeTree=void 0;var Dr=Pr(decodeDataHtml);_r.htmlDecodeTree=Dr.default;var Mr=Pr(decodeDataXml);_r.xmlDecodeTree=Mr.default;var Fr=Rr(decode_codepoint);_r.decodeCodePoint=Fr.default;var zr=decode_codepoint;Object.defineProperty(_r,"replaceCodePoint",{enumerable:!0,get:function(){return zr.replaceCodePoint}}),Object.defineProperty(_r,"fromCodePoint",{enumerable:!0,get:function(){return zr.fromCodePoint}});var jr;(function(ls){ls[ls.NUM=35]="NUM",ls[ls.SEMI=59]="SEMI",ls[ls.EQUALS=61]="EQUALS",ls[ls.ZERO=48]="ZERO",ls[ls.NINE=57]="NINE",ls[ls.LOWER_A=97]="LOWER_A",ls[ls.LOWER_F=102]="LOWER_F",ls[ls.LOWER_X=120]="LOWER_X",ls[ls.LOWER_Z=122]="LOWER_Z",ls[ls.UPPER_A=65]="UPPER_A",ls[ls.UPPER_F=70]="UPPER_F",ls[ls.UPPER_Z=90]="UPPER_Z"})(jr||(jr={}));var Gr=32,Nr;(function(ls){ls[ls.VALUE_LENGTH=49152]="VALUE_LENGTH",ls[ls.BRANCH_LENGTH=16256]="BRANCH_LENGTH",ls[ls.JUMP_TABLE=127]="JUMP_TABLE"})(Nr=_r.BinTrieFlags||(_r.BinTrieFlags={}));function Lr(ls){return ls>=jr.ZERO&&ls<=jr.NINE}function Ur(ls){return ls>=jr.UPPER_A&&ls<=jr.UPPER_F||ls>=jr.LOWER_A&&ls<=jr.LOWER_F}function Vr(ls){return ls>=jr.UPPER_A&&ls<=jr.UPPER_Z||ls>=jr.LOWER_A&&ls<=jr.LOWER_Z||Lr(ls)}function Wr(ls){return ls===jr.EQUALS||Vr(ls)}var qr;(function(ls){ls[ls.EntityStart=0]="EntityStart",ls[ls.NumericStart=1]="NumericStart",ls[ls.NumericDecimal=2]="NumericDecimal",ls[ls.NumericHex=3]="NumericHex",ls[ls.NamedEntity=4]="NamedEntity"})(qr||(qr={}));var Kr;(function(ls){ls[ls.Legacy=0]="Legacy",ls[ls.Strict=1]="Strict",ls[ls.Attribute=2]="Attribute"})(Kr=_r.DecodingMode||(_r.DecodingMode={}));var Xr=function(){function ls(fs,Ts,$s){this.decodeTree=fs,this.emitCodePoint=Ts,this.errors=$s,this.state=qr.EntityStart,this.consumed=1,this.result=0,this.treeIndex=0,this.excess=1,this.decodeMode=Kr.Strict}return ls.prototype.startEntity=function(fs){this.decodeMode=fs,this.state=qr.EntityStart,this.result=0,this.treeIndex=0,this.excess=1,this.consumed=1},ls.prototype.write=function(fs,Ts){switch(this.state){case qr.EntityStart:return fs.charCodeAt(Ts)===jr.NUM?(this.state=qr.NumericStart,this.consumed+=1,this.stateNumericStart(fs,Ts+1)):(this.state=qr.NamedEntity,this.stateNamedEntity(fs,Ts));case qr.NumericStart:return this.stateNumericStart(fs,Ts);case qr.NumericDecimal:return this.stateNumericDecimal(fs,Ts);case qr.NumericHex:return this.stateNumericHex(fs,Ts);case qr.NamedEntity:return this.stateNamedEntity(fs,Ts)}},ls.prototype.stateNumericStart=function(fs,Ts){return Ts>=fs.length?-1:(fs.charCodeAt(Ts)|Gr)===jr.LOWER_X?(this.state=qr.NumericHex,this.consumed+=1,this.stateNumericHex(fs,Ts+1)):(this.state=qr.NumericDecimal,this.stateNumericDecimal(fs,Ts))},ls.prototype.addToNumericResult=function(fs,Ts,$s,xs){if(Ts!==$s){var ys=$s-Ts;this.result=this.result*Math.pow(xs,ys)+parseInt(fs.substr(Ts,ys),xs),this.consumed+=ys}},ls.prototype.stateNumericHex=function(fs,Ts){for(var $s=Ts;Ts<fs.length;){var xs=fs.charCodeAt(Ts);if(Lr(xs)||Ur(xs))Ts+=1;else return this.addToNumericResult(fs,$s,Ts,16),this.emitNumericEntity(xs,3)}return this.addToNumericResult(fs,$s,Ts,16),-1},ls.prototype.stateNumericDecimal=function(fs,Ts){for(var $s=Ts;Ts<fs.length;){var xs=fs.charCodeAt(Ts);if(Lr(xs))Ts+=1;else return this.addToNumericResult(fs,$s,Ts,10),this.emitNumericEntity(xs,2)}return this.addToNumericResult(fs,$s,Ts,10),-1},ls.prototype.emitNumericEntity=function(fs,Ts){var $s;if(this.consumed<=Ts)return($s=this.errors)===null||$s===void 0||$s.absenceOfDigitsInNumericCharacterReference(this.consumed),0;if(fs===jr.SEMI)this.consumed+=1;else if(this.decodeMode===Kr.Strict)return 0;return this.emitCodePoint((0,Fr.replaceCodePoint)(this.result),this.consumed),this.errors&&(fs!==jr.SEMI&&this.errors.missingSemicolonAfterCharacterReference(),this.errors.validateNumericCharacterReference(this.result)),this.consumed},ls.prototype.stateNamedEntity=function(fs,Ts){for(var $s=this.decodeTree,xs=$s[this.treeIndex],ys=(xs&Nr.VALUE_LENGTH)>>14;Ts<fs.length;Ts++,this.excess++){var ps=fs.charCodeAt(Ts);if(this.treeIndex=_i($s,xs,this.treeIndex+Math.max(1,ys),ps),this.treeIndex<0)return this.result===0||this.decodeMode===Kr.Attribute&&(ys===0||Wr(ps))?0:this.emitNotTerminatedNamedEntity();if(xs=$s[this.treeIndex],ys=(xs&Nr.VALUE_LENGTH)>>14,ys!==0){if(ps===jr.SEMI)return this.emitNamedEntityData(this.treeIndex,ys,this.consumed+this.excess);this.decodeMode!==Kr.Strict&&(this.result=this.treeIndex,this.consumed+=this.excess,this.excess=0)}}return-1},ls.prototype.emitNotTerminatedNamedEntity=function(){var fs,Ts=this,$s=Ts.result,xs=Ts.decodeTree,ys=(xs[$s]&Nr.VALUE_LENGTH)>>14;return this.emitNamedEntityData($s,ys,this.consumed),(fs=this.errors)===null||fs===void 0||fs.missingSemicolonAfterCharacterReference(),this.consumed},ls.prototype.emitNamedEntityData=function(fs,Ts,$s){var xs=this.decodeTree;return this.emitCodePoint(Ts===1?xs[fs]&~Nr.VALUE_LENGTH:xs[fs+1],$s),Ts===3&&this.emitCodePoint(xs[fs+2],$s),$s},ls.prototype.end=function(){var fs;switch(this.state){case qr.NamedEntity:return this.result!==0&&(this.decodeMode!==Kr.Attribute||this.result===this.treeIndex)?this.emitNotTerminatedNamedEntity():0;case qr.NumericDecimal:return this.emitNumericEntity(0,2);case qr.NumericHex:return this.emitNumericEntity(0,3);case qr.NumericStart:return(fs=this.errors)===null||fs===void 0||fs.absenceOfDigitsInNumericCharacterReference(this.consumed),0;case qr.EntityStart:return 0}},ls}();_r.EntityDecoder=Xr;function Zr(ls){var fs="",Ts=new Xr(ls,function($s){return fs+=(0,Fr.fromCodePoint)($s)});return function(xs,ys){for(var ps=0,vs=0;(vs=xs.indexOf("&",vs))>=0;){fs+=xs.slice(ps,vs),Ts.startEntity(ys);var Ds=Ts.write(xs,vs+1);if(Ds<0){ps=vs+Ts.end();break}ps=vs+Ds,vs=Ds===0?ps+1:ps}var js=fs+xs.slice(ps);return fs="",js}}function _i(ls,fs,Ts,$s){var xs=(fs&Nr.BRANCH_LENGTH)>>7,ys=fs&Nr.JUMP_TABLE;if(xs===0)return ys!==0&&$s===ys?Ts:-1;if(ys){var ps=$s-ys;return ps<0||ps>=xs?-1:ls[Ts+ps]-1}for(var vs=Ts,Ds=vs+xs-1;vs<=Ds;){var js=vs+Ds>>>1,zs=ls[js];if(zs<$s)vs=js+1;else if(zs>$s)Ds=js-1;else return ls[js+xs]}return-1}_r.determineBranch=_i;var Jr=Zr(Dr.default),es=Zr(Mr.default);function ts(ls,fs){return fs===void 0&&(fs=Kr.Legacy),Jr(ls,fs)}_r.decodeHTML=ts;function is(ls){return Jr(ls,Kr.Attribute)}_r.decodeHTMLAttribute=is;function rs(ls){return Jr(ls,Kr.Strict)}_r.decodeHTMLStrict=rs;function as(ls){return es(ls,Kr.Strict)}_r.decodeXML=as})(decode);(function(_r){Object.defineProperty(_r,"__esModule",{value:!0}),_r.QuoteType=void 0;var Tr=decode,Ar;(function(Lr){Lr[Lr.Tab=9]="Tab",Lr[Lr.NewLine=10]="NewLine",Lr[Lr.FormFeed=12]="FormFeed",Lr[Lr.CarriageReturn=13]="CarriageReturn",Lr[Lr.Space=32]="Space",Lr[Lr.ExclamationMark=33]="ExclamationMark",Lr[Lr.Number=35]="Number",Lr[Lr.Amp=38]="Amp",Lr[Lr.SingleQuote=39]="SingleQuote",Lr[Lr.DoubleQuote=34]="DoubleQuote",Lr[Lr.Dash=45]="Dash",Lr[Lr.Slash=47]="Slash",Lr[Lr.Zero=48]="Zero",Lr[Lr.Nine=57]="Nine",Lr[Lr.Semi=59]="Semi",Lr[Lr.Lt=60]="Lt",Lr[Lr.Eq=61]="Eq",Lr[Lr.Gt=62]="Gt",Lr[Lr.Questionmark=63]="Questionmark",Lr[Lr.UpperA=65]="UpperA",Lr[Lr.LowerA=97]="LowerA",Lr[Lr.UpperF=70]="UpperF",Lr[Lr.LowerF=102]="LowerF",Lr[Lr.UpperZ=90]="UpperZ",Lr[Lr.LowerZ=122]="LowerZ",Lr[Lr.LowerX=120]="LowerX",Lr[Lr.OpeningSquareBracket=91]="OpeningSquareBracket"})(Ar||(Ar={}));var Rr;(function(Lr){Lr[Lr.Text=1]="Text",Lr[Lr.BeforeTagName=2]="BeforeTagName",Lr[Lr.InTagName=3]="InTagName",Lr[Lr.InSelfClosingTag=4]="InSelfClosingTag",Lr[Lr.BeforeClosingTagName=5]="BeforeClosingTagName",Lr[Lr.InClosingTagName=6]="InClosingTagName",Lr[Lr.AfterClosingTagName=7]="AfterClosingTagName",Lr[Lr.BeforeAttributeName=8]="BeforeAttributeName",Lr[Lr.InAttributeName=9]="InAttributeName",Lr[Lr.AfterAttributeName=10]="AfterAttributeName",Lr[Lr.BeforeAttributeValue=11]="BeforeAttributeValue",Lr[Lr.InAttributeValueDq=12]="InAttributeValueDq",Lr[Lr.InAttributeValueSq=13]="InAttributeValueSq",Lr[Lr.InAttributeValueNq=14]="InAttributeValueNq",Lr[Lr.BeforeDeclaration=15]="BeforeDeclaration",Lr[Lr.InDeclaration=16]="InDeclaration",Lr[Lr.InProcessingInstruction=17]="InProcessingInstruction",Lr[Lr.BeforeComment=18]="BeforeComment",Lr[Lr.CDATASequence=19]="CDATASequence",Lr[Lr.InSpecialComment=20]="InSpecialComment",Lr[Lr.InCommentLike=21]="InCommentLike",Lr[Lr.BeforeSpecialS=22]="BeforeSpecialS",Lr[Lr.SpecialStartSequence=23]="SpecialStartSequence",Lr[Lr.InSpecialTag=24]="InSpecialTag",Lr[Lr.BeforeEntity=25]="BeforeEntity",Lr[Lr.BeforeNumericEntity=26]="BeforeNumericEntity",Lr[Lr.InNamedEntity=27]="InNamedEntity",Lr[Lr.InNumericEntity=28]="InNumericEntity",Lr[Lr.InHexEntity=29]="InHexEntity"})(Rr||(Rr={}));function Pr(Lr){return Lr===Ar.Space||Lr===Ar.NewLine||Lr===Ar.Tab||Lr===Ar.FormFeed||Lr===Ar.CarriageReturn}function Dr(Lr){return Lr===Ar.Slash||Lr===Ar.Gt||Pr(Lr)}function Mr(Lr){return Lr>=Ar.Zero&&Lr<=Ar.Nine}function Fr(Lr){return Lr>=Ar.LowerA&&Lr<=Ar.LowerZ||Lr>=Ar.UpperA&&Lr<=Ar.UpperZ}function zr(Lr){return Lr>=Ar.UpperA&&Lr<=Ar.UpperF||Lr>=Ar.LowerA&&Lr<=Ar.LowerF}var jr;(function(Lr){Lr[Lr.NoValue=0]="NoValue",Lr[Lr.Unquoted=1]="Unquoted",Lr[Lr.Single=2]="Single",Lr[Lr.Double=3]="Double"})(jr=_r.QuoteType||(_r.QuoteType={}));var Gr={Cdata:new Uint8Array([67,68,65,84,65,91]),CdataEnd:new Uint8Array([93,93,62]),CommentEnd:new Uint8Array([45,45,62]),ScriptEnd:new Uint8Array([60,47,115,99,114,105,112,116]),StyleEnd:new Uint8Array([60,47,115,116,121,108,101]),TitleEnd:new Uint8Array([60,47,116,105,116,108,101])},Nr=function(){function Lr(Ur,Vr){var Wr=Ur.xmlMode,qr=Wr===void 0?!1:Wr,Kr=Ur.decodeEntities,Xr=Kr===void 0?!0:Kr;this.cbs=Vr,this.state=Rr.Text,this.buffer="",this.sectionStart=0,this.index=0,this.baseState=Rr.Text,this.isSpecial=!1,this.running=!0,this.offset=0,this.currentSequence=void 0,this.sequenceIndex=0,this.trieIndex=0,this.trieCurrent=0,this.entityResult=0,this.entityExcess=0,this.xmlMode=qr,this.decodeEntities=Xr,this.entityTrie=qr?Tr.xmlDecodeTree:Tr.htmlDecodeTree}return Lr.prototype.reset=function(){this.state=Rr.Text,this.buffer="",this.sectionStart=0,this.index=0,this.baseState=Rr.Text,this.currentSequence=void 0,this.running=!0,this.offset=0},Lr.prototype.write=function(Ur){this.offset+=this.buffer.length,this.buffer=Ur,this.parse()},Lr.prototype.end=function(){this.running&&this.finish()},Lr.prototype.pause=function(){this.running=!1},Lr.prototype.resume=function(){this.running=!0,this.index<this.buffer.length+this.offset&&this.parse()},Lr.prototype.getIndex=function(){return this.index},Lr.prototype.getSectionStart=function(){return this.sectionStart},Lr.prototype.stateText=function(Ur){Ur===Ar.Lt||!this.decodeEntities&&this.fastForwardTo(Ar.Lt)?(this.index>this.sectionStart&&this.cbs.ontext(this.sectionStart,this.index),this.state=Rr.BeforeTagName,this.sectionStart=this.index):this.decodeEntities&&Ur===Ar.Amp&&(this.state=Rr.BeforeEntity)},Lr.prototype.stateSpecialStartSequence=function(Ur){var Vr=this.sequenceIndex===this.currentSequence.length,Wr=Vr?Dr(Ur):(Ur|32)===this.currentSequence[this.sequenceIndex];if(!Wr)this.isSpecial=!1;else if(!Vr){this.sequenceIndex++;return}this.sequenceIndex=0,this.state=Rr.InTagName,this.stateInTagName(Ur)},Lr.prototype.stateInSpecialTag=function(Ur){if(this.sequenceIndex===this.currentSequence.length){if(Ur===Ar.Gt||Pr(Ur)){var Vr=this.index-this.currentSequence.length;if(this.sectionStart<Vr){var Wr=this.index;this.index=Vr,this.cbs.ontext(this.sectionStart,Vr),this.index=Wr}this.isSpecial=!1,this.sectionStart=Vr+2,this.stateInClosingTagName(Ur);return}this.sequenceIndex=0}(Ur|32)===this.currentSequence[this.sequenceIndex]?this.sequenceIndex+=1:this.sequenceIndex===0?this.currentSequence===Gr.TitleEnd?this.decodeEntities&&Ur===Ar.Amp&&(this.state=Rr.BeforeEntity):this.fastForwardTo(Ar.Lt)&&(this.sequenceIndex=1):this.sequenceIndex=+(Ur===Ar.Lt)},Lr.prototype.stateCDATASequence=function(Ur){Ur===Gr.Cdata[this.sequenceIndex]?++this.sequenceIndex===Gr.Cdata.length&&(this.state=Rr.InCommentLike,this.currentSequence=Gr.CdataEnd,this.sequenceIndex=0,this.sectionStart=this.index+1):(this.sequenceIndex=0,this.state=Rr.InDeclaration,this.stateInDeclaration(Ur))},Lr.prototype.fastForwardTo=function(Ur){for(;++this.index<this.buffer.length+this.offset;)if(this.buffer.charCodeAt(this.index-this.offset)===Ur)return!0;return this.index=this.buffer.length+this.offset-1,!1},Lr.prototype.stateInCommentLike=function(Ur){Ur===this.currentSequence[this.sequenceIndex]?++this.sequenceIndex===this.currentSequence.length&&(this.currentSequence===Gr.CdataEnd?this.cbs.oncdata(this.sectionStart,this.index,2):this.cbs.oncomment(this.sectionStart,this.index,2),this.sequenceIndex=0,this.sectionStart=this.index+1,this.state=Rr.Text):this.sequenceIndex===0?this.fastForwardTo(this.currentSequence[0])&&(this.sequenceIndex=1):Ur!==this.currentSequence[this.sequenceIndex-1]&&(this.sequenceIndex=0)},Lr.prototype.isTagStartChar=function(Ur){return this.xmlMode?!Dr(Ur):Fr(Ur)},Lr.prototype.startSpecial=function(Ur,Vr){this.isSpecial=!0,this.currentSequence=Ur,this.sequenceIndex=Vr,this.state=Rr.SpecialStartSequence},Lr.prototype.stateBeforeTagName=function(Ur){if(Ur===Ar.ExclamationMark)this.state=Rr.BeforeDeclaration,this.sectionStart=this.index+1;else if(Ur===Ar.Questionmark)this.state=Rr.InProcessingInstruction,this.sectionStart=this.index+1;else if(this.isTagStartChar(Ur)){var Vr=Ur|32;this.sectionStart=this.index,!this.xmlMode&&Vr===Gr.TitleEnd[2]?this.startSpecial(Gr.TitleEnd,3):this.state=!this.xmlMode&&Vr===Gr.ScriptEnd[2]?Rr.BeforeSpecialS:Rr.InTagName}else Ur===Ar.Slash?this.state=Rr.BeforeClosingTagName:(this.state=Rr.Text,this.stateText(Ur))},Lr.prototype.stateInTagName=function(Ur){Dr(Ur)&&(this.cbs.onopentagname(this.sectionStart,this.index),this.sectionStart=-1,this.state=Rr.BeforeAttributeName,this.stateBeforeAttributeName(Ur))},Lr.prototype.stateBeforeClosingTagName=function(Ur){Pr(Ur)||(Ur===Ar.Gt?this.state=Rr.Text:(this.state=this.isTagStartChar(Ur)?Rr.InClosingTagName:Rr.InSpecialComment,this.sectionStart=this.index))},Lr.prototype.stateInClosingTagName=function(Ur){(Ur===Ar.Gt||Pr(Ur))&&(this.cbs.onclosetag(this.sectionStart,this.index),this.sectionStart=-1,this.state=Rr.AfterClosingTagName,this.stateAfterClosingTagName(Ur))},Lr.prototype.stateAfterClosingTagName=function(Ur){(Ur===Ar.Gt||this.fastForwardTo(Ar.Gt))&&(this.state=Rr.Text,this.baseState=Rr.Text,this.sectionStart=this.index+1)},Lr.prototype.stateBeforeAttributeName=function(Ur){Ur===Ar.Gt?(this.cbs.onopentagend(this.index),this.isSpecial?(this.state=Rr.InSpecialTag,this.sequenceIndex=0):this.state=Rr.Text,this.baseState=this.state,this.sectionStart=this.index+1):Ur===Ar.Slash?this.state=Rr.InSelfClosingTag:Pr(Ur)||(this.state=Rr.InAttributeName,this.sectionStart=this.index)},Lr.prototype.stateInSelfClosingTag=function(Ur){Ur===Ar.Gt?(this.cbs.onselfclosingtag(this.index),this.state=Rr.Text,this.baseState=Rr.Text,this.sectionStart=this.index+1,this.isSpecial=!1):Pr(Ur)||(this.state=Rr.BeforeAttributeName,this.stateBeforeAttributeName(Ur))},Lr.prototype.stateInAttributeName=function(Ur){(Ur===Ar.Eq||Dr(Ur))&&(this.cbs.onattribname(this.sectionStart,this.index),this.sectionStart=-1,this.state=Rr.AfterAttributeName,this.stateAfterAttributeName(Ur))},Lr.prototype.stateAfterAttributeName=function(Ur){Ur===Ar.Eq?this.state=Rr.BeforeAttributeValue:Ur===Ar.Slash||Ur===Ar.Gt?(this.cbs.onattribend(jr.NoValue,this.index),this.state=Rr.BeforeAttributeName,this.stateBeforeAttributeName(Ur)):Pr(Ur)||(this.cbs.onattribend(jr.NoValue,this.index),this.state=Rr.InAttributeName,this.sectionStart=this.index)},Lr.prototype.stateBeforeAttributeValue=function(Ur){Ur===Ar.DoubleQuote?(this.state=Rr.InAttributeValueDq,this.sectionStart=this.index+1):Ur===Ar.SingleQuote?(this.state=Rr.InAttributeValueSq,this.sectionStart=this.index+1):Pr(Ur)||(this.sectionStart=this.index,this.state=Rr.InAttributeValueNq,this.stateInAttributeValueNoQuotes(Ur))},Lr.prototype.handleInAttributeValue=function(Ur,Vr){Ur===Vr||!this.decodeEntities&&this.fastForwardTo(Vr)?(this.cbs.onattribdata(this.sectionStart,this.index),this.sectionStart=-1,this.cbs.onattribend(Vr===Ar.DoubleQuote?jr.Double:jr.Single,this.index),this.state=Rr.BeforeAttributeName):this.decodeEntities&&Ur===Ar.Amp&&(this.baseState=this.state,this.state=Rr.BeforeEntity)},Lr.prototype.stateInAttributeValueDoubleQuotes=function(Ur){this.handleInAttributeValue(Ur,Ar.DoubleQuote)},Lr.prototype.stateInAttributeValueSingleQuotes=function(Ur){this.handleInAttributeValue(Ur,Ar.SingleQuote)},Lr.prototype.stateInAttributeValueNoQuotes=function(Ur){Pr(Ur)||Ur===Ar.Gt?(this.cbs.onattribdata(this.sectionStart,this.index),this.sectionStart=-1,this.cbs.onattribend(jr.Unquoted,this.index),this.state=Rr.BeforeAttributeName,this.stateBeforeAttributeName(Ur)):this.decodeEntities&&Ur===Ar.Amp&&(this.baseState=this.state,this.state=Rr.BeforeEntity)},Lr.prototype.stateBeforeDeclaration=function(Ur){Ur===Ar.OpeningSquareBracket?(this.state=Rr.CDATASequence,this.sequenceIndex=0):this.state=Ur===Ar.Dash?Rr.BeforeComment:Rr.InDeclaration},Lr.prototype.stateInDeclaration=function(Ur){(Ur===Ar.Gt||this.fastForwardTo(Ar.Gt))&&(this.cbs.ondeclaration(this.sectionStart,this.index),this.state=Rr.Text,this.sectionStart=this.index+1)},Lr.prototype.stateInProcessingInstruction=function(Ur){(Ur===Ar.Gt||this.fastForwardTo(Ar.Gt))&&(this.cbs.onprocessinginstruction(this.sectionStart,this.index),this.state=Rr.Text,this.sectionStart=this.index+1)},Lr.prototype.stateBeforeComment=function(Ur){Ur===Ar.Dash?(this.state=Rr.InCommentLike,this.currentSequence=Gr.CommentEnd,this.sequenceIndex=2,this.sectionStart=this.index+1):this.state=Rr.InDeclaration},Lr.prototype.stateInSpecialComment=function(Ur){(Ur===Ar.Gt||this.fastForwardTo(Ar.Gt))&&(this.cbs.oncomment(this.sectionStart,this.index,0),this.state=Rr.Text,this.sectionStart=this.index+1)},Lr.prototype.stateBeforeSpecialS=function(Ur){var Vr=Ur|32;Vr===Gr.ScriptEnd[3]?this.startSpecial(Gr.ScriptEnd,4):Vr===Gr.StyleEnd[3]?this.startSpecial(Gr.StyleEnd,4):(this.state=Rr.InTagName,this.stateInTagName(Ur))},Lr.prototype.stateBeforeEntity=function(Ur){this.entityExcess=1,this.entityResult=0,Ur===Ar.Number?this.state=Rr.BeforeNumericEntity:Ur===Ar.Amp||(this.trieIndex=0,this.trieCurrent=this.entityTrie[0],this.state=Rr.InNamedEntity,this.stateInNamedEntity(Ur))},Lr.prototype.stateInNamedEntity=function(Ur){if(this.entityExcess+=1,this.trieIndex=(0,Tr.determineBranch)(this.entityTrie,this.trieCurrent,this.trieIndex+1,Ur),this.trieIndex<0){this.emitNamedEntity(),this.index--;return}this.trieCurrent=this.entityTrie[this.trieIndex];var Vr=this.trieCurrent&Tr.BinTrieFlags.VALUE_LENGTH;if(Vr){var Wr=(Vr>>14)-1;if(!this.allowLegacyEntity()&&Ur!==Ar.Semi)this.trieIndex+=Wr;else{var qr=this.index-this.entityExcess+1;qr>this.sectionStart&&this.emitPartial(this.sectionStart,qr),this.entityResult=this.trieIndex,this.trieIndex+=Wr,this.entityExcess=0,this.sectionStart=this.index+1,Wr===0&&this.emitNamedEntity()}}},Lr.prototype.emitNamedEntity=function(){if(this.state=this.baseState,this.entityResult!==0){var Ur=(this.entityTrie[this.entityResult]&Tr.BinTrieFlags.VALUE_LENGTH)>>14;switch(Ur){case 1:{this.emitCodePoint(this.entityTrie[this.entityResult]&~Tr.BinTrieFlags.VALUE_LENGTH);break}case 2:{this.emitCodePoint(this.entityTrie[this.entityResult+1]);break}case 3:this.emitCodePoint(this.entityTrie[this.entityResult+1]),this.emitCodePoint(this.entityTrie[this.entityResult+2])}}},Lr.prototype.stateBeforeNumericEntity=function(Ur){(Ur|32)===Ar.LowerX?(this.entityExcess++,this.state=Rr.InHexEntity):(this.state=Rr.InNumericEntity,this.stateInNumericEntity(Ur))},Lr.prototype.emitNumericEntity=function(Ur){var Vr=this.index-this.entityExcess-1,Wr=Vr+2+ +(this.state===Rr.InHexEntity);Wr!==this.index&&(Vr>this.sectionStart&&this.emitPartial(this.sectionStart,Vr),this.sectionStart=this.index+Number(Ur),this.emitCodePoint((0,Tr.replaceCodePoint)(this.entityResult))),this.state=this.baseState},Lr.prototype.stateInNumericEntity=function(Ur){Ur===Ar.Semi?this.emitNumericEntity(!0):Mr(Ur)?(this.entityResult=this.entityResult*10+(Ur-Ar.Zero),this.entityExcess++):(this.allowLegacyEntity()?this.emitNumericEntity(!1):this.state=this.baseState,this.index--)},Lr.prototype.stateInHexEntity=function(Ur){Ur===Ar.Semi?this.emitNumericEntity(!0):Mr(Ur)?(this.entityResult=this.entityResult*16+(Ur-Ar.Zero),this.entityExcess++):zr(Ur)?(this.entityResult=this.entityResult*16+((Ur|32)-Ar.LowerA+10),this.entityExcess++):(this.allowLegacyEntity()?this.emitNumericEntity(!1):this.state=this.baseState,this.index--)},Lr.prototype.allowLegacyEntity=function(){return!this.xmlMode&&(this.baseState===Rr.Text||this.baseState===Rr.InSpecialTag)},Lr.prototype.cleanup=function(){this.running&&this.sectionStart!==this.index&&(this.state===Rr.Text||this.state===Rr.InSpecialTag&&this.sequenceIndex===0?(this.cbs.ontext(this.sectionStart,this.index),this.sectionStart=this.index):(this.state===Rr.InAttributeValueDq||this.state===Rr.InAttributeValueSq||this.state===Rr.InAttributeValueNq)&&(this.cbs.onattribdata(this.sectionStart,this.index),this.sectionStart=this.index))},Lr.prototype.shouldContinue=function(){return this.index<this.buffer.length+this.offset&&this.running},Lr.prototype.parse=function(){for(;this.shouldContinue();){var Ur=this.buffer.charCodeAt(this.index-this.offset);switch(this.state){case Rr.Text:{this.stateText(Ur);break}case Rr.SpecialStartSequence:{this.stateSpecialStartSequence(Ur);break}case Rr.InSpecialTag:{this.stateInSpecialTag(Ur);break}case Rr.CDATASequence:{this.stateCDATASequence(Ur);break}case Rr.InAttributeValueDq:{this.stateInAttributeValueDoubleQuotes(Ur);break}case Rr.InAttributeName:{this.stateInAttributeName(Ur);break}case Rr.InCommentLike:{this.stateInCommentLike(Ur);break}case Rr.InSpecialComment:{this.stateInSpecialComment(Ur);break}case Rr.BeforeAttributeName:{this.stateBeforeAttributeName(Ur);break}case Rr.InTagName:{this.stateInTagName(Ur);break}case Rr.InClosingTagName:{this.stateInClosingTagName(Ur);break}case Rr.BeforeTagName:{this.stateBeforeTagName(Ur);break}case Rr.AfterAttributeName:{this.stateAfterAttributeName(Ur);break}case Rr.InAttributeValueSq:{this.stateInAttributeValueSingleQuotes(Ur);break}case Rr.BeforeAttributeValue:{this.stateBeforeAttributeValue(Ur);break}case Rr.BeforeClosingTagName:{this.stateBeforeClosingTagName(Ur);break}case Rr.AfterClosingTagName:{this.stateAfterClosingTagName(Ur);break}case Rr.BeforeSpecialS:{this.stateBeforeSpecialS(Ur);break}case Rr.InAttributeValueNq:{this.stateInAttributeValueNoQuotes(Ur);break}case Rr.InSelfClosingTag:{this.stateInSelfClosingTag(Ur);break}case Rr.InDeclaration:{this.stateInDeclaration(Ur);break}case Rr.BeforeDeclaration:{this.stateBeforeDeclaration(Ur);break}case Rr.BeforeComment:{this.stateBeforeComment(Ur);break}case Rr.InProcessingInstruction:{this.stateInProcessingInstruction(Ur);break}case Rr.InNamedEntity:{this.stateInNamedEntity(Ur);break}case Rr.BeforeEntity:{this.stateBeforeEntity(Ur);break}case Rr.InHexEntity:{this.stateInHexEntity(Ur);break}case Rr.InNumericEntity:{this.stateInNumericEntity(Ur);break}default:this.stateBeforeNumericEntity(Ur)}this.index++}this.cleanup()},Lr.prototype.finish=function(){this.state===Rr.InNamedEntity&&this.emitNamedEntity(),this.sectionStart<this.index&&this.handleTrailingData(),this.cbs.onend()},Lr.prototype.handleTrailingData=function(){var Ur=this.buffer.length+this.offset;this.state===Rr.InCommentLike?this.currentSequence===Gr.CdataEnd?this.cbs.oncdata(this.sectionStart,Ur,0):this.cbs.oncomment(this.sectionStart,Ur,0):this.state===Rr.InNumericEntity&&this.allowLegacyEntity()?this.emitNumericEntity(!1):this.state===Rr.InHexEntity&&this.allowLegacyEntity()?this.emitNumericEntity(!1):this.state===Rr.InTagName||this.state===Rr.BeforeAttributeName||this.state===Rr.BeforeAttributeValue||this.state===Rr.AfterAttributeName||this.state===Rr.InAttributeName||this.state===Rr.InAttributeValueSq||this.state===Rr.InAttributeValueDq||this.state===Rr.InAttributeValueNq||this.state===Rr.InClosingTagName||this.cbs.ontext(this.sectionStart,Ur)},Lr.prototype.emitPartial=function(Ur,Vr){this.baseState!==Rr.Text&&this.baseState!==Rr.InSpecialTag?this.cbs.onattribdata(Ur,Vr):this.cbs.ontext(Ur,Vr)},Lr.prototype.emitCodePoint=function(Ur){this.baseState!==Rr.Text&&this.baseState!==Rr.InSpecialTag?this.cbs.onattribentity(Ur):this.cbs.ontextentity(Ur)},Lr}();_r.default=Nr})(Tokenizer);var __createBinding$1=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(_r,Tr,Ar,Rr){Rr===void 0&&(Rr=Ar);var Pr=Object.getOwnPropertyDescriptor(Tr,Ar);(!Pr||("get"in Pr?!Tr.__esModule:Pr.writable||Pr.configurable))&&(Pr={enumerable:!0,get:function(){return Tr[Ar]}}),Object.defineProperty(_r,Rr,Pr)}:function(_r,Tr,Ar,Rr){Rr===void 0&&(Rr=Ar),_r[Rr]=Tr[Ar]}),__setModuleDefault$1=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(_r,Tr){Object.defineProperty(_r,"default",{enumerable:!0,value:Tr})}:function(_r,Tr){_r.default=Tr}),__importStar$1=commonjsGlobal&&commonjsGlobal.__importStar||function(_r){if(_r&&_r.__esModule)return _r;var Tr={};if(_r!=null)for(var Ar in _r)Ar!=="default"&&Object.prototype.hasOwnProperty.call(_r,Ar)&&__createBinding$1(Tr,_r,Ar);return __setModuleDefault$1(Tr,_r),Tr};Object.defineProperty(Parser$3,"__esModule",{value:!0});Parser$3.Parser=void 0;var Tokenizer_js_1=__importStar$1(Tokenizer),decode_js_1=decode,formTags=new Set(["input","option","optgroup","select","button","datalist","textarea"]),pTag=new Set(["p"]),tableSectionTags=new Set(["thead","tbody"]),ddtTags=new Set(["dd","dt"]),rtpTags=new Set(["rt","rp"]),openImpliesClose=new Map([["tr",new Set(["tr","th","td"])],["th",new Set(["th"])],["td",new Set(["thead","th","td"])],["body",new Set(["head","link","script"])],["li",new Set(["li"])],["p",pTag],["h1",pTag],["h2",pTag],["h3",pTag],["h4",pTag],["h5",pTag],["h6",pTag],["select",formTags],["input",formTags],["output",formTags],["button",formTags],["datalist",formTags],["textarea",formTags],["option",new Set(["option"])],["optgroup",new Set(["optgroup","option"])],["dd",ddtTags],["dt",ddtTags],["address",pTag],["article",pTag],["aside",pTag],["blockquote",pTag],["details",pTag],["div",pTag],["dl",pTag],["fieldset",pTag],["figcaption",pTag],["figure",pTag],["footer",pTag],["form",pTag],["header",pTag],["hr",pTag],["main",pTag],["nav",pTag],["ol",pTag],["pre",pTag],["section",pTag],["table",pTag],["ul",pTag],["rt",rtpTags],["rp",rtpTags],["tbody",tableSectionTags],["tfoot",tableSectionTags]]),voidElements=new Set(["area","base","basefont","br","col","command","embed","frame","hr","img","input","isindex","keygen","link","meta","param","source","track","wbr"]),foreignContextElements=new Set(["math","svg"]),htmlIntegrationElements=new Set(["mi","mo","mn","ms","mtext","annotation-xml","foreignobject","desc","title"]),reNameEnd=/\s|\//,Parser$2=function(){function _r(Tr,Ar){Ar===void 0&&(Ar={});var Rr,Pr,Dr,Mr,Fr;this.options=Ar,this.startIndex=0,this.endIndex=0,this.openTagStart=0,this.tagname="",this.attribname="",this.attribvalue="",this.attribs=null,this.stack=[],this.foreignContext=[],this.buffers=[],this.bufferOffset=0,this.writeIndex=0,this.ended=!1,this.cbs=Tr??{},this.lowerCaseTagNames=(Rr=Ar.lowerCaseTags)!==null&&Rr!==void 0?Rr:!Ar.xmlMode,this.lowerCaseAttributeNames=(Pr=Ar.lowerCaseAttributeNames)!==null&&Pr!==void 0?Pr:!Ar.xmlMode,this.tokenizer=new((Dr=Ar.Tokenizer)!==null&&Dr!==void 0?Dr:Tokenizer_js_1.default)(this.options,this),(Fr=(Mr=this.cbs).onparserinit)===null||Fr===void 0||Fr.call(Mr,this)}return _r.prototype.ontext=function(Tr,Ar){var Rr,Pr,Dr=this.getSlice(Tr,Ar);this.endIndex=Ar-1,(Pr=(Rr=this.cbs).ontext)===null||Pr===void 0||Pr.call(Rr,Dr),this.startIndex=Ar},_r.prototype.ontextentity=function(Tr){var Ar,Rr,Pr=this.tokenizer.getSectionStart();this.endIndex=Pr-1,(Rr=(Ar=this.cbs).ontext)===null||Rr===void 0||Rr.call(Ar,(0,decode_js_1.fromCodePoint)(Tr)),this.startIndex=Pr},_r.prototype.isVoidElement=function(Tr){return!this.options.xmlMode&&voidElements.has(Tr)},_r.prototype.onopentagname=function(Tr,Ar){this.endIndex=Ar;var Rr=this.getSlice(Tr,Ar);this.lowerCaseTagNames&&(Rr=Rr.toLowerCase()),this.emitOpenTag(Rr)},_r.prototype.emitOpenTag=function(Tr){var Ar,Rr,Pr,Dr;this.openTagStart=this.startIndex,this.tagname=Tr;var Mr=!this.options.xmlMode&&openImpliesClose.get(Tr);if(Mr)for(;this.stack.length>0&&Mr.has(this.stack[this.stack.length-1]);){var Fr=this.stack.pop();(Rr=(Ar=this.cbs).onclosetag)===null||Rr===void 0||Rr.call(Ar,Fr,!0)}this.isVoidElement(Tr)||(this.stack.push(Tr),foreignContextElements.has(Tr)?this.foreignContext.push(!0):htmlIntegrationElements.has(Tr)&&this.foreignContext.push(!1)),(Dr=(Pr=this.cbs).onopentagname)===null||Dr===void 0||Dr.call(Pr,Tr),this.cbs.onopentag&&(this.attribs={})},_r.prototype.endOpenTag=function(Tr){var Ar,Rr;this.startIndex=this.openTagStart,this.attribs&&((Rr=(Ar=this.cbs).onopentag)===null||Rr===void 0||Rr.call(Ar,this.tagname,this.attribs,Tr),this.attribs=null),this.cbs.onclosetag&&this.isVoidElement(this.tagname)&&this.cbs.onclosetag(this.tagname,!0),this.tagname=""},_r.prototype.onopentagend=function(Tr){this.endIndex=Tr,this.endOpenTag(!1),this.startIndex=Tr+1},_r.prototype.onclosetag=function(Tr,Ar){var Rr,Pr,Dr,Mr,Fr,zr;this.endIndex=Ar;var jr=this.getSlice(Tr,Ar);if(this.lowerCaseTagNames&&(jr=jr.toLowerCase()),(foreignContextElements.has(jr)||htmlIntegrationElements.has(jr))&&this.foreignContext.pop(),this.isVoidElement(jr))!this.options.xmlMode&&jr==="br"&&((Pr=(Rr=this.cbs).onopentagname)===null||Pr===void 0||Pr.call(Rr,"br"),(Mr=(Dr=this.cbs).onopentag)===null||Mr===void 0||Mr.call(Dr,"br",{},!0),(zr=(Fr=this.cbs).onclosetag)===null||zr===void 0||zr.call(Fr,"br",!1));else{var Gr=this.stack.lastIndexOf(jr);if(Gr!==-1)if(this.cbs.onclosetag)for(var Nr=this.stack.length-Gr;Nr--;)this.cbs.onclosetag(this.stack.pop(),Nr!==0);else this.stack.length=Gr;else!this.options.xmlMode&&jr==="p"&&(this.emitOpenTag("p"),this.closeCurrentTag(!0))}this.startIndex=Ar+1},_r.prototype.onselfclosingtag=function(Tr){this.endIndex=Tr,this.options.xmlMode||this.options.recognizeSelfClosing||this.foreignContext[this.foreignContext.length-1]?(this.closeCurrentTag(!1),this.startIndex=Tr+1):this.onopentagend(Tr)},_r.prototype.closeCurrentTag=function(Tr){var Ar,Rr,Pr=this.tagname;this.endOpenTag(Tr),this.stack[this.stack.length-1]===Pr&&((Rr=(Ar=this.cbs).onclosetag)===null||Rr===void 0||Rr.call(Ar,Pr,!Tr),this.stack.pop())},_r.prototype.onattribname=function(Tr,Ar){this.startIndex=Tr;var Rr=this.getSlice(Tr,Ar);this.attribname=this.lowerCaseAttributeNames?Rr.toLowerCase():Rr},_r.prototype.onattribdata=function(Tr,Ar){this.attribvalue+=this.getSlice(Tr,Ar)},_r.prototype.onattribentity=function(Tr){this.attribvalue+=(0,decode_js_1.fromCodePoint)(Tr)},_r.prototype.onattribend=function(Tr,Ar){var Rr,Pr;this.endIndex=Ar,(Pr=(Rr=this.cbs).onattribute)===null||Pr===void 0||Pr.call(Rr,this.attribname,this.attribvalue,Tr===Tokenizer_js_1.QuoteType.Double?'"':Tr===Tokenizer_js_1.QuoteType.Single?"'":Tr===Tokenizer_js_1.QuoteType.NoValue?void 0:null),this.attribs&&!Object.prototype.hasOwnProperty.call(this.attribs,this.attribname)&&(this.attribs[this.attribname]=this.attribvalue),this.attribvalue=""},_r.prototype.getInstructionName=function(Tr){var Ar=Tr.search(reNameEnd),Rr=Ar<0?Tr:Tr.substr(0,Ar);return this.lowerCaseTagNames&&(Rr=Rr.toLowerCase()),Rr},_r.prototype.ondeclaration=function(Tr,Ar){this.endIndex=Ar;var Rr=this.getSlice(Tr,Ar);if(this.cbs.onprocessinginstruction){var Pr=this.getInstructionName(Rr);this.cbs.onprocessinginstruction("!".concat(Pr),"!".concat(Rr))}this.startIndex=Ar+1},_r.prototype.onprocessinginstruction=function(Tr,Ar){this.endIndex=Ar;var Rr=this.getSlice(Tr,Ar);if(this.cbs.onprocessinginstruction){var Pr=this.getInstructionName(Rr);this.cbs.onprocessinginstruction("?".concat(Pr),"?".concat(Rr))}this.startIndex=Ar+1},_r.prototype.oncomment=function(Tr,Ar,Rr){var Pr,Dr,Mr,Fr;this.endIndex=Ar,(Dr=(Pr=this.cbs).oncomment)===null||Dr===void 0||Dr.call(Pr,this.getSlice(Tr,Ar-Rr)),(Fr=(Mr=this.cbs).oncommentend)===null||Fr===void 0||Fr.call(Mr),this.startIndex=Ar+1},_r.prototype.oncdata=function(Tr,Ar,Rr){var Pr,Dr,Mr,Fr,zr,jr,Gr,Nr,Lr,Ur;this.endIndex=Ar;var Vr=this.getSlice(Tr,Ar-Rr);this.options.xmlMode||this.options.recognizeCDATA?((Dr=(Pr=this.cbs).oncdatastart)===null||Dr===void 0||Dr.call(Pr),(Fr=(Mr=this.cbs).ontext)===null||Fr===void 0||Fr.call(Mr,Vr),(jr=(zr=this.cbs).oncdataend)===null||jr===void 0||jr.call(zr)):((Nr=(Gr=this.cbs).oncomment)===null||Nr===void 0||Nr.call(Gr,"[CDATA[".concat(Vr,"]]")),(Ur=(Lr=this.cbs).oncommentend)===null||Ur===void 0||Ur.call(Lr)),this.startIndex=Ar+1},_r.prototype.onend=function(){var Tr,Ar;if(this.cbs.onclosetag){this.endIndex=this.startIndex;for(var Rr=this.stack.length;Rr>0;this.cbs.onclosetag(this.stack[--Rr],!0));}(Ar=(Tr=this.cbs).onend)===null||Ar===void 0||Ar.call(Tr)},_r.prototype.reset=function(){var Tr,Ar,Rr,Pr;(Ar=(Tr=this.cbs).onreset)===null||Ar===void 0||Ar.call(Tr),this.tokenizer.reset(),this.tagname="",this.attribname="",this.attribs=null,this.stack.length=0,this.startIndex=0,this.endIndex=0,(Pr=(Rr=this.cbs).onparserinit)===null||Pr===void 0||Pr.call(Rr,this),this.buffers.length=0,this.bufferOffset=0,this.writeIndex=0,this.ended=!1},_r.prototype.parseComplete=function(Tr){this.reset(),this.end(Tr)},_r.prototype.getSlice=function(Tr,Ar){for(;Tr-this.bufferOffset>=this.buffers[0].length;)this.shiftBuffer();for(var Rr=this.buffers[0].slice(Tr-this.bufferOffset,Ar-this.bufferOffset);Ar-this.bufferOffset>this.buffers[0].length;)this.shiftBuffer(),Rr+=this.buffers[0].slice(0,Ar-this.bufferOffset);return Rr},_r.prototype.shiftBuffer=function(){this.bufferOffset+=this.buffers[0].length,this.writeIndex--,this.buffers.shift()},_r.prototype.write=function(Tr){var Ar,Rr;if(this.ended){(Rr=(Ar=this.cbs).onerror)===null||Rr===void 0||Rr.call(Ar,new Error(".write() after done!"));return}this.buffers.push(Tr),this.tokenizer.running&&(this.tokenizer.write(Tr),this.writeIndex++)},_r.prototype.end=function(Tr){var Ar,Rr;if(this.ended){(Rr=(Ar=this.cbs).onerror)===null||Rr===void 0||Rr.call(Ar,new Error(".end() after done!"));return}Tr&&this.write(Tr),this.ended=!0,this.tokenizer.end()},_r.prototype.pause=function(){this.tokenizer.pause()},_r.prototype.resume=function(){for(this.tokenizer.resume();this.tokenizer.running&&this.writeIndex<this.buffers.length;)this.tokenizer.write(this.buffers[this.writeIndex++]);this.ended&&this.tokenizer.end()},_r.prototype.parseChunk=function(Tr){this.write(Tr)},_r.prototype.done=function(Tr){this.end(Tr)},_r}();Parser$3.Parser=Parser$2;var lib$4={},lib$3={};(function(_r){Object.defineProperty(_r,"__esModule",{value:!0}),_r.Doctype=_r.CDATA=_r.Tag=_r.Style=_r.Script=_r.Comment=_r.Directive=_r.Text=_r.Root=_r.isTag=_r.ElementType=void 0;var Tr;(function(Rr){Rr.Root="root",Rr.Text="text",Rr.Directive="directive",Rr.Comment="comment",Rr.Script="script",Rr.Style="style",Rr.Tag="tag",Rr.CDATA="cdata",Rr.Doctype="doctype"})(Tr=_r.ElementType||(_r.ElementType={}));function Ar(Rr){return Rr.type===Tr.Tag||Rr.type===Tr.Script||Rr.type===Tr.Style}_r.isTag=Ar,_r.Root=Tr.Root,_r.Text=Tr.Text,_r.Directive=Tr.Directive,_r.Comment=Tr.Comment,_r.Script=Tr.Script,_r.Style=Tr.Style,_r.Tag=Tr.Tag,_r.CDATA=Tr.CDATA,_r.Doctype=Tr.Doctype})(lib$3);var node$1={},__extends=commonjsGlobal&&commonjsGlobal.__extends||function(){var _r=function(Tr,Ar){return _r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(Rr,Pr){Rr.__proto__=Pr}||function(Rr,Pr){for(var Dr in Pr)Object.prototype.hasOwnProperty.call(Pr,Dr)&&(Rr[Dr]=Pr[Dr])},_r(Tr,Ar)};return function(Tr,Ar){if(typeof Ar!="function"&&Ar!==null)throw new TypeError("Class extends value "+String(Ar)+" is not a constructor or null");_r(Tr,Ar);function Rr(){this.constructor=Tr}Tr.prototype=Ar===null?Object.create(Ar):(Rr.prototype=Ar.prototype,new Rr)}}(),__assign$2=commonjsGlobal&&commonjsGlobal.__assign||function(){return __assign$2=Object.assign||function(_r){for(var Tr,Ar=1,Rr=arguments.length;Ar<Rr;Ar++){Tr=arguments[Ar];for(var Pr in Tr)Object.prototype.hasOwnProperty.call(Tr,Pr)&&(_r[Pr]=Tr[Pr])}return _r},__assign$2.apply(this,arguments)};Object.defineProperty(node$1,"__esModule",{value:!0});node$1.cloneNode=node$1.hasChildren=node$1.isDocument=node$1.isDirective=node$1.isComment=node$1.isText=node$1.isCDATA=node$1.isTag=node$1.Element=node$1.Document=node$1.CDATA=node$1.NodeWithChildren=node$1.ProcessingInstruction=node$1.Comment=node$1.Text=node$1.DataNode=node$1.Node=void 0;var domelementtype_1$1=lib$3,Node$6=function(){function _r(){this.parent=null,this.prev=null,this.next=null,this.startIndex=null,this.endIndex=null}return Object.defineProperty(_r.prototype,"parentNode",{get:function(){return this.parent},set:function(Tr){this.parent=Tr},enumerable:!1,configurable:!0}),Object.defineProperty(_r.prototype,"previousSibling",{get:function(){return this.prev},set:function(Tr){this.prev=Tr},enumerable:!1,configurable:!0}),Object.defineProperty(_r.prototype,"nextSibling",{get:function(){return this.next},set:function(Tr){this.next=Tr},enumerable:!1,configurable:!0}),_r.prototype.cloneNode=function(Tr){return Tr===void 0&&(Tr=!1),cloneNode$1(this,Tr)},_r}();node$1.Node=Node$6;var DataNode=function(_r){__extends(Tr,_r);function Tr(Ar){var Rr=_r.call(this)||this;return Rr.data=Ar,Rr}return Object.defineProperty(Tr.prototype,"nodeValue",{get:function(){return this.data},set:function(Ar){this.data=Ar},enumerable:!1,configurable:!0}),Tr}(Node$6);node$1.DataNode=DataNode;var Text=function(_r){__extends(Tr,_r);function Tr(){var Ar=_r!==null&&_r.apply(this,arguments)||this;return Ar.type=domelementtype_1$1.ElementType.Text,Ar}return Object.defineProperty(Tr.prototype,"nodeType",{get:function(){return 3},enumerable:!1,configurable:!0}),Tr}(DataNode);node$1.Text=Text;var Comment$5=function(_r){__extends(Tr,_r);function Tr(){var Ar=_r!==null&&_r.apply(this,arguments)||this;return Ar.type=domelementtype_1$1.ElementType.Comment,Ar}return Object.defineProperty(Tr.prototype,"nodeType",{get:function(){return 8},enumerable:!1,configurable:!0}),Tr}(DataNode);node$1.Comment=Comment$5;var ProcessingInstruction=function(_r){__extends(Tr,_r);function Tr(Ar,Rr){var Pr=_r.call(this,Rr)||this;return Pr.name=Ar,Pr.type=domelementtype_1$1.ElementType.Directive,Pr}return Object.defineProperty(Tr.prototype,"nodeType",{get:function(){return 1},enumerable:!1,configurable:!0}),Tr}(DataNode);node$1.ProcessingInstruction=ProcessingInstruction;var NodeWithChildren=function(_r){__extends(Tr,_r);function Tr(Ar){var Rr=_r.call(this)||this;return Rr.children=Ar,Rr}return Object.defineProperty(Tr.prototype,"firstChild",{get:function(){var Ar;return(Ar=this.children[0])!==null&&Ar!==void 0?Ar:null},enumerable:!1,configurable:!0}),Object.defineProperty(Tr.prototype,"lastChild",{get:function(){return this.children.length>0?this.children[this.children.length-1]:null},enumerable:!1,configurable:!0}),Object.defineProperty(Tr.prototype,"childNodes",{get:function(){return this.children},set:function(Ar){this.children=Ar},enumerable:!1,configurable:!0}),Tr}(Node$6);node$1.NodeWithChildren=NodeWithChildren;var CDATA=function(_r){__extends(Tr,_r);function Tr(){var Ar=_r!==null&&_r.apply(this,arguments)||this;return Ar.type=domelementtype_1$1.ElementType.CDATA,Ar}return Object.defineProperty(Tr.prototype,"nodeType",{get:function(){return 4},enumerable:!1,configurable:!0}),Tr}(NodeWithChildren);node$1.CDATA=CDATA;var Document$4=function(_r){__extends(Tr,_r);function Tr(){var Ar=_r!==null&&_r.apply(this,arguments)||this;return Ar.type=domelementtype_1$1.ElementType.Root,Ar}return Object.defineProperty(Tr.prototype,"nodeType",{get:function(){return 9},enumerable:!1,configurable:!0}),Tr}(NodeWithChildren);node$1.Document=Document$4;var Element$1=function(_r){__extends(Tr,_r);function Tr(Ar,Rr,Pr,Dr){Pr===void 0&&(Pr=[]),Dr===void 0&&(Dr=Ar==="script"?domelementtype_1$1.ElementType.Script:Ar==="style"?domelementtype_1$1.ElementType.Style:domelementtype_1$1.ElementType.Tag);var Mr=_r.call(this,Pr)||this;return Mr.name=Ar,Mr.attribs=Rr,Mr.type=Dr,Mr}return Object.defineProperty(Tr.prototype,"nodeType",{get:function(){return 1},enumerable:!1,configurable:!0}),Object.defineProperty(Tr.prototype,"tagName",{get:function(){return this.name},set:function(Ar){this.name=Ar},enumerable:!1,configurable:!0}),Object.defineProperty(Tr.prototype,"attributes",{get:function(){var Ar=this;return Object.keys(this.attribs).map(function(Rr){var Pr,Dr;return{name:Rr,value:Ar.attribs[Rr],namespace:(Pr=Ar["x-attribsNamespace"])===null||Pr===void 0?void 0:Pr[Rr],prefix:(Dr=Ar["x-attribsPrefix"])===null||Dr===void 0?void 0:Dr[Rr]}})},enumerable:!1,configurable:!0}),Tr}(NodeWithChildren);node$1.Element=Element$1;function isTag(_r){return(0,domelementtype_1$1.isTag)(_r)}node$1.isTag=isTag;function isCDATA(_r){return _r.type===domelementtype_1$1.ElementType.CDATA}node$1.isCDATA=isCDATA;function isText(_r){return _r.type===domelementtype_1$1.ElementType.Text}node$1.isText=isText;function isComment(_r){return _r.type===domelementtype_1$1.ElementType.Comment}node$1.isComment=isComment;function isDirective(_r){return _r.type===domelementtype_1$1.ElementType.Directive}node$1.isDirective=isDirective;function isDocument(_r){return _r.type===domelementtype_1$1.ElementType.Root}node$1.isDocument=isDocument;function hasChildren(_r){return Object.prototype.hasOwnProperty.call(_r,"children")}node$1.hasChildren=hasChildren;function cloneNode$1(_r,Tr){Tr===void 0&&(Tr=!1);var Ar;if(isText(_r))Ar=new Text(_r.data);else if(isComment(_r))Ar=new Comment$5(_r.data);else if(isTag(_r)){var Rr=Tr?cloneChildren(_r.children):[],Pr=new Element$1(_r.name,__assign$2({},_r.attribs),Rr);Rr.forEach(function(zr){return zr.parent=Pr}),_r.namespace!=null&&(Pr.namespace=_r.namespace),_r["x-attribsNamespace"]&&(Pr["x-attribsNamespace"]=__assign$2({},_r["x-attribsNamespace"])),_r["x-attribsPrefix"]&&(Pr["x-attribsPrefix"]=__assign$2({},_r["x-attribsPrefix"])),Ar=Pr}else if(isCDATA(_r)){var Rr=Tr?cloneChildren(_r.children):[],Dr=new CDATA(Rr);Rr.forEach(function(jr){return jr.parent=Dr}),Ar=Dr}else if(isDocument(_r)){var Rr=Tr?cloneChildren(_r.children):[],Mr=new Document$4(Rr);Rr.forEach(function(jr){return jr.parent=Mr}),_r["x-mode"]&&(Mr["x-mode"]=_r["x-mode"]),Ar=Mr}else if(isDirective(_r)){var Fr=new ProcessingInstruction(_r.name,_r.data);_r["x-name"]!=null&&(Fr["x-name"]=_r["x-name"],Fr["x-publicId"]=_r["x-publicId"],Fr["x-systemId"]=_r["x-systemId"]),Ar=Fr}else throw new Error("Not implemented yet: ".concat(_r.type));return Ar.startIndex=_r.startIndex,Ar.endIndex=_r.endIndex,_r.sourceCodeLocation!=null&&(Ar.sourceCodeLocation=_r.sourceCodeLocation),Ar}node$1.cloneNode=cloneNode$1;function cloneChildren(_r){for(var Tr=_r.map(function(Rr){return cloneNode$1(Rr,!0)}),Ar=1;Ar<Tr.length;Ar++)Tr[Ar].prev=Tr[Ar-1],Tr[Ar-1].next=Tr[Ar];return Tr}(function(_r){var Tr=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(Fr,zr,jr,Gr){Gr===void 0&&(Gr=jr);var Nr=Object.getOwnPropertyDescriptor(zr,jr);(!Nr||("get"in Nr?!zr.__esModule:Nr.writable||Nr.configurable))&&(Nr={enumerable:!0,get:function(){return zr[jr]}}),Object.defineProperty(Fr,Gr,Nr)}:function(Fr,zr,jr,Gr){Gr===void 0&&(Gr=jr),Fr[Gr]=zr[jr]}),Ar=commonjsGlobal&&commonjsGlobal.__exportStar||function(Fr,zr){for(var jr in Fr)jr!=="default"&&!Object.prototype.hasOwnProperty.call(zr,jr)&&Tr(zr,Fr,jr)};Object.defineProperty(_r,"__esModule",{value:!0}),_r.DomHandler=void 0;var Rr=lib$3,Pr=node$1;Ar(node$1,_r);var Dr={withStartIndices:!1,withEndIndices:!1,xmlMode:!1},Mr=function(){function Fr(zr,jr,Gr){this.dom=[],this.root=new Pr.Document(this.dom),this.done=!1,this.tagStack=[this.root],this.lastNode=null,this.parser=null,typeof jr=="function"&&(Gr=jr,jr=Dr),typeof zr=="object"&&(jr=zr,zr=void 0),this.callback=zr??null,this.options=jr??Dr,this.elementCB=Gr??null}return Fr.prototype.onparserinit=function(zr){this.parser=zr},Fr.prototype.onreset=function(){this.dom=[],this.root=new Pr.Document(this.dom),this.done=!1,this.tagStack=[this.root],this.lastNode=null,this.parser=null},Fr.prototype.onend=function(){this.done||(this.done=!0,this.parser=null,this.handleCallback(null))},Fr.prototype.onerror=function(zr){this.handleCallback(zr)},Fr.prototype.onclosetag=function(){this.lastNode=null;var zr=this.tagStack.pop();this.options.withEndIndices&&(zr.endIndex=this.parser.endIndex),this.elementCB&&this.elementCB(zr)},Fr.prototype.onopentag=function(zr,jr){var Gr=this.options.xmlMode?Rr.ElementType.Tag:void 0,Nr=new Pr.Element(zr,jr,void 0,Gr);this.addNode(Nr),this.tagStack.push(Nr)},Fr.prototype.ontext=function(zr){var jr=this.lastNode;if(jr&&jr.type===Rr.ElementType.Text)jr.data+=zr,this.options.withEndIndices&&(jr.endIndex=this.parser.endIndex);else{var Gr=new Pr.Text(zr);this.addNode(Gr),this.lastNode=Gr}},Fr.prototype.oncomment=function(zr){if(this.lastNode&&this.lastNode.type===Rr.ElementType.Comment){this.lastNode.data+=zr;return}var jr=new Pr.Comment(zr);this.addNode(jr),this.lastNode=jr},Fr.prototype.oncommentend=function(){this.lastNode=null},Fr.prototype.oncdatastart=function(){var zr=new Pr.Text(""),jr=new Pr.CDATA([zr]);this.addNode(jr),zr.parent=jr,this.lastNode=zr},Fr.prototype.oncdataend=function(){this.lastNode=null},Fr.prototype.onprocessinginstruction=function(zr,jr){var Gr=new Pr.ProcessingInstruction(zr,jr);this.addNode(Gr)},Fr.prototype.handleCallback=function(zr){if(typeof this.callback=="function")this.callback(zr,this.dom);else if(zr)throw zr},Fr.prototype.addNode=function(zr){var jr=this.tagStack[this.tagStack.length-1],Gr=jr.children[jr.children.length-1];this.options.withStartIndices&&(zr.startIndex=this.parser.startIndex),this.options.withEndIndices&&(zr.endIndex=this.parser.endIndex),jr.children.push(zr),Gr&&(zr.prev=Gr,Gr.next=zr),zr.parent=jr,this.lastNode=null},Fr}();_r.DomHandler=Mr,_r.default=Mr})(lib$4);var lib$2={},stringify$5={},lib$1={},lib={},encode={},encodeHtml={};Object.defineProperty(encodeHtml,"__esModule",{value:!0});function restoreDiff(_r){for(var Tr=1;Tr<_r.length;Tr++)_r[Tr][0]+=_r[Tr-1][0]+1;return _r}encodeHtml.default=new Map(restoreDiff([[9,"&Tab;"],[0,"&NewLine;"],[22,"&excl;"],[0,"&quot;"],[0,"&num;"],[0,"&dollar;"],[0,"&percnt;"],[0,"&amp;"],[0,"&apos;"],[0,"&lpar;"],[0,"&rpar;"],[0,"&ast;"],[0,"&plus;"],[0,"&comma;"],[1,"&period;"],[0,"&sol;"],[10,"&colon;"],[0,"&semi;"],[0,{v:"&lt;",n:8402,o:"&nvlt;"}],[0,{v:"&equals;",n:8421,o:"&bne;"}],[0,{v:"&gt;",n:8402,o:"&nvgt;"}],[0,"&quest;"],[0,"&commat;"],[26,"&lbrack;"],[0,"&bsol;"],[0,"&rbrack;"],[0,"&Hat;"],[0,"&lowbar;"],[0,"&DiacriticalGrave;"],[5,{n:106,o:"&fjlig;"}],[20,"&lbrace;"],[0,"&verbar;"],[0,"&rbrace;"],[34,"&nbsp;"],[0,"&iexcl;"],[0,"&cent;"],[0,"&pound;"],[0,"&curren;"],[0,"&yen;"],[0,"&brvbar;"],[0,"&sect;"],[0,"&die;"],[0,"&copy;"],[0,"&ordf;"],[0,"&laquo;"],[0,"&not;"],[0,"&shy;"],[0,"&circledR;"],[0,"&macr;"],[0,"&deg;"],[0,"&PlusMinus;"],[0,"&sup2;"],[0,"&sup3;"],[0,"&acute;"],[0,"&micro;"],[0,"&para;"],[0,"&centerdot;"],[0,"&cedil;"],[0,"&sup1;"],[0,"&ordm;"],[0,"&raquo;"],[0,"&frac14;"],[0,"&frac12;"],[0,"&frac34;"],[0,"&iquest;"],[0,"&Agrave;"],[0,"&Aacute;"],[0,"&Acirc;"],[0,"&Atilde;"],[0,"&Auml;"],[0,"&angst;"],[0,"&AElig;"],[0,"&Ccedil;"],[0,"&Egrave;"],[0,"&Eacute;"],[0,"&Ecirc;"],[0,"&Euml;"],[0,"&Igrave;"],[0,"&Iacute;"],[0,"&Icirc;"],[0,"&Iuml;"],[0,"&ETH;"],[0,"&Ntilde;"],[0,"&Ograve;"],[0,"&Oacute;"],[0,"&Ocirc;"],[0,"&Otilde;"],[0,"&Ouml;"],[0,"&times;"],[0,"&Oslash;"],[0,"&Ugrave;"],[0,"&Uacute;"],[0,"&Ucirc;"],[0,"&Uuml;"],[0,"&Yacute;"],[0,"&THORN;"],[0,"&szlig;"],[0,"&agrave;"],[0,"&aacute;"],[0,"&acirc;"],[0,"&atilde;"],[0,"&auml;"],[0,"&aring;"],[0,"&aelig;"],[0,"&ccedil;"],[0,"&egrave;"],[0,"&eacute;"],[0,"&ecirc;"],[0,"&euml;"],[0,"&igrave;"],[0,"&iacute;"],[0,"&icirc;"],[0,"&iuml;"],[0,"&eth;"],[0,"&ntilde;"],[0,"&ograve;"],[0,"&oacute;"],[0,"&ocirc;"],[0,"&otilde;"],[0,"&ouml;"],[0,"&div;"],[0,"&oslash;"],[0,"&ugrave;"],[0,"&uacute;"],[0,"&ucirc;"],[0,"&uuml;"],[0,"&yacute;"],[0,"&thorn;"],[0,"&yuml;"],[0,"&Amacr;"],[0,"&amacr;"],[0,"&Abreve;"],[0,"&abreve;"],[0,"&Aogon;"],[0,"&aogon;"],[0,"&Cacute;"],[0,"&cacute;"],[0,"&Ccirc;"],[0,"&ccirc;"],[0,"&Cdot;"],[0,"&cdot;"],[0,"&Ccaron;"],[0,"&ccaron;"],[0,"&Dcaron;"],[0,"&dcaron;"],[0,"&Dstrok;"],[0,"&dstrok;"],[0,"&Emacr;"],[0,"&emacr;"],[2,"&Edot;"],[0,"&edot;"],[0,"&Eogon;"],[0,"&eogon;"],[0,"&Ecaron;"],[0,"&ecaron;"],[0,"&Gcirc;"],[0,"&gcirc;"],[0,"&Gbreve;"],[0,"&gbreve;"],[0,"&Gdot;"],[0,"&gdot;"],[0,"&Gcedil;"],[1,"&Hcirc;"],[0,"&hcirc;"],[0,"&Hstrok;"],[0,"&hstrok;"],[0,"&Itilde;"],[0,"&itilde;"],[0,"&Imacr;"],[0,"&imacr;"],[2,"&Iogon;"],[0,"&iogon;"],[0,"&Idot;"],[0,"&imath;"],[0,"&IJlig;"],[0,"&ijlig;"],[0,"&Jcirc;"],[0,"&jcirc;"],[0,"&Kcedil;"],[0,"&kcedil;"],[0,"&kgreen;"],[0,"&Lacute;"],[0,"&lacute;"],[0,"&Lcedil;"],[0,"&lcedil;"],[0,"&Lcaron;"],[0,"&lcaron;"],[0,"&Lmidot;"],[0,"&lmidot;"],[0,"&Lstrok;"],[0,"&lstrok;"],[0,"&Nacute;"],[0,"&nacute;"],[0,"&Ncedil;"],[0,"&ncedil;"],[0,"&Ncaron;"],[0,"&ncaron;"],[0,"&napos;"],[0,"&ENG;"],[0,"&eng;"],[0,"&Omacr;"],[0,"&omacr;"],[2,"&Odblac;"],[0,"&odblac;"],[0,"&OElig;"],[0,"&oelig;"],[0,"&Racute;"],[0,"&racute;"],[0,"&Rcedil;"],[0,"&rcedil;"],[0,"&Rcaron;"],[0,"&rcaron;"],[0,"&Sacute;"],[0,"&sacute;"],[0,"&Scirc;"],[0,"&scirc;"],[0,"&Scedil;"],[0,"&scedil;"],[0,"&Scaron;"],[0,"&scaron;"],[0,"&Tcedil;"],[0,"&tcedil;"],[0,"&Tcaron;"],[0,"&tcaron;"],[0,"&Tstrok;"],[0,"&tstrok;"],[0,"&Utilde;"],[0,"&utilde;"],[0,"&Umacr;"],[0,"&umacr;"],[0,"&Ubreve;"],[0,"&ubreve;"],[0,"&Uring;"],[0,"&uring;"],[0,"&Udblac;"],[0,"&udblac;"],[0,"&Uogon;"],[0,"&uogon;"],[0,"&Wcirc;"],[0,"&wcirc;"],[0,"&Ycirc;"],[0,"&ycirc;"],[0,"&Yuml;"],[0,"&Zacute;"],[0,"&zacute;"],[0,"&Zdot;"],[0,"&zdot;"],[0,"&Zcaron;"],[0,"&zcaron;"],[19,"&fnof;"],[34,"&imped;"],[63,"&gacute;"],[65,"&jmath;"],[142,"&circ;"],[0,"&caron;"],[16,"&breve;"],[0,"&DiacriticalDot;"],[0,"&ring;"],[0,"&ogon;"],[0,"&DiacriticalTilde;"],[0,"&dblac;"],[51,"&DownBreve;"],[127,"&Alpha;"],[0,"&Beta;"],[0,"&Gamma;"],[0,"&Delta;"],[0,"&Epsilon;"],[0,"&Zeta;"],[0,"&Eta;"],[0,"&Theta;"],[0,"&Iota;"],[0,"&Kappa;"],[0,"&Lambda;"],[0,"&Mu;"],[0,"&Nu;"],[0,"&Xi;"],[0,"&Omicron;"],[0,"&Pi;"],[0,"&Rho;"],[1,"&Sigma;"],[0,"&Tau;"],[0,"&Upsilon;"],[0,"&Phi;"],[0,"&Chi;"],[0,"&Psi;"],[0,"&ohm;"],[7,"&alpha;"],[0,"&beta;"],[0,"&gamma;"],[0,"&delta;"],[0,"&epsi;"],[0,"&zeta;"],[0,"&eta;"],[0,"&theta;"],[0,"&iota;"],[0,"&kappa;"],[0,"&lambda;"],[0,"&mu;"],[0,"&nu;"],[0,"&xi;"],[0,"&omicron;"],[0,"&pi;"],[0,"&rho;"],[0,"&sigmaf;"],[0,"&sigma;"],[0,"&tau;"],[0,"&upsi;"],[0,"&phi;"],[0,"&chi;"],[0,"&psi;"],[0,"&omega;"],[7,"&thetasym;"],[0,"&Upsi;"],[2,"&phiv;"],[0,"&piv;"],[5,"&Gammad;"],[0,"&digamma;"],[18,"&kappav;"],[0,"&rhov;"],[3,"&epsiv;"],[0,"&backepsilon;"],[10,"&IOcy;"],[0,"&DJcy;"],[0,"&GJcy;"],[0,"&Jukcy;"],[0,"&DScy;"],[0,"&Iukcy;"],[0,"&YIcy;"],[0,"&Jsercy;"],[0,"&LJcy;"],[0,"&NJcy;"],[0,"&TSHcy;"],[0,"&KJcy;"],[1,"&Ubrcy;"],[0,"&DZcy;"],[0,"&Acy;"],[0,"&Bcy;"],[0,"&Vcy;"],[0,"&Gcy;"],[0,"&Dcy;"],[0,"&IEcy;"],[0,"&ZHcy;"],[0,"&Zcy;"],[0,"&Icy;"],[0,"&Jcy;"],[0,"&Kcy;"],[0,"&Lcy;"],[0,"&Mcy;"],[0,"&Ncy;"],[0,"&Ocy;"],[0,"&Pcy;"],[0,"&Rcy;"],[0,"&Scy;"],[0,"&Tcy;"],[0,"&Ucy;"],[0,"&Fcy;"],[0,"&KHcy;"],[0,"&TScy;"],[0,"&CHcy;"],[0,"&SHcy;"],[0,"&SHCHcy;"],[0,"&HARDcy;"],[0,"&Ycy;"],[0,"&SOFTcy;"],[0,"&Ecy;"],[0,"&YUcy;"],[0,"&YAcy;"],[0,"&acy;"],[0,"&bcy;"],[0,"&vcy;"],[0,"&gcy;"],[0,"&dcy;"],[0,"&iecy;"],[0,"&zhcy;"],[0,"&zcy;"],[0,"&icy;"],[0,"&jcy;"],[0,"&kcy;"],[0,"&lcy;"],[0,"&mcy;"],[0,"&ncy;"],[0,"&ocy;"],[0,"&pcy;"],[0,"&rcy;"],[0,"&scy;"],[0,"&tcy;"],[0,"&ucy;"],[0,"&fcy;"],[0,"&khcy;"],[0,"&tscy;"],[0,"&chcy;"],[0,"&shcy;"],[0,"&shchcy;"],[0,"&hardcy;"],[0,"&ycy;"],[0,"&softcy;"],[0,"&ecy;"],[0,"&yucy;"],[0,"&yacy;"],[1,"&iocy;"],[0,"&djcy;"],[0,"&gjcy;"],[0,"&jukcy;"],[0,"&dscy;"],[0,"&iukcy;"],[0,"&yicy;"],[0,"&jsercy;"],[0,"&ljcy;"],[0,"&njcy;"],[0,"&tshcy;"],[0,"&kjcy;"],[1,"&ubrcy;"],[0,"&dzcy;"],[7074,"&ensp;"],[0,"&emsp;"],[0,"&emsp13;"],[0,"&emsp14;"],[1,"&numsp;"],[0,"&puncsp;"],[0,"&ThinSpace;"],[0,"&hairsp;"],[0,"&NegativeMediumSpace;"],[0,"&zwnj;"],[0,"&zwj;"],[0,"&lrm;"],[0,"&rlm;"],[0,"&dash;"],[2,"&ndash;"],[0,"&mdash;"],[0,"&horbar;"],[0,"&Verbar;"],[1,"&lsquo;"],[0,"&CloseCurlyQuote;"],[0,"&lsquor;"],[1,"&ldquo;"],[0,"&CloseCurlyDoubleQuote;"],[0,"&bdquo;"],[1,"&dagger;"],[0,"&Dagger;"],[0,"&bull;"],[2,"&nldr;"],[0,"&hellip;"],[9,"&permil;"],[0,"&pertenk;"],[0,"&prime;"],[0,"&Prime;"],[0,"&tprime;"],[0,"&backprime;"],[3,"&lsaquo;"],[0,"&rsaquo;"],[3,"&oline;"],[2,"&caret;"],[1,"&hybull;"],[0,"&frasl;"],[10,"&bsemi;"],[7,"&qprime;"],[7,{v:"&MediumSpace;",n:8202,o:"&ThickSpace;"}],[0,"&NoBreak;"],[0,"&af;"],[0,"&InvisibleTimes;"],[0,"&ic;"],[72,"&euro;"],[46,"&tdot;"],[0,"&DotDot;"],[37,"&complexes;"],[2,"&incare;"],[4,"&gscr;"],[0,"&hamilt;"],[0,"&Hfr;"],[0,"&Hopf;"],[0,"&planckh;"],[0,"&hbar;"],[0,"&imagline;"],[0,"&Ifr;"],[0,"&lagran;"],[0,"&ell;"],[1,"&naturals;"],[0,"&numero;"],[0,"&copysr;"],[0,"&weierp;"],[0,"&Popf;"],[0,"&Qopf;"],[0,"&realine;"],[0,"&real;"],[0,"&reals;"],[0,"&rx;"],[3,"&trade;"],[1,"&integers;"],[2,"&mho;"],[0,"&zeetrf;"],[0,"&iiota;"],[2,"&bernou;"],[0,"&Cayleys;"],[1,"&escr;"],[0,"&Escr;"],[0,"&Fouriertrf;"],[1,"&Mellintrf;"],[0,"&order;"],[0,"&alefsym;"],[0,"&beth;"],[0,"&gimel;"],[0,"&daleth;"],[12,"&CapitalDifferentialD;"],[0,"&dd;"],[0,"&ee;"],[0,"&ii;"],[10,"&frac13;"],[0,"&frac23;"],[0,"&frac15;"],[0,"&frac25;"],[0,"&frac35;"],[0,"&frac45;"],[0,"&frac16;"],[0,"&frac56;"],[0,"&frac18;"],[0,"&frac38;"],[0,"&frac58;"],[0,"&frac78;"],[49,"&larr;"],[0,"&ShortUpArrow;"],[0,"&rarr;"],[0,"&darr;"],[0,"&harr;"],[0,"&updownarrow;"],[0,"&nwarr;"],[0,"&nearr;"],[0,"&LowerRightArrow;"],[0,"&LowerLeftArrow;"],[0,"&nlarr;"],[0,"&nrarr;"],[1,{v:"&rarrw;",n:824,o:"&nrarrw;"}],[0,"&Larr;"],[0,"&Uarr;"],[0,"&Rarr;"],[0,"&Darr;"],[0,"&larrtl;"],[0,"&rarrtl;"],[0,"&LeftTeeArrow;"],[0,"&mapstoup;"],[0,"&map;"],[0,"&DownTeeArrow;"],[1,"&hookleftarrow;"],[0,"&hookrightarrow;"],[0,"&larrlp;"],[0,"&looparrowright;"],[0,"&harrw;"],[0,"&nharr;"],[1,"&lsh;"],[0,"&rsh;"],[0,"&ldsh;"],[0,"&rdsh;"],[1,"&crarr;"],[0,"&cularr;"],[0,"&curarr;"],[2,"&circlearrowleft;"],[0,"&circlearrowright;"],[0,"&leftharpoonup;"],[0,"&DownLeftVector;"],[0,"&RightUpVector;"],[0,"&LeftUpVector;"],[0,"&rharu;"],[0,"&DownRightVector;"],[0,"&dharr;"],[0,"&dharl;"],[0,"&RightArrowLeftArrow;"],[0,"&udarr;"],[0,"&LeftArrowRightArrow;"],[0,"&leftleftarrows;"],[0,"&upuparrows;"],[0,"&rightrightarrows;"],[0,"&ddarr;"],[0,"&leftrightharpoons;"],[0,"&Equilibrium;"],[0,"&nlArr;"],[0,"&nhArr;"],[0,"&nrArr;"],[0,"&DoubleLeftArrow;"],[0,"&DoubleUpArrow;"],[0,"&DoubleRightArrow;"],[0,"&dArr;"],[0,"&DoubleLeftRightArrow;"],[0,"&DoubleUpDownArrow;"],[0,"&nwArr;"],[0,"&neArr;"],[0,"&seArr;"],[0,"&swArr;"],[0,"&lAarr;"],[0,"&rAarr;"],[1,"&zigrarr;"],[6,"&larrb;"],[0,"&rarrb;"],[15,"&DownArrowUpArrow;"],[7,"&loarr;"],[0,"&roarr;"],[0,"&hoarr;"],[0,"&forall;"],[0,"&comp;"],[0,{v:"&part;",n:824,o:"&npart;"}],[0,"&exist;"],[0,"&nexist;"],[0,"&empty;"],[1,"&Del;"],[0,"&Element;"],[0,"&NotElement;"],[1,"&ni;"],[0,"&notni;"],[2,"&prod;"],[0,"&coprod;"],[0,"&sum;"],[0,"&minus;"],[0,"&MinusPlus;"],[0,"&dotplus;"],[1,"&Backslash;"],[0,"&lowast;"],[0,"&compfn;"],[1,"&radic;"],[2,"&prop;"],[0,"&infin;"],[0,"&angrt;"],[0,{v:"&ang;",n:8402,o:"&nang;"}],[0,"&angmsd;"],[0,"&angsph;"],[0,"&mid;"],[0,"&nmid;"],[0,"&DoubleVerticalBar;"],[0,"&NotDoubleVerticalBar;"],[0,"&and;"],[0,"&or;"],[0,{v:"&cap;",n:65024,o:"&caps;"}],[0,{v:"&cup;",n:65024,o:"&cups;"}],[0,"&int;"],[0,"&Int;"],[0,"&iiint;"],[0,"&conint;"],[0,"&Conint;"],[0,"&Cconint;"],[0,"&cwint;"],[0,"&ClockwiseContourIntegral;"],[0,"&awconint;"],[0,"&there4;"],[0,"&becaus;"],[0,"&ratio;"],[0,"&Colon;"],[0,"&dotminus;"],[1,"&mDDot;"],[0,"&homtht;"],[0,{v:"&sim;",n:8402,o:"&nvsim;"}],[0,{v:"&backsim;",n:817,o:"&race;"}],[0,{v:"&ac;",n:819,o:"&acE;"}],[0,"&acd;"],[0,"&VerticalTilde;"],[0,"&NotTilde;"],[0,{v:"&eqsim;",n:824,o:"&nesim;"}],[0,"&sime;"],[0,"&NotTildeEqual;"],[0,"&cong;"],[0,"&simne;"],[0,"&ncong;"],[0,"&ap;"],[0,"&nap;"],[0,"&ape;"],[0,{v:"&apid;",n:824,o:"&napid;"}],[0,"&backcong;"],[0,{v:"&asympeq;",n:8402,o:"&nvap;"}],[0,{v:"&bump;",n:824,o:"&nbump;"}],[0,{v:"&bumpe;",n:824,o:"&nbumpe;"}],[0,{v:"&doteq;",n:824,o:"&nedot;"}],[0,"&doteqdot;"],[0,"&efDot;"],[0,"&erDot;"],[0,"&Assign;"],[0,"&ecolon;"],[0,"&ecir;"],[0,"&circeq;"],[1,"&wedgeq;"],[0,"&veeeq;"],[1,"&triangleq;"],[2,"&equest;"],[0,"&ne;"],[0,{v:"&Congruent;",n:8421,o:"&bnequiv;"}],[0,"&nequiv;"],[1,{v:"&le;",n:8402,o:"&nvle;"}],[0,{v:"&ge;",n:8402,o:"&nvge;"}],[0,{v:"&lE;",n:824,o:"&nlE;"}],[0,{v:"&gE;",n:824,o:"&ngE;"}],[0,{v:"&lnE;",n:65024,o:"&lvertneqq;"}],[0,{v:"&gnE;",n:65024,o:"&gvertneqq;"}],[0,{v:"&ll;",n:new Map(restoreDiff([[824,"&nLtv;"],[7577,"&nLt;"]]))}],[0,{v:"&gg;",n:new Map(restoreDiff([[824,"&nGtv;"],[7577,"&nGt;"]]))}],[0,"&between;"],[0,"&NotCupCap;"],[0,"&nless;"],[0,"&ngt;"],[0,"&nle;"],[0,"&nge;"],[0,"&lesssim;"],[0,"&GreaterTilde;"],[0,"&nlsim;"],[0,"&ngsim;"],[0,"&LessGreater;"],[0,"&gl;"],[0,"&NotLessGreater;"],[0,"&NotGreaterLess;"],[0,"&pr;"],[0,"&sc;"],[0,"&prcue;"],[0,"&sccue;"],[0,"&PrecedesTilde;"],[0,{v:"&scsim;",n:824,o:"&NotSucceedsTilde;"}],[0,"&NotPrecedes;"],[0,"&NotSucceeds;"],[0,{v:"&sub;",n:8402,o:"&NotSubset;"}],[0,{v:"&sup;",n:8402,o:"&NotSuperset;"}],[0,"&nsub;"],[0,"&nsup;"],[0,"&sube;"],[0,"&supe;"],[0,"&NotSubsetEqual;"],[0,"&NotSupersetEqual;"],[0,{v:"&subne;",n:65024,o:"&varsubsetneq;"}],[0,{v:"&supne;",n:65024,o:"&varsupsetneq;"}],[1,"&cupdot;"],[0,"&UnionPlus;"],[0,{v:"&sqsub;",n:824,o:"&NotSquareSubset;"}],[0,{v:"&sqsup;",n:824,o:"&NotSquareSuperset;"}],[0,"&sqsube;"],[0,"&sqsupe;"],[0,{v:"&sqcap;",n:65024,o:"&sqcaps;"}],[0,{v:"&sqcup;",n:65024,o:"&sqcups;"}],[0,"&CirclePlus;"],[0,"&CircleMinus;"],[0,"&CircleTimes;"],[0,"&osol;"],[0,"&CircleDot;"],[0,"&circledcirc;"],[0,"&circledast;"],[1,"&circleddash;"],[0,"&boxplus;"],[0,"&boxminus;"],[0,"&boxtimes;"],[0,"&dotsquare;"],[0,"&RightTee;"],[0,"&dashv;"],[0,"&DownTee;"],[0,"&bot;"],[1,"&models;"],[0,"&DoubleRightTee;"],[0,"&Vdash;"],[0,"&Vvdash;"],[0,"&VDash;"],[0,"&nvdash;"],[0,"&nvDash;"],[0,"&nVdash;"],[0,"&nVDash;"],[0,"&prurel;"],[1,"&LeftTriangle;"],[0,"&RightTriangle;"],[0,{v:"&LeftTriangleEqual;",n:8402,o:"&nvltrie;"}],[0,{v:"&RightTriangleEqual;",n:8402,o:"&nvrtrie;"}],[0,"&origof;"],[0,"&imof;"],[0,"&multimap;"],[0,"&hercon;"],[0,"&intcal;"],[0,"&veebar;"],[1,"&barvee;"],[0,"&angrtvb;"],[0,"&lrtri;"],[0,"&bigwedge;"],[0,"&bigvee;"],[0,"&bigcap;"],[0,"&bigcup;"],[0,"&diam;"],[0,"&sdot;"],[0,"&sstarf;"],[0,"&divideontimes;"],[0,"&bowtie;"],[0,"&ltimes;"],[0,"&rtimes;"],[0,"&leftthreetimes;"],[0,"&rightthreetimes;"],[0,"&backsimeq;"],[0,"&curlyvee;"],[0,"&curlywedge;"],[0,"&Sub;"],[0,"&Sup;"],[0,"&Cap;"],[0,"&Cup;"],[0,"&fork;"],[0,"&epar;"],[0,"&lessdot;"],[0,"&gtdot;"],[0,{v:"&Ll;",n:824,o:"&nLl;"}],[0,{v:"&Gg;",n:824,o:"&nGg;"}],[0,{v:"&leg;",n:65024,o:"&lesg;"}],[0,{v:"&gel;",n:65024,o:"&gesl;"}],[2,"&cuepr;"],[0,"&cuesc;"],[0,"&NotPrecedesSlantEqual;"],[0,"&NotSucceedsSlantEqual;"],[0,"&NotSquareSubsetEqual;"],[0,"&NotSquareSupersetEqual;"],[2,"&lnsim;"],[0,"&gnsim;"],[0,"&precnsim;"],[0,"&scnsim;"],[0,"&nltri;"],[0,"&NotRightTriangle;"],[0,"&nltrie;"],[0,"&NotRightTriangleEqual;"],[0,"&vellip;"],[0,"&ctdot;"],[0,"&utdot;"],[0,"&dtdot;"],[0,"&disin;"],[0,"&isinsv;"],[0,"&isins;"],[0,{v:"&isindot;",n:824,o:"&notindot;"}],[0,"&notinvc;"],[0,"&notinvb;"],[1,{v:"&isinE;",n:824,o:"&notinE;"}],[0,"&nisd;"],[0,"&xnis;"],[0,"&nis;"],[0,"&notnivc;"],[0,"&notnivb;"],[6,"&barwed;"],[0,"&Barwed;"],[1,"&lceil;"],[0,"&rceil;"],[0,"&LeftFloor;"],[0,"&rfloor;"],[0,"&drcrop;"],[0,"&dlcrop;"],[0,"&urcrop;"],[0,"&ulcrop;"],[0,"&bnot;"],[1,"&profline;"],[0,"&profsurf;"],[1,"&telrec;"],[0,"&target;"],[5,"&ulcorn;"],[0,"&urcorn;"],[0,"&dlcorn;"],[0,"&drcorn;"],[2,"&frown;"],[0,"&smile;"],[9,"&cylcty;"],[0,"&profalar;"],[7,"&topbot;"],[6,"&ovbar;"],[1,"&solbar;"],[60,"&angzarr;"],[51,"&lmoustache;"],[0,"&rmoustache;"],[2,"&OverBracket;"],[0,"&bbrk;"],[0,"&bbrktbrk;"],[37,"&OverParenthesis;"],[0,"&UnderParenthesis;"],[0,"&OverBrace;"],[0,"&UnderBrace;"],[2,"&trpezium;"],[4,"&elinters;"],[59,"&blank;"],[164,"&circledS;"],[55,"&boxh;"],[1,"&boxv;"],[9,"&boxdr;"],[3,"&boxdl;"],[3,"&boxur;"],[3,"&boxul;"],[3,"&boxvr;"],[7,"&boxvl;"],[7,"&boxhd;"],[7,"&boxhu;"],[7,"&boxvh;"],[19,"&boxH;"],[0,"&boxV;"],[0,"&boxdR;"],[0,"&boxDr;"],[0,"&boxDR;"],[0,"&boxdL;"],[0,"&boxDl;"],[0,"&boxDL;"],[0,"&boxuR;"],[0,"&boxUr;"],[0,"&boxUR;"],[0,"&boxuL;"],[0,"&boxUl;"],[0,"&boxUL;"],[0,"&boxvR;"],[0,"&boxVr;"],[0,"&boxVR;"],[0,"&boxvL;"],[0,"&boxVl;"],[0,"&boxVL;"],[0,"&boxHd;"],[0,"&boxhD;"],[0,"&boxHD;"],[0,"&boxHu;"],[0,"&boxhU;"],[0,"&boxHU;"],[0,"&boxvH;"],[0,"&boxVh;"],[0,"&boxVH;"],[19,"&uhblk;"],[3,"&lhblk;"],[3,"&block;"],[8,"&blk14;"],[0,"&blk12;"],[0,"&blk34;"],[13,"&square;"],[8,"&blacksquare;"],[0,"&EmptyVerySmallSquare;"],[1,"&rect;"],[0,"&marker;"],[2,"&fltns;"],[1,"&bigtriangleup;"],[0,"&blacktriangle;"],[0,"&triangle;"],[2,"&blacktriangleright;"],[0,"&rtri;"],[3,"&bigtriangledown;"],[0,"&blacktriangledown;"],[0,"&dtri;"],[2,"&blacktriangleleft;"],[0,"&ltri;"],[6,"&loz;"],[0,"&cir;"],[32,"&tridot;"],[2,"&bigcirc;"],[8,"&ultri;"],[0,"&urtri;"],[0,"&lltri;"],[0,"&EmptySmallSquare;"],[0,"&FilledSmallSquare;"],[8,"&bigstar;"],[0,"&star;"],[7,"&phone;"],[49,"&female;"],[1,"&male;"],[29,"&spades;"],[2,"&clubs;"],[1,"&hearts;"],[0,"&diamondsuit;"],[3,"&sung;"],[2,"&flat;"],[0,"&natural;"],[0,"&sharp;"],[163,"&check;"],[3,"&cross;"],[8,"&malt;"],[21,"&sext;"],[33,"&VerticalSeparator;"],[25,"&lbbrk;"],[0,"&rbbrk;"],[84,"&bsolhsub;"],[0,"&suphsol;"],[28,"&LeftDoubleBracket;"],[0,"&RightDoubleBracket;"],[0,"&lang;"],[0,"&rang;"],[0,"&Lang;"],[0,"&Rang;"],[0,"&loang;"],[0,"&roang;"],[7,"&longleftarrow;"],[0,"&longrightarrow;"],[0,"&longleftrightarrow;"],[0,"&DoubleLongLeftArrow;"],[0,"&DoubleLongRightArrow;"],[0,"&DoubleLongLeftRightArrow;"],[1,"&longmapsto;"],[2,"&dzigrarr;"],[258,"&nvlArr;"],[0,"&nvrArr;"],[0,"&nvHarr;"],[0,"&Map;"],[6,"&lbarr;"],[0,"&bkarow;"],[0,"&lBarr;"],[0,"&dbkarow;"],[0,"&drbkarow;"],[0,"&DDotrahd;"],[0,"&UpArrowBar;"],[0,"&DownArrowBar;"],[2,"&Rarrtl;"],[2,"&latail;"],[0,"&ratail;"],[0,"&lAtail;"],[0,"&rAtail;"],[0,"&larrfs;"],[0,"&rarrfs;"],[0,"&larrbfs;"],[0,"&rarrbfs;"],[2,"&nwarhk;"],[0,"&nearhk;"],[0,"&hksearow;"],[0,"&hkswarow;"],[0,"&nwnear;"],[0,"&nesear;"],[0,"&seswar;"],[0,"&swnwar;"],[8,{v:"&rarrc;",n:824,o:"&nrarrc;"}],[1,"&cudarrr;"],[0,"&ldca;"],[0,"&rdca;"],[0,"&cudarrl;"],[0,"&larrpl;"],[2,"&curarrm;"],[0,"&cularrp;"],[7,"&rarrpl;"],[2,"&harrcir;"],[0,"&Uarrocir;"],[0,"&lurdshar;"],[0,"&ldrushar;"],[2,"&LeftRightVector;"],[0,"&RightUpDownVector;"],[0,"&DownLeftRightVector;"],[0,"&LeftUpDownVector;"],[0,"&LeftVectorBar;"],[0,"&RightVectorBar;"],[0,"&RightUpVectorBar;"],[0,"&RightDownVectorBar;"],[0,"&DownLeftVectorBar;"],[0,"&DownRightVectorBar;"],[0,"&LeftUpVectorBar;"],[0,"&LeftDownVectorBar;"],[0,"&LeftTeeVector;"],[0,"&RightTeeVector;"],[0,"&RightUpTeeVector;"],[0,"&RightDownTeeVector;"],[0,"&DownLeftTeeVector;"],[0,"&DownRightTeeVector;"],[0,"&LeftUpTeeVector;"],[0,"&LeftDownTeeVector;"],[0,"&lHar;"],[0,"&uHar;"],[0,"&rHar;"],[0,"&dHar;"],[0,"&luruhar;"],[0,"&ldrdhar;"],[0,"&ruluhar;"],[0,"&rdldhar;"],[0,"&lharul;"],[0,"&llhard;"],[0,"&rharul;"],[0,"&lrhard;"],[0,"&udhar;"],[0,"&duhar;"],[0,"&RoundImplies;"],[0,"&erarr;"],[0,"&simrarr;"],[0,"&larrsim;"],[0,"&rarrsim;"],[0,"&rarrap;"],[0,"&ltlarr;"],[1,"&gtrarr;"],[0,"&subrarr;"],[1,"&suplarr;"],[0,"&lfisht;"],[0,"&rfisht;"],[0,"&ufisht;"],[0,"&dfisht;"],[5,"&lopar;"],[0,"&ropar;"],[4,"&lbrke;"],[0,"&rbrke;"],[0,"&lbrkslu;"],[0,"&rbrksld;"],[0,"&lbrksld;"],[0,"&rbrkslu;"],[0,"&langd;"],[0,"&rangd;"],[0,"&lparlt;"],[0,"&rpargt;"],[0,"&gtlPar;"],[0,"&ltrPar;"],[3,"&vzigzag;"],[1,"&vangrt;"],[0,"&angrtvbd;"],[6,"&ange;"],[0,"&range;"],[0,"&dwangle;"],[0,"&uwangle;"],[0,"&angmsdaa;"],[0,"&angmsdab;"],[0,"&angmsdac;"],[0,"&angmsdad;"],[0,"&angmsdae;"],[0,"&angmsdaf;"],[0,"&angmsdag;"],[0,"&angmsdah;"],[0,"&bemptyv;"],[0,"&demptyv;"],[0,"&cemptyv;"],[0,"&raemptyv;"],[0,"&laemptyv;"],[0,"&ohbar;"],[0,"&omid;"],[0,"&opar;"],[1,"&operp;"],[1,"&olcross;"],[0,"&odsold;"],[1,"&olcir;"],[0,"&ofcir;"],[0,"&olt;"],[0,"&ogt;"],[0,"&cirscir;"],[0,"&cirE;"],[0,"&solb;"],[0,"&bsolb;"],[3,"&boxbox;"],[3,"&trisb;"],[0,"&rtriltri;"],[0,{v:"&LeftTriangleBar;",n:824,o:"&NotLeftTriangleBar;"}],[0,{v:"&RightTriangleBar;",n:824,o:"&NotRightTriangleBar;"}],[11,"&iinfin;"],[0,"&infintie;"],[0,"&nvinfin;"],[4,"&eparsl;"],[0,"&smeparsl;"],[0,"&eqvparsl;"],[5,"&blacklozenge;"],[8,"&RuleDelayed;"],[1,"&dsol;"],[9,"&bigodot;"],[0,"&bigoplus;"],[0,"&bigotimes;"],[1,"&biguplus;"],[1,"&bigsqcup;"],[5,"&iiiint;"],[0,"&fpartint;"],[2,"&cirfnint;"],[0,"&awint;"],[0,"&rppolint;"],[0,"&scpolint;"],[0,"&npolint;"],[0,"&pointint;"],[0,"&quatint;"],[0,"&intlarhk;"],[10,"&pluscir;"],[0,"&plusacir;"],[0,"&simplus;"],[0,"&plusdu;"],[0,"&plussim;"],[0,"&plustwo;"],[1,"&mcomma;"],[0,"&minusdu;"],[2,"&loplus;"],[0,"&roplus;"],[0,"&Cross;"],[0,"&timesd;"],[0,"&timesbar;"],[1,"&smashp;"],[0,"&lotimes;"],[0,"&rotimes;"],[0,"&otimesas;"],[0,"&Otimes;"],[0,"&odiv;"],[0,"&triplus;"],[0,"&triminus;"],[0,"&tritime;"],[0,"&intprod;"],[2,"&amalg;"],[0,"&capdot;"],[1,"&ncup;"],[0,"&ncap;"],[0,"&capand;"],[0,"&cupor;"],[0,"&cupcap;"],[0,"&capcup;"],[0,"&cupbrcap;"],[0,"&capbrcup;"],[0,"&cupcup;"],[0,"&capcap;"],[0,"&ccups;"],[0,"&ccaps;"],[2,"&ccupssm;"],[2,"&And;"],[0,"&Or;"],[0,"&andand;"],[0,"&oror;"],[0,"&orslope;"],[0,"&andslope;"],[1,"&andv;"],[0,"&orv;"],[0,"&andd;"],[0,"&ord;"],[1,"&wedbar;"],[6,"&sdote;"],[3,"&simdot;"],[2,{v:"&congdot;",n:824,o:"&ncongdot;"}],[0,"&easter;"],[0,"&apacir;"],[0,{v:"&apE;",n:824,o:"&napE;"}],[0,"&eplus;"],[0,"&pluse;"],[0,"&Esim;"],[0,"&Colone;"],[0,"&Equal;"],[1,"&ddotseq;"],[0,"&equivDD;"],[0,"&ltcir;"],[0,"&gtcir;"],[0,"&ltquest;"],[0,"&gtquest;"],[0,{v:"&leqslant;",n:824,o:"&nleqslant;"}],[0,{v:"&geqslant;",n:824,o:"&ngeqslant;"}],[0,"&lesdot;"],[0,"&gesdot;"],[0,"&lesdoto;"],[0,"&gesdoto;"],[0,"&lesdotor;"],[0,"&gesdotol;"],[0,"&lap;"],[0,"&gap;"],[0,"&lne;"],[0,"&gne;"],[0,"&lnap;"],[0,"&gnap;"],[0,"&lEg;"],[0,"&gEl;"],[0,"&lsime;"],[0,"&gsime;"],[0,"&lsimg;"],[0,"&gsiml;"],[0,"&lgE;"],[0,"&glE;"],[0,"&lesges;"],[0,"&gesles;"],[0,"&els;"],[0,"&egs;"],[0,"&elsdot;"],[0,"&egsdot;"],[0,"&el;"],[0,"&eg;"],[2,"&siml;"],[0,"&simg;"],[0,"&simlE;"],[0,"&simgE;"],[0,{v:"&LessLess;",n:824,o:"&NotNestedLessLess;"}],[0,{v:"&GreaterGreater;",n:824,o:"&NotNestedGreaterGreater;"}],[1,"&glj;"],[0,"&gla;"],[0,"&ltcc;"],[0,"&gtcc;"],[0,"&lescc;"],[0,"&gescc;"],[0,"&smt;"],[0,"&lat;"],[0,{v:"&smte;",n:65024,o:"&smtes;"}],[0,{v:"&late;",n:65024,o:"&lates;"}],[0,"&bumpE;"],[0,{v:"&PrecedesEqual;",n:824,o:"&NotPrecedesEqual;"}],[0,{v:"&sce;",n:824,o:"&NotSucceedsEqual;"}],[2,"&prE;"],[0,"&scE;"],[0,"&precneqq;"],[0,"&scnE;"],[0,"&prap;"],[0,"&scap;"],[0,"&precnapprox;"],[0,"&scnap;"],[0,"&Pr;"],[0,"&Sc;"],[0,"&subdot;"],[0,"&supdot;"],[0,"&subplus;"],[0,"&supplus;"],[0,"&submult;"],[0,"&supmult;"],[0,"&subedot;"],[0,"&supedot;"],[0,{v:"&subE;",n:824,o:"&nsubE;"}],[0,{v:"&supE;",n:824,o:"&nsupE;"}],[0,"&subsim;"],[0,"&supsim;"],[2,{v:"&subnE;",n:65024,o:"&varsubsetneqq;"}],[0,{v:"&supnE;",n:65024,o:"&varsupsetneqq;"}],[2,"&csub;"],[0,"&csup;"],[0,"&csube;"],[0,"&csupe;"],[0,"&subsup;"],[0,"&supsub;"],[0,"&subsub;"],[0,"&supsup;"],[0,"&suphsub;"],[0,"&supdsub;"],[0,"&forkv;"],[0,"&topfork;"],[0,"&mlcp;"],[8,"&Dashv;"],[1,"&Vdashl;"],[0,"&Barv;"],[0,"&vBar;"],[0,"&vBarv;"],[1,"&Vbar;"],[0,"&Not;"],[0,"&bNot;"],[0,"&rnmid;"],[0,"&cirmid;"],[0,"&midcir;"],[0,"&topcir;"],[0,"&nhpar;"],[0,"&parsim;"],[9,{v:"&parsl;",n:8421,o:"&nparsl;"}],[44343,{n:new Map(restoreDiff([[56476,"&Ascr;"],[1,"&Cscr;"],[0,"&Dscr;"],[2,"&Gscr;"],[2,"&Jscr;"],[0,"&Kscr;"],[2,"&Nscr;"],[0,"&Oscr;"],[0,"&Pscr;"],[0,"&Qscr;"],[1,"&Sscr;"],[0,"&Tscr;"],[0,"&Uscr;"],[0,"&Vscr;"],[0,"&Wscr;"],[0,"&Xscr;"],[0,"&Yscr;"],[0,"&Zscr;"],[0,"&ascr;"],[0,"&bscr;"],[0,"&cscr;"],[0,"&dscr;"],[1,"&fscr;"],[1,"&hscr;"],[0,"&iscr;"],[0,"&jscr;"],[0,"&kscr;"],[0,"&lscr;"],[0,"&mscr;"],[0,"&nscr;"],[1,"&pscr;"],[0,"&qscr;"],[0,"&rscr;"],[0,"&sscr;"],[0,"&tscr;"],[0,"&uscr;"],[0,"&vscr;"],[0,"&wscr;"],[0,"&xscr;"],[0,"&yscr;"],[0,"&zscr;"],[52,"&Afr;"],[0,"&Bfr;"],[1,"&Dfr;"],[0,"&Efr;"],[0,"&Ffr;"],[0,"&Gfr;"],[2,"&Jfr;"],[0,"&Kfr;"],[0,"&Lfr;"],[0,"&Mfr;"],[0,"&Nfr;"],[0,"&Ofr;"],[0,"&Pfr;"],[0,"&Qfr;"],[1,"&Sfr;"],[0,"&Tfr;"],[0,"&Ufr;"],[0,"&Vfr;"],[0,"&Wfr;"],[0,"&Xfr;"],[0,"&Yfr;"],[1,"&afr;"],[0,"&bfr;"],[0,"&cfr;"],[0,"&dfr;"],[0,"&efr;"],[0,"&ffr;"],[0,"&gfr;"],[0,"&hfr;"],[0,"&ifr;"],[0,"&jfr;"],[0,"&kfr;"],[0,"&lfr;"],[0,"&mfr;"],[0,"&nfr;"],[0,"&ofr;"],[0,"&pfr;"],[0,"&qfr;"],[0,"&rfr;"],[0,"&sfr;"],[0,"&tfr;"],[0,"&ufr;"],[0,"&vfr;"],[0,"&wfr;"],[0,"&xfr;"],[0,"&yfr;"],[0,"&zfr;"],[0,"&Aopf;"],[0,"&Bopf;"],[1,"&Dopf;"],[0,"&Eopf;"],[0,"&Fopf;"],[0,"&Gopf;"],[1,"&Iopf;"],[0,"&Jopf;"],[0,"&Kopf;"],[0,"&Lopf;"],[0,"&Mopf;"],[1,"&Oopf;"],[3,"&Sopf;"],[0,"&Topf;"],[0,"&Uopf;"],[0,"&Vopf;"],[0,"&Wopf;"],[0,"&Xopf;"],[0,"&Yopf;"],[1,"&aopf;"],[0,"&bopf;"],[0,"&copf;"],[0,"&dopf;"],[0,"&eopf;"],[0,"&fopf;"],[0,"&gopf;"],[0,"&hopf;"],[0,"&iopf;"],[0,"&jopf;"],[0,"&kopf;"],[0,"&lopf;"],[0,"&mopf;"],[0,"&nopf;"],[0,"&oopf;"],[0,"&popf;"],[0,"&qopf;"],[0,"&ropf;"],[0,"&sopf;"],[0,"&topf;"],[0,"&uopf;"],[0,"&vopf;"],[0,"&wopf;"],[0,"&xopf;"],[0,"&yopf;"],[0,"&zopf;"]]))}],[8906,"&fflig;"],[0,"&filig;"],[0,"&fllig;"],[0,"&ffilig;"],[0,"&ffllig;"]]));var _escape={};(function(_r){Object.defineProperty(_r,"__esModule",{value:!0}),_r.escapeText=_r.escapeAttribute=_r.escapeUTF8=_r.escape=_r.encodeXML=_r.getCodePoint=_r.xmlReplacer=void 0,_r.xmlReplacer=/["&'<>$\x80-\uFFFF]/g;var Tr=new Map([[34,"&quot;"],[38,"&amp;"],[39,"&apos;"],[60,"&lt;"],[62,"&gt;"]]);_r.getCodePoint=String.prototype.codePointAt!=null?function(Pr,Dr){return Pr.codePointAt(Dr)}:function(Pr,Dr){return(Pr.charCodeAt(Dr)&64512)===55296?(Pr.charCodeAt(Dr)-55296)*1024+Pr.charCodeAt(Dr+1)-56320+65536:Pr.charCodeAt(Dr)};function Ar(Pr){for(var Dr="",Mr=0,Fr;(Fr=_r.xmlReplacer.exec(Pr))!==null;){var zr=Fr.index,jr=Pr.charCodeAt(zr),Gr=Tr.get(jr);Gr!==void 0?(Dr+=Pr.substring(Mr,zr)+Gr,Mr=zr+1):(Dr+="".concat(Pr.substring(Mr,zr),"&#x").concat((0,_r.getCodePoint)(Pr,zr).toString(16),";"),Mr=_r.xmlReplacer.lastIndex+=+((jr&64512)===55296))}return Dr+Pr.substr(Mr)}_r.encodeXML=Ar,_r.escape=Ar;function Rr(Pr,Dr){return function(Fr){for(var zr,jr=0,Gr="";zr=Pr.exec(Fr);)jr!==zr.index&&(Gr+=Fr.substring(jr,zr.index)),Gr+=Dr.get(zr[0].charCodeAt(0)),jr=zr.index+1;return Gr+Fr.substring(jr)}}_r.escapeUTF8=Rr(/[&<>'"]/g,Tr),_r.escapeAttribute=Rr(/["&\u00A0]/g,new Map([[34,"&quot;"],[38,"&amp;"],[160,"&nbsp;"]])),_r.escapeText=Rr(/[&<>\u00A0]/g,new Map([[38,"&amp;"],[60,"&lt;"],[62,"&gt;"],[160,"&nbsp;"]]))})(_escape);var __importDefault$1=commonjsGlobal&&commonjsGlobal.__importDefault||function(_r){return _r&&_r.__esModule?_r:{default:_r}};Object.defineProperty(encode,"__esModule",{value:!0});encode.encodeNonAsciiHTML=encode.encodeHTML=void 0;var encode_html_js_1=__importDefault$1(encodeHtml),escape_js_1=_escape,htmlReplacer=/[\t\n!-,./:-@[-`\f{-}$\x80-\uFFFF]/g;function encodeHTML(_r){return encodeHTMLTrieRe(htmlReplacer,_r)}encode.encodeHTML=encodeHTML;function encodeNonAsciiHTML(_r){return encodeHTMLTrieRe(escape_js_1.xmlReplacer,_r)}encode.encodeNonAsciiHTML=encodeNonAsciiHTML;function encodeHTMLTrieRe(_r,Tr){for(var Ar="",Rr=0,Pr;(Pr=_r.exec(Tr))!==null;){var Dr=Pr.index;Ar+=Tr.substring(Rr,Dr);var Mr=Tr.charCodeAt(Dr),Fr=encode_html_js_1.default.get(Mr);if(typeof Fr=="object"){if(Dr+1<Tr.length){var zr=Tr.charCodeAt(Dr+1),jr=typeof Fr.n=="number"?Fr.n===zr?Fr.o:void 0:Fr.n.get(zr);if(jr!==void 0){Ar+=jr,Rr=_r.lastIndex+=1;continue}}Fr=Fr.v}if(Fr!==void 0)Ar+=Fr,Rr=Dr+1;else{var Gr=(0,escape_js_1.getCodePoint)(Tr,Dr);Ar+="&#x".concat(Gr.toString(16),";"),Rr=_r.lastIndex+=+(Gr!==Mr)}}return Ar+Tr.substr(Rr)}(function(_r){Object.defineProperty(_r,"__esModule",{value:!0}),_r.decodeXMLStrict=_r.decodeHTML5Strict=_r.decodeHTML4Strict=_r.decodeHTML5=_r.decodeHTML4=_r.decodeHTMLAttribute=_r.decodeHTMLStrict=_r.decodeHTML=_r.decodeXML=_r.DecodingMode=_r.EntityDecoder=_r.encodeHTML5=_r.encodeHTML4=_r.encodeNonAsciiHTML=_r.encodeHTML=_r.escapeText=_r.escapeAttribute=_r.escapeUTF8=_r.escape=_r.encodeXML=_r.encode=_r.decodeStrict=_r.decode=_r.EncodingMode=_r.EntityLevel=void 0;var Tr=decode,Ar=encode,Rr=_escape,Pr;(function(Lr){Lr[Lr.XML=0]="XML",Lr[Lr.HTML=1]="HTML"})(Pr=_r.EntityLevel||(_r.EntityLevel={}));var Dr;(function(Lr){Lr[Lr.UTF8=0]="UTF8",Lr[Lr.ASCII=1]="ASCII",Lr[Lr.Extensive=2]="Extensive",Lr[Lr.Attribute=3]="Attribute",Lr[Lr.Text=4]="Text"})(Dr=_r.EncodingMode||(_r.EncodingMode={}));function Mr(Lr,Ur){Ur===void 0&&(Ur=Pr.XML);var Vr=typeof Ur=="number"?Ur:Ur.level;if(Vr===Pr.HTML){var Wr=typeof Ur=="object"?Ur.mode:void 0;return(0,Tr.decodeHTML)(Lr,Wr)}return(0,Tr.decodeXML)(Lr)}_r.decode=Mr;function Fr(Lr,Ur){var Vr;Ur===void 0&&(Ur=Pr.XML);var Wr=typeof Ur=="number"?{level:Ur}:Ur;return(Vr=Wr.mode)!==null&&Vr!==void 0||(Wr.mode=Tr.DecodingMode.Strict),Mr(Lr,Wr)}_r.decodeStrict=Fr;function zr(Lr,Ur){Ur===void 0&&(Ur=Pr.XML);var Vr=typeof Ur=="number"?{level:Ur}:Ur;return Vr.mode===Dr.UTF8?(0,Rr.escapeUTF8)(Lr):Vr.mode===Dr.Attribute?(0,Rr.escapeAttribute)(Lr):Vr.mode===Dr.Text?(0,Rr.escapeText)(Lr):Vr.level===Pr.HTML?Vr.mode===Dr.ASCII?(0,Ar.encodeNonAsciiHTML)(Lr):(0,Ar.encodeHTML)(Lr):(0,Rr.encodeXML)(Lr)}_r.encode=zr;var jr=_escape;Object.defineProperty(_r,"encodeXML",{enumerable:!0,get:function(){return jr.encodeXML}}),Object.defineProperty(_r,"escape",{enumerable:!0,get:function(){return jr.escape}}),Object.defineProperty(_r,"escapeUTF8",{enumerable:!0,get:function(){return jr.escapeUTF8}}),Object.defineProperty(_r,"escapeAttribute",{enumerable:!0,get:function(){return jr.escapeAttribute}}),Object.defineProperty(_r,"escapeText",{enumerable:!0,get:function(){return jr.escapeText}});var Gr=encode;Object.defineProperty(_r,"encodeHTML",{enumerable:!0,get:function(){return Gr.encodeHTML}}),Object.defineProperty(_r,"encodeNonAsciiHTML",{enumerable:!0,get:function(){return Gr.encodeNonAsciiHTML}}),Object.defineProperty(_r,"encodeHTML4",{enumerable:!0,get:function(){return Gr.encodeHTML}}),Object.defineProperty(_r,"encodeHTML5",{enumerable:!0,get:function(){return Gr.encodeHTML}});var Nr=decode;Object.defineProperty(_r,"EntityDecoder",{enumerable:!0,get:function(){return Nr.EntityDecoder}}),Object.defineProperty(_r,"DecodingMode",{enumerable:!0,get:function(){return Nr.DecodingMode}}),Object.defineProperty(_r,"decodeXML",{enumerable:!0,get:function(){return Nr.decodeXML}}),Object.defineProperty(_r,"decodeHTML",{enumerable:!0,get:function(){return Nr.decodeHTML}}),Object.defineProperty(_r,"decodeHTMLStrict",{enumerable:!0,get:function(){return Nr.decodeHTMLStrict}}),Object.defineProperty(_r,"decodeHTMLAttribute",{enumerable:!0,get:function(){return Nr.decodeHTMLAttribute}}),Object.defineProperty(_r,"decodeHTML4",{enumerable:!0,get:function(){return Nr.decodeHTML}}),Object.defineProperty(_r,"decodeHTML5",{enumerable:!0,get:function(){return Nr.decodeHTML}}),Object.defineProperty(_r,"decodeHTML4Strict",{enumerable:!0,get:function(){return Nr.decodeHTMLStrict}}),Object.defineProperty(_r,"decodeHTML5Strict",{enumerable:!0,get:function(){return Nr.decodeHTMLStrict}}),Object.defineProperty(_r,"decodeXMLStrict",{enumerable:!0,get:function(){return Nr.decodeXML}})})(lib);var foreignNames={};Object.defineProperty(foreignNames,"__esModule",{value:!0});foreignNames.attributeNames=foreignNames.elementNames=void 0;foreignNames.elementNames=new Map(["altGlyph","altGlyphDef","altGlyphItem","animateColor","animateMotion","animateTransform","clipPath","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","foreignObject","glyphRef","linearGradient","radialGradient","textPath"].map(function(_r){return[_r.toLowerCase(),_r]}));foreignNames.attributeNames=new Map(["definitionURL","attributeName","attributeType","baseFrequency","baseProfile","calcMode","clipPathUnits","diffuseConstant","edgeMode","filterUnits","glyphRef","gradientTransform","gradientUnits","kernelMatrix","kernelUnitLength","keyPoints","keySplines","keyTimes","lengthAdjust","limitingConeAngle","markerHeight","markerUnits","markerWidth","maskContentUnits","maskUnits","numOctaves","pathLength","patternContentUnits","patternTransform","patternUnits","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","refX","refY","repeatCount","repeatDur","requiredExtensions","requiredFeatures","specularConstant","specularExponent","spreadMethod","startOffset","stdDeviation","stitchTiles","surfaceScale","systemLanguage","tableValues","targetX","targetY","textLength","viewBox","viewTarget","xChannelSelector","yChannelSelector","zoomAndPan"].map(function(_r){return[_r.toLowerCase(),_r]}));var __assign$1=commonjsGlobal&&commonjsGlobal.__assign||function(){return __assign$1=Object.assign||function(_r){for(var Tr,Ar=1,Rr=arguments.length;Ar<Rr;Ar++){Tr=arguments[Ar];for(var Pr in Tr)Object.prototype.hasOwnProperty.call(Tr,Pr)&&(_r[Pr]=Tr[Pr])}return _r},__assign$1.apply(this,arguments)},__createBinding=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(_r,Tr,Ar,Rr){Rr===void 0&&(Rr=Ar);var Pr=Object.getOwnPropertyDescriptor(Tr,Ar);(!Pr||("get"in Pr?!Tr.__esModule:Pr.writable||Pr.configurable))&&(Pr={enumerable:!0,get:function(){return Tr[Ar]}}),Object.defineProperty(_r,Rr,Pr)}:function(_r,Tr,Ar,Rr){Rr===void 0&&(Rr=Ar),_r[Rr]=Tr[Ar]}),__setModuleDefault=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(_r,Tr){Object.defineProperty(_r,"default",{enumerable:!0,value:Tr})}:function(_r,Tr){_r.default=Tr}),__importStar=commonjsGlobal&&commonjsGlobal.__importStar||function(_r){if(_r&&_r.__esModule)return _r;var Tr={};if(_r!=null)for(var Ar in _r)Ar!=="default"&&Object.prototype.hasOwnProperty.call(_r,Ar)&&__createBinding(Tr,_r,Ar);return __setModuleDefault(Tr,_r),Tr};Object.defineProperty(lib$1,"__esModule",{value:!0});lib$1.render=void 0;var ElementType=__importStar(lib$3),entities_1=lib,foreignNames_js_1=foreignNames,unencodedElements=new Set(["style","script","xmp","iframe","noembed","noframes","plaintext","noscript"]);function replaceQuotes(_r){return _r.replace(/"/g,"&quot;")}function formatAttributes(_r,Tr){var Ar;if(_r){var Rr=((Ar=Tr.encodeEntities)!==null&&Ar!==void 0?Ar:Tr.decodeEntities)===!1?replaceQuotes:Tr.xmlMode||Tr.encodeEntities!=="utf8"?entities_1.encodeXML:entities_1.escapeAttribute;return Object.keys(_r).map(function(Pr){var Dr,Mr,Fr=(Dr=_r[Pr])!==null&&Dr!==void 0?Dr:"";return Tr.xmlMode==="foreign"&&(Pr=(Mr=foreignNames_js_1.attributeNames.get(Pr))!==null&&Mr!==void 0?Mr:Pr),!Tr.emptyAttrs&&!Tr.xmlMode&&Fr===""?Pr:"".concat(Pr,'="').concat(Rr(Fr),'"')}).join(" ")}}var singleTag=new Set(["area","base","basefont","br","col","command","embed","frame","hr","img","input","isindex","keygen","link","meta","param","source","track","wbr"]);function render(_r,Tr){Tr===void 0&&(Tr={});for(var Ar=("length"in _r)?_r:[_r],Rr="",Pr=0;Pr<Ar.length;Pr++)Rr+=renderNode(Ar[Pr],Tr);return Rr}lib$1.render=render;lib$1.default=render;function renderNode(_r,Tr){switch(_r.type){case ElementType.Root:return render(_r.children,Tr);case ElementType.Doctype:case ElementType.Directive:return renderDirective(_r);case ElementType.Comment:return renderComment(_r);case ElementType.CDATA:return renderCdata(_r);case ElementType.Script:case ElementType.Style:case ElementType.Tag:return renderTag(_r,Tr);case ElementType.Text:return renderText(_r,Tr)}}var foreignModeIntegrationPoints=new Set(["mi","mo","mn","ms","mtext","annotation-xml","foreignObject","desc","title"]),foreignElements=new Set(["svg","math"]);function renderTag(_r,Tr){var Ar;Tr.xmlMode==="foreign"&&(_r.name=(Ar=foreignNames_js_1.elementNames.get(_r.name))!==null&&Ar!==void 0?Ar:_r.name,_r.parent&&foreignModeIntegrationPoints.has(_r.parent.name)&&(Tr=__assign$1(__assign$1({},Tr),{xmlMode:!1}))),!Tr.xmlMode&&foreignElements.has(_r.name)&&(Tr=__assign$1(__assign$1({},Tr),{xmlMode:"foreign"}));var Rr="<".concat(_r.name),Pr=formatAttributes(_r.attribs,Tr);return Pr&&(Rr+=" ".concat(Pr)),_r.children.length===0&&(Tr.xmlMode?Tr.selfClosingTags!==!1:Tr.selfClosingTags&&singleTag.has(_r.name))?(Tr.xmlMode||(Rr+=" "),Rr+="/>"):(Rr+=">",_r.children.length>0&&(Rr+=render(_r.children,Tr)),(Tr.xmlMode||!singleTag.has(_r.name))&&(Rr+="</".concat(_r.name,">"))),Rr}function renderDirective(_r){return"<".concat(_r.data,">")}function renderText(_r,Tr){var Ar,Rr=_r.data||"";return((Ar=Tr.encodeEntities)!==null&&Ar!==void 0?Ar:Tr.decodeEntities)!==!1&&!(!Tr.xmlMode&&_r.parent&&unencodedElements.has(_r.parent.name))&&(Rr=Tr.xmlMode||Tr.encodeEntities!=="utf8"?(0,entities_1.encodeXML)(Rr):(0,entities_1.escapeText)(Rr)),Rr}function renderCdata(_r){return"<![CDATA[".concat(_r.children[0].data,"]]>")}function renderComment(_r){return"<!--".concat(_r.data,"-->")}var __importDefault=commonjsGlobal&&commonjsGlobal.__importDefault||function(_r){return _r&&_r.__esModule?_r:{default:_r}};Object.defineProperty(stringify$5,"__esModule",{value:!0});stringify$5.innerText=stringify$5.textContent=stringify$5.getText=stringify$5.getInnerHTML=stringify$5.getOuterHTML=void 0;var domhandler_1$3=lib$4,dom_serializer_1=__importDefault(lib$1),domelementtype_1=lib$3;function getOuterHTML(_r,Tr){return(0,dom_serializer_1.default)(_r,Tr)}stringify$5.getOuterHTML=getOuterHTML;function getInnerHTML(_r,Tr){return(0,domhandler_1$3.hasChildren)(_r)?_r.children.map(function(Ar){return getOuterHTML(Ar,Tr)}).join(""):""}stringify$5.getInnerHTML=getInnerHTML;function getText(_r){return Array.isArray(_r)?_r.map(getText).join(""):(0,domhandler_1$3.isTag)(_r)?_r.name==="br"?`
`:getText(_r.children):(0,domhandler_1$3.isCDATA)(_r)?getText(_r.children):(0,domhandler_1$3.isText)(_r)?_r.data:""}stringify$5.getText=getText;function textContent(_r){return Array.isArray(_r)?_r.map(textContent).join(""):(0,domhandler_1$3.hasChildren)(_r)&&!(0,domhandler_1$3.isComment)(_r)?textContent(_r.children):(0,domhandler_1$3.isText)(_r)?_r.data:""}stringify$5.textContent=textContent;function innerText(_r){return Array.isArray(_r)?_r.map(innerText).join(""):(0,domhandler_1$3.hasChildren)(_r)&&(_r.type===domelementtype_1.ElementType.Tag||(0,domhandler_1$3.isCDATA)(_r))?innerText(_r.children):(0,domhandler_1$3.isText)(_r)?_r.data:""}stringify$5.innerText=innerText;var traversal={};Object.defineProperty(traversal,"__esModule",{value:!0});traversal.prevElementSibling=traversal.nextElementSibling=traversal.getName=traversal.hasAttrib=traversal.getAttributeValue=traversal.getSiblings=traversal.getParent=traversal.getChildren=void 0;var domhandler_1$2=lib$4;function getChildren(_r){return(0,domhandler_1$2.hasChildren)(_r)?_r.children:[]}traversal.getChildren=getChildren;function getParent(_r){return _r.parent||null}traversal.getParent=getParent;function getSiblings(_r){var Tr,Ar,Rr=getParent(_r);if(Rr!=null)return getChildren(Rr);for(var Pr=[_r],Dr=_r.prev,Mr=_r.next;Dr!=null;)Pr.unshift(Dr),Tr=Dr,Dr=Tr.prev;for(;Mr!=null;)Pr.push(Mr),Ar=Mr,Mr=Ar.next;return Pr}traversal.getSiblings=getSiblings;function getAttributeValue(_r,Tr){var Ar;return(Ar=_r.attribs)===null||Ar===void 0?void 0:Ar[Tr]}traversal.getAttributeValue=getAttributeValue;function hasAttrib(_r,Tr){return _r.attribs!=null&&Object.prototype.hasOwnProperty.call(_r.attribs,Tr)&&_r.attribs[Tr]!=null}traversal.hasAttrib=hasAttrib;function getName(_r){return _r.name}traversal.getName=getName;function nextElementSibling(_r){for(var Tr,Ar=_r.next;Ar!==null&&!(0,domhandler_1$2.isTag)(Ar);)Tr=Ar,Ar=Tr.next;return Ar}traversal.nextElementSibling=nextElementSibling;function prevElementSibling(_r){for(var Tr,Ar=_r.prev;Ar!==null&&!(0,domhandler_1$2.isTag)(Ar);)Tr=Ar,Ar=Tr.prev;return Ar}traversal.prevElementSibling=prevElementSibling;var manipulation={};Object.defineProperty(manipulation,"__esModule",{value:!0});manipulation.prepend=manipulation.prependChild=manipulation.append=manipulation.appendChild=manipulation.replaceElement=manipulation.removeElement=void 0;function removeElement(_r){if(_r.prev&&(_r.prev.next=_r.next),_r.next&&(_r.next.prev=_r.prev),_r.parent){var Tr=_r.parent.children,Ar=Tr.lastIndexOf(_r);Ar>=0&&Tr.splice(Ar,1)}_r.next=null,_r.prev=null,_r.parent=null}manipulation.removeElement=removeElement;function replaceElement(_r,Tr){var Ar=Tr.prev=_r.prev;Ar&&(Ar.next=Tr);var Rr=Tr.next=_r.next;Rr&&(Rr.prev=Tr);var Pr=Tr.parent=_r.parent;if(Pr){var Dr=Pr.children;Dr[Dr.lastIndexOf(_r)]=Tr,_r.parent=null}}manipulation.replaceElement=replaceElement;function appendChild(_r,Tr){if(removeElement(Tr),Tr.next=null,Tr.parent=_r,_r.children.push(Tr)>1){var Ar=_r.children[_r.children.length-2];Ar.next=Tr,Tr.prev=Ar}else Tr.prev=null}manipulation.appendChild=appendChild;function append(_r,Tr){removeElement(Tr);var Ar=_r.parent,Rr=_r.next;if(Tr.next=Rr,Tr.prev=_r,_r.next=Tr,Tr.parent=Ar,Rr){if(Rr.prev=Tr,Ar){var Pr=Ar.children;Pr.splice(Pr.lastIndexOf(Rr),0,Tr)}}else Ar&&Ar.children.push(Tr)}manipulation.append=append;function prependChild(_r,Tr){if(removeElement(Tr),Tr.parent=_r,Tr.prev=null,_r.children.unshift(Tr)!==1){var Ar=_r.children[1];Ar.prev=Tr,Tr.next=Ar}else Tr.next=null}manipulation.prependChild=prependChild;function prepend(_r,Tr){removeElement(Tr);var Ar=_r.parent;if(Ar){var Rr=Ar.children;Rr.splice(Rr.indexOf(_r),0,Tr)}_r.prev&&(_r.prev.next=Tr),Tr.parent=Ar,Tr.prev=_r.prev,Tr.next=_r,_r.prev=Tr}manipulation.prepend=prepend;var querying={};Object.defineProperty(querying,"__esModule",{value:!0});querying.findAll=querying.existsOne=querying.findOne=querying.findOneChild=querying.find=querying.filter=void 0;var domhandler_1$1=lib$4;function filter$1(_r,Tr,Ar,Rr){return Ar===void 0&&(Ar=!0),Rr===void 0&&(Rr=1/0),find(_r,Array.isArray(Tr)?Tr:[Tr],Ar,Rr)}querying.filter=filter$1;function find(_r,Tr,Ar,Rr){for(var Pr=[],Dr=[Tr],Mr=[0];;){if(Mr[0]>=Dr[0].length){if(Mr.length===1)return Pr;Dr.shift(),Mr.shift();continue}var Fr=Dr[0][Mr[0]++];if(_r(Fr)&&(Pr.push(Fr),--Rr<=0))return Pr;Ar&&(0,domhandler_1$1.hasChildren)(Fr)&&Fr.children.length>0&&(Mr.unshift(0),Dr.unshift(Fr.children))}}querying.find=find;function findOneChild(_r,Tr){return Tr.find(_r)}querying.findOneChild=findOneChild;function findOne(_r,Tr,Ar){Ar===void 0&&(Ar=!0);for(var Rr=null,Pr=0;Pr<Tr.length&&!Rr;Pr++){var Dr=Tr[Pr];if((0,domhandler_1$1.isTag)(Dr))_r(Dr)?Rr=Dr:Ar&&Dr.children.length>0&&(Rr=findOne(_r,Dr.children,!0));else continue}return Rr}querying.findOne=findOne;function existsOne(_r,Tr){return Tr.some(function(Ar){return(0,domhandler_1$1.isTag)(Ar)&&(_r(Ar)||existsOne(_r,Ar.children))})}querying.existsOne=existsOne;function findAll(_r,Tr){for(var Ar=[],Rr=[Tr],Pr=[0];;){if(Pr[0]>=Rr[0].length){if(Rr.length===1)return Ar;Rr.shift(),Pr.shift();continue}var Dr=Rr[0][Pr[0]++];(0,domhandler_1$1.isTag)(Dr)&&(_r(Dr)&&Ar.push(Dr),Dr.children.length>0&&(Pr.unshift(0),Rr.unshift(Dr.children)))}}querying.findAll=findAll;var legacy={};Object.defineProperty(legacy,"__esModule",{value:!0});legacy.getElementsByTagType=legacy.getElementsByTagName=legacy.getElementById=legacy.getElements=legacy.testElement=void 0;var domhandler_1=lib$4,querying_js_1=querying,Checks={tag_name:function(_r){return typeof _r=="function"?function(Tr){return(0,domhandler_1.isTag)(Tr)&&_r(Tr.name)}:_r==="*"?domhandler_1.isTag:function(Tr){return(0,domhandler_1.isTag)(Tr)&&Tr.name===_r}},tag_type:function(_r){return typeof _r=="function"?function(Tr){return _r(Tr.type)}:function(Tr){return Tr.type===_r}},tag_contains:function(_r){return typeof _r=="function"?function(Tr){return(0,domhandler_1.isText)(Tr)&&_r(Tr.data)}:function(Tr){return(0,domhandler_1.isText)(Tr)&&Tr.data===_r}}};function getAttribCheck(_r,Tr){return typeof Tr=="function"?function(Ar){return(0,domhandler_1.isTag)(Ar)&&Tr(Ar.attribs[_r])}:function(Ar){return(0,domhandler_1.isTag)(Ar)&&Ar.attribs[_r]===Tr}}function combineFuncs(_r,Tr){return function(Ar){return _r(Ar)||Tr(Ar)}}function compileTest(_r){var Tr=Object.keys(_r).map(function(Ar){var Rr=_r[Ar];return Object.prototype.hasOwnProperty.call(Checks,Ar)?Checks[Ar](Rr):getAttribCheck(Ar,Rr)});return Tr.length===0?null:Tr.reduce(combineFuncs)}function testElement(_r,Tr){var Ar=compileTest(_r);return Ar?Ar(Tr):!0}legacy.testElement=testElement;function getElements(_r,Tr,Ar,Rr){Rr===void 0&&(Rr=1/0);var Pr=compileTest(_r);return Pr?(0,querying_js_1.filter)(Pr,Tr,Ar,Rr):[]}legacy.getElements=getElements;function getElementById(_r,Tr,Ar){return Ar===void 0&&(Ar=!0),Array.isArray(Tr)||(Tr=[Tr]),(0,querying_js_1.findOne)(getAttribCheck("id",_r),Tr,Ar)}legacy.getElementById=getElementById;function getElementsByTagName(_r,Tr,Ar,Rr){return Ar===void 0&&(Ar=!0),Rr===void 0&&(Rr=1/0),(0,querying_js_1.filter)(Checks.tag_name(_r),Tr,Ar,Rr)}legacy.getElementsByTagName=getElementsByTagName;function getElementsByTagType(_r,Tr,Ar,Rr){return Ar===void 0&&(Ar=!0),Rr===void 0&&(Rr=1/0),(0,querying_js_1.filter)(Checks.tag_type(_r),Tr,Ar,Rr)}legacy.getElementsByTagType=getElementsByTagType;var helpers$1={};(function(_r){Object.defineProperty(_r,"__esModule",{value:!0}),_r.uniqueSort=_r.compareDocumentPosition=_r.DocumentPosition=_r.removeSubsets=void 0;var Tr=lib$4;function Ar(Mr){for(var Fr=Mr.length;--Fr>=0;){var zr=Mr[Fr];if(Fr>0&&Mr.lastIndexOf(zr,Fr-1)>=0){Mr.splice(Fr,1);continue}for(var jr=zr.parent;jr;jr=jr.parent)if(Mr.includes(jr)){Mr.splice(Fr,1);break}}return Mr}_r.removeSubsets=Ar;var Rr;(function(Mr){Mr[Mr.DISCONNECTED=1]="DISCONNECTED",Mr[Mr.PRECEDING=2]="PRECEDING",Mr[Mr.FOLLOWING=4]="FOLLOWING",Mr[Mr.CONTAINS=8]="CONTAINS",Mr[Mr.CONTAINED_BY=16]="CONTAINED_BY"})(Rr=_r.DocumentPosition||(_r.DocumentPosition={}));function Pr(Mr,Fr){var zr=[],jr=[];if(Mr===Fr)return 0;for(var Gr=(0,Tr.hasChildren)(Mr)?Mr:Mr.parent;Gr;)zr.unshift(Gr),Gr=Gr.parent;for(Gr=(0,Tr.hasChildren)(Fr)?Fr:Fr.parent;Gr;)jr.unshift(Gr),Gr=Gr.parent;for(var Nr=Math.min(zr.length,jr.length),Lr=0;Lr<Nr&&zr[Lr]===jr[Lr];)Lr++;if(Lr===0)return Rr.DISCONNECTED;var Ur=zr[Lr-1],Vr=Ur.children,Wr=zr[Lr],qr=jr[Lr];return Vr.indexOf(Wr)>Vr.indexOf(qr)?Ur===Fr?Rr.FOLLOWING|Rr.CONTAINED_BY:Rr.FOLLOWING:Ur===Mr?Rr.PRECEDING|Rr.CONTAINS:Rr.PRECEDING}_r.compareDocumentPosition=Pr;function Dr(Mr){return Mr=Mr.filter(function(Fr,zr,jr){return!jr.includes(Fr,zr+1)}),Mr.sort(function(Fr,zr){var jr=Pr(Fr,zr);return jr&Rr.PRECEDING?-1:jr&Rr.FOLLOWING?1:0}),Mr}_r.uniqueSort=Dr})(helpers$1);var feeds={};Object.defineProperty(feeds,"__esModule",{value:!0});feeds.getFeed=void 0;var stringify_js_1=stringify$5,legacy_js_1=legacy;function getFeed(_r){var Tr=getOneElement(isValidFeed,_r);return Tr?Tr.name==="feed"?getAtomFeed(Tr):getRssFeed(Tr):null}feeds.getFeed=getFeed;function getAtomFeed(_r){var Tr,Ar=_r.children,Rr={type:"atom",items:(0,legacy_js_1.getElementsByTagName)("entry",Ar).map(function(Mr){var Fr,zr=Mr.children,jr={media:getMediaElements(zr)};addConditionally(jr,"id","id",zr),addConditionally(jr,"title","title",zr);var Gr=(Fr=getOneElement("link",zr))===null||Fr===void 0?void 0:Fr.attribs.href;Gr&&(jr.link=Gr);var Nr=fetch$1("summary",zr)||fetch$1("content",zr);Nr&&(jr.description=Nr);var Lr=fetch$1("updated",zr);return Lr&&(jr.pubDate=new Date(Lr)),jr})};addConditionally(Rr,"id","id",Ar),addConditionally(Rr,"title","title",Ar);var Pr=(Tr=getOneElement("link",Ar))===null||Tr===void 0?void 0:Tr.attribs.href;Pr&&(Rr.link=Pr),addConditionally(Rr,"description","subtitle",Ar);var Dr=fetch$1("updated",Ar);return Dr&&(Rr.updated=new Date(Dr)),addConditionally(Rr,"author","email",Ar,!0),Rr}function getRssFeed(_r){var Tr,Ar,Rr=(Ar=(Tr=getOneElement("channel",_r.children))===null||Tr===void 0?void 0:Tr.children)!==null&&Ar!==void 0?Ar:[],Pr={type:_r.name.substr(0,3),id:"",items:(0,legacy_js_1.getElementsByTagName)("item",_r.children).map(function(Mr){var Fr=Mr.children,zr={media:getMediaElements(Fr)};addConditionally(zr,"id","guid",Fr),addConditionally(zr,"title","title",Fr),addConditionally(zr,"link","link",Fr),addConditionally(zr,"description","description",Fr);var jr=fetch$1("pubDate",Fr)||fetch$1("dc:date",Fr);return jr&&(zr.pubDate=new Date(jr)),zr})};addConditionally(Pr,"title","title",Rr),addConditionally(Pr,"link","link",Rr),addConditionally(Pr,"description","description",Rr);var Dr=fetch$1("lastBuildDate",Rr);return Dr&&(Pr.updated=new Date(Dr)),addConditionally(Pr,"author","managingEditor",Rr,!0),Pr}var MEDIA_KEYS_STRING=["url","type","lang"],MEDIA_KEYS_INT=["fileSize","bitrate","framerate","samplingrate","channels","duration","height","width"];function getMediaElements(_r){return(0,legacy_js_1.getElementsByTagName)("media:content",_r).map(function(Tr){for(var Ar=Tr.attribs,Rr={medium:Ar.medium,isDefault:!!Ar.isDefault},Pr=0,Dr=MEDIA_KEYS_STRING;Pr<Dr.length;Pr++){var Mr=Dr[Pr];Ar[Mr]&&(Rr[Mr]=Ar[Mr])}for(var Fr=0,zr=MEDIA_KEYS_INT;Fr<zr.length;Fr++){var Mr=zr[Fr];Ar[Mr]&&(Rr[Mr]=parseInt(Ar[Mr],10))}return Ar.expression&&(Rr.expression=Ar.expression),Rr})}function getOneElement(_r,Tr){return(0,legacy_js_1.getElementsByTagName)(_r,Tr,!0,1)[0]}function fetch$1(_r,Tr,Ar){return Ar===void 0&&(Ar=!1),(0,stringify_js_1.textContent)((0,legacy_js_1.getElementsByTagName)(_r,Tr,Ar,1)).trim()}function addConditionally(_r,Tr,Ar,Rr,Pr){Pr===void 0&&(Pr=!1);var Dr=fetch$1(Ar,Rr,Pr);Dr&&(_r[Tr]=Dr)}function isValidFeed(_r){return _r==="rss"||_r==="feed"||_r==="rdf:RDF"}(function(_r){var Tr=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(Pr,Dr,Mr,Fr){Fr===void 0&&(Fr=Mr);var zr=Object.getOwnPropertyDescriptor(Dr,Mr);(!zr||("get"in zr?!Dr.__esModule:zr.writable||zr.configurable))&&(zr={enumerable:!0,get:function(){return Dr[Mr]}}),Object.defineProperty(Pr,Fr,zr)}:function(Pr,Dr,Mr,Fr){Fr===void 0&&(Fr=Mr),Pr[Fr]=Dr[Mr]}),Ar=commonjsGlobal&&commonjsGlobal.__exportStar||function(Pr,Dr){for(var Mr in Pr)Mr!=="default"&&!Object.prototype.hasOwnProperty.call(Dr,Mr)&&Tr(Dr,Pr,Mr)};Object.defineProperty(_r,"__esModule",{value:!0}),_r.hasChildren=_r.isDocument=_r.isComment=_r.isText=_r.isCDATA=_r.isTag=void 0,Ar(stringify$5,_r),Ar(traversal,_r),Ar(manipulation,_r),Ar(querying,_r),Ar(legacy,_r),Ar(helpers$1,_r),Ar(feeds,_r);var Rr=lib$4;Object.defineProperty(_r,"isTag",{enumerable:!0,get:function(){return Rr.isTag}}),Object.defineProperty(_r,"isCDATA",{enumerable:!0,get:function(){return Rr.isCDATA}}),Object.defineProperty(_r,"isText",{enumerable:!0,get:function(){return Rr.isText}}),Object.defineProperty(_r,"isComment",{enumerable:!0,get:function(){return Rr.isComment}}),Object.defineProperty(_r,"isDocument",{enumerable:!0,get:function(){return Rr.isDocument}}),Object.defineProperty(_r,"hasChildren",{enumerable:!0,get:function(){return Rr.hasChildren}})})(lib$2);(function(_r){var Tr=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(Kr,Xr,Zr,_i){_i===void 0&&(_i=Zr);var Jr=Object.getOwnPropertyDescriptor(Xr,Zr);(!Jr||("get"in Jr?!Xr.__esModule:Jr.writable||Jr.configurable))&&(Jr={enumerable:!0,get:function(){return Xr[Zr]}}),Object.defineProperty(Kr,_i,Jr)}:function(Kr,Xr,Zr,_i){_i===void 0&&(_i=Zr),Kr[_i]=Xr[Zr]}),Ar=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(Kr,Xr){Object.defineProperty(Kr,"default",{enumerable:!0,value:Xr})}:function(Kr,Xr){Kr.default=Xr}),Rr=commonjsGlobal&&commonjsGlobal.__importStar||function(Kr){if(Kr&&Kr.__esModule)return Kr;var Xr={};if(Kr!=null)for(var Zr in Kr)Zr!=="default"&&Object.prototype.hasOwnProperty.call(Kr,Zr)&&Tr(Xr,Kr,Zr);return Ar(Xr,Kr),Xr},Pr=commonjsGlobal&&commonjsGlobal.__importDefault||function(Kr){return Kr&&Kr.__esModule?Kr:{default:Kr}};Object.defineProperty(_r,"__esModule",{value:!0}),_r.DomUtils=_r.parseFeed=_r.getFeed=_r.ElementType=_r.Tokenizer=_r.createDomStream=_r.parseDOM=_r.parseDocument=_r.DefaultHandler=_r.DomHandler=_r.Parser=void 0;var Dr=Parser$3,Mr=Parser$3;Object.defineProperty(_r,"Parser",{enumerable:!0,get:function(){return Mr.Parser}});var Fr=lib$4,zr=lib$4;Object.defineProperty(_r,"DomHandler",{enumerable:!0,get:function(){return zr.DomHandler}}),Object.defineProperty(_r,"DefaultHandler",{enumerable:!0,get:function(){return zr.DomHandler}});function jr(Kr,Xr){var Zr=new Fr.DomHandler(void 0,Xr);return new Dr.Parser(Zr,Xr).end(Kr),Zr.root}_r.parseDocument=jr;function Gr(Kr,Xr){return jr(Kr,Xr).children}_r.parseDOM=Gr;function Nr(Kr,Xr,Zr){var _i=new Fr.DomHandler(Kr,Xr,Zr);return new Dr.Parser(_i,Xr)}_r.createDomStream=Nr;var Lr=Tokenizer;Object.defineProperty(_r,"Tokenizer",{enumerable:!0,get:function(){return Pr(Lr).default}}),_r.ElementType=Rr(lib$3);var Ur=lib$2,Vr=lib$2;Object.defineProperty(_r,"getFeed",{enumerable:!0,get:function(){return Vr.getFeed}});var Wr={xmlMode:!0};function qr(Kr,Xr){return Xr===void 0&&(Xr=Wr),(0,Ur.getFeed)(Gr(Kr,Xr))}_r.parseFeed=qr,_r.DomUtils=Rr(lib$2)})(lib$5);var escapeStringRegexp$1=_r=>{if(typeof _r!="string")throw new TypeError("Expected a string");return _r.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")},isPlainObject$3={};Object.defineProperty(isPlainObject$3,"__esModule",{value:!0});/*!
 * is-plain-object <https://github.com/jonschlinkert/is-plain-object>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */function isObject$1(_r){return Object.prototype.toString.call(_r)==="[object Object]"}function isPlainObject$2(_r){var Tr,Ar;return isObject$1(_r)===!1?!1:(Tr=_r.constructor,Tr===void 0?!0:(Ar=Tr.prototype,!(isObject$1(Ar)===!1||Ar.hasOwnProperty("isPrototypeOf")===!1)))}isPlainObject$3.isPlainObject=isPlainObject$2;var isMergeableObject=function(Tr){return isNonNullObject(Tr)&&!isSpecial(Tr)};function isNonNullObject(_r){return!!_r&&typeof _r=="object"}function isSpecial(_r){var Tr=Object.prototype.toString.call(_r);return Tr==="[object RegExp]"||Tr==="[object Date]"||isReactElement(_r)}var canUseSymbol=typeof Symbol=="function"&&Symbol.for,REACT_ELEMENT_TYPE=canUseSymbol?Symbol.for("react.element"):60103;function isReactElement(_r){return _r.$$typeof===REACT_ELEMENT_TYPE}function emptyTarget(_r){return Array.isArray(_r)?[]:{}}function cloneUnlessOtherwiseSpecified(_r,Tr){return Tr.clone!==!1&&Tr.isMergeableObject(_r)?deepmerge$1(emptyTarget(_r),_r,Tr):_r}function defaultArrayMerge(_r,Tr,Ar){return _r.concat(Tr).map(function(Rr){return cloneUnlessOtherwiseSpecified(Rr,Ar)})}function getMergeFunction(_r,Tr){if(!Tr.customMerge)return deepmerge$1;var Ar=Tr.customMerge(_r);return typeof Ar=="function"?Ar:deepmerge$1}function getEnumerableOwnPropertySymbols(_r){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(_r).filter(function(Tr){return Object.propertyIsEnumerable.call(_r,Tr)}):[]}function getKeys(_r){return Object.keys(_r).concat(getEnumerableOwnPropertySymbols(_r))}function propertyIsOnObject(_r,Tr){try{return Tr in _r}catch{return!1}}function propertyIsUnsafe(_r,Tr){return propertyIsOnObject(_r,Tr)&&!(Object.hasOwnProperty.call(_r,Tr)&&Object.propertyIsEnumerable.call(_r,Tr))}function mergeObject(_r,Tr,Ar){var Rr={};return Ar.isMergeableObject(_r)&&getKeys(_r).forEach(function(Pr){Rr[Pr]=cloneUnlessOtherwiseSpecified(_r[Pr],Ar)}),getKeys(Tr).forEach(function(Pr){propertyIsUnsafe(_r,Pr)||(propertyIsOnObject(_r,Pr)&&Ar.isMergeableObject(Tr[Pr])?Rr[Pr]=getMergeFunction(Pr,Ar)(_r[Pr],Tr[Pr],Ar):Rr[Pr]=cloneUnlessOtherwiseSpecified(Tr[Pr],Ar))}),Rr}function deepmerge$1(_r,Tr,Ar){Ar=Ar||{},Ar.arrayMerge=Ar.arrayMerge||defaultArrayMerge,Ar.isMergeableObject=Ar.isMergeableObject||isMergeableObject,Ar.cloneUnlessOtherwiseSpecified=cloneUnlessOtherwiseSpecified;var Rr=Array.isArray(Tr),Pr=Array.isArray(_r),Dr=Rr===Pr;return Dr?Rr?Ar.arrayMerge(_r,Tr,Ar):mergeObject(_r,Tr,Ar):cloneUnlessOtherwiseSpecified(Tr,Ar)}deepmerge$1.all=function(Tr,Ar){if(!Array.isArray(Tr))throw new Error("first argument should be an array");return Tr.reduce(function(Rr,Pr){return deepmerge$1(Rr,Pr,Ar)},{})};var deepmerge_1=deepmerge$1,cjs=deepmerge_1,parseSrcset$1={exports:{}};(function(_r){(function(Tr,Ar){_r.exports?_r.exports=Ar():Tr.parseSrcset=Ar()})(commonjsGlobal,function(){return function(Tr){function Ar(_i){return _i===" "||_i==="	"||_i===`
`||_i==="\f"||_i==="\r"}function Rr(_i){var Jr,es=_i.exec(Tr.substring(qr));if(es)return Jr=es[0],qr+=Jr.length,Jr}for(var Pr=Tr.length,Dr=/^[ \t\n\r\u000c]+/,Mr=/^[, \t\n\r\u000c]+/,Fr=/^[^ \t\n\r\u000c]+/,zr=/[,]+$/,jr=/^\d+$/,Gr=/^-?(?:[0-9]+|[0-9]*\.[0-9]+)(?:[eE][+-]?[0-9]+)?$/,Nr,Lr,Ur,Vr,Wr,qr=0,Kr=[];;){if(Rr(Mr),qr>=Pr)return Kr;Nr=Rr(Fr),Lr=[],Nr.slice(-1)===","?(Nr=Nr.replace(zr,""),Zr()):Xr()}function Xr(){for(Rr(Dr),Ur="",Vr="in descriptor";;){if(Wr=Tr.charAt(qr),Vr==="in descriptor")if(Ar(Wr))Ur&&(Lr.push(Ur),Ur="",Vr="after descriptor");else if(Wr===","){qr+=1,Ur&&Lr.push(Ur),Zr();return}else if(Wr==="(")Ur=Ur+Wr,Vr="in parens";else if(Wr===""){Ur&&Lr.push(Ur),Zr();return}else Ur=Ur+Wr;else if(Vr==="in parens")if(Wr===")")Ur=Ur+Wr,Vr="in descriptor";else if(Wr===""){Lr.push(Ur),Zr();return}else Ur=Ur+Wr;else if(Vr==="after descriptor"&&!Ar(Wr))if(Wr===""){Zr();return}else Vr="in descriptor",qr-=1;qr+=1}}function Zr(){var _i=!1,Jr,es,ts,is,rs={},as,ls,fs,Ts,$s;for(is=0;is<Lr.length;is++)as=Lr[is],ls=as[as.length-1],fs=as.substring(0,as.length-1),Ts=parseInt(fs,10),$s=parseFloat(fs),jr.test(fs)&&ls==="w"?((Jr||es)&&(_i=!0),Ts===0?_i=!0:Jr=Ts):Gr.test(fs)&&ls==="x"?((Jr||es||ts)&&(_i=!0),$s<0?_i=!0:es=$s):jr.test(fs)&&ls==="h"?((ts||es)&&(_i=!0),Ts===0?_i=!0:ts=Ts):_i=!0;_i?console&&console.log&&console.log("Invalid srcset descriptor found in '"+Tr+"' at '"+as+"'."):(rs.url=Nr,Jr&&(rs.w=Jr),es&&(rs.d=es),ts&&(rs.h=ts),Kr.push(rs))}}})})(parseSrcset$1);var parseSrcsetExports=parseSrcset$1.exports,picocolors_browser={exports:{}},x=String,create=function(){return{isColorSupported:!1,reset:x,bold:x,dim:x,italic:x,underline:x,inverse:x,hidden:x,strikethrough:x,black:x,red:x,green:x,yellow:x,blue:x,magenta:x,cyan:x,white:x,gray:x,bgBlack:x,bgRed:x,bgGreen:x,bgYellow:x,bgBlue:x,bgMagenta:x,bgCyan:x,bgWhite:x}};picocolors_browser.exports=create();picocolors_browser.exports.createColors=create;var picocolors_browserExports=picocolors_browser.exports;const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$2=getAugmentedNamespace(__viteBrowserExternal$1);let pico=picocolors_browserExports,terminalHighlight$1=require$$2,CssSyntaxError$3=class qv extends Error{constructor(Tr,Ar,Rr,Pr,Dr,Mr){super(Tr),this.name="CssSyntaxError",this.reason=Tr,Dr&&(this.file=Dr),Pr&&(this.source=Pr),Mr&&(this.plugin=Mr),typeof Ar<"u"&&typeof Rr<"u"&&(typeof Ar=="number"?(this.line=Ar,this.column=Rr):(this.line=Ar.line,this.column=Ar.column,this.endLine=Rr.line,this.endColumn=Rr.column)),this.setMessage(),Error.captureStackTrace&&Error.captureStackTrace(this,qv)}setMessage(){this.message=this.plugin?this.plugin+": ":"",this.message+=this.file?this.file:"<css input>",typeof this.line<"u"&&(this.message+=":"+this.line+":"+this.column),this.message+=": "+this.reason}showSourceCode(Tr){if(!this.source)return"";let Ar=this.source;Tr==null&&(Tr=pico.isColorSupported),terminalHighlight$1&&Tr&&(Ar=terminalHighlight$1(Ar));let Rr=Ar.split(/\r?\n/),Pr=Math.max(this.line-3,0),Dr=Math.min(this.line+2,Rr.length),Mr=String(Dr).length,Fr,zr;if(Tr){let{bold:jr,gray:Gr,red:Nr}=pico.createColors(!0);Fr=Lr=>jr(Nr(Lr)),zr=Lr=>Gr(Lr)}else Fr=zr=jr=>jr;return Rr.slice(Pr,Dr).map((jr,Gr)=>{let Nr=Pr+1+Gr,Lr=" "+(" "+Nr).slice(-Mr)+" | ";if(Nr===this.line){let Ur=zr(Lr.replace(/\d/g," "))+jr.slice(0,this.column-1).replace(/[^\t]/g," ");return Fr(">")+zr(Lr)+jr+`
 `+Ur+Fr("^")}return" "+zr(Lr)+jr}).join(`
`)}toString(){let Tr=this.showSourceCode();return Tr&&(Tr=`

`+Tr+`
`),this.name+": "+this.message+Tr}};var cssSyntaxError=CssSyntaxError$3;CssSyntaxError$3.default=CssSyntaxError$3;var symbols={};symbols.isClean=Symbol("isClean");symbols.my=Symbol("my");const DEFAULT_RAW={after:`
`,beforeClose:`
`,beforeComment:`
`,beforeDecl:`
`,beforeOpen:" ",beforeRule:`
`,colon:": ",commentLeft:" ",commentRight:" ",emptyBody:"",indent:"    ",semicolon:!1};function capitalize(_r){return _r[0].toUpperCase()+_r.slice(1)}let Stringifier$2=class{constructor(Tr){this.builder=Tr}atrule(Tr,Ar){let Rr="@"+Tr.name,Pr=Tr.params?this.rawValue(Tr,"params"):"";if(typeof Tr.raws.afterName<"u"?Rr+=Tr.raws.afterName:Pr&&(Rr+=" "),Tr.nodes)this.block(Tr,Rr+Pr);else{let Dr=(Tr.raws.between||"")+(Ar?";":"");this.builder(Rr+Pr+Dr,Tr)}}beforeAfter(Tr,Ar){let Rr;Tr.type==="decl"?Rr=this.raw(Tr,null,"beforeDecl"):Tr.type==="comment"?Rr=this.raw(Tr,null,"beforeComment"):Ar==="before"?Rr=this.raw(Tr,null,"beforeRule"):Rr=this.raw(Tr,null,"beforeClose");let Pr=Tr.parent,Dr=0;for(;Pr&&Pr.type!=="root";)Dr+=1,Pr=Pr.parent;if(Rr.includes(`
`)){let Mr=this.raw(Tr,null,"indent");if(Mr.length)for(let Fr=0;Fr<Dr;Fr++)Rr+=Mr}return Rr}block(Tr,Ar){let Rr=this.raw(Tr,"between","beforeOpen");this.builder(Ar+Rr+"{",Tr,"start");let Pr;Tr.nodes&&Tr.nodes.length?(this.body(Tr),Pr=this.raw(Tr,"after")):Pr=this.raw(Tr,"after","emptyBody"),Pr&&this.builder(Pr),this.builder("}",Tr,"end")}body(Tr){let Ar=Tr.nodes.length-1;for(;Ar>0&&Tr.nodes[Ar].type==="comment";)Ar-=1;let Rr=this.raw(Tr,"semicolon");for(let Pr=0;Pr<Tr.nodes.length;Pr++){let Dr=Tr.nodes[Pr],Mr=this.raw(Dr,"before");Mr&&this.builder(Mr),this.stringify(Dr,Ar!==Pr||Rr)}}comment(Tr){let Ar=this.raw(Tr,"left","commentLeft"),Rr=this.raw(Tr,"right","commentRight");this.builder("/*"+Ar+Tr.text+Rr+"*/",Tr)}decl(Tr,Ar){let Rr=this.raw(Tr,"between","colon"),Pr=Tr.prop+Rr+this.rawValue(Tr,"value");Tr.important&&(Pr+=Tr.raws.important||" !important"),Ar&&(Pr+=";"),this.builder(Pr,Tr)}document(Tr){this.body(Tr)}raw(Tr,Ar,Rr){let Pr;if(Rr||(Rr=Ar),Ar&&(Pr=Tr.raws[Ar],typeof Pr<"u"))return Pr;let Dr=Tr.parent;if(Rr==="before"&&(!Dr||Dr.type==="root"&&Dr.first===Tr||Dr&&Dr.type==="document"))return"";if(!Dr)return DEFAULT_RAW[Rr];let Mr=Tr.root();if(Mr.rawCache||(Mr.rawCache={}),typeof Mr.rawCache[Rr]<"u")return Mr.rawCache[Rr];if(Rr==="before"||Rr==="after")return this.beforeAfter(Tr,Rr);{let Fr="raw"+capitalize(Rr);this[Fr]?Pr=this[Fr](Mr,Tr):Mr.walk(zr=>{if(Pr=zr.raws[Ar],typeof Pr<"u")return!1})}return typeof Pr>"u"&&(Pr=DEFAULT_RAW[Rr]),Mr.rawCache[Rr]=Pr,Pr}rawBeforeClose(Tr){let Ar;return Tr.walk(Rr=>{if(Rr.nodes&&Rr.nodes.length>0&&typeof Rr.raws.after<"u")return Ar=Rr.raws.after,Ar.includes(`
`)&&(Ar=Ar.replace(/[^\n]+$/,"")),!1}),Ar&&(Ar=Ar.replace(/\S/g,"")),Ar}rawBeforeComment(Tr,Ar){let Rr;return Tr.walkComments(Pr=>{if(typeof Pr.raws.before<"u")return Rr=Pr.raws.before,Rr.includes(`
`)&&(Rr=Rr.replace(/[^\n]+$/,"")),!1}),typeof Rr>"u"?Rr=this.raw(Ar,null,"beforeDecl"):Rr&&(Rr=Rr.replace(/\S/g,"")),Rr}rawBeforeDecl(Tr,Ar){let Rr;return Tr.walkDecls(Pr=>{if(typeof Pr.raws.before<"u")return Rr=Pr.raws.before,Rr.includes(`
`)&&(Rr=Rr.replace(/[^\n]+$/,"")),!1}),typeof Rr>"u"?Rr=this.raw(Ar,null,"beforeRule"):Rr&&(Rr=Rr.replace(/\S/g,"")),Rr}rawBeforeOpen(Tr){let Ar;return Tr.walk(Rr=>{if(Rr.type!=="decl"&&(Ar=Rr.raws.between,typeof Ar<"u"))return!1}),Ar}rawBeforeRule(Tr){let Ar;return Tr.walk(Rr=>{if(Rr.nodes&&(Rr.parent!==Tr||Tr.first!==Rr)&&typeof Rr.raws.before<"u")return Ar=Rr.raws.before,Ar.includes(`
`)&&(Ar=Ar.replace(/[^\n]+$/,"")),!1}),Ar&&(Ar=Ar.replace(/\S/g,"")),Ar}rawColon(Tr){let Ar;return Tr.walkDecls(Rr=>{if(typeof Rr.raws.between<"u")return Ar=Rr.raws.between.replace(/[^\s:]/g,""),!1}),Ar}rawEmptyBody(Tr){let Ar;return Tr.walk(Rr=>{if(Rr.nodes&&Rr.nodes.length===0&&(Ar=Rr.raws.after,typeof Ar<"u"))return!1}),Ar}rawIndent(Tr){if(Tr.raws.indent)return Tr.raws.indent;let Ar;return Tr.walk(Rr=>{let Pr=Rr.parent;if(Pr&&Pr!==Tr&&Pr.parent&&Pr.parent===Tr&&typeof Rr.raws.before<"u"){let Dr=Rr.raws.before.split(`
`);return Ar=Dr[Dr.length-1],Ar=Ar.replace(/\S/g,""),!1}}),Ar}rawSemicolon(Tr){let Ar;return Tr.walk(Rr=>{if(Rr.nodes&&Rr.nodes.length&&Rr.last.type==="decl"&&(Ar=Rr.raws.semicolon,typeof Ar<"u"))return!1}),Ar}rawValue(Tr,Ar){let Rr=Tr[Ar],Pr=Tr.raws[Ar];return Pr&&Pr.value===Rr?Pr.raw:Rr}root(Tr){this.body(Tr),Tr.raws.after&&this.builder(Tr.raws.after)}rule(Tr){this.block(Tr,this.rawValue(Tr,"selector")),Tr.raws.ownSemicolon&&this.builder(Tr.raws.ownSemicolon,Tr,"end")}stringify(Tr,Ar){if(!this[Tr.type])throw new Error("Unknown AST node type "+Tr.type+". Maybe you need to change PostCSS stringifier.");this[Tr.type](Tr,Ar)}};var stringifier=Stringifier$2;Stringifier$2.default=Stringifier$2;let Stringifier$1=stringifier;function stringify$4(_r,Tr){new Stringifier$1(Tr).stringify(_r)}var stringify_1=stringify$4;stringify$4.default=stringify$4;let{isClean:isClean$2,my:my$2}=symbols,CssSyntaxError$2=cssSyntaxError,Stringifier=stringifier,stringify$3=stringify_1;function cloneNode(_r,Tr){let Ar=new _r.constructor;for(let Rr in _r){if(!Object.prototype.hasOwnProperty.call(_r,Rr)||Rr==="proxyCache")continue;let Pr=_r[Rr],Dr=typeof Pr;Rr==="parent"&&Dr==="object"?Tr&&(Ar[Rr]=Tr):Rr==="source"?Ar[Rr]=Pr:Array.isArray(Pr)?Ar[Rr]=Pr.map(Mr=>cloneNode(Mr,Ar)):(Dr==="object"&&Pr!==null&&(Pr=cloneNode(Pr)),Ar[Rr]=Pr)}return Ar}let Node$5=class{constructor(Tr={}){this.raws={},this[isClean$2]=!1,this[my$2]=!0;for(let Ar in Tr)if(Ar==="nodes"){this.nodes=[];for(let Rr of Tr[Ar])typeof Rr.clone=="function"?this.append(Rr.clone()):this.append(Rr)}else this[Ar]=Tr[Ar]}addToError(Tr){if(Tr.postcssNode=this,Tr.stack&&this.source&&/\n\s{4}at /.test(Tr.stack)){let Ar=this.source;Tr.stack=Tr.stack.replace(/\n\s{4}at /,`$&${Ar.input.from}:${Ar.start.line}:${Ar.start.column}$&`)}return Tr}after(Tr){return this.parent.insertAfter(this,Tr),this}assign(Tr={}){for(let Ar in Tr)this[Ar]=Tr[Ar];return this}before(Tr){return this.parent.insertBefore(this,Tr),this}cleanRaws(Tr){delete this.raws.before,delete this.raws.after,Tr||delete this.raws.between}clone(Tr={}){let Ar=cloneNode(this);for(let Rr in Tr)Ar[Rr]=Tr[Rr];return Ar}cloneAfter(Tr={}){let Ar=this.clone(Tr);return this.parent.insertAfter(this,Ar),Ar}cloneBefore(Tr={}){let Ar=this.clone(Tr);return this.parent.insertBefore(this,Ar),Ar}error(Tr,Ar={}){if(this.source){let{end:Rr,start:Pr}=this.rangeBy(Ar);return this.source.input.error(Tr,{column:Pr.column,line:Pr.line},{column:Rr.column,line:Rr.line},Ar)}return new CssSyntaxError$2(Tr)}getProxyProcessor(){return{get(Tr,Ar){return Ar==="proxyOf"?Tr:Ar==="root"?()=>Tr.root().toProxy():Tr[Ar]},set(Tr,Ar,Rr){return Tr[Ar]===Rr||(Tr[Ar]=Rr,(Ar==="prop"||Ar==="value"||Ar==="name"||Ar==="params"||Ar==="important"||Ar==="text")&&Tr.markDirty()),!0}}}markDirty(){if(this[isClean$2]){this[isClean$2]=!1;let Tr=this;for(;Tr=Tr.parent;)Tr[isClean$2]=!1}}next(){if(!this.parent)return;let Tr=this.parent.index(this);return this.parent.nodes[Tr+1]}positionBy(Tr,Ar){let Rr=this.source.start;if(Tr.index)Rr=this.positionInside(Tr.index,Ar);else if(Tr.word){Ar=this.toString();let Pr=Ar.indexOf(Tr.word);Pr!==-1&&(Rr=this.positionInside(Pr,Ar))}return Rr}positionInside(Tr,Ar){let Rr=Ar||this.toString(),Pr=this.source.start.column,Dr=this.source.start.line;for(let Mr=0;Mr<Tr;Mr++)Rr[Mr]===`
`?(Pr=1,Dr+=1):Pr+=1;return{column:Pr,line:Dr}}prev(){if(!this.parent)return;let Tr=this.parent.index(this);return this.parent.nodes[Tr-1]}get proxyOf(){return this}rangeBy(Tr){let Ar={column:this.source.start.column,line:this.source.start.line},Rr=this.source.end?{column:this.source.end.column+1,line:this.source.end.line}:{column:Ar.column+1,line:Ar.line};if(Tr.word){let Pr=this.toString(),Dr=Pr.indexOf(Tr.word);Dr!==-1&&(Ar=this.positionInside(Dr,Pr),Rr=this.positionInside(Dr+Tr.word.length,Pr))}else Tr.start?Ar={column:Tr.start.column,line:Tr.start.line}:Tr.index&&(Ar=this.positionInside(Tr.index)),Tr.end?Rr={column:Tr.end.column,line:Tr.end.line}:Tr.endIndex?Rr=this.positionInside(Tr.endIndex):Tr.index&&(Rr=this.positionInside(Tr.index+1));return(Rr.line<Ar.line||Rr.line===Ar.line&&Rr.column<=Ar.column)&&(Rr={column:Ar.column+1,line:Ar.line}),{end:Rr,start:Ar}}raw(Tr,Ar){return new Stringifier().raw(this,Tr,Ar)}remove(){return this.parent&&this.parent.removeChild(this),this.parent=void 0,this}replaceWith(...Tr){if(this.parent){let Ar=this,Rr=!1;for(let Pr of Tr)Pr===this?Rr=!0:Rr?(this.parent.insertAfter(Ar,Pr),Ar=Pr):this.parent.insertBefore(Ar,Pr);Rr||this.remove()}return this}root(){let Tr=this;for(;Tr.parent&&Tr.parent.type!=="document";)Tr=Tr.parent;return Tr}toJSON(Tr,Ar){let Rr={},Pr=Ar==null;Ar=Ar||new Map;let Dr=0;for(let Mr in this){if(!Object.prototype.hasOwnProperty.call(this,Mr)||Mr==="parent"||Mr==="proxyCache")continue;let Fr=this[Mr];if(Array.isArray(Fr))Rr[Mr]=Fr.map(zr=>typeof zr=="object"&&zr.toJSON?zr.toJSON(null,Ar):zr);else if(typeof Fr=="object"&&Fr.toJSON)Rr[Mr]=Fr.toJSON(null,Ar);else if(Mr==="source"){let zr=Ar.get(Fr.input);zr==null&&(zr=Dr,Ar.set(Fr.input,Dr),Dr++),Rr[Mr]={end:Fr.end,inputId:zr,start:Fr.start}}else Rr[Mr]=Fr}return Pr&&(Rr.inputs=[...Ar.keys()].map(Mr=>Mr.toJSON())),Rr}toProxy(){return this.proxyCache||(this.proxyCache=new Proxy(this,this.getProxyProcessor())),this.proxyCache}toString(Tr=stringify$3){Tr.stringify&&(Tr=Tr.stringify);let Ar="";return Tr(this,Rr=>{Ar+=Rr}),Ar}warn(Tr,Ar,Rr){let Pr={node:this};for(let Dr in Rr)Pr[Dr]=Rr[Dr];return Tr.warn(Ar,Pr)}};var node=Node$5;Node$5.default=Node$5;let Node$4=node,Declaration$4=class extends Node$4{constructor(Tr){Tr&&typeof Tr.value<"u"&&typeof Tr.value!="string"&&(Tr={...Tr,value:String(Tr.value)}),super(Tr),this.type="decl"}get variable(){return this.prop.startsWith("--")||this.prop[0]==="$"}};var declaration=Declaration$4;Declaration$4.default=Declaration$4;let urlAlphabet="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",customAlphabet=(_r,Tr=21)=>(Ar=Tr)=>{let Rr="",Pr=Ar;for(;Pr--;)Rr+=_r[Math.random()*_r.length|0];return Rr},nanoid$1=(_r=21)=>{let Tr="",Ar=_r;for(;Ar--;)Tr+=urlAlphabet[Math.random()*64|0];return Tr};var nonSecure={nanoid:nanoid$1,customAlphabet};let{SourceMapConsumer:SourceMapConsumer$2,SourceMapGenerator:SourceMapGenerator$2}=require$$2,{existsSync,readFileSync}=require$$2,{dirname:dirname$1,join}=require$$2;function fromBase64(_r){return Buffer?Buffer.from(_r,"base64").toString():window.atob(_r)}let PreviousMap$2=class{constructor(Tr,Ar){if(Ar.map===!1)return;this.loadAnnotation(Tr),this.inline=this.startWith(this.annotation,"data:");let Rr=Ar.map?Ar.map.prev:void 0,Pr=this.loadMap(Ar.from,Rr);!this.mapFile&&Ar.from&&(this.mapFile=Ar.from),this.mapFile&&(this.root=dirname$1(this.mapFile)),Pr&&(this.text=Pr)}consumer(){return this.consumerCache||(this.consumerCache=new SourceMapConsumer$2(this.text)),this.consumerCache}decodeInline(Tr){let Ar=/^data:application\/json;charset=utf-?8;base64,/,Rr=/^data:application\/json;base64,/,Pr=/^data:application\/json;charset=utf-?8,/,Dr=/^data:application\/json,/;if(Pr.test(Tr)||Dr.test(Tr))return decodeURIComponent(Tr.substr(RegExp.lastMatch.length));if(Ar.test(Tr)||Rr.test(Tr))return fromBase64(Tr.substr(RegExp.lastMatch.length));let Mr=Tr.match(/data:application\/json;([^,]+),/)[1];throw new Error("Unsupported source map encoding "+Mr)}getAnnotationURL(Tr){return Tr.replace(/^\/\*\s*# sourceMappingURL=/,"").trim()}isMap(Tr){return typeof Tr!="object"?!1:typeof Tr.mappings=="string"||typeof Tr._mappings=="string"||Array.isArray(Tr.sections)}loadAnnotation(Tr){let Ar=Tr.match(/\/\*\s*# sourceMappingURL=/gm);if(!Ar)return;let Rr=Tr.lastIndexOf(Ar.pop()),Pr=Tr.indexOf("*/",Rr);Rr>-1&&Pr>-1&&(this.annotation=this.getAnnotationURL(Tr.substring(Rr,Pr)))}loadFile(Tr){if(this.root=dirname$1(Tr),existsSync(Tr))return this.mapFile=Tr,readFileSync(Tr,"utf-8").toString().trim()}loadMap(Tr,Ar){if(Ar===!1)return!1;if(Ar){if(typeof Ar=="string")return Ar;if(typeof Ar=="function"){let Rr=Ar(Tr);if(Rr){let Pr=this.loadFile(Rr);if(!Pr)throw new Error("Unable to load previous source map: "+Rr.toString());return Pr}}else{if(Ar instanceof SourceMapConsumer$2)return SourceMapGenerator$2.fromSourceMap(Ar).toString();if(Ar instanceof SourceMapGenerator$2)return Ar.toString();if(this.isMap(Ar))return JSON.stringify(Ar);throw new Error("Unsupported previous source map format: "+Ar.toString())}}else{if(this.inline)return this.decodeInline(this.annotation);if(this.annotation){let Rr=this.annotation;return Tr&&(Rr=join(dirname$1(Tr),Rr)),this.loadFile(Rr)}}}startWith(Tr,Ar){return Tr?Tr.substr(0,Ar.length)===Ar:!1}withContent(){return!!(this.consumer().sourcesContent&&this.consumer().sourcesContent.length>0)}};var previousMap=PreviousMap$2;PreviousMap$2.default=PreviousMap$2;let{SourceMapConsumer:SourceMapConsumer$1,SourceMapGenerator:SourceMapGenerator$1}=require$$2,{fileURLToPath,pathToFileURL:pathToFileURL$1}=require$$2,{isAbsolute,resolve:resolve$1}=require$$2,{nanoid}=nonSecure,terminalHighlight=require$$2,CssSyntaxError$1=cssSyntaxError,PreviousMap$1=previousMap,fromOffsetCache=Symbol("fromOffsetCache"),sourceMapAvailable$1=!!(SourceMapConsumer$1&&SourceMapGenerator$1),pathAvailable$1=!!(resolve$1&&isAbsolute),Input$4=class{constructor(Tr,Ar={}){if(Tr===null||typeof Tr>"u"||typeof Tr=="object"&&!Tr.toString)throw new Error(`PostCSS received ${Tr} instead of CSS string`);if(this.css=Tr.toString(),this.css[0]==="\uFEFF"||this.css[0]===""?(this.hasBOM=!0,this.css=this.css.slice(1)):this.hasBOM=!1,Ar.from&&(!pathAvailable$1||/^\w+:\/\//.test(Ar.from)||isAbsolute(Ar.from)?this.file=Ar.from:this.file=resolve$1(Ar.from)),pathAvailable$1&&sourceMapAvailable$1){let Rr=new PreviousMap$1(this.css,Ar);if(Rr.text){this.map=Rr;let Pr=Rr.consumer().file;!this.file&&Pr&&(this.file=this.mapResolve(Pr))}}this.file||(this.id="<input css "+nanoid(6)+">"),this.map&&(this.map.file=this.from)}error(Tr,Ar,Rr,Pr={}){let Dr,Mr,Fr;if(Ar&&typeof Ar=="object"){let jr=Ar,Gr=Rr;if(typeof jr.offset=="number"){let Nr=this.fromOffset(jr.offset);Ar=Nr.line,Rr=Nr.col}else Ar=jr.line,Rr=jr.column;if(typeof Gr.offset=="number"){let Nr=this.fromOffset(Gr.offset);Mr=Nr.line,Fr=Nr.col}else Mr=Gr.line,Fr=Gr.column}else if(!Rr){let jr=this.fromOffset(Ar);Ar=jr.line,Rr=jr.col}let zr=this.origin(Ar,Rr,Mr,Fr);return zr?Dr=new CssSyntaxError$1(Tr,zr.endLine===void 0?zr.line:{column:zr.column,line:zr.line},zr.endLine===void 0?zr.column:{column:zr.endColumn,line:zr.endLine},zr.source,zr.file,Pr.plugin):Dr=new CssSyntaxError$1(Tr,Mr===void 0?Ar:{column:Rr,line:Ar},Mr===void 0?Rr:{column:Fr,line:Mr},this.css,this.file,Pr.plugin),Dr.input={column:Rr,endColumn:Fr,endLine:Mr,line:Ar,source:this.css},this.file&&(pathToFileURL$1&&(Dr.input.url=pathToFileURL$1(this.file).toString()),Dr.input.file=this.file),Dr}get from(){return this.file||this.id}fromOffset(Tr){let Ar,Rr;if(this[fromOffsetCache])Rr=this[fromOffsetCache];else{let Dr=this.css.split(`
`);Rr=new Array(Dr.length);let Mr=0;for(let Fr=0,zr=Dr.length;Fr<zr;Fr++)Rr[Fr]=Mr,Mr+=Dr[Fr].length+1;this[fromOffsetCache]=Rr}Ar=Rr[Rr.length-1];let Pr=0;if(Tr>=Ar)Pr=Rr.length-1;else{let Dr=Rr.length-2,Mr;for(;Pr<Dr;)if(Mr=Pr+(Dr-Pr>>1),Tr<Rr[Mr])Dr=Mr-1;else if(Tr>=Rr[Mr+1])Pr=Mr+1;else{Pr=Mr;break}}return{col:Tr-Rr[Pr]+1,line:Pr+1}}mapResolve(Tr){return/^\w+:\/\//.test(Tr)?Tr:resolve$1(this.map.consumer().sourceRoot||this.map.root||".",Tr)}origin(Tr,Ar,Rr,Pr){if(!this.map)return!1;let Dr=this.map.consumer(),Mr=Dr.originalPositionFor({column:Ar,line:Tr});if(!Mr.source)return!1;let Fr;typeof Rr=="number"&&(Fr=Dr.originalPositionFor({column:Pr,line:Rr}));let zr;isAbsolute(Mr.source)?zr=pathToFileURL$1(Mr.source):zr=new URL(Mr.source,this.map.consumer().sourceRoot||pathToFileURL$1(this.map.mapFile));let jr={column:Mr.column,endColumn:Fr&&Fr.column,endLine:Fr&&Fr.line,line:Mr.line,url:zr.toString()};if(zr.protocol==="file:")if(fileURLToPath)jr.file=fileURLToPath(zr);else throw new Error("file: protocol is not available in this PostCSS build");let Gr=Dr.sourceContentFor(Mr.source);return Gr&&(jr.source=Gr),jr}toJSON(){let Tr={};for(let Ar of["hasBOM","css","file","id"])this[Ar]!=null&&(Tr[Ar]=this[Ar]);return this.map&&(Tr.map={...this.map},Tr.map.consumerCache&&(Tr.map.consumerCache=void 0)),Tr}};var input=Input$4;Input$4.default=Input$4;terminalHighlight&&terminalHighlight.registerInput&&terminalHighlight.registerInput(Input$4);let{SourceMapConsumer,SourceMapGenerator}=require$$2,{dirname,relative,resolve,sep}=require$$2,{pathToFileURL}=require$$2,Input$3=input,sourceMapAvailable=!!(SourceMapConsumer&&SourceMapGenerator),pathAvailable=!!(dirname&&resolve&&relative&&sep),MapGenerator$2=class{constructor(Tr,Ar,Rr,Pr){this.stringify=Tr,this.mapOpts=Rr.map||{},this.root=Ar,this.opts=Rr,this.css=Pr,this.usesFileUrls=!this.mapOpts.from&&this.mapOpts.absolute}addAnnotation(){let Tr;this.isInline()?Tr="data:application/json;base64,"+this.toBase64(this.map.toString()):typeof this.mapOpts.annotation=="string"?Tr=this.mapOpts.annotation:typeof this.mapOpts.annotation=="function"?Tr=this.mapOpts.annotation(this.opts.to,this.root):Tr=this.outputFile()+".map";let Ar=`
`;this.css.includes(`\r
`)&&(Ar=`\r
`),this.css+=Ar+"/*# sourceMappingURL="+Tr+" */"}applyPrevMaps(){for(let Tr of this.previous()){let Ar=this.toUrl(this.path(Tr.file)),Rr=Tr.root||dirname(Tr.file),Pr;this.mapOpts.sourcesContent===!1?(Pr=new SourceMapConsumer(Tr.text),Pr.sourcesContent&&(Pr.sourcesContent=Pr.sourcesContent.map(()=>null))):Pr=Tr.consumer(),this.map.applySourceMap(Pr,Ar,this.toUrl(this.path(Rr)))}}clearAnnotation(){if(this.mapOpts.annotation!==!1)if(this.root){let Tr;for(let Ar=this.root.nodes.length-1;Ar>=0;Ar--)Tr=this.root.nodes[Ar],Tr.type==="comment"&&Tr.text.indexOf("# sourceMappingURL=")===0&&this.root.removeChild(Ar)}else this.css&&(this.css=this.css.replace(/(\n)?\/\*#[\S\s]*?\*\/$/gm,""))}generate(){if(this.clearAnnotation(),pathAvailable&&sourceMapAvailable&&this.isMap())return this.generateMap();{let Tr="";return this.stringify(this.root,Ar=>{Tr+=Ar}),[Tr]}}generateMap(){if(this.root)this.generateString();else if(this.previous().length===1){let Tr=this.previous()[0].consumer();Tr.file=this.outputFile(),this.map=SourceMapGenerator.fromSourceMap(Tr)}else this.map=new SourceMapGenerator({file:this.outputFile()}),this.map.addMapping({generated:{column:0,line:1},original:{column:0,line:1},source:this.opts.from?this.toUrl(this.path(this.opts.from)):"<no source>"});return this.isSourcesContent()&&this.setSourcesContent(),this.root&&this.previous().length>0&&this.applyPrevMaps(),this.isAnnotation()&&this.addAnnotation(),this.isInline()?[this.css]:[this.css,this.map]}generateString(){this.css="",this.map=new SourceMapGenerator({file:this.outputFile()});let Tr=1,Ar=1,Rr="<no source>",Pr={generated:{column:0,line:0},original:{column:0,line:0},source:""},Dr,Mr;this.stringify(this.root,(Fr,zr,jr)=>{if(this.css+=Fr,zr&&jr!=="end"&&(Pr.generated.line=Tr,Pr.generated.column=Ar-1,zr.source&&zr.source.start?(Pr.source=this.sourcePath(zr),Pr.original.line=zr.source.start.line,Pr.original.column=zr.source.start.column-1,this.map.addMapping(Pr)):(Pr.source=Rr,Pr.original.line=1,Pr.original.column=0,this.map.addMapping(Pr))),Dr=Fr.match(/\n/g),Dr?(Tr+=Dr.length,Mr=Fr.lastIndexOf(`
`),Ar=Fr.length-Mr):Ar+=Fr.length,zr&&jr!=="start"){let Gr=zr.parent||{raws:{}};(!(zr.type==="decl"||zr.type==="atrule"&&!zr.nodes)||zr!==Gr.last||Gr.raws.semicolon)&&(zr.source&&zr.source.end?(Pr.source=this.sourcePath(zr),Pr.original.line=zr.source.end.line,Pr.original.column=zr.source.end.column-1,Pr.generated.line=Tr,Pr.generated.column=Ar-2,this.map.addMapping(Pr)):(Pr.source=Rr,Pr.original.line=1,Pr.original.column=0,Pr.generated.line=Tr,Pr.generated.column=Ar-1,this.map.addMapping(Pr)))}})}isAnnotation(){return this.isInline()?!0:typeof this.mapOpts.annotation<"u"?this.mapOpts.annotation:this.previous().length?this.previous().some(Tr=>Tr.annotation):!0}isInline(){if(typeof this.mapOpts.inline<"u")return this.mapOpts.inline;let Tr=this.mapOpts.annotation;return typeof Tr<"u"&&Tr!==!0?!1:this.previous().length?this.previous().some(Ar=>Ar.inline):!0}isMap(){return typeof this.opts.map<"u"?!!this.opts.map:this.previous().length>0}isSourcesContent(){return typeof this.mapOpts.sourcesContent<"u"?this.mapOpts.sourcesContent:this.previous().length?this.previous().some(Tr=>Tr.withContent()):!0}outputFile(){return this.opts.to?this.path(this.opts.to):this.opts.from?this.path(this.opts.from):"to.css"}path(Tr){if(Tr.indexOf("<")===0||/^\w+:\/\//.test(Tr)||this.mapOpts.absolute)return Tr;let Ar=this.opts.to?dirname(this.opts.to):".";return typeof this.mapOpts.annotation=="string"&&(Ar=dirname(resolve(Ar,this.mapOpts.annotation))),Tr=relative(Ar,Tr),Tr}previous(){if(!this.previousMaps)if(this.previousMaps=[],this.root)this.root.walk(Tr=>{if(Tr.source&&Tr.source.input.map){let Ar=Tr.source.input.map;this.previousMaps.includes(Ar)||this.previousMaps.push(Ar)}});else{let Tr=new Input$3(this.css,this.opts);Tr.map&&this.previousMaps.push(Tr.map)}return this.previousMaps}setSourcesContent(){let Tr={};if(this.root)this.root.walk(Ar=>{if(Ar.source){let Rr=Ar.source.input.from;if(Rr&&!Tr[Rr]){Tr[Rr]=!0;let Pr=this.usesFileUrls?this.toFileUrl(Rr):this.toUrl(this.path(Rr));this.map.setSourceContent(Pr,Ar.source.input.css)}}});else if(this.css){let Ar=this.opts.from?this.toUrl(this.path(this.opts.from)):"<no source>";this.map.setSourceContent(Ar,this.css)}}sourcePath(Tr){return this.mapOpts.from?this.toUrl(this.mapOpts.from):this.usesFileUrls?this.toFileUrl(Tr.source.input.from):this.toUrl(this.path(Tr.source.input.from))}toBase64(Tr){return Buffer?Buffer.from(Tr).toString("base64"):window.btoa(unescape(encodeURIComponent(Tr)))}toFileUrl(Tr){if(pathToFileURL)return pathToFileURL(Tr).toString();throw new Error("`map.absolute` option is not available in this PostCSS build")}toUrl(Tr){return sep==="\\"&&(Tr=Tr.replace(/\\/g,"/")),encodeURI(Tr).replace(/[#?]/g,encodeURIComponent)}};var mapGenerator=MapGenerator$2;let Node$3=node,Comment$4=class extends Node$3{constructor(Tr){super(Tr),this.type="comment"}};var comment=Comment$4;Comment$4.default=Comment$4;let{isClean:isClean$1,my:my$1}=symbols,Declaration$3=declaration,Comment$3=comment,Node$2=node,parse$9,Rule$4,AtRule$4,Root$6;function cleanSource(_r){return _r.map(Tr=>(Tr.nodes&&(Tr.nodes=cleanSource(Tr.nodes)),delete Tr.source,Tr))}function markDirtyUp(_r){if(_r[isClean$1]=!1,_r.proxyOf.nodes)for(let Tr of _r.proxyOf.nodes)markDirtyUp(Tr)}let Container$7=class Kv extends Node$2{append(...Tr){for(let Ar of Tr){let Rr=this.normalize(Ar,this.last);for(let Pr of Rr)this.proxyOf.nodes.push(Pr)}return this.markDirty(),this}cleanRaws(Tr){if(super.cleanRaws(Tr),this.nodes)for(let Ar of this.nodes)Ar.cleanRaws(Tr)}each(Tr){if(!this.proxyOf.nodes)return;let Ar=this.getIterator(),Rr,Pr;for(;this.indexes[Ar]<this.proxyOf.nodes.length&&(Rr=this.indexes[Ar],Pr=Tr(this.proxyOf.nodes[Rr],Rr),Pr!==!1);)this.indexes[Ar]+=1;return delete this.indexes[Ar],Pr}every(Tr){return this.nodes.every(Tr)}get first(){if(this.proxyOf.nodes)return this.proxyOf.nodes[0]}getIterator(){this.lastEach||(this.lastEach=0),this.indexes||(this.indexes={}),this.lastEach+=1;let Tr=this.lastEach;return this.indexes[Tr]=0,Tr}getProxyProcessor(){return{get(Tr,Ar){return Ar==="proxyOf"?Tr:Tr[Ar]?Ar==="each"||typeof Ar=="string"&&Ar.startsWith("walk")?(...Rr)=>Tr[Ar](...Rr.map(Pr=>typeof Pr=="function"?(Dr,Mr)=>Pr(Dr.toProxy(),Mr):Pr)):Ar==="every"||Ar==="some"?Rr=>Tr[Ar]((Pr,...Dr)=>Rr(Pr.toProxy(),...Dr)):Ar==="root"?()=>Tr.root().toProxy():Ar==="nodes"?Tr.nodes.map(Rr=>Rr.toProxy()):Ar==="first"||Ar==="last"?Tr[Ar].toProxy():Tr[Ar]:Tr[Ar]},set(Tr,Ar,Rr){return Tr[Ar]===Rr||(Tr[Ar]=Rr,(Ar==="name"||Ar==="params"||Ar==="selector")&&Tr.markDirty()),!0}}}index(Tr){return typeof Tr=="number"?Tr:(Tr.proxyOf&&(Tr=Tr.proxyOf),this.proxyOf.nodes.indexOf(Tr))}insertAfter(Tr,Ar){let Rr=this.index(Tr),Pr=this.normalize(Ar,this.proxyOf.nodes[Rr]).reverse();Rr=this.index(Tr);for(let Mr of Pr)this.proxyOf.nodes.splice(Rr+1,0,Mr);let Dr;for(let Mr in this.indexes)Dr=this.indexes[Mr],Rr<Dr&&(this.indexes[Mr]=Dr+Pr.length);return this.markDirty(),this}insertBefore(Tr,Ar){let Rr=this.index(Tr),Pr=Rr===0?"prepend":!1,Dr=this.normalize(Ar,this.proxyOf.nodes[Rr],Pr).reverse();Rr=this.index(Tr);for(let Fr of Dr)this.proxyOf.nodes.splice(Rr,0,Fr);let Mr;for(let Fr in this.indexes)Mr=this.indexes[Fr],Rr<=Mr&&(this.indexes[Fr]=Mr+Dr.length);return this.markDirty(),this}get last(){if(this.proxyOf.nodes)return this.proxyOf.nodes[this.proxyOf.nodes.length-1]}normalize(Tr,Ar){if(typeof Tr=="string")Tr=cleanSource(parse$9(Tr).nodes);else if(Array.isArray(Tr)){Tr=Tr.slice(0);for(let Pr of Tr)Pr.parent&&Pr.parent.removeChild(Pr,"ignore")}else if(Tr.type==="root"&&this.type!=="document"){Tr=Tr.nodes.slice(0);for(let Pr of Tr)Pr.parent&&Pr.parent.removeChild(Pr,"ignore")}else if(Tr.type)Tr=[Tr];else if(Tr.prop){if(typeof Tr.value>"u")throw new Error("Value field is missed in node creation");typeof Tr.value!="string"&&(Tr.value=String(Tr.value)),Tr=[new Declaration$3(Tr)]}else if(Tr.selector)Tr=[new Rule$4(Tr)];else if(Tr.name)Tr=[new AtRule$4(Tr)];else if(Tr.text)Tr=[new Comment$3(Tr)];else throw new Error("Unknown node type in node creation");return Tr.map(Pr=>(Pr[my$1]||Kv.rebuild(Pr),Pr=Pr.proxyOf,Pr.parent&&Pr.parent.removeChild(Pr),Pr[isClean$1]&&markDirtyUp(Pr),typeof Pr.raws.before>"u"&&Ar&&typeof Ar.raws.before<"u"&&(Pr.raws.before=Ar.raws.before.replace(/\S/g,"")),Pr.parent=this.proxyOf,Pr))}prepend(...Tr){Tr=Tr.reverse();for(let Ar of Tr){let Rr=this.normalize(Ar,this.first,"prepend").reverse();for(let Pr of Rr)this.proxyOf.nodes.unshift(Pr);for(let Pr in this.indexes)this.indexes[Pr]=this.indexes[Pr]+Rr.length}return this.markDirty(),this}push(Tr){return Tr.parent=this,this.proxyOf.nodes.push(Tr),this}removeAll(){for(let Tr of this.proxyOf.nodes)Tr.parent=void 0;return this.proxyOf.nodes=[],this.markDirty(),this}removeChild(Tr){Tr=this.index(Tr),this.proxyOf.nodes[Tr].parent=void 0,this.proxyOf.nodes.splice(Tr,1);let Ar;for(let Rr in this.indexes)Ar=this.indexes[Rr],Ar>=Tr&&(this.indexes[Rr]=Ar-1);return this.markDirty(),this}replaceValues(Tr,Ar,Rr){return Rr||(Rr=Ar,Ar={}),this.walkDecls(Pr=>{Ar.props&&!Ar.props.includes(Pr.prop)||Ar.fast&&!Pr.value.includes(Ar.fast)||(Pr.value=Pr.value.replace(Tr,Rr))}),this.markDirty(),this}some(Tr){return this.nodes.some(Tr)}walk(Tr){return this.each((Ar,Rr)=>{let Pr;try{Pr=Tr(Ar,Rr)}catch(Dr){throw Ar.addToError(Dr)}return Pr!==!1&&Ar.walk&&(Pr=Ar.walk(Tr)),Pr})}walkAtRules(Tr,Ar){return Ar?Tr instanceof RegExp?this.walk((Rr,Pr)=>{if(Rr.type==="atrule"&&Tr.test(Rr.name))return Ar(Rr,Pr)}):this.walk((Rr,Pr)=>{if(Rr.type==="atrule"&&Rr.name===Tr)return Ar(Rr,Pr)}):(Ar=Tr,this.walk((Rr,Pr)=>{if(Rr.type==="atrule")return Ar(Rr,Pr)}))}walkComments(Tr){return this.walk((Ar,Rr)=>{if(Ar.type==="comment")return Tr(Ar,Rr)})}walkDecls(Tr,Ar){return Ar?Tr instanceof RegExp?this.walk((Rr,Pr)=>{if(Rr.type==="decl"&&Tr.test(Rr.prop))return Ar(Rr,Pr)}):this.walk((Rr,Pr)=>{if(Rr.type==="decl"&&Rr.prop===Tr)return Ar(Rr,Pr)}):(Ar=Tr,this.walk((Rr,Pr)=>{if(Rr.type==="decl")return Ar(Rr,Pr)}))}walkRules(Tr,Ar){return Ar?Tr instanceof RegExp?this.walk((Rr,Pr)=>{if(Rr.type==="rule"&&Tr.test(Rr.selector))return Ar(Rr,Pr)}):this.walk((Rr,Pr)=>{if(Rr.type==="rule"&&Rr.selector===Tr)return Ar(Rr,Pr)}):(Ar=Tr,this.walk((Rr,Pr)=>{if(Rr.type==="rule")return Ar(Rr,Pr)}))}};Container$7.registerParse=_r=>{parse$9=_r};Container$7.registerRule=_r=>{Rule$4=_r};Container$7.registerAtRule=_r=>{AtRule$4=_r};Container$7.registerRoot=_r=>{Root$6=_r};var container=Container$7;Container$7.default=Container$7;Container$7.rebuild=_r=>{_r.type==="atrule"?Object.setPrototypeOf(_r,AtRule$4.prototype):_r.type==="rule"?Object.setPrototypeOf(_r,Rule$4.prototype):_r.type==="decl"?Object.setPrototypeOf(_r,Declaration$3.prototype):_r.type==="comment"?Object.setPrototypeOf(_r,Comment$3.prototype):_r.type==="root"&&Object.setPrototypeOf(_r,Root$6.prototype),_r[my$1]=!0,_r.nodes&&_r.nodes.forEach(Tr=>{Container$7.rebuild(Tr)})};let Container$6=container,LazyResult$4,Processor$3,Document$3=class extends Container$6{constructor(Tr){super({type:"document",...Tr}),this.nodes||(this.nodes=[])}toResult(Tr={}){return new LazyResult$4(new Processor$3,this,Tr).stringify()}};Document$3.registerLazyResult=_r=>{LazyResult$4=_r};Document$3.registerProcessor=_r=>{Processor$3=_r};var document$1=Document$3;Document$3.default=Document$3;let Warning$2=class{constructor(Tr,Ar={}){if(this.type="warning",this.text=Tr,Ar.node&&Ar.node.source){let Rr=Ar.node.rangeBy(Ar);this.line=Rr.start.line,this.column=Rr.start.column,this.endLine=Rr.end.line,this.endColumn=Rr.end.column}for(let Rr in Ar)this[Rr]=Ar[Rr]}toString(){return this.node?this.node.error(this.text,{index:this.index,plugin:this.plugin,word:this.word}).message:this.plugin?this.plugin+": "+this.text:this.text}};var warning=Warning$2;Warning$2.default=Warning$2;let Warning$1=warning,Result$3=class{constructor(Tr,Ar,Rr){this.processor=Tr,this.messages=[],this.root=Ar,this.opts=Rr,this.css=void 0,this.map=void 0}get content(){return this.css}toString(){return this.css}warn(Tr,Ar={}){Ar.plugin||this.lastPlugin&&this.lastPlugin.postcssPlugin&&(Ar.plugin=this.lastPlugin.postcssPlugin);let Rr=new Warning$1(Tr,Ar);return this.messages.push(Rr),Rr}warnings(){return this.messages.filter(Tr=>Tr.type==="warning")}};var result=Result$3;Result$3.default=Result$3;const SINGLE_QUOTE="'".charCodeAt(0),DOUBLE_QUOTE='"'.charCodeAt(0),BACKSLASH="\\".charCodeAt(0),SLASH="/".charCodeAt(0),NEWLINE=`
`.charCodeAt(0),SPACE=" ".charCodeAt(0),FEED="\f".charCodeAt(0),TAB="	".charCodeAt(0),CR="\r".charCodeAt(0),OPEN_SQUARE="[".charCodeAt(0),CLOSE_SQUARE="]".charCodeAt(0),OPEN_PARENTHESES="(".charCodeAt(0),CLOSE_PARENTHESES=")".charCodeAt(0),OPEN_CURLY="{".charCodeAt(0),CLOSE_CURLY="}".charCodeAt(0),SEMICOLON=";".charCodeAt(0),ASTERISK="*".charCodeAt(0),COLON=":".charCodeAt(0),AT="@".charCodeAt(0),RE_AT_END=/[\t\n\f\r "#'()/;[\\\]{}]/g,RE_WORD_END=/[\t\n\f\r !"#'():;@[\\\]{}]|\/(?=\*)/g,RE_BAD_BRACKET=/.[\n"'(/\\]/,RE_HEX_ESCAPE=/[\da-f]/i;var tokenize=function(Tr,Ar={}){let Rr=Tr.css.valueOf(),Pr=Ar.ignoreErrors,Dr,Mr,Fr,zr,jr,Gr,Nr,Lr,Ur,Vr,Wr=Rr.length,qr=0,Kr=[],Xr=[];function Zr(){return qr}function _i(is){throw Tr.error("Unclosed "+is,qr)}function Jr(){return Xr.length===0&&qr>=Wr}function es(is){if(Xr.length)return Xr.pop();if(qr>=Wr)return;let rs=is?is.ignoreUnclosed:!1;switch(Dr=Rr.charCodeAt(qr),Dr){case NEWLINE:case SPACE:case TAB:case CR:case FEED:{Mr=qr;do Mr+=1,Dr=Rr.charCodeAt(Mr);while(Dr===SPACE||Dr===NEWLINE||Dr===TAB||Dr===CR||Dr===FEED);Vr=["space",Rr.slice(qr,Mr)],qr=Mr-1;break}case OPEN_SQUARE:case CLOSE_SQUARE:case OPEN_CURLY:case CLOSE_CURLY:case COLON:case SEMICOLON:case CLOSE_PARENTHESES:{let as=String.fromCharCode(Dr);Vr=[as,as,qr];break}case OPEN_PARENTHESES:{if(Lr=Kr.length?Kr.pop()[1]:"",Ur=Rr.charCodeAt(qr+1),Lr==="url"&&Ur!==SINGLE_QUOTE&&Ur!==DOUBLE_QUOTE&&Ur!==SPACE&&Ur!==NEWLINE&&Ur!==TAB&&Ur!==FEED&&Ur!==CR){Mr=qr;do{if(Gr=!1,Mr=Rr.indexOf(")",Mr+1),Mr===-1)if(Pr||rs){Mr=qr;break}else _i("bracket");for(Nr=Mr;Rr.charCodeAt(Nr-1)===BACKSLASH;)Nr-=1,Gr=!Gr}while(Gr);Vr=["brackets",Rr.slice(qr,Mr+1),qr,Mr],qr=Mr}else Mr=Rr.indexOf(")",qr+1),zr=Rr.slice(qr,Mr+1),Mr===-1||RE_BAD_BRACKET.test(zr)?Vr=["(","(",qr]:(Vr=["brackets",zr,qr,Mr],qr=Mr);break}case SINGLE_QUOTE:case DOUBLE_QUOTE:{Fr=Dr===SINGLE_QUOTE?"'":'"',Mr=qr;do{if(Gr=!1,Mr=Rr.indexOf(Fr,Mr+1),Mr===-1)if(Pr||rs){Mr=qr+1;break}else _i("string");for(Nr=Mr;Rr.charCodeAt(Nr-1)===BACKSLASH;)Nr-=1,Gr=!Gr}while(Gr);Vr=["string",Rr.slice(qr,Mr+1),qr,Mr],qr=Mr;break}case AT:{RE_AT_END.lastIndex=qr+1,RE_AT_END.test(Rr),RE_AT_END.lastIndex===0?Mr=Rr.length-1:Mr=RE_AT_END.lastIndex-2,Vr=["at-word",Rr.slice(qr,Mr+1),qr,Mr],qr=Mr;break}case BACKSLASH:{for(Mr=qr,jr=!0;Rr.charCodeAt(Mr+1)===BACKSLASH;)Mr+=1,jr=!jr;if(Dr=Rr.charCodeAt(Mr+1),jr&&Dr!==SLASH&&Dr!==SPACE&&Dr!==NEWLINE&&Dr!==TAB&&Dr!==CR&&Dr!==FEED&&(Mr+=1,RE_HEX_ESCAPE.test(Rr.charAt(Mr)))){for(;RE_HEX_ESCAPE.test(Rr.charAt(Mr+1));)Mr+=1;Rr.charCodeAt(Mr+1)===SPACE&&(Mr+=1)}Vr=["word",Rr.slice(qr,Mr+1),qr,Mr],qr=Mr;break}default:{Dr===SLASH&&Rr.charCodeAt(qr+1)===ASTERISK?(Mr=Rr.indexOf("*/",qr+2)+1,Mr===0&&(Pr||rs?Mr=Rr.length:_i("comment")),Vr=["comment",Rr.slice(qr,Mr+1),qr,Mr],qr=Mr):(RE_WORD_END.lastIndex=qr+1,RE_WORD_END.test(Rr),RE_WORD_END.lastIndex===0?Mr=Rr.length-1:Mr=RE_WORD_END.lastIndex-2,Vr=["word",Rr.slice(qr,Mr+1),qr,Mr],Kr.push(Vr),qr=Mr);break}}return qr++,Vr}function ts(is){Xr.push(is)}return{back:ts,endOfFile:Jr,nextToken:es,position:Zr}};let Container$5=container,AtRule$3=class extends Container$5{constructor(Tr){super(Tr),this.type="atrule"}append(...Tr){return this.proxyOf.nodes||(this.nodes=[]),super.append(...Tr)}prepend(...Tr){return this.proxyOf.nodes||(this.nodes=[]),super.prepend(...Tr)}};var atRule=AtRule$3;AtRule$3.default=AtRule$3;Container$5.registerAtRule(AtRule$3);let Container$4=container,LazyResult$3,Processor$2,Root$5=class extends Container$4{constructor(Tr){super(Tr),this.type="root",this.nodes||(this.nodes=[])}normalize(Tr,Ar,Rr){let Pr=super.normalize(Tr);if(Ar){if(Rr==="prepend")this.nodes.length>1?Ar.raws.before=this.nodes[1].raws.before:delete Ar.raws.before;else if(this.first!==Ar)for(let Dr of Pr)Dr.raws.before=Ar.raws.before}return Pr}removeChild(Tr,Ar){let Rr=this.index(Tr);return!Ar&&Rr===0&&this.nodes.length>1&&(this.nodes[1].raws.before=this.nodes[Rr].raws.before),super.removeChild(Tr)}toResult(Tr={}){return new LazyResult$3(new Processor$2,this,Tr).stringify()}};Root$5.registerLazyResult=_r=>{LazyResult$3=_r};Root$5.registerProcessor=_r=>{Processor$2=_r};var root=Root$5;Root$5.default=Root$5;Container$4.registerRoot(Root$5);let list$2={comma(_r){return list$2.split(_r,[","],!0)},space(_r){let Tr=[" ",`
`,"	"];return list$2.split(_r,Tr)},split(_r,Tr,Ar){let Rr=[],Pr="",Dr=!1,Mr=0,Fr=!1,zr="",jr=!1;for(let Gr of _r)jr?jr=!1:Gr==="\\"?jr=!0:Fr?Gr===zr&&(Fr=!1):Gr==='"'||Gr==="'"?(Fr=!0,zr=Gr):Gr==="("?Mr+=1:Gr===")"?Mr>0&&(Mr-=1):Mr===0&&Tr.includes(Gr)&&(Dr=!0),Dr?(Pr!==""&&Rr.push(Pr.trim()),Pr="",Dr=!1):Pr+=Gr;return(Ar||Pr!=="")&&Rr.push(Pr.trim()),Rr}};var list_1=list$2;list$2.default=list$2;let Container$3=container,list$1=list_1,Rule$3=class extends Container$3{constructor(Tr){super(Tr),this.type="rule",this.nodes||(this.nodes=[])}get selectors(){return list$1.comma(this.selector)}set selectors(Tr){let Ar=this.selector?this.selector.match(/,\s*/):null,Rr=Ar?Ar[0]:","+this.raw("between","beforeOpen");this.selector=Tr.join(Rr)}};var rule=Rule$3;Rule$3.default=Rule$3;Container$3.registerRule(Rule$3);let Declaration$2=declaration,tokenizer=tokenize,Comment$2=comment,AtRule$2=atRule,Root$4=root,Rule$2=rule;const SAFE_COMMENT_NEIGHBOR={empty:!0,space:!0};function findLastWithPosition(_r){for(let Tr=_r.length-1;Tr>=0;Tr--){let Ar=_r[Tr],Rr=Ar[3]||Ar[2];if(Rr)return Rr}}let Parser$1=class{constructor(Tr){this.input=Tr,this.root=new Root$4,this.current=this.root,this.spaces="",this.semicolon=!1,this.customProperty=!1,this.createTokenizer(),this.root.source={input:Tr,start:{column:1,line:1,offset:0}}}atrule(Tr){let Ar=new AtRule$2;Ar.name=Tr[1].slice(1),Ar.name===""&&this.unnamedAtrule(Ar,Tr),this.init(Ar,Tr[2]);let Rr,Pr,Dr,Mr=!1,Fr=!1,zr=[],jr=[];for(;!this.tokenizer.endOfFile();){if(Tr=this.tokenizer.nextToken(),Rr=Tr[0],Rr==="("||Rr==="["?jr.push(Rr==="("?")":"]"):Rr==="{"&&jr.length>0?jr.push("}"):Rr===jr[jr.length-1]&&jr.pop(),jr.length===0)if(Rr===";"){Ar.source.end=this.getPosition(Tr[2]),Ar.source.end.offset++,this.semicolon=!0;break}else if(Rr==="{"){Fr=!0;break}else if(Rr==="}"){if(zr.length>0){for(Dr=zr.length-1,Pr=zr[Dr];Pr&&Pr[0]==="space";)Pr=zr[--Dr];Pr&&(Ar.source.end=this.getPosition(Pr[3]||Pr[2]),Ar.source.end.offset++)}this.end(Tr);break}else zr.push(Tr);else zr.push(Tr);if(this.tokenizer.endOfFile()){Mr=!0;break}}Ar.raws.between=this.spacesAndCommentsFromEnd(zr),zr.length?(Ar.raws.afterName=this.spacesAndCommentsFromStart(zr),this.raw(Ar,"params",zr),Mr&&(Tr=zr[zr.length-1],Ar.source.end=this.getPosition(Tr[3]||Tr[2]),Ar.source.end.offset++,this.spaces=Ar.raws.between,Ar.raws.between="")):(Ar.raws.afterName="",Ar.params=""),Fr&&(Ar.nodes=[],this.current=Ar)}checkMissedSemicolon(Tr){let Ar=this.colon(Tr);if(Ar===!1)return;let Rr=0,Pr;for(let Dr=Ar-1;Dr>=0&&(Pr=Tr[Dr],!(Pr[0]!=="space"&&(Rr+=1,Rr===2)));Dr--);throw this.input.error("Missed semicolon",Pr[0]==="word"?Pr[3]+1:Pr[2])}colon(Tr){let Ar=0,Rr,Pr,Dr;for(let[Mr,Fr]of Tr.entries()){if(Rr=Fr,Pr=Rr[0],Pr==="("&&(Ar+=1),Pr===")"&&(Ar-=1),Ar===0&&Pr===":")if(!Dr)this.doubleColon(Rr);else{if(Dr[0]==="word"&&Dr[1]==="progid")continue;return Mr}Dr=Rr}return!1}comment(Tr){let Ar=new Comment$2;this.init(Ar,Tr[2]),Ar.source.end=this.getPosition(Tr[3]||Tr[2]),Ar.source.end.offset++;let Rr=Tr[1].slice(2,-2);if(/^\s*$/.test(Rr))Ar.text="",Ar.raws.left=Rr,Ar.raws.right="";else{let Pr=Rr.match(/^(\s*)([^]*\S)(\s*)$/);Ar.text=Pr[2],Ar.raws.left=Pr[1],Ar.raws.right=Pr[3]}}createTokenizer(){this.tokenizer=tokenizer(this.input)}decl(Tr,Ar){let Rr=new Declaration$2;this.init(Rr,Tr[0][2]);let Pr=Tr[Tr.length-1];for(Pr[0]===";"&&(this.semicolon=!0,Tr.pop()),Rr.source.end=this.getPosition(Pr[3]||Pr[2]||findLastWithPosition(Tr)),Rr.source.end.offset++;Tr[0][0]!=="word";)Tr.length===1&&this.unknownWord(Tr),Rr.raws.before+=Tr.shift()[1];for(Rr.source.start=this.getPosition(Tr[0][2]),Rr.prop="";Tr.length;){let jr=Tr[0][0];if(jr===":"||jr==="space"||jr==="comment")break;Rr.prop+=Tr.shift()[1]}Rr.raws.between="";let Dr;for(;Tr.length;)if(Dr=Tr.shift(),Dr[0]===":"){Rr.raws.between+=Dr[1];break}else Dr[0]==="word"&&/\w/.test(Dr[1])&&this.unknownWord([Dr]),Rr.raws.between+=Dr[1];(Rr.prop[0]==="_"||Rr.prop[0]==="*")&&(Rr.raws.before+=Rr.prop[0],Rr.prop=Rr.prop.slice(1));let Mr=[],Fr;for(;Tr.length&&(Fr=Tr[0][0],!(Fr!=="space"&&Fr!=="comment"));)Mr.push(Tr.shift());this.precheckMissedSemicolon(Tr);for(let jr=Tr.length-1;jr>=0;jr--){if(Dr=Tr[jr],Dr[1].toLowerCase()==="!important"){Rr.important=!0;let Gr=this.stringFrom(Tr,jr);Gr=this.spacesFromEnd(Tr)+Gr,Gr!==" !important"&&(Rr.raws.important=Gr);break}else if(Dr[1].toLowerCase()==="important"){let Gr=Tr.slice(0),Nr="";for(let Lr=jr;Lr>0;Lr--){let Ur=Gr[Lr][0];if(Nr.trim().indexOf("!")===0&&Ur!=="space")break;Nr=Gr.pop()[1]+Nr}Nr.trim().indexOf("!")===0&&(Rr.important=!0,Rr.raws.important=Nr,Tr=Gr)}if(Dr[0]!=="space"&&Dr[0]!=="comment")break}Tr.some(jr=>jr[0]!=="space"&&jr[0]!=="comment")&&(Rr.raws.between+=Mr.map(jr=>jr[1]).join(""),Mr=[]),this.raw(Rr,"value",Mr.concat(Tr),Ar),Rr.value.includes(":")&&!Ar&&this.checkMissedSemicolon(Tr)}doubleColon(Tr){throw this.input.error("Double colon",{offset:Tr[2]},{offset:Tr[2]+Tr[1].length})}emptyRule(Tr){let Ar=new Rule$2;this.init(Ar,Tr[2]),Ar.selector="",Ar.raws.between="",this.current=Ar}end(Tr){this.current.nodes&&this.current.nodes.length&&(this.current.raws.semicolon=this.semicolon),this.semicolon=!1,this.current.raws.after=(this.current.raws.after||"")+this.spaces,this.spaces="",this.current.parent?(this.current.source.end=this.getPosition(Tr[2]),this.current.source.end.offset++,this.current=this.current.parent):this.unexpectedClose(Tr)}endFile(){this.current.parent&&this.unclosedBlock(),this.current.nodes&&this.current.nodes.length&&(this.current.raws.semicolon=this.semicolon),this.current.raws.after=(this.current.raws.after||"")+this.spaces,this.root.source.end=this.getPosition(this.tokenizer.position())}freeSemicolon(Tr){if(this.spaces+=Tr[1],this.current.nodes){let Ar=this.current.nodes[this.current.nodes.length-1];Ar&&Ar.type==="rule"&&!Ar.raws.ownSemicolon&&(Ar.raws.ownSemicolon=this.spaces,this.spaces="")}}getPosition(Tr){let Ar=this.input.fromOffset(Tr);return{column:Ar.col,line:Ar.line,offset:Tr}}init(Tr,Ar){this.current.push(Tr),Tr.source={input:this.input,start:this.getPosition(Ar)},Tr.raws.before=this.spaces,this.spaces="",Tr.type!=="comment"&&(this.semicolon=!1)}other(Tr){let Ar=!1,Rr=null,Pr=!1,Dr=null,Mr=[],Fr=Tr[1].startsWith("--"),zr=[],jr=Tr;for(;jr;){if(Rr=jr[0],zr.push(jr),Rr==="("||Rr==="[")Dr||(Dr=jr),Mr.push(Rr==="("?")":"]");else if(Fr&&Pr&&Rr==="{")Dr||(Dr=jr),Mr.push("}");else if(Mr.length===0)if(Rr===";")if(Pr){this.decl(zr,Fr);return}else break;else if(Rr==="{"){this.rule(zr);return}else if(Rr==="}"){this.tokenizer.back(zr.pop()),Ar=!0;break}else Rr===":"&&(Pr=!0);else Rr===Mr[Mr.length-1]&&(Mr.pop(),Mr.length===0&&(Dr=null));jr=this.tokenizer.nextToken()}if(this.tokenizer.endOfFile()&&(Ar=!0),Mr.length>0&&this.unclosedBracket(Dr),Ar&&Pr){if(!Fr)for(;zr.length&&(jr=zr[zr.length-1][0],!(jr!=="space"&&jr!=="comment"));)this.tokenizer.back(zr.pop());this.decl(zr,Fr)}else this.unknownWord(zr)}parse(){let Tr;for(;!this.tokenizer.endOfFile();)switch(Tr=this.tokenizer.nextToken(),Tr[0]){case"space":this.spaces+=Tr[1];break;case";":this.freeSemicolon(Tr);break;case"}":this.end(Tr);break;case"comment":this.comment(Tr);break;case"at-word":this.atrule(Tr);break;case"{":this.emptyRule(Tr);break;default:this.other(Tr);break}this.endFile()}precheckMissedSemicolon(){}raw(Tr,Ar,Rr,Pr){let Dr,Mr,Fr=Rr.length,zr="",jr=!0,Gr,Nr;for(let Lr=0;Lr<Fr;Lr+=1)Dr=Rr[Lr],Mr=Dr[0],Mr==="space"&&Lr===Fr-1&&!Pr?jr=!1:Mr==="comment"?(Nr=Rr[Lr-1]?Rr[Lr-1][0]:"empty",Gr=Rr[Lr+1]?Rr[Lr+1][0]:"empty",!SAFE_COMMENT_NEIGHBOR[Nr]&&!SAFE_COMMENT_NEIGHBOR[Gr]?zr.slice(-1)===","?jr=!1:zr+=Dr[1]:jr=!1):zr+=Dr[1];if(!jr){let Lr=Rr.reduce((Ur,Vr)=>Ur+Vr[1],"");Tr.raws[Ar]={raw:Lr,value:zr}}Tr[Ar]=zr}rule(Tr){Tr.pop();let Ar=new Rule$2;this.init(Ar,Tr[0][2]),Ar.raws.between=this.spacesAndCommentsFromEnd(Tr),this.raw(Ar,"selector",Tr),this.current=Ar}spacesAndCommentsFromEnd(Tr){let Ar,Rr="";for(;Tr.length&&(Ar=Tr[Tr.length-1][0],!(Ar!=="space"&&Ar!=="comment"));)Rr=Tr.pop()[1]+Rr;return Rr}spacesAndCommentsFromStart(Tr){let Ar,Rr="";for(;Tr.length&&(Ar=Tr[0][0],!(Ar!=="space"&&Ar!=="comment"));)Rr+=Tr.shift()[1];return Rr}spacesFromEnd(Tr){let Ar,Rr="";for(;Tr.length&&(Ar=Tr[Tr.length-1][0],Ar==="space");)Rr=Tr.pop()[1]+Rr;return Rr}stringFrom(Tr,Ar){let Rr="";for(let Pr=Ar;Pr<Tr.length;Pr++)Rr+=Tr[Pr][1];return Tr.splice(Ar,Tr.length-Ar),Rr}unclosedBlock(){let Tr=this.current.source.start;throw this.input.error("Unclosed block",Tr.line,Tr.column)}unclosedBracket(Tr){throw this.input.error("Unclosed bracket",{offset:Tr[2]},{offset:Tr[2]+1})}unexpectedClose(Tr){throw this.input.error("Unexpected }",{offset:Tr[2]},{offset:Tr[2]+1})}unknownWord(Tr){throw this.input.error("Unknown word",{offset:Tr[0][2]},{offset:Tr[0][2]+Tr[0][1].length})}unnamedAtrule(Tr,Ar){throw this.input.error("At-rule without name",{offset:Ar[2]},{offset:Ar[2]+Ar[1].length})}};var parser$1=Parser$1;let Container$2=container,Parser=parser$1,Input$2=input;function parse$8(_r,Tr){let Ar=new Input$2(_r,Tr),Rr=new Parser(Ar);try{Rr.parse()}catch(Pr){throw Pr}return Rr.root}var parse_1=parse$8;parse$8.default=parse$8;Container$2.registerParse(parse$8);let{isClean,my}=symbols,MapGenerator$1=mapGenerator,stringify$2=stringify_1,Container$1=container,Document$2=document$1,Result$2=result,parse$7=parse_1,Root$3=root;const TYPE_TO_CLASS_NAME={atrule:"AtRule",comment:"Comment",decl:"Declaration",document:"Document",root:"Root",rule:"Rule"},PLUGIN_PROPS={AtRule:!0,AtRuleExit:!0,Comment:!0,CommentExit:!0,Declaration:!0,DeclarationExit:!0,Document:!0,DocumentExit:!0,Once:!0,OnceExit:!0,postcssPlugin:!0,prepare:!0,Root:!0,RootExit:!0,Rule:!0,RuleExit:!0},NOT_VISITORS={Once:!0,postcssPlugin:!0,prepare:!0},CHILDREN=0;function isPromise$1(_r){return typeof _r=="object"&&typeof _r.then=="function"}function getEvents(_r){let Tr=!1,Ar=TYPE_TO_CLASS_NAME[_r.type];return _r.type==="decl"?Tr=_r.prop.toLowerCase():_r.type==="atrule"&&(Tr=_r.name.toLowerCase()),Tr&&_r.append?[Ar,Ar+"-"+Tr,CHILDREN,Ar+"Exit",Ar+"Exit-"+Tr]:Tr?[Ar,Ar+"-"+Tr,Ar+"Exit",Ar+"Exit-"+Tr]:_r.append?[Ar,CHILDREN,Ar+"Exit"]:[Ar,Ar+"Exit"]}function toStack(_r){let Tr;return _r.type==="document"?Tr=["Document",CHILDREN,"DocumentExit"]:_r.type==="root"?Tr=["Root",CHILDREN,"RootExit"]:Tr=getEvents(_r),{eventIndex:0,events:Tr,iterator:0,node:_r,visitorIndex:0,visitors:[]}}function cleanMarks(_r){return _r[isClean]=!1,_r.nodes&&_r.nodes.forEach(Tr=>cleanMarks(Tr)),_r}let postcss$1={},LazyResult$2=class Yv{constructor(Tr,Ar,Rr){this.stringified=!1,this.processed=!1;let Pr;if(typeof Ar=="object"&&Ar!==null&&(Ar.type==="root"||Ar.type==="document"))Pr=cleanMarks(Ar);else if(Ar instanceof Yv||Ar instanceof Result$2)Pr=cleanMarks(Ar.root),Ar.map&&(typeof Rr.map>"u"&&(Rr.map={}),Rr.map.inline||(Rr.map.inline=!1),Rr.map.prev=Ar.map);else{let Dr=parse$7;Rr.syntax&&(Dr=Rr.syntax.parse),Rr.parser&&(Dr=Rr.parser),Dr.parse&&(Dr=Dr.parse);try{Pr=Dr(Ar,Rr)}catch(Mr){this.processed=!0,this.error=Mr}Pr&&!Pr[my]&&Container$1.rebuild(Pr)}this.result=new Result$2(Tr,Pr,Rr),this.helpers={...postcss$1,postcss:postcss$1,result:this.result},this.plugins=this.processor.plugins.map(Dr=>typeof Dr=="object"&&Dr.prepare?{...Dr,...Dr.prepare(this.result)}:Dr)}async(){return this.error?Promise.reject(this.error):this.processed?Promise.resolve(this.result):(this.processing||(this.processing=this.runAsync()),this.processing)}catch(Tr){return this.async().catch(Tr)}get content(){return this.stringify().content}get css(){return this.stringify().css}finally(Tr){return this.async().then(Tr,Tr)}getAsyncError(){throw new Error("Use process(css).then(cb) to work with async plugins")}handleError(Tr,Ar){let Rr=this.result.lastPlugin;try{Ar&&Ar.addToError(Tr),this.error=Tr,Tr.name==="CssSyntaxError"&&!Tr.plugin?(Tr.plugin=Rr.postcssPlugin,Tr.setMessage()):Rr.postcssVersion}catch(Pr){console&&console.error&&console.error(Pr)}return Tr}get map(){return this.stringify().map}get messages(){return this.sync().messages}get opts(){return this.result.opts}prepareVisitors(){this.listeners={};let Tr=(Ar,Rr,Pr)=>{this.listeners[Rr]||(this.listeners[Rr]=[]),this.listeners[Rr].push([Ar,Pr])};for(let Ar of this.plugins)if(typeof Ar=="object")for(let Rr in Ar){if(!PLUGIN_PROPS[Rr]&&/^[A-Z]/.test(Rr))throw new Error(`Unknown event ${Rr} in ${Ar.postcssPlugin}. Try to update PostCSS (${this.processor.version} now).`);if(!NOT_VISITORS[Rr])if(typeof Ar[Rr]=="object")for(let Pr in Ar[Rr])Pr==="*"?Tr(Ar,Rr,Ar[Rr][Pr]):Tr(Ar,Rr+"-"+Pr.toLowerCase(),Ar[Rr][Pr]);else typeof Ar[Rr]=="function"&&Tr(Ar,Rr,Ar[Rr])}this.hasListener=Object.keys(this.listeners).length>0}get processor(){return this.result.processor}get root(){return this.sync().root}async runAsync(){this.plugin=0;for(let Tr=0;Tr<this.plugins.length;Tr++){let Ar=this.plugins[Tr],Rr=this.runOnRoot(Ar);if(isPromise$1(Rr))try{await Rr}catch(Pr){throw this.handleError(Pr)}}if(this.prepareVisitors(),this.hasListener){let Tr=this.result.root;for(;!Tr[isClean];){Tr[isClean]=!0;let Ar=[toStack(Tr)];for(;Ar.length>0;){let Rr=this.visitTick(Ar);if(isPromise$1(Rr))try{await Rr}catch(Pr){let Dr=Ar[Ar.length-1].node;throw this.handleError(Pr,Dr)}}}if(this.listeners.OnceExit)for(let[Ar,Rr]of this.listeners.OnceExit){this.result.lastPlugin=Ar;try{if(Tr.type==="document"){let Pr=Tr.nodes.map(Dr=>Rr(Dr,this.helpers));await Promise.all(Pr)}else await Rr(Tr,this.helpers)}catch(Pr){throw this.handleError(Pr)}}}return this.processed=!0,this.stringify()}runOnRoot(Tr){this.result.lastPlugin=Tr;try{if(typeof Tr=="object"&&Tr.Once){if(this.result.root.type==="document"){let Ar=this.result.root.nodes.map(Rr=>Tr.Once(Rr,this.helpers));return isPromise$1(Ar[0])?Promise.all(Ar):Ar}return Tr.Once(this.result.root,this.helpers)}else if(typeof Tr=="function")return Tr(this.result.root,this.result)}catch(Ar){throw this.handleError(Ar)}}stringify(){if(this.error)throw this.error;if(this.stringified)return this.result;this.stringified=!0,this.sync();let Tr=this.result.opts,Ar=stringify$2;Tr.syntax&&(Ar=Tr.syntax.stringify),Tr.stringifier&&(Ar=Tr.stringifier),Ar.stringify&&(Ar=Ar.stringify);let Pr=new MapGenerator$1(Ar,this.result.root,this.result.opts).generate();return this.result.css=Pr[0],this.result.map=Pr[1],this.result}get[Symbol.toStringTag](){return"LazyResult"}sync(){if(this.error)throw this.error;if(this.processed)return this.result;if(this.processed=!0,this.processing)throw this.getAsyncError();for(let Tr of this.plugins){let Ar=this.runOnRoot(Tr);if(isPromise$1(Ar))throw this.getAsyncError()}if(this.prepareVisitors(),this.hasListener){let Tr=this.result.root;for(;!Tr[isClean];)Tr[isClean]=!0,this.walkSync(Tr);if(this.listeners.OnceExit)if(Tr.type==="document")for(let Ar of Tr.nodes)this.visitSync(this.listeners.OnceExit,Ar);else this.visitSync(this.listeners.OnceExit,Tr)}return this.result}then(Tr,Ar){return this.async().then(Tr,Ar)}toString(){return this.css}visitSync(Tr,Ar){for(let[Rr,Pr]of Tr){this.result.lastPlugin=Rr;let Dr;try{Dr=Pr(Ar,this.helpers)}catch(Mr){throw this.handleError(Mr,Ar.proxyOf)}if(Ar.type!=="root"&&Ar.type!=="document"&&!Ar.parent)return!0;if(isPromise$1(Dr))throw this.getAsyncError()}}visitTick(Tr){let Ar=Tr[Tr.length-1],{node:Rr,visitors:Pr}=Ar;if(Rr.type!=="root"&&Rr.type!=="document"&&!Rr.parent){Tr.pop();return}if(Pr.length>0&&Ar.visitorIndex<Pr.length){let[Mr,Fr]=Pr[Ar.visitorIndex];Ar.visitorIndex+=1,Ar.visitorIndex===Pr.length&&(Ar.visitors=[],Ar.visitorIndex=0),this.result.lastPlugin=Mr;try{return Fr(Rr.toProxy(),this.helpers)}catch(zr){throw this.handleError(zr,Rr)}}if(Ar.iterator!==0){let Mr=Ar.iterator,Fr;for(;Fr=Rr.nodes[Rr.indexes[Mr]];)if(Rr.indexes[Mr]+=1,!Fr[isClean]){Fr[isClean]=!0,Tr.push(toStack(Fr));return}Ar.iterator=0,delete Rr.indexes[Mr]}let Dr=Ar.events;for(;Ar.eventIndex<Dr.length;){let Mr=Dr[Ar.eventIndex];if(Ar.eventIndex+=1,Mr===CHILDREN){Rr.nodes&&Rr.nodes.length&&(Rr[isClean]=!0,Ar.iterator=Rr.getIterator());return}else if(this.listeners[Mr]){Ar.visitors=this.listeners[Mr];return}}Tr.pop()}walkSync(Tr){Tr[isClean]=!0;let Ar=getEvents(Tr);for(let Rr of Ar)if(Rr===CHILDREN)Tr.nodes&&Tr.each(Pr=>{Pr[isClean]||this.walkSync(Pr)});else{let Pr=this.listeners[Rr];if(Pr&&this.visitSync(Pr,Tr.toProxy()))return}}warnings(){return this.sync().warnings()}};LazyResult$2.registerPostcss=_r=>{postcss$1=_r};var lazyResult=LazyResult$2;LazyResult$2.default=LazyResult$2;Root$3.registerLazyResult(LazyResult$2);Document$2.registerLazyResult(LazyResult$2);let MapGenerator=mapGenerator,stringify$1=stringify_1,parse$6=parse_1;const Result$1=result;let NoWorkResult$1=class{constructor(Tr,Ar,Rr){Ar=Ar.toString(),this.stringified=!1,this._processor=Tr,this._css=Ar,this._opts=Rr,this._map=void 0;let Pr,Dr=stringify$1;this.result=new Result$1(this._processor,Pr,this._opts),this.result.css=Ar;let Mr=this;Object.defineProperty(this.result,"root",{get(){return Mr.root}});let Fr=new MapGenerator(Dr,Pr,this._opts,Ar);if(Fr.isMap()){let[zr,jr]=Fr.generate();zr&&(this.result.css=zr),jr&&(this.result.map=jr)}}async(){return this.error?Promise.reject(this.error):Promise.resolve(this.result)}catch(Tr){return this.async().catch(Tr)}get content(){return this.result.css}get css(){return this.result.css}finally(Tr){return this.async().then(Tr,Tr)}get map(){return this.result.map}get messages(){return[]}get opts(){return this.result.opts}get processor(){return this.result.processor}get root(){if(this._root)return this._root;let Tr,Ar=parse$6;try{Tr=Ar(this._css,this._opts)}catch(Rr){this.error=Rr}if(this.error)throw this.error;return this._root=Tr,Tr}get[Symbol.toStringTag](){return"NoWorkResult"}sync(){if(this.error)throw this.error;return this.result}then(Tr,Ar){return this.async().then(Tr,Ar)}toString(){return this._css}warnings(){return[]}};var noWorkResult=NoWorkResult$1;NoWorkResult$1.default=NoWorkResult$1;let NoWorkResult=noWorkResult,LazyResult$1=lazyResult,Document$1=document$1,Root$2=root,Processor$1=class{constructor(Tr=[]){this.version="8.4.29",this.plugins=this.normalize(Tr)}normalize(Tr){let Ar=[];for(let Rr of Tr)if(Rr.postcss===!0?Rr=Rr():Rr.postcss&&(Rr=Rr.postcss),typeof Rr=="object"&&Array.isArray(Rr.plugins))Ar=Ar.concat(Rr.plugins);else if(typeof Rr=="object"&&Rr.postcssPlugin)Ar.push(Rr);else if(typeof Rr=="function")Ar.push(Rr);else if(!(typeof Rr=="object"&&(Rr.parse||Rr.stringify)))throw new Error(Rr+" is not a PostCSS plugin");return Ar}process(Tr,Ar={}){return this.plugins.length===0&&typeof Ar.parser>"u"&&typeof Ar.stringifier>"u"&&typeof Ar.syntax>"u"?new NoWorkResult(this,Tr,Ar):new LazyResult$1(this,Tr,Ar)}use(Tr){return this.plugins=this.plugins.concat(this.normalize([Tr])),this}};var processor=Processor$1;Processor$1.default=Processor$1;Root$2.registerProcessor(Processor$1);Document$1.registerProcessor(Processor$1);let Declaration$1=declaration,PreviousMap=previousMap,Comment$1=comment,AtRule$1=atRule,Input$1=input,Root$1=root,Rule$1=rule;function fromJSON$1(_r,Tr){if(Array.isArray(_r))return _r.map(Pr=>fromJSON$1(Pr));let{inputs:Ar,...Rr}=_r;if(Ar){Tr=[];for(let Pr of Ar){let Dr={...Pr,__proto__:Input$1.prototype};Dr.map&&(Dr.map={...Dr.map,__proto__:PreviousMap.prototype}),Tr.push(Dr)}}if(Rr.nodes&&(Rr.nodes=_r.nodes.map(Pr=>fromJSON$1(Pr,Tr))),Rr.source){let{inputId:Pr,...Dr}=Rr.source;Rr.source=Dr,Pr!=null&&(Rr.source.input=Tr[Pr])}if(Rr.type==="root")return new Root$1(Rr);if(Rr.type==="decl")return new Declaration$1(Rr);if(Rr.type==="rule")return new Rule$1(Rr);if(Rr.type==="comment")return new Comment$1(Rr);if(Rr.type==="atrule")return new AtRule$1(Rr);throw new Error("Unknown node type: "+_r.type)}var fromJSON_1=fromJSON$1;fromJSON$1.default=fromJSON$1;let CssSyntaxError=cssSyntaxError,Declaration=declaration,LazyResult=lazyResult,Container=container,Processor=processor,stringify=stringify_1,fromJSON=fromJSON_1,Document=document$1,Warning=warning,Comment=comment,AtRule=atRule,Result=result,Input=input,parse$5=parse_1,list=list_1,Rule=rule,Root=root,Node$1=node;function postcss(..._r){return _r.length===1&&Array.isArray(_r[0])&&(_r=_r[0]),new Processor(_r)}postcss.plugin=function(Tr,Ar){let Rr=!1;function Pr(...Mr){console&&console.warn&&!Rr&&(Rr=!0,console.warn(Tr+`: postcss.plugin was deprecated. Migration guide:
https://evilmartians.com/chronicles/postcss-8-plugin-migration`),{}.LANG&&{}.LANG.startsWith("cn")&&console.warn(Tr+`:  postcss.plugin . :
https://www.w3ctech.com/topic/2226`));let Fr=Ar(...Mr);return Fr.postcssPlugin=Tr,Fr.postcssVersion=new Processor().version,Fr}let Dr;return Object.defineProperty(Pr,"postcss",{get(){return Dr||(Dr=Pr()),Dr}}),Pr.process=function(Mr,Fr,zr){return postcss([Pr(zr)]).process(Mr,Fr)},Pr};postcss.stringify=stringify;postcss.parse=parse$5;postcss.fromJSON=fromJSON;postcss.list=list;postcss.comment=_r=>new Comment(_r);postcss.atRule=_r=>new AtRule(_r);postcss.decl=_r=>new Declaration(_r);postcss.rule=_r=>new Rule(_r);postcss.root=_r=>new Root(_r);postcss.document=_r=>new Document(_r);postcss.CssSyntaxError=CssSyntaxError;postcss.Declaration=Declaration;postcss.Container=Container;postcss.Processor=Processor;postcss.Document=Document;postcss.Comment=Comment;postcss.Warning=Warning;postcss.AtRule=AtRule;postcss.Result=Result;postcss.Input=Input;postcss.Rule=Rule;postcss.Root=Root;postcss.Node=Node$1;LazyResult.registerPostcss(postcss);var postcss_1=postcss;postcss.default=postcss;const htmlparser=lib$5,escapeStringRegexp=escapeStringRegexp$1,{isPlainObject:isPlainObject$1}=isPlainObject$3,deepmerge=cjs,parseSrcset=parseSrcsetExports,{parse:postcssParse}=postcss_1,mediaTags=["img","audio","video","picture","svg","object","map","iframe","embed"],vulnerableTags=["script","style"];function each(_r,Tr){_r&&Object.keys(_r).forEach(function(Ar){Tr(_r[Ar],Ar)})}function has(_r,Tr){return{}.hasOwnProperty.call(_r,Tr)}function filter(_r,Tr){const Ar=[];return each(_r,function(Rr){Tr(Rr)&&Ar.push(Rr)}),Ar}function isEmptyObject(_r){for(const Tr in _r)if(has(_r,Tr))return!1;return!0}function stringifySrcset(_r){return _r.map(function(Tr){if(!Tr.url)throw new Error("URL missing");return Tr.url+(Tr.w?` ${Tr.w}w`:"")+(Tr.h?` ${Tr.h}h`:"")+(Tr.d?` ${Tr.d}x`:"")}).join(", ")}var sanitizeHtml_1=sanitizeHtml;const VALID_HTML_ATTRIBUTE_NAME=/^[^\0\t\n\f\r /<=>]+$/;function sanitizeHtml(_r,Tr,Ar){if(_r==null)return"";typeof _r=="number"&&(_r=_r.toString());let Rr="",Pr="";function Dr(xs,ys){const ps=this;this.tag=xs,this.attribs=ys||{},this.tagPosition=Rr.length,this.text="",this.mediaChildren=[],this.updateParentNodeText=function(){if(qr.length){const vs=qr[qr.length-1];vs.text+=ps.text}},this.updateParentNodeMediaChildren=function(){qr.length&&mediaTags.includes(this.tag)&&qr[qr.length-1].mediaChildren.push(this.tag)}}Tr=Object.assign({},sanitizeHtml.defaults,Tr),Tr.parser=Object.assign({},htmlParserDefaults,Tr.parser);const Mr=function(xs){return Tr.allowedTags===!1||(Tr.allowedTags||[]).indexOf(xs)>-1};vulnerableTags.forEach(function(xs){Mr(xs)&&!Tr.allowVulnerableTags&&console.warn(`

 Your \`allowedTags\` option includes, \`${xs}\`, which is inherently
vulnerable to XSS attacks. Please remove it from \`allowedTags\`.
Or, to disable this warning, add the \`allowVulnerableTags\` option
and ensure you are accounting for this risk.

`)});const Fr=Tr.nonTextTags||["script","style","textarea","option"];let zr,jr;Tr.allowedAttributes&&(zr={},jr={},each(Tr.allowedAttributes,function(xs,ys){zr[ys]=[];const ps=[];xs.forEach(function(vs){typeof vs=="string"&&vs.indexOf("*")>=0?ps.push(escapeStringRegexp(vs).replace(/\\\*/g,".*")):zr[ys].push(vs)}),ps.length&&(jr[ys]=new RegExp("^("+ps.join("|")+")$"))}));const Gr={},Nr={},Lr={};each(Tr.allowedClasses,function(xs,ys){if(zr&&(has(zr,ys)||(zr[ys]=[]),zr[ys].push("class")),Gr[ys]=xs,Array.isArray(xs)){const ps=[];Gr[ys]=[],Lr[ys]=[],xs.forEach(function(vs){typeof vs=="string"&&vs.indexOf("*")>=0?ps.push(escapeStringRegexp(vs).replace(/\\\*/g,".*")):vs instanceof RegExp?Lr[ys].push(vs):Gr[ys].push(vs)}),ps.length&&(Nr[ys]=new RegExp("^("+ps.join("|")+")$"))}});const Ur={};let Vr;each(Tr.transformTags,function(xs,ys){let ps;typeof xs=="function"?ps=xs:typeof xs=="string"&&(ps=sanitizeHtml.simpleTransform(xs)),ys==="*"?Vr=ps:Ur[ys]=ps});let Wr,qr,Kr,Xr,Zr,_i,Jr=!1;ts();const es=new htmlparser.Parser({onopentag:function(xs,ys){if(Tr.enforceHtmlBoundary&&xs==="html"&&ts(),Zr){_i++;return}const ps=new Dr(xs,ys);qr.push(ps);let vs=!1;const Ds=!!ps.text;let js;if(has(Ur,xs)&&(js=Ur[xs](xs,ys),ps.attribs=ys=js.attribs,js.text!==void 0&&(ps.innerText=js.text),xs!==js.tagName&&(ps.name=xs=js.tagName,Xr[Wr]=js.tagName)),Vr&&(js=Vr(xs,ys),ps.attribs=ys=js.attribs,xs!==js.tagName&&(ps.name=xs=js.tagName,Xr[Wr]=js.tagName)),(!Mr(xs)||Tr.disallowedTagsMode==="recursiveEscape"&&!isEmptyObject(Kr)||Tr.nestingLimit!=null&&Wr>=Tr.nestingLimit)&&(vs=!0,Kr[Wr]=!0,Tr.disallowedTagsMode==="discard"&&Fr.indexOf(xs)!==-1&&(Zr=!0,_i=1),Kr[Wr]=!0),Wr++,vs){if(Tr.disallowedTagsMode==="discard")return;Pr=Rr,Rr=""}Rr+="<"+xs,xs==="script"&&(Tr.allowedScriptHostnames||Tr.allowedScriptDomains)&&(ps.innerText=""),(!zr||has(zr,xs)||zr["*"])&&each(ys,function(zs,qs){if(!VALID_HTML_ATTRIBUTE_NAME.test(qs)){delete ps.attribs[qs];return}if(zs===""&&(Tr.nonBooleanAttributes.includes(qs)||Tr.nonBooleanAttributes.includes("*"))){delete ps.attribs[qs];return}let fo=!1;if(!zr||has(zr,xs)&&zr[xs].indexOf(qs)!==-1||zr["*"]&&zr["*"].indexOf(qs)!==-1||has(jr,xs)&&jr[xs].test(qs)||jr["*"]&&jr["*"].test(qs))fo=!0;else if(zr&&zr[xs]){for(const Qs of zr[xs])if(isPlainObject$1(Qs)&&Qs.name&&Qs.name===qs){fo=!0;let no="";if(Qs.multiple===!0){const yo=zs.split(" ");for(const Js of yo)Qs.values.indexOf(Js)!==-1&&(no===""?no=Js:no+=" "+Js)}else Qs.values.indexOf(zs)>=0&&(no=zs);zs=no}}if(fo){if(Tr.allowedSchemesAppliedToAttributes.indexOf(qs)!==-1&&rs(xs,zs)){delete ps.attribs[qs];return}if(xs==="script"&&qs==="src"){let Qs=!0;try{const no=as(zs);if(Tr.allowedScriptHostnames||Tr.allowedScriptDomains){const yo=(Tr.allowedScriptHostnames||[]).find(function(lo){return lo===no.url.hostname}),Js=(Tr.allowedScriptDomains||[]).find(function(lo){return no.url.hostname===lo||no.url.hostname.endsWith(`.${lo}`)});Qs=yo||Js}}catch{Qs=!1}if(!Qs){delete ps.attribs[qs];return}}if(xs==="iframe"&&qs==="src"){let Qs=!0;try{const no=as(zs);if(no.isRelativeUrl)Qs=has(Tr,"allowIframeRelativeUrls")?Tr.allowIframeRelativeUrls:!Tr.allowedIframeHostnames&&!Tr.allowedIframeDomains;else if(Tr.allowedIframeHostnames||Tr.allowedIframeDomains){const yo=(Tr.allowedIframeHostnames||[]).find(function(lo){return lo===no.url.hostname}),Js=(Tr.allowedIframeDomains||[]).find(function(lo){return no.url.hostname===lo||no.url.hostname.endsWith(`.${lo}`)});Qs=yo||Js}}catch{Qs=!1}if(!Qs){delete ps.attribs[qs];return}}if(qs==="srcset")try{let Qs=parseSrcset(zs);if(Qs.forEach(function(no){rs("srcset",no.url)&&(no.evil=!0)}),Qs=filter(Qs,function(no){return!no.evil}),Qs.length)zs=stringifySrcset(filter(Qs,function(no){return!no.evil})),ps.attribs[qs]=zs;else{delete ps.attribs[qs];return}}catch{delete ps.attribs[qs];return}if(qs==="class"){const Qs=Gr[xs],no=Gr["*"],yo=Nr[xs],Js=Lr[xs],lo=Nr["*"],vo=[yo,lo].concat(Js).filter(function(Ro){return Ro});if(Qs&&no?zs=$s(zs,deepmerge(Qs,no),vo):zs=$s(zs,Qs||no,vo),!zs.length){delete ps.attribs[qs];return}}if(qs==="style"){if(Tr.parseStyleAttributes)try{const Qs=postcssParse(xs+" {"+zs+"}"),no=ls(Qs,Tr.allowedStyles);if(zs=fs(no),zs.length===0){delete ps.attribs[qs];return}}catch{typeof window<"u"&&console.warn('Failed to parse "'+xs+" {"+zs+`}", If you're running this in a browser, we recommend to disable style parsing: options.parseStyleAttributes: false, since this only works in a node environment due to a postcss dependency, More info: https://github.com/apostrophecms/sanitize-html/issues/547`),delete ps.attribs[qs];return}else if(Tr.allowedStyles)throw new Error("allowedStyles option cannot be used together with parseStyleAttributes: false.")}Rr+=" "+qs,zs&&zs.length&&(Rr+='="'+is(zs,!0)+'"')}else delete ps.attribs[qs]}),Tr.selfClosing.indexOf(xs)!==-1?Rr+=" />":(Rr+=">",ps.innerText&&!Ds&&!Tr.textFilter&&(Rr+=is(ps.innerText),Jr=!0)),vs&&(Rr=Pr+is(Rr),Pr="")},ontext:function(xs){if(Zr)return;const ys=qr[qr.length-1];let ps;if(ys&&(ps=ys.tag,xs=ys.innerText!==void 0?ys.innerText:xs),Tr.disallowedTagsMode==="discard"&&(ps==="script"||ps==="style"))Rr+=xs;else{const vs=is(xs,!1);Tr.textFilter&&!Jr?Rr+=Tr.textFilter(vs,ps):Jr||(Rr+=vs)}if(qr.length){const vs=qr[qr.length-1];vs.text+=xs}},onclosetag:function(xs,ys){if(Zr)if(_i--,!_i)Zr=!1;else return;const ps=qr.pop();if(!ps)return;if(ps.tag!==xs){qr.push(ps);return}Zr=Tr.enforceHtmlBoundary?xs==="html":!1,Wr--;const vs=Kr[Wr];if(vs){if(delete Kr[Wr],Tr.disallowedTagsMode==="discard"){ps.updateParentNodeText();return}Pr=Rr,Rr=""}if(Xr[Wr]&&(xs=Xr[Wr],delete Xr[Wr]),Tr.exclusiveFilter&&Tr.exclusiveFilter(ps)){Rr=Rr.substr(0,ps.tagPosition);return}if(ps.updateParentNodeMediaChildren(),ps.updateParentNodeText(),Tr.selfClosing.indexOf(xs)!==-1||ys&&!Mr(xs)&&["escape","recursiveEscape"].indexOf(Tr.disallowedTagsMode)>=0){vs&&(Rr=Pr,Pr="");return}Rr+="</"+xs+">",vs&&(Rr=Pr+is(Rr),Pr=""),Jr=!1}},Tr.parser);return es.write(_r),es.end(),Rr;function ts(){Rr="",Wr=0,qr=[],Kr={},Xr={},Zr=!1,_i=0}function is(xs,ys){return typeof xs!="string"&&(xs=xs+""),Tr.parser.decodeEntities&&(xs=xs.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),ys&&(xs=xs.replace(/"/g,"&quot;"))),xs=xs.replace(/&(?![a-zA-Z0-9#]{1,20};)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),ys&&(xs=xs.replace(/"/g,"&quot;")),xs}function rs(xs,ys){for(ys=ys.replace(/[\x00-\x20]+/g,"");;){const Ds=ys.indexOf("<!--");if(Ds===-1)break;const js=ys.indexOf("-->",Ds+4);if(js===-1)break;ys=ys.substring(0,Ds)+ys.substring(js+3)}const ps=ys.match(/^([a-zA-Z][a-zA-Z0-9.\-+]*):/);if(!ps)return ys.match(/^[/\\]{2}/)?!Tr.allowProtocolRelative:!1;const vs=ps[1].toLowerCase();return has(Tr.allowedSchemesByTag,xs)?Tr.allowedSchemesByTag[xs].indexOf(vs)===-1:!Tr.allowedSchemes||Tr.allowedSchemes.indexOf(vs)===-1}function as(xs){if(xs=xs.replace(/^(\w+:)?\s*[\\/]\s*[\\/]/,"$1//"),xs.startsWith("relative:"))throw new Error("relative: exploit attempt");let ys="relative://relative-site";for(let Ds=0;Ds<100;Ds++)ys+=`/${Ds}`;const ps=new URL(xs,ys);return{isRelativeUrl:ps&&ps.hostname==="relative-site"&&ps.protocol==="relative:",url:ps}}function ls(xs,ys){if(!ys)return xs;const ps=xs.nodes[0];let vs;return ys[ps.selector]&&ys["*"]?vs=deepmerge(ys[ps.selector],ys["*"]):vs=ys[ps.selector]||ys["*"],vs&&(xs.nodes[0].nodes=ps.nodes.reduce(Ts(vs),[])),xs}function fs(xs){return xs.nodes[0].nodes.reduce(function(ys,ps){return ys.push(`${ps.prop}:${ps.value}${ps.important?" !important":""}`),ys},[]).join(";")}function Ts(xs){return function(ys,ps){return has(xs,ps.prop)&&xs[ps.prop].some(function(Ds){return Ds.test(ps.value)})&&ys.push(ps),ys}}function $s(xs,ys,ps){return ys?(xs=xs.split(/\s+/),xs.filter(function(vs){return ys.indexOf(vs)!==-1||ps.some(function(Ds){return Ds.test(vs)})}).join(" ")):xs}}const htmlParserDefaults={decodeEntities:!0};sanitizeHtml.defaults={allowedTags:["address","article","aside","footer","header","h1","h2","h3","h4","h5","h6","hgroup","main","nav","section","blockquote","dd","div","dl","dt","figcaption","figure","hr","li","main","ol","p","pre","ul","a","abbr","b","bdi","bdo","br","cite","code","data","dfn","em","i","kbd","mark","q","rb","rp","rt","rtc","ruby","s","samp","small","span","strong","sub","sup","time","u","var","wbr","caption","col","colgroup","table","tbody","td","tfoot","th","thead","tr"],nonBooleanAttributes:["abbr","accept","accept-charset","accesskey","action","allow","alt","as","autocapitalize","autocomplete","blocking","charset","cite","class","color","cols","colspan","content","contenteditable","coords","crossorigin","data","datetime","decoding","dir","dirname","download","draggable","enctype","enterkeyhint","fetchpriority","for","form","formaction","formenctype","formmethod","formtarget","headers","height","hidden","high","href","hreflang","http-equiv","id","imagesizes","imagesrcset","inputmode","integrity","is","itemid","itemprop","itemref","itemtype","kind","label","lang","list","loading","low","max","maxlength","media","method","min","minlength","name","nonce","optimum","pattern","ping","placeholder","popover","popovertarget","popovertargetaction","poster","preload","referrerpolicy","rel","rows","rowspan","sandbox","scope","shape","size","sizes","slot","span","spellcheck","src","srcdoc","srclang","srcset","start","step","style","tabindex","target","title","translate","type","usemap","value","width","wrap","onauxclick","onafterprint","onbeforematch","onbeforeprint","onbeforeunload","onbeforetoggle","onblur","oncancel","oncanplay","oncanplaythrough","onchange","onclick","onclose","oncontextlost","oncontextmenu","oncontextrestored","oncopy","oncuechange","oncut","ondblclick","ondrag","ondragend","ondragenter","ondragleave","ondragover","ondragstart","ondrop","ondurationchange","onemptied","onended","onerror","onfocus","onformdata","onhashchange","oninput","oninvalid","onkeydown","onkeypress","onkeyup","onlanguagechange","onload","onloadeddata","onloadedmetadata","onloadstart","onmessage","onmessageerror","onmousedown","onmouseenter","onmouseleave","onmousemove","onmouseout","onmouseover","onmouseup","onoffline","ononline","onpagehide","onpageshow","onpaste","onpause","onplay","onplaying","onpopstate","onprogress","onratechange","onreset","onresize","onrejectionhandled","onscroll","onscrollend","onsecuritypolicyviolation","onseeked","onseeking","onselect","onslotchange","onstalled","onstorage","onsubmit","onsuspend","ontimeupdate","ontoggle","onunhandledrejection","onunload","onvolumechange","onwaiting","onwheel"],disallowedTagsMode:"discard",allowedAttributes:{a:["href","name","target"],img:["src","srcset","alt","title","width","height","loading"]},selfClosing:["img","br","hr","area","base","basefont","input","link","meta"],allowedSchemes:["http","https","ftp","mailto","tel"],allowedSchemesByTag:{},allowedSchemesAppliedToAttributes:["href","src","cite"],allowProtocolRelative:!0,enforceHtmlBoundary:!1,parseStyleAttributes:!0};sanitizeHtml.simpleTransform=function(_r,Tr,Ar){return Ar=Ar===void 0?!0:Ar,Tr=Tr||{},function(Rr,Pr){let Dr;if(Ar)for(Dr in Tr)Pr[Dr]=Tr[Dr];else Pr=Tr;return{tagName:_r,attribs:Pr}}};const Ye=getDefaultExportFromCjs$1(sanitizeHtml_1);function getDefaultExportFromCjs(_r){return _r&&_r.__esModule&&Object.prototype.hasOwnProperty.call(_r,"default")?_r.default:_r}var urlToolkit={exports:{}};(function(_r,Tr){(function(Ar){var Rr=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,Pr=/^(?=([^\/?#]*))\1([^]*)$/,Dr=/(?:\/|^)\.(?=\/)/g,Mr=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,Fr={buildAbsoluteURL:function(zr,jr,Gr){if(Gr=Gr||{},zr=zr.trim(),jr=jr.trim(),!jr){if(!Gr.alwaysNormalize)return zr;var Nr=Fr.parseURL(zr);if(!Nr)throw new Error("Error trying to parse base URL.");return Nr.path=Fr.normalizePath(Nr.path),Fr.buildURLFromParts(Nr)}var Lr=Fr.parseURL(jr);if(!Lr)throw new Error("Error trying to parse relative URL.");if(Lr.scheme)return Gr.alwaysNormalize?(Lr.path=Fr.normalizePath(Lr.path),Fr.buildURLFromParts(Lr)):jr;var Ur=Fr.parseURL(zr);if(!Ur)throw new Error("Error trying to parse base URL.");if(!Ur.netLoc&&Ur.path&&Ur.path[0]!=="/"){var Vr=Pr.exec(Ur.path);Ur.netLoc=Vr[1],Ur.path=Vr[2]}Ur.netLoc&&!Ur.path&&(Ur.path="/");var Wr={scheme:Ur.scheme,netLoc:Lr.netLoc,path:null,params:Lr.params,query:Lr.query,fragment:Lr.fragment};if(!Lr.netLoc&&(Wr.netLoc=Ur.netLoc,Lr.path[0]!=="/"))if(!Lr.path)Wr.path=Ur.path,Lr.params||(Wr.params=Ur.params,Lr.query||(Wr.query=Ur.query));else{var qr=Ur.path,Kr=qr.substring(0,qr.lastIndexOf("/")+1)+Lr.path;Wr.path=Fr.normalizePath(Kr)}return Wr.path===null&&(Wr.path=Gr.alwaysNormalize?Fr.normalizePath(Lr.path):Lr.path),Fr.buildURLFromParts(Wr)},parseURL:function(zr){var jr=Rr.exec(zr);return jr?{scheme:jr[1]||"",netLoc:jr[2]||"",path:jr[3]||"",params:jr[4]||"",query:jr[5]||"",fragment:jr[6]||""}:null},normalizePath:function(zr){for(zr=zr.split("").reverse().join("").replace(Dr,"");zr.length!==(zr=zr.replace(Mr,"")).length;);return zr.split("").reverse().join("")},buildURLFromParts:function(zr){return zr.scheme+zr.netLoc+zr.path+zr.params+zr.query+zr.fragment}};_r.exports=Fr})()})(urlToolkit);var urlToolkitExports=urlToolkit.exports;function ownKeys(_r,Tr){var Ar=Object.keys(_r);if(Object.getOwnPropertySymbols){var Rr=Object.getOwnPropertySymbols(_r);Tr&&(Rr=Rr.filter(function(Pr){return Object.getOwnPropertyDescriptor(_r,Pr).enumerable})),Ar.push.apply(Ar,Rr)}return Ar}function _objectSpread2(_r){for(var Tr=1;Tr<arguments.length;Tr++){var Ar=arguments[Tr]!=null?arguments[Tr]:{};Tr%2?ownKeys(Object(Ar),!0).forEach(function(Rr){_defineProperty(_r,Rr,Ar[Rr])}):Object.getOwnPropertyDescriptors?Object.defineProperties(_r,Object.getOwnPropertyDescriptors(Ar)):ownKeys(Object(Ar)).forEach(function(Rr){Object.defineProperty(_r,Rr,Object.getOwnPropertyDescriptor(Ar,Rr))})}return _r}function _defineProperty(_r,Tr,Ar){return Tr=_toPropertyKey(Tr),Tr in _r?Object.defineProperty(_r,Tr,{value:Ar,enumerable:!0,configurable:!0,writable:!0}):_r[Tr]=Ar,_r}function _extends(){return _extends=Object.assign?Object.assign.bind():function(_r){for(var Tr=1;Tr<arguments.length;Tr++){var Ar=arguments[Tr];for(var Rr in Ar)Object.prototype.hasOwnProperty.call(Ar,Rr)&&(_r[Rr]=Ar[Rr])}return _r},_extends.apply(this,arguments)}function _toPrimitive(_r,Tr){if(typeof _r!="object"||_r===null)return _r;var Ar=_r[Symbol.toPrimitive];if(Ar!==void 0){var Rr=Ar.call(_r,Tr||"default");if(typeof Rr!="object")return Rr;throw new TypeError("@@toPrimitive must return a primitive value.")}return(Tr==="string"?String:Number)(_r)}function _toPropertyKey(_r){var Tr=_toPrimitive(_r,"string");return typeof Tr=="symbol"?Tr:String(Tr)}const isFiniteNumber=Number.isFinite||function(_r){return typeof _r=="number"&&isFinite(_r)};let Events=function(_r){return _r.MEDIA_ATTACHING="hlsMediaAttaching",_r.MEDIA_ATTACHED="hlsMediaAttached",_r.MEDIA_DETACHING="hlsMediaDetaching",_r.MEDIA_DETACHED="hlsMediaDetached",_r.BUFFER_RESET="hlsBufferReset",_r.BUFFER_CODECS="hlsBufferCodecs",_r.BUFFER_CREATED="hlsBufferCreated",_r.BUFFER_APPENDING="hlsBufferAppending",_r.BUFFER_APPENDED="hlsBufferAppended",_r.BUFFER_EOS="hlsBufferEos",_r.BUFFER_FLUSHING="hlsBufferFlushing",_r.BUFFER_FLUSHED="hlsBufferFlushed",_r.MANIFEST_LOADING="hlsManifestLoading",_r.MANIFEST_LOADED="hlsManifestLoaded",_r.MANIFEST_PARSED="hlsManifestParsed",_r.LEVEL_SWITCHING="hlsLevelSwitching",_r.LEVEL_SWITCHED="hlsLevelSwitched",_r.LEVEL_LOADING="hlsLevelLoading",_r.LEVEL_LOADED="hlsLevelLoaded",_r.LEVEL_UPDATED="hlsLevelUpdated",_r.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",_r.LEVELS_UPDATED="hlsLevelsUpdated",_r.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",_r.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",_r.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",_r.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",_r.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",_r.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",_r.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",_r.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",_r.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",_r.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",_r.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",_r.CUES_PARSED="hlsCuesParsed",_r.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",_r.INIT_PTS_FOUND="hlsInitPtsFound",_r.FRAG_LOADING="hlsFragLoading",_r.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",_r.FRAG_LOADED="hlsFragLoaded",_r.FRAG_DECRYPTED="hlsFragDecrypted",_r.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",_r.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",_r.FRAG_PARSING_METADATA="hlsFragParsingMetadata",_r.FRAG_PARSED="hlsFragParsed",_r.FRAG_BUFFERED="hlsFragBuffered",_r.FRAG_CHANGED="hlsFragChanged",_r.FPS_DROP="hlsFpsDrop",_r.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",_r.ERROR="hlsError",_r.DESTROYING="hlsDestroying",_r.KEY_LOADING="hlsKeyLoading",_r.KEY_LOADED="hlsKeyLoaded",_r.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",_r.BACK_BUFFER_REACHED="hlsBackBufferReached",_r}({}),ErrorTypes=function(_r){return _r.NETWORK_ERROR="networkError",_r.MEDIA_ERROR="mediaError",_r.KEY_SYSTEM_ERROR="keySystemError",_r.MUX_ERROR="muxError",_r.OTHER_ERROR="otherError",_r}({}),ErrorDetails=function(_r){return _r.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",_r.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",_r.KEY_SYSTEM_NO_SESSION="keySystemNoSession",_r.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",_r.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",_r.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",_r.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",_r.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",_r.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",_r.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",_r.MANIFEST_LOAD_ERROR="manifestLoadError",_r.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",_r.MANIFEST_PARSING_ERROR="manifestParsingError",_r.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",_r.LEVEL_EMPTY_ERROR="levelEmptyError",_r.LEVEL_LOAD_ERROR="levelLoadError",_r.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",_r.LEVEL_PARSING_ERROR="levelParsingError",_r.LEVEL_SWITCH_ERROR="levelSwitchError",_r.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",_r.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",_r.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",_r.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",_r.FRAG_LOAD_ERROR="fragLoadError",_r.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",_r.FRAG_DECRYPT_ERROR="fragDecryptError",_r.FRAG_PARSING_ERROR="fragParsingError",_r.FRAG_GAP="fragGap",_r.REMUX_ALLOC_ERROR="remuxAllocError",_r.KEY_LOAD_ERROR="keyLoadError",_r.KEY_LOAD_TIMEOUT="keyLoadTimeOut",_r.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",_r.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",_r.BUFFER_APPEND_ERROR="bufferAppendError",_r.BUFFER_APPENDING_ERROR="bufferAppendingError",_r.BUFFER_STALLED_ERROR="bufferStalledError",_r.BUFFER_FULL_ERROR="bufferFullError",_r.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",_r.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",_r.INTERNAL_EXCEPTION="internalException",_r.INTERNAL_ABORTED="aborted",_r.UNKNOWN="unknown",_r}({});const noop=function(){},fakeLogger={trace:noop,debug:noop,log:noop,warn:noop,info:noop,error:noop};let exportedLogger=fakeLogger;function consolePrintFn(_r){const Tr=self.console[_r];return Tr?Tr.bind(self.console,`[${_r}] >`):noop}function exportLoggerFunctions(_r,...Tr){Tr.forEach(function(Ar){exportedLogger[Ar]=_r[Ar]?_r[Ar].bind(_r):consolePrintFn(Ar)})}function enableLogs(_r,Tr){if(self.console&&_r===!0||typeof _r=="object"){exportLoggerFunctions(_r,"debug","log","info","warn","error");try{exportedLogger.log(`Debug logs enabled for "${Tr}" in hls.js version 1.4.12`)}catch{exportedLogger=fakeLogger}}else exportedLogger=fakeLogger}const logger=exportedLogger,DECIMAL_RESOLUTION_REGEX=/^(\d+)x(\d+)$/,ATTR_LIST_REGEX=/(.+?)=(".*?"|.*?)(?:,|$)/g;class AttrList{constructor(Tr){typeof Tr=="string"&&(Tr=AttrList.parseAttrList(Tr));for(const Ar in Tr)Tr.hasOwnProperty(Ar)&&(Ar.substring(0,2)==="X-"&&(this.clientAttrs=this.clientAttrs||[],this.clientAttrs.push(Ar)),this[Ar]=Tr[Ar])}decimalInteger(Tr){const Ar=parseInt(this[Tr],10);return Ar>Number.MAX_SAFE_INTEGER?1/0:Ar}hexadecimalInteger(Tr){if(this[Tr]){let Ar=(this[Tr]||"0x").slice(2);Ar=(Ar.length&1?"0":"")+Ar;const Rr=new Uint8Array(Ar.length/2);for(let Pr=0;Pr<Ar.length/2;Pr++)Rr[Pr]=parseInt(Ar.slice(Pr*2,Pr*2+2),16);return Rr}else return null}hexadecimalIntegerAsNumber(Tr){const Ar=parseInt(this[Tr],16);return Ar>Number.MAX_SAFE_INTEGER?1/0:Ar}decimalFloatingPoint(Tr){return parseFloat(this[Tr])}optionalFloat(Tr,Ar){const Rr=this[Tr];return Rr?parseFloat(Rr):Ar}enumeratedString(Tr){return this[Tr]}bool(Tr){return this[Tr]==="YES"}decimalResolution(Tr){const Ar=DECIMAL_RESOLUTION_REGEX.exec(this[Tr]);if(Ar!==null)return{width:parseInt(Ar[1],10),height:parseInt(Ar[2],10)}}static parseAttrList(Tr){let Ar;const Rr={},Pr='"';for(ATTR_LIST_REGEX.lastIndex=0;(Ar=ATTR_LIST_REGEX.exec(Tr))!==null;){let Dr=Ar[2];Dr.indexOf(Pr)===0&&Dr.lastIndexOf(Pr)===Dr.length-1&&(Dr=Dr.slice(1,-1));const Mr=Ar[1].trim();Rr[Mr]=Dr}return Rr}}function isDateRangeCueAttribute(_r){return _r!=="ID"&&_r!=="CLASS"&&_r!=="START-DATE"&&_r!=="DURATION"&&_r!=="END-DATE"&&_r!=="END-ON-NEXT"}function isSCTE35Attribute(_r){return _r==="SCTE35-OUT"||_r==="SCTE35-IN"}class DateRange{constructor(Tr,Ar){if(this.attr=void 0,this._startDate=void 0,this._endDate=void 0,this._badValueForSameId=void 0,Ar){const Rr=Ar.attr;for(const Pr in Rr)if(Object.prototype.hasOwnProperty.call(Tr,Pr)&&Tr[Pr]!==Rr[Pr]){logger.warn(`DATERANGE tag attribute: "${Pr}" does not match for tags with ID: "${Tr.ID}"`),this._badValueForSameId=Pr;break}Tr=_extends(new AttrList({}),Rr,Tr)}if(this.attr=Tr,this._startDate=new Date(Tr["START-DATE"]),"END-DATE"in this.attr){const Rr=new Date(this.attr["END-DATE"]);isFiniteNumber(Rr.getTime())&&(this._endDate=Rr)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get startDate(){return this._startDate}get endDate(){if(this._endDate)return this._endDate;const Tr=this.duration;return Tr!==null?new Date(this._startDate.getTime()+Tr*1e3):null}get duration(){if("DURATION"in this.attr){const Tr=this.attr.decimalFloatingPoint("DURATION");if(isFiniteNumber(Tr))return Tr}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isValid(){return!!this.id&&!this._badValueForSameId&&isFiniteNumber(this.startDate.getTime())&&(this.duration===null||this.duration>=0)&&(!this.endOnNext||!!this.class)}}class LoadStats{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var ElementaryStreamTypes={AUDIO:"audio",VIDEO:"video",AUDIOVIDEO:"audiovideo"};class BaseSegment{constructor(Tr){this._byteRange=null,this._url=null,this.baseurl=void 0,this.relurl=void 0,this.elementaryStreams={[ElementaryStreamTypes.AUDIO]:null,[ElementaryStreamTypes.VIDEO]:null,[ElementaryStreamTypes.AUDIOVIDEO]:null},this.baseurl=Tr}setByteRange(Tr,Ar){const Rr=Tr.split("@",2),Pr=[];Rr.length===1?Pr[0]=Ar?Ar.byteRangeEndOffset:0:Pr[0]=parseInt(Rr[1]),Pr[1]=parseInt(Rr[0])+Pr[0],this._byteRange=Pr}get byteRange(){return this._byteRange?this._byteRange:[]}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=urlToolkitExports.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(Tr){this._url=Tr}}class Fragment extends BaseSegment{constructor(Tr,Ar){super(Ar),this._decryptdata=null,this.rawProgramDateTime=null,this.programDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.stats=new LoadStats,this.urlId=0,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.type=Tr}get decryptdata(){const{levelkeys:Tr}=this;if(!Tr&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkeys&&!this.levelkeys.NONE){const Ar=this.levelkeys.identity;if(Ar)this._decryptdata=Ar.getDecryptData(this.sn);else{const Rr=Object.keys(this.levelkeys);if(Rr.length===1)return this._decryptdata=this.levelkeys[Rr[0]].getDecryptData(this.sn)}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(this.programDateTime===null||!isFiniteNumber(this.programDateTime))return null;const Tr=isFiniteNumber(this.duration)?this.duration:0;return this.programDateTime+Tr*1e3}get encrypted(){var Tr;if((Tr=this._decryptdata)!=null&&Tr.encrypted)return!0;if(this.levelkeys){const Ar=Object.keys(this.levelkeys),Rr=Ar.length;if(Rr>1||Rr===1&&this.levelkeys[Ar[0]].encrypted)return!0}return!1}setKeyFormat(Tr){if(this.levelkeys){const Ar=this.levelkeys[Tr];Ar&&!this._decryptdata&&(this._decryptdata=Ar.getDecryptData(this.sn))}}abortRequests(){var Tr,Ar;(Tr=this.loader)==null||Tr.abort(),(Ar=this.keyLoader)==null||Ar.abort()}setElementaryStreamInfo(Tr,Ar,Rr,Pr,Dr,Mr=!1){const{elementaryStreams:Fr}=this,zr=Fr[Tr];if(!zr){Fr[Tr]={startPTS:Ar,endPTS:Rr,startDTS:Pr,endDTS:Dr,partial:Mr};return}zr.startPTS=Math.min(zr.startPTS,Ar),zr.endPTS=Math.max(zr.endPTS,Rr),zr.startDTS=Math.min(zr.startDTS,Pr),zr.endDTS=Math.max(zr.endDTS,Dr)}clearElementaryStreamInfo(){const{elementaryStreams:Tr}=this;Tr[ElementaryStreamTypes.AUDIO]=null,Tr[ElementaryStreamTypes.VIDEO]=null,Tr[ElementaryStreamTypes.AUDIOVIDEO]=null}}class Part extends BaseSegment{constructor(Tr,Ar,Rr,Pr,Dr){super(Rr),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.stats=new LoadStats,this.duration=Tr.decimalFloatingPoint("DURATION"),this.gap=Tr.bool("GAP"),this.independent=Tr.bool("INDEPENDENT"),this.relurl=Tr.enumeratedString("URI"),this.fragment=Ar,this.index=Pr;const Mr=Tr.enumeratedString("BYTERANGE");Mr&&this.setByteRange(Mr,Dr),Dr&&(this.fragOffset=Dr.fragOffset+Dr.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){const{elementaryStreams:Tr}=this;return!!(Tr.audio||Tr.video||Tr.audiovideo)}}const DEFAULT_TARGET_DURATION=10;class LevelDetails{constructor(Tr){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.live=!0,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.availabilityDelay=void 0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=Tr}reloaded(Tr){if(!Tr){this.advanced=!0,this.updated=!0;return}const Ar=this.lastPartSn-Tr.lastPartSn,Rr=this.lastPartIndex-Tr.lastPartIndex;this.updated=this.endSN!==Tr.endSN||!!Rr||!!Ar||!this.live,this.advanced=this.endSN>Tr.endSN||Ar>0||Ar===0&&Rr>0,this.updated||this.advanced?this.misses=Math.floor(Tr.misses*.6):this.misses=Tr.misses+1,this.availabilityDelay=Tr.availabilityDelay}get hasProgramDateTime(){return this.fragments.length?isFiniteNumber(this.fragments[this.fragments.length-1].programDateTime):!1}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||DEFAULT_TARGET_DURATION}get drift(){const Tr=this.driftEndTime-this.driftStartTime;return Tr>0?(this.driftEnd-this.driftStart)*1e3/Tr:1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var Tr;return(Tr=this.partList)!=null&&Tr.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){var Tr;return(Tr=this.fragments)!=null&&Tr.length?this.fragments[this.fragments.length-1].end:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var Tr;return(Tr=this.partList)!=null&&Tr.length?this.partList[this.partList.length-1].index:-1}get lastPartSn(){var Tr;return(Tr=this.partList)!=null&&Tr.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}}function base64Decode(_r){return Uint8Array.from(atob(_r),Tr=>Tr.charCodeAt(0))}function getKeyIdBytes(_r){const Tr=strToUtf8array(_r).subarray(0,16),Ar=new Uint8Array(16);return Ar.set(Tr,16-Tr.length),Ar}function changeEndianness(_r){const Tr=function(Rr,Pr,Dr){const Mr=Rr[Pr];Rr[Pr]=Rr[Dr],Rr[Dr]=Mr};Tr(_r,0,3),Tr(_r,1,2),Tr(_r,4,5),Tr(_r,6,7)}function convertDataUriToArrayBytes(_r){const Tr=_r.split(":");let Ar=null;if(Tr[0]==="data"&&Tr.length===2){const Rr=Tr[1].split(";"),Pr=Rr[Rr.length-1].split(",");if(Pr.length===2){const Dr=Pr[0]==="base64",Mr=Pr[1];Dr?(Rr.splice(-1,1),Ar=base64Decode(Mr)):Ar=getKeyIdBytes(Mr)}}return Ar}function strToUtf8array(_r){return Uint8Array.from(unescape(encodeURIComponent(_r)),Tr=>Tr.charCodeAt(0))}var KeySystems={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},KeySystemFormats={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.streamingkeydelivery",PLAYREADY:"com.microsoft.playready",WIDEVINE:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"};function keySystemFormatToKeySystemDomain(_r){switch(_r){case KeySystemFormats.FAIRPLAY:return KeySystems.FAIRPLAY;case KeySystemFormats.PLAYREADY:return KeySystems.PLAYREADY;case KeySystemFormats.WIDEVINE:return KeySystems.WIDEVINE;case KeySystemFormats.CLEARKEY:return KeySystems.CLEARKEY}}var KeySystemIds={WIDEVINE:"edef8ba979d64acea3c827dcd51d21ed"};function keySystemIdToKeySystemDomain(_r){if(_r===KeySystemIds.WIDEVINE)return KeySystems.WIDEVINE}function keySystemDomainToKeySystemFormat(_r){switch(_r){case KeySystems.FAIRPLAY:return KeySystemFormats.FAIRPLAY;case KeySystems.PLAYREADY:return KeySystemFormats.PLAYREADY;case KeySystems.WIDEVINE:return KeySystemFormats.WIDEVINE;case KeySystems.CLEARKEY:return KeySystemFormats.CLEARKEY}}function getKeySystemsForConfig(_r){const{drmSystems:Tr,widevineLicenseUrl:Ar}=_r,Rr=Tr?[KeySystems.FAIRPLAY,KeySystems.WIDEVINE,KeySystems.PLAYREADY,KeySystems.CLEARKEY].filter(Pr=>!!Tr[Pr]):[];return!Rr[KeySystems.WIDEVINE]&&Ar&&Rr.push(KeySystems.WIDEVINE),Rr}const requestMediaKeySystemAccess=function(){return typeof self<"u"&&self.navigator&&self.navigator.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null}();function getSupportedMediaKeySystemConfigurations(_r,Tr,Ar,Rr){let Pr;switch(_r){case KeySystems.FAIRPLAY:Pr=["cenc","sinf"];break;case KeySystems.WIDEVINE:case KeySystems.PLAYREADY:Pr=["cenc"];break;case KeySystems.CLEARKEY:Pr=["cenc","keyids"];break;default:throw new Error(`Unknown key-system: ${_r}`)}return createMediaKeySystemConfigurations(Pr,Tr,Ar,Rr)}function createMediaKeySystemConfigurations(_r,Tr,Ar,Rr){return[{initDataTypes:_r,persistentState:Rr.persistentState||"not-allowed",distinctiveIdentifier:Rr.distinctiveIdentifier||"not-allowed",sessionTypes:Rr.sessionTypes||[Rr.sessionType||"temporary"],audioCapabilities:Tr.map(Dr=>({contentType:`audio/mp4; codecs="${Dr}"`,robustness:Rr.audioRobustness||"",encryptionScheme:Rr.audioEncryptionScheme||null})),videoCapabilities:Ar.map(Dr=>({contentType:`video/mp4; codecs="${Dr}"`,robustness:Rr.videoRobustness||"",encryptionScheme:Rr.videoEncryptionScheme||null}))}]}function sliceUint8(_r,Tr,Ar){return Uint8Array.prototype.slice?_r.slice(Tr,Ar):new Uint8Array(Array.prototype.slice.call(_r,Tr,Ar))}const isHeader$2=(_r,Tr)=>Tr+10<=_r.length&&_r[Tr]===73&&_r[Tr+1]===68&&_r[Tr+2]===51&&_r[Tr+3]<255&&_r[Tr+4]<255&&_r[Tr+6]<128&&_r[Tr+7]<128&&_r[Tr+8]<128&&_r[Tr+9]<128,isFooter=(_r,Tr)=>Tr+10<=_r.length&&_r[Tr]===51&&_r[Tr+1]===68&&_r[Tr+2]===73&&_r[Tr+3]<255&&_r[Tr+4]<255&&_r[Tr+6]<128&&_r[Tr+7]<128&&_r[Tr+8]<128&&_r[Tr+9]<128,getID3Data=(_r,Tr)=>{const Ar=Tr;let Rr=0;for(;isHeader$2(_r,Tr);){Rr+=10;const Pr=readSize(_r,Tr+6);Rr+=Pr,isFooter(_r,Tr+10)&&(Rr+=10),Tr+=Rr}if(Rr>0)return _r.subarray(Ar,Ar+Rr)},readSize=(_r,Tr)=>{let Ar=0;return Ar=(_r[Tr]&127)<<21,Ar|=(_r[Tr+1]&127)<<14,Ar|=(_r[Tr+2]&127)<<7,Ar|=_r[Tr+3]&127,Ar},canParse$2=(_r,Tr)=>isHeader$2(_r,Tr)&&readSize(_r,Tr+6)+10<=_r.length-Tr,getTimeStamp=_r=>{const Tr=getID3Frames(_r);for(let Ar=0;Ar<Tr.length;Ar++){const Rr=Tr[Ar];if(isTimeStampFrame(Rr))return readTimeStamp(Rr)}},isTimeStampFrame=_r=>_r&&_r.key==="PRIV"&&_r.info==="com.apple.streaming.transportStreamTimestamp",getFrameData=_r=>{const Tr=String.fromCharCode(_r[0],_r[1],_r[2],_r[3]),Ar=readSize(_r,4),Rr=10;return{type:Tr,size:Ar,data:_r.subarray(Rr,Rr+Ar)}},getID3Frames=_r=>{let Tr=0;const Ar=[];for(;isHeader$2(_r,Tr);){const Rr=readSize(_r,Tr+6);Tr+=10;const Pr=Tr+Rr;for(;Tr+8<Pr;){const Dr=getFrameData(_r.subarray(Tr)),Mr=decodeFrame(Dr);Mr&&Ar.push(Mr),Tr+=Dr.size+10}isFooter(_r,Tr)&&(Tr+=10)}return Ar},decodeFrame=_r=>_r.type==="PRIV"?decodePrivFrame(_r):_r.type[0]==="W"?decodeURLFrame(_r):decodeTextFrame(_r),decodePrivFrame=_r=>{if(_r.size<2)return;const Tr=utf8ArrayToStr(_r.data,!0),Ar=new Uint8Array(_r.data.subarray(Tr.length+1));return{key:_r.type,info:Tr,data:Ar.buffer}},decodeTextFrame=_r=>{if(_r.size<2)return;if(_r.type==="TXXX"){let Ar=1;const Rr=utf8ArrayToStr(_r.data.subarray(Ar),!0);Ar+=Rr.length+1;const Pr=utf8ArrayToStr(_r.data.subarray(Ar));return{key:_r.type,info:Rr,data:Pr}}const Tr=utf8ArrayToStr(_r.data.subarray(1));return{key:_r.type,data:Tr}},decodeURLFrame=_r=>{if(_r.type==="WXXX"){if(_r.size<2)return;let Ar=1;const Rr=utf8ArrayToStr(_r.data.subarray(Ar),!0);Ar+=Rr.length+1;const Pr=utf8ArrayToStr(_r.data.subarray(Ar));return{key:_r.type,info:Rr,data:Pr}}const Tr=utf8ArrayToStr(_r.data);return{key:_r.type,data:Tr}},readTimeStamp=_r=>{if(_r.data.byteLength===8){const Tr=new Uint8Array(_r.data),Ar=Tr[3]&1;let Rr=(Tr[4]<<23)+(Tr[5]<<15)+(Tr[6]<<7)+Tr[7];return Rr/=45,Ar&&(Rr+=4772185884e-2),Math.round(Rr)}},utf8ArrayToStr=(_r,Tr=!1)=>{const Ar=getTextDecoder();if(Ar){const jr=Ar.decode(_r);if(Tr){const Gr=jr.indexOf("\0");return Gr!==-1?jr.substring(0,Gr):jr}return jr.replace(/\0/g,"")}const Rr=_r.length;let Pr,Dr,Mr,Fr="",zr=0;for(;zr<Rr;){if(Pr=_r[zr++],Pr===0&&Tr)return Fr;if(Pr===0||Pr===3)continue;switch(Pr>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:Fr+=String.fromCharCode(Pr);break;case 12:case 13:Dr=_r[zr++],Fr+=String.fromCharCode((Pr&31)<<6|Dr&63);break;case 14:Dr=_r[zr++],Mr=_r[zr++],Fr+=String.fromCharCode((Pr&15)<<12|(Dr&63)<<6|(Mr&63)<<0);break}}return Fr};let decoder;function getTextDecoder(){return!decoder&&typeof self.TextDecoder<"u"&&(decoder=new self.TextDecoder("utf-8")),decoder}const Hex={hexDump:function(_r){let Tr="";for(let Ar=0;Ar<_r.length;Ar++){let Rr=_r[Ar].toString(16);Rr.length<2&&(Rr="0"+Rr),Tr+=Rr}return Tr}},UINT32_MAX$1=Math.pow(2,32)-1,push=[].push,RemuxerTrackIdConfig={video:1,audio:2,id3:3,text:4};function bin2str(_r){return String.fromCharCode.apply(null,_r)}function readUint16(_r,Tr){const Ar=_r[Tr]<<8|_r[Tr+1];return Ar<0?65536+Ar:Ar}function readUint32(_r,Tr){const Ar=readSint32(_r,Tr);return Ar<0?4294967296+Ar:Ar}function readSint32(_r,Tr){return _r[Tr]<<24|_r[Tr+1]<<16|_r[Tr+2]<<8|_r[Tr+3]}function writeUint32(_r,Tr,Ar){_r[Tr]=Ar>>24,_r[Tr+1]=Ar>>16&255,_r[Tr+2]=Ar>>8&255,_r[Tr+3]=Ar&255}function findBox(_r,Tr){const Ar=[];if(!Tr.length)return Ar;const Rr=_r.byteLength;for(let Pr=0;Pr<Rr;){const Dr=readUint32(_r,Pr),Mr=bin2str(_r.subarray(Pr+4,Pr+8)),Fr=Dr>1?Pr+Dr:Rr;if(Mr===Tr[0])if(Tr.length===1)Ar.push(_r.subarray(Pr+8,Fr));else{const zr=findBox(_r.subarray(Pr+8,Fr),Tr.slice(1));zr.length&&push.apply(Ar,zr)}Pr=Fr}return Ar}function parseSegmentIndex(_r){const Tr=[],Ar=_r[0];let Rr=8;const Pr=readUint32(_r,Rr);Rr+=4;const Dr=0,Mr=0;Ar===0?Rr+=8:Rr+=16,Rr+=2;let Fr=_r.length+Mr;const zr=readUint16(_r,Rr);Rr+=2;for(let jr=0;jr<zr;jr++){let Gr=Rr;const Nr=readUint32(_r,Gr);Gr+=4;const Lr=Nr&2147483647;if((Nr&2147483648)>>>31===1)return logger.warn("SIDX has hierarchical references (not supported)"),null;const Vr=readUint32(_r,Gr);Gr+=4,Tr.push({referenceSize:Lr,subsegmentDuration:Vr,info:{duration:Vr/Pr,start:Fr,end:Fr+Lr-1}}),Fr+=Lr,Gr+=4,Rr=Gr}return{earliestPresentationTime:Dr,timescale:Pr,version:Ar,referencesCount:zr,references:Tr}}function parseInitSegment(_r){const Tr=[],Ar=findBox(_r,["moov","trak"]);for(let Pr=0;Pr<Ar.length;Pr++){const Dr=Ar[Pr],Mr=findBox(Dr,["tkhd"])[0];if(Mr){let Fr=Mr[0],zr=Fr===0?12:20;const jr=readUint32(Mr,zr),Gr=findBox(Dr,["mdia","mdhd"])[0];if(Gr){Fr=Gr[0],zr=Fr===0?12:20;const Nr=readUint32(Gr,zr),Lr=findBox(Dr,["mdia","hdlr"])[0];if(Lr){const Ur=bin2str(Lr.subarray(8,12)),Vr={soun:ElementaryStreamTypes.AUDIO,vide:ElementaryStreamTypes.VIDEO}[Ur];if(Vr){const Wr=findBox(Dr,["mdia","minf","stbl","stsd"])[0];let qr;Wr&&(qr=bin2str(Wr.subarray(12,16))),Tr[jr]={timescale:Nr,type:Vr},Tr[Vr]={timescale:Nr,id:jr,codec:qr}}}}}}return findBox(_r,["moov","mvex","trex"]).forEach(Pr=>{const Dr=readUint32(Pr,4),Mr=Tr[Dr];Mr&&(Mr.default={duration:readUint32(Pr,12),flags:readUint32(Pr,20)})}),Tr}function patchEncyptionData(_r,Tr){if(!_r||!Tr)return _r;const Ar=Tr.keyId;return Ar&&Tr.isCommonEncryption&&findBox(_r,["moov","trak"]).forEach(Pr=>{const Mr=findBox(Pr,["mdia","minf","stbl","stsd"])[0].subarray(8);let Fr=findBox(Mr,["enca"]);const zr=Fr.length>0;zr||(Fr=findBox(Mr,["encv"])),Fr.forEach(jr=>{const Gr=zr?jr.subarray(28):jr.subarray(78);findBox(Gr,["sinf"]).forEach(Lr=>{const Ur=parseSinf(Lr);if(Ur){const Vr=Ur.subarray(8,24);Vr.some(Wr=>Wr!==0)||(logger.log(`[eme] Patching keyId in 'enc${zr?"a":"v"}>sinf>>tenc' box: ${Hex.hexDump(Vr)} -> ${Hex.hexDump(Ar)}`),Ur.set(Ar,8))}})})}),_r}function parseSinf(_r){const Tr=findBox(_r,["schm"])[0];if(Tr){const Ar=bin2str(Tr.subarray(4,8));if(Ar==="cbcs"||Ar==="cenc")return findBox(_r,["schi","tenc"])[0]}return logger.error("[eme] missing 'schm' box"),null}function getStartDTS(_r,Tr){return findBox(Tr,["moof","traf"]).reduce((Ar,Rr)=>{const Pr=findBox(Rr,["tfdt"])[0],Dr=Pr[0],Mr=findBox(Rr,["tfhd"]).reduce((Fr,zr)=>{const jr=readUint32(zr,4),Gr=_r[jr];if(Gr){let Nr=readUint32(Pr,4);if(Dr===1){if(Nr===UINT32_MAX$1)return logger.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"),Fr;Nr*=UINT32_MAX$1+1,Nr+=readUint32(Pr,8)}const Lr=Gr.timescale||9e4,Ur=Nr/Lr;if(isFinite(Ur)&&(Fr===null||Ur<Fr))return Ur}return Fr},null);return Mr!==null&&isFinite(Mr)&&(Ar===null||Mr<Ar)?Mr:Ar},null)}function getDuration(_r,Tr){let Ar=0,Rr=0,Pr=0;const Dr=findBox(_r,["moof","traf"]);for(let Mr=0;Mr<Dr.length;Mr++){const Fr=Dr[Mr],zr=findBox(Fr,["tfhd"])[0],jr=readUint32(zr,4),Gr=Tr[jr];if(!Gr)continue;const Nr=Gr.default,Lr=readUint32(zr,0)|(Nr==null?void 0:Nr.flags);let Ur=Nr==null?void 0:Nr.duration;Lr&8&&(Lr&2?Ur=readUint32(zr,12):Ur=readUint32(zr,8));const Vr=Gr.timescale||9e4,Wr=findBox(Fr,["trun"]);for(let qr=0;qr<Wr.length;qr++){if(Ar=computeRawDurationFromSamples(Wr[qr]),!Ar&&Ur){const Kr=readUint32(Wr[qr],4);Ar=Ur*Kr}Gr.type===ElementaryStreamTypes.VIDEO?Rr+=Ar/Vr:Gr.type===ElementaryStreamTypes.AUDIO&&(Pr+=Ar/Vr)}}if(Rr===0&&Pr===0){let Mr=0;const Fr=findBox(_r,["sidx"]);for(let zr=0;zr<Fr.length;zr++){const jr=parseSegmentIndex(Fr[zr]);jr!=null&&jr.references&&(Mr+=jr.references.reduce((Gr,Nr)=>Gr+Nr.info.duration||0,0))}return Mr}return Rr||Pr}function computeRawDurationFromSamples(_r){const Tr=readUint32(_r,0);let Ar=8;Tr&1&&(Ar+=4),Tr&4&&(Ar+=4);let Rr=0;const Pr=readUint32(_r,4);for(let Dr=0;Dr<Pr;Dr++){if(Tr&256){const Mr=readUint32(_r,Ar);Rr+=Mr,Ar+=4}Tr&512&&(Ar+=4),Tr&1024&&(Ar+=4),Tr&2048&&(Ar+=4)}return Rr}function offsetStartDTS(_r,Tr,Ar){findBox(Tr,["moof","traf"]).forEach(Rr=>{findBox(Rr,["tfhd"]).forEach(Pr=>{const Dr=readUint32(Pr,4),Mr=_r[Dr];if(!Mr)return;const Fr=Mr.timescale||9e4;findBox(Rr,["tfdt"]).forEach(zr=>{const jr=zr[0];let Gr=readUint32(zr,4);if(jr===0)Gr-=Ar*Fr,Gr=Math.max(Gr,0),writeUint32(zr,4,Gr);else{Gr*=Math.pow(2,32),Gr+=readUint32(zr,8),Gr-=Ar*Fr,Gr=Math.max(Gr,0);const Nr=Math.floor(Gr/(UINT32_MAX$1+1)),Lr=Math.floor(Gr%(UINT32_MAX$1+1));writeUint32(zr,4,Nr),writeUint32(zr,8,Lr)}})})})}function segmentValidRange(_r){const Tr={valid:null,remainder:null},Ar=findBox(_r,["moof"]);if(Ar){if(Ar.length<2)return Tr.remainder=_r,Tr}else return Tr;const Rr=Ar[Ar.length-1];return Tr.valid=sliceUint8(_r,0,Rr.byteOffset-8),Tr.remainder=sliceUint8(_r,Rr.byteOffset-8),Tr}function appendUint8Array(_r,Tr){const Ar=new Uint8Array(_r.length+Tr.length);return Ar.set(_r),Ar.set(Tr,_r.length),Ar}function parseSamples(_r,Tr){const Ar=[],Rr=Tr.samples,Pr=Tr.timescale,Dr=Tr.id;let Mr=!1;return findBox(Rr,["moof"]).map(zr=>{const jr=zr.byteOffset-8;findBox(zr,["traf"]).map(Nr=>{const Lr=findBox(Nr,["tfdt"]).map(Ur=>{const Vr=Ur[0];let Wr=readUint32(Ur,4);return Vr===1&&(Wr*=Math.pow(2,32),Wr+=readUint32(Ur,8)),Wr/Pr})[0];return Lr!==void 0&&(_r=Lr),findBox(Nr,["tfhd"]).map(Ur=>{const Vr=readUint32(Ur,4),Wr=readUint32(Ur,0)&16777215,qr=(Wr&1)!==0,Kr=(Wr&2)!==0,Xr=(Wr&8)!==0;let Zr=0;const _i=(Wr&16)!==0;let Jr=0;const es=(Wr&32)!==0;let ts=8;Vr===Dr&&(qr&&(ts+=8),Kr&&(ts+=4),Xr&&(Zr=readUint32(Ur,ts),ts+=4),_i&&(Jr=readUint32(Ur,ts),ts+=4),es&&(ts+=4),Tr.type==="video"&&(Mr=isHEVC(Tr.codec)),findBox(Nr,["trun"]).map(is=>{const rs=is[0],as=readUint32(is,0)&16777215,ls=(as&1)!==0;let fs=0;const Ts=(as&4)!==0,$s=(as&256)!==0;let xs=0;const ys=(as&512)!==0;let ps=0;const vs=(as&1024)!==0,Ds=(as&2048)!==0;let js=0;const zs=readUint32(is,4);let qs=8;ls&&(fs=readUint32(is,qs),qs+=4),Ts&&(qs+=4);let fo=fs+jr;for(let Qs=0;Qs<zs;Qs++){if($s?(xs=readUint32(is,qs),qs+=4):xs=Zr,ys?(ps=readUint32(is,qs),qs+=4):ps=Jr,vs&&(qs+=4),Ds&&(rs===0?js=readUint32(is,qs):js=readSint32(is,qs),qs+=4),Tr.type===ElementaryStreamTypes.VIDEO){let no=0;for(;no<ps;){const yo=readUint32(Rr,fo);if(fo+=4,isSEIMessage(Mr,Rr[fo])){const Js=Rr.subarray(fo,fo+yo);parseSEIMessageFromNALu(Js,Mr?2:1,_r+js/Pr,Ar)}fo+=yo,no+=yo+4}}_r+=xs/Pr}}))})})}),Ar}function isHEVC(_r){if(!_r)return!1;const Tr=_r.indexOf("."),Ar=Tr<0?_r:_r.substring(0,Tr);return Ar==="hvc1"||Ar==="hev1"||Ar==="dvh1"||Ar==="dvhe"}function isSEIMessage(_r,Tr){if(_r){const Ar=Tr>>1&63;return Ar===39||Ar===40}else return(Tr&31)===6}function parseSEIMessageFromNALu(_r,Tr,Ar,Rr){const Pr=discardEPB(_r);let Dr=0;Dr+=Tr;let Mr=0,Fr=0,zr=!1,jr=0;for(;Dr<Pr.length;){Mr=0;do{if(Dr>=Pr.length)break;jr=Pr[Dr++],Mr+=jr}while(jr===255);Fr=0;do{if(Dr>=Pr.length)break;jr=Pr[Dr++],Fr+=jr}while(jr===255);const Gr=Pr.length-Dr;if(!zr&&Mr===4&&Dr<Pr.length){if(zr=!0,Pr[Dr++]===181){const Lr=readUint16(Pr,Dr);if(Dr+=2,Lr===49){const Ur=readUint32(Pr,Dr);if(Dr+=4,Ur===1195456820){const Vr=Pr[Dr++];if(Vr===3){const Wr=Pr[Dr++],qr=31&Wr,Kr=64&Wr,Xr=Kr?2+qr*3:0,Zr=new Uint8Array(Xr);if(Kr){Zr[0]=Wr;for(let _i=1;_i<Xr;_i++)Zr[_i]=Pr[Dr++]}Rr.push({type:Vr,payloadType:Mr,pts:Ar,bytes:Zr})}}}}}else if(Mr===5&&Fr<Gr){if(zr=!0,Fr>16){const Nr=[];for(let Vr=0;Vr<16;Vr++){const Wr=Pr[Dr++].toString(16);Nr.push(Wr.length==1?"0"+Wr:Wr),(Vr===3||Vr===5||Vr===7||Vr===9)&&Nr.push("-")}const Lr=Fr-16,Ur=new Uint8Array(Lr);for(let Vr=0;Vr<Lr;Vr++)Ur[Vr]=Pr[Dr++];Rr.push({payloadType:Mr,pts:Ar,uuid:Nr.join(""),userData:utf8ArrayToStr(Ur),userDataBytes:Ur})}}else if(Fr<Gr)Dr+=Fr;else if(Fr>Gr)break}}function discardEPB(_r){const Tr=_r.byteLength,Ar=[];let Rr=1;for(;Rr<Tr-2;)_r[Rr]===0&&_r[Rr+1]===0&&_r[Rr+2]===3?(Ar.push(Rr+2),Rr+=2):Rr++;if(Ar.length===0)return _r;const Pr=Tr-Ar.length,Dr=new Uint8Array(Pr);let Mr=0;for(Rr=0;Rr<Pr;Mr++,Rr++)Mr===Ar[0]&&(Mr++,Ar.shift()),Dr[Rr]=_r[Mr];return Dr}function parseEmsg(_r){const Tr=_r[0];let Ar="",Rr="",Pr=0,Dr=0,Mr=0,Fr=0,zr=0,jr=0;if(Tr===0){for(;bin2str(_r.subarray(jr,jr+1))!=="\0";)Ar+=bin2str(_r.subarray(jr,jr+1)),jr+=1;for(Ar+=bin2str(_r.subarray(jr,jr+1)),jr+=1;bin2str(_r.subarray(jr,jr+1))!=="\0";)Rr+=bin2str(_r.subarray(jr,jr+1)),jr+=1;Rr+=bin2str(_r.subarray(jr,jr+1)),jr+=1,Pr=readUint32(_r,12),Dr=readUint32(_r,16),Fr=readUint32(_r,20),zr=readUint32(_r,24),jr=28}else if(Tr===1){jr+=4,Pr=readUint32(_r,jr),jr+=4;const Nr=readUint32(_r,jr);jr+=4;const Lr=readUint32(_r,jr);for(jr+=4,Mr=2**32*Nr+Lr,Number.isSafeInteger(Mr)||(Mr=Number.MAX_SAFE_INTEGER,logger.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),Fr=readUint32(_r,jr),jr+=4,zr=readUint32(_r,jr),jr+=4;bin2str(_r.subarray(jr,jr+1))!=="\0";)Ar+=bin2str(_r.subarray(jr,jr+1)),jr+=1;for(Ar+=bin2str(_r.subarray(jr,jr+1)),jr+=1;bin2str(_r.subarray(jr,jr+1))!=="\0";)Rr+=bin2str(_r.subarray(jr,jr+1)),jr+=1;Rr+=bin2str(_r.subarray(jr,jr+1)),jr+=1}const Gr=_r.subarray(jr,_r.byteLength);return{schemeIdUri:Ar,value:Rr,timeScale:Pr,presentationTime:Mr,presentationTimeDelta:Dr,eventDuration:Fr,id:zr,payload:Gr}}function mp4Box(_r,...Tr){const Ar=Tr.length;let Rr=8,Pr=Ar;for(;Pr--;)Rr+=Tr[Pr].byteLength;const Dr=new Uint8Array(Rr);for(Dr[0]=Rr>>24&255,Dr[1]=Rr>>16&255,Dr[2]=Rr>>8&255,Dr[3]=Rr&255,Dr.set(_r,4),Pr=0,Rr=8;Pr<Ar;Pr++)Dr.set(Tr[Pr],Rr),Rr+=Tr[Pr].byteLength;return Dr}function mp4pssh(_r,Tr,Ar){if(_r.byteLength!==16)throw new RangeError("Invalid system id");let Rr,Pr;if(Tr){Rr=1,Pr=new Uint8Array(Tr.length*16);for(let Fr=0;Fr<Tr.length;Fr++){const zr=Tr[Fr];if(zr.byteLength!==16)throw new RangeError("Invalid key");Pr.set(zr,Fr*16)}}else Rr=0,Pr=new Uint8Array;let Dr;Rr>0?(Dr=new Uint8Array(4),Tr.length>0&&new DataView(Dr.buffer).setUint32(0,Tr.length,!1)):Dr=new Uint8Array;const Mr=new Uint8Array(4);return Ar&&Ar.byteLength>0&&new DataView(Mr.buffer).setUint32(0,Ar.byteLength,!1),mp4Box([112,115,115,104],new Uint8Array([Rr,0,0,0]),_r,Dr,Pr,Mr,Ar||new Uint8Array)}function parsePssh(_r){if(!(_r instanceof ArrayBuffer)||_r.byteLength<32)return null;const Tr={version:0,systemId:"",kids:null,data:null},Ar=new DataView(_r),Rr=Ar.getUint32(0);if(_r.byteLength!==Rr&&Rr>44||Ar.getUint32(4)!==1886614376||(Tr.version=Ar.getUint32(8)>>>24,Tr.version>1))return null;Tr.systemId=Hex.hexDump(new Uint8Array(_r,12,16));const Dr=Ar.getUint32(28);if(Tr.version===0){if(Rr-32<Dr)return null;Tr.data=new Uint8Array(_r,32,Dr)}else if(Tr.version===1){Tr.kids=[];for(let Mr=0;Mr<Dr;Mr++)Tr.kids.push(new Uint8Array(_r,32+Mr*16,16))}return Tr}let keyUriToKeyIdMap={};class LevelKey{static clearKeyUriToKeyIdMap(){keyUriToKeyIdMap={}}constructor(Tr,Ar,Rr,Pr=[1],Dr=null){this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=Tr,this.uri=Ar,this.keyFormat=Rr,this.keyFormatVersions=Pr,this.iv=Dr,this.encrypted=Tr?Tr!=="NONE":!1,this.isCommonEncryption=this.encrypted&&Tr!=="AES-128"}isSupported(){if(this.method){if(this.method==="AES-128"||this.method==="NONE")return!0;if(this.keyFormat==="identity")return this.method==="SAMPLE-AES";switch(this.keyFormat){case KeySystemFormats.FAIRPLAY:case KeySystemFormats.WIDEVINE:case KeySystemFormats.PLAYREADY:case KeySystemFormats.CLEARKEY:return["ISO-23001-7","SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)!==-1}}return!1}getDecryptData(Tr){if(!this.encrypted||!this.uri)return null;if(this.method==="AES-128"&&this.uri&&!this.iv){typeof Tr!="number"&&(this.method==="AES-128"&&!this.iv&&logger.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),Tr=0);const Rr=createInitializationVector(Tr);return new LevelKey(this.method,this.uri,"identity",this.keyFormatVersions,Rr)}const Ar=convertDataUriToArrayBytes(this.uri);if(Ar)switch(this.keyFormat){case KeySystemFormats.WIDEVINE:this.pssh=Ar,Ar.length>=22&&(this.keyId=Ar.subarray(Ar.length-22,Ar.length-6));break;case KeySystemFormats.PLAYREADY:{const Rr=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=mp4pssh(Rr,null,Ar);const Pr=new Uint16Array(Ar.buffer,Ar.byteOffset,Ar.byteLength/2),Dr=String.fromCharCode.apply(null,Array.from(Pr)),Mr=Dr.substring(Dr.indexOf("<"),Dr.length),jr=new DOMParser().parseFromString(Mr,"text/xml").getElementsByTagName("KID")[0];if(jr){const Gr=jr.childNodes[0]?jr.childNodes[0].nodeValue:jr.getAttribute("VALUE");if(Gr){const Nr=base64Decode(Gr).subarray(0,16);changeEndianness(Nr),this.keyId=Nr}}break}default:{let Rr=Ar.subarray(0,16);if(Rr.length!==16){const Pr=new Uint8Array(16);Pr.set(Rr,16-Rr.length),Rr=Pr}this.keyId=Rr;break}}if(!this.keyId||this.keyId.byteLength!==16){let Rr=keyUriToKeyIdMap[this.uri];if(!Rr){const Pr=Object.keys(keyUriToKeyIdMap).length%Number.MAX_SAFE_INTEGER;Rr=new Uint8Array(16),new DataView(Rr.buffer,12,4).setUint32(0,Pr),keyUriToKeyIdMap[this.uri]=Rr}this.keyId=Rr}return this}}function createInitializationVector(_r){const Tr=new Uint8Array(16);for(let Ar=12;Ar<16;Ar++)Tr[Ar]=_r>>8*(15-Ar)&255;return Tr}const VARIABLE_REPLACEMENT_REGEX=/\{\$([a-zA-Z0-9-_]+)\}/g;function hasVariableReferences(_r){return VARIABLE_REPLACEMENT_REGEX.test(_r)}function substituteVariablesInAttributes(_r,Tr,Ar){if(_r.variableList!==null||_r.hasVariableRefs)for(let Rr=Ar.length;Rr--;){const Pr=Ar[Rr],Dr=Tr[Pr];Dr&&(Tr[Pr]=substituteVariables(_r,Dr))}}function substituteVariables(_r,Tr){if(_r.variableList!==null||_r.hasVariableRefs){const Ar=_r.variableList;return Tr.replace(VARIABLE_REPLACEMENT_REGEX,Rr=>{const Pr=Rr.substring(2,Rr.length-1),Dr=Ar==null?void 0:Ar[Pr];return Dr===void 0?(_r.playlistParsingError||(_r.playlistParsingError=new Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${Pr}"`)),Rr):Dr})}return Tr}function addVariableDefinition(_r,Tr,Ar){let Rr=_r.variableList;Rr||(_r.variableList=Rr={});let Pr,Dr;if("QUERYPARAM"in Tr){Pr=Tr.QUERYPARAM;try{const Mr=new self.URL(Ar).searchParams;if(Mr.has(Pr))Dr=Mr.get(Pr);else throw new Error(`"${Pr}" does not match any query parameter in URI: "${Ar}"`)}catch(Mr){_r.playlistParsingError||(_r.playlistParsingError=new Error(`EXT-X-DEFINE QUERYPARAM: ${Mr.message}`))}}else Pr=Tr.NAME,Dr=Tr.VALUE;Pr in Rr?_r.playlistParsingError||(_r.playlistParsingError=new Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${Pr}"`)):Rr[Pr]=Dr||""}function importVariableDefinition(_r,Tr,Ar){const Rr=Tr.IMPORT;if(Ar&&Rr in Ar){let Pr=_r.variableList;Pr||(_r.variableList=Pr={}),Pr[Rr]=Ar[Rr]}else _r.playlistParsingError||(_r.playlistParsingError=new Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${Rr}"`))}function getMediaSource(){if(!(typeof self>"u"))return self.MediaSource||self.WebKitMediaSource}const sampleEntryCodesISO={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,av01:!0,drac:!0,dva1:!0,dvav:!0,dvh1:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0},text:{stpp:!0,wvtt:!0}},MediaSource$2=getMediaSource();function isCodecType(_r,Tr){const Ar=sampleEntryCodesISO[Tr];return!!Ar&&Ar[_r.slice(0,4)]===!0}function isCodecSupportedInMp4(_r,Tr){var Ar;return(Ar=MediaSource$2==null?void 0:MediaSource$2.isTypeSupported(`${Tr||"video"}/mp4;codecs="${_r}"`))!=null?Ar:!1}const MASTER_PLAYLIST_REGEX=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,MASTER_PLAYLIST_MEDIA_REGEX=/#EXT-X-MEDIA:(.*)/g,IS_MEDIA_PLAYLIST=/^#EXT(?:INF|-X-TARGETDURATION):/m,LEVEL_PLAYLIST_REGEX_FAST=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[\S ]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),LEVEL_PLAYLIST_REGEX_SLOW=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class M3U8Parser{static findGroup(Tr,Ar){for(let Rr=0;Rr<Tr.length;Rr++){const Pr=Tr[Rr];if(Pr.id===Ar)return Pr}}static convertAVC1ToAVCOTI(Tr){const Ar=Tr.split(".");if(Ar.length>2){let Rr=Ar.shift()+".";return Rr+=parseInt(Ar.shift()).toString(16),Rr+=("000"+parseInt(Ar.shift()).toString(16)).slice(-4),Rr}return Tr}static resolve(Tr,Ar){return urlToolkitExports.buildAbsoluteURL(Ar,Tr,{alwaysNormalize:!0})}static isMediaPlaylist(Tr){return IS_MEDIA_PLAYLIST.test(Tr)}static parseMasterPlaylist(Tr,Ar){const Rr=hasVariableReferences(Tr),Pr={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:Rr},Dr=[];MASTER_PLAYLIST_REGEX.lastIndex=0;let Mr;for(;(Mr=MASTER_PLAYLIST_REGEX.exec(Tr))!=null;)if(Mr[1]){var Fr;const jr=new AttrList(Mr[1]);substituteVariablesInAttributes(Pr,jr,["CODECS","SUPPLEMENTAL-CODECS","ALLOWED-CPC","PATHWAY-ID","STABLE-VARIANT-ID","AUDIO","VIDEO","SUBTITLES","CLOSED-CAPTIONS","NAME"]);const Gr=substituteVariables(Pr,Mr[2]),Nr={attrs:jr,bitrate:jr.decimalInteger("AVERAGE-BANDWIDTH")||jr.decimalInteger("BANDWIDTH"),name:jr.NAME,url:M3U8Parser.resolve(Gr,Ar)},Lr=jr.decimalResolution("RESOLUTION");Lr&&(Nr.width=Lr.width,Nr.height=Lr.height),setCodecs((jr.CODECS||"").split(/[ ,]+/).filter(Ur=>Ur),Nr),Nr.videoCodec&&Nr.videoCodec.indexOf("avc1")!==-1&&(Nr.videoCodec=M3U8Parser.convertAVC1ToAVCOTI(Nr.videoCodec)),(Fr=Nr.unknownCodecs)!=null&&Fr.length||Dr.push(Nr),Pr.levels.push(Nr)}else if(Mr[3]){const jr=Mr[3],Gr=Mr[4];switch(jr){case"SESSION-DATA":{const Nr=new AttrList(Gr);substituteVariablesInAttributes(Pr,Nr,["DATA-ID","LANGUAGE","VALUE","URI"]);const Lr=Nr["DATA-ID"];Lr&&(Pr.sessionData===null&&(Pr.sessionData={}),Pr.sessionData[Lr]=Nr);break}case"SESSION-KEY":{const Nr=parseKey(Gr,Ar,Pr);Nr.encrypted&&Nr.isSupported()?(Pr.sessionKeys===null&&(Pr.sessionKeys=[]),Pr.sessionKeys.push(Nr)):logger.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${Gr}"`);break}case"DEFINE":{{const Nr=new AttrList(Gr);substituteVariablesInAttributes(Pr,Nr,["NAME","VALUE","QUERYPARAM"]),addVariableDefinition(Pr,Nr,Ar)}break}case"CONTENT-STEERING":{const Nr=new AttrList(Gr);substituteVariablesInAttributes(Pr,Nr,["SERVER-URI","PATHWAY-ID"]),Pr.contentSteering={uri:M3U8Parser.resolve(Nr["SERVER-URI"],Ar),pathwayId:Nr["PATHWAY-ID"]||"."};break}case"START":{Pr.startTimeOffset=parseStartTimeOffset(Gr);break}}}const zr=Dr.length>0&&Dr.length<Pr.levels.length;return Pr.levels=zr?Dr:Pr.levels,Pr.levels.length===0&&(Pr.playlistParsingError=new Error("no levels found in manifest")),Pr}static parseMasterPlaylistMedia(Tr,Ar,Rr){let Pr;const Dr={},Mr=Rr.levels,Fr={AUDIO:Mr.map(jr=>({id:jr.attrs.AUDIO,audioCodec:jr.audioCodec})),SUBTITLES:Mr.map(jr=>({id:jr.attrs.SUBTITLES,textCodec:jr.textCodec})),"CLOSED-CAPTIONS":[]};let zr=0;for(MASTER_PLAYLIST_MEDIA_REGEX.lastIndex=0;(Pr=MASTER_PLAYLIST_MEDIA_REGEX.exec(Tr))!==null;){const jr=new AttrList(Pr[1]),Gr=jr.TYPE;if(Gr){const Nr=Fr[Gr],Lr=Dr[Gr]||[];Dr[Gr]=Lr,substituteVariablesInAttributes(Rr,jr,["URI","GROUP-ID","LANGUAGE","ASSOC-LANGUAGE","STABLE-RENDITION-ID","NAME","INSTREAM-ID","CHARACTERISTICS","CHANNELS"]);const Ur={attrs:jr,bitrate:0,id:zr++,groupId:jr["GROUP-ID"]||"",instreamId:jr["INSTREAM-ID"],name:jr.NAME||jr.LANGUAGE||"",type:Gr,default:jr.bool("DEFAULT"),autoselect:jr.bool("AUTOSELECT"),forced:jr.bool("FORCED"),lang:jr.LANGUAGE,url:jr.URI?M3U8Parser.resolve(jr.URI,Ar):""};if(Nr!=null&&Nr.length){const Vr=M3U8Parser.findGroup(Nr,Ur.groupId)||Nr[0];assignCodec(Ur,Vr,"audioCodec"),assignCodec(Ur,Vr,"textCodec")}Lr.push(Ur)}}return Dr}static parseLevelPlaylist(Tr,Ar,Rr,Pr,Dr,Mr){const Fr=new LevelDetails(Ar),zr=Fr.fragments;let jr=null,Gr=0,Nr=0,Lr=0,Ur=0,Vr=null,Wr=new Fragment(Pr,Ar),qr,Kr,Xr,Zr=-1,_i=!1;for(LEVEL_PLAYLIST_REGEX_FAST.lastIndex=0,Fr.m3u8=Tr,Fr.hasVariableRefs=hasVariableReferences(Tr);(qr=LEVEL_PLAYLIST_REGEX_FAST.exec(Tr))!==null;){_i&&(_i=!1,Wr=new Fragment(Pr,Ar),Wr.start=Lr,Wr.sn=Gr,Wr.cc=Ur,Wr.level=Rr,jr&&(Wr.initSegment=jr,Wr.rawProgramDateTime=jr.rawProgramDateTime,jr.rawProgramDateTime=null));const is=qr[1];if(is){Wr.duration=parseFloat(is);const rs=(" "+qr[2]).slice(1);Wr.title=rs||null,Wr.tagList.push(rs?["INF",is,rs]:["INF",is])}else if(qr[3]){if(isFiniteNumber(Wr.duration)){Wr.start=Lr,Xr&&setFragLevelKeys(Wr,Xr,Fr),Wr.sn=Gr,Wr.level=Rr,Wr.cc=Ur,Wr.urlId=Dr,zr.push(Wr);const rs=(" "+qr[3]).slice(1);Wr.relurl=substituteVariables(Fr,rs),assignProgramDateTime(Wr,Vr),Vr=Wr,Lr+=Wr.duration,Gr++,Nr=0,_i=!0}}else if(qr[4]){const rs=(" "+qr[4]).slice(1);Vr?Wr.setByteRange(rs,Vr):Wr.setByteRange(rs)}else if(qr[5])Wr.rawProgramDateTime=(" "+qr[5]).slice(1),Wr.tagList.push(["PROGRAM-DATE-TIME",Wr.rawProgramDateTime]),Zr===-1&&(Zr=zr.length);else{if(qr=qr[0].match(LEVEL_PLAYLIST_REGEX_SLOW),!qr){logger.warn("No matches on slow regex match for level playlist!");continue}for(Kr=1;Kr<qr.length&&!(typeof qr[Kr]<"u");Kr++);const rs=(" "+qr[Kr]).slice(1),as=(" "+qr[Kr+1]).slice(1),ls=qr[Kr+2]?(" "+qr[Kr+2]).slice(1):"";switch(rs){case"PLAYLIST-TYPE":Fr.type=as.toUpperCase();break;case"MEDIA-SEQUENCE":Gr=Fr.startSN=parseInt(as);break;case"SKIP":{const fs=new AttrList(as);substituteVariablesInAttributes(Fr,fs,["RECENTLY-REMOVED-DATERANGES"]);const Ts=fs.decimalInteger("SKIPPED-SEGMENTS");if(isFiniteNumber(Ts)){Fr.skippedSegments=Ts;for(let xs=Ts;xs--;)zr.unshift(null);Gr+=Ts}const $s=fs.enumeratedString("RECENTLY-REMOVED-DATERANGES");$s&&(Fr.recentlyRemovedDateranges=$s.split("	"));break}case"TARGETDURATION":Fr.targetduration=Math.max(parseInt(as),1);break;case"VERSION":Fr.version=parseInt(as);break;case"EXTM3U":break;case"ENDLIST":Fr.live=!1;break;case"#":(as||ls)&&Wr.tagList.push(ls?[as,ls]:[as]);break;case"DISCONTINUITY":Ur++,Wr.tagList.push(["DIS"]);break;case"GAP":Wr.gap=!0,Wr.tagList.push([rs]);break;case"BITRATE":Wr.tagList.push([rs,as]);break;case"DATERANGE":{const fs=new AttrList(as);substituteVariablesInAttributes(Fr,fs,["ID","CLASS","START-DATE","END-DATE","SCTE35-CMD","SCTE35-OUT","SCTE35-IN"]),substituteVariablesInAttributes(Fr,fs,fs.clientAttrs);const Ts=new DateRange(fs,Fr.dateRanges[fs.ID]);Ts.isValid||Fr.skippedSegments?Fr.dateRanges[Ts.id]=Ts:logger.warn(`Ignoring invalid DATERANGE tag: "${as}"`),Wr.tagList.push(["EXT-X-DATERANGE",as]);break}case"DEFINE":{{const fs=new AttrList(as);substituteVariablesInAttributes(Fr,fs,["NAME","VALUE","IMPORT","QUERYPARAM"]),"IMPORT"in fs?importVariableDefinition(Fr,fs,Mr):addVariableDefinition(Fr,fs,Ar)}break}case"DISCONTINUITY-SEQUENCE":Ur=parseInt(as);break;case"KEY":{const fs=parseKey(as,Ar,Fr);if(fs.isSupported()){if(fs.method==="NONE"){Xr=void 0;break}Xr||(Xr={}),Xr[fs.keyFormat]&&(Xr=_extends({},Xr)),Xr[fs.keyFormat]=fs}else logger.warn(`[Keys] Ignoring invalid EXT-X-KEY tag: "${as}"`);break}case"START":Fr.startTimeOffset=parseStartTimeOffset(as);break;case"MAP":{const fs=new AttrList(as);if(substituteVariablesInAttributes(Fr,fs,["BYTERANGE","URI"]),Wr.duration){const Ts=new Fragment(Pr,Ar);setInitSegment(Ts,fs,Rr,Xr),jr=Ts,Wr.initSegment=jr,jr.rawProgramDateTime&&!Wr.rawProgramDateTime&&(Wr.rawProgramDateTime=jr.rawProgramDateTime)}else setInitSegment(Wr,fs,Rr,Xr),jr=Wr,_i=!0;break}case"SERVER-CONTROL":{const fs=new AttrList(as);Fr.canBlockReload=fs.bool("CAN-BLOCK-RELOAD"),Fr.canSkipUntil=fs.optionalFloat("CAN-SKIP-UNTIL",0),Fr.canSkipDateRanges=Fr.canSkipUntil>0&&fs.bool("CAN-SKIP-DATERANGES"),Fr.partHoldBack=fs.optionalFloat("PART-HOLD-BACK",0),Fr.holdBack=fs.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{const fs=new AttrList(as);Fr.partTarget=fs.decimalFloatingPoint("PART-TARGET");break}case"PART":{let fs=Fr.partList;fs||(fs=Fr.partList=[]);const Ts=Nr>0?fs[fs.length-1]:void 0,$s=Nr++,xs=new AttrList(as);substituteVariablesInAttributes(Fr,xs,["BYTERANGE","URI"]);const ys=new Part(xs,Wr,Ar,$s,Ts);fs.push(ys),Wr.duration+=ys.duration;break}case"PRELOAD-HINT":{const fs=new AttrList(as);substituteVariablesInAttributes(Fr,fs,["URI"]),Fr.preloadHint=fs;break}case"RENDITION-REPORT":{const fs=new AttrList(as);substituteVariablesInAttributes(Fr,fs,["URI"]),Fr.renditionReports=Fr.renditionReports||[],Fr.renditionReports.push(fs);break}default:logger.warn(`line parsed but not handled: ${qr}`);break}}}Vr&&!Vr.relurl?(zr.pop(),Lr-=Vr.duration,Fr.partList&&(Fr.fragmentHint=Vr)):Fr.partList&&(assignProgramDateTime(Wr,Vr),Wr.cc=Ur,Fr.fragmentHint=Wr,Xr&&setFragLevelKeys(Wr,Xr,Fr));const Jr=zr.length,es=zr[0],ts=zr[Jr-1];if(Lr+=Fr.skippedSegments*Fr.targetduration,Lr>0&&Jr&&ts){Fr.averagetargetduration=Lr/Jr;const is=ts.sn;Fr.endSN=is!=="initSegment"?is:0,Fr.live||(ts.endList=!0),es&&(Fr.startCC=es.cc)}else Fr.endSN=0,Fr.startCC=0;return Fr.fragmentHint&&(Lr+=Fr.fragmentHint.duration),Fr.totalduration=Lr,Fr.endCC=Ur,Zr>0&&backfillProgramDateTimes(zr,Zr),Fr}}function parseKey(_r,Tr,Ar){var Rr,Pr;const Dr=new AttrList(_r);substituteVariablesInAttributes(Ar,Dr,["KEYFORMAT","KEYFORMATVERSIONS","URI","IV","URI"]);const Mr=(Rr=Dr.METHOD)!=null?Rr:"",Fr=Dr.URI,zr=Dr.hexadecimalInteger("IV"),jr=Dr.KEYFORMATVERSIONS,Gr=(Pr=Dr.KEYFORMAT)!=null?Pr:"identity";Fr&&Dr.IV&&!zr&&logger.error(`Invalid IV: ${Dr.IV}`);const Nr=Fr?M3U8Parser.resolve(Fr,Tr):"",Lr=(jr||"1").split("/").map(Number).filter(Number.isFinite);return new LevelKey(Mr,Nr,Gr,Lr,zr)}function parseStartTimeOffset(_r){const Ar=new AttrList(_r).decimalFloatingPoint("TIME-OFFSET");return isFiniteNumber(Ar)?Ar:null}function setCodecs(_r,Tr){["video","audio","text"].forEach(Ar=>{const Rr=_r.filter(Pr=>isCodecType(Pr,Ar));if(Rr.length){const Pr=Rr.filter(Dr=>Dr.lastIndexOf("avc1",0)===0||Dr.lastIndexOf("mp4a",0)===0);Tr[`${Ar}Codec`]=Pr.length>0?Pr[0]:Rr[0],_r=_r.filter(Dr=>Rr.indexOf(Dr)===-1)}}),Tr.unknownCodecs=_r}function assignCodec(_r,Tr,Ar){const Rr=Tr[Ar];Rr&&(_r[Ar]=Rr)}function backfillProgramDateTimes(_r,Tr){let Ar=_r[Tr];for(let Rr=Tr;Rr--;){const Pr=_r[Rr];if(!Pr)return;Pr.programDateTime=Ar.programDateTime-Pr.duration*1e3,Ar=Pr}}function assignProgramDateTime(_r,Tr){_r.rawProgramDateTime?_r.programDateTime=Date.parse(_r.rawProgramDateTime):Tr!=null&&Tr.programDateTime&&(_r.programDateTime=Tr.endProgramDateTime),isFiniteNumber(_r.programDateTime)||(_r.programDateTime=null,_r.rawProgramDateTime=null)}function setInitSegment(_r,Tr,Ar,Rr){_r.relurl=Tr.URI,Tr.BYTERANGE&&_r.setByteRange(Tr.BYTERANGE),_r.level=Ar,_r.sn="initSegment",Rr&&(_r.levelkeys=Rr),_r.initSegment=null}function setFragLevelKeys(_r,Tr,Ar){_r.levelkeys=Tr;const{encryptedFragments:Rr}=Ar;(!Rr.length||Rr[Rr.length-1].levelkeys!==Tr)&&Object.keys(Tr).some(Pr=>Tr[Pr].isCommonEncryption)&&Rr.push(_r)}var PlaylistContextType={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},PlaylistLevelType={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"};function mapContextToLevelType(_r){const{type:Tr}=_r;switch(Tr){case PlaylistContextType.AUDIO_TRACK:return PlaylistLevelType.AUDIO;case PlaylistContextType.SUBTITLE_TRACK:return PlaylistLevelType.SUBTITLE;default:return PlaylistLevelType.MAIN}}function getResponseUrl(_r,Tr){let Ar=_r.url;return(Ar===void 0||Ar.indexOf("data:")===0)&&(Ar=Tr.url),Ar}class PlaylistLoader{constructor(Tr){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.hls=Tr,this.registerListeners()}startLoad(Tr){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){const{hls:Tr}=this;Tr.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),Tr.on(Events.LEVEL_LOADING,this.onLevelLoading,this),Tr.on(Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),Tr.on(Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}unregisterListeners(){const{hls:Tr}=this;Tr.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),Tr.off(Events.LEVEL_LOADING,this.onLevelLoading,this),Tr.off(Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),Tr.off(Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}createInternalLoader(Tr){const Ar=this.hls.config,Rr=Ar.pLoader,Pr=Ar.loader,Dr=Rr||Pr,Mr=new Dr(Ar);return this.loaders[Tr.type]=Mr,Mr}getInternalLoader(Tr){return this.loaders[Tr.type]}resetInternalLoader(Tr){this.loaders[Tr]&&delete this.loaders[Tr]}destroyInternalLoaders(){for(const Tr in this.loaders){const Ar=this.loaders[Tr];Ar&&Ar.destroy(),this.resetInternalLoader(Tr)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(Tr,Ar){const{url:Rr}=Ar;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:PlaylistContextType.MANIFEST,url:Rr,deliveryDirectives:null})}onLevelLoading(Tr,Ar){const{id:Rr,level:Pr,url:Dr,deliveryDirectives:Mr}=Ar;this.load({id:Rr,level:Pr,responseType:"text",type:PlaylistContextType.LEVEL,url:Dr,deliveryDirectives:Mr})}onAudioTrackLoading(Tr,Ar){const{id:Rr,groupId:Pr,url:Dr,deliveryDirectives:Mr}=Ar;this.load({id:Rr,groupId:Pr,level:null,responseType:"text",type:PlaylistContextType.AUDIO_TRACK,url:Dr,deliveryDirectives:Mr})}onSubtitleTrackLoading(Tr,Ar){const{id:Rr,groupId:Pr,url:Dr,deliveryDirectives:Mr}=Ar;this.load({id:Rr,groupId:Pr,level:null,responseType:"text",type:PlaylistContextType.SUBTITLE_TRACK,url:Dr,deliveryDirectives:Mr})}load(Tr){var Ar;const Rr=this.hls.config;let Pr=this.getInternalLoader(Tr);if(Pr){const jr=Pr.context;if(jr&&jr.url===Tr.url){logger.trace("[playlist-loader]: playlist request ongoing");return}logger.log(`[playlist-loader]: aborting previous loader for type: ${Tr.type}`),Pr.abort()}let Dr;if(Tr.type===PlaylistContextType.MANIFEST?Dr=Rr.manifestLoadPolicy.default:Dr=_extends({},Rr.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),Pr=this.createInternalLoader(Tr),(Ar=Tr.deliveryDirectives)!=null&&Ar.part){let jr;if(Tr.type===PlaylistContextType.LEVEL&&Tr.level!==null?jr=this.hls.levels[Tr.level].details:Tr.type===PlaylistContextType.AUDIO_TRACK&&Tr.id!==null?jr=this.hls.audioTracks[Tr.id].details:Tr.type===PlaylistContextType.SUBTITLE_TRACK&&Tr.id!==null&&(jr=this.hls.subtitleTracks[Tr.id].details),jr){const Gr=jr.partTarget,Nr=jr.targetduration;if(Gr&&Nr){const Lr=Math.max(Gr*3,Nr*.8)*1e3;Dr=_extends({},Dr,{maxTimeToFirstByteMs:Math.min(Lr,Dr.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(Lr,Dr.maxTimeToFirstByteMs)})}}}const Mr=Dr.errorRetry||Dr.timeoutRetry||{},Fr={loadPolicy:Dr,timeout:Dr.maxLoadTimeMs,maxRetry:Mr.maxNumRetry||0,retryDelay:Mr.retryDelayMs||0,maxRetryDelay:Mr.maxRetryDelayMs||0},zr={onSuccess:(jr,Gr,Nr,Lr)=>{const Ur=this.getInternalLoader(Nr);this.resetInternalLoader(Nr.type);const Vr=jr.data;if(Vr.indexOf("#EXTM3U")!==0){this.handleManifestParsingError(jr,Nr,new Error("no EXTM3U delimiter"),Lr||null,Gr);return}Gr.parsing.start=performance.now(),M3U8Parser.isMediaPlaylist(Vr)?this.handleTrackOrLevelPlaylist(jr,Gr,Nr,Lr||null,Ur):this.handleMasterPlaylist(jr,Gr,Nr,Lr)},onError:(jr,Gr,Nr,Lr)=>{this.handleNetworkError(Gr,Nr,!1,jr,Lr)},onTimeout:(jr,Gr,Nr)=>{this.handleNetworkError(Gr,Nr,!0,void 0,jr)}};Pr.load(Tr,Fr,zr)}handleMasterPlaylist(Tr,Ar,Rr,Pr){const Dr=this.hls,Mr=Tr.data,Fr=getResponseUrl(Tr,Rr),zr=M3U8Parser.parseMasterPlaylist(Mr,Fr);if(zr.playlistParsingError){this.handleManifestParsingError(Tr,Rr,zr.playlistParsingError,Pr,Ar);return}const{contentSteering:jr,levels:Gr,sessionData:Nr,sessionKeys:Lr,startTimeOffset:Ur,variableList:Vr}=zr;this.variableList=Vr;const{AUDIO:Wr=[],SUBTITLES:qr,"CLOSED-CAPTIONS":Kr}=M3U8Parser.parseMasterPlaylistMedia(Mr,Fr,zr);Wr.length&&!Wr.some(Zr=>!Zr.url)&&Gr[0].audioCodec&&!Gr[0].attrs.AUDIO&&(logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),Wr.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new AttrList({}),bitrate:0,url:""})),Dr.trigger(Events.MANIFEST_LOADED,{levels:Gr,audioTracks:Wr,subtitles:qr,captions:Kr,contentSteering:jr,url:Fr,stats:Ar,networkDetails:Pr,sessionData:Nr,sessionKeys:Lr,startTimeOffset:Ur,variableList:Vr})}handleTrackOrLevelPlaylist(Tr,Ar,Rr,Pr,Dr){const Mr=this.hls,{id:Fr,level:zr,type:jr}=Rr,Gr=getResponseUrl(Tr,Rr),Nr=isFiniteNumber(Fr)?Fr:0,Lr=isFiniteNumber(zr)?zr:Nr,Ur=mapContextToLevelType(Rr),Vr=M3U8Parser.parseLevelPlaylist(Tr.data,Gr,Lr,Ur,Nr,this.variableList);if(jr===PlaylistContextType.MANIFEST){const Wr={attrs:new AttrList({}),bitrate:0,details:Vr,name:"",url:Gr};Mr.trigger(Events.MANIFEST_LOADED,{levels:[Wr],audioTracks:[],url:Gr,stats:Ar,networkDetails:Pr,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}Ar.parsing.end=performance.now(),Rr.levelDetails=Vr,this.handlePlaylistLoaded(Vr,Tr,Ar,Rr,Pr,Dr)}handleManifestParsingError(Tr,Ar,Rr,Pr,Dr){this.hls.trigger(Events.ERROR,{type:ErrorTypes.NETWORK_ERROR,details:ErrorDetails.MANIFEST_PARSING_ERROR,fatal:Ar.type===PlaylistContextType.MANIFEST,url:Tr.url,err:Rr,error:Rr,reason:Rr.message,response:Tr,context:Ar,networkDetails:Pr,stats:Dr})}handleNetworkError(Tr,Ar,Rr=!1,Pr,Dr){let Mr=`A network ${Rr?"timeout":"error"+(Pr?" (status "+Pr.code+")":"")} occurred while loading ${Tr.type}`;Tr.type===PlaylistContextType.LEVEL?Mr+=`: ${Tr.level} id: ${Tr.id}`:(Tr.type===PlaylistContextType.AUDIO_TRACK||Tr.type===PlaylistContextType.SUBTITLE_TRACK)&&(Mr+=` id: ${Tr.id} group-id: "${Tr.groupId}"`);const Fr=new Error(Mr);logger.warn(`[playlist-loader]: ${Mr}`);let zr=ErrorDetails.UNKNOWN,jr=!1;const Gr=this.getInternalLoader(Tr);switch(Tr.type){case PlaylistContextType.MANIFEST:zr=Rr?ErrorDetails.MANIFEST_LOAD_TIMEOUT:ErrorDetails.MANIFEST_LOAD_ERROR,jr=!0;break;case PlaylistContextType.LEVEL:zr=Rr?ErrorDetails.LEVEL_LOAD_TIMEOUT:ErrorDetails.LEVEL_LOAD_ERROR,jr=!1;break;case PlaylistContextType.AUDIO_TRACK:zr=Rr?ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:ErrorDetails.AUDIO_TRACK_LOAD_ERROR,jr=!1;break;case PlaylistContextType.SUBTITLE_TRACK:zr=Rr?ErrorDetails.SUBTITLE_TRACK_LOAD_TIMEOUT:ErrorDetails.SUBTITLE_LOAD_ERROR,jr=!1;break}Gr&&this.resetInternalLoader(Tr.type);const Nr={type:ErrorTypes.NETWORK_ERROR,details:zr,fatal:jr,url:Tr.url,loader:Gr,context:Tr,error:Fr,networkDetails:Ar,stats:Dr};if(Pr){const Lr=(Ar==null?void 0:Ar.url)||Tr.url;Nr.response=_objectSpread2({url:Lr,data:void 0},Pr)}this.hls.trigger(Events.ERROR,Nr)}handlePlaylistLoaded(Tr,Ar,Rr,Pr,Dr,Mr){const Fr=this.hls,{type:zr,level:jr,id:Gr,groupId:Nr,deliveryDirectives:Lr}=Pr,Ur=getResponseUrl(Ar,Pr),Vr=mapContextToLevelType(Pr),Wr=typeof Pr.level=="number"&&Vr===PlaylistLevelType.MAIN?jr:void 0;if(!Tr.fragments.length){const Kr=new Error("No Segments found in Playlist");Fr.trigger(Events.ERROR,{type:ErrorTypes.NETWORK_ERROR,details:ErrorDetails.LEVEL_EMPTY_ERROR,fatal:!1,url:Ur,error:Kr,reason:Kr.message,response:Ar,context:Pr,level:Wr,parent:Vr,networkDetails:Dr,stats:Rr});return}Tr.targetduration||(Tr.playlistParsingError=new Error("Missing Target Duration"));const qr=Tr.playlistParsingError;if(qr){Fr.trigger(Events.ERROR,{type:ErrorTypes.NETWORK_ERROR,details:ErrorDetails.LEVEL_PARSING_ERROR,fatal:!1,url:Ur,error:qr,reason:qr.message,response:Ar,context:Pr,level:Wr,parent:Vr,networkDetails:Dr,stats:Rr});return}switch(Tr.live&&Mr&&(Mr.getCacheAge&&(Tr.ageHeader=Mr.getCacheAge()||0),(!Mr.getCacheAge||isNaN(Tr.ageHeader))&&(Tr.ageHeader=0)),zr){case PlaylistContextType.MANIFEST:case PlaylistContextType.LEVEL:Fr.trigger(Events.LEVEL_LOADED,{details:Tr,level:Wr||0,id:Gr||0,stats:Rr,networkDetails:Dr,deliveryDirectives:Lr});break;case PlaylistContextType.AUDIO_TRACK:Fr.trigger(Events.AUDIO_TRACK_LOADED,{details:Tr,id:Gr||0,groupId:Nr||"",stats:Rr,networkDetails:Dr,deliveryDirectives:Lr});break;case PlaylistContextType.SUBTITLE_TRACK:Fr.trigger(Events.SUBTITLE_TRACK_LOADED,{details:Tr,id:Gr||0,groupId:Nr||"",stats:Rr,networkDetails:Dr,deliveryDirectives:Lr});break}}}function sendAddTrackEvent(_r,Tr){let Ar;try{Ar=new Event("addtrack")}catch{Ar=document.createEvent("Event"),Ar.initEvent("addtrack",!1,!1)}Ar.track=_r,Tr.dispatchEvent(Ar)}function addCueToTrack(_r,Tr){const Ar=_r.mode;if(Ar==="disabled"&&(_r.mode="hidden"),_r.cues&&!_r.cues.getCueById(Tr.id))try{if(_r.addCue(Tr),!_r.cues.getCueById(Tr.id))throw new Error(`addCue is failed for: ${Tr}`)}catch(Rr){logger.debug(`[texttrack-utils]: ${Rr}`);try{const Pr=new self.TextTrackCue(Tr.startTime,Tr.endTime,Tr.text);Pr.id=Tr.id,_r.addCue(Pr)}catch(Pr){logger.debug(`[texttrack-utils]: Legacy TextTrackCue fallback failed: ${Pr}`)}}Ar==="disabled"&&(_r.mode=Ar)}function clearCurrentCues(_r){const Tr=_r.mode;if(Tr==="disabled"&&(_r.mode="hidden"),_r.cues)for(let Ar=_r.cues.length;Ar--;)_r.removeCue(_r.cues[Ar]);Tr==="disabled"&&(_r.mode=Tr)}function removeCuesInRange(_r,Tr,Ar,Rr){const Pr=_r.mode;if(Pr==="disabled"&&(_r.mode="hidden"),_r.cues&&_r.cues.length>0){const Dr=getCuesInRange(_r.cues,Tr,Ar);for(let Mr=0;Mr<Dr.length;Mr++)(!Rr||Rr(Dr[Mr]))&&_r.removeCue(Dr[Mr])}Pr==="disabled"&&(_r.mode=Pr)}function getFirstCueIndexAfterTime(_r,Tr){if(Tr<_r[0].startTime)return 0;const Ar=_r.length-1;if(Tr>_r[Ar].endTime)return-1;let Rr=0,Pr=Ar;for(;Rr<=Pr;){const Dr=Math.floor((Pr+Rr)/2);if(Tr<_r[Dr].startTime)Pr=Dr-1;else if(Tr>_r[Dr].startTime&&Rr<Ar)Rr=Dr+1;else return Dr}return _r[Rr].startTime-Tr<Tr-_r[Pr].startTime?Rr:Pr}function getCuesInRange(_r,Tr,Ar){const Rr=[],Pr=getFirstCueIndexAfterTime(_r,Tr);if(Pr>-1)for(let Dr=Pr,Mr=_r.length;Dr<Mr;Dr++){const Fr=_r[Dr];if(Fr.startTime>=Tr&&Fr.endTime<=Ar)Rr.push(Fr);else if(Fr.startTime>Ar)return Rr}return Rr}var MetadataSchema={audioId3:"org.id3",dateRange:"com.apple.quicktime.HLS",emsg:"https://aomedia.org/emsg/ID3"};const MIN_CUE_DURATION=.25;function getCueClass(){if(!(typeof self>"u"))return self.WebKitDataCue||self.VTTCue||self.TextTrackCue}const MAX_CUE_ENDTIME=(()=>{const _r=getCueClass();try{new _r(0,Number.POSITIVE_INFINITY,"")}catch{return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();function dateRangeDateToTimelineSeconds(_r,Tr){return _r.getTime()/1e3-Tr}function hexToArrayBuffer(_r){return Uint8Array.from(_r.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}class ID3TrackController{constructor(Tr){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=Tr,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=null}_registerListeners(){const{hls:Tr}=this;Tr.on(Events.MEDIA_ATTACHED,this.onMediaAttached,this),Tr.on(Events.MEDIA_DETACHING,this.onMediaDetaching,this),Tr.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),Tr.on(Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),Tr.on(Events.BUFFER_FLUSHING,this.onBufferFlushing,this),Tr.on(Events.LEVEL_UPDATED,this.onLevelUpdated,this)}_unregisterListeners(){const{hls:Tr}=this;Tr.off(Events.MEDIA_ATTACHED,this.onMediaAttached,this),Tr.off(Events.MEDIA_DETACHING,this.onMediaDetaching,this),Tr.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),Tr.off(Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),Tr.off(Events.BUFFER_FLUSHING,this.onBufferFlushing,this),Tr.off(Events.LEVEL_UPDATED,this.onLevelUpdated,this)}onMediaAttached(Tr,Ar){this.media=Ar.media}onMediaDetaching(){this.id3Track&&(clearCurrentCues(this.id3Track),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(Tr){const Ar=this.getID3Track(Tr.textTracks);return Ar.mode="hidden",Ar}getID3Track(Tr){if(this.media){for(let Ar=0;Ar<Tr.length;Ar++){const Rr=Tr[Ar];if(Rr.kind==="metadata"&&Rr.label==="id3")return sendAddTrackEvent(Rr,this.media),Rr}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(Tr,Ar){if(!this.media)return;const{hls:{config:{enableEmsgMetadataCues:Rr,enableID3MetadataCues:Pr}}}=this;if(!Rr&&!Pr)return;const{samples:Dr}=Ar;this.id3Track||(this.id3Track=this.createTrack(this.media));const Mr=getCueClass();for(let Fr=0;Fr<Dr.length;Fr++){const zr=Dr[Fr].type;if(zr===MetadataSchema.emsg&&!Rr||!Pr)continue;const jr=getID3Frames(Dr[Fr].data);if(jr){const Gr=Dr[Fr].pts;let Nr=Gr+Dr[Fr].duration;Nr>MAX_CUE_ENDTIME&&(Nr=MAX_CUE_ENDTIME),Nr-Gr<=0&&(Nr=Gr+MIN_CUE_DURATION);for(let Ur=0;Ur<jr.length;Ur++){const Vr=jr[Ur];if(!isTimeStampFrame(Vr)){this.updateId3CueEnds(Gr,zr);const Wr=new Mr(Gr,Nr,"");Wr.value=Vr,zr&&(Wr.type=zr),this.id3Track.addCue(Wr)}}}}}updateId3CueEnds(Tr,Ar){var Rr;const Pr=(Rr=this.id3Track)==null?void 0:Rr.cues;if(Pr)for(let Dr=Pr.length;Dr--;){const Mr=Pr[Dr];Mr.type===Ar&&Mr.startTime<Tr&&Mr.endTime===MAX_CUE_ENDTIME&&(Mr.endTime=Tr)}}onBufferFlushing(Tr,{startOffset:Ar,endOffset:Rr,type:Pr}){const{id3Track:Dr,hls:Mr}=this;if(!Mr)return;const{config:{enableEmsgMetadataCues:Fr,enableID3MetadataCues:zr}}=Mr;if(Dr&&(Fr||zr)){let jr;Pr==="audio"?jr=Gr=>Gr.type===MetadataSchema.audioId3&&zr:Pr==="video"?jr=Gr=>Gr.type===MetadataSchema.emsg&&Fr:jr=Gr=>Gr.type===MetadataSchema.audioId3&&zr||Gr.type===MetadataSchema.emsg&&Fr,removeCuesInRange(Dr,Ar,Rr,jr)}}onLevelUpdated(Tr,{details:Ar}){if(!this.media||!Ar.hasProgramDateTime||!this.hls.config.enableDateRangeMetadataCues)return;const{dateRangeCuesAppended:Rr,id3Track:Pr}=this,{dateRanges:Dr}=Ar,Mr=Object.keys(Dr);if(Pr){const Gr=Object.keys(Rr).filter(Nr=>!Mr.includes(Nr));for(let Nr=Gr.length;Nr--;){const Lr=Gr[Nr];Object.keys(Rr[Lr].cues).forEach(Ur=>{Pr.removeCue(Rr[Lr].cues[Ur])}),delete Rr[Lr]}}const Fr=Ar.fragments[Ar.fragments.length-1];if(Mr.length===0||!isFiniteNumber(Fr==null?void 0:Fr.programDateTime))return;this.id3Track||(this.id3Track=this.createTrack(this.media));const zr=Fr.programDateTime/1e3-Fr.start,jr=getCueClass();for(let Gr=0;Gr<Mr.length;Gr++){const Nr=Mr[Gr],Lr=Dr[Nr],Ur=Rr[Nr],Vr=(Ur==null?void 0:Ur.cues)||{};let Wr=(Ur==null?void 0:Ur.durationKnown)||!1;const qr=dateRangeDateToTimelineSeconds(Lr.startDate,zr);let Kr=MAX_CUE_ENDTIME;const Xr=Lr.endDate;if(Xr)Kr=dateRangeDateToTimelineSeconds(Xr,zr),Wr=!0;else if(Lr.endOnNext&&!Wr){const _i=Mr.reduce((Jr,es)=>{const ts=Dr[es];return ts.class===Lr.class&&ts.id!==es&&ts.startDate>Lr.startDate&&Jr.push(ts),Jr},[]).sort((Jr,es)=>Jr.startDate.getTime()-es.startDate.getTime())[0];_i&&(Kr=dateRangeDateToTimelineSeconds(_i.startDate,zr),Wr=!0)}const Zr=Object.keys(Lr.attr);for(let _i=0;_i<Zr.length;_i++){const Jr=Zr[_i];if(!isDateRangeCueAttribute(Jr))continue;let es=Vr[Jr];if(es)Wr&&!Ur.durationKnown&&(es.endTime=Kr);else{let ts=Lr.attr[Jr];es=new jr(qr,Kr,""),isSCTE35Attribute(Jr)&&(ts=hexToArrayBuffer(ts)),es.value={key:Jr,data:ts},es.type=MetadataSchema.dateRange,es.id=Nr,this.id3Track.addCue(es),Vr[Jr]=es}}Rr[Nr]={cues:Vr,dateRange:Lr,durationKnown:Wr}}}}class LatencyController{constructor(Tr){this.hls=void 0,this.config=void 0,this.media=null,this.levelDetails=null,this.currentTime=0,this.stallCount=0,this._latency=null,this.timeupdateHandler=()=>this.timeupdate(),this.hls=Tr,this.config=Tr.config,this.registerListeners()}get latency(){return this._latency||0}get maxLatency(){const{config:Tr,levelDetails:Ar}=this;return Tr.liveMaxLatencyDuration!==void 0?Tr.liveMaxLatencyDuration:Ar?Tr.liveMaxLatencyDurationCount*Ar.targetduration:0}get targetLatency(){const{levelDetails:Tr}=this;if(Tr===null)return null;const{holdBack:Ar,partHoldBack:Rr,targetduration:Pr}=Tr,{liveSyncDuration:Dr,liveSyncDurationCount:Mr,lowLatencyMode:Fr}=this.config,zr=this.hls.userConfig;let jr=Fr&&Rr||Ar;(zr.liveSyncDuration||zr.liveSyncDurationCount||jr===0)&&(jr=Dr!==void 0?Dr:Mr*Pr);const Gr=Pr,Nr=1;return jr+Math.min(this.stallCount*Nr,Gr)}get liveSyncPosition(){const Tr=this.estimateLiveEdge(),Ar=this.targetLatency,Rr=this.levelDetails;if(Tr===null||Ar===null||Rr===null)return null;const Pr=Rr.edge,Dr=Tr-Ar-this.edgeStalled,Mr=Pr-Rr.totalduration,Fr=Pr-(this.config.lowLatencyMode&&Rr.partTarget||Rr.targetduration);return Math.min(Math.max(Mr,Dr),Fr)}get drift(){const{levelDetails:Tr}=this;return Tr===null?1:Tr.drift}get edgeStalled(){const{levelDetails:Tr}=this;if(Tr===null)return 0;const Ar=(this.config.lowLatencyMode&&Tr.partTarget||Tr.targetduration)*3;return Math.max(Tr.age-Ar,0)}get forwardBufferLength(){const{media:Tr,levelDetails:Ar}=this;if(!Tr||!Ar)return 0;const Rr=Tr.buffered.length;return(Rr?Tr.buffered.end(Rr-1):Ar.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null}registerListeners(){this.hls.on(Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(Events.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(Events.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on(Events.ERROR,this.onError,this)}unregisterListeners(){this.hls.off(Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(Events.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(Events.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.off(Events.ERROR,this.onError,this)}onMediaAttached(Tr,Ar){this.media=Ar.media,this.media.addEventListener("timeupdate",this.timeupdateHandler)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)}onManifestLoading(){this.levelDetails=null,this._latency=null,this.stallCount=0}onLevelUpdated(Tr,{details:Ar}){this.levelDetails=Ar,Ar.advanced&&this.timeupdate(),!Ar.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)}onError(Tr,Ar){var Rr;Ar.details===ErrorDetails.BUFFER_STALLED_ERROR&&(this.stallCount++,(Rr=this.levelDetails)!=null&&Rr.live&&logger.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))}timeupdate(){const{media:Tr,levelDetails:Ar}=this;if(!Tr||!Ar)return;this.currentTime=Tr.currentTime;const Rr=this.computeLatency();if(Rr===null)return;this._latency=Rr;const{lowLatencyMode:Pr,maxLiveSyncPlaybackRate:Dr}=this.config;if(!Pr||Dr===1)return;const Mr=this.targetLatency;if(Mr===null)return;const Fr=Rr-Mr,zr=Math.min(this.maxLatency,Mr+Ar.targetduration),jr=Fr<zr;if(Ar.live&&jr&&Fr>.05&&this.forwardBufferLength>1){const Gr=Math.min(2,Math.max(1,Dr)),Nr=Math.round(2/(1+Math.exp(-.75*Fr-this.edgeStalled))*20)/20;Tr.playbackRate=Math.min(Gr,Math.max(1,Nr))}else Tr.playbackRate!==1&&Tr.playbackRate!==0&&(Tr.playbackRate=1)}estimateLiveEdge(){const{levelDetails:Tr}=this;return Tr===null?null:Tr.edge+Tr.age}computeLatency(){const Tr=this.estimateLiveEdge();return Tr===null?null:Tr-this.currentTime}}const HdcpLevels=["NONE","TYPE-0","TYPE-1",null];var HlsSkip={No:"",Yes:"YES",v2:"v2"};function getSkipValue(_r,Tr){const{canSkipUntil:Ar,canSkipDateRanges:Rr,endSN:Pr}=_r,Dr=Tr!==void 0?Tr-Pr:0;return Ar&&Dr<Ar?Rr?HlsSkip.v2:HlsSkip.Yes:HlsSkip.No}class HlsUrlParameters{constructor(Tr,Ar,Rr){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=Tr,this.part=Ar,this.skip=Rr}addDirectives(Tr){const Ar=new self.URL(Tr);return this.msn!==void 0&&Ar.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&Ar.searchParams.set("_HLS_part",this.part.toString()),this.skip&&Ar.searchParams.set("_HLS_skip",this.skip),Ar.href}}class Level{constructor(Tr){this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.videoCodec=void 0,this.width=void 0,this.unknownCodecs=void 0,this.audioGroupIds=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.textGroupIds=void 0,this.url=void 0,this._urlId=0,this.url=[Tr.url],this._attrs=[Tr.attrs],this.bitrate=Tr.bitrate,Tr.details&&(this.details=Tr.details),this.id=Tr.id||0,this.name=Tr.name,this.width=Tr.width||0,this.height=Tr.height||0,this.audioCodec=Tr.audioCodec,this.videoCodec=Tr.videoCodec,this.unknownCodecs=Tr.unknownCodecs,this.codecSet=[Tr.videoCodec,Tr.audioCodec].filter(Ar=>Ar).join(",").replace(/\.[^.,]+/g,"")}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get attrs(){return this._attrs[this._urlId]}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get uri(){return this.url[this._urlId]||""}get urlId(){return this._urlId}set urlId(Tr){const Ar=Tr%this.url.length;this._urlId!==Ar&&(this.fragmentError=0,this.loadError=0,this.details=void 0,this._urlId=Ar)}get audioGroupId(){var Tr;return(Tr=this.audioGroupIds)==null?void 0:Tr[this.urlId]}get textGroupId(){var Tr;return(Tr=this.textGroupIds)==null?void 0:Tr[this.urlId]}addFallback(Tr){this.url.push(Tr.url),this._attrs.push(Tr.attrs)}}function updateFromToPTS(_r,Tr){const Ar=Tr.startPTS;if(isFiniteNumber(Ar)){let Rr=0,Pr;Tr.sn>_r.sn?(Rr=Ar-_r.start,Pr=_r):(Rr=_r.start-Ar,Pr=Tr),Pr.duration!==Rr&&(Pr.duration=Rr)}else Tr.sn>_r.sn?_r.cc===Tr.cc&&_r.minEndPTS?Tr.start=_r.start+(_r.minEndPTS-_r.start):Tr.start=_r.start+_r.duration:Tr.start=Math.max(_r.start-Tr.duration,0)}function updateFragPTSDTS(_r,Tr,Ar,Rr,Pr,Dr){Rr-Ar<=0&&(logger.warn("Fragment should have a positive duration",Tr),Rr=Ar+Tr.duration,Dr=Pr+Tr.duration);let Fr=Ar,zr=Rr;const jr=Tr.startPTS,Gr=Tr.endPTS;if(isFiniteNumber(jr)){const qr=Math.abs(jr-Ar);isFiniteNumber(Tr.deltaPTS)?Tr.deltaPTS=Math.max(qr,Tr.deltaPTS):Tr.deltaPTS=qr,Fr=Math.max(Ar,jr),Ar=Math.min(Ar,jr),Pr=Math.min(Pr,Tr.startDTS),zr=Math.min(Rr,Gr),Rr=Math.max(Rr,Gr),Dr=Math.max(Dr,Tr.endDTS)}const Nr=Ar-Tr.start;Tr.start!==0&&(Tr.start=Ar),Tr.duration=Rr-Tr.start,Tr.startPTS=Ar,Tr.maxStartPTS=Fr,Tr.startDTS=Pr,Tr.endPTS=Rr,Tr.minEndPTS=zr,Tr.endDTS=Dr;const Lr=Tr.sn;if(!_r||Lr<_r.startSN||Lr>_r.endSN)return 0;let Ur;const Vr=Lr-_r.startSN,Wr=_r.fragments;for(Wr[Vr]=Tr,Ur=Vr;Ur>0;Ur--)updateFromToPTS(Wr[Ur],Wr[Ur-1]);for(Ur=Vr;Ur<Wr.length-1;Ur++)updateFromToPTS(Wr[Ur],Wr[Ur+1]);return _r.fragmentHint&&updateFromToPTS(Wr[Wr.length-1],_r.fragmentHint),_r.PTSKnown=_r.alignedSliding=!0,Nr}function mergeDetails(_r,Tr){let Ar=null;const Rr=_r.fragments;for(let zr=Rr.length-1;zr>=0;zr--){const jr=Rr[zr].initSegment;if(jr){Ar=jr;break}}_r.fragmentHint&&delete _r.fragmentHint.endPTS;let Pr=0,Dr;if(mapFragmentIntersection(_r,Tr,(zr,jr)=>{zr.relurl&&(Pr=zr.cc-jr.cc),isFiniteNumber(zr.startPTS)&&isFiniteNumber(zr.endPTS)&&(jr.start=jr.startPTS=zr.startPTS,jr.startDTS=zr.startDTS,jr.maxStartPTS=zr.maxStartPTS,jr.endPTS=zr.endPTS,jr.endDTS=zr.endDTS,jr.minEndPTS=zr.minEndPTS,jr.duration=zr.endPTS-zr.startPTS,jr.duration&&(Dr=jr),Tr.PTSKnown=Tr.alignedSliding=!0),jr.elementaryStreams=zr.elementaryStreams,jr.loader=zr.loader,jr.stats=zr.stats,jr.urlId=zr.urlId,zr.initSegment&&(jr.initSegment=zr.initSegment,Ar=zr.initSegment)}),Ar&&(Tr.fragmentHint?Tr.fragments.concat(Tr.fragmentHint):Tr.fragments).forEach(jr=>{var Gr;(!jr.initSegment||jr.initSegment.relurl===((Gr=Ar)==null?void 0:Gr.relurl))&&(jr.initSegment=Ar)}),Tr.skippedSegments)if(Tr.deltaUpdateFailed=Tr.fragments.some(zr=>!zr),Tr.deltaUpdateFailed){logger.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let zr=Tr.skippedSegments;zr--;)Tr.fragments.shift();Tr.startSN=Tr.fragments[0].sn,Tr.startCC=Tr.fragments[0].cc}else Tr.canSkipDateRanges&&(Tr.dateRanges=mergeDateRanges(_r.dateRanges,Tr.dateRanges,Tr.recentlyRemovedDateranges));const Mr=Tr.fragments;if(Pr){logger.warn("discontinuity sliding from playlist, take drift into account");for(let zr=0;zr<Mr.length;zr++)Mr[zr].cc+=Pr}Tr.skippedSegments&&(Tr.startCC=Tr.fragments[0].cc),mapPartIntersection(_r.partList,Tr.partList,(zr,jr)=>{jr.elementaryStreams=zr.elementaryStreams,jr.stats=zr.stats}),Dr?updateFragPTSDTS(Tr,Dr,Dr.startPTS,Dr.endPTS,Dr.startDTS,Dr.endDTS):adjustSliding(_r,Tr),Mr.length&&(Tr.totalduration=Tr.edge-Mr[0].start),Tr.driftStartTime=_r.driftStartTime,Tr.driftStart=_r.driftStart;const Fr=Tr.advancedDateTime;if(Tr.advanced&&Fr){const zr=Tr.edge;Tr.driftStart||(Tr.driftStartTime=Fr,Tr.driftStart=zr),Tr.driftEndTime=Fr,Tr.driftEnd=zr}else Tr.driftEndTime=_r.driftEndTime,Tr.driftEnd=_r.driftEnd,Tr.advancedDateTime=_r.advancedDateTime}function mergeDateRanges(_r,Tr,Ar){const Rr=_extends({},_r);return Ar&&Ar.forEach(Pr=>{delete Rr[Pr]}),Object.keys(Tr).forEach(Pr=>{const Dr=new DateRange(Tr[Pr].attr,Rr[Pr]);Dr.isValid?Rr[Pr]=Dr:logger.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${JSON.stringify(Tr[Pr].attr)}"`)}),Rr}function mapPartIntersection(_r,Tr,Ar){if(_r&&Tr){let Rr=0;for(let Pr=0,Dr=_r.length;Pr<=Dr;Pr++){const Mr=_r[Pr],Fr=Tr[Pr+Rr];Mr&&Fr&&Mr.index===Fr.index&&Mr.fragment.sn===Fr.fragment.sn?Ar(Mr,Fr):Rr--}}}function mapFragmentIntersection(_r,Tr,Ar){const Rr=Tr.skippedSegments,Pr=Math.max(_r.startSN,Tr.startSN)-Tr.startSN,Dr=(_r.fragmentHint?1:0)+(Rr?Tr.endSN:Math.min(_r.endSN,Tr.endSN))-Tr.startSN,Mr=Tr.startSN-_r.startSN,Fr=Tr.fragmentHint?Tr.fragments.concat(Tr.fragmentHint):Tr.fragments,zr=_r.fragmentHint?_r.fragments.concat(_r.fragmentHint):_r.fragments;for(let jr=Pr;jr<=Dr;jr++){const Gr=zr[Mr+jr];let Nr=Fr[jr];Rr&&!Nr&&jr<Rr&&(Nr=Tr.fragments[jr]=Gr),Gr&&Nr&&Ar(Gr,Nr)}}function adjustSliding(_r,Tr){const Ar=Tr.startSN+Tr.skippedSegments-_r.startSN,Rr=_r.fragments;Ar<0||Ar>=Rr.length||addSliding(Tr,Rr[Ar].start)}function addSliding(_r,Tr){if(Tr){const Ar=_r.fragments;for(let Rr=_r.skippedSegments;Rr<Ar.length;Rr++)Ar[Rr].start+=Tr;_r.fragmentHint&&(_r.fragmentHint.start+=Tr)}}function computeReloadInterval(_r,Tr=1/0){let Ar=1e3*_r.targetduration;if(_r.updated){const Rr=_r.fragments,Pr=4;if(Rr.length&&Ar*Pr>Tr){const Dr=Rr[Rr.length-1].duration*1e3;Dr<Ar&&(Ar=Dr)}}else Ar/=2;return Math.round(Ar)}function getFragmentWithSN(_r,Tr,Ar){if(!(_r!=null&&_r.details))return null;const Rr=_r.details;let Pr=Rr.fragments[Tr-Rr.startSN];return Pr||(Pr=Rr.fragmentHint,Pr&&Pr.sn===Tr)?Pr:Tr<Rr.startSN&&Ar&&Ar.sn===Tr?Ar:null}function getPartWith(_r,Tr,Ar){var Rr;return _r!=null&&_r.details?findPart((Rr=_r.details)==null?void 0:Rr.partList,Tr,Ar):null}function findPart(_r,Tr,Ar){if(_r)for(let Rr=_r.length;Rr--;){const Pr=_r[Rr];if(Pr.index===Ar&&Pr.fragment.sn===Tr)return Pr}return null}function isTimeoutError(_r){switch(_r.details){case ErrorDetails.FRAG_LOAD_TIMEOUT:case ErrorDetails.KEY_LOAD_TIMEOUT:case ErrorDetails.LEVEL_LOAD_TIMEOUT:case ErrorDetails.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function getRetryConfig(_r,Tr){const Ar=isTimeoutError(Tr);return _r.default[`${Ar?"timeout":"error"}Retry`]}function getRetryDelay(_r,Tr){const Ar=_r.backoff==="linear"?1:Math.pow(2,Tr);return Math.min(Ar*_r.retryDelayMs,_r.maxRetryDelayMs)}function getLoaderConfigWithoutReties(_r){return _objectSpread2(_objectSpread2({},_r),{errorRetry:null,timeoutRetry:null})}function shouldRetry(_r,Tr,Ar,Rr){return!!_r&&Tr<_r.maxNumRetry&&(retryForHttpStatus(Rr)||!!Ar)}function retryForHttpStatus(_r){return _r===0&&navigator.onLine===!1||!!_r&&(_r<400||_r>499)}const BinarySearch={search:function(_r,Tr){let Ar=0,Rr=_r.length-1,Pr=null,Dr=null;for(;Ar<=Rr;){Pr=(Ar+Rr)/2|0,Dr=_r[Pr];const Mr=Tr(Dr);if(Mr>0)Ar=Pr+1;else if(Mr<0)Rr=Pr-1;else return Dr}return null}};function findFragmentByPDT(_r,Tr,Ar){if(Tr===null||!Array.isArray(_r)||!_r.length||!isFiniteNumber(Tr))return null;const Rr=_r[0].programDateTime;if(Tr<(Rr||0))return null;const Pr=_r[_r.length-1].endProgramDateTime;if(Tr>=(Pr||0))return null;Ar=Ar||0;for(let Dr=0;Dr<_r.length;++Dr){const Mr=_r[Dr];if(pdtWithinToleranceTest(Tr,Ar,Mr))return Mr}return null}function findFragmentByPTS(_r,Tr,Ar=0,Rr=0){let Pr=null;if(_r?Pr=Tr[_r.sn-Tr[0].sn+1]||null:Ar===0&&Tr[0].start===0&&(Pr=Tr[0]),Pr&&fragmentWithinToleranceTest(Ar,Rr,Pr)===0)return Pr;const Dr=BinarySearch.search(Tr,fragmentWithinToleranceTest.bind(null,Ar,Rr));return Dr&&(Dr!==_r||!Pr)?Dr:Pr}function fragmentWithinToleranceTest(_r=0,Tr=0,Ar){if(Ar.start<=_r&&Ar.start+Ar.duration>_r)return 0;const Rr=Math.min(Tr,Ar.duration+(Ar.deltaPTS?Ar.deltaPTS:0));return Ar.start+Ar.duration-Rr<=_r?1:Ar.start-Rr>_r&&Ar.start?-1:0}function pdtWithinToleranceTest(_r,Tr,Ar){const Rr=Math.min(Tr,Ar.duration+(Ar.deltaPTS?Ar.deltaPTS:0))*1e3;return(Ar.endProgramDateTime||0)-Rr>_r}function findFragWithCC(_r,Tr){return BinarySearch.search(_r,Ar=>Ar.cc<Tr?1:Ar.cc>Tr?-1:0)}const RENDITION_PENALTY_DURATION_MS=3e5;var NetworkErrorAction={DoNothing:0,SendEndCallback:1,SendAlternateToPenaltyBox:2,RemoveAlternatePermanently:3,InsertDiscontinuity:4,RetryRequest:5},ErrorActionFlags={None:0,MoveAllAlternatesMatchingHost:1,MoveAllAlternatesMatchingHDCP:2,SwitchToSDR:4};class ErrorController{constructor(Tr){this.hls=void 0,this.playlistError=0,this.penalizedRenditions={},this.log=void 0,this.warn=void 0,this.error=void 0,this.hls=Tr,this.log=logger.log.bind(logger,"[info]:"),this.warn=logger.warn.bind(logger,"[warning]:"),this.error=logger.error.bind(logger,"[error]:"),this.registerListeners()}registerListeners(){const Tr=this.hls;Tr.on(Events.ERROR,this.onError,this),Tr.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),Tr.on(Events.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){const Tr=this.hls;Tr&&(Tr.off(Events.ERROR,this.onError,this),Tr.off(Events.ERROR,this.onErrorOut,this),Tr.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),Tr.off(Events.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null,this.penalizedRenditions={}}startLoad(Tr){this.playlistError=0}stopLoad(){}getVariantLevelIndex(Tr){return(Tr==null?void 0:Tr.type)===PlaylistLevelType.MAIN?Tr.level:this.hls.loadLevel}onManifestLoading(){this.playlistError=0,this.penalizedRenditions={}}onLevelUpdated(){this.playlistError=0}onError(Tr,Ar){var Rr,Pr;if(Ar.fatal)return;const Dr=this.hls,Mr=Ar.context;switch(Ar.details){case ErrorDetails.FRAG_LOAD_ERROR:case ErrorDetails.FRAG_LOAD_TIMEOUT:case ErrorDetails.KEY_LOAD_ERROR:case ErrorDetails.KEY_LOAD_TIMEOUT:Ar.errorAction=this.getFragRetryOrSwitchAction(Ar);return;case ErrorDetails.FRAG_PARSING_ERROR:if((Rr=Ar.frag)!=null&&Rr.gap){Ar.errorAction={action:NetworkErrorAction.DoNothing,flags:ErrorActionFlags.None};return}case ErrorDetails.FRAG_GAP:case ErrorDetails.FRAG_DECRYPT_ERROR:{Ar.errorAction=this.getFragRetryOrSwitchAction(Ar),Ar.errorAction.action=NetworkErrorAction.SendAlternateToPenaltyBox;return}case ErrorDetails.LEVEL_EMPTY_ERROR:case ErrorDetails.LEVEL_PARSING_ERROR:{var Fr,zr;const jr=Ar.parent===PlaylistLevelType.MAIN?Ar.level:Dr.loadLevel;Ar.details===ErrorDetails.LEVEL_EMPTY_ERROR&&((Fr=Ar.context)!=null&&(zr=Fr.levelDetails)!=null&&zr.live)?Ar.errorAction=this.getPlaylistRetryOrSwitchAction(Ar,jr):(Ar.levelRetry=!1,Ar.errorAction=this.getLevelSwitchAction(Ar,jr))}return;case ErrorDetails.LEVEL_LOAD_ERROR:case ErrorDetails.LEVEL_LOAD_TIMEOUT:typeof(Mr==null?void 0:Mr.level)=="number"&&(Ar.errorAction=this.getPlaylistRetryOrSwitchAction(Ar,Mr.level));return;case ErrorDetails.AUDIO_TRACK_LOAD_ERROR:case ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:case ErrorDetails.SUBTITLE_LOAD_ERROR:case ErrorDetails.SUBTITLE_TRACK_LOAD_TIMEOUT:if(Mr){const jr=Dr.levels[Dr.loadLevel];if(jr&&(Mr.type===PlaylistContextType.AUDIO_TRACK&&Mr.groupId===jr.audioGroupId||Mr.type===PlaylistContextType.SUBTITLE_TRACK&&Mr.groupId===jr.textGroupId)){Ar.errorAction=this.getPlaylistRetryOrSwitchAction(Ar,Dr.loadLevel),Ar.errorAction.action=NetworkErrorAction.SendAlternateToPenaltyBox,Ar.errorAction.flags=ErrorActionFlags.MoveAllAlternatesMatchingHost;return}}return;case ErrorDetails.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:{const jr=Dr.levels[Dr.loadLevel],Gr=jr==null?void 0:jr.attrs["HDCP-LEVEL"];Gr&&(Ar.errorAction={action:NetworkErrorAction.SendAlternateToPenaltyBox,flags:ErrorActionFlags.MoveAllAlternatesMatchingHDCP,hdcpLevel:Gr})}return;case ErrorDetails.BUFFER_ADD_CODEC_ERROR:case ErrorDetails.REMUX_ALLOC_ERROR:Ar.errorAction=this.getLevelSwitchAction(Ar,(Pr=Ar.level)!=null?Pr:Dr.loadLevel);return;case ErrorDetails.INTERNAL_EXCEPTION:case ErrorDetails.BUFFER_APPENDING_ERROR:case ErrorDetails.BUFFER_APPEND_ERROR:case ErrorDetails.BUFFER_FULL_ERROR:case ErrorDetails.LEVEL_SWITCH_ERROR:case ErrorDetails.BUFFER_STALLED_ERROR:case ErrorDetails.BUFFER_SEEK_OVER_HOLE:case ErrorDetails.BUFFER_NUDGE_ON_STALL:Ar.errorAction={action:NetworkErrorAction.DoNothing,flags:ErrorActionFlags.None};return}if(Ar.type===ErrorTypes.KEY_SYSTEM_ERROR){const jr=this.getVariantLevelIndex(Ar.frag);Ar.levelRetry=!1,Ar.errorAction=this.getLevelSwitchAction(Ar,jr);return}}getPlaylistRetryOrSwitchAction(Tr,Ar){var Rr;const Pr=this.hls,Dr=getRetryConfig(Pr.config.playlistLoadPolicy,Tr),Mr=this.playlistError++,Fr=(Rr=Tr.response)==null?void 0:Rr.code;if(shouldRetry(Dr,Mr,isTimeoutError(Tr),Fr))return{action:NetworkErrorAction.RetryRequest,flags:ErrorActionFlags.None,retryConfig:Dr,retryCount:Mr};const jr=this.getLevelSwitchAction(Tr,Ar);return Dr&&(jr.retryConfig=Dr,jr.retryCount=Mr),jr}getFragRetryOrSwitchAction(Tr){const Ar=this.hls,Rr=this.getVariantLevelIndex(Tr.frag),Pr=Ar.levels[Rr],{fragLoadPolicy:Dr,keyLoadPolicy:Mr}=Ar.config,Fr=getRetryConfig(Tr.details.startsWith("key")?Mr:Dr,Tr),zr=Ar.levels.reduce((Nr,Lr)=>Nr+Lr.fragmentError,0);if(Pr){var jr;Tr.details!==ErrorDetails.FRAG_GAP&&Pr.fragmentError++;const Nr=(jr=Tr.response)==null?void 0:jr.code;if(shouldRetry(Fr,zr,isTimeoutError(Tr),Nr))return{action:NetworkErrorAction.RetryRequest,flags:ErrorActionFlags.None,retryConfig:Fr,retryCount:zr}}const Gr=this.getLevelSwitchAction(Tr,Rr);return Fr&&(Gr.retryConfig=Fr,Gr.retryCount=zr),Gr}getLevelSwitchAction(Tr,Ar){const Rr=this.hls;Ar==null&&(Ar=Rr.loadLevel);const Pr=this.hls.levels[Ar];if(Pr&&(Pr.loadError++,Rr.autoLevelEnabled)){var Dr,Mr;let Fr=-1;const{levels:zr,loadLevel:jr,minAutoLevel:Gr,maxAutoLevel:Nr}=Rr,Lr=(Dr=Tr.frag)==null?void 0:Dr.type,{type:Ur,groupId:Vr}=(Mr=Tr.context)!=null?Mr:{};for(let Wr=zr.length;Wr--;){const qr=(Wr+jr)%zr.length;if(qr!==jr&&qr>=Gr&&qr<=Nr&&zr[qr].loadError===0){const Kr=zr[qr];if(Tr.details===ErrorDetails.FRAG_GAP&&Tr.frag){const Xr=zr[qr].details;if(Xr){const Zr=findFragmentByPTS(Tr.frag,Xr.fragments,Tr.frag.start);if(Zr!=null&&Zr.gap)continue}}else{if(Ur===PlaylistContextType.AUDIO_TRACK&&Vr===Kr.audioGroupId||Ur===PlaylistContextType.SUBTITLE_TRACK&&Vr===Kr.textGroupId)continue;if(Lr===PlaylistLevelType.AUDIO&&Pr.audioGroupId===Kr.audioGroupId||Lr===PlaylistLevelType.SUBTITLE&&Pr.textGroupId===Kr.textGroupId)continue}Fr=qr;break}}if(Fr>-1&&Rr.loadLevel!==Fr)return Tr.levelRetry=!0,this.playlistError=0,{action:NetworkErrorAction.SendAlternateToPenaltyBox,flags:ErrorActionFlags.None,nextAutoLevel:Fr}}return{action:NetworkErrorAction.SendAlternateToPenaltyBox,flags:ErrorActionFlags.MoveAllAlternatesMatchingHost}}onErrorOut(Tr,Ar){var Rr;switch((Rr=Ar.errorAction)==null?void 0:Rr.action){case NetworkErrorAction.DoNothing:break;case NetworkErrorAction.SendAlternateToPenaltyBox:this.sendAlternateToPenaltyBox(Ar),!Ar.errorAction.resolved&&Ar.details!==ErrorDetails.FRAG_GAP&&(Ar.fatal=!0);break}if(Ar.fatal){this.hls.stopLoad();return}}sendAlternateToPenaltyBox(Tr){const Ar=this.hls,Rr=Tr.errorAction;if(!Rr)return;const{flags:Pr,hdcpLevel:Dr,nextAutoLevel:Mr}=Rr;switch(Pr){case ErrorActionFlags.None:this.switchLevel(Tr,Mr);break;case ErrorActionFlags.MoveAllAlternatesMatchingHost:Rr.resolved||(Rr.resolved=this.redundantFailover(Tr));break;case ErrorActionFlags.MoveAllAlternatesMatchingHDCP:Dr&&(Ar.maxHdcpLevel=HdcpLevels[HdcpLevels.indexOf(Dr)-1],Rr.resolved=!0),this.warn(`Restricting playback to HDCP-LEVEL of "${Ar.maxHdcpLevel}" or lower`);break}Rr.resolved||this.switchLevel(Tr,Mr)}switchLevel(Tr,Ar){Ar!==void 0&&Tr.errorAction&&(this.warn(`switching to level ${Ar} after ${Tr.details}`),this.hls.nextAutoLevel=Ar,Tr.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel)}redundantFailover(Tr){const{hls:Ar,penalizedRenditions:Rr}=this,Pr=Tr.parent===PlaylistLevelType.MAIN?Tr.level:Ar.loadLevel,Dr=Ar.levels[Pr],Mr=Dr.url.length,Fr=Tr.frag?Tr.frag.urlId:Dr.urlId;Dr.urlId===Fr&&(!Tr.frag||Dr.details)&&this.penalizeRendition(Dr,Tr);for(let zr=1;zr<Mr;zr++){const jr=(Fr+zr)%Mr,Gr=Rr[jr];if(!Gr||checkExpired(Gr,Tr,Rr[Fr]))return this.warn(`Switching to Redundant Stream ${jr+1}/${Mr}: "${Dr.url[jr]}" after ${Tr.details}`),this.playlistError=0,Ar.levels.forEach(Nr=>{Nr.urlId=jr}),Ar.nextLoadLevel=Pr,!0}return!1}penalizeRendition(Tr,Ar){const{penalizedRenditions:Rr}=this,Pr=Rr[Tr.urlId]||{lastErrorPerfMs:0,errors:[],details:void 0};Pr.lastErrorPerfMs=performance.now(),Pr.errors.push(Ar),Pr.details=Tr.details,Rr[Tr.urlId]=Pr}}function checkExpired(_r,Tr,Ar){if(performance.now()-_r.lastErrorPerfMs>RENDITION_PENALTY_DURATION_MS)return!0;const Rr=_r.details;if(Tr.details===ErrorDetails.FRAG_GAP&&Rr&&Tr.frag){const Pr=Tr.frag.start,Dr=findFragmentByPTS(null,Rr.fragments,Pr);if(Dr&&!Dr.gap)return!0}if(Ar&&_r.errors.length<Ar.errors.length){const Pr=_r.errors[_r.errors.length-1];if(Rr&&Pr.frag&&Tr.frag&&Math.abs(Pr.frag.start-Tr.frag.start)>Rr.targetduration*3)return!0}return!1}class BasePlaylistController{constructor(Tr,Ar){this.hls=void 0,this.timer=-1,this.requestScheduled=-1,this.canLoad=!1,this.log=void 0,this.warn=void 0,this.log=logger.log.bind(logger,`${Ar}:`),this.warn=logger.warn.bind(logger,`${Ar}:`),this.hls=Tr}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){clearTimeout(this.timer),this.timer=-1}startLoad(){this.canLoad=!0,this.requestScheduled=-1,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(Tr,Ar){const Rr=Ar==null?void 0:Ar.renditionReports;if(Rr){let Pr=-1;for(let Dr=0;Dr<Rr.length;Dr++){const Mr=Rr[Dr];let Fr;try{Fr=new self.URL(Mr.URI,Ar.url).href}catch(zr){logger.warn(`Could not construct new URL for Rendition Report: ${zr}`),Fr=Mr.URI||""}if(Fr===Tr){Pr=Dr;break}else Fr===Tr.substring(0,Fr.length)&&(Pr=Dr)}if(Pr!==-1){const Dr=Rr[Pr],Mr=parseInt(Dr["LAST-MSN"])||(Ar==null?void 0:Ar.lastPartSn);let Fr=parseInt(Dr["LAST-PART"])||(Ar==null?void 0:Ar.lastPartIndex);if(this.hls.config.lowLatencyMode){const zr=Math.min(Ar.age-Ar.partTarget,Ar.targetduration);Fr>=0&&zr>Ar.partTarget&&(Fr+=1)}return new HlsUrlParameters(Mr,Fr>=0?Fr:void 0,HlsSkip.No)}}}loadPlaylist(Tr){this.requestScheduled===-1&&(this.requestScheduled=self.performance.now())}shouldLoadPlaylist(Tr){return this.canLoad&&!!Tr&&!!Tr.url&&(!Tr.details||Tr.details.live)}shouldReloadPlaylist(Tr){return this.timer===-1&&this.requestScheduled===-1&&this.shouldLoadPlaylist(Tr)}playlistLoaded(Tr,Ar,Rr){const{details:Pr,stats:Dr}=Ar,Mr=self.performance.now(),Fr=Dr.loading.first?Math.max(0,Mr-Dr.loading.first):0;if(Pr.advancedDateTime=Date.now()-Fr,Pr.live||Rr!=null&&Rr.live){if(Pr.reloaded(Rr),Rr&&this.log(`live playlist ${Tr} ${Pr.advanced?"REFRESHED "+Pr.lastPartSn+"-"+Pr.lastPartIndex:Pr.updated?"UPDATED":"MISSED"}`),Rr&&Pr.fragments.length>0&&mergeDetails(Rr,Pr),!this.canLoad||!Pr.live)return;let zr,jr,Gr;if(Pr.canBlockReload&&Pr.endSN&&Pr.advanced){const qr=this.hls.config.lowLatencyMode,Kr=Pr.lastPartSn,Xr=Pr.endSN,Zr=Pr.lastPartIndex,_i=Zr!==-1,Jr=Kr===Xr,es=qr?0:Zr;_i?(jr=Jr?Xr+1:Kr,Gr=Jr?es:Zr+1):jr=Xr+1;const ts=Pr.age,is=ts+Pr.ageHeader;let rs=Math.min(is-Pr.partTarget,Pr.targetduration*1.5);if(rs>0){if(Rr&&rs>Rr.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${Rr.tuneInGoal} to: ${rs} with playlist age: ${Pr.age}`),rs=0;else{const as=Math.floor(rs/Pr.targetduration);if(jr+=as,Gr!==void 0){const ls=Math.round(rs%Pr.targetduration/Pr.partTarget);Gr+=ls}this.log(`CDN Tune-in age: ${Pr.ageHeader}s last advanced ${ts.toFixed(2)}s goal: ${rs} skip sn ${as} to part ${Gr}`)}Pr.tuneInGoal=rs}if(zr=this.getDeliveryDirectives(Pr,Ar.deliveryDirectives,jr,Gr),qr||!Jr){this.loadPlaylist(zr);return}}else(Pr.canBlockReload||Pr.canSkipUntil)&&(zr=this.getDeliveryDirectives(Pr,Ar.deliveryDirectives,jr,Gr));const Nr=this.hls.mainForwardBufferInfo,Lr=Nr?Nr.end-Nr.len:0,Ur=(Pr.edge-Lr)*1e3,Vr=computeReloadInterval(Pr,Ur);Pr.updated&&Mr>this.requestScheduled+Vr&&(this.requestScheduled=Dr.loading.start),jr!==void 0&&Pr.canBlockReload?this.requestScheduled=Dr.loading.first+Vr-(Pr.partTarget*1e3||1e3):this.requestScheduled===-1||this.requestScheduled+Vr<Mr?this.requestScheduled=Mr:this.requestScheduled-Mr<=0&&(this.requestScheduled+=Vr);let Wr=this.requestScheduled-Mr;Wr=Math.max(0,Wr),this.log(`reload live playlist ${Tr} in ${Math.round(Wr)} ms`),this.timer=self.setTimeout(()=>this.loadPlaylist(zr),Wr)}else this.clearTimer()}getDeliveryDirectives(Tr,Ar,Rr,Pr){let Dr=getSkipValue(Tr,Rr);return Ar!=null&&Ar.skip&&Tr.deltaUpdateFailed&&(Rr=Ar.msn,Pr=Ar.part,Dr=HlsSkip.No),new HlsUrlParameters(Rr,Pr,Dr)}checkRetry(Tr){const Ar=Tr.details,Rr=isTimeoutError(Tr),Pr=Tr.errorAction,{action:Dr,retryCount:Mr=0,retryConfig:Fr}=Pr||{},zr=!!Pr&&!!Fr&&(Dr===NetworkErrorAction.RetryRequest||!Pr.resolved&&Dr===NetworkErrorAction.SendAlternateToPenaltyBox);if(zr){var jr;if(this.requestScheduled=-1,Mr>=Fr.maxNumRetry)return!1;if(Rr&&(jr=Tr.context)!=null&&jr.deliveryDirectives)this.warn(`Retrying playlist loading ${Mr+1}/${Fr.maxNumRetry} after "${Ar}" without delivery-directives`),this.loadPlaylist();else{const Gr=getRetryDelay(Fr,Mr);this.timer=self.setTimeout(()=>this.loadPlaylist(),Gr),this.warn(`Retrying playlist loading ${Mr+1}/${Fr.maxNumRetry} after "${Ar}" in ${Gr}ms`)}Tr.levelRetry=!0,Pr.resolved=!0}return zr}}let chromeOrFirefox;class LevelController extends BasePlaylistController{constructor(Tr,Ar){super(Tr,"[level-controller]"),this._levels=[],this._firstLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=Ar,this._registerListeners()}_registerListeners(){const{hls:Tr}=this;Tr.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),Tr.on(Events.MANIFEST_LOADED,this.onManifestLoaded,this),Tr.on(Events.LEVEL_LOADED,this.onLevelLoaded,this),Tr.on(Events.LEVELS_UPDATED,this.onLevelsUpdated,this),Tr.on(Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),Tr.on(Events.FRAG_LOADED,this.onFragLoaded,this),Tr.on(Events.ERROR,this.onError,this)}_unregisterListeners(){const{hls:Tr}=this;Tr.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),Tr.off(Events.MANIFEST_LOADED,this.onManifestLoaded,this),Tr.off(Events.LEVEL_LOADED,this.onLevelLoaded,this),Tr.off(Events.LEVELS_UPDATED,this.onLevelsUpdated,this),Tr.off(Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),Tr.off(Events.FRAG_LOADED,this.onFragLoaded,this),Tr.off(Events.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}startLoad(){this._levels.forEach(Ar=>{Ar.loadError=0,Ar.fragmentError=0}),super.startLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[]}onManifestLoading(Tr,Ar){this.resetLevels()}onManifestLoaded(Tr,Ar){const Rr=[],Pr={};let Dr;Ar.levels.forEach(Mr=>{var Fr;const zr=Mr.attrs;((Fr=Mr.audioCodec)==null?void 0:Fr.indexOf("mp4a.40.34"))!==-1&&(chromeOrFirefox||(chromeOrFirefox=/chrome|firefox/i.test(navigator.userAgent)),chromeOrFirefox&&(Mr.audioCodec=void 0));const{AUDIO:jr,CODECS:Gr,"FRAME-RATE":Nr,"PATHWAY-ID":Lr,RESOLUTION:Ur,SUBTITLES:Vr}=zr,qr=`${`${Lr||"."}-`}${Mr.bitrate}-${Ur}-${Nr}-${Gr}`;Dr=Pr[qr],Dr?Dr.addFallback(Mr):(Dr=new Level(Mr),Pr[qr]=Dr,Rr.push(Dr)),addGroupId(Dr,"audio",jr),addGroupId(Dr,"text",Vr)}),this.filterAndSortMediaOptions(Rr,Ar)}filterAndSortMediaOptions(Tr,Ar){let Rr=[],Pr=[],Dr=!1,Mr=!1,Fr=!1,zr=Tr.filter(({audioCodec:Ur,videoCodec:Vr,width:Wr,height:qr,unknownCodecs:Kr})=>(Dr||(Dr=!!(Wr&&qr)),Mr||(Mr=!!Vr),Fr||(Fr=!!Ur),!(Kr!=null&&Kr.length)&&(!Ur||isCodecSupportedInMp4(Ur,"audio"))&&(!Vr||isCodecSupportedInMp4(Vr,"video"))));if((Dr||Mr)&&Fr&&(zr=zr.filter(({videoCodec:Ur,width:Vr,height:Wr})=>!!Ur||!!(Vr&&Wr))),zr.length===0){Promise.resolve().then(()=>{if(this.hls){const Ur=new Error("no level with compatible codecs found in manifest");this.hls.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:Ar.url,error:Ur,reason:Ur.message})}});return}Ar.audioTracks&&(Rr=Ar.audioTracks.filter(Ur=>!Ur.audioCodec||isCodecSupportedInMp4(Ur.audioCodec,"audio")),assignTrackIdsByGroup(Rr)),Ar.subtitles&&(Pr=Ar.subtitles,assignTrackIdsByGroup(Pr));const jr=zr.slice(0);zr.sort((Ur,Vr)=>Ur.attrs["HDCP-LEVEL"]!==Vr.attrs["HDCP-LEVEL"]?(Ur.attrs["HDCP-LEVEL"]||"")>(Vr.attrs["HDCP-LEVEL"]||"")?1:-1:Ur.bitrate!==Vr.bitrate?Ur.bitrate-Vr.bitrate:Ur.attrs["FRAME-RATE"]!==Vr.attrs["FRAME-RATE"]?Ur.attrs.decimalFloatingPoint("FRAME-RATE")-Vr.attrs.decimalFloatingPoint("FRAME-RATE"):Ur.attrs.SCORE!==Vr.attrs.SCORE?Ur.attrs.decimalFloatingPoint("SCORE")-Vr.attrs.decimalFloatingPoint("SCORE"):Dr&&Ur.height!==Vr.height?Ur.height-Vr.height:0);let Gr=jr[0];if(this.steering&&(zr=this.steering.filterParsedLevels(zr),zr.length!==jr.length)){for(let Ur=0;Ur<jr.length;Ur++)if(jr[Ur].pathwayId===zr[0].pathwayId){Gr=jr[Ur];break}}this._levels=zr;for(let Ur=0;Ur<zr.length;Ur++)if(zr[Ur]===Gr){this._firstLevel=Ur,this.log(`manifest loaded, ${zr.length} level(s) found, first bitrate: ${Gr.bitrate}`);break}const Nr=Fr&&!Mr,Lr={levels:zr,audioTracks:Rr,subtitleTracks:Pr,sessionData:Ar.sessionData,sessionKeys:Ar.sessionKeys,firstLevel:this._firstLevel,stats:Ar.stats,audio:Fr,video:Mr,altAudio:!Nr&&Rr.some(Ur=>!!Ur.url)};this.hls.trigger(Events.MANIFEST_PARSED,Lr),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}get levels(){return this._levels.length===0?null:this._levels}get level(){return this.currentLevelIndex}set level(Tr){const Ar=this._levels;if(Ar.length===0)return;if(Tr<0||Tr>=Ar.length){const Gr=new Error("invalid level idx"),Nr=Tr<0;if(this.hls.trigger(Events.ERROR,{type:ErrorTypes.OTHER_ERROR,details:ErrorDetails.LEVEL_SWITCH_ERROR,level:Tr,fatal:Nr,error:Gr,reason:Gr.message}),Nr)return;Tr=Math.min(Tr,Ar.length-1)}const Rr=this.currentLevelIndex,Pr=this.currentLevel,Dr=Pr?Pr.attrs["PATHWAY-ID"]:void 0,Mr=Ar[Tr],Fr=Mr.attrs["PATHWAY-ID"];if(this.currentLevelIndex=Tr,this.currentLevel=Mr,Rr===Tr&&Mr.details&&Pr&&Dr===Fr)return;this.log(`Switching to level ${Tr}${Fr?" with Pathway "+Fr:""} from level ${Rr}${Dr?" with Pathway "+Dr:""}`);const zr=_extends({},Mr,{level:Tr,maxBitrate:Mr.maxBitrate,attrs:Mr.attrs,uri:Mr.uri,urlId:Mr.urlId});delete zr._attrs,delete zr._urlId,this.hls.trigger(Events.LEVEL_SWITCHING,zr);const jr=Mr.details;if(!jr||jr.live){const Gr=this.switchParams(Mr.uri,Pr==null?void 0:Pr.details);this.loadPlaylist(Gr)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(Tr){this.manualLevelIndex=Tr,this._startLevel===void 0&&(this._startLevel=Tr),Tr!==-1&&(this.level=Tr)}get firstLevel(){return this._firstLevel}set firstLevel(Tr){this._firstLevel=Tr}get startLevel(){if(this._startLevel===void 0){const Tr=this.hls.config.startLevel;return Tr!==void 0?Tr:this._firstLevel}else return this._startLevel}set startLevel(Tr){this._startLevel=Tr}onError(Tr,Ar){Ar.fatal||!Ar.context||Ar.context.type===PlaylistContextType.LEVEL&&Ar.context.level===this.level&&this.checkRetry(Ar)}onFragLoaded(Tr,{frag:Ar}){if(Ar!==void 0&&Ar.type===PlaylistLevelType.MAIN){const Rr=this._levels[Ar.level];Rr!==void 0&&(Rr.loadError=0)}}onLevelLoaded(Tr,Ar){var Rr;const{level:Pr,details:Dr}=Ar,Mr=this._levels[Pr];if(!Mr){var Fr;this.warn(`Invalid level index ${Pr}`),(Fr=Ar.deliveryDirectives)!=null&&Fr.skip&&(Dr.deltaUpdateFailed=!0);return}Pr===this.currentLevelIndex?(Mr.fragmentError===0&&(Mr.loadError=0),this.playlistLoaded(Pr,Ar,Mr.details)):(Rr=Ar.deliveryDirectives)!=null&&Rr.skip&&(Dr.deltaUpdateFailed=!0)}onAudioTrackSwitched(Tr,Ar){const Rr=this.currentLevel;if(!Rr)return;const Pr=this.hls.audioTracks[Ar.id].groupId;if(Rr.audioGroupIds&&Rr.audioGroupId!==Pr){let Dr=-1;for(let Mr=0;Mr<Rr.audioGroupIds.length;Mr++)if(Rr.audioGroupIds[Mr]===Pr){Dr=Mr;break}Dr!==-1&&Dr!==Rr.urlId&&(Rr.urlId=Dr,this.canLoad&&this.startLoad())}}loadPlaylist(Tr){super.loadPlaylist();const Ar=this.currentLevelIndex,Rr=this.currentLevel;if(Rr&&this.shouldLoadPlaylist(Rr)){const Pr=Rr.urlId;let Dr=Rr.uri;if(Tr)try{Dr=Tr.addDirectives(Dr)}catch(Fr){this.warn(`Could not construct new URL with HLS Delivery Directives: ${Fr}`)}const Mr=Rr.attrs["PATHWAY-ID"];this.log(`Loading level index ${Ar}${(Tr==null?void 0:Tr.msn)!==void 0?" at sn "+Tr.msn+" part "+Tr.part:""} with${Mr?" Pathway "+Mr:""} URI ${Pr+1}/${Rr.url.length} ${Dr}`),this.clearTimer(),this.hls.trigger(Events.LEVEL_LOADING,{url:Dr,level:Ar,id:Pr,deliveryDirectives:Tr||null})}}get nextLoadLevel(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(Tr){this.level=Tr,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=Tr)}removeLevel(Tr,Ar){const Rr=(Dr,Mr)=>Mr!==Ar,Pr=this._levels.filter((Dr,Mr)=>Mr!==Tr?!0:Dr.url.length>1&&Ar!==void 0?(Dr.url=Dr.url.filter(Rr),Dr.audioGroupIds&&(Dr.audioGroupIds=Dr.audioGroupIds.filter(Rr)),Dr.textGroupIds&&(Dr.textGroupIds=Dr.textGroupIds.filter(Rr)),Dr.urlId=0,!0):(this.steering&&this.steering.removeLevel(Dr),!1));this.hls.trigger(Events.LEVELS_UPDATED,{levels:Pr})}onLevelsUpdated(Tr,{levels:Ar}){Ar.forEach((Rr,Pr)=>{const{details:Dr}=Rr;Dr!=null&&Dr.fragments&&Dr.fragments.forEach(Mr=>{Mr.level=Pr})}),this._levels=Ar}}function addGroupId(_r,Tr,Ar){Ar&&(Tr==="audio"?(_r.audioGroupIds||(_r.audioGroupIds=[]),_r.audioGroupIds[_r.url.length-1]=Ar):Tr==="text"&&(_r.textGroupIds||(_r.textGroupIds=[]),_r.textGroupIds[_r.url.length-1]=Ar))}function assignTrackIdsByGroup(_r){const Tr={};_r.forEach(Ar=>{const Rr=Ar.groupId||"";Ar.id=Tr[Rr]=Tr[Rr]||0,Tr[Rr]++})}var FragmentState={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"};class FragmentTracker{constructor(Tr){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=Tr,this._registerListeners()}_registerListeners(){const{hls:Tr}=this;Tr.on(Events.BUFFER_APPENDED,this.onBufferAppended,this),Tr.on(Events.FRAG_BUFFERED,this.onFragBuffered,this),Tr.on(Events.FRAG_LOADED,this.onFragLoaded,this)}_unregisterListeners(){const{hls:Tr}=this;Tr.off(Events.BUFFER_APPENDED,this.onBufferAppended,this),Tr.off(Events.FRAG_BUFFERED,this.onFragBuffered,this),Tr.off(Events.FRAG_LOADED,this.onFragLoaded,this)}destroy(){this._unregisterListeners(),this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(Tr,Ar){const Rr=this.activePartLists[Ar];if(Rr)for(let Pr=Rr.length;Pr--;){const Dr=Rr[Pr];if(!Dr)break;const Mr=Dr.end;if(Dr.start<=Tr&&Mr!==null&&Tr<=Mr)return Dr}return this.getBufferedFrag(Tr,Ar)}getBufferedFrag(Tr,Ar){const{fragments:Rr}=this,Pr=Object.keys(Rr);for(let Dr=Pr.length;Dr--;){const Mr=Rr[Pr[Dr]];if((Mr==null?void 0:Mr.body.type)===Ar&&Mr.buffered){const Fr=Mr.body;if(Fr.start<=Tr&&Tr<=Fr.end)return Fr}}return null}detectEvictedFragments(Tr,Ar,Rr,Pr){this.timeRanges&&(this.timeRanges[Tr]=Ar);const Dr=(Pr==null?void 0:Pr.fragment.sn)||-1;Object.keys(this.fragments).forEach(Mr=>{const Fr=this.fragments[Mr];if(!Fr||Dr>=Fr.body.sn)return;if(!Fr.buffered&&!Fr.loaded){Fr.body.type===Rr&&this.removeFragment(Fr.body);return}const zr=Fr.range[Tr];zr&&zr.time.some(jr=>{const Gr=!this.isTimeBuffered(jr.startPTS,jr.endPTS,Ar);return Gr&&this.removeFragment(Fr.body),Gr})})}detectPartialFragments(Tr){const Ar=this.timeRanges,{frag:Rr,part:Pr}=Tr;if(!Ar||Rr.sn==="initSegment")return;const Dr=getFragmentKey(Rr),Mr=this.fragments[Dr];if(!Mr||Mr.buffered&&Rr.gap)return;const Fr=!Rr.relurl;Object.keys(Ar).forEach(zr=>{const jr=Rr.elementaryStreams[zr];if(!jr)return;const Gr=Ar[zr],Nr=Fr||jr.partial===!0;Mr.range[zr]=this.getBufferedTimes(Rr,Pr,Nr,Gr)}),Mr.loaded=null,Object.keys(Mr.range).length?(Mr.buffered=!0,(Mr.body.endList=Rr.endList||Mr.body.endList)&&(this.endListFragments[Mr.body.type]=Mr),isPartial(Mr)||this.removeParts(Rr.sn-1,Rr.type)):this.removeFragment(Mr.body)}removeParts(Tr,Ar){const Rr=this.activePartLists[Ar];Rr&&(this.activePartLists[Ar]=Rr.filter(Pr=>Pr.fragment.sn>=Tr))}fragBuffered(Tr,Ar){const Rr=getFragmentKey(Tr);let Pr=this.fragments[Rr];!Pr&&Ar&&(Pr=this.fragments[Rr]={body:Tr,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},Tr.gap&&(this.hasGaps=!0)),Pr&&(Pr.loaded=null,Pr.buffered=!0)}getBufferedTimes(Tr,Ar,Rr,Pr){const Dr={time:[],partial:Rr},Mr=Tr.start,Fr=Tr.end,zr=Tr.minEndPTS||Fr,jr=Tr.maxStartPTS||Mr;for(let Gr=0;Gr<Pr.length;Gr++){const Nr=Pr.start(Gr)-this.bufferPadding,Lr=Pr.end(Gr)+this.bufferPadding;if(jr>=Nr&&zr<=Lr){Dr.time.push({startPTS:Math.max(Mr,Pr.start(Gr)),endPTS:Math.min(Fr,Pr.end(Gr))});break}else if(Mr<Lr&&Fr>Nr)Dr.partial=!0,Dr.time.push({startPTS:Math.max(Mr,Pr.start(Gr)),endPTS:Math.min(Fr,Pr.end(Gr))});else if(Fr<=Nr)break}return Dr}getPartialFragment(Tr){let Ar=null,Rr,Pr,Dr,Mr=0;const{bufferPadding:Fr,fragments:zr}=this;return Object.keys(zr).forEach(jr=>{const Gr=zr[jr];Gr&&isPartial(Gr)&&(Pr=Gr.body.start-Fr,Dr=Gr.body.end+Fr,Tr>=Pr&&Tr<=Dr&&(Rr=Math.min(Tr-Pr,Dr-Tr),Mr<=Rr&&(Ar=Gr.body,Mr=Rr)))}),Ar}isEndListAppended(Tr){const Ar=this.endListFragments[Tr];return Ar!==void 0&&(Ar.buffered||isPartial(Ar))}getState(Tr){const Ar=getFragmentKey(Tr),Rr=this.fragments[Ar];return Rr?Rr.buffered?isPartial(Rr)?FragmentState.PARTIAL:FragmentState.OK:FragmentState.APPENDING:FragmentState.NOT_LOADED}isTimeBuffered(Tr,Ar,Rr){let Pr,Dr;for(let Mr=0;Mr<Rr.length;Mr++){if(Pr=Rr.start(Mr)-this.bufferPadding,Dr=Rr.end(Mr)+this.bufferPadding,Tr>=Pr&&Ar<=Dr)return!0;if(Ar<=Pr)return!1}return!1}onFragLoaded(Tr,Ar){const{frag:Rr,part:Pr}=Ar;if(Rr.sn==="initSegment"||Rr.bitrateTest)return;const Dr=Pr?null:Ar,Mr=getFragmentKey(Rr);this.fragments[Mr]={body:Rr,appendedPTS:null,loaded:Dr,buffered:!1,range:Object.create(null)}}onBufferAppended(Tr,Ar){const{frag:Rr,part:Pr,timeRanges:Dr}=Ar;if(Rr.sn==="initSegment")return;const Mr=Rr.type;if(Pr){let Fr=this.activePartLists[Mr];Fr||(this.activePartLists[Mr]=Fr=[]),Fr.push(Pr)}this.timeRanges=Dr,Object.keys(Dr).forEach(Fr=>{const zr=Dr[Fr];this.detectEvictedFragments(Fr,zr,Mr,Pr)})}onFragBuffered(Tr,Ar){this.detectPartialFragments(Ar)}hasFragment(Tr){const Ar=getFragmentKey(Tr);return!!this.fragments[Ar]}hasParts(Tr){var Ar;return!!((Ar=this.activePartLists[Tr])!=null&&Ar.length)}removeFragmentsInRange(Tr,Ar,Rr,Pr,Dr){Pr&&!this.hasGaps||Object.keys(this.fragments).forEach(Mr=>{const Fr=this.fragments[Mr];if(!Fr)return;const zr=Fr.body;zr.type!==Rr||Pr&&!zr.gap||zr.start<Ar&&zr.end>Tr&&(Fr.buffered||Dr)&&this.removeFragment(zr)})}removeFragment(Tr){const Ar=getFragmentKey(Tr);Tr.stats.loaded=0,Tr.clearElementaryStreamInfo();const Rr=this.activePartLists[Tr.type];if(Rr){const Pr=Tr.sn;this.activePartLists[Tr.type]=Rr.filter(Dr=>Dr.fragment.sn!==Pr)}delete this.fragments[Ar],Tr.endList&&delete this.endListFragments[Tr.type]}removeAllFragments(){this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1}}function isPartial(_r){var Tr,Ar,Rr;return _r.buffered&&(_r.body.gap||((Tr=_r.range.video)==null?void 0:Tr.partial)||((Ar=_r.range.audio)==null?void 0:Ar.partial)||((Rr=_r.range.audiovideo)==null?void 0:Rr.partial))}function getFragmentKey(_r){return`${_r.type}_${_r.level}_${_r.urlId}_${_r.sn}`}const MIN_CHUNK_SIZE=Math.pow(2,17);class FragmentLoader{constructor(Tr){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=Tr}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(Tr,Ar){const Rr=Tr.url;if(!Rr)return Promise.reject(new LoadError({type:ErrorTypes.NETWORK_ERROR,details:ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:Tr,error:new Error(`Fragment does not have a ${Rr?"part list":"url"}`),networkDetails:null}));this.abort();const Pr=this.config,Dr=Pr.fLoader,Mr=Pr.loader;return new Promise((Fr,zr)=>{if(this.loader&&this.loader.destroy(),Tr.gap)if(Tr.tagList.some(Ur=>Ur[0]==="GAP")){zr(createGapLoadError(Tr));return}else Tr.gap=!1;const jr=this.loader=Tr.loader=Dr?new Dr(Pr):new Mr(Pr),Gr=createLoaderContext(Tr),Nr=getLoaderConfigWithoutReties(Pr.fragLoadPolicy.default),Lr={loadPolicy:Nr,timeout:Nr.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:Tr.sn==="initSegment"?1/0:MIN_CHUNK_SIZE};Tr.stats=jr.stats,jr.load(Gr,Lr,{onSuccess:(Ur,Vr,Wr,qr)=>{this.resetLoader(Tr,jr);let Kr=Ur.data;Wr.resetIV&&Tr.decryptdata&&(Tr.decryptdata.iv=new Uint8Array(Kr.slice(0,16)),Kr=Kr.slice(16)),Fr({frag:Tr,part:null,payload:Kr,networkDetails:qr})},onError:(Ur,Vr,Wr,qr)=>{this.resetLoader(Tr,jr),zr(new LoadError({type:ErrorTypes.NETWORK_ERROR,details:ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:Tr,response:_objectSpread2({url:Rr,data:void 0},Ur),error:new Error(`HTTP Error ${Ur.code} ${Ur.text}`),networkDetails:Wr,stats:qr}))},onAbort:(Ur,Vr,Wr)=>{this.resetLoader(Tr,jr),zr(new LoadError({type:ErrorTypes.NETWORK_ERROR,details:ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:Tr,error:new Error("Aborted"),networkDetails:Wr,stats:Ur}))},onTimeout:(Ur,Vr,Wr)=>{this.resetLoader(Tr,jr),zr(new LoadError({type:ErrorTypes.NETWORK_ERROR,details:ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:Tr,error:new Error(`Timeout after ${Lr.timeout}ms`),networkDetails:Wr,stats:Ur}))},onProgress:(Ur,Vr,Wr,qr)=>{Ar&&Ar({frag:Tr,part:null,payload:Wr,networkDetails:qr})}})})}loadPart(Tr,Ar,Rr){this.abort();const Pr=this.config,Dr=Pr.fLoader,Mr=Pr.loader;return new Promise((Fr,zr)=>{if(this.loader&&this.loader.destroy(),Tr.gap||Ar.gap){zr(createGapLoadError(Tr,Ar));return}const jr=this.loader=Tr.loader=Dr?new Dr(Pr):new Mr(Pr),Gr=createLoaderContext(Tr,Ar),Nr=getLoaderConfigWithoutReties(Pr.fragLoadPolicy.default),Lr={loadPolicy:Nr,timeout:Nr.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:MIN_CHUNK_SIZE};Ar.stats=jr.stats,jr.load(Gr,Lr,{onSuccess:(Ur,Vr,Wr,qr)=>{this.resetLoader(Tr,jr),this.updateStatsFromPart(Tr,Ar);const Kr={frag:Tr,part:Ar,payload:Ur.data,networkDetails:qr};Rr(Kr),Fr(Kr)},onError:(Ur,Vr,Wr,qr)=>{this.resetLoader(Tr,jr),zr(new LoadError({type:ErrorTypes.NETWORK_ERROR,details:ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:Tr,part:Ar,response:_objectSpread2({url:Gr.url,data:void 0},Ur),error:new Error(`HTTP Error ${Ur.code} ${Ur.text}`),networkDetails:Wr,stats:qr}))},onAbort:(Ur,Vr,Wr)=>{Tr.stats.aborted=Ar.stats.aborted,this.resetLoader(Tr,jr),zr(new LoadError({type:ErrorTypes.NETWORK_ERROR,details:ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:Tr,part:Ar,error:new Error("Aborted"),networkDetails:Wr,stats:Ur}))},onTimeout:(Ur,Vr,Wr)=>{this.resetLoader(Tr,jr),zr(new LoadError({type:ErrorTypes.NETWORK_ERROR,details:ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:Tr,part:Ar,error:new Error(`Timeout after ${Lr.timeout}ms`),networkDetails:Wr,stats:Ur}))}})})}updateStatsFromPart(Tr,Ar){const Rr=Tr.stats,Pr=Ar.stats,Dr=Pr.total;if(Rr.loaded+=Pr.loaded,Dr){const zr=Math.round(Tr.duration/Ar.duration),jr=Math.min(Math.round(Rr.loaded/Dr),zr),Nr=(zr-jr)*Math.round(Rr.loaded/jr);Rr.total=Rr.loaded+Nr}else Rr.total=Math.max(Rr.loaded,Rr.total);const Mr=Rr.loading,Fr=Pr.loading;Mr.start?Mr.first+=Fr.first-Fr.start:(Mr.start=Fr.start,Mr.first=Fr.first),Mr.end=Fr.end}resetLoader(Tr,Ar){Tr.loader=null,this.loader===Ar&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),Ar.destroy()}}function createLoaderContext(_r,Tr=null){const Ar=Tr||_r,Rr={frag:_r,part:Tr,responseType:"arraybuffer",url:Ar.url,headers:{},rangeStart:0,rangeEnd:0},Pr=Ar.byteRangeStartOffset,Dr=Ar.byteRangeEndOffset;if(isFiniteNumber(Pr)&&isFiniteNumber(Dr)){var Mr;let Fr=Pr,zr=Dr;if(_r.sn==="initSegment"&&((Mr=_r.decryptdata)==null?void 0:Mr.method)==="AES-128"){const jr=Dr-Pr;jr%16&&(zr=Dr+(16-jr%16)),Pr!==0&&(Rr.resetIV=!0,Fr=Pr-16)}Rr.rangeStart=Fr,Rr.rangeEnd=zr}return Rr}function createGapLoadError(_r,Tr){const Ar=new Error(`GAP ${_r.gap?"tag":"attribute"} found`),Rr={type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.FRAG_GAP,fatal:!1,frag:_r,error:Ar,networkDetails:null};return Tr&&(Rr.part=Tr),(Tr||_r).stats.aborted=!0,new LoadError(Rr)}class LoadError extends Error{constructor(Tr){super(Tr.error.message),this.data=void 0,this.data=Tr}}class KeyLoader{constructor(Tr){this.config=void 0,this.keyUriToKeyInfo={},this.emeController=null,this.config=Tr}abort(Tr){for(const Ar in this.keyUriToKeyInfo){const Rr=this.keyUriToKeyInfo[Ar].loader;if(Rr){if(Tr&&Tr!==Rr.context.frag.type)return;Rr.abort()}}}detach(){for(const Tr in this.keyUriToKeyInfo){const Ar=this.keyUriToKeyInfo[Tr];(Ar.mediaKeySessionContext||Ar.decryptdata.isCommonEncryption)&&delete this.keyUriToKeyInfo[Tr]}}destroy(){this.detach();for(const Tr in this.keyUriToKeyInfo){const Ar=this.keyUriToKeyInfo[Tr].loader;Ar&&Ar.destroy()}this.keyUriToKeyInfo={}}createKeyLoadError(Tr,Ar=ErrorDetails.KEY_LOAD_ERROR,Rr,Pr,Dr){return new LoadError({type:ErrorTypes.NETWORK_ERROR,details:Ar,fatal:!1,frag:Tr,response:Dr,error:Rr,networkDetails:Pr})}loadClear(Tr,Ar){if(this.emeController&&this.config.emeEnabled){const{sn:Rr,cc:Pr}=Tr;for(let Dr=0;Dr<Ar.length;Dr++){const Mr=Ar[Dr];if(Pr<=Mr.cc&&(Rr==="initSegment"||Mr.sn==="initSegment"||Rr<Mr.sn)){this.emeController.selectKeySystemFormat(Mr).then(Fr=>{Mr.setKeyFormat(Fr)});break}}}}load(Tr){return!Tr.decryptdata&&Tr.encrypted&&this.emeController?this.emeController.selectKeySystemFormat(Tr).then(Ar=>this.loadInternal(Tr,Ar)):this.loadInternal(Tr)}loadInternal(Tr,Ar){var Rr,Pr;Ar&&Tr.setKeyFormat(Ar);const Dr=Tr.decryptdata;if(!Dr){const jr=new Error(Ar?`Expected frag.decryptdata to be defined after setting format ${Ar}`:"Missing decryption data on fragment in onKeyLoading");return Promise.reject(this.createKeyLoadError(Tr,ErrorDetails.KEY_LOAD_ERROR,jr))}const Mr=Dr.uri;if(!Mr)return Promise.reject(this.createKeyLoadError(Tr,ErrorDetails.KEY_LOAD_ERROR,new Error(`Invalid key URI: "${Mr}"`)));let Fr=this.keyUriToKeyInfo[Mr];if((Rr=Fr)!=null&&Rr.decryptdata.key)return Dr.key=Fr.decryptdata.key,Promise.resolve({frag:Tr,keyInfo:Fr});if((Pr=Fr)!=null&&Pr.keyLoadPromise){var zr;switch((zr=Fr.mediaKeySessionContext)==null?void 0:zr.keyStatus){case void 0:case"status-pending":case"usable":case"usable-in-future":return Fr.keyLoadPromise.then(jr=>(Dr.key=jr.keyInfo.decryptdata.key,{frag:Tr,keyInfo:Fr}))}}switch(Fr=this.keyUriToKeyInfo[Mr]={decryptdata:Dr,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},Dr.method){case"ISO-23001-7":case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return Dr.keyFormat==="identity"?this.loadKeyHTTP(Fr,Tr):this.loadKeyEME(Fr,Tr);case"AES-128":return this.loadKeyHTTP(Fr,Tr);default:return Promise.reject(this.createKeyLoadError(Tr,ErrorDetails.KEY_LOAD_ERROR,new Error(`Key supplied with unsupported METHOD: "${Dr.method}"`)))}}loadKeyEME(Tr,Ar){const Rr={frag:Ar,keyInfo:Tr};if(this.emeController&&this.config.emeEnabled){const Pr=this.emeController.loadKey(Rr);if(Pr)return(Tr.keyLoadPromise=Pr.then(Dr=>(Tr.mediaKeySessionContext=Dr,Rr))).catch(Dr=>{throw Tr.keyLoadPromise=null,Dr})}return Promise.resolve(Rr)}loadKeyHTTP(Tr,Ar){const Rr=this.config,Pr=Rr.loader,Dr=new Pr(Rr);return Ar.keyLoader=Tr.loader=Dr,Tr.keyLoadPromise=new Promise((Mr,Fr)=>{const zr={keyInfo:Tr,frag:Ar,responseType:"arraybuffer",url:Tr.decryptdata.uri},jr=Rr.keyLoadPolicy.default,Gr={loadPolicy:jr,timeout:jr.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},Nr={onSuccess:(Lr,Ur,Vr,Wr)=>{const{frag:qr,keyInfo:Kr,url:Xr}=Vr;if(!qr.decryptdata||Kr!==this.keyUriToKeyInfo[Xr])return Fr(this.createKeyLoadError(qr,ErrorDetails.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),Wr));Kr.decryptdata.key=qr.decryptdata.key=new Uint8Array(Lr.data),qr.keyLoader=null,Kr.loader=null,Mr({frag:qr,keyInfo:Kr})},onError:(Lr,Ur,Vr,Wr)=>{this.resetLoader(Ur),Fr(this.createKeyLoadError(Ar,ErrorDetails.KEY_LOAD_ERROR,new Error(`HTTP Error ${Lr.code} loading key ${Lr.text}`),Vr,_objectSpread2({url:zr.url,data:void 0},Lr)))},onTimeout:(Lr,Ur,Vr)=>{this.resetLoader(Ur),Fr(this.createKeyLoadError(Ar,ErrorDetails.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),Vr))},onAbort:(Lr,Ur,Vr)=>{this.resetLoader(Ur),Fr(this.createKeyLoadError(Ar,ErrorDetails.INTERNAL_ABORTED,new Error("key loading aborted"),Vr))}};Dr.load(zr,Gr,Nr)})}resetLoader(Tr){const{frag:Ar,keyInfo:Rr,url:Pr}=Tr,Dr=Rr.loader;Ar.keyLoader===Dr&&(Ar.keyLoader=null,Rr.loader=null),delete this.keyUriToKeyInfo[Pr],Dr&&Dr.destroy()}}class TaskLoop{constructor(){this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(Tr){return this._tickInterval?!1:(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,Tr),!0)}clearInterval(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1}clearNextTick(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1}tick(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}const noopBuffered={length:0,start:()=>0,end:()=>0};class BufferHelper{static isBuffered(Tr,Ar){try{if(Tr){const Rr=BufferHelper.getBuffered(Tr);for(let Pr=0;Pr<Rr.length;Pr++)if(Ar>=Rr.start(Pr)&&Ar<=Rr.end(Pr))return!0}}catch{}return!1}static bufferInfo(Tr,Ar,Rr){try{if(Tr){const Pr=BufferHelper.getBuffered(Tr),Dr=[];let Mr;for(Mr=0;Mr<Pr.length;Mr++)Dr.push({start:Pr.start(Mr),end:Pr.end(Mr)});return this.bufferedInfo(Dr,Ar,Rr)}}catch{}return{len:0,start:Ar,end:Ar,nextStart:void 0}}static bufferedInfo(Tr,Ar,Rr){Ar=Math.max(0,Ar),Tr.sort(function(jr,Gr){const Nr=jr.start-Gr.start;return Nr||Gr.end-jr.end});let Pr=[];if(Rr)for(let jr=0;jr<Tr.length;jr++){const Gr=Pr.length;if(Gr){const Nr=Pr[Gr-1].end;Tr[jr].start-Nr<Rr?Tr[jr].end>Nr&&(Pr[Gr-1].end=Tr[jr].end):Pr.push(Tr[jr])}else Pr.push(Tr[jr])}else Pr=Tr;let Dr=0,Mr,Fr=Ar,zr=Ar;for(let jr=0;jr<Pr.length;jr++){const Gr=Pr[jr].start,Nr=Pr[jr].end;if(Ar+Rr>=Gr&&Ar<Nr)Fr=Gr,zr=Nr,Dr=zr-Ar;else if(Ar+Rr<Gr){Mr=Gr;break}}return{len:Dr,start:Fr||0,end:zr||0,nextStart:Mr}}static getBuffered(Tr){try{return Tr.buffered}catch(Ar){return logger.log("failed to get media.buffered",Ar),noopBuffered}}}class ChunkMetadata{constructor(Tr,Ar,Rr,Pr=0,Dr=-1,Mr=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=getNewPerformanceTiming(),this.buffering={audio:getNewPerformanceTiming(),video:getNewPerformanceTiming(),audiovideo:getNewPerformanceTiming()},this.level=Tr,this.sn=Ar,this.id=Rr,this.size=Pr,this.part=Dr,this.partial=Mr}}function getNewPerformanceTiming(){return{start:0,executeStart:0,executeEnd:0,end:0}}function findFirstFragWithCC(_r,Tr){let Ar=null;for(let Rr=0,Pr=_r.length;Rr<Pr;Rr++){const Dr=_r[Rr];if(Dr&&Dr.cc===Tr){Ar=Dr;break}}return Ar}function shouldAlignOnDiscontinuities(_r,Tr,Ar){return!!(Tr.details&&(Ar.endCC>Ar.startCC||_r&&_r.cc<Ar.startCC))}function findDiscontinuousReferenceFrag(_r,Tr,Ar=0){const Rr=_r.fragments,Pr=Tr.fragments;if(!Pr.length||!Rr.length){logger.log("No fragments to align");return}const Dr=findFirstFragWithCC(Rr,Pr[0].cc);if(!Dr||Dr&&!Dr.startPTS){logger.log("No frag in previous level to align on");return}return Dr}function adjustFragmentStart(_r,Tr){if(_r){const Ar=_r.start+Tr;_r.start=_r.startPTS=Ar,_r.endPTS=Ar+_r.duration}}function adjustSlidingStart(_r,Tr){const Ar=Tr.fragments;for(let Rr=0,Pr=Ar.length;Rr<Pr;Rr++)adjustFragmentStart(Ar[Rr],_r);Tr.fragmentHint&&adjustFragmentStart(Tr.fragmentHint,_r),Tr.alignedSliding=!0}function alignStream(_r,Tr,Ar){Tr&&(alignDiscontinuities(_r,Ar,Tr),!Ar.alignedSliding&&Tr.details&&alignPDT(Ar,Tr.details),!Ar.alignedSliding&&Tr.details&&!Ar.skippedSegments&&adjustSliding(Tr.details,Ar))}function alignDiscontinuities(_r,Tr,Ar){if(shouldAlignOnDiscontinuities(_r,Ar,Tr)){const Rr=findDiscontinuousReferenceFrag(Ar.details,Tr);Rr&&isFiniteNumber(Rr.start)&&(logger.log(`Adjusting PTS using last level due to CC increase within current level ${Tr.url}`),adjustSlidingStart(Rr.start,Tr))}}function alignPDT(_r,Tr){if(!Tr.fragments.length||!_r.hasProgramDateTime||!Tr.hasProgramDateTime)return;const Ar=Tr.fragments[0].programDateTime,Rr=_r.fragments[0].programDateTime,Pr=(Rr-Ar)/1e3+Tr.fragments[0].start;Pr&&isFiniteNumber(Pr)&&(logger.log(`Adjusting PTS using programDateTime delta ${Rr-Ar}ms, sliding:${Pr.toFixed(3)} ${_r.url} `),adjustSlidingStart(Pr,_r))}function alignMediaPlaylistByPDT(_r,Tr){if(!_r.hasProgramDateTime||!Tr.hasProgramDateTime)return;const Ar=_r.fragments,Rr=Tr.fragments;if(!Ar.length||!Rr.length)return;const Pr=Math.round(Rr.length/2)-1,Dr=Rr[Pr],Mr=findFirstFragWithCC(Ar,Dr.cc)||Ar[Math.round(Ar.length/2)-1],Fr=Dr.programDateTime,zr=Mr.programDateTime;if(Fr===null||zr===null)return;const jr=(zr-Fr)/1e3-(Mr.start-Dr.start);adjustSlidingStart(jr,_r)}class AESCrypto{constructor(Tr,Ar){this.subtle=void 0,this.aesIV=void 0,this.subtle=Tr,this.aesIV=Ar}decrypt(Tr,Ar){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},Ar,Tr)}}class FastAESKey{constructor(Tr,Ar){this.subtle=void 0,this.key=void 0,this.subtle=Tr,this.key=Ar}expandKey(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])}}function removePadding(_r){const Tr=_r.byteLength,Ar=Tr&&new DataView(_r.buffer).getUint8(Tr-1);return Ar?sliceUint8(_r,0,Tr-Ar):_r}class AESDecryptor{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(Tr){const Ar=new DataView(Tr),Rr=new Uint32Array(4);for(let Pr=0;Pr<4;Pr++)Rr[Pr]=Ar.getUint32(Pr*4);return Rr}initTable(){const Tr=this.sBox,Ar=this.invSBox,Rr=this.subMix,Pr=Rr[0],Dr=Rr[1],Mr=Rr[2],Fr=Rr[3],zr=this.invSubMix,jr=zr[0],Gr=zr[1],Nr=zr[2],Lr=zr[3],Ur=new Uint32Array(256);let Vr=0,Wr=0,qr=0;for(qr=0;qr<256;qr++)qr<128?Ur[qr]=qr<<1:Ur[qr]=qr<<1^283;for(qr=0;qr<256;qr++){let Kr=Wr^Wr<<1^Wr<<2^Wr<<3^Wr<<4;Kr=Kr>>>8^Kr&255^99,Tr[Vr]=Kr,Ar[Kr]=Vr;const Xr=Ur[Vr],Zr=Ur[Xr],_i=Ur[Zr];let Jr=Ur[Kr]*257^Kr*16843008;Pr[Vr]=Jr<<24|Jr>>>8,Dr[Vr]=Jr<<16|Jr>>>16,Mr[Vr]=Jr<<8|Jr>>>24,Fr[Vr]=Jr,Jr=_i*16843009^Zr*65537^Xr*257^Vr*16843008,jr[Kr]=Jr<<24|Jr>>>8,Gr[Kr]=Jr<<16|Jr>>>16,Nr[Kr]=Jr<<8|Jr>>>24,Lr[Kr]=Jr,Vr?(Vr=Xr^Ur[Ur[Ur[_i^Xr]]],Wr^=Ur[Ur[Wr]]):Vr=Wr=1}}expandKey(Tr){const Ar=this.uint8ArrayToUint32Array_(Tr);let Rr=!0,Pr=0;for(;Pr<Ar.length&&Rr;)Rr=Ar[Pr]===this.key[Pr],Pr++;if(Rr)return;this.key=Ar;const Dr=this.keySize=Ar.length;if(Dr!==4&&Dr!==6&&Dr!==8)throw new Error("Invalid aes key size="+Dr);const Mr=this.ksRows=(Dr+6+1)*4;let Fr,zr;const jr=this.keySchedule=new Uint32Array(Mr),Gr=this.invKeySchedule=new Uint32Array(Mr),Nr=this.sBox,Lr=this.rcon,Ur=this.invSubMix,Vr=Ur[0],Wr=Ur[1],qr=Ur[2],Kr=Ur[3];let Xr,Zr;for(Fr=0;Fr<Mr;Fr++){if(Fr<Dr){Xr=jr[Fr]=Ar[Fr];continue}Zr=Xr,Fr%Dr===0?(Zr=Zr<<8|Zr>>>24,Zr=Nr[Zr>>>24]<<24|Nr[Zr>>>16&255]<<16|Nr[Zr>>>8&255]<<8|Nr[Zr&255],Zr^=Lr[Fr/Dr|0]<<24):Dr>6&&Fr%Dr===4&&(Zr=Nr[Zr>>>24]<<24|Nr[Zr>>>16&255]<<16|Nr[Zr>>>8&255]<<8|Nr[Zr&255]),jr[Fr]=Xr=(jr[Fr-Dr]^Zr)>>>0}for(zr=0;zr<Mr;zr++)Fr=Mr-zr,zr&3?Zr=jr[Fr]:Zr=jr[Fr-4],zr<4||Fr<=4?Gr[zr]=Zr:Gr[zr]=Vr[Nr[Zr>>>24]]^Wr[Nr[Zr>>>16&255]]^qr[Nr[Zr>>>8&255]]^Kr[Nr[Zr&255]],Gr[zr]=Gr[zr]>>>0}networkToHostOrderSwap(Tr){return Tr<<24|(Tr&65280)<<8|(Tr&16711680)>>8|Tr>>>24}decrypt(Tr,Ar,Rr){const Pr=this.keySize+6,Dr=this.invKeySchedule,Mr=this.invSBox,Fr=this.invSubMix,zr=Fr[0],jr=Fr[1],Gr=Fr[2],Nr=Fr[3],Lr=this.uint8ArrayToUint32Array_(Rr);let Ur=Lr[0],Vr=Lr[1],Wr=Lr[2],qr=Lr[3];const Kr=new Int32Array(Tr),Xr=new Int32Array(Kr.length);let Zr,_i,Jr,es,ts,is,rs,as,ls,fs,Ts,$s,xs,ys;const ps=this.networkToHostOrderSwap;for(;Ar<Kr.length;){for(ls=ps(Kr[Ar]),fs=ps(Kr[Ar+1]),Ts=ps(Kr[Ar+2]),$s=ps(Kr[Ar+3]),ts=ls^Dr[0],is=$s^Dr[1],rs=Ts^Dr[2],as=fs^Dr[3],xs=4,ys=1;ys<Pr;ys++)Zr=zr[ts>>>24]^jr[is>>16&255]^Gr[rs>>8&255]^Nr[as&255]^Dr[xs],_i=zr[is>>>24]^jr[rs>>16&255]^Gr[as>>8&255]^Nr[ts&255]^Dr[xs+1],Jr=zr[rs>>>24]^jr[as>>16&255]^Gr[ts>>8&255]^Nr[is&255]^Dr[xs+2],es=zr[as>>>24]^jr[ts>>16&255]^Gr[is>>8&255]^Nr[rs&255]^Dr[xs+3],ts=Zr,is=_i,rs=Jr,as=es,xs=xs+4;Zr=Mr[ts>>>24]<<24^Mr[is>>16&255]<<16^Mr[rs>>8&255]<<8^Mr[as&255]^Dr[xs],_i=Mr[is>>>24]<<24^Mr[rs>>16&255]<<16^Mr[as>>8&255]<<8^Mr[ts&255]^Dr[xs+1],Jr=Mr[rs>>>24]<<24^Mr[as>>16&255]<<16^Mr[ts>>8&255]<<8^Mr[is&255]^Dr[xs+2],es=Mr[as>>>24]<<24^Mr[ts>>16&255]<<16^Mr[is>>8&255]<<8^Mr[rs&255]^Dr[xs+3],Xr[Ar]=ps(Zr^Ur),Xr[Ar+1]=ps(es^Vr),Xr[Ar+2]=ps(Jr^Wr),Xr[Ar+3]=ps(_i^qr),Ur=ls,Vr=fs,Wr=Ts,qr=$s,Ar=Ar+4}return Xr.buffer}}const CHUNK_SIZE=16;class Decrypter{constructor(Tr,{removePKCS7Padding:Ar=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.useSoftware=Tr.enableSoftwareAES,this.removePKCS7Padding=Ar,Ar)try{const Rr=self.crypto;Rr&&(this.subtle=Rr.subtle||Rr.webkitSubtle)}catch{}this.subtle===null&&(this.useSoftware=!0)}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){const{currentResult:Tr,remainderData:Ar}=this;if(!Tr||Ar)return this.reset(),null;const Rr=new Uint8Array(Tr);return this.reset(),this.removePKCS7Padding?removePadding(Rr):Rr}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(Tr,Ar,Rr){return this.useSoftware?new Promise((Pr,Dr)=>{this.softwareDecrypt(new Uint8Array(Tr),Ar,Rr);const Mr=this.flush();Mr?Pr(Mr.buffer):Dr(new Error("[softwareDecrypt] Failed to decrypt data"))}):this.webCryptoDecrypt(new Uint8Array(Tr),Ar,Rr)}softwareDecrypt(Tr,Ar,Rr){const{currentIV:Pr,currentResult:Dr,remainderData:Mr}=this;this.logOnce("JS AES decrypt"),Mr&&(Tr=appendUint8Array(Mr,Tr),this.remainderData=null);const Fr=this.getValidChunk(Tr);if(!Fr.length)return null;Pr&&(Rr=Pr);let zr=this.softwareDecrypter;zr||(zr=this.softwareDecrypter=new AESDecryptor),zr.expandKey(Ar);const jr=Dr;return this.currentResult=zr.decrypt(Fr.buffer,0,Rr),this.currentIV=sliceUint8(Fr,-16).buffer,jr||null}webCryptoDecrypt(Tr,Ar,Rr){const Pr=this.subtle;return(this.key!==Ar||!this.fastAesKey)&&(this.key=Ar,this.fastAesKey=new FastAESKey(Pr,Ar)),this.fastAesKey.expandKey().then(Dr=>Pr?(this.logOnce("WebCrypto AES decrypt"),new AESCrypto(Pr,new Uint8Array(Rr)).decrypt(Tr.buffer,Dr)):Promise.reject(new Error("web crypto not initialized"))).catch(Dr=>(logger.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${Dr.name}: ${Dr.message}`),this.onWebCryptoError(Tr,Ar,Rr)))}onWebCryptoError(Tr,Ar,Rr){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(Tr,Ar,Rr);const Pr=this.flush();if(Pr)return Pr.buffer;throw new Error("WebCrypto and softwareDecrypt: failed to decrypt data")}getValidChunk(Tr){let Ar=Tr;const Rr=Tr.length-Tr.length%CHUNK_SIZE;return Rr!==Tr.length&&(Ar=sliceUint8(Tr,0,Rr),this.remainderData=sliceUint8(Tr,Rr)),Ar}logOnce(Tr){this.logEnabled&&(logger.log(`[decrypter]: ${Tr}`),this.logEnabled=!1)}}const TimeRanges={toString:function(_r){let Tr="";const Ar=_r.length;for(let Rr=0;Rr<Ar;Rr++)Tr+=`[${_r.start(Rr).toFixed(3)}-${_r.end(Rr).toFixed(3)}]`;return Tr}},State={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"};class BaseStreamController extends TaskLoop{constructor(Tr,Ar,Rr,Pr,Dr){super(),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=State.STOPPED,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.loadedmetadata=!1,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.onvseeking=null,this.onvended=null,this.logPrefix="",this.log=void 0,this.warn=void 0,this.playlistType=Dr,this.logPrefix=Pr,this.log=logger.log.bind(logger,`${Pr}:`),this.warn=logger.warn.bind(logger,`${Pr}:`),this.hls=Tr,this.fragmentLoader=new FragmentLoader(Tr.config),this.keyLoader=Rr,this.fragmentTracker=Ar,this.config=Tr.config,this.decrypter=new Decrypter(Tr.config),Tr.on(Events.MANIFEST_LOADED,this.onManifestLoaded,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(Tr){}stopLoad(){this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);const Tr=this.fragCurrent;Tr!=null&&Tr.loader&&(Tr.abortRequests(),this.fragmentTracker.removeFragment(Tr)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=State.STOPPED}_streamEnded(Tr,Ar){if(Ar.live||Tr.nextStart||!Tr.end||!this.media)return!1;const Rr=Ar.partList;if(Rr!=null&&Rr.length){const Dr=Rr[Rr.length-1];return BufferHelper.isBuffered(this.media,Dr.start+Dr.duration/2)}const Pr=Ar.fragments[Ar.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(Pr)}getLevelDetails(){if(this.levels&&this.levelLastLoaded!==null){var Tr;return(Tr=this.levels[this.levelLastLoaded])==null?void 0:Tr.details}}onMediaAttached(Tr,Ar){const Rr=this.media=this.mediaBuffer=Ar.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),Rr.addEventListener("seeking",this.onvseeking),Rr.addEventListener("ended",this.onvended);const Pr=this.config;this.levels&&Pr.autoStartLoad&&this.state===State.STOPPED&&this.startLoad(Pr.startPosition)}onMediaDetaching(){const Tr=this.media;Tr!=null&&Tr.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),Tr&&this.onvseeking&&this.onvended&&(Tr.removeEventListener("seeking",this.onvseeking),Tr.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null),this.keyLoader&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}onMediaSeeking(){const{config:Tr,fragCurrent:Ar,media:Rr,mediaBuffer:Pr,state:Dr}=this,Mr=Rr?Rr.currentTime:0,Fr=BufferHelper.bufferInfo(Pr||Rr,Mr,Tr.maxBufferHole);if(this.log(`media seeking to ${isFiniteNumber(Mr)?Mr.toFixed(3):Mr}, state: ${Dr}`),this.state===State.ENDED)this.resetLoadingState();else if(Ar){const zr=Tr.maxFragLookUpTolerance,jr=Ar.start-zr,Gr=Ar.start+Ar.duration+zr;if(!Fr.len||Gr<Fr.start||jr>Fr.end){const Nr=Mr>Gr;(Mr<jr||Nr)&&(Nr&&Ar.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),Ar.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}Rr&&(this.fragmentTracker.removeFragmentsInRange(Mr,1/0,this.playlistType,!0),this.lastCurrentTime=Mr),!this.loadedmetadata&&!Fr.len&&(this.nextLoadPosition=this.startPosition=Mr),this.tickImmediate()}onMediaEnded(){this.startPosition=this.lastCurrentTime=0}onManifestLoaded(Tr,Ar){this.startTimeOffset=Ar.startTimeOffset,this.initPTS=[]}onHandlerDestroying(){this.stopLoad(),super.onHandlerDestroying()}onHandlerDestroyed(){this.state=State.STOPPED,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(Tr,Ar,Rr){this._loadFragForPlayback(Tr,Ar,Rr)}_loadFragForPlayback(Tr,Ar,Rr){const Pr=Dr=>{if(this.fragContextChanged(Tr)){this.warn(`Fragment ${Tr.sn}${Dr.part?" p: "+Dr.part.index:""} of level ${Tr.level} was dropped during download.`),this.fragmentTracker.removeFragment(Tr);return}Tr.stats.chunkCount++,this._handleFragmentLoadProgress(Dr)};this._doFragLoad(Tr,Ar,Rr,Pr).then(Dr=>{if(!Dr)return;const Mr=this.state;if(this.fragContextChanged(Tr)){(Mr===State.FRAG_LOADING||!this.fragCurrent&&Mr===State.PARSING)&&(this.fragmentTracker.removeFragment(Tr),this.state=State.IDLE);return}"payload"in Dr&&(this.log(`Loaded fragment ${Tr.sn} of level ${Tr.level}`),this.hls.trigger(Events.FRAG_LOADED,Dr)),this._handleFragmentLoadComplete(Dr)}).catch(Dr=>{this.state===State.STOPPED||this.state===State.ERROR||(this.warn(Dr),this.resetFragmentLoading(Tr))})}clearTrackerIfNeeded(Tr){var Ar;const{fragmentTracker:Rr}=this;if(Rr.getState(Tr)===FragmentState.APPENDING){const Dr=Tr.type,Mr=this.getFwdBufferInfo(this.mediaBuffer,Dr),Fr=Math.max(Tr.duration,Mr?Mr.len:this.config.maxBufferLength);this.reduceMaxBufferLength(Fr)&&Rr.removeFragment(Tr)}else((Ar=this.mediaBuffer)==null?void 0:Ar.buffered.length)===0?Rr.removeAllFragments():Rr.hasParts(Tr.type)&&(Rr.detectPartialFragments({frag:Tr,part:null,stats:Tr.stats,id:Tr.type}),Rr.getState(Tr)===FragmentState.PARTIAL&&Rr.removeFragment(Tr))}checkLiveUpdate(Tr){if(Tr.updated&&!Tr.live){const Ar=Tr.fragments[Tr.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:Ar,part:null,stats:Ar.stats,id:Ar.type})}Tr.fragments[0]||(Tr.deltaUpdateFailed=!0)}flushMainBuffer(Tr,Ar,Rr=null){if(!(Tr-Ar))return;const Pr={startOffset:Tr,endOffset:Ar,type:Rr};this.hls.trigger(Events.BUFFER_FLUSHING,Pr)}_loadInitSegment(Tr,Ar){this._doFragLoad(Tr,Ar).then(Rr=>{if(!Rr||this.fragContextChanged(Tr)||!this.levels)throw new Error("init load aborted");return Rr}).then(Rr=>{const{hls:Pr}=this,{payload:Dr}=Rr,Mr=Tr.decryptdata;if(Dr&&Dr.byteLength>0&&Mr&&Mr.key&&Mr.iv&&Mr.method==="AES-128"){const Fr=self.performance.now();return this.decrypter.decrypt(new Uint8Array(Dr),Mr.key.buffer,Mr.iv.buffer).catch(zr=>{throw Pr.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.FRAG_DECRYPT_ERROR,fatal:!1,error:zr,reason:zr.message,frag:Tr}),zr}).then(zr=>{const jr=self.performance.now();return Pr.trigger(Events.FRAG_DECRYPTED,{frag:Tr,payload:zr,stats:{tstart:Fr,tdecrypt:jr}}),Rr.payload=zr,Rr})}return Rr}).then(Rr=>{const{fragCurrent:Pr,hls:Dr,levels:Mr}=this;if(!Mr)throw new Error("init load aborted, missing levels");const Fr=Tr.stats;this.state=State.IDLE,Ar.fragmentError=0,Tr.data=new Uint8Array(Rr.payload),Fr.parsing.start=Fr.buffering.start=self.performance.now(),Fr.parsing.end=Fr.buffering.end=self.performance.now(),Rr.frag===Pr&&Dr.trigger(Events.FRAG_BUFFERED,{stats:Fr,frag:Pr,part:null,id:Tr.type}),this.tick()}).catch(Rr=>{this.state===State.STOPPED||this.state===State.ERROR||(this.warn(Rr),this.resetFragmentLoading(Tr))})}fragContextChanged(Tr){const{fragCurrent:Ar}=this;return!Tr||!Ar||Tr.level!==Ar.level||Tr.sn!==Ar.sn||Tr.urlId!==Ar.urlId}fragBufferedComplete(Tr,Ar){var Rr,Pr,Dr,Mr;const Fr=this.mediaBuffer?this.mediaBuffer:this.media;this.log(`Buffered ${Tr.type} sn: ${Tr.sn}${Ar?" part: "+Ar.index:""} of ${this.playlistType===PlaylistLevelType.MAIN?"level":"track"} ${Tr.level} (frag:[${((Rr=Tr.startPTS)!=null?Rr:NaN).toFixed(3)}-${((Pr=Tr.endPTS)!=null?Pr:NaN).toFixed(3)}] > buffer:${Fr?TimeRanges.toString(BufferHelper.getBuffered(Fr)):"(detached)"})`),this.state=State.IDLE,Fr&&(!this.loadedmetadata&&Tr.type==PlaylistLevelType.MAIN&&Fr.buffered.length&&((Dr=this.fragCurrent)==null?void 0:Dr.sn)===((Mr=this.fragPrevious)==null?void 0:Mr.sn)&&(this.loadedmetadata=!0,this.seekToStartPos()),this.tick())}seekToStartPos(){}_handleFragmentLoadComplete(Tr){const{transmuxer:Ar}=this;if(!Ar)return;const{frag:Rr,part:Pr,partsLoaded:Dr}=Tr,Mr=!Dr||Dr.length===0||Dr.some(zr=>!zr),Fr=new ChunkMetadata(Rr.level,Rr.sn,Rr.stats.chunkCount+1,0,Pr?Pr.index:-1,!Mr);Ar.flush(Fr)}_handleFragmentLoadProgress(Tr){}_doFragLoad(Tr,Ar,Rr=null,Pr){var Dr;const Mr=Ar==null?void 0:Ar.details;if(!this.levels||!Mr)throw new Error(`frag load aborted, missing level${Mr?"":" detail"}s`);let Fr=null;if(Tr.encrypted&&!((Dr=Tr.decryptdata)!=null&&Dr.key)?(this.log(`Loading key for ${Tr.sn} of [${Mr.startSN}-${Mr.endSN}], ${this.logPrefix==="[stream-controller]"?"level":"track"} ${Tr.level}`),this.state=State.KEY_LOADING,this.fragCurrent=Tr,Fr=this.keyLoader.load(Tr).then(Gr=>{if(!this.fragContextChanged(Gr.frag))return this.hls.trigger(Events.KEY_LOADED,Gr),this.state===State.KEY_LOADING&&(this.state=State.IDLE),Gr}),this.hls.trigger(Events.KEY_LOADING,{frag:Tr}),this.fragCurrent===null&&(Fr=Promise.reject(new Error("frag load aborted, context changed in KEY_LOADING")))):!Tr.encrypted&&Mr.encryptedFragments.length&&this.keyLoader.loadClear(Tr,Mr.encryptedFragments),Rr=Math.max(Tr.start,Rr||0),this.config.lowLatencyMode&&Tr.sn!=="initSegment"){const Gr=Mr.partList;if(Gr&&Pr){Rr>Tr.end&&Mr.fragmentHint&&(Tr=Mr.fragmentHint);const Nr=this.getNextPart(Gr,Tr,Rr);if(Nr>-1){const Lr=Gr[Nr];this.log(`Loading part sn: ${Tr.sn} p: ${Lr.index} cc: ${Tr.cc} of playlist [${Mr.startSN}-${Mr.endSN}] parts [0-${Nr}-${Gr.length-1}] ${this.logPrefix==="[stream-controller]"?"level":"track"}: ${Tr.level}, target: ${parseFloat(Rr.toFixed(3))}`),this.nextLoadPosition=Lr.start+Lr.duration,this.state=State.FRAG_LOADING;let Ur;return Fr?Ur=Fr.then(Vr=>!Vr||this.fragContextChanged(Vr.frag)?null:this.doFragPartsLoad(Tr,Lr,Ar,Pr)).catch(Vr=>this.handleFragLoadError(Vr)):Ur=this.doFragPartsLoad(Tr,Lr,Ar,Pr).catch(Vr=>this.handleFragLoadError(Vr)),this.hls.trigger(Events.FRAG_LOADING,{frag:Tr,part:Lr,targetBufferTime:Rr}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):Ur}else if(!Tr.url||this.loadedEndOfParts(Gr,Rr))return Promise.resolve(null)}}this.log(`Loading fragment ${Tr.sn} cc: ${Tr.cc} ${Mr?"of ["+Mr.startSN+"-"+Mr.endSN+"] ":""}${this.logPrefix==="[stream-controller]"?"level":"track"}: ${Tr.level}, target: ${parseFloat(Rr.toFixed(3))}`),isFiniteNumber(Tr.sn)&&!this.bitrateTest&&(this.nextLoadPosition=Tr.start+Tr.duration),this.state=State.FRAG_LOADING;const zr=this.config.progressive;let jr;return zr&&Fr?jr=Fr.then(Gr=>!Gr||this.fragContextChanged(Gr==null?void 0:Gr.frag)?null:this.fragmentLoader.load(Tr,Pr)).catch(Gr=>this.handleFragLoadError(Gr)):jr=Promise.all([this.fragmentLoader.load(Tr,zr?Pr:void 0),Fr]).then(([Gr])=>(!zr&&Gr&&Pr&&Pr(Gr),Gr)).catch(Gr=>this.handleFragLoadError(Gr)),this.hls.trigger(Events.FRAG_LOADING,{frag:Tr,targetBufferTime:Rr}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):jr}doFragPartsLoad(Tr,Ar,Rr,Pr){return new Promise((Dr,Mr)=>{var Fr;const zr=[],jr=(Fr=Rr.details)==null?void 0:Fr.partList,Gr=Nr=>{this.fragmentLoader.loadPart(Tr,Nr,Pr).then(Lr=>{zr[Nr.index]=Lr;const Ur=Lr.part;this.hls.trigger(Events.FRAG_LOADED,Lr);const Vr=getPartWith(Rr,Tr.sn,Nr.index+1)||findPart(jr,Tr.sn,Nr.index+1);if(Vr)Gr(Vr);else return Dr({frag:Tr,part:Ur,partsLoaded:zr})}).catch(Mr)};Gr(Ar)})}handleFragLoadError(Tr){if("data"in Tr){const Ar=Tr.data;Tr.data&&Ar.details===ErrorDetails.INTERNAL_ABORTED?this.handleFragLoadAborted(Ar.frag,Ar.part):this.hls.trigger(Events.ERROR,Ar)}else this.hls.trigger(Events.ERROR,{type:ErrorTypes.OTHER_ERROR,details:ErrorDetails.INTERNAL_EXCEPTION,err:Tr,error:Tr,fatal:!0});return null}_handleTransmuxerFlush(Tr){const Ar=this.getCurrentContext(Tr);if(!Ar||this.state!==State.PARSING){!this.fragCurrent&&this.state!==State.STOPPED&&this.state!==State.ERROR&&(this.state=State.IDLE);return}const{frag:Rr,part:Pr,level:Dr}=Ar,Mr=self.performance.now();Rr.stats.parsing.end=Mr,Pr&&(Pr.stats.parsing.end=Mr),this.updateLevelTiming(Rr,Pr,Dr,Tr.partial)}getCurrentContext(Tr){const{levels:Ar,fragCurrent:Rr}=this,{level:Pr,sn:Dr,part:Mr}=Tr;if(!(Ar!=null&&Ar[Pr]))return this.warn(`Levels object was unset while buffering fragment ${Dr} of level ${Pr}. The current chunk will not be buffered.`),null;const Fr=Ar[Pr],zr=Mr>-1?getPartWith(Fr,Dr,Mr):null,jr=zr?zr.fragment:getFragmentWithSN(Fr,Dr,Rr);return jr?(Rr&&Rr!==jr&&(jr.stats=Rr.stats),{frag:jr,part:zr,level:Fr}):null}bufferFragmentData(Tr,Ar,Rr,Pr,Dr){var Mr;if(!Tr||this.state!==State.PARSING)return;const{data1:Fr,data2:zr}=Tr;let jr=Fr;if(Fr&&zr&&(jr=appendUint8Array(Fr,zr)),!((Mr=jr)!=null&&Mr.length))return;const Gr={type:Tr.type,frag:Ar,part:Rr,chunkMeta:Pr,parent:Ar.type,data:jr};if(this.hls.trigger(Events.BUFFER_APPENDING,Gr),Tr.dropped&&Tr.independent&&!Rr){if(Dr)return;this.flushBufferGap(Ar)}}flushBufferGap(Tr){const Ar=this.media;if(!Ar)return;if(!BufferHelper.isBuffered(Ar,Ar.currentTime)){this.flushMainBuffer(0,Tr.start);return}const Rr=Ar.currentTime,Pr=BufferHelper.bufferInfo(Ar,Rr,0),Dr=Tr.duration,Mr=Math.min(this.config.maxFragLookUpTolerance*2,Dr*.25),Fr=Math.max(Math.min(Tr.start-Mr,Pr.end-Mr),Rr+Mr);Tr.start-Fr>Mr&&this.flushMainBuffer(Fr,Tr.start)}getFwdBufferInfo(Tr,Ar){const Rr=this.getLoadPosition();return isFiniteNumber(Rr)?this.getFwdBufferInfoAtPos(Tr,Rr,Ar):null}getFwdBufferInfoAtPos(Tr,Ar,Rr){const{config:{maxBufferHole:Pr}}=this,Dr=BufferHelper.bufferInfo(Tr,Ar,Pr);if(Dr.len===0&&Dr.nextStart!==void 0){const Mr=this.fragmentTracker.getBufferedFrag(Ar,Rr);if(Mr&&Dr.nextStart<Mr.end)return BufferHelper.bufferInfo(Tr,Ar,Math.max(Dr.nextStart,Pr))}return Dr}getMaxBufferLength(Tr){const{config:Ar}=this;let Rr;return Tr?Rr=Math.max(8*Ar.maxBufferSize/Tr,Ar.maxBufferLength):Rr=Ar.maxBufferLength,Math.min(Rr,Ar.maxMaxBufferLength)}reduceMaxBufferLength(Tr){const Ar=this.config,Rr=Tr||Ar.maxBufferLength;return Ar.maxMaxBufferLength>=Rr?(Ar.maxMaxBufferLength/=2,this.warn(`Reduce max buffer length to ${Ar.maxMaxBufferLength}s`),!0):!1}getAppendedFrag(Tr,Ar=PlaylistLevelType.MAIN){const Rr=this.fragmentTracker.getAppendedFrag(Tr,PlaylistLevelType.MAIN);return Rr&&"fragment"in Rr?Rr.fragment:Rr}getNextFragment(Tr,Ar){const Rr=Ar.fragments,Pr=Rr.length;if(!Pr)return null;const{config:Dr}=this,Mr=Rr[0].start;let Fr;if(Ar.live){const zr=Dr.initialLiveManifestSize;if(Pr<zr)return this.warn(`Not enough fragments to start playback (have: ${Pr}, need: ${zr})`),null;!Ar.PTSKnown&&!this.startFragRequested&&this.startPosition===-1&&(Fr=this.getInitialLiveFragment(Ar,Rr),this.startPosition=Fr?this.hls.liveSyncPosition||Fr.start:Tr)}else Tr<=Mr&&(Fr=Rr[0]);if(!Fr){const zr=Dr.lowLatencyMode?Ar.partEnd:Ar.fragmentEnd;Fr=this.getFragmentAtPosition(Tr,zr,Ar)}return this.mapToInitFragWhenRequired(Fr)}isLoopLoading(Tr,Ar){const Rr=this.fragmentTracker.getState(Tr);return(Rr===FragmentState.OK||Rr===FragmentState.PARTIAL&&!!Tr.gap)&&this.nextLoadPosition>Ar}getNextFragmentLoopLoading(Tr,Ar,Rr,Pr,Dr){const Mr=Tr.gap,Fr=this.getNextFragment(this.nextLoadPosition,Ar);if(Fr===null)return Fr;if(Tr=Fr,Mr&&Tr&&!Tr.gap&&Rr.nextStart){const zr=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,Rr.nextStart,Pr);if(zr!==null&&Rr.len+zr.len>=Dr)return this.log(`buffer full after gaps in "${Pr}" playlist starting at sn: ${Tr.sn}`),null}return Tr}mapToInitFragWhenRequired(Tr){return Tr!=null&&Tr.initSegment&&!(Tr!=null&&Tr.initSegment.data)&&!this.bitrateTest?Tr.initSegment:Tr}getNextPart(Tr,Ar,Rr){let Pr=-1,Dr=!1,Mr=!0;for(let Fr=0,zr=Tr.length;Fr<zr;Fr++){const jr=Tr[Fr];if(Mr=Mr&&!jr.independent,Pr>-1&&Rr<jr.start)break;const Gr=jr.loaded;Gr?Pr=-1:(Dr||jr.independent||Mr)&&jr.fragment===Ar&&(Pr=Fr),Dr=Gr}return Pr}loadedEndOfParts(Tr,Ar){const Rr=Tr[Tr.length-1];return Rr&&Ar>Rr.start&&Rr.loaded}getInitialLiveFragment(Tr,Ar){const Rr=this.fragPrevious;let Pr=null;if(Rr){if(Tr.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${Rr.programDateTime}`),Pr=findFragmentByPDT(Ar,Rr.endProgramDateTime,this.config.maxFragLookUpTolerance)),!Pr){const Dr=Rr.sn+1;if(Dr>=Tr.startSN&&Dr<=Tr.endSN){const Mr=Ar[Dr-Tr.startSN];Rr.cc===Mr.cc&&(Pr=Mr,this.log(`Live playlist, switching playlist, load frag with next SN: ${Pr.sn}`))}Pr||(Pr=findFragWithCC(Ar,Rr.cc),Pr&&this.log(`Live playlist, switching playlist, load frag with same CC: ${Pr.sn}`))}}else{const Dr=this.hls.liveSyncPosition;Dr!==null&&(Pr=this.getFragmentAtPosition(Dr,this.bitrateTest?Tr.fragmentEnd:Tr.edge,Tr))}return Pr}getFragmentAtPosition(Tr,Ar,Rr){const{config:Pr}=this;let{fragPrevious:Dr}=this,{fragments:Mr,endSN:Fr}=Rr;const{fragmentHint:zr}=Rr,jr=Pr.maxFragLookUpTolerance,Gr=Rr.partList,Nr=!!(Pr.lowLatencyMode&&Gr!=null&&Gr.length&&zr);Nr&&zr&&!this.bitrateTest&&(Mr=Mr.concat(zr),Fr=zr.sn);let Lr;if(Tr<Ar){const Ur=Tr>Ar-jr?0:jr;Lr=findFragmentByPTS(Dr,Mr,Tr,Ur)}else Lr=Mr[Mr.length-1];if(Lr){const Ur=Lr.sn-Rr.startSN,Vr=this.fragmentTracker.getState(Lr);if((Vr===FragmentState.OK||Vr===FragmentState.PARTIAL&&Lr.gap)&&(Dr=Lr),Dr&&Lr.sn===Dr.sn&&(!Nr||Gr[0].fragment.sn>Lr.sn)&&Dr&&Lr.level===Dr.level){const qr=Mr[Ur+1];Lr.sn<Fr&&this.fragmentTracker.getState(qr)!==FragmentState.OK?Lr=qr:Lr=null}}return Lr}synchronizeToLiveEdge(Tr){const{config:Ar,media:Rr}=this;if(!Rr)return;const Pr=this.hls.liveSyncPosition,Dr=Rr.currentTime,Mr=Tr.fragments[0].start,Fr=Tr.edge,zr=Dr>=Mr-Ar.maxFragLookUpTolerance&&Dr<=Fr;if(Pr!==null&&Rr.duration>Pr&&(Dr<Pr||!zr)){const jr=Ar.liveMaxLatencyDuration!==void 0?Ar.liveMaxLatencyDuration:Ar.liveMaxLatencyDurationCount*Tr.targetduration;(!zr&&Rr.readyState<4||Dr<Fr-jr)&&(this.loadedmetadata||(this.nextLoadPosition=Pr),Rr.readyState&&(this.warn(`Playback: ${Dr.toFixed(3)} is located too far from the end of live sliding playlist: ${Fr}, reset currentTime to : ${Pr.toFixed(3)}`),Rr.currentTime=Pr))}}alignPlaylists(Tr,Ar){const{levels:Rr,levelLastLoaded:Pr,fragPrevious:Dr}=this,Mr=Pr!==null?Rr[Pr]:null,Fr=Tr.fragments.length;if(!Fr)return this.warn("No fragments in live playlist"),0;const zr=Tr.fragments[0].start,jr=!Ar,Gr=Tr.alignedSliding&&isFiniteNumber(zr);if(jr||!Gr&&!zr){alignStream(Dr,Mr,Tr);const Nr=Tr.fragments[0].start;return this.log(`Live playlist sliding: ${Nr.toFixed(2)} start-sn: ${Ar?Ar.startSN:"na"}->${Tr.startSN} prev-sn: ${Dr?Dr.sn:"na"} fragments: ${Fr}`),Nr}return zr}waitForCdnTuneIn(Tr){return Tr.live&&Tr.canBlockReload&&Tr.partTarget&&Tr.tuneInGoal>Math.max(Tr.partHoldBack,Tr.partTarget*3)}setStartPosition(Tr,Ar){let Rr=this.startPosition;if(Rr<Ar&&(Rr=-1),Rr===-1||this.lastCurrentTime===-1){const Pr=this.startTimeOffset!==null,Dr=Pr?this.startTimeOffset:Tr.startTimeOffset;Dr!==null&&isFiniteNumber(Dr)?(Rr=Ar+Dr,Dr<0&&(Rr+=Tr.totalduration),Rr=Math.min(Math.max(Ar,Rr),Ar+Tr.totalduration),this.log(`Start time offset ${Dr} found in ${Pr?"multivariant":"media"} playlist, adjust startPosition to ${Rr}`),this.startPosition=Rr):Tr.live?Rr=this.hls.liveSyncPosition||Ar:this.startPosition=Rr=0,this.lastCurrentTime=Rr}this.nextLoadPosition=Rr}getLoadPosition(){const{media:Tr}=this;let Ar=0;return this.loadedmetadata&&Tr?Ar=Tr.currentTime:this.nextLoadPosition&&(Ar=this.nextLoadPosition),Ar}handleFragLoadAborted(Tr,Ar){this.transmuxer&&Tr.sn!=="initSegment"&&Tr.stats.aborted&&(this.warn(`Fragment ${Tr.sn}${Ar?" part "+Ar.index:""} of level ${Tr.level} was aborted`),this.resetFragmentLoading(Tr))}resetFragmentLoading(Tr){(!this.fragCurrent||!this.fragContextChanged(Tr)&&this.state!==State.FRAG_LOADING_WAITING_RETRY)&&(this.state=State.IDLE)}onFragmentOrKeyLoadError(Tr,Ar){if(Ar.chunkMeta&&!Ar.frag){const Nr=this.getCurrentContext(Ar.chunkMeta);Nr&&(Ar.frag=Nr.frag)}const Rr=Ar.frag;if(!Rr||Rr.type!==Tr||!this.levels)return;if(this.fragContextChanged(Rr)){var Pr;this.warn(`Frag load error must match current frag to retry ${Rr.url} > ${(Pr=this.fragCurrent)==null?void 0:Pr.url}`);return}const Dr=Ar.details===ErrorDetails.FRAG_GAP;Dr&&this.fragmentTracker.fragBuffered(Rr,!0);const Mr=Ar.errorAction,{action:Fr,retryCount:zr=0,retryConfig:jr}=Mr||{};if(Mr&&Fr===NetworkErrorAction.RetryRequest&&jr){var Gr;this.resetStartWhenNotLoaded((Gr=this.levelLastLoaded)!=null?Gr:Rr.level);const Nr=getRetryDelay(jr,zr);this.warn(`Fragment ${Rr.sn} of ${Tr} ${Rr.level} errored with ${Ar.details}, retrying loading ${zr+1}/${jr.maxNumRetry} in ${Nr}ms`),Mr.resolved=!0,this.retryDate=self.performance.now()+Nr,this.state=State.FRAG_LOADING_WAITING_RETRY}else jr&&Mr?(this.resetFragmentErrors(Tr),zr<jr.maxNumRetry?Dr||(Mr.resolved=!0):logger.warn(`${Ar.details} reached or exceeded max retry (${zr})`)):(Mr==null?void 0:Mr.action)===NetworkErrorAction.SendAlternateToPenaltyBox?this.state=State.WAITING_LEVEL:this.state=State.ERROR;this.tickImmediate()}reduceLengthAndFlushBuffer(Tr){if(this.state===State.PARSING||this.state===State.PARSED){const Ar=Tr.parent,Rr=this.getFwdBufferInfo(this.mediaBuffer,Ar),Pr=Rr&&Rr.len>.5;Pr&&this.reduceMaxBufferLength(Rr.len);const Dr=!Pr;return Dr&&this.warn(`Buffer full error while media.currentTime is not buffered, flush ${Ar} buffer`),Tr.frag&&(this.fragmentTracker.removeFragment(Tr.frag),this.nextLoadPosition=Tr.frag.start),this.resetLoadingState(),Dr}return!1}resetFragmentErrors(Tr){Tr===PlaylistLevelType.AUDIO&&(this.fragCurrent=null),this.loadedmetadata||(this.startFragRequested=!1),this.state!==State.STOPPED&&(this.state=State.IDLE)}afterBufferFlushed(Tr,Ar,Rr){if(!Tr)return;const Pr=BufferHelper.getBuffered(Tr);this.fragmentTracker.detectEvictedFragments(Ar,Pr,Rr),this.state===State.ENDED&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state=State.IDLE}resetStartWhenNotLoaded(Tr){if(!this.loadedmetadata){this.startFragRequested=!1;const Ar=this.levels?this.levels[Tr].details:null;Ar!=null&&Ar.live?(this.startPosition=-1,this.setStartPosition(Ar,0),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(Tr){var Ar;this.warn(`The loading context changed while buffering fragment ${Tr.sn} of level ${Tr.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded((Ar=this.levelLastLoaded)!=null?Ar:Tr.level),this.resetLoadingState()}removeUnbufferedFrags(Tr=0){this.fragmentTracker.removeFragmentsInRange(Tr,1/0,this.playlistType,!1,!0)}updateLevelTiming(Tr,Ar,Rr,Pr){var Dr;const Mr=Rr.details;if(!Mr){this.warn("level.details undefined");return}if(Object.keys(Tr.elementaryStreams).reduce((zr,jr)=>{const Gr=Tr.elementaryStreams[jr];if(Gr){const Nr=Gr.endPTS-Gr.startPTS;if(Nr<=0)return this.warn(`Could not parse fragment ${Tr.sn} ${jr} duration reliably (${Nr})`),zr||!1;const Lr=Pr?0:updateFragPTSDTS(Mr,Tr,Gr.startPTS,Gr.endPTS,Gr.startDTS,Gr.endDTS);return this.hls.trigger(Events.LEVEL_PTS_UPDATED,{details:Mr,level:Rr,drift:Lr,type:jr,frag:Tr,start:Gr.startPTS,end:Gr.endPTS}),!0}return zr},!1))Rr.fragmentError=0;else if(((Dr=this.transmuxer)==null?void 0:Dr.error)===null){const zr=new Error(`Found no media in fragment ${Tr.sn} of level ${Tr.level} resetting transmuxer to fallback to playlist timing`);if(Rr.fragmentError===0&&(Rr.fragmentError++,Tr.gap=!0,this.fragmentTracker.removeFragment(Tr),this.fragmentTracker.fragBuffered(Tr,!0)),this.warn(zr.message),this.hls.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,error:zr,frag:Tr,reason:`Found no media in msn ${Tr.sn} of level "${Rr.url}"`}),!this.hls)return;this.resetTransmuxer()}this.state=State.PARSED,this.hls.trigger(Events.FRAG_PARSED,{frag:Tr,part:Ar})}resetTransmuxer(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)}recoverWorkerError(Tr){if(Tr.event==="demuxerWorker"){var Ar,Rr,Pr;this.fragmentTracker.removeAllFragments(),this.resetTransmuxer(),this.resetStartWhenNotLoaded((Ar=(Rr=this.levelLastLoaded)!=null?Rr:(Pr=this.fragCurrent)==null?void 0:Pr.level)!=null?Ar:0),this.resetLoadingState()}}set state(Tr){const Ar=this._state;Ar!==Tr&&(this._state=Tr,this.log(`${Ar}->${Tr}`))}get state(){return this._state}}function getSourceBuffer(){return self.SourceBuffer||self.WebKitSourceBuffer}function isSupported(){const _r=getMediaSource();if(!_r)return!1;const Tr=getSourceBuffer(),Ar=_r&&typeof _r.isTypeSupported=="function"&&_r.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),Rr=!Tr||Tr.prototype&&typeof Tr.prototype.appendBuffer=="function"&&typeof Tr.prototype.remove=="function";return!!Ar&&!!Rr}function changeTypeSupported(){var _r;const Tr=getSourceBuffer();return typeof(Tr==null||(_r=Tr.prototype)==null?void 0:_r.changeType)=="function"}function hasUMDWorker(){return typeof __HLS_WORKER_BUNDLE__=="function"}function injectWorker(){const _r=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),Tr=self.URL.createObjectURL(_r);return{worker:new self.Worker(Tr),objectURL:Tr}}function loadWorker(_r){const Tr=new self.URL(_r,self.location.href).href;return{worker:new self.Worker(Tr),scriptURL:Tr}}function dummyTrack(_r="",Tr=9e4){return{type:_r,id:-1,pid:-1,inputTimeScale:Tr,sequenceNumber:-1,samples:[],dropped:0}}class BaseAudioDemuxer{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(Tr,Ar,Rr,Pr){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(Tr){this.initPTS=Tr,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(Tr,Ar){return!1}appendFrame(Tr,Ar,Rr){}demux(Tr,Ar){this.cachedData&&(Tr=appendUint8Array(this.cachedData,Tr),this.cachedData=null);let Rr=getID3Data(Tr,0),Pr=Rr?Rr.length:0,Dr;const Mr=this._audioTrack,Fr=this._id3Track,zr=Rr?getTimeStamp(Rr):void 0,jr=Tr.length;for((this.basePTS===null||this.frameIndex===0&&isFiniteNumber(zr))&&(this.basePTS=initPTSFn(zr,Ar,this.initPTS),this.lastPTS=this.basePTS),this.lastPTS===null&&(this.lastPTS=this.basePTS),Rr&&Rr.length>0&&Fr.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:Rr,type:MetadataSchema.audioId3,duration:Number.POSITIVE_INFINITY});Pr<jr;){if(this.canParse(Tr,Pr)){const Gr=this.appendFrame(Mr,Tr,Pr);Gr?(this.frameIndex++,this.lastPTS=Gr.sample.pts,Pr+=Gr.length,Dr=Pr):Pr=jr}else canParse$2(Tr,Pr)?(Rr=getID3Data(Tr,Pr),Fr.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:Rr,type:MetadataSchema.audioId3,duration:Number.POSITIVE_INFINITY}),Pr+=Rr.length,Dr=Pr):Pr++;if(Pr===jr&&Dr!==jr){const Gr=sliceUint8(Tr,Dr);this.cachedData?this.cachedData=appendUint8Array(this.cachedData,Gr):this.cachedData=Gr}}return{audioTrack:Mr,videoTrack:dummyTrack(),id3Track:Fr,textTrack:dummyTrack()}}demuxSampleAes(Tr,Ar,Rr){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(Tr){const Ar=this.cachedData;return Ar&&(this.cachedData=null,this.demux(Ar,0)),{audioTrack:this._audioTrack,videoTrack:dummyTrack(),id3Track:this._id3Track,textTrack:dummyTrack()}}destroy(){}}const initPTSFn=(_r,Tr,Ar)=>{if(isFiniteNumber(_r))return _r*90;const Rr=Ar?Ar.baseTime*9e4/Ar.timescale:0;return Tr*9e4+Rr};function getAudioConfig(_r,Tr,Ar,Rr){let Pr,Dr,Mr,Fr;const zr=navigator.userAgent.toLowerCase(),jr=Rr,Gr=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];Pr=((Tr[Ar+2]&192)>>>6)+1;const Nr=(Tr[Ar+2]&60)>>>2;if(Nr>Gr.length-1){_r.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:`invalid ADTS sampling index:${Nr}`});return}return Mr=(Tr[Ar+2]&1)<<2,Mr|=(Tr[Ar+3]&192)>>>6,logger.log(`manifest codec:${Rr}, ADTS type:${Pr}, samplingIndex:${Nr}`),/firefox/i.test(zr)?Nr>=6?(Pr=5,Fr=new Array(4),Dr=Nr-3):(Pr=2,Fr=new Array(2),Dr=Nr):zr.indexOf("android")!==-1?(Pr=2,Fr=new Array(2),Dr=Nr):(Pr=5,Fr=new Array(4),Rr&&(Rr.indexOf("mp4a.40.29")!==-1||Rr.indexOf("mp4a.40.5")!==-1)||!Rr&&Nr>=6?Dr=Nr-3:((Rr&&Rr.indexOf("mp4a.40.2")!==-1&&(Nr>=6&&Mr===1||/vivaldi/i.test(zr))||!Rr&&Mr===1)&&(Pr=2,Fr=new Array(2)),Dr=Nr)),Fr[0]=Pr<<3,Fr[0]|=(Nr&14)>>1,Fr[1]|=(Nr&1)<<7,Fr[1]|=Mr<<3,Pr===5&&(Fr[1]|=(Dr&14)>>1,Fr[2]=(Dr&1)<<7,Fr[2]|=8,Fr[3]=0),{config:Fr,samplerate:Gr[Nr],channelCount:Mr,codec:"mp4a.40."+Pr,manifestCodec:jr}}function isHeaderPattern$1(_r,Tr){return _r[Tr]===255&&(_r[Tr+1]&246)===240}function getHeaderLength(_r,Tr){return _r[Tr+1]&1?7:9}function getFullFrameLength(_r,Tr){return(_r[Tr+3]&3)<<11|_r[Tr+4]<<3|(_r[Tr+5]&224)>>>5}function canGetFrameLength(_r,Tr){return Tr+5<_r.length}function isHeader$1(_r,Tr){return Tr+1<_r.length&&isHeaderPattern$1(_r,Tr)}function canParse$1(_r,Tr){return canGetFrameLength(_r,Tr)&&isHeaderPattern$1(_r,Tr)&&getFullFrameLength(_r,Tr)<=_r.length-Tr}function probe$1(_r,Tr){if(isHeader$1(_r,Tr)){const Ar=getHeaderLength(_r,Tr);if(Tr+Ar>=_r.length)return!1;const Rr=getFullFrameLength(_r,Tr);if(Rr<=Ar)return!1;const Pr=Tr+Rr;return Pr===_r.length||isHeader$1(_r,Pr)}return!1}function initTrackConfig(_r,Tr,Ar,Rr,Pr){if(!_r.samplerate){const Dr=getAudioConfig(Tr,Ar,Rr,Pr);if(!Dr)return;_r.config=Dr.config,_r.samplerate=Dr.samplerate,_r.channelCount=Dr.channelCount,_r.codec=Dr.codec,_r.manifestCodec=Dr.manifestCodec,logger.log(`parsed codec:${_r.codec}, rate:${Dr.samplerate}, channels:${Dr.channelCount}`)}}function getFrameDuration(_r){return 1024*9e4/_r}function parseFrameHeader(_r,Tr){const Ar=getHeaderLength(_r,Tr);if(Tr+Ar<=_r.length){const Rr=getFullFrameLength(_r,Tr)-Ar;if(Rr>0)return{headerLength:Ar,frameLength:Rr}}}function appendFrame$1(_r,Tr,Ar,Rr,Pr){const Dr=getFrameDuration(_r.samplerate),Mr=Rr+Pr*Dr,Fr=parseFrameHeader(Tr,Ar);let zr;if(Fr){const{frameLength:Nr,headerLength:Lr}=Fr,Ur=Lr+Nr,Vr=Math.max(0,Ar+Ur-Tr.length);Vr?(zr=new Uint8Array(Ur-Lr),zr.set(Tr.subarray(Ar+Lr,Tr.length),0)):zr=Tr.subarray(Ar+Lr,Ar+Ur);const Wr={unit:zr,pts:Mr};return Vr||_r.samples.push(Wr),{sample:Wr,length:Ur,missing:Vr}}const jr=Tr.length-Ar;return zr=new Uint8Array(jr),zr.set(Tr.subarray(Ar,Tr.length),0),{sample:{unit:zr,pts:Mr},length:jr,missing:-1}}class AACDemuxer extends BaseAudioDemuxer{constructor(Tr,Ar){super(),this.observer=void 0,this.config=void 0,this.observer=Tr,this.config=Ar}resetInitSegment(Tr,Ar,Rr,Pr){super.resetInitSegment(Tr,Ar,Rr,Pr),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:Ar,duration:Pr,inputTimeScale:9e4,dropped:0}}static probe(Tr){if(!Tr)return!1;let Rr=(getID3Data(Tr,0)||[]).length;for(let Pr=Tr.length;Rr<Pr;Rr++)if(probe$1(Tr,Rr))return logger.log("ADTS sync word found !"),!0;return!1}canParse(Tr,Ar){return canParse$1(Tr,Ar)}appendFrame(Tr,Ar,Rr){initTrackConfig(Tr,this.observer,Ar,Rr,Tr.manifestCodec);const Pr=appendFrame$1(Tr,Ar,Rr,this.basePTS,this.frameIndex);if(Pr&&Pr.missing===0)return Pr}}const emsgSchemePattern=/\/emsg[-/]ID3/i;class MP4Demuxer{constructor(Tr,Ar){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=Ar}resetTimeStamp(){}resetInitSegment(Tr,Ar,Rr,Pr){const Dr=this.videoTrack=dummyTrack("video",1),Mr=this.audioTrack=dummyTrack("audio",1),Fr=this.txtTrack=dummyTrack("text",1);if(this.id3Track=dummyTrack("id3",1),this.timeOffset=0,!(Tr!=null&&Tr.byteLength))return;const zr=parseInitSegment(Tr);if(zr.video){const{id:jr,timescale:Gr,codec:Nr}=zr.video;Dr.id=jr,Dr.timescale=Fr.timescale=Gr,Dr.codec=Nr}if(zr.audio){const{id:jr,timescale:Gr,codec:Nr}=zr.audio;Mr.id=jr,Mr.timescale=Gr,Mr.codec=Nr}Fr.id=RemuxerTrackIdConfig.text,Dr.sampleDuration=0,Dr.duration=Mr.duration=Pr}resetContiguity(){this.remainderData=null}static probe(Tr){return Tr=Tr.length>16384?Tr.subarray(0,16384):Tr,findBox(Tr,["moof"]).length>0}demux(Tr,Ar){this.timeOffset=Ar;let Rr=Tr;const Pr=this.videoTrack,Dr=this.txtTrack;if(this.config.progressive){this.remainderData&&(Rr=appendUint8Array(this.remainderData,Tr));const Fr=segmentValidRange(Rr);this.remainderData=Fr.remainder,Pr.samples=Fr.valid||new Uint8Array}else Pr.samples=Rr;const Mr=this.extractID3Track(Pr,Ar);return Dr.samples=parseSamples(Ar,Pr),{videoTrack:Pr,audioTrack:this.audioTrack,id3Track:Mr,textTrack:this.txtTrack}}flush(){const Tr=this.timeOffset,Ar=this.videoTrack,Rr=this.txtTrack;Ar.samples=this.remainderData||new Uint8Array,this.remainderData=null;const Pr=this.extractID3Track(Ar,this.timeOffset);return Rr.samples=parseSamples(Tr,Ar),{videoTrack:Ar,audioTrack:dummyTrack(),id3Track:Pr,textTrack:dummyTrack()}}extractID3Track(Tr,Ar){const Rr=this.id3Track;if(Tr.samples.length){const Pr=findBox(Tr.samples,["emsg"]);Pr&&Pr.forEach(Dr=>{const Mr=parseEmsg(Dr);if(emsgSchemePattern.test(Mr.schemeIdUri)){const Fr=isFiniteNumber(Mr.presentationTime)?Mr.presentationTime/Mr.timeScale:Ar+Mr.presentationTimeDelta/Mr.timeScale;let zr=Mr.eventDuration===4294967295?Number.POSITIVE_INFINITY:Mr.eventDuration/Mr.timeScale;zr<=.001&&(zr=Number.POSITIVE_INFINITY);const jr=Mr.payload;Rr.samples.push({data:jr,len:jr.byteLength,dts:Fr,pts:Fr,type:MetadataSchema.emsg,duration:zr})}})}return Rr}demuxSampleAes(Tr,Ar,Rr){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){}}let chromeVersion$1=null;const BitratesMap=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],SamplingRateMap=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],SamplesCoefficients=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],BytesInSlot=[0,1,1,4];function appendFrame(_r,Tr,Ar,Rr,Pr){if(Ar+24>Tr.length)return;const Dr=parseHeader(Tr,Ar);if(Dr&&Ar+Dr.frameLength<=Tr.length){const Mr=Dr.samplesPerFrame*9e4/Dr.sampleRate,Fr=Rr+Pr*Mr,zr={unit:Tr.subarray(Ar,Ar+Dr.frameLength),pts:Fr,dts:Fr};return _r.config=[],_r.channelCount=Dr.channelCount,_r.samplerate=Dr.sampleRate,_r.samples.push(zr),{sample:zr,length:Dr.frameLength,missing:0}}}function parseHeader(_r,Tr){const Ar=_r[Tr+1]>>3&3,Rr=_r[Tr+1]>>1&3,Pr=_r[Tr+2]>>4&15,Dr=_r[Tr+2]>>2&3;if(Ar!==1&&Pr!==0&&Pr!==15&&Dr!==3){const Mr=_r[Tr+2]>>1&1,Fr=_r[Tr+3]>>6,zr=Ar===3?3-Rr:Rr===3?3:4,jr=BitratesMap[zr*14+Pr-1]*1e3,Nr=SamplingRateMap[(Ar===3?0:Ar===2?1:2)*3+Dr],Lr=Fr===3?1:2,Ur=SamplesCoefficients[Ar][Rr],Vr=BytesInSlot[Rr],Wr=Ur*8*Vr,qr=Math.floor(Ur*jr/Nr+Mr)*Vr;if(chromeVersion$1===null){const Zr=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);chromeVersion$1=Zr?parseInt(Zr[1]):0}return!!chromeVersion$1&&chromeVersion$1<=87&&Rr===2&&jr>=224e3&&Fr===0&&(_r[Tr+3]=_r[Tr+3]|128),{sampleRate:Nr,channelCount:Lr,frameLength:qr,samplesPerFrame:Wr}}}function isHeaderPattern(_r,Tr){return _r[Tr]===255&&(_r[Tr+1]&224)===224&&(_r[Tr+1]&6)!==0}function isHeader(_r,Tr){return Tr+1<_r.length&&isHeaderPattern(_r,Tr)}function canParse(_r,Tr){return isHeaderPattern(_r,Tr)&&4<=_r.length-Tr}function probe(_r,Tr){if(Tr+1<_r.length&&isHeaderPattern(_r,Tr)){const Rr=parseHeader(_r,Tr);let Pr=4;Rr!=null&&Rr.frameLength&&(Pr=Rr.frameLength);const Dr=Tr+Pr;return Dr===_r.length||isHeader(_r,Dr)}return!1}class ExpGolomb{constructor(Tr){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=Tr,this.bytesAvailable=Tr.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){const Tr=this.data,Ar=this.bytesAvailable,Rr=Tr.byteLength-Ar,Pr=new Uint8Array(4),Dr=Math.min(4,Ar);if(Dr===0)throw new Error("no bytes available");Pr.set(Tr.subarray(Rr,Rr+Dr)),this.word=new DataView(Pr.buffer).getUint32(0),this.bitsAvailable=Dr*8,this.bytesAvailable-=Dr}skipBits(Tr){let Ar;Tr=Math.min(Tr,this.bytesAvailable*8+this.bitsAvailable),this.bitsAvailable>Tr?(this.word<<=Tr,this.bitsAvailable-=Tr):(Tr-=this.bitsAvailable,Ar=Tr>>3,Tr-=Ar<<3,this.bytesAvailable-=Ar,this.loadWord(),this.word<<=Tr,this.bitsAvailable-=Tr)}readBits(Tr){let Ar=Math.min(this.bitsAvailable,Tr);const Rr=this.word>>>32-Ar;if(Tr>32&&logger.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=Ar,this.bitsAvailable>0)this.word<<=Ar;else if(this.bytesAvailable>0)this.loadWord();else throw new Error("no bits available");return Ar=Tr-Ar,Ar>0&&this.bitsAvailable?Rr<<Ar|this.readBits(Ar):Rr}skipLZ(){let Tr;for(Tr=0;Tr<this.bitsAvailable;++Tr)if(this.word&2147483648>>>Tr)return this.word<<=Tr,this.bitsAvailable-=Tr,Tr;return this.loadWord(),Tr+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){const Tr=this.skipLZ();return this.readBits(Tr+1)-1}readEG(){const Tr=this.readUEG();return 1&Tr?1+Tr>>>1:-1*(Tr>>>1)}readBoolean(){return this.readBits(1)===1}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}skipScalingList(Tr){let Ar=8,Rr=8,Pr;for(let Dr=0;Dr<Tr;Dr++)Rr!==0&&(Pr=this.readEG(),Rr=(Ar+Pr+256)%256),Ar=Rr===0?Ar:Rr}readSPS(){let Tr=0,Ar=0,Rr=0,Pr=0,Dr,Mr,Fr;const zr=this.readUByte.bind(this),jr=this.readBits.bind(this),Gr=this.readUEG.bind(this),Nr=this.readBoolean.bind(this),Lr=this.skipBits.bind(this),Ur=this.skipEG.bind(this),Vr=this.skipUEG.bind(this),Wr=this.skipScalingList.bind(this);zr();const qr=zr();if(jr(5),Lr(3),zr(),Vr(),qr===100||qr===110||qr===122||qr===244||qr===44||qr===83||qr===86||qr===118||qr===128){const es=Gr();if(es===3&&Lr(1),Vr(),Vr(),Lr(1),Nr())for(Mr=es!==3?8:12,Fr=0;Fr<Mr;Fr++)Nr()&&(Fr<6?Wr(16):Wr(64))}Vr();const Kr=Gr();if(Kr===0)Gr();else if(Kr===1)for(Lr(1),Ur(),Ur(),Dr=Gr(),Fr=0;Fr<Dr;Fr++)Ur();Vr(),Lr(1);const Xr=Gr(),Zr=Gr(),_i=jr(1);_i===0&&Lr(1),Lr(1),Nr()&&(Tr=Gr(),Ar=Gr(),Rr=Gr(),Pr=Gr());let Jr=[1,1];if(Nr()&&Nr())switch(zr()){case 1:Jr=[1,1];break;case 2:Jr=[12,11];break;case 3:Jr=[10,11];break;case 4:Jr=[16,11];break;case 5:Jr=[40,33];break;case 6:Jr=[24,11];break;case 7:Jr=[20,11];break;case 8:Jr=[32,11];break;case 9:Jr=[80,33];break;case 10:Jr=[18,11];break;case 11:Jr=[15,11];break;case 12:Jr=[64,33];break;case 13:Jr=[160,99];break;case 14:Jr=[4,3];break;case 15:Jr=[3,2];break;case 16:Jr=[2,1];break;case 255:{Jr=[zr()<<8|zr(),zr()<<8|zr()];break}}return{width:Math.ceil((Xr+1)*16-Tr*2-Ar*2),height:(2-_i)*(Zr+1)*16-(_i?2:4)*(Rr+Pr),pixelRatio:Jr}}readSliceType(){return this.readUByte(),this.readUEG(),this.readUEG()}}class SampleAesDecrypter{constructor(Tr,Ar,Rr){this.keyData=void 0,this.decrypter=void 0,this.keyData=Rr,this.decrypter=new Decrypter(Ar,{removePKCS7Padding:!1})}decryptBuffer(Tr){return this.decrypter.decrypt(Tr,this.keyData.key.buffer,this.keyData.iv.buffer)}decryptAacSample(Tr,Ar,Rr){const Pr=Tr[Ar].unit;if(Pr.length<=16)return;const Dr=Pr.subarray(16,Pr.length-Pr.length%16),Mr=Dr.buffer.slice(Dr.byteOffset,Dr.byteOffset+Dr.length);this.decryptBuffer(Mr).then(Fr=>{const zr=new Uint8Array(Fr);Pr.set(zr,16),this.decrypter.isSync()||this.decryptAacSamples(Tr,Ar+1,Rr)})}decryptAacSamples(Tr,Ar,Rr){for(;;Ar++){if(Ar>=Tr.length){Rr();return}if(!(Tr[Ar].unit.length<32)&&(this.decryptAacSample(Tr,Ar,Rr),!this.decrypter.isSync()))return}}getAvcEncryptedData(Tr){const Ar=Math.floor((Tr.length-48)/160)*16+16,Rr=new Int8Array(Ar);let Pr=0;for(let Dr=32;Dr<Tr.length-16;Dr+=160,Pr+=16)Rr.set(Tr.subarray(Dr,Dr+16),Pr);return Rr}getAvcDecryptedUnit(Tr,Ar){const Rr=new Uint8Array(Ar);let Pr=0;for(let Dr=32;Dr<Tr.length-16;Dr+=160,Pr+=16)Tr.set(Rr.subarray(Pr,Pr+16),Dr);return Tr}decryptAvcSample(Tr,Ar,Rr,Pr,Dr){const Mr=discardEPB(Dr.data),Fr=this.getAvcEncryptedData(Mr);this.decryptBuffer(Fr.buffer).then(zr=>{Dr.data=this.getAvcDecryptedUnit(Mr,zr),this.decrypter.isSync()||this.decryptAvcSamples(Tr,Ar,Rr+1,Pr)})}decryptAvcSamples(Tr,Ar,Rr,Pr){if(Tr instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;Ar++,Rr=0){if(Ar>=Tr.length){Pr();return}const Dr=Tr[Ar].units;for(;!(Rr>=Dr.length);Rr++){const Mr=Dr[Rr];if(!(Mr.data.length<=48||Mr.type!==1&&Mr.type!==5)&&(this.decryptAvcSample(Tr,Ar,Rr,Pr,Mr),!this.decrypter.isSync()))return}}}}const PACKET_LENGTH=188;class TSDemuxer{constructor(Tr,Ar,Rr){this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._duration=0,this._pmtId=-1,this._avcTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.observer=Tr,this.config=Ar,this.typeSupported=Rr}static probe(Tr){const Ar=TSDemuxer.syncOffset(Tr);return Ar>0&&logger.warn(`MPEG2-TS detected but first sync word found @ offset ${Ar}`),Ar!==-1}static syncOffset(Tr){const Ar=Tr.length;let Rr=Math.min(PACKET_LENGTH*5,Tr.length-PACKET_LENGTH)+1,Pr=0;for(;Pr<Rr;){let Dr=!1,Mr=-1,Fr=0;for(let zr=Pr;zr<Ar;zr+=PACKET_LENGTH)if(Tr[zr]===71){if(Fr++,Mr===-1&&(Mr=zr,Mr!==0&&(Rr=Math.min(Mr+PACKET_LENGTH*99,Tr.length-PACKET_LENGTH)+1)),Dr||(Dr=parsePID(Tr,zr)===0),Dr&&Fr>1&&(Mr===0&&Fr>2||zr+PACKET_LENGTH>Rr))return Mr}else{if(Fr)return-1;break}Pr++}return-1}static createTrack(Tr,Ar){return{container:Tr==="video"||Tr==="audio"?"video/mp2t":void 0,type:Tr,id:RemuxerTrackIdConfig[Tr],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:Tr==="audio"?Ar:void 0}}resetInitSegment(Tr,Ar,Rr,Pr){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack=TSDemuxer.createTrack("video"),this._audioTrack=TSDemuxer.createTrack("audio",Pr),this._id3Track=TSDemuxer.createTrack("id3"),this._txtTrack=TSDemuxer.createTrack("text"),this._audioTrack.segmentCodec="aac",this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.audioCodec=Ar,this.videoCodec=Rr,this._duration=Pr}resetTimeStamp(){}resetContiguity(){const{_audioTrack:Tr,_avcTrack:Ar,_id3Track:Rr}=this;Tr&&(Tr.pesData=null),Ar&&(Ar.pesData=null),Rr&&(Rr.pesData=null),this.aacOverFlow=null,this.avcSample=null,this.remainderData=null}demux(Tr,Ar,Rr=!1,Pr=!1){Rr||(this.sampleAes=null);let Dr;const Mr=this._avcTrack,Fr=this._audioTrack,zr=this._id3Track,jr=this._txtTrack;let Gr=Mr.pid,Nr=Mr.pesData,Lr=Fr.pid,Ur=zr.pid,Vr=Fr.pesData,Wr=zr.pesData,qr=null,Kr=this.pmtParsed,Xr=this._pmtId,Zr=Tr.length;if(this.remainderData&&(Tr=appendUint8Array(this.remainderData,Tr),Zr=Tr.length,this.remainderData=null),Zr<PACKET_LENGTH&&!Pr)return this.remainderData=Tr,{audioTrack:Fr,videoTrack:Mr,id3Track:zr,textTrack:jr};const _i=Math.max(0,TSDemuxer.syncOffset(Tr));Zr-=(Zr-_i)%PACKET_LENGTH,Zr<Tr.byteLength&&!Pr&&(this.remainderData=new Uint8Array(Tr.buffer,Zr,Tr.buffer.byteLength-Zr));let Jr=0;for(let ts=_i;ts<Zr;ts+=PACKET_LENGTH)if(Tr[ts]===71){const is=!!(Tr[ts+1]&64),rs=parsePID(Tr,ts),as=(Tr[ts+3]&48)>>4;let ls;if(as>1){if(ls=ts+5+Tr[ts+4],ls===ts+PACKET_LENGTH)continue}else ls=ts+4;switch(rs){case Gr:is&&(Nr&&(Dr=parsePES(Nr))&&this.parseAVCPES(Mr,jr,Dr,!1),Nr={data:[],size:0}),Nr&&(Nr.data.push(Tr.subarray(ls,ts+PACKET_LENGTH)),Nr.size+=ts+PACKET_LENGTH-ls);break;case Lr:if(is){if(Vr&&(Dr=parsePES(Vr)))switch(Fr.segmentCodec){case"aac":this.parseAACPES(Fr,Dr);break;case"mp3":this.parseMPEGPES(Fr,Dr);break}Vr={data:[],size:0}}Vr&&(Vr.data.push(Tr.subarray(ls,ts+PACKET_LENGTH)),Vr.size+=ts+PACKET_LENGTH-ls);break;case Ur:is&&(Wr&&(Dr=parsePES(Wr))&&this.parseID3PES(zr,Dr),Wr={data:[],size:0}),Wr&&(Wr.data.push(Tr.subarray(ls,ts+PACKET_LENGTH)),Wr.size+=ts+PACKET_LENGTH-ls);break;case 0:is&&(ls+=Tr[ls]+1),Xr=this._pmtId=parsePAT(Tr,ls);break;case Xr:{is&&(ls+=Tr[ls]+1);const fs=parsePMT(Tr,ls,this.typeSupported,Rr);Gr=fs.avc,Gr>0&&(Mr.pid=Gr),Lr=fs.audio,Lr>0&&(Fr.pid=Lr,Fr.segmentCodec=fs.segmentCodec),Ur=fs.id3,Ur>0&&(zr.pid=Ur),qr!==null&&!Kr&&(logger.warn(`MPEG-TS PMT found at ${ts} after unknown PID '${qr}'. Backtracking to sync byte @${_i} to parse all TS packets.`),qr=null,ts=_i-188),Kr=this.pmtParsed=!0;break}case 17:case 8191:break;default:qr=rs;break}}else Jr++;if(Jr>0){const ts=new Error(`Found ${Jr} TS packet/s that do not start with 0x47`);this.observer.emit(Events.ERROR,Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,error:ts,reason:ts.message})}Mr.pesData=Nr,Fr.pesData=Vr,zr.pesData=Wr;const es={audioTrack:Fr,videoTrack:Mr,id3Track:zr,textTrack:jr};return Pr&&this.extractRemainingSamples(es),es}flush(){const{remainderData:Tr}=this;this.remainderData=null;let Ar;return Tr?Ar=this.demux(Tr,-1,!1,!0):Ar={videoTrack:this._avcTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(Ar),this.sampleAes?this.decrypt(Ar,this.sampleAes):Ar}extractRemainingSamples(Tr){const{audioTrack:Ar,videoTrack:Rr,id3Track:Pr,textTrack:Dr}=Tr,Mr=Rr.pesData,Fr=Ar.pesData,zr=Pr.pesData;let jr;if(Mr&&(jr=parsePES(Mr))?(this.parseAVCPES(Rr,Dr,jr,!0),Rr.pesData=null):Rr.pesData=Mr,Fr&&(jr=parsePES(Fr))){switch(Ar.segmentCodec){case"aac":this.parseAACPES(Ar,jr);break;case"mp3":this.parseMPEGPES(Ar,jr);break}Ar.pesData=null}else Fr!=null&&Fr.size&&logger.log("last AAC PES packet truncated,might overlap between fragments"),Ar.pesData=Fr;zr&&(jr=parsePES(zr))?(this.parseID3PES(Pr,jr),Pr.pesData=null):Pr.pesData=zr}demuxSampleAes(Tr,Ar,Rr){const Pr=this.demux(Tr,Rr,!0,!this.config.progressive),Dr=this.sampleAes=new SampleAesDecrypter(this.observer,this.config,Ar);return this.decrypt(Pr,Dr)}decrypt(Tr,Ar){return new Promise(Rr=>{const{audioTrack:Pr,videoTrack:Dr}=Tr;Pr.samples&&Pr.segmentCodec==="aac"?Ar.decryptAacSamples(Pr.samples,0,()=>{Dr.samples?Ar.decryptAvcSamples(Dr.samples,0,0,()=>{Rr(Tr)}):Rr(Tr)}):Dr.samples&&Ar.decryptAvcSamples(Dr.samples,0,0,()=>{Rr(Tr)})})}destroy(){this._duration=0}parseAVCPES(Tr,Ar,Rr,Pr){const Dr=this.parseAVCNALu(Tr,Rr.data);let Mr=this.avcSample,Fr,zr=!1;Rr.data=null,Mr&&Dr.length&&!Tr.audFound&&(pushAccessUnit(Mr,Tr),Mr=this.avcSample=createAVCSample(!1,Rr.pts,Rr.dts,"")),Dr.forEach(jr=>{var Gr;switch(jr.type){case 1:{let Lr=!1;Fr=!0;const Ur=jr.data;if(zr&&Ur.length>4){const Vr=new ExpGolomb(Ur).readSliceType();(Vr===2||Vr===4||Vr===7||Vr===9)&&(Lr=!0)}if(Lr){var Nr;(Nr=Mr)!=null&&Nr.frame&&!Mr.key&&(pushAccessUnit(Mr,Tr),Mr=this.avcSample=null)}Mr||(Mr=this.avcSample=createAVCSample(!0,Rr.pts,Rr.dts,"")),Mr.frame=!0,Mr.key=Lr;break}case 5:Fr=!0,(Gr=Mr)!=null&&Gr.frame&&!Mr.key&&(pushAccessUnit(Mr,Tr),Mr=this.avcSample=null),Mr||(Mr=this.avcSample=createAVCSample(!0,Rr.pts,Rr.dts,"")),Mr.key=!0,Mr.frame=!0;break;case 6:{Fr=!0,parseSEIMessageFromNALu(jr.data,1,Rr.pts,Ar.samples);break}case 7:if(Fr=!0,zr=!0,!Tr.sps){const Lr=jr.data,Vr=new ExpGolomb(Lr).readSPS();Tr.width=Vr.width,Tr.height=Vr.height,Tr.pixelRatio=Vr.pixelRatio,Tr.sps=[Lr],Tr.duration=this._duration;const Wr=Lr.subarray(1,4);let qr="avc1.";for(let Kr=0;Kr<3;Kr++){let Xr=Wr[Kr].toString(16);Xr.length<2&&(Xr="0"+Xr),qr+=Xr}Tr.codec=qr}break;case 8:Fr=!0,Tr.pps||(Tr.pps=[jr.data]);break;case 9:Fr=!1,Tr.audFound=!0,Mr&&pushAccessUnit(Mr,Tr),Mr=this.avcSample=createAVCSample(!1,Rr.pts,Rr.dts,"");break;case 12:Fr=!0;break;default:Fr=!1,Mr&&(Mr.debug+="unknown NAL "+jr.type+" ");break}Mr&&Fr&&Mr.units.push(jr)}),Pr&&Mr&&(pushAccessUnit(Mr,Tr),this.avcSample=null)}getLastNalUnit(Tr){var Ar;let Rr=this.avcSample,Pr;if((!Rr||Rr.units.length===0)&&(Rr=Tr[Tr.length-1]),(Ar=Rr)!=null&&Ar.units){const Dr=Rr.units;Pr=Dr[Dr.length-1]}return Pr}parseAVCNALu(Tr,Ar){const Rr=Ar.byteLength;let Pr=Tr.naluState||0;const Dr=Pr,Mr=[];let Fr=0,zr,jr,Gr,Nr=-1,Lr=0;for(Pr===-1&&(Nr=0,Lr=Ar[0]&31,Pr=0,Fr=1);Fr<Rr;){if(zr=Ar[Fr++],!Pr){Pr=zr?0:1;continue}if(Pr===1){Pr=zr?0:2;continue}if(!zr)Pr=3;else if(zr===1){if(Nr>=0){const Ur={data:Ar.subarray(Nr,Fr-Pr-1),type:Lr};Mr.push(Ur)}else{const Ur=this.getLastNalUnit(Tr.samples);if(Ur&&(Dr&&Fr<=4-Dr&&Ur.state&&(Ur.data=Ur.data.subarray(0,Ur.data.byteLength-Dr)),jr=Fr-Pr-1,jr>0)){const Vr=new Uint8Array(Ur.data.byteLength+jr);Vr.set(Ur.data,0),Vr.set(Ar.subarray(0,jr),Ur.data.byteLength),Ur.data=Vr,Ur.state=0}}Fr<Rr?(Gr=Ar[Fr]&31,Nr=Fr,Lr=Gr,Pr=0):Pr=-1}else Pr=0}if(Nr>=0&&Pr>=0){const Ur={data:Ar.subarray(Nr,Rr),type:Lr,state:Pr};Mr.push(Ur)}if(Mr.length===0){const Ur=this.getLastNalUnit(Tr.samples);if(Ur){const Vr=new Uint8Array(Ur.data.byteLength+Ar.byteLength);Vr.set(Ur.data,0),Vr.set(Ar,Ur.data.byteLength),Ur.data=Vr}}return Tr.naluState=Pr,Mr}parseAACPES(Tr,Ar){let Rr=0;const Pr=this.aacOverFlow;let Dr=Ar.data;if(Pr){this.aacOverFlow=null;const Nr=Pr.missing,Lr=Pr.sample.unit.byteLength;if(Nr===-1){const Ur=new Uint8Array(Lr+Dr.byteLength);Ur.set(Pr.sample.unit,0),Ur.set(Dr,Lr),Dr=Ur}else{const Ur=Lr-Nr;Pr.sample.unit.set(Dr.subarray(0,Nr),Ur),Tr.samples.push(Pr.sample),Rr=Pr.missing}}let Mr,Fr;for(Mr=Rr,Fr=Dr.length;Mr<Fr-1&&!isHeader$1(Dr,Mr);Mr++);if(Mr!==Rr){let Nr;const Lr=Mr<Fr-1;Lr?Nr=`AAC PES did not start with ADTS header,offset:${Mr}`:Nr="No ADTS header found in AAC PES";const Ur=new Error(Nr);if(logger.warn(`parsing error: ${Nr}`),this.observer.emit(Events.ERROR,Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,levelRetry:Lr,error:Ur,reason:Nr}),!Lr)return}initTrackConfig(Tr,this.observer,Dr,Mr,this.audioCodec);let zr;if(Ar.pts!==void 0)zr=Ar.pts;else if(Pr){const Nr=getFrameDuration(Tr.samplerate);zr=Pr.sample.pts+Nr}else{logger.warn("[tsdemuxer]: AAC PES unknown PTS");return}let jr=0,Gr;for(;Mr<Fr;)if(Gr=appendFrame$1(Tr,Dr,Mr,zr,jr),Mr+=Gr.length,Gr.missing){this.aacOverFlow=Gr;break}else for(jr++;Mr<Fr-1&&!isHeader$1(Dr,Mr);Mr++);}parseMPEGPES(Tr,Ar){const Rr=Ar.data,Pr=Rr.length;let Dr=0,Mr=0;const Fr=Ar.pts;if(Fr===void 0){logger.warn("[tsdemuxer]: MPEG PES unknown PTS");return}for(;Mr<Pr;)if(isHeader(Rr,Mr)){const zr=appendFrame(Tr,Rr,Mr,Fr,Dr);if(zr)Mr+=zr.length,Dr++;else break}else Mr++}parseID3PES(Tr,Ar){if(Ar.pts===void 0){logger.warn("[tsdemuxer]: ID3 PES unknown PTS");return}const Rr=_extends({},Ar,{type:this._avcTrack?MetadataSchema.emsg:MetadataSchema.audioId3,duration:Number.POSITIVE_INFINITY});Tr.samples.push(Rr)}}function createAVCSample(_r,Tr,Ar,Rr){return{key:_r,frame:!1,pts:Tr,dts:Ar,units:[],debug:Rr,length:0}}function parsePID(_r,Tr){return((_r[Tr+1]&31)<<8)+_r[Tr+2]}function parsePAT(_r,Tr){return(_r[Tr+10]&31)<<8|_r[Tr+11]}function parsePMT(_r,Tr,Ar,Rr){const Pr={audio:-1,avc:-1,id3:-1,segmentCodec:"aac"},Dr=(_r[Tr+1]&15)<<8|_r[Tr+2],Mr=Tr+3+Dr-4,Fr=(_r[Tr+10]&15)<<8|_r[Tr+11];for(Tr+=12+Fr;Tr<Mr;){const zr=parsePID(_r,Tr);switch(_r[Tr]){case 207:if(!Rr){logger.log("ADTS AAC with AES-128-CBC frame encryption found in unencrypted stream");break}case 15:Pr.audio===-1&&(Pr.audio=zr);break;case 21:Pr.id3===-1&&(Pr.id3=zr);break;case 219:if(!Rr){logger.log("H.264 with AES-128-CBC slice encryption found in unencrypted stream");break}case 27:Pr.avc===-1&&(Pr.avc=zr);break;case 3:case 4:Ar.mpeg!==!0&&Ar.mp3!==!0?logger.log("MPEG audio found, not supported in this browser"):Pr.audio===-1&&(Pr.audio=zr,Pr.segmentCodec="mp3");break;case 36:logger.warn("Unsupported HEVC stream type found");break}Tr+=((_r[Tr+3]&15)<<8|_r[Tr+4])+5}return Pr}function parsePES(_r){let Tr=0,Ar,Rr,Pr,Dr,Mr;const Fr=_r.data;if(!_r||_r.size===0)return null;for(;Fr[0].length<19&&Fr.length>1;){const jr=new Uint8Array(Fr[0].length+Fr[1].length);jr.set(Fr[0]),jr.set(Fr[1],Fr[0].length),Fr[0]=jr,Fr.splice(1,1)}if(Ar=Fr[0],(Ar[0]<<16)+(Ar[1]<<8)+Ar[2]===1){if(Rr=(Ar[4]<<8)+Ar[5],Rr&&Rr>_r.size-6)return null;const jr=Ar[7];jr&192&&(Dr=(Ar[9]&14)*536870912+(Ar[10]&255)*4194304+(Ar[11]&254)*16384+(Ar[12]&255)*128+(Ar[13]&254)/2,jr&64?(Mr=(Ar[14]&14)*536870912+(Ar[15]&255)*4194304+(Ar[16]&254)*16384+(Ar[17]&255)*128+(Ar[18]&254)/2,Dr-Mr>60*9e4&&(logger.warn(`${Math.round((Dr-Mr)/9e4)}s delta between PTS and DTS, align them`),Dr=Mr)):Mr=Dr),Pr=Ar[8];let Gr=Pr+9;if(_r.size<=Gr)return null;_r.size-=Gr;const Nr=new Uint8Array(_r.size);for(let Lr=0,Ur=Fr.length;Lr<Ur;Lr++){Ar=Fr[Lr];let Vr=Ar.byteLength;if(Gr)if(Gr>Vr){Gr-=Vr;continue}else Ar=Ar.subarray(Gr),Vr-=Gr,Gr=0;Nr.set(Ar,Tr),Tr+=Vr}return Rr&&(Rr-=Pr+3),{data:Nr,pts:Dr,dts:Mr,len:Rr}}return null}function pushAccessUnit(_r,Tr){if(_r.units.length&&_r.frame){if(_r.pts===void 0){const Ar=Tr.samples,Rr=Ar.length;if(Rr){const Pr=Ar[Rr-1];_r.pts=Pr.pts,_r.dts=Pr.dts}else{Tr.dropped++;return}}Tr.samples.push(_r)}_r.debug.length&&logger.log(_r.pts+"/"+_r.dts+":"+_r.debug)}class MP3Demuxer extends BaseAudioDemuxer{resetInitSegment(Tr,Ar,Rr,Pr){super.resetInitSegment(Tr,Ar,Rr,Pr),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:Ar,duration:Pr,inputTimeScale:9e4,dropped:0}}static probe(Tr){if(!Tr)return!1;let Rr=(getID3Data(Tr,0)||[]).length;for(let Pr=Tr.length;Rr<Pr;Rr++)if(probe(Tr,Rr))return logger.log("MPEG Audio sync word found !"),!0;return!1}canParse(Tr,Ar){return canParse(Tr,Ar)}appendFrame(Tr,Ar,Rr){if(this.basePTS!==null)return appendFrame(Tr,Ar,Rr,this.basePTS,this.frameIndex)}}class AAC{static getSilentFrame(Tr,Ar){switch(Tr){case"mp4a.40.2":if(Ar===1)return new Uint8Array([0,200,0,128,35,128]);if(Ar===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(Ar===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(Ar===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(Ar===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(Ar===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(Ar===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(Ar===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(Ar===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}}}const UINT32_MAX=Math.pow(2,32)-1;class MP4{static init(){MP4.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};let Tr;for(Tr in MP4.types)MP4.types.hasOwnProperty(Tr)&&(MP4.types[Tr]=[Tr.charCodeAt(0),Tr.charCodeAt(1),Tr.charCodeAt(2),Tr.charCodeAt(3)]);const Ar=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),Rr=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);MP4.HDLR_TYPES={video:Ar,audio:Rr};const Pr=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),Dr=new Uint8Array([0,0,0,0,0,0,0,0]);MP4.STTS=MP4.STSC=MP4.STCO=Dr,MP4.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),MP4.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),MP4.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),MP4.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);const Mr=new Uint8Array([105,115,111,109]),Fr=new Uint8Array([97,118,99,49]),zr=new Uint8Array([0,0,0,1]);MP4.FTYP=MP4.box(MP4.types.ftyp,Mr,zr,Mr,Fr),MP4.DINF=MP4.box(MP4.types.dinf,MP4.box(MP4.types.dref,Pr))}static box(Tr,...Ar){let Rr=8,Pr=Ar.length;const Dr=Pr;for(;Pr--;)Rr+=Ar[Pr].byteLength;const Mr=new Uint8Array(Rr);for(Mr[0]=Rr>>24&255,Mr[1]=Rr>>16&255,Mr[2]=Rr>>8&255,Mr[3]=Rr&255,Mr.set(Tr,4),Pr=0,Rr=8;Pr<Dr;Pr++)Mr.set(Ar[Pr],Rr),Rr+=Ar[Pr].byteLength;return Mr}static hdlr(Tr){return MP4.box(MP4.types.hdlr,MP4.HDLR_TYPES[Tr])}static mdat(Tr){return MP4.box(MP4.types.mdat,Tr)}static mdhd(Tr,Ar){Ar*=Tr;const Rr=Math.floor(Ar/(UINT32_MAX+1)),Pr=Math.floor(Ar%(UINT32_MAX+1));return MP4.box(MP4.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,Tr>>24&255,Tr>>16&255,Tr>>8&255,Tr&255,Rr>>24,Rr>>16&255,Rr>>8&255,Rr&255,Pr>>24,Pr>>16&255,Pr>>8&255,Pr&255,85,196,0,0]))}static mdia(Tr){return MP4.box(MP4.types.mdia,MP4.mdhd(Tr.timescale,Tr.duration),MP4.hdlr(Tr.type),MP4.minf(Tr))}static mfhd(Tr){return MP4.box(MP4.types.mfhd,new Uint8Array([0,0,0,0,Tr>>24,Tr>>16&255,Tr>>8&255,Tr&255]))}static minf(Tr){return Tr.type==="audio"?MP4.box(MP4.types.minf,MP4.box(MP4.types.smhd,MP4.SMHD),MP4.DINF,MP4.stbl(Tr)):MP4.box(MP4.types.minf,MP4.box(MP4.types.vmhd,MP4.VMHD),MP4.DINF,MP4.stbl(Tr))}static moof(Tr,Ar,Rr){return MP4.box(MP4.types.moof,MP4.mfhd(Tr),MP4.traf(Rr,Ar))}static moov(Tr){let Ar=Tr.length;const Rr=[];for(;Ar--;)Rr[Ar]=MP4.trak(Tr[Ar]);return MP4.box.apply(null,[MP4.types.moov,MP4.mvhd(Tr[0].timescale,Tr[0].duration)].concat(Rr).concat(MP4.mvex(Tr)))}static mvex(Tr){let Ar=Tr.length;const Rr=[];for(;Ar--;)Rr[Ar]=MP4.trex(Tr[Ar]);return MP4.box.apply(null,[MP4.types.mvex,...Rr])}static mvhd(Tr,Ar){Ar*=Tr;const Rr=Math.floor(Ar/(UINT32_MAX+1)),Pr=Math.floor(Ar%(UINT32_MAX+1)),Dr=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,Tr>>24&255,Tr>>16&255,Tr>>8&255,Tr&255,Rr>>24,Rr>>16&255,Rr>>8&255,Rr&255,Pr>>24,Pr>>16&255,Pr>>8&255,Pr&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return MP4.box(MP4.types.mvhd,Dr)}static sdtp(Tr){const Ar=Tr.samples||[],Rr=new Uint8Array(4+Ar.length);let Pr,Dr;for(Pr=0;Pr<Ar.length;Pr++)Dr=Ar[Pr].flags,Rr[Pr+4]=Dr.dependsOn<<4|Dr.isDependedOn<<2|Dr.hasRedundancy;return MP4.box(MP4.types.sdtp,Rr)}static stbl(Tr){return MP4.box(MP4.types.stbl,MP4.stsd(Tr),MP4.box(MP4.types.stts,MP4.STTS),MP4.box(MP4.types.stsc,MP4.STSC),MP4.box(MP4.types.stsz,MP4.STSZ),MP4.box(MP4.types.stco,MP4.STCO))}static avc1(Tr){let Ar=[],Rr=[],Pr,Dr,Mr;for(Pr=0;Pr<Tr.sps.length;Pr++)Dr=Tr.sps[Pr],Mr=Dr.byteLength,Ar.push(Mr>>>8&255),Ar.push(Mr&255),Ar=Ar.concat(Array.prototype.slice.call(Dr));for(Pr=0;Pr<Tr.pps.length;Pr++)Dr=Tr.pps[Pr],Mr=Dr.byteLength,Rr.push(Mr>>>8&255),Rr.push(Mr&255),Rr=Rr.concat(Array.prototype.slice.call(Dr));const Fr=MP4.box(MP4.types.avcC,new Uint8Array([1,Ar[3],Ar[4],Ar[5],255,224|Tr.sps.length].concat(Ar).concat([Tr.pps.length]).concat(Rr))),zr=Tr.width,jr=Tr.height,Gr=Tr.pixelRatio[0],Nr=Tr.pixelRatio[1];return MP4.box(MP4.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,zr>>8&255,zr&255,jr>>8&255,jr&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),Fr,MP4.box(MP4.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),MP4.box(MP4.types.pasp,new Uint8Array([Gr>>24,Gr>>16&255,Gr>>8&255,Gr&255,Nr>>24,Nr>>16&255,Nr>>8&255,Nr&255])))}static esds(Tr){const Ar=Tr.config.length;return new Uint8Array([0,0,0,0,3,23+Ar,0,1,0,4,15+Ar,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([Ar]).concat(Tr.config).concat([6,1,2]))}static mp4a(Tr){const Ar=Tr.samplerate;return MP4.box(MP4.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,Tr.channelCount,0,16,0,0,0,0,Ar>>8&255,Ar&255,0,0]),MP4.box(MP4.types.esds,MP4.esds(Tr)))}static mp3(Tr){const Ar=Tr.samplerate;return MP4.box(MP4.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,Tr.channelCount,0,16,0,0,0,0,Ar>>8&255,Ar&255,0,0]))}static stsd(Tr){return Tr.type==="audio"?Tr.segmentCodec==="mp3"&&Tr.codec==="mp3"?MP4.box(MP4.types.stsd,MP4.STSD,MP4.mp3(Tr)):MP4.box(MP4.types.stsd,MP4.STSD,MP4.mp4a(Tr)):MP4.box(MP4.types.stsd,MP4.STSD,MP4.avc1(Tr))}static tkhd(Tr){const Ar=Tr.id,Rr=Tr.duration*Tr.timescale,Pr=Tr.width,Dr=Tr.height,Mr=Math.floor(Rr/(UINT32_MAX+1)),Fr=Math.floor(Rr%(UINT32_MAX+1));return MP4.box(MP4.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,Ar>>24&255,Ar>>16&255,Ar>>8&255,Ar&255,0,0,0,0,Mr>>24,Mr>>16&255,Mr>>8&255,Mr&255,Fr>>24,Fr>>16&255,Fr>>8&255,Fr&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,Pr>>8&255,Pr&255,0,0,Dr>>8&255,Dr&255,0,0]))}static traf(Tr,Ar){const Rr=MP4.sdtp(Tr),Pr=Tr.id,Dr=Math.floor(Ar/(UINT32_MAX+1)),Mr=Math.floor(Ar%(UINT32_MAX+1));return MP4.box(MP4.types.traf,MP4.box(MP4.types.tfhd,new Uint8Array([0,0,0,0,Pr>>24,Pr>>16&255,Pr>>8&255,Pr&255])),MP4.box(MP4.types.tfdt,new Uint8Array([1,0,0,0,Dr>>24,Dr>>16&255,Dr>>8&255,Dr&255,Mr>>24,Mr>>16&255,Mr>>8&255,Mr&255])),MP4.trun(Tr,Rr.length+16+20+8+16+8+8),Rr)}static trak(Tr){return Tr.duration=Tr.duration||4294967295,MP4.box(MP4.types.trak,MP4.tkhd(Tr),MP4.mdia(Tr))}static trex(Tr){const Ar=Tr.id;return MP4.box(MP4.types.trex,new Uint8Array([0,0,0,0,Ar>>24,Ar>>16&255,Ar>>8&255,Ar&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(Tr,Ar){const Rr=Tr.samples||[],Pr=Rr.length,Dr=12+16*Pr,Mr=new Uint8Array(Dr);let Fr,zr,jr,Gr,Nr,Lr;for(Ar+=8+Dr,Mr.set([Tr.type==="video"?1:0,0,15,1,Pr>>>24&255,Pr>>>16&255,Pr>>>8&255,Pr&255,Ar>>>24&255,Ar>>>16&255,Ar>>>8&255,Ar&255],0),Fr=0;Fr<Pr;Fr++)zr=Rr[Fr],jr=zr.duration,Gr=zr.size,Nr=zr.flags,Lr=zr.cts,Mr.set([jr>>>24&255,jr>>>16&255,jr>>>8&255,jr&255,Gr>>>24&255,Gr>>>16&255,Gr>>>8&255,Gr&255,Nr.isLeading<<2|Nr.dependsOn,Nr.isDependedOn<<6|Nr.hasRedundancy<<4|Nr.paddingValue<<1|Nr.isNonSync,Nr.degradPrio&61440,Nr.degradPrio&15,Lr>>>24&255,Lr>>>16&255,Lr>>>8&255,Lr&255],12+16*Fr);return MP4.box(MP4.types.trun,Mr)}static initSegment(Tr){MP4.types||MP4.init();const Ar=MP4.moov(Tr),Rr=new Uint8Array(MP4.FTYP.byteLength+Ar.byteLength);return Rr.set(MP4.FTYP),Rr.set(Ar,MP4.FTYP.byteLength),Rr}}MP4.types=void 0;MP4.HDLR_TYPES=void 0;MP4.STTS=void 0;MP4.STSC=void 0;MP4.STCO=void 0;MP4.STSZ=void 0;MP4.VMHD=void 0;MP4.SMHD=void 0;MP4.STSD=void 0;MP4.FTYP=void 0;MP4.DINF=void 0;const MPEG_TS_CLOCK_FREQ_HZ=9e4;function toTimescaleFromBase(_r,Tr,Ar=1,Rr=!1){const Pr=_r*Tr*Ar;return Rr?Math.round(Pr):Pr}function toTimescaleFromScale(_r,Tr,Ar=1,Rr=!1){return toTimescaleFromBase(_r,Tr,1/Ar,Rr)}function toMsFromMpegTsClock(_r,Tr=!1){return toTimescaleFromBase(_r,1e3,1/MPEG_TS_CLOCK_FREQ_HZ,Tr)}function toMpegTsClockFromTimescale(_r,Tr=1){return toTimescaleFromBase(_r,MPEG_TS_CLOCK_FREQ_HZ,1/Tr)}const MAX_SILENT_FRAME_DURATION=10*1e3,AAC_SAMPLES_PER_FRAME=1024,MPEG_AUDIO_SAMPLE_PER_FRAME=1152;let chromeVersion=null,safariWebkitVersion=null;class MP4Remuxer{constructor(Tr,Ar,Rr,Pr=""){if(this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextAvcDts=null,this.nextAudioPts=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.observer=Tr,this.config=Ar,this.typeSupported=Rr,this.ISGenerated=!1,chromeVersion===null){const Mr=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);chromeVersion=Mr?parseInt(Mr[1]):0}if(safariWebkitVersion===null){const Dr=navigator.userAgent.match(/Safari\/(\d+)/i);safariWebkitVersion=Dr?parseInt(Dr[1]):0}}destroy(){}resetTimeStamp(Tr){logger.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=Tr}resetNextTimestamp(){logger.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){logger.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1}getVideoStartPts(Tr){let Ar=!1;const Rr=Tr.reduce((Pr,Dr)=>{const Mr=Dr.pts-Pr;return Mr<-4294967296?(Ar=!0,normalizePts(Pr,Dr.pts)):Mr>0?Pr:Dr.pts},Tr[0].pts);return Ar&&logger.debug("PTS rollover detected"),Rr}remux(Tr,Ar,Rr,Pr,Dr,Mr,Fr,zr){let jr,Gr,Nr,Lr,Ur,Vr,Wr=Dr,qr=Dr;const Kr=Tr.pid>-1,Xr=Ar.pid>-1,Zr=Ar.samples.length,_i=Tr.samples.length>0,Jr=Fr&&Zr>0||Zr>1;if((!Kr||_i)&&(!Xr||Jr)||this.ISGenerated||Fr){this.ISGenerated||(Nr=this.generateIS(Tr,Ar,Dr,Mr));const ts=this.isVideoContiguous;let is=-1,rs;if(Jr&&(is=findKeyframeIndex(Ar.samples),!ts&&this.config.forceKeyFrameOnDiscontinuity))if(Vr=!0,is>0){logger.warn(`[mp4-remuxer]: Dropped ${is} out of ${Zr} video samples due to a missing keyframe`);const as=this.getVideoStartPts(Ar.samples);Ar.samples=Ar.samples.slice(is),Ar.dropped+=is,qr+=(Ar.samples[0].pts-as)/Ar.inputTimeScale,rs=qr}else is===-1&&(logger.warn(`[mp4-remuxer]: No keyframe found out of ${Zr} video samples`),Vr=!1);if(this.ISGenerated){if(_i&&Jr){const as=this.getVideoStartPts(Ar.samples),fs=(normalizePts(Tr.samples[0].pts,as)-as)/Ar.inputTimeScale;Wr+=Math.max(0,fs),qr+=Math.max(0,-fs)}if(_i){if(Tr.samplerate||(logger.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),Nr=this.generateIS(Tr,Ar,Dr,Mr)),Gr=this.remuxAudio(Tr,Wr,this.isAudioContiguous,Mr,Xr||Jr||zr===PlaylistLevelType.AUDIO?qr:void 0),Jr){const as=Gr?Gr.endPTS-Gr.startPTS:0;Ar.inputTimeScale||(logger.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),Nr=this.generateIS(Tr,Ar,Dr,Mr)),jr=this.remuxVideo(Ar,qr,ts,as)}}else Jr&&(jr=this.remuxVideo(Ar,qr,ts,0));jr&&(jr.firstKeyFrame=is,jr.independent=is!==-1,jr.firstKeyFramePTS=rs)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(Rr.samples.length&&(Ur=flushTextTrackMetadataCueSamples(Rr,Dr,this._initPTS,this._initDTS)),Pr.samples.length&&(Lr=flushTextTrackUserdataCueSamples(Pr,Dr,this._initPTS))),{audio:Gr,video:jr,initSegment:Nr,independent:Vr,text:Lr,id3:Ur}}generateIS(Tr,Ar,Rr,Pr){const Dr=Tr.samples,Mr=Ar.samples,Fr=this.typeSupported,zr={},jr=this._initPTS;let Gr=!jr||Pr,Nr="audio/mp4",Lr,Ur,Vr;if(Gr&&(Lr=Ur=1/0),Tr.config&&Dr.length){switch(Tr.timescale=Tr.samplerate,Tr.segmentCodec){case"mp3":Fr.mpeg?(Nr="audio/mpeg",Tr.codec=""):Fr.mp3&&(Tr.codec="mp3");break}zr.audio={id:"audio",container:Nr,codec:Tr.codec,initSegment:Tr.segmentCodec==="mp3"&&Fr.mpeg?new Uint8Array(0):MP4.initSegment([Tr]),metadata:{channelCount:Tr.channelCount}},Gr&&(Vr=Tr.inputTimeScale,!jr||Vr!==jr.timescale?Lr=Ur=Dr[0].pts-Math.round(Vr*Rr):Gr=!1)}if(Ar.sps&&Ar.pps&&Mr.length&&(Ar.timescale=Ar.inputTimeScale,zr.video={id:"main",container:"video/mp4",codec:Ar.codec,initSegment:MP4.initSegment([Ar]),metadata:{width:Ar.width,height:Ar.height}},Gr))if(Vr=Ar.inputTimeScale,!jr||Vr!==jr.timescale){const Wr=this.getVideoStartPts(Mr),qr=Math.round(Vr*Rr);Ur=Math.min(Ur,normalizePts(Mr[0].dts,Wr)-qr),Lr=Math.min(Lr,Wr-qr)}else Gr=!1;if(Object.keys(zr).length)return this.ISGenerated=!0,Gr?(this._initPTS={baseTime:Lr,timescale:Vr},this._initDTS={baseTime:Ur,timescale:Vr}):Lr=Vr=void 0,{tracks:zr,initPTS:Lr,timescale:Vr}}remuxVideo(Tr,Ar,Rr,Pr){const Dr=Tr.inputTimeScale,Mr=Tr.samples,Fr=[],zr=Mr.length,jr=this._initPTS;let Gr=this.nextAvcDts,Nr=8,Lr=this.videoSampleDuration,Ur,Vr,Wr=Number.POSITIVE_INFINITY,qr=Number.NEGATIVE_INFINITY,Kr=!1;if(!Rr||Gr===null){const vs=Ar*Dr,Ds=Mr[0].pts-normalizePts(Mr[0].dts,Mr[0].pts);Gr=vs-Ds}const Xr=jr.baseTime*Dr/jr.timescale;for(let vs=0;vs<zr;vs++){const Ds=Mr[vs];Ds.pts=normalizePts(Ds.pts-Xr,Gr),Ds.dts=normalizePts(Ds.dts-Xr,Gr),Ds.dts<Mr[vs>0?vs-1:vs].dts&&(Kr=!0)}Kr&&Mr.sort(function(vs,Ds){const js=vs.dts-Ds.dts,zs=vs.pts-Ds.pts;return js||zs}),Ur=Mr[0].dts,Vr=Mr[Mr.length-1].dts;const Zr=Vr-Ur,_i=Zr?Math.round(Zr/(zr-1)):Lr||Tr.inputTimeScale/30;if(Rr){const vs=Ur-Gr,Ds=vs>_i,js=vs<-1;if((Ds||js)&&(Ds?logger.warn(`AVC: ${toMsFromMpegTsClock(vs,!0)} ms (${vs}dts) hole between fragments detected, filling it`):logger.warn(`AVC: ${toMsFromMpegTsClock(-vs,!0)} ms (${vs}dts) overlapping between fragments detected`),!js||Gr>=Mr[0].pts)){Ur=Gr;const zs=Mr[0].pts-vs;Mr[0].dts=Ur,Mr[0].pts=zs,logger.log(`Video: First PTS/DTS adjusted: ${toMsFromMpegTsClock(zs,!0)}/${toMsFromMpegTsClock(Ur,!0)}, delta: ${toMsFromMpegTsClock(vs,!0)} ms`)}}Ur=Math.max(0,Ur);let Jr=0,es=0;for(let vs=0;vs<zr;vs++){const Ds=Mr[vs],js=Ds.units,zs=js.length;let qs=0;for(let fo=0;fo<zs;fo++)qs+=js[fo].data.length;es+=qs,Jr+=zs,Ds.length=qs,Ds.dts=Math.max(Ds.dts,Ur),Wr=Math.min(Ds.pts,Wr),qr=Math.max(Ds.pts,qr)}Vr=Mr[zr-1].dts;const ts=es+4*Jr+8;let is;try{is=new Uint8Array(ts)}catch(vs){this.observer.emit(Events.ERROR,Events.ERROR,{type:ErrorTypes.MUX_ERROR,details:ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,error:vs,bytes:ts,reason:`fail allocating video mdat ${ts}`});return}const rs=new DataView(is.buffer);rs.setUint32(0,ts),is.set(MP4.types.mdat,4);let as=!1,ls=Number.POSITIVE_INFINITY,fs=Number.POSITIVE_INFINITY,Ts=Number.NEGATIVE_INFINITY,$s=Number.NEGATIVE_INFINITY;for(let vs=0;vs<zr;vs++){const Ds=Mr[vs],js=Ds.units;let zs=0;for(let Qs=0,no=js.length;Qs<no;Qs++){const yo=js[Qs],Js=yo.data,lo=yo.data.byteLength;rs.setUint32(Nr,lo),Nr+=4,is.set(Js,Nr),Nr+=lo,zs+=4+lo}let qs;if(vs<zr-1)Lr=Mr[vs+1].dts-Ds.dts,qs=Mr[vs+1].pts-Ds.pts;else{const Qs=this.config,no=vs>0?Ds.dts-Mr[vs-1].dts:_i;if(qs=vs>0?Ds.pts-Mr[vs-1].pts:_i,Qs.stretchShortVideoTrack&&this.nextAudioPts!==null){const yo=Math.floor(Qs.maxBufferHole*Dr),Js=(Pr?Wr+Pr*Dr:this.nextAudioPts)-Ds.pts;Js>yo?(Lr=Js-no,Lr<0?Lr=no:as=!0,logger.log(`[mp4-remuxer]: It is approximately ${Js/90} ms to the next segment; using duration ${Lr/90} ms for the last video frame.`)):Lr=no}else Lr=no}const fo=Math.round(Ds.pts-Ds.dts);ls=Math.min(ls,Lr),Ts=Math.max(Ts,Lr),fs=Math.min(fs,qs),$s=Math.max($s,qs),Fr.push(new Mp4Sample(Ds.key,Lr,zs,fo))}if(Fr.length){if(chromeVersion){if(chromeVersion<70){const vs=Fr[0].flags;vs.dependsOn=2,vs.isNonSync=0}}else if(safariWebkitVersion&&$s-fs<Ts-ls&&_i/Ts<.025&&Fr[0].cts===0){logger.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let vs=Ur;for(let Ds=0,js=Fr.length;Ds<js;Ds++){const zs=vs+Fr[Ds].duration,qs=vs+Fr[Ds].cts;if(Ds<js-1){const fo=zs+Fr[Ds+1].cts;Fr[Ds].duration=fo-qs}else Fr[Ds].duration=Ds?Fr[Ds-1].duration:_i;Fr[Ds].cts=0,vs=zs}}}Lr=as||!Lr?_i:Lr,this.nextAvcDts=Gr=Vr+Lr,this.videoSampleDuration=Lr,this.isVideoContiguous=!0;const xs=MP4.moof(Tr.sequenceNumber++,Ur,_extends({},Tr,{samples:Fr})),ys="video",ps={data1:xs,data2:is,startPTS:Wr/Dr,endPTS:(qr+Lr)/Dr,startDTS:Ur/Dr,endDTS:Gr/Dr,type:ys,hasAudio:!1,hasVideo:!0,nb:Fr.length,dropped:Tr.dropped};return Tr.samples=[],Tr.dropped=0,ps}remuxAudio(Tr,Ar,Rr,Pr,Dr){const Mr=Tr.inputTimeScale,Fr=Tr.samplerate?Tr.samplerate:Mr,zr=Mr/Fr,jr=Tr.segmentCodec==="aac"?AAC_SAMPLES_PER_FRAME:MPEG_AUDIO_SAMPLE_PER_FRAME,Gr=jr*zr,Nr=this._initPTS,Lr=Tr.segmentCodec==="mp3"&&this.typeSupported.mpeg,Ur=[],Vr=Dr!==void 0;let Wr=Tr.samples,qr=Lr?0:8,Kr=this.nextAudioPts||-1;const Xr=Ar*Mr,Zr=Nr.baseTime*Mr/Nr.timescale;if(this.isAudioContiguous=Rr=Rr||Wr.length&&Kr>0&&(Pr&&Math.abs(Xr-Kr)<9e3||Math.abs(normalizePts(Wr[0].pts-Zr,Xr)-Kr)<20*Gr),Wr.forEach(function(ys){ys.pts=normalizePts(ys.pts-Zr,Xr)}),!Rr||Kr<0){if(Wr=Wr.filter(ys=>ys.pts>=0),!Wr.length)return;Dr===0?Kr=0:Pr&&!Vr?Kr=Math.max(0,Xr):Kr=Wr[0].pts}if(Tr.segmentCodec==="aac"){const ys=this.config.maxAudioFramesDrift;for(let ps=0,vs=Kr;ps<Wr.length;ps++){const Ds=Wr[ps],js=Ds.pts,zs=js-vs,qs=Math.abs(1e3*zs/Mr);if(zs<=-ys*Gr&&Vr)ps===0&&(logger.warn(`Audio frame @ ${(js/Mr).toFixed(3)}s overlaps nextAudioPts by ${Math.round(1e3*zs/Mr)} ms.`),this.nextAudioPts=Kr=vs=js);else if(zs>=ys*Gr&&qs<MAX_SILENT_FRAME_DURATION&&Vr){let fo=Math.round(zs/Gr);vs=js-fo*Gr,vs<0&&(fo--,vs+=Gr),ps===0&&(this.nextAudioPts=Kr=vs),logger.warn(`[mp4-remuxer]: Injecting ${fo} audio frame @ ${(vs/Mr).toFixed(3)}s due to ${Math.round(1e3*zs/Mr)} ms gap.`);for(let Qs=0;Qs<fo;Qs++){const no=Math.max(vs,0);let yo=AAC.getSilentFrame(Tr.manifestCodec||Tr.codec,Tr.channelCount);yo||(logger.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),yo=Ds.unit.subarray()),Wr.splice(ps,0,{unit:yo,pts:no}),vs+=Gr,ps++}}Ds.pts=vs,vs+=Gr}}let _i=null,Jr=null,es,ts=0,is=Wr.length;for(;is--;)ts+=Wr[is].unit.byteLength;for(let ys=0,ps=Wr.length;ys<ps;ys++){const vs=Wr[ys],Ds=vs.unit;let js=vs.pts;if(Jr!==null){const qs=Ur[ys-1];qs.duration=Math.round((js-Jr)/zr)}else if(Rr&&Tr.segmentCodec==="aac"&&(js=Kr),_i=js,ts>0){ts+=qr;try{es=new Uint8Array(ts)}catch(qs){this.observer.emit(Events.ERROR,Events.ERROR,{type:ErrorTypes.MUX_ERROR,details:ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,error:qs,bytes:ts,reason:`fail allocating audio mdat ${ts}`});return}Lr||(new DataView(es.buffer).setUint32(0,ts),es.set(MP4.types.mdat,4))}else return;es.set(Ds,qr);const zs=Ds.byteLength;qr+=zs,Ur.push(new Mp4Sample(!0,jr,zs,0)),Jr=js}const rs=Ur.length;if(!rs)return;const as=Ur[Ur.length-1];this.nextAudioPts=Kr=Jr+zr*as.duration;const ls=Lr?new Uint8Array(0):MP4.moof(Tr.sequenceNumber++,_i/zr,_extends({},Tr,{samples:Ur}));Tr.samples=[];const fs=_i/Mr,Ts=Kr/Mr,xs={data1:ls,data2:es,startPTS:fs,endPTS:Ts,startDTS:fs,endDTS:Ts,type:"audio",hasAudio:!0,hasVideo:!1,nb:rs};return this.isAudioContiguous=!0,xs}remuxEmptyAudio(Tr,Ar,Rr,Pr){const Dr=Tr.inputTimeScale,Mr=Tr.samplerate?Tr.samplerate:Dr,Fr=Dr/Mr,zr=this.nextAudioPts,jr=this._initDTS,Gr=jr.baseTime*9e4/jr.timescale,Nr=(zr!==null?zr:Pr.startDTS*Dr)+Gr,Lr=Pr.endDTS*Dr+Gr,Ur=Fr*AAC_SAMPLES_PER_FRAME,Vr=Math.ceil((Lr-Nr)/Ur),Wr=AAC.getSilentFrame(Tr.manifestCodec||Tr.codec,Tr.channelCount);if(logger.warn("[mp4-remuxer]: remux empty Audio"),!Wr){logger.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec");return}const qr=[];for(let Kr=0;Kr<Vr;Kr++){const Xr=Nr+Kr*Ur;qr.push({unit:Wr,pts:Xr,dts:Xr})}return Tr.samples=qr,this.remuxAudio(Tr,Ar,Rr,!1)}}function normalizePts(_r,Tr){let Ar;if(Tr===null)return _r;for(Tr<_r?Ar=-8589934592:Ar=8589934592;Math.abs(_r-Tr)>4294967296;)_r+=Ar;return _r}function findKeyframeIndex(_r){for(let Tr=0;Tr<_r.length;Tr++)if(_r[Tr].key)return Tr;return-1}function flushTextTrackMetadataCueSamples(_r,Tr,Ar,Rr){const Pr=_r.samples.length;if(!Pr)return;const Dr=_r.inputTimeScale;for(let Fr=0;Fr<Pr;Fr++){const zr=_r.samples[Fr];zr.pts=normalizePts(zr.pts-Ar.baseTime*Dr/Ar.timescale,Tr*Dr)/Dr,zr.dts=normalizePts(zr.dts-Rr.baseTime*Dr/Rr.timescale,Tr*Dr)/Dr}const Mr=_r.samples;return _r.samples=[],{samples:Mr}}function flushTextTrackUserdataCueSamples(_r,Tr,Ar){const Rr=_r.samples.length;if(!Rr)return;const Pr=_r.inputTimeScale;for(let Mr=0;Mr<Rr;Mr++){const Fr=_r.samples[Mr];Fr.pts=normalizePts(Fr.pts-Ar.baseTime*Pr/Ar.timescale,Tr*Pr)/Pr}_r.samples.sort((Mr,Fr)=>Mr.pts-Fr.pts);const Dr=_r.samples;return _r.samples=[],{samples:Dr}}class Mp4Sample{constructor(Tr,Ar,Rr,Pr){this.size=void 0,this.duration=void 0,this.cts=void 0,this.flags=void 0,this.duration=Ar,this.size=Rr,this.cts=Pr,this.flags=new Mp4SampleFlags(Tr)}}class Mp4SampleFlags{constructor(Tr){this.isLeading=0,this.isDependedOn=0,this.hasRedundancy=0,this.degradPrio=0,this.dependsOn=1,this.isNonSync=1,this.dependsOn=Tr?2:1,this.isNonSync=Tr?0:1}}class PassThroughRemuxer{constructor(){this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null}destroy(){}resetTimeStamp(Tr){this.initPTS=Tr,this.lastEndTime=null}resetNextTimestamp(){this.lastEndTime=null}resetInitSegment(Tr,Ar,Rr,Pr){this.audioCodec=Ar,this.videoCodec=Rr,this.generateInitSegment(patchEncyptionData(Tr,Pr)),this.emitInitSegment=!0}generateInitSegment(Tr){let{audioCodec:Ar,videoCodec:Rr}=this;if(!(Tr!=null&&Tr.byteLength)){this.initTracks=void 0,this.initData=void 0;return}const Pr=this.initData=parseInitSegment(Tr);Ar||(Ar=getParsedTrackCodec(Pr.audio,ElementaryStreamTypes.AUDIO)),Rr||(Rr=getParsedTrackCodec(Pr.video,ElementaryStreamTypes.VIDEO));const Dr={};Pr.audio&&Pr.video?Dr.audiovideo={container:"video/mp4",codec:Ar+","+Rr,initSegment:Tr,id:"main"}:Pr.audio?Dr.audio={container:"audio/mp4",codec:Ar,initSegment:Tr,id:"audio"}:Pr.video?Dr.video={container:"video/mp4",codec:Rr,initSegment:Tr,id:"main"}:logger.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=Dr}remux(Tr,Ar,Rr,Pr,Dr,Mr){var Fr,zr;let{initPTS:jr,lastEndTime:Gr}=this;const Nr={audio:void 0,video:void 0,text:Pr,id3:Rr,initSegment:void 0};isFiniteNumber(Gr)||(Gr=this.lastEndTime=Dr||0);const Lr=Ar.samples;if(!(Lr!=null&&Lr.length))return Nr;const Ur={initPTS:void 0,timescale:1};let Vr=this.initData;if((Fr=Vr)!=null&&Fr.length||(this.generateInitSegment(Lr),Vr=this.initData),!((zr=Vr)!=null&&zr.length))return logger.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),Nr;this.emitInitSegment&&(Ur.tracks=this.initTracks,this.emitInitSegment=!1);const Wr=getDuration(Lr,Vr),qr=getStartDTS(Vr,Lr),Kr=qr===null?Dr:qr;(isInvalidInitPts(jr,Kr,Dr,Wr)||Ur.timescale!==jr.timescale&&Mr)&&(Ur.initPTS=Kr-Dr,jr&&jr.timescale===1&&logger.warn(`Adjusting initPTS by ${Ur.initPTS-jr.baseTime}`),this.initPTS=jr={baseTime:Ur.initPTS,timescale:1});const Xr=Tr?Kr-jr.baseTime/jr.timescale:Gr,Zr=Xr+Wr;offsetStartDTS(Vr,Lr,jr.baseTime/jr.timescale),Wr>0?this.lastEndTime=Zr:(logger.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());const _i=!!Vr.audio,Jr=!!Vr.video;let es="";_i&&(es+="audio"),Jr&&(es+="video");const ts={data1:Lr,startPTS:Xr,startDTS:Xr,endPTS:Zr,endDTS:Zr,type:es,hasAudio:_i,hasVideo:Jr,nb:1,dropped:0};return Nr.audio=ts.type==="audio"?ts:void 0,Nr.video=ts.type!=="audio"?ts:void 0,Nr.initSegment=Ur,Nr.id3=flushTextTrackMetadataCueSamples(Rr,Dr,jr,jr),Pr.samples.length&&(Nr.text=flushTextTrackUserdataCueSamples(Pr,Dr,jr)),Nr}}function isInvalidInitPts(_r,Tr,Ar,Rr){if(_r===null)return!0;const Pr=Math.max(Rr,1),Dr=Tr-_r.baseTime/_r.timescale;return Math.abs(Dr-Ar)>Pr}function getParsedTrackCodec(_r,Tr){const Ar=_r==null?void 0:_r.codec;return Ar&&Ar.length>4?Ar:Ar==="hvc1"||Ar==="hev1"?"hvc1.1.6.L120.90":Ar==="av01"?"av01.0.04M.08":Ar==="avc1"||Tr===ElementaryStreamTypes.VIDEO?"avc1.42e01e":"mp4a.40.5"}let now;try{now=self.performance.now.bind(self.performance)}catch{logger.debug("Unable to use Performance API on this environment"),now=typeof self<"u"&&self.Date.now}const muxConfig=[{demux:MP4Demuxer,remux:PassThroughRemuxer},{demux:TSDemuxer,remux:MP4Remuxer},{demux:AACDemuxer,remux:MP4Remuxer},{demux:MP3Demuxer,remux:MP4Remuxer}];class Transmuxer{constructor(Tr,Ar,Rr,Pr,Dr){this.async=!1,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.vendor=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=Tr,this.typeSupported=Ar,this.config=Rr,this.vendor=Pr,this.id=Dr}configure(Tr){this.transmuxConfig=Tr,this.decrypter&&this.decrypter.reset()}push(Tr,Ar,Rr,Pr){const Dr=Rr.transmuxing;Dr.executeStart=now();let Mr=new Uint8Array(Tr);const{currentTransmuxState:Fr,transmuxConfig:zr}=this;Pr&&(this.currentTransmuxState=Pr);const{contiguous:jr,discontinuity:Gr,trackSwitch:Nr,accurateTimeOffset:Lr,timeOffset:Ur,initSegmentChange:Vr}=Pr||Fr,{audioCodec:Wr,videoCodec:qr,defaultInitPts:Kr,duration:Xr,initSegmentData:Zr}=zr,_i=getEncryptionType(Mr,Ar);if(_i&&_i.method==="AES-128"){const is=this.getDecrypter();if(is.isSync()){let rs=is.softwareDecrypt(Mr,_i.key.buffer,_i.iv.buffer);if(Rr.part>-1&&(rs=is.flush()),!rs)return Dr.executeEnd=now(),emptyResult(Rr);Mr=new Uint8Array(rs)}else return this.decryptionPromise=is.webCryptoDecrypt(Mr,_i.key.buffer,_i.iv.buffer).then(rs=>{const as=this.push(rs,null,Rr);return this.decryptionPromise=null,as}),this.decryptionPromise}const Jr=this.needsProbing(Gr,Nr);if(Jr){const is=this.configureTransmuxer(Mr);if(is)return logger.warn(`[transmuxer] ${is.message}`),this.observer.emit(Events.ERROR,Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,error:is,reason:is.message}),Dr.executeEnd=now(),emptyResult(Rr)}(Gr||Nr||Vr||Jr)&&this.resetInitSegment(Zr,Wr,qr,Xr,Ar),(Gr||Vr||Jr)&&this.resetInitialTimestamp(Kr),jr||this.resetContiguity();const es=this.transmux(Mr,_i,Ur,Lr,Rr),ts=this.currentTransmuxState;return ts.contiguous=!0,ts.discontinuity=!1,ts.trackSwitch=!1,Dr.executeEnd=now(),es}flush(Tr){const Ar=Tr.transmuxing;Ar.executeStart=now();const{decrypter:Rr,currentTransmuxState:Pr,decryptionPromise:Dr}=this;if(Dr)return Dr.then(()=>this.flush(Tr));const Mr=[],{timeOffset:Fr}=Pr;if(Rr){const Nr=Rr.flush();Nr&&Mr.push(this.push(Nr,null,Tr))}const{demuxer:zr,remuxer:jr}=this;if(!zr||!jr)return Ar.executeEnd=now(),[emptyResult(Tr)];const Gr=zr.flush(Fr);return isPromise(Gr)?Gr.then(Nr=>(this.flushRemux(Mr,Nr,Tr),Mr)):(this.flushRemux(Mr,Gr,Tr),Mr)}flushRemux(Tr,Ar,Rr){const{audioTrack:Pr,videoTrack:Dr,id3Track:Mr,textTrack:Fr}=Ar,{accurateTimeOffset:zr,timeOffset:jr}=this.currentTransmuxState;logger.log(`[transmuxer.ts]: Flushed fragment ${Rr.sn}${Rr.part>-1?" p: "+Rr.part:""} of level ${Rr.level}`);const Gr=this.remuxer.remux(Pr,Dr,Mr,Fr,jr,zr,!0,this.id);Tr.push({remuxResult:Gr,chunkMeta:Rr}),Rr.transmuxing.executeEnd=now()}resetInitialTimestamp(Tr){const{demuxer:Ar,remuxer:Rr}=this;!Ar||!Rr||(Ar.resetTimeStamp(Tr),Rr.resetTimeStamp(Tr))}resetContiguity(){const{demuxer:Tr,remuxer:Ar}=this;!Tr||!Ar||(Tr.resetContiguity(),Ar.resetNextTimestamp())}resetInitSegment(Tr,Ar,Rr,Pr,Dr){const{demuxer:Mr,remuxer:Fr}=this;!Mr||!Fr||(Mr.resetInitSegment(Tr,Ar,Rr,Pr),Fr.resetInitSegment(Tr,Ar,Rr,Dr))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(Tr,Ar,Rr,Pr,Dr){let Mr;return Ar&&Ar.method==="SAMPLE-AES"?Mr=this.transmuxSampleAes(Tr,Ar,Rr,Pr,Dr):Mr=this.transmuxUnencrypted(Tr,Rr,Pr,Dr),Mr}transmuxUnencrypted(Tr,Ar,Rr,Pr){const{audioTrack:Dr,videoTrack:Mr,id3Track:Fr,textTrack:zr}=this.demuxer.demux(Tr,Ar,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(Dr,Mr,Fr,zr,Ar,Rr,!1,this.id),chunkMeta:Pr}}transmuxSampleAes(Tr,Ar,Rr,Pr,Dr){return this.demuxer.demuxSampleAes(Tr,Ar,Rr).then(Mr=>({remuxResult:this.remuxer.remux(Mr.audioTrack,Mr.videoTrack,Mr.id3Track,Mr.textTrack,Rr,Pr,!1,this.id),chunkMeta:Dr}))}configureTransmuxer(Tr){const{config:Ar,observer:Rr,typeSupported:Pr,vendor:Dr}=this;let Mr;for(let Nr=0,Lr=muxConfig.length;Nr<Lr;Nr++)if(muxConfig[Nr].demux.probe(Tr)){Mr=muxConfig[Nr];break}if(!Mr)return new Error("Failed to find demuxer by probing fragment data");const Fr=this.demuxer,zr=this.remuxer,jr=Mr.remux,Gr=Mr.demux;(!zr||!(zr instanceof jr))&&(this.remuxer=new jr(Rr,Ar,Pr,Dr)),(!Fr||!(Fr instanceof Gr))&&(this.demuxer=new Gr(Rr,Ar,Pr),this.probe=Gr.probe)}needsProbing(Tr,Ar){return!this.demuxer||!this.remuxer||Tr||Ar}getDecrypter(){let Tr=this.decrypter;return Tr||(Tr=this.decrypter=new Decrypter(this.config)),Tr}}function getEncryptionType(_r,Tr){let Ar=null;return _r.byteLength>0&&Tr!=null&&Tr.key!=null&&Tr.iv!==null&&Tr.method!=null&&(Ar=Tr),Ar}const emptyResult=_r=>({remuxResult:{},chunkMeta:_r});function isPromise(_r){return"then"in _r&&_r.then instanceof Function}class TransmuxConfig{constructor(Tr,Ar,Rr,Pr,Dr){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=Tr,this.videoCodec=Ar,this.initSegmentData=Rr,this.duration=Pr,this.defaultInitPts=Dr||null}}class TransmuxState{constructor(Tr,Ar,Rr,Pr,Dr,Mr){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=Tr,this.contiguous=Ar,this.accurateTimeOffset=Rr,this.trackSwitch=Pr,this.timeOffset=Dr,this.initSegmentChange=Mr}}var eventemitter3={exports:{}};(function(_r){var Tr=Object.prototype.hasOwnProperty,Ar="~";function Rr(){}Object.create&&(Rr.prototype=Object.create(null),new Rr().__proto__||(Ar=!1));function Pr(zr,jr,Gr){this.fn=zr,this.context=jr,this.once=Gr||!1}function Dr(zr,jr,Gr,Nr,Lr){if(typeof Gr!="function")throw new TypeError("The listener must be a function");var Ur=new Pr(Gr,Nr||zr,Lr),Vr=Ar?Ar+jr:jr;return zr._events[Vr]?zr._events[Vr].fn?zr._events[Vr]=[zr._events[Vr],Ur]:zr._events[Vr].push(Ur):(zr._events[Vr]=Ur,zr._eventsCount++),zr}function Mr(zr,jr){--zr._eventsCount===0?zr._events=new Rr:delete zr._events[jr]}function Fr(){this._events=new Rr,this._eventsCount=0}Fr.prototype.eventNames=function(){var jr=[],Gr,Nr;if(this._eventsCount===0)return jr;for(Nr in Gr=this._events)Tr.call(Gr,Nr)&&jr.push(Ar?Nr.slice(1):Nr);return Object.getOwnPropertySymbols?jr.concat(Object.getOwnPropertySymbols(Gr)):jr},Fr.prototype.listeners=function(jr){var Gr=Ar?Ar+jr:jr,Nr=this._events[Gr];if(!Nr)return[];if(Nr.fn)return[Nr.fn];for(var Lr=0,Ur=Nr.length,Vr=new Array(Ur);Lr<Ur;Lr++)Vr[Lr]=Nr[Lr].fn;return Vr},Fr.prototype.listenerCount=function(jr){var Gr=Ar?Ar+jr:jr,Nr=this._events[Gr];return Nr?Nr.fn?1:Nr.length:0},Fr.prototype.emit=function(jr,Gr,Nr,Lr,Ur,Vr){var Wr=Ar?Ar+jr:jr;if(!this._events[Wr])return!1;var qr=this._events[Wr],Kr=arguments.length,Xr,Zr;if(qr.fn){switch(qr.once&&this.removeListener(jr,qr.fn,void 0,!0),Kr){case 1:return qr.fn.call(qr.context),!0;case 2:return qr.fn.call(qr.context,Gr),!0;case 3:return qr.fn.call(qr.context,Gr,Nr),!0;case 4:return qr.fn.call(qr.context,Gr,Nr,Lr),!0;case 5:return qr.fn.call(qr.context,Gr,Nr,Lr,Ur),!0;case 6:return qr.fn.call(qr.context,Gr,Nr,Lr,Ur,Vr),!0}for(Zr=1,Xr=new Array(Kr-1);Zr<Kr;Zr++)Xr[Zr-1]=arguments[Zr];qr.fn.apply(qr.context,Xr)}else{var _i=qr.length,Jr;for(Zr=0;Zr<_i;Zr++)switch(qr[Zr].once&&this.removeListener(jr,qr[Zr].fn,void 0,!0),Kr){case 1:qr[Zr].fn.call(qr[Zr].context);break;case 2:qr[Zr].fn.call(qr[Zr].context,Gr);break;case 3:qr[Zr].fn.call(qr[Zr].context,Gr,Nr);break;case 4:qr[Zr].fn.call(qr[Zr].context,Gr,Nr,Lr);break;default:if(!Xr)for(Jr=1,Xr=new Array(Kr-1);Jr<Kr;Jr++)Xr[Jr-1]=arguments[Jr];qr[Zr].fn.apply(qr[Zr].context,Xr)}}return!0},Fr.prototype.on=function(jr,Gr,Nr){return Dr(this,jr,Gr,Nr,!1)},Fr.prototype.once=function(jr,Gr,Nr){return Dr(this,jr,Gr,Nr,!0)},Fr.prototype.removeListener=function(jr,Gr,Nr,Lr){var Ur=Ar?Ar+jr:jr;if(!this._events[Ur])return this;if(!Gr)return Mr(this,Ur),this;var Vr=this._events[Ur];if(Vr.fn)Vr.fn===Gr&&(!Lr||Vr.once)&&(!Nr||Vr.context===Nr)&&Mr(this,Ur);else{for(var Wr=0,qr=[],Kr=Vr.length;Wr<Kr;Wr++)(Vr[Wr].fn!==Gr||Lr&&!Vr[Wr].once||Nr&&Vr[Wr].context!==Nr)&&qr.push(Vr[Wr]);qr.length?this._events[Ur]=qr.length===1?qr[0]:qr:Mr(this,Ur)}return this},Fr.prototype.removeAllListeners=function(jr){var Gr;return jr?(Gr=Ar?Ar+jr:jr,this._events[Gr]&&Mr(this,Gr)):(this._events=new Rr,this._eventsCount=0),this},Fr.prototype.off=Fr.prototype.removeListener,Fr.prototype.addListener=Fr.prototype.on,Fr.prefixed=Ar,Fr.EventEmitter=Fr,_r.exports=Fr})(eventemitter3);var eventemitter3Exports=eventemitter3.exports,EventEmitter=getDefaultExportFromCjs(eventemitter3Exports);const MediaSource$1=getMediaSource()||{isTypeSupported:()=>!1};class TransmuxerInterface{constructor(Tr,Ar,Rr,Pr){this.error=null,this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0;const Dr=Tr.config;this.hls=Tr,this.id=Ar,this.useWorker=!!Dr.enableWorker,this.onTransmuxComplete=Rr,this.onFlush=Pr;const Mr=(jr,Gr)=>{Gr=Gr||{},Gr.frag=this.frag,Gr.id=this.id,jr===Events.ERROR&&(this.error=Gr.error),this.hls.trigger(jr,Gr)};this.observer=new EventEmitter,this.observer.on(Events.FRAG_DECRYPTED,Mr),this.observer.on(Events.ERROR,Mr);const Fr={mp4:MediaSource$1.isTypeSupported("video/mp4"),mpeg:MediaSource$1.isTypeSupported("audio/mpeg"),mp3:MediaSource$1.isTypeSupported('audio/mp4; codecs="mp3"')},zr=navigator.vendor;if(this.useWorker&&typeof Worker<"u"&&(Dr.workerPath||hasUMDWorker())){try{Dr.workerPath?(logger.log(`loading Web Worker ${Dr.workerPath} for "${Ar}"`),this.workerContext=loadWorker(Dr.workerPath)):(logger.log(`injecting Web Worker for "${Ar}"`),this.workerContext=injectWorker()),this.onwmsg=Nr=>this.onWorkerMessage(Nr);const{worker:Gr}=this.workerContext;Gr.addEventListener("message",this.onwmsg),Gr.onerror=Nr=>{const Lr=new Error(`${Nr.message}  (${Nr.filename}:${Nr.lineno})`);Dr.enableWorker=!1,logger.warn(`Error in "${Ar}" Web Worker, fallback to inline`),this.hls.trigger(Events.ERROR,{type:ErrorTypes.OTHER_ERROR,details:ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:Lr})},Gr.postMessage({cmd:"init",typeSupported:Fr,vendor:zr,id:Ar,config:JSON.stringify(Dr)})}catch(Gr){logger.warn(`Error setting up "${Ar}" Web Worker, fallback to inline`,Gr),this.resetWorker(),this.error=null,this.transmuxer=new Transmuxer(this.observer,Fr,Dr,zr,Ar)}return}this.transmuxer=new Transmuxer(this.observer,Fr,Dr,zr,Ar)}resetWorker(){if(this.workerContext){const{worker:Tr,objectURL:Ar}=this.workerContext;Ar&&self.URL.revokeObjectURL(Ar),Tr.removeEventListener("message",this.onwmsg),Tr.onerror=null,Tr.terminate(),this.workerContext=null}}destroy(){if(this.workerContext)this.resetWorker(),this.onwmsg=void 0;else{const Ar=this.transmuxer;Ar&&(Ar.destroy(),this.transmuxer=null)}const Tr=this.observer;Tr&&Tr.removeAllListeners(),this.frag=null,this.observer=null,this.hls=null}push(Tr,Ar,Rr,Pr,Dr,Mr,Fr,zr,jr,Gr){var Nr,Lr;jr.transmuxing.start=self.performance.now();const{transmuxer:Ur}=this,Vr=Mr?Mr.start:Dr.start,Wr=Dr.decryptdata,qr=this.frag,Kr=!(qr&&Dr.cc===qr.cc),Xr=!(qr&&jr.level===qr.level),Zr=qr?jr.sn-qr.sn:-1,_i=this.part?jr.part-this.part.index:-1,Jr=Zr===0&&jr.id>1&&jr.id===(qr==null?void 0:qr.stats.chunkCount),es=!Xr&&(Zr===1||Zr===0&&(_i===1||Jr&&_i<=0)),ts=self.performance.now();(Xr||Zr||Dr.stats.parsing.start===0)&&(Dr.stats.parsing.start=ts),Mr&&(_i||!es)&&(Mr.stats.parsing.start=ts);const is=!(qr&&((Nr=Dr.initSegment)==null?void 0:Nr.url)===((Lr=qr.initSegment)==null?void 0:Lr.url)),rs=new TransmuxState(Kr,es,zr,Xr,Vr,is);if(!es||Kr||is){logger.log(`[transmuxer-interface, ${Dr.type}]: Starting new transmux session for sn: ${jr.sn} p: ${jr.part} level: ${jr.level} id: ${jr.id}
        discontinuity: ${Kr}
        trackSwitch: ${Xr}
        contiguous: ${es}
        accurateTimeOffset: ${zr}
        timeOffset: ${Vr}
        initSegmentChange: ${is}`);const as=new TransmuxConfig(Rr,Pr,Ar,Fr,Gr);this.configureTransmuxer(as)}if(this.frag=Dr,this.part=Mr,this.workerContext)this.workerContext.worker.postMessage({cmd:"demux",data:Tr,decryptdata:Wr,chunkMeta:jr,state:rs},Tr instanceof ArrayBuffer?[Tr]:[]);else if(Ur){const as=Ur.push(Tr,Wr,jr,rs);isPromise(as)?(Ur.async=!0,as.then(ls=>{this.handleTransmuxComplete(ls)}).catch(ls=>{this.transmuxerError(ls,jr,"transmuxer-interface push error")})):(Ur.async=!1,this.handleTransmuxComplete(as))}}flush(Tr){Tr.transmuxing.start=self.performance.now();const{transmuxer:Ar}=this;if(this.workerContext)this.workerContext.worker.postMessage({cmd:"flush",chunkMeta:Tr});else if(Ar){let Rr=Ar.flush(Tr);isPromise(Rr)||Ar.async?(isPromise(Rr)||(Rr=Promise.resolve(Rr)),Rr.then(Dr=>{this.handleFlushResult(Dr,Tr)}).catch(Dr=>{this.transmuxerError(Dr,Tr,"transmuxer-interface flush error")})):this.handleFlushResult(Rr,Tr)}}transmuxerError(Tr,Ar,Rr){this.hls&&(this.error=Tr,this.hls.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.FRAG_PARSING_ERROR,chunkMeta:Ar,fatal:!1,error:Tr,err:Tr,reason:Rr}))}handleFlushResult(Tr,Ar){Tr.forEach(Rr=>{this.handleTransmuxComplete(Rr)}),this.onFlush(Ar)}onWorkerMessage(Tr){const Ar=Tr.data,Rr=this.hls;switch(Ar.event){case"init":{var Pr;const Dr=(Pr=this.workerContext)==null?void 0:Pr.objectURL;Dr&&self.URL.revokeObjectURL(Dr);break}case"transmuxComplete":{this.handleTransmuxComplete(Ar.data);break}case"flush":{this.onFlush(Ar.data);break}case"workerLog":logger[Ar.data.logType]&&logger[Ar.data.logType](Ar.data.message);break;default:{Ar.data=Ar.data||{},Ar.data.frag=this.frag,Ar.data.id=this.id,Rr.trigger(Ar.event,Ar.data);break}}}configureTransmuxer(Tr){const{transmuxer:Ar}=this;this.workerContext?this.workerContext.worker.postMessage({cmd:"configure",config:Tr}):Ar&&Ar.configure(Tr)}handleTransmuxComplete(Tr){Tr.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(Tr)}}const STALL_MINIMUM_DURATION_MS=250,MAX_START_GAP_JUMP=2,SKIP_BUFFER_HOLE_STEP_SECONDS=.1,SKIP_BUFFER_RANGE_START=.05;class GapController{constructor(Tr,Ar,Rr,Pr){this.config=void 0,this.media=null,this.fragmentTracker=void 0,this.hls=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.config=Tr,this.media=Ar,this.fragmentTracker=Rr,this.hls=Pr}destroy(){this.media=null,this.hls=this.fragmentTracker=null}poll(Tr,Ar){const{config:Rr,media:Pr,stalled:Dr}=this;if(Pr===null)return;const{currentTime:Mr,seeking:Fr}=Pr,zr=this.seeking&&!Fr,jr=!this.seeking&&Fr;if(this.seeking=Fr,Mr!==Tr){if(this.moved=!0,Dr!==null){if(this.stallReported){const Kr=self.performance.now()-Dr;logger.warn(`playback not stuck anymore @${Mr}, after ${Math.round(Kr)}ms`),this.stallReported=!1}this.stalled=null,this.nudgeRetry=0}return}if(jr||zr){this.stalled=null;return}if(Pr.paused&&!Fr||Pr.ended||Pr.playbackRate===0||!BufferHelper.getBuffered(Pr).length)return;const Gr=BufferHelper.bufferInfo(Pr,Mr,0),Nr=Gr.len>0,Lr=Gr.nextStart||0;if(!Nr&&!Lr)return;if(Fr){const Kr=Gr.len>MAX_START_GAP_JUMP,Xr=!Lr||Ar&&Ar.start<=Mr||Lr-Mr>MAX_START_GAP_JUMP&&!this.fragmentTracker.getPartialFragment(Mr);if(Kr||Xr)return;this.moved=!1}if(!this.moved&&this.stalled!==null){var Ur;const Kr=Math.max(Lr,Gr.start||0)-Mr,Xr=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,_i=(Xr==null||(Ur=Xr.details)==null?void 0:Ur.live)?Xr.details.targetduration*2:MAX_START_GAP_JUMP,Jr=this.fragmentTracker.getPartialFragment(Mr);if(Kr>0&&(Kr<=_i||Jr)){this._trySkipBufferHole(Jr);return}}const Vr=self.performance.now();if(Dr===null){this.stalled=Vr;return}const Wr=Vr-Dr;if(!Fr&&Wr>=STALL_MINIMUM_DURATION_MS&&(this._reportStall(Gr),!this.media))return;const qr=BufferHelper.bufferInfo(Pr,Mr,Rr.maxBufferHole);this._tryFixBufferStall(qr,Wr)}_tryFixBufferStall(Tr,Ar){const{config:Rr,fragmentTracker:Pr,media:Dr}=this;if(Dr===null)return;const Mr=Dr.currentTime,Fr=Pr.getPartialFragment(Mr);Fr&&(this._trySkipBufferHole(Fr)||!this.media)||(Tr.len>Rr.maxBufferHole||Tr.nextStart&&Tr.nextStart-Mr<Rr.maxBufferHole)&&Ar>Rr.highBufferWatchdogPeriod*1e3&&(logger.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())}_reportStall(Tr){const{hls:Ar,media:Rr,stallReported:Pr}=this;if(!Pr&&Rr){this.stallReported=!0;const Dr=new Error(`Playback stalling at @${Rr.currentTime} due to low buffer (${JSON.stringify(Tr)})`);logger.warn(Dr.message),Ar.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,error:Dr,buffer:Tr.len})}}_trySkipBufferHole(Tr){const{config:Ar,hls:Rr,media:Pr}=this;if(Pr===null)return 0;const Dr=Pr.currentTime,Mr=BufferHelper.bufferInfo(Pr,Dr,0),Fr=Dr<Mr.start?Mr.start:Mr.nextStart;if(Fr){const zr=Mr.len<=Ar.maxBufferHole,jr=Mr.len>0&&Mr.len<1&&Pr.readyState<3,Gr=Fr-Dr;if(Gr>0&&(zr||jr)){if(Gr>Ar.maxBufferHole){const{fragmentTracker:Lr}=this;let Ur=!1;if(Dr===0){const Vr=Lr.getAppendedFrag(0,PlaylistLevelType.MAIN);Vr&&Fr<Vr.end&&(Ur=!0)}if(!Ur){const Vr=Tr||Lr.getAppendedFrag(Dr,PlaylistLevelType.MAIN);if(Vr){let Wr=!1,qr=Vr.end;for(;qr<Fr;){const Kr=Lr.getPartialFragment(qr);if(Kr)qr+=Kr.duration;else{Wr=!0;break}}if(Wr)return 0}}}const Nr=Math.max(Fr+SKIP_BUFFER_RANGE_START,Dr+SKIP_BUFFER_HOLE_STEP_SECONDS);if(logger.warn(`skipping hole, adjusting currentTime from ${Dr} to ${Nr}`),this.moved=!0,this.stalled=null,Pr.currentTime=Nr,Tr&&!Tr.gap){const Lr=new Error(`fragment loaded with buffer holes, seeking from ${Dr} to ${Nr}`);Rr.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:Lr,reason:Lr.message,frag:Tr})}return Nr}}return 0}_tryNudgeBuffer(){const{config:Tr,hls:Ar,media:Rr,nudgeRetry:Pr}=this;if(Rr===null)return;const Dr=Rr.currentTime;if(this.nudgeRetry++,Pr<Tr.nudgeMaxRetry){const Mr=Dr+(Pr+1)*Tr.nudgeOffset,Fr=new Error(`Nudging 'currentTime' from ${Dr} to ${Mr}`);logger.warn(Fr.message),Rr.currentTime=Mr,Ar.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.BUFFER_NUDGE_ON_STALL,error:Fr,fatal:!1})}else{const Mr=new Error(`Playhead still not moving while enough data buffered @${Dr} after ${Tr.nudgeMaxRetry} nudges`);logger.error(Mr.message),Ar.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.BUFFER_STALLED_ERROR,error:Mr,fatal:!0})}}}const TICK_INTERVAL$2=100;class StreamController extends BaseStreamController{constructor(Tr,Ar,Rr){super(Tr,Ar,Rr,"[stream-controller]",PlaylistLevelType.MAIN),this.audioCodecSwap=!1,this.gapController=null,this.level=-1,this._forceStartLoad=!1,this.altAudio=!1,this.audioOnly=!1,this.fragPlaying=null,this.onvplaying=null,this.onvseeked=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this._registerListeners()}_registerListeners(){const{hls:Tr}=this;Tr.on(Events.MEDIA_ATTACHED,this.onMediaAttached,this),Tr.on(Events.MEDIA_DETACHING,this.onMediaDetaching,this),Tr.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),Tr.on(Events.MANIFEST_PARSED,this.onManifestParsed,this),Tr.on(Events.LEVEL_LOADING,this.onLevelLoading,this),Tr.on(Events.LEVEL_LOADED,this.onLevelLoaded,this),Tr.on(Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),Tr.on(Events.ERROR,this.onError,this),Tr.on(Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),Tr.on(Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),Tr.on(Events.BUFFER_CREATED,this.onBufferCreated,this),Tr.on(Events.BUFFER_FLUSHED,this.onBufferFlushed,this),Tr.on(Events.LEVELS_UPDATED,this.onLevelsUpdated,this),Tr.on(Events.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:Tr}=this;Tr.off(Events.MEDIA_ATTACHED,this.onMediaAttached,this),Tr.off(Events.MEDIA_DETACHING,this.onMediaDetaching,this),Tr.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),Tr.off(Events.MANIFEST_PARSED,this.onManifestParsed,this),Tr.off(Events.LEVEL_LOADED,this.onLevelLoaded,this),Tr.off(Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),Tr.off(Events.ERROR,this.onError,this),Tr.off(Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),Tr.off(Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),Tr.off(Events.BUFFER_CREATED,this.onBufferCreated,this),Tr.off(Events.BUFFER_FLUSHED,this.onBufferFlushed,this),Tr.off(Events.LEVELS_UPDATED,this.onLevelsUpdated,this),Tr.off(Events.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this._unregisterListeners(),this.onMediaDetaching()}startLoad(Tr){if(this.levels){const{lastCurrentTime:Ar,hls:Rr}=this;if(this.stopLoad(),this.setInterval(TICK_INTERVAL$2),this.level=-1,!this.startFragRequested){let Pr=Rr.startLevel;Pr===-1&&(Rr.config.testBandwidth&&this.levels.length>1?(Pr=0,this.bitrateTest=!0):Pr=Rr.nextAutoLevel),this.level=Rr.nextLoadLevel=Pr,this.loadedmetadata=!1}Ar>0&&Tr===-1&&(this.log(`Override startPosition with lastCurrentTime @${Ar.toFixed(3)}`),Tr=Ar),this.state=State.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=Tr,this.tick()}else this._forceStartLoad=!0,this.state=State.STOPPED}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case State.WAITING_LEVEL:{var Tr;const{levels:Rr,level:Pr}=this,Dr=Rr==null||(Tr=Rr[Pr])==null?void 0:Tr.details;if(Dr&&(!Dr.live||this.levelLastLoaded===this.level)){if(this.waitForCdnTuneIn(Dr))break;this.state=State.IDLE;break}else if(this.hls.nextLoadLevel!==this.level){this.state=State.IDLE;break}break}case State.FRAG_LOADING_WAITING_RETRY:{var Ar;const Rr=self.performance.now(),Pr=this.retryDate;(!Pr||Rr>=Pr||(Ar=this.media)!=null&&Ar.seeking)&&(this.resetStartWhenNotLoaded(this.level),this.state=State.IDLE)}break}this.state===State.IDLE&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){super.onTickEnd(),this.checkBuffer(),this.checkFragmentChanged()}doTickIdle(){const{hls:Tr,levelLastLoaded:Ar,levels:Rr,media:Pr}=this,{config:Dr,nextLoadLevel:Mr}=Tr;if(Ar===null||!Pr&&(this.startFragRequested||!Dr.startFragPrefetch)||this.altAudio&&this.audioOnly||!(Rr!=null&&Rr[Mr]))return;const Fr=Rr[Mr],zr=this.getMainFwdBufferInfo();if(zr===null)return;const jr=this.getLevelDetails();if(jr&&this._streamEnded(zr,jr)){const qr={};this.altAudio&&(qr.type="video"),this.hls.trigger(Events.BUFFER_EOS,qr),this.state=State.ENDED;return}Tr.loadLevel!==Mr&&Tr.manualLevel===-1&&this.log(`Adapting to level ${Mr} from level ${this.level}`),this.level=Tr.nextLoadLevel=Mr;const Gr=Fr.details;if(!Gr||this.state===State.WAITING_LEVEL||Gr.live&&this.levelLastLoaded!==Mr){this.level=Mr,this.state=State.WAITING_LEVEL;return}const Nr=zr.len,Lr=this.getMaxBufferLength(Fr.maxBitrate);if(Nr>=Lr)return;this.backtrackFragment&&this.backtrackFragment.start>zr.end&&(this.backtrackFragment=null);const Ur=this.backtrackFragment?this.backtrackFragment.start:zr.end;let Vr=this.getNextFragment(Ur,Gr);if(this.couldBacktrack&&!this.fragPrevious&&Vr&&Vr.sn!=="initSegment"&&this.fragmentTracker.getState(Vr)!==FragmentState.OK){var Wr;const Kr=((Wr=this.backtrackFragment)!=null?Wr:Vr).sn-Gr.startSN,Xr=Gr.fragments[Kr-1];Xr&&Vr.cc===Xr.cc&&(Vr=Xr,this.fragmentTracker.removeFragment(Xr))}else this.backtrackFragment&&zr.len&&(this.backtrackFragment=null);if(Vr&&this.isLoopLoading(Vr,Ur)){if(!Vr.gap){const Kr=this.audioOnly&&!this.altAudio?ElementaryStreamTypes.AUDIO:ElementaryStreamTypes.VIDEO,Xr=(Kr===ElementaryStreamTypes.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;Xr&&this.afterBufferFlushed(Xr,Kr,PlaylistLevelType.MAIN)}Vr=this.getNextFragmentLoopLoading(Vr,Gr,zr,PlaylistLevelType.MAIN,Lr)}Vr&&(Vr.initSegment&&!Vr.initSegment.data&&!this.bitrateTest&&(Vr=Vr.initSegment),this.loadFragment(Vr,Fr,Ur))}loadFragment(Tr,Ar,Rr){const Pr=this.fragmentTracker.getState(Tr);this.fragCurrent=Tr,Pr===FragmentState.NOT_LOADED||Pr===FragmentState.PARTIAL?Tr.sn==="initSegment"?this._loadInitSegment(Tr,Ar):this.bitrateTest?(this.log(`Fragment ${Tr.sn} of level ${Tr.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(Tr,Ar)):(this.startFragRequested=!0,super.loadFragment(Tr,Ar,Rr)):this.clearTrackerIfNeeded(Tr)}getBufferedFrag(Tr){return this.fragmentTracker.getBufferedFrag(Tr,PlaylistLevelType.MAIN)}followingBufferedFrag(Tr){return Tr?this.getBufferedFrag(Tr.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){const{levels:Tr,media:Ar}=this;if(Ar!=null&&Ar.readyState){let Rr;const Pr=this.getAppendedFrag(Ar.currentTime);Pr&&Pr.start>1&&this.flushMainBuffer(0,Pr.start-1);const Dr=this.getLevelDetails();if(Dr!=null&&Dr.live){const Fr=this.getMainFwdBufferInfo();if(!Fr||Fr.len<Dr.targetduration*2)return}if(!Ar.paused&&Tr){const Fr=this.hls.nextLoadLevel,zr=Tr[Fr],jr=this.fragLastKbps;jr&&this.fragCurrent?Rr=this.fragCurrent.duration*zr.maxBitrate/(1e3*jr)+1:Rr=0}else Rr=0;const Mr=this.getBufferedFrag(Ar.currentTime+Rr);if(Mr){const Fr=this.followingBufferedFrag(Mr);if(Fr){this.abortCurrentFrag();const zr=Fr.maxStartPTS?Fr.maxStartPTS:Fr.start,jr=Fr.duration,Gr=Math.max(Mr.end,zr+Math.min(Math.max(jr-this.config.maxFragLookUpTolerance,jr*.5),jr*.75));this.flushMainBuffer(Gr,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){const Tr=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,Tr&&(Tr.abortRequests(),this.fragmentTracker.removeFragment(Tr)),this.state){case State.KEY_LOADING:case State.FRAG_LOADING:case State.FRAG_LOADING_WAITING_RETRY:case State.PARSING:case State.PARSED:this.state=State.IDLE;break}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(Tr,Ar){super.flushMainBuffer(Tr,Ar,this.altAudio?"video":null)}onMediaAttached(Tr,Ar){super.onMediaAttached(Tr,Ar);const Rr=Ar.media;this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),Rr.addEventListener("playing",this.onvplaying),Rr.addEventListener("seeked",this.onvseeked),this.gapController=new GapController(this.config,Rr,this.fragmentTracker,this.hls)}onMediaDetaching(){const{media:Tr}=this;Tr&&this.onvplaying&&this.onvseeked&&(Tr.removeEventListener("playing",this.onvplaying),Tr.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),super.onMediaDetaching()}onMediaPlaying(){this.tick()}onMediaSeeked(){const Tr=this.media,Ar=Tr?Tr.currentTime:null;isFiniteNumber(Ar)&&this.log(`Media seeked to ${Ar.toFixed(3)}`);const Rr=this.getMainFwdBufferInfo();if(Rr===null||Rr.len===0){this.warn(`Main forward buffer length on "seeked" event ${Rr?Rr.len:"empty"})`);return}this.tick()}onManifestLoading(){this.log("Trigger BUFFER_RESET"),this.hls.trigger(Events.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.couldBacktrack=!1,this.startPosition=this.lastCurrentTime=0,this.levels=this.fragPlaying=this.backtrackFragment=null,this.altAudio=this.audioOnly=!1}onManifestParsed(Tr,Ar){let Rr=!1,Pr=!1,Dr;Ar.levels.forEach(Mr=>{Dr=Mr.audioCodec,Dr&&(Dr.indexOf("mp4a.40.2")!==-1&&(Rr=!0),Dr.indexOf("mp4a.40.5")!==-1&&(Pr=!0))}),this.audioCodecSwitch=Rr&&Pr&&!changeTypeSupported(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=Ar.levels,this.startFragRequested=!1}onLevelLoading(Tr,Ar){const{levels:Rr}=this;if(!Rr||this.state!==State.IDLE)return;const Pr=Rr[Ar.level];(!Pr.details||Pr.details.live&&this.levelLastLoaded!==Ar.level||this.waitForCdnTuneIn(Pr.details))&&(this.state=State.WAITING_LEVEL)}onLevelLoaded(Tr,Ar){var Rr;const{levels:Pr}=this,Dr=Ar.level,Mr=Ar.details,Fr=Mr.totalduration;if(!Pr){this.warn(`Levels were reset while loading level ${Dr}`);return}this.log(`Level ${Dr} loaded [${Mr.startSN},${Mr.endSN}]${Mr.lastPartSn?`[part-${Mr.lastPartSn}-${Mr.lastPartIndex}]`:""}, cc [${Mr.startCC}, ${Mr.endCC}] duration:${Fr}`);const zr=Pr[Dr],jr=this.fragCurrent;jr&&(this.state===State.FRAG_LOADING||this.state===State.FRAG_LOADING_WAITING_RETRY)&&(jr.level!==Ar.level||jr.urlId!==zr.urlId)&&jr.loader&&this.abortCurrentFrag();let Gr=0;if(Mr.live||(Rr=zr.details)!=null&&Rr.live){if(this.checkLiveUpdate(Mr),Mr.deltaUpdateFailed)return;Gr=this.alignPlaylists(Mr,zr.details)}if(zr.details=Mr,this.levelLastLoaded=Dr,this.hls.trigger(Events.LEVEL_UPDATED,{details:Mr,level:Dr}),this.state===State.WAITING_LEVEL){if(this.waitForCdnTuneIn(Mr))return;this.state=State.IDLE}this.startFragRequested?Mr.live&&this.synchronizeToLiveEdge(Mr):this.setStartPosition(Mr,Gr),this.tick()}_handleFragmentLoadProgress(Tr){var Ar;const{frag:Rr,part:Pr,payload:Dr}=Tr,{levels:Mr}=this;if(!Mr){this.warn(`Levels were reset while fragment load was in progress. Fragment ${Rr.sn} of level ${Rr.level} will not be buffered`);return}const Fr=Mr[Rr.level],zr=Fr.details;if(!zr){this.warn(`Dropping fragment ${Rr.sn} of level ${Rr.level} after level details were reset`),this.fragmentTracker.removeFragment(Rr);return}const jr=Fr.videoCodec,Gr=zr.PTSKnown||!zr.live,Nr=(Ar=Rr.initSegment)==null?void 0:Ar.data,Lr=this._getAudioCodec(Fr),Ur=this.transmuxer=this.transmuxer||new TransmuxerInterface(this.hls,PlaylistLevelType.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),Vr=Pr?Pr.index:-1,Wr=Vr!==-1,qr=new ChunkMetadata(Rr.level,Rr.sn,Rr.stats.chunkCount,Dr.byteLength,Vr,Wr),Kr=this.initPTS[Rr.cc];Ur.push(Dr,Nr,Lr,jr,Rr,Pr,zr.totalduration,Gr,qr,Kr)}onAudioTrackSwitching(Tr,Ar){const Rr=this.altAudio;if(!!!Ar.url){if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;const Mr=this.fragCurrent;Mr&&(this.log("Switching to main audio track, cancel main fragment load"),Mr.abortRequests(),this.fragmentTracker.removeFragment(Mr)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();const Dr=this.hls;Rr&&(Dr.trigger(Events.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null}),this.fragmentTracker.removeAllFragments()),Dr.trigger(Events.AUDIO_TRACK_SWITCHED,Ar)}}onAudioTrackSwitched(Tr,Ar){const Rr=Ar.id,Pr=!!this.hls.audioTracks[Rr].url;if(Pr){const Dr=this.videoBuffer;Dr&&this.mediaBuffer!==Dr&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=Dr)}this.altAudio=Pr,this.tick()}onBufferCreated(Tr,Ar){const Rr=Ar.tracks;let Pr,Dr,Mr=!1;for(const Fr in Rr){const zr=Rr[Fr];if(zr.id==="main"){if(Dr=Fr,Pr=zr,Fr==="video"){const jr=Rr[Fr];jr&&(this.videoBuffer=jr.buffer)}}else Mr=!0}Mr&&Pr?(this.log(`Alternate track found, use ${Dr}.buffered to schedule main fragment loading`),this.mediaBuffer=Pr.buffer):this.mediaBuffer=this.media}onFragBuffered(Tr,Ar){const{frag:Rr,part:Pr}=Ar;if(Rr&&Rr.type!==PlaylistLevelType.MAIN)return;if(this.fragContextChanged(Rr)){this.warn(`Fragment ${Rr.sn}${Pr?" p: "+Pr.index:""} of level ${Rr.level} finished buffering, but was aborted. state: ${this.state}`),this.state===State.PARSED&&(this.state=State.IDLE);return}const Dr=Pr?Pr.stats:Rr.stats;this.fragLastKbps=Math.round(8*Dr.total/(Dr.buffering.end-Dr.loading.first)),Rr.sn!=="initSegment"&&(this.fragPrevious=Rr),this.fragBufferedComplete(Rr,Pr)}onError(Tr,Ar){var Rr;if(Ar.fatal){this.state=State.ERROR;return}switch(Ar.details){case ErrorDetails.FRAG_GAP:case ErrorDetails.FRAG_PARSING_ERROR:case ErrorDetails.FRAG_DECRYPT_ERROR:case ErrorDetails.FRAG_LOAD_ERROR:case ErrorDetails.FRAG_LOAD_TIMEOUT:case ErrorDetails.KEY_LOAD_ERROR:case ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(PlaylistLevelType.MAIN,Ar);break;case ErrorDetails.LEVEL_LOAD_ERROR:case ErrorDetails.LEVEL_LOAD_TIMEOUT:case ErrorDetails.LEVEL_PARSING_ERROR:!Ar.levelRetry&&this.state===State.WAITING_LEVEL&&((Rr=Ar.context)==null?void 0:Rr.type)===PlaylistContextType.LEVEL&&(this.state=State.IDLE);break;case ErrorDetails.BUFFER_FULL_ERROR:if(!Ar.parent||Ar.parent!=="main")return;this.reduceLengthAndFlushBuffer(Ar)&&this.flushMainBuffer(0,Number.POSITIVE_INFINITY);break;case ErrorDetails.INTERNAL_EXCEPTION:this.recoverWorkerError(Ar);break}}checkBuffer(){const{media:Tr,gapController:Ar}=this;if(!(!Tr||!Ar||!Tr.readyState)){if(this.loadedmetadata||!BufferHelper.getBuffered(Tr).length){const Rr=this.state!==State.IDLE?this.fragCurrent:null;Ar.poll(this.lastCurrentTime,Rr)}this.lastCurrentTime=Tr.currentTime}}onFragLoadEmergencyAborted(){this.state=State.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tickImmediate()}onBufferFlushed(Tr,{type:Ar}){if(Ar!==ElementaryStreamTypes.AUDIO||this.audioOnly&&!this.altAudio){const Rr=(Ar===ElementaryStreamTypes.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;this.afterBufferFlushed(Rr,Ar,PlaylistLevelType.MAIN)}}onLevelsUpdated(Tr,Ar){this.levels=Ar.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){const{media:Tr}=this;if(!Tr)return;const Ar=Tr.currentTime;let Rr=this.startPosition;if(Rr>=0&&Ar<Rr){if(Tr.seeking){this.log(`could not seek to ${Rr}, already seeking at ${Ar}`);return}const Pr=BufferHelper.getBuffered(Tr),Mr=(Pr.length?Pr.start(0):0)-Rr;Mr>0&&(Mr<this.config.maxBufferHole||Mr<this.config.maxFragLookUpTolerance)&&(this.log(`adjusting start position by ${Mr} to match buffer start`),Rr+=Mr,this.startPosition=Rr),this.log(`seek to target start position ${Rr} from current time ${Ar}`),Tr.currentTime=Rr}}_getAudioCodec(Tr){let Ar=this.config.defaultAudioCodec||Tr.audioCodec;return this.audioCodecSwap&&Ar&&(this.log("Swapping audio codec"),Ar.indexOf("mp4a.40.5")!==-1?Ar="mp4a.40.2":Ar="mp4a.40.5"),Ar}_loadBitrateTestFrag(Tr,Ar){Tr.bitrateTest=!0,this._doFragLoad(Tr,Ar).then(Rr=>{const{hls:Pr}=this;if(!Rr||this.fragContextChanged(Tr))return;Ar.fragmentError=0,this.state=State.IDLE,this.startFragRequested=!1,this.bitrateTest=!1;const Dr=Tr.stats;Dr.parsing.start=Dr.parsing.end=Dr.buffering.start=Dr.buffering.end=self.performance.now(),Pr.trigger(Events.FRAG_LOADED,Rr),Tr.bitrateTest=!1})}_handleTransmuxComplete(Tr){var Ar;const Rr="main",{hls:Pr}=this,{remuxResult:Dr,chunkMeta:Mr}=Tr,Fr=this.getCurrentContext(Mr);if(!Fr){this.resetWhenMissingContext(Mr);return}const{frag:zr,part:jr,level:Gr}=Fr,{video:Nr,text:Lr,id3:Ur,initSegment:Vr}=Dr,{details:Wr}=Gr,qr=this.altAudio?void 0:Dr.audio;if(this.fragContextChanged(zr)){this.fragmentTracker.removeFragment(zr);return}if(this.state=State.PARSING,Vr){if(Vr!=null&&Vr.tracks){const Zr=zr.initSegment||zr;this._bufferInitSegment(Gr,Vr.tracks,Zr,Mr),Pr.trigger(Events.FRAG_PARSING_INIT_SEGMENT,{frag:Zr,id:Rr,tracks:Vr.tracks})}const Kr=Vr.initPTS,Xr=Vr.timescale;isFiniteNumber(Kr)&&(this.initPTS[zr.cc]={baseTime:Kr,timescale:Xr},Pr.trigger(Events.INIT_PTS_FOUND,{frag:zr,id:Rr,initPTS:Kr,timescale:Xr}))}if(Nr&&Wr&&zr.sn!=="initSegment"){const Kr=Wr.fragments[zr.sn-1-Wr.startSN],Xr=zr.sn===Wr.startSN,Zr=!Kr||zr.cc>Kr.cc;if(Dr.independent!==!1){const{startPTS:_i,endPTS:Jr,startDTS:es,endDTS:ts}=Nr;if(jr)jr.elementaryStreams[Nr.type]={startPTS:_i,endPTS:Jr,startDTS:es,endDTS:ts};else if(Nr.firstKeyFrame&&Nr.independent&&Mr.id===1&&!Zr&&(this.couldBacktrack=!0),Nr.dropped&&Nr.independent){const is=this.getMainFwdBufferInfo(),rs=(is?is.end:this.getLoadPosition())+this.config.maxBufferHole,as=Nr.firstKeyFramePTS?Nr.firstKeyFramePTS:_i;if(!Xr&&rs<as-this.config.maxBufferHole&&!Zr){this.backtrack(zr);return}else Zr&&(zr.gap=!0);zr.setElementaryStreamInfo(Nr.type,zr.start,Jr,zr.start,ts,!0)}zr.setElementaryStreamInfo(Nr.type,_i,Jr,es,ts),this.backtrackFragment&&(this.backtrackFragment=zr),this.bufferFragmentData(Nr,zr,jr,Mr,Xr||Zr)}else if(Xr||Zr)zr.gap=!0;else{this.backtrack(zr);return}}if(qr){const{startPTS:Kr,endPTS:Xr,startDTS:Zr,endDTS:_i}=qr;jr&&(jr.elementaryStreams[ElementaryStreamTypes.AUDIO]={startPTS:Kr,endPTS:Xr,startDTS:Zr,endDTS:_i}),zr.setElementaryStreamInfo(ElementaryStreamTypes.AUDIO,Kr,Xr,Zr,_i),this.bufferFragmentData(qr,zr,jr,Mr)}if(Wr&&Ur!=null&&(Ar=Ur.samples)!=null&&Ar.length){const Kr={id:Rr,frag:zr,details:Wr,samples:Ur.samples};Pr.trigger(Events.FRAG_PARSING_METADATA,Kr)}if(Wr&&Lr){const Kr={id:Rr,frag:zr,details:Wr,samples:Lr.samples};Pr.trigger(Events.FRAG_PARSING_USERDATA,Kr)}}_bufferInitSegment(Tr,Ar,Rr,Pr){if(this.state!==State.PARSING)return;this.audioOnly=!!Ar.audio&&!Ar.video,this.altAudio&&!this.audioOnly&&delete Ar.audio;const{audio:Dr,video:Mr,audiovideo:Fr}=Ar;if(Dr){let zr=Tr.audioCodec;const jr=navigator.userAgent.toLowerCase();this.audioCodecSwitch&&(zr&&(zr.indexOf("mp4a.40.5")!==-1?zr="mp4a.40.2":zr="mp4a.40.5"),Dr.metadata.channelCount!==1&&jr.indexOf("firefox")===-1&&(zr="mp4a.40.5")),jr.indexOf("android")!==-1&&Dr.container!=="audio/mpeg"&&(zr="mp4a.40.2",this.log(`Android: force audio codec to ${zr}`)),Tr.audioCodec&&Tr.audioCodec!==zr&&this.log(`Swapping manifest audio codec "${Tr.audioCodec}" for "${zr}"`),Dr.levelCodec=zr,Dr.id="main",this.log(`Init audio buffer, container:${Dr.container}, codecs[selected/level/parsed]=[${zr||""}/${Tr.audioCodec||""}/${Dr.codec}]`)}Mr&&(Mr.levelCodec=Tr.videoCodec,Mr.id="main",this.log(`Init video buffer, container:${Mr.container}, codecs[level/parsed]=[${Tr.videoCodec||""}/${Mr.codec}]`)),Fr&&this.log(`Init audiovideo buffer, container:${Fr.container}, codecs[level/parsed]=[${Tr.attrs.CODECS||""}/${Fr.codec}]`),this.hls.trigger(Events.BUFFER_CODECS,Ar),Object.keys(Ar).forEach(zr=>{const Gr=Ar[zr].initSegment;Gr!=null&&Gr.byteLength&&this.hls.trigger(Events.BUFFER_APPENDING,{type:zr,data:Gr,frag:Rr,part:null,chunkMeta:Pr,parent:Rr.type})}),this.tick()}getMainFwdBufferInfo(){return this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:this.media,PlaylistLevelType.MAIN)}backtrack(Tr){this.couldBacktrack=!0,this.backtrackFragment=Tr,this.resetTransmuxer(),this.flushBufferGap(Tr),this.fragmentTracker.removeFragment(Tr),this.fragPrevious=null,this.nextLoadPosition=Tr.start,this.state=State.IDLE}checkFragmentChanged(){const Tr=this.media;let Ar=null;if(Tr&&Tr.readyState>1&&Tr.seeking===!1){const Rr=Tr.currentTime;if(BufferHelper.isBuffered(Tr,Rr)?Ar=this.getAppendedFrag(Rr):BufferHelper.isBuffered(Tr,Rr+.1)&&(Ar=this.getAppendedFrag(Rr+.1)),Ar){this.backtrackFragment=null;const Pr=this.fragPlaying,Dr=Ar.level;(!Pr||Ar.sn!==Pr.sn||Pr.level!==Dr||Ar.urlId!==Pr.urlId)&&(this.fragPlaying=Ar,this.hls.trigger(Events.FRAG_CHANGED,{frag:Ar}),(!Pr||Pr.level!==Dr)&&this.hls.trigger(Events.LEVEL_SWITCHED,{level:Dr}))}}}get nextLevel(){const Tr=this.nextBufferedFrag;return Tr?Tr.level:-1}get currentFrag(){const Tr=this.media;return Tr?this.fragPlaying||this.getAppendedFrag(Tr.currentTime):null}get currentProgramDateTime(){const Tr=this.media;if(Tr){const Ar=Tr.currentTime,Rr=this.currentFrag;if(Rr&&isFiniteNumber(Ar)&&isFiniteNumber(Rr.programDateTime)){const Pr=Rr.programDateTime+(Ar-Rr.start)*1e3;return new Date(Pr)}}return null}get currentLevel(){const Tr=this.currentFrag;return Tr?Tr.level:-1}get nextBufferedFrag(){const Tr=this.currentFrag;return Tr?this.followingBufferedFrag(Tr):null}get forceStartLoad(){return this._forceStartLoad}}class EWMA{constructor(Tr,Ar=0,Rr=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=Tr,this.alpha_=Tr?Math.exp(Math.log(.5)/Tr):0,this.estimate_=Ar,this.totalWeight_=Rr}sample(Tr,Ar){const Rr=Math.pow(this.alpha_,Tr);this.estimate_=Ar*(1-Rr)+Rr*this.estimate_,this.totalWeight_+=Tr}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){const Tr=1-Math.pow(this.alpha_,this.totalWeight_);if(Tr)return this.estimate_/Tr}return this.estimate_}}class EwmaBandWidthEstimator{constructor(Tr,Ar,Rr,Pr=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=Rr,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new EWMA(Tr),this.fast_=new EWMA(Ar),this.defaultTTFB_=Pr,this.ttfb_=new EWMA(Tr)}update(Tr,Ar){const{slow_:Rr,fast_:Pr,ttfb_:Dr}=this;Rr.halfLife!==Tr&&(this.slow_=new EWMA(Tr,Rr.getEstimate(),Rr.getTotalWeight())),Pr.halfLife!==Ar&&(this.fast_=new EWMA(Ar,Pr.getEstimate(),Pr.getTotalWeight())),Dr.halfLife!==Tr&&(this.ttfb_=new EWMA(Tr,Dr.getEstimate(),Dr.getTotalWeight()))}sample(Tr,Ar){Tr=Math.max(Tr,this.minDelayMs_);const Rr=8*Ar,Pr=Tr/1e3,Dr=Rr/Pr;this.fast_.sample(Pr,Dr),this.slow_.sample(Pr,Dr)}sampleTTFB(Tr){const Ar=Tr/1e3,Rr=Math.sqrt(2)*Math.exp(-Math.pow(Ar,2)/2);this.ttfb_.sample(Rr,Math.max(Tr,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}destroy(){}}class AbrController{constructor(Tr){this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=0,this._nextAutoLevel=-1,this.timer=-1,this.onCheck=this._abandonRulesCheck.bind(this),this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.bwEstimator=void 0,this.hls=Tr;const Ar=Tr.config;this.bwEstimator=new EwmaBandWidthEstimator(Ar.abrEwmaSlowVoD,Ar.abrEwmaFastVoD,Ar.abrEwmaDefaultEstimate),this.registerListeners()}registerListeners(){const{hls:Tr}=this;Tr.on(Events.FRAG_LOADING,this.onFragLoading,this),Tr.on(Events.FRAG_LOADED,this.onFragLoaded,this),Tr.on(Events.FRAG_BUFFERED,this.onFragBuffered,this),Tr.on(Events.LEVEL_SWITCHING,this.onLevelSwitching,this),Tr.on(Events.LEVEL_LOADED,this.onLevelLoaded,this)}unregisterListeners(){const{hls:Tr}=this;Tr.off(Events.FRAG_LOADING,this.onFragLoading,this),Tr.off(Events.FRAG_LOADED,this.onFragLoaded,this),Tr.off(Events.FRAG_BUFFERED,this.onFragBuffered,this),Tr.off(Events.LEVEL_SWITCHING,this.onLevelSwitching,this),Tr.off(Events.LEVEL_LOADED,this.onLevelLoaded,this)}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this.onCheck=null,this.fragCurrent=this.partCurrent=null}onFragLoading(Tr,Ar){var Rr;const Pr=Ar.frag;this.ignoreFragment(Pr)||(this.fragCurrent=Pr,this.partCurrent=(Rr=Ar.part)!=null?Rr:null,this.clearTimer(),this.timer=self.setInterval(this.onCheck,100))}onLevelSwitching(Tr,Ar){this.clearTimer()}getTimeToLoadFrag(Tr,Ar,Rr,Pr){const Dr=Tr+Rr/Ar,Mr=Pr?this.lastLevelLoadSec:0;return Dr+Mr}onLevelLoaded(Tr,Ar){const Rr=this.hls.config,{total:Pr,bwEstimate:Dr}=Ar.stats;isFiniteNumber(Pr)&&isFiniteNumber(Dr)&&(this.lastLevelLoadSec=8*Pr/Dr),Ar.details.live?this.bwEstimator.update(Rr.abrEwmaSlowLive,Rr.abrEwmaFastLive):this.bwEstimator.update(Rr.abrEwmaSlowVoD,Rr.abrEwmaFastVoD)}_abandonRulesCheck(){const{fragCurrent:Tr,partCurrent:Ar,hls:Rr}=this,{autoLevelEnabled:Pr,media:Dr}=Rr;if(!Tr||!Dr)return;const Mr=performance.now(),Fr=Ar?Ar.stats:Tr.stats,zr=Ar?Ar.duration:Tr.duration,jr=Mr-Fr.loading.start;if(Fr.aborted||Fr.loaded&&Fr.loaded===Fr.total||Tr.level===0){this.clearTimer(),this._nextAutoLevel=-1;return}if(!Pr||Dr.paused||!Dr.playbackRate||!Dr.readyState)return;const Gr=Rr.mainForwardBufferInfo;if(Gr===null)return;const Nr=this.bwEstimator.getEstimateTTFB(),Lr=Math.abs(Dr.playbackRate);if(jr<=Math.max(Nr,1e3*(zr/(Lr*2))))return;const Ur=Gr.len/Lr;if(Ur>=2*zr/Lr)return;const Vr=Fr.loading.first?Fr.loading.first-Fr.loading.start:-1,Wr=Fr.loaded&&Vr>-1,qr=this.bwEstimator.getEstimate(),{levels:Kr,minAutoLevel:Xr}=Rr,Zr=Kr[Tr.level],_i=Fr.total||Math.max(Fr.loaded,Math.round(zr*Zr.maxBitrate/8));let Jr=jr-Vr;Jr<1&&Wr&&(Jr=Math.min(jr,Fr.loaded*8/qr));const es=Wr?Fr.loaded*1e3/Jr:0,ts=es?(_i-Fr.loaded)/es:_i*8/qr+Nr/1e3;if(ts<=Ur)return;const is=es?es*8:qr;let rs=Number.POSITIVE_INFINITY,as;for(as=Tr.level-1;as>Xr;as--){const ls=Kr[as].maxBitrate;if(rs=this.getTimeToLoadFrag(Nr/1e3,is,zr*ls,!Kr[as].details),rs<Ur)break}rs>=ts||rs>zr*10||(Rr.nextLoadLevel=as,Wr?this.bwEstimator.sample(jr-Math.min(Nr,Vr),Fr.loaded):this.bwEstimator.sampleTTFB(jr),this.clearTimer(),logger.warn(`[abr] Fragment ${Tr.sn}${Ar?" part "+Ar.index:""} of level ${Tr.level} is loading too slowly;
      Time to underbuffer: ${Ur.toFixed(3)} s
      Estimated load time for current fragment: ${ts.toFixed(3)} s
      Estimated load time for down switch fragment: ${rs.toFixed(3)} s
      TTFB estimate: ${Vr}
      Current BW estimate: ${isFiniteNumber(qr)?(qr/1024).toFixed(3):"Unknown"} Kb/s
      New BW estimate: ${(this.bwEstimator.getEstimate()/1024).toFixed(3)} Kb/s
      Aborting and switching to level ${as}`),Tr.loader&&(this.fragCurrent=this.partCurrent=null,Tr.abortRequests()),Rr.trigger(Events.FRAG_LOAD_EMERGENCY_ABORTED,{frag:Tr,part:Ar,stats:Fr}))}onFragLoaded(Tr,{frag:Ar,part:Rr}){const Pr=Rr?Rr.stats:Ar.stats;if(Ar.type===PlaylistLevelType.MAIN&&this.bwEstimator.sampleTTFB(Pr.loading.first-Pr.loading.start),!this.ignoreFragment(Ar)){if(this.clearTimer(),this.lastLoadedFragLevel=Ar.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){const Dr=Rr?Rr.duration:Ar.duration,Mr=this.hls.levels[Ar.level],Fr=(Mr.loaded?Mr.loaded.bytes:0)+Pr.loaded,zr=(Mr.loaded?Mr.loaded.duration:0)+Dr;Mr.loaded={bytes:Fr,duration:zr},Mr.realBitrate=Math.round(8*Fr/zr)}if(Ar.bitrateTest){const Dr={stats:Pr,frag:Ar,part:Rr,id:Ar.type};this.onFragBuffered(Events.FRAG_BUFFERED,Dr),Ar.bitrateTest=!1}}}onFragBuffered(Tr,Ar){const{frag:Rr,part:Pr}=Ar,Dr=Pr!=null&&Pr.stats.loaded?Pr.stats:Rr.stats;if(Dr.aborted||this.ignoreFragment(Rr))return;const Mr=Dr.parsing.end-Dr.loading.start-Math.min(Dr.loading.first-Dr.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(Mr,Dr.loaded),Dr.bwEstimate=this.bwEstimator.getEstimate(),Rr.bitrateTest?this.bitrateTestDelay=Mr/1e3:this.bitrateTestDelay=0}ignoreFragment(Tr){return Tr.type!==PlaylistLevelType.MAIN||Tr.sn==="initSegment"}clearTimer(){self.clearInterval(this.timer)}get nextAutoLevel(){const Tr=this._nextAutoLevel,Ar=this.bwEstimator;if(Tr!==-1&&!Ar.canEstimate())return Tr;let Rr=this.getNextABRAutoLevel();if(Tr!==-1){const Pr=this.hls.levels;if(Pr.length>Math.max(Tr,Rr)&&Pr[Tr].loadError<=Pr[Rr].loadError)return Tr}return Tr!==-1&&(Rr=Math.min(Tr,Rr)),Rr}getNextABRAutoLevel(){const{fragCurrent:Tr,partCurrent:Ar,hls:Rr}=this,{maxAutoLevel:Pr,config:Dr,minAutoLevel:Mr,media:Fr}=Rr,zr=Ar?Ar.duration:Tr?Tr.duration:0,jr=Fr&&Fr.playbackRate!==0?Math.abs(Fr.playbackRate):1,Gr=this.bwEstimator?this.bwEstimator.getEstimate():Dr.abrEwmaDefaultEstimate,Nr=Rr.mainForwardBufferInfo,Lr=(Nr?Nr.len:0)/jr;let Ur=this.findBestLevel(Gr,Mr,Pr,Lr,Dr.abrBandWidthFactor,Dr.abrBandWidthUpFactor);if(Ur>=0)return Ur;logger.trace(`[abr] ${Lr?"rebuffering expected":"buffer is empty"}, finding optimal quality level`);let Vr=zr?Math.min(zr,Dr.maxStarvationDelay):Dr.maxStarvationDelay,Wr=Dr.abrBandWidthFactor,qr=Dr.abrBandWidthUpFactor;if(!Lr){const Kr=this.bitrateTestDelay;Kr&&(Vr=(zr?Math.min(zr,Dr.maxLoadingDelay):Dr.maxLoadingDelay)-Kr,logger.trace(`[abr] bitrate test took ${Math.round(1e3*Kr)}ms, set first fragment max fetchDuration to ${Math.round(1e3*Vr)} ms`),Wr=qr=1)}return Ur=this.findBestLevel(Gr,Mr,Pr,Lr+Vr,Wr,qr),Math.max(Ur,0)}findBestLevel(Tr,Ar,Rr,Pr,Dr,Mr){var Fr;const{fragCurrent:zr,partCurrent:jr,lastLoadedFragLevel:Gr}=this,{levels:Nr}=this.hls,Lr=Nr[Gr],Ur=!!(Lr!=null&&(Fr=Lr.details)!=null&&Fr.live),Vr=Lr==null?void 0:Lr.codecSet,Wr=jr?jr.duration:zr?zr.duration:0,qr=this.bwEstimator.getEstimateTTFB()/1e3;let Kr=Ar,Xr=-1;for(let Zr=Rr;Zr>=Ar;Zr--){const _i=Nr[Zr];if(!_i||Vr&&_i.codecSet!==Vr){_i&&(Kr=Math.min(Zr,Kr),Xr=Math.max(Zr,Xr));continue}Xr!==-1&&logger.trace(`[abr] Skipped level(s) ${Kr}-${Xr} with CODECS:"${Nr[Xr].attrs.CODECS}"; not compatible with "${Lr.attrs.CODECS}"`);const Jr=_i.details,es=(jr?Jr==null?void 0:Jr.partTarget:Jr==null?void 0:Jr.averagetargetduration)||Wr;let ts;Zr<=Gr?ts=Dr*Tr:ts=Mr*Tr;const is=Nr[Zr].maxBitrate,rs=this.getTimeToLoadFrag(qr,ts,is*es,Jr===void 0);if(logger.trace(`[abr] level:${Zr} adjustedbw-bitrate:${Math.round(ts-is)} avgDuration:${es.toFixed(1)} maxFetchDuration:${Pr.toFixed(1)} fetchDuration:${rs.toFixed(1)}`),ts>is&&(rs===0||!isFiniteNumber(rs)||Ur&&!this.bitrateTestDelay||rs<Pr))return Zr}return-1}set nextAutoLevel(Tr){this._nextAutoLevel=Tr}}class ChunkCache{constructor(){this.chunks=[],this.dataLength=0}push(Tr){this.chunks.push(Tr),this.dataLength+=Tr.length}flush(){const{chunks:Tr,dataLength:Ar}=this;let Rr;if(Tr.length)Tr.length===1?Rr=Tr[0]:Rr=concatUint8Arrays(Tr,Ar);else return new Uint8Array(0);return this.reset(),Rr}reset(){this.chunks.length=0,this.dataLength=0}}function concatUint8Arrays(_r,Tr){const Ar=new Uint8Array(Tr);let Rr=0;for(let Pr=0;Pr<_r.length;Pr++){const Dr=_r[Pr];Ar.set(Dr,Rr),Rr+=Dr.length}return Ar}const TICK_INTERVAL$1=100;class AudioStreamController extends BaseStreamController{constructor(Tr,Ar,Rr){super(Tr,Ar,Rr,"[audio-stream-controller]",PlaylistLevelType.AUDIO),this.videoBuffer=null,this.videoTrackCC=-1,this.waitingVideoCC=-1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),this.mainDetails=null,this.bufferedTrack=null,this.switchingTrack=null}_registerListeners(){const{hls:Tr}=this;Tr.on(Events.MEDIA_ATTACHED,this.onMediaAttached,this),Tr.on(Events.MEDIA_DETACHING,this.onMediaDetaching,this),Tr.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),Tr.on(Events.LEVEL_LOADED,this.onLevelLoaded,this),Tr.on(Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),Tr.on(Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),Tr.on(Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),Tr.on(Events.ERROR,this.onError,this),Tr.on(Events.BUFFER_RESET,this.onBufferReset,this),Tr.on(Events.BUFFER_CREATED,this.onBufferCreated,this),Tr.on(Events.BUFFER_FLUSHED,this.onBufferFlushed,this),Tr.on(Events.INIT_PTS_FOUND,this.onInitPtsFound,this),Tr.on(Events.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:Tr}=this;Tr.off(Events.MEDIA_ATTACHED,this.onMediaAttached,this),Tr.off(Events.MEDIA_DETACHING,this.onMediaDetaching,this),Tr.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),Tr.off(Events.LEVEL_LOADED,this.onLevelLoaded,this),Tr.off(Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),Tr.off(Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),Tr.off(Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),Tr.off(Events.ERROR,this.onError,this),Tr.off(Events.BUFFER_RESET,this.onBufferReset,this),Tr.off(Events.BUFFER_CREATED,this.onBufferCreated,this),Tr.off(Events.BUFFER_FLUSHED,this.onBufferFlushed,this),Tr.off(Events.INIT_PTS_FOUND,this.onInitPtsFound,this),Tr.off(Events.FRAG_BUFFERED,this.onFragBuffered,this)}onInitPtsFound(Tr,{frag:Ar,id:Rr,initPTS:Pr,timescale:Dr}){if(Rr==="main"){const Mr=Ar.cc;this.initPTS[Ar.cc]={baseTime:Pr,timescale:Dr},this.log(`InitPTS for cc: ${Mr} found from main: ${Pr}`),this.videoTrackCC=Mr,this.state===State.WAITING_INIT_PTS&&this.tick()}}startLoad(Tr){if(!this.levels){this.startPosition=Tr,this.state=State.STOPPED;return}const Ar=this.lastCurrentTime;this.stopLoad(),this.setInterval(TICK_INTERVAL$1),Ar>0&&Tr===-1?(this.log(`Override startPosition with lastCurrentTime @${Ar.toFixed(3)}`),Tr=Ar,this.state=State.IDLE):(this.loadedmetadata=!1,this.state=State.WAITING_TRACK),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=Tr,this.tick()}doTick(){switch(this.state){case State.IDLE:this.doTickIdle();break;case State.WAITING_TRACK:{var Tr;const{levels:Rr,trackId:Pr}=this,Dr=Rr==null||(Tr=Rr[Pr])==null?void 0:Tr.details;if(Dr){if(this.waitForCdnTuneIn(Dr))break;this.state=State.WAITING_INIT_PTS}break}case State.FRAG_LOADING_WAITING_RETRY:{var Ar;const Rr=performance.now(),Pr=this.retryDate;(!Pr||Rr>=Pr||(Ar=this.media)!=null&&Ar.seeking)&&(this.log("RetryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded(this.trackId),this.state=State.IDLE);break}case State.WAITING_INIT_PTS:{const Rr=this.waitingData;if(Rr){const{frag:Pr,part:Dr,cache:Mr,complete:Fr}=Rr;if(this.initPTS[Pr.cc]!==void 0){this.waitingData=null,this.waitingVideoCC=-1,this.state=State.FRAG_LOADING;const zr=Mr.flush(),jr={frag:Pr,part:Dr,payload:zr,networkDetails:null};this._handleFragmentLoadProgress(jr),Fr&&super._handleFragmentLoadComplete(jr)}else if(this.videoTrackCC!==this.waitingVideoCC)this.log(`Waiting fragment cc (${Pr.cc}) cancelled because video is at cc ${this.videoTrackCC}`),this.clearWaitingFragment();else{const zr=this.getLoadPosition(),jr=BufferHelper.bufferInfo(this.mediaBuffer,zr,this.config.maxBufferHole);fragmentWithinToleranceTest(jr.end,this.config.maxFragLookUpTolerance,Pr)<0&&(this.log(`Waiting fragment cc (${Pr.cc}) @ ${Pr.start} cancelled because another fragment at ${jr.end} is needed`),this.clearWaitingFragment())}}else this.state=State.IDLE}}this.onTickEnd()}clearWaitingFragment(){const Tr=this.waitingData;Tr&&(this.fragmentTracker.removeFragment(Tr.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state=State.IDLE)}resetLoadingState(){this.clearWaitingFragment(),super.resetLoadingState()}onTickEnd(){const{media:Tr}=this;Tr!=null&&Tr.readyState&&(this.lastCurrentTime=Tr.currentTime)}doTickIdle(){const{hls:Tr,levels:Ar,media:Rr,trackId:Pr}=this,Dr=Tr.config;if(!(Ar!=null&&Ar[Pr])||!Rr&&(this.startFragRequested||!Dr.startFragPrefetch))return;const Mr=Ar[Pr],Fr=Mr.details;if(!Fr||Fr.live&&this.levelLastLoaded!==Pr||this.waitForCdnTuneIn(Fr)){this.state=State.WAITING_TRACK;return}const zr=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&zr&&(this.bufferFlushed=!1,this.afterBufferFlushed(zr,ElementaryStreamTypes.AUDIO,PlaylistLevelType.AUDIO));const jr=this.getFwdBufferInfo(zr,PlaylistLevelType.AUDIO);if(jr===null)return;const{bufferedTrack:Gr,switchingTrack:Nr}=this;if(!Nr&&this._streamEnded(jr,Fr)){Tr.trigger(Events.BUFFER_EOS,{type:"audio"}),this.state=State.ENDED;return}const Lr=this.getFwdBufferInfo(this.videoBuffer?this.videoBuffer:this.media,PlaylistLevelType.MAIN),Ur=jr.len,Vr=this.getMaxBufferLength(Lr==null?void 0:Lr.len);if(Ur>=Vr&&!Nr)return;const qr=Fr.fragments[0].start;let Kr=jr.end;if(Nr&&Rr){const Jr=this.getLoadPosition();Gr&&Nr.attrs!==Gr.attrs&&(Kr=Jr),Fr.PTSKnown&&Jr<qr&&(jr.end>qr||jr.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),Rr.currentTime=qr+.05)}let Xr=this.getNextFragment(Kr,Fr),Zr=!1;if(Xr&&this.isLoopLoading(Xr,Kr)&&(Zr=!!Xr.gap,Xr=this.getNextFragmentLoopLoading(Xr,Fr,jr,PlaylistLevelType.MAIN,Vr)),!Xr){this.bufferFlushed=!0;return}const _i=Lr&&Xr.start>Lr.end+Fr.targetduration;if(_i||!(Lr!=null&&Lr.len)&&jr.len){const Jr=this.getAppendedFrag(Xr.start,PlaylistLevelType.MAIN);if(Jr===null||(Zr||(Zr=!!Jr.gap||!!_i&&Lr.len===0),_i&&!Zr||Zr&&jr.nextStart&&jr.nextStart<Jr.end))return}this.loadFragment(Xr,Mr,Kr)}getMaxBufferLength(Tr){const Ar=super.getMaxBufferLength();return Tr?Math.min(Math.max(Ar,Tr),this.config.maxMaxBufferLength):Ar}onMediaDetaching(){this.videoBuffer=null,super.onMediaDetaching()}onAudioTracksUpdated(Tr,{audioTracks:Ar}){this.resetTransmuxer(),this.levels=Ar.map(Rr=>new Level(Rr))}onAudioTrackSwitching(Tr,Ar){const Rr=!!Ar.url;this.trackId=Ar.id;const{fragCurrent:Pr}=this;Pr&&(Pr.abortRequests(),this.removeUnbufferedFrags(Pr.start)),this.resetLoadingState(),Rr?this.setInterval(TICK_INTERVAL$1):this.resetTransmuxer(),Rr?(this.switchingTrack=Ar,this.state=State.IDLE):(this.switchingTrack=null,this.bufferedTrack=Ar,this.state=State.STOPPED),this.tick()}onManifestLoading(){this.fragmentTracker.removeAllFragments(),this.startPosition=this.lastCurrentTime=0,this.bufferFlushed=!1,this.levels=this.mainDetails=this.waitingData=this.bufferedTrack=this.cachedTrackLoadedData=this.switchingTrack=null,this.startFragRequested=!1,this.trackId=this.videoTrackCC=this.waitingVideoCC=-1}onLevelLoaded(Tr,Ar){this.mainDetails=Ar.details,this.cachedTrackLoadedData!==null&&(this.hls.trigger(Events.AUDIO_TRACK_LOADED,this.cachedTrackLoadedData),this.cachedTrackLoadedData=null)}onAudioTrackLoaded(Tr,Ar){var Rr;if(this.mainDetails==null){this.cachedTrackLoadedData=Ar;return}const{levels:Pr}=this,{details:Dr,id:Mr}=Ar;if(!Pr){this.warn(`Audio tracks were reset while loading level ${Mr}`);return}this.log(`Track ${Mr} loaded [${Dr.startSN},${Dr.endSN}]${Dr.lastPartSn?`[part-${Dr.lastPartSn}-${Dr.lastPartIndex}]`:""},duration:${Dr.totalduration}`);const Fr=Pr[Mr];let zr=0;if(Dr.live||(Rr=Fr.details)!=null&&Rr.live){this.checkLiveUpdate(Dr);const jr=this.mainDetails;if(Dr.deltaUpdateFailed||!jr)return;!Fr.details&&Dr.hasProgramDateTime&&jr.hasProgramDateTime?(alignMediaPlaylistByPDT(Dr,jr),zr=Dr.fragments[0].start):zr=this.alignPlaylists(Dr,Fr.details)}Fr.details=Dr,this.levelLastLoaded=Mr,!this.startFragRequested&&(this.mainDetails||!Dr.live)&&this.setStartPosition(Fr.details,zr),this.state===State.WAITING_TRACK&&!this.waitForCdnTuneIn(Dr)&&(this.state=State.IDLE),this.tick()}_handleFragmentLoadProgress(Tr){var Ar;const{frag:Rr,part:Pr,payload:Dr}=Tr,{config:Mr,trackId:Fr,levels:zr}=this;if(!zr){this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${Rr.sn} of level ${Rr.level} will not be buffered`);return}const jr=zr[Fr];if(!jr){this.warn("Audio track is undefined on fragment load progress");return}const Gr=jr.details;if(!Gr){this.warn("Audio track details undefined on fragment load progress"),this.removeUnbufferedFrags(Rr.start);return}const Nr=Mr.defaultAudioCodec||jr.audioCodec||"mp4a.40.2";let Lr=this.transmuxer;Lr||(Lr=this.transmuxer=new TransmuxerInterface(this.hls,PlaylistLevelType.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));const Ur=this.initPTS[Rr.cc],Vr=(Ar=Rr.initSegment)==null?void 0:Ar.data;if(Ur!==void 0){const qr=Pr?Pr.index:-1,Kr=qr!==-1,Xr=new ChunkMetadata(Rr.level,Rr.sn,Rr.stats.chunkCount,Dr.byteLength,qr,Kr);Lr.push(Dr,Vr,Nr,"",Rr,Pr,Gr.totalduration,!1,Xr,Ur)}else{this.log(`Unknown video PTS for cc ${Rr.cc}, waiting for video PTS before demuxing audio frag ${Rr.sn} of [${Gr.startSN} ,${Gr.endSN}],track ${Fr}`);const{cache:Wr}=this.waitingData=this.waitingData||{frag:Rr,part:Pr,cache:new ChunkCache,complete:!1};Wr.push(new Uint8Array(Dr)),this.waitingVideoCC=this.videoTrackCC,this.state=State.WAITING_INIT_PTS}}_handleFragmentLoadComplete(Tr){if(this.waitingData){this.waitingData.complete=!0;return}super._handleFragmentLoadComplete(Tr)}onBufferReset(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1}onBufferCreated(Tr,Ar){const Rr=Ar.tracks.audio;Rr&&(this.mediaBuffer=Rr.buffer||null),Ar.tracks.video&&(this.videoBuffer=Ar.tracks.video.buffer||null)}onFragBuffered(Tr,Ar){const{frag:Rr,part:Pr}=Ar;if(Rr.type!==PlaylistLevelType.AUDIO){if(!this.loadedmetadata&&Rr.type===PlaylistLevelType.MAIN){const Dr=this.videoBuffer||this.media;Dr&&BufferHelper.getBuffered(Dr).length&&(this.loadedmetadata=!0)}return}if(this.fragContextChanged(Rr)){this.warn(`Fragment ${Rr.sn}${Pr?" p: "+Pr.index:""} of level ${Rr.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);return}if(Rr.sn!=="initSegment"){this.fragPrevious=Rr;const Dr=this.switchingTrack;Dr&&(this.bufferedTrack=Dr,this.switchingTrack=null,this.hls.trigger(Events.AUDIO_TRACK_SWITCHED,_objectSpread2({},Dr)))}this.fragBufferedComplete(Rr,Pr)}onError(Tr,Ar){var Rr;if(Ar.fatal){this.state=State.ERROR;return}switch(Ar.details){case ErrorDetails.FRAG_GAP:case ErrorDetails.FRAG_PARSING_ERROR:case ErrorDetails.FRAG_DECRYPT_ERROR:case ErrorDetails.FRAG_LOAD_ERROR:case ErrorDetails.FRAG_LOAD_TIMEOUT:case ErrorDetails.KEY_LOAD_ERROR:case ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(PlaylistLevelType.AUDIO,Ar);break;case ErrorDetails.AUDIO_TRACK_LOAD_ERROR:case ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:case ErrorDetails.LEVEL_PARSING_ERROR:!Ar.levelRetry&&this.state===State.WAITING_TRACK&&((Rr=Ar.context)==null?void 0:Rr.type)===PlaylistContextType.AUDIO_TRACK&&(this.state=State.IDLE);break;case ErrorDetails.BUFFER_FULL_ERROR:if(!Ar.parent||Ar.parent!=="audio")return;this.reduceLengthAndFlushBuffer(Ar)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case ErrorDetails.INTERNAL_EXCEPTION:this.recoverWorkerError(Ar);break}}onBufferFlushed(Tr,{type:Ar}){Ar===ElementaryStreamTypes.AUDIO&&(this.bufferFlushed=!0,this.state===State.ENDED&&(this.state=State.IDLE))}_handleTransmuxComplete(Tr){var Ar;const Rr="audio",{hls:Pr}=this,{remuxResult:Dr,chunkMeta:Mr}=Tr,Fr=this.getCurrentContext(Mr);if(!Fr){this.resetWhenMissingContext(Mr);return}const{frag:zr,part:jr,level:Gr}=Fr,{details:Nr}=Gr,{audio:Lr,text:Ur,id3:Vr,initSegment:Wr}=Dr;if(this.fragContextChanged(zr)||!Nr){this.fragmentTracker.removeFragment(zr);return}if(this.state=State.PARSING,this.switchingTrack&&Lr&&this.completeAudioSwitch(this.switchingTrack),Wr!=null&&Wr.tracks){const qr=zr.initSegment||zr;this._bufferInitSegment(Wr.tracks,qr,Mr),Pr.trigger(Events.FRAG_PARSING_INIT_SEGMENT,{frag:qr,id:Rr,tracks:Wr.tracks})}if(Lr){const{startPTS:qr,endPTS:Kr,startDTS:Xr,endDTS:Zr}=Lr;jr&&(jr.elementaryStreams[ElementaryStreamTypes.AUDIO]={startPTS:qr,endPTS:Kr,startDTS:Xr,endDTS:Zr}),zr.setElementaryStreamInfo(ElementaryStreamTypes.AUDIO,qr,Kr,Xr,Zr),this.bufferFragmentData(Lr,zr,jr,Mr)}if(Vr!=null&&(Ar=Vr.samples)!=null&&Ar.length){const qr=_extends({id:Rr,frag:zr,details:Nr},Vr);Pr.trigger(Events.FRAG_PARSING_METADATA,qr)}if(Ur){const qr=_extends({id:Rr,frag:zr,details:Nr},Ur);Pr.trigger(Events.FRAG_PARSING_USERDATA,qr)}}_bufferInitSegment(Tr,Ar,Rr){if(this.state!==State.PARSING)return;Tr.video&&delete Tr.video;const Pr=Tr.audio;if(!Pr)return;Pr.levelCodec=Pr.codec,Pr.id="audio",this.log(`Init audio buffer, container:${Pr.container}, codecs[parsed]=[${Pr.codec}]`),this.hls.trigger(Events.BUFFER_CODECS,Tr);const Dr=Pr.initSegment;if(Dr!=null&&Dr.byteLength){const Mr={type:"audio",frag:Ar,part:null,chunkMeta:Rr,parent:Ar.type,data:Dr};this.hls.trigger(Events.BUFFER_APPENDING,Mr)}this.tick()}loadFragment(Tr,Ar,Rr){const Pr=this.fragmentTracker.getState(Tr);if(this.fragCurrent=Tr,this.switchingTrack||Pr===FragmentState.NOT_LOADED||Pr===FragmentState.PARTIAL){var Dr;Tr.sn==="initSegment"?this._loadInitSegment(Tr,Ar):(Dr=Ar.details)!=null&&Dr.live&&!this.initPTS[Tr.cc]?(this.log(`Waiting for video PTS in continuity counter ${Tr.cc} of live stream before loading audio fragment ${Tr.sn} of level ${this.trackId}`),this.state=State.WAITING_INIT_PTS):(this.startFragRequested=!0,super.loadFragment(Tr,Ar,Rr))}else this.clearTrackerIfNeeded(Tr)}completeAudioSwitch(Tr){const{hls:Ar,media:Rr,bufferedTrack:Pr}=this,Dr=Pr==null?void 0:Pr.attrs,Mr=Tr.attrs;Rr&&Dr&&(Dr.CHANNELS!==Mr.CHANNELS||Dr.NAME!==Mr.NAME||Dr.LANGUAGE!==Mr.LANGUAGE)&&(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio")),this.bufferedTrack=Tr,this.switchingTrack=null,Ar.trigger(Events.AUDIO_TRACK_SWITCHED,_objectSpread2({},Tr))}}class AudioTrackController extends BasePlaylistController{constructor(Tr){super(Tr,"[audio-track-controller]"),this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){const{hls:Tr}=this;Tr.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),Tr.on(Events.MANIFEST_PARSED,this.onManifestParsed,this),Tr.on(Events.LEVEL_LOADING,this.onLevelLoading,this),Tr.on(Events.LEVEL_SWITCHING,this.onLevelSwitching,this),Tr.on(Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),Tr.on(Events.ERROR,this.onError,this)}unregisterListeners(){const{hls:Tr}=this;Tr.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),Tr.off(Events.MANIFEST_PARSED,this.onManifestParsed,this),Tr.off(Events.LEVEL_LOADING,this.onLevelLoading,this),Tr.off(Events.LEVEL_SWITCHING,this.onLevelSwitching,this),Tr.off(Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),Tr.off(Events.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(Tr,Ar){this.tracks=Ar.audioTracks||[]}onAudioTrackLoaded(Tr,Ar){const{id:Rr,groupId:Pr,details:Dr}=Ar,Mr=this.tracksInGroup[Rr];if(!Mr||Mr.groupId!==Pr){this.warn(`Track with id:${Rr} and group:${Pr} not found in active group ${Mr.groupId}`);return}const Fr=Mr.details;Mr.details=Ar.details,this.log(`audio-track ${Rr} "${Mr.name}" lang:${Mr.lang} group:${Pr} loaded [${Dr.startSN}-${Dr.endSN}]`),Rr===this.trackId&&this.playlistLoaded(Rr,Ar,Fr)}onLevelLoading(Tr,Ar){this.switchLevel(Ar.level)}onLevelSwitching(Tr,Ar){this.switchLevel(Ar.level)}switchLevel(Tr){const Ar=this.hls.levels[Tr];if(!(Ar!=null&&Ar.audioGroupIds))return;const Rr=Ar.audioGroupIds[Ar.urlId];if(this.groupId!==Rr){this.groupId=Rr||null;const Pr=this.tracks.filter(Mr=>!Rr||Mr.groupId===Rr);this.selectDefaultTrack&&!Pr.some(Mr=>Mr.default)&&(this.selectDefaultTrack=!1),this.tracksInGroup=Pr;const Dr={audioTracks:Pr};this.log(`Updating audio tracks, ${Pr.length} track(s) found in group:${Rr}`),this.hls.trigger(Events.AUDIO_TRACKS_UPDATED,Dr),this.selectInitialTrack()}else this.shouldReloadPlaylist(this.currentTrack)&&this.setAudioTrack(this.trackId)}onError(Tr,Ar){Ar.fatal||!Ar.context||Ar.context.type===PlaylistContextType.AUDIO_TRACK&&Ar.context.id===this.trackId&&Ar.context.groupId===this.groupId&&(this.requestScheduled=-1,this.checkRetry(Ar))}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(Tr){this.selectDefaultTrack=!1,this.setAudioTrack(Tr)}setAudioTrack(Tr){const Ar=this.tracksInGroup;if(Tr<0||Tr>=Ar.length){this.warn("Invalid id passed to audio-track controller");return}this.clearTimer();const Rr=this.currentTrack;Ar[this.trackId];const Pr=Ar[Tr],{groupId:Dr,name:Mr}=Pr;if(this.log(`Switching to audio-track ${Tr} "${Mr}" lang:${Pr.lang} group:${Dr}`),this.trackId=Tr,this.currentTrack=Pr,this.selectDefaultTrack=!1,this.hls.trigger(Events.AUDIO_TRACK_SWITCHING,_objectSpread2({},Pr)),Pr.details&&!Pr.details.live)return;const Fr=this.switchParams(Pr.url,Rr==null?void 0:Rr.details);this.loadPlaylist(Fr)}selectInitialTrack(){const Tr=this.tracksInGroup,Ar=this.findTrackId(this.currentTrack)|this.findTrackId(null);if(Ar!==-1)this.setAudioTrack(Ar);else{const Rr=new Error(`No track found for running audio group-ID: ${this.groupId} track count: ${Tr.length}`);this.warn(Rr.message),this.hls.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:Rr})}}findTrackId(Tr){const Ar=this.tracksInGroup;for(let Rr=0;Rr<Ar.length;Rr++){const Pr=Ar[Rr];if((!this.selectDefaultTrack||Pr.default)&&(!Tr||Tr.attrs["STABLE-RENDITION-ID"]!==void 0&&Tr.attrs["STABLE-RENDITION-ID"]===Pr.attrs["STABLE-RENDITION-ID"]||Tr.name===Pr.name&&Tr.lang===Pr.lang))return Pr.id}return-1}loadPlaylist(Tr){super.loadPlaylist();const Ar=this.tracksInGroup[this.trackId];if(this.shouldLoadPlaylist(Ar)){const Rr=Ar.id,Pr=Ar.groupId;let Dr=Ar.url;if(Tr)try{Dr=Tr.addDirectives(Dr)}catch(Mr){this.warn(`Could not construct new URL with HLS Delivery Directives: ${Mr}`)}this.log(`loading audio-track playlist ${Rr} "${Ar.name}" lang:${Ar.lang} group:${Pr}`),this.clearTimer(),this.hls.trigger(Events.AUDIO_TRACK_LOADING,{url:Dr,id:Rr,groupId:Pr,deliveryDirectives:Tr||null})}}}function subtitleOptionsIdentical(_r,Tr){if(_r.length!==Tr.length)return!1;for(let Ar=0;Ar<_r.length;Ar++)if(!subtitleAttributesIdentical(_r[Ar].attrs,Tr[Ar].attrs))return!1;return!0}function subtitleAttributesIdentical(_r,Tr){const Ar=_r["STABLE-RENDITION-ID"];return Ar?Ar===Tr["STABLE-RENDITION-ID"]:!["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED"].some(Rr=>_r[Rr]!==Tr[Rr])}const TICK_INTERVAL=500;class SubtitleStreamController extends BaseStreamController{constructor(Tr,Ar,Rr){super(Tr,Ar,Rr,"[subtitle-stream-controller]",PlaylistLevelType.SUBTITLE),this.levels=[],this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),this.mainDetails=null}_registerListeners(){const{hls:Tr}=this;Tr.on(Events.MEDIA_ATTACHED,this.onMediaAttached,this),Tr.on(Events.MEDIA_DETACHING,this.onMediaDetaching,this),Tr.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),Tr.on(Events.LEVEL_LOADED,this.onLevelLoaded,this),Tr.on(Events.ERROR,this.onError,this),Tr.on(Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),Tr.on(Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),Tr.on(Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),Tr.on(Events.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),Tr.on(Events.BUFFER_FLUSHING,this.onBufferFlushing,this),Tr.on(Events.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){const{hls:Tr}=this;Tr.off(Events.MEDIA_ATTACHED,this.onMediaAttached,this),Tr.off(Events.MEDIA_DETACHING,this.onMediaDetaching,this),Tr.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),Tr.off(Events.LEVEL_LOADED,this.onLevelLoaded,this),Tr.off(Events.ERROR,this.onError,this),Tr.off(Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),Tr.off(Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),Tr.off(Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),Tr.off(Events.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),Tr.off(Events.BUFFER_FLUSHING,this.onBufferFlushing,this),Tr.off(Events.FRAG_BUFFERED,this.onFragBuffered,this)}startLoad(Tr){this.stopLoad(),this.state=State.IDLE,this.setInterval(TICK_INTERVAL),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=Tr,this.tick()}onManifestLoading(){this.mainDetails=null,this.fragmentTracker.removeAllFragments()}onMediaDetaching(){this.tracksBuffered=[],super.onMediaDetaching()}onLevelLoaded(Tr,Ar){this.mainDetails=Ar.details}onSubtitleFragProcessed(Tr,Ar){const{frag:Rr,success:Pr}=Ar;if(this.fragPrevious=Rr,this.state=State.IDLE,!Pr)return;const Dr=this.tracksBuffered[this.currentTrackId];if(!Dr)return;let Mr;const Fr=Rr.start;for(let jr=0;jr<Dr.length;jr++)if(Fr>=Dr[jr].start&&Fr<=Dr[jr].end){Mr=Dr[jr];break}const zr=Rr.start+Rr.duration;Mr?Mr.end=zr:(Mr={start:Fr,end:zr},Dr.push(Mr)),this.fragmentTracker.fragBuffered(Rr)}onBufferFlushing(Tr,Ar){const{startOffset:Rr,endOffset:Pr}=Ar;if(Rr===0&&Pr!==Number.POSITIVE_INFINITY){const Dr=Pr-1;if(Dr<=0)return;Ar.endOffsetSubtitles=Math.max(0,Dr),this.tracksBuffered.forEach(Mr=>{for(let Fr=0;Fr<Mr.length;){if(Mr[Fr].end<=Dr){Mr.shift();continue}else if(Mr[Fr].start<Dr)Mr[Fr].start=Dr;else break;Fr++}}),this.fragmentTracker.removeFragmentsInRange(Rr,Dr,PlaylistLevelType.SUBTITLE)}}onFragBuffered(Tr,Ar){if(!this.loadedmetadata&&Ar.frag.type===PlaylistLevelType.MAIN){var Rr;(Rr=this.media)!=null&&Rr.buffered.length&&(this.loadedmetadata=!0)}}onError(Tr,Ar){const Rr=Ar.frag;(Rr==null?void 0:Rr.type)===PlaylistLevelType.SUBTITLE&&(this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==State.STOPPED&&(this.state=State.IDLE))}onSubtitleTracksUpdated(Tr,{subtitleTracks:Ar}){if(subtitleOptionsIdentical(this.levels,Ar)){this.levels=Ar.map(Rr=>new Level(Rr));return}this.tracksBuffered=[],this.levels=Ar.map(Rr=>{const Pr=new Level(Rr);return this.tracksBuffered[Pr.id]=[],Pr}),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,PlaylistLevelType.SUBTITLE),this.fragPrevious=null,this.mediaBuffer=null}onSubtitleTrackSwitch(Tr,Ar){if(this.currentTrackId=Ar.id,!this.levels.length||this.currentTrackId===-1){this.clearInterval();return}const Rr=this.levels[this.currentTrackId];Rr!=null&&Rr.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,Rr&&this.setInterval(TICK_INTERVAL)}onSubtitleTrackLoaded(Tr,Ar){var Rr;const{details:Pr,id:Dr}=Ar,{currentTrackId:Mr,levels:Fr}=this;if(!Fr.length)return;const zr=Fr[Mr];if(Dr>=Fr.length||Dr!==Mr||!zr)return;this.mediaBuffer=this.mediaBufferTimeRanges;let jr=0;if(Pr.live||(Rr=zr.details)!=null&&Rr.live){const Gr=this.mainDetails;if(Pr.deltaUpdateFailed||!Gr)return;const Nr=Gr.fragments[0];zr.details?(jr=this.alignPlaylists(Pr,zr.details),jr===0&&Nr&&(jr=Nr.start,addSliding(Pr,jr))):Pr.hasProgramDateTime&&Gr.hasProgramDateTime?(alignMediaPlaylistByPDT(Pr,Gr),jr=Pr.fragments[0].start):Nr&&(jr=Nr.start,addSliding(Pr,jr))}zr.details=Pr,this.levelLastLoaded=Dr,!this.startFragRequested&&(this.mainDetails||!Pr.live)&&this.setStartPosition(zr.details,jr),this.tick(),Pr.live&&!this.fragCurrent&&this.media&&this.state===State.IDLE&&(findFragmentByPTS(null,Pr.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),zr.details=void 0))}_handleFragmentLoadComplete(Tr){const{frag:Ar,payload:Rr}=Tr,Pr=Ar.decryptdata,Dr=this.hls;if(!this.fragContextChanged(Ar)&&Rr&&Rr.byteLength>0&&Pr&&Pr.key&&Pr.iv&&Pr.method==="AES-128"){const Mr=performance.now();this.decrypter.decrypt(new Uint8Array(Rr),Pr.key.buffer,Pr.iv.buffer).catch(Fr=>{throw Dr.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.FRAG_DECRYPT_ERROR,fatal:!1,error:Fr,reason:Fr.message,frag:Ar}),Fr}).then(Fr=>{const zr=performance.now();Dr.trigger(Events.FRAG_DECRYPTED,{frag:Ar,payload:Fr,stats:{tstart:Mr,tdecrypt:zr}})}).catch(Fr=>{this.warn(`${Fr.name}: ${Fr.message}`),this.state=State.IDLE})}}doTick(){if(!this.media){this.state=State.IDLE;return}if(this.state===State.IDLE){const{currentTrackId:Tr,levels:Ar}=this,Rr=Ar[Tr];if(!Ar.length||!Rr||!Rr.details)return;const{config:Pr}=this,Dr=this.getLoadPosition(),Mr=BufferHelper.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],Dr,Pr.maxBufferHole),{end:Fr,len:zr}=Mr,jr=this.getFwdBufferInfo(this.media,PlaylistLevelType.MAIN),Gr=Rr.details,Nr=this.getMaxBufferLength(jr==null?void 0:jr.len)+Gr.levelTargetDuration;if(zr>Nr)return;const Lr=Gr.fragments,Ur=Lr.length,Vr=Gr.edge;let Wr=null;const qr=this.fragPrevious;if(Fr<Vr){const Kr=Pr.maxFragLookUpTolerance,Xr=Fr>Vr-Kr?0:Kr;Wr=findFragmentByPTS(qr,Lr,Math.max(Lr[0].start,Fr),Xr),!Wr&&qr&&qr.start<Lr[0].start&&(Wr=Lr[0])}else Wr=Lr[Ur-1];if(!Wr)return;if(Wr=this.mapToInitFragWhenRequired(Wr),Wr.sn!=="initSegment"){const Kr=Wr.sn-Gr.startSN,Xr=Lr[Kr-1];Xr&&Xr.cc===Wr.cc&&this.fragmentTracker.getState(Xr)===FragmentState.NOT_LOADED&&(Wr=Xr)}this.fragmentTracker.getState(Wr)===FragmentState.NOT_LOADED&&this.loadFragment(Wr,Rr,Fr)}}getMaxBufferLength(Tr){const Ar=super.getMaxBufferLength();return Tr?Math.max(Ar,Tr):Ar}loadFragment(Tr,Ar,Rr){this.fragCurrent=Tr,Tr.sn==="initSegment"?this._loadInitSegment(Tr,Ar):(this.startFragRequested=!0,super.loadFragment(Tr,Ar,Rr))}get mediaBufferTimeRanges(){return new BufferableInstance(this.tracksBuffered[this.currentTrackId]||[])}}class BufferableInstance{constructor(Tr){this.buffered=void 0;const Ar=(Rr,Pr,Dr)=>{if(Pr=Pr>>>0,Pr>Dr-1)throw new DOMException(`Failed to execute '${Rr}' on 'TimeRanges': The index provided (${Pr}) is greater than the maximum bound (${Dr})`);return Tr[Pr][Rr]};this.buffered={get length(){return Tr.length},end(Rr){return Ar("end",Rr,Tr.length)},start(Rr){return Ar("start",Rr,Tr.length)}}}}class SubtitleTrackController extends BasePlaylistController{constructor(Tr){super(Tr,"[subtitle-track-controller]"),this.media=null,this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.trackChangeListener=()=>this.onTextTracksChanged(),this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.trackChangeListener=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(Tr){this._subtitleDisplay=Tr,this.trackId>-1&&this.toggleTrackModes(this.trackId)}registerListeners(){const{hls:Tr}=this;Tr.on(Events.MEDIA_ATTACHED,this.onMediaAttached,this),Tr.on(Events.MEDIA_DETACHING,this.onMediaDetaching,this),Tr.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),Tr.on(Events.MANIFEST_PARSED,this.onManifestParsed,this),Tr.on(Events.LEVEL_LOADING,this.onLevelLoading,this),Tr.on(Events.LEVEL_SWITCHING,this.onLevelSwitching,this),Tr.on(Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),Tr.on(Events.ERROR,this.onError,this)}unregisterListeners(){const{hls:Tr}=this;Tr.off(Events.MEDIA_ATTACHED,this.onMediaAttached,this),Tr.off(Events.MEDIA_DETACHING,this.onMediaDetaching,this),Tr.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),Tr.off(Events.MANIFEST_PARSED,this.onManifestParsed,this),Tr.off(Events.LEVEL_LOADING,this.onLevelLoading,this),Tr.off(Events.LEVEL_SWITCHING,this.onLevelSwitching,this),Tr.off(Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),Tr.off(Events.ERROR,this.onError,this)}onMediaAttached(Tr,Ar){this.media=Ar.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(Tr){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.trackChangeListener,Tr)}onMediaDetaching(){if(!this.media)return;self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||this.media.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),filterSubtitleTracks(this.media.textTracks).forEach(Ar=>{clearCurrentCues(Ar)}),this.subtitleTrack=-1,this.media=null}onManifestLoading(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(Tr,Ar){this.tracks=Ar.subtitleTracks}onSubtitleTrackLoaded(Tr,Ar){const{id:Rr,details:Pr}=Ar,{trackId:Dr}=this,Mr=this.tracksInGroup[Dr];if(!Mr){this.warn(`Invalid subtitle track id ${Rr}`);return}const Fr=Mr.details;Mr.details=Ar.details,this.log(`subtitle track ${Rr} loaded [${Pr.startSN}-${Pr.endSN}]`),Rr===this.trackId&&this.playlistLoaded(Rr,Ar,Fr)}onLevelLoading(Tr,Ar){this.switchLevel(Ar.level)}onLevelSwitching(Tr,Ar){this.switchLevel(Ar.level)}switchLevel(Tr){const Ar=this.hls.levels[Tr];if(!(Ar!=null&&Ar.textGroupIds))return;const Rr=Ar.textGroupIds[Ar.urlId],Pr=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0;if(this.groupId!==Rr){const Dr=this.tracks.filter(zr=>!Rr||zr.groupId===Rr);this.tracksInGroup=Dr;const Mr=this.findTrackId(Pr==null?void 0:Pr.name)||this.findTrackId();this.groupId=Rr||null;const Fr={subtitleTracks:Dr};this.log(`Updating subtitle tracks, ${Dr.length} track(s) found in "${Rr}" group-id`),this.hls.trigger(Events.SUBTITLE_TRACKS_UPDATED,Fr),Mr!==-1&&this.setSubtitleTrack(Mr,Pr)}else this.shouldReloadPlaylist(Pr)&&this.setSubtitleTrack(this.trackId,Pr)}findTrackId(Tr){const Ar=this.tracksInGroup;for(let Rr=0;Rr<Ar.length;Rr++){const Pr=Ar[Rr];if((!this.selectDefaultTrack||Pr.default)&&(!Tr||Tr===Pr.name))return Pr.id}return-1}onError(Tr,Ar){Ar.fatal||!Ar.context||Ar.context.type===PlaylistContextType.SUBTITLE_TRACK&&Ar.context.id===this.trackId&&Ar.context.groupId===this.groupId&&this.checkRetry(Ar)}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(Tr){this.selectDefaultTrack=!1;const Ar=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0;this.setSubtitleTrack(Tr,Ar)}loadPlaylist(Tr){super.loadPlaylist();const Ar=this.tracksInGroup[this.trackId];if(this.shouldLoadPlaylist(Ar)){const Rr=Ar.id,Pr=Ar.groupId;let Dr=Ar.url;if(Tr)try{Dr=Tr.addDirectives(Dr)}catch(Mr){this.warn(`Could not construct new URL with HLS Delivery Directives: ${Mr}`)}this.log(`Loading subtitle playlist for id ${Rr}`),this.hls.trigger(Events.SUBTITLE_TRACK_LOADING,{url:Dr,id:Rr,groupId:Pr,deliveryDirectives:Tr||null})}}toggleTrackModes(Tr){const{media:Ar,trackId:Rr}=this;if(!Ar)return;const Pr=filterSubtitleTracks(Ar.textTracks),Dr=Pr.filter(Fr=>Fr.groupId===this.groupId);if(Tr===-1)[].slice.call(Pr).forEach(Fr=>{Fr.mode="disabled"});else{const Fr=Dr[Rr];Fr&&(Fr.mode="disabled")}const Mr=Dr[Tr];Mr&&(Mr.mode=this.subtitleDisplay?"showing":"hidden")}setSubtitleTrack(Tr,Ar){var Rr;const Pr=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=Tr;return}if(this.trackId!==Tr&&this.toggleTrackModes(Tr),this.trackId===Tr&&(Tr===-1||(Rr=Pr[Tr])!=null&&Rr.details)||Tr<-1||Tr>=Pr.length)return;this.clearTimer();const Dr=Pr[Tr];if(this.log(`Switching to subtitle-track ${Tr}`+(Dr?` "${Dr.name}" lang:${Dr.lang} group:${Dr.groupId}`:"")),this.trackId=Tr,Dr){const{id:Mr,groupId:Fr="",name:zr,type:jr,url:Gr}=Dr;this.hls.trigger(Events.SUBTITLE_TRACK_SWITCH,{id:Mr,groupId:Fr,name:zr,type:jr,url:Gr});const Nr=this.switchParams(Dr.url,Ar==null?void 0:Ar.details);this.loadPlaylist(Nr)}else this.hls.trigger(Events.SUBTITLE_TRACK_SWITCH,{id:Tr})}onTextTracksChanged(){if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let Tr=-1;const Ar=filterSubtitleTracks(this.media.textTracks);for(let Rr=0;Rr<Ar.length;Rr++)if(Ar[Rr].mode==="hidden")Tr=Rr;else if(Ar[Rr].mode==="showing"){Tr=Rr;break}this.subtitleTrack!==Tr&&(this.subtitleTrack=Tr)}}function filterSubtitleTracks(_r){const Tr=[];for(let Ar=0;Ar<_r.length;Ar++){const Rr=_r[Ar];(Rr.kind==="subtitles"||Rr.kind==="captions")&&Rr.label&&Tr.push(_r[Ar])}return Tr}class BufferOperationQueue{constructor(Tr){this.buffers=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.buffers=Tr}append(Tr,Ar){const Rr=this.queues[Ar];Rr.push(Tr),Rr.length===1&&this.buffers[Ar]&&this.executeNext(Ar)}insertAbort(Tr,Ar){this.queues[Ar].unshift(Tr),this.executeNext(Ar)}appendBlocker(Tr){let Ar;const Rr=new Promise(Dr=>{Ar=Dr}),Pr={execute:Ar,onStart:()=>{},onComplete:()=>{},onError:()=>{}};return this.append(Pr,Tr),Rr}executeNext(Tr){const{buffers:Ar,queues:Rr}=this,Pr=Ar[Tr],Dr=Rr[Tr];if(Dr.length){const Mr=Dr[0];try{Mr.execute()}catch(Fr){logger.warn("[buffer-operation-queue]: Unhandled exception executing the current operation"),Mr.onError(Fr),Pr!=null&&Pr.updating||(Dr.shift(),this.executeNext(Tr))}}}shiftAndExecuteNext(Tr){this.queues[Tr].shift(),this.executeNext(Tr)}current(Tr){return this.queues[Tr][0]}}const MediaSource=getMediaSource(),VIDEO_CODEC_PROFILE_REPACE=/([ha]vc.)(?:\.[^.,]+)+/;class BufferController{constructor(Tr){this.details=null,this._objectUrl=null,this.operationQueue=void 0,this.listeners=void 0,this.hls=void 0,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.appendError=0,this.tracks={},this.pendingTracks={},this.sourceBuffer=void 0,this._onMediaSourceOpen=()=>{const{media:Ar,mediaSource:Rr}=this;logger.log("[buffer-controller]: Media source opened"),Ar&&(Ar.removeEventListener("emptied",this._onMediaEmptied),this.updateMediaElementDuration(),this.hls.trigger(Events.MEDIA_ATTACHED,{media:Ar})),Rr&&Rr.removeEventListener("sourceopen",this._onMediaSourceOpen),this.checkPendingTracks()},this._onMediaSourceClose=()=>{logger.log("[buffer-controller]: Media source closed")},this._onMediaSourceEnded=()=>{logger.log("[buffer-controller]: Media source ended")},this._onMediaEmptied=()=>{const{media:Ar,_objectUrl:Rr}=this;Ar&&Ar.src!==Rr&&logger.error(`Media element src was set while attaching MediaSource (${Rr} > ${Ar.src})`)},this.hls=Tr,this._initSourceBuffer(),this.registerListeners()}hasSourceTypes(){return this.getSourceBufferTypes().length>0||Object.keys(this.pendingTracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=null}registerListeners(){const{hls:Tr}=this;Tr.on(Events.MEDIA_ATTACHING,this.onMediaAttaching,this),Tr.on(Events.MEDIA_DETACHING,this.onMediaDetaching,this),Tr.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),Tr.on(Events.MANIFEST_PARSED,this.onManifestParsed,this),Tr.on(Events.BUFFER_RESET,this.onBufferReset,this),Tr.on(Events.BUFFER_APPENDING,this.onBufferAppending,this),Tr.on(Events.BUFFER_CODECS,this.onBufferCodecs,this),Tr.on(Events.BUFFER_EOS,this.onBufferEos,this),Tr.on(Events.BUFFER_FLUSHING,this.onBufferFlushing,this),Tr.on(Events.LEVEL_UPDATED,this.onLevelUpdated,this),Tr.on(Events.FRAG_PARSED,this.onFragParsed,this),Tr.on(Events.FRAG_CHANGED,this.onFragChanged,this)}unregisterListeners(){const{hls:Tr}=this;Tr.off(Events.MEDIA_ATTACHING,this.onMediaAttaching,this),Tr.off(Events.MEDIA_DETACHING,this.onMediaDetaching,this),Tr.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),Tr.off(Events.MANIFEST_PARSED,this.onManifestParsed,this),Tr.off(Events.BUFFER_RESET,this.onBufferReset,this),Tr.off(Events.BUFFER_APPENDING,this.onBufferAppending,this),Tr.off(Events.BUFFER_CODECS,this.onBufferCodecs,this),Tr.off(Events.BUFFER_EOS,this.onBufferEos,this),Tr.off(Events.BUFFER_FLUSHING,this.onBufferFlushing,this),Tr.off(Events.LEVEL_UPDATED,this.onLevelUpdated,this),Tr.off(Events.FRAG_PARSED,this.onFragParsed,this),Tr.off(Events.FRAG_CHANGED,this.onFragChanged,this)}_initSourceBuffer(){this.sourceBuffer={},this.operationQueue=new BufferOperationQueue(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]},this.lastMpegAudioChunk=null}onManifestLoading(){this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=0,this.details=null}onManifestParsed(Tr,Ar){let Rr=2;(Ar.audio&&!Ar.video||!Ar.altAudio)&&(Rr=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=Rr,logger.log(`${this.bufferCodecEventsExpected} bufferCodec event(s) expected`)}onMediaAttaching(Tr,Ar){const Rr=this.media=Ar.media;if(Rr&&MediaSource){const Pr=this.mediaSource=new MediaSource;Pr.addEventListener("sourceopen",this._onMediaSourceOpen),Pr.addEventListener("sourceended",this._onMediaSourceEnded),Pr.addEventListener("sourceclose",this._onMediaSourceClose),Rr.src=self.URL.createObjectURL(Pr),this._objectUrl=Rr.src,Rr.addEventListener("emptied",this._onMediaEmptied)}}onMediaDetaching(){const{media:Tr,mediaSource:Ar,_objectUrl:Rr}=this;if(Ar){if(logger.log("[buffer-controller]: media source detaching"),Ar.readyState==="open")try{Ar.endOfStream()}catch(Pr){logger.warn(`[buffer-controller]: onMediaDetaching: ${Pr.message} while calling endOfStream`)}this.onBufferReset(),Ar.removeEventListener("sourceopen",this._onMediaSourceOpen),Ar.removeEventListener("sourceended",this._onMediaSourceEnded),Ar.removeEventListener("sourceclose",this._onMediaSourceClose),Tr&&(Tr.removeEventListener("emptied",this._onMediaEmptied),Rr&&self.URL.revokeObjectURL(Rr),Tr.src===Rr?(Tr.removeAttribute("src"),Tr.load()):logger.warn("[buffer-controller]: media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger(Events.MEDIA_DETACHED,void 0)}onBufferReset(){this.getSourceBufferTypes().forEach(Tr=>{const Ar=this.sourceBuffer[Tr];try{Ar&&(this.removeBufferListeners(Tr),this.mediaSource&&this.mediaSource.removeSourceBuffer(Ar),this.sourceBuffer[Tr]=void 0)}catch(Rr){logger.warn(`[buffer-controller]: Failed to reset the ${Tr} buffer`,Rr)}}),this._initSourceBuffer()}onBufferCodecs(Tr,Ar){const Rr=this.getSourceBufferTypes().length;Object.keys(Ar).forEach(Pr=>{if(Rr){const Dr=this.tracks[Pr];if(Dr&&typeof Dr.buffer.changeType=="function"){const{id:Mr,codec:Fr,levelCodec:zr,container:jr,metadata:Gr}=Ar[Pr],Nr=(Dr.levelCodec||Dr.codec).replace(VIDEO_CODEC_PROFILE_REPACE,"$1"),Lr=(zr||Fr).replace(VIDEO_CODEC_PROFILE_REPACE,"$1");if(Nr!==Lr){const Ur=`${jr};codecs=${zr||Fr}`;this.appendChangeType(Pr,Ur),logger.log(`[buffer-controller]: switching codec ${Nr} to ${Lr}`),this.tracks[Pr]={buffer:Dr.buffer,codec:Fr,container:jr,levelCodec:zr,metadata:Gr,id:Mr}}}}else this.pendingTracks[Pr]=Ar[Pr]}),!Rr&&(this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),this.mediaSource&&this.mediaSource.readyState==="open"&&this.checkPendingTracks())}appendChangeType(Tr,Ar){const{operationQueue:Rr}=this,Pr={execute:()=>{const Dr=this.sourceBuffer[Tr];Dr&&(logger.log(`[buffer-controller]: changing ${Tr} sourceBuffer type to ${Ar}`),Dr.changeType(Ar)),Rr.shiftAndExecuteNext(Tr)},onStart:()=>{},onComplete:()=>{},onError:Dr=>{logger.warn(`[buffer-controller]: Failed to change ${Tr} SourceBuffer type`,Dr)}};Rr.append(Pr,Tr)}onBufferAppending(Tr,Ar){const{hls:Rr,operationQueue:Pr,tracks:Dr}=this,{data:Mr,type:Fr,frag:zr,part:jr,chunkMeta:Gr}=Ar,Nr=Gr.buffering[Fr],Lr=self.performance.now();Nr.start=Lr;const Ur=zr.stats.buffering,Vr=jr?jr.stats.buffering:null;Ur.start===0&&(Ur.start=Lr),Vr&&Vr.start===0&&(Vr.start=Lr);const Wr=Dr.audio;let qr=!1;Fr==="audio"&&(Wr==null?void 0:Wr.container)==="audio/mpeg"&&(qr=!this.lastMpegAudioChunk||Gr.id===1||this.lastMpegAudioChunk.sn!==Gr.sn,this.lastMpegAudioChunk=Gr);const Kr=zr.start,Xr={execute:()=>{if(Nr.executeStart=self.performance.now(),qr){const Zr=this.sourceBuffer[Fr];if(Zr){const _i=Kr-Zr.timestampOffset;Math.abs(_i)>=.1&&(logger.log(`[buffer-controller]: Updating audio SourceBuffer timestampOffset to ${Kr} (delta: ${_i}) sn: ${zr.sn})`),Zr.timestampOffset=Kr)}}this.appendExecutor(Mr,Fr)},onStart:()=>{},onComplete:()=>{const Zr=self.performance.now();Nr.executeEnd=Nr.end=Zr,Ur.first===0&&(Ur.first=Zr),Vr&&Vr.first===0&&(Vr.first=Zr);const{sourceBuffer:_i}=this,Jr={};for(const es in _i)Jr[es]=BufferHelper.getBuffered(_i[es]);this.appendError=0,this.hls.trigger(Events.BUFFER_APPENDED,{type:Fr,frag:zr,part:jr,chunkMeta:Gr,parent:zr.type,timeRanges:Jr})},onError:Zr=>{logger.error(`[buffer-controller]: Error encountered while trying to append to the ${Fr} SourceBuffer`,Zr);const _i={type:ErrorTypes.MEDIA_ERROR,parent:zr.type,details:ErrorDetails.BUFFER_APPEND_ERROR,frag:zr,part:jr,chunkMeta:Gr,error:Zr,err:Zr,fatal:!1};Zr.code===DOMException.QUOTA_EXCEEDED_ERR?_i.details=ErrorDetails.BUFFER_FULL_ERROR:(this.appendError++,_i.details=ErrorDetails.BUFFER_APPEND_ERROR,this.appendError>Rr.config.appendErrorMaxRetry&&(logger.error(`[buffer-controller]: Failed ${Rr.config.appendErrorMaxRetry} times to append segment in sourceBuffer`),_i.fatal=!0)),Rr.trigger(Events.ERROR,_i)}};Pr.append(Xr,Fr)}onBufferFlushing(Tr,Ar){const{operationQueue:Rr}=this,Pr=Dr=>({execute:this.removeExecutor.bind(this,Dr,Ar.startOffset,Ar.endOffset),onStart:()=>{},onComplete:()=>{this.hls.trigger(Events.BUFFER_FLUSHED,{type:Dr})},onError:Mr=>{logger.warn(`[buffer-controller]: Failed to remove from ${Dr} SourceBuffer`,Mr)}});Ar.type?Rr.append(Pr(Ar.type),Ar.type):this.getSourceBufferTypes().forEach(Dr=>{Rr.append(Pr(Dr),Dr)})}onFragParsed(Tr,Ar){const{frag:Rr,part:Pr}=Ar,Dr=[],Mr=Pr?Pr.elementaryStreams:Rr.elementaryStreams;Mr[ElementaryStreamTypes.AUDIOVIDEO]?Dr.push("audiovideo"):(Mr[ElementaryStreamTypes.AUDIO]&&Dr.push("audio"),Mr[ElementaryStreamTypes.VIDEO]&&Dr.push("video"));const Fr=()=>{const zr=self.performance.now();Rr.stats.buffering.end=zr,Pr&&(Pr.stats.buffering.end=zr);const jr=Pr?Pr.stats:Rr.stats;this.hls.trigger(Events.FRAG_BUFFERED,{frag:Rr,part:Pr,stats:jr,id:Rr.type})};Dr.length===0&&logger.warn(`Fragments must have at least one ElementaryStreamType set. type: ${Rr.type} level: ${Rr.level} sn: ${Rr.sn}`),this.blockBuffers(Fr,Dr)}onFragChanged(Tr,Ar){this.flushBackBuffer()}onBufferEos(Tr,Ar){this.getSourceBufferTypes().reduce((Pr,Dr)=>{const Mr=this.sourceBuffer[Dr];return Mr&&(!Ar.type||Ar.type===Dr)&&(Mr.ending=!0,Mr.ended||(Mr.ended=!0,logger.log(`[buffer-controller]: ${Dr} sourceBuffer now EOS`))),Pr&&!!(!Mr||Mr.ended)},!0)&&(logger.log("[buffer-controller]: Queueing mediaSource.endOfStream()"),this.blockBuffers(()=>{this.getSourceBufferTypes().forEach(Dr=>{const Mr=this.sourceBuffer[Dr];Mr&&(Mr.ending=!1)});const{mediaSource:Pr}=this;if(!Pr||Pr.readyState!=="open"){Pr&&logger.info(`[buffer-controller]: Could not call mediaSource.endOfStream(). mediaSource.readyState: ${Pr.readyState}`);return}logger.log("[buffer-controller]: Calling mediaSource.endOfStream()"),Pr.endOfStream()}))}onLevelUpdated(Tr,{details:Ar}){Ar.fragments.length&&(this.details=Ar,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())}flushBackBuffer(){const{hls:Tr,details:Ar,media:Rr,sourceBuffer:Pr}=this;if(!Rr||Ar===null)return;const Dr=this.getSourceBufferTypes();if(!Dr.length)return;const Mr=Ar.live&&Tr.config.liveBackBufferLength!==null?Tr.config.liveBackBufferLength:Tr.config.backBufferLength;if(!isFiniteNumber(Mr)||Mr<0)return;const Fr=Rr.currentTime,zr=Ar.levelTargetDuration,jr=Math.max(Mr,zr),Gr=Math.floor(Fr/zr)*zr-jr;Dr.forEach(Nr=>{const Lr=Pr[Nr];if(Lr){const Ur=BufferHelper.getBuffered(Lr);if(Ur.length>0&&Gr>Ur.start(0)){if(Tr.trigger(Events.BACK_BUFFER_REACHED,{bufferEnd:Gr}),Ar.live)Tr.trigger(Events.LIVE_BACK_BUFFER_REACHED,{bufferEnd:Gr});else if(Lr.ended&&Ur.end(Ur.length-1)-Fr<zr*2){logger.info(`[buffer-controller]: Cannot flush ${Nr} back buffer while SourceBuffer is in ended state`);return}Tr.trigger(Events.BUFFER_FLUSHING,{startOffset:0,endOffset:Gr,type:Nr})}}})}updateMediaElementDuration(){if(!this.details||!this.media||!this.mediaSource||this.mediaSource.readyState!=="open")return;const{details:Tr,hls:Ar,media:Rr,mediaSource:Pr}=this,Dr=Tr.fragments[0].start+Tr.totalduration,Mr=Rr.duration,Fr=isFiniteNumber(Pr.duration)?Pr.duration:0;Tr.live&&Ar.config.liveDurationInfinity?(logger.log("[buffer-controller]: Media Source duration is set to Infinity"),Pr.duration=1/0,this.updateSeekableRange(Tr)):(Dr>Fr&&Dr>Mr||!isFiniteNumber(Mr))&&(logger.log(`[buffer-controller]: Updating Media Source duration to ${Dr.toFixed(3)}`),Pr.duration=Dr)}updateSeekableRange(Tr){const Ar=this.mediaSource,Rr=Tr.fragments;if(Rr.length&&Tr.live&&Ar!=null&&Ar.setLiveSeekableRange){const Dr=Math.max(0,Rr[0].start),Mr=Math.max(Dr,Dr+Tr.totalduration);Ar.setLiveSeekableRange(Dr,Mr)}}checkPendingTracks(){const{bufferCodecEventsExpected:Tr,operationQueue:Ar,pendingTracks:Rr}=this,Pr=Object.keys(Rr).length;if(Pr&&!Tr||Pr===2){this.createSourceBuffers(Rr),this.pendingTracks={};const Dr=this.getSourceBufferTypes();if(Dr.length)this.hls.trigger(Events.BUFFER_CREATED,{tracks:this.tracks}),Dr.forEach(Mr=>{Ar.executeNext(Mr)});else{const Mr=new Error("could not create source buffer for media codec(s)");this.hls.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:Mr,reason:Mr.message})}}}createSourceBuffers(Tr){const{sourceBuffer:Ar,mediaSource:Rr}=this;if(!Rr)throw Error("createSourceBuffers called when mediaSource was null");for(const Pr in Tr)if(!Ar[Pr]){const Dr=Tr[Pr];if(!Dr)throw Error(`source buffer exists for track ${Pr}, however track does not`);const Mr=Dr.levelCodec||Dr.codec,Fr=`${Dr.container};codecs=${Mr}`;logger.log(`[buffer-controller]: creating sourceBuffer(${Fr})`);try{const zr=Ar[Pr]=Rr.addSourceBuffer(Fr),jr=Pr;this.addBufferListener(jr,"updatestart",this._onSBUpdateStart),this.addBufferListener(jr,"updateend",this._onSBUpdateEnd),this.addBufferListener(jr,"error",this._onSBUpdateError),this.tracks[Pr]={buffer:zr,codec:Mr,container:Dr.container,levelCodec:Dr.levelCodec,metadata:Dr.metadata,id:Dr.id}}catch(zr){logger.error(`[buffer-controller]: error while trying to add sourceBuffer: ${zr.message}`),this.hls.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:zr,mimeType:Fr})}}}_onSBUpdateStart(Tr){const{operationQueue:Ar}=this;Ar.current(Tr).onStart()}_onSBUpdateEnd(Tr){const{operationQueue:Ar}=this;Ar.current(Tr).onComplete(),Ar.shiftAndExecuteNext(Tr)}_onSBUpdateError(Tr,Ar){const Rr=new Error(`${Tr} SourceBuffer error`);logger.error(`[buffer-controller]: ${Rr}`,Ar),this.hls.trigger(Events.ERROR,{type:ErrorTypes.MEDIA_ERROR,details:ErrorDetails.BUFFER_APPENDING_ERROR,error:Rr,fatal:!1});const Pr=this.operationQueue.current(Tr);Pr&&Pr.onError(Ar)}removeExecutor(Tr,Ar,Rr){const{media:Pr,mediaSource:Dr,operationQueue:Mr,sourceBuffer:Fr}=this,zr=Fr[Tr];if(!Pr||!Dr||!zr){logger.warn(`[buffer-controller]: Attempting to remove from the ${Tr} SourceBuffer, but it does not exist`),Mr.shiftAndExecuteNext(Tr);return}const jr=isFiniteNumber(Pr.duration)?Pr.duration:1/0,Gr=isFiniteNumber(Dr.duration)?Dr.duration:1/0,Nr=Math.max(0,Ar),Lr=Math.min(Rr,jr,Gr);Lr>Nr&&!zr.ending?(zr.ended=!1,logger.log(`[buffer-controller]: Removing [${Nr},${Lr}] from the ${Tr} SourceBuffer`),zr.remove(Nr,Lr)):Mr.shiftAndExecuteNext(Tr)}appendExecutor(Tr,Ar){const{operationQueue:Rr,sourceBuffer:Pr}=this,Dr=Pr[Ar];if(!Dr){logger.warn(`[buffer-controller]: Attempting to append to the ${Ar} SourceBuffer, but it does not exist`),Rr.shiftAndExecuteNext(Ar);return}Dr.ended=!1,Dr.appendBuffer(Tr)}blockBuffers(Tr,Ar=this.getSourceBufferTypes()){if(!Ar.length){logger.log("[buffer-controller]: Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(Tr);return}const{operationQueue:Rr}=this,Pr=Ar.map(Dr=>Rr.appendBlocker(Dr));Promise.all(Pr).then(()=>{Tr(),Ar.forEach(Dr=>{const Mr=this.sourceBuffer[Dr];Mr!=null&&Mr.updating||Rr.shiftAndExecuteNext(Dr)})})}getSourceBufferTypes(){return Object.keys(this.sourceBuffer)}addBufferListener(Tr,Ar,Rr){const Pr=this.sourceBuffer[Tr];if(!Pr)return;const Dr=Rr.bind(this,Tr);this.listeners[Tr].push({event:Ar,listener:Dr}),Pr.addEventListener(Ar,Dr)}removeBufferListeners(Tr){const Ar=this.sourceBuffer[Tr];Ar&&this.listeners[Tr].forEach(Rr=>{Ar.removeEventListener(Rr.event,Rr.listener)})}}const specialCea608CharsCodes={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},getCharForByte=function(Tr){let Ar=Tr;return specialCea608CharsCodes.hasOwnProperty(Tr)&&(Ar=specialCea608CharsCodes[Tr]),String.fromCharCode(Ar)},NR_ROWS=15,NR_COLS=100,rowsLowCh1={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},rowsHighCh1={17:2,18:4,21:6,22:8,23:10,19:13,20:15},rowsLowCh2={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},rowsHighCh2={25:2,26:4,29:6,30:8,31:10,27:13,28:15},backgroundColors=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class CaptionsLogger{constructor(){this.time=null,this.verboseLevel=0}log(Tr,Ar){if(this.verboseLevel>=Tr){const Rr=typeof Ar=="function"?Ar():Ar;logger.log(`${this.time} [${Tr}] ${Rr}`)}}}const numArrayToHexArray=function(Tr){const Ar=[];for(let Rr=0;Rr<Tr.length;Rr++)Ar.push(Tr[Rr].toString(16));return Ar};class PenState{constructor(Tr,Ar,Rr,Pr,Dr){this.foreground=void 0,this.underline=void 0,this.italics=void 0,this.background=void 0,this.flash=void 0,this.foreground=Tr||"white",this.underline=Ar||!1,this.italics=Rr||!1,this.background=Pr||"black",this.flash=Dr||!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(Tr){const Ar=["foreground","underline","italics","background","flash"];for(let Rr=0;Rr<Ar.length;Rr++){const Pr=Ar[Rr];Tr.hasOwnProperty(Pr)&&(this[Pr]=Tr[Pr])}}isDefault(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash}equals(Tr){return this.foreground===Tr.foreground&&this.underline===Tr.underline&&this.italics===Tr.italics&&this.background===Tr.background&&this.flash===Tr.flash}copy(Tr){this.foreground=Tr.foreground,this.underline=Tr.underline,this.italics=Tr.italics,this.background=Tr.background,this.flash=Tr.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class StyledUnicodeChar{constructor(Tr,Ar,Rr,Pr,Dr,Mr){this.uchar=void 0,this.penState=void 0,this.uchar=Tr||" ",this.penState=new PenState(Ar,Rr,Pr,Dr,Mr)}reset(){this.uchar=" ",this.penState.reset()}setChar(Tr,Ar){this.uchar=Tr,this.penState.copy(Ar)}setPenState(Tr){this.penState.copy(Tr)}equals(Tr){return this.uchar===Tr.uchar&&this.penState.equals(Tr.penState)}copy(Tr){this.uchar=Tr.uchar,this.penState.copy(Tr.penState)}isEmpty(){return this.uchar===" "&&this.penState.isDefault()}}class Row{constructor(Tr){this.chars=void 0,this.pos=void 0,this.currPenState=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chars=[];for(let Ar=0;Ar<NR_COLS;Ar++)this.chars.push(new StyledUnicodeChar);this.logger=Tr,this.pos=0,this.currPenState=new PenState}equals(Tr){let Ar=!0;for(let Rr=0;Rr<NR_COLS;Rr++)if(!this.chars[Rr].equals(Tr.chars[Rr])){Ar=!1;break}return Ar}copy(Tr){for(let Ar=0;Ar<NR_COLS;Ar++)this.chars[Ar].copy(Tr.chars[Ar])}isEmpty(){let Tr=!0;for(let Ar=0;Ar<NR_COLS;Ar++)if(!this.chars[Ar].isEmpty()){Tr=!1;break}return Tr}setCursor(Tr){this.pos!==Tr&&(this.pos=Tr),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>NR_COLS&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=NR_COLS)}moveCursor(Tr){const Ar=this.pos+Tr;if(Tr>1)for(let Rr=this.pos+1;Rr<Ar+1;Rr++)this.chars[Rr].setPenState(this.currPenState);this.setCursor(Ar)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(Tr){Tr>=144&&this.backSpace();const Ar=getCharForByte(Tr);if(this.pos>=NR_COLS){this.logger.log(0,()=>"Cannot insert "+Tr.toString(16)+" ("+Ar+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(Ar,this.currPenState),this.moveCursor(1)}clearFromPos(Tr){let Ar;for(Ar=Tr;Ar<NR_COLS;Ar++)this.chars[Ar].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){const Tr=[];let Ar=!0;for(let Rr=0;Rr<NR_COLS;Rr++){const Pr=this.chars[Rr].uchar;Pr!==" "&&(Ar=!1),Tr.push(Pr)}return Ar?"":Tr.join("")}setPenStyles(Tr){this.currPenState.setStyles(Tr),this.chars[this.pos].setPenState(this.currPenState)}}class CaptionScreen{constructor(Tr){this.rows=void 0,this.currRow=void 0,this.nrRollUpRows=void 0,this.lastOutputScreen=void 0,this.logger=void 0,this.rows=[];for(let Ar=0;Ar<NR_ROWS;Ar++)this.rows.push(new Row(Tr));this.logger=Tr,this.currRow=NR_ROWS-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.reset()}reset(){for(let Tr=0;Tr<NR_ROWS;Tr++)this.rows[Tr].clear();this.currRow=NR_ROWS-1}equals(Tr){let Ar=!0;for(let Rr=0;Rr<NR_ROWS;Rr++)if(!this.rows[Rr].equals(Tr.rows[Rr])){Ar=!1;break}return Ar}copy(Tr){for(let Ar=0;Ar<NR_ROWS;Ar++)this.rows[Ar].copy(Tr.rows[Ar])}isEmpty(){let Tr=!0;for(let Ar=0;Ar<NR_ROWS;Ar++)if(!this.rows[Ar].isEmpty()){Tr=!1;break}return Tr}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(Tr){this.rows[this.currRow].insertChar(Tr)}setPen(Tr){this.rows[this.currRow].setPenStyles(Tr)}moveCursor(Tr){this.rows[this.currRow].moveCursor(Tr)}setCursor(Tr){this.logger.log(2,"setCursor: "+Tr),this.rows[this.currRow].setCursor(Tr)}setPAC(Tr){this.logger.log(2,()=>"pacData = "+JSON.stringify(Tr));let Ar=Tr.row-1;if(this.nrRollUpRows&&Ar<this.nrRollUpRows-1&&(Ar=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==Ar){for(let Fr=0;Fr<NR_ROWS;Fr++)this.rows[Fr].clear();const Dr=this.currRow+1-this.nrRollUpRows,Mr=this.lastOutputScreen;if(Mr){const Fr=Mr.rows[Dr].cueStartTime,zr=this.logger.time;if(Fr&&zr!==null&&Fr<zr)for(let jr=0;jr<this.nrRollUpRows;jr++)this.rows[Ar-this.nrRollUpRows+jr+1].copy(Mr.rows[Dr+jr])}}this.currRow=Ar;const Rr=this.rows[this.currRow];if(Tr.indent!==null){const Dr=Tr.indent,Mr=Math.max(Dr-1,0);Rr.setCursor(Tr.indent),Tr.color=Rr.chars[Mr].penState.foreground}const Pr={foreground:Tr.color,underline:Tr.underline,italics:Tr.italics,background:"black",flash:!1};this.setPen(Pr)}setBkgData(Tr){this.logger.log(2,()=>"bkgData = "+JSON.stringify(Tr)),this.backSpace(),this.setPen(Tr),this.insertChar(32)}setRollUpRows(Tr){this.nrRollUpRows=Tr}rollUp(){if(this.nrRollUpRows===null){this.logger.log(3,"roll_up but nrRollUpRows not set yet");return}this.logger.log(1,()=>this.getDisplayText());const Tr=this.currRow+1-this.nrRollUpRows,Ar=this.rows.splice(Tr,1)[0];Ar.clear(),this.rows.splice(this.currRow,0,Ar),this.logger.log(2,"Rolling up")}getDisplayText(Tr){Tr=Tr||!1;const Ar=[];let Rr="",Pr=-1;for(let Dr=0;Dr<NR_ROWS;Dr++){const Mr=this.rows[Dr].getTextString();Mr&&(Pr=Dr+1,Tr?Ar.push("Row "+Pr+": '"+Mr+"'"):Ar.push(Mr.trim()))}return Ar.length>0&&(Tr?Rr="["+Ar.join(" | ")+"]":Rr=Ar.join(`
`)),Rr}getTextAndFormat(){return this.rows}}class Cea608Channel{constructor(Tr,Ar,Rr){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=Tr,this.outputFilter=Ar,this.mode=null,this.verbose=0,this.displayedMemory=new CaptionScreen(Rr),this.nonDisplayedMemory=new CaptionScreen(Rr),this.lastOutputScreen=new CaptionScreen(Rr),this.currRollUpRow=this.displayedMemory.rows[NR_ROWS-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=Rr}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[NR_ROWS-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(Tr){this.outputFilter=Tr}setPAC(Tr){this.writeScreen.setPAC(Tr)}setBkgData(Tr){this.writeScreen.setBkgData(Tr)}setMode(Tr){Tr!==this.mode&&(this.mode=Tr,this.logger.log(2,()=>"MODE="+Tr),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=Tr)}insertChars(Tr){for(let Rr=0;Rr<Tr.length;Rr++)this.writeScreen.insertChar(Tr[Rr]);const Ar=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,()=>Ar+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(1,()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(Tr){this.logger.log(2,"RU("+Tr+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(Tr)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){const Tr=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=Tr,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,()=>"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)}ccTO(Tr){this.logger.log(2,"TO("+Tr+") - Tab Offset"),this.writeScreen.moveCursor(Tr)}ccMIDROW(Tr){const Ar={flash:!1};if(Ar.underline=Tr%2===1,Ar.italics=Tr>=46,Ar.italics)Ar.foreground="white";else{const Rr=Math.floor(Tr/2)-16,Pr=["white","green","blue","cyan","red","yellow","magenta"];Ar.foreground=Pr[Rr]}this.logger.log(2,"MIDROW: "+JSON.stringify(Ar)),this.writeScreen.setPen(Ar)}outputDataUpdate(Tr=!1){const Ar=this.logger.time;Ar!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=Ar:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,Ar,this.lastOutputScreen),Tr&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:Ar),this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(Tr){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,Tr,this.displayedMemory),this.cueStartTime=Tr))}}class Cea608Parser{constructor(Tr,Ar,Rr){this.channels=void 0,this.currentChannel=0,this.cmdHistory=void 0,this.logger=void 0;const Pr=new CaptionsLogger;this.channels=[null,new Cea608Channel(Tr,Ar,Pr),new Cea608Channel(Tr+1,Rr,Pr)],this.cmdHistory=createCmdHistory(),this.logger=Pr}getHandler(Tr){return this.channels[Tr].getHandler()}setHandler(Tr,Ar){this.channels[Tr].setHandler(Ar)}addData(Tr,Ar){let Rr,Pr,Dr,Mr=!1;this.logger.time=Tr;for(let Fr=0;Fr<Ar.length;Fr+=2)if(Pr=Ar[Fr]&127,Dr=Ar[Fr+1]&127,!(Pr===0&&Dr===0)){if(this.logger.log(3,"["+numArrayToHexArray([Ar[Fr],Ar[Fr+1]])+"] -> ("+numArrayToHexArray([Pr,Dr])+")"),Rr=this.parseCmd(Pr,Dr),Rr||(Rr=this.parseMidrow(Pr,Dr)),Rr||(Rr=this.parsePAC(Pr,Dr)),Rr||(Rr=this.parseBackgroundAttributes(Pr,Dr)),!Rr&&(Mr=this.parseChars(Pr,Dr),Mr)){const zr=this.currentChannel;zr&&zr>0?this.channels[zr].insertChars(Mr):this.logger.log(2,"No channel found yet. TEXT-MODE?")}!Rr&&!Mr&&this.logger.log(2,"Couldn't parse cleaned data "+numArrayToHexArray([Pr,Dr])+" orig: "+numArrayToHexArray([Ar[Fr],Ar[Fr+1]]))}}parseCmd(Tr,Ar){const{cmdHistory:Rr}=this,Pr=(Tr===20||Tr===28||Tr===21||Tr===29)&&Ar>=32&&Ar<=47,Dr=(Tr===23||Tr===31)&&Ar>=33&&Ar<=35;if(!(Pr||Dr))return!1;if(hasCmdRepeated(Tr,Ar,Rr))return setLastCmd(null,null,Rr),this.logger.log(3,"Repeated command ("+numArrayToHexArray([Tr,Ar])+") is dropped"),!0;const Mr=Tr===20||Tr===21||Tr===23?1:2,Fr=this.channels[Mr];return Tr===20||Tr===21||Tr===28||Tr===29?Ar===32?Fr.ccRCL():Ar===33?Fr.ccBS():Ar===34?Fr.ccAOF():Ar===35?Fr.ccAON():Ar===36?Fr.ccDER():Ar===37?Fr.ccRU(2):Ar===38?Fr.ccRU(3):Ar===39?Fr.ccRU(4):Ar===40?Fr.ccFON():Ar===41?Fr.ccRDC():Ar===42?Fr.ccTR():Ar===43?Fr.ccRTD():Ar===44?Fr.ccEDM():Ar===45?Fr.ccCR():Ar===46?Fr.ccENM():Ar===47&&Fr.ccEOC():Fr.ccTO(Ar-32),setLastCmd(Tr,Ar,Rr),this.currentChannel=Mr,!0}parseMidrow(Tr,Ar){let Rr=0;if((Tr===17||Tr===25)&&Ar>=32&&Ar<=47){if(Tr===17?Rr=1:Rr=2,Rr!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;const Pr=this.channels[Rr];return Pr?(Pr.ccMIDROW(Ar),this.logger.log(3,"MIDROW ("+numArrayToHexArray([Tr,Ar])+")"),!0):!1}return!1}parsePAC(Tr,Ar){let Rr;const Pr=this.cmdHistory,Dr=(Tr>=17&&Tr<=23||Tr>=25&&Tr<=31)&&Ar>=64&&Ar<=127,Mr=(Tr===16||Tr===24)&&Ar>=64&&Ar<=95;if(!(Dr||Mr))return!1;if(hasCmdRepeated(Tr,Ar,Pr))return setLastCmd(null,null,Pr),!0;const Fr=Tr<=23?1:2;Ar>=64&&Ar<=95?Rr=Fr===1?rowsLowCh1[Tr]:rowsLowCh2[Tr]:Rr=Fr===1?rowsHighCh1[Tr]:rowsHighCh2[Tr];const zr=this.channels[Fr];return zr?(zr.setPAC(this.interpretPAC(Rr,Ar)),setLastCmd(Tr,Ar,Pr),this.currentChannel=Fr,!0):!1}interpretPAC(Tr,Ar){let Rr;const Pr={color:null,italics:!1,indent:null,underline:!1,row:Tr};return Ar>95?Rr=Ar-96:Rr=Ar-64,Pr.underline=(Rr&1)===1,Rr<=13?Pr.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(Rr/2)]:Rr<=15?(Pr.italics=!0,Pr.color="white"):Pr.indent=Math.floor((Rr-16)/2)*4,Pr}parseChars(Tr,Ar){let Rr,Pr=null,Dr=null;if(Tr>=25?(Rr=2,Dr=Tr-8):(Rr=1,Dr=Tr),Dr>=17&&Dr<=19){let Mr;Dr===17?Mr=Ar+80:Dr===18?Mr=Ar+112:Mr=Ar+144,this.logger.log(2,"Special char '"+getCharForByte(Mr)+"' in channel "+Rr),Pr=[Mr]}else Tr>=32&&Tr<=127&&(Pr=Ar===0?[Tr]:[Tr,Ar]);if(Pr){const Mr=numArrayToHexArray(Pr);this.logger.log(3,"Char codes =  "+Mr.join(",")),setLastCmd(Tr,Ar,this.cmdHistory)}return Pr}parseBackgroundAttributes(Tr,Ar){const Rr=(Tr===16||Tr===24)&&Ar>=32&&Ar<=47,Pr=(Tr===23||Tr===31)&&Ar>=45&&Ar<=47;if(!(Rr||Pr))return!1;let Dr;const Mr={};Tr===16||Tr===24?(Dr=Math.floor((Ar-32)/2),Mr.background=backgroundColors[Dr],Ar%2===1&&(Mr.background=Mr.background+"_semi")):Ar===45?Mr.background="transparent":(Mr.foreground="black",Ar===47&&(Mr.underline=!0));const Fr=Tr<=23?1:2;return this.channels[Fr].setBkgData(Mr),setLastCmd(Tr,Ar,this.cmdHistory),!0}reset(){for(let Tr=0;Tr<Object.keys(this.channels).length;Tr++){const Ar=this.channels[Tr];Ar&&Ar.reset()}this.cmdHistory=createCmdHistory()}cueSplitAtTime(Tr){for(let Ar=0;Ar<this.channels.length;Ar++){const Rr=this.channels[Ar];Rr&&Rr.cueSplitAtTime(Tr)}}}function setLastCmd(_r,Tr,Ar){Ar.a=_r,Ar.b=Tr}function hasCmdRepeated(_r,Tr,Ar){return Ar.a===_r&&Ar.b===Tr}function createCmdHistory(){return{a:null,b:null}}class OutputFilter{constructor(Tr,Ar){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=Tr,this.trackName=Ar}dispatchCue(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(Tr,Ar,Rr){(this.startTime===null||this.startTime>Tr)&&(this.startTime=Tr),this.endTime=Ar,this.screen=Rr,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}var VTTCue=function(){if(typeof self<"u"&&self.VTTCue)return self.VTTCue;const _r=["","lr","rl"],Tr=["start","middle","end","left","right"];function Ar(Fr,zr){if(typeof zr!="string"||!Array.isArray(Fr))return!1;const jr=zr.toLowerCase();return~Fr.indexOf(jr)?jr:!1}function Rr(Fr){return Ar(_r,Fr)}function Pr(Fr){return Ar(Tr,Fr)}function Dr(Fr,...zr){let jr=1;for(;jr<arguments.length;jr++){const Gr=arguments[jr];for(const Nr in Gr)Fr[Nr]=Gr[Nr]}return Fr}function Mr(Fr,zr,jr){const Gr=this,Nr={enumerable:!0};Gr.hasBeenReset=!1;let Lr="",Ur=!1,Vr=Fr,Wr=zr,qr=jr,Kr=null,Xr="",Zr=!0,_i="auto",Jr="start",es=50,ts="middle",is=50,rs="middle";Object.defineProperty(Gr,"id",Dr({},Nr,{get:function(){return Lr},set:function(as){Lr=""+as}})),Object.defineProperty(Gr,"pauseOnExit",Dr({},Nr,{get:function(){return Ur},set:function(as){Ur=!!as}})),Object.defineProperty(Gr,"startTime",Dr({},Nr,{get:function(){return Vr},set:function(as){if(typeof as!="number")throw new TypeError("Start time must be set to a number.");Vr=as,this.hasBeenReset=!0}})),Object.defineProperty(Gr,"endTime",Dr({},Nr,{get:function(){return Wr},set:function(as){if(typeof as!="number")throw new TypeError("End time must be set to a number.");Wr=as,this.hasBeenReset=!0}})),Object.defineProperty(Gr,"text",Dr({},Nr,{get:function(){return qr},set:function(as){qr=""+as,this.hasBeenReset=!0}})),Object.defineProperty(Gr,"region",Dr({},Nr,{get:function(){return Kr},set:function(as){Kr=as,this.hasBeenReset=!0}})),Object.defineProperty(Gr,"vertical",Dr({},Nr,{get:function(){return Xr},set:function(as){const ls=Rr(as);if(ls===!1)throw new SyntaxError("An invalid or illegal string was specified.");Xr=ls,this.hasBeenReset=!0}})),Object.defineProperty(Gr,"snapToLines",Dr({},Nr,{get:function(){return Zr},set:function(as){Zr=!!as,this.hasBeenReset=!0}})),Object.defineProperty(Gr,"line",Dr({},Nr,{get:function(){return _i},set:function(as){if(typeof as!="number"&&as!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");_i=as,this.hasBeenReset=!0}})),Object.defineProperty(Gr,"lineAlign",Dr({},Nr,{get:function(){return Jr},set:function(as){const ls=Pr(as);if(!ls)throw new SyntaxError("An invalid or illegal string was specified.");Jr=ls,this.hasBeenReset=!0}})),Object.defineProperty(Gr,"position",Dr({},Nr,{get:function(){return es},set:function(as){if(as<0||as>100)throw new Error("Position must be between 0 and 100.");es=as,this.hasBeenReset=!0}})),Object.defineProperty(Gr,"positionAlign",Dr({},Nr,{get:function(){return ts},set:function(as){const ls=Pr(as);if(!ls)throw new SyntaxError("An invalid or illegal string was specified.");ts=ls,this.hasBeenReset=!0}})),Object.defineProperty(Gr,"size",Dr({},Nr,{get:function(){return is},set:function(as){if(as<0||as>100)throw new Error("Size must be between 0 and 100.");is=as,this.hasBeenReset=!0}})),Object.defineProperty(Gr,"align",Dr({},Nr,{get:function(){return rs},set:function(as){const ls=Pr(as);if(!ls)throw new SyntaxError("An invalid or illegal string was specified.");rs=ls,this.hasBeenReset=!0}})),Gr.displayState=void 0}return Mr.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},Mr}();class StringDecoder{decode(Tr,Ar){if(!Tr)return"";if(typeof Tr!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(Tr))}}function parseTimeStamp(_r){function Tr(Rr,Pr,Dr,Mr){return(Rr|0)*3600+(Pr|0)*60+(Dr|0)+parseFloat(Mr||0)}const Ar=_r.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return Ar?parseFloat(Ar[2])>59?Tr(Ar[2],Ar[3],0,Ar[4]):Tr(Ar[1],Ar[2],Ar[3],Ar[4]):null}class Settings{constructor(){this.values=Object.create(null)}set(Tr,Ar){!this.get(Tr)&&Ar!==""&&(this.values[Tr]=Ar)}get(Tr,Ar,Rr){return Rr?this.has(Tr)?this.values[Tr]:Ar[Rr]:this.has(Tr)?this.values[Tr]:Ar}has(Tr){return Tr in this.values}alt(Tr,Ar,Rr){for(let Pr=0;Pr<Rr.length;++Pr)if(Ar===Rr[Pr]){this.set(Tr,Ar);break}}integer(Tr,Ar){/^-?\d+$/.test(Ar)&&this.set(Tr,parseInt(Ar,10))}percent(Tr,Ar){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(Ar)){const Rr=parseFloat(Ar);if(Rr>=0&&Rr<=100)return this.set(Tr,Rr),!0}return!1}}function parseOptions(_r,Tr,Ar,Rr){const Pr=Rr?_r.split(Rr):[_r];for(const Dr in Pr){if(typeof Pr[Dr]!="string")continue;const Mr=Pr[Dr].split(Ar);if(Mr.length!==2)continue;const Fr=Mr[0],zr=Mr[1];Tr(Fr,zr)}}const defaults=new VTTCue(0,0,""),center=defaults.align==="middle"?"middle":"center";function parseCue$1(_r,Tr,Ar){const Rr=_r;function Pr(){const Fr=parseTimeStamp(_r);if(Fr===null)throw new Error("Malformed timestamp: "+Rr);return _r=_r.replace(/^[^\sa-zA-Z-]+/,""),Fr}function Dr(Fr,zr){const jr=new Settings;parseOptions(Fr,function(Lr,Ur){let Vr;switch(Lr){case"region":for(let Wr=Ar.length-1;Wr>=0;Wr--)if(Ar[Wr].id===Ur){jr.set(Lr,Ar[Wr].region);break}break;case"vertical":jr.alt(Lr,Ur,["rl","lr"]);break;case"line":Vr=Ur.split(","),jr.integer(Lr,Vr[0]),jr.percent(Lr,Vr[0])&&jr.set("snapToLines",!1),jr.alt(Lr,Vr[0],["auto"]),Vr.length===2&&jr.alt("lineAlign",Vr[1],["start",center,"end"]);break;case"position":Vr=Ur.split(","),jr.percent(Lr,Vr[0]),Vr.length===2&&jr.alt("positionAlign",Vr[1],["start",center,"end","line-left","line-right","auto"]);break;case"size":jr.percent(Lr,Ur);break;case"align":jr.alt(Lr,Ur,["start",center,"end","left","right"]);break}},/:/,/\s/),zr.region=jr.get("region",null),zr.vertical=jr.get("vertical","");let Gr=jr.get("line","auto");Gr==="auto"&&defaults.line===-1&&(Gr=-1),zr.line=Gr,zr.lineAlign=jr.get("lineAlign","start"),zr.snapToLines=jr.get("snapToLines",!0),zr.size=jr.get("size",100),zr.align=jr.get("align",center);let Nr=jr.get("position","auto");Nr==="auto"&&defaults.position===50&&(Nr=zr.align==="start"||zr.align==="left"?0:zr.align==="end"||zr.align==="right"?100:50),zr.position=Nr}function Mr(){_r=_r.replace(/^\s+/,"")}if(Mr(),Tr.startTime=Pr(),Mr(),_r.slice(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+Rr);_r=_r.slice(3),Mr(),Tr.endTime=Pr(),Mr(),Dr(_r,Tr)}function fixLineBreaks(_r){return _r.replace(/<br(?: \/)?>/gi,`
`)}class VTTParser{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new StringDecoder,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(Tr){const Ar=this;Tr&&(Ar.buffer+=Ar.decoder.decode(Tr,{stream:!0}));function Rr(){let Dr=Ar.buffer,Mr=0;for(Dr=fixLineBreaks(Dr);Mr<Dr.length&&Dr[Mr]!=="\r"&&Dr[Mr]!==`
`;)++Mr;const Fr=Dr.slice(0,Mr);return Dr[Mr]==="\r"&&++Mr,Dr[Mr]===`
`&&++Mr,Ar.buffer=Dr.slice(Mr),Fr}function Pr(Dr){parseOptions(Dr,function(Mr,Fr){},/:/)}try{let Dr="";if(Ar.state==="INITIAL"){if(!/\r\n|\n/.test(Ar.buffer))return this;Dr=Rr();const Fr=Dr.match(/^()?WEBVTT([ \t].*)?$/);if(!(Fr!=null&&Fr[0]))throw new Error("Malformed WebVTT signature.");Ar.state="HEADER"}let Mr=!1;for(;Ar.buffer;){if(!/\r\n|\n/.test(Ar.buffer))return this;switch(Mr?Mr=!1:Dr=Rr(),Ar.state){case"HEADER":/:/.test(Dr)?Pr(Dr):Dr||(Ar.state="ID");continue;case"NOTE":Dr||(Ar.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(Dr)){Ar.state="NOTE";break}if(!Dr)continue;if(Ar.cue=new VTTCue(0,0,""),Ar.state="CUE",Dr.indexOf("-->")===-1){Ar.cue.id=Dr;continue}case"CUE":if(!Ar.cue){Ar.state="BADCUE";continue}try{parseCue$1(Dr,Ar.cue,Ar.regionList)}catch{Ar.cue=null,Ar.state="BADCUE";continue}Ar.state="CUETEXT";continue;case"CUETEXT":{const Fr=Dr.indexOf("-->")!==-1;if(!Dr||Fr&&(Mr=!0)){Ar.oncue&&Ar.cue&&Ar.oncue(Ar.cue),Ar.cue=null,Ar.state="ID";continue}if(Ar.cue===null)continue;Ar.cue.text&&(Ar.cue.text+=`
`),Ar.cue.text+=Dr}continue;case"BADCUE":Dr||(Ar.state="ID")}}}catch{Ar.state==="CUETEXT"&&Ar.cue&&Ar.oncue&&Ar.oncue(Ar.cue),Ar.cue=null,Ar.state=Ar.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this}flush(){const Tr=this;try{if((Tr.cue||Tr.state==="HEADER")&&(Tr.buffer+=`

`,Tr.parse()),Tr.state==="INITIAL"||Tr.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(Ar){Tr.onparsingerror&&Tr.onparsingerror(Ar)}return Tr.onflush&&Tr.onflush(),this}}const LINEBREAKS=/\r\n|\n\r|\n|\r/g,startsWith=function(Tr,Ar,Rr=0){return Tr.slice(Rr,Rr+Ar.length)===Ar},cueString2millis=function(Tr){let Ar=parseInt(Tr.slice(-3));const Rr=parseInt(Tr.slice(-6,-4)),Pr=parseInt(Tr.slice(-9,-7)),Dr=Tr.length>9?parseInt(Tr.substring(0,Tr.indexOf(":"))):0;if(!isFiniteNumber(Ar)||!isFiniteNumber(Rr)||!isFiniteNumber(Pr)||!isFiniteNumber(Dr))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${Tr}`);return Ar+=1e3*Rr,Ar+=60*1e3*Pr,Ar+=60*60*1e3*Dr,Ar},hash=function(Tr){let Ar=5381,Rr=Tr.length;for(;Rr;)Ar=Ar*33^Tr.charCodeAt(--Rr);return(Ar>>>0).toString()};function generateCueId(_r,Tr,Ar){return hash(_r.toString())+hash(Tr.toString())+hash(Ar)}const calculateOffset=function(Tr,Ar,Rr){let Pr=Tr[Ar],Dr=Tr[Pr.prevCC];if(!Dr||!Dr.new&&Pr.new){Tr.ccOffset=Tr.presentationOffset=Pr.start,Pr.new=!1;return}for(;(Mr=Dr)!=null&&Mr.new;){var Mr;Tr.ccOffset+=Pr.start-Dr.start,Pr.new=!1,Pr=Dr,Dr=Tr[Pr.prevCC]}Tr.presentationOffset=Rr};function parseWebVTT(_r,Tr,Ar,Rr,Pr,Dr,Mr){const Fr=new VTTParser,zr=utf8ArrayToStr(new Uint8Array(_r)).trim().replace(LINEBREAKS,`
`).split(`
`),jr=[],Gr=Tr?toMpegTsClockFromTimescale(Tr.baseTime,Tr.timescale):0;let Nr="00:00.000",Lr=0,Ur=0,Vr,Wr=!0;Fr.oncue=function(qr){const Kr=Ar[Rr];let Xr=Ar.ccOffset;const Zr=(Lr-Gr)/9e4;if(Kr!=null&&Kr.new&&(Ur!==void 0?Xr=Ar.ccOffset=Kr.start:calculateOffset(Ar,Rr,Zr)),Zr){if(!Tr){Vr=new Error("Missing initPTS for VTT MPEGTS");return}Xr=Zr-Ar.presentationOffset}const _i=qr.endTime-qr.startTime,Jr=normalizePts((qr.startTime+Xr-Ur)*9e4,Pr*9e4)/9e4;qr.startTime=Math.max(Jr,0),qr.endTime=Math.max(Jr+_i,0);const es=qr.text.trim();qr.text=decodeURIComponent(encodeURIComponent(es)),qr.id||(qr.id=generateCueId(qr.startTime,qr.endTime,es)),qr.endTime>0&&jr.push(qr)},Fr.onparsingerror=function(qr){Vr=qr},Fr.onflush=function(){if(Vr){Mr(Vr);return}Dr(jr)},zr.forEach(qr=>{if(Wr)if(startsWith(qr,"X-TIMESTAMP-MAP=")){Wr=!1,qr.slice(16).split(",").forEach(Kr=>{startsWith(Kr,"LOCAL:")?Nr=Kr.slice(6):startsWith(Kr,"MPEGTS:")&&(Lr=parseInt(Kr.slice(7)))});try{Ur=cueString2millis(Nr)/1e3}catch(Kr){Vr=Kr}return}else qr===""&&(Wr=!1);Fr.parse(qr+`
`)}),Fr.flush()}const IMSC1_CODEC="stpp.ttml.im1t",HMSF_REGEX=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,TIME_UNIT_REGEX=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,textAlignToLineAlign={left:"start",center:"center",right:"end",start:"start",end:"end"};function parseIMSC1(_r,Tr,Ar,Rr){const Pr=findBox(new Uint8Array(_r),["mdat"]);if(Pr.length===0){Rr(new Error("Could not parse IMSC1 mdat"));return}const Dr=Pr.map(Fr=>utf8ArrayToStr(Fr)),Mr=toTimescaleFromScale(Tr.baseTime,1,Tr.timescale);try{Dr.forEach(Fr=>Ar(parseTTML(Fr,Mr)))}catch(Fr){Rr(Fr)}}function parseTTML(_r,Tr){const Pr=new DOMParser().parseFromString(_r,"text/xml").getElementsByTagName("tt")[0];if(!Pr)throw new Error("Invalid ttml");const Dr={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},Mr=Object.keys(Dr).reduce((Nr,Lr)=>(Nr[Lr]=Pr.getAttribute(`ttp:${Lr}`)||Dr[Lr],Nr),{}),Fr=Pr.getAttribute("xml:space")!=="preserve",zr=collectionToDictionary(getElementCollection(Pr,"styling","style")),jr=collectionToDictionary(getElementCollection(Pr,"layout","region")),Gr=getElementCollection(Pr,"body","[begin]");return[].map.call(Gr,Nr=>{const Lr=getTextContent(Nr,Fr);if(!Lr||!Nr.hasAttribute("begin"))return null;const Ur=parseTtmlTime(Nr.getAttribute("begin"),Mr),Vr=parseTtmlTime(Nr.getAttribute("dur"),Mr);let Wr=parseTtmlTime(Nr.getAttribute("end"),Mr);if(Ur===null)throw timestampParsingError(Nr);if(Wr===null){if(Vr===null)throw timestampParsingError(Nr);Wr=Ur+Vr}const qr=new VTTCue(Ur-Tr,Wr-Tr,Lr);qr.id=generateCueId(qr.startTime,qr.endTime,qr.text);const Kr=jr[Nr.getAttribute("region")],Xr=zr[Nr.getAttribute("style")],Zr=getTtmlStyles(Kr,Xr,zr),{textAlign:_i}=Zr;if(_i){const Jr=textAlignToLineAlign[_i];Jr&&(qr.lineAlign=Jr),qr.align=_i}return _extends(qr,Zr),qr}).filter(Nr=>Nr!==null)}function getElementCollection(_r,Tr,Ar){const Rr=_r.getElementsByTagName(Tr)[0];return Rr?[].slice.call(Rr.querySelectorAll(Ar)):[]}function collectionToDictionary(_r){return _r.reduce((Tr,Ar)=>{const Rr=Ar.getAttribute("xml:id");return Rr&&(Tr[Rr]=Ar),Tr},{})}function getTextContent(_r,Tr){return[].slice.call(_r.childNodes).reduce((Ar,Rr,Pr)=>{var Dr;return Rr.nodeName==="br"&&Pr?Ar+`
`:(Dr=Rr.childNodes)!=null&&Dr.length?getTextContent(Rr,Tr):Tr?Ar+Rr.textContent.trim().replace(/\s+/g," "):Ar+Rr.textContent},"")}function getTtmlStyles(_r,Tr,Ar){const Rr="http://www.w3.org/ns/ttml#styling";let Pr=null;const Dr=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],Mr=_r!=null&&_r.hasAttribute("style")?_r.getAttribute("style"):null;return Mr&&Ar.hasOwnProperty(Mr)&&(Pr=Ar[Mr]),Dr.reduce((Fr,zr)=>{const jr=getAttributeNS(Tr,Rr,zr)||getAttributeNS(_r,Rr,zr)||getAttributeNS(Pr,Rr,zr);return jr&&(Fr[zr]=jr),Fr},{})}function getAttributeNS(_r,Tr,Ar){return _r&&_r.hasAttributeNS(Tr,Ar)?_r.getAttributeNS(Tr,Ar):null}function timestampParsingError(_r){return new Error(`Could not parse ttml timestamp ${_r}`)}function parseTtmlTime(_r,Tr){if(!_r)return null;let Ar=parseTimeStamp(_r);return Ar===null&&(HMSF_REGEX.test(_r)?Ar=parseHoursMinutesSecondsFrames(_r,Tr):TIME_UNIT_REGEX.test(_r)&&(Ar=parseTimeUnits(_r,Tr))),Ar}function parseHoursMinutesSecondsFrames(_r,Tr){const Ar=HMSF_REGEX.exec(_r),Rr=(Ar[4]|0)+(Ar[5]|0)/Tr.subFrameRate;return(Ar[1]|0)*3600+(Ar[2]|0)*60+(Ar[3]|0)+Rr/Tr.frameRate}function parseTimeUnits(_r,Tr){const Ar=TIME_UNIT_REGEX.exec(_r),Rr=Number(Ar[1]);switch(Ar[2]){case"h":return Rr*3600;case"m":return Rr*60;case"ms":return Rr*1e3;case"f":return Rr/Tr.frameRate;case"t":return Rr/Tr.tickRate}return Rr}class TimelineController{constructor(Tr){if(this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=newVTTCCs(),this.captionsProperties=void 0,this.hls=Tr,this.config=Tr.config,this.Cues=Tr.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},this.config.enableCEA708Captions){const Ar=new OutputFilter(this,"textTrack1"),Rr=new OutputFilter(this,"textTrack2"),Pr=new OutputFilter(this,"textTrack3"),Dr=new OutputFilter(this,"textTrack4");this.cea608Parser1=new Cea608Parser(1,Ar,Rr),this.cea608Parser2=new Cea608Parser(3,Pr,Dr)}Tr.on(Events.MEDIA_ATTACHING,this.onMediaAttaching,this),Tr.on(Events.MEDIA_DETACHING,this.onMediaDetaching,this),Tr.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),Tr.on(Events.MANIFEST_LOADED,this.onManifestLoaded,this),Tr.on(Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),Tr.on(Events.FRAG_LOADING,this.onFragLoading,this),Tr.on(Events.FRAG_LOADED,this.onFragLoaded,this),Tr.on(Events.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),Tr.on(Events.FRAG_DECRYPTED,this.onFragDecrypted,this),Tr.on(Events.INIT_PTS_FOUND,this.onInitPtsFound,this),Tr.on(Events.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),Tr.on(Events.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){const{hls:Tr}=this;Tr.off(Events.MEDIA_ATTACHING,this.onMediaAttaching,this),Tr.off(Events.MEDIA_DETACHING,this.onMediaDetaching,this),Tr.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),Tr.off(Events.MANIFEST_LOADED,this.onManifestLoaded,this),Tr.off(Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),Tr.off(Events.FRAG_LOADING,this.onFragLoading,this),Tr.off(Events.FRAG_LOADED,this.onFragLoaded,this),Tr.off(Events.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),Tr.off(Events.FRAG_DECRYPTED,this.onFragDecrypted,this),Tr.off(Events.INIT_PTS_FOUND,this.onInitPtsFound,this),Tr.off(Events.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),Tr.off(Events.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.cea608Parser1=this.cea608Parser2=null}addCues(Tr,Ar,Rr,Pr,Dr){let Mr=!1;for(let Fr=Dr.length;Fr--;){const zr=Dr[Fr],jr=intersection(zr[0],zr[1],Ar,Rr);if(jr>=0&&(zr[0]=Math.min(zr[0],Ar),zr[1]=Math.max(zr[1],Rr),Mr=!0,jr/(Rr-Ar)>.5))return}if(Mr||Dr.push([Ar,Rr]),this.config.renderTextTracksNatively){const Fr=this.captionsTracks[Tr];this.Cues.newCue(Fr,Ar,Rr,Pr)}else{const Fr=this.Cues.newCue(null,Ar,Rr,Pr);this.hls.trigger(Events.CUES_PARSED,{type:"captions",cues:Fr,track:Tr})}}onInitPtsFound(Tr,{frag:Ar,id:Rr,initPTS:Pr,timescale:Dr}){const{unparsedVttFrags:Mr}=this;Rr==="main"&&(this.initPTS[Ar.cc]={baseTime:Pr,timescale:Dr}),Mr.length&&(this.unparsedVttFrags=[],Mr.forEach(Fr=>{this.onFragLoaded(Events.FRAG_LOADED,Fr)}))}getExistingTrack(Tr){const{media:Ar}=this;if(Ar)for(let Rr=0;Rr<Ar.textTracks.length;Rr++){const Pr=Ar.textTracks[Rr];if(Pr[Tr])return Pr}return null}createCaptionsTrack(Tr){this.config.renderTextTracksNatively?this.createNativeTrack(Tr):this.createNonNativeTrack(Tr)}createNativeTrack(Tr){if(this.captionsTracks[Tr])return;const{captionsProperties:Ar,captionsTracks:Rr,media:Pr}=this,{label:Dr,languageCode:Mr}=Ar[Tr],Fr=this.getExistingTrack(Tr);if(Fr)Rr[Tr]=Fr,clearCurrentCues(Rr[Tr]),sendAddTrackEvent(Rr[Tr],Pr);else{const zr=this.createTextTrack("captions",Dr,Mr);zr&&(zr[Tr]=!0,Rr[Tr]=zr)}}createNonNativeTrack(Tr){if(this.nonNativeCaptionsTracks[Tr])return;const Ar=this.captionsProperties[Tr];if(!Ar)return;const Rr=Ar.label,Pr={_id:Tr,label:Rr,kind:"captions",default:Ar.media?!!Ar.media.default:!1,closedCaptions:Ar.media};this.nonNativeCaptionsTracks[Tr]=Pr,this.hls.trigger(Events.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[Pr]})}createTextTrack(Tr,Ar,Rr){const Pr=this.media;if(Pr)return Pr.addTextTrack(Tr,Ar,Rr)}onMediaAttaching(Tr,Ar){this.media=Ar.media,this._cleanTracks()}onMediaDetaching(){const{captionsTracks:Tr}=this;Object.keys(Tr).forEach(Ar=>{clearCurrentCues(Tr[Ar]),delete Tr[Ar]}),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=newVTTCCs(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){const{media:Tr}=this;if(!Tr)return;const Ar=Tr.textTracks;if(Ar)for(let Rr=0;Rr<Ar.length;Rr++)clearCurrentCues(Ar[Rr])}onSubtitleTracksUpdated(Tr,Ar){const Rr=Ar.subtitleTracks||[],Pr=Rr.some(Dr=>Dr.textCodec===IMSC1_CODEC);if(this.config.enableWebVTT||Pr&&this.config.enableIMSC1){if(subtitleOptionsIdentical(this.tracks,Rr)){this.tracks=Rr;return}if(this.textTracks=[],this.tracks=Rr,this.config.renderTextTracksNatively){const Mr=this.media?this.media.textTracks:null;this.tracks.forEach((Fr,zr)=>{let jr;if(Mr&&zr<Mr.length){let Gr=null;for(let Nr=0;Nr<Mr.length;Nr++)if(canReuseVttTextTrack(Mr[Nr],Fr)){Gr=Mr[Nr];break}Gr&&(jr=Gr)}if(jr)clearCurrentCues(jr);else{const Gr=this._captionsOrSubtitlesFromCharacteristics(Fr);jr=this.createTextTrack(Gr,Fr.name,Fr.lang),jr&&(jr.mode="disabled")}jr&&(jr.groupId=Fr.groupId,this.textTracks.push(jr))})}else if(this.tracks.length){const Mr=this.tracks.map(Fr=>({label:Fr.name,kind:Fr.type.toLowerCase(),default:Fr.default,subtitleTrack:Fr}));this.hls.trigger(Events.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:Mr})}}}_captionsOrSubtitlesFromCharacteristics(Tr){if(Tr.attrs.CHARACTERISTICS){const Ar=/transcribes-spoken-dialog/gi.test(Tr.attrs.CHARACTERISTICS),Rr=/describes-music-and-sound/gi.test(Tr.attrs.CHARACTERISTICS);if(Ar&&Rr)return"captions"}return"subtitles"}onManifestLoaded(Tr,Ar){this.config.enableCEA708Captions&&Ar.captions&&Ar.captions.forEach(Rr=>{const Pr=/(?:CC|SERVICE)([1-4])/.exec(Rr.instreamId);if(!Pr)return;const Dr=`textTrack${Pr[1]}`,Mr=this.captionsProperties[Dr];Mr&&(Mr.label=Rr.name,Rr.lang&&(Mr.languageCode=Rr.lang),Mr.media=Rr)})}closedCaptionsForLevel(Tr){const Ar=this.hls.levels[Tr.level];return Ar==null?void 0:Ar.attrs["CLOSED-CAPTIONS"]}onFragLoading(Tr,Ar){const{cea608Parser1:Rr,cea608Parser2:Pr,lastSn:Dr,lastPartIndex:Mr}=this;if(!(!this.enabled||!(Rr&&Pr))&&Ar.frag.type===PlaylistLevelType.MAIN){var Fr,zr;const jr=Ar.frag.sn,Gr=(Fr=Ar==null||(zr=Ar.part)==null?void 0:zr.index)!=null?Fr:-1;jr===Dr+1||jr===Dr&&Gr===Mr+1||(Rr.reset(),Pr.reset()),this.lastSn=jr,this.lastPartIndex=Gr}}onFragLoaded(Tr,Ar){const{frag:Rr,payload:Pr}=Ar;if(Rr.type===PlaylistLevelType.SUBTITLE)if(Pr.byteLength){const Dr=Rr.decryptdata,Mr="stats"in Ar;if(Dr==null||!Dr.encrypted||Mr){const Fr=this.tracks[Rr.level],zr=this.vttCCs;zr[Rr.cc]||(zr[Rr.cc]={start:Rr.start,prevCC:this.prevCC,new:!0},this.prevCC=Rr.cc),Fr&&Fr.textCodec===IMSC1_CODEC?this._parseIMSC1(Rr,Pr):this._parseVTTs(Ar)}}else this.hls.trigger(Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:Rr,error:new Error("Empty subtitle payload")})}_parseIMSC1(Tr,Ar){const Rr=this.hls;parseIMSC1(Ar,this.initPTS[Tr.cc],Pr=>{this._appendCues(Pr,Tr.level),Rr.trigger(Events.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:Tr})},Pr=>{logger.log(`Failed to parse IMSC1: ${Pr}`),Rr.trigger(Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:Tr,error:Pr})})}_parseVTTs(Tr){var Ar;const{frag:Rr,payload:Pr}=Tr,{initPTS:Dr,unparsedVttFrags:Mr}=this,Fr=Dr.length-1;if(!Dr[Rr.cc]&&Fr===-1){Mr.push(Tr);return}const zr=this.hls,jr=(Ar=Rr.initSegment)!=null&&Ar.data?appendUint8Array(Rr.initSegment.data,new Uint8Array(Pr)):Pr;parseWebVTT(jr,this.initPTS[Rr.cc],this.vttCCs,Rr.cc,Rr.start,Gr=>{this._appendCues(Gr,Rr.level),zr.trigger(Events.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:Rr})},Gr=>{const Nr=Gr.message==="Missing initPTS for VTT MPEGTS";Nr?Mr.push(Tr):this._fallbackToIMSC1(Rr,Pr),logger.log(`Failed to parse VTT cue: ${Gr}`),!(Nr&&Fr>Rr.cc)&&zr.trigger(Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:Rr,error:Gr})})}_fallbackToIMSC1(Tr,Ar){const Rr=this.tracks[Tr.level];Rr.textCodec||parseIMSC1(Ar,this.initPTS[Tr.cc],()=>{Rr.textCodec=IMSC1_CODEC,this._parseIMSC1(Tr,Ar)},()=>{Rr.textCodec="wvtt"})}_appendCues(Tr,Ar){const Rr=this.hls;if(this.config.renderTextTracksNatively){const Pr=this.textTracks[Ar];if(!Pr||Pr.mode==="disabled")return;Tr.forEach(Dr=>addCueToTrack(Pr,Dr))}else{const Pr=this.tracks[Ar];if(!Pr)return;const Dr=Pr.default?"default":"subtitles"+Ar;Rr.trigger(Events.CUES_PARSED,{type:"subtitles",cues:Tr,track:Dr})}}onFragDecrypted(Tr,Ar){const{frag:Rr}=Ar;Rr.type===PlaylistLevelType.SUBTITLE&&this.onFragLoaded(Events.FRAG_LOADED,Ar)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(Tr,Ar){const{cea608Parser1:Rr,cea608Parser2:Pr}=this;if(!this.enabled||!(Rr&&Pr))return;const{frag:Dr,samples:Mr}=Ar;if(!(Dr.type===PlaylistLevelType.MAIN&&this.closedCaptionsForLevel(Dr)==="NONE"))for(let Fr=0;Fr<Mr.length;Fr++){const zr=Mr[Fr].bytes;if(zr){const jr=this.extractCea608Data(zr);Rr.addData(Mr[Fr].pts,jr[0]),Pr.addData(Mr[Fr].pts,jr[1])}}}onBufferFlushing(Tr,{startOffset:Ar,endOffset:Rr,endOffsetSubtitles:Pr,type:Dr}){const{media:Mr}=this;if(!(!Mr||Mr.currentTime<Rr)){if(!Dr||Dr==="video"){const{captionsTracks:Fr}=this;Object.keys(Fr).forEach(zr=>removeCuesInRange(Fr[zr],Ar,Rr))}if(this.config.renderTextTracksNatively&&Ar===0&&Pr!==void 0){const{textTracks:Fr}=this;Object.keys(Fr).forEach(zr=>removeCuesInRange(Fr[zr],Ar,Pr))}}}extractCea608Data(Tr){const Ar=[[],[]],Rr=Tr[0]&31;let Pr=2;for(let Dr=0;Dr<Rr;Dr++){const Mr=Tr[Pr++],Fr=127&Tr[Pr++],zr=127&Tr[Pr++];if(Fr===0&&zr===0)continue;if((4&Mr)!==0){const Gr=3&Mr;(Gr===0||Gr===1)&&(Ar[Gr].push(Fr),Ar[Gr].push(zr))}}return Ar}}function canReuseVttTextTrack(_r,Tr){return!!_r&&_r.label===Tr.name&&!(_r.textTrack1||_r.textTrack2)}function intersection(_r,Tr,Ar,Rr){return Math.min(Tr,Rr)-Math.max(_r,Ar)}function newVTTCCs(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}}}class CapLevelController{constructor(Tr){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=Tr,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(Tr){this.streamController=Tr}destroy(){this.unregisterListener(),this.hls.config.capLevelToPlayerSize&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){const{hls:Tr}=this;Tr.on(Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),Tr.on(Events.MEDIA_ATTACHING,this.onMediaAttaching,this),Tr.on(Events.MANIFEST_PARSED,this.onManifestParsed,this),Tr.on(Events.BUFFER_CODECS,this.onBufferCodecs,this),Tr.on(Events.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){const{hls:Tr}=this;Tr.off(Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),Tr.off(Events.MEDIA_ATTACHING,this.onMediaAttaching,this),Tr.off(Events.MANIFEST_PARSED,this.onManifestParsed,this),Tr.off(Events.BUFFER_CODECS,this.onBufferCodecs,this),Tr.off(Events.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(Tr,Ar){const Rr=this.hls.levels[Ar.droppedLevel];this.isLevelAllowed(Rr)&&this.restrictedLevels.push({bitrate:Rr.bitrate,height:Rr.height,width:Rr.width})}onMediaAttaching(Tr,Ar){this.media=Ar.media instanceof HTMLVideoElement?Ar.media:null,this.clientRect=null}onManifestParsed(Tr,Ar){const Rr=this.hls;this.restrictedLevels=[],this.firstLevel=Ar.firstLevel,Rr.config.capLevelToPlayerSize&&Ar.video&&this.startCapping()}onBufferCodecs(Tr,Ar){this.hls.config.capLevelToPlayerSize&&Ar.video&&this.startCapping()}onMediaDetaching(){this.stopCapping()}detectPlayerSize(){if(this.media&&this.mediaHeight>0&&this.mediaWidth>0){const Tr=this.hls.levels;if(Tr.length){const Ar=this.hls;Ar.autoLevelCapping=this.getMaxLevel(Tr.length-1),Ar.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=Ar.autoLevelCapping}}}getMaxLevel(Tr){const Ar=this.hls.levels;if(!Ar.length)return-1;const Rr=Ar.filter((Pr,Dr)=>this.isLevelAllowed(Pr)&&Dr<=Tr);return this.clientRect=null,CapLevelController.getMaxLevelByMediaSize(Rr,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;const Tr=this.media,Ar={width:0,height:0};if(Tr){const Rr=Tr.getBoundingClientRect();Ar.width=Rr.width,Ar.height=Rr.height,!Ar.width&&!Ar.height&&(Ar.width=Rr.right-Rr.left||Tr.width||0,Ar.height=Rr.bottom-Rr.top||Tr.height||0)}return this.clientRect=Ar,Ar}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let Tr=1;if(!this.hls.config.ignoreDevicePixelRatio)try{Tr=self.devicePixelRatio}catch{}return Tr}isLevelAllowed(Tr){return!this.restrictedLevels.some(Rr=>Tr.bitrate===Rr.bitrate&&Tr.width===Rr.width&&Tr.height===Rr.height)}static getMaxLevelByMediaSize(Tr,Ar,Rr){if(!(Tr!=null&&Tr.length))return-1;const Pr=(Mr,Fr)=>Fr?Mr.width!==Fr.width||Mr.height!==Fr.height:!0;let Dr=Tr.length-1;for(let Mr=0;Mr<Tr.length;Mr+=1){const Fr=Tr[Mr];if((Fr.width>=Ar||Fr.height>=Rr)&&Pr(Fr,Tr[Mr+1])){Dr=Mr;break}}return Dr}}class FPSController{constructor(Tr){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=Tr,this.registerListeners()}setStreamController(Tr){this.streamController=Tr}registerListeners(){this.hls.on(Events.MEDIA_ATTACHING,this.onMediaAttaching,this)}unregisterListeners(){this.hls.off(Events.MEDIA_ATTACHING,this.onMediaAttaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(Tr,Ar){const Rr=this.hls.config;if(Rr.capLevelOnFPSDrop){const Pr=Ar.media instanceof self.HTMLVideoElement?Ar.media:null;this.media=Pr,Pr&&typeof Pr.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),Rr.fpsDroppedMonitoringPeriod)}}checkFPS(Tr,Ar,Rr){const Pr=performance.now();if(Ar){if(this.lastTime){const Dr=Pr-this.lastTime,Mr=Rr-this.lastDroppedFrames,Fr=Ar-this.lastDecodedFrames,zr=1e3*Mr/Dr,jr=this.hls;if(jr.trigger(Events.FPS_DROP,{currentDropped:Mr,currentDecoded:Fr,totalDroppedFrames:Rr}),zr>0&&Mr>jr.config.fpsDroppedMonitoringThreshold*Fr){let Gr=jr.currentLevel;logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+Gr),Gr>0&&(jr.autoLevelCapping===-1||jr.autoLevelCapping>=Gr)&&(Gr=Gr-1,jr.trigger(Events.FPS_DROP_LEVEL_CAPPING,{level:Gr,droppedLevel:jr.currentLevel}),jr.autoLevelCapping=Gr,this.streamController.nextLevelSwitch())}}this.lastTime=Pr,this.lastDroppedFrames=Rr,this.lastDecodedFrames=Ar}}checkFPSInterval(){const Tr=this.media;if(Tr)if(this.isVideoPlaybackQualityAvailable){const Ar=Tr.getVideoPlaybackQuality();this.checkFPS(Tr,Ar.totalVideoFrames,Ar.droppedVideoFrames)}else this.checkFPS(Tr,Tr.webkitDecodedFrameCount,Tr.webkitDroppedFrameCount)}}const LOGGER_PREFIX="[eme]";class EMEController{constructor(Tr){this.hls=void 0,this.config=void 0,this.media=null,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.setMediaKeysQueue=EMEController.CDMCleanupPromise?[EMEController.CDMCleanupPromise]:[],this.onMediaEncrypted=this._onMediaEncrypted.bind(this),this.onWaitingForKey=this._onWaitingForKey.bind(this),this.debug=logger.debug.bind(logger,LOGGER_PREFIX),this.log=logger.log.bind(logger,LOGGER_PREFIX),this.warn=logger.warn.bind(logger,LOGGER_PREFIX),this.error=logger.error.bind(logger,LOGGER_PREFIX),this.hls=Tr,this.config=Tr.config,this.registerListeners()}destroy(){this.unregisterListeners(),this.onMediaDetached();const Tr=this.config;Tr.requestMediaKeySystemAccessFunc=null,Tr.licenseXhrSetup=Tr.licenseResponseCallback=void 0,Tr.drmSystems=Tr.drmSystemOptions={},this.hls=this.onMediaEncrypted=this.onWaitingForKey=this.keyIdToKeySessionPromise=null,this.config=null}registerListeners(){this.hls.on(Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(Events.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(Events.MANIFEST_LOADED,this.onManifestLoaded,this)}unregisterListeners(){this.hls.off(Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(Events.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(Events.MANIFEST_LOADED,this.onManifestLoaded,this)}getLicenseServerUrl(Tr){const{drmSystems:Ar,widevineLicenseUrl:Rr}=this.config,Pr=Ar[Tr];if(Pr)return Pr.licenseUrl;if(Tr===KeySystems.WIDEVINE&&Rr)return Rr;throw new Error(`no license server URL configured for key-system "${Tr}"`)}getServerCertificateUrl(Tr){const{drmSystems:Ar}=this.config,Rr=Ar[Tr];if(Rr)return Rr.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${Tr}"]`)}attemptKeySystemAccess(Tr){const Ar=this.hls.levels,Rr=(Mr,Fr,zr)=>!!Mr&&zr.indexOf(Mr)===Fr,Pr=Ar.map(Mr=>Mr.audioCodec).filter(Rr),Dr=Ar.map(Mr=>Mr.videoCodec).filter(Rr);return Pr.length+Dr.length===0&&Dr.push("avc1.42e01e"),new Promise((Mr,Fr)=>{const zr=jr=>{const Gr=jr.shift();this.getMediaKeysPromise(Gr,Pr,Dr).then(Nr=>Mr({keySystem:Gr,mediaKeys:Nr})).catch(Nr=>{jr.length?zr(jr):Nr instanceof EMEKeyError?Fr(Nr):Fr(new EMEKeyError({type:ErrorTypes.KEY_SYSTEM_ERROR,details:ErrorDetails.KEY_SYSTEM_NO_ACCESS,error:Nr,fatal:!0},Nr.message))})};zr(Tr)})}requestMediaKeySystemAccess(Tr,Ar){const{requestMediaKeySystemAccessFunc:Rr}=this.config;if(typeof Rr!="function"){let Pr=`Configured requestMediaKeySystemAccess is not a function ${Rr}`;return requestMediaKeySystemAccess===null&&self.location.protocol==="http:"&&(Pr=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(new Error(Pr))}return Rr(Tr,Ar)}getMediaKeysPromise(Tr,Ar,Rr){const Pr=getSupportedMediaKeySystemConfigurations(Tr,Ar,Rr,this.config.drmSystemOptions),Dr=this.keySystemAccessPromises[Tr];let Mr=Dr==null?void 0:Dr.keySystemAccess;if(!Mr){this.log(`Requesting encrypted media "${Tr}" key-system access with config: ${JSON.stringify(Pr)}`),Mr=this.requestMediaKeySystemAccess(Tr,Pr);const Fr=this.keySystemAccessPromises[Tr]={keySystemAccess:Mr};return Mr.catch(zr=>{this.log(`Failed to obtain access to key-system "${Tr}": ${zr}`)}),Mr.then(zr=>{this.log(`Access for key-system "${zr.keySystem}" obtained`);const jr=this.fetchServerCertificate(Tr);return this.log(`Create media-keys for "${Tr}"`),Fr.mediaKeys=zr.createMediaKeys().then(Gr=>(this.log(`Media-keys created for "${Tr}"`),jr.then(Nr=>Nr?this.setMediaKeysServerCertificate(Gr,Tr,Nr):Gr))),Fr.mediaKeys.catch(Gr=>{this.error(`Failed to create media-keys for "${Tr}"}: ${Gr}`)}),Fr.mediaKeys})}return Mr.then(()=>Dr.mediaKeys)}createMediaKeySessionContext({decryptdata:Tr,keySystem:Ar,mediaKeys:Rr}){this.log(`Creating key-system session "${Ar}" keyId: ${Hex.hexDump(Tr.keyId||[])}`);const Pr=Rr.createSession(),Dr={decryptdata:Tr,keySystem:Ar,mediaKeys:Rr,mediaKeysSession:Pr,keyStatus:"status-pending"};return this.mediaKeySessions.push(Dr),Dr}renewKeySession(Tr){const Ar=Tr.decryptdata;if(Ar.pssh){const Rr=this.createMediaKeySessionContext(Tr),Pr=this.getKeyIdString(Ar),Dr="cenc";this.keyIdToKeySessionPromise[Pr]=this.generateRequestWithPreferredKeySession(Rr,Dr,Ar.pssh,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(Tr)}getKeyIdString(Tr){if(!Tr)throw new Error("Could not read keyId of undefined decryptdata");if(Tr.keyId===null)throw new Error("keyId is null");return Hex.hexDump(Tr.keyId)}updateKeySession(Tr,Ar){var Rr;const Pr=Tr.mediaKeysSession;return this.log(`Updating key-session "${Pr.sessionId}" for keyID ${Hex.hexDump(((Rr=Tr.decryptdata)==null?void 0:Rr.keyId)||[])}
      } (data length: ${Ar&&Ar.byteLength})`),Pr.update(Ar)}selectKeySystemFormat(Tr){const Ar=Object.keys(Tr.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${Tr.sn} ${Tr.type}: ${Tr.level}) key formats ${Ar.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(Ar)),this.keyFormatPromise}getKeyFormatPromise(Tr){return new Promise((Ar,Rr)=>{const Pr=getKeySystemsForConfig(this.config),Dr=Tr.map(keySystemFormatToKeySystemDomain).filter(Mr=>!!Mr&&Pr.indexOf(Mr)!==-1);return this.getKeySystemSelectionPromise(Dr).then(({keySystem:Mr})=>{const Fr=keySystemDomainToKeySystemFormat(Mr);Fr?Ar(Fr):Rr(new Error(`Unable to find format for key-system "${Mr}"`))}).catch(Rr)})}loadKey(Tr){const Ar=Tr.keyInfo.decryptdata,Rr=this.getKeyIdString(Ar),Pr=`(keyId: ${Rr} format: "${Ar.keyFormat}" method: ${Ar.method} uri: ${Ar.uri})`;this.log(`Starting session for key ${Pr}`);let Dr=this.keyIdToKeySessionPromise[Rr];return Dr||(Dr=this.keyIdToKeySessionPromise[Rr]=this.getKeySystemForKeyPromise(Ar).then(({keySystem:Mr,mediaKeys:Fr})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${Tr.frag.sn} ${Tr.frag.type}: ${Tr.frag.level} using key ${Pr}`),this.attemptSetMediaKeys(Mr,Fr).then(()=>{this.throwIfDestroyed();const zr=this.createMediaKeySessionContext({keySystem:Mr,mediaKeys:Fr,decryptdata:Ar}),jr="cenc";return this.generateRequestWithPreferredKeySession(zr,jr,Ar.pssh,"playlist-key")}))),Dr.catch(Mr=>this.handleError(Mr))),Dr}throwIfDestroyed(Tr="Invalid state"){if(!this.hls)throw new Error("invalid state")}handleError(Tr){this.hls&&(this.error(Tr.message),Tr instanceof EMEKeyError?this.hls.trigger(Events.ERROR,Tr.data):this.hls.trigger(Events.ERROR,{type:ErrorTypes.KEY_SYSTEM_ERROR,details:ErrorDetails.KEY_SYSTEM_NO_KEYS,error:Tr,fatal:!0}))}getKeySystemForKeyPromise(Tr){const Ar=this.getKeyIdString(Tr),Rr=this.keyIdToKeySessionPromise[Ar];if(!Rr){const Pr=keySystemFormatToKeySystemDomain(Tr.keyFormat),Dr=Pr?[Pr]:getKeySystemsForConfig(this.config);return this.attemptKeySystemAccess(Dr)}return Rr}getKeySystemSelectionPromise(Tr){if(Tr.length||(Tr=getKeySystemsForConfig(this.config)),Tr.length===0)throw new EMEKeyError({type:ErrorTypes.KEY_SYSTEM_ERROR,details:ErrorDetails.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${JSON.stringify({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(Tr)}_onMediaEncrypted(Tr){const{initDataType:Ar,initData:Rr}=Tr;if(this.debug(`"${Tr.type}" event: init data type: "${Ar}"`),Rr===null)return;let Pr,Dr;if(Ar==="sinf"&&this.config.drmSystems[KeySystems.FAIRPLAY]){const Gr=bin2str(new Uint8Array(Rr));try{const Nr=base64Decode(JSON.parse(Gr).sinf),Lr=parseSinf(new Uint8Array(Nr));if(!Lr)return;Pr=Lr.subarray(8,24),Dr=KeySystems.FAIRPLAY}catch{this.warn('Failed to parse sinf "encrypted" event message initData');return}}else{const Gr=parsePssh(Rr);if(Gr===null)return;Gr.version===0&&Gr.systemId===KeySystemIds.WIDEVINE&&Gr.data&&(Pr=Gr.data.subarray(8,24)),Dr=keySystemIdToKeySystemDomain(Gr.systemId)}if(!Dr||!Pr)return;const Mr=Hex.hexDump(Pr),{keyIdToKeySessionPromise:Fr,mediaKeySessions:zr}=this;let jr=Fr[Mr];for(let Gr=0;Gr<zr.length;Gr++){const Nr=zr[Gr],Lr=Nr.decryptdata;if(Lr.pssh||!Lr.keyId)continue;const Ur=Hex.hexDump(Lr.keyId);if(Mr===Ur||Lr.uri.replace(/-/g,"").indexOf(Mr)!==-1){jr=Fr[Ur],delete Fr[Ur],Lr.pssh=new Uint8Array(Rr),Lr.keyId=Pr,jr=Fr[Mr]=jr.then(()=>this.generateRequestWithPreferredKeySession(Nr,Ar,Rr,"encrypted-event-key-match"));break}}jr||(jr=Fr[Mr]=this.getKeySystemSelectionPromise([Dr]).then(({keySystem:Gr,mediaKeys:Nr})=>{var Lr;this.throwIfDestroyed();const Ur=new LevelKey("ISO-23001-7",Mr,(Lr=keySystemDomainToKeySystemFormat(Gr))!=null?Lr:"");return Ur.pssh=new Uint8Array(Rr),Ur.keyId=Pr,this.attemptSetMediaKeys(Gr,Nr).then(()=>{this.throwIfDestroyed();const Vr=this.createMediaKeySessionContext({decryptdata:Ur,keySystem:Gr,mediaKeys:Nr});return this.generateRequestWithPreferredKeySession(Vr,Ar,Rr,"encrypted-event-no-match")})})),jr.catch(Gr=>this.handleError(Gr))}_onWaitingForKey(Tr){this.log(`"${Tr.type}" event`)}attemptSetMediaKeys(Tr,Ar){const Rr=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${Tr}"`);const Pr=Promise.all(Rr).then(()=>{if(!this.media)throw new Error("Attempted to set mediaKeys without media element attached");return this.media.setMediaKeys(Ar)});return this.setMediaKeysQueue.push(Pr),Pr.then(()=>{this.log(`Media-keys set for "${Tr}"`),Rr.push(Pr),this.setMediaKeysQueue=this.setMediaKeysQueue.filter(Dr=>Rr.indexOf(Dr)===-1)})}generateRequestWithPreferredKeySession(Tr,Ar,Rr,Pr){var Dr,Mr;const Fr=(Dr=this.config.drmSystems)==null||(Mr=Dr[Tr.keySystem])==null?void 0:Mr.generateRequest;if(Fr)try{const Lr=Fr.call(this.hls,Ar,Rr,Tr);if(!Lr)throw new Error("Invalid response from configured generateRequest filter");Ar=Lr.initDataType,Rr=Tr.decryptdata.pssh=Lr.initData?new Uint8Array(Lr.initData):null}catch(Lr){var zr;if(this.warn(Lr.message),(zr=this.hls)!=null&&zr.config.debug)throw Lr}if(Rr===null)return this.log(`Skipping key-session request for "${Pr}" (no initData)`),Promise.resolve(Tr);const jr=this.getKeyIdString(Tr.decryptdata);this.log(`Generating key-session request for "${Pr}": ${jr} (init data type: ${Ar} length: ${Rr?Rr.byteLength:null})`);const Gr=new EventEmitter;Tr.mediaKeysSession.onmessage=Lr=>{const Ur=Tr.mediaKeysSession;if(!Ur){Gr.emit("error",new Error("invalid state"));return}const{messageType:Vr,message:Wr}=Lr;this.log(`"${Vr}" message event for session "${Ur.sessionId}" message size: ${Wr.byteLength}`),Vr==="license-request"||Vr==="license-renewal"?this.renewLicense(Tr,Wr).catch(qr=>{this.handleError(qr),Gr.emit("error",qr)}):Vr==="license-release"?Tr.keySystem===KeySystems.FAIRPLAY&&(this.updateKeySession(Tr,strToUtf8array("acknowledged")),this.removeSession(Tr)):this.warn(`unhandled media key message type "${Vr}"`)},Tr.mediaKeysSession.onkeystatuseschange=Lr=>{if(!Tr.mediaKeysSession){Gr.emit("error",new Error("invalid state"));return}this.onKeyStatusChange(Tr);const Vr=Tr.keyStatus;Gr.emit("keyStatus",Vr),Vr==="expired"&&(this.warn(`${Tr.keySystem} expired for key ${jr}`),this.renewKeySession(Tr))};const Nr=new Promise((Lr,Ur)=>{Gr.on("error",Ur),Gr.on("keyStatus",Vr=>{Vr.startsWith("usable")?Lr():Vr==="output-restricted"?Ur(new EMEKeyError({type:ErrorTypes.KEY_SYSTEM_ERROR,details:ErrorDetails.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED,fatal:!1},"HDCP level output restricted")):Vr==="internal-error"?Ur(new EMEKeyError({type:ErrorTypes.KEY_SYSTEM_ERROR,details:ErrorDetails.KEY_SYSTEM_STATUS_INTERNAL_ERROR,fatal:!0},`key status changed to "${Vr}"`)):Vr==="expired"?Ur(new Error("key expired while generating request")):this.warn(`unhandled key status change "${Vr}"`)})});return Tr.mediaKeysSession.generateRequest(Ar,Rr).then(()=>{var Lr;this.log(`Request generated for key-session "${(Lr=Tr.mediaKeysSession)==null?void 0:Lr.sessionId}" keyId: ${jr}`)}).catch(Lr=>{throw new EMEKeyError({type:ErrorTypes.KEY_SYSTEM_ERROR,details:ErrorDetails.KEY_SYSTEM_NO_SESSION,error:Lr,fatal:!1},`Error generating key-session request: ${Lr}`)}).then(()=>Nr).catch(Lr=>{throw Gr.removeAllListeners(),this.removeSession(Tr),Lr}).then(()=>(Gr.removeAllListeners(),Tr))}onKeyStatusChange(Tr){Tr.mediaKeysSession.keyStatuses.forEach((Ar,Rr)=>{this.log(`key status change "${Ar}" for keyStatuses keyId: ${Hex.hexDump("buffer"in Rr?new Uint8Array(Rr.buffer,Rr.byteOffset,Rr.byteLength):new Uint8Array(Rr))} session keyId: ${Hex.hexDump(new Uint8Array(Tr.decryptdata.keyId||[]))} uri: ${Tr.decryptdata.uri}`),Tr.keyStatus=Ar})}fetchServerCertificate(Tr){const Ar=this.config,Rr=Ar.loader,Pr=new Rr(Ar),Dr=this.getServerCertificateUrl(Tr);return Dr?(this.log(`Fetching serverCertificate for "${Tr}"`),new Promise((Mr,Fr)=>{const zr={responseType:"arraybuffer",url:Dr},jr=Ar.certLoadPolicy.default,Gr={loadPolicy:jr,timeout:jr.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},Nr={onSuccess:(Lr,Ur,Vr,Wr)=>{Mr(Lr.data)},onError:(Lr,Ur,Vr,Wr)=>{Fr(new EMEKeyError({type:ErrorTypes.KEY_SYSTEM_ERROR,details:ErrorDetails.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:Vr,response:_objectSpread2({url:zr.url,data:void 0},Lr)},`"${Tr}" certificate request failed (${Dr}). Status: ${Lr.code} (${Lr.text})`))},onTimeout:(Lr,Ur,Vr)=>{Fr(new EMEKeyError({type:ErrorTypes.KEY_SYSTEM_ERROR,details:ErrorDetails.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:Vr,response:{url:zr.url,data:void 0}},`"${Tr}" certificate request timed out (${Dr})`))},onAbort:(Lr,Ur,Vr)=>{Fr(new Error("aborted"))}};Pr.load(zr,Gr,Nr)})):Promise.resolve()}setMediaKeysServerCertificate(Tr,Ar,Rr){return new Promise((Pr,Dr)=>{Tr.setServerCertificate(Rr).then(Mr=>{this.log(`setServerCertificate ${Mr?"success":"not supported by CDM"} (${Rr==null?void 0:Rr.byteLength}) on "${Ar}"`),Pr(Tr)}).catch(Mr=>{Dr(new EMEKeyError({type:ErrorTypes.KEY_SYSTEM_ERROR,details:ErrorDetails.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:Mr,fatal:!0},Mr.message))})})}renewLicense(Tr,Ar){return this.requestLicense(Tr,new Uint8Array(Ar)).then(Rr=>this.updateKeySession(Tr,new Uint8Array(Rr)).catch(Pr=>{throw new EMEKeyError({type:ErrorTypes.KEY_SYSTEM_ERROR,details:ErrorDetails.KEY_SYSTEM_SESSION_UPDATE_FAILED,error:Pr,fatal:!0},Pr.message)}))}setupLicenseXHR(Tr,Ar,Rr,Pr){const Dr=this.config.licenseXhrSetup;return Dr?Promise.resolve().then(()=>{if(!Rr.decryptdata)throw new Error("Key removed");return Dr.call(this.hls,Tr,Ar,Rr,Pr)}).catch(Mr=>{if(!Rr.decryptdata)throw Mr;return Tr.open("POST",Ar,!0),Dr.call(this.hls,Tr,Ar,Rr,Pr)}).then(Mr=>(Tr.readyState||Tr.open("POST",Ar,!0),{xhr:Tr,licenseChallenge:Mr||Pr})):(Tr.open("POST",Ar,!0),Promise.resolve({xhr:Tr,licenseChallenge:Pr}))}requestLicense(Tr,Ar){const Rr=this.config.keyLoadPolicy.default;return new Promise((Pr,Dr)=>{const Mr=this.getLicenseServerUrl(Tr.keySystem);this.log(`Sending license request to URL: ${Mr}`);const Fr=new XMLHttpRequest;Fr.responseType="arraybuffer",Fr.onreadystatechange=()=>{if(!this.hls||!Tr.mediaKeysSession)return Dr(new Error("invalid state"));if(Fr.readyState===4)if(Fr.status===200){this._requestLicenseFailureCount=0;let zr=Fr.response;this.log(`License received ${zr instanceof ArrayBuffer?zr.byteLength:zr}`);const jr=this.config.licenseResponseCallback;if(jr)try{zr=jr.call(this.hls,Fr,Mr,Tr)}catch(Gr){this.error(Gr)}Pr(zr)}else{const zr=Rr.errorRetry,jr=zr?zr.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>jr||Fr.status>=400&&Fr.status<500)Dr(new EMEKeyError({type:ErrorTypes.KEY_SYSTEM_ERROR,details:ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0,networkDetails:Fr,response:{url:Mr,data:void 0,code:Fr.status,text:Fr.statusText}},`License Request XHR failed (${Mr}). Status: ${Fr.status} (${Fr.statusText})`));else{const Gr=jr-this._requestLicenseFailureCount+1;this.warn(`Retrying license request, ${Gr} attempts left`),this.requestLicense(Tr,Ar).then(Pr,Dr)}}},Tr.licenseXhr&&Tr.licenseXhr.readyState!==XMLHttpRequest.DONE&&Tr.licenseXhr.abort(),Tr.licenseXhr=Fr,this.setupLicenseXHR(Fr,Mr,Tr,Ar).then(({xhr:zr,licenseChallenge:jr})=>{zr.send(jr)})})}onMediaAttached(Tr,Ar){if(!this.config.emeEnabled)return;const Rr=Ar.media;this.media=Rr,Rr.addEventListener("encrypted",this.onMediaEncrypted),Rr.addEventListener("waitingforkey",this.onWaitingForKey)}onMediaDetached(){const Tr=this.media,Ar=this.mediaKeySessions;Tr&&(Tr.removeEventListener("encrypted",this.onMediaEncrypted),Tr.removeEventListener("waitingforkey",this.onWaitingForKey),this.media=null),this._requestLicenseFailureCount=0,this.setMediaKeysQueue=[],this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},LevelKey.clearKeyUriToKeyIdMap();const Rr=Ar.length;EMEController.CDMCleanupPromise=Promise.all(Ar.map(Pr=>this.removeSession(Pr)).concat(Tr==null?void 0:Tr.setMediaKeys(null).catch(Pr=>{this.log(`Could not clear media keys: ${Pr}. media.src: ${Tr==null?void 0:Tr.src}`)}))).then(()=>{Rr&&(this.log("finished closing key sessions and clearing media keys"),Ar.length=0)}).catch(Pr=>{this.log(`Could not close sessions and clear media keys: ${Pr}. media.src: ${Tr==null?void 0:Tr.src}`)})}onManifestLoading(){this.keyFormatPromise=null}onManifestLoaded(Tr,{sessionKeys:Ar}){if(!(!Ar||!this.config.emeEnabled)&&!this.keyFormatPromise){const Rr=Ar.reduce((Pr,Dr)=>(Pr.indexOf(Dr.keyFormat)===-1&&Pr.push(Dr.keyFormat),Pr),[]);this.log(`Selecting key-system from session-keys ${Rr.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(Rr)}}removeSession(Tr){const{mediaKeysSession:Ar,licenseXhr:Rr}=Tr;if(Ar){this.log(`Remove licenses and keys and close session ${Ar.sessionId}`),Ar.onmessage=null,Ar.onkeystatuseschange=null,Rr&&Rr.readyState!==XMLHttpRequest.DONE&&Rr.abort(),Tr.mediaKeysSession=Tr.decryptdata=Tr.licenseXhr=void 0;const Pr=this.mediaKeySessions.indexOf(Tr);return Pr>-1&&this.mediaKeySessions.splice(Pr,1),Ar.remove().catch(Dr=>{this.log(`Could not remove session: ${Dr}`)}).then(()=>Ar.close()).catch(Dr=>{this.log(`Could not close session: ${Dr}`)})}}}EMEController.CDMCleanupPromise=void 0;class EMEKeyError extends Error{constructor(Tr,Ar){super(Ar),this.data=void 0,Tr.error||(Tr.error=new Error(Ar)),this.data=Tr,Tr.err=Tr.error}}const CMCDVersion=1;var CMCDObjectType={MANIFEST:"m",AUDIO:"a",VIDEO:"v",MUXED:"av",INIT:"i",CAPTION:"c",TIMED_TEXT:"tt",KEY:"k",OTHER:"o"};const CMCDStreamingFormatHLS="h";class CMCDController{constructor(Tr){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=Pr=>{try{this.apply(Pr,{ot:CMCDObjectType.MANIFEST,su:!this.initialized})}catch(Dr){logger.warn("Could not generate manifest CMCD data.",Dr)}},this.applyFragmentData=Pr=>{try{const Dr=Pr.frag,Mr=this.hls.levels[Dr.level],Fr=this.getObjectType(Dr),zr={d:Dr.duration*1e3,ot:Fr};(Fr===CMCDObjectType.VIDEO||Fr===CMCDObjectType.AUDIO||Fr==CMCDObjectType.MUXED)&&(zr.br=Mr.bitrate/1e3,zr.tb=this.getTopBandwidth(Fr)/1e3,zr.bl=this.getBufferLength(Fr)),this.apply(Pr,zr)}catch(Dr){logger.warn("Could not generate segment CMCD data.",Dr)}},this.hls=Tr;const Ar=this.config=Tr.config,{cmcd:Rr}=Ar;Rr!=null&&(Ar.pLoader=this.createPlaylistLoader(),Ar.fLoader=this.createFragmentLoader(),this.sid=Rr.sessionId||CMCDController.uuid(),this.cid=Rr.contentId,this.useHeaders=Rr.useHeaders===!0,this.registerListeners())}registerListeners(){const Tr=this.hls;Tr.on(Events.MEDIA_ATTACHED,this.onMediaAttached,this),Tr.on(Events.MEDIA_DETACHED,this.onMediaDetached,this),Tr.on(Events.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){const Tr=this.hls;Tr.off(Events.MEDIA_ATTACHED,this.onMediaAttached,this),Tr.off(Events.MEDIA_DETACHED,this.onMediaDetached,this),Tr.off(Events.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null}onMediaAttached(Tr,Ar){this.media=Ar.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(Tr,Ar){var Rr,Pr;this.audioBuffer=(Rr=Ar.tracks.audio)==null?void 0:Rr.buffer,this.videoBuffer=(Pr=Ar.tracks.video)==null?void 0:Pr.buffer}createData(){var Tr;return{v:CMCDVersion,sf:CMCDStreamingFormatHLS,sid:this.sid,cid:this.cid,pr:(Tr=this.media)==null?void 0:Tr.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(Tr,Ar={}){_extends(Ar,this.createData());const Rr=Ar.ot===CMCDObjectType.INIT||Ar.ot===CMCDObjectType.VIDEO||Ar.ot===CMCDObjectType.MUXED;if(this.starved&&Rr&&(Ar.bs=!0,Ar.su=!0,this.starved=!1),Ar.su==null&&(Ar.su=this.buffering),this.useHeaders){const Pr=CMCDController.toHeaders(Ar);if(!Object.keys(Pr).length)return;Tr.headers||(Tr.headers={}),_extends(Tr.headers,Pr)}else{const Pr=CMCDController.toQuery(Ar);if(!Pr)return;Tr.url=CMCDController.appendQueryToUri(Tr.url,Pr)}}getObjectType(Tr){const{type:Ar}=Tr;if(Ar==="subtitle")return CMCDObjectType.TIMED_TEXT;if(Tr.sn==="initSegment")return CMCDObjectType.INIT;if(Ar==="audio")return CMCDObjectType.AUDIO;if(Ar==="main")return this.hls.audioTracks.length?CMCDObjectType.VIDEO:CMCDObjectType.MUXED}getTopBandwidth(Tr){let Ar=0,Rr;const Pr=this.hls;if(Tr===CMCDObjectType.AUDIO)Rr=Pr.audioTracks;else{const Dr=Pr.maxAutoLevel,Mr=Dr>-1?Dr+1:Pr.levels.length;Rr=Pr.levels.slice(0,Mr)}for(const Dr of Rr)Dr.bitrate>Ar&&(Ar=Dr.bitrate);return Ar>0?Ar:NaN}getBufferLength(Tr){const Ar=this.hls.media,Rr=Tr===CMCDObjectType.AUDIO?this.audioBuffer:this.videoBuffer;return!Rr||!Ar?NaN:BufferHelper.bufferInfo(Rr,Ar.currentTime,this.config.maxBufferHole).len*1e3}createPlaylistLoader(){const{pLoader:Tr}=this.config,Ar=this.applyPlaylistData,Rr=Tr||this.config.loader;return class{constructor(Dr){this.loader=void 0,this.loader=new Rr(Dr)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(Dr,Mr,Fr){Ar(Dr),this.loader.load(Dr,Mr,Fr)}}}createFragmentLoader(){const{fLoader:Tr}=this.config,Ar=this.applyFragmentData,Rr=Tr||this.config.loader;return class{constructor(Dr){this.loader=void 0,this.loader=new Rr(Dr)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(Dr,Mr,Fr){Ar(Dr),this.loader.load(Dr,Mr,Fr)}}}static uuid(){const Tr=URL.createObjectURL(new Blob),Ar=Tr.toString();return URL.revokeObjectURL(Tr),Ar.slice(Ar.lastIndexOf("/")+1)}static serialize(Tr){const Ar=[],Rr=jr=>!Number.isNaN(jr)&&jr!=null&&jr!==""&&jr!==!1,Pr=jr=>Math.round(jr),Dr=jr=>Pr(jr/100)*100,Fr={br:Pr,d:Pr,bl:Dr,dl:Dr,mtp:Dr,nor:jr=>encodeURIComponent(jr),rtp:Dr,tb:Pr},zr=Object.keys(Tr||{}).sort();for(const jr of zr){let Gr=Tr[jr];if(!Rr(Gr)||jr==="v"&&Gr===1||jr=="pr"&&Gr===1)continue;const Nr=Fr[jr];Nr&&(Gr=Nr(Gr));const Lr=typeof Gr;let Ur;jr==="ot"||jr==="sf"||jr==="st"?Ur=`${jr}=${Gr}`:Lr==="boolean"?Ur=jr:Lr==="number"?Ur=`${jr}=${Gr}`:Ur=`${jr}=${JSON.stringify(Gr)}`,Ar.push(Ur)}return Ar.join(",")}static toHeaders(Tr){const Ar=Object.keys(Tr),Rr={},Pr=["Object","Request","Session","Status"],Dr=[{},{},{},{}],Mr={br:0,d:0,ot:0,tb:0,bl:1,dl:1,mtp:1,nor:1,nrr:1,su:1,cid:2,pr:2,sf:2,sid:2,st:2,v:2,bs:3,rtp:3};for(const Fr of Ar){const zr=Mr[Fr]!=null?Mr[Fr]:1;Dr[zr][Fr]=Tr[Fr]}for(let Fr=0;Fr<Dr.length;Fr++){const zr=CMCDController.serialize(Dr[Fr]);zr&&(Rr[`CMCD-${Pr[Fr]}`]=zr)}return Rr}static toQuery(Tr){return`CMCD=${encodeURIComponent(CMCDController.serialize(Tr))}`}static appendQueryToUri(Tr,Ar){if(!Ar)return Tr;const Rr=Tr.includes("?")?"&":"?";return`${Tr}${Rr}${Ar}`}}const PATHWAY_PENALTY_DURATION_MS=3e5;class ContentSteeringController{constructor(Tr){this.hls=void 0,this.log=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this.pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=Tr,this.log=logger.log.bind(logger,"[content-steering]:"),this.registerListeners()}registerListeners(){const Tr=this.hls;Tr.on(Events.MANIFEST_LOADING,this.onManifestLoading,this),Tr.on(Events.MANIFEST_LOADED,this.onManifestLoaded,this),Tr.on(Events.MANIFEST_PARSED,this.onManifestParsed,this),Tr.on(Events.ERROR,this.onError,this)}unregisterListeners(){const Tr=this.hls;Tr&&(Tr.off(Events.MANIFEST_LOADING,this.onManifestLoading,this),Tr.off(Events.MANIFEST_LOADED,this.onManifestLoaded,this),Tr.off(Events.MANIFEST_PARSED,this.onManifestParsed,this),Tr.off(Events.ERROR,this.onError,this))}startLoad(){if(this.started=!0,self.clearTimeout(this.reloadTimer),this.enabled&&this.uri)if(this.updated){const Tr=Math.max(this.timeToLoad*1e3-(performance.now()-this.updated),0);this.scheduleRefresh(this.uri,Tr)}else this.loadSteeringManifest(this.uri)}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),self.clearTimeout(this.reloadTimer)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(Tr){const Ar=this.levels;Ar&&(this.levels=Ar.filter(Rr=>Rr!==Tr))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(Tr,Ar){const{contentSteering:Rr}=Ar;Rr!==null&&(this.pathwayId=Rr.pathwayId,this.uri=Rr.uri,this.started&&this.startLoad())}onManifestParsed(Tr,Ar){this.audioTracks=Ar.audioTracks,this.subtitleTracks=Ar.subtitleTracks}onError(Tr,Ar){const{errorAction:Rr}=Ar;if((Rr==null?void 0:Rr.action)===NetworkErrorAction.SendAlternateToPenaltyBox&&Rr.flags===ErrorActionFlags.MoveAllAlternatesMatchingHost){let Pr=this.pathwayPriority;const Dr=this.pathwayId;this.penalizedPathways[Dr]||(this.penalizedPathways[Dr]=performance.now()),!Pr&&this.levels&&(Pr=this.levels.reduce((Mr,Fr)=>(Mr.indexOf(Fr.pathwayId)===-1&&Mr.push(Fr.pathwayId),Mr),[])),Pr&&Pr.length>1&&(this.updatePathwayPriority(Pr),Rr.resolved=this.pathwayId!==Dr)}}filterParsedLevels(Tr){this.levels=Tr;let Ar=this.getLevelsForPathway(this.pathwayId);if(Ar.length===0){const Rr=Tr[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${Rr}"`),Ar=this.getLevelsForPathway(Rr),this.pathwayId=Rr}return Ar.length!==Tr.length?(this.log(`Found ${Ar.length}/${Tr.length} levels in Pathway "${this.pathwayId}"`),Ar):Tr}getLevelsForPathway(Tr){return this.levels===null?[]:this.levels.filter(Ar=>Tr===Ar.pathwayId)}updatePathwayPriority(Tr){this.pathwayPriority=Tr;let Ar;const Rr=this.penalizedPathways,Pr=performance.now();Object.keys(Rr).forEach(Dr=>{Pr-Rr[Dr]>PATHWAY_PENALTY_DURATION_MS&&delete Rr[Dr]});for(let Dr=0;Dr<Tr.length;Dr++){const Mr=Tr[Dr];if(Rr[Mr])continue;if(Mr===this.pathwayId)return;const Fr=this.hls.nextLoadLevel,zr=this.hls.levels[Fr];if(Ar=this.getLevelsForPathway(Mr),Ar.length>0){this.log(`Setting Pathway to "${Mr}"`),this.pathwayId=Mr,this.hls.trigger(Events.LEVELS_UPDATED,{levels:Ar});const jr=this.hls.levels[Fr];zr&&jr&&this.levels&&(jr.attrs["STABLE-VARIANT-ID"]!==zr.attrs["STABLE-VARIANT-ID"]&&jr.bitrate!==zr.bitrate&&this.log(`Unstable Pathways change from bitrate ${zr.bitrate} to ${jr.bitrate}`),this.hls.nextLoadLevel=Fr);break}}}clonePathways(Tr){const Ar=this.levels;if(!Ar)return;const Rr={},Pr={};Tr.forEach(Dr=>{const{ID:Mr,"BASE-ID":Fr,"URI-REPLACEMENT":zr}=Dr;if(Ar.some(Gr=>Gr.pathwayId===Mr))return;const jr=this.getLevelsForPathway(Fr).map(Gr=>{const Nr=_extends({},Gr);Nr.details=void 0,Nr.url=performUriReplacement(Gr.uri,Gr.attrs["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",zr);const Lr=new AttrList(Gr.attrs);Lr["PATHWAY-ID"]=Mr;const Ur=Lr.AUDIO&&`${Lr.AUDIO}_clone_${Mr}`,Vr=Lr.SUBTITLES&&`${Lr.SUBTITLES}_clone_${Mr}`;Ur&&(Rr[Lr.AUDIO]=Ur,Lr.AUDIO=Ur),Vr&&(Pr[Lr.SUBTITLES]=Vr,Lr.SUBTITLES=Vr),Nr.attrs=Lr;const Wr=new Level(Nr);return addGroupId(Wr,"audio",Ur),addGroupId(Wr,"text",Vr),Wr});Ar.push(...jr),cloneRenditionGroups(this.audioTracks,Rr,zr,Mr),cloneRenditionGroups(this.subtitleTracks,Pr,zr,Mr)})}loadSteeringManifest(Tr){const Ar=this.hls.config,Rr=Ar.loader;this.loader&&this.loader.destroy(),this.loader=new Rr(Ar);let Pr;try{Pr=new self.URL(Tr)}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest URI: ${Tr}`);return}if(Pr.protocol!=="data:"){const Gr=(this.hls.bandwidthEstimate||Ar.abrEwmaDefaultEstimate)|0;Pr.searchParams.set("_HLS_pathway",this.pathwayId),Pr.searchParams.set("_HLS_throughput",""+Gr)}const Dr={responseType:"json",url:Pr.href},Mr=Ar.steeringManifestLoadPolicy.default,Fr=Mr.errorRetry||Mr.timeoutRetry||{},zr={loadPolicy:Mr,timeout:Mr.maxLoadTimeMs,maxRetry:Fr.maxNumRetry||0,retryDelay:Fr.retryDelayMs||0,maxRetryDelay:Fr.maxRetryDelayMs||0},jr={onSuccess:(Gr,Nr,Lr,Ur)=>{this.log(`Loaded steering manifest: "${Pr}"`);const Vr=Gr.data;if(Vr.VERSION!==1){this.log(`Steering VERSION ${Vr.VERSION} not supported!`);return}this.updated=performance.now(),this.timeToLoad=Vr.TTL;const{"RELOAD-URI":Wr,"PATHWAY-CLONES":qr,"PATHWAY-PRIORITY":Kr}=Vr;if(Wr)try{this.uri=new self.URL(Wr,Pr).href}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest RELOAD-URI: ${Wr}`);return}this.scheduleRefresh(this.uri||Lr.url),qr&&this.clonePathways(qr),Kr&&this.updatePathwayPriority(Kr)},onError:(Gr,Nr,Lr,Ur)=>{if(this.log(`Error loading steering manifest: ${Gr.code} ${Gr.text} (${Nr.url})`),this.stopLoad(),Gr.code===410){this.enabled=!1,this.log(`Steering manifest ${Nr.url} no longer available`);return}let Vr=this.timeToLoad*1e3;if(Gr.code===429){const Wr=this.loader;if(typeof(Wr==null?void 0:Wr.getResponseHeader)=="function"){const qr=Wr.getResponseHeader("Retry-After");qr&&(Vr=parseFloat(qr)*1e3)}this.log(`Steering manifest ${Nr.url} rate limited`);return}this.scheduleRefresh(this.uri||Nr.url,Vr)},onTimeout:(Gr,Nr,Lr)=>{this.log(`Timeout loading steering manifest (${Nr.url})`),this.scheduleRefresh(this.uri||Nr.url)}};this.log(`Requesting steering manifest: ${Pr}`),this.loader.load(Dr,zr,jr)}scheduleRefresh(Tr,Ar=this.timeToLoad*1e3){self.clearTimeout(this.reloadTimer),this.reloadTimer=self.setTimeout(()=>{this.loadSteeringManifest(Tr)},Ar)}}function cloneRenditionGroups(_r,Tr,Ar,Rr){_r&&Object.keys(Tr).forEach(Pr=>{const Dr=_r.filter(Mr=>Mr.groupId===Pr).map(Mr=>{const Fr=_extends({},Mr);return Fr.details=void 0,Fr.attrs=new AttrList(Fr.attrs),Fr.url=Fr.attrs.URI=performUriReplacement(Mr.url,Mr.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",Ar),Fr.groupId=Fr.attrs["GROUP-ID"]=Tr[Pr],Fr.attrs["PATHWAY-ID"]=Rr,Fr});_r.push(...Dr)})}function performUriReplacement(_r,Tr,Ar,Rr){const{HOST:Pr,PARAMS:Dr,[Ar]:Mr}=Rr;let Fr;Tr&&(Fr=Mr==null?void 0:Mr[Tr],Fr&&(_r=Fr));const zr=new self.URL(_r);return Pr&&!Fr&&(zr.host=Pr),Dr&&Object.keys(Dr).sort().forEach(jr=>{jr&&zr.searchParams.set(jr,Dr[jr])}),zr.href}const AGE_HEADER_LINE_REGEX=/^age:\s*[\d.]+\s*$/im;class XhrLoader{constructor(Tr){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=void 0,this.loader=null,this.stats=void 0,this.xhrSetup=Tr&&Tr.xhrSetup||null,this.stats=new LoadStats,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null}abortInternal(){const Tr=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),Tr&&(Tr.onreadystatechange=null,Tr.onprogress=null,Tr.readyState!==4&&(this.stats.aborted=!0,Tr.abort()))}abort(){var Tr;this.abortInternal(),(Tr=this.callbacks)!=null&&Tr.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(Tr,Ar,Rr){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=Tr,this.config=Ar,this.callbacks=Rr,this.loadInternal()}loadInternal(){const{config:Tr,context:Ar}=this;if(!Tr)return;const Rr=this.loader=new self.XMLHttpRequest,Pr=this.stats;Pr.loading.first=0,Pr.loaded=0,Pr.aborted=!1;const Dr=this.xhrSetup;Dr?Promise.resolve().then(()=>{if(!this.stats.aborted)return Dr(Rr,Ar.url)}).catch(Mr=>(Rr.open("GET",Ar.url,!0),Dr(Rr,Ar.url))).then(()=>{this.stats.aborted||this.openAndSendXhr(Rr,Ar,Tr)}).catch(Mr=>{this.callbacks.onError({code:Rr.status,text:Mr.message},Ar,Rr,Pr)}):this.openAndSendXhr(Rr,Ar,Tr)}openAndSendXhr(Tr,Ar,Rr){Tr.readyState||Tr.open("GET",Ar.url,!0);const Pr=this.context.headers,{maxTimeToFirstByteMs:Dr,maxLoadTimeMs:Mr}=Rr.loadPolicy;if(Pr)for(const Fr in Pr)Tr.setRequestHeader(Fr,Pr[Fr]);Ar.rangeEnd&&Tr.setRequestHeader("Range","bytes="+Ar.rangeStart+"-"+(Ar.rangeEnd-1)),Tr.onreadystatechange=this.readystatechange.bind(this),Tr.onprogress=this.loadprogress.bind(this),Tr.responseType=Ar.responseType,self.clearTimeout(this.requestTimeout),Rr.timeout=Dr&&isFiniteNumber(Dr)?Dr:Mr,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),Rr.timeout),Tr.send()}readystatechange(){const{context:Tr,loader:Ar,stats:Rr}=this;if(!Tr||!Ar)return;const Pr=Ar.readyState,Dr=this.config;if(!Rr.aborted&&Pr>=2&&(Rr.loading.first===0&&(Rr.loading.first=Math.max(self.performance.now(),Rr.loading.start),Dr.timeout!==Dr.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),Dr.timeout=Dr.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),Dr.loadPolicy.maxLoadTimeMs-(Rr.loading.first-Rr.loading.start)))),Pr===4)){self.clearTimeout(this.requestTimeout),Ar.onreadystatechange=null,Ar.onprogress=null;const Mr=Ar.status,Fr=Ar.responseType!=="text";if(Mr>=200&&Mr<300&&(Fr&&Ar.response||Ar.responseText!==null)){Rr.loading.end=Math.max(self.performance.now(),Rr.loading.first);const zr=Fr?Ar.response:Ar.responseText,jr=Ar.responseType==="arraybuffer"?zr.byteLength:zr.length;if(Rr.loaded=Rr.total=jr,Rr.bwEstimate=Rr.total*8e3/(Rr.loading.end-Rr.loading.first),!this.callbacks)return;const Gr=this.callbacks.onProgress;if(Gr&&Gr(Rr,Tr,zr,Ar),!this.callbacks)return;const Nr={url:Ar.responseURL,data:zr,code:Mr};this.callbacks.onSuccess(Nr,Rr,Tr,Ar)}else{const zr=Dr.loadPolicy.errorRetry,jr=Rr.retry;shouldRetry(zr,jr,!1,Mr)?this.retry(zr):(logger.error(`${Mr} while loading ${Tr.url}`),this.callbacks.onError({code:Mr,text:Ar.statusText},Tr,Ar,Rr))}}}loadtimeout(){var Tr;const Ar=(Tr=this.config)==null?void 0:Tr.loadPolicy.timeoutRetry,Rr=this.stats.retry;if(shouldRetry(Ar,Rr,!0))this.retry(Ar);else{logger.warn(`timeout while loading ${this.context.url}`);const Pr=this.callbacks;Pr&&(this.abortInternal(),Pr.onTimeout(this.stats,this.context,this.loader))}}retry(Tr){const{context:Ar,stats:Rr}=this;this.retryDelay=getRetryDelay(Tr,Rr.retry),Rr.retry++,logger.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${Ar.url}, retrying ${Rr.retry}/${Tr.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(Tr){const Ar=this.stats;Ar.loaded=Tr.loaded,Tr.lengthComputable&&(Ar.total=Tr.total)}getCacheAge(){let Tr=null;if(this.loader&&AGE_HEADER_LINE_REGEX.test(this.loader.getAllResponseHeaders())){const Ar=this.loader.getResponseHeader("age");Tr=Ar?parseFloat(Ar):null}return Tr}getResponseHeader(Tr){return this.loader&&new RegExp(`^${Tr}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(Tr):null}}function fetchSupported(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch{}return!1}const BYTERANGE=/(\d+)-(\d+)\/(\d+)/;class FetchLoader{constructor(Tr){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=void 0,this.response=void 0,this.controller=void 0,this.context=void 0,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=Tr.fetchSetup||getRequest,this.controller=new self.AbortController,this.stats=new LoadStats}destroy(){this.loader=this.callbacks=null,this.abortInternal()}abortInternal(){const Tr=this.response;Tr!=null&&Tr.ok||(this.stats.aborted=!0,this.controller.abort())}abort(){var Tr;this.abortInternal(),(Tr=this.callbacks)!=null&&Tr.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(Tr,Ar,Rr){const Pr=this.stats;if(Pr.loading.start)throw new Error("Loader can only be used once.");Pr.loading.start=self.performance.now();const Dr=getRequestParameters(Tr,this.controller.signal),Mr=Rr.onProgress,Fr=Tr.responseType==="arraybuffer",zr=Fr?"byteLength":"length",{maxTimeToFirstByteMs:jr,maxLoadTimeMs:Gr}=Ar.loadPolicy;this.context=Tr,this.config=Ar,this.callbacks=Rr,this.request=this.fetchSetup(Tr,Dr),self.clearTimeout(this.requestTimeout),Ar.timeout=jr&&isFiniteNumber(jr)?jr:Gr,this.requestTimeout=self.setTimeout(()=>{this.abortInternal(),Rr.onTimeout(Pr,Tr,this.response)},Ar.timeout),self.fetch(this.request).then(Nr=>{this.response=this.loader=Nr;const Lr=Math.max(self.performance.now(),Pr.loading.start);if(self.clearTimeout(this.requestTimeout),Ar.timeout=Gr,this.requestTimeout=self.setTimeout(()=>{this.abortInternal(),Rr.onTimeout(Pr,Tr,this.response)},Gr-(Lr-Pr.loading.start)),!Nr.ok){const{status:Ur,statusText:Vr}=Nr;throw new FetchError(Vr||"fetch, bad network response",Ur,Nr)}return Pr.loading.first=Lr,Pr.total=getContentLength(Nr.headers)||Pr.total,Mr&&isFiniteNumber(Ar.highWaterMark)?this.loadProgressively(Nr,Pr,Tr,Ar.highWaterMark,Mr):Fr?Nr.arrayBuffer():Tr.responseType==="json"?Nr.json():Nr.text()}).then(Nr=>{const{response:Lr}=this;self.clearTimeout(this.requestTimeout),Pr.loading.end=Math.max(self.performance.now(),Pr.loading.first);const Ur=Nr[zr];Ur&&(Pr.loaded=Pr.total=Ur);const Vr={url:Lr.url,data:Nr,code:Lr.status};Mr&&!isFiniteNumber(Ar.highWaterMark)&&Mr(Pr,Tr,Nr,Lr),Rr.onSuccess(Vr,Pr,Tr,Lr)}).catch(Nr=>{if(self.clearTimeout(this.requestTimeout),Pr.aborted)return;const Lr=Nr&&Nr.code||0,Ur=Nr?Nr.message:null;Rr.onError({code:Lr,text:Ur},Tr,Nr?Nr.details:null,Pr)})}getCacheAge(){let Tr=null;if(this.response){const Ar=this.response.headers.get("age");Tr=Ar?parseFloat(Ar):null}return Tr}getResponseHeader(Tr){return this.response?this.response.headers.get(Tr):null}loadProgressively(Tr,Ar,Rr,Pr=0,Dr){const Mr=new ChunkCache,Fr=Tr.body.getReader(),zr=()=>Fr.read().then(jr=>{if(jr.done)return Mr.dataLength&&Dr(Ar,Rr,Mr.flush(),Tr),Promise.resolve(new ArrayBuffer(0));const Gr=jr.value,Nr=Gr.length;return Ar.loaded+=Nr,Nr<Pr||Mr.dataLength?(Mr.push(Gr),Mr.dataLength>=Pr&&Dr(Ar,Rr,Mr.flush(),Tr)):Dr(Ar,Rr,Gr,Tr),zr()}).catch(()=>Promise.reject());return zr()}}function getRequestParameters(_r,Tr){const Ar={method:"GET",mode:"cors",credentials:"same-origin",signal:Tr,headers:new self.Headers(_extends({},_r.headers))};return _r.rangeEnd&&Ar.headers.set("Range","bytes="+_r.rangeStart+"-"+String(_r.rangeEnd-1)),Ar}function getByteRangeLength(_r){const Tr=BYTERANGE.exec(_r);if(Tr)return parseInt(Tr[2])-parseInt(Tr[1])+1}function getContentLength(_r){const Tr=_r.get("Content-Range");if(Tr){const Rr=getByteRangeLength(Tr);if(isFiniteNumber(Rr))return Rr}const Ar=_r.get("Content-Length");if(Ar)return parseInt(Ar)}function getRequest(_r,Tr){return new self.Request(_r.url,Tr)}class FetchError extends Error{constructor(Tr,Ar,Rr){super(Tr),this.code=void 0,this.details=void 0,this.code=Ar,this.details=Rr}}const WHITESPACE_CHAR=/\s/,Cues={newCue(_r,Tr,Ar,Rr){const Pr=[];let Dr,Mr,Fr,zr,jr;const Gr=self.VTTCue||self.TextTrackCue;for(let Lr=0;Lr<Rr.rows.length;Lr++)if(Dr=Rr.rows[Lr],Fr=!0,zr=0,jr="",!Dr.isEmpty()){var Nr;for(let Wr=0;Wr<Dr.chars.length;Wr++)WHITESPACE_CHAR.test(Dr.chars[Wr].uchar)&&Fr?zr++:(jr+=Dr.chars[Wr].uchar,Fr=!1);Dr.cueStartTime=Tr,Tr===Ar&&(Ar+=1e-4),zr>=16?zr--:zr++;const Ur=fixLineBreaks(jr.trim()),Vr=generateCueId(Tr,Ar,Ur);_r!=null&&(Nr=_r.cues)!=null&&Nr.getCueById(Vr)||(Mr=new Gr(Tr,Ar,Ur),Mr.id=Vr,Mr.line=Lr+1,Mr.align="left",Mr.position=10+Math.min(80,Math.floor(zr*8/32)*10),Pr.push(Mr))}return _r&&Pr.length&&(Pr.sort((Lr,Ur)=>Lr.line==="auto"||Ur.line==="auto"?0:Lr.line>8&&Ur.line>8?Ur.line-Lr.line:Lr.line-Ur.line),Pr.forEach(Lr=>addCueToTrack(_r,Lr))),Pr}},defaultLoadPolicy={maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null},hlsDefaultConfig=_objectSpread2(_objectSpread2({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,maxBufferSize:60*1e3*1e3,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:XhrLoader,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:AbrController,bufferController:BufferController,capLevelController:CapLevelController,errorController:ErrorController,fpsController:FPSController,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:requestMediaKeySystemAccess,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableID3MetadataCues:!0,certLoadPolicy:{default:defaultLoadPolicy},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},timelineConfig()),{},{subtitleStreamController:SubtitleStreamController,subtitleTrackController:SubtitleTrackController,timelineController:TimelineController,audioStreamController:AudioStreamController,audioTrackController:AudioTrackController,emeController:EMEController,cmcdController:CMCDController,contentSteeringController:ContentSteeringController});function timelineConfig(){return{cueHandler:Cues,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function mergeConfig(_r,Tr){if((Tr.liveSyncDurationCount||Tr.liveMaxLatencyDurationCount)&&(Tr.liveSyncDuration||Tr.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(Tr.liveMaxLatencyDurationCount!==void 0&&(Tr.liveSyncDurationCount===void 0||Tr.liveMaxLatencyDurationCount<=Tr.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(Tr.liveMaxLatencyDuration!==void 0&&(Tr.liveSyncDuration===void 0||Tr.liveMaxLatencyDuration<=Tr.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');const Ar=deepCpy(_r),Rr=["manifest","level","frag"],Pr=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return Rr.forEach(Dr=>{const Mr=`${Dr==="level"?"playlist":Dr}LoadPolicy`,Fr=Tr[Mr]===void 0,zr=[];Pr.forEach(jr=>{const Gr=`${Dr}Loading${jr}`,Nr=Tr[Gr];if(Nr!==void 0&&Fr){zr.push(Gr);const Lr=Ar[Mr].default;switch(Tr[Mr]={default:Lr},jr){case"TimeOut":Lr.maxLoadTimeMs=Nr,Lr.maxTimeToFirstByteMs=Nr;break;case"MaxRetry":Lr.errorRetry.maxNumRetry=Nr,Lr.timeoutRetry.maxNumRetry=Nr;break;case"RetryDelay":Lr.errorRetry.retryDelayMs=Nr,Lr.timeoutRetry.retryDelayMs=Nr;break;case"MaxRetryTimeout":Lr.errorRetry.maxRetryDelayMs=Nr,Lr.timeoutRetry.maxRetryDelayMs=Nr;break}}}),zr.length&&logger.warn(`hls.js config: "${zr.join('", "')}" setting(s) are deprecated, use "${Mr}": ${JSON.stringify(Tr[Mr])}`)}),_objectSpread2(_objectSpread2({},Ar),Tr)}function deepCpy(_r){return _r&&typeof _r=="object"?Array.isArray(_r)?_r.map(deepCpy):Object.keys(_r).reduce((Tr,Ar)=>(Tr[Ar]=deepCpy(_r[Ar]),Tr),{}):_r}function enableStreamingMode(_r){const Tr=_r.loader;Tr!==FetchLoader&&Tr!==XhrLoader?(logger.log("[config]: Custom loader detected, cannot enable progressive streaming"),_r.progressive=!1):fetchSupported()&&(_r.loader=FetchLoader,_r.progressive=!0,_r.enableSoftwareAES=!0,logger.log("[config]: Progressive streaming enabled, using FetchLoader"))}class Hls{static get version(){return"1.4.12"}static isSupported(){return isSupported()}static get Events(){return Events}static get ErrorTypes(){return ErrorTypes}static get ErrorDetails(){return ErrorDetails}static get DefaultConfig(){return Hls.defaultConfig?Hls.defaultConfig:hlsDefaultConfig}static set DefaultConfig(Tr){Hls.defaultConfig=Tr}constructor(Tr={}){this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new EventEmitter,this._autoLevelCapping=void 0,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this.url=null,enableLogs(Tr.debug||!1,"Hls instance");const Ar=this.config=mergeConfig(Hls.DefaultConfig,Tr);this.userConfig=Tr,this._autoLevelCapping=-1,Ar.progressive&&enableStreamingMode(Ar);const{abrController:Rr,bufferController:Pr,capLevelController:Dr,errorController:Mr,fpsController:Fr}=Ar,zr=new Mr(this),jr=this.abrController=new Rr(this),Gr=this.bufferController=new Pr(this),Nr=this.capLevelController=new Dr(this),Lr=new Fr(this),Ur=new PlaylistLoader(this),Vr=new ID3TrackController(this),Wr=Ar.contentSteeringController,qr=Wr?new Wr(this):null,Kr=this.levelController=new LevelController(this,qr),Xr=new FragmentTracker(this),Zr=new KeyLoader(this.config),_i=this.streamController=new StreamController(this,Xr,Zr);Nr.setStreamController(_i),Lr.setStreamController(_i);const Jr=[Ur,Kr,_i];qr&&Jr.splice(1,0,qr),this.networkControllers=Jr;const es=[jr,Gr,Nr,Lr,Vr,Xr];this.audioTrackController=this.createController(Ar.audioTrackController,Jr);const ts=Ar.audioStreamController;ts&&Jr.push(new ts(this,Xr,Zr)),this.subtitleTrackController=this.createController(Ar.subtitleTrackController,Jr);const is=Ar.subtitleStreamController;is&&Jr.push(new is(this,Xr,Zr)),this.createController(Ar.timelineController,es),Zr.emeController=this.emeController=this.createController(Ar.emeController,es),this.cmcdController=this.createController(Ar.cmcdController,es),this.latencyController=this.createController(LatencyController,es),this.coreComponents=es,Jr.push(zr);const rs=zr.onErrorOut;typeof rs=="function"&&this.on(Events.ERROR,rs,zr)}createController(Tr,Ar){if(Tr){const Rr=new Tr(this);return Ar&&Ar.push(Rr),Rr}return null}on(Tr,Ar,Rr=this){this._emitter.on(Tr,Ar,Rr)}once(Tr,Ar,Rr=this){this._emitter.once(Tr,Ar,Rr)}removeAllListeners(Tr){this._emitter.removeAllListeners(Tr)}off(Tr,Ar,Rr=this,Pr){this._emitter.off(Tr,Ar,Rr,Pr)}listeners(Tr){return this._emitter.listeners(Tr)}emit(Tr,Ar,Rr){return this._emitter.emit(Tr,Ar,Rr)}trigger(Tr,Ar){if(this.config.debug)return this.emit(Tr,Tr,Ar);try{return this.emit(Tr,Tr,Ar)}catch(Rr){logger.error("An internal error happened while handling event "+Tr+'. Error message: "'+Rr.message+'". Here is a stacktrace:',Rr),this.trigger(Events.ERROR,{type:ErrorTypes.OTHER_ERROR,details:ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:Tr,error:Rr})}return!1}listenerCount(Tr){return this._emitter.listenerCount(Tr)}destroy(){logger.log("destroy"),this.trigger(Events.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers.forEach(Ar=>Ar.destroy()),this.networkControllers.length=0,this.coreComponents.forEach(Ar=>Ar.destroy()),this.coreComponents.length=0;const Tr=this.config;Tr.xhrSetup=Tr.fetchSetup=void 0,this.userConfig=null}attachMedia(Tr){logger.log("attachMedia"),this._media=Tr,this.trigger(Events.MEDIA_ATTACHING,{media:Tr})}detachMedia(){logger.log("detachMedia"),this.trigger(Events.MEDIA_DETACHING,void 0),this._media=null}loadSource(Tr){this.stopLoad();const Ar=this.media,Rr=this.url,Pr=this.url=urlToolkitExports.buildAbsoluteURL(self.location.href,Tr,{alwaysNormalize:!0});logger.log(`loadSource:${Pr}`),Ar&&Rr&&(Rr!==Pr||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(Ar)),this.trigger(Events.MANIFEST_LOADING,{url:Tr})}startLoad(Tr=-1){logger.log(`startLoad(${Tr})`),this.networkControllers.forEach(Ar=>{Ar.startLoad(Tr)})}stopLoad(){logger.log("stopLoad"),this.networkControllers.forEach(Tr=>{Tr.stopLoad()})}swapAudioCodec(){logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){logger.log("recoverMediaError");const Tr=this._media;this.detachMedia(),Tr&&this.attachMedia(Tr)}removeLevel(Tr,Ar=0){this.levelController.removeLevel(Tr,Ar)}get levels(){const Tr=this.levelController.levels;return Tr||[]}get currentLevel(){return this.streamController.currentLevel}set currentLevel(Tr){logger.log(`set currentLevel:${Tr}`),this.loadLevel=Tr,this.abrController.clearTimer(),this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(Tr){logger.log(`set nextLevel:${Tr}`),this.levelController.manualLevel=Tr,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(Tr){logger.log(`set loadLevel:${Tr}`),this.levelController.manualLevel=Tr}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(Tr){this.levelController.nextLoadLevel=Tr}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(Tr){logger.log(`set firstLevel:${Tr}`),this.levelController.firstLevel=Tr}get startLevel(){return this.levelController.startLevel}set startLevel(Tr){logger.log(`set startLevel:${Tr}`),Tr!==-1&&(Tr=Math.max(Tr,this.minAutoLevel)),this.levelController.startLevel=Tr}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(Tr){const Ar=!!Tr;Ar!==this.config.capLevelToPlayerSize&&(Ar?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=Ar)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){const{bwEstimator:Tr}=this.abrController;return Tr?Tr.getEstimate():NaN}get ttfbEstimate(){const{bwEstimator:Tr}=this.abrController;return Tr?Tr.getEstimateTTFB():NaN}set autoLevelCapping(Tr){this._autoLevelCapping!==Tr&&(logger.log(`set autoLevelCapping:${Tr}`),this._autoLevelCapping=Tr)}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(Tr){HdcpLevels.indexOf(Tr)>-1&&(this._maxHdcpLevel=Tr)}get autoLevelEnabled(){return this.levelController.manualLevel===-1}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){const{levels:Tr,config:{minAutoBitrate:Ar}}=this;if(!Tr)return 0;const Rr=Tr.length;for(let Pr=0;Pr<Rr;Pr++)if(Tr[Pr].maxBitrate>=Ar)return Pr;return 0}get maxAutoLevel(){const{levels:Tr,autoLevelCapping:Ar,maxHdcpLevel:Rr}=this;let Pr;if(Ar===-1&&Tr&&Tr.length?Pr=Tr.length-1:Pr=Ar,Rr)for(let Dr=Pr;Dr--;){const Mr=Tr[Dr].attrs["HDCP-LEVEL"];if(Mr&&Mr<=Rr)return Dr}return Pr}get nextAutoLevel(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)}set nextAutoLevel(Tr){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,Tr)}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}get audioTracks(){const Tr=this.audioTrackController;return Tr?Tr.audioTracks:[]}get audioTrack(){const Tr=this.audioTrackController;return Tr?Tr.audioTrack:-1}set audioTrack(Tr){const Ar=this.audioTrackController;Ar&&(Ar.audioTrack=Tr)}get subtitleTracks(){const Tr=this.subtitleTrackController;return Tr?Tr.subtitleTracks:[]}get subtitleTrack(){const Tr=this.subtitleTrackController;return Tr?Tr.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(Tr){const Ar=this.subtitleTrackController;Ar&&(Ar.subtitleTrack=Tr)}get subtitleDisplay(){const Tr=this.subtitleTrackController;return Tr?Tr.subtitleDisplay:!1}set subtitleDisplay(Tr){const Ar=this.subtitleTrackController;Ar&&(Ar.subtitleDisplay=Tr)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(Tr){this.config.lowLatencyMode=Tr}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}}Hls.defaultConfig=void 0;let getRandomValues;const rnds8=new Uint8Array(16);function rng(){if(!getRandomValues&&(getRandomValues=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!getRandomValues))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return getRandomValues(rnds8)}const byteToHex=[];for(let _r=0;_r<256;++_r)byteToHex.push((_r+256).toString(16).slice(1));function unsafeStringify(_r,Tr=0){return byteToHex[_r[Tr+0]]+byteToHex[_r[Tr+1]]+byteToHex[_r[Tr+2]]+byteToHex[_r[Tr+3]]+"-"+byteToHex[_r[Tr+4]]+byteToHex[_r[Tr+5]]+"-"+byteToHex[_r[Tr+6]]+byteToHex[_r[Tr+7]]+"-"+byteToHex[_r[Tr+8]]+byteToHex[_r[Tr+9]]+"-"+byteToHex[_r[Tr+10]]+byteToHex[_r[Tr+11]]+byteToHex[_r[Tr+12]]+byteToHex[_r[Tr+13]]+byteToHex[_r[Tr+14]]+byteToHex[_r[Tr+15]]}const randomUUID=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),native={randomUUID};function v4(_r,Tr,Ar){if(native.randomUUID&&!Tr&&!_r)return native.randomUUID();_r=_r||{};const Rr=_r.random||(_r.rng||rng)();if(Rr[6]=Rr[6]&15|64,Rr[8]=Rr[8]&63|128,Tr){Ar=Ar||0;for(let Pr=0;Pr<16;++Pr)Tr[Ar+Pr]=Rr[Pr];return Tr}return unsafeStringify(Rr)}function $db6c3485150b8e66$export$1ab7ae714698c4b8(_r){const[Tr,Ar]=reactExports.useState(void 0);return $9f79659886946c16$export$e5c5a5f917a5871c(()=>{if(_r){Ar({width:_r.offsetWidth,height:_r.offsetHeight});const Rr=new ResizeObserver(Pr=>{if(!Array.isArray(Pr)||!Pr.length)return;const Dr=Pr[0];let Mr,Fr;if("borderBoxSize"in Dr){const zr=Dr.borderBoxSize,jr=Array.isArray(zr)?zr[0]:zr;Mr=jr.inlineSize,Fr=jr.blockSize}else Mr=_r.offsetWidth,Fr=_r.offsetHeight;Ar({width:Mr,height:Fr})});return Rr.observe(_r,{box:"border-box"}),()=>Rr.unobserve(_r)}else Ar(void 0)},[_r]),Tr}function $010c2913dbd2fe3d$export$5cae361ad82dce8b(_r){const Tr=reactExports.useRef({value:_r,previous:_r});return reactExports.useMemo(()=>(Tr.current.value!==_r&&(Tr.current.previous=Tr.current.value,Tr.current.value=_r),Tr.current.previous),[_r])}const $ce77a8961b41be9e$var$RADIO_NAME="Radio",[$ce77a8961b41be9e$var$createRadioContext,$ce77a8961b41be9e$export$67d2296460f1b002]=$c512c27ab02ef895$export$50c7b4e9d9f19c1($ce77a8961b41be9e$var$RADIO_NAME),[$ce77a8961b41be9e$var$RadioProvider,$ce77a8961b41be9e$var$useRadioContext]=$ce77a8961b41be9e$var$createRadioContext($ce77a8961b41be9e$var$RADIO_NAME),$ce77a8961b41be9e$export$d7b12c4107be0d61=reactExports.forwardRef((_r,Tr)=>{const{__scopeRadio:Ar,name:Rr,checked:Pr=!1,required:Dr,disabled:Mr,value:Fr="on",onCheck:zr,...jr}=_r,[Gr,Nr]=reactExports.useState(null),Lr=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(Tr,Wr=>Nr(Wr)),Ur=reactExports.useRef(!1),Vr=Gr?!!Gr.closest("form"):!0;return reactExports.createElement($ce77a8961b41be9e$var$RadioProvider,{scope:Ar,checked:Pr,disabled:Mr},reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.button,_extends$1({type:"button",role:"radio","aria-checked":Pr,"data-state":$ce77a8961b41be9e$var$getState(Pr),"data-disabled":Mr?"":void 0,disabled:Mr,value:Fr},jr,{ref:Lr,onClick:$e42e1063c40fb3ef$export$b9ecd428b558ff10(_r.onClick,Wr=>{Pr||zr==null||zr(),Vr&&(Ur.current=Wr.isPropagationStopped(),Ur.current||Wr.stopPropagation())})})),Vr&&reactExports.createElement($ce77a8961b41be9e$var$BubbleInput,{control:Gr,bubbles:!Ur.current,name:Rr,value:Fr,checked:Pr,required:Dr,disabled:Mr,style:{transform:"translateX(-100%)"}}))}),$ce77a8961b41be9e$var$BubbleInput=_r=>{const{control:Tr,checked:Ar,bubbles:Rr=!0,...Pr}=_r,Dr=reactExports.useRef(null),Mr=$010c2913dbd2fe3d$export$5cae361ad82dce8b(Ar),Fr=$db6c3485150b8e66$export$1ab7ae714698c4b8(Tr);return reactExports.useEffect(()=>{const zr=Dr.current,jr=window.HTMLInputElement.prototype,Nr=Object.getOwnPropertyDescriptor(jr,"checked").set;if(Mr!==Ar&&Nr){const Lr=new Event("click",{bubbles:Rr});Nr.call(zr,Ar),zr.dispatchEvent(Lr)}},[Mr,Ar,Rr]),reactExports.createElement("input",_extends$1({type:"radio","aria-hidden":!0,defaultChecked:Ar},Pr,{tabIndex:-1,ref:Dr,style:{..._r.style,...Fr,position:"absolute",pointerEvents:"none",opacity:0,margin:0}}))};function $ce77a8961b41be9e$var$getState(_r){return _r?"checked":"unchecked"}const $f99a8c78507165f7$var$ARROW_KEYS=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],$f99a8c78507165f7$var$RADIO_GROUP_NAME="RadioGroup",[$f99a8c78507165f7$var$createRadioGroupContext,$f99a8c78507165f7$export$c547093f11b76da2]=$c512c27ab02ef895$export$50c7b4e9d9f19c1($f99a8c78507165f7$var$RADIO_GROUP_NAME,[$d7bdfb9eb0fdf311$export$c7109489551a4f4,$ce77a8961b41be9e$export$67d2296460f1b002]),$f99a8c78507165f7$var$useRovingFocusGroupScope=$d7bdfb9eb0fdf311$export$c7109489551a4f4(),$f99a8c78507165f7$var$useRadioScope=$ce77a8961b41be9e$export$67d2296460f1b002(),[$f99a8c78507165f7$var$RadioGroupProvider,$f99a8c78507165f7$var$useRadioGroupContext]=$f99a8c78507165f7$var$createRadioGroupContext($f99a8c78507165f7$var$RADIO_GROUP_NAME),$f99a8c78507165f7$export$a98f0dcb43a68a25=reactExports.forwardRef((_r,Tr)=>{const{__scopeRadioGroup:Ar,name:Rr,defaultValue:Pr,value:Dr,required:Mr=!1,disabled:Fr=!1,orientation:zr,dir:jr,loop:Gr=!0,onValueChange:Nr,...Lr}=_r,Ur=$f99a8c78507165f7$var$useRovingFocusGroupScope(Ar),Vr=$f631663db3294ace$export$b39126d51d94e6f3(jr),[Wr,qr]=$71cd76cc60e0454e$export$6f32135080cb4c3({prop:Dr,defaultProp:Pr,onChange:Nr});return reactExports.createElement($f99a8c78507165f7$var$RadioGroupProvider,{scope:Ar,name:Rr,required:Mr,disabled:Fr,value:Wr,onValueChange:qr},reactExports.createElement($d7bdfb9eb0fdf311$export$be92b6f5f03c0fe9,_extends$1({asChild:!0},Ur,{orientation:zr,dir:Vr,loop:Gr}),reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.div,_extends$1({role:"radiogroup","aria-required":Mr,"aria-orientation":zr,"data-disabled":Fr?"":void 0,dir:Vr},Lr,{ref:Tr}))))}),$f99a8c78507165f7$var$ITEM_NAME="RadioGroupItem",$f99a8c78507165f7$export$9f866c100ef519e4=reactExports.forwardRef((_r,Tr)=>{const{__scopeRadioGroup:Ar,disabled:Rr,...Pr}=_r,Dr=$f99a8c78507165f7$var$useRadioGroupContext($f99a8c78507165f7$var$ITEM_NAME,Ar),Mr=Dr.disabled||Rr,Fr=$f99a8c78507165f7$var$useRovingFocusGroupScope(Ar),zr=$f99a8c78507165f7$var$useRadioScope(Ar),jr=reactExports.useRef(null),Gr=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(Tr,jr),Nr=Dr.value===Pr.value,Lr=reactExports.useRef(!1);return reactExports.useEffect(()=>{const Ur=Wr=>{$f99a8c78507165f7$var$ARROW_KEYS.includes(Wr.key)&&(Lr.current=!0)},Vr=()=>Lr.current=!1;return document.addEventListener("keydown",Ur),document.addEventListener("keyup",Vr),()=>{document.removeEventListener("keydown",Ur),document.removeEventListener("keyup",Vr)}},[]),reactExports.createElement($d7bdfb9eb0fdf311$export$6d08773d2e66f8f2,_extends$1({asChild:!0},Fr,{focusable:!Mr,active:Nr}),reactExports.createElement($ce77a8961b41be9e$export$d7b12c4107be0d61,_extends$1({disabled:Mr,required:Dr.required,checked:Nr},zr,Pr,{name:Dr.name,ref:Gr,onCheck:()=>Dr.onValueChange(Pr.value),onKeyDown:$e42e1063c40fb3ef$export$b9ecd428b558ff10(Ur=>{Ur.key==="Enter"&&Ur.preventDefault()}),onFocus:$e42e1063c40fb3ef$export$b9ecd428b558ff10(Pr.onFocus,()=>{var Ur;Lr.current&&((Ur=jr.current)===null||Ur===void 0||Ur.click())})})))}),$f99a8c78507165f7$export$be92b6f5f03c0fe9=$f99a8c78507165f7$export$a98f0dcb43a68a25,$f99a8c78507165f7$export$6d08773d2e66f8f2=$f99a8c78507165f7$export$9f866c100ef519e4;function ParserError(_r,Tr){this.message=_r,this.error=Tr}ParserError.prototype=Object.create(Error.prototype);const TIMESTAMP_REGEXP=/([0-9]+)?:?([0-9]{2}):([0-9]{2}\.[0-9]{2,3})/;function parse$4(_r,Tr){Tr||(Tr={});const{meta:Ar=!1,strict:Rr=!0}=Tr;if(typeof _r!="string")throw new ParserError("Input must be a string");_r=_r.trim(),_r=_r.replace(/\r\n/g,`
`),_r=_r.replace(/\r/g,`
`);const Pr=_r.split(`

`),Dr=Pr.shift();if(!Dr.startsWith("WEBVTT"))throw new ParserError('Must start with "WEBVTT"');const Mr=Dr.split(`
`),Fr=Mr[0].replace("WEBVTT","");if(Fr.length>0&&Fr[0]!==" "&&Fr[0]!=="	")throw new ParserError("Header comment must start with space or tab");if(Pr.length===0&&Mr.length===1)return{valid:!0,strict:Rr,cues:[],errors:[]};if(!Ar&&Mr.length>1&&Mr[1]!=="")throw new ParserError("Missing blank line after signature");const{cues:zr,errors:jr}=parseCues(Pr,Rr);if(Rr&&jr.length>0)throw jr[0];const Gr=Ar?parseMeta(Mr):null,Nr={valid:jr.length===0,strict:Rr,cues:zr,errors:jr};return Ar&&(Nr.meta=Gr),Nr}function parseMeta(_r){const Tr={};return _r.slice(1).forEach(Ar=>{const Rr=Ar.indexOf(":"),Pr=Ar.slice(0,Rr).trim(),Dr=Ar.slice(Rr+1).trim();Tr[Pr]=Dr}),Object.keys(Tr).length>0?Tr:null}function parseCues(_r,Tr){const Ar=[];return{cues:_r.map((Pr,Dr)=>{try{return parseCue(Pr,Dr,Tr)}catch(Mr){return Ar.push(Mr),null}}).filter(Boolean),errors:Ar}}function parseCue(_r,Tr,Ar){let Rr="",Pr=0,Dr=.01,Mr="",Fr="";const zr=_r.split(`
`).filter(Boolean);if(zr.length>0&&zr[0].trim().startsWith("NOTE"))return null;if(zr.length===1&&!zr[0].includes("-->"))throw new ParserError(`Cue identifier cannot be standalone (cue #${Tr})`);if(zr.length>1&&!(zr[0].includes("-->")||zr[1].includes("-->"))){const Gr=`Cue identifier needs to be followed by timestamp (cue #${Tr})`;throw new ParserError(Gr)}zr.length>1&&zr[1].includes("-->")&&(Rr=zr.shift());const jr=typeof zr[0]=="string"&&zr[0].split(" --> ");if(jr.length!==2||!validTimestamp(jr[0])||!validTimestamp(jr[1]))throw new ParserError(`Invalid cue timestamp (cue #${Tr})`);if(Pr=parseTimestamp(jr[0]),Dr=parseTimestamp(jr[1]),Ar){if(Pr>Dr)throw new ParserError(`Start timestamp greater than end (cue #${Tr})`);if(Dr<=Pr)throw new ParserError(`End must be greater than start (cue #${Tr})`)}if(!Ar&&Dr<Pr)throw new ParserError(`End must be greater or equal to start when not strict (cue #${Tr})`);return Fr=jr[1].replace(TIMESTAMP_REGEXP,"").trim(),zr.shift(),Mr=zr.join(`
`),Mr?{identifier:Rr,start:Pr,end:Dr,text:Mr,styles:Fr}:!1}function validTimestamp(_r){return TIMESTAMP_REGEXP.test(_r)}function parseTimestamp(_r){const Tr=_r.match(TIMESTAMP_REGEXP);let Ar=parseFloat(Tr[1]||0)*60*60;return Ar+=parseFloat(Tr[2])*60,Ar+=parseFloat(Tr[3]),Ar}var parser={ParserError,parse:parse$4};function CompilerError(_r,Tr){this.message=_r,this.error=Tr}CompilerError.prototype=Object.create(Error.prototype);function compile$1(_r){if(!_r)throw new CompilerError("Input must be non-null");if(typeof _r!="object")throw new CompilerError("Input must be an object");if(Array.isArray(_r))throw new CompilerError("Input cannot be array");if(!_r.valid)throw new CompilerError("Input must be valid");let Tr=`WEBVTT
`;if(_r.meta){if(typeof _r.meta!="object"||Array.isArray(_r.meta))throw new CompilerError("Metadata must be an object");Object.entries(_r.meta).forEach(Rr=>{if(typeof Rr[1]!="string")throw new CompilerError(`Metadata value for "${Rr[0]}" must be string`);Tr+=`${Rr[0]}: ${Rr[1]}
`})}let Ar=null;return _r.cues.forEach((Rr,Pr)=>{if(Ar&&Ar>Rr.start)throw new CompilerError(`Cue number ${Pr} is not in chronological order`);Ar=Rr.start,Tr+=`
`,Tr+=compileCue(Rr),Tr+=`
`}),Tr}function compileCue(_r){if(typeof _r!="object")throw new CompilerError("Cue malformed: not of type object");if(typeof _r.identifier!="string"&&typeof _r.identifier!="number"&&_r.identifier!==null)throw new CompilerError(`Cue malformed: identifier value is not a string.
    ${JSON.stringify(_r)}`);if(isNaN(_r.start))throw new CompilerError(`Cue malformed: null start value.
    ${JSON.stringify(_r)}`);if(isNaN(_r.end))throw new CompilerError(`Cue malformed: null end value.
    ${JSON.stringify(_r)}`);if(_r.start>=_r.end)throw new CompilerError(`Cue malformed: start timestamp greater than end
    ${JSON.stringify(_r)}`);if(typeof _r.text!="string")throw new CompilerError(`Cue malformed: null text value.
    ${JSON.stringify(_r)}`);if(typeof _r.styles!="string")throw new CompilerError(`Cue malformed: null styles value.
    ${JSON.stringify(_r)}`);let Tr="";_r.identifier.length>0&&(Tr+=`${_r.identifier}
`);const Ar=convertTimestamp(_r.start),Rr=convertTimestamp(_r.end);return Tr+=`${Ar} --> ${Rr}`,Tr+=_r.styles?` ${_r.styles}`:"",Tr+=`
${_r.text}`,Tr}function convertTimestamp(_r){const Tr=pad$1(calculateHours(_r),2),Ar=pad$1(calculateMinutes(_r),2),Rr=pad$1(calculateSeconds(_r),2),Pr=pad$1(calculateMs(_r),3);return`${Tr}:${Ar}:${Rr}.${Pr}`}function pad$1(_r,Tr){let Ar=`${_r}`;for(;Ar.length<Tr;)Ar=`0${Ar}`;return Ar}function calculateHours(_r){return Math.floor(_r/60/60)}function calculateMinutes(_r){return Math.floor(_r/60)%60}function calculateSeconds(_r){return Math.floor(_r%60)}function calculateMs(_r){return Math.floor((_r%1).toFixed(4)*1e3)}var compiler={CompilerError,compile:compile$1};const parse$3=parser.parse;function segment$2(_r,Tr){Tr=Tr||10;const Ar=parse$3(_r),Rr=[];let Pr=[],Dr=null,Mr=0,Fr=0;return Ar.cues.forEach((zr,jr)=>{const Gr=jr===0,Nr=jr===Ar.cues.length-1,Lr=zr.start,Ur=zr.end,Vr=Nr?1/0:Ar.cues[jr+1].start,Wr=Gr?Ur:Ur-Lr,qr=Gr?0:Lr-Ar.cues[jr-1].end;Mr=Mr+Wr+qr,`${jr}`,Rr.length+1,Dr&&(Pr.push(Dr),Mr+=Dr.end-Fr,Dr=null),Pr.push(zr);let Kr=Vr-Ur<Tr&&qr<Tr&&Mr>Tr;if(shouldSegment(Fr,Tr,Vr,qr)){const Xr=segmentDuration(Nr,Ur,Tr,Mr,Fr);Rr.push({duration:Xr,cues:Pr}),Fr+=Xr,Mr=0,Pr=[]}else Kr=!1;Kr&&(Dr=zr)}),Rr}function shouldSegment(_r,Tr,Ar,Rr){const Pr=alignToSegmentLength(Rr,Tr);return(Rr<=Tr||Pr+_r<Ar)&&Ar-_r>=Tr}function segmentDuration(_r,Tr,Ar,Rr,Pr){let Dr=Ar;return Rr>Ar&&(Dr=alignToSegmentLength(Rr-Ar,Ar)),_r?Dr=parseFloat((Tr-Pr).toFixed(2)):Dr=Math.round(Dr),Dr}function alignToSegmentLength(_r,Tr){return _r+=Tr-_r%Tr,_r}function debug(_r){}var segmenter={segment:segment$2};const segment$1=segmenter.segment;function hlsSegment(_r,Tr,Ar){typeof Ar>"u"&&(Ar="900000");const Rr=segment$1(_r,Tr),Pr=[];return Rr.forEach((Dr,Mr)=>{const Fr=`WEBVTT
X-TIMESTAMP-MAP=MPEGTS:${Ar},LOCAL:00:00:00.000

${printableCues(Dr.cues)}
`,zr=generateSegmentFilename(Mr);Pr.push({filename:zr,content:Fr})}),Pr}function hlsSegmentPlaylist(_r,Tr){const Ar=segment$1(_r,Tr),Rr=printableSegments(Ar);return`#EXTM3U
#EXT-X-TARGETDURATION:${Math.round(findLongestSegment(Ar))}
#EXT-X-VERSION:3
#EXT-X-MEDIA-SEQUENCE:0
#EXT-X-PLAYLIST-TYPE:VOD
${Rr}
#EXT-X-ENDLIST
`}function pad(_r,Tr){return`${"0".repeat(Math.max(0,Tr-_r.toString().length))}${_r}`}function generateSegmentFilename(_r){return`${_r}.vtt`}function printableSegments(_r){const Tr=[];return _r.forEach((Ar,Rr)=>{Tr.push(`#EXTINF:${Ar.duration.toFixed(5)},
${generateSegmentFilename(Rr)}`)}),Tr.join(`
`)}function findLongestSegment(_r){let Tr=0;return _r.forEach(Ar=>{Ar.duration>Tr&&(Tr=Ar.duration)}),Tr}function printableCues(_r){const Tr=[];return _r.forEach(Ar=>{Tr.push(printableCue(Ar))}),Tr.join(`

`)}function printableCue(_r){const Tr=[];_r.identifier&&Tr.push(_r.identifier);const Ar=printableTimestamp(_r.start),Rr=printableTimestamp(_r.end),Pr=_r.styles?`${_r.styles}`:"";return Tr.push(`${Ar} --> ${Rr} ${Pr}`),Tr.push(_r.text),Tr.join(`
`)}function printableTimestamp(_r){const Tr=(_r%1).toFixed(3);_r=Math.round(_r-Tr);const Ar=Math.floor(_r/3600),Rr=Math.floor((_r-Ar*3600)/60),Pr=_r-Ar*3600-Rr*60;return`${`${pad(Ar,2)}:`}${pad(Rr,2)}:${pad(Pr,2)}.${pad(Tr*1e3,3)}`}var hls$1={hlsSegment,hlsSegmentPlaylist};const parse$2=parser.parse,compile=compiler.compile,segment=segmenter.segment,hls=hls$1;var nodeWebvtt={parse:parse$2,compile,segment,hls};function $addc16e1bbe58fd0$export$3a72a57244d6e765(_r,Tr=globalThis==null?void 0:globalThis.document){const Ar=$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(_r);reactExports.useEffect(()=>{const Rr=Pr=>{Pr.key==="Escape"&&Ar(Pr)};return Tr.addEventListener("keydown",Rr),()=>Tr.removeEventListener("keydown",Rr)},[Ar,Tr])}const $5cb92bef7577960e$var$CONTEXT_UPDATE="dismissableLayer.update",$5cb92bef7577960e$var$POINTER_DOWN_OUTSIDE="dismissableLayer.pointerDownOutside",$5cb92bef7577960e$var$FOCUS_OUTSIDE="dismissableLayer.focusOutside";let $5cb92bef7577960e$var$originalBodyPointerEvents;const $5cb92bef7577960e$var$DismissableLayerContext=reactExports.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),$5cb92bef7577960e$export$177fb62ff3ec1f22=reactExports.forwardRef((_r,Tr)=>{var Ar;const{disableOutsidePointerEvents:Rr=!1,onEscapeKeyDown:Pr,onPointerDownOutside:Dr,onFocusOutside:Mr,onInteractOutside:Fr,onDismiss:zr,...jr}=_r,Gr=reactExports.useContext($5cb92bef7577960e$var$DismissableLayerContext),[Nr,Lr]=reactExports.useState(null),Ur=(Ar=Nr==null?void 0:Nr.ownerDocument)!==null&&Ar!==void 0?Ar:globalThis==null?void 0:globalThis.document,[,Vr]=reactExports.useState({}),Wr=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(Tr,is=>Lr(is)),qr=Array.from(Gr.layers),[Kr]=[...Gr.layersWithOutsidePointerEventsDisabled].slice(-1),Xr=qr.indexOf(Kr),Zr=Nr?qr.indexOf(Nr):-1,_i=Gr.layersWithOutsidePointerEventsDisabled.size>0,Jr=Zr>=Xr,es=$5cb92bef7577960e$var$usePointerDownOutside(is=>{const rs=is.target,as=[...Gr.branches].some(ls=>ls.contains(rs));!Jr||as||(Dr==null||Dr(is),Fr==null||Fr(is),is.defaultPrevented||zr==null||zr())},Ur),ts=$5cb92bef7577960e$var$useFocusOutside(is=>{const rs=is.target;[...Gr.branches].some(ls=>ls.contains(rs))||(Mr==null||Mr(is),Fr==null||Fr(is),is.defaultPrevented||zr==null||zr())},Ur);return $addc16e1bbe58fd0$export$3a72a57244d6e765(is=>{Zr===Gr.layers.size-1&&(Pr==null||Pr(is),!is.defaultPrevented&&zr&&(is.preventDefault(),zr()))},Ur),reactExports.useEffect(()=>{if(Nr)return Rr&&(Gr.layersWithOutsidePointerEventsDisabled.size===0&&($5cb92bef7577960e$var$originalBodyPointerEvents=Ur.body.style.pointerEvents,Ur.body.style.pointerEvents="none"),Gr.layersWithOutsidePointerEventsDisabled.add(Nr)),Gr.layers.add(Nr),$5cb92bef7577960e$var$dispatchUpdate(),()=>{Rr&&Gr.layersWithOutsidePointerEventsDisabled.size===1&&(Ur.body.style.pointerEvents=$5cb92bef7577960e$var$originalBodyPointerEvents)}},[Nr,Ur,Rr,Gr]),reactExports.useEffect(()=>()=>{Nr&&(Gr.layers.delete(Nr),Gr.layersWithOutsidePointerEventsDisabled.delete(Nr),$5cb92bef7577960e$var$dispatchUpdate())},[Nr,Gr]),reactExports.useEffect(()=>{const is=()=>Vr({});return document.addEventListener($5cb92bef7577960e$var$CONTEXT_UPDATE,is),()=>document.removeEventListener($5cb92bef7577960e$var$CONTEXT_UPDATE,is)},[]),reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.div,_extends$1({},jr,{ref:Wr,style:{pointerEvents:_i?Jr?"auto":"none":void 0,..._r.style},onFocusCapture:$e42e1063c40fb3ef$export$b9ecd428b558ff10(_r.onFocusCapture,ts.onFocusCapture),onBlurCapture:$e42e1063c40fb3ef$export$b9ecd428b558ff10(_r.onBlurCapture,ts.onBlurCapture),onPointerDownCapture:$e42e1063c40fb3ef$export$b9ecd428b558ff10(_r.onPointerDownCapture,es.onPointerDownCapture)}))});function $5cb92bef7577960e$var$usePointerDownOutside(_r,Tr=globalThis==null?void 0:globalThis.document){const Ar=$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(_r),Rr=reactExports.useRef(!1),Pr=reactExports.useRef(()=>{});return reactExports.useEffect(()=>{const Dr=Fr=>{if(Fr.target&&!Rr.current){let Gr=function(){$5cb92bef7577960e$var$handleAndDispatchCustomEvent($5cb92bef7577960e$var$POINTER_DOWN_OUTSIDE,Ar,jr,{discrete:!0})};var zr=Gr;const jr={originalEvent:Fr};Fr.pointerType==="touch"?(Tr.removeEventListener("click",Pr.current),Pr.current=Gr,Tr.addEventListener("click",Pr.current,{once:!0})):Gr()}Rr.current=!1},Mr=window.setTimeout(()=>{Tr.addEventListener("pointerdown",Dr)},0);return()=>{window.clearTimeout(Mr),Tr.removeEventListener("pointerdown",Dr),Tr.removeEventListener("click",Pr.current)}},[Tr,Ar]),{onPointerDownCapture:()=>Rr.current=!0}}function $5cb92bef7577960e$var$useFocusOutside(_r,Tr=globalThis==null?void 0:globalThis.document){const Ar=$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(_r),Rr=reactExports.useRef(!1);return reactExports.useEffect(()=>{const Pr=Dr=>{Dr.target&&!Rr.current&&$5cb92bef7577960e$var$handleAndDispatchCustomEvent($5cb92bef7577960e$var$FOCUS_OUTSIDE,Ar,{originalEvent:Dr},{discrete:!1})};return Tr.addEventListener("focusin",Pr),()=>Tr.removeEventListener("focusin",Pr)},[Tr,Ar]),{onFocusCapture:()=>Rr.current=!0,onBlurCapture:()=>Rr.current=!1}}function $5cb92bef7577960e$var$dispatchUpdate(){const _r=new CustomEvent($5cb92bef7577960e$var$CONTEXT_UPDATE);document.dispatchEvent(_r)}function $5cb92bef7577960e$var$handleAndDispatchCustomEvent(_r,Tr,Ar,{discrete:Rr}){const Pr=Ar.originalEvent.target,Dr=new CustomEvent(_r,{bubbles:!1,cancelable:!0,detail:Ar});Tr&&Pr.addEventListener(_r,Tr,{once:!0}),Rr?$8927f6f2acc4f386$export$6d1a0317bde7de7f(Pr,Dr):Pr.dispatchEvent(Dr)}let $3db38b7d1fb3fe6a$var$count=0;function $3db38b7d1fb3fe6a$export$b7ece24a22aeda8c(){reactExports.useEffect(()=>{var _r,Tr;const Ar=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",(_r=Ar[0])!==null&&_r!==void 0?_r:$3db38b7d1fb3fe6a$var$createFocusGuard()),document.body.insertAdjacentElement("beforeend",(Tr=Ar[1])!==null&&Tr!==void 0?Tr:$3db38b7d1fb3fe6a$var$createFocusGuard()),$3db38b7d1fb3fe6a$var$count++,()=>{$3db38b7d1fb3fe6a$var$count===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(Rr=>Rr.remove()),$3db38b7d1fb3fe6a$var$count--}},[])}function $3db38b7d1fb3fe6a$var$createFocusGuard(){const _r=document.createElement("span");return _r.setAttribute("data-radix-focus-guard",""),_r.tabIndex=0,_r.style.cssText="outline: none; opacity: 0; position: fixed; pointer-events: none",_r}const $d3863c46a17e8a28$var$AUTOFOCUS_ON_MOUNT="focusScope.autoFocusOnMount",$d3863c46a17e8a28$var$AUTOFOCUS_ON_UNMOUNT="focusScope.autoFocusOnUnmount",$d3863c46a17e8a28$var$EVENT_OPTIONS={bubbles:!1,cancelable:!0},$d3863c46a17e8a28$export$20e40289641fbbb6=reactExports.forwardRef((_r,Tr)=>{const{loop:Ar=!1,trapped:Rr=!1,onMountAutoFocus:Pr,onUnmountAutoFocus:Dr,...Mr}=_r,[Fr,zr]=reactExports.useState(null),jr=$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(Pr),Gr=$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(Dr),Nr=reactExports.useRef(null),Lr=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(Tr,Wr=>zr(Wr)),Ur=reactExports.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;reactExports.useEffect(()=>{if(Rr){let Xr=function(es){if(Ur.paused||!Fr)return;const ts=es.target;Fr.contains(ts)?Nr.current=ts:$d3863c46a17e8a28$var$focus(Nr.current,{select:!0})},Zr=function(es){if(Ur.paused||!Fr)return;const ts=es.relatedTarget;ts!==null&&(Fr.contains(ts)||$d3863c46a17e8a28$var$focus(Nr.current,{select:!0}))},_i=function(es){const ts=document.activeElement;for(const is of es)is.removedNodes.length>0&&(Fr!=null&&Fr.contains(ts)||$d3863c46a17e8a28$var$focus(Fr))};var Wr=Xr,qr=Zr,Kr=_i;document.addEventListener("focusin",Xr),document.addEventListener("focusout",Zr);const Jr=new MutationObserver(_i);return Fr&&Jr.observe(Fr,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",Xr),document.removeEventListener("focusout",Zr),Jr.disconnect()}}},[Rr,Fr,Ur.paused]),reactExports.useEffect(()=>{if(Fr){$d3863c46a17e8a28$var$focusScopesStack.add(Ur);const Wr=document.activeElement;if(!Fr.contains(Wr)){const Kr=new CustomEvent($d3863c46a17e8a28$var$AUTOFOCUS_ON_MOUNT,$d3863c46a17e8a28$var$EVENT_OPTIONS);Fr.addEventListener($d3863c46a17e8a28$var$AUTOFOCUS_ON_MOUNT,jr),Fr.dispatchEvent(Kr),Kr.defaultPrevented||($d3863c46a17e8a28$var$focusFirst($d3863c46a17e8a28$var$removeLinks($d3863c46a17e8a28$var$getTabbableCandidates(Fr)),{select:!0}),document.activeElement===Wr&&$d3863c46a17e8a28$var$focus(Fr))}return()=>{Fr.removeEventListener($d3863c46a17e8a28$var$AUTOFOCUS_ON_MOUNT,jr),setTimeout(()=>{const Kr=new CustomEvent($d3863c46a17e8a28$var$AUTOFOCUS_ON_UNMOUNT,$d3863c46a17e8a28$var$EVENT_OPTIONS);Fr.addEventListener($d3863c46a17e8a28$var$AUTOFOCUS_ON_UNMOUNT,Gr),Fr.dispatchEvent(Kr),Kr.defaultPrevented||$d3863c46a17e8a28$var$focus(Wr??document.body,{select:!0}),Fr.removeEventListener($d3863c46a17e8a28$var$AUTOFOCUS_ON_UNMOUNT,Gr),$d3863c46a17e8a28$var$focusScopesStack.remove(Ur)},0)}}},[Fr,jr,Gr,Ur]);const Vr=reactExports.useCallback(Wr=>{if(!Ar&&!Rr||Ur.paused)return;const qr=Wr.key==="Tab"&&!Wr.altKey&&!Wr.ctrlKey&&!Wr.metaKey,Kr=document.activeElement;if(qr&&Kr){const Xr=Wr.currentTarget,[Zr,_i]=$d3863c46a17e8a28$var$getTabbableEdges(Xr);Zr&&_i?!Wr.shiftKey&&Kr===_i?(Wr.preventDefault(),Ar&&$d3863c46a17e8a28$var$focus(Zr,{select:!0})):Wr.shiftKey&&Kr===Zr&&(Wr.preventDefault(),Ar&&$d3863c46a17e8a28$var$focus(_i,{select:!0})):Kr===Xr&&Wr.preventDefault()}},[Ar,Rr,Ur.paused]);return reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.div,_extends$1({tabIndex:-1},Mr,{ref:Lr,onKeyDown:Vr}))});function $d3863c46a17e8a28$var$focusFirst(_r,{select:Tr=!1}={}){const Ar=document.activeElement;for(const Rr of _r)if($d3863c46a17e8a28$var$focus(Rr,{select:Tr}),document.activeElement!==Ar)return}function $d3863c46a17e8a28$var$getTabbableEdges(_r){const Tr=$d3863c46a17e8a28$var$getTabbableCandidates(_r),Ar=$d3863c46a17e8a28$var$findVisible(Tr,_r),Rr=$d3863c46a17e8a28$var$findVisible(Tr.reverse(),_r);return[Ar,Rr]}function $d3863c46a17e8a28$var$getTabbableCandidates(_r){const Tr=[],Ar=document.createTreeWalker(_r,NodeFilter.SHOW_ELEMENT,{acceptNode:Rr=>{const Pr=Rr.tagName==="INPUT"&&Rr.type==="hidden";return Rr.disabled||Rr.hidden||Pr?NodeFilter.FILTER_SKIP:Rr.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;Ar.nextNode();)Tr.push(Ar.currentNode);return Tr}function $d3863c46a17e8a28$var$findVisible(_r,Tr){for(const Ar of _r)if(!$d3863c46a17e8a28$var$isHidden(Ar,{upTo:Tr}))return Ar}function $d3863c46a17e8a28$var$isHidden(_r,{upTo:Tr}){if(getComputedStyle(_r).visibility==="hidden")return!0;for(;_r;){if(Tr!==void 0&&_r===Tr)return!1;if(getComputedStyle(_r).display==="none")return!0;_r=_r.parentElement}return!1}function $d3863c46a17e8a28$var$isSelectableInput(_r){return _r instanceof HTMLInputElement&&"select"in _r}function $d3863c46a17e8a28$var$focus(_r,{select:Tr=!1}={}){if(_r&&_r.focus){const Ar=document.activeElement;_r.focus({preventScroll:!0}),_r!==Ar&&$d3863c46a17e8a28$var$isSelectableInput(_r)&&Tr&&_r.select()}}const $d3863c46a17e8a28$var$focusScopesStack=$d3863c46a17e8a28$var$createFocusScopesStack();function $d3863c46a17e8a28$var$createFocusScopesStack(){let _r=[];return{add(Tr){const Ar=_r[0];Tr!==Ar&&(Ar==null||Ar.pause()),_r=$d3863c46a17e8a28$var$arrayRemove(_r,Tr),_r.unshift(Tr)},remove(Tr){var Ar;_r=$d3863c46a17e8a28$var$arrayRemove(_r,Tr),(Ar=_r[0])===null||Ar===void 0||Ar.resume()}}}function $d3863c46a17e8a28$var$arrayRemove(_r,Tr){const Ar=[..._r],Rr=Ar.indexOf(Tr);return Rr!==-1&&Ar.splice(Rr,1),Ar}function $d3863c46a17e8a28$var$removeLinks(_r){return _r.filter(Tr=>Tr.tagName!=="A")}const sides=["top","right","bottom","left"],min=Math.min,max=Math.max,round=Math.round,floor=Math.floor,createCoords=_r=>({x:_r,y:_r}),oppositeSideMap={left:"right",right:"left",bottom:"top",top:"bottom"},oppositeAlignmentMap={start:"end",end:"start"};function clamp(_r,Tr,Ar){return max(_r,min(Tr,Ar))}function evaluate(_r,Tr){return typeof _r=="function"?_r(Tr):_r}function getSide(_r){return _r.split("-")[0]}function getAlignment(_r){return _r.split("-")[1]}function getOppositeAxis(_r){return _r==="x"?"y":"x"}function getAxisLength(_r){return _r==="y"?"height":"width"}function getSideAxis(_r){return["top","bottom"].includes(getSide(_r))?"y":"x"}function getAlignmentAxis(_r){return getOppositeAxis(getSideAxis(_r))}function getAlignmentSides(_r,Tr,Ar){Ar===void 0&&(Ar=!1);const Rr=getAlignment(_r),Pr=getAlignmentAxis(_r),Dr=getAxisLength(Pr);let Mr=Pr==="x"?Rr===(Ar?"end":"start")?"right":"left":Rr==="start"?"bottom":"top";return Tr.reference[Dr]>Tr.floating[Dr]&&(Mr=getOppositePlacement(Mr)),[Mr,getOppositePlacement(Mr)]}function getExpandedPlacements(_r){const Tr=getOppositePlacement(_r);return[getOppositeAlignmentPlacement(_r),Tr,getOppositeAlignmentPlacement(Tr)]}function getOppositeAlignmentPlacement(_r){return _r.replace(/start|end/g,Tr=>oppositeAlignmentMap[Tr])}function getSideList(_r,Tr,Ar){const Rr=["left","right"],Pr=["right","left"],Dr=["top","bottom"],Mr=["bottom","top"];switch(_r){case"top":case"bottom":return Ar?Tr?Pr:Rr:Tr?Rr:Pr;case"left":case"right":return Tr?Dr:Mr;default:return[]}}function getOppositeAxisPlacements(_r,Tr,Ar,Rr){const Pr=getAlignment(_r);let Dr=getSideList(getSide(_r),Ar==="start",Rr);return Pr&&(Dr=Dr.map(Mr=>Mr+"-"+Pr),Tr&&(Dr=Dr.concat(Dr.map(getOppositeAlignmentPlacement)))),Dr}function getOppositePlacement(_r){return _r.replace(/left|right|bottom|top/g,Tr=>oppositeSideMap[Tr])}function expandPaddingObject(_r){return{top:0,right:0,bottom:0,left:0,..._r}}function getPaddingObject(_r){return typeof _r!="number"?expandPaddingObject(_r):{top:_r,right:_r,bottom:_r,left:_r}}function rectToClientRect(_r){return{..._r,top:_r.y,left:_r.x,right:_r.x+_r.width,bottom:_r.y+_r.height}}function computeCoordsFromPlacement(_r,Tr,Ar){let{reference:Rr,floating:Pr}=_r;const Dr=getSideAxis(Tr),Mr=getAlignmentAxis(Tr),Fr=getAxisLength(Mr),zr=getSide(Tr),jr=Dr==="y",Gr=Rr.x+Rr.width/2-Pr.width/2,Nr=Rr.y+Rr.height/2-Pr.height/2,Lr=Rr[Fr]/2-Pr[Fr]/2;let Ur;switch(zr){case"top":Ur={x:Gr,y:Rr.y-Pr.height};break;case"bottom":Ur={x:Gr,y:Rr.y+Rr.height};break;case"right":Ur={x:Rr.x+Rr.width,y:Nr};break;case"left":Ur={x:Rr.x-Pr.width,y:Nr};break;default:Ur={x:Rr.x,y:Rr.y}}switch(getAlignment(Tr)){case"start":Ur[Mr]-=Lr*(Ar&&jr?-1:1);break;case"end":Ur[Mr]+=Lr*(Ar&&jr?-1:1);break}return Ur}const computePosition$1=async(_r,Tr,Ar)=>{const{placement:Rr="bottom",strategy:Pr="absolute",middleware:Dr=[],platform:Mr}=Ar,Fr=Dr.filter(Boolean),zr=await(Mr.isRTL==null?void 0:Mr.isRTL(Tr));let jr=await Mr.getElementRects({reference:_r,floating:Tr,strategy:Pr}),{x:Gr,y:Nr}=computeCoordsFromPlacement(jr,Rr,zr),Lr=Rr,Ur={},Vr=0;for(let Wr=0;Wr<Fr.length;Wr++){const{name:qr,fn:Kr}=Fr[Wr],{x:Xr,y:Zr,data:_i,reset:Jr}=await Kr({x:Gr,y:Nr,initialPlacement:Rr,placement:Lr,strategy:Pr,middlewareData:Ur,rects:jr,platform:Mr,elements:{reference:_r,floating:Tr}});if(Gr=Xr??Gr,Nr=Zr??Nr,Ur={...Ur,[qr]:{...Ur[qr],..._i}},Jr&&Vr<=50){Vr++,typeof Jr=="object"&&(Jr.placement&&(Lr=Jr.placement),Jr.rects&&(jr=Jr.rects===!0?await Mr.getElementRects({reference:_r,floating:Tr,strategy:Pr}):Jr.rects),{x:Gr,y:Nr}=computeCoordsFromPlacement(jr,Lr,zr)),Wr=-1;continue}}return{x:Gr,y:Nr,placement:Lr,strategy:Pr,middlewareData:Ur}};async function detectOverflow(_r,Tr){var Ar;Tr===void 0&&(Tr={});const{x:Rr,y:Pr,platform:Dr,rects:Mr,elements:Fr,strategy:zr}=_r,{boundary:jr="clippingAncestors",rootBoundary:Gr="viewport",elementContext:Nr="floating",altBoundary:Lr=!1,padding:Ur=0}=evaluate(Tr,_r),Vr=getPaddingObject(Ur),qr=Fr[Lr?Nr==="floating"?"reference":"floating":Nr],Kr=rectToClientRect(await Dr.getClippingRect({element:(Ar=await(Dr.isElement==null?void 0:Dr.isElement(qr)))==null||Ar?qr:qr.contextElement||await(Dr.getDocumentElement==null?void 0:Dr.getDocumentElement(Fr.floating)),boundary:jr,rootBoundary:Gr,strategy:zr})),Xr=Nr==="floating"?{...Mr.floating,x:Rr,y:Pr}:Mr.reference,Zr=await(Dr.getOffsetParent==null?void 0:Dr.getOffsetParent(Fr.floating)),_i=await(Dr.isElement==null?void 0:Dr.isElement(Zr))?await(Dr.getScale==null?void 0:Dr.getScale(Zr))||{x:1,y:1}:{x:1,y:1},Jr=rectToClientRect(Dr.convertOffsetParentRelativeRectToViewportRelativeRect?await Dr.convertOffsetParentRelativeRectToViewportRelativeRect({rect:Xr,offsetParent:Zr,strategy:zr}):Xr);return{top:(Kr.top-Jr.top+Vr.top)/_i.y,bottom:(Jr.bottom-Kr.bottom+Vr.bottom)/_i.y,left:(Kr.left-Jr.left+Vr.left)/_i.x,right:(Jr.right-Kr.right+Vr.right)/_i.x}}const arrow$1=_r=>({name:"arrow",options:_r,async fn(Tr){const{x:Ar,y:Rr,placement:Pr,rects:Dr,platform:Mr,elements:Fr,middlewareData:zr}=Tr,{element:jr,padding:Gr=0}=evaluate(_r,Tr)||{};if(jr==null)return{};const Nr=getPaddingObject(Gr),Lr={x:Ar,y:Rr},Ur=getAlignmentAxis(Pr),Vr=getAxisLength(Ur),Wr=await Mr.getDimensions(jr),qr=Ur==="y",Kr=qr?"top":"left",Xr=qr?"bottom":"right",Zr=qr?"clientHeight":"clientWidth",_i=Dr.reference[Vr]+Dr.reference[Ur]-Lr[Ur]-Dr.floating[Vr],Jr=Lr[Ur]-Dr.reference[Ur],es=await(Mr.getOffsetParent==null?void 0:Mr.getOffsetParent(jr));let ts=es?es[Zr]:0;(!ts||!await(Mr.isElement==null?void 0:Mr.isElement(es)))&&(ts=Fr.floating[Zr]||Dr.floating[Vr]);const is=_i/2-Jr/2,rs=ts/2-Wr[Vr]/2-1,as=min(Nr[Kr],rs),ls=min(Nr[Xr],rs),fs=as,Ts=ts-Wr[Vr]-ls,$s=ts/2-Wr[Vr]/2+is,xs=clamp(fs,$s,Ts),ys=!zr.arrow&&getAlignment(Pr)!=null&&$s!=xs&&Dr.reference[Vr]/2-($s<fs?as:ls)-Wr[Vr]/2<0,ps=ys?$s<fs?$s-fs:$s-Ts:0;return{[Ur]:Lr[Ur]+ps,data:{[Ur]:xs,centerOffset:$s-xs-ps,...ys&&{alignmentOffset:ps}},reset:ys}}}),flip=function(_r){return _r===void 0&&(_r={}),{name:"flip",options:_r,async fn(Tr){var Ar,Rr;const{placement:Pr,middlewareData:Dr,rects:Mr,initialPlacement:Fr,platform:zr,elements:jr}=Tr,{mainAxis:Gr=!0,crossAxis:Nr=!0,fallbackPlacements:Lr,fallbackStrategy:Ur="bestFit",fallbackAxisSideDirection:Vr="none",flipAlignment:Wr=!0,...qr}=evaluate(_r,Tr);if((Ar=Dr.arrow)!=null&&Ar.alignmentOffset)return{};const Kr=getSide(Pr),Xr=getSide(Fr)===Fr,Zr=await(zr.isRTL==null?void 0:zr.isRTL(jr.floating)),_i=Lr||(Xr||!Wr?[getOppositePlacement(Fr)]:getExpandedPlacements(Fr));!Lr&&Vr!=="none"&&_i.push(...getOppositeAxisPlacements(Fr,Wr,Vr,Zr));const Jr=[Fr,..._i],es=await detectOverflow(Tr,qr),ts=[];let is=((Rr=Dr.flip)==null?void 0:Rr.overflows)||[];if(Gr&&ts.push(es[Kr]),Nr){const fs=getAlignmentSides(Pr,Mr,Zr);ts.push(es[fs[0]],es[fs[1]])}if(is=[...is,{placement:Pr,overflows:ts}],!ts.every(fs=>fs<=0)){var rs,as;const fs=(((rs=Dr.flip)==null?void 0:rs.index)||0)+1,Ts=Jr[fs];if(Ts)return{data:{index:fs,overflows:is},reset:{placement:Ts}};let $s=(as=is.filter(xs=>xs.overflows[0]<=0).sort((xs,ys)=>xs.overflows[1]-ys.overflows[1])[0])==null?void 0:as.placement;if(!$s)switch(Ur){case"bestFit":{var ls;const xs=(ls=is.map(ys=>[ys.placement,ys.overflows.filter(ps=>ps>0).reduce((ps,vs)=>ps+vs,0)]).sort((ys,ps)=>ys[1]-ps[1])[0])==null?void 0:ls[0];xs&&($s=xs);break}case"initialPlacement":$s=Fr;break}if(Pr!==$s)return{reset:{placement:$s}}}return{}}}};function getSideOffsets(_r,Tr){return{top:_r.top-Tr.height,right:_r.right-Tr.width,bottom:_r.bottom-Tr.height,left:_r.left-Tr.width}}function isAnySideFullyClipped(_r){return sides.some(Tr=>_r[Tr]>=0)}const hide=function(_r){return _r===void 0&&(_r={}),{name:"hide",options:_r,async fn(Tr){const{rects:Ar}=Tr,{strategy:Rr="referenceHidden",...Pr}=evaluate(_r,Tr);switch(Rr){case"referenceHidden":{const Dr=await detectOverflow(Tr,{...Pr,elementContext:"reference"}),Mr=getSideOffsets(Dr,Ar.reference);return{data:{referenceHiddenOffsets:Mr,referenceHidden:isAnySideFullyClipped(Mr)}}}case"escaped":{const Dr=await detectOverflow(Tr,{...Pr,altBoundary:!0}),Mr=getSideOffsets(Dr,Ar.floating);return{data:{escapedOffsets:Mr,escaped:isAnySideFullyClipped(Mr)}}}default:return{}}}}};async function convertValueToCoords(_r,Tr){const{placement:Ar,platform:Rr,elements:Pr}=_r,Dr=await(Rr.isRTL==null?void 0:Rr.isRTL(Pr.floating)),Mr=getSide(Ar),Fr=getAlignment(Ar),zr=getSideAxis(Ar)==="y",jr=["left","top"].includes(Mr)?-1:1,Gr=Dr&&zr?-1:1,Nr=evaluate(Tr,_r);let{mainAxis:Lr,crossAxis:Ur,alignmentAxis:Vr}=typeof Nr=="number"?{mainAxis:Nr,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...Nr};return Fr&&typeof Vr=="number"&&(Ur=Fr==="end"?Vr*-1:Vr),zr?{x:Ur*Gr,y:Lr*jr}:{x:Lr*jr,y:Ur*Gr}}const offset=function(_r){return _r===void 0&&(_r=0),{name:"offset",options:_r,async fn(Tr){const{x:Ar,y:Rr}=Tr,Pr=await convertValueToCoords(Tr,_r);return{x:Ar+Pr.x,y:Rr+Pr.y,data:Pr}}}},shift=function(_r){return _r===void 0&&(_r={}),{name:"shift",options:_r,async fn(Tr){const{x:Ar,y:Rr,placement:Pr}=Tr,{mainAxis:Dr=!0,crossAxis:Mr=!1,limiter:Fr={fn:qr=>{let{x:Kr,y:Xr}=qr;return{x:Kr,y:Xr}}},...zr}=evaluate(_r,Tr),jr={x:Ar,y:Rr},Gr=await detectOverflow(Tr,zr),Nr=getSideAxis(getSide(Pr)),Lr=getOppositeAxis(Nr);let Ur=jr[Lr],Vr=jr[Nr];if(Dr){const qr=Lr==="y"?"top":"left",Kr=Lr==="y"?"bottom":"right",Xr=Ur+Gr[qr],Zr=Ur-Gr[Kr];Ur=clamp(Xr,Ur,Zr)}if(Mr){const qr=Nr==="y"?"top":"left",Kr=Nr==="y"?"bottom":"right",Xr=Vr+Gr[qr],Zr=Vr-Gr[Kr];Vr=clamp(Xr,Vr,Zr)}const Wr=Fr.fn({...Tr,[Lr]:Ur,[Nr]:Vr});return{...Wr,data:{x:Wr.x-Ar,y:Wr.y-Rr}}}}},limitShift=function(_r){return _r===void 0&&(_r={}),{options:_r,fn(Tr){const{x:Ar,y:Rr,placement:Pr,rects:Dr,middlewareData:Mr}=Tr,{offset:Fr=0,mainAxis:zr=!0,crossAxis:jr=!0}=evaluate(_r,Tr),Gr={x:Ar,y:Rr},Nr=getSideAxis(Pr),Lr=getOppositeAxis(Nr);let Ur=Gr[Lr],Vr=Gr[Nr];const Wr=evaluate(Fr,Tr),qr=typeof Wr=="number"?{mainAxis:Wr,crossAxis:0}:{mainAxis:0,crossAxis:0,...Wr};if(zr){const Zr=Lr==="y"?"height":"width",_i=Dr.reference[Lr]-Dr.floating[Zr]+qr.mainAxis,Jr=Dr.reference[Lr]+Dr.reference[Zr]-qr.mainAxis;Ur<_i?Ur=_i:Ur>Jr&&(Ur=Jr)}if(jr){var Kr,Xr;const Zr=Lr==="y"?"width":"height",_i=["top","left"].includes(getSide(Pr)),Jr=Dr.reference[Nr]-Dr.floating[Zr]+(_i&&((Kr=Mr.offset)==null?void 0:Kr[Nr])||0)+(_i?0:qr.crossAxis),es=Dr.reference[Nr]+Dr.reference[Zr]+(_i?0:((Xr=Mr.offset)==null?void 0:Xr[Nr])||0)-(_i?qr.crossAxis:0);Vr<Jr?Vr=Jr:Vr>es&&(Vr=es)}return{[Lr]:Ur,[Nr]:Vr}}}},size=function(_r){return _r===void 0&&(_r={}),{name:"size",options:_r,async fn(Tr){const{placement:Ar,rects:Rr,platform:Pr,elements:Dr}=Tr,{apply:Mr=()=>{},...Fr}=evaluate(_r,Tr),zr=await detectOverflow(Tr,Fr),jr=getSide(Ar),Gr=getAlignment(Ar),Nr=getSideAxis(Ar)==="y",{width:Lr,height:Ur}=Rr.floating;let Vr,Wr;jr==="top"||jr==="bottom"?(Vr=jr,Wr=Gr===(await(Pr.isRTL==null?void 0:Pr.isRTL(Dr.floating))?"start":"end")?"left":"right"):(Wr=jr,Vr=Gr==="end"?"top":"bottom");const qr=Ur-zr[Vr],Kr=Lr-zr[Wr],Xr=!Tr.middlewareData.shift;let Zr=qr,_i=Kr;if(Nr){const es=Lr-zr.left-zr.right;_i=Gr||Xr?min(Kr,es):es}else{const es=Ur-zr.top-zr.bottom;Zr=Gr||Xr?min(qr,es):es}if(Xr&&!Gr){const es=max(zr.left,0),ts=max(zr.right,0),is=max(zr.top,0),rs=max(zr.bottom,0);Nr?_i=Lr-2*(es!==0||ts!==0?es+ts:max(zr.left,zr.right)):Zr=Ur-2*(is!==0||rs!==0?is+rs:max(zr.top,zr.bottom))}await Mr({...Tr,availableWidth:_i,availableHeight:Zr});const Jr=await Pr.getDimensions(Dr.floating);return Lr!==Jr.width||Ur!==Jr.height?{reset:{rects:!0}}:{}}}};function getNodeName(_r){return isNode(_r)?(_r.nodeName||"").toLowerCase():"#document"}function getWindow(_r){var Tr;return(_r==null||(Tr=_r.ownerDocument)==null?void 0:Tr.defaultView)||window}function getDocumentElement(_r){var Tr;return(Tr=(isNode(_r)?_r.ownerDocument:_r.document)||window.document)==null?void 0:Tr.documentElement}function isNode(_r){return _r instanceof Node||_r instanceof getWindow(_r).Node}function isElement(_r){return _r instanceof Element||_r instanceof getWindow(_r).Element}function isHTMLElement(_r){return _r instanceof HTMLElement||_r instanceof getWindow(_r).HTMLElement}function isShadowRoot(_r){return typeof ShadowRoot>"u"?!1:_r instanceof ShadowRoot||_r instanceof getWindow(_r).ShadowRoot}function isOverflowElement(_r){const{overflow:Tr,overflowX:Ar,overflowY:Rr,display:Pr}=getComputedStyle$1(_r);return/auto|scroll|overlay|hidden|clip/.test(Tr+Rr+Ar)&&!["inline","contents"].includes(Pr)}function isTableElement(_r){return["table","td","th"].includes(getNodeName(_r))}function isContainingBlock(_r){const Tr=isWebKit(),Ar=getComputedStyle$1(_r);return Ar.transform!=="none"||Ar.perspective!=="none"||(Ar.containerType?Ar.containerType!=="normal":!1)||!Tr&&(Ar.backdropFilter?Ar.backdropFilter!=="none":!1)||!Tr&&(Ar.filter?Ar.filter!=="none":!1)||["transform","perspective","filter"].some(Rr=>(Ar.willChange||"").includes(Rr))||["paint","layout","strict","content"].some(Rr=>(Ar.contain||"").includes(Rr))}function getContainingBlock(_r){let Tr=getParentNode(_r);for(;isHTMLElement(Tr)&&!isLastTraversableNode(Tr);){if(isContainingBlock(Tr))return Tr;Tr=getParentNode(Tr)}return null}function isWebKit(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function isLastTraversableNode(_r){return["html","body","#document"].includes(getNodeName(_r))}function getComputedStyle$1(_r){return getWindow(_r).getComputedStyle(_r)}function getNodeScroll(_r){return isElement(_r)?{scrollLeft:_r.scrollLeft,scrollTop:_r.scrollTop}:{scrollLeft:_r.pageXOffset,scrollTop:_r.pageYOffset}}function getParentNode(_r){if(getNodeName(_r)==="html")return _r;const Tr=_r.assignedSlot||_r.parentNode||isShadowRoot(_r)&&_r.host||getDocumentElement(_r);return isShadowRoot(Tr)?Tr.host:Tr}function getNearestOverflowAncestor(_r){const Tr=getParentNode(_r);return isLastTraversableNode(Tr)?_r.ownerDocument?_r.ownerDocument.body:_r.body:isHTMLElement(Tr)&&isOverflowElement(Tr)?Tr:getNearestOverflowAncestor(Tr)}function getOverflowAncestors(_r,Tr,Ar){var Rr;Tr===void 0&&(Tr=[]),Ar===void 0&&(Ar=!0);const Pr=getNearestOverflowAncestor(_r),Dr=Pr===((Rr=_r.ownerDocument)==null?void 0:Rr.body),Mr=getWindow(Pr);return Dr?Tr.concat(Mr,Mr.visualViewport||[],isOverflowElement(Pr)?Pr:[],Mr.frameElement&&Ar?getOverflowAncestors(Mr.frameElement):[]):Tr.concat(Pr,getOverflowAncestors(Pr,[],Ar))}function getCssDimensions(_r){const Tr=getComputedStyle$1(_r);let Ar=parseFloat(Tr.width)||0,Rr=parseFloat(Tr.height)||0;const Pr=isHTMLElement(_r),Dr=Pr?_r.offsetWidth:Ar,Mr=Pr?_r.offsetHeight:Rr,Fr=round(Ar)!==Dr||round(Rr)!==Mr;return Fr&&(Ar=Dr,Rr=Mr),{width:Ar,height:Rr,$:Fr}}function unwrapElement(_r){return isElement(_r)?_r:_r.contextElement}function getScale(_r){const Tr=unwrapElement(_r);if(!isHTMLElement(Tr))return createCoords(1);const Ar=Tr.getBoundingClientRect(),{width:Rr,height:Pr,$:Dr}=getCssDimensions(Tr);let Mr=(Dr?round(Ar.width):Ar.width)/Rr,Fr=(Dr?round(Ar.height):Ar.height)/Pr;return(!Mr||!Number.isFinite(Mr))&&(Mr=1),(!Fr||!Number.isFinite(Fr))&&(Fr=1),{x:Mr,y:Fr}}const noOffsets=createCoords(0);function getVisualOffsets(_r){const Tr=getWindow(_r);return!isWebKit()||!Tr.visualViewport?noOffsets:{x:Tr.visualViewport.offsetLeft,y:Tr.visualViewport.offsetTop}}function shouldAddVisualOffsets(_r,Tr,Ar){return Tr===void 0&&(Tr=!1),!Ar||Tr&&Ar!==getWindow(_r)?!1:Tr}function getBoundingClientRect(_r,Tr,Ar,Rr){Tr===void 0&&(Tr=!1),Ar===void 0&&(Ar=!1);const Pr=_r.getBoundingClientRect(),Dr=unwrapElement(_r);let Mr=createCoords(1);Tr&&(Rr?isElement(Rr)&&(Mr=getScale(Rr)):Mr=getScale(_r));const Fr=shouldAddVisualOffsets(Dr,Ar,Rr)?getVisualOffsets(Dr):createCoords(0);let zr=(Pr.left+Fr.x)/Mr.x,jr=(Pr.top+Fr.y)/Mr.y,Gr=Pr.width/Mr.x,Nr=Pr.height/Mr.y;if(Dr){const Lr=getWindow(Dr),Ur=Rr&&isElement(Rr)?getWindow(Rr):Rr;let Vr=Lr.frameElement;for(;Vr&&Rr&&Ur!==Lr;){const Wr=getScale(Vr),qr=Vr.getBoundingClientRect(),Kr=getComputedStyle$1(Vr),Xr=qr.left+(Vr.clientLeft+parseFloat(Kr.paddingLeft))*Wr.x,Zr=qr.top+(Vr.clientTop+parseFloat(Kr.paddingTop))*Wr.y;zr*=Wr.x,jr*=Wr.y,Gr*=Wr.x,Nr*=Wr.y,zr+=Xr,jr+=Zr,Vr=getWindow(Vr).frameElement}}return rectToClientRect({width:Gr,height:Nr,x:zr,y:jr})}function convertOffsetParentRelativeRectToViewportRelativeRect(_r){let{rect:Tr,offsetParent:Ar,strategy:Rr}=_r;const Pr=isHTMLElement(Ar),Dr=getDocumentElement(Ar);if(Ar===Dr)return Tr;let Mr={scrollLeft:0,scrollTop:0},Fr=createCoords(1);const zr=createCoords(0);if((Pr||!Pr&&Rr!=="fixed")&&((getNodeName(Ar)!=="body"||isOverflowElement(Dr))&&(Mr=getNodeScroll(Ar)),isHTMLElement(Ar))){const jr=getBoundingClientRect(Ar);Fr=getScale(Ar),zr.x=jr.x+Ar.clientLeft,zr.y=jr.y+Ar.clientTop}return{width:Tr.width*Fr.x,height:Tr.height*Fr.y,x:Tr.x*Fr.x-Mr.scrollLeft*Fr.x+zr.x,y:Tr.y*Fr.y-Mr.scrollTop*Fr.y+zr.y}}function getClientRects(_r){return Array.from(_r.getClientRects())}function getWindowScrollBarX(_r){return getBoundingClientRect(getDocumentElement(_r)).left+getNodeScroll(_r).scrollLeft}function getDocumentRect(_r){const Tr=getDocumentElement(_r),Ar=getNodeScroll(_r),Rr=_r.ownerDocument.body,Pr=max(Tr.scrollWidth,Tr.clientWidth,Rr.scrollWidth,Rr.clientWidth),Dr=max(Tr.scrollHeight,Tr.clientHeight,Rr.scrollHeight,Rr.clientHeight);let Mr=-Ar.scrollLeft+getWindowScrollBarX(_r);const Fr=-Ar.scrollTop;return getComputedStyle$1(Rr).direction==="rtl"&&(Mr+=max(Tr.clientWidth,Rr.clientWidth)-Pr),{width:Pr,height:Dr,x:Mr,y:Fr}}function getViewportRect(_r,Tr){const Ar=getWindow(_r),Rr=getDocumentElement(_r),Pr=Ar.visualViewport;let Dr=Rr.clientWidth,Mr=Rr.clientHeight,Fr=0,zr=0;if(Pr){Dr=Pr.width,Mr=Pr.height;const jr=isWebKit();(!jr||jr&&Tr==="fixed")&&(Fr=Pr.offsetLeft,zr=Pr.offsetTop)}return{width:Dr,height:Mr,x:Fr,y:zr}}function getInnerBoundingClientRect(_r,Tr){const Ar=getBoundingClientRect(_r,!0,Tr==="fixed"),Rr=Ar.top+_r.clientTop,Pr=Ar.left+_r.clientLeft,Dr=isHTMLElement(_r)?getScale(_r):createCoords(1),Mr=_r.clientWidth*Dr.x,Fr=_r.clientHeight*Dr.y,zr=Pr*Dr.x,jr=Rr*Dr.y;return{width:Mr,height:Fr,x:zr,y:jr}}function getClientRectFromClippingAncestor(_r,Tr,Ar){let Rr;if(Tr==="viewport")Rr=getViewportRect(_r,Ar);else if(Tr==="document")Rr=getDocumentRect(getDocumentElement(_r));else if(isElement(Tr))Rr=getInnerBoundingClientRect(Tr,Ar);else{const Pr=getVisualOffsets(_r);Rr={...Tr,x:Tr.x-Pr.x,y:Tr.y-Pr.y}}return rectToClientRect(Rr)}function hasFixedPositionAncestor(_r,Tr){const Ar=getParentNode(_r);return Ar===Tr||!isElement(Ar)||isLastTraversableNode(Ar)?!1:getComputedStyle$1(Ar).position==="fixed"||hasFixedPositionAncestor(Ar,Tr)}function getClippingElementAncestors(_r,Tr){const Ar=Tr.get(_r);if(Ar)return Ar;let Rr=getOverflowAncestors(_r,[],!1).filter(Fr=>isElement(Fr)&&getNodeName(Fr)!=="body"),Pr=null;const Dr=getComputedStyle$1(_r).position==="fixed";let Mr=Dr?getParentNode(_r):_r;for(;isElement(Mr)&&!isLastTraversableNode(Mr);){const Fr=getComputedStyle$1(Mr),zr=isContainingBlock(Mr);!zr&&Fr.position==="fixed"&&(Pr=null),(Dr?!zr&&!Pr:!zr&&Fr.position==="static"&&!!Pr&&["absolute","fixed"].includes(Pr.position)||isOverflowElement(Mr)&&!zr&&hasFixedPositionAncestor(_r,Mr))?Rr=Rr.filter(Gr=>Gr!==Mr):Pr=Fr,Mr=getParentNode(Mr)}return Tr.set(_r,Rr),Rr}function getClippingRect(_r){let{element:Tr,boundary:Ar,rootBoundary:Rr,strategy:Pr}=_r;const Mr=[...Ar==="clippingAncestors"?getClippingElementAncestors(Tr,this._c):[].concat(Ar),Rr],Fr=Mr[0],zr=Mr.reduce((jr,Gr)=>{const Nr=getClientRectFromClippingAncestor(Tr,Gr,Pr);return jr.top=max(Nr.top,jr.top),jr.right=min(Nr.right,jr.right),jr.bottom=min(Nr.bottom,jr.bottom),jr.left=max(Nr.left,jr.left),jr},getClientRectFromClippingAncestor(Tr,Fr,Pr));return{width:zr.right-zr.left,height:zr.bottom-zr.top,x:zr.left,y:zr.top}}function getDimensions(_r){return getCssDimensions(_r)}function getRectRelativeToOffsetParent(_r,Tr,Ar){const Rr=isHTMLElement(Tr),Pr=getDocumentElement(Tr),Dr=Ar==="fixed",Mr=getBoundingClientRect(_r,!0,Dr,Tr);let Fr={scrollLeft:0,scrollTop:0};const zr=createCoords(0);if(Rr||!Rr&&!Dr)if((getNodeName(Tr)!=="body"||isOverflowElement(Pr))&&(Fr=getNodeScroll(Tr)),Rr){const jr=getBoundingClientRect(Tr,!0,Dr,Tr);zr.x=jr.x+Tr.clientLeft,zr.y=jr.y+Tr.clientTop}else Pr&&(zr.x=getWindowScrollBarX(Pr));return{x:Mr.left+Fr.scrollLeft-zr.x,y:Mr.top+Fr.scrollTop-zr.y,width:Mr.width,height:Mr.height}}function getTrueOffsetParent(_r,Tr){return!isHTMLElement(_r)||getComputedStyle$1(_r).position==="fixed"?null:Tr?Tr(_r):_r.offsetParent}function getOffsetParent(_r,Tr){const Ar=getWindow(_r);if(!isHTMLElement(_r))return Ar;let Rr=getTrueOffsetParent(_r,Tr);for(;Rr&&isTableElement(Rr)&&getComputedStyle$1(Rr).position==="static";)Rr=getTrueOffsetParent(Rr,Tr);return Rr&&(getNodeName(Rr)==="html"||getNodeName(Rr)==="body"&&getComputedStyle$1(Rr).position==="static"&&!isContainingBlock(Rr))?Ar:Rr||getContainingBlock(_r)||Ar}const getElementRects=async function(_r){let{reference:Tr,floating:Ar,strategy:Rr}=_r;const Pr=this.getOffsetParent||getOffsetParent,Dr=this.getDimensions;return{reference:getRectRelativeToOffsetParent(Tr,await Pr(Ar),Rr),floating:{x:0,y:0,...await Dr(Ar)}}};function isRTL(_r){return getComputedStyle$1(_r).direction==="rtl"}const platform={convertOffsetParentRelativeRectToViewportRelativeRect,getDocumentElement,getClippingRect,getOffsetParent,getElementRects,getClientRects,getDimensions,getScale,isElement,isRTL};function observeMove(_r,Tr){let Ar=null,Rr;const Pr=getDocumentElement(_r);function Dr(){clearTimeout(Rr),Ar&&Ar.disconnect(),Ar=null}function Mr(Fr,zr){Fr===void 0&&(Fr=!1),zr===void 0&&(zr=1),Dr();const{left:jr,top:Gr,width:Nr,height:Lr}=_r.getBoundingClientRect();if(Fr||Tr(),!Nr||!Lr)return;const Ur=floor(Gr),Vr=floor(Pr.clientWidth-(jr+Nr)),Wr=floor(Pr.clientHeight-(Gr+Lr)),qr=floor(jr),Xr={rootMargin:-Ur+"px "+-Vr+"px "+-Wr+"px "+-qr+"px",threshold:max(0,min(1,zr))||1};let Zr=!0;function _i(Jr){const es=Jr[0].intersectionRatio;if(es!==zr){if(!Zr)return Mr();es?Mr(!1,es):Rr=setTimeout(()=>{Mr(!1,1e-7)},100)}Zr=!1}try{Ar=new IntersectionObserver(_i,{...Xr,root:Pr.ownerDocument})}catch{Ar=new IntersectionObserver(_i,Xr)}Ar.observe(_r)}return Mr(!0),Dr}function autoUpdate(_r,Tr,Ar,Rr){Rr===void 0&&(Rr={});const{ancestorScroll:Pr=!0,ancestorResize:Dr=!0,elementResize:Mr=typeof ResizeObserver=="function",layoutShift:Fr=typeof IntersectionObserver=="function",animationFrame:zr=!1}=Rr,jr=unwrapElement(_r),Gr=Pr||Dr?[...jr?getOverflowAncestors(jr):[],...getOverflowAncestors(Tr)]:[];Gr.forEach(Kr=>{Pr&&Kr.addEventListener("scroll",Ar,{passive:!0}),Dr&&Kr.addEventListener("resize",Ar)});const Nr=jr&&Fr?observeMove(jr,Ar):null;let Lr=-1,Ur=null;Mr&&(Ur=new ResizeObserver(Kr=>{let[Xr]=Kr;Xr&&Xr.target===jr&&Ur&&(Ur.unobserve(Tr),cancelAnimationFrame(Lr),Lr=requestAnimationFrame(()=>{Ur&&Ur.observe(Tr)})),Ar()}),jr&&!zr&&Ur.observe(jr),Ur.observe(Tr));let Vr,Wr=zr?getBoundingClientRect(_r):null;zr&&qr();function qr(){const Kr=getBoundingClientRect(_r);Wr&&(Kr.x!==Wr.x||Kr.y!==Wr.y||Kr.width!==Wr.width||Kr.height!==Wr.height)&&Ar(),Wr=Kr,Vr=requestAnimationFrame(qr)}return Ar(),()=>{Gr.forEach(Kr=>{Pr&&Kr.removeEventListener("scroll",Ar),Dr&&Kr.removeEventListener("resize",Ar)}),Nr&&Nr(),Ur&&Ur.disconnect(),Ur=null,zr&&cancelAnimationFrame(Vr)}}const computePosition=(_r,Tr,Ar)=>{const Rr=new Map,Pr={platform,...Ar},Dr={...Pr.platform,_c:Rr};return computePosition$1(_r,Tr,{...Pr,platform:Dr})},arrow=_r=>{function Tr(Ar){return{}.hasOwnProperty.call(Ar,"current")}return{name:"arrow",options:_r,fn(Ar){const{element:Rr,padding:Pr}=typeof _r=="function"?_r(Ar):_r;return Rr&&Tr(Rr)?Rr.current!=null?arrow$1({element:Rr.current,padding:Pr}).fn(Ar):{}:Rr?arrow$1({element:Rr,padding:Pr}).fn(Ar):{}}}};var index$1=typeof document<"u"?reactExports.useLayoutEffect:reactExports.useEffect;function deepEqual(_r,Tr){if(_r===Tr)return!0;if(typeof _r!=typeof Tr)return!1;if(typeof _r=="function"&&_r.toString()===Tr.toString())return!0;let Ar,Rr,Pr;if(_r&&Tr&&typeof _r=="object"){if(Array.isArray(_r)){if(Ar=_r.length,Ar!=Tr.length)return!1;for(Rr=Ar;Rr--!==0;)if(!deepEqual(_r[Rr],Tr[Rr]))return!1;return!0}if(Pr=Object.keys(_r),Ar=Pr.length,Ar!==Object.keys(Tr).length)return!1;for(Rr=Ar;Rr--!==0;)if(!{}.hasOwnProperty.call(Tr,Pr[Rr]))return!1;for(Rr=Ar;Rr--!==0;){const Dr=Pr[Rr];if(!(Dr==="_owner"&&_r.$$typeof)&&!deepEqual(_r[Dr],Tr[Dr]))return!1}return!0}return _r!==_r&&Tr!==Tr}function getDPR(_r){return typeof window>"u"?1:(_r.ownerDocument.defaultView||window).devicePixelRatio||1}function roundByDPR(_r,Tr){const Ar=getDPR(_r);return Math.round(Tr*Ar)/Ar}function useLatestRef(_r){const Tr=reactExports.useRef(_r);return index$1(()=>{Tr.current=_r}),Tr}function useFloating(_r){_r===void 0&&(_r={});const{placement:Tr="bottom",strategy:Ar="absolute",middleware:Rr=[],platform:Pr,elements:{reference:Dr,floating:Mr}={},transform:Fr=!0,whileElementsMounted:zr,open:jr}=_r,[Gr,Nr]=reactExports.useState({x:0,y:0,strategy:Ar,placement:Tr,middlewareData:{},isPositioned:!1}),[Lr,Ur]=reactExports.useState(Rr);deepEqual(Lr,Rr)||Ur(Rr);const[Vr,Wr]=reactExports.useState(null),[qr,Kr]=reactExports.useState(null),Xr=reactExports.useCallback(ys=>{ys!=es.current&&(es.current=ys,Wr(ys))},[Wr]),Zr=reactExports.useCallback(ys=>{ys!==ts.current&&(ts.current=ys,Kr(ys))},[Kr]),_i=Dr||Vr,Jr=Mr||qr,es=reactExports.useRef(null),ts=reactExports.useRef(null),is=reactExports.useRef(Gr),rs=useLatestRef(zr),as=useLatestRef(Pr),ls=reactExports.useCallback(()=>{if(!es.current||!ts.current)return;const ys={placement:Tr,strategy:Ar,middleware:Lr};as.current&&(ys.platform=as.current),computePosition(es.current,ts.current,ys).then(ps=>{const vs={...ps,isPositioned:!0};fs.current&&!deepEqual(is.current,vs)&&(is.current=vs,reactDomExports.flushSync(()=>{Nr(vs)}))})},[Lr,Tr,Ar,as]);index$1(()=>{jr===!1&&is.current.isPositioned&&(is.current.isPositioned=!1,Nr(ys=>({...ys,isPositioned:!1})))},[jr]);const fs=reactExports.useRef(!1);index$1(()=>(fs.current=!0,()=>{fs.current=!1}),[]),index$1(()=>{if(_i&&(es.current=_i),Jr&&(ts.current=Jr),_i&&Jr){if(rs.current)return rs.current(_i,Jr,ls);ls()}},[_i,Jr,ls,rs]);const Ts=reactExports.useMemo(()=>({reference:es,floating:ts,setReference:Xr,setFloating:Zr}),[Xr,Zr]),$s=reactExports.useMemo(()=>({reference:_i,floating:Jr}),[_i,Jr]),xs=reactExports.useMemo(()=>{const ys={position:Ar,left:0,top:0};if(!$s.floating)return ys;const ps=roundByDPR($s.floating,Gr.x),vs=roundByDPR($s.floating,Gr.y);return Fr?{...ys,transform:"translate("+ps+"px, "+vs+"px)",...getDPR($s.floating)>=1.5&&{willChange:"transform"}}:{position:Ar,left:ps,top:vs}},[Ar,Fr,$s.floating,Gr.x,Gr.y]);return reactExports.useMemo(()=>({...Gr,update:ls,refs:Ts,elements:$s,floatingStyles:xs}),[Gr,ls,Ts,$s,xs])}const $7e8f5cd07187803e$export$21b07c8f274aebd5=reactExports.forwardRef((_r,Tr)=>{const{children:Ar,width:Rr=10,height:Pr=5,...Dr}=_r;return reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.svg,_extends$1({},Dr,{ref:Tr,width:Rr,height:Pr,viewBox:"0 0 30 10",preserveAspectRatio:"none"}),_r.asChild?Ar:reactExports.createElement("polygon",{points:"0,0 30,0 15,10"}))}),$7e8f5cd07187803e$export$be92b6f5f03c0fe9=$7e8f5cd07187803e$export$21b07c8f274aebd5,$cf1ac5d9fe0e8206$var$POPPER_NAME="Popper",[$cf1ac5d9fe0e8206$var$createPopperContext,$cf1ac5d9fe0e8206$export$722aac194ae923]=$c512c27ab02ef895$export$50c7b4e9d9f19c1($cf1ac5d9fe0e8206$var$POPPER_NAME),[$cf1ac5d9fe0e8206$var$PopperProvider,$cf1ac5d9fe0e8206$var$usePopperContext]=$cf1ac5d9fe0e8206$var$createPopperContext($cf1ac5d9fe0e8206$var$POPPER_NAME),$cf1ac5d9fe0e8206$export$badac9ada3a0bdf9=_r=>{const{__scopePopper:Tr,children:Ar}=_r,[Rr,Pr]=reactExports.useState(null);return reactExports.createElement($cf1ac5d9fe0e8206$var$PopperProvider,{scope:Tr,anchor:Rr,onAnchorChange:Pr},Ar)},$cf1ac5d9fe0e8206$var$ANCHOR_NAME="PopperAnchor",$cf1ac5d9fe0e8206$export$ecd4e1ccab6ed6d=reactExports.forwardRef((_r,Tr)=>{const{__scopePopper:Ar,virtualRef:Rr,...Pr}=_r,Dr=$cf1ac5d9fe0e8206$var$usePopperContext($cf1ac5d9fe0e8206$var$ANCHOR_NAME,Ar),Mr=reactExports.useRef(null),Fr=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(Tr,Mr);return reactExports.useEffect(()=>{Dr.onAnchorChange((Rr==null?void 0:Rr.current)||Mr.current)}),Rr?null:reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.div,_extends$1({},Pr,{ref:Fr}))}),$cf1ac5d9fe0e8206$var$CONTENT_NAME="PopperContent",[$cf1ac5d9fe0e8206$var$PopperContentProvider,$cf1ac5d9fe0e8206$var$useContentContext]=$cf1ac5d9fe0e8206$var$createPopperContext($cf1ac5d9fe0e8206$var$CONTENT_NAME),$cf1ac5d9fe0e8206$export$bc4ae5855d3c4fc=reactExports.forwardRef((_r,Tr)=>{var Ar,Rr,Pr,Dr,Mr,Fr,zr,jr;const{__scopePopper:Gr,side:Nr="bottom",sideOffset:Lr=0,align:Ur="center",alignOffset:Vr=0,arrowPadding:Wr=0,collisionBoundary:qr=[],collisionPadding:Kr=0,sticky:Xr="partial",hideWhenDetached:Zr=!1,avoidCollisions:_i=!0,onPlaced:Jr,...es}=_r,ts=$cf1ac5d9fe0e8206$var$usePopperContext($cf1ac5d9fe0e8206$var$CONTENT_NAME,Gr),[is,rs]=reactExports.useState(null),as=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(Tr,Os=>rs(Os)),[ls,fs]=reactExports.useState(null),Ts=$db6c3485150b8e66$export$1ab7ae714698c4b8(ls),$s=(Ar=Ts==null?void 0:Ts.width)!==null&&Ar!==void 0?Ar:0,xs=(Rr=Ts==null?void 0:Ts.height)!==null&&Rr!==void 0?Rr:0,ys=Nr+(Ur!=="center"?"-"+Ur:""),ps=typeof Kr=="number"?Kr:{top:0,right:0,bottom:0,left:0,...Kr},vs=Array.isArray(qr)?qr:[qr],Ds=vs.length>0,js={padding:ps,boundary:vs.filter($cf1ac5d9fe0e8206$var$isNotNull),altBoundary:Ds},{refs:zs,floatingStyles:qs,placement:fo,isPositioned:Qs,middlewareData:no}=useFloating({strategy:"fixed",placement:ys,whileElementsMounted:autoUpdate,elements:{reference:ts.anchor},middleware:[offset({mainAxis:Lr+xs,alignmentAxis:Vr}),_i&&shift({mainAxis:!0,crossAxis:!1,limiter:Xr==="partial"?limitShift():void 0,...js}),_i&&flip({...js}),size({...js,apply:({elements:Os,rects:Ws,availableWidth:to,availableHeight:io})=>{const{width:ko,height:go}=Ws.reference,To=Os.floating.style;To.setProperty("--radix-popper-available-width",`${to}px`),To.setProperty("--radix-popper-available-height",`${io}px`),To.setProperty("--radix-popper-anchor-width",`${ko}px`),To.setProperty("--radix-popper-anchor-height",`${go}px`)}}),ls&&arrow({element:ls,padding:Wr}),$cf1ac5d9fe0e8206$var$transformOrigin({arrowWidth:$s,arrowHeight:xs}),Zr&&hide({strategy:"referenceHidden"})]}),[yo,Js]=$cf1ac5d9fe0e8206$var$getSideAndAlignFromPlacement(fo),lo=$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(Jr);$9f79659886946c16$export$e5c5a5f917a5871c(()=>{Qs&&(lo==null||lo())},[Qs,lo]);const vo=(Pr=no.arrow)===null||Pr===void 0?void 0:Pr.x,Ro=(Dr=no.arrow)===null||Dr===void 0?void 0:Dr.y,Co=((Mr=no.arrow)===null||Mr===void 0?void 0:Mr.centerOffset)!==0,[Do,ds]=reactExports.useState();return $9f79659886946c16$export$e5c5a5f917a5871c(()=>{is&&ds(window.getComputedStyle(is).zIndex)},[is]),reactExports.createElement("div",{ref:zs.setFloating,"data-radix-popper-content-wrapper":"",style:{...qs,transform:Qs?qs.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:Do,"--radix-popper-transform-origin":[(Fr=no.transformOrigin)===null||Fr===void 0?void 0:Fr.x,(zr=no.transformOrigin)===null||zr===void 0?void 0:zr.y].join(" ")},dir:_r.dir},reactExports.createElement($cf1ac5d9fe0e8206$var$PopperContentProvider,{scope:Gr,placedSide:yo,onArrowChange:fs,arrowX:vo,arrowY:Ro,shouldHideArrow:Co},reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.div,_extends$1({"data-side":yo,"data-align":Js},es,{ref:as,style:{...es.style,animation:Qs?void 0:"none",opacity:(jr=no.hide)!==null&&jr!==void 0&&jr.referenceHidden?0:void 0}}))))}),$cf1ac5d9fe0e8206$var$ARROW_NAME="PopperArrow",$cf1ac5d9fe0e8206$var$OPPOSITE_SIDE={top:"bottom",right:"left",bottom:"top",left:"right"},$cf1ac5d9fe0e8206$export$79d62cd4e10a3fd0=reactExports.forwardRef(function(Tr,Ar){const{__scopePopper:Rr,...Pr}=Tr,Dr=$cf1ac5d9fe0e8206$var$useContentContext($cf1ac5d9fe0e8206$var$ARROW_NAME,Rr),Mr=$cf1ac5d9fe0e8206$var$OPPOSITE_SIDE[Dr.placedSide];return reactExports.createElement("span",{ref:Dr.onArrowChange,style:{position:"absolute",left:Dr.arrowX,top:Dr.arrowY,[Mr]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[Dr.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[Dr.placedSide],visibility:Dr.shouldHideArrow?"hidden":void 0}},reactExports.createElement($7e8f5cd07187803e$export$be92b6f5f03c0fe9,_extends$1({},Pr,{ref:Ar,style:{...Pr.style,display:"block"}})))});function $cf1ac5d9fe0e8206$var$isNotNull(_r){return _r!==null}const $cf1ac5d9fe0e8206$var$transformOrigin=_r=>({name:"transformOrigin",options:_r,fn(Tr){var Ar,Rr,Pr,Dr,Mr;const{placement:Fr,rects:zr,middlewareData:jr}=Tr,Nr=((Ar=jr.arrow)===null||Ar===void 0?void 0:Ar.centerOffset)!==0,Lr=Nr?0:_r.arrowWidth,Ur=Nr?0:_r.arrowHeight,[Vr,Wr]=$cf1ac5d9fe0e8206$var$getSideAndAlignFromPlacement(Fr),qr={start:"0%",center:"50%",end:"100%"}[Wr],Kr=((Rr=(Pr=jr.arrow)===null||Pr===void 0?void 0:Pr.x)!==null&&Rr!==void 0?Rr:0)+Lr/2,Xr=((Dr=(Mr=jr.arrow)===null||Mr===void 0?void 0:Mr.y)!==null&&Dr!==void 0?Dr:0)+Ur/2;let Zr="",_i="";return Vr==="bottom"?(Zr=Nr?qr:`${Kr}px`,_i=`${-Ur}px`):Vr==="top"?(Zr=Nr?qr:`${Kr}px`,_i=`${zr.floating.height+Ur}px`):Vr==="right"?(Zr=`${-Ur}px`,_i=Nr?qr:`${Xr}px`):Vr==="left"&&(Zr=`${zr.floating.width+Ur}px`,_i=Nr?qr:`${Xr}px`),{data:{x:Zr,y:_i}}}});function $cf1ac5d9fe0e8206$var$getSideAndAlignFromPlacement(_r){const[Tr,Ar="center"]=_r.split("-");return[Tr,Ar]}const $cf1ac5d9fe0e8206$export$be92b6f5f03c0fe9=$cf1ac5d9fe0e8206$export$badac9ada3a0bdf9,$cf1ac5d9fe0e8206$export$b688253958b8dfe7=$cf1ac5d9fe0e8206$export$ecd4e1ccab6ed6d,$cf1ac5d9fe0e8206$export$7c6e2c02157bb7d2=$cf1ac5d9fe0e8206$export$bc4ae5855d3c4fc,$cf1ac5d9fe0e8206$export$21b07c8f274aebd5=$cf1ac5d9fe0e8206$export$79d62cd4e10a3fd0;var getDefaultParent=function(_r){if(typeof document>"u")return null;var Tr=Array.isArray(_r)?_r[0]:_r;return Tr.ownerDocument.body},counterMap=new WeakMap,uncontrolledNodes=new WeakMap,markerMap={},lockCount=0,unwrapHost=function(_r){return _r&&(_r.host||unwrapHost(_r.parentNode))},correctTargets=function(_r,Tr){return Tr.map(function(Ar){if(_r.contains(Ar))return Ar;var Rr=unwrapHost(Ar);return Rr&&_r.contains(Rr)?Rr:(console.error("aria-hidden",Ar,"in not contained inside",_r,". Doing nothing"),null)}).filter(function(Ar){return!!Ar})},applyAttributeToOthers=function(_r,Tr,Ar,Rr){var Pr=correctTargets(Tr,Array.isArray(_r)?_r:[_r]);markerMap[Ar]||(markerMap[Ar]=new WeakMap);var Dr=markerMap[Ar],Mr=[],Fr=new Set,zr=new Set(Pr),jr=function(Nr){!Nr||Fr.has(Nr)||(Fr.add(Nr),jr(Nr.parentNode))};Pr.forEach(jr);var Gr=function(Nr){!Nr||zr.has(Nr)||Array.prototype.forEach.call(Nr.children,function(Lr){if(Fr.has(Lr))Gr(Lr);else{var Ur=Lr.getAttribute(Rr),Vr=Ur!==null&&Ur!=="false",Wr=(counterMap.get(Lr)||0)+1,qr=(Dr.get(Lr)||0)+1;counterMap.set(Lr,Wr),Dr.set(Lr,qr),Mr.push(Lr),Wr===1&&Vr&&uncontrolledNodes.set(Lr,!0),qr===1&&Lr.setAttribute(Ar,"true"),Vr||Lr.setAttribute(Rr,"true")}})};return Gr(Tr),Fr.clear(),lockCount++,function(){Mr.forEach(function(Nr){var Lr=counterMap.get(Nr)-1,Ur=Dr.get(Nr)-1;counterMap.set(Nr,Lr),Dr.set(Nr,Ur),Lr||(uncontrolledNodes.has(Nr)||Nr.removeAttribute(Rr),uncontrolledNodes.delete(Nr)),Ur||Nr.removeAttribute(Ar)}),lockCount--,lockCount||(counterMap=new WeakMap,counterMap=new WeakMap,uncontrolledNodes=new WeakMap,markerMap={})}},hideOthers=function(_r,Tr,Ar){Ar===void 0&&(Ar="data-aria-hidden");var Rr=Array.from(Array.isArray(_r)?_r:[_r]),Pr=Tr||getDefaultParent(_r);return Pr?(Rr.push.apply(Rr,Array.from(Pr.querySelectorAll("[aria-live]"))),applyAttributeToOthers(Rr,Pr,Ar,"aria-hidden")):function(){return null}},__assign=function(){return __assign=Object.assign||function(Tr){for(var Ar,Rr=1,Pr=arguments.length;Rr<Pr;Rr++){Ar=arguments[Rr];for(var Dr in Ar)Object.prototype.hasOwnProperty.call(Ar,Dr)&&(Tr[Dr]=Ar[Dr])}return Tr},__assign.apply(this,arguments)};function __rest(_r,Tr){var Ar={};for(var Rr in _r)Object.prototype.hasOwnProperty.call(_r,Rr)&&Tr.indexOf(Rr)<0&&(Ar[Rr]=_r[Rr]);if(_r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Pr=0,Rr=Object.getOwnPropertySymbols(_r);Pr<Rr.length;Pr++)Tr.indexOf(Rr[Pr])<0&&Object.prototype.propertyIsEnumerable.call(_r,Rr[Pr])&&(Ar[Rr[Pr]]=_r[Rr[Pr]]);return Ar}function __spreadArray(_r,Tr,Ar){if(Ar||arguments.length===2)for(var Rr=0,Pr=Tr.length,Dr;Rr<Pr;Rr++)(Dr||!(Rr in Tr))&&(Dr||(Dr=Array.prototype.slice.call(Tr,0,Rr)),Dr[Rr]=Tr[Rr]);return _r.concat(Dr||Array.prototype.slice.call(Tr))}typeof SuppressedError=="function"&&SuppressedError;var zeroRightClassName="right-scroll-bar-position",fullWidthClassName="width-before-scroll-bar",noScrollbarsClassName="with-scroll-bars-hidden",removedBarSizeVariable="--removed-body-scroll-bar-size";function assignRef(_r,Tr){return typeof _r=="function"?_r(Tr):_r&&(_r.current=Tr),_r}function useCallbackRef(_r,Tr){var Ar=reactExports.useState(function(){return{value:_r,callback:Tr,facade:{get current(){return Ar.value},set current(Rr){var Pr=Ar.value;Pr!==Rr&&(Ar.value=Rr,Ar.callback(Rr,Pr))}}}})[0];return Ar.callback=Tr,Ar.facade}function useMergeRefs(_r,Tr){return useCallbackRef(Tr||null,function(Ar){return _r.forEach(function(Rr){return assignRef(Rr,Ar)})})}function ItoI(_r){return _r}function innerCreateMedium(_r,Tr){Tr===void 0&&(Tr=ItoI);var Ar=[],Rr=!1,Pr={read:function(){if(Rr)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return Ar.length?Ar[Ar.length-1]:_r},useMedium:function(Dr){var Mr=Tr(Dr,Rr);return Ar.push(Mr),function(){Ar=Ar.filter(function(Fr){return Fr!==Mr})}},assignSyncMedium:function(Dr){for(Rr=!0;Ar.length;){var Mr=Ar;Ar=[],Mr.forEach(Dr)}Ar={push:function(Fr){return Dr(Fr)},filter:function(){return Ar}}},assignMedium:function(Dr){Rr=!0;var Mr=[];if(Ar.length){var Fr=Ar;Ar=[],Fr.forEach(Dr),Mr=Ar}var zr=function(){var Gr=Mr;Mr=[],Gr.forEach(Dr)},jr=function(){return Promise.resolve().then(zr)};jr(),Ar={push:function(Gr){Mr.push(Gr),jr()},filter:function(Gr){return Mr=Mr.filter(Gr),Ar}}}};return Pr}function createSidecarMedium(_r){_r===void 0&&(_r={});var Tr=innerCreateMedium(null);return Tr.options=__assign({async:!0,ssr:!1},_r),Tr}var SideCar$1=function(_r){var Tr=_r.sideCar,Ar=__rest(_r,["sideCar"]);if(!Tr)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var Rr=Tr.read();if(!Rr)throw new Error("Sidecar medium not found");return reactExports.createElement(Rr,__assign({},Ar))};SideCar$1.isSideCarExport=!0;function exportSidecar(_r,Tr){return _r.useMedium(Tr),SideCar$1}var effectCar=createSidecarMedium(),nothing=function(){},RemoveScroll=reactExports.forwardRef(function(_r,Tr){var Ar=reactExports.useRef(null),Rr=reactExports.useState({onScrollCapture:nothing,onWheelCapture:nothing,onTouchMoveCapture:nothing}),Pr=Rr[0],Dr=Rr[1],Mr=_r.forwardProps,Fr=_r.children,zr=_r.className,jr=_r.removeScrollBar,Gr=_r.enabled,Nr=_r.shards,Lr=_r.sideCar,Ur=_r.noIsolation,Vr=_r.inert,Wr=_r.allowPinchZoom,qr=_r.as,Kr=qr===void 0?"div":qr,Xr=__rest(_r,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as"]),Zr=Lr,_i=useMergeRefs([Ar,Tr]),Jr=__assign(__assign({},Xr),Pr);return reactExports.createElement(reactExports.Fragment,null,Gr&&reactExports.createElement(Zr,{sideCar:effectCar,removeScrollBar:jr,shards:Nr,noIsolation:Ur,inert:Vr,setCallbacks:Dr,allowPinchZoom:!!Wr,lockRef:Ar}),Mr?reactExports.cloneElement(reactExports.Children.only(Fr),__assign(__assign({},Jr),{ref:_i})):reactExports.createElement(Kr,__assign({},Jr,{className:zr,ref:_i}),Fr))});RemoveScroll.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};RemoveScroll.classNames={fullWidth:fullWidthClassName,zeroRight:zeroRightClassName};var currentNonce,getNonce=function(){if(currentNonce)return currentNonce;if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function makeStyleTag(){if(!document)return null;var _r=document.createElement("style");_r.type="text/css";var Tr=getNonce();return Tr&&_r.setAttribute("nonce",Tr),_r}function injectStyles(_r,Tr){_r.styleSheet?_r.styleSheet.cssText=Tr:_r.appendChild(document.createTextNode(Tr))}function insertStyleTag(_r){var Tr=document.head||document.getElementsByTagName("head")[0];Tr.appendChild(_r)}var stylesheetSingleton=function(){var _r=0,Tr=null;return{add:function(Ar){_r==0&&(Tr=makeStyleTag())&&(injectStyles(Tr,Ar),insertStyleTag(Tr)),_r++},remove:function(){_r--,!_r&&Tr&&(Tr.parentNode&&Tr.parentNode.removeChild(Tr),Tr=null)}}},styleHookSingleton=function(){var _r=stylesheetSingleton();return function(Tr,Ar){reactExports.useEffect(function(){return _r.add(Tr),function(){_r.remove()}},[Tr&&Ar])}},styleSingleton=function(){var _r=styleHookSingleton(),Tr=function(Ar){var Rr=Ar.styles,Pr=Ar.dynamic;return _r(Rr,Pr),null};return Tr},zeroGap={left:0,top:0,right:0,gap:0},parse$1=function(_r){return parseInt(_r||"",10)||0},getOffset=function(_r){var Tr=window.getComputedStyle(document.body),Ar=Tr[_r==="padding"?"paddingLeft":"marginLeft"],Rr=Tr[_r==="padding"?"paddingTop":"marginTop"],Pr=Tr[_r==="padding"?"paddingRight":"marginRight"];return[parse$1(Ar),parse$1(Rr),parse$1(Pr)]},getGapWidth=function(_r){if(_r===void 0&&(_r="margin"),typeof window>"u")return zeroGap;var Tr=getOffset(_r),Ar=document.documentElement.clientWidth,Rr=window.innerWidth;return{left:Tr[0],top:Tr[1],right:Tr[2],gap:Math.max(0,Rr-Ar+Tr[2]-Tr[0])}},Style=styleSingleton(),getStyles=function(_r,Tr,Ar,Rr){var Pr=_r.left,Dr=_r.top,Mr=_r.right,Fr=_r.gap;return Ar===void 0&&(Ar="margin"),`
  .`.concat(noScrollbarsClassName,` {
   overflow: hidden `).concat(Rr,`;
   padding-right: `).concat(Fr,"px ").concat(Rr,`;
  }
  body {
    overflow: hidden `).concat(Rr,`;
    overscroll-behavior: contain;
    `).concat([Tr&&"position: relative ".concat(Rr,";"),Ar==="margin"&&`
    padding-left: `.concat(Pr,`px;
    padding-top: `).concat(Dr,`px;
    padding-right: `).concat(Mr,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(Fr,"px ").concat(Rr,`;
    `),Ar==="padding"&&"padding-right: ".concat(Fr,"px ").concat(Rr,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(zeroRightClassName,` {
    right: `).concat(Fr,"px ").concat(Rr,`;
  }
  
  .`).concat(fullWidthClassName,` {
    margin-right: `).concat(Fr,"px ").concat(Rr,`;
  }
  
  .`).concat(zeroRightClassName," .").concat(zeroRightClassName,` {
    right: 0 `).concat(Rr,`;
  }
  
  .`).concat(fullWidthClassName," .").concat(fullWidthClassName,` {
    margin-right: 0 `).concat(Rr,`;
  }
  
  body {
    `).concat(removedBarSizeVariable,": ").concat(Fr,`px;
  }
`)},RemoveScrollBar=function(_r){var Tr=_r.noRelative,Ar=_r.noImportant,Rr=_r.gapMode,Pr=Rr===void 0?"margin":Rr,Dr=reactExports.useMemo(function(){return getGapWidth(Pr)},[Pr]);return reactExports.createElement(Style,{styles:getStyles(Dr,!Tr,Pr,Ar?"":"!important")})},passiveSupported=!1;if(typeof window<"u")try{var options$1=Object.defineProperty({},"passive",{get:function(){return passiveSupported=!0,!0}});window.addEventListener("test",options$1,options$1),window.removeEventListener("test",options$1,options$1)}catch{passiveSupported=!1}var nonPassive=passiveSupported?{passive:!1}:!1,alwaysContainsScroll=function(_r){return _r.tagName==="TEXTAREA"},elementCanBeScrolled=function(_r,Tr){var Ar=window.getComputedStyle(_r);return Ar[Tr]!=="hidden"&&!(Ar.overflowY===Ar.overflowX&&!alwaysContainsScroll(_r)&&Ar[Tr]==="visible")},elementCouldBeVScrolled=function(_r){return elementCanBeScrolled(_r,"overflowY")},elementCouldBeHScrolled=function(_r){return elementCanBeScrolled(_r,"overflowX")},locationCouldBeScrolled=function(_r,Tr){var Ar=Tr;do{typeof ShadowRoot<"u"&&Ar instanceof ShadowRoot&&(Ar=Ar.host);var Rr=elementCouldBeScrolled(_r,Ar);if(Rr){var Pr=getScrollVariables(_r,Ar),Dr=Pr[1],Mr=Pr[2];if(Dr>Mr)return!0}Ar=Ar.parentNode}while(Ar&&Ar!==document.body);return!1},getVScrollVariables=function(_r){var Tr=_r.scrollTop,Ar=_r.scrollHeight,Rr=_r.clientHeight;return[Tr,Ar,Rr]},getHScrollVariables=function(_r){var Tr=_r.scrollLeft,Ar=_r.scrollWidth,Rr=_r.clientWidth;return[Tr,Ar,Rr]},elementCouldBeScrolled=function(_r,Tr){return _r==="v"?elementCouldBeVScrolled(Tr):elementCouldBeHScrolled(Tr)},getScrollVariables=function(_r,Tr){return _r==="v"?getVScrollVariables(Tr):getHScrollVariables(Tr)},getDirectionFactor=function(_r,Tr){return _r==="h"&&Tr==="rtl"?-1:1},handleScroll=function(_r,Tr,Ar,Rr,Pr){var Dr=getDirectionFactor(_r,window.getComputedStyle(Tr).direction),Mr=Dr*Rr,Fr=Ar.target,zr=Tr.contains(Fr),jr=!1,Gr=Mr>0,Nr=0,Lr=0;do{var Ur=getScrollVariables(_r,Fr),Vr=Ur[0],Wr=Ur[1],qr=Ur[2],Kr=Wr-qr-Dr*Vr;(Vr||Kr)&&elementCouldBeScrolled(_r,Fr)&&(Nr+=Kr,Lr+=Vr),Fr=Fr.parentNode}while(!zr&&Fr!==document.body||zr&&(Tr.contains(Fr)||Tr===Fr));return(Gr&&(Pr&&Nr===0||!Pr&&Mr>Nr)||!Gr&&(Pr&&Lr===0||!Pr&&-Mr>Lr))&&(jr=!0),jr},getTouchXY=function(_r){return"changedTouches"in _r?[_r.changedTouches[0].clientX,_r.changedTouches[0].clientY]:[0,0]},getDeltaXY=function(_r){return[_r.deltaX,_r.deltaY]},extractRef=function(_r){return _r&&"current"in _r?_r.current:_r},deltaCompare=function(_r,Tr){return _r[0]===Tr[0]&&_r[1]===Tr[1]},generateStyle=function(_r){return`
  .block-interactivity-`.concat(_r,` {pointer-events: none;}
  .allow-interactivity-`).concat(_r,` {pointer-events: all;}
`)},idCounter=0,lockStack=[];function RemoveScrollSideCar(_r){var Tr=reactExports.useRef([]),Ar=reactExports.useRef([0,0]),Rr=reactExports.useRef(),Pr=reactExports.useState(idCounter++)[0],Dr=reactExports.useState(function(){return styleSingleton()})[0],Mr=reactExports.useRef(_r);reactExports.useEffect(function(){Mr.current=_r},[_r]),reactExports.useEffect(function(){if(_r.inert){document.body.classList.add("block-interactivity-".concat(Pr));var Wr=__spreadArray([_r.lockRef.current],(_r.shards||[]).map(extractRef),!0).filter(Boolean);return Wr.forEach(function(qr){return qr.classList.add("allow-interactivity-".concat(Pr))}),function(){document.body.classList.remove("block-interactivity-".concat(Pr)),Wr.forEach(function(qr){return qr.classList.remove("allow-interactivity-".concat(Pr))})}}},[_r.inert,_r.lockRef.current,_r.shards]);var Fr=reactExports.useCallback(function(Wr,qr){if("touches"in Wr&&Wr.touches.length===2)return!Mr.current.allowPinchZoom;var Kr=getTouchXY(Wr),Xr=Ar.current,Zr="deltaX"in Wr?Wr.deltaX:Xr[0]-Kr[0],_i="deltaY"in Wr?Wr.deltaY:Xr[1]-Kr[1],Jr,es=Wr.target,ts=Math.abs(Zr)>Math.abs(_i)?"h":"v";if("touches"in Wr&&ts==="h"&&es.type==="range")return!1;var is=locationCouldBeScrolled(ts,es);if(!is)return!0;if(is?Jr=ts:(Jr=ts==="v"?"h":"v",is=locationCouldBeScrolled(ts,es)),!is)return!1;if(!Rr.current&&"changedTouches"in Wr&&(Zr||_i)&&(Rr.current=Jr),!Jr)return!0;var rs=Rr.current||Jr;return handleScroll(rs,qr,Wr,rs==="h"?Zr:_i,!0)},[]),zr=reactExports.useCallback(function(Wr){var qr=Wr;if(!(!lockStack.length||lockStack[lockStack.length-1]!==Dr)){var Kr="deltaY"in qr?getDeltaXY(qr):getTouchXY(qr),Xr=Tr.current.filter(function(Jr){return Jr.name===qr.type&&Jr.target===qr.target&&deltaCompare(Jr.delta,Kr)})[0];if(Xr&&Xr.should){qr.cancelable&&qr.preventDefault();return}if(!Xr){var Zr=(Mr.current.shards||[]).map(extractRef).filter(Boolean).filter(function(Jr){return Jr.contains(qr.target)}),_i=Zr.length>0?Fr(qr,Zr[0]):!Mr.current.noIsolation;_i&&qr.cancelable&&qr.preventDefault()}}},[]),jr=reactExports.useCallback(function(Wr,qr,Kr,Xr){var Zr={name:Wr,delta:qr,target:Kr,should:Xr};Tr.current.push(Zr),setTimeout(function(){Tr.current=Tr.current.filter(function(_i){return _i!==Zr})},1)},[]),Gr=reactExports.useCallback(function(Wr){Ar.current=getTouchXY(Wr),Rr.current=void 0},[]),Nr=reactExports.useCallback(function(Wr){jr(Wr.type,getDeltaXY(Wr),Wr.target,Fr(Wr,_r.lockRef.current))},[]),Lr=reactExports.useCallback(function(Wr){jr(Wr.type,getTouchXY(Wr),Wr.target,Fr(Wr,_r.lockRef.current))},[]);reactExports.useEffect(function(){return lockStack.push(Dr),_r.setCallbacks({onScrollCapture:Nr,onWheelCapture:Nr,onTouchMoveCapture:Lr}),document.addEventListener("wheel",zr,nonPassive),document.addEventListener("touchmove",zr,nonPassive),document.addEventListener("touchstart",Gr,nonPassive),function(){lockStack=lockStack.filter(function(Wr){return Wr!==Dr}),document.removeEventListener("wheel",zr,nonPassive),document.removeEventListener("touchmove",zr,nonPassive),document.removeEventListener("touchstart",Gr,nonPassive)}},[]);var Ur=_r.removeScrollBar,Vr=_r.inert;return reactExports.createElement(reactExports.Fragment,null,Vr?reactExports.createElement(Dr,{styles:generateStyle(Pr)}):null,Ur?reactExports.createElement(RemoveScrollBar,{gapMode:"margin"}):null)}const SideCar=exportSidecar(effectCar,RemoveScrollSideCar);var ReactRemoveScroll=reactExports.forwardRef(function(_r,Tr){return reactExports.createElement(RemoveScroll,__assign({},_r,{ref:Tr,sideCar:SideCar}))});ReactRemoveScroll.classNames=RemoveScroll.classNames;const $01b9c$RemoveScroll=ReactRemoveScroll,$cb5cc270b50c6fcd$var$POPOVER_NAME="Popover",[$cb5cc270b50c6fcd$var$createPopoverContext,$cb5cc270b50c6fcd$export$c8393c9e73286932]=$c512c27ab02ef895$export$50c7b4e9d9f19c1($cb5cc270b50c6fcd$var$POPOVER_NAME,[$cf1ac5d9fe0e8206$export$722aac194ae923]),$cb5cc270b50c6fcd$var$usePopperScope=$cf1ac5d9fe0e8206$export$722aac194ae923(),[$cb5cc270b50c6fcd$var$PopoverProvider,$cb5cc270b50c6fcd$var$usePopoverContext]=$cb5cc270b50c6fcd$var$createPopoverContext($cb5cc270b50c6fcd$var$POPOVER_NAME),$cb5cc270b50c6fcd$export$5b6b19405a83ff9d=_r=>{const{__scopePopover:Tr,children:Ar,open:Rr,defaultOpen:Pr,onOpenChange:Dr,modal:Mr=!1}=_r,Fr=$cb5cc270b50c6fcd$var$usePopperScope(Tr),zr=reactExports.useRef(null),[jr,Gr]=reactExports.useState(!1),[Nr=!1,Lr]=$71cd76cc60e0454e$export$6f32135080cb4c3({prop:Rr,defaultProp:Pr,onChange:Dr});return reactExports.createElement($cf1ac5d9fe0e8206$export$be92b6f5f03c0fe9,Fr,reactExports.createElement($cb5cc270b50c6fcd$var$PopoverProvider,{scope:Tr,contentId:$1746a345f3d73bb7$export$f680877a34711e37(),triggerRef:zr,open:Nr,onOpenChange:Lr,onOpenToggle:reactExports.useCallback(()=>Lr(Ur=>!Ur),[Lr]),hasCustomAnchor:jr,onCustomAnchorAdd:reactExports.useCallback(()=>Gr(!0),[]),onCustomAnchorRemove:reactExports.useCallback(()=>Gr(!1),[]),modal:Mr},Ar))},$cb5cc270b50c6fcd$var$TRIGGER_NAME="PopoverTrigger",$cb5cc270b50c6fcd$export$7dacb05d26466c3=reactExports.forwardRef((_r,Tr)=>{const{__scopePopover:Ar,...Rr}=_r,Pr=$cb5cc270b50c6fcd$var$usePopoverContext($cb5cc270b50c6fcd$var$TRIGGER_NAME,Ar),Dr=$cb5cc270b50c6fcd$var$usePopperScope(Ar),Mr=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(Tr,Pr.triggerRef),Fr=reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.button,_extends$1({type:"button","aria-haspopup":"dialog","aria-expanded":Pr.open,"aria-controls":Pr.contentId,"data-state":$cb5cc270b50c6fcd$var$getState(Pr.open)},Rr,{ref:Mr,onClick:$e42e1063c40fb3ef$export$b9ecd428b558ff10(_r.onClick,Pr.onOpenToggle)}));return Pr.hasCustomAnchor?Fr:reactExports.createElement($cf1ac5d9fe0e8206$export$b688253958b8dfe7,_extends$1({asChild:!0},Dr),Fr)}),$cb5cc270b50c6fcd$var$PORTAL_NAME="PopoverPortal",[$cb5cc270b50c6fcd$var$PortalProvider,$cb5cc270b50c6fcd$var$usePortalContext]=$cb5cc270b50c6fcd$var$createPopoverContext($cb5cc270b50c6fcd$var$PORTAL_NAME,{forceMount:void 0}),$cb5cc270b50c6fcd$var$CONTENT_NAME="PopoverContent",$cb5cc270b50c6fcd$export$d7e1f420b25549ff=reactExports.forwardRef((_r,Tr)=>{const Ar=$cb5cc270b50c6fcd$var$usePortalContext($cb5cc270b50c6fcd$var$CONTENT_NAME,_r.__scopePopover),{forceMount:Rr=Ar.forceMount,...Pr}=_r,Dr=$cb5cc270b50c6fcd$var$usePopoverContext($cb5cc270b50c6fcd$var$CONTENT_NAME,_r.__scopePopover);return reactExports.createElement($921a889cee6df7e8$export$99c2b779aa4e8b8b,{present:Rr||Dr.open},Dr.modal?reactExports.createElement($cb5cc270b50c6fcd$var$PopoverContentModal,_extends$1({},Pr,{ref:Tr})):reactExports.createElement($cb5cc270b50c6fcd$var$PopoverContentNonModal,_extends$1({},Pr,{ref:Tr})))}),$cb5cc270b50c6fcd$var$PopoverContentModal=reactExports.forwardRef((_r,Tr)=>{const Ar=$cb5cc270b50c6fcd$var$usePopoverContext($cb5cc270b50c6fcd$var$CONTENT_NAME,_r.__scopePopover),Rr=reactExports.useRef(null),Pr=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(Tr,Rr),Dr=reactExports.useRef(!1);return reactExports.useEffect(()=>{const Mr=Rr.current;if(Mr)return hideOthers(Mr)},[]),reactExports.createElement($01b9c$RemoveScroll,{as:$5e63c961fc1ce211$export$8c6ed5c666ac1360,allowPinchZoom:!0},reactExports.createElement($cb5cc270b50c6fcd$var$PopoverContentImpl,_extends$1({},_r,{ref:Pr,trapFocus:Ar.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:$e42e1063c40fb3ef$export$b9ecd428b558ff10(_r.onCloseAutoFocus,Mr=>{var Fr;Mr.preventDefault(),Dr.current||(Fr=Ar.triggerRef.current)===null||Fr===void 0||Fr.focus()}),onPointerDownOutside:$e42e1063c40fb3ef$export$b9ecd428b558ff10(_r.onPointerDownOutside,Mr=>{const Fr=Mr.detail.originalEvent,zr=Fr.button===0&&Fr.ctrlKey===!0,jr=Fr.button===2||zr;Dr.current=jr},{checkForDefaultPrevented:!1}),onFocusOutside:$e42e1063c40fb3ef$export$b9ecd428b558ff10(_r.onFocusOutside,Mr=>Mr.preventDefault(),{checkForDefaultPrevented:!1})})))}),$cb5cc270b50c6fcd$var$PopoverContentNonModal=reactExports.forwardRef((_r,Tr)=>{const Ar=$cb5cc270b50c6fcd$var$usePopoverContext($cb5cc270b50c6fcd$var$CONTENT_NAME,_r.__scopePopover),Rr=reactExports.useRef(!1),Pr=reactExports.useRef(!1);return reactExports.createElement($cb5cc270b50c6fcd$var$PopoverContentImpl,_extends$1({},_r,{ref:Tr,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:Dr=>{var Mr;if((Mr=_r.onCloseAutoFocus)===null||Mr===void 0||Mr.call(_r,Dr),!Dr.defaultPrevented){var Fr;Rr.current||(Fr=Ar.triggerRef.current)===null||Fr===void 0||Fr.focus(),Dr.preventDefault()}Rr.current=!1,Pr.current=!1},onInteractOutside:Dr=>{var Mr,Fr;(Mr=_r.onInteractOutside)===null||Mr===void 0||Mr.call(_r,Dr),Dr.defaultPrevented||(Rr.current=!0,Dr.detail.originalEvent.type==="pointerdown"&&(Pr.current=!0));const zr=Dr.target;((Fr=Ar.triggerRef.current)===null||Fr===void 0?void 0:Fr.contains(zr))&&Dr.preventDefault(),Dr.detail.originalEvent.type==="focusin"&&Pr.current&&Dr.preventDefault()}}))}),$cb5cc270b50c6fcd$var$PopoverContentImpl=reactExports.forwardRef((_r,Tr)=>{const{__scopePopover:Ar,trapFocus:Rr,onOpenAutoFocus:Pr,onCloseAutoFocus:Dr,disableOutsidePointerEvents:Mr,onEscapeKeyDown:Fr,onPointerDownOutside:zr,onFocusOutside:jr,onInteractOutside:Gr,...Nr}=_r,Lr=$cb5cc270b50c6fcd$var$usePopoverContext($cb5cc270b50c6fcd$var$CONTENT_NAME,Ar),Ur=$cb5cc270b50c6fcd$var$usePopperScope(Ar);return $3db38b7d1fb3fe6a$export$b7ece24a22aeda8c(),reactExports.createElement($d3863c46a17e8a28$export$20e40289641fbbb6,{asChild:!0,loop:!0,trapped:Rr,onMountAutoFocus:Pr,onUnmountAutoFocus:Dr},reactExports.createElement($5cb92bef7577960e$export$177fb62ff3ec1f22,{asChild:!0,disableOutsidePointerEvents:Mr,onInteractOutside:Gr,onEscapeKeyDown:Fr,onPointerDownOutside:zr,onFocusOutside:jr,onDismiss:()=>Lr.onOpenChange(!1)},reactExports.createElement($cf1ac5d9fe0e8206$export$7c6e2c02157bb7d2,_extends$1({"data-state":$cb5cc270b50c6fcd$var$getState(Lr.open),role:"dialog",id:Lr.contentId},Ur,Nr,{ref:Tr,style:{...Nr.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}}))))}),$cb5cc270b50c6fcd$var$CLOSE_NAME="PopoverClose",$cb5cc270b50c6fcd$export$d6ac43ebaa40d53e=reactExports.forwardRef((_r,Tr)=>{const{__scopePopover:Ar,...Rr}=_r,Pr=$cb5cc270b50c6fcd$var$usePopoverContext($cb5cc270b50c6fcd$var$CLOSE_NAME,Ar);return reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.button,_extends$1({type:"button"},Rr,{ref:Tr,onClick:$e42e1063c40fb3ef$export$b9ecd428b558ff10(_r.onClick,()=>Pr.onOpenChange(!1))}))}),$cb5cc270b50c6fcd$export$3152841115e061b2=reactExports.forwardRef((_r,Tr)=>{const{__scopePopover:Ar,...Rr}=_r,Pr=$cb5cc270b50c6fcd$var$usePopperScope(Ar);return reactExports.createElement($cf1ac5d9fe0e8206$export$21b07c8f274aebd5,_extends$1({},Pr,Rr,{ref:Tr}))});function $cb5cc270b50c6fcd$var$getState(_r){return _r?"open":"closed"}const $cb5cc270b50c6fcd$export$be92b6f5f03c0fe9=$cb5cc270b50c6fcd$export$5b6b19405a83ff9d,$cb5cc270b50c6fcd$export$41fb9f06171c75f4=$cb5cc270b50c6fcd$export$7dacb05d26466c3,$cb5cc270b50c6fcd$export$7c6e2c02157bb7d2=$cb5cc270b50c6fcd$export$d7e1f420b25549ff,$cb5cc270b50c6fcd$export$f39c2d165cd861fe=$cb5cc270b50c6fcd$export$d6ac43ebaa40d53e,$cb5cc270b50c6fcd$export$21b07c8f274aebd5=$cb5cc270b50c6fcd$export$3152841115e061b2;var openseadragon={exports:{}};(function(module){//! openseadragon 2.4.2
//! Built on 2020-03-05
//! Git commit: v2.4.2-0-c450749
//! http://openseadragon.github.io
//! License: http://openseadragon.github.io/license/
function OpenSeadragon(_r){return new OpenSeadragon.Viewer(_r)}(function(_r){_r.version={versionStr:"2.4.2",major:parseInt("2",10),minor:parseInt("4",10),revision:parseInt("2",10)};var Tr={"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object Array]":"array","[object Date]":"date","[object RegExp]":"regexp","[object Object]":"object"},Ar=Object.prototype.toString,Rr=Object.prototype.hasOwnProperty;_r.isFunction=function(Pr){return _r.type(Pr)==="function"},_r.isArray=Array.isArray||function(Pr){return _r.type(Pr)==="array"},_r.isWindow=function(Pr){return Pr&&typeof Pr=="object"&&"setInterval"in Pr},_r.type=function(Pr){return Pr==null?String(Pr):Tr[Ar.call(Pr)]||"object"},_r.isPlainObject=function(Pr){if(!Pr||OpenSeadragon.type(Pr)!=="object"||Pr.nodeType||_r.isWindow(Pr)||Pr.constructor&&!Rr.call(Pr,"constructor")&&!Rr.call(Pr.constructor.prototype,"isPrototypeOf"))return!1;var Dr;for(var Mr in Pr)Dr=Mr;return Dr===void 0||Rr.call(Pr,Dr)},_r.isEmptyObject=function(Pr){for(var Dr in Pr)return!1;return!0},_r.freezeObject=function(Pr){return Object.freeze?_r.freezeObject=Object.freeze:_r.freezeObject=function(Dr){return Dr},_r.freezeObject(Pr)},_r.supportsCanvas=function(){var Pr=document.createElement("canvas");return!!(_r.isFunction(Pr.getContext)&&Pr.getContext("2d"))}(),_r.isCanvasTainted=function(Pr){var Dr=!1;try{Pr.getContext("2d").getImageData(0,0,1,1)}catch{Dr=!0}return Dr},_r.pixelDensityRatio=function(){if(_r.supportsCanvas){var Pr=document.createElement("canvas").getContext("2d"),Dr=window.devicePixelRatio||1,Mr=Pr.webkitBackingStorePixelRatio||Pr.mozBackingStorePixelRatio||Pr.msBackingStorePixelRatio||Pr.oBackingStorePixelRatio||Pr.backingStorePixelRatio||1;return Math.max(Dr,1)/Mr}else return 1}()})(OpenSeadragon),function($){$.extend=function(){var _r,Tr,Ar,Rr,Pr,Dr,Mr=arguments[0]||{},Fr=arguments.length,zr=!1,jr=1;for(typeof Mr=="boolean"&&(zr=Mr,Mr=arguments[1]||{},jr=2),typeof Mr!="object"&&!OpenSeadragon.isFunction(Mr)&&(Mr={}),Fr===jr&&(Mr=this,--jr);jr<Fr;jr++)if(_r=arguments[jr],_r!==null||_r!==void 0)for(Tr in _r)Ar=Mr[Tr],Rr=_r[Tr],Mr!==Rr&&(zr&&Rr&&(OpenSeadragon.isPlainObject(Rr)||(Pr=OpenSeadragon.isArray(Rr)))?(Pr?(Pr=!1,Dr=Ar&&OpenSeadragon.isArray(Ar)?Ar:[]):Dr=Ar&&OpenSeadragon.isPlainObject(Ar)?Ar:{},Mr[Tr]=OpenSeadragon.extend(zr,Dr,Rr)):Rr!==void 0&&(Mr[Tr]=Rr));return Mr};var isIOSDevice=function(){if(typeof navigator!="object")return!1;var _r=navigator.userAgent;return typeof _r!="string"?!1:_r.indexOf("iPhone")!==-1||_r.indexOf("iPad")!==-1||_r.indexOf("iPod")!==-1};$.extend($,{DEFAULT_SETTINGS:{xmlPath:null,tileSources:null,tileHost:null,initialPage:0,crossOriginPolicy:!1,ajaxWithCredentials:!1,loadTilesWithAjax:!1,ajaxHeaders:{},panHorizontal:!0,panVertical:!0,constrainDuringPan:!1,wrapHorizontal:!1,wrapVertical:!1,visibilityRatio:.5,minPixelRatio:.5,defaultZoomLevel:0,minZoomLevel:null,maxZoomLevel:null,homeFillsViewer:!1,clickTimeThreshold:300,clickDistThreshold:5,dblClickTimeThreshold:300,dblClickDistThreshold:20,springStiffness:6.5,animationTime:1.2,gestureSettingsMouse:{scrollToZoom:!0,clickToZoom:!0,dblClickToZoom:!1,pinchToZoom:!1,zoomToRefPoint:!0,flickEnabled:!1,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},gestureSettingsTouch:{scrollToZoom:!1,clickToZoom:!1,dblClickToZoom:!0,pinchToZoom:!0,zoomToRefPoint:!0,flickEnabled:!0,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},gestureSettingsPen:{scrollToZoom:!1,clickToZoom:!0,dblClickToZoom:!1,pinchToZoom:!1,zoomToRefPoint:!0,flickEnabled:!1,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},gestureSettingsUnknown:{scrollToZoom:!1,clickToZoom:!1,dblClickToZoom:!0,pinchToZoom:!0,zoomToRefPoint:!0,flickEnabled:!0,flickMinSpeed:120,flickMomentum:.25,pinchRotate:!1},zoomPerClick:2,zoomPerScroll:1.2,zoomPerSecond:1,blendTime:0,alwaysBlend:!1,autoHideControls:!0,immediateRender:!1,minZoomImageRatio:.9,maxZoomPixelRatio:1.1,smoothTileEdgesMinZoom:1.1,iOSDevice:isIOSDevice(),pixelsPerWheelLine:40,pixelsPerArrowPress:40,autoResize:!0,preserveImageSizeOnResize:!1,minScrollDeltaTime:50,rotationIncrement:90,showSequenceControl:!0,sequenceControlAnchor:null,preserveViewport:!1,preserveOverlays:!1,navPrevNextWrap:!1,showNavigationControl:!0,navigationControlAnchor:null,showZoomControl:!0,showHomeControl:!0,showFullPageControl:!0,showRotationControl:!1,showFlipControl:!1,controlsFadeDelay:2e3,controlsFadeLength:1500,mouseNavEnabled:!0,showNavigator:!1,navigatorId:null,navigatorPosition:null,navigatorSizeRatio:.2,navigatorMaintainSizeRatio:!1,navigatorTop:null,navigatorLeft:null,navigatorHeight:null,navigatorWidth:null,navigatorAutoResize:!0,navigatorAutoFade:!0,navigatorRotate:!0,navigatorBackground:"#000",navigatorOpacity:.8,navigatorBorderColor:"#555",navigatorDisplayRegionColor:"#900",degrees:0,flipped:!1,opacity:1,preload:!1,compositeOperation:null,imageSmoothingEnabled:!0,placeholderFillStyle:null,showReferenceStrip:!1,referenceStripScroll:"horizontal",referenceStripElement:null,referenceStripHeight:null,referenceStripWidth:null,referenceStripPosition:"BOTTOM_LEFT",referenceStripSizeRatio:.2,collectionRows:3,collectionColumns:0,collectionLayout:"horizontal",collectionMode:!1,collectionTileSize:800,collectionTileMargin:80,imageLoaderLimit:0,maxImageCacheCount:200,timeout:3e4,useCanvas:!0,prefixUrl:"/images/",navImages:{zoomIn:{REST:"zoomin_rest.png",GROUP:"zoomin_grouphover.png",HOVER:"zoomin_hover.png",DOWN:"zoomin_pressed.png"},zoomOut:{REST:"zoomout_rest.png",GROUP:"zoomout_grouphover.png",HOVER:"zoomout_hover.png",DOWN:"zoomout_pressed.png"},home:{REST:"home_rest.png",GROUP:"home_grouphover.png",HOVER:"home_hover.png",DOWN:"home_pressed.png"},fullpage:{REST:"fullpage_rest.png",GROUP:"fullpage_grouphover.png",HOVER:"fullpage_hover.png",DOWN:"fullpage_pressed.png"},rotateleft:{REST:"rotateleft_rest.png",GROUP:"rotateleft_grouphover.png",HOVER:"rotateleft_hover.png",DOWN:"rotateleft_pressed.png"},rotateright:{REST:"rotateright_rest.png",GROUP:"rotateright_grouphover.png",HOVER:"rotateright_hover.png",DOWN:"rotateright_pressed.png"},flip:{REST:"flip_rest.png",GROUP:"flip_grouphover.png",HOVER:"flip_hover.png",DOWN:"flip_pressed.png"},previous:{REST:"previous_rest.png",GROUP:"previous_grouphover.png",HOVER:"previous_hover.png",DOWN:"previous_pressed.png"},next:{REST:"next_rest.png",GROUP:"next_grouphover.png",HOVER:"next_hover.png",DOWN:"next_pressed.png"}},debugMode:!1,debugGridColor:["#437AB2","#1B9E77","#D95F02","#7570B3","#E7298A","#66A61E","#E6AB02","#A6761D","#666666"]},SIGNAL:"----seadragon----",delegate:function(_r,Tr){return function(){var Ar=arguments;return Ar===void 0&&(Ar=[]),Tr.apply(_r,Ar)}},BROWSERS:{UNKNOWN:0,IE:1,FIREFOX:2,SAFARI:3,CHROME:4,OPERA:5},getElement:function(_r){return typeof _r=="string"&&(_r=document.getElementById(_r)),_r},getElementPosition:function(_r){var Tr=new $.Point,Ar,Rr;for(_r=$.getElement(_r),Ar=$.getElementStyle(_r).position=="fixed",Rr=getOffsetParent(_r,Ar);Rr;)Tr.x+=_r.offsetLeft,Tr.y+=_r.offsetTop,Ar&&(Tr=Tr.plus($.getPageScroll())),_r=Rr,Ar=$.getElementStyle(_r).position=="fixed",Rr=getOffsetParent(_r,Ar);return Tr},getElementOffset:function(_r){_r=$.getElement(_r);var Tr=_r&&_r.ownerDocument,Ar,Rr,Pr={top:0,left:0};return Tr?(Ar=Tr.documentElement,typeof _r.getBoundingClientRect<"u"&&(Pr=_r.getBoundingClientRect()),Rr=Tr==Tr.window?Tr:Tr.nodeType===9?Tr.defaultView||Tr.parentWindow:!1,new $.Point(Pr.left+(Rr.pageXOffset||Ar.scrollLeft)-(Ar.clientLeft||0),Pr.top+(Rr.pageYOffset||Ar.scrollTop)-(Ar.clientTop||0))):new $.Point},getElementSize:function(_r){return _r=$.getElement(_r),new $.Point(_r.clientWidth,_r.clientHeight)},getElementStyle:document.documentElement.currentStyle?function(_r){return _r=$.getElement(_r),_r.currentStyle}:function(_r){return _r=$.getElement(_r),window.getComputedStyle(_r,"")},getCssPropertyWithVendorPrefix:function(_r){var Tr={};return $.getCssPropertyWithVendorPrefix=function(Ar){if(Tr[Ar]!==void 0)return Tr[Ar];var Rr=document.createElement("div").style,Pr=null;if(Rr[Ar]!==void 0)Pr=Ar;else for(var Dr=["Webkit","Moz","MS","O","webkit","moz","ms","o"],Mr=$.capitalizeFirstLetter(Ar),Fr=0;Fr<Dr.length;Fr++){var zr=Dr[Fr]+Mr;if(Rr[zr]!==void 0){Pr=zr;break}}return Tr[Ar]=Pr,Pr},$.getCssPropertyWithVendorPrefix(_r)},capitalizeFirstLetter:function(_r){return _r.charAt(0).toUpperCase()+_r.slice(1)},positiveModulo:function(_r,Tr){var Ar=_r%Tr;return Ar<0&&(Ar+=Tr),Ar},pointInElement:function(_r,Tr){_r=$.getElement(_r);var Ar=$.getElementOffset(_r),Rr=$.getElementSize(_r);return Tr.x>=Ar.x&&Tr.x<Ar.x+Rr.x&&Tr.y<Ar.y+Rr.y&&Tr.y>=Ar.y},getEvent:function(_r){return _r?$.getEvent=function(Tr){return Tr}:$.getEvent=function(){return window.event},$.getEvent(_r)},getMousePosition:function(_r){if(typeof _r.pageX=="number")$.getMousePosition=function(Tr){var Ar=new $.Point;return Tr=$.getEvent(Tr),Ar.x=Tr.pageX,Ar.y=Tr.pageY,Ar};else if(typeof _r.clientX=="number")$.getMousePosition=function(Tr){var Ar=new $.Point;return Tr=$.getEvent(Tr),Ar.x=Tr.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,Ar.y=Tr.clientY+document.body.scrollTop+document.documentElement.scrollTop,Ar};else throw new Error("Unknown event mouse position, no known technique.");return $.getMousePosition(_r)},getPageScroll:function(){var _r=document.documentElement||{},Tr=document.body||{};if(typeof window.pageXOffset=="number")$.getPageScroll=function(){return new $.Point(window.pageXOffset,window.pageYOffset)};else if(Tr.scrollLeft||Tr.scrollTop)$.getPageScroll=function(){return new $.Point(document.body.scrollLeft,document.body.scrollTop)};else if(_r.scrollLeft||_r.scrollTop)$.getPageScroll=function(){return new $.Point(document.documentElement.scrollLeft,document.documentElement.scrollTop)};else return new $.Point(0,0);return $.getPageScroll()},setPageScroll:function(_r){if(typeof window.scrollTo<"u")$.setPageScroll=function(Rr){window.scrollTo(Rr.x,Rr.y)};else{var Tr=$.getPageScroll();if(Tr.x===_r.x&&Tr.y===_r.y)return;document.body.scrollLeft=_r.x,document.body.scrollTop=_r.y;var Ar=$.getPageScroll();if(Ar.x!==Tr.x&&Ar.y!==Tr.y){$.setPageScroll=function(Rr){document.body.scrollLeft=Rr.x,document.body.scrollTop=Rr.y};return}if(document.documentElement.scrollLeft=_r.x,document.documentElement.scrollTop=_r.y,Ar=$.getPageScroll(),Ar.x!==Tr.x&&Ar.y!==Tr.y){$.setPageScroll=function(Rr){document.documentElement.scrollLeft=Rr.x,document.documentElement.scrollTop=Rr.y};return}$.setPageScroll=function(Rr){}}return $.setPageScroll(_r)},getWindowSize:function(){var _r=document.documentElement||{},Tr=document.body||{};if(typeof window.innerWidth=="number")$.getWindowSize=function(){return new $.Point(window.innerWidth,window.innerHeight)};else if(_r.clientWidth||_r.clientHeight)$.getWindowSize=function(){return new $.Point(document.documentElement.clientWidth,document.documentElement.clientHeight)};else if(Tr.clientWidth||Tr.clientHeight)$.getWindowSize=function(){return new $.Point(document.body.clientWidth,document.body.clientHeight)};else throw new Error("Unknown window size, no known technique.");return $.getWindowSize()},makeCenteredNode:function(_r){_r=$.getElement(_r);var Tr=[$.makeNeutralElement("div"),$.makeNeutralElement("div"),$.makeNeutralElement("div")];return $.extend(Tr[0].style,{display:"table",height:"100%",width:"100%"}),$.extend(Tr[1].style,{display:"table-row"}),$.extend(Tr[2].style,{display:"table-cell",verticalAlign:"middle",textAlign:"center"}),Tr[0].appendChild(Tr[1]),Tr[1].appendChild(Tr[2]),Tr[2].appendChild(_r),Tr[0]},makeNeutralElement:function(_r){var Tr=document.createElement(_r),Ar=Tr.style;return Ar.background="transparent none",Ar.border="none",Ar.margin="0px",Ar.padding="0px",Ar.position="static",Tr},now:function(){return Date.now?$.now=Date.now:$.now=function(){return new Date().getTime()},$.now()},makeTransparentImage:function(_r){return $.makeTransparentImage=function(Tr){var Ar=$.makeNeutralElement("img");return Ar.src=Tr,Ar},$.Browser.vendor==$.BROWSERS.IE&&$.Browser.version<7&&($.makeTransparentImage=function(Tr){var Ar=$.makeNeutralElement("img"),Rr=null;return Rr=$.makeNeutralElement("span"),Rr.style.display="inline-block",Ar.onload=function(){Rr.style.width=Rr.style.width||Ar.width+"px",Rr.style.height=Rr.style.height||Ar.height+"px",Ar.onload=null,Ar=null},Ar.src=Tr,Rr.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+Tr+"', sizingMethod='scale')",Rr}),$.makeTransparentImage(_r)},setElementOpacity:function(_r,Tr,Ar){var Rr,Pr;_r=$.getElement(_r),Ar&&!$.Browser.alpha&&(Tr=Math.round(Tr)),$.Browser.opacity?_r.style.opacity=Tr<1?Tr:"":Tr<1?(Rr=Math.round(100*Tr),Pr="alpha(opacity="+Rr+")",_r.style.filter=Pr):_r.style.filter=""},setElementTouchActionNone:function(_r){_r=$.getElement(_r),typeof _r.style.touchAction<"u"?_r.style.touchAction="none":typeof _r.style.msTouchAction<"u"&&(_r.style.msTouchAction="none")},addClass:function(_r,Tr){_r=$.getElement(_r),_r.className?(" "+_r.className+" ").indexOf(" "+Tr+" ")===-1&&(_r.className+=" "+Tr):_r.className=Tr},indexOf:function(_r,Tr,Ar){return Array.prototype.indexOf?this.indexOf=function(Rr,Pr,Dr){return Rr.indexOf(Pr,Dr)}:this.indexOf=function(Rr,Pr,Dr){var Mr,Fr=Dr||0,zr;if(!Rr)throw new TypeError;if(zr=Rr.length,zr===0||Fr>=zr)return-1;for(Fr<0&&(Fr=zr-Math.abs(Fr)),Mr=Fr;Mr<zr;Mr++)if(Rr[Mr]===Pr)return Mr;return-1},this.indexOf(_r,Tr,Ar)},removeClass:function(_r,Tr){var Ar,Rr=[],Pr;for(_r=$.getElement(_r),Ar=_r.className.split(/\s+/),Pr=0;Pr<Ar.length;Pr++)Ar[Pr]&&Ar[Pr]!==Tr&&Rr.push(Ar[Pr]);_r.className=Rr.join(" ")},addEvent:function(){if(window.addEventListener)return function(_r,Tr,Ar,Rr){_r=$.getElement(_r),_r.addEventListener(Tr,Ar,Rr)};if(window.attachEvent)return function(_r,Tr,Ar,Rr){_r=$.getElement(_r),_r.attachEvent("on"+Tr,Ar)};throw new Error("No known event model.")}(),removeEvent:function(){if(window.removeEventListener)return function(_r,Tr,Ar,Rr){_r=$.getElement(_r),_r.removeEventListener(Tr,Ar,Rr)};if(window.detachEvent)return function(_r,Tr,Ar,Rr){_r=$.getElement(_r),_r.detachEvent("on"+Tr,Ar)};throw new Error("No known event model.")}(),cancelEvent:function(_r){_r=$.getEvent(_r),_r.preventDefault?$.cancelEvent=function(Tr){Tr.preventDefault()}:$.cancelEvent=function(Tr){Tr=$.getEvent(Tr),Tr.cancel=!0,Tr.returnValue=!1},$.cancelEvent(_r)},stopEvent:function(_r){_r=$.getEvent(_r),_r.stopPropagation?$.stopEvent=function(Tr){Tr.stopPropagation()}:$.stopEvent=function(Tr){Tr=$.getEvent(Tr),Tr.cancelBubble=!0},$.stopEvent(_r)},createCallback:function(_r,Tr){var Ar=[],Rr;for(Rr=2;Rr<arguments.length;Rr++)Ar.push(arguments[Rr]);return function(){var Pr=Ar.concat([]),Dr;for(Dr=0;Dr<arguments.length;Dr++)Pr.push(arguments[Dr]);return Tr.apply(_r,Pr)}},getUrlParameter:function(_r){var Tr=URLPARAMS[_r];return Tr||null},getUrlProtocol:function(_r){var Tr=_r.match(/^([a-z]+:)\/\//i);return Tr===null?window.location.protocol:Tr[1].toLowerCase()},createAjaxRequest:function(_r){var Tr;try{Tr=!!new ActiveXObject("Microsoft.XMLHTTP")}catch{Tr=!1}if(Tr)window.XMLHttpRequest?$.createAjaxRequest=function(Ar){return Ar?new ActiveXObject("Microsoft.XMLHTTP"):new XMLHttpRequest}:$.createAjaxRequest=function(){return new ActiveXObject("Microsoft.XMLHTTP")};else if(window.XMLHttpRequest)$.createAjaxRequest=function(){return new XMLHttpRequest};else throw new Error("Browser doesn't support XMLHttpRequest.");return $.createAjaxRequest(_r)},makeAjaxRequest:function(_r,Tr,Ar){var Rr,Pr,Dr;$.isPlainObject(_r)&&(Tr=_r.success,Ar=_r.error,Rr=_r.withCredentials,Pr=_r.headers,Dr=_r.responseType||null,_r=_r.url);var Mr=$.getUrlProtocol(_r),Fr=$.createAjaxRequest(Mr==="file:");if(!$.isFunction(Tr))throw new Error("makeAjaxRequest requires a success callback");Fr.onreadystatechange=function(){Fr.readyState==4&&(Fr.onreadystatechange=function(){},Fr.status>=200&&Fr.status<300||Fr.status===0&&Mr!=="http:"&&Mr!=="https:"?Tr(Fr):($.console.log("AJAX request returned %d: %s",Fr.status,_r),$.isFunction(Ar)&&Ar(Fr)))};try{if(Fr.open("GET",_r,!0),Dr&&(Fr.responseType=Dr),Pr)for(var zr in Pr)Object.prototype.hasOwnProperty.call(Pr,zr)&&Pr[zr]&&Fr.setRequestHeader(zr,Pr[zr]);Rr&&(Fr.withCredentials=!0),Fr.send(null)}catch(Lr){var jr=Lr.message,Gr=$.Browser.vendor==$.BROWSERS.IE&&$.Browser.version<10;if(Gr&&typeof Lr.number<"u"&&Lr.number==-2147024891&&(jr+=`
See http://msdn.microsoft.com/en-us/library/ms537505(v=vs.85).aspx#xdomain`),$.console.log("%s while making AJAX request: %s",Lr.name,jr),Fr.onreadystatechange=function(){},window.XDomainRequest){var Nr=new window.XDomainRequest;if(Nr){Nr.onload=function(Ur){$.isFunction(Tr)&&Tr({responseText:Nr.responseText,status:200,statusText:"OK"})},Nr.onerror=function(Ur){$.isFunction(Ar)&&Ar({responseText:Nr.responseText,status:444,statusText:"An error happened. Due to an XDomainRequest deficiency we can not extract any information about this error. Upgrade your browser."})};try{Nr.open("GET",_r),Nr.send()}catch{$.isFunction(Ar)&&Ar(Fr,Lr)}}}else $.isFunction(Ar)&&Ar(Fr,Lr)}return Fr},jsonp:function(_r){var Tr,Ar=_r.url,Rr=document.head||document.getElementsByTagName("head")[0]||document.documentElement,Pr=_r.callbackName||"openseadragon"+$.now(),Dr=window[Pr],Mr="$1"+Pr+"$2",Fr=_r.param||"callback",zr=_r.callback;Ar=Ar.replace(/(\=)\?(&|$)|\?\?/i,Mr),Ar+=(/\?/.test(Ar)?"&":"?")+Fr+"="+Pr,window[Pr]=function(jr){if(Dr)window[Pr]=Dr;else try{delete window[Pr]}catch{}zr&&$.isFunction(zr)&&zr(jr)},Tr=document.createElement("script"),(_r.async!==void 0||_r.async!==!1)&&(Tr.async="async"),_r.scriptCharset&&(Tr.charset=_r.scriptCharset),Tr.src=Ar,Tr.onload=Tr.onreadystatechange=function(jr,Gr){(Gr||!Tr.readyState||/loaded|complete/.test(Tr.readyState))&&(Tr.onload=Tr.onreadystatechange=null,Rr&&Tr.parentNode&&Rr.removeChild(Tr),Tr=void 0)},Rr.insertBefore(Tr,Rr.firstChild)},createFromDZI:function(){throw"OpenSeadragon.createFromDZI is deprecated, use Viewer.open."},parseXml:function(_r){if(window.DOMParser)$.parseXml=function(Tr){var Ar=null,Rr;return Rr=new DOMParser,Ar=Rr.parseFromString(Tr,"text/xml"),Ar};else if(window.ActiveXObject)$.parseXml=function(Tr){var Ar=null;return Ar=new ActiveXObject("Microsoft.XMLDOM"),Ar.async=!1,Ar.loadXML(Tr),Ar};else throw new Error("Browser doesn't support XML DOM.");return $.parseXml(_r)},parseJSON:function(string){return window.JSON&&window.JSON.parse?$.parseJSON=window.JSON.parse:$.parseJSON=function(string){return eval("("+string+")")},$.parseJSON(string)},imageFormatSupported:function(_r){return _r=_r||"",!!FILEFORMATS[_r.toLowerCase()]}});var nullfunction=function(_r){};$.console=window.console||{log:nullfunction,debug:nullfunction,info:nullfunction,warn:nullfunction,error:nullfunction,assert:nullfunction},$.Browser={vendor:$.BROWSERS.UNKNOWN,version:0,alpha:!0};var FILEFORMATS={bmp:!1,jpeg:!0,jpg:!0,png:!0,tif:!1,wdp:!1},URLPARAMS={};(function(){var _r=navigator.appVersion,Tr=navigator.userAgent,Ar;switch(navigator.appName){case"Microsoft Internet Explorer":window.attachEvent&&window.ActiveXObject&&($.Browser.vendor=$.BROWSERS.IE,$.Browser.version=parseFloat(Tr.substring(Tr.indexOf("MSIE")+5,Tr.indexOf(";",Tr.indexOf("MSIE")))));break;case"Netscape":window.addEventListener&&(Tr.indexOf("Firefox")>=0?($.Browser.vendor=$.BROWSERS.FIREFOX,$.Browser.version=parseFloat(Tr.substring(Tr.indexOf("Firefox")+8))):Tr.indexOf("Safari")>=0?($.Browser.vendor=Tr.indexOf("Chrome")>=0?$.BROWSERS.CHROME:$.BROWSERS.SAFARI,$.Browser.version=parseFloat(Tr.substring(Tr.substring(0,Tr.indexOf("Safari")).lastIndexOf("/")+1,Tr.indexOf("Safari")))):(Ar=new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})"),Ar.exec(Tr)!==null&&($.Browser.vendor=$.BROWSERS.IE,$.Browser.version=parseFloat(RegExp.$1))));break;case"Opera":$.Browser.vendor=$.BROWSERS.OPERA,$.Browser.version=parseFloat(_r);break}var Rr=window.location.search.substring(1),Pr=Rr.split("&"),Dr,Mr,Fr;for(Fr=0;Fr<Pr.length;Fr++)if(Dr=Pr[Fr],Mr=Dr.indexOf("="),Mr>0){var zr=Dr.substring(0,Mr),jr=Dr.substring(Mr+1);try{URLPARAMS[zr]=decodeURIComponent(jr)}catch{$.console.error("Ignoring malformed URL parameter: %s=%s",zr,jr)}}$.Browser.alpha=!($.Browser.vendor==$.BROWSERS.IE&&$.Browser.version<9||$.Browser.vendor==$.BROWSERS.CHROME&&$.Browser.version<2),$.Browser.opacity=!($.Browser.vendor==$.BROWSERS.IE&&$.Browser.version<9)})(),function(_r){var Tr=_r.requestAnimationFrame||_r.mozRequestAnimationFrame||_r.webkitRequestAnimationFrame||_r.msRequestAnimationFrame,Ar=_r.cancelAnimationFrame||_r.mozCancelAnimationFrame||_r.webkitCancelAnimationFrame||_r.msCancelAnimationFrame;if(Tr&&Ar)$.requestAnimationFrame=function(){return Tr.apply(_r,arguments)},$.cancelAnimationFrame=function(){return Ar.apply(_r,arguments)};else{var Rr=[],Pr=[],Dr=0,Mr;$.requestAnimationFrame=function(Fr){return Rr.push([++Dr,Fr]),Mr||(Mr=setInterval(function(){if(Rr.length){var zr=$.now(),jr=Pr;for(Pr=Rr,Rr=jr;Pr.length;)Pr.shift()[1](zr)}else clearInterval(Mr),Mr=void 0},1e3/50)),Dr},$.cancelAnimationFrame=function(Fr){var zr,jr;for(zr=0,jr=Rr.length;zr<jr;zr+=1)if(Rr[zr][0]===Fr){Rr.splice(zr,1);return}for(zr=0,jr=Pr.length;zr<jr;zr+=1)if(Pr[zr][0]===Fr){Pr.splice(zr,1);return}}}}(window);function getOffsetParent(_r,Tr){return Tr&&_r!=document.body?document.body:_r.offsetParent}}(OpenSeadragon),function(_r,Tr){module.exports?module.exports=Tr():_r.OpenSeadragon=Tr()}(commonjsGlobal,function(){return OpenSeadragon}),function(_r){var Tr={supportsFullScreen:!1,isFullScreen:function(){return!1},getFullScreenElement:function(){return null},requestFullScreen:function(){},exitFullScreen:function(){},cancelFullScreen:function(){},fullScreenEventName:"",fullScreenErrorEventName:""};document.exitFullscreen?(Tr.supportsFullScreen=!0,Tr.getFullScreenElement=function(){return document.fullscreenElement},Tr.requestFullScreen=function(Ar){return Ar.requestFullscreen()},Tr.exitFullScreen=function(){document.exitFullscreen()},Tr.fullScreenEventName="fullscreenchange",Tr.fullScreenErrorEventName="fullscreenerror"):document.msExitFullscreen?(Tr.supportsFullScreen=!0,Tr.getFullScreenElement=function(){return document.msFullscreenElement},Tr.requestFullScreen=function(Ar){return Ar.msRequestFullscreen()},Tr.exitFullScreen=function(){document.msExitFullscreen()},Tr.fullScreenEventName="MSFullscreenChange",Tr.fullScreenErrorEventName="MSFullscreenError"):document.webkitExitFullscreen?(Tr.supportsFullScreen=!0,Tr.getFullScreenElement=function(){return document.webkitFullscreenElement},Tr.requestFullScreen=function(Ar){return Ar.webkitRequestFullscreen()},Tr.exitFullScreen=function(){document.webkitExitFullscreen()},Tr.fullScreenEventName="webkitfullscreenchange",Tr.fullScreenErrorEventName="webkitfullscreenerror"):document.webkitCancelFullScreen?(Tr.supportsFullScreen=!0,Tr.getFullScreenElement=function(){return document.webkitCurrentFullScreenElement},Tr.requestFullScreen=function(Ar){return Ar.webkitRequestFullScreen()},Tr.exitFullScreen=function(){document.webkitCancelFullScreen()},Tr.fullScreenEventName="webkitfullscreenchange",Tr.fullScreenErrorEventName="webkitfullscreenerror"):document.mozCancelFullScreen&&(Tr.supportsFullScreen=!0,Tr.getFullScreenElement=function(){return document.mozFullScreenElement},Tr.requestFullScreen=function(Ar){return Ar.mozRequestFullScreen()},Tr.exitFullScreen=function(){document.mozCancelFullScreen()},Tr.fullScreenEventName="mozfullscreenchange",Tr.fullScreenErrorEventName="mozfullscreenerror"),Tr.isFullScreen=function(){return Tr.getFullScreenElement()!==null},Tr.cancelFullScreen=function(){_r.console.error("cancelFullScreen is deprecated. Use exitFullScreen instead."),Tr.exitFullScreen()},_r.extend(_r,Tr)}(OpenSeadragon),function(_r){_r.EventSource=function(){this.events={}},_r.EventSource.prototype={addOnceHandler:function(Tr,Ar,Rr,Pr){var Dr=this;Pr=Pr||1;var Mr=0,Fr=function(zr){Mr++,Mr===Pr&&Dr.removeHandler(Tr,Fr),Ar(zr)};this.addHandler(Tr,Fr,Rr)},addHandler:function(Tr,Ar,Rr){var Pr=this.events[Tr];Pr||(this.events[Tr]=Pr=[]),Ar&&_r.isFunction(Ar)&&(Pr[Pr.length]={handler:Ar,userData:Rr||null})},removeHandler:function(Tr,Ar){var Rr=this.events[Tr],Pr=[],Dr;if(Rr&&_r.isArray(Rr)){for(Dr=0;Dr<Rr.length;Dr++)Rr[Dr].handler!==Ar&&Pr.push(Rr[Dr]);this.events[Tr]=Pr}},removeAllHandlers:function(Tr){if(Tr)this.events[Tr]=[];else for(var Ar in this.events)this.events[Ar]=[]},getHandler:function(Tr){var Ar=this.events[Tr];return!Ar||!Ar.length?null:(Ar=Ar.length===1?[Ar[0]]:Array.apply(null,Ar),function(Rr,Pr){var Dr,Mr=Ar.length;for(Dr=0;Dr<Mr;Dr++)Ar[Dr]&&(Pr.eventSource=Rr,Pr.userData=Ar[Dr].userData,Ar[Dr].handler(Pr))})},raiseEvent:function(Tr,Ar){var Rr=this.getHandler(Tr);Rr&&(Ar||(Ar={}),Rr(this,Ar))}}}(OpenSeadragon),function(_r){var Tr=[],Ar={};_r.MouseTracker=function(gs){Tr.push(this);var hs=arguments;_r.isPlainObject(gs)||(gs={element:hs[0],clickTimeThreshold:hs[1],clickDistThreshold:hs[2]}),this.hash=Math.random(),this.element=_r.getElement(gs.element),this.clickTimeThreshold=gs.clickTimeThreshold||_r.DEFAULT_SETTINGS.clickTimeThreshold,this.clickDistThreshold=gs.clickDistThreshold||_r.DEFAULT_SETTINGS.clickDistThreshold,this.dblClickTimeThreshold=gs.dblClickTimeThreshold||_r.DEFAULT_SETTINGS.dblClickTimeThreshold,this.dblClickDistThreshold=gs.dblClickDistThreshold||_r.DEFAULT_SETTINGS.dblClickDistThreshold,this.userData=gs.userData||null,this.stopDelay=gs.stopDelay||50,this.enterHandler=gs.enterHandler||null,this.exitHandler=gs.exitHandler||null,this.pressHandler=gs.pressHandler||null,this.nonPrimaryPressHandler=gs.nonPrimaryPressHandler||null,this.releaseHandler=gs.releaseHandler||null,this.nonPrimaryReleaseHandler=gs.nonPrimaryReleaseHandler||null,this.moveHandler=gs.moveHandler||null,this.scrollHandler=gs.scrollHandler||null,this.clickHandler=gs.clickHandler||null,this.dblClickHandler=gs.dblClickHandler||null,this.dragHandler=gs.dragHandler||null,this.dragEndHandler=gs.dragEndHandler||null,this.pinchHandler=gs.pinchHandler||null,this.stopHandler=gs.stopHandler||null,this.keyDownHandler=gs.keyDownHandler||null,this.keyUpHandler=gs.keyUpHandler||null,this.keyHandler=gs.keyHandler||null,this.focusHandler=gs.focusHandler||null,this.blurHandler=gs.blurHandler||null;var Ps=this;Ar[this.hash]={click:function(ks){Vr(Ps,ks)},dblclick:function(ks){Wr(Ps,ks)},keydown:function(ks){qr(Ps,ks)},keyup:function(ks){Kr(Ps,ks)},keypress:function(ks){Xr(Ps,ks)},focus:function(ks){Zr(Ps,ks)},blur:function(ks){_i(Ps,ks)},wheel:function(ks){Jr(Ps,ks)},mousewheel:function(ks){es(Ps,ks)},DOMMouseScroll:function(ks){es(Ps,ks)},MozMousePixelScroll:function(ks){es(Ps,ks)},mouseenter:function(ks){rs(Ps,ks)},mouseleave:function(ks){fs(Ps,ks)},mouseover:function(ks){as(Ps,ks)},mouseout:function(ks){Ts(Ps,ks)},mousedown:function(ks){ys(Ps,ks)},mouseup:function(ks){ps(Ps,ks)},mouseupcaptured:function(ks){vs(Ps,ks)},mousemove:function(ks){js(Ps,ks)},mousemovecaptured:function(ks){zs(Ps,ks)},touchstart:function(ks){Qs(Ps,ks)},touchend:function(ks){no(Ps,ks)},touchendcaptured:function(ks){yo(Ps,ks)},touchmove:function(ks){lo(Ps,ks)},touchmovecaptured:function(ks){vo(Ps,ks)},touchcancel:function(ks){Co(Ps,ks)},gesturestart:function(ks){Do(Ps,ks)},gesturechange:function(ks){ds(Ps,ks)},pointerover:function(ks){Os(Ps,ks)},MSPointerOver:function(ks){Os(Ps,ks)},pointerout:function(ks){Ws(Ps,ks)},MSPointerOut:function(ks){Ws(Ps,ks)},pointerdown:function(ks){to(Ps,ks)},MSPointerDown:function(ks){to(Ps,ks)},pointerup:function(ks){io(Ps,ks)},MSPointerUp:function(ks){io(Ps,ks)},pointermove:function(ks){To(Ps,ks)},MSPointerMove:function(ks){To(Ps,ks)},pointercancel:function(ks){Io(Ps,ks)},MSPointerCancel:function(ks){Io(Ps,ks)},pointerupcaptured:function(ks){ko(Ps,ks)},pointermovecaptured:function(ks){Ho(Ps,ks)},tracking:!1,activePointersLists:[],lastClickPos:null,dblClickTimeOut:null,pinchGPoints:[],lastPinchDist:0,currentPinchDist:0,lastPinchCenter:null,currentPinchCenter:null},gs.startDisabled||this.setTracking(!0)},_r.MouseTracker.prototype={destroy:function(){var gs;for(Dr(this),this.element=null,gs=0;gs<Tr.length;gs++)if(Tr[gs]===this){Tr.splice(gs,1);break}Ar[this.hash]=null,delete Ar[this.hash]},isTracking:function(){return Ar[this.hash].tracking},setTracking:function(gs){return gs?Pr(this):Dr(this),this},getActivePointersListsExceptType:function(gs){for(var hs=Ar[this.hash],Ps=[],ks=0;ks<hs.activePointersLists.length;++ks)hs.activePointersLists[ks].type!==gs&&Ps.push(hs.activePointersLists[ks]);return Ps},getActivePointersListByType:function(gs){var hs=Ar[this.hash],Ps,ks=hs.activePointersLists.length,Zs;for(Ps=0;Ps<ks;Ps++)if(hs.activePointersLists[Ps].type===gs)return hs.activePointersLists[Ps];return Zs=new _r.MouseTracker.GesturePointList(gs),hs.activePointersLists.push(Zs),Zs},getActivePointerCount:function(){var gs=Ar[this.hash],hs,Ps=gs.activePointersLists.length,ks=0;for(hs=0;hs<Ps;hs++)ks+=gs.activePointersLists[hs].getLength();return ks},enterHandler:function(){},exitHandler:function(){},pressHandler:function(){},nonPrimaryPressHandler:function(){},releaseHandler:function(){},nonPrimaryReleaseHandler:function(){},moveHandler:function(){},scrollHandler:function(){},clickHandler:function(){},dblClickHandler:function(){},dragHandler:function(){},dragEndHandler:function(){},pinchHandler:function(){},stopHandler:function(){},keyDownHandler:function(){},keyUpHandler:function(){},keyHandler:function(){},focusHandler:function(){},blurHandler:function(){}},_r.MouseTracker.resetAllMouseTrackers=function(){for(var gs=0;gs<Tr.length;gs++)Tr[gs].isTracking()&&(Tr[gs].setTracking(!1),Tr[gs].setTracking(!0))},_r.MouseTracker.gesturePointVelocityTracker=function(){var gs=[],hs=0,Ps=0,ks=function(eo,Po){return eo.hash.toString()+Po.type+Po.id.toString()},Zs=function(){var eo,Po=gs.length,qo,zo,Hs=_r.now(),wo,xo,Yl;for(wo=Hs-Ps,Ps=Hs,eo=0;eo<Po;eo++)qo=gs[eo],zo=qo.gPoint,zo.direction=Math.atan2(zo.currentPos.y-qo.lastPos.y,zo.currentPos.x-qo.lastPos.x),xo=qo.lastPos.distanceTo(zo.currentPos),qo.lastPos=zo.currentPos,Yl=1e3*xo/(wo+1),zo.speed=.75*Yl+.25*zo.speed},bo=function(eo,Po){var qo=ks(eo,Po);gs.push({guid:qo,gPoint:Po,lastPos:Po.currentPos}),gs.length===1&&(Ps=_r.now(),hs=window.setInterval(Zs,50))},ho=function(eo,Po){var qo=ks(eo,Po),zo,Hs=gs.length;for(zo=0;zo<Hs;zo++)if(gs[zo].guid===qo){gs.splice(zo,1),Hs--,Hs===0&&window.clearInterval(hs);break}};return{addPoint:bo,removePoint:ho}}(),_r.MouseTracker.captureElement=document,_r.MouseTracker.wheelEventName=_r.Browser.vendor==_r.BROWSERS.IE&&_r.Browser.version>8||"onwheel"in document.createElement("div")?"wheel":document.onmousewheel!==void 0?"mousewheel":"DOMMouseScroll",_r.MouseTracker.supportsMouseCapture=function(){var gs=document.createElement("div");return _r.isFunction(gs.setCapture)&&_r.isFunction(gs.releaseCapture)}(),_r.MouseTracker.subscribeEvents=["click","dblclick","keydown","keyup","keypress","focus","blur",_r.MouseTracker.wheelEventName],_r.MouseTracker.wheelEventName=="DOMMouseScroll"&&_r.MouseTracker.subscribeEvents.push("MozMousePixelScroll"),window.PointerEvent&&(window.navigator.pointerEnabled||_r.Browser.vendor!==_r.BROWSERS.IE)?(_r.MouseTracker.havePointerEvents=!0,_r.MouseTracker.subscribeEvents.push("pointerover","pointerout","pointerdown","pointerup","pointermove","pointercancel"),_r.MouseTracker.unprefixedPointerEvents=!0,navigator.maxTouchPoints?_r.MouseTracker.maxTouchPoints=navigator.maxTouchPoints:_r.MouseTracker.maxTouchPoints=0,_r.MouseTracker.haveMouseEnter=!1):window.MSPointerEvent&&window.navigator.msPointerEnabled?(_r.MouseTracker.havePointerEvents=!0,_r.MouseTracker.subscribeEvents.push("MSPointerOver","MSPointerOut","MSPointerDown","MSPointerUp","MSPointerMove","MSPointerCancel"),_r.MouseTracker.unprefixedPointerEvents=!1,navigator.msMaxTouchPoints?_r.MouseTracker.maxTouchPoints=navigator.msMaxTouchPoints:_r.MouseTracker.maxTouchPoints=0,_r.MouseTracker.haveMouseEnter=!1):(_r.MouseTracker.havePointerEvents=!1,_r.Browser.vendor===_r.BROWSERS.IE&&_r.Browser.version<9?(_r.MouseTracker.subscribeEvents.push("mouseenter","mouseleave"),_r.MouseTracker.haveMouseEnter=!0):(_r.MouseTracker.subscribeEvents.push("mouseover","mouseout"),_r.MouseTracker.haveMouseEnter=!1),_r.MouseTracker.subscribeEvents.push("mousedown","mouseup","mousemove"),"ontouchstart"in window&&_r.MouseTracker.subscribeEvents.push("touchstart","touchend","touchmove","touchcancel"),"ongesturestart"in window&&_r.MouseTracker.subscribeEvents.push("gesturestart","gesturechange"),_r.MouseTracker.mousePointerId="legacy-mouse",_r.MouseTracker.maxTouchPoints=10),_r.MouseTracker.GesturePointList=function(gs){this._gPoints=[],this.type=gs,this.buttons=0,this.contacts=0,this.clicks=0,this.captureCount=0},_r.MouseTracker.GesturePointList.prototype={getLength:function(){return this._gPoints.length},asArray:function(){return this._gPoints},add:function(gs){return this._gPoints.push(gs)},removeById:function(gs){var hs,Ps=this._gPoints.length;for(hs=0;hs<Ps;hs++)if(this._gPoints[hs].id===gs){this._gPoints.splice(hs,1);break}return this._gPoints.length},getByIndex:function(gs){return gs<this._gPoints.length?this._gPoints[gs]:null},getById:function(gs){var hs,Ps=this._gPoints.length;for(hs=0;hs<Ps;hs++)if(this._gPoints[hs].id===gs)return this._gPoints[hs];return null},getPrimary:function(gs){var hs,Ps=this._gPoints.length;for(hs=0;hs<Ps;hs++)if(this._gPoints[hs].isPrimary)return this._gPoints[hs];return null},addContact:function(){++this.contacts,this.contacts>1&&(this.type==="mouse"||this.type==="pen")&&(this.contacts=1)},removeContact:function(){--this.contacts,this.contacts<0&&(this.contacts=0)}};function Rr(gs){var hs=Ar[gs.hash],Ps,ks=hs.activePointersLists.length;for(Ps=0;Ps<ks;Ps++)hs.activePointersLists[Ps].captureCount>0&&(_r.removeEvent(_r.MouseTracker.captureElement,"mousemove",hs.mousemovecaptured,!0),_r.removeEvent(_r.MouseTracker.captureElement,"mouseup",hs.mouseupcaptured,!0),_r.removeEvent(_r.MouseTracker.captureElement,_r.MouseTracker.unprefixedPointerEvents?"pointermove":"MSPointerMove",hs.pointermovecaptured,!0),_r.removeEvent(_r.MouseTracker.captureElement,_r.MouseTracker.unprefixedPointerEvents?"pointerup":"MSPointerUp",hs.pointerupcaptured,!0),_r.removeEvent(_r.MouseTracker.captureElement,"touchmove",hs.touchmovecaptured,!0),_r.removeEvent(_r.MouseTracker.captureElement,"touchend",hs.touchendcaptured,!0),hs.activePointersLists[Ps].captureCount=0);for(Ps=0;Ps<ks;Ps++)hs.activePointersLists.pop()}function Pr(gs){var hs=Ar[gs.hash],Ps,ks;if(!hs.tracking){for(ks=0;ks<_r.MouseTracker.subscribeEvents.length;ks++)Ps=_r.MouseTracker.subscribeEvents[ks],_r.addEvent(gs.element,Ps,hs[Ps],!1);Rr(gs),hs.tracking=!0}}function Dr(gs){var hs=Ar[gs.hash],Ps,ks;if(hs.tracking){for(ks=0;ks<_r.MouseTracker.subscribeEvents.length;ks++)Ps=_r.MouseTracker.subscribeEvents[ks],_r.removeEvent(gs.element,Ps,hs[Ps],!1);Rr(gs),hs.tracking=!1}}function Mr(gs,hs){var Ps=Ar[gs.hash];if(hs==="pointerevent")return{upName:_r.MouseTracker.unprefixedPointerEvents?"pointerup":"MSPointerUp",upHandler:Ps.pointerupcaptured,moveName:_r.MouseTracker.unprefixedPointerEvents?"pointermove":"MSPointerMove",moveHandler:Ps.pointermovecaptured};if(hs==="mouse")return{upName:"mouseup",upHandler:Ps.mouseupcaptured,moveName:"mousemove",moveHandler:Ps.mousemovecaptured};if(hs==="touch")return{upName:"touchend",upHandler:Ps.touchendcaptured,moveName:"touchmove",moveHandler:Ps.touchmovecaptured};throw new Error("MouseTracker.getCaptureEventParams: Unknown pointer type.")}function Fr(gs,hs,Ps){var ks=gs.getActivePointersListByType(hs),Zs;ks.captureCount+=Ps||1,ks.captureCount===1&&(_r.Browser.vendor===_r.BROWSERS.IE&&_r.Browser.version<9?gs.element.setCapture(!0):(Zs=Mr(gs,_r.MouseTracker.havePointerEvents?"pointerevent":hs),Fs&&Ks(window.top)&&_r.addEvent(window.top,Zs.upName,Zs.upHandler,!0),_r.addEvent(_r.MouseTracker.captureElement,Zs.upName,Zs.upHandler,!0),_r.addEvent(_r.MouseTracker.captureElement,Zs.moveName,Zs.moveHandler,!0)))}function zr(gs,hs,Ps){var ks=gs.getActivePointersListByType(hs),Zs;ks.captureCount-=Ps||1,ks.captureCount===0&&(_r.Browser.vendor===_r.BROWSERS.IE&&_r.Browser.version<9?gs.element.releaseCapture():(Zs=Mr(gs,_r.MouseTracker.havePointerEvents?"pointerevent":hs),Fs&&Ks(window.top)&&_r.removeEvent(window.top,Zs.upName,Zs.upHandler,!0),_r.removeEvent(_r.MouseTracker.captureElement,Zs.moveName,Zs.moveHandler,!0),_r.removeEvent(_r.MouseTracker.captureElement,Zs.upName,Zs.upHandler,!0)))}function jr(gs){var hs;if(_r.MouseTracker.unprefixedPointerEvents)hs=gs.pointerType;else switch(gs.pointerType){case 2:hs="touch";break;case 3:hs="pen";break;case 4:hs="mouse";break;default:hs=""}return hs}function Gr(gs){return _r.getMousePosition(gs)}function Nr(gs,hs){return Lr(Gr(gs),hs)}function Lr(gs,hs){var Ps=_r.getElementOffset(hs);return gs.minus(Ps)}function Ur(gs,hs){return new _r.Point((gs.x+hs.x)/2,(gs.y+hs.y)/2)}function Vr(gs,hs){gs.clickHandler&&_r.cancelEvent(hs)}function Wr(gs,hs){gs.dblClickHandler&&_r.cancelEvent(hs)}function qr(gs,hs){var Ps;gs.keyDownHandler&&(hs=_r.getEvent(hs),Ps=gs.keyDownHandler({eventSource:gs,keyCode:hs.keyCode?hs.keyCode:hs.charCode,ctrl:hs.ctrlKey,shift:hs.shiftKey,alt:hs.altKey,meta:hs.metaKey,originalEvent:hs,preventDefaultAction:!1,userData:gs.userData}),Ps||_r.cancelEvent(hs))}function Kr(gs,hs){var Ps;gs.keyUpHandler&&(hs=_r.getEvent(hs),Ps=gs.keyUpHandler({eventSource:gs,keyCode:hs.keyCode?hs.keyCode:hs.charCode,ctrl:hs.ctrlKey,shift:hs.shiftKey,alt:hs.altKey,meta:hs.metaKey,originalEvent:hs,preventDefaultAction:!1,userData:gs.userData}),Ps||_r.cancelEvent(hs))}function Xr(gs,hs){var Ps;gs.keyHandler&&(hs=_r.getEvent(hs),Ps=gs.keyHandler({eventSource:gs,keyCode:hs.keyCode?hs.keyCode:hs.charCode,ctrl:hs.ctrlKey,shift:hs.shiftKey,alt:hs.altKey,meta:hs.metaKey,originalEvent:hs,preventDefaultAction:!1,userData:gs.userData}),Ps||_r.cancelEvent(hs))}function Zr(gs,hs){var Ps;gs.focusHandler&&(hs=_r.getEvent(hs),Ps=gs.focusHandler({eventSource:gs,originalEvent:hs,preventDefaultAction:!1,userData:gs.userData}),Ps===!1&&_r.cancelEvent(hs))}function _i(gs,hs){var Ps;gs.blurHandler&&(hs=_r.getEvent(hs),Ps=gs.blurHandler({eventSource:gs,originalEvent:hs,preventDefaultAction:!1,userData:gs.userData}),Ps===!1&&_r.cancelEvent(hs))}function Jr(gs,hs){ts(gs,hs,hs)}function es(gs,hs){hs=_r.getEvent(hs);var Ps={target:hs.target||hs.srcElement,type:"wheel",shiftKey:hs.shiftKey||!1,clientX:hs.clientX,clientY:hs.clientY,pageX:hs.pageX?hs.pageX:hs.clientX,pageY:hs.pageY?hs.pageY:hs.clientY,deltaMode:hs.type=="MozMousePixelScroll"?0:1,deltaX:0,deltaZ:0};_r.MouseTracker.wheelEventName=="mousewheel"?Ps.deltaY=-hs.wheelDelta/_r.DEFAULT_SETTINGS.pixelsPerWheelLine:Ps.deltaY=hs.detail,ts(gs,Ps,hs)}function ts(gs,hs,Ps){var ks=0,Zs;ks=hs.deltaY<0?1:-1,gs.scrollHandler&&(Zs=gs.scrollHandler({eventSource:gs,pointerType:"mouse",position:Nr(hs,gs.element),scroll:ks,shift:hs.shiftKey,isTouchEvent:!1,originalEvent:Ps,preventDefaultAction:!1,userData:gs.userData}),Zs===!1&&_r.cancelEvent(Ps))}function is(gs,hs){if(gs===hs)return!1;for(;hs&&hs!==gs;)hs=hs.parentNode;return hs===gs}function rs(gs,hs){hs=_r.getEvent(hs),ls(gs,hs)}function as(gs,hs){hs=_r.getEvent(hs),!(hs.currentTarget===hs.relatedTarget||is(hs.currentTarget,hs.relatedTarget))&&ls(gs,hs)}function ls(gs,hs){var Ps={id:_r.MouseTracker.mousePointerId,type:"mouse",isPrimary:!0,currentPos:Gr(hs),currentTime:_r.now()};El(gs,hs,[Ps])}function fs(gs,hs){hs=_r.getEvent(hs),$s(gs,hs)}function Ts(gs,hs){hs=_r.getEvent(hs),!(hs.currentTarget===hs.relatedTarget||is(hs.currentTarget,hs.relatedTarget))&&$s(gs,hs)}function $s(gs,hs){var Ps={id:_r.MouseTracker.mousePointerId,type:"mouse",isPrimary:!0,currentPos:Gr(hs),currentTime:_r.now()};Dl(gs,hs,[Ps])}function xs(gs){return _r.Browser.vendor===_r.BROWSERS.IE&&_r.Browser.version<9?gs===1?0:gs===2?2:gs===4?1:-1:gs}function ys(gs,hs){var Ps;hs=_r.getEvent(hs),Ps={id:_r.MouseTracker.mousePointerId,type:"mouse",isPrimary:!0,currentPos:Gr(hs),currentTime:_r.now()},ru(gs,hs,[Ps],xs(hs.button))&&(_r.stopEvent(hs),Fr(gs,"mouse")),(gs.clickHandler||gs.dblClickHandler||gs.pressHandler||gs.dragHandler||gs.dragEndHandler)&&_r.cancelEvent(hs)}function ps(gs,hs){Ds(gs,hs)}function vs(gs,hs){Ds(gs,hs),_r.stopEvent(hs)}function Ds(gs,hs){var Ps;hs=_r.getEvent(hs),Ps={id:_r.MouseTracker.mousePointerId,type:"mouse",isPrimary:!0,currentPos:Gr(hs),currentTime:_r.now()},Ul(gs,hs,[Ps],xs(hs.button))&&zr(gs,"mouse")}function js(gs,hs){qs(gs,hs)}function zs(gs,hs){qs(gs,hs),_r.stopEvent(hs)}function qs(gs,hs){var Ps;hs=_r.getEvent(hs),Ps={id:_r.MouseTracker.mousePointerId,type:"mouse",isPrimary:!0,currentPos:Gr(hs),currentTime:_r.now()},Kl(gs,hs,[Ps])}function fo(gs,hs,Ps){var ks,Zs=Ps.getLength(),bo=[];if(Ps.type==="touch"||Ps.contacts>0){for(ks=0;ks<Zs;ks++)bo.push(Ps.getByIndex(ks));bo.length>0&&(Ul(gs,hs,bo,0),Ps.captureCount=1,zr(gs,Ps.type),Dl(gs,hs,bo))}}function Qs(gs,hs){var Ps,ks,Zs,bo=hs.changedTouches.length,ho=[],eo,Po=gs.getActivePointersListByType("touch");for(Ps=_r.now(),Po.getLength()>hs.touches.length-bo&&(_r.console.warn("Tracked touch contact count doesn't match event.touches.length. Removing all tracked touch pointers."),fo(gs,hs,Po)),ks=0;ks<bo;ks++)ho.push({id:hs.changedTouches[ks].identifier,type:"touch",currentPos:Gr(hs.changedTouches[ks]),currentTime:Ps});for(El(gs,hs,ho),ks=0;ks<Tr.length;ks++)if(Tr[ks]!==gs&&Tr[ks].isTracking()&&is(Tr[ks].element,gs.element)){for(eo=[],Zs=0;Zs<bo;Zs++)eo.push({id:hs.changedTouches[Zs].identifier,type:"touch",currentPos:Gr(hs.changedTouches[Zs]),currentTime:Ps});El(Tr[ks],hs,eo)}ru(gs,hs,ho,0)&&(_r.stopEvent(hs),Fr(gs,"touch",bo)),_r.cancelEvent(hs)}function no(gs,hs){Js(gs,hs)}function yo(gs,hs){Js(gs,hs),_r.stopEvent(hs)}function Js(gs,hs){var Ps,ks,Zs,bo=hs.changedTouches.length,ho=[],eo;for(Ps=_r.now(),ks=0;ks<bo;ks++)ho.push({id:hs.changedTouches[ks].identifier,type:"touch",currentPos:Gr(hs.changedTouches[ks]),currentTime:Ps});for(Ul(gs,hs,ho,0)&&zr(gs,"touch",bo),Dl(gs,hs,ho),ks=0;ks<Tr.length;ks++)if(Tr[ks]!==gs&&Tr[ks].isTracking()&&is(Tr[ks].element,gs.element)){for(eo=[],Zs=0;Zs<bo;Zs++)eo.push({id:hs.changedTouches[Zs].identifier,type:"touch",currentPos:Gr(hs.changedTouches[Zs]),currentTime:Ps});Dl(Tr[ks],hs,eo)}_r.cancelEvent(hs)}function lo(gs,hs){Ro(gs,hs)}function vo(gs,hs){Ro(gs,hs),_r.stopEvent(hs)}function Ro(gs,hs){var Ps,ks=hs.changedTouches.length,Zs=[];for(Ps=0;Ps<ks;Ps++)Zs.push({id:hs.changedTouches[Ps].identifier,type:"touch",currentPos:Gr(hs.changedTouches[Ps]),currentTime:_r.now()});Kl(gs,hs,Zs),_r.cancelEvent(hs)}function Co(gs,hs){var Ps=gs.getActivePointersListByType("touch");fo(gs,hs,Ps)}function Do(gs,hs){return hs.stopPropagation(),hs.preventDefault(),!1}function ds(gs,hs){return hs.stopPropagation(),hs.preventDefault(),!1}function Os(gs,hs){var Ps;hs.currentTarget===hs.relatedTarget||is(hs.currentTarget,hs.relatedTarget)||(Ps={id:hs.pointerId,type:jr(hs),isPrimary:hs.isPrimary,currentPos:Gr(hs),currentTime:_r.now()},El(gs,hs,[Ps]))}function Ws(gs,hs){var Ps;hs.currentTarget===hs.relatedTarget||is(hs.currentTarget,hs.relatedTarget)||(Ps={id:hs.pointerId,type:jr(hs),isPrimary:hs.isPrimary,currentPos:Gr(hs),currentTime:_r.now()},Dl(gs,hs,[Ps]))}function to(gs,hs){var Ps;Ps={id:hs.pointerId,type:jr(hs),isPrimary:hs.isPrimary,currentPos:Gr(hs),currentTime:_r.now()},ru(gs,hs,[Ps],hs.button)&&(_r.stopEvent(hs),Fr(gs,Ps.type)),(gs.clickHandler||gs.dblClickHandler||gs.pressHandler||gs.dragHandler||gs.dragEndHandler||gs.pinchHandler)&&_r.cancelEvent(hs)}function io(gs,hs){go(gs,hs)}function ko(gs,hs){var Ps=gs.getActivePointersListByType(jr(hs));Ps.getById(hs.pointerId)&&go(gs,hs),_r.stopEvent(hs)}function go(gs,hs){var Ps;Ps={id:hs.pointerId,type:jr(hs),isPrimary:hs.isPrimary,currentPos:Gr(hs),currentTime:_r.now()},Ul(gs,hs,[Ps],hs.button)&&zr(gs,Ps.type)}function To(gs,hs){Uo(gs,hs)}function Ho(gs,hs){var Ps=gs.getActivePointersListByType(jr(hs));Ps.getById(hs.pointerId)&&Uo(gs,hs),_r.stopEvent(hs)}function Uo(gs,hs){var Ps;Ps={id:hs.pointerId,type:jr(hs),isPrimary:hs.isPrimary,currentPos:Gr(hs),currentTime:_r.now()},Kl(gs,hs,[Ps])}function Io(gs,hs){var Ps;Ps={id:hs.pointerId,type:jr(hs)},vu(gs,hs,[Ps])}function xl(gs,hs){return Object.prototype.hasOwnProperty.call(hs,"isPrimary")||(gs.getLength()===0?hs.isPrimary=!0:hs.isPrimary=!1),hs.speed=0,hs.direction=0,hs.contactPos=hs.currentPos,hs.contactTime=hs.currentTime,hs.lastPos=hs.currentPos,hs.lastTime=hs.currentTime,gs.add(hs)}function Xo(gs,hs){var Ps,ks;return gs.getById(hs.id)?(Ps=gs.removeById(hs.id),Object.prototype.hasOwnProperty.call(hs,"isPrimary")||(ks=gs.getPrimary(),ks||(ks=gs.getByIndex(0),ks&&(ks.isPrimary=!0)))):Ps=gs.getLength(),Ps}function El(gs,hs,Ps){var ks=gs.getActivePointersListByType(Ps[0].type),Zs,bo=Ps.length,ho,eo,Po;for(Zs=0;Zs<bo;Zs++)ho=Ps[Zs],eo=ks.getById(ho.id),eo?(eo.insideElement=!0,eo.lastPos=eo.currentPos,eo.lastTime=eo.currentTime,eo.currentPos=ho.currentPos,eo.currentTime=ho.currentTime,ho=eo):(ho.captured=!1,ho.insideElementPressed=!1,ho.insideElement=!0,xl(ks,ho)),gs.enterHandler&&(Po=gs.enterHandler({eventSource:gs,pointerType:ho.type,position:Lr(ho.currentPos,gs.element),buttons:ks.buttons,pointers:gs.getActivePointerCount(),insideElementPressed:ho.insideElementPressed,buttonDownAny:ks.buttons!==0,isTouchEvent:ho.type==="touch",originalEvent:hs,preventDefaultAction:!1,userData:gs.userData}),Po===!1&&_r.cancelEvent(hs))}function Dl(gs,hs,Ps){var ks=gs.getActivePointersListByType(Ps[0].type),Zs,bo=Ps.length,ho,eo,Po;for(Zs=0;Zs<bo;Zs++)ho=Ps[Zs],eo=ks.getById(ho.id),eo&&(eo.captured?(eo.insideElement=!1,eo.lastPos=eo.currentPos,eo.lastTime=eo.currentTime,eo.currentPos=ho.currentPos,eo.currentTime=ho.currentTime):Xo(ks,eo),ho=eo),gs.exitHandler&&(Po=gs.exitHandler({eventSource:gs,pointerType:ho.type,position:ho.currentPos&&Lr(ho.currentPos,gs.element),buttons:ks.buttons,pointers:gs.getActivePointerCount(),insideElementPressed:eo?eo.insideElementPressed:!1,buttonDownAny:ks.buttons!==0,isTouchEvent:ho.type==="touch",originalEvent:hs,preventDefaultAction:!1,userData:gs.userData}),Po===!1&&_r.cancelEvent(hs))}function ru(gs,hs,Ps,ks){var Zs=Ar[gs.hash],bo,ho=gs.getActivePointersListByType(Ps[0].type),eo,Po=Ps.length,qo,zo;typeof hs.buttons<"u"?ho.buttons=hs.buttons:_r.Browser.vendor===_r.BROWSERS.IE&&_r.Browser.version<9?ks===0?ho.buttons+=1:ks===1?ho.buttons+=4:ks===2?ho.buttons+=2:ks===3?ho.buttons+=8:ks===4?ho.buttons+=16:ks===5&&(ho.buttons+=32):ks===0?ho.buttons|=1:ks===1?ho.buttons|=4:ks===2?ho.buttons|=2:ks===3?ho.buttons|=8:ks===4?ho.buttons|=16:ks===5&&(ho.buttons|=32);var Hs=gs.getActivePointersListsExceptType(Ps[0].type);for(eo=0;eo<Hs.length;eo++)fo(gs,hs,Hs[eo]);if(ks!==0)return gs.nonPrimaryPressHandler&&(bo=gs.nonPrimaryPressHandler({eventSource:gs,pointerType:Ps[0].type,position:Lr(Ps[0].currentPos,gs.element),button:ks,buttons:ho.buttons,isTouchEvent:Ps[0].type==="touch",originalEvent:hs,preventDefaultAction:!1,userData:gs.userData}),bo===!1&&_r.cancelEvent(hs)),!1;for(eo=0;eo<Po;eo++)qo=Ps[eo],zo=ho.getById(qo.id),zo?(zo.captured=!0,zo.insideElementPressed=!0,zo.insideElement=!0,zo.contactPos=qo.currentPos,zo.contactTime=qo.currentTime,zo.lastPos=zo.currentPos,zo.lastTime=zo.currentTime,zo.currentPos=qo.currentPos,zo.currentTime=qo.currentTime,qo=zo):(qo.captured=!0,qo.insideElementPressed=!0,qo.insideElement=!0,xl(ho,qo)),ho.addContact(),(gs.dragHandler||gs.dragEndHandler||gs.pinchHandler)&&_r.MouseTracker.gesturePointVelocityTracker.addPoint(gs,qo),ho.contacts===1?gs.pressHandler&&(bo=gs.pressHandler({eventSource:gs,pointerType:qo.type,position:Lr(qo.contactPos,gs.element),buttons:ho.buttons,isTouchEvent:qo.type==="touch",originalEvent:hs,preventDefaultAction:!1,userData:gs.userData}),bo===!1&&_r.cancelEvent(hs)):ho.contacts===2&&gs.pinchHandler&&qo.type==="touch"&&(Zs.pinchGPoints=ho.asArray(),Zs.lastPinchDist=Zs.currentPinchDist=Zs.pinchGPoints[0].currentPos.distanceTo(Zs.pinchGPoints[1].currentPos),Zs.lastPinchCenter=Zs.currentPinchCenter=Ur(Zs.pinchGPoints[0].currentPos,Zs.pinchGPoints[1].currentPos));return!0}function Ul(gs,hs,Ps,ks){var Zs=Ar[gs.hash],bo=gs.getActivePointersListByType(Ps[0].type),ho,eo,Po,qo,zo=Ps.length,Hs,wo,xo=!1,Yl=!1,xu;if(typeof hs.buttons<"u"?bo.buttons=hs.buttons:_r.Browser.vendor===_r.BROWSERS.IE&&_r.Browser.version<9?ks===0?bo.buttons-=1:ks===1?bo.buttons-=4:ks===2?bo.buttons-=2:ks===3?bo.buttons-=8:ks===4?bo.buttons-=16:ks===5&&(bo.buttons-=32):ks===0?bo.buttons^=-2:ks===1?bo.buttons^=-5:ks===2?bo.buttons^=-3:ks===3?bo.buttons^=-9:ks===4?bo.buttons^=-17:ks===5&&(bo.buttons^=-33),ks!==0){gs.nonPrimaryReleaseHandler&&(ho=gs.nonPrimaryReleaseHandler({eventSource:gs,pointerType:Ps[0].type,position:Lr(Ps[0].currentPos,gs.element),button:ks,buttons:bo.buttons,isTouchEvent:Ps[0].type==="touch",originalEvent:hs,preventDefaultAction:!1,userData:gs.userData}),ho===!1&&_r.cancelEvent(hs));var ju=gs.getActivePointersListByType("mouse");return fo(gs,hs,ju),!1}if(typeof Ps[0].currentPos>"u")return fo(gs,hs,bo),!1;for(qo=0;qo<zo;qo++)Hs=Ps[qo],wo=bo.getById(Hs.id),wo&&(wo.captured&&(wo.captured=!1,xo=!0,Yl=!0),wo.lastPos=wo.currentPos,wo.lastTime=wo.currentTime,wo.currentPos=Hs.currentPos,wo.currentTime=Hs.currentTime,wo.insideElement||Xo(bo,wo),eo=wo.currentPos,Po=wo.currentTime,Yl?(bo.removeContact(),(gs.dragHandler||gs.dragEndHandler||gs.pinchHandler)&&_r.MouseTracker.gesturePointVelocityTracker.removePoint(gs,wo),bo.contacts===0?(gs.releaseHandler&&(ho=gs.releaseHandler({eventSource:gs,pointerType:wo.type,position:Lr(eo,gs.element),buttons:bo.buttons,insideElementPressed:wo.insideElementPressed,insideElementReleased:wo.insideElement,isTouchEvent:wo.type==="touch",originalEvent:hs,preventDefaultAction:!1,userData:gs.userData}),ho===!1&&_r.cancelEvent(hs)),gs.dragEndHandler&&!wo.currentPos.equals(wo.contactPos)&&(ho=gs.dragEndHandler({eventSource:gs,pointerType:wo.type,position:Lr(wo.currentPos,gs.element),speed:wo.speed,direction:wo.direction,shift:hs.shiftKey,isTouchEvent:wo.type==="touch",originalEvent:hs,preventDefaultAction:!1,userData:gs.userData}),ho===!1&&_r.cancelEvent(hs)),(gs.clickHandler||gs.dblClickHandler)&&wo.insideElement&&(xu=Po-wo.contactTime<=gs.clickTimeThreshold&&wo.contactPos.distanceTo(eo)<=gs.clickDistThreshold,gs.clickHandler&&(ho=gs.clickHandler({eventSource:gs,pointerType:wo.type,position:Lr(wo.currentPos,gs.element),quick:xu,shift:hs.shiftKey,isTouchEvent:wo.type==="touch",originalEvent:hs,preventDefaultAction:!1,userData:gs.userData}),ho===!1&&_r.cancelEvent(hs)),gs.dblClickHandler&&xu&&(bo.clicks++,bo.clicks===1?(Zs.lastClickPos=eo,Zs.dblClickTimeOut=setTimeout(function(){bo.clicks=0},gs.dblClickTimeThreshold)):bo.clicks===2&&(clearTimeout(Zs.dblClickTimeOut),bo.clicks=0,Zs.lastClickPos.distanceTo(eo)<=gs.dblClickDistThreshold&&(ho=gs.dblClickHandler({eventSource:gs,pointerType:wo.type,position:Lr(wo.currentPos,gs.element),shift:hs.shiftKey,isTouchEvent:wo.type==="touch",originalEvent:hs,preventDefaultAction:!1,userData:gs.userData}),ho===!1&&_r.cancelEvent(hs)),Zs.lastClickPos=null)))):bo.contacts===2&&gs.pinchHandler&&wo.type==="touch"&&(Zs.pinchGPoints=bo.asArray(),Zs.lastPinchDist=Zs.currentPinchDist=Zs.pinchGPoints[0].currentPos.distanceTo(Zs.pinchGPoints[1].currentPos),Zs.lastPinchCenter=Zs.currentPinchCenter=Ur(Zs.pinchGPoints[0].currentPos,Zs.pinchGPoints[1].currentPos))):gs.releaseHandler&&(ho=gs.releaseHandler({eventSource:gs,pointerType:wo.type,position:Lr(eo,gs.element),buttons:bo.buttons,insideElementPressed:wo.insideElementPressed,insideElementReleased:wo.insideElement,isTouchEvent:wo.type==="touch",originalEvent:hs,preventDefaultAction:!1,userData:gs.userData}),ho===!1&&_r.cancelEvent(hs)));return xo}function Kl(gs,hs,Ps){var ks=Ar[gs.hash],Zs=gs.getActivePointersListByType(Ps[0].type),bo,ho=Ps.length,eo,Po,qo,zo,Hs;for(typeof hs.buttons<"u"&&(Zs.buttons=hs.buttons),bo=0;bo<ho;bo++)eo=Ps[bo],Po=Zs.getById(eo.id),Po?(Object.prototype.hasOwnProperty.call(eo,"isPrimary")&&(Po.isPrimary=eo.isPrimary),Po.lastPos=Po.currentPos,Po.lastTime=Po.currentTime,Po.currentPos=eo.currentPos,Po.currentTime=eo.currentTime):(eo.captured=!1,eo.insideElementPressed=!1,eo.insideElement=!0,xl(Zs,eo));gs.stopHandler&&Ps[0].type==="mouse"&&(clearTimeout(gs.stopTimeOut),gs.stopTimeOut=setTimeout(function(){Vo(gs,hs,Ps[0].type)},gs.stopDelay)),Zs.contacts===0?gs.moveHandler&&(Hs=gs.moveHandler({eventSource:gs,pointerType:Ps[0].type,position:Lr(Ps[0].currentPos,gs.element),buttons:Zs.buttons,isTouchEvent:Ps[0].type==="touch",originalEvent:hs,preventDefaultAction:!1,userData:gs.userData}),Hs===!1&&_r.cancelEvent(hs)):Zs.contacts===1?(gs.moveHandler&&(Po=Zs.asArray()[0],Hs=gs.moveHandler({eventSource:gs,pointerType:Po.type,position:Lr(Po.currentPos,gs.element),buttons:Zs.buttons,isTouchEvent:Po.type==="touch",originalEvent:hs,preventDefaultAction:!1,userData:gs.userData}),Hs===!1&&_r.cancelEvent(hs)),gs.dragHandler&&(Po=Zs.asArray()[0],zo=Po.currentPos.minus(Po.lastPos),Hs=gs.dragHandler({eventSource:gs,pointerType:Po.type,position:Lr(Po.currentPos,gs.element),buttons:Zs.buttons,delta:zo,speed:Po.speed,direction:Po.direction,shift:hs.shiftKey,isTouchEvent:Po.type==="touch",originalEvent:hs,preventDefaultAction:!1,userData:gs.userData}),Hs===!1&&_r.cancelEvent(hs))):Zs.contacts===2&&(gs.moveHandler&&(qo=Zs.asArray(),Hs=gs.moveHandler({eventSource:gs,pointerType:qo[0].type,position:Lr(Ur(qo[0].currentPos,qo[1].currentPos),gs.element),buttons:Zs.buttons,isTouchEvent:qo[0].type==="touch",originalEvent:hs,preventDefaultAction:!1,userData:gs.userData}),Hs===!1&&_r.cancelEvent(hs)),gs.pinchHandler&&Ps[0].type==="touch"&&(zo=ks.pinchGPoints[0].currentPos.distanceTo(ks.pinchGPoints[1].currentPos),zo!=ks.currentPinchDist&&(ks.lastPinchDist=ks.currentPinchDist,ks.currentPinchDist=zo,ks.lastPinchCenter=ks.currentPinchCenter,ks.currentPinchCenter=Ur(ks.pinchGPoints[0].currentPos,ks.pinchGPoints[1].currentPos),Hs=gs.pinchHandler({eventSource:gs,pointerType:"touch",gesturePoints:ks.pinchGPoints,lastCenter:Lr(ks.lastPinchCenter,gs.element),center:Lr(ks.currentPinchCenter,gs.element),lastDistance:ks.lastPinchDist,distance:ks.currentPinchDist,shift:hs.shiftKey,originalEvent:hs,preventDefaultAction:!1,userData:gs.userData}),Hs===!1&&_r.cancelEvent(hs))))}function vu(gs,hs,Ps){Ul(gs,hs,Ps,0),Dl(gs,hs,Ps)}function Vo(gs,hs,Ps){gs.stopHandler&&gs.stopHandler({eventSource:gs,pointerType:Ps,position:Nr(hs,gs.element),buttons:gs.getActivePointersListByType(Ps).buttons,isTouchEvent:Ps==="touch",originalEvent:hs,preventDefaultAction:!1,userData:gs.userData})}var Fs=function(){try{return window.self!==window.top}catch{return!0}}();function Ks(gs){try{return gs.addEventListener&&gs.removeEventListener}catch{return!1}}}(OpenSeadragon),function(_r){_r.ControlAnchor={NONE:0,TOP_LEFT:1,TOP_RIGHT:2,BOTTOM_RIGHT:3,BOTTOM_LEFT:4,ABSOLUTE:5},_r.Control=function(Tr,Ar,Rr){var Pr=Tr.parentNode;typeof Ar=="number"&&(_r.console.error("Passing an anchor directly into the OpenSeadragon.Control constructor is deprecated; please use an options object instead.  Support for this deprecated variant is scheduled for removal in December 2013"),Ar={anchor:Ar}),Ar.attachToViewer=typeof Ar.attachToViewer>"u"?!0:Ar.attachToViewer,this.autoFade=typeof Ar.autoFade>"u"?!0:Ar.autoFade,this.element=Tr,this.anchor=Ar.anchor,this.container=Rr,this.anchor==_r.ControlAnchor.ABSOLUTE?(this.wrapper=_r.makeNeutralElement("div"),this.wrapper.style.position="absolute",this.wrapper.style.top=typeof Ar.top=="number"?Ar.top+"px":Ar.top,this.wrapper.style.left=typeof Ar.left=="number"?Ar.left+"px":Ar.left,this.wrapper.style.height=typeof Ar.height=="number"?Ar.height+"px":Ar.height,this.wrapper.style.width=typeof Ar.width=="number"?Ar.width+"px":Ar.width,this.wrapper.style.margin="0px",this.wrapper.style.padding="0px",this.element.style.position="relative",this.element.style.top="0px",this.element.style.left="0px",this.element.style.height="100%",this.element.style.width="100%"):(this.wrapper=_r.makeNeutralElement("div"),this.wrapper.style.display="inline-block",this.anchor==_r.ControlAnchor.NONE&&(this.wrapper.style.width=this.wrapper.style.height="100%")),this.wrapper.appendChild(this.element),Ar.attachToViewer?this.anchor==_r.ControlAnchor.TOP_RIGHT||this.anchor==_r.ControlAnchor.BOTTOM_RIGHT?this.container.insertBefore(this.wrapper,this.container.firstChild):this.container.appendChild(this.wrapper):Pr.appendChild(this.wrapper)},_r.Control.prototype={destroy:function(){this.wrapper.removeChild(this.element),this.container.removeChild(this.wrapper)},isVisible:function(){return this.wrapper.style.display!="none"},setVisible:function(Tr){this.wrapper.style.display=Tr?this.anchor==_r.ControlAnchor.ABSOLUTE?"block":"inline-block":"none"},setOpacity:function(Tr){this.element[_r.SIGNAL]&&_r.Browser.vendor==_r.BROWSERS.IE?_r.setElementOpacity(this.element,Tr,!0):_r.setElementOpacity(this.wrapper,Tr,!0)}}}(OpenSeadragon),function(_r){_r.ControlDock=function(Ar){var Rr=["topleft","topright","bottomright","bottomleft"],Pr,Dr;for(_r.extend(!0,this,{id:"controldock-"+_r.now()+"-"+Math.floor(Math.random()*1e6),container:_r.makeNeutralElement("div"),controls:[]},Ar),this.container.onsubmit=function(){return!1},this.element&&(this.element=_r.getElement(this.element),this.element.appendChild(this.container),this.element.style.position="relative",this.container.style.width="100%",this.container.style.height="100%"),Dr=0;Dr<Rr.length;Dr++)Pr=Rr[Dr],this.controls[Pr]=_r.makeNeutralElement("div"),this.controls[Pr].style.position="absolute",Pr.match("left")&&(this.controls[Pr].style.left="0px"),Pr.match("right")&&(this.controls[Pr].style.right="0px"),Pr.match("top")&&(this.controls[Pr].style.top="0px"),Pr.match("bottom")&&(this.controls[Pr].style.bottom="0px");this.container.appendChild(this.controls.topleft),this.container.appendChild(this.controls.topright),this.container.appendChild(this.controls.bottomright),this.container.appendChild(this.controls.bottomleft)},_r.ControlDock.prototype={addControl:function(Ar,Rr){Ar=_r.getElement(Ar);var Pr=null;if(!(Tr(this,Ar)>=0)){switch(Rr.anchor){case _r.ControlAnchor.TOP_RIGHT:Pr=this.controls.topright,Ar.style.position="relative",Ar.style.paddingRight="0px",Ar.style.paddingTop="0px";break;case _r.ControlAnchor.BOTTOM_RIGHT:Pr=this.controls.bottomright,Ar.style.position="relative",Ar.style.paddingRight="0px",Ar.style.paddingBottom="0px";break;case _r.ControlAnchor.BOTTOM_LEFT:Pr=this.controls.bottomleft,Ar.style.position="relative",Ar.style.paddingLeft="0px",Ar.style.paddingBottom="0px";break;case _r.ControlAnchor.TOP_LEFT:Pr=this.controls.topleft,Ar.style.position="relative",Ar.style.paddingLeft="0px",Ar.style.paddingTop="0px";break;case _r.ControlAnchor.ABSOLUTE:Pr=this.container,Ar.style.margin="0px",Ar.style.padding="0px";break;default:case _r.ControlAnchor.NONE:Pr=this.container,Ar.style.margin="0px",Ar.style.padding="0px";break}this.controls.push(new _r.Control(Ar,Rr,Pr)),Ar.style.display="inline-block"}},removeControl:function(Ar){Ar=_r.getElement(Ar);var Rr=Tr(this,Ar);return Rr>=0&&(this.controls[Rr].destroy(),this.controls.splice(Rr,1)),this},clearControls:function(){for(;this.controls.length>0;)this.controls.pop().destroy();return this},areControlsEnabled:function(){var Ar;for(Ar=this.controls.length-1;Ar>=0;Ar--)if(this.controls[Ar].isVisible())return!0;return!1},setControlsEnabled:function(Ar){var Rr;for(Rr=this.controls.length-1;Rr>=0;Rr--)this.controls[Rr].setVisible(Ar);return this}};function Tr(Ar,Rr){var Pr=Ar.controls,Dr;for(Dr=Pr.length-1;Dr>=0;Dr--)if(Pr[Dr].element==Rr)return Dr;return-1}}(OpenSeadragon),function(_r){_r.Placement=_r.freezeObject({CENTER:0,TOP_LEFT:1,TOP:2,TOP_RIGHT:3,RIGHT:4,BOTTOM_RIGHT:5,BOTTOM:6,BOTTOM_LEFT:7,LEFT:8,properties:{0:{isLeft:!1,isHorizontallyCentered:!0,isRight:!1,isTop:!1,isVerticallyCentered:!0,isBottom:!1},1:{isLeft:!0,isHorizontallyCentered:!1,isRight:!1,isTop:!0,isVerticallyCentered:!1,isBottom:!1},2:{isLeft:!1,isHorizontallyCentered:!0,isRight:!1,isTop:!0,isVerticallyCentered:!1,isBottom:!1},3:{isLeft:!1,isHorizontallyCentered:!1,isRight:!0,isTop:!0,isVerticallyCentered:!1,isBottom:!1},4:{isLeft:!1,isHorizontallyCentered:!1,isRight:!0,isTop:!1,isVerticallyCentered:!0,isBottom:!1},5:{isLeft:!1,isHorizontallyCentered:!1,isRight:!0,isTop:!1,isVerticallyCentered:!1,isBottom:!0},6:{isLeft:!1,isHorizontallyCentered:!0,isRight:!1,isTop:!1,isVerticallyCentered:!1,isBottom:!0},7:{isLeft:!0,isHorizontallyCentered:!1,isRight:!1,isTop:!1,isVerticallyCentered:!1,isBottom:!0},8:{isLeft:!0,isHorizontallyCentered:!1,isRight:!1,isTop:!1,isVerticallyCentered:!0,isBottom:!1}}})}(OpenSeadragon),function(_r){var Tr={},Ar=1;_r.Viewer=function(ds){var Os=arguments,Ws=this,to;if(_r.isPlainObject(ds)||(ds={id:Os[0],xmlPath:Os.length>1?Os[1]:void 0,prefixUrl:Os.length>2?Os[2]:void 0,controls:Os.length>3?Os[3]:void 0,overlays:Os.length>4?Os[4]:void 0}),ds.config&&(_r.extend(!0,ds,ds.config),delete ds.config),_r.extend(!0,this,{id:ds.id,hash:ds.hash||Ar++,initialPage:0,element:null,container:null,canvas:null,overlays:[],overlaysContainer:null,previousBody:[],customControls:[],source:null,drawer:null,world:null,viewport:null,navigator:null,collectionViewport:null,collectionDrawer:null,navImages:null,buttons:null,profiler:null},_r.DEFAULT_SETTINGS,ds),typeof this.hash>"u")throw new Error("A hash must be defined, either by specifying options.id or options.hash.");for(typeof Tr[this.hash]<"u"&&_r.console.warn("Hash "+this.hash+" has already been used."),Tr[this.hash]={fsBoundsDelta:new _r.Point(1,1),prevContainerSize:null,animating:!1,forceRedraw:!1,mouseInside:!1,group:null,zooming:!1,zoomFactor:null,lastZoomTime:null,fullPage:!1,onfullscreenchange:null},this._sequenceIndex=0,this._firstOpen=!0,this._updateRequestId=null,this._loadQueue=[],this.currentOverlays=[],this._lastScrollTime=_r.now(),_r.EventSource.call(this),this.addHandler("open-failed",function(io){var ko=_r.getString("Errors.OpenFailed",io.eventSource,io.message);Ws._showMessage(ko)}),_r.ControlDock.call(this,ds),this.xmlPath&&(this.tileSources=[this.xmlPath]),this.element=this.element||document.getElementById(this.id),this.canvas=_r.makeNeutralElement("div"),this.canvas.className="openseadragon-canvas",function(io){io.width="100%",io.height="100%",io.overflow="hidden",io.position="absolute",io.top="0px",io.left="0px"}(this.canvas.style),_r.setElementTouchActionNone(this.canvas),ds.tabIndex!==""&&(this.canvas.tabIndex=ds.tabIndex===void 0?0:ds.tabIndex),this.container.className="openseadragon-container",function(io){io.width="100%",io.height="100%",io.position="relative",io.overflow="hidden",io.left="0px",io.top="0px",io.textAlign="left"}(this.container.style),this.container.insertBefore(this.canvas,this.container.firstChild),this.element.appendChild(this.container),this.bodyWidth=document.body.style.width,this.bodyHeight=document.body.style.height,this.bodyOverflow=document.body.style.overflow,this.docOverflow=document.documentElement.style.overflow,this.innerTracker=new _r.MouseTracker({element:this.canvas,startDisabled:!this.mouseNavEnabled,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,dblClickTimeThreshold:this.dblClickTimeThreshold,dblClickDistThreshold:this.dblClickDistThreshold,keyDownHandler:_r.delegate(this,Vr),keyHandler:_r.delegate(this,Wr),clickHandler:_r.delegate(this,qr),dblClickHandler:_r.delegate(this,Kr),dragHandler:_r.delegate(this,Xr),dragEndHandler:_r.delegate(this,Zr),enterHandler:_r.delegate(this,_i),exitHandler:_r.delegate(this,Jr),pressHandler:_r.delegate(this,es),releaseHandler:_r.delegate(this,ts),nonPrimaryPressHandler:_r.delegate(this,is),nonPrimaryReleaseHandler:_r.delegate(this,rs),scrollHandler:_r.delegate(this,ls),pinchHandler:_r.delegate(this,as)}),this.outerTracker=new _r.MouseTracker({element:this.container,startDisabled:!this.mouseNavEnabled,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,dblClickTimeThreshold:this.dblClickTimeThreshold,dblClickDistThreshold:this.dblClickDistThreshold,enterHandler:_r.delegate(this,fs),exitHandler:_r.delegate(this,Ts)}),this.toolbar&&(this.toolbar=new _r.ControlDock({element:this.toolbar})),this.bindStandardControls(),Tr[this.hash].prevContainerSize=Rr(this.container),this.world=new _r.World({viewer:this}),this.world.addHandler("add-item",function(io){Ws.source=Ws.world.getItemAt(0).source,Tr[Ws.hash].forceRedraw=!0,Ws._updateRequestId||(Ws._updateRequestId=Fr(Ws,$s))}),this.world.addHandler("remove-item",function(io){Ws.world.getItemCount()?Ws.source=Ws.world.getItemAt(0).source:Ws.source=null,Tr[Ws.hash].forceRedraw=!0}),this.world.addHandler("metrics-change",function(io){Ws.viewport&&Ws.viewport._setContentBounds(Ws.world.getHomeBounds(),Ws.world.getContentFactor())}),this.world.addHandler("item-index-change",function(io){Ws.source=Ws.world.getItemAt(0).source}),this.viewport=new _r.Viewport({containerSize:Tr[this.hash].prevContainerSize,springStiffness:this.springStiffness,animationTime:this.animationTime,minZoomImageRatio:this.minZoomImageRatio,maxZoomPixelRatio:this.maxZoomPixelRatio,visibilityRatio:this.visibilityRatio,wrapHorizontal:this.wrapHorizontal,wrapVertical:this.wrapVertical,defaultZoomLevel:this.defaultZoomLevel,minZoomLevel:this.minZoomLevel,maxZoomLevel:this.maxZoomLevel,viewer:this,degrees:this.degrees,flipped:this.flipped,navigatorRotate:this.navigatorRotate,homeFillsViewer:this.homeFillsViewer,margins:this.viewportMargins}),this.viewport._setContentBounds(this.world.getHomeBounds(),this.world.getContentFactor()),this.imageLoader=new _r.ImageLoader({jobLimit:this.imageLoaderLimit,timeout:ds.timeout}),this.tileCache=new _r.TileCache({maxImageCacheCount:this.maxImageCacheCount}),this.drawer=new _r.Drawer({viewer:this,viewport:this.viewport,element:this.canvas,debugGridColor:this.debugGridColor}),this.overlaysContainer=_r.makeNeutralElement("div"),this.canvas.appendChild(this.overlaysContainer),this.drawer.canRotate()||(this.rotateLeft&&(to=this.buttons.buttons.indexOf(this.rotateLeft),this.buttons.buttons.splice(to,1),this.buttons.element.removeChild(this.rotateLeft.element)),this.rotateRight&&(to=this.buttons.buttons.indexOf(this.rotateRight),this.buttons.buttons.splice(to,1),this.buttons.element.removeChild(this.rotateRight.element))),this.showNavigator&&(this.navigator=new _r.Navigator({id:this.navigatorId,position:this.navigatorPosition,sizeRatio:this.navigatorSizeRatio,maintainSizeRatio:this.navigatorMaintainSizeRatio,top:this.navigatorTop,left:this.navigatorLeft,width:this.navigatorWidth,height:this.navigatorHeight,autoResize:this.navigatorAutoResize,autoFade:this.navigatorAutoFade,prefixUrl:this.prefixUrl,viewer:this,navigatorRotate:this.navigatorRotate,background:this.navigatorBackground,opacity:this.navigatorOpacity,borderColor:this.navigatorBorderColor,displayRegionColor:this.navigatorDisplayRegionColor,crossOriginPolicy:this.crossOriginPolicy})),this.sequenceMode&&this.bindSequenceControls(),this.tileSources&&this.open(this.tileSources),to=0;to<this.customControls.length;to++)this.addControl(this.customControls[to].id,{anchor:this.customControls[to].anchor});_r.requestAnimationFrame(function(){jr(Ws)}),this.imageSmoothingEnabled!==void 0&&!this.imageSmoothingEnabled&&this.drawer.setImageSmoothingEnabled(this.imageSmoothingEnabled)},_r.extend(_r.Viewer.prototype,_r.EventSource.prototype,_r.ControlDock.prototype,{isOpen:function(){return!!this.world.getItemCount()},openDzi:function(ds){return _r.console.error("[Viewer.openDzi] this function is deprecated; use Viewer.open() instead."),this.open(ds)},openTileSource:function(ds){return _r.console.error("[Viewer.openTileSource] this function is deprecated; use Viewer.open() instead."),this.open(ds)},open:function(ds,Os){var Ws=this;if(this.close(),!!ds){if(this.sequenceMode&&_r.isArray(ds)){this.referenceStrip&&(this.referenceStrip.destroy(),this.referenceStrip=null),typeof Os<"u"&&!isNaN(Os)&&(this.initialPage=Os),this.tileSources=ds,this._sequenceIndex=Math.max(0,Math.min(this.tileSources.length-1,this.initialPage)),this.tileSources.length&&(this.open(this.tileSources[this._sequenceIndex]),this.showReferenceStrip&&this.addReferenceStrip()),this._updateSequenceButtons(this._sequenceIndex);return}if(_r.isArray(ds)||(ds=[ds]),!!ds.length){this._opening=!0;for(var to=ds.length,io=0,ko=0,go,To=function(){if(io+ko===to)if(io){(Ws._firstOpen||!Ws.preserveViewport)&&(Ws.viewport.goHome(!0),Ws.viewport.update()),Ws._firstOpen=!1;var Io=ds[0];if(Io.tileSource&&(Io=Io.tileSource),Ws.overlays&&!Ws.preserveOverlays)for(var xl=0;xl<Ws.overlays.length;xl++)Ws.currentOverlays[xl]=Dr(Ws,Ws.overlays[xl]);Ws._drawOverlays(),Ws._opening=!1,Ws.raiseEvent("open",{source:Io})}else Ws._opening=!1,Ws.raiseEvent("open-failed",go)},Ho=function(Io){(!_r.isPlainObject(Io)||!Io.tileSource)&&(Io={tileSource:Io}),Io.index!==void 0&&(_r.console.error("[Viewer.open] setting indexes here is not supported; use addTiledImage instead"),delete Io.index),Io.collectionImmediately===void 0&&(Io.collectionImmediately=!0);var xl=Io.success;Io.success=function(El){if(io++,Io.tileSource.overlays)for(var Dl=0;Dl<Io.tileSource.overlays.length;Dl++)Ws.addOverlay(Io.tileSource.overlays[Dl]);xl&&xl(El),To()};var Xo=Io.error;Io.error=function(El){ko++,go||(go=El),Xo&&Xo(El),To()},Ws.addTiledImage(Io)},Uo=0;Uo<ds.length;Uo++)Ho(ds[Uo]);return this}}},close:function(){return Tr[this.hash]?(this._opening=!1,this.navigator&&this.navigator.close(),this.preserveOverlays||(this.clearOverlays(),this.overlaysContainer.innerHTML=""),Tr[this.hash].animating=!1,this.world.removeAll(),this.imageLoader.clear(),this.raiseEvent("close"),this):this},destroy:function(){if(Tr[this.hash]){if(this.close(),this.clearOverlays(),this.overlaysContainer.innerHTML="",this.referenceStrip&&(this.referenceStrip.destroy(),this.referenceStrip=null),this._updateRequestId!==null&&(_r.cancelAnimationFrame(this._updateRequestId),this._updateRequestId=null),this.drawer&&this.drawer.destroy(),this.removeAllHandlers(),this.element)for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.innerTracker&&this.innerTracker.destroy(),this.outerTracker&&this.outerTracker.destroy(),Tr[this.hash]=null,delete Tr[this.hash],this.canvas=null,this.container=null,this.element=null}},isMouseNavEnabled:function(){return this.innerTracker.isTracking()},setMouseNavEnabled:function(ds){return this.innerTracker.setTracking(ds),this.outerTracker.setTracking(ds),this.raiseEvent("mouse-enabled",{enabled:ds}),this},areControlsEnabled:function(){var ds=this.controls.length,Os;for(Os=0;Os<this.controls.length;Os++)ds=ds&&this.controls[Os].isVisible();return ds},setControlsEnabled:function(ds){return ds?Nr(this):jr(this),this.raiseEvent("controls-enabled",{enabled:ds}),this},setDebugMode:function(ds){for(var Os=0;Os<this.world.getItemCount();Os++)this.world.getItemAt(Os).debugMode=ds;this.debugMode=ds,this.forceRedraw()},isFullPage:function(){return Tr[this.hash].fullPage},setFullPage:function(ds){var Os=document.body,Ws=Os.style,to=document.documentElement.style,io=this,ko,go;if(ds==this.isFullPage())return this;var To={fullPage:ds,preventDefaultAction:!1};if(this.raiseEvent("pre-full-page",To),To.preventDefaultAction)return this;if(ds){for(this.elementSize=_r.getElementSize(this.element),this.pageScroll=_r.getPageScroll(),this.elementMargin=this.element.style.margin,this.element.style.margin="0",this.elementPadding=this.element.style.padding,this.element.style.padding="0",this.bodyMargin=Ws.margin,this.docMargin=to.margin,Ws.margin="0",to.margin="0",this.bodyPadding=Ws.padding,this.docPadding=to.padding,Ws.padding="0",to.padding="0",this.bodyWidth=Ws.width,this.docWidth=to.width,Ws.width="100%",to.width="100%",this.bodyHeight=Ws.height,this.docHeight=to.height,Ws.height="100%",to.height="100%",this.previousBody=[],Tr[this.hash].prevElementParent=this.element.parentNode,Tr[this.hash].prevNextSibling=this.element.nextSibling,Tr[this.hash].prevElementWidth=this.element.style.width,Tr[this.hash].prevElementHeight=this.element.style.height,ko=Os.childNodes.length,go=0;go<ko;go++)this.previousBody.push(Os.childNodes[0]),Os.removeChild(Os.childNodes[0]);this.toolbar&&this.toolbar.element&&(this.toolbar.parentNode=this.toolbar.element.parentNode,this.toolbar.nextSibling=this.toolbar.element.nextSibling,Os.appendChild(this.toolbar.element),_r.addClass(this.toolbar.element,"fullpage")),_r.addClass(this.element,"fullpage"),Os.appendChild(this.element),this.element.style.height=_r.getWindowSize().y+"px",this.element.style.width=_r.getWindowSize().x+"px",this.toolbar&&this.toolbar.element&&(this.element.style.height=_r.getElementSize(this.element).y-_r.getElementSize(this.toolbar.element).y+"px"),Tr[this.hash].fullPage=!0,_r.delegate(this,fs)({})}else{for(this.element.style.margin=this.elementMargin,this.element.style.padding=this.elementPadding,Ws.margin=this.bodyMargin,to.margin=this.docMargin,Ws.padding=this.bodyPadding,to.padding=this.docPadding,Ws.width=this.bodyWidth,to.width=this.docWidth,Ws.height=this.bodyHeight,to.height=this.docHeight,Os.removeChild(this.element),ko=this.previousBody.length,go=0;go<ko;go++)Os.appendChild(this.previousBody.shift());_r.removeClass(this.element,"fullpage"),Tr[this.hash].prevElementParent.insertBefore(this.element,Tr[this.hash].prevNextSibling),this.toolbar&&this.toolbar.element&&(Os.removeChild(this.toolbar.element),_r.removeClass(this.toolbar.element,"fullpage"),this.toolbar.parentNode.insertBefore(this.toolbar.element,this.toolbar.nextSibling),delete this.toolbar.parentNode,delete this.toolbar.nextSibling),this.element.style.width=Tr[this.hash].prevElementWidth,this.element.style.height=Tr[this.hash].prevElementHeight;var Ho=0,Uo=function(){_r.setPageScroll(io.pageScroll);var Io=_r.getPageScroll();Ho++,Ho<10&&(Io.x!==io.pageScroll.x||Io.y!==io.pageScroll.y)&&_r.requestAnimationFrame(Uo)};_r.requestAnimationFrame(Uo),Tr[this.hash].fullPage=!1,_r.delegate(this,Ts)({})}return this.navigator&&this.viewport&&this.navigator.update(this.viewport),this.raiseEvent("full-page",{fullPage:ds}),this},setFullScreen:function(ds){var Os=this;if(!_r.supportsFullScreen)return this.setFullPage(ds);if(_r.isFullScreen()===ds)return this;var Ws={fullScreen:ds,preventDefaultAction:!1};if(this.raiseEvent("pre-full-screen",Ws),Ws.preventDefaultAction)return this;if(ds){if(this.setFullPage(!0),!this.isFullPage())return this;this.fullPageStyleWidth=this.element.style.width,this.fullPageStyleHeight=this.element.style.height,this.element.style.width="100%",this.element.style.height="100%";var to=function(){var io=_r.isFullScreen();io||(_r.removeEvent(document,_r.fullScreenEventName,to),_r.removeEvent(document,_r.fullScreenErrorEventName,to),Os.setFullPage(!1),Os.isFullPage()&&(Os.element.style.width=Os.fullPageStyleWidth,Os.element.style.height=Os.fullPageStyleHeight)),Os.navigator&&Os.viewport&&setTimeout(function(){Os.navigator.update(Os.viewport)}),Os.raiseEvent("full-screen",{fullScreen:io})};_r.addEvent(document,_r.fullScreenEventName,to),_r.addEvent(document,_r.fullScreenErrorEventName,to),_r.requestFullScreen(document.body)}else _r.exitFullScreen();return this},isVisible:function(){return this.container.style.visibility!="hidden"},setVisible:function(ds){return this.container.style.visibility=ds?"":"hidden",this.raiseEvent("visible",{visible:ds}),this},addTiledImage:function(ds){_r.console.assert(ds,"[Viewer.addTiledImage] options is required"),_r.console.assert(ds.tileSource,"[Viewer.addTiledImage] options.tileSource is required"),_r.console.assert(!ds.replace||ds.index>-1&&ds.index<this.world.getItemCount(),"[Viewer.addTiledImage] if options.replace is used, options.index must be a valid index in Viewer.world");var Os=this;ds.replace&&(ds.replaceItem=Os.world.getItemAt(ds.index)),this._hideMessage(),ds.placeholderFillStyle===void 0&&(ds.placeholderFillStyle=this.placeholderFillStyle),ds.opacity===void 0&&(ds.opacity=this.opacity),ds.preload===void 0&&(ds.preload=this.preload),ds.compositeOperation===void 0&&(ds.compositeOperation=this.compositeOperation),ds.crossOriginPolicy===void 0&&(ds.crossOriginPolicy=ds.tileSource.crossOriginPolicy!==void 0?ds.tileSource.crossOriginPolicy:this.crossOriginPolicy),ds.ajaxWithCredentials===void 0&&(ds.ajaxWithCredentials=this.ajaxWithCredentials),ds.loadTilesWithAjax===void 0&&(ds.loadTilesWithAjax=this.loadTilesWithAjax),ds.ajaxHeaders===void 0||ds.ajaxHeaders===null?ds.ajaxHeaders=this.ajaxHeaders:_r.isPlainObject(ds.ajaxHeaders)&&_r.isPlainObject(this.ajaxHeaders)&&(ds.ajaxHeaders=_r.extend({},this.ajaxHeaders,ds.ajaxHeaders));var Ws={options:ds};function to(go){for(var To=0;To<Os._loadQueue.length;To++)if(Os._loadQueue[To]===Ws){Os._loadQueue.splice(To,1);break}Os._loadQueue.length===0&&io(Ws),Os.raiseEvent("add-item-failed",go),ds.error&&ds.error(go)}function io(go){Os.collectionMode&&(Os.world.arrange({immediately:go.options.collectionImmediately,rows:Os.collectionRows,columns:Os.collectionColumns,layout:Os.collectionLayout,tileSize:Os.collectionTileSize,tileMargin:Os.collectionTileMargin}),Os.world.setAutoRefigureSizes(!0))}if(_r.isArray(ds.tileSource)){setTimeout(function(){to({message:"[Viewer.addTiledImage] Sequences can not be added; add them one at a time instead.",source:ds.tileSource,options:ds})});return}this._loadQueue.push(Ws);function ko(){for(var go,To,Ho;Os._loadQueue.length&&(go=Os._loadQueue[0],!!go.tileSource);){if(Os._loadQueue.splice(0,1),go.options.replace){var Uo=Os.world.getIndexOfItem(go.options.replaceItem);Uo!=-1&&(go.options.index=Uo),Os.world.removeItem(go.options.replaceItem)}To=new _r.TiledImage({viewer:Os,source:go.tileSource,viewport:Os.viewport,drawer:Os.drawer,tileCache:Os.tileCache,imageLoader:Os.imageLoader,x:go.options.x,y:go.options.y,width:go.options.width,height:go.options.height,fitBounds:go.options.fitBounds,fitBoundsPlacement:go.options.fitBoundsPlacement,clip:go.options.clip,placeholderFillStyle:go.options.placeholderFillStyle,opacity:go.options.opacity,preload:go.options.preload,degrees:go.options.degrees,compositeOperation:go.options.compositeOperation,springStiffness:Os.springStiffness,animationTime:Os.animationTime,minZoomImageRatio:Os.minZoomImageRatio,wrapHorizontal:Os.wrapHorizontal,wrapVertical:Os.wrapVertical,immediateRender:Os.immediateRender,blendTime:Os.blendTime,alwaysBlend:Os.alwaysBlend,minPixelRatio:Os.minPixelRatio,smoothTileEdgesMinZoom:Os.smoothTileEdgesMinZoom,iOSDevice:Os.iOSDevice,crossOriginPolicy:go.options.crossOriginPolicy,ajaxWithCredentials:go.options.ajaxWithCredentials,loadTilesWithAjax:go.options.loadTilesWithAjax,ajaxHeaders:go.options.ajaxHeaders,debugMode:Os.debugMode}),Os.collectionMode&&Os.world.setAutoRefigureSizes(!1),Os.world.addItem(To,{index:go.options.index}),Os._loadQueue.length===0&&io(go),Os.world.getItemCount()===1&&!Os.preserveViewport&&Os.viewport.goHome(!0),Os.navigator&&(Ho=_r.extend({},go.options,{replace:!1,originalTiledImage:To,tileSource:go.tileSource}),Os.navigator.addTiledImage(Ho)),go.options.success&&go.options.success({item:To})}}Pr(this,ds.tileSource,ds,function(go){Ws.tileSource=go,ko()},function(go){go.options=ds,to(go),ko()})},addSimpleImage:function(ds){_r.console.assert(ds,"[Viewer.addSimpleImage] options is required"),_r.console.assert(ds.url,"[Viewer.addSimpleImage] options.url is required");var Os=_r.extend({},ds,{tileSource:{type:"image",url:ds.url}});delete Os.url,this.addTiledImage(Os)},addLayer:function(ds){var Os=this;_r.console.error("[Viewer.addLayer] this function is deprecated; use Viewer.addTiledImage() instead.");var Ws=_r.extend({},ds,{success:function(to){Os.raiseEvent("add-layer",{options:ds,drawer:to.item})},error:function(to){Os.raiseEvent("add-layer-failed",to)}});return this.addTiledImage(Ws),this},getLayerAtLevel:function(ds){return _r.console.error("[Viewer.getLayerAtLevel] this function is deprecated; use World.getItemAt() instead."),this.world.getItemAt(ds)},getLevelOfLayer:function(ds){return _r.console.error("[Viewer.getLevelOfLayer] this function is deprecated; use World.getIndexOfItem() instead."),this.world.getIndexOfItem(ds)},getLayersCount:function(){return _r.console.error("[Viewer.getLayersCount] this function is deprecated; use World.getItemCount() instead."),this.world.getItemCount()},setLayerLevel:function(ds,Os){return _r.console.error("[Viewer.setLayerLevel] this function is deprecated; use World.setItemIndex() instead."),this.world.setItemIndex(ds,Os)},removeLayer:function(ds){return _r.console.error("[Viewer.removeLayer] this function is deprecated; use World.removeItem() instead."),this.world.removeItem(ds)},forceRedraw:function(){return Tr[this.hash].forceRedraw=!0,this},bindSequenceControls:function(){var ds=_r.delegate(this,Lr),Os=_r.delegate(this,Ur),Ws=_r.delegate(this,Do),to=_r.delegate(this,Co),io=this.navImages,ko=!0;return this.showSequenceControl&&((this.previousButton||this.nextButton)&&(ko=!1),this.previousButton=new _r.Button({element:this.previousButton?_r.getElement(this.previousButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:_r.getString("Tooltips.PreviousPage"),srcRest:ps(this.prefixUrl,io.previous.REST),srcGroup:ps(this.prefixUrl,io.previous.GROUP),srcHover:ps(this.prefixUrl,io.previous.HOVER),srcDown:ps(this.prefixUrl,io.previous.DOWN),onRelease:to,onFocus:ds,onBlur:Os}),this.nextButton=new _r.Button({element:this.nextButton?_r.getElement(this.nextButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:_r.getString("Tooltips.NextPage"),srcRest:ps(this.prefixUrl,io.next.REST),srcGroup:ps(this.prefixUrl,io.next.GROUP),srcHover:ps(this.prefixUrl,io.next.HOVER),srcDown:ps(this.prefixUrl,io.next.DOWN),onRelease:Ws,onFocus:ds,onBlur:Os}),this.navPrevNextWrap||this.previousButton.disable(),(!this.tileSources||!this.tileSources.length)&&this.nextButton.disable(),ko&&(this.paging=new _r.ButtonGroup({buttons:[this.previousButton,this.nextButton],clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold}),this.pagingControl=this.paging.element,this.toolbar?this.toolbar.addControl(this.pagingControl,{anchor:_r.ControlAnchor.BOTTOM_RIGHT}):this.addControl(this.pagingControl,{anchor:this.sequenceControlAnchor||_r.ControlAnchor.TOP_LEFT}))),this},bindStandardControls:function(){var ds=_r.delegate(this,vs),Os=_r.delegate(this,js),Ws=_r.delegate(this,fo),to=_r.delegate(this,Ds),io=_r.delegate(this,Qs),ko=_r.delegate(this,yo),go=_r.delegate(this,Js),To=_r.delegate(this,lo),Ho=_r.delegate(this,vo),Uo=_r.delegate(this,Ro),Io=_r.delegate(this,Lr),xl=_r.delegate(this,Ur),Xo=this.navImages,El=[],Dl=!0;return this.showNavigationControl&&((this.zoomInButton||this.zoomOutButton||this.homeButton||this.fullPageButton||this.rotateLeftButton||this.rotateRightButton||this.flipButton)&&(Dl=!1),this.showZoomControl&&(El.push(this.zoomInButton=new _r.Button({element:this.zoomInButton?_r.getElement(this.zoomInButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:_r.getString("Tooltips.ZoomIn"),srcRest:ps(this.prefixUrl,Xo.zoomIn.REST),srcGroup:ps(this.prefixUrl,Xo.zoomIn.GROUP),srcHover:ps(this.prefixUrl,Xo.zoomIn.HOVER),srcDown:ps(this.prefixUrl,Xo.zoomIn.DOWN),onPress:ds,onRelease:Os,onClick:Ws,onEnter:ds,onExit:Os,onFocus:Io,onBlur:xl})),El.push(this.zoomOutButton=new _r.Button({element:this.zoomOutButton?_r.getElement(this.zoomOutButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:_r.getString("Tooltips.ZoomOut"),srcRest:ps(this.prefixUrl,Xo.zoomOut.REST),srcGroup:ps(this.prefixUrl,Xo.zoomOut.GROUP),srcHover:ps(this.prefixUrl,Xo.zoomOut.HOVER),srcDown:ps(this.prefixUrl,Xo.zoomOut.DOWN),onPress:to,onRelease:Os,onClick:io,onEnter:to,onExit:Os,onFocus:Io,onBlur:xl}))),this.showHomeControl&&El.push(this.homeButton=new _r.Button({element:this.homeButton?_r.getElement(this.homeButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:_r.getString("Tooltips.Home"),srcRest:ps(this.prefixUrl,Xo.home.REST),srcGroup:ps(this.prefixUrl,Xo.home.GROUP),srcHover:ps(this.prefixUrl,Xo.home.HOVER),srcDown:ps(this.prefixUrl,Xo.home.DOWN),onRelease:ko,onFocus:Io,onBlur:xl})),this.showFullPageControl&&El.push(this.fullPageButton=new _r.Button({element:this.fullPageButton?_r.getElement(this.fullPageButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:_r.getString("Tooltips.FullPage"),srcRest:ps(this.prefixUrl,Xo.fullpage.REST),srcGroup:ps(this.prefixUrl,Xo.fullpage.GROUP),srcHover:ps(this.prefixUrl,Xo.fullpage.HOVER),srcDown:ps(this.prefixUrl,Xo.fullpage.DOWN),onRelease:go,onFocus:Io,onBlur:xl})),this.showRotationControl&&(El.push(this.rotateLeftButton=new _r.Button({element:this.rotateLeftButton?_r.getElement(this.rotateLeftButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:_r.getString("Tooltips.RotateLeft"),srcRest:ps(this.prefixUrl,Xo.rotateleft.REST),srcGroup:ps(this.prefixUrl,Xo.rotateleft.GROUP),srcHover:ps(this.prefixUrl,Xo.rotateleft.HOVER),srcDown:ps(this.prefixUrl,Xo.rotateleft.DOWN),onRelease:To,onFocus:Io,onBlur:xl})),El.push(this.rotateRightButton=new _r.Button({element:this.rotateRightButton?_r.getElement(this.rotateRightButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:_r.getString("Tooltips.RotateRight"),srcRest:ps(this.prefixUrl,Xo.rotateright.REST),srcGroup:ps(this.prefixUrl,Xo.rotateright.GROUP),srcHover:ps(this.prefixUrl,Xo.rotateright.HOVER),srcDown:ps(this.prefixUrl,Xo.rotateright.DOWN),onRelease:Ho,onFocus:Io,onBlur:xl}))),this.showFlipControl&&El.push(this.flipButton=new _r.Button({element:this.flipButton?_r.getElement(this.flipButton):null,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,tooltip:_r.getString("Tooltips.Flip"),srcRest:ps(this.prefixUrl,Xo.flip.REST),srcGroup:ps(this.prefixUrl,Xo.flip.GROUP),srcHover:ps(this.prefixUrl,Xo.flip.HOVER),srcDown:ps(this.prefixUrl,Xo.flip.DOWN),onRelease:Uo,onFocus:Io,onBlur:xl})),Dl&&(this.buttons=new _r.ButtonGroup({buttons:El,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold}),this.navControl=this.buttons.element,this.addHandler("open",_r.delegate(this,no)),this.toolbar?this.toolbar.addControl(this.navControl,{anchor:this.navigationControlAnchor||_r.ControlAnchor.TOP_LEFT}):this.addControl(this.navControl,{anchor:this.navigationControlAnchor||_r.ControlAnchor.TOP_LEFT}))),this},currentPage:function(){return this._sequenceIndex},goToPage:function(ds){return this.tileSources&&ds>=0&&ds<this.tileSources.length&&(this._sequenceIndex=ds,this._updateSequenceButtons(ds),this.open(this.tileSources[ds]),this.referenceStrip&&this.referenceStrip.setFocus(ds),this.raiseEvent("page",{page:ds})),this},addOverlay:function(ds,Os,Ws,to){var io;if(_r.isPlainObject(ds)?io=ds:io={element:ds,location:Os,placement:Ws,onDraw:to},ds=_r.getElement(io.element),Mr(this.currentOverlays,ds)>=0)return this;var ko=Dr(this,io);return this.currentOverlays.push(ko),ko.drawHTML(this.overlaysContainer,this.viewport),this.raiseEvent("add-overlay",{element:ds,location:io.location,placement:io.placement}),this},updateOverlay:function(ds,Os,Ws){var to;return ds=_r.getElement(ds),to=Mr(this.currentOverlays,ds),to>=0&&(this.currentOverlays[to].update(Os,Ws),Tr[this.hash].forceRedraw=!0,this.raiseEvent("update-overlay",{element:ds,location:Os,placement:Ws})),this},removeOverlay:function(ds){var Os;return ds=_r.getElement(ds),Os=Mr(this.currentOverlays,ds),Os>=0&&(this.currentOverlays[Os].destroy(),this.currentOverlays.splice(Os,1),Tr[this.hash].forceRedraw=!0,this.raiseEvent("remove-overlay",{element:ds})),this},clearOverlays:function(){for(;this.currentOverlays.length>0;)this.currentOverlays.pop().destroy();return Tr[this.hash].forceRedraw=!0,this.raiseEvent("clear-overlay",{}),this},getOverlayById:function(ds){var Os;return ds=_r.getElement(ds),Os=Mr(this.currentOverlays,ds),Os>=0?this.currentOverlays[Os]:null},_updateSequenceButtons:function(ds){this.nextButton&&(!this.tileSources||this.tileSources.length-1===ds?this.navPrevNextWrap||this.nextButton.disable():this.nextButton.enable()),this.previousButton&&(ds>0?this.previousButton.enable():this.navPrevNextWrap||this.previousButton.disable())},_showMessage:function(ds){this._hideMessage();var Os=_r.makeNeutralElement("div");Os.appendChild(document.createTextNode(ds)),this.messageDiv=_r.makeCenteredNode(Os),_r.addClass(this.messageDiv,"openseadragon-message"),this.container.appendChild(this.messageDiv)},_hideMessage:function(){var ds=this.messageDiv;ds&&(ds.parentNode.removeChild(ds),delete this.messageDiv)},gestureSettingsByDeviceType:function(ds){switch(ds){case"mouse":return this.gestureSettingsMouse;case"touch":return this.gestureSettingsTouch;case"pen":return this.gestureSettingsPen;default:return this.gestureSettingsUnknown}},_drawOverlays:function(){var ds,Os=this.currentOverlays.length;for(ds=0;ds<Os;ds++)this.currentOverlays[ds].drawHTML(this.overlaysContainer,this.viewport)},_cancelPendingImages:function(){this._loadQueue=[]},removeReferenceStrip:function(){this.showReferenceStrip=!1,this.referenceStrip&&(this.referenceStrip.destroy(),this.referenceStrip=null)},addReferenceStrip:function(){if(this.showReferenceStrip=!0,this.sequenceMode){if(this.referenceStrip)return;this.tileSources.length&&this.tileSources.length>1&&(this.referenceStrip=new _r.ReferenceStrip({id:this.referenceStripElement,position:this.referenceStripPosition,sizeRatio:this.referenceStripSizeRatio,scroll:this.referenceStripScroll,height:this.referenceStripHeight,width:this.referenceStripWidth,tileSources:this.tileSources,prefixUrl:this.prefixUrl,useCanvas:this.useCanvas,viewer:this}),this.referenceStrip.setFocus(this._sequenceIndex))}else _r.console.warn('Attempting to display a reference strip while "sequenceMode" is off.')}});function Rr(ds){return ds=_r.getElement(ds),new _r.Point(ds.clientWidth===0?1:ds.clientWidth,ds.clientHeight===0?1:ds.clientHeight)}function Pr(ds,Os,Ws,to,io){var ko=ds;if(_r.type(Os)=="string"){if(Os.match(/^\s*<.*>\s*$/))Os=_r.parseXml(Os);else if(Os.match(/^\s*[\{\[].*[\}\]]\s*$/))try{var go=_r.parseJSON(Os);Os=go}catch{}}function To(Ho,Uo){Ho.ready?to(Ho):(Ho.addHandler("ready",function(){to(Ho)}),Ho.addHandler("open-failed",function(Io){io({message:Io.message,source:Uo})}))}setTimeout(function(){if(_r.type(Os)=="string")Os=new _r.TileSource({url:Os,crossOriginPolicy:Ws.crossOriginPolicy!==void 0?Ws.crossOriginPolicy:ds.crossOriginPolicy,ajaxWithCredentials:ds.ajaxWithCredentials,ajaxHeaders:ds.ajaxHeaders,useCanvas:ds.useCanvas,success:function(xl){to(xl.tileSource)}}),Os.addHandler("open-failed",function(xl){io(xl)});else if(_r.isPlainObject(Os)||Os.nodeType)if(Os.crossOriginPolicy===void 0&&(Ws.crossOriginPolicy!==void 0||ds.crossOriginPolicy!==void 0)&&(Os.crossOriginPolicy=Ws.crossOriginPolicy!==void 0?Ws.crossOriginPolicy:ds.crossOriginPolicy),Os.ajaxWithCredentials===void 0&&(Os.ajaxWithCredentials=ds.ajaxWithCredentials),Os.useCanvas===void 0&&(Os.useCanvas=ds.useCanvas),_r.isFunction(Os.getTileUrl)){var Ho=new _r.TileSource(Os);Ho.getTileUrl=Os.getTileUrl,to(Ho)}else{var Uo=_r.TileSource.determineType(ko,Os);if(!Uo){io({message:"Unable to load TileSource",source:Os});return}var Io=Uo.prototype.configure.apply(ko,[Os]);To(new Uo(Io),Os)}else To(Os,Os)})}function Dr(ds,Os){if(Os instanceof _r.Overlay)return Os;var Ws=null;if(Os.element)Ws=_r.getElement(Os.element);else{var to=Os.id?Os.id:"openseadragon-overlay-"+Math.floor(Math.random()*1e7);Ws=_r.getElement(Os.id),Ws||(Ws=document.createElement("a"),Ws.href="#/overlay/"+to),Ws.id=to,_r.addClass(Ws,Os.className?Os.className:"openseadragon-overlay")}var io=Os.location,ko=Os.width,go=Os.height;if(!io){var To=Os.x,Ho=Os.y;if(Os.px!==void 0){var Uo=ds.viewport.imageToViewportRectangle(new _r.Rect(Os.px,Os.py,ko||0,go||0));To=Uo.x,Ho=Uo.y,ko=ko!==void 0?Uo.width:void 0,go=go!==void 0?Uo.height:void 0}io=new _r.Point(To,Ho)}var Io=Os.placement;return Io&&_r.type(Io)==="string"&&(Io=_r.Placement[Os.placement.toUpperCase()]),new _r.Overlay({element:Ws,location:io,placement:Io,onDraw:Os.onDraw,checkResize:Os.checkResize,width:ko,height:go,rotationMode:Os.rotationMode})}function Mr(ds,Os){var Ws;for(Ws=ds.length-1;Ws>=0;Ws--)if(ds[Ws].element===Os)return Ws;return-1}function Fr(ds,Os){return _r.requestAnimationFrame(function(){Os(ds)})}function zr(ds){_r.requestAnimationFrame(function(){Gr(ds)})}function jr(ds){ds.autoHideControls&&(ds.controlsShouldFade=!0,ds.controlsFadeBeginTime=_r.now()+ds.controlsFadeDelay,window.setTimeout(function(){zr(ds)},ds.controlsFadeDelay))}function Gr(ds){var Os,Ws,to,io;if(ds.controlsShouldFade){for(Os=_r.now(),Ws=Os-ds.controlsFadeBeginTime,to=1-Ws/ds.controlsFadeLength,to=Math.min(1,to),to=Math.max(0,to),io=ds.controls.length-1;io>=0;io--)ds.controls[io].autoFade&&ds.controls[io].setOpacity(to);to>0&&zr(ds)}}function Nr(ds){var Os;for(ds.controlsShouldFade=!1,Os=ds.controls.length-1;Os>=0;Os--)ds.controls[Os].setOpacity(1)}function Lr(){Nr(this)}function Ur(){jr(this)}function Vr(ds){var Os={originalEvent:ds.originalEvent,preventDefaultAction:ds.preventDefaultAction,preventVerticalPan:ds.preventVerticalPan,preventHorizontalPan:ds.preventHorizontalPan};if(this.raiseEvent("canvas-key",Os),!Os.preventDefaultAction&&!ds.ctrl&&!ds.alt&&!ds.meta)switch(ds.keyCode){case 38:return Os.preventVerticalPan||(ds.shift?this.viewport.zoomBy(1.1):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new _r.Point(0,-this.pixelsPerArrowPress))),this.viewport.applyConstraints()),!1;case 40:return Os.preventVerticalPan||(ds.shift?this.viewport.zoomBy(.9):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new _r.Point(0,this.pixelsPerArrowPress))),this.viewport.applyConstraints()),!1;case 37:return Os.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new _r.Point(-this.pixelsPerArrowPress,0))),this.viewport.applyConstraints()),!1;case 39:return Os.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new _r.Point(this.pixelsPerArrowPress,0))),this.viewport.applyConstraints()),!1;default:return!0}else return!0}function Wr(ds){var Os={originalEvent:ds.originalEvent,preventDefaultAction:ds.preventDefaultAction,preventVerticalPan:ds.preventVerticalPan,preventHorizontalPan:ds.preventHorizontalPan};if(this.raiseEvent("canvas-key",Os),!Os.preventDefaultAction&&!ds.ctrl&&!ds.alt&&!ds.meta)switch(ds.keyCode){case 43:case 61:return this.viewport.zoomBy(1.1),this.viewport.applyConstraints(),!1;case 45:return this.viewport.zoomBy(.9),this.viewport.applyConstraints(),!1;case 48:return this.viewport.goHome(),this.viewport.applyConstraints(),!1;case 119:case 87:return Os.preventVerticalPan||(ds.shift?this.viewport.zoomBy(1.1):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new _r.Point(0,-40))),this.viewport.applyConstraints()),!1;case 115:case 83:return Os.preventVerticalPan||(ds.shift?this.viewport.zoomBy(.9):this.viewport.panBy(this.viewport.deltaPointsFromPixels(new _r.Point(0,40))),this.viewport.applyConstraints()),!1;case 97:return Os.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new _r.Point(-40,0))),this.viewport.applyConstraints()),!1;case 100:return Os.preventHorizontalPan||(this.viewport.panBy(this.viewport.deltaPointsFromPixels(new _r.Point(40,0))),this.viewport.applyConstraints()),!1;case 114:return this.viewport.flipped?this.viewport.setRotation(_r.positiveModulo(this.viewport.degrees-this.rotationIncrement,360)):this.viewport.setRotation(_r.positiveModulo(this.viewport.degrees+this.rotationIncrement,360)),this.viewport.applyConstraints(),!1;case 82:return this.viewport.flipped?this.viewport.setRotation(_r.positiveModulo(this.viewport.degrees+this.rotationIncrement,360)):this.viewport.setRotation(_r.positiveModulo(this.viewport.degrees-this.rotationIncrement,360)),this.viewport.applyConstraints(),!1;case 102:return this.viewport.toggleFlip(),!1;default:return!0}else return!0}function qr(ds){var Os,Ws=document.activeElement==this.canvas;Ws||this.canvas.focus(),this.viewport.flipped&&(ds.position.x=this.viewport.getContainerSize().x-ds.position.x);var to={tracker:ds.eventSource,position:ds.position,quick:ds.quick,shift:ds.shift,originalEvent:ds.originalEvent,preventDefaultAction:ds.preventDefaultAction};this.raiseEvent("canvas-click",to),!to.preventDefaultAction&&this.viewport&&ds.quick&&(Os=this.gestureSettingsByDeviceType(ds.pointerType),Os.clickToZoom&&(this.viewport.zoomBy(ds.shift?1/this.zoomPerClick:this.zoomPerClick,Os.zoomToRefPoint?this.viewport.pointFromPixel(ds.position,!0):null),this.viewport.applyConstraints()))}function Kr(ds){var Os,Ws={tracker:ds.eventSource,position:ds.position,shift:ds.shift,originalEvent:ds.originalEvent,preventDefaultAction:ds.preventDefaultAction};this.raiseEvent("canvas-double-click",Ws),!Ws.preventDefaultAction&&this.viewport&&(Os=this.gestureSettingsByDeviceType(ds.pointerType),Os.dblClickToZoom&&(this.viewport.zoomBy(ds.shift?1/this.zoomPerClick:this.zoomPerClick,Os.zoomToRefPoint?this.viewport.pointFromPixel(ds.position,!0):null),this.viewport.applyConstraints()))}function Xr(ds){var Os,Ws={tracker:ds.eventSource,position:ds.position,delta:ds.delta,speed:ds.speed,direction:ds.direction,shift:ds.shift,originalEvent:ds.originalEvent,preventDefaultAction:ds.preventDefaultAction};if(this.raiseEvent("canvas-drag",Ws),!Ws.preventDefaultAction&&this.viewport){if(Os=this.gestureSettingsByDeviceType(ds.pointerType),this.panHorizontal||(ds.delta.x=0),this.panVertical||(ds.delta.y=0),this.viewport.flipped&&(ds.delta.x=-ds.delta.x),this.constrainDuringPan){var to=this.viewport.deltaPointsFromPixels(ds.delta.negate());this.viewport.centerSpringX.target.value+=to.x,this.viewport.centerSpringY.target.value+=to.y;var io=this.viewport.getBounds(),ko=this.viewport.getConstrainedBounds();this.viewport.centerSpringX.target.value-=to.x,this.viewport.centerSpringY.target.value-=to.y,io.x!=ko.x&&(ds.delta.x=0),io.y!=ko.y&&(ds.delta.y=0)}this.viewport.panBy(this.viewport.deltaPointsFromPixels(ds.delta.negate()),Os.flickEnabled&&!this.constrainDuringPan)}}function Zr(ds){if(!ds.preventDefaultAction&&this.viewport){var Os=this.gestureSettingsByDeviceType(ds.pointerType);if(Os.flickEnabled&&ds.speed>=Os.flickMinSpeed){var Ws=0;this.panHorizontal&&(Ws=Os.flickMomentum*ds.speed*Math.cos(ds.direction));var to=0;this.panVertical&&(to=Os.flickMomentum*ds.speed*Math.sin(ds.direction));var io=this.viewport.pixelFromPoint(this.viewport.getCenter(!0)),ko=this.viewport.pointFromPixel(new _r.Point(io.x-Ws,io.y-to));this.viewport.panTo(ko,!1)}this.viewport.applyConstraints()}this.raiseEvent("canvas-drag-end",{tracker:ds.eventSource,position:ds.position,speed:ds.speed,direction:ds.direction,shift:ds.shift,originalEvent:ds.originalEvent})}function _i(ds){this.raiseEvent("canvas-enter",{tracker:ds.eventSource,pointerType:ds.pointerType,position:ds.position,buttons:ds.buttons,pointers:ds.pointers,insideElementPressed:ds.insideElementPressed,buttonDownAny:ds.buttonDownAny,originalEvent:ds.originalEvent})}function Jr(ds){window.location!=window.parent.location&&_r.MouseTracker.resetAllMouseTrackers(),this.raiseEvent("canvas-exit",{tracker:ds.eventSource,pointerType:ds.pointerType,position:ds.position,buttons:ds.buttons,pointers:ds.pointers,insideElementPressed:ds.insideElementPressed,buttonDownAny:ds.buttonDownAny,originalEvent:ds.originalEvent})}function es(ds){this.raiseEvent("canvas-press",{tracker:ds.eventSource,pointerType:ds.pointerType,position:ds.position,insideElementPressed:ds.insideElementPressed,insideElementReleased:ds.insideElementReleased,originalEvent:ds.originalEvent})}function ts(ds){this.raiseEvent("canvas-release",{tracker:ds.eventSource,pointerType:ds.pointerType,position:ds.position,insideElementPressed:ds.insideElementPressed,insideElementReleased:ds.insideElementReleased,originalEvent:ds.originalEvent})}function is(ds){this.raiseEvent("canvas-nonprimary-press",{tracker:ds.eventSource,position:ds.position,pointerType:ds.pointerType,button:ds.button,buttons:ds.buttons,originalEvent:ds.originalEvent})}function rs(ds){this.raiseEvent("canvas-nonprimary-release",{tracker:ds.eventSource,position:ds.position,pointerType:ds.pointerType,button:ds.button,buttons:ds.buttons,originalEvent:ds.originalEvent})}function as(ds){var Os,Ws,to,io;if(!ds.preventDefaultAction&&this.viewport&&(Os=this.gestureSettingsByDeviceType(ds.pointerType),Os.pinchToZoom&&(Ws=this.viewport.pointFromPixel(ds.center,!0),to=this.viewport.pointFromPixel(ds.lastCenter,!0),io=to.minus(Ws),this.panHorizontal||(io.x=0),this.panVertical||(io.y=0),this.viewport.zoomBy(ds.distance/ds.lastDistance,Ws,!0),Os.zoomToRefPoint&&this.viewport.panBy(io,!0),this.viewport.applyConstraints()),Os.pinchRotate)){var ko=Math.atan2(ds.gesturePoints[0].currentPos.y-ds.gesturePoints[1].currentPos.y,ds.gesturePoints[0].currentPos.x-ds.gesturePoints[1].currentPos.x),go=Math.atan2(ds.gesturePoints[0].lastPos.y-ds.gesturePoints[1].lastPos.y,ds.gesturePoints[0].lastPos.x-ds.gesturePoints[1].lastPos.x);this.viewport.setRotation(this.viewport.getRotation()+(ko-go)*(180/Math.PI))}return this.raiseEvent("canvas-pinch",{tracker:ds.eventSource,gesturePoints:ds.gesturePoints,lastCenter:ds.lastCenter,center:ds.center,lastDistance:ds.lastDistance,distance:ds.distance,shift:ds.shift,originalEvent:ds.originalEvent}),!1}function ls(ds){var Os,Ws,to,io;if(to=_r.now(),io=to-this._lastScrollTime,io>this.minScrollDeltaTime){if(this._lastScrollTime=to,this.viewport.flipped&&(ds.position.x=this.viewport.getContainerSize().x-ds.position.x),!ds.preventDefaultAction&&this.viewport&&(Os=this.gestureSettingsByDeviceType(ds.pointerType),Os.scrollToZoom&&(Ws=Math.pow(this.zoomPerScroll,ds.scroll),this.viewport.zoomBy(Ws,Os.zoomToRefPoint?this.viewport.pointFromPixel(ds.position,!0):null),this.viewport.applyConstraints())),this.raiseEvent("canvas-scroll",{tracker:ds.eventSource,position:ds.position,scroll:ds.scroll,shift:ds.shift,originalEvent:ds.originalEvent}),Os&&Os.scrollToZoom)return!1}else if(Os=this.gestureSettingsByDeviceType(ds.pointerType),Os&&Os.scrollToZoom)return!1}function fs(ds){Tr[this.hash].mouseInside=!0,Nr(this),this.raiseEvent("container-enter",{tracker:ds.eventSource,position:ds.position,buttons:ds.buttons,pointers:ds.pointers,insideElementPressed:ds.insideElementPressed,buttonDownAny:ds.buttonDownAny,originalEvent:ds.originalEvent})}function Ts(ds){ds.pointers<1&&(Tr[this.hash].mouseInside=!1,Tr[this.hash].animating||jr(this)),this.raiseEvent("container-exit",{tracker:ds.eventSource,position:ds.position,buttons:ds.buttons,pointers:ds.pointers,insideElementPressed:ds.insideElementPressed,buttonDownAny:ds.buttonDownAny,originalEvent:ds.originalEvent})}function $s(ds){xs(ds),ds.isOpen()?ds._updateRequestId=Fr(ds,$s):ds._updateRequestId=!1}function xs(ds){if(!ds._opening){if(ds.autoResize){var Os=Rr(ds.container),Ws=Tr[ds.hash].prevContainerSize;if(!Os.equals(Ws)){var to=ds.viewport;if(ds.preserveImageSizeOnResize){var io=Ws.x/Os.x,ko=to.getZoom()*io,go=to.getCenter();to.resize(Os,!1),to.zoomTo(ko,null,!0),to.panTo(go,!0)}else{var To=to.getBounds();to.resize(Os,!0),to.fitBoundsWithConstraints(To,!0)}Tr[ds.hash].prevContainerSize=Os,Tr[ds.hash].forceRedraw=!0}}var Ho=ds.viewport.update(),Uo=ds.world.update()||Ho;Ho&&ds.raiseEvent("viewport-change"),ds.referenceStrip&&(Uo=ds.referenceStrip.update(ds.viewport)||Uo),!Tr[ds.hash].animating&&Uo&&(ds.raiseEvent("animation-start"),Nr(ds)),(Uo||Tr[ds.hash].forceRedraw||ds.world.needsDraw())&&(ys(ds),ds._drawOverlays(),ds.navigator&&ds.navigator.update(ds.viewport),Tr[ds.hash].forceRedraw=!1,Uo&&ds.raiseEvent("animation")),Tr[ds.hash].animating&&!Uo&&(ds.raiseEvent("animation-finish"),Tr[ds.hash].mouseInside||jr(ds)),Tr[ds.hash].animating=Uo}}function ys(ds){ds.imageLoader.clear(),ds.drawer.clear(),ds.world.draw(),ds.raiseEvent("update-viewport",{})}function ps(ds,Os){return ds?ds+Os:Os}function vs(){Tr[this.hash].lastZoomTime=_r.now(),Tr[this.hash].zoomFactor=this.zoomPerSecond,Tr[this.hash].zooming=!0,zs(this)}function Ds(){Tr[this.hash].lastZoomTime=_r.now(),Tr[this.hash].zoomFactor=1/this.zoomPerSecond,Tr[this.hash].zooming=!0,zs(this)}function js(){Tr[this.hash].zooming=!1}function zs(ds){_r.requestAnimationFrame(_r.delegate(ds,qs))}function qs(){var ds,Os,Ws;Tr[this.hash].zooming&&this.viewport&&(ds=_r.now(),Os=ds-Tr[this.hash].lastZoomTime,Ws=Math.pow(Tr[this.hash].zoomFactor,Os/1e3),this.viewport.zoomBy(Ws),this.viewport.applyConstraints(),Tr[this.hash].lastZoomTime=ds,zs(this))}function fo(){this.viewport&&(Tr[this.hash].zooming=!1,this.viewport.zoomBy(this.zoomPerClick/1),this.viewport.applyConstraints())}function Qs(){this.viewport&&(Tr[this.hash].zooming=!1,this.viewport.zoomBy(1/this.zoomPerClick),this.viewport.applyConstraints())}function no(){this.buttons.emulateEnter(),this.buttons.emulateExit()}function yo(){this.viewport&&this.viewport.goHome()}function Js(){this.isFullPage()&&!_r.isFullScreen()?this.setFullPage(!1):this.setFullScreen(!this.isFullPage()),this.buttons&&this.buttons.emulateExit(),this.fullPageButton.element.focus(),this.viewport&&this.viewport.applyConstraints()}function lo(){if(this.viewport){var ds=this.viewport.getRotation();this.viewport.flipped?ds=_r.positiveModulo(ds+this.rotationIncrement,360):ds=_r.positiveModulo(ds-this.rotationIncrement,360),this.viewport.setRotation(ds)}}function vo(){if(this.viewport){var ds=this.viewport.getRotation();this.viewport.flipped?ds=_r.positiveModulo(ds-this.rotationIncrement,360):ds=_r.positiveModulo(ds+this.rotationIncrement,360),this.viewport.setRotation(ds)}}function Ro(){this.viewport.toggleFlip()}function Co(){var ds=this._sequenceIndex-1;this.navPrevNextWrap&&ds<0&&(ds+=this.tileSources.length),this.goToPage(ds)}function Do(){var ds=this._sequenceIndex+1;this.navPrevNextWrap&&ds>=this.tileSources.length&&(ds=0),this.goToPage(ds)}}(OpenSeadragon),function(_r){_r.Navigator=function(Fr){var zr=Fr.viewer,jr=this,Gr,Nr;Fr.id?(this.element=document.getElementById(Fr.id),Fr.controlOptions={anchor:_r.ControlAnchor.NONE,attachToViewer:!1,autoFade:!1}):(Fr.id="navigator-"+_r.now(),this.element=_r.makeNeutralElement("div"),Fr.controlOptions={anchor:_r.ControlAnchor.TOP_RIGHT,attachToViewer:!0,autoFade:Fr.autoFade},Fr.position&&(Fr.position=="BOTTOM_RIGHT"?Fr.controlOptions.anchor=_r.ControlAnchor.BOTTOM_RIGHT:Fr.position=="BOTTOM_LEFT"?Fr.controlOptions.anchor=_r.ControlAnchor.BOTTOM_LEFT:Fr.position=="TOP_RIGHT"?Fr.controlOptions.anchor=_r.ControlAnchor.TOP_RIGHT:Fr.position=="TOP_LEFT"?Fr.controlOptions.anchor=_r.ControlAnchor.TOP_LEFT:Fr.position=="ABSOLUTE"&&(Fr.controlOptions.anchor=_r.ControlAnchor.ABSOLUTE,Fr.controlOptions.top=Fr.top,Fr.controlOptions.left=Fr.left,Fr.controlOptions.height=Fr.height,Fr.controlOptions.width=Fr.width))),this.element.id=Fr.id,this.element.className+=" navigator",Fr=_r.extend(!0,{sizeRatio:_r.DEFAULT_SETTINGS.navigatorSizeRatio},Fr,{element:this.element,tabIndex:-1,showNavigator:!1,mouseNavEnabled:!1,showNavigationControl:!1,showSequenceControl:!1,immediateRender:!0,blendTime:0,animationTime:0,autoResize:Fr.autoResize,minZoomImageRatio:1,background:Fr.background,opacity:Fr.opacity,borderColor:Fr.borderColor,displayRegionColor:Fr.displayRegionColor}),Fr.minPixelRatio=this.minPixelRatio=zr.minPixelRatio,_r.setElementTouchActionNone(this.element),this.borderWidth=2,this.fudge=new _r.Point(1,1),this.totalBorderWidths=new _r.Point(this.borderWidth*2,this.borderWidth*2).minus(this.fudge),Fr.controlOptions.anchor!=_r.ControlAnchor.NONE&&function(Vr,Wr){Vr.margin="0px",Vr.border=Wr+"px solid "+Fr.borderColor,Vr.padding="0px",Vr.background=Fr.background,Vr.opacity=Fr.opacity,Vr.overflow="hidden"}(this.element.style,this.borderWidth),this.displayRegion=_r.makeNeutralElement("div"),this.displayRegion.id=this.element.id+"-displayregion",this.displayRegion.className="displayregion",function(Vr,Wr){Vr.position="relative",Vr.top="0px",Vr.left="0px",Vr.fontSize="0px",Vr.overflow="hidden",Vr.border=Wr+"px solid "+Fr.displayRegionColor,Vr.margin="0px",Vr.padding="0px",Vr.background="transparent",Vr.float="left",Vr.cssFloat="left",Vr.styleFloat="left",Vr.zIndex=999999999,Vr.cursor="default"}(this.displayRegion.style,this.borderWidth),this.displayRegionContainer=_r.makeNeutralElement("div"),this.displayRegionContainer.id=this.element.id+"-displayregioncontainer",this.displayRegionContainer.className="displayregioncontainer",this.displayRegionContainer.style.width="100%",this.displayRegionContainer.style.height="100%",zr.addControl(this.element,Fr.controlOptions),this._resizeWithViewer=Fr.controlOptions.anchor!=_r.ControlAnchor.ABSOLUTE&&Fr.controlOptions.anchor!=_r.ControlAnchor.NONE,Fr.width&&Fr.height?(this.setWidth(Fr.width),this.setHeight(Fr.height)):this._resizeWithViewer&&(Gr=_r.getElementSize(zr.element),this.element.style.height=Math.round(Gr.y*Fr.sizeRatio)+"px",this.element.style.width=Math.round(Gr.x*Fr.sizeRatio)+"px",this.oldViewerSize=Gr,Nr=_r.getElementSize(this.element),this.elementArea=Nr.x*Nr.y),this.oldContainerSize=new _r.Point(0,0),_r.Viewer.apply(this,[Fr]),this.displayRegionContainer.appendChild(this.displayRegion),this.element.getElementsByTagName("div")[0].appendChild(this.displayRegionContainer);function Lr(Vr){Dr(jr.displayRegionContainer,Vr),Dr(jr.displayRegion,-Vr),jr.viewport.setRotation(Vr)}if(Fr.navigatorRotate){var Ur=Fr.viewer.viewport?Fr.viewer.viewport.getRotation():Fr.viewer.degrees||0;Lr(Ur),Fr.viewer.addHandler("rotate",function(Vr){Lr(Vr.degrees)})}this.innerTracker.destroy(),this.innerTracker=new _r.MouseTracker({element:this.element,dragHandler:_r.delegate(this,Ar),clickHandler:_r.delegate(this,Tr),releaseHandler:_r.delegate(this,Rr),scrollHandler:_r.delegate(this,Pr)}),this.addHandler("reset-size",function(){jr.viewport&&jr.viewport.goHome(!0)}),zr.world.addHandler("item-index-change",function(Vr){window.setTimeout(function(){var Wr=jr.world.getItemAt(Vr.previousIndex);jr.world.setItemIndex(Wr,Vr.newIndex)},1)}),zr.world.addHandler("remove-item",function(Vr){var Wr=Vr.item,qr=jr._getMatchingItem(Wr);qr&&jr.world.removeItem(qr)}),this.update(zr.viewport)},_r.extend(_r.Navigator.prototype,_r.EventSource.prototype,_r.Viewer.prototype,{updateSize:function(){if(this.viewport){var Fr=new _r.Point(this.container.clientWidth===0?1:this.container.clientWidth,this.container.clientHeight===0?1:this.container.clientHeight);Fr.equals(this.oldContainerSize)||(this.viewport.resize(Fr,!0),this.viewport.goHome(!0),this.oldContainerSize=Fr,this.drawer.clear(),this.world.draw())}},setWidth:function(Fr){this.width=Fr,this.element.style.width=typeof Fr=="number"?Fr+"px":Fr,this._resizeWithViewer=!1},setHeight:function(Fr){this.height=Fr,this.element.style.height=typeof Fr=="number"?Fr+"px":Fr,this._resizeWithViewer=!1},setFlip:function(Fr){return this.viewport.setFlip(Fr),this.setDisplayTransform(this.viewer.viewport.getFlip()?"scale(-1,1)":"scale(1,1)"),this},setDisplayTransform:function(Fr){Mr(this.displayRegion,Fr),Mr(this.canvas,Fr),Mr(this.element,Fr)},update:function(Fr){var zr,jr,Gr,Nr,Lr,Ur;if(zr=_r.getElementSize(this.viewer.element),this._resizeWithViewer&&zr.x&&zr.y&&!zr.equals(this.oldViewerSize)&&(this.oldViewerSize=zr,this.maintainSizeRatio||!this.elementArea?(jr=zr.x*this.sizeRatio,Gr=zr.y*this.sizeRatio):(jr=Math.sqrt(this.elementArea*(zr.x/zr.y)),Gr=this.elementArea/jr),this.element.style.width=Math.round(jr)+"px",this.element.style.height=Math.round(Gr)+"px",this.elementArea||(this.elementArea=jr*Gr),this.updateSize()),Fr&&this.viewport){Nr=Fr.getBoundsNoRotate(!0),Lr=this.viewport.pixelFromPointNoRotate(Nr.getTopLeft(),!1),Ur=this.viewport.pixelFromPointNoRotate(Nr.getBottomRight(),!1).minus(this.totalBorderWidths);var Vr=this.displayRegion.style;Vr.display=this.world.getItemCount()?"block":"none",Vr.top=Math.round(Lr.y)+"px",Vr.left=Math.round(Lr.x)+"px";var Wr=Math.abs(Lr.x-Ur.x),qr=Math.abs(Lr.y-Ur.y);Vr.width=Math.round(Math.max(Wr,0))+"px",Vr.height=Math.round(Math.max(qr,0))+"px"}},addTiledImage:function(Fr){var zr=this,jr=Fr.originalTiledImage;delete Fr.original;var Gr=_r.extend({},Fr,{success:function(Nr){var Lr=Nr.item;Lr._originalForNavigator=jr,zr._matchBounds(Lr,jr,!0);function Ur(){zr._matchBounds(Lr,jr)}function Vr(){zr._matchOpacity(Lr,jr)}function Wr(){zr._matchCompositeOperation(Lr,jr)}jr.addHandler("bounds-change",Ur),jr.addHandler("clip-change",Ur),jr.addHandler("opacity-change",Vr),jr.addHandler("composite-operation-change",Wr)}});return _r.Viewer.prototype.addTiledImage.apply(this,[Gr])},_getMatchingItem:function(Fr){for(var zr=this.world.getItemCount(),jr,Gr=0;Gr<zr;Gr++)if(jr=this.world.getItemAt(Gr),jr._originalForNavigator===Fr)return jr;return null},_matchBounds:function(Fr,zr,jr){var Gr=zr.getBoundsNoRotate();Fr.setPosition(Gr.getTopLeft(),jr),Fr.setWidth(Gr.width,jr),Fr.setRotation(zr.getRotation(),jr),Fr.setClip(zr.getClip())},_matchOpacity:function(Fr,zr){Fr.setOpacity(zr.opacity)},_matchCompositeOperation:function(Fr,zr){Fr.setCompositeOperation(zr.compositeOperation)}});function Tr(Fr){var zr={tracker:Fr.eventSource,position:Fr.position,quick:Fr.quick,shift:Fr.shift,originalEvent:Fr.originalEvent,preventDefaultAction:Fr.preventDefaultAction};if(this.viewer.raiseEvent("navigator-click",zr),!zr.preventDefaultAction&&Fr.quick&&this.viewer.viewport&&(this.panVertical||this.panHorizontal)){this.viewer.viewport.flipped&&(Fr.position.x=this.viewport.getContainerSize().x-Fr.position.x);var jr=this.viewport.pointFromPixel(Fr.position);this.panVertical?this.panHorizontal||(jr.x=this.viewer.viewport.getCenter(!0).x):jr.y=this.viewer.viewport.getCenter(!0).y,this.viewer.viewport.panTo(jr),this.viewer.viewport.applyConstraints()}}function Ar(Fr){var zr={tracker:Fr.eventSource,position:Fr.position,delta:Fr.delta,speed:Fr.speed,direction:Fr.direction,shift:Fr.shift,originalEvent:Fr.originalEvent,preventDefaultAction:Fr.preventDefaultAction};this.viewer.raiseEvent("navigator-drag",zr),!zr.preventDefaultAction&&this.viewer.viewport&&(this.panHorizontal||(Fr.delta.x=0),this.panVertical||(Fr.delta.y=0),this.viewer.viewport.flipped&&(Fr.delta.x=-Fr.delta.x),this.viewer.viewport.panBy(this.viewport.deltaPointsFromPixels(Fr.delta)),this.viewer.constrainDuringPan&&this.viewer.viewport.applyConstraints())}function Rr(Fr){Fr.insideElementPressed&&this.viewer.viewport&&this.viewer.viewport.applyConstraints()}function Pr(Fr){return this.viewer.raiseEvent("navigator-scroll",{tracker:Fr.eventSource,position:Fr.position,scroll:Fr.scroll,shift:Fr.shift,originalEvent:Fr.originalEvent}),!1}function Dr(Fr,zr){Mr(Fr,"rotate("+zr+"deg)")}function Mr(Fr,zr){Fr.style.webkitTransform=zr,Fr.style.mozTransform=zr,Fr.style.msTransform=zr,Fr.style.oTransform=zr,Fr.style.transform=zr}}(OpenSeadragon),function(_r){var Tr={Errors:{Dzc:"Sorry, we don't support Deep Zoom Collections!",Dzi:"Hmm, this doesn't appear to be a valid Deep Zoom Image.",Xml:"Hmm, this doesn't appear to be a valid Deep Zoom Image.",ImageFormat:"Sorry, we don't support {0}-based Deep Zoom Images.",Security:"It looks like a security restriction stopped us from loading this Deep Zoom Image.",Status:"This space unintentionally left blank ({0} {1}).",OpenFailed:"Unable to open {0}: {1}"},Tooltips:{FullPage:"Toggle full page",Home:"Go home",ZoomIn:"Zoom in",ZoomOut:"Zoom out",NextPage:"Next page",PreviousPage:"Previous page",RotateLeft:"Rotate left",RotateRight:"Rotate right",Flip:"Flip Horizontally"}};_r.extend(_r,{getString:function(Ar){var Rr=Ar.split("."),Pr=null,Dr=arguments,Mr=Tr,Fr;for(Fr=0;Fr<Rr.length-1;Fr++)Mr=Mr[Rr[Fr]]||{};return Pr=Mr[Rr[Fr]],typeof Pr!="string"&&(_r.console.log("Untranslated source string:",Ar),Pr=""),Pr.replace(/\{\d+\}/g,function(zr){var jr=parseInt(zr.match(/\d+/),10)+1;return jr<Dr.length?Dr[jr]:""})},setString:function(Ar,Rr){var Pr=Ar.split("."),Dr=Tr,Mr;for(Mr=0;Mr<Pr.length-1;Mr++)Dr[Pr[Mr]]||(Dr[Pr[Mr]]={}),Dr=Dr[Pr[Mr]];Dr[Pr[Mr]]=Rr}})}(OpenSeadragon),function(_r){_r.Point=function(Tr,Ar){this.x=typeof Tr=="number"?Tr:0,this.y=typeof Ar=="number"?Ar:0},_r.Point.prototype={clone:function(){return new _r.Point(this.x,this.y)},plus:function(Tr){return new _r.Point(this.x+Tr.x,this.y+Tr.y)},minus:function(Tr){return new _r.Point(this.x-Tr.x,this.y-Tr.y)},times:function(Tr){return new _r.Point(this.x*Tr,this.y*Tr)},divide:function(Tr){return new _r.Point(this.x/Tr,this.y/Tr)},negate:function(){return new _r.Point(-this.x,-this.y)},distanceTo:function(Tr){return Math.sqrt(Math.pow(this.x-Tr.x,2)+Math.pow(this.y-Tr.y,2))},squaredDistanceTo:function(Tr){return Math.pow(this.x-Tr.x,2)+Math.pow(this.y-Tr.y,2)},apply:function(Tr){return new _r.Point(Tr(this.x),Tr(this.y))},equals:function(Tr){return Tr instanceof _r.Point&&this.x===Tr.x&&this.y===Tr.y},rotate:function(Tr,Ar){Ar=Ar||new _r.Point(0,0);var Rr,Pr;if(Tr%90===0){var Dr=_r.positiveModulo(Tr,360);switch(Dr){case 0:Rr=1,Pr=0;break;case 90:Rr=0,Pr=1;break;case 180:Rr=-1,Pr=0;break;case 270:Rr=0,Pr=-1;break}}else{var Mr=Tr*Math.PI/180;Rr=Math.cos(Mr),Pr=Math.sin(Mr)}var Fr=Rr*(this.x-Ar.x)-Pr*(this.y-Ar.y)+Ar.x,zr=Pr*(this.x-Ar.x)+Rr*(this.y-Ar.y)+Ar.y;return new _r.Point(Fr,zr)},toString:function(){return"("+Math.round(this.x*100)/100+","+Math.round(this.y*100)/100+")"}}}(OpenSeadragon),function(_r){_r.TileSource=function(Ar,Rr,Pr,Dr,Mr,Fr){var zr=this,jr=arguments,Gr,Nr;if(_r.isPlainObject(Ar)?Gr=Ar:Gr={width:jr[0],height:jr[1],tileSize:jr[2],tileOverlap:jr[3],minLevel:jr[4],maxLevel:jr[5]},_r.EventSource.call(this),_r.extend(!0,this,Gr),!this.success){for(Nr=0;Nr<arguments.length;Nr++)if(_r.isFunction(arguments[Nr])){this.success=arguments[Nr];break}}this.success&&this.addHandler("ready",function(Lr){zr.success(Lr)}),_r.type(arguments[0])=="string"&&(this.url=arguments[0]),this.url?(this.aspectRatio=1,this.dimensions=new _r.Point(10,10),this._tileWidth=0,this._tileHeight=0,this.tileOverlap=0,this.minLevel=0,this.maxLevel=0,this.ready=!1,this.getImageInfo(this.url)):(this.ready=!0,this.aspectRatio=Gr.width&&Gr.height?Gr.width/Gr.height:1,this.dimensions=new _r.Point(Gr.width,Gr.height),this.tileSize?(this._tileWidth=this._tileHeight=this.tileSize,delete this.tileSize):(this.tileWidth?(this._tileWidth=this.tileWidth,delete this.tileWidth):this._tileWidth=0,this.tileHeight?(this._tileHeight=this.tileHeight,delete this.tileHeight):this._tileHeight=0),this.tileOverlap=Gr.tileOverlap?Gr.tileOverlap:0,this.minLevel=Gr.minLevel?Gr.minLevel:0,this.maxLevel=Gr.maxLevel!==void 0&&Gr.maxLevel!==null?Gr.maxLevel:Gr.width&&Gr.height?Math.ceil(Math.log(Math.max(Gr.width,Gr.height))/Math.log(2)):0,this.success&&_r.isFunction(this.success)&&this.success(this))},_r.TileSource.prototype={getTileSize:function(Ar){return _r.console.error("[TileSource.getTileSize] is deprecated. Use TileSource.getTileWidth() and TileSource.getTileHeight() instead"),this._tileWidth},getTileWidth:function(Ar){return this._tileWidth?this._tileWidth:this.getTileSize(Ar)},getTileHeight:function(Ar){return this._tileHeight?this._tileHeight:this.getTileSize(Ar)},getLevelScale:function(Ar){var Rr={},Pr;for(Pr=0;Pr<=this.maxLevel;Pr++)Rr[Pr]=1/Math.pow(2,this.maxLevel-Pr);return this.getLevelScale=function(Dr){return Rr[Dr]},this.getLevelScale(Ar)},getNumTiles:function(Ar){var Rr=this.getLevelScale(Ar),Pr=Math.ceil(Rr*this.dimensions.x/this.getTileWidth(Ar)),Dr=Math.ceil(Rr*this.dimensions.y/this.getTileHeight(Ar));return new _r.Point(Pr,Dr)},getPixelRatio:function(Ar){var Rr=this.dimensions.times(this.getLevelScale(Ar)),Pr=1/Rr.x,Dr=1/Rr.y;return new _r.Point(Pr,Dr)},getClosestLevel:function(){var Ar,Rr;for(Ar=this.minLevel+1;Ar<=this.maxLevel&&(Rr=this.getNumTiles(Ar),!(Rr.x>1||Rr.y>1));Ar++);return Ar-1},getTileAtPoint:function(Ar,Rr){var Pr=Rr.x>=0&&Rr.x<=1&&Rr.y>=0&&Rr.y<=1/this.aspectRatio;_r.console.assert(Pr,"[TileSource.getTileAtPoint] must be called with a valid point.");var Dr=this.dimensions.x*this.getLevelScale(Ar),Mr=Rr.x*Dr,Fr=Rr.y*Dr,zr=Math.floor(Mr/this.getTileWidth(Ar)),jr=Math.floor(Fr/this.getTileHeight(Ar));Rr.x>=1&&(zr=this.getNumTiles(Ar).x-1);var Gr=1e-15;return Rr.y>=1/this.aspectRatio-Gr&&(jr=this.getNumTiles(Ar).y-1),new _r.Point(zr,jr)},getTileBounds:function(Ar,Rr,Pr,Dr){var Mr=this.dimensions.times(this.getLevelScale(Ar)),Fr=this.getTileWidth(Ar),zr=this.getTileHeight(Ar),jr=Rr===0?0:Fr*Rr-this.tileOverlap,Gr=Pr===0?0:zr*Pr-this.tileOverlap,Nr=Fr+(Rr===0?1:2)*this.tileOverlap,Lr=zr+(Pr===0?1:2)*this.tileOverlap,Ur=1/Mr.x;return Nr=Math.min(Nr,Mr.x-jr),Lr=Math.min(Lr,Mr.y-Gr),Dr?new _r.Rect(0,0,Nr,Lr):new _r.Rect(jr*Ur,Gr*Ur,Nr*Ur,Lr*Ur)},getImageInfo:function(Ar){var Rr=this,Pr,Dr,Mr,Fr,zr,jr,Gr;Ar&&(zr=Ar.split("/"),jr=zr[zr.length-1],Gr=jr.lastIndexOf("."),Gr>-1&&(zr[zr.length-1]=jr.slice(0,Gr))),Dr=function(Nr){typeof Nr=="string"&&(Nr=_r.parseXml(Nr));var Lr=_r.TileSource.determineType(Rr,Nr,Ar);if(!Lr){Rr.raiseEvent("open-failed",{message:"Unable to load TileSource",source:Ar});return}Fr=Lr.prototype.configure.apply(Rr,[Nr,Ar]),Fr.ajaxWithCredentials===void 0&&(Fr.ajaxWithCredentials=Rr.ajaxWithCredentials),Mr=new Lr(Fr),Rr.ready=!0,Rr.raiseEvent("ready",{tileSource:Mr})},Ar.match(/\.js$/)?(Pr=Ar.split("/").pop().replace(".js",""),_r.jsonp({url:Ar,async:!1,callbackName:Pr,callback:Dr})):_r.makeAjaxRequest({url:Ar,withCredentials:this.ajaxWithCredentials,headers:this.ajaxHeaders,success:function(Nr){var Lr=Tr(Nr);Dr(Lr)},error:function(Nr,Lr){var Ur;try{Ur="HTTP "+Nr.status+" attempting to load TileSource"}catch{var Vr;typeof Lr>"u"||!Lr.toString?Vr="Unknown error":Vr=Lr.toString(),Ur=Vr+" attempting to load TileSource"}Rr.raiseEvent("open-failed",{message:Ur,source:Ar})}})},supports:function(Ar,Rr){return!1},configure:function(Ar,Rr){throw new Error("Method not implemented.")},getTileUrl:function(Ar,Rr,Pr){throw new Error("Method not implemented.")},getTileAjaxHeaders:function(Ar,Rr,Pr){return{}},tileExists:function(Ar,Rr,Pr){var Dr=this.getNumTiles(Ar);return Ar>=this.minLevel&&Ar<=this.maxLevel&&Rr>=0&&Pr>=0&&Rr<Dr.x&&Pr<Dr.y}},_r.extend(!0,_r.TileSource.prototype,_r.EventSource.prototype);function Tr(Ar){var Rr=Ar.responseText,Pr=Ar.status,Dr,Mr;if(Ar){if(Ar.status!==200&&Ar.status!==0)throw Pr=Ar.status,Dr=Pr==404?"Not Found":Ar.statusText,new Error(_r.getString("Errors.Status",Pr,Dr))}else throw new Error(_r.getString("Errors.Security"));if(Rr.match(/\s*<.*/))try{Mr=Ar.responseXML&&Ar.responseXML.documentElement?Ar.responseXML:_r.parseXml(Rr)}catch{Mr=Ar.responseText}else if(Rr.match(/\s*[\{\[].*/))try{Mr=_r.parseJSON(Rr)}catch{Mr=Rr}else Mr=Rr;return Mr}_r.TileSource.determineType=function(Ar,Rr,Pr){var Dr;for(Dr in OpenSeadragon)if(Dr.match(/.+TileSource$/)&&_r.isFunction(OpenSeadragon[Dr])&&_r.isFunction(OpenSeadragon[Dr].prototype.supports)&&OpenSeadragon[Dr].prototype.supports.call(Ar,Rr,Pr))return OpenSeadragon[Dr];_r.console.error("No TileSource was able to open %s %s",Pr,Rr)}}(OpenSeadragon),function(_r){_r.DziTileSource=function(Rr,Pr,Dr,Mr,Fr,zr,jr,Gr,Nr){var Lr,Ur,Vr,Wr;if(_r.isPlainObject(Rr)?Wr=Rr:Wr={width:arguments[0],height:arguments[1],tileSize:arguments[2],tileOverlap:arguments[3],tilesUrl:arguments[4],fileFormat:arguments[5],displayRects:arguments[6],minLevel:arguments[7],maxLevel:arguments[8]},this._levelRects={},this.tilesUrl=Wr.tilesUrl,this.fileFormat=Wr.fileFormat,this.displayRects=Wr.displayRects,this.displayRects)for(Lr=this.displayRects.length-1;Lr>=0;Lr--)for(Ur=this.displayRects[Lr],Vr=Ur.minLevel;Vr<=Ur.maxLevel;Vr++)this._levelRects[Vr]||(this._levelRects[Vr]=[]),this._levelRects[Vr].push(Ur);_r.TileSource.apply(this,[Wr])},_r.extend(_r.DziTileSource.prototype,_r.TileSource.prototype,{supports:function(Rr,Pr){var Dr;return Rr.Image?Dr=Rr.Image.xmlns:Rr.documentElement&&(Rr.documentElement.localName=="Image"||Rr.documentElement.tagName=="Image")&&(Dr=Rr.documentElement.namespaceURI),Dr=(Dr||"").toLowerCase(),Dr.indexOf("schemas.microsoft.com/deepzoom/2008")!==-1||Dr.indexOf("schemas.microsoft.com/deepzoom/2009")!==-1},configure:function(Rr,Pr){var Dr;return _r.isPlainObject(Rr)?Dr=Ar(this,Rr):Dr=Tr(this,Rr),Pr&&!Dr.tilesUrl&&(Dr.tilesUrl=Pr.replace(/([^\/]+?)(\.(dzi|xml|js)?(\?[^\/]*)?)?\/?$/,"$1_files/"),Pr.search(/\.(dzi|xml|js)\?/)!=-1?Dr.queryParams=Pr.match(/\?.*/):Dr.queryParams=""),Dr},getTileUrl:function(Rr,Pr,Dr){return[this.tilesUrl,Rr,"/",Pr,"_",Dr,".",this.fileFormat,this.queryParams].join("")},tileExists:function(Rr,Pr,Dr){var Mr=this._levelRects[Rr],Fr,zr,jr,Gr,Nr,Lr,Ur;if(this.minLevel&&Rr<this.minLevel||this.maxLevel&&Rr>this.maxLevel)return!1;if(!Mr||!Mr.length)return!0;for(Ur=Mr.length-1;Ur>=0;Ur--)if(Fr=Mr[Ur],!(Rr<Fr.minLevel||Rr>Fr.maxLevel)&&(zr=this.getLevelScale(Rr),jr=Fr.x*zr,Gr=Fr.y*zr,Nr=jr+Fr.width*zr,Lr=Gr+Fr.height*zr,jr=Math.floor(jr/this._tileWidth),Gr=Math.floor(Gr/this._tileWidth),Nr=Math.ceil(Nr/this._tileWidth),Lr=Math.ceil(Lr/this._tileWidth),jr<=Pr&&Pr<Nr&&Gr<=Dr&&Dr<Lr))return!0;return!1}});function Tr(Rr,Pr){if(!Pr||!Pr.documentElement)throw new Error(_r.getString("Errors.Xml"));var Dr=Pr.documentElement,Mr=Dr.localName||Dr.tagName,Fr=Pr.documentElement.namespaceURI,zr=null,jr=[],Gr,Nr,Lr,Ur,Vr;if(Mr=="Image")try{if(Ur=Dr.getElementsByTagName("Size")[0],Ur===void 0&&(Ur=Dr.getElementsByTagNameNS(Fr,"Size")[0]),zr={Image:{xmlns:"http://schemas.microsoft.com/deepzoom/2008",Url:Dr.getAttribute("Url"),Format:Dr.getAttribute("Format"),DisplayRect:null,Overlap:parseInt(Dr.getAttribute("Overlap"),10),TileSize:parseInt(Dr.getAttribute("TileSize"),10),Size:{Height:parseInt(Ur.getAttribute("Height"),10),Width:parseInt(Ur.getAttribute("Width"),10)}}},!_r.imageFormatSupported(zr.Image.Format))throw new Error(_r.getString("Errors.ImageFormat",zr.Image.Format.toUpperCase()));for(Gr=Dr.getElementsByTagName("DisplayRect"),Gr===void 0&&(Gr=Dr.getElementsByTagNameNS(Fr,"DisplayRect")[0]),Vr=0;Vr<Gr.length;Vr++)Nr=Gr[Vr],Lr=Nr.getElementsByTagName("Rect")[0],Lr===void 0&&(Lr=Nr.getElementsByTagNameNS(Fr,"Rect")[0]),jr.push({Rect:{X:parseInt(Lr.getAttribute("X"),10),Y:parseInt(Lr.getAttribute("Y"),10),Width:parseInt(Lr.getAttribute("Width"),10),Height:parseInt(Lr.getAttribute("Height"),10),MinLevel:parseInt(Nr.getAttribute("MinLevel"),10),MaxLevel:parseInt(Nr.getAttribute("MaxLevel"),10)}});return jr.length&&(zr.Image.DisplayRect=jr),Ar(Rr,zr)}catch(Kr){throw Kr instanceof Error?Kr:new Error(_r.getString("Errors.Dzi"))}else{if(Mr=="Collection")throw new Error(_r.getString("Errors.Dzc"));if(Mr=="Error"){var Wr=Dr.getElementsByTagName("Message")[0],qr=Wr.firstChild.nodeValue;throw new Error(qr)}}throw new Error(_r.getString("Errors.Dzi"))}function Ar(Rr,Pr){var Dr=Pr.Image,Mr=Dr.Url,Fr=Dr.Format,zr=Dr.Size,jr=Dr.DisplayRect||[],Gr=parseInt(zr.Width,10),Nr=parseInt(zr.Height,10),Lr=parseInt(Dr.TileSize,10),Ur=parseInt(Dr.Overlap,10),Vr=[],Wr,qr;for(qr=0;qr<jr.length;qr++)Wr=jr[qr].Rect,Vr.push(new _r.DisplayRect(parseInt(Wr.X,10),parseInt(Wr.Y,10),parseInt(Wr.Width,10),parseInt(Wr.Height,10),parseInt(Wr.MinLevel,10),parseInt(Wr.MaxLevel,10)));return _r.extend(!0,{width:Gr,height:Nr,tileSize:Lr,tileOverlap:Ur,minLevel:null,maxLevel:null,tilesUrl:Mr,fileFormat:Fr,displayRects:Vr},Pr)}}(OpenSeadragon),function(_r){_r.IIIFTileSource=function(Dr){if(_r.extend(!0,this,Dr),!(this.height&&this.width&&this["@id"]))throw new Error("IIIF required parameters not provided.");if(Dr.tileSizePerScaleFactor={},this.tileFormat=this.tileFormat||"jpg",this.version=Dr.version,this.tile_width&&this.tile_height)Dr.tileWidth=this.tile_width,Dr.tileHeight=this.tile_height;else if(this.tile_width)Dr.tileSize=this.tile_width;else if(this.tile_height)Dr.tileSize=this.tile_height;else if(this.tiles)if(this.tiles.length==1)Dr.tileWidth=this.tiles[0].width,Dr.tileHeight=this.tiles[0].height||this.tiles[0].width,this.scale_factors=this.tiles[0].scaleFactors;else{this.scale_factors=[];for(var Mr=0;Mr<this.tiles.length;Mr++)for(var Fr=0;Fr<this.tiles[Mr].scaleFactors.length;Fr++){var zr=this.tiles[Mr].scaleFactors[Fr];this.scale_factors.push(zr),Dr.tileSizePerScaleFactor[zr]={width:this.tiles[Mr].width,height:this.tiles[Mr].height||this.tiles[Mr].width}}}else if(Tr(Dr)){for(var jr=Math.min(this.height,this.width),Gr=[256,512,1024],Nr=[],Lr=0;Lr<Gr.length;Lr++)Gr[Lr]<=jr&&Nr.push(Gr[Lr]);Nr.length>0?Dr.tileSize=Math.max.apply(null,Nr):Dr.tileSize=jr}else this.sizes&&this.sizes.length>0?(this.emulateLegacyImagePyramid=!0,Dr.levels=Ar(this),_r.extend(!0,Dr,{width:Dr.levels[Dr.levels.length-1].width,height:Dr.levels[Dr.levels.length-1].height,tileSize:Math.max(Dr.height,Dr.width),tileOverlap:0,minLevel:0,maxLevel:Dr.levels.length-1}),this.levels=Dr.levels):_r.console.error("Nothing in the info.json to construct image pyramids from");if(!Dr.maxLevel&&!this.emulateLegacyImagePyramid)if(!this.scale_factors)Dr.maxLevel=Number(Math.ceil(Math.log(Math.max(this.width,this.height),2)));else{var Ur=Math.max.apply(null,this.scale_factors);Dr.maxLevel=Math.round(Math.log(Ur)*Math.LOG2E)}_r.TileSource.apply(this,[Dr])},_r.extend(_r.IIIFTileSource.prototype,_r.TileSource.prototype,{supports:function(Dr,Mr){return Dr.protocol&&Dr.protocol=="http://iiif.io/api/image"||Dr["@context"]&&(Dr["@context"]=="http://library.stanford.edu/iiif/image-api/1.1/context.json"||Dr["@context"]=="http://iiif.io/api/image/1/context.json")||Dr.profile&&Dr.profile.indexOf("http://library.stanford.edu/iiif/image-api/compliance.html")===0||Dr.identifier&&Dr.width&&Dr.height?!0:!!(Dr.documentElement&&Dr.documentElement.tagName=="info"&&Dr.documentElement.namespaceURI=="http://library.stanford.edu/iiif/image-api/ns/")},configure:function(Dr,Mr){if(_r.isPlainObject(Dr)){if(!Dr["@context"])Dr["@context"]="http://iiif.io/api/image/1.0/context.json",Dr["@id"]=Mr.replace("/info.json",""),Dr.version=1;else{var zr=Dr["@context"];if(Array.isArray(zr)){for(var jr=0;jr<zr.length;jr++)if(typeof zr[jr]=="string"&&(/^http:\/\/iiif\.io\/api\/image\/[1-3]\/context\.json$/.test(zr[jr])||zr[jr]==="http://library.stanford.edu/iiif/image-api/1.1/context.json")){zr=zr[jr];break}}switch(zr){case"http://iiif.io/api/image/1/context.json":case"http://library.stanford.edu/iiif/image-api/1.1/context.json":Dr.version=1;break;case"http://iiif.io/api/image/2/context.json":Dr.version=2;break;case"http://iiif.io/api/image/3/context.json":Dr.version=3;break;default:_r.console.error("Data has a @context property which contains no known IIIF context URI.")}}if(!Dr["@id"]&&Dr.id&&(Dr["@id"]=Dr.id),Dr.preferredFormats){for(var Gr=0;Gr<Dr.preferredFormats.length;Gr++)if(OpenSeadragon.imageFormatSupported(Dr.preferredFormats[Gr])){Dr.tileFormat=Dr.preferredFormats[Gr];break}}return Dr}else{var Fr=Rr(Dr);return Fr["@context"]="http://iiif.io/api/image/1.0/context.json",Fr["@id"]=Mr.replace("/info.xml",""),Fr.version=1,Fr}},getTileWidth:function(Dr){if(this.emulateLegacyImagePyramid)return _r.TileSource.prototype.getTileWidth.call(this,Dr);var Mr=Math.pow(2,this.maxLevel-Dr);return this.tileSizePerScaleFactor&&this.tileSizePerScaleFactor[Mr]?this.tileSizePerScaleFactor[Mr].width:this._tileWidth},getTileHeight:function(Dr){if(this.emulateLegacyImagePyramid)return _r.TileSource.prototype.getTileHeight.call(this,Dr);var Mr=Math.pow(2,this.maxLevel-Dr);return this.tileSizePerScaleFactor&&this.tileSizePerScaleFactor[Mr]?this.tileSizePerScaleFactor[Mr].height:this._tileHeight},getLevelScale:function(Dr){if(this.emulateLegacyImagePyramid){var Mr=NaN;return this.levels.length>0&&Dr>=this.minLevel&&Dr<=this.maxLevel&&(Mr=this.levels[Dr].width/this.levels[this.maxLevel].width),Mr}return _r.TileSource.prototype.getLevelScale.call(this,Dr)},getNumTiles:function(Dr){if(this.emulateLegacyImagePyramid){var Mr=this.getLevelScale(Dr);return Mr?new _r.Point(1,1):new _r.Point(0,0)}return _r.TileSource.prototype.getNumTiles.call(this,Dr)},getTileAtPoint:function(Dr,Mr){return this.emulateLegacyImagePyramid?new _r.Point(0,0):_r.TileSource.prototype.getTileAtPoint.call(this,Dr,Mr)},getTileUrl:function(Dr,Mr,Fr){if(this.emulateLegacyImagePyramid){var zr=null;return this.levels.length>0&&Dr>=this.minLevel&&Dr<=this.maxLevel&&(zr=this.levels[Dr].url),zr}var jr="0",Gr=Math.pow(.5,this.maxLevel-Dr),Nr=Math.ceil(this.width*Gr),Lr=Math.ceil(this.height*Gr),Ur,Vr,Wr,qr,Kr,Xr,Zr,_i,Jr,es,ts,is,rs,as;return Ur=this.getTileWidth(Dr),Vr=this.getTileHeight(Dr),Wr=Math.ceil(Ur/Gr),qr=Math.ceil(Vr/Gr),this.version===1?rs="native."+this.tileFormat:rs="default."+this.tileFormat,Nr<Ur&&Lr<Vr?(this.version===2&&Nr===this.width||this.version===3&&Nr===this.width&&Lr===this.height?es="max":this.version===3?es=Nr+","+Lr:es=Nr+",",Kr="full"):(Xr=Mr*Wr,Zr=Fr*qr,_i=Math.min(Wr,this.width-Xr),Jr=Math.min(qr,this.height-Zr),Mr===0&&Fr===0&&_i===this.width&&Jr===this.height?Kr="full":Kr=[Xr,Zr,_i,Jr].join(","),ts=Math.ceil(_i*Gr),is=Math.ceil(Jr*Gr),this.version===2&&ts===this.width||this.version===3&&ts===this.width&&is===this.height?es="max":this.version===3?es=ts+","+is:es=ts+","),as=[this["@id"],Kr,es,jr,rs].join("/"),as},__testonly__:{canBeTiled:Tr,constructLevels:Ar}});function Tr(Dr){var Mr=["http://library.stanford.edu/iiif/image-api/compliance.html#level0","http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level0","http://iiif.io/api/image/2/level0.json","level0","https://iiif.io/api/image/3/level0.json"],Fr=Array.isArray(Dr.profile)?Dr.profile[0]:Dr.profile,zr=Mr.indexOf(Fr)!==-1,jr=!1;return Dr.version===2&&Dr.profile.length>1&&Dr.profile[1].supports&&(jr=Dr.profile[1].supports.indexOf("sizeByW")!==-1),Dr.version===3&&Dr.extraFeatures&&(jr=Dr.extraFeatures.indexOf("sizeByWh")!==-1),!zr||jr}function Ar(Dr){for(var Mr=[],Fr=0;Fr<Dr.sizes.length;Fr++)Mr.push({url:Dr["@id"]+"/full/"+Dr.sizes[Fr].width+","+(Dr.version===3?Dr.sizes[Fr].height:"")+"/0/default."+Dr.tileFormat,width:Dr.sizes[Fr].width,height:Dr.sizes[Fr].height});return Mr.sort(function(zr,jr){return zr.width-jr.width})}function Rr(Dr){if(!Dr||!Dr.documentElement)throw new Error(_r.getString("Errors.Xml"));var Mr=Dr.documentElement,Fr=Mr.tagName,zr=null;if(Fr=="info")try{return zr={},Pr(Mr,zr),zr}catch(jr){throw jr instanceof Error?jr:new Error(_r.getString("Errors.IIIF"))}throw new Error(_r.getString("Errors.IIIF"))}function Pr(Dr,Mr,Fr){var zr,jr;if(Dr.nodeType==3&&Fr)jr=Dr.nodeValue.trim(),jr.match(/^\d*$/)&&(jr=Number(jr)),Mr[Fr]?(_r.isArray(Mr[Fr])||(Mr[Fr]=[Mr[Fr]]),Mr[Fr].push(jr)):Mr[Fr]=jr;else if(Dr.nodeType==1)for(zr=0;zr<Dr.childNodes.length;zr++)Pr(Dr.childNodes[zr],Mr,Dr.nodeName)}}(OpenSeadragon),function(_r){_r.OsmTileSource=function(Tr,Ar,Rr,Pr,Dr){var Mr;_r.isPlainObject(Tr)?Mr=Tr:Mr={width:arguments[0],height:arguments[1],tileSize:arguments[2],tileOverlap:arguments[3],tilesUrl:arguments[4]},(!Mr.width||!Mr.height)&&(Mr.width=65572864,Mr.height=65572864),Mr.tileSize||(Mr.tileSize=256,Mr.tileOverlap=0),Mr.tilesUrl||(Mr.tilesUrl="http://tile.openstreetmap.org/"),Mr.minLevel=8,_r.TileSource.apply(this,[Mr])},_r.extend(_r.OsmTileSource.prototype,_r.TileSource.prototype,{supports:function(Tr,Ar){return Tr.type&&Tr.type=="openstreetmaps"},configure:function(Tr,Ar){return Tr},getTileUrl:function(Tr,Ar,Rr){return this.tilesUrl+(Tr-8)+"/"+Ar+"/"+Rr+".png"}})}(OpenSeadragon),function(_r){_r.TmsTileSource=function(Tr,Ar,Rr,Pr,Dr){var Mr;_r.isPlainObject(Tr)?Mr=Tr:Mr={width:arguments[0],height:arguments[1],tileSize:arguments[2],tileOverlap:arguments[3],tilesUrl:arguments[4]};var Fr=Math.ceil(Mr.width/256)*256,zr=Math.ceil(Mr.height/256)*256,jr;Fr>zr?jr=Fr/256:jr=zr/256,Mr.maxLevel=Math.ceil(Math.log(jr)/Math.log(2))-1,Mr.tileSize=256,Mr.width=Fr,Mr.height=zr,_r.TileSource.apply(this,[Mr])},_r.extend(_r.TmsTileSource.prototype,_r.TileSource.prototype,{supports:function(Tr,Ar){return Tr.type&&Tr.type=="tiledmapservice"},configure:function(Tr,Ar){return Tr},getTileUrl:function(Tr,Ar,Rr){var Pr=this.getNumTiles(Tr).y-1;return this.tilesUrl+Tr+"/"+Ar+"/"+(Pr-Rr)+".png"}})}(OpenSeadragon),function(_r){_r.ZoomifyTileSource=function(Tr){Tr.tileSize=256;var Ar={x:Tr.width,y:Tr.height};for(Tr.imageSizes=[{x:Tr.width,y:Tr.height}],Tr.gridSize=[this._getGridSize(Tr.width,Tr.height,Tr.tileSize)];parseInt(Ar.x,10)>Tr.tileSize||parseInt(Ar.y,10)>Tr.tileSize;)Ar.x=Math.floor(Ar.x/2),Ar.y=Math.floor(Ar.y/2),Tr.imageSizes.push({x:Ar.x,y:Ar.y}),Tr.gridSize.push(this._getGridSize(Ar.x,Ar.y,Tr.tileSize));Tr.imageSizes.reverse(),Tr.gridSize.reverse(),Tr.minLevel=0,Tr.maxLevel=Tr.gridSize.length-1,OpenSeadragon.TileSource.apply(this,[Tr])},_r.extend(_r.ZoomifyTileSource.prototype,_r.TileSource.prototype,{_getGridSize:function(Tr,Ar,Rr){return{x:Math.ceil(Tr/Rr),y:Math.ceil(Ar/Rr)}},_calculateAbsoluteTileNumber:function(Tr,Ar,Rr){for(var Pr=0,Dr={},Mr=0;Mr<Tr;Mr++)Dr=this.gridSize[Mr],Pr+=Dr.x*Dr.y;return Dr=this.gridSize[Tr],Pr+=Dr.x*Rr+Ar,Pr},supports:function(Tr,Ar){return Tr.type&&Tr.type=="zoomifytileservice"},configure:function(Tr,Ar){return Tr},getTileUrl:function(Tr,Ar,Rr){var Pr=0,Dr=this._calculateAbsoluteTileNumber(Tr,Ar,Rr);return Pr=Math.floor(Dr/256),this.tilesUrl+"TileGroup"+Pr+"/"+Tr+"-"+Ar+"-"+Rr+".jpg"}})}(OpenSeadragon),function(_r){_r.LegacyTileSource=function(Pr){var Dr,Mr,Fr;_r.isArray(Pr)&&(Dr={type:"legacy-image-pyramid",levels:Pr}),Dr.levels=Tr(Dr.levels),Dr.levels.length>0?(Mr=Dr.levels[Dr.levels.length-1].width,Fr=Dr.levels[Dr.levels.length-1].height):(Mr=0,Fr=0,_r.console.error("No supported image formats found")),_r.extend(!0,Dr,{width:Mr,height:Fr,tileSize:Math.max(Fr,Mr),tileOverlap:0,minLevel:0,maxLevel:Dr.levels.length>0?Dr.levels.length-1:0}),_r.TileSource.apply(this,[Dr]),this.levels=Dr.levels},_r.extend(_r.LegacyTileSource.prototype,_r.TileSource.prototype,{supports:function(Pr,Dr){return Pr.type&&Pr.type=="legacy-image-pyramid"||Pr.documentElement&&Pr.documentElement.getAttribute("type")=="legacy-image-pyramid"},configure:function(Pr,Dr){var Mr;return _r.isPlainObject(Pr)?Mr=Rr(this,Pr):Mr=Ar(this,Pr),Mr},getLevelScale:function(Pr){var Dr=NaN;return this.levels.length>0&&Pr>=this.minLevel&&Pr<=this.maxLevel&&(Dr=this.levels[Pr].width/this.levels[this.maxLevel].width),Dr},getNumTiles:function(Pr){var Dr=this.getLevelScale(Pr);return Dr?new _r.Point(1,1):new _r.Point(0,0)},getTileUrl:function(Pr,Dr,Mr){var Fr=null;return this.levels.length>0&&Pr>=this.minLevel&&Pr<=this.maxLevel&&(Fr=this.levels[Pr].url),Fr}});function Tr(Pr){var Dr=[],Mr,Fr;for(Fr=0;Fr<Pr.length;Fr++)Mr=Pr[Fr],Mr.height&&Mr.width&&Mr.url?Dr.push({url:Mr.url,width:Number(Mr.width),height:Number(Mr.height)}):_r.console.error("Unsupported image format: %s",Mr.url?Mr.url:"<no URL>");return Dr.sort(function(zr,jr){return zr.height-jr.height})}function Ar(Pr,Dr){if(!Dr||!Dr.documentElement)throw new Error(_r.getString("Errors.Xml"));var Mr=Dr.documentElement,Fr=Mr.tagName,zr=null,jr=[],Gr,Nr;if(Fr=="image")try{for(zr={type:Mr.getAttribute("type"),levels:[]},jr=Mr.getElementsByTagName("level"),Nr=0;Nr<jr.length;Nr++)Gr=jr[Nr],zr.levels.push({url:Gr.getAttribute("url"),width:parseInt(Gr.getAttribute("width"),10),height:parseInt(Gr.getAttribute("height"),10)});return Rr(Pr,zr)}catch(Lr){throw Lr instanceof Error?Lr:new Error("Unknown error parsing Legacy Image Pyramid XML.")}else{if(Fr=="collection")throw new Error("Legacy Image Pyramid Collections not yet supported.");if(Fr=="error")throw new Error("Error: "+Dr)}throw new Error("Unknown element "+Fr)}function Rr(Pr,Dr){return Dr.levels}}(OpenSeadragon),function(_r){_r.ImageTileSource=function(Tr){Tr=_r.extend({buildPyramid:!0,crossOriginPolicy:!1,ajaxWithCredentials:!1,useCanvas:!0},Tr),_r.TileSource.apply(this,[Tr])},_r.extend(_r.ImageTileSource.prototype,_r.TileSource.prototype,{supports:function(Tr,Ar){return Tr.type&&Tr.type==="image"},configure:function(Tr,Ar){return Tr},getImageInfo:function(Tr){var Ar=this._image=new Image,Rr=this;this.crossOriginPolicy&&(Ar.crossOrigin=this.crossOriginPolicy),this.ajaxWithCredentials&&(Ar.useCredentials=this.ajaxWithCredentials),_r.addEvent(Ar,"load",function(){Rr.width=Object.prototype.hasOwnProperty.call(Ar,"naturalWidth")?Ar.naturalWidth:Ar.width,Rr.height=Object.prototype.hasOwnProperty.call(Ar,"naturalHeight")?Ar.naturalHeight:Ar.height,Rr.aspectRatio=Rr.width/Rr.height,Rr.dimensions=new _r.Point(Rr.width,Rr.height),Rr._tileWidth=Rr.width,Rr._tileHeight=Rr.height,Rr.tileOverlap=0,Rr.minLevel=0,Rr.levels=Rr._buildLevels(),Rr.maxLevel=Rr.levels.length-1,Rr.ready=!0,Rr.raiseEvent("ready",{tileSource:Rr})}),_r.addEvent(Ar,"error",function(){Rr.raiseEvent("open-failed",{message:"Error loading image at "+Tr,source:Tr})}),Ar.src=Tr},getLevelScale:function(Tr){var Ar=NaN;return Tr>=this.minLevel&&Tr<=this.maxLevel&&(Ar=this.levels[Tr].width/this.levels[this.maxLevel].width),Ar},getNumTiles:function(Tr){var Ar=this.getLevelScale(Tr);return Ar?new _r.Point(1,1):new _r.Point(0,0)},getTileUrl:function(Tr,Ar,Rr){var Pr=null;return Tr>=this.minLevel&&Tr<=this.maxLevel&&(Pr=this.levels[Tr].url),Pr},getContext2D:function(Tr,Ar,Rr){var Pr=null;return Tr>=this.minLevel&&Tr<=this.maxLevel&&(Pr=this.levels[Tr].context2D),Pr},_buildLevels:function(){var Tr=[{url:this._image.src,width:Object.prototype.hasOwnProperty.call(this._image,"naturalWidth")?this._image.naturalWidth:this._image.width,height:Object.prototype.hasOwnProperty.call(this._image,"naturalHeight")?this._image.naturalHeight:this._image.height}];if(!this.buildPyramid||!_r.supportsCanvas||!this.useCanvas)return delete this._image,Tr;var Ar=Object.prototype.hasOwnProperty.call(this._image,"naturalWidth")?this._image.naturalWidth:this._image.width,Rr=Object.prototype.hasOwnProperty.call(this._image,"naturalHeight")?this._image.naturalHeight:this._image.height,Pr=document.createElement("canvas"),Dr=Pr.getContext("2d");if(Pr.width=Ar,Pr.height=Rr,Dr.drawImage(this._image,0,0,Ar,Rr),Tr[0].context2D=Dr,delete this._image,_r.isCanvasTainted(Pr))return Tr;for(;Ar>=2&&Rr>=2;){Ar=Math.floor(Ar/2),Rr=Math.floor(Rr/2);var Mr=document.createElement("canvas"),Fr=Mr.getContext("2d");Mr.width=Ar,Mr.height=Rr,Fr.drawImage(Pr,0,0,Ar,Rr),Tr.splice(0,0,{context2D:Fr,width:Ar,height:Rr}),Pr=Mr,Dr=Fr}return Tr}})}(OpenSeadragon),function(_r){_r.TileSourceCollection=function(Tr,Ar,Rr,Pr){_r.console.error("TileSourceCollection is deprecated; use World instead")}}(OpenSeadragon),function(_r){_r.ButtonState={REST:0,GROUP:1,HOVER:2,DOWN:3},_r.Button=function(Fr){var zr=this;_r.EventSource.call(this),_r.extend(!0,this,{tooltip:null,srcRest:null,srcGroup:null,srcHover:null,srcDown:null,clickTimeThreshold:_r.DEFAULT_SETTINGS.clickTimeThreshold,clickDistThreshold:_r.DEFAULT_SETTINGS.clickDistThreshold,fadeDelay:0,fadeLength:2e3,onPress:null,onRelease:null,onClick:null,onEnter:null,onExit:null,onFocus:null,onBlur:null},Fr),this.element=Fr.element||_r.makeNeutralElement("div"),Fr.element||(this.imgRest=_r.makeTransparentImage(this.srcRest),this.imgGroup=_r.makeTransparentImage(this.srcGroup),this.imgHover=_r.makeTransparentImage(this.srcHover),this.imgDown=_r.makeTransparentImage(this.srcDown),this.imgRest.alt=this.imgGroup.alt=this.imgHover.alt=this.imgDown.alt=this.tooltip,this.element.style.position="relative",_r.setElementTouchActionNone(this.element),this.imgGroup.style.position=this.imgHover.style.position=this.imgDown.style.position="absolute",this.imgGroup.style.top=this.imgHover.style.top=this.imgDown.style.top="0px",this.imgGroup.style.left=this.imgHover.style.left=this.imgDown.style.left="0px",this.imgHover.style.visibility=this.imgDown.style.visibility="hidden",_r.Browser.vendor==_r.BROWSERS.FIREFOX&&_r.Browser.version<3&&(this.imgGroup.style.top=this.imgHover.style.top=this.imgDown.style.top=""),this.element.appendChild(this.imgRest),this.element.appendChild(this.imgGroup),this.element.appendChild(this.imgHover),this.element.appendChild(this.imgDown)),this.addHandler("press",this.onPress),this.addHandler("release",this.onRelease),this.addHandler("click",this.onClick),this.addHandler("enter",this.onEnter),this.addHandler("exit",this.onExit),this.addHandler("focus",this.onFocus),this.addHandler("blur",this.onBlur),this.currentState=_r.ButtonState.GROUP,this.fadeBeginTime=null,this.shouldFade=!1,this.element.style.display="inline-block",this.element.style.position="relative",this.element.title=this.tooltip,this.tracker=new _r.MouseTracker({element:this.element,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,enterHandler:function(jr){jr.insideElementPressed?(Dr(zr,_r.ButtonState.DOWN),zr.raiseEvent("enter",{originalEvent:jr.originalEvent})):jr.buttonDownAny||Dr(zr,_r.ButtonState.HOVER)},focusHandler:function(jr){this.enterHandler(jr),zr.raiseEvent("focus",{originalEvent:jr.originalEvent})},exitHandler:function(jr){Mr(zr,_r.ButtonState.GROUP),jr.insideElementPressed&&zr.raiseEvent("exit",{originalEvent:jr.originalEvent})},blurHandler:function(jr){this.exitHandler(jr),zr.raiseEvent("blur",{originalEvent:jr.originalEvent})},pressHandler:function(jr){Dr(zr,_r.ButtonState.DOWN),zr.raiseEvent("press",{originalEvent:jr.originalEvent})},releaseHandler:function(jr){jr.insideElementPressed&&jr.insideElementReleased?(Mr(zr,_r.ButtonState.HOVER),zr.raiseEvent("release",{originalEvent:jr.originalEvent})):jr.insideElementPressed?Mr(zr,_r.ButtonState.GROUP):Dr(zr,_r.ButtonState.HOVER)},clickHandler:function(jr){jr.quick&&zr.raiseEvent("click",{originalEvent:jr.originalEvent})},keyHandler:function(jr){return jr.keyCode===13?(zr.raiseEvent("click",{originalEvent:jr.originalEvent}),zr.raiseEvent("release",{originalEvent:jr.originalEvent}),!1):!0}}),Mr(this,_r.ButtonState.REST)},_r.extend(_r.Button.prototype,_r.EventSource.prototype,{notifyGroupEnter:function(){Dr(this,_r.ButtonState.GROUP)},notifyGroupExit:function(){Mr(this,_r.ButtonState.REST)},disable:function(){this.notifyGroupExit(),this.element.disabled=!0,_r.setElementOpacity(this.element,.2,!0)},enable:function(){this.element.disabled=!1,_r.setElementOpacity(this.element,1,!0),this.notifyGroupEnter()}});function Tr(Fr){_r.requestAnimationFrame(function(){Ar(Fr)})}function Ar(Fr){var zr,jr,Gr;Fr.shouldFade&&(zr=_r.now(),jr=zr-Fr.fadeBeginTime,Gr=1-jr/Fr.fadeLength,Gr=Math.min(1,Gr),Gr=Math.max(0,Gr),Fr.imgGroup&&_r.setElementOpacity(Fr.imgGroup,Gr,!0),Gr>0&&Tr(Fr))}function Rr(Fr){Fr.shouldFade=!0,Fr.fadeBeginTime=_r.now()+Fr.fadeDelay,window.setTimeout(function(){Tr(Fr)},Fr.fadeDelay)}function Pr(Fr){Fr.shouldFade=!1,Fr.imgGroup&&_r.setElementOpacity(Fr.imgGroup,1,!0)}function Dr(Fr,zr){Fr.element.disabled||(zr>=_r.ButtonState.GROUP&&Fr.currentState==_r.ButtonState.REST&&(Pr(Fr),Fr.currentState=_r.ButtonState.GROUP),zr>=_r.ButtonState.HOVER&&Fr.currentState==_r.ButtonState.GROUP&&(Fr.imgHover&&(Fr.imgHover.style.visibility=""),Fr.currentState=_r.ButtonState.HOVER),zr>=_r.ButtonState.DOWN&&Fr.currentState==_r.ButtonState.HOVER&&(Fr.imgDown&&(Fr.imgDown.style.visibility=""),Fr.currentState=_r.ButtonState.DOWN))}function Mr(Fr,zr){Fr.element.disabled||(zr<=_r.ButtonState.HOVER&&Fr.currentState==_r.ButtonState.DOWN&&(Fr.imgDown&&(Fr.imgDown.style.visibility="hidden"),Fr.currentState=_r.ButtonState.HOVER),zr<=_r.ButtonState.GROUP&&Fr.currentState==_r.ButtonState.HOVER&&(Fr.imgHover&&(Fr.imgHover.style.visibility="hidden"),Fr.currentState=_r.ButtonState.GROUP),zr<=_r.ButtonState.REST&&Fr.currentState==_r.ButtonState.GROUP&&(Rr(Fr),Fr.currentState=_r.ButtonState.REST))}}(OpenSeadragon),function(_r){_r.ButtonGroup=function(Tr){_r.extend(!0,this,{buttons:[],clickTimeThreshold:_r.DEFAULT_SETTINGS.clickTimeThreshold,clickDistThreshold:_r.DEFAULT_SETTINGS.clickDistThreshold,labelText:""},Tr);var Ar=this.buttons.concat([]),Rr=this,Pr;if(this.element=Tr.element||_r.makeNeutralElement("div"),!Tr.group)for(this.element.style.display="inline-block",Pr=0;Pr<Ar.length;Pr++)this.element.appendChild(Ar[Pr].element);_r.setElementTouchActionNone(this.element),this.tracker=new _r.MouseTracker({element:this.element,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,enterHandler:function(Dr){var Mr;for(Mr=0;Mr<Rr.buttons.length;Mr++)Rr.buttons[Mr].notifyGroupEnter()},exitHandler:function(Dr){var Mr;if(!Dr.insideElementPressed)for(Mr=0;Mr<Rr.buttons.length;Mr++)Rr.buttons[Mr].notifyGroupExit()}})},_r.ButtonGroup.prototype={emulateEnter:function(){this.tracker.enterHandler({eventSource:this.tracker})},emulateExit:function(){this.tracker.exitHandler({eventSource:this.tracker})}}}(OpenSeadragon),function(_r){_r.Rect=function(Tr,Ar,Rr,Pr,Dr){this.x=typeof Tr=="number"?Tr:0,this.y=typeof Ar=="number"?Ar:0,this.width=typeof Rr=="number"?Rr:0,this.height=typeof Pr=="number"?Pr:0,this.degrees=typeof Dr=="number"?Dr:0,this.degrees=_r.positiveModulo(this.degrees,360);var Mr,Fr;this.degrees>=270?(Mr=this.getTopRight(),this.x=Mr.x,this.y=Mr.y,Fr=this.height,this.height=this.width,this.width=Fr,this.degrees-=270):this.degrees>=180?(Mr=this.getBottomRight(),this.x=Mr.x,this.y=Mr.y,this.degrees-=180):this.degrees>=90&&(Mr=this.getBottomLeft(),this.x=Mr.x,this.y=Mr.y,Fr=this.height,this.height=this.width,this.width=Fr,this.degrees-=90)},_r.Rect.fromSummits=function(Tr,Ar,Rr){var Pr=Tr.distanceTo(Ar),Dr=Tr.distanceTo(Rr),Mr=Ar.minus(Tr),Fr=Math.atan(Mr.y/Mr.x);return Mr.x<0?Fr+=Math.PI:Mr.y<0&&(Fr+=2*Math.PI),new _r.Rect(Tr.x,Tr.y,Pr,Dr,Fr/Math.PI*180)},_r.Rect.prototype={clone:function(){return new _r.Rect(this.x,this.y,this.width,this.height,this.degrees)},getAspectRatio:function(){return this.width/this.height},getTopLeft:function(){return new _r.Point(this.x,this.y)},getBottomRight:function(){return new _r.Point(this.x+this.width,this.y+this.height).rotate(this.degrees,this.getTopLeft())},getTopRight:function(){return new _r.Point(this.x+this.width,this.y).rotate(this.degrees,this.getTopLeft())},getBottomLeft:function(){return new _r.Point(this.x,this.y+this.height).rotate(this.degrees,this.getTopLeft())},getCenter:function(){return new _r.Point(this.x+this.width/2,this.y+this.height/2).rotate(this.degrees,this.getTopLeft())},getSize:function(){return new _r.Point(this.width,this.height)},equals:function(Tr){return Tr instanceof _r.Rect&&this.x===Tr.x&&this.y===Tr.y&&this.width===Tr.width&&this.height===Tr.height&&this.degrees===Tr.degrees},times:function(Tr){return new _r.Rect(this.x*Tr,this.y*Tr,this.width*Tr,this.height*Tr,this.degrees)},translate:function(Tr){return new _r.Rect(this.x+Tr.x,this.y+Tr.y,this.width,this.height,this.degrees)},union:function(Tr){var Ar=this.getBoundingBox(),Rr=Tr.getBoundingBox(),Pr=Math.min(Ar.x,Rr.x),Dr=Math.min(Ar.y,Rr.y),Mr=Math.max(Ar.x+Ar.width,Rr.x+Rr.width),Fr=Math.max(Ar.y+Ar.height,Rr.y+Rr.height);return new _r.Rect(Pr,Dr,Mr-Pr,Fr-Dr)},intersection:function(Tr){var Ar=1e-10,Rr=[],Pr=this.getTopLeft();Tr.containsPoint(Pr,Ar)&&Rr.push(Pr);var Dr=this.getTopRight();Tr.containsPoint(Dr,Ar)&&Rr.push(Dr);var Mr=this.getBottomLeft();Tr.containsPoint(Mr,Ar)&&Rr.push(Mr);var Fr=this.getBottomRight();Tr.containsPoint(Fr,Ar)&&Rr.push(Fr);var zr=Tr.getTopLeft();this.containsPoint(zr,Ar)&&Rr.push(zr);var jr=Tr.getTopRight();this.containsPoint(jr,Ar)&&Rr.push(jr);var Gr=Tr.getBottomLeft();this.containsPoint(Gr,Ar)&&Rr.push(Gr);var Nr=Tr.getBottomRight();this.containsPoint(Nr,Ar)&&Rr.push(Nr);for(var Lr=this._getSegments(),Ur=Tr._getSegments(),Vr=0;Vr<Lr.length;Vr++)for(var Wr=Lr[Vr],qr=0;qr<Ur.length;qr++){var Kr=Ur[qr],Xr=Zr(Wr[0],Wr[1],Kr[0],Kr[1]);Xr&&Rr.push(Xr)}function Zr(as,ls,fs,Ts){var $s=ls.minus(as),xs=Ts.minus(fs),ys=-xs.x*$s.y+$s.x*xs.y;if(ys===0)return null;var ps=($s.x*(as.y-fs.y)-$s.y*(as.x-fs.x))/ys,vs=(xs.x*(as.y-fs.y)-xs.y*(as.x-fs.x))/ys;return-Ar<=ps&&ps<=1-Ar&&-Ar<=vs&&vs<=1-Ar?new _r.Point(as.x+vs*$s.x,as.y+vs*$s.y):null}if(Rr.length===0)return null;for(var _i=Rr[0].x,Jr=Rr[0].x,es=Rr[0].y,ts=Rr[0].y,is=1;is<Rr.length;is++){var rs=Rr[is];rs.x<_i&&(_i=rs.x),rs.x>Jr&&(Jr=rs.x),rs.y<es&&(es=rs.y),rs.y>ts&&(ts=rs.y)}return new _r.Rect(_i,es,Jr-_i,ts-es)},_getSegments:function(){var Tr=this.getTopLeft(),Ar=this.getTopRight(),Rr=this.getBottomLeft(),Pr=this.getBottomRight();return[[Tr,Ar],[Ar,Pr],[Pr,Rr],[Rr,Tr]]},rotate:function(Tr,Ar){if(Tr=_r.positiveModulo(Tr,360),Tr===0)return this.clone();Ar=Ar||this.getCenter();var Rr=this.getTopLeft().rotate(Tr,Ar),Pr=this.getTopRight().rotate(Tr,Ar),Dr=Pr.minus(Rr);Dr=Dr.apply(function(Fr){var zr=1e-15;return Math.abs(Fr)<zr?0:Fr});var Mr=Math.atan(Dr.y/Dr.x);return Dr.x<0?Mr+=Math.PI:Dr.y<0&&(Mr+=2*Math.PI),new _r.Rect(Rr.x,Rr.y,this.width,this.height,Mr/Math.PI*180)},getBoundingBox:function(){if(this.degrees===0)return this.clone();var Tr=this.getTopLeft(),Ar=this.getTopRight(),Rr=this.getBottomLeft(),Pr=this.getBottomRight(),Dr=Math.min(Tr.x,Ar.x,Rr.x,Pr.x),Mr=Math.max(Tr.x,Ar.x,Rr.x,Pr.x),Fr=Math.min(Tr.y,Ar.y,Rr.y,Pr.y),zr=Math.max(Tr.y,Ar.y,Rr.y,Pr.y);return new _r.Rect(Dr,Fr,Mr-Dr,zr-Fr)},getIntegerBoundingBox:function(){var Tr=this.getBoundingBox(),Ar=Math.floor(Tr.x),Rr=Math.floor(Tr.y),Pr=Math.ceil(Tr.width+Tr.x-Ar),Dr=Math.ceil(Tr.height+Tr.y-Rr);return new _r.Rect(Ar,Rr,Pr,Dr)},containsPoint:function(Tr,Ar){Ar=Ar||0;var Rr=this.getTopLeft(),Pr=this.getTopRight(),Dr=this.getBottomLeft(),Mr=Pr.minus(Rr),Fr=Dr.minus(Rr);return(Tr.x-Rr.x)*Mr.x+(Tr.y-Rr.y)*Mr.y>=-Ar&&(Tr.x-Pr.x)*Mr.x+(Tr.y-Pr.y)*Mr.y<=Ar&&(Tr.x-Rr.x)*Fr.x+(Tr.y-Rr.y)*Fr.y>=-Ar&&(Tr.x-Dr.x)*Fr.x+(Tr.y-Dr.y)*Fr.y<=Ar},toString:function(){return"["+Math.round(this.x*100)/100+", "+Math.round(this.y*100)/100+", "+Math.round(this.width*100)/100+"x"+Math.round(this.height*100)/100+", "+Math.round(this.degrees*100)/100+"deg]"}}}(OpenSeadragon),function(_r){var Tr={};_r.ReferenceStrip=function(jr){var Gr=this,Nr=jr.viewer,Lr=_r.getElementSize(Nr.element),Ur,Vr,Wr;for(jr.id||(jr.id="referencestrip-"+_r.now(),this.element=_r.makeNeutralElement("div"),this.element.id=jr.id,this.element.className="referencestrip"),jr=_r.extend(!0,{sizeRatio:_r.DEFAULT_SETTINGS.referenceStripSizeRatio,position:_r.DEFAULT_SETTINGS.referenceStripPosition,scroll:_r.DEFAULT_SETTINGS.referenceStripScroll,clickTimeThreshold:_r.DEFAULT_SETTINGS.clickTimeThreshold},jr,{element:this.element,showNavigator:!1,mouseNavEnabled:!1,showNavigationControl:!1,showSequenceControl:!1}),_r.extend(this,jr),Tr[this.id]={animating:!1},this.minPixelRatio=this.viewer.minPixelRatio,Vr=this.element.style,Vr.marginTop="0px",Vr.marginRight="0px",Vr.marginBottom="0px",Vr.marginLeft="0px",Vr.left="0px",Vr.bottom="0px",Vr.border="0px",Vr.background="#000",Vr.position="relative",_r.setElementTouchActionNone(this.element),_r.setElementOpacity(this.element,.8),this.viewer=Nr,this.innerTracker=new _r.MouseTracker({element:this.element,dragHandler:_r.delegate(this,Ar),scrollHandler:_r.delegate(this,Rr),enterHandler:_r.delegate(this,Dr),exitHandler:_r.delegate(this,Mr),keyDownHandler:_r.delegate(this,Fr),keyHandler:_r.delegate(this,zr)}),jr.width&&jr.height?(this.element.style.width=jr.width+"px",this.element.style.height=jr.height+"px",Nr.addControl(this.element,{anchor:_r.ControlAnchor.BOTTOM_LEFT})):jr.scroll=="horizontal"?(this.element.style.width=Lr.x*jr.sizeRatio*Nr.tileSources.length+12*Nr.tileSources.length+"px",this.element.style.height=Lr.y*jr.sizeRatio+"px",Nr.addControl(this.element,{anchor:_r.ControlAnchor.BOTTOM_LEFT})):(this.element.style.height=Lr.y*jr.sizeRatio*Nr.tileSources.length+12*Nr.tileSources.length+"px",this.element.style.width=Lr.x*jr.sizeRatio+"px",Nr.addControl(this.element,{anchor:_r.ControlAnchor.TOP_LEFT})),this.panelWidth=Lr.x*this.sizeRatio+8,this.panelHeight=Lr.y*this.sizeRatio+8,this.panels=[],this.miniViewers={},Wr=0;Wr<Nr.tileSources.length;Wr++)Ur=_r.makeNeutralElement("div"),Ur.id=this.element.id+"-"+Wr,Ur.style.width=Gr.panelWidth+"px",Ur.style.height=Gr.panelHeight+"px",Ur.style.display="inline",Ur.style.float="left",Ur.style.cssFloat="left",Ur.style.styleFloat="left",Ur.style.padding="2px",_r.setElementTouchActionNone(Ur),Ur.innerTracker=new _r.MouseTracker({element:Ur,clickTimeThreshold:this.clickTimeThreshold,clickDistThreshold:this.clickDistThreshold,pressHandler:function(qr){qr.eventSource.dragging=_r.now()},releaseHandler:function(qr){var Kr=qr.eventSource,Xr=Kr.element.id,Zr=Number(Xr.split("-")[2]),_i=_r.now();qr.insideElementPressed&&qr.insideElementReleased&&Kr.dragging&&_i-Kr.dragging<Kr.clickTimeThreshold&&(Kr.dragging=null,Nr.goToPage(Zr))}}),this.element.appendChild(Ur),Ur.activePanel=!1,this.panels.push(Ur);Pr(this,this.scroll=="vertical"?Lr.y:Lr.x,0),this.setFocus(0)},_r.extend(_r.ReferenceStrip.prototype,_r.EventSource.prototype,_r.Viewer.prototype,{setFocus:function(jr){var Gr=this.element.querySelector("#"+this.element.id+"-"+jr),Nr=_r.getElementSize(this.viewer.canvas),Lr=Number(this.element.style.width.replace("px","")),Ur=Number(this.element.style.height.replace("px","")),Vr=-Number(this.element.style.marginLeft.replace("px","")),Wr=-Number(this.element.style.marginTop.replace("px","")),qr;this.currentSelected!==Gr&&(this.currentSelected&&(this.currentSelected.style.background="#000"),this.currentSelected=Gr,this.currentSelected.style.background="#999",this.scroll=="horizontal"?(qr=Number(jr)*(this.panelWidth+3),qr>Vr+Nr.x-this.panelWidth?(qr=Math.min(qr,Lr-Nr.x),this.element.style.marginLeft=-qr+"px",Pr(this,Nr.x,-qr)):qr<Vr&&(qr=Math.max(0,qr-Nr.x/2),this.element.style.marginLeft=-qr+"px",Pr(this,Nr.x,-qr))):(qr=Number(jr)*(this.panelHeight+3),qr>Wr+Nr.y-this.panelHeight?(qr=Math.min(qr,Ur-Nr.y),this.element.style.marginTop=-qr+"px",Pr(this,Nr.y,-qr)):qr<Wr&&(qr=Math.max(0,qr-Nr.y/2),this.element.style.marginTop=-qr+"px",Pr(this,Nr.y,-qr))),this.currentPage=jr,Dr.call(this,{eventSource:this.innerTracker}))},update:function(){return Tr[this.id].animating?(_r.console.log("image reference strip update"),!0):!1},destroy:function(){if(this.miniViewers)for(var jr in this.miniViewers)this.miniViewers[jr].destroy();this.element&&this.element.parentNode.removeChild(this.element)}});function Ar(jr){var Gr=Number(this.element.style.marginLeft.replace("px","")),Nr=Number(this.element.style.marginTop.replace("px","")),Lr=Number(this.element.style.width.replace("px","")),Ur=Number(this.element.style.height.replace("px","")),Vr=_r.getElementSize(this.viewer.canvas);return this.dragging=!0,this.element&&(this.scroll=="horizontal"?-jr.delta.x>0?Gr>-(Lr-Vr.x)&&(this.element.style.marginLeft=Gr+jr.delta.x*2+"px",Pr(this,Vr.x,Gr+jr.delta.x*2)):-jr.delta.x<0&&Gr<0&&(this.element.style.marginLeft=Gr+jr.delta.x*2+"px",Pr(this,Vr.x,Gr+jr.delta.x*2)):-jr.delta.y>0?Nr>-(Ur-Vr.y)&&(this.element.style.marginTop=Nr+jr.delta.y*2+"px",Pr(this,Vr.y,Nr+jr.delta.y*2)):-jr.delta.y<0&&Nr<0&&(this.element.style.marginTop=Nr+jr.delta.y*2+"px",Pr(this,Vr.y,Nr+jr.delta.y*2))),!1}function Rr(jr){var Gr=Number(this.element.style.marginLeft.replace("px","")),Nr=Number(this.element.style.marginTop.replace("px","")),Lr=Number(this.element.style.width.replace("px","")),Ur=Number(this.element.style.height.replace("px","")),Vr=_r.getElementSize(this.viewer.canvas);return this.element&&(this.scroll=="horizontal"?jr.scroll>0?Gr>-(Lr-Vr.x)&&(this.element.style.marginLeft=Gr-jr.scroll*60+"px",Pr(this,Vr.x,Gr-jr.scroll*60)):jr.scroll<0&&Gr<0&&(this.element.style.marginLeft=Gr-jr.scroll*60+"px",Pr(this,Vr.x,Gr-jr.scroll*60)):jr.scroll<0?Nr>Vr.y-Ur&&(this.element.style.marginTop=Nr+jr.scroll*60+"px",Pr(this,Vr.y,Nr+jr.scroll*60)):jr.scroll>0&&Nr<0&&(this.element.style.marginTop=Nr+jr.scroll*60+"px",Pr(this,Vr.y,Nr+jr.scroll*60))),!1}function Pr(jr,Gr,Nr){var Lr,Ur,Vr,Wr,qr,Kr,Xr;for(jr.scroll=="horizontal"?Lr=jr.panelWidth:Lr=jr.panelHeight,Ur=Math.ceil(Gr/Lr)+5,Vr=Math.ceil((Math.abs(Nr)+Gr)/Lr)+1,Ur=Vr-Ur,Ur=Ur<0?0:Ur,Kr=Ur;Kr<Vr&&Kr<jr.panels.length;Kr++)if(Xr=jr.panels[Kr],!Xr.activePanel){var Zr,_i=jr.viewer.tileSources[Kr];_i.referenceStripThumbnailUrl?Zr={type:"image",url:_i.referenceStripThumbnailUrl}:Zr=_i,Wr=new _r.Viewer({id:Xr.id,tileSources:[Zr],element:Xr,navigatorSizeRatio:jr.sizeRatio,showNavigator:!1,mouseNavEnabled:!1,showNavigationControl:!1,showSequenceControl:!1,immediateRender:!0,blendTime:0,animationTime:0,loadTilesWithAjax:jr.viewer.loadTilesWithAjax,ajaxHeaders:jr.viewer.ajaxHeaders,useCanvas:jr.useCanvas}),Wr.displayRegion=_r.makeNeutralElement("div"),Wr.displayRegion.id=Xr.id+"-displayregion",Wr.displayRegion.className="displayregion",qr=Wr.displayRegion.style,qr.position="relative",qr.top="0px",qr.left="0px",qr.fontSize="0px",qr.overflow="hidden",qr.float="left",qr.cssFloat="left",qr.styleFloat="left",qr.zIndex=999999999,qr.cursor="default",qr.width=jr.panelWidth-4+"px",qr.height=jr.panelHeight-4+"px",Wr.displayRegion.innerTracker=new _r.MouseTracker({element:Wr.displayRegion,startDisabled:!0}),Xr.getElementsByTagName("div")[0].appendChild(Wr.displayRegion),jr.miniViewers[Xr.id]=Wr,Xr.activePanel=!0}}function Dr(jr){var Gr=jr.eventSource.element;return this.scroll=="horizontal"?Gr.style.marginBottom="0px":Gr.style.marginLeft="0px",!1}function Mr(jr){var Gr=jr.eventSource.element;return this.scroll=="horizontal"?Gr.style.marginBottom="-"+_r.getElementSize(Gr).y/2+"px":Gr.style.marginLeft="-"+_r.getElementSize(Gr).x/2+"px",!1}function Fr(jr){if(!jr.preventDefaultAction&&!jr.ctrl&&!jr.alt&&!jr.meta)switch(jr.keyCode){case 38:return Rr.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),!1;case 40:return Rr.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),!1;case 37:return Rr.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),!1;case 39:return Rr.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),!1;default:return!0}else return!0}function zr(jr){if(!jr.preventDefaultAction&&!jr.ctrl&&!jr.alt&&!jr.meta)switch(jr.keyCode){case 61:return Rr.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),!1;case 45:return Rr.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),!1;case 48:case 119:case 87:return Rr.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),!1;case 115:case 83:return Rr.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),!1;case 97:return Rr.call(this,{eventSource:this.tracker,position:null,scroll:-1,shift:null}),!1;case 100:return Rr.call(this,{eventSource:this.tracker,position:null,scroll:1,shift:null}),!1;default:return!0}else return!0}}(OpenSeadragon),function(_r){_r.DisplayRect=function(Tr,Ar,Rr,Pr,Dr,Mr){_r.Rect.apply(this,[Tr,Ar,Rr,Pr]),this.minLevel=Dr,this.maxLevel=Mr},_r.extend(_r.DisplayRect.prototype,_r.Rect.prototype)}(OpenSeadragon),function(_r){_r.Spring=function(Ar){var Rr=arguments;typeof Ar!="object"&&(Ar={initial:Rr.length&&typeof Rr[0]=="number"?Rr[0]:void 0,springStiffness:Rr.length>1?Rr[1].springStiffness:5,animationTime:Rr.length>1?Rr[1].animationTime:1.5}),_r.console.assert(typeof Ar.springStiffness=="number"&&Ar.springStiffness!==0,"[OpenSeadragon.Spring] options.springStiffness must be a non-zero number"),_r.console.assert(typeof Ar.animationTime=="number"&&Ar.animationTime>=0,"[OpenSeadragon.Spring] options.animationTime must be a number greater than or equal to 0"),Ar.exponential&&(this._exponential=!0,delete Ar.exponential),_r.extend(!0,this,Ar),this.current={value:typeof this.initial=="number"?this.initial:this._exponential?0:1,time:_r.now()},_r.console.assert(!this._exponential||this.current.value!==0,"[OpenSeadragon.Spring] value must be non-zero for exponential springs"),this.start={value:this.current.value,time:this.current.time},this.target={value:this.current.value,time:this.current.time},this._exponential&&(this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value),this.current._logValue=Math.log(this.current.value))},_r.Spring.prototype={resetTo:function(Ar){_r.console.assert(!this._exponential||Ar!==0,"[OpenSeadragon.Spring.resetTo] target must be non-zero for exponential springs"),this.start.value=this.target.value=this.current.value=Ar,this.start.time=this.target.time=this.current.time=_r.now(),this._exponential&&(this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value),this.current._logValue=Math.log(this.current.value))},springTo:function(Ar){_r.console.assert(!this._exponential||Ar!==0,"[OpenSeadragon.Spring.springTo] target must be non-zero for exponential springs"),this.start.value=this.current.value,this.start.time=this.current.time,this.target.value=Ar,this.target.time=this.start.time+1e3*this.animationTime,this._exponential&&(this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value))},shiftBy:function(Ar){this.start.value+=Ar,this.target.value+=Ar,this._exponential&&(_r.console.assert(this.target.value!==0&&this.start.value!==0,"[OpenSeadragon.Spring.shiftBy] spring value must be non-zero for exponential springs"),this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value))},setExponential:function(Ar){this._exponential=Ar,this._exponential&&(_r.console.assert(this.current.value!==0&&this.target.value!==0&&this.start.value!==0,"[OpenSeadragon.Spring.setExponential] spring value must be non-zero for exponential springs"),this.start._logValue=Math.log(this.start.value),this.target._logValue=Math.log(this.target.value),this.current._logValue=Math.log(this.current.value))},update:function(){this.current.time=_r.now();var Ar,Rr;this._exponential?(Ar=this.start._logValue,Rr=this.target._logValue):(Ar=this.start.value,Rr=this.target.value);var Pr=this.current.time>=this.target.time?Rr:Ar+(Rr-Ar)*Tr(this.springStiffness,(this.current.time-this.start.time)/(this.target.time-this.start.time)),Dr=this.current.value;return this._exponential?this.current.value=Math.exp(Pr):this.current.value=Pr,Dr!=this.current.value},isAtTargetValue:function(){return this.current.value===this.target.value}};function Tr(Ar,Rr){return(1-Math.exp(Ar*-Rr))/(1-Math.exp(-Ar))}}(OpenSeadragon),function(_r){function Tr(Rr){_r.extend(!0,this,{timeout:_r.DEFAULT_SETTINGS.timeout,jobId:null},Rr),this.image=null}Tr.prototype={errorMsg:null,start:function(){var Rr=this,Pr=this.abort;this.image=new Image,this.image.onload=function(){Rr.finish(!0)},this.image.onabort=this.image.onerror=function(){Rr.errorMsg="Image load aborted",Rr.finish(!1)},this.jobId=window.setTimeout(function(){Rr.errorMsg="Image load exceeded timeout ("+Rr.timeout+" ms)",Rr.finish(!1)},this.timeout),this.loadWithAjax?(this.request=_r.makeAjaxRequest({url:this.src,withCredentials:this.ajaxWithCredentials,headers:this.ajaxHeaders,responseType:"arraybuffer",success:function(Dr){var Mr;try{Mr=new window.Blob([Dr.response])}catch(Gr){var Fr=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder;if(Gr.name==="TypeError"&&Fr){var zr=new Fr;zr.append(Dr.response),Mr=zr.getBlob()}}Mr.size===0&&(Rr.errorMsg="Empty image response.",Rr.finish(!1));var jr=(window.URL||window.webkitURL).createObjectURL(Mr);Rr.image.src=jr},error:function(Dr){Rr.errorMsg="Image load aborted - XHR error",Rr.finish(!1)}}),this.abort=function(){Rr.request.abort(),typeof Pr=="function"&&Pr()}):(this.crossOriginPolicy!==!1&&(this.image.crossOrigin=this.crossOriginPolicy),this.image.src=this.src)},finish:function(Rr){this.image.onload=this.image.onerror=this.image.onabort=null,Rr||(this.image=null),this.jobId&&window.clearTimeout(this.jobId),this.callback(this)}},_r.ImageLoader=function(Rr){_r.extend(!0,this,{jobLimit:_r.DEFAULT_SETTINGS.imageLoaderLimit,timeout:_r.DEFAULT_SETTINGS.timeout,jobQueue:[],jobsInProgress:0},Rr)},_r.ImageLoader.prototype={addJob:function(Rr){var Pr=this,Dr=function(zr){Ar(Pr,zr,Rr.callback)},Mr={src:Rr.src,loadWithAjax:Rr.loadWithAjax,ajaxHeaders:Rr.loadWithAjax?Rr.ajaxHeaders:null,crossOriginPolicy:Rr.crossOriginPolicy,ajaxWithCredentials:Rr.ajaxWithCredentials,callback:Dr,abort:Rr.abort,timeout:this.timeout},Fr=new Tr(Mr);!this.jobLimit||this.jobsInProgress<this.jobLimit?(Fr.start(),this.jobsInProgress++):this.jobQueue.push(Fr)},clear:function(){for(var Rr=0;Rr<this.jobQueue.length;Rr++){var Pr=this.jobQueue[Rr];typeof Pr.abort=="function"&&Pr.abort()}this.jobQueue=[]}};function Ar(Rr,Pr,Dr){var Mr;Rr.jobsInProgress--,(!Rr.jobLimit||Rr.jobsInProgress<Rr.jobLimit)&&Rr.jobQueue.length>0&&(Mr=Rr.jobQueue.shift(),Mr.start(),Rr.jobsInProgress++),Dr(Pr.image,Pr.errorMsg,Pr.request)}}(OpenSeadragon),function(_r){_r.Tile=function(Tr,Ar,Rr,Pr,Dr,Mr,Fr,zr,jr,Gr){this.level=Tr,this.x=Ar,this.y=Rr,this.bounds=Pr,this.sourceBounds=Gr,this.exists=Dr,this.url=Mr,this.context2D=Fr,this.loadWithAjax=zr,this.ajaxHeaders=jr,this.ajaxHeaders?this.cacheKey=this.url+"+"+JSON.stringify(this.ajaxHeaders):this.cacheKey=this.url,this.loaded=!1,this.loading=!1,this.element=null,this.imgElement=null,this.image=null,this.style=null,this.position=null,this.size=null,this.blendStart=null,this.opacity=null,this.squaredDistance=null,this.visibility=null,this.beingDrawn=!1,this.lastTouchTime=0,this.isRightMost=!1,this.isBottomMost=!1},_r.Tile.prototype={toString:function(){return this.level+"/"+this.x+"_"+this.y},_hasTransparencyChannel:function(){return!!this.context2D||this.url.match(".png")},drawHTML:function(Tr){if(!this.cacheImageRecord){_r.console.warn("[Tile.drawHTML] attempting to draw tile %s when it's not cached",this.toString());return}if(!this.loaded){_r.console.warn("Attempting to draw tile %s when it's not yet loaded.",this.toString());return}this.element||(this.element=_r.makeNeutralElement("div"),this.imgElement=this.cacheImageRecord.getImage().cloneNode(),this.imgElement.style.msInterpolationMode="nearest-neighbor",this.imgElement.style.width="100%",this.imgElement.style.height="100%",this.style=this.element.style,this.style.position="absolute"),this.element.parentNode!=Tr&&Tr.appendChild(this.element),this.imgElement.parentNode!=this.element&&this.element.appendChild(this.imgElement),this.style.top=this.position.y+"px",this.style.left=this.position.x+"px",this.style.height=this.size.y+"px",this.style.width=this.size.x+"px",_r.setElementOpacity(this.element,this.opacity)},drawCanvas:function(Tr,Ar,Rr,Pr){var Dr=this.position.times(_r.pixelDensityRatio),Mr=this.size.times(_r.pixelDensityRatio),Fr;if(!this.context2D&&!this.cacheImageRecord){_r.console.warn("[Tile.drawCanvas] attempting to draw tile %s when it's not cached",this.toString());return}if(Fr=this.context2D||this.cacheImageRecord.getRenderedContext(),!this.loaded||!Fr){_r.console.warn("Attempting to draw tile %s when it's not yet loaded.",this.toString());return}Tr.save(),Tr.globalAlpha=this.opacity,typeof Rr=="number"&&Rr!==1&&(Dr=Dr.times(Rr),Mr=Mr.times(Rr)),Pr instanceof _r.Point&&(Dr=Dr.plus(Pr)),Tr.globalAlpha===1&&this._hasTransparencyChannel()&&Tr.clearRect(Dr.x,Dr.y,Mr.x,Mr.y),Ar({context:Tr,tile:this,rendered:Fr});var zr,jr;this.sourceBounds?(zr=Math.min(this.sourceBounds.width,Fr.canvas.width),jr=Math.min(this.sourceBounds.height,Fr.canvas.height)):(zr=Fr.canvas.width,jr=Fr.canvas.height),Tr.drawImage(Fr.canvas,0,0,zr,jr,Dr.x,Dr.y,Mr.x,Mr.y),Tr.restore()},getScaleForEdgeSmoothing:function(){var Tr;if(this.cacheImageRecord)Tr=this.cacheImageRecord.getRenderedContext();else if(this.context2D)Tr=this.context2D;else return _r.console.warn("[Tile.drawCanvas] attempting to get tile scale %s when tile's not cached",this.toString()),1;return Tr.canvas.width/(this.size.x*_r.pixelDensityRatio)},getTranslationForEdgeSmoothing:function(Tr,Ar,Rr){var Pr=Math.max(1,Math.ceil((Rr.x-Ar.x)/2)),Dr=Math.max(1,Math.ceil((Rr.y-Ar.y)/2));return new _r.Point(Pr,Dr).minus(this.position.times(_r.pixelDensityRatio).times(Tr||1).apply(function(Mr){return Mr%1}))},unload:function(){this.imgElement&&this.imgElement.parentNode&&this.imgElement.parentNode.removeChild(this.imgElement),this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.element=null,this.imgElement=null,this.loaded=!1,this.loading=!1}}}(OpenSeadragon),function(_r){_r.OverlayPlacement=_r.Placement,_r.OverlayRotationMode=_r.freezeObject({NO_ROTATION:1,EXACT:2,BOUNDING_BOX:3}),_r.Overlay=function(Tr,Ar,Rr){var Pr;_r.isPlainObject(Tr)?Pr=Tr:Pr={element:Tr,location:Ar,placement:Rr},this.element=Pr.element,this.style=Pr.element.style,this._init(Pr)},_r.Overlay.prototype={_init:function(Tr){this.location=Tr.location,this.placement=Tr.placement===void 0?_r.Placement.TOP_LEFT:Tr.placement,this.onDraw=Tr.onDraw,this.checkResize=Tr.checkResize===void 0?!0:Tr.checkResize,this.width=Tr.width===void 0?null:Tr.width,this.height=Tr.height===void 0?null:Tr.height,this.rotationMode=Tr.rotationMode||_r.OverlayRotationMode.EXACT,this.location instanceof _r.Rect&&(this.width=this.location.width,this.height=this.location.height,this.location=this.location.getTopLeft(),this.placement=_r.Placement.TOP_LEFT),this.scales=this.width!==null&&this.height!==null,this.bounds=new _r.Rect(this.location.x,this.location.y,this.width,this.height),this.position=this.location},adjust:function(Tr,Ar){var Rr=_r.Placement.properties[this.placement];Rr&&(Rr.isHorizontallyCentered?Tr.x-=Ar.x/2:Rr.isRight&&(Tr.x-=Ar.x),Rr.isVerticallyCentered?Tr.y-=Ar.y/2:Rr.isBottom&&(Tr.y-=Ar.y))},destroy:function(){var Tr=this.element,Ar=this.style;Tr.parentNode&&(Tr.parentNode.removeChild(Tr),Tr.prevElementParent&&(Ar.display="none",document.body.appendChild(Tr))),this.onDraw=null,Ar.top="",Ar.left="",Ar.position="",this.width!==null&&(Ar.width=""),this.height!==null&&(Ar.height="");var Rr=_r.getCssPropertyWithVendorPrefix("transformOrigin"),Pr=_r.getCssPropertyWithVendorPrefix("transform");Rr&&Pr&&(Ar[Rr]="",Ar[Pr]="")},drawHTML:function(Tr,Ar){var Rr=this.element;Rr.parentNode!==Tr&&(Rr.prevElementParent=Rr.parentNode,Rr.prevNextSibling=Rr.nextSibling,Tr.appendChild(Rr),this.style.position="absolute",this.size=_r.getElementSize(Rr));var Pr=this._getOverlayPositionAndSize(Ar),Dr=Pr.position,Mr=this.size=Pr.size,Fr=Pr.rotate;if(this.onDraw)this.onDraw(Dr,Mr,this.element);else{var zr=this.style;zr.left=Dr.x+"px",zr.top=Dr.y+"px",this.width!==null&&(zr.width=Mr.x+"px"),this.height!==null&&(zr.height=Mr.y+"px");var jr=_r.getCssPropertyWithVendorPrefix("transformOrigin"),Gr=_r.getCssPropertyWithVendorPrefix("transform");jr&&Gr&&(Fr?(zr[jr]=this._getTransformOrigin(),zr[Gr]="rotate("+Fr+"deg)"):(zr[jr]="",zr[Gr]="")),zr.display!=="none"&&(zr.display="block")}},_getOverlayPositionAndSize:function(Tr){var Ar=Tr.pixelFromPoint(this.location,!0),Rr=this._getSizeInPixels(Tr);this.adjust(Ar,Rr);var Pr=0;if(Tr.degrees&&this.rotationMode!==_r.OverlayRotationMode.NO_ROTATION)if(this.rotationMode===_r.OverlayRotationMode.BOUNDING_BOX&&this.width!==null&&this.height!==null){var Dr=new _r.Rect(Ar.x,Ar.y,Rr.x,Rr.y),Mr=this._getBoundingBox(Dr,Tr.degrees);Ar=Mr.getTopLeft(),Rr=Mr.getSize()}else Pr=Tr.degrees;return{position:Ar,size:Rr,rotate:Pr}},_getSizeInPixels:function(Tr){var Ar=this.size.x,Rr=this.size.y;if(this.width!==null||this.height!==null){var Pr=Tr.deltaPixelsFromPointsNoRotate(new _r.Point(this.width||0,this.height||0),!0);this.width!==null&&(Ar=Pr.x),this.height!==null&&(Rr=Pr.y)}if(this.checkResize&&(this.width===null||this.height===null)){var Dr=this.size=_r.getElementSize(this.element);this.width===null&&(Ar=Dr.x),this.height===null&&(Rr=Dr.y)}return new _r.Point(Ar,Rr)},_getBoundingBox:function(Tr,Ar){var Rr=this._getPlacementPoint(Tr);return Tr.rotate(Ar,Rr).getBoundingBox()},_getPlacementPoint:function(Tr){var Ar=new _r.Point(Tr.x,Tr.y),Rr=_r.Placement.properties[this.placement];return Rr&&(Rr.isHorizontallyCentered?Ar.x+=Tr.width/2:Rr.isRight&&(Ar.x+=Tr.width),Rr.isVerticallyCentered?Ar.y+=Tr.height/2:Rr.isBottom&&(Ar.y+=Tr.height)),Ar},_getTransformOrigin:function(){var Tr="",Ar=_r.Placement.properties[this.placement];return Ar&&(Ar.isLeft?Tr="left":Ar.isRight&&(Tr="right"),Ar.isTop?Tr+=" top":Ar.isBottom&&(Tr+=" bottom")),Tr},update:function(Tr,Ar){var Rr=_r.isPlainObject(Tr)?Tr:{location:Tr,placement:Ar};this._init({location:Rr.location||this.location,placement:Rr.placement!==void 0?Rr.placement:this.placement,onDraw:Rr.onDraw||this.onDraw,checkResize:Rr.checkResize||this.checkResize,width:Rr.width!==void 0?Rr.width:this.width,height:Rr.height!==void 0?Rr.height:this.height,rotationMode:Rr.rotationMode||this.rotationMode})},getBounds:function(Tr){_r.console.assert(Tr,"A viewport must now be passed to Overlay.getBounds.");var Ar=this.width,Rr=this.height;if(Ar===null||Rr===null){var Pr=Tr.deltaPointsFromPixelsNoRotate(this.size,!0);Ar===null&&(Ar=Pr.x),Rr===null&&(Rr=Pr.y)}var Dr=this.location.clone();return this.adjust(Dr,new _r.Point(Ar,Rr)),this._adjustBoundsForRotation(Tr,new _r.Rect(Dr.x,Dr.y,Ar,Rr))},_adjustBoundsForRotation:function(Tr,Ar){if(!Tr||Tr.degrees===0||this.rotationMode===_r.OverlayRotationMode.EXACT)return Ar;if(this.rotationMode===_r.OverlayRotationMode.BOUNDING_BOX){if(this.width===null||this.height===null)return Ar;var Rr=this._getOverlayPositionAndSize(Tr);return Tr.viewerElementToViewportRectangle(new _r.Rect(Rr.position.x,Rr.position.y,Rr.size.x,Rr.size.y))}return Ar.rotate(-Tr.degrees,this._getPlacementPoint(Ar))}}}(OpenSeadragon),function(_r){_r.Drawer=function(Tr){_r.console.assert(Tr.viewer,"[Drawer] options.viewer is required");var Ar=arguments;if(_r.isPlainObject(Tr)||(Tr={source:Ar[0],viewport:Ar[1],element:Ar[2]}),_r.console.assert(Tr.viewport,"[Drawer] options.viewport is required"),_r.console.assert(Tr.element,"[Drawer] options.element is required"),Tr.source&&_r.console.error("[Drawer] options.source is no longer accepted; use TiledImage instead"),this.viewer=Tr.viewer,this.viewport=Tr.viewport,this.debugGridColor=typeof Tr.debugGridColor=="string"?[Tr.debugGridColor]:Tr.debugGridColor||_r.DEFAULT_SETTINGS.debugGridColor,Tr.opacity&&_r.console.error("[Drawer] options.opacity is no longer accepted; set the opacity on the TiledImage instead"),this.useCanvas=_r.supportsCanvas&&(this.viewer?this.viewer.useCanvas:!0),this.container=_r.getElement(Tr.element),this.canvas=_r.makeNeutralElement(this.useCanvas?"canvas":"div"),this.context=this.useCanvas?this.canvas.getContext("2d"):null,this.sketchCanvas=null,this.sketchContext=null,this.element=this.container,this.container.dir="ltr",this.useCanvas){var Rr=this._calculateCanvasSize();this.canvas.width=Rr.x,this.canvas.height=Rr.y}this.canvas.style.width="100%",this.canvas.style.height="100%",this.canvas.style.position="absolute",_r.setElementOpacity(this.canvas,this.opacity,!0),this.container.style.textAlign="left",this.container.appendChild(this.canvas),this._imageSmoothingEnabled=!0},_r.Drawer.prototype={addOverlay:function(Tr,Ar,Rr,Pr){return _r.console.error("drawer.addOverlay is deprecated. Use viewer.addOverlay instead."),this.viewer.addOverlay(Tr,Ar,Rr,Pr),this},updateOverlay:function(Tr,Ar,Rr){return _r.console.error("drawer.updateOverlay is deprecated. Use viewer.updateOverlay instead."),this.viewer.updateOverlay(Tr,Ar,Rr),this},removeOverlay:function(Tr){return _r.console.error("drawer.removeOverlay is deprecated. Use viewer.removeOverlay instead."),this.viewer.removeOverlay(Tr),this},clearOverlays:function(){return _r.console.error("drawer.clearOverlays is deprecated. Use viewer.clearOverlays instead."),this.viewer.clearOverlays(),this},viewportCoordToDrawerCoord:function(Tr){var Ar=this.viewport.pixelFromPointNoRotate(Tr,!0);return new _r.Point(Ar.x*_r.pixelDensityRatio,Ar.y*_r.pixelDensityRatio)},clipWithPolygons:function(Tr,Ar){if(this.useCanvas){var Rr=this._getContext(Ar);Rr.beginPath(),Tr.forEach(function(Pr){Pr.forEach(function(Dr,Mr){Rr[Mr===0?"moveTo":"lineTo"](Dr.x,Dr.y)})}),Rr.clip()}},setOpacity:function(Tr){_r.console.error("drawer.setOpacity is deprecated. Use tiledImage.setOpacity instead.");for(var Ar=this.viewer.world,Rr=0;Rr<Ar.getItemCount();Rr++)Ar.getItemAt(Rr).setOpacity(Tr);return this},getOpacity:function(){_r.console.error("drawer.getOpacity is deprecated. Use tiledImage.getOpacity instead.");for(var Tr=this.viewer.world,Ar=0,Rr=0;Rr<Tr.getItemCount();Rr++){var Pr=Tr.getItemAt(Rr).getOpacity();Pr>Ar&&(Ar=Pr)}return Ar},needsUpdate:function(){return _r.console.error("[Drawer.needsUpdate] this function is deprecated. Use World.needsDraw instead."),this.viewer.world.needsDraw()},numTilesLoaded:function(){return _r.console.error("[Drawer.numTilesLoaded] this function is deprecated. Use TileCache.numTilesLoaded instead."),this.viewer.tileCache.numTilesLoaded()},reset:function(){return _r.console.error("[Drawer.reset] this function is deprecated. Use World.resetItems instead."),this.viewer.world.resetItems(),this},update:function(){return _r.console.error("[Drawer.update] this function is deprecated. Use Drawer.clear and World.draw instead."),this.clear(),this.viewer.world.draw(),this},canRotate:function(){return this.useCanvas},destroy:function(){this.canvas.width=1,this.canvas.height=1,this.sketchCanvas=null,this.sketchContext=null},clear:function(){if(this.canvas.innerHTML="",this.useCanvas){var Tr=this._calculateCanvasSize();if((this.canvas.width!=Tr.x||this.canvas.height!=Tr.y)&&(this.canvas.width=Tr.x,this.canvas.height=Tr.y,this._updateImageSmoothingEnabled(this.context),this.sketchCanvas!==null)){var Ar=this._calculateSketchCanvasSize();this.sketchCanvas.width=Ar.x,this.sketchCanvas.height=Ar.y,this._updateImageSmoothingEnabled(this.sketchContext)}this._clear()}},_clear:function(Tr,Ar){if(this.useCanvas){var Rr=this._getContext(Tr);if(Ar)Rr.clearRect(Ar.x,Ar.y,Ar.width,Ar.height);else{var Pr=Rr.canvas;Rr.clearRect(0,0,Pr.width,Pr.height)}}},viewportToDrawerRectangle:function(Tr){var Ar=this.viewport.pixelFromPointNoRotate(Tr.getTopLeft(),!0),Rr=this.viewport.deltaPixelsFromPointsNoRotate(Tr.getSize(),!0);return new _r.Rect(Ar.x*_r.pixelDensityRatio,Ar.y*_r.pixelDensityRatio,Rr.x*_r.pixelDensityRatio,Rr.y*_r.pixelDensityRatio)},drawTile:function(Tr,Ar,Rr,Pr,Dr){if(_r.console.assert(Tr,"[Drawer.drawTile] tile is required"),_r.console.assert(Ar,"[Drawer.drawTile] drawingHandler is required"),this.useCanvas){var Mr=this._getContext(Rr);Pr=Pr||1,Tr.drawCanvas(Mr,Ar,Pr,Dr)}else Tr.drawHTML(this.canvas)},_getContext:function(Tr){var Ar=this.context;if(Tr){if(this.sketchCanvas===null){this.sketchCanvas=document.createElement("canvas");var Rr=this._calculateSketchCanvasSize();if(this.sketchCanvas.width=Rr.x,this.sketchCanvas.height=Rr.y,this.sketchContext=this.sketchCanvas.getContext("2d"),this.viewport.getRotation()===0){var Pr=this;this.viewer.addHandler("rotate",function Dr(){if(Pr.viewport.getRotation()!==0){Pr.viewer.removeHandler("rotate",Dr);var Mr=Pr._calculateSketchCanvasSize();Pr.sketchCanvas.width=Mr.x,Pr.sketchCanvas.height=Mr.y}})}this._updateImageSmoothingEnabled(this.sketchContext)}Ar=this.sketchContext}return Ar},saveContext:function(Tr){this.useCanvas&&this._getContext(Tr).save()},restoreContext:function(Tr){this.useCanvas&&this._getContext(Tr).restore()},setClip:function(Tr,Ar){if(this.useCanvas){var Rr=this._getContext(Ar);Rr.beginPath(),Rr.rect(Tr.x,Tr.y,Tr.width,Tr.height),Rr.clip()}},drawRectangle:function(Tr,Ar,Rr){if(this.useCanvas){var Pr=this._getContext(Rr);Pr.save(),Pr.fillStyle=Ar,Pr.fillRect(Tr.x,Tr.y,Tr.width,Tr.height),Pr.restore()}},blendSketch:function(Tr,Ar,Rr,Pr){var Dr=Tr;if(_r.isPlainObject(Dr)||(Dr={opacity:Tr,scale:Ar,translate:Rr,compositeOperation:Pr}),!(!this.useCanvas||!this.sketchCanvas)){Tr=Dr.opacity,Pr=Dr.compositeOperation;var Mr=Dr.bounds;if(this.context.save(),this.context.globalAlpha=Tr,Pr&&(this.context.globalCompositeOperation=Pr),Mr)Mr.x<0&&(Mr.width+=Mr.x,Mr.x=0),Mr.x+Mr.width>this.canvas.width&&(Mr.width=this.canvas.width-Mr.x),Mr.y<0&&(Mr.height+=Mr.y,Mr.y=0),Mr.y+Mr.height>this.canvas.height&&(Mr.height=this.canvas.height-Mr.y),this.context.drawImage(this.sketchCanvas,Mr.x,Mr.y,Mr.width,Mr.height,Mr.x,Mr.y,Mr.width,Mr.height);else{Ar=Dr.scale||1,Rr=Dr.translate;var Fr=Rr instanceof _r.Point?Rr:new _r.Point(0,0),zr=0,jr=0;if(Rr){var Gr=this.sketchCanvas.width-this.canvas.width,Nr=this.sketchCanvas.height-this.canvas.height;zr=Math.round(Gr/2),jr=Math.round(Nr/2)}this.context.drawImage(this.sketchCanvas,Fr.x-zr*Ar,Fr.y-jr*Ar,(this.canvas.width+2*zr)*Ar,(this.canvas.height+2*jr)*Ar,-zr,-jr,this.canvas.width+2*zr,this.canvas.height+2*jr)}this.context.restore()}},drawDebugInfo:function(Tr,Ar,Rr,Pr){if(this.useCanvas){var Dr=this.viewer.world.getIndexOfItem(Pr)%this.debugGridColor.length,Mr=this.context;Mr.save(),Mr.lineWidth=2*_r.pixelDensityRatio,Mr.font="small-caps bold "+13*_r.pixelDensityRatio+"px arial",Mr.strokeStyle=this.debugGridColor[Dr],Mr.fillStyle=this.debugGridColor[Dr],this.viewport.degrees!==0&&this._offsetForRotation({degrees:this.viewport.degrees}),Pr.getRotation(!0)%360!==0&&this._offsetForRotation({degrees:Pr.getRotation(!0),point:Pr.viewport.pixelFromPointNoRotate(Pr._getRotationPoint(!0),!0)}),Pr.viewport.degrees===0&&Pr.getRotation(!0)%360===0&&Pr._drawer.viewer.viewport.getFlip()&&Pr._drawer._flip(),Mr.strokeRect(Tr.position.x*_r.pixelDensityRatio,Tr.position.y*_r.pixelDensityRatio,Tr.size.x*_r.pixelDensityRatio,Tr.size.y*_r.pixelDensityRatio);var Fr=(Tr.position.x+Tr.size.x/2)*_r.pixelDensityRatio,zr=(Tr.position.y+Tr.size.y/2)*_r.pixelDensityRatio;Mr.translate(Fr,zr),Mr.rotate(Math.PI/180*-this.viewport.degrees),Mr.translate(-Fr,-zr),Tr.x===0&&Tr.y===0&&(Mr.fillText("Zoom: "+this.viewport.getZoom(),Tr.position.x*_r.pixelDensityRatio,(Tr.position.y-30)*_r.pixelDensityRatio),Mr.fillText("Pan: "+this.viewport.getBounds().toString(),Tr.position.x*_r.pixelDensityRatio,(Tr.position.y-20)*_r.pixelDensityRatio)),Mr.fillText("Level: "+Tr.level,(Tr.position.x+10)*_r.pixelDensityRatio,(Tr.position.y+20)*_r.pixelDensityRatio),Mr.fillText("Column: "+Tr.x,(Tr.position.x+10)*_r.pixelDensityRatio,(Tr.position.y+30)*_r.pixelDensityRatio),Mr.fillText("Row: "+Tr.y,(Tr.position.x+10)*_r.pixelDensityRatio,(Tr.position.y+40)*_r.pixelDensityRatio),Mr.fillText("Order: "+Rr+" of "+Ar,(Tr.position.x+10)*_r.pixelDensityRatio,(Tr.position.y+50)*_r.pixelDensityRatio),Mr.fillText("Size: "+Tr.size.toString(),(Tr.position.x+10)*_r.pixelDensityRatio,(Tr.position.y+60)*_r.pixelDensityRatio),Mr.fillText("Position: "+Tr.position.toString(),(Tr.position.x+10)*_r.pixelDensityRatio,(Tr.position.y+70)*_r.pixelDensityRatio),this.viewport.degrees!==0&&this._restoreRotationChanges(),Pr.getRotation(!0)%360!==0&&this._restoreRotationChanges(),Pr.viewport.degrees===0&&Pr.getRotation(!0)%360===0&&Pr._drawer.viewer.viewport.getFlip()&&Pr._drawer._flip(),Mr.restore()}},debugRect:function(Tr){if(this.useCanvas){var Ar=this.context;Ar.save(),Ar.lineWidth=2*_r.pixelDensityRatio,Ar.strokeStyle=this.debugGridColor[0],Ar.fillStyle=this.debugGridColor[0],Ar.strokeRect(Tr.x*_r.pixelDensityRatio,Tr.y*_r.pixelDensityRatio,Tr.width*_r.pixelDensityRatio,Tr.height*_r.pixelDensityRatio),Ar.restore()}},setImageSmoothingEnabled:function(Tr){this.useCanvas&&(this._imageSmoothingEnabled=Tr,this._updateImageSmoothingEnabled(this.context),this.viewer.forceRedraw())},_updateImageSmoothingEnabled:function(Tr){Tr.msImageSmoothingEnabled=this._imageSmoothingEnabled,Tr.imageSmoothingEnabled=this._imageSmoothingEnabled},getCanvasSize:function(Tr){var Ar=this._getContext(Tr).canvas;return new _r.Point(Ar.width,Ar.height)},getCanvasCenter:function(){return new _r.Point(this.canvas.width/2,this.canvas.height/2)},_offsetForRotation:function(Tr){var Ar=Tr.point?Tr.point.times(_r.pixelDensityRatio):this.getCanvasCenter(),Rr=this._getContext(Tr.useSketch);Rr.save(),Rr.translate(Ar.x,Ar.y),this.viewer.viewport.flipped?(Rr.rotate(Math.PI/180*-Tr.degrees),Rr.scale(-1,1)):Rr.rotate(Math.PI/180*Tr.degrees),Rr.translate(-Ar.x,-Ar.y)},_flip:function(Tr){Tr=Tr||{};var Ar=Tr.point?Tr.point.times(_r.pixelDensityRatio):this.getCanvasCenter(),Rr=this._getContext(Tr.useSketch);Rr.translate(Ar.x,0),Rr.scale(-1,1),Rr.translate(-Ar.x,0)},_restoreRotationChanges:function(Tr){var Ar=this._getContext(Tr);Ar.restore()},_calculateCanvasSize:function(){var Tr=_r.pixelDensityRatio,Ar=this.viewport.getContainerSize();return{x:Math.round(Ar.x*Tr),y:Math.round(Ar.y*Tr)}},_calculateSketchCanvasSize:function(){var Tr=this._calculateCanvasSize();if(this.viewport.getRotation()===0)return Tr;var Ar=Math.ceil(Math.sqrt(Tr.x*Tr.x+Tr.y*Tr.y));return{x:Ar,y:Ar}}}}(OpenSeadragon),function(_r){_r.Viewport=function(Tr){var Ar=arguments;Ar.length&&Ar[0]instanceof _r.Point&&(Tr={containerSize:Ar[0],contentSize:Ar[1],config:Ar[2]}),Tr.config&&(_r.extend(!0,Tr,Tr.config),delete Tr.config),this._margins=_r.extend({left:0,top:0,right:0,bottom:0},Tr.margins||{}),delete Tr.margins,_r.extend(!0,this,{containerSize:null,contentSize:null,zoomPoint:null,viewer:null,springStiffness:_r.DEFAULT_SETTINGS.springStiffness,animationTime:_r.DEFAULT_SETTINGS.animationTime,minZoomImageRatio:_r.DEFAULT_SETTINGS.minZoomImageRatio,maxZoomPixelRatio:_r.DEFAULT_SETTINGS.maxZoomPixelRatio,visibilityRatio:_r.DEFAULT_SETTINGS.visibilityRatio,wrapHorizontal:_r.DEFAULT_SETTINGS.wrapHorizontal,wrapVertical:_r.DEFAULT_SETTINGS.wrapVertical,defaultZoomLevel:_r.DEFAULT_SETTINGS.defaultZoomLevel,minZoomLevel:_r.DEFAULT_SETTINGS.minZoomLevel,maxZoomLevel:_r.DEFAULT_SETTINGS.maxZoomLevel,degrees:_r.DEFAULT_SETTINGS.degrees,flipped:_r.DEFAULT_SETTINGS.flipped,homeFillsViewer:_r.DEFAULT_SETTINGS.homeFillsViewer},Tr),this._updateContainerInnerSize(),this.centerSpringX=new _r.Spring({initial:0,springStiffness:this.springStiffness,animationTime:this.animationTime}),this.centerSpringY=new _r.Spring({initial:0,springStiffness:this.springStiffness,animationTime:this.animationTime}),this.zoomSpring=new _r.Spring({exponential:!0,initial:1,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._oldCenterX=this.centerSpringX.current.value,this._oldCenterY=this.centerSpringY.current.value,this._oldZoom=this.zoomSpring.current.value,this._setContentBounds(new _r.Rect(0,0,1,1),1),this.goHome(!0),this.update()},_r.Viewport.prototype={resetContentSize:function(Tr){return _r.console.assert(Tr,"[Viewport.resetContentSize] contentSize is required"),_r.console.assert(Tr instanceof _r.Point,"[Viewport.resetContentSize] contentSize must be an OpenSeadragon.Point"),_r.console.assert(Tr.x>0,"[Viewport.resetContentSize] contentSize.x must be greater than 0"),_r.console.assert(Tr.y>0,"[Viewport.resetContentSize] contentSize.y must be greater than 0"),this._setContentBounds(new _r.Rect(0,0,1,Tr.y/Tr.x),Tr.x),this},setHomeBounds:function(Tr,Ar){_r.console.error("[Viewport.setHomeBounds] this function is deprecated; The content bounds should not be set manually."),this._setContentBounds(Tr,Ar)},_setContentBounds:function(Tr,Ar){_r.console.assert(Tr,"[Viewport._setContentBounds] bounds is required"),_r.console.assert(Tr instanceof _r.Rect,"[Viewport._setContentBounds] bounds must be an OpenSeadragon.Rect"),_r.console.assert(Tr.width>0,"[Viewport._setContentBounds] bounds.width must be greater than 0"),_r.console.assert(Tr.height>0,"[Viewport._setContentBounds] bounds.height must be greater than 0"),this._contentBoundsNoRotate=Tr.clone(),this._contentSizeNoRotate=this._contentBoundsNoRotate.getSize().times(Ar),this._contentBounds=Tr.rotate(this.degrees).getBoundingBox(),this._contentSize=this._contentBounds.getSize().times(Ar),this._contentAspectRatio=this._contentSize.x/this._contentSize.y,this.viewer&&this.viewer.raiseEvent("reset-size",{contentSize:this._contentSizeNoRotate.clone(),contentFactor:Ar,homeBounds:this._contentBoundsNoRotate.clone(),contentBounds:this._contentBounds.clone()})},getHomeZoom:function(){if(this.defaultZoomLevel)return this.defaultZoomLevel;var Tr=this._contentAspectRatio/this.getAspectRatio(),Ar;return this.homeFillsViewer?Ar=Tr>=1?Tr:1:Ar=Tr>=1?1:Tr,Ar/this._contentBounds.width},getHomeBounds:function(){return this.getHomeBoundsNoRotate().rotate(-this.getRotation())},getHomeBoundsNoRotate:function(){var Tr=this._contentBounds.getCenter(),Ar=1/this.getHomeZoom(),Rr=Ar/this.getAspectRatio();return new _r.Rect(Tr.x-Ar/2,Tr.y-Rr/2,Ar,Rr)},goHome:function(Tr){return this.viewer&&this.viewer.raiseEvent("home",{immediately:Tr}),this.fitBounds(this.getHomeBounds(),Tr)},getMinZoom:function(){var Tr=this.getHomeZoom(),Ar=this.minZoomLevel?this.minZoomLevel:this.minZoomImageRatio*Tr;return Ar},getMaxZoom:function(){var Tr=this.maxZoomLevel;return Tr||(Tr=this._contentSize.x*this.maxZoomPixelRatio/this._containerInnerSize.x,Tr/=this._contentBounds.width),Math.max(Tr,this.getHomeZoom())},getAspectRatio:function(){return this._containerInnerSize.x/this._containerInnerSize.y},getContainerSize:function(){return new _r.Point(this.containerSize.x,this.containerSize.y)},getMargins:function(){return _r.extend({},this._margins)},setMargins:function(Tr){_r.console.assert(_r.type(Tr)==="object","[Viewport.setMargins] margins must be an object"),this._margins=_r.extend({left:0,top:0,right:0,bottom:0},Tr),this._updateContainerInnerSize(),this.viewer&&this.viewer.forceRedraw()},getBounds:function(Tr){return this.getBoundsNoRotate(Tr).rotate(-this.getRotation())},getBoundsNoRotate:function(Tr){var Ar=this.getCenter(Tr),Rr=1/this.getZoom(Tr),Pr=Rr/this.getAspectRatio();return new _r.Rect(Ar.x-Rr/2,Ar.y-Pr/2,Rr,Pr)},getBoundsWithMargins:function(Tr){return this.getBoundsNoRotateWithMargins(Tr).rotate(-this.getRotation(),this.getCenter(Tr))},getBoundsNoRotateWithMargins:function(Tr){var Ar=this.getBoundsNoRotate(Tr),Rr=this._containerInnerSize.x*this.getZoom(Tr);return Ar.x-=this._margins.left/Rr,Ar.y-=this._margins.top/Rr,Ar.width+=(this._margins.left+this._margins.right)/Rr,Ar.height+=(this._margins.top+this._margins.bottom)/Rr,Ar},getCenter:function(Tr){var Ar=new _r.Point(this.centerSpringX.current.value,this.centerSpringY.current.value),Rr=new _r.Point(this.centerSpringX.target.value,this.centerSpringY.target.value),Pr,Dr,Mr,Fr,zr,jr,Gr,Nr;return Tr?Ar:this.zoomPoint?(Pr=this.pixelFromPoint(this.zoomPoint,!0),Dr=this.getZoom(),Mr=1/Dr,Fr=Mr/this.getAspectRatio(),zr=new _r.Rect(Ar.x-Mr/2,Ar.y-Fr/2,Mr,Fr),jr=this._pixelFromPoint(this.zoomPoint,zr),Gr=jr.minus(Pr),Nr=Gr.divide(this._containerInnerSize.x*Dr),Rr.plus(Nr)):Rr},getZoom:function(Tr){return Tr?this.zoomSpring.current.value:this.zoomSpring.target.value},_applyZoomConstraints:function(Tr){return Math.max(Math.min(Tr,this.getMaxZoom()),this.getMinZoom())},_applyBoundaryConstraints:function(Tr){var Ar=new _r.Rect(Tr.x,Tr.y,Tr.width,Tr.height);if(!this.wrapHorizontal){var Rr=this.visibilityRatio*Ar.width,Pr=Ar.x+Ar.width,Dr=this._contentBoundsNoRotate.x+this._contentBoundsNoRotate.width,Mr=this._contentBoundsNoRotate.x-Pr+Rr,Fr=Dr-Ar.x-Rr;Rr>this._contentBoundsNoRotate.width?Ar.x+=(Mr+Fr)/2:Fr<0?Ar.x+=Fr:Mr>0&&(Ar.x+=Mr)}if(!this.wrapVertical){var zr=this.visibilityRatio*Ar.height,jr=Ar.y+Ar.height,Gr=this._contentBoundsNoRotate.y+this._contentBoundsNoRotate.height,Nr=this._contentBoundsNoRotate.y-jr+zr,Lr=Gr-Ar.y-zr;zr>this._contentBoundsNoRotate.height?Ar.y+=(Nr+Lr)/2:Lr<0?Ar.y+=Lr:Nr>0&&(Ar.y+=Nr)}return Ar},_raiseConstraintsEvent:function(Tr){this.viewer&&this.viewer.raiseEvent("constrain",{immediately:Tr})},applyConstraints:function(Tr){var Ar=this.getZoom(),Rr=this._applyZoomConstraints(Ar);Ar!==Rr&&this.zoomTo(Rr,this.zoomPoint,Tr);var Pr=this.getBoundsNoRotate(),Dr=this._applyBoundaryConstraints(Pr);return this._raiseConstraintsEvent(Tr),(Pr.x!==Dr.x||Pr.y!==Dr.y||Tr)&&this.fitBounds(Dr.rotate(-this.getRotation()),Tr),this},ensureVisible:function(Tr){return this.applyConstraints(Tr)},_fitBounds:function(Tr,Ar){Ar=Ar||{};var Rr=Ar.immediately||!1,Pr=Ar.constraints||!1,Dr=this.getAspectRatio(),Mr=Tr.getCenter(),Fr=new _r.Rect(Tr.x,Tr.y,Tr.width,Tr.height,Tr.degrees+this.getRotation()).getBoundingBox();Fr.getAspectRatio()>=Dr?Fr.height=Fr.width/Dr:Fr.width=Fr.height*Dr,Fr.x=Mr.x-Fr.width/2,Fr.y=Mr.y-Fr.height/2;var zr=1/Fr.width;if(Pr){var jr=Fr.getAspectRatio(),Gr=this._applyZoomConstraints(zr);zr!==Gr&&(zr=Gr,Fr.width=1/zr,Fr.x=Mr.x-Fr.width/2,Fr.height=Fr.width/jr,Fr.y=Mr.y-Fr.height/2),Fr=this._applyBoundaryConstraints(Fr),Mr=Fr.getCenter(),this._raiseConstraintsEvent(Rr)}if(Rr)return this.panTo(Mr,!0),this.zoomTo(zr,null,!0);this.panTo(this.getCenter(!0),!0),this.zoomTo(this.getZoom(!0),null,!0);var Nr=this.getBounds(),Lr=this.getZoom();if(Lr===0||Math.abs(zr/Lr-1)<1e-8)return this.zoomTo(zr,!0),this.panTo(Mr,Rr);Fr=Fr.rotate(-this.getRotation());var Ur=Fr.getTopLeft().times(zr).minus(Nr.getTopLeft().times(Lr)).divide(zr-Lr);return this.zoomTo(zr,Ur,Rr)},fitBounds:function(Tr,Ar){return this._fitBounds(Tr,{immediately:Ar,constraints:!1})},fitBoundsWithConstraints:function(Tr,Ar){return this._fitBounds(Tr,{immediately:Ar,constraints:!0})},fitVertically:function(Tr){var Ar=new _r.Rect(this._contentBounds.x+this._contentBounds.width/2,this._contentBounds.y,0,this._contentBounds.height);return this.fitBounds(Ar,Tr)},fitHorizontally:function(Tr){var Ar=new _r.Rect(this._contentBounds.x,this._contentBounds.y+this._contentBounds.height/2,this._contentBounds.width,0);return this.fitBounds(Ar,Tr)},getConstrainedBounds:function(Tr){var Ar,Rr;return Ar=this.getBounds(Tr),Rr=this._applyBoundaryConstraints(Ar),Rr},panBy:function(Tr,Ar){var Rr=new _r.Point(this.centerSpringX.target.value,this.centerSpringY.target.value);return this.panTo(Rr.plus(Tr),Ar)},panTo:function(Tr,Ar){return Ar?(this.centerSpringX.resetTo(Tr.x),this.centerSpringY.resetTo(Tr.y)):(this.centerSpringX.springTo(Tr.x),this.centerSpringY.springTo(Tr.y)),this.viewer&&this.viewer.raiseEvent("pan",{center:Tr,immediately:Ar}),this},zoomBy:function(Tr,Ar,Rr){return this.zoomTo(this.zoomSpring.target.value*Tr,Ar,Rr)},zoomTo:function(Tr,Ar,Rr){var Pr=this;return this.zoomPoint=Ar instanceof _r.Point&&!isNaN(Ar.x)&&!isNaN(Ar.y)?Ar:null,Rr?this._adjustCenterSpringsForZoomPoint(function(){Pr.zoomSpring.resetTo(Tr)}):this.zoomSpring.springTo(Tr),this.viewer&&this.viewer.raiseEvent("zoom",{zoom:Tr,refPoint:Ar,immediately:Rr}),this},setRotation:function(Tr){return!this.viewer||!this.viewer.drawer.canRotate()?this:(this.degrees=_r.positiveModulo(Tr,360),this._setContentBounds(this.viewer.world.getHomeBounds(),this.viewer.world.getContentFactor()),this.viewer.forceRedraw(),this.viewer.raiseEvent("rotate",{degrees:Tr}),this)},getRotation:function(){return this.degrees},resize:function(Tr,Ar){var Rr=this.getBoundsNoRotate(),Pr=Rr,Dr;return this.containerSize.x=Tr.x,this.containerSize.y=Tr.y,this._updateContainerInnerSize(),Ar&&(Dr=Tr.x/this.containerSize.x,Pr.width=Rr.width*Dr,Pr.height=Pr.width/this.getAspectRatio()),this.viewer&&this.viewer.raiseEvent("resize",{newContainerSize:Tr,maintain:Ar}),this.fitBounds(Pr,!0)},_updateContainerInnerSize:function(){this._containerInnerSize=new _r.Point(Math.max(1,this.containerSize.x-(this._margins.left+this._margins.right)),Math.max(1,this.containerSize.y-(this._margins.top+this._margins.bottom)))},update:function(){var Tr=this;this._adjustCenterSpringsForZoomPoint(function(){Tr.zoomSpring.update()}),this.centerSpringX.update(),this.centerSpringY.update();var Ar=this.centerSpringX.current.value!==this._oldCenterX||this.centerSpringY.current.value!==this._oldCenterY||this.zoomSpring.current.value!==this._oldZoom;return this._oldCenterX=this.centerSpringX.current.value,this._oldCenterY=this.centerSpringY.current.value,this._oldZoom=this.zoomSpring.current.value,Ar},_adjustCenterSpringsForZoomPoint:function(Tr){if(this.zoomPoint){var Ar=this.pixelFromPoint(this.zoomPoint,!0);Tr();var Rr=this.pixelFromPoint(this.zoomPoint,!0),Pr=Rr.minus(Ar),Dr=this.deltaPointsFromPixels(Pr,!0);this.centerSpringX.shiftBy(Dr.x),this.centerSpringY.shiftBy(Dr.y),this.zoomSpring.isAtTargetValue()&&(this.zoomPoint=null)}else Tr()},deltaPixelsFromPointsNoRotate:function(Tr,Ar){return Tr.times(this._containerInnerSize.x*this.getZoom(Ar))},deltaPixelsFromPoints:function(Tr,Ar){return this.deltaPixelsFromPointsNoRotate(Tr.rotate(this.getRotation()),Ar)},deltaPointsFromPixelsNoRotate:function(Tr,Ar){return Tr.divide(this._containerInnerSize.x*this.getZoom(Ar))},deltaPointsFromPixels:function(Tr,Ar){return this.deltaPointsFromPixelsNoRotate(Tr,Ar).rotate(-this.getRotation())},pixelFromPointNoRotate:function(Tr,Ar){return this._pixelFromPointNoRotate(Tr,this.getBoundsNoRotate(Ar))},pixelFromPoint:function(Tr,Ar){return this._pixelFromPoint(Tr,this.getBoundsNoRotate(Ar))},_pixelFromPointNoRotate:function(Tr,Ar){return Tr.minus(Ar.getTopLeft()).times(this._containerInnerSize.x/Ar.width).plus(new _r.Point(this._margins.left,this._margins.top))},_pixelFromPoint:function(Tr,Ar){return this._pixelFromPointNoRotate(Tr.rotate(this.getRotation(),this.getCenter(!0)),Ar)},pointFromPixelNoRotate:function(Tr,Ar){var Rr=this.getBoundsNoRotate(Ar);return Tr.minus(new _r.Point(this._margins.left,this._margins.top)).divide(this._containerInnerSize.x/Rr.width).plus(Rr.getTopLeft())},pointFromPixel:function(Tr,Ar){return this.pointFromPixelNoRotate(Tr,Ar).rotate(-this.getRotation(),this.getCenter(!0))},_viewportToImageDelta:function(Tr,Ar){var Rr=this._contentBoundsNoRotate.width;return new _r.Point(Tr*this._contentSizeNoRotate.x/Rr,Ar*this._contentSizeNoRotate.x/Rr)},viewportToImageCoordinates:function(Tr,Ar){if(Tr instanceof _r.Point)return this.viewportToImageCoordinates(Tr.x,Tr.y);if(this.viewer){var Rr=this.viewer.world.getItemCount();if(Rr>1)_r.console.error("[Viewport.viewportToImageCoordinates] is not accurate with multi-image; use TiledImage.viewportToImageCoordinates instead.");else if(Rr===1){var Pr=this.viewer.world.getItemAt(0);return Pr.viewportToImageCoordinates(Tr,Ar,!0)}}return this._viewportToImageDelta(Tr-this._contentBoundsNoRotate.x,Ar-this._contentBoundsNoRotate.y)},_imageToViewportDelta:function(Tr,Ar){var Rr=this._contentBoundsNoRotate.width;return new _r.Point(Tr/this._contentSizeNoRotate.x*Rr,Ar/this._contentSizeNoRotate.x*Rr)},imageToViewportCoordinates:function(Tr,Ar){if(Tr instanceof _r.Point)return this.imageToViewportCoordinates(Tr.x,Tr.y);if(this.viewer){var Rr=this.viewer.world.getItemCount();if(Rr>1)_r.console.error("[Viewport.imageToViewportCoordinates] is not accurate with multi-image; use TiledImage.imageToViewportCoordinates instead.");else if(Rr===1){var Pr=this.viewer.world.getItemAt(0);return Pr.imageToViewportCoordinates(Tr,Ar,!0)}}var Dr=this._imageToViewportDelta(Tr,Ar);return Dr.x+=this._contentBoundsNoRotate.x,Dr.y+=this._contentBoundsNoRotate.y,Dr},imageToViewportRectangle:function(Tr,Ar,Rr,Pr){var Dr=Tr;if(Dr instanceof _r.Rect||(Dr=new _r.Rect(Tr,Ar,Rr,Pr)),this.viewer){var Mr=this.viewer.world.getItemCount();if(Mr>1)_r.console.error("[Viewport.imageToViewportRectangle] is not accurate with multi-image; use TiledImage.imageToViewportRectangle instead.");else if(Mr===1){var Fr=this.viewer.world.getItemAt(0);return Fr.imageToViewportRectangle(Tr,Ar,Rr,Pr,!0)}}var zr=this.imageToViewportCoordinates(Dr.x,Dr.y),jr=this._imageToViewportDelta(Dr.width,Dr.height);return new _r.Rect(zr.x,zr.y,jr.x,jr.y,Dr.degrees)},viewportToImageRectangle:function(Tr,Ar,Rr,Pr){var Dr=Tr;if(Dr instanceof _r.Rect||(Dr=new _r.Rect(Tr,Ar,Rr,Pr)),this.viewer){var Mr=this.viewer.world.getItemCount();if(Mr>1)_r.console.error("[Viewport.viewportToImageRectangle] is not accurate with multi-image; use TiledImage.viewportToImageRectangle instead.");else if(Mr===1){var Fr=this.viewer.world.getItemAt(0);return Fr.viewportToImageRectangle(Tr,Ar,Rr,Pr,!0)}}var zr=this.viewportToImageCoordinates(Dr.x,Dr.y),jr=this._viewportToImageDelta(Dr.width,Dr.height);return new _r.Rect(zr.x,zr.y,jr.x,jr.y,Dr.degrees)},viewerElementToImageCoordinates:function(Tr){var Ar=this.pointFromPixel(Tr,!0);return this.viewportToImageCoordinates(Ar)},imageToViewerElementCoordinates:function(Tr){var Ar=this.imageToViewportCoordinates(Tr);return this.pixelFromPoint(Ar,!0)},windowToImageCoordinates:function(Tr){_r.console.assert(this.viewer,"[Viewport.windowToImageCoordinates] the viewport must have a viewer.");var Ar=Tr.minus(_r.getElementPosition(this.viewer.element));return this.viewerElementToImageCoordinates(Ar)},imageToWindowCoordinates:function(Tr){_r.console.assert(this.viewer,"[Viewport.imageToWindowCoordinates] the viewport must have a viewer.");var Ar=this.imageToViewerElementCoordinates(Tr);return Ar.plus(_r.getElementPosition(this.viewer.element))},viewerElementToViewportCoordinates:function(Tr){return this.pointFromPixel(Tr,!0)},viewportToViewerElementCoordinates:function(Tr){return this.pixelFromPoint(Tr,!0)},viewerElementToViewportRectangle:function(Tr){return _r.Rect.fromSummits(this.pointFromPixel(Tr.getTopLeft(),!0),this.pointFromPixel(Tr.getTopRight(),!0),this.pointFromPixel(Tr.getBottomLeft(),!0))},viewportToViewerElementRectangle:function(Tr){return _r.Rect.fromSummits(this.pixelFromPoint(Tr.getTopLeft(),!0),this.pixelFromPoint(Tr.getTopRight(),!0),this.pixelFromPoint(Tr.getBottomLeft(),!0))},windowToViewportCoordinates:function(Tr){_r.console.assert(this.viewer,"[Viewport.windowToViewportCoordinates] the viewport must have a viewer.");var Ar=Tr.minus(_r.getElementPosition(this.viewer.element));return this.viewerElementToViewportCoordinates(Ar)},viewportToWindowCoordinates:function(Tr){_r.console.assert(this.viewer,"[Viewport.viewportToWindowCoordinates] the viewport must have a viewer.");var Ar=this.viewportToViewerElementCoordinates(Tr);return Ar.plus(_r.getElementPosition(this.viewer.element))},viewportToImageZoom:function(Tr){if(this.viewer){var Ar=this.viewer.world.getItemCount();if(Ar>1)_r.console.error("[Viewport.viewportToImageZoom] is not accurate with multi-image.");else if(Ar===1){var Rr=this.viewer.world.getItemAt(0);return Rr.viewportToImageZoom(Tr)}}var Pr=this._contentSizeNoRotate.x,Dr=this._containerInnerSize.x,Mr=this._contentBoundsNoRotate.width,Fr=Dr/Pr*Mr;return Tr*Fr},imageToViewportZoom:function(Tr){if(this.viewer){var Ar=this.viewer.world.getItemCount();if(Ar>1)_r.console.error("[Viewport.imageToViewportZoom] is not accurate with multi-image.");else if(Ar===1){var Rr=this.viewer.world.getItemAt(0);return Rr.imageToViewportZoom(Tr)}}var Pr=this._contentSizeNoRotate.x,Dr=this._containerInnerSize.x,Mr=this._contentBoundsNoRotate.width,Fr=Pr/Dr/Mr;return Tr*Fr},toggleFlip:function(){return this.setFlip(!this.getFlip()),this},getFlip:function(){return this.flipped},setFlip:function(Tr){return this.flipped===Tr?this:(this.flipped=Tr,this.viewer.navigator&&this.viewer.navigator.setFlip(this.getFlip()),this.viewer.forceRedraw(),this.viewer.raiseEvent("flip",{flipped:Tr}),this)}}}(OpenSeadragon),function(_r){_r.TiledImage=function(qr){var Kr=this;_r.console.assert(qr.tileCache,"[TiledImage] options.tileCache is required"),_r.console.assert(qr.drawer,"[TiledImage] options.drawer is required"),_r.console.assert(qr.viewer,"[TiledImage] options.viewer is required"),_r.console.assert(qr.imageLoader,"[TiledImage] options.imageLoader is required"),_r.console.assert(qr.source,"[TiledImage] options.source is required"),_r.console.assert(!qr.clip||qr.clip instanceof _r.Rect,"[TiledImage] options.clip must be an OpenSeadragon.Rect if present"),_r.EventSource.call(this),this._tileCache=qr.tileCache,delete qr.tileCache,this._drawer=qr.drawer,delete qr.drawer,this._imageLoader=qr.imageLoader,delete qr.imageLoader,qr.clip instanceof _r.Rect&&(this._clip=qr.clip.clone()),delete qr.clip;var Xr=qr.x||0;delete qr.x;var Zr=qr.y||0;delete qr.y,this.normHeight=qr.source.dimensions.y/qr.source.dimensions.x,this.contentAspectX=qr.source.dimensions.x/qr.source.dimensions.y;var _i=1;qr.width?(_i=qr.width,delete qr.width,qr.height&&(_r.console.error("specifying both width and height to a tiledImage is not supported"),delete qr.height)):qr.height&&(_i=qr.height/this.normHeight,delete qr.height);var Jr=qr.fitBounds;delete qr.fitBounds;var es=qr.fitBoundsPlacement||OpenSeadragon.Placement.CENTER;delete qr.fitBoundsPlacement;var ts=qr.degrees||0;delete qr.degrees,_r.extend(!0,this,{viewer:null,tilesMatrix:{},coverage:{},loadingCoverage:{},lastDrawn:[],lastResetTime:0,_midDraw:!1,_needsDraw:!0,_hasOpaqueTile:!1,_tilesLoading:0,springStiffness:_r.DEFAULT_SETTINGS.springStiffness,animationTime:_r.DEFAULT_SETTINGS.animationTime,minZoomImageRatio:_r.DEFAULT_SETTINGS.minZoomImageRatio,wrapHorizontal:_r.DEFAULT_SETTINGS.wrapHorizontal,wrapVertical:_r.DEFAULT_SETTINGS.wrapVertical,immediateRender:_r.DEFAULT_SETTINGS.immediateRender,blendTime:_r.DEFAULT_SETTINGS.blendTime,alwaysBlend:_r.DEFAULT_SETTINGS.alwaysBlend,minPixelRatio:_r.DEFAULT_SETTINGS.minPixelRatio,smoothTileEdgesMinZoom:_r.DEFAULT_SETTINGS.smoothTileEdgesMinZoom,iOSDevice:_r.DEFAULT_SETTINGS.iOSDevice,debugMode:_r.DEFAULT_SETTINGS.debugMode,crossOriginPolicy:_r.DEFAULT_SETTINGS.crossOriginPolicy,ajaxWithCredentials:_r.DEFAULT_SETTINGS.ajaxWithCredentials,placeholderFillStyle:_r.DEFAULT_SETTINGS.placeholderFillStyle,opacity:_r.DEFAULT_SETTINGS.opacity,preload:_r.DEFAULT_SETTINGS.preload,compositeOperation:_r.DEFAULT_SETTINGS.compositeOperation},qr),this._preload=this.preload,delete this.preload,this._fullyLoaded=!1,this._xSpring=new _r.Spring({initial:Xr,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._ySpring=new _r.Spring({initial:Zr,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._scaleSpring=new _r.Spring({initial:_i,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._degreesSpring=new _r.Spring({initial:ts,springStiffness:this.springStiffness,animationTime:this.animationTime}),this._updateForScale(),Jr&&this.fitBounds(Jr,es,!0),this._drawingHandler=function(is){Kr.viewer.raiseEvent("tile-drawing",_r.extend({tiledImage:Kr},is))}},_r.extend(_r.TiledImage.prototype,_r.EventSource.prototype,{needsDraw:function(){return this._needsDraw},getFullyLoaded:function(){return this._fullyLoaded},_setFullyLoaded:function(qr){qr!==this._fullyLoaded&&(this._fullyLoaded=qr,this.raiseEvent("fully-loaded-change",{fullyLoaded:this._fullyLoaded}))},reset:function(){this._tileCache.clearTilesFor(this),this.lastResetTime=_r.now(),this._needsDraw=!0},update:function(){var qr=this._xSpring.update(),Kr=this._ySpring.update(),Xr=this._scaleSpring.update(),Zr=this._degreesSpring.update();return qr||Kr||Xr||Zr?(this._updateForScale(),this._needsDraw=!0,!0):!1},draw:function(){this.opacity!==0||this._preload?(this._midDraw=!0,this._updateViewport(),this._midDraw=!1):this._needsDraw=!1},destroy:function(){this.reset()},getBounds:function(qr){return this.getBoundsNoRotate(qr).rotate(this.getRotation(qr),this._getRotationPoint(qr))},getBoundsNoRotate:function(qr){return qr?new _r.Rect(this._xSpring.current.value,this._ySpring.current.value,this._worldWidthCurrent,this._worldHeightCurrent):new _r.Rect(this._xSpring.target.value,this._ySpring.target.value,this._worldWidthTarget,this._worldHeightTarget)},getWorldBounds:function(){return _r.console.error("[TiledImage.getWorldBounds] is deprecated; use TiledImage.getBounds instead"),this.getBounds()},getClippedBounds:function(qr){var Kr=this.getBoundsNoRotate(qr);if(this._clip){var Xr=qr?this._worldWidthCurrent:this._worldWidthTarget,Zr=Xr/this.source.dimensions.x,_i=this._clip.times(Zr);Kr=new _r.Rect(Kr.x+_i.x,Kr.y+_i.y,_i.width,_i.height)}return Kr.rotate(this.getRotation(qr),this._getRotationPoint(qr))},getContentSize:function(){return new _r.Point(this.source.dimensions.x,this.source.dimensions.y)},_viewportToImageDelta:function(qr,Kr,Xr){var Zr=Xr?this._scaleSpring.current.value:this._scaleSpring.target.value;return new _r.Point(qr*(this.source.dimensions.x/Zr),Kr*(this.source.dimensions.y*this.contentAspectX/Zr))},viewportToImageCoordinates:function(qr,Kr,Xr){var Zr;return qr instanceof _r.Point?(Xr=Kr,Zr=qr):Zr=new _r.Point(qr,Kr),Zr=Zr.rotate(-this.getRotation(Xr),this._getRotationPoint(Xr)),Xr?this._viewportToImageDelta(Zr.x-this._xSpring.current.value,Zr.y-this._ySpring.current.value):this._viewportToImageDelta(Zr.x-this._xSpring.target.value,Zr.y-this._ySpring.target.value)},_imageToViewportDelta:function(qr,Kr,Xr){var Zr=Xr?this._scaleSpring.current.value:this._scaleSpring.target.value;return new _r.Point(qr/this.source.dimensions.x*Zr,Kr/this.source.dimensions.y/this.contentAspectX*Zr)},imageToViewportCoordinates:function(qr,Kr,Xr){qr instanceof _r.Point&&(Xr=Kr,Kr=qr.y,qr=qr.x);var Zr=this._imageToViewportDelta(qr,Kr);return Xr?(Zr.x+=this._xSpring.current.value,Zr.y+=this._ySpring.current.value):(Zr.x+=this._xSpring.target.value,Zr.y+=this._ySpring.target.value),Zr.rotate(this.getRotation(Xr),this._getRotationPoint(Xr))},imageToViewportRectangle:function(qr,Kr,Xr,Zr,_i){var Jr=qr;Jr instanceof _r.Rect?_i=Kr:Jr=new _r.Rect(qr,Kr,Xr,Zr);var es=this.imageToViewportCoordinates(Jr.getTopLeft(),_i),ts=this._imageToViewportDelta(Jr.width,Jr.height,_i);return new _r.Rect(es.x,es.y,ts.x,ts.y,Jr.degrees+this.getRotation(_i))},viewportToImageRectangle:function(qr,Kr,Xr,Zr,_i){var Jr=qr;qr instanceof _r.Rect?_i=Kr:Jr=new _r.Rect(qr,Kr,Xr,Zr);var es=this.viewportToImageCoordinates(Jr.getTopLeft(),_i),ts=this._viewportToImageDelta(Jr.width,Jr.height,_i);return new _r.Rect(es.x,es.y,ts.x,ts.y,Jr.degrees-this.getRotation(_i))},viewerElementToImageCoordinates:function(qr){var Kr=this.viewport.pointFromPixel(qr,!0);return this.viewportToImageCoordinates(Kr)},imageToViewerElementCoordinates:function(qr){var Kr=this.imageToViewportCoordinates(qr);return this.viewport.pixelFromPoint(Kr,!0)},windowToImageCoordinates:function(qr){var Kr=qr.minus(OpenSeadragon.getElementPosition(this.viewer.element));return this.viewerElementToImageCoordinates(Kr)},imageToWindowCoordinates:function(qr){var Kr=this.imageToViewerElementCoordinates(qr);return Kr.plus(OpenSeadragon.getElementPosition(this.viewer.element))},_viewportToTiledImageRectangle:function(qr){var Kr=this._scaleSpring.current.value;return qr=qr.rotate(-this.getRotation(!0),this._getRotationPoint(!0)),new _r.Rect((qr.x-this._xSpring.current.value)/Kr,(qr.y-this._ySpring.current.value)/Kr,qr.width/Kr,qr.height/Kr,qr.degrees)},viewportToImageZoom:function(qr){var Kr=this._scaleSpring.current.value*this.viewport._containerInnerSize.x/this.source.dimensions.x;return Kr*qr},imageToViewportZoom:function(qr){var Kr=this._scaleSpring.current.value*this.viewport._containerInnerSize.x/this.source.dimensions.x;return qr/Kr},setPosition:function(qr,Kr){var Xr=this._xSpring.target.value===qr.x&&this._ySpring.target.value===qr.y;if(Kr){if(Xr&&this._xSpring.current.value===qr.x&&this._ySpring.current.value===qr.y)return;this._xSpring.resetTo(qr.x),this._ySpring.resetTo(qr.y),this._needsDraw=!0}else{if(Xr)return;this._xSpring.springTo(qr.x),this._ySpring.springTo(qr.y),this._needsDraw=!0}Xr||this._raiseBoundsChange()},setWidth:function(qr,Kr){this._setScale(qr,Kr)},setHeight:function(qr,Kr){this._setScale(qr/this.normHeight,Kr)},setCroppingPolygons:function(qr){var Kr=function(Zr){return Zr instanceof _r.Point||typeof Zr.x=="number"&&typeof Zr.y=="number"},Xr=function(Zr){return Zr.map(function(_i){try{if(Kr(_i))return{x:_i.x,y:_i.y};throw new Error}catch{throw new Error("A Provided cropping polygon point is not supported")}})};try{if(!_r.isArray(qr))throw new Error("Provided cropping polygon is not an array");this._croppingPolygons=qr.map(function(Zr){return Xr(Zr)})}catch(Zr){_r.console.error("[TiledImage.setCroppingPolygons] Cropping polygon format not supported"),_r.console.error(Zr),this._croppingPolygons=null}},resetCroppingPolygons:function(){this._croppingPolygons=null},fitBounds:function(qr,Kr,Xr){Kr=Kr||_r.Placement.CENTER;var Zr=_r.Placement.properties[Kr],_i=this.contentAspectX,Jr=0,es=0,ts=1,is=1;if(this._clip&&(_i=this._clip.getAspectRatio(),ts=this._clip.width/this.source.dimensions.x,is=this._clip.height/this.source.dimensions.y,qr.getAspectRatio()>_i?(Jr=this._clip.x/this._clip.height*qr.height,es=this._clip.y/this._clip.height*qr.height):(Jr=this._clip.x/this._clip.width*qr.width,es=this._clip.y/this._clip.width*qr.width)),qr.getAspectRatio()>_i){var rs=qr.height/is,as=0;Zr.isHorizontallyCentered?as=(qr.width-qr.height*_i)/2:Zr.isRight&&(as=qr.width-qr.height*_i),this.setPosition(new _r.Point(qr.x-Jr+as,qr.y-es),Xr),this.setHeight(rs,Xr)}else{var ls=qr.width/ts,fs=0;Zr.isVerticallyCentered?fs=(qr.height-qr.width/_i)/2:Zr.isBottom&&(fs=qr.height-qr.width/_i),this.setPosition(new _r.Point(qr.x-Jr,qr.y-es+fs),Xr),this.setWidth(ls,Xr)}},getClip:function(){return this._clip?this._clip.clone():null},setClip:function(qr){_r.console.assert(!qr||qr instanceof _r.Rect,"[TiledImage.setClip] newClip must be an OpenSeadragon.Rect or null"),qr instanceof _r.Rect?this._clip=qr.clone():this._clip=null,this._needsDraw=!0,this.raiseEvent("clip-change")},getOpacity:function(){return this.opacity},setOpacity:function(qr){qr!==this.opacity&&(this.opacity=qr,this._needsDraw=!0,this.raiseEvent("opacity-change",{opacity:this.opacity}))},getPreload:function(){return this._preload},setPreload:function(qr){this._preload=!!qr,this._needsDraw=!0},getRotation:function(qr){return qr?this._degreesSpring.current.value:this._degreesSpring.target.value},setRotation:function(qr,Kr){this._degreesSpring.target.value===qr&&this._degreesSpring.isAtTargetValue()||(Kr?this._degreesSpring.resetTo(qr):this._degreesSpring.springTo(qr),this._needsDraw=!0,this._raiseBoundsChange())},_getRotationPoint:function(qr){return this.getBoundsNoRotate(qr).getCenter()},getCompositeOperation:function(){return this.compositeOperation},setCompositeOperation:function(qr){qr!==this.compositeOperation&&(this.compositeOperation=qr,this._needsDraw=!0,this.raiseEvent("composite-operation-change",{compositeOperation:this.compositeOperation}))},_setScale:function(qr,Kr){var Xr=this._scaleSpring.target.value===qr;if(Kr){if(Xr&&this._scaleSpring.current.value===qr)return;this._scaleSpring.resetTo(qr),this._updateForScale(),this._needsDraw=!0}else{if(Xr)return;this._scaleSpring.springTo(qr),this._updateForScale(),this._needsDraw=!0}Xr||this._raiseBoundsChange()},_updateForScale:function(){this._worldWidthTarget=this._scaleSpring.target.value,this._worldHeightTarget=this.normHeight*this._scaleSpring.target.value,this._worldWidthCurrent=this._scaleSpring.current.value,this._worldHeightCurrent=this.normHeight*this._scaleSpring.current.value},_raiseBoundsChange:function(){this.raiseEvent("bounds-change")},_isBottomItem:function(){return this.viewer.world.getItemAt(0)===this},_getLevelsInterval:function(){var qr=Math.max(this.source.minLevel,Math.floor(Math.log(this.minZoomImageRatio)/Math.log(2))),Kr=this.viewport.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(0),!0).x*this._scaleSpring.current.value,Xr=Math.min(Math.abs(this.source.maxLevel),Math.abs(Math.floor(Math.log(Kr/this.minPixelRatio)/Math.log(2))));return Xr=Math.max(Xr,this.source.minLevel||0),qr=Math.min(qr,Xr),{lowestLevel:qr,highestLevel:Xr}},_updateViewport:function(){for(this._needsDraw=!1,this._tilesLoading=0,this.loadingCoverage={};this.lastDrawn.length>0;){var qr=this.lastDrawn.pop();qr.beingDrawn=!1}var Kr=this.viewport,Xr=this._viewportToTiledImageRectangle(Kr.getBoundsWithMargins(!0));if(!this.wrapHorizontal&&!this.wrapVertical){var Zr=this._viewportToTiledImageRectangle(this.getClippedBounds(!0));if(Xr=Xr.intersection(Zr),Xr===null)return}for(var _i=this._getLevelsInterval(),Jr=_i.lowestLevel,es=_i.highestLevel,ts=null,is=!1,rs=_r.now(),as=es;as>=Jr;as--){var ls=!1,fs=Kr.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(as),!0).x*this._scaleSpring.current.value;if(as===Jr||!is&&fs>=this.minPixelRatio)ls=!0,is=!0;else if(!is)continue;var Ts=Kr.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(as),!1).x*this._scaleSpring.current.value,$s=Kr.deltaPixelsFromPointsNoRotate(this.source.getPixelRatio(Math.max(this.source.getClosestLevel(),0)),!1).x*this._scaleSpring.current.value,xs=this.immediateRender?1:$s,ys=Math.min(1,(fs-.5)/.5),ps=xs/Math.abs(xs-Ts);if(ts=Tr(this,is,ls,as,ys,ps,Xr,rs,ts),jr(this.coverage,as))break}Vr(this,this.lastDrawn),ts&&!ts.context2D?(Pr(this,ts,rs),this._needsDraw=!0,this._setFullyLoaded(!1)):this._setFullyLoaded(this._tilesLoading===0)},_getCornerTiles:function(qr,Kr,Xr){var Zr,_i;this.wrapHorizontal?(Zr=_r.positiveModulo(Kr.x,1),_i=_r.positiveModulo(Xr.x,1)):(Zr=Math.max(0,Kr.x),_i=Math.min(1,Xr.x));var Jr,es,ts=1/this.source.aspectRatio;this.wrapVertical?(Jr=_r.positiveModulo(Kr.y,ts),es=_r.positiveModulo(Xr.y,ts)):(Jr=Math.max(0,Kr.y),es=Math.min(ts,Xr.y));var is=this.source.getTileAtPoint(qr,new _r.Point(Zr,Jr)),rs=this.source.getTileAtPoint(qr,new _r.Point(_i,es)),as=this.source.getNumTiles(qr);return this.wrapHorizontal&&(is.x+=as.x*Math.floor(Kr.x),rs.x+=as.x*Math.floor(Xr.x)),this.wrapVertical&&(is.y+=as.y*Math.floor(Kr.y/ts),rs.y+=as.y*Math.floor(Xr.y/ts)),{topLeft:is,bottomRight:rs}}});function Tr(qr,Kr,Xr,Zr,_i,Jr,es,ts,is){var rs=es.getBoundingBox().getTopLeft(),as=es.getBoundingBox().getBottomRight();qr.viewer&&qr.viewer.raiseEvent("update-level",{tiledImage:qr,havedrawn:Kr,level:Zr,opacity:_i,visibility:Jr,drawArea:es,topleft:rs,bottomright:as,currenttime:ts,best:is}),Lr(qr.coverage,Zr),Lr(qr.loadingCoverage,Zr);for(var ls=qr._getCornerTiles(Zr,rs,as),fs=ls.topLeft,Ts=ls.bottomRight,$s=qr.source.getNumTiles(Zr),xs=qr.viewport.pixelFromPoint(qr.viewport.getCenter()),ys=fs.x;ys<=Ts.x;ys++)for(var ps=fs.y;ps<=Ts.y;ps++){if(!qr.wrapHorizontal&&!qr.wrapVertical){var vs=qr.source.getTileBounds(Zr,ys,ps);if(es.intersection(vs)===null)continue}is=Ar(qr,Xr,Kr,ys,ps,Zr,_i,Jr,xs,$s,ts,is)}return is}function Ar(qr,Kr,Xr,Zr,_i,Jr,es,ts,is,rs,as,ls){var fs=Rr(Zr,_i,Jr,qr,qr.source,qr.tilesMatrix,as,rs,qr._worldWidthCurrent,qr._worldHeightCurrent),Ts=Xr;qr.viewer&&qr.viewer.raiseEvent("update-tile",{tiledImage:qr,tile:fs}),Nr(qr.coverage,Jr,Zr,_i,!1);var $s=fs.loaded||fs.loading||Gr(qr.loadingCoverage,Jr,Zr,_i);if(Nr(qr.loadingCoverage,Jr,Zr,_i,$s),!fs.exists||(Kr&&!Ts&&(Gr(qr.coverage,Jr,Zr,_i)?Nr(qr.coverage,Jr,Zr,_i,!0):Ts=!0),!Ts))return ls;if(Fr(fs,qr.source.tileOverlap,qr.viewport,is,ts,qr),!fs.loaded)if(fs.context2D)Mr(qr,fs);else{var xs=qr._tileCache.getImageRecord(fs.cacheKey);if(xs){var ys=xs.getImage();Mr(qr,fs,ys)}}if(fs.loaded){var ps=zr(qr,fs,Zr,_i,Jr,es,as);ps&&(qr._needsDraw=!0)}else fs.loading?qr._tilesLoading++:$s||(ls=Ur(ls,fs));return ls}function Rr(qr,Kr,Xr,Zr,_i,Jr,es,ts,is,rs){var as,ls,fs,Ts,$s,xs,ys,ps,vs;return Jr[Xr]||(Jr[Xr]={}),Jr[Xr][qr]||(Jr[Xr][qr]={}),Jr[Xr][qr][Kr]||(as=(ts.x+qr%ts.x)%ts.x,ls=(ts.y+Kr%ts.y)%ts.y,fs=_i.getTileBounds(Xr,as,ls),Ts=_i.getTileBounds(Xr,as,ls,!0),$s=_i.tileExists(Xr,as,ls),xs=_i.getTileUrl(Xr,as,ls),Zr.loadTilesWithAjax?(ys=_i.getTileAjaxHeaders(Xr,as,ls),_r.isPlainObject(Zr.ajaxHeaders)&&(ys=_r.extend({},Zr.ajaxHeaders,ys))):ys=null,ps=_i.getContext2D?_i.getContext2D(Xr,as,ls):void 0,fs.x+=(qr-as)/ts.x,fs.y+=rs/is*((Kr-ls)/ts.y),vs=new _r.Tile(Xr,qr,Kr,fs,$s,xs,ps,Zr.loadTilesWithAjax,ys,Ts),as===ts.x-1&&(vs.isRightMost=!0),ls===ts.y-1&&(vs.isBottomMost=!0),Jr[Xr][qr][Kr]=vs),vs=Jr[Xr][qr][Kr],vs.lastTouchTime=es,vs}function Pr(qr,Kr,Xr){Kr.loading=!0,qr._imageLoader.addJob({src:Kr.url,loadWithAjax:Kr.loadWithAjax,ajaxHeaders:Kr.ajaxHeaders,crossOriginPolicy:qr.crossOriginPolicy,ajaxWithCredentials:qr.ajaxWithCredentials,callback:function(Zr,_i,Jr){Dr(qr,Kr,Xr,Zr,_i,Jr)},abort:function(){Kr.loading=!1}})}function Dr(qr,Kr,Xr,Zr,_i,Jr){if(!Zr){_r.console.log("Tile %s failed to load: %s - error: %s",Kr,Kr.url,_i),qr.viewer.raiseEvent("tile-load-failed",{tile:Kr,tiledImage:qr,time:Xr,message:_i,tileRequest:Jr}),Kr.loading=!1,Kr.exists=!1;return}if(Xr<qr.lastResetTime){_r.console.log("Ignoring tile %s loaded before reset: %s",Kr,Kr.url),Kr.loading=!1;return}var es=function(){var ts=qr.source.getClosestLevel();Mr(qr,Kr,Zr,ts,Jr)};qr._midDraw?window.setTimeout(es,1):es()}function Mr(qr,Kr,Xr,Zr,_i){var Jr=0;function es(){return Jr++,ts}function ts(){Jr--,Jr===0&&(Kr.loading=!1,Kr.loaded=!0,Kr.context2D||qr._tileCache.cacheTile({image:Xr,tile:Kr,cutoff:Zr,tiledImage:qr}),qr._needsDraw=!0)}qr.viewer.raiseEvent("tile-loaded",{tile:Kr,tiledImage:qr,tileRequest:_i,image:Xr,getCompletionCallback:es}),es()()}function Fr(qr,Kr,Xr,Zr,_i,Jr){var es=qr.bounds.getTopLeft();es.x*=Jr._scaleSpring.current.value,es.y*=Jr._scaleSpring.current.value,es.x+=Jr._xSpring.current.value,es.y+=Jr._ySpring.current.value;var ts=qr.bounds.getSize();ts.x*=Jr._scaleSpring.current.value,ts.y*=Jr._scaleSpring.current.value;var is=Xr.pixelFromPointNoRotate(es,!0),rs=Xr.pixelFromPointNoRotate(es,!1),as=Xr.deltaPixelsFromPointsNoRotate(ts,!0),ls=Xr.deltaPixelsFromPointsNoRotate(ts,!1),fs=rs.plus(ls.divide(2)),Ts=Zr.squaredDistanceTo(fs);Kr||(as=as.plus(new _r.Point(1,1))),qr.isRightMost&&Jr.wrapHorizontal&&(as.x+=.75),qr.isBottomMost&&Jr.wrapVertical&&(as.y+=.75),qr.position=is,qr.size=as,qr.squaredDistance=Ts,qr.visibility=_i}function zr(qr,Kr,Xr,Zr,_i,Jr,es){var ts=1e3*qr.blendTime,is,rs;if(Kr.blendStart||(Kr.blendStart=es),is=es-Kr.blendStart,rs=ts?Math.min(1,is/ts):1,qr.alwaysBlend&&(rs*=Jr),Kr.opacity=rs,qr.lastDrawn.push(Kr),rs===1)Nr(qr.coverage,_i,Xr,Zr,!0),qr._hasOpaqueTile=!0;else if(is<ts)return!0;return!1}function jr(qr,Kr,Xr,Zr){var _i,Jr,es,ts;if(!qr[Kr])return!1;if(Xr===void 0||Zr===void 0){_i=qr[Kr];for(es in _i)if(Object.prototype.hasOwnProperty.call(_i,es)){Jr=_i[es];for(ts in Jr)if(Object.prototype.hasOwnProperty.call(Jr,ts)&&!Jr[ts])return!1}return!0}return qr[Kr][Xr]===void 0||qr[Kr][Xr][Zr]===void 0||qr[Kr][Xr][Zr]===!0}function Gr(qr,Kr,Xr,Zr){return Xr===void 0||Zr===void 0?jr(qr,Kr+1):jr(qr,Kr+1,2*Xr,2*Zr)&&jr(qr,Kr+1,2*Xr,2*Zr+1)&&jr(qr,Kr+1,2*Xr+1,2*Zr)&&jr(qr,Kr+1,2*Xr+1,2*Zr+1)}function Nr(qr,Kr,Xr,Zr,_i){if(!qr[Kr]){_r.console.warn("Setting coverage for a tile before its level's coverage has been reset: %s",Kr);return}qr[Kr][Xr]||(qr[Kr][Xr]={}),qr[Kr][Xr][Zr]=_i}function Lr(qr,Kr){qr[Kr]={}}function Ur(qr,Kr){return!qr||Kr.visibility>qr.visibility||Kr.visibility==qr.visibility&&Kr.squaredDistance<qr.squaredDistance?Kr:qr}function Vr(qr,Kr){if(!(qr.opacity===0||Kr.length===0&&!qr.placeholderFillStyle)){var Xr=Kr[0],Zr;Xr&&(Zr=qr.opacity<1||qr.compositeOperation&&qr.compositeOperation!=="source-over"||!qr._isBottomItem()&&Xr._hasTransparencyChannel());var _i,Jr,es=qr.viewport.getZoom(!0),ts=qr.viewportToImageZoom(es);Kr.length>1&&ts>qr.smoothTileEdgesMinZoom&&!qr.iOSDevice&&qr.getRotation(!0)%360===0&&_r.supportsCanvas&&(Zr=!0,_i=Xr.getScaleForEdgeSmoothing(),Jr=Xr.getTranslationForEdgeSmoothing(_i,qr._drawer.getCanvasSize(!1),qr._drawer.getCanvasSize(!0)));var is;Zr&&(_i||(is=qr.viewport.viewportToViewerElementRectangle(qr.getClippedBounds(!0)).getIntegerBoundingBox(),qr._drawer.viewer.viewport.getFlip()&&(qr.viewport.degrees!==0||qr.getRotation(!0)%360!==0)&&(is.x=qr._drawer.viewer.container.clientWidth-(is.x+is.width)),is=is.times(_r.pixelDensityRatio)),qr._drawer._clear(!0,is)),_i||(qr.viewport.degrees!==0&&qr._drawer._offsetForRotation({degrees:qr.viewport.degrees,useSketch:Zr}),qr.getRotation(!0)%360!==0&&qr._drawer._offsetForRotation({degrees:qr.getRotation(!0),point:qr.viewport.pixelFromPointNoRotate(qr._getRotationPoint(!0),!0),useSketch:Zr}),qr.viewport.degrees===0&&qr.getRotation(!0)%360===0&&qr._drawer.viewer.viewport.getFlip()&&qr._drawer._flip());var rs=!1;if(qr._clip){qr._drawer.saveContext(Zr);var as=qr.imageToViewportRectangle(qr._clip,!0);as=as.rotate(-qr.getRotation(!0),qr._getRotationPoint(!0));var ls=qr._drawer.viewportToDrawerRectangle(as);_i&&(ls=ls.times(_i)),Jr&&(ls=ls.translate(Jr)),qr._drawer.setClip(ls,Zr),rs=!0}if(qr._croppingPolygons){qr._drawer.saveContext(Zr);try{var fs=qr._croppingPolygons.map(function(ys){return ys.map(function(ps){var vs=qr.imageToViewportCoordinates(ps.x,ps.y,!0).rotate(-qr.getRotation(!0),qr._getRotationPoint(!0)),Ds=qr._drawer.viewportCoordToDrawerCoord(vs);return _i&&(Ds=Ds.times(_i)),Ds})});qr._drawer.clipWithPolygons(fs,Zr)}catch(ys){_r.console.error(ys)}rs=!0}if(qr.placeholderFillStyle&&qr._hasOpaqueTile===!1){var Ts=qr._drawer.viewportToDrawerRectangle(qr.getBounds(!0));_i&&(Ts=Ts.times(_i)),Jr&&(Ts=Ts.translate(Jr));var $s=null;typeof qr.placeholderFillStyle=="function"?$s=qr.placeholderFillStyle(qr,qr._drawer.context):$s=qr.placeholderFillStyle,qr._drawer.drawRectangle(Ts,$s,Zr)}for(var xs=Kr.length-1;xs>=0;xs--)Xr=Kr[xs],qr._drawer.drawTile(Xr,qr._drawingHandler,Zr,_i,Jr),Xr.beingDrawn=!0,qr.viewer&&qr.viewer.raiseEvent("tile-drawn",{tiledImage:qr,tile:Xr});rs&&qr._drawer.restoreContext(Zr),_i||(qr.getRotation(!0)%360!==0&&qr._drawer._restoreRotationChanges(Zr),qr.viewport.degrees!==0&&qr._drawer._restoreRotationChanges(Zr)),Zr&&(_i&&(qr.viewport.degrees!==0&&qr._drawer._offsetForRotation({degrees:qr.viewport.degrees,useSketch:!1}),qr.getRotation(!0)%360!==0&&qr._drawer._offsetForRotation({degrees:qr.getRotation(!0),point:qr.viewport.pixelFromPointNoRotate(qr._getRotationPoint(!0),!0),useSketch:!1})),qr._drawer.blendSketch({opacity:qr.opacity,scale:_i,translate:Jr,compositeOperation:qr.compositeOperation,bounds:is}),_i&&(qr.getRotation(!0)%360!==0&&qr._drawer._restoreRotationChanges(!1),qr.viewport.degrees!==0&&qr._drawer._restoreRotationChanges(!1))),_i||qr.viewport.degrees===0&&qr.getRotation(!0)%360===0&&qr._drawer.viewer.viewport.getFlip()&&qr._drawer._flip(),Wr(qr,Kr)}}function Wr(qr,Kr){if(qr.debugMode)for(var Xr=Kr.length-1;Xr>=0;Xr--){var Zr=Kr[Xr];try{qr._drawer.drawDebugInfo(Zr,Kr.length,Xr,qr)}catch(_i){_r.console.error(_i)}}}}(OpenSeadragon),function(_r){var Tr=function(Rr){_r.console.assert(Rr,"[TileCache.cacheTile] options is required"),_r.console.assert(Rr.tile,"[TileCache.cacheTile] options.tile is required"),_r.console.assert(Rr.tiledImage,"[TileCache.cacheTile] options.tiledImage is required"),this.tile=Rr.tile,this.tiledImage=Rr.tiledImage},Ar=function(Rr){_r.console.assert(Rr,"[ImageRecord] options is required"),_r.console.assert(Rr.image,"[ImageRecord] options.image is required"),this._image=Rr.image,this._tiles=[]};Ar.prototype={destroy:function(){this._image=null,this._renderedContext=null,this._tiles=null},getImage:function(){return this._image},getRenderedContext:function(){if(!this._renderedContext){var Rr=document.createElement("canvas");Rr.width=this._image.width,Rr.height=this._image.height,this._renderedContext=Rr.getContext("2d"),this._renderedContext.drawImage(this._image,0,0),this._image=null}return this._renderedContext},setRenderedContext:function(Rr){_r.console.error("ImageRecord.setRenderedContext is deprecated. The rendered context should be created by the ImageRecord itself when calling ImageRecord.getRenderedContext."),this._renderedContext=Rr},addTile:function(Rr){_r.console.assert(Rr,"[ImageRecord.addTile] tile is required"),this._tiles.push(Rr)},removeTile:function(Rr){for(var Pr=0;Pr<this._tiles.length;Pr++)if(this._tiles[Pr]===Rr){this._tiles.splice(Pr,1);return}_r.console.warn("[ImageRecord.removeTile] trying to remove unknown tile",Rr)},getTileCount:function(){return this._tiles.length}},_r.TileCache=function(Rr){Rr=Rr||{},this._maxImageCacheCount=Rr.maxImageCacheCount||_r.DEFAULT_SETTINGS.maxImageCacheCount,this._tilesLoaded=[],this._imagesLoaded=[],this._imagesLoadedCount=0},_r.TileCache.prototype={numTilesLoaded:function(){return this._tilesLoaded.length},cacheTile:function(Rr){_r.console.assert(Rr,"[TileCache.cacheTile] options is required"),_r.console.assert(Rr.tile,"[TileCache.cacheTile] options.tile is required"),_r.console.assert(Rr.tile.cacheKey,"[TileCache.cacheTile] options.tile.cacheKey is required"),_r.console.assert(Rr.tiledImage,"[TileCache.cacheTile] options.tiledImage is required");var Pr=Rr.cutoff||0,Dr=this._tilesLoaded.length,Mr=this._imagesLoaded[Rr.tile.cacheKey];if(Mr||(_r.console.assert(Rr.image,"[TileCache.cacheTile] options.image is required to create an ImageRecord"),Mr=this._imagesLoaded[Rr.tile.cacheKey]=new Ar({image:Rr.image}),this._imagesLoadedCount++),Mr.addTile(Rr.tile),Rr.tile.cacheImageRecord=Mr,this._imagesLoadedCount>this._maxImageCacheCount){for(var Fr=null,zr=-1,jr=null,Gr,Nr,Lr,Ur,Vr,Wr,qr=this._tilesLoaded.length-1;qr>=0;qr--)if(Wr=this._tilesLoaded[qr],Gr=Wr.tile,!(Gr.level<=Pr||Gr.beingDrawn)){if(!Fr){Fr=Gr,zr=qr,jr=Wr;continue}Ur=Gr.lastTouchTime,Nr=Fr.lastTouchTime,Vr=Gr.level,Lr=Fr.level,(Ur<Nr||Ur==Nr&&Vr>Lr)&&(Fr=Gr,zr=qr,jr=Wr)}Fr&&zr>=0&&(this._unloadTile(jr),Dr=zr)}this._tilesLoaded[Dr]=new Tr({tile:Rr.tile,tiledImage:Rr.tiledImage})},clearTilesFor:function(Rr){_r.console.assert(Rr,"[TileCache.clearTilesFor] tiledImage is required");for(var Pr,Dr=0;Dr<this._tilesLoaded.length;++Dr)Pr=this._tilesLoaded[Dr],Pr.tiledImage===Rr&&(this._unloadTile(Pr),this._tilesLoaded.splice(Dr,1),Dr--)},getImageRecord:function(Rr){return _r.console.assert(Rr,"[TileCache.getImageRecord] cacheKey is required"),this._imagesLoaded[Rr]},_unloadTile:function(Rr){_r.console.assert(Rr,"[TileCache._unloadTile] tileRecord is required");var Pr=Rr.tile,Dr=Rr.tiledImage;Pr.unload(),Pr.cacheImageRecord=null;var Mr=this._imagesLoaded[Pr.cacheKey];Mr.removeTile(Pr),Mr.getTileCount()||(Mr.destroy(),delete this._imagesLoaded[Pr.cacheKey],this._imagesLoadedCount--),Dr.viewer.raiseEvent("tile-unloaded",{tile:Pr,tiledImage:Dr})}}}(OpenSeadragon),function(_r){_r.World=function(Tr){var Ar=this;_r.console.assert(Tr.viewer,"[World] options.viewer is required"),_r.EventSource.call(this),this.viewer=Tr.viewer,this._items=[],this._needsDraw=!1,this._autoRefigureSizes=!0,this._needsSizesFigured=!1,this._delegatedFigureSizes=function(Rr){Ar._autoRefigureSizes?Ar._figureSizes():Ar._needsSizesFigured=!0},this._figureSizes()},_r.extend(_r.World.prototype,_r.EventSource.prototype,{addItem:function(Tr,Ar){if(_r.console.assert(Tr,"[World.addItem] item is required"),_r.console.assert(Tr instanceof _r.TiledImage,"[World.addItem] only TiledImages supported at this time"),Ar=Ar||{},Ar.index!==void 0){var Rr=Math.max(0,Math.min(this._items.length,Ar.index));this._items.splice(Rr,0,Tr)}else this._items.push(Tr);this._autoRefigureSizes?this._figureSizes():this._needsSizesFigured=!0,this._needsDraw=!0,Tr.addHandler("bounds-change",this._delegatedFigureSizes),Tr.addHandler("clip-change",this._delegatedFigureSizes),this.raiseEvent("add-item",{item:Tr})},getItemAt:function(Tr){return _r.console.assert(Tr!==void 0,"[World.getItemAt] index is required"),this._items[Tr]},getIndexOfItem:function(Tr){return _r.console.assert(Tr,"[World.getIndexOfItem] item is required"),_r.indexOf(this._items,Tr)},getItemCount:function(){return this._items.length},setItemIndex:function(Tr,Ar){_r.console.assert(Tr,"[World.setItemIndex] item is required"),_r.console.assert(Ar!==void 0,"[World.setItemIndex] index is required");var Rr=this.getIndexOfItem(Tr);if(Ar>=this._items.length)throw new Error("Index bigger than number of layers.");Ar===Rr||Rr===-1||(this._items.splice(Rr,1),this._items.splice(Ar,0,Tr),this._needsDraw=!0,this.raiseEvent("item-index-change",{item:Tr,previousIndex:Rr,newIndex:Ar}))},removeItem:function(Tr){_r.console.assert(Tr,"[World.removeItem] item is required");var Ar=_r.indexOf(this._items,Tr);Ar!==-1&&(Tr.removeHandler("bounds-change",this._delegatedFigureSizes),Tr.removeHandler("clip-change",this._delegatedFigureSizes),Tr.destroy(),this._items.splice(Ar,1),this._figureSizes(),this._needsDraw=!0,this._raiseRemoveItem(Tr))},removeAll:function(){this.viewer._cancelPendingImages();var Tr,Ar;for(Ar=0;Ar<this._items.length;Ar++)Tr=this._items[Ar],Tr.removeHandler("bounds-change",this._delegatedFigureSizes),Tr.removeHandler("clip-change",this._delegatedFigureSizes),Tr.destroy();var Rr=this._items;for(this._items=[],this._figureSizes(),this._needsDraw=!0,Ar=0;Ar<Rr.length;Ar++)Tr=Rr[Ar],this._raiseRemoveItem(Tr)},resetItems:function(){for(var Tr=0;Tr<this._items.length;Tr++)this._items[Tr].reset()},update:function(){for(var Tr=!1,Ar=0;Ar<this._items.length;Ar++)Tr=this._items[Ar].update()||Tr;return Tr},draw:function(){for(var Tr=0;Tr<this._items.length;Tr++)this._items[Tr].draw();this._needsDraw=!1},needsDraw:function(){for(var Tr=0;Tr<this._items.length;Tr++)if(this._items[Tr].needsDraw())return!0;return this._needsDraw},getHomeBounds:function(){return this._homeBounds.clone()},getContentFactor:function(){return this._contentFactor},setAutoRefigureSizes:function(Tr){this._autoRefigureSizes=Tr,Tr&this._needsSizesFigured&&(this._figureSizes(),this._needsSizesFigured=!1)},arrange:function(Tr){Tr=Tr||{};var Ar=Tr.immediately||!1,Rr=Tr.layout||_r.DEFAULT_SETTINGS.collectionLayout,Pr=Tr.rows||_r.DEFAULT_SETTINGS.collectionRows,Dr=Tr.columns||_r.DEFAULT_SETTINGS.collectionColumns,Mr=Tr.tileSize||_r.DEFAULT_SETTINGS.collectionTileSize,Fr=Tr.tileMargin||_r.DEFAULT_SETTINGS.collectionTileMargin,zr=Mr+Fr,jr;!Tr.rows&&Dr?jr=Dr:jr=Math.ceil(this._items.length/Pr);var Gr=0,Nr=0,Lr,Ur,Vr,Wr,qr;this.setAutoRefigureSizes(!1);for(var Kr=0;Kr<this._items.length;Kr++)Kr&&Kr%jr===0&&(Rr==="horizontal"?(Nr+=zr,Gr=0):(Gr+=zr,Nr=0)),Lr=this._items[Kr],Ur=Lr.getBounds(),Ur.width>Ur.height?Vr=Mr:Vr=Mr*(Ur.width/Ur.height),Wr=Vr*(Ur.height/Ur.width),qr=new _r.Point(Gr+(Mr-Vr)/2,Nr+(Mr-Wr)/2),Lr.setPosition(qr,Ar),Lr.setWidth(Vr,Ar),Rr==="horizontal"?Gr+=zr:Nr+=zr;this.setAutoRefigureSizes(!0)},_figureSizes:function(){var Tr=this._homeBounds?this._homeBounds.clone():null,Ar=this._contentSize?this._contentSize.clone():null,Rr=this._contentFactor||0;if(!this._items.length)this._homeBounds=new _r.Rect(0,0,1,1),this._contentSize=new _r.Point(1,1),this._contentFactor=1;else{var Pr=this._items[0],Dr=Pr.getBounds();this._contentFactor=Pr.getContentSize().x/Dr.width;for(var Mr=Pr.getClippedBounds().getBoundingBox(),Fr=Mr.x,zr=Mr.y,jr=Mr.x+Mr.width,Gr=Mr.y+Mr.height,Nr=1;Nr<this._items.length;Nr++)Pr=this._items[Nr],Dr=Pr.getBounds(),this._contentFactor=Math.max(this._contentFactor,Pr.getContentSize().x/Dr.width),Mr=Pr.getClippedBounds().getBoundingBox(),Fr=Math.min(Fr,Mr.x),zr=Math.min(zr,Mr.y),jr=Math.max(jr,Mr.x+Mr.width),Gr=Math.max(Gr,Mr.y+Mr.height);this._homeBounds=new _r.Rect(Fr,zr,jr-Fr,Gr-zr),this._contentSize=new _r.Point(this._homeBounds.width*this._contentFactor,this._homeBounds.height*this._contentFactor)}(this._contentFactor!==Rr||!this._homeBounds.equals(Tr)||!this._contentSize.equals(Ar))&&this.raiseEvent("metrics-change",{})},_raiseRemoveItem:function(Tr){this.raiseEvent("remove-item",{item:Tr})}})}(OpenSeadragon)})(openseadragon);var openseadragonExports=openseadragon.exports;const Q=getDefaultExportFromCjs$1(openseadragonExports);function $ae6933e535247d3d$export$7d15b64cf5a3a4c4(_r,[Tr,Ar]){return Math.min(Ar,Math.max(Tr,_r))}const $ea1ef594cf570d83$export$439d29a4e110a164=reactExports.forwardRef((_r,Tr)=>reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.span,_extends$1({},_r,{ref:Tr,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",..._r.style}}))),$cc7e05a45900e73f$var$OPEN_KEYS=[" ","Enter","ArrowUp","ArrowDown"],$cc7e05a45900e73f$var$SELECTION_KEYS=[" ","Enter"],$cc7e05a45900e73f$var$SELECT_NAME="Select",[$cc7e05a45900e73f$var$Collection,$cc7e05a45900e73f$var$useCollection,$cc7e05a45900e73f$var$createCollectionScope]=$e02a7d9cb1dc128c$export$c74125a8e3af6bb2($cc7e05a45900e73f$var$SELECT_NAME),[$cc7e05a45900e73f$var$createSelectContext,$cc7e05a45900e73f$export$286727a75dc039bd]=$c512c27ab02ef895$export$50c7b4e9d9f19c1($cc7e05a45900e73f$var$SELECT_NAME,[$cc7e05a45900e73f$var$createCollectionScope,$cf1ac5d9fe0e8206$export$722aac194ae923]),$cc7e05a45900e73f$var$usePopperScope=$cf1ac5d9fe0e8206$export$722aac194ae923(),[$cc7e05a45900e73f$var$SelectProvider,$cc7e05a45900e73f$var$useSelectContext]=$cc7e05a45900e73f$var$createSelectContext($cc7e05a45900e73f$var$SELECT_NAME),[$cc7e05a45900e73f$var$SelectNativeOptionsProvider,$cc7e05a45900e73f$var$useSelectNativeOptionsContext]=$cc7e05a45900e73f$var$createSelectContext($cc7e05a45900e73f$var$SELECT_NAME),$cc7e05a45900e73f$export$ef9b1a59e592288f=_r=>{const{__scopeSelect:Tr,children:Ar,open:Rr,defaultOpen:Pr,onOpenChange:Dr,value:Mr,defaultValue:Fr,onValueChange:zr,dir:jr,name:Gr,autoComplete:Nr,disabled:Lr,required:Ur}=_r,Vr=$cc7e05a45900e73f$var$usePopperScope(Tr),[Wr,qr]=reactExports.useState(null),[Kr,Xr]=reactExports.useState(null),[Zr,_i]=reactExports.useState(!1),Jr=$f631663db3294ace$export$b39126d51d94e6f3(jr),[es=!1,ts]=$71cd76cc60e0454e$export$6f32135080cb4c3({prop:Rr,defaultProp:Pr,onChange:Dr}),[is,rs]=$71cd76cc60e0454e$export$6f32135080cb4c3({prop:Mr,defaultProp:Fr,onChange:zr}),as=reactExports.useRef(null),ls=Wr?!!Wr.closest("form"):!0,[fs,Ts]=reactExports.useState(new Set),$s=Array.from(fs).map(xs=>xs.props.value).join(";");return reactExports.createElement($cf1ac5d9fe0e8206$export$be92b6f5f03c0fe9,Vr,reactExports.createElement($cc7e05a45900e73f$var$SelectProvider,{required:Ur,scope:Tr,trigger:Wr,onTriggerChange:qr,valueNode:Kr,onValueNodeChange:Xr,valueNodeHasChildren:Zr,onValueNodeHasChildrenChange:_i,contentId:$1746a345f3d73bb7$export$f680877a34711e37(),value:is,onValueChange:rs,open:es,onOpenChange:ts,dir:Jr,triggerPointerDownPosRef:as,disabled:Lr},reactExports.createElement($cc7e05a45900e73f$var$Collection.Provider,{scope:Tr},reactExports.createElement($cc7e05a45900e73f$var$SelectNativeOptionsProvider,{scope:_r.__scopeSelect,onNativeOptionAdd:reactExports.useCallback(xs=>{Ts(ys=>new Set(ys).add(xs))},[]),onNativeOptionRemove:reactExports.useCallback(xs=>{Ts(ys=>{const ps=new Set(ys);return ps.delete(xs),ps})},[])},Ar)),ls?reactExports.createElement($cc7e05a45900e73f$var$BubbleSelect,{key:$s,"aria-hidden":!0,required:Ur,tabIndex:-1,name:Gr,autoComplete:Nr,value:is,onChange:xs=>rs(xs.target.value),disabled:Lr},is===void 0?reactExports.createElement("option",{value:""}):null,Array.from(fs)):null))},$cc7e05a45900e73f$var$TRIGGER_NAME="SelectTrigger",$cc7e05a45900e73f$export$3ac1e88a1c0b9f1=reactExports.forwardRef((_r,Tr)=>{const{__scopeSelect:Ar,disabled:Rr=!1,...Pr}=_r,Dr=$cc7e05a45900e73f$var$usePopperScope(Ar),Mr=$cc7e05a45900e73f$var$useSelectContext($cc7e05a45900e73f$var$TRIGGER_NAME,Ar),Fr=Mr.disabled||Rr,zr=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(Tr,Mr.onTriggerChange),jr=$cc7e05a45900e73f$var$useCollection(Ar),[Gr,Nr,Lr]=$cc7e05a45900e73f$var$useTypeaheadSearch(Vr=>{const Wr=jr().filter(Xr=>!Xr.disabled),qr=Wr.find(Xr=>Xr.value===Mr.value),Kr=$cc7e05a45900e73f$var$findNextItem(Wr,Vr,qr);Kr!==void 0&&Mr.onValueChange(Kr.value)}),Ur=()=>{Fr||(Mr.onOpenChange(!0),Lr())};return reactExports.createElement($cf1ac5d9fe0e8206$export$b688253958b8dfe7,_extends$1({asChild:!0},Dr),reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.button,_extends$1({type:"button",role:"combobox","aria-controls":Mr.contentId,"aria-expanded":Mr.open,"aria-required":Mr.required,"aria-autocomplete":"none",dir:Mr.dir,"data-state":Mr.open?"open":"closed",disabled:Fr,"data-disabled":Fr?"":void 0,"data-placeholder":Mr.value===void 0?"":void 0},Pr,{ref:zr,onClick:$e42e1063c40fb3ef$export$b9ecd428b558ff10(Pr.onClick,Vr=>{Vr.currentTarget.focus()}),onPointerDown:$e42e1063c40fb3ef$export$b9ecd428b558ff10(Pr.onPointerDown,Vr=>{const Wr=Vr.target;Wr.hasPointerCapture(Vr.pointerId)&&Wr.releasePointerCapture(Vr.pointerId),Vr.button===0&&Vr.ctrlKey===!1&&(Ur(),Mr.triggerPointerDownPosRef.current={x:Math.round(Vr.pageX),y:Math.round(Vr.pageY)},Vr.preventDefault())}),onKeyDown:$e42e1063c40fb3ef$export$b9ecd428b558ff10(Pr.onKeyDown,Vr=>{const Wr=Gr.current!=="";!(Vr.ctrlKey||Vr.altKey||Vr.metaKey)&&Vr.key.length===1&&Nr(Vr.key),!(Wr&&Vr.key===" ")&&$cc7e05a45900e73f$var$OPEN_KEYS.includes(Vr.key)&&(Ur(),Vr.preventDefault())})})))}),$cc7e05a45900e73f$var$VALUE_NAME="SelectValue",$cc7e05a45900e73f$export$e288731fd71264f0=reactExports.forwardRef((_r,Tr)=>{const{__scopeSelect:Ar,className:Rr,style:Pr,children:Dr,placeholder:Mr,...Fr}=_r,zr=$cc7e05a45900e73f$var$useSelectContext($cc7e05a45900e73f$var$VALUE_NAME,Ar),{onValueNodeHasChildrenChange:jr}=zr,Gr=Dr!==void 0,Nr=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(Tr,zr.onValueNodeChange);return $9f79659886946c16$export$e5c5a5f917a5871c(()=>{jr(Gr)},[jr,Gr]),reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.span,_extends$1({},Fr,{ref:Nr,style:{pointerEvents:"none"}}),zr.value===void 0&&Mr!==void 0?Mr:Dr)}),$cc7e05a45900e73f$export$99b400cabb58c515=reactExports.forwardRef((_r,Tr)=>{const{__scopeSelect:Ar,children:Rr,...Pr}=_r;return reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.span,_extends$1({"aria-hidden":!0},Pr,{ref:Tr}),Rr||"")}),$cc7e05a45900e73f$var$CONTENT_NAME="SelectContent",$cc7e05a45900e73f$export$c973a4b3cb86a03d=reactExports.forwardRef((_r,Tr)=>{const Ar=$cc7e05a45900e73f$var$useSelectContext($cc7e05a45900e73f$var$CONTENT_NAME,_r.__scopeSelect),[Rr,Pr]=reactExports.useState();if($9f79659886946c16$export$e5c5a5f917a5871c(()=>{Pr(new DocumentFragment)},[]),!Ar.open){const Dr=Rr;return Dr?reactDomExports.createPortal(reactExports.createElement($cc7e05a45900e73f$var$SelectContentProvider,{scope:_r.__scopeSelect},reactExports.createElement($cc7e05a45900e73f$var$Collection.Slot,{scope:_r.__scopeSelect},reactExports.createElement("div",null,_r.children))),Dr):null}return reactExports.createElement($cc7e05a45900e73f$var$SelectContentImpl,_extends$1({},_r,{ref:Tr}))}),$cc7e05a45900e73f$var$CONTENT_MARGIN=10,[$cc7e05a45900e73f$var$SelectContentProvider,$cc7e05a45900e73f$var$useSelectContentContext]=$cc7e05a45900e73f$var$createSelectContext($cc7e05a45900e73f$var$CONTENT_NAME),$cc7e05a45900e73f$var$SelectContentImpl=reactExports.forwardRef((_r,Tr)=>{const{__scopeSelect:Ar,position:Rr="item-aligned",onCloseAutoFocus:Pr,onEscapeKeyDown:Dr,onPointerDownOutside:Mr,side:Fr,sideOffset:zr,align:jr,alignOffset:Gr,arrowPadding:Nr,collisionBoundary:Lr,collisionPadding:Ur,sticky:Vr,hideWhenDetached:Wr,avoidCollisions:qr,...Kr}=_r,Xr=$cc7e05a45900e73f$var$useSelectContext($cc7e05a45900e73f$var$CONTENT_NAME,Ar),[Zr,_i]=reactExports.useState(null),[Jr,es]=reactExports.useState(null),ts=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(Tr,Js=>_i(Js)),[is,rs]=reactExports.useState(null),[as,ls]=reactExports.useState(null),fs=$cc7e05a45900e73f$var$useCollection(Ar),[Ts,$s]=reactExports.useState(!1),xs=reactExports.useRef(!1);reactExports.useEffect(()=>{if(Zr)return hideOthers(Zr)},[Zr]),$3db38b7d1fb3fe6a$export$b7ece24a22aeda8c();const ys=reactExports.useCallback(Js=>{const[lo,...vo]=fs().map(Do=>Do.ref.current),[Ro]=vo.slice(-1),Co=document.activeElement;for(const Do of Js)if(Do===Co||(Do==null||Do.scrollIntoView({block:"nearest"}),Do===lo&&Jr&&(Jr.scrollTop=0),Do===Ro&&Jr&&(Jr.scrollTop=Jr.scrollHeight),Do==null||Do.focus(),document.activeElement!==Co))return},[fs,Jr]),ps=reactExports.useCallback(()=>ys([is,Zr]),[ys,is,Zr]);reactExports.useEffect(()=>{Ts&&ps()},[Ts,ps]);const{onOpenChange:vs,triggerPointerDownPosRef:Ds}=Xr;reactExports.useEffect(()=>{if(Zr){let Js={x:0,y:0};const lo=Ro=>{var Co,Do,ds,Os;Js={x:Math.abs(Math.round(Ro.pageX)-((Co=(Do=Ds.current)===null||Do===void 0?void 0:Do.x)!==null&&Co!==void 0?Co:0)),y:Math.abs(Math.round(Ro.pageY)-((ds=(Os=Ds.current)===null||Os===void 0?void 0:Os.y)!==null&&ds!==void 0?ds:0))}},vo=Ro=>{Js.x<=10&&Js.y<=10?Ro.preventDefault():Zr.contains(Ro.target)||vs(!1),document.removeEventListener("pointermove",lo),Ds.current=null};return Ds.current!==null&&(document.addEventListener("pointermove",lo),document.addEventListener("pointerup",vo,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",lo),document.removeEventListener("pointerup",vo,{capture:!0})}}},[Zr,vs,Ds]),reactExports.useEffect(()=>{const Js=()=>vs(!1);return window.addEventListener("blur",Js),window.addEventListener("resize",Js),()=>{window.removeEventListener("blur",Js),window.removeEventListener("resize",Js)}},[vs]);const[js,zs]=$cc7e05a45900e73f$var$useTypeaheadSearch(Js=>{const lo=fs().filter(Co=>!Co.disabled),vo=lo.find(Co=>Co.ref.current===document.activeElement),Ro=$cc7e05a45900e73f$var$findNextItem(lo,Js,vo);Ro&&setTimeout(()=>Ro.ref.current.focus())}),qs=reactExports.useCallback((Js,lo,vo)=>{const Ro=!xs.current&&!vo;(Xr.value!==void 0&&Xr.value===lo||Ro)&&(rs(Js),Ro&&(xs.current=!0))},[Xr.value]),fo=reactExports.useCallback(()=>Zr==null?void 0:Zr.focus(),[Zr]),Qs=reactExports.useCallback((Js,lo,vo)=>{const Ro=!xs.current&&!vo;(Xr.value!==void 0&&Xr.value===lo||Ro)&&ls(Js)},[Xr.value]),no=Rr==="popper"?$cc7e05a45900e73f$var$SelectPopperPosition:$cc7e05a45900e73f$var$SelectItemAlignedPosition,yo=no===$cc7e05a45900e73f$var$SelectPopperPosition?{side:Fr,sideOffset:zr,align:jr,alignOffset:Gr,arrowPadding:Nr,collisionBoundary:Lr,collisionPadding:Ur,sticky:Vr,hideWhenDetached:Wr,avoidCollisions:qr}:{};return reactExports.createElement($cc7e05a45900e73f$var$SelectContentProvider,{scope:Ar,content:Zr,viewport:Jr,onViewportChange:es,itemRefCallback:qs,selectedItem:is,onItemLeave:fo,itemTextRefCallback:Qs,focusSelectedItem:ps,selectedItemText:as,position:Rr,isPositioned:Ts,searchRef:js},reactExports.createElement($01b9c$RemoveScroll,{as:$5e63c961fc1ce211$export$8c6ed5c666ac1360,allowPinchZoom:!0},reactExports.createElement($d3863c46a17e8a28$export$20e40289641fbbb6,{asChild:!0,trapped:Xr.open,onMountAutoFocus:Js=>{Js.preventDefault()},onUnmountAutoFocus:$e42e1063c40fb3ef$export$b9ecd428b558ff10(Pr,Js=>{var lo;(lo=Xr.trigger)===null||lo===void 0||lo.focus({preventScroll:!0}),Js.preventDefault()})},reactExports.createElement($5cb92bef7577960e$export$177fb62ff3ec1f22,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:Dr,onPointerDownOutside:Mr,onFocusOutside:Js=>Js.preventDefault(),onDismiss:()=>Xr.onOpenChange(!1)},reactExports.createElement(no,_extends$1({role:"listbox",id:Xr.contentId,"data-state":Xr.open?"open":"closed",dir:Xr.dir,onContextMenu:Js=>Js.preventDefault()},Kr,yo,{onPlaced:()=>$s(!0),ref:ts,style:{display:"flex",flexDirection:"column",outline:"none",...Kr.style},onKeyDown:$e42e1063c40fb3ef$export$b9ecd428b558ff10(Kr.onKeyDown,Js=>{const lo=Js.ctrlKey||Js.altKey||Js.metaKey;if(Js.key==="Tab"&&Js.preventDefault(),!lo&&Js.key.length===1&&zs(Js.key),["ArrowUp","ArrowDown","Home","End"].includes(Js.key)){let Ro=fs().filter(Co=>!Co.disabled).map(Co=>Co.ref.current);if(["ArrowUp","End"].includes(Js.key)&&(Ro=Ro.slice().reverse()),["ArrowUp","ArrowDown"].includes(Js.key)){const Co=Js.target,Do=Ro.indexOf(Co);Ro=Ro.slice(Do+1)}setTimeout(()=>ys(Ro)),Js.preventDefault()}})}))))))}),$cc7e05a45900e73f$var$SelectItemAlignedPosition=reactExports.forwardRef((_r,Tr)=>{const{__scopeSelect:Ar,onPlaced:Rr,...Pr}=_r,Dr=$cc7e05a45900e73f$var$useSelectContext($cc7e05a45900e73f$var$CONTENT_NAME,Ar),Mr=$cc7e05a45900e73f$var$useSelectContentContext($cc7e05a45900e73f$var$CONTENT_NAME,Ar),[Fr,zr]=reactExports.useState(null),[jr,Gr]=reactExports.useState(null),Nr=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(Tr,ts=>Gr(ts)),Lr=$cc7e05a45900e73f$var$useCollection(Ar),Ur=reactExports.useRef(!1),Vr=reactExports.useRef(!0),{viewport:Wr,selectedItem:qr,selectedItemText:Kr,focusSelectedItem:Xr}=Mr,Zr=reactExports.useCallback(()=>{if(Dr.trigger&&Dr.valueNode&&Fr&&jr&&Wr&&qr&&Kr){const ts=Dr.trigger.getBoundingClientRect(),is=jr.getBoundingClientRect(),rs=Dr.valueNode.getBoundingClientRect(),as=Kr.getBoundingClientRect();if(Dr.dir!=="rtl"){const Co=as.left-is.left,Do=rs.left-Co,ds=ts.left-Do,Os=ts.width+ds,Ws=Math.max(Os,is.width),to=window.innerWidth-$cc7e05a45900e73f$var$CONTENT_MARGIN,io=$ae6933e535247d3d$export$7d15b64cf5a3a4c4(Do,[$cc7e05a45900e73f$var$CONTENT_MARGIN,to-Ws]);Fr.style.minWidth=Os+"px",Fr.style.left=io+"px"}else{const Co=is.right-as.right,Do=window.innerWidth-rs.right-Co,ds=window.innerWidth-ts.right-Do,Os=ts.width+ds,Ws=Math.max(Os,is.width),to=window.innerWidth-$cc7e05a45900e73f$var$CONTENT_MARGIN,io=$ae6933e535247d3d$export$7d15b64cf5a3a4c4(Do,[$cc7e05a45900e73f$var$CONTENT_MARGIN,to-Ws]);Fr.style.minWidth=Os+"px",Fr.style.right=io+"px"}const ls=Lr(),fs=window.innerHeight-$cc7e05a45900e73f$var$CONTENT_MARGIN*2,Ts=Wr.scrollHeight,$s=window.getComputedStyle(jr),xs=parseInt($s.borderTopWidth,10),ys=parseInt($s.paddingTop,10),ps=parseInt($s.borderBottomWidth,10),vs=parseInt($s.paddingBottom,10),Ds=xs+ys+Ts+vs+ps,js=Math.min(qr.offsetHeight*5,Ds),zs=window.getComputedStyle(Wr),qs=parseInt(zs.paddingTop,10),fo=parseInt(zs.paddingBottom,10),Qs=ts.top+ts.height/2-$cc7e05a45900e73f$var$CONTENT_MARGIN,no=fs-Qs,yo=qr.offsetHeight/2,Js=qr.offsetTop+yo,lo=xs+ys+Js,vo=Ds-lo;if(lo<=Qs){const Co=qr===ls[ls.length-1].ref.current;Fr.style.bottom="0px";const Do=jr.clientHeight-Wr.offsetTop-Wr.offsetHeight,ds=Math.max(no,yo+(Co?fo:0)+Do+ps),Os=lo+ds;Fr.style.height=Os+"px"}else{const Co=qr===ls[0].ref.current;Fr.style.top="0px";const ds=Math.max(Qs,xs+Wr.offsetTop+(Co?qs:0)+yo)+vo;Fr.style.height=ds+"px",Wr.scrollTop=lo-Qs+Wr.offsetTop}Fr.style.margin=`${$cc7e05a45900e73f$var$CONTENT_MARGIN}px 0`,Fr.style.minHeight=js+"px",Fr.style.maxHeight=fs+"px",Rr==null||Rr(),requestAnimationFrame(()=>Ur.current=!0)}},[Lr,Dr.trigger,Dr.valueNode,Fr,jr,Wr,qr,Kr,Dr.dir,Rr]);$9f79659886946c16$export$e5c5a5f917a5871c(()=>Zr(),[Zr]);const[_i,Jr]=reactExports.useState();$9f79659886946c16$export$e5c5a5f917a5871c(()=>{jr&&Jr(window.getComputedStyle(jr).zIndex)},[jr]);const es=reactExports.useCallback(ts=>{ts&&Vr.current===!0&&(Zr(),Xr==null||Xr(),Vr.current=!1)},[Zr,Xr]);return reactExports.createElement($cc7e05a45900e73f$var$SelectViewportProvider,{scope:Ar,contentWrapper:Fr,shouldExpandOnScrollRef:Ur,onScrollButtonChange:es},reactExports.createElement("div",{ref:zr,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:_i}},reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.div,_extends$1({},Pr,{ref:Nr,style:{boxSizing:"border-box",maxHeight:"100%",...Pr.style}}))))}),$cc7e05a45900e73f$var$SelectPopperPosition=reactExports.forwardRef((_r,Tr)=>{const{__scopeSelect:Ar,align:Rr="start",collisionPadding:Pr=$cc7e05a45900e73f$var$CONTENT_MARGIN,...Dr}=_r,Mr=$cc7e05a45900e73f$var$usePopperScope(Ar);return reactExports.createElement($cf1ac5d9fe0e8206$export$7c6e2c02157bb7d2,_extends$1({},Mr,Dr,{ref:Tr,align:Rr,collisionPadding:Pr,style:{boxSizing:"border-box",...Dr.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}}))}),[$cc7e05a45900e73f$var$SelectViewportProvider,$cc7e05a45900e73f$var$useSelectViewportContext]=$cc7e05a45900e73f$var$createSelectContext($cc7e05a45900e73f$var$CONTENT_NAME,{}),$cc7e05a45900e73f$var$VIEWPORT_NAME="SelectViewport",$cc7e05a45900e73f$export$9ed6e7b40248d36d=reactExports.forwardRef((_r,Tr)=>{const{__scopeSelect:Ar,...Rr}=_r,Pr=$cc7e05a45900e73f$var$useSelectContentContext($cc7e05a45900e73f$var$VIEWPORT_NAME,Ar),Dr=$cc7e05a45900e73f$var$useSelectViewportContext($cc7e05a45900e73f$var$VIEWPORT_NAME,Ar),Mr=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(Tr,Pr.onViewportChange),Fr=reactExports.useRef(0);return reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"}}),reactExports.createElement($cc7e05a45900e73f$var$Collection.Slot,{scope:Ar},reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.div,_extends$1({"data-radix-select-viewport":"",role:"presentation"},Rr,{ref:Mr,style:{position:"relative",flex:1,overflow:"auto",...Rr.style},onScroll:$e42e1063c40fb3ef$export$b9ecd428b558ff10(Rr.onScroll,zr=>{const jr=zr.currentTarget,{contentWrapper:Gr,shouldExpandOnScrollRef:Nr}=Dr;if(Nr!=null&&Nr.current&&Gr){const Lr=Math.abs(Fr.current-jr.scrollTop);if(Lr>0){const Ur=window.innerHeight-$cc7e05a45900e73f$var$CONTENT_MARGIN*2,Vr=parseFloat(Gr.style.minHeight),Wr=parseFloat(Gr.style.height),qr=Math.max(Vr,Wr);if(qr<Ur){const Kr=qr+Lr,Xr=Math.min(Ur,Kr),Zr=Kr-Xr;Gr.style.height=Xr+"px",Gr.style.bottom==="0px"&&(jr.scrollTop=Zr>0?Zr:0,Gr.style.justifyContent="flex-end")}}}Fr.current=jr.scrollTop})}))))}),$cc7e05a45900e73f$var$GROUP_NAME="SelectGroup",[$cc7e05a45900e73f$var$SelectGroupContextProvider,$cc7e05a45900e73f$var$useSelectGroupContext]=$cc7e05a45900e73f$var$createSelectContext($cc7e05a45900e73f$var$GROUP_NAME),$cc7e05a45900e73f$export$ee25a334c55de1f4=reactExports.forwardRef((_r,Tr)=>{const{__scopeSelect:Ar,...Rr}=_r,Pr=$1746a345f3d73bb7$export$f680877a34711e37();return reactExports.createElement($cc7e05a45900e73f$var$SelectGroupContextProvider,{scope:Ar,id:Pr},reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.div,_extends$1({role:"group","aria-labelledby":Pr},Rr,{ref:Tr})))}),$cc7e05a45900e73f$var$LABEL_NAME="SelectLabel",$cc7e05a45900e73f$export$f67338d29bd972f8=reactExports.forwardRef((_r,Tr)=>{const{__scopeSelect:Ar,...Rr}=_r,Pr=$cc7e05a45900e73f$var$useSelectGroupContext($cc7e05a45900e73f$var$LABEL_NAME,Ar);return reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.div,_extends$1({id:Pr.id},Rr,{ref:Tr}))}),$cc7e05a45900e73f$var$ITEM_NAME="SelectItem",[$cc7e05a45900e73f$var$SelectItemContextProvider,$cc7e05a45900e73f$var$useSelectItemContext]=$cc7e05a45900e73f$var$createSelectContext($cc7e05a45900e73f$var$ITEM_NAME),$cc7e05a45900e73f$export$13ef48a934230896=reactExports.forwardRef((_r,Tr)=>{const{__scopeSelect:Ar,value:Rr,disabled:Pr=!1,textValue:Dr,...Mr}=_r,Fr=$cc7e05a45900e73f$var$useSelectContext($cc7e05a45900e73f$var$ITEM_NAME,Ar),zr=$cc7e05a45900e73f$var$useSelectContentContext($cc7e05a45900e73f$var$ITEM_NAME,Ar),jr=Fr.value===Rr,[Gr,Nr]=reactExports.useState(Dr??""),[Lr,Ur]=reactExports.useState(!1),Vr=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(Tr,Kr=>{var Xr;return(Xr=zr.itemRefCallback)===null||Xr===void 0?void 0:Xr.call(zr,Kr,Rr,Pr)}),Wr=$1746a345f3d73bb7$export$f680877a34711e37(),qr=()=>{Pr||(Fr.onValueChange(Rr),Fr.onOpenChange(!1))};return reactExports.createElement($cc7e05a45900e73f$var$SelectItemContextProvider,{scope:Ar,value:Rr,disabled:Pr,textId:Wr,isSelected:jr,onItemTextChange:reactExports.useCallback(Kr=>{Nr(Xr=>{var Zr;return Xr||((Zr=Kr==null?void 0:Kr.textContent)!==null&&Zr!==void 0?Zr:"").trim()})},[])},reactExports.createElement($cc7e05a45900e73f$var$Collection.ItemSlot,{scope:Ar,value:Rr,disabled:Pr,textValue:Gr},reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.div,_extends$1({role:"option","aria-labelledby":Wr,"data-highlighted":Lr?"":void 0,"aria-selected":jr&&Lr,"data-state":jr?"checked":"unchecked","aria-disabled":Pr||void 0,"data-disabled":Pr?"":void 0,tabIndex:Pr?void 0:-1},Mr,{ref:Vr,onFocus:$e42e1063c40fb3ef$export$b9ecd428b558ff10(Mr.onFocus,()=>Ur(!0)),onBlur:$e42e1063c40fb3ef$export$b9ecd428b558ff10(Mr.onBlur,()=>Ur(!1)),onPointerUp:$e42e1063c40fb3ef$export$b9ecd428b558ff10(Mr.onPointerUp,qr),onPointerMove:$e42e1063c40fb3ef$export$b9ecd428b558ff10(Mr.onPointerMove,Kr=>{if(Pr){var Xr;(Xr=zr.onItemLeave)===null||Xr===void 0||Xr.call(zr)}else Kr.currentTarget.focus({preventScroll:!0})}),onPointerLeave:$e42e1063c40fb3ef$export$b9ecd428b558ff10(Mr.onPointerLeave,Kr=>{if(Kr.currentTarget===document.activeElement){var Xr;(Xr=zr.onItemLeave)===null||Xr===void 0||Xr.call(zr)}}),onKeyDown:$e42e1063c40fb3ef$export$b9ecd428b558ff10(Mr.onKeyDown,Kr=>{var Xr;((Xr=zr.searchRef)===null||Xr===void 0?void 0:Xr.current)!==""&&Kr.key===" "||($cc7e05a45900e73f$var$SELECTION_KEYS.includes(Kr.key)&&qr(),Kr.key===" "&&Kr.preventDefault())})}))))}),$cc7e05a45900e73f$var$ITEM_TEXT_NAME="SelectItemText",$cc7e05a45900e73f$export$3572fb0fb821ff49=reactExports.forwardRef((_r,Tr)=>{const{__scopeSelect:Ar,className:Rr,style:Pr,...Dr}=_r,Mr=$cc7e05a45900e73f$var$useSelectContext($cc7e05a45900e73f$var$ITEM_TEXT_NAME,Ar),Fr=$cc7e05a45900e73f$var$useSelectContentContext($cc7e05a45900e73f$var$ITEM_TEXT_NAME,Ar),zr=$cc7e05a45900e73f$var$useSelectItemContext($cc7e05a45900e73f$var$ITEM_TEXT_NAME,Ar),jr=$cc7e05a45900e73f$var$useSelectNativeOptionsContext($cc7e05a45900e73f$var$ITEM_TEXT_NAME,Ar),[Gr,Nr]=reactExports.useState(null),Lr=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(Tr,Kr=>Nr(Kr),zr.onItemTextChange,Kr=>{var Xr;return(Xr=Fr.itemTextRefCallback)===null||Xr===void 0?void 0:Xr.call(Fr,Kr,zr.value,zr.disabled)}),Ur=Gr==null?void 0:Gr.textContent,Vr=reactExports.useMemo(()=>reactExports.createElement("option",{key:zr.value,value:zr.value,disabled:zr.disabled},Ur),[zr.disabled,zr.value,Ur]),{onNativeOptionAdd:Wr,onNativeOptionRemove:qr}=jr;return $9f79659886946c16$export$e5c5a5f917a5871c(()=>(Wr(Vr),()=>qr(Vr)),[Wr,qr,Vr]),reactExports.createElement(reactExports.Fragment,null,reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.span,_extends$1({id:zr.textId},Dr,{ref:Lr})),zr.isSelected&&Mr.valueNode&&!Mr.valueNodeHasChildren?reactDomExports.createPortal(Dr.children,Mr.valueNode):null)}),$cc7e05a45900e73f$var$ITEM_INDICATOR_NAME="SelectItemIndicator",$cc7e05a45900e73f$export$6b9198de19accfe6=reactExports.forwardRef((_r,Tr)=>{const{__scopeSelect:Ar,...Rr}=_r;return $cc7e05a45900e73f$var$useSelectItemContext($cc7e05a45900e73f$var$ITEM_INDICATOR_NAME,Ar).isSelected?reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.span,_extends$1({"aria-hidden":!0},Rr,{ref:Tr})):null}),$cc7e05a45900e73f$var$SCROLL_UP_BUTTON_NAME="SelectScrollUpButton",$cc7e05a45900e73f$export$d8117927658af6d7=reactExports.forwardRef((_r,Tr)=>{const Ar=$cc7e05a45900e73f$var$useSelectContentContext($cc7e05a45900e73f$var$SCROLL_UP_BUTTON_NAME,_r.__scopeSelect),Rr=$cc7e05a45900e73f$var$useSelectViewportContext($cc7e05a45900e73f$var$SCROLL_UP_BUTTON_NAME,_r.__scopeSelect),[Pr,Dr]=reactExports.useState(!1),Mr=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(Tr,Rr.onScrollButtonChange);return $9f79659886946c16$export$e5c5a5f917a5871c(()=>{if(Ar.viewport&&Ar.isPositioned){let jr=function(){const Gr=zr.scrollTop>0;Dr(Gr)};var Fr=jr;const zr=Ar.viewport;return jr(),zr.addEventListener("scroll",jr),()=>zr.removeEventListener("scroll",jr)}},[Ar.viewport,Ar.isPositioned]),Pr?reactExports.createElement($cc7e05a45900e73f$var$SelectScrollButtonImpl,_extends$1({},_r,{ref:Mr,onAutoScroll:()=>{const{viewport:Fr,selectedItem:zr}=Ar;Fr&&zr&&(Fr.scrollTop=Fr.scrollTop-zr.offsetHeight)}})):null}),$cc7e05a45900e73f$var$SCROLL_DOWN_BUTTON_NAME="SelectScrollDownButton",$cc7e05a45900e73f$export$ff951e476c12189=reactExports.forwardRef((_r,Tr)=>{const Ar=$cc7e05a45900e73f$var$useSelectContentContext($cc7e05a45900e73f$var$SCROLL_DOWN_BUTTON_NAME,_r.__scopeSelect),Rr=$cc7e05a45900e73f$var$useSelectViewportContext($cc7e05a45900e73f$var$SCROLL_DOWN_BUTTON_NAME,_r.__scopeSelect),[Pr,Dr]=reactExports.useState(!1),Mr=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(Tr,Rr.onScrollButtonChange);return $9f79659886946c16$export$e5c5a5f917a5871c(()=>{if(Ar.viewport&&Ar.isPositioned){let jr=function(){const Gr=zr.scrollHeight-zr.clientHeight,Nr=Math.ceil(zr.scrollTop)<Gr;Dr(Nr)};var Fr=jr;const zr=Ar.viewport;return jr(),zr.addEventListener("scroll",jr),()=>zr.removeEventListener("scroll",jr)}},[Ar.viewport,Ar.isPositioned]),Pr?reactExports.createElement($cc7e05a45900e73f$var$SelectScrollButtonImpl,_extends$1({},_r,{ref:Mr,onAutoScroll:()=>{const{viewport:Fr,selectedItem:zr}=Ar;Fr&&zr&&(Fr.scrollTop=Fr.scrollTop+zr.offsetHeight)}})):null}),$cc7e05a45900e73f$var$SelectScrollButtonImpl=reactExports.forwardRef((_r,Tr)=>{const{__scopeSelect:Ar,onAutoScroll:Rr,...Pr}=_r,Dr=$cc7e05a45900e73f$var$useSelectContentContext("SelectScrollButton",Ar),Mr=reactExports.useRef(null),Fr=$cc7e05a45900e73f$var$useCollection(Ar),zr=reactExports.useCallback(()=>{Mr.current!==null&&(window.clearInterval(Mr.current),Mr.current=null)},[]);return reactExports.useEffect(()=>()=>zr(),[zr]),$9f79659886946c16$export$e5c5a5f917a5871c(()=>{var jr;const Gr=Fr().find(Nr=>Nr.ref.current===document.activeElement);Gr==null||(jr=Gr.ref.current)===null||jr===void 0||jr.scrollIntoView({block:"nearest"})},[Fr]),reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.div,_extends$1({"aria-hidden":!0},Pr,{ref:Tr,style:{flexShrink:0,...Pr.style},onPointerDown:$e42e1063c40fb3ef$export$b9ecd428b558ff10(Pr.onPointerDown,()=>{Mr.current===null&&(Mr.current=window.setInterval(Rr,50))}),onPointerMove:$e42e1063c40fb3ef$export$b9ecd428b558ff10(Pr.onPointerMove,()=>{var jr;(jr=Dr.onItemLeave)===null||jr===void 0||jr.call(Dr),Mr.current===null&&(Mr.current=window.setInterval(Rr,50))}),onPointerLeave:$e42e1063c40fb3ef$export$b9ecd428b558ff10(Pr.onPointerLeave,()=>{zr()})}))}),$cc7e05a45900e73f$var$BubbleSelect=reactExports.forwardRef((_r,Tr)=>{const{value:Ar,...Rr}=_r,Pr=reactExports.useRef(null),Dr=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(Tr,Pr),Mr=$010c2913dbd2fe3d$export$5cae361ad82dce8b(Ar);return reactExports.useEffect(()=>{const Fr=Pr.current,zr=window.HTMLSelectElement.prototype,Gr=Object.getOwnPropertyDescriptor(zr,"value").set;if(Mr!==Ar&&Gr){const Nr=new Event("change",{bubbles:!0});Gr.call(Fr,Ar),Fr.dispatchEvent(Nr)}},[Mr,Ar]),reactExports.createElement($ea1ef594cf570d83$export$439d29a4e110a164,{asChild:!0},reactExports.createElement("select",_extends$1({},Rr,{ref:Dr,defaultValue:Ar})))});$cc7e05a45900e73f$var$BubbleSelect.displayName="BubbleSelect";function $cc7e05a45900e73f$var$useTypeaheadSearch(_r){const Tr=$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(_r),Ar=reactExports.useRef(""),Rr=reactExports.useRef(0),Pr=reactExports.useCallback(Mr=>{const Fr=Ar.current+Mr;Tr(Fr),function zr(jr){Ar.current=jr,window.clearTimeout(Rr.current),jr!==""&&(Rr.current=window.setTimeout(()=>zr(""),1e3))}(Fr)},[Tr]),Dr=reactExports.useCallback(()=>{Ar.current="",window.clearTimeout(Rr.current)},[]);return reactExports.useEffect(()=>()=>window.clearTimeout(Rr.current),[]),[Ar,Pr,Dr]}function $cc7e05a45900e73f$var$findNextItem(_r,Tr,Ar){const Pr=Tr.length>1&&Array.from(Tr).every(jr=>jr===Tr[0])?Tr[0]:Tr,Dr=Ar?_r.indexOf(Ar):-1;let Mr=$cc7e05a45900e73f$var$wrapArray(_r,Math.max(Dr,0));Pr.length===1&&(Mr=Mr.filter(jr=>jr!==Ar));const zr=Mr.find(jr=>jr.textValue.toLowerCase().startsWith(Pr.toLowerCase()));return zr!==Ar?zr:void 0}function $cc7e05a45900e73f$var$wrapArray(_r,Tr){return _r.map((Ar,Rr)=>_r[(Tr+Rr)%_r.length])}const $cc7e05a45900e73f$export$be92b6f5f03c0fe9=$cc7e05a45900e73f$export$ef9b1a59e592288f,$cc7e05a45900e73f$export$41fb9f06171c75f4=$cc7e05a45900e73f$export$3ac1e88a1c0b9f1,$cc7e05a45900e73f$export$4c8d1a57a761ef94=$cc7e05a45900e73f$export$e288731fd71264f0,$cc7e05a45900e73f$export$f04a61298a47a40f=$cc7e05a45900e73f$export$99b400cabb58c515,$cc7e05a45900e73f$export$7c6e2c02157bb7d2=$cc7e05a45900e73f$export$c973a4b3cb86a03d,$cc7e05a45900e73f$export$d5c6c08dc2d3ca7=$cc7e05a45900e73f$export$9ed6e7b40248d36d,$cc7e05a45900e73f$export$eb2fcfdbd7ba97d4=$cc7e05a45900e73f$export$ee25a334c55de1f4,$cc7e05a45900e73f$export$b04be29aa201d4f5=$cc7e05a45900e73f$export$f67338d29bd972f8,$cc7e05a45900e73f$export$6d08773d2e66f8f2=$cc7e05a45900e73f$export$13ef48a934230896,$cc7e05a45900e73f$export$d6e5bf9c43ea9319=$cc7e05a45900e73f$export$3572fb0fb821ff49,$cc7e05a45900e73f$export$c3468e2714d175fa=$cc7e05a45900e73f$export$6b9198de19accfe6,$cc7e05a45900e73f$export$2f60d3ec9ad468f2=$cc7e05a45900e73f$export$d8117927658af6d7,$cc7e05a45900e73f$export$bf1aedc3039c8d63=$cc7e05a45900e73f$export$ff951e476c12189,$6be4966fd9bbc698$var$SWITCH_NAME="Switch",[$6be4966fd9bbc698$var$createSwitchContext,$6be4966fd9bbc698$export$cf7f5f17f69cbd43]=$c512c27ab02ef895$export$50c7b4e9d9f19c1($6be4966fd9bbc698$var$SWITCH_NAME),[$6be4966fd9bbc698$var$SwitchProvider,$6be4966fd9bbc698$var$useSwitchContext]=$6be4966fd9bbc698$var$createSwitchContext($6be4966fd9bbc698$var$SWITCH_NAME),$6be4966fd9bbc698$export$b5d5cf8927ab7262=reactExports.forwardRef((_r,Tr)=>{const{__scopeSwitch:Ar,name:Rr,checked:Pr,defaultChecked:Dr,required:Mr,disabled:Fr,value:zr="on",onCheckedChange:jr,...Gr}=_r,[Nr,Lr]=reactExports.useState(null),Ur=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(Tr,Xr=>Lr(Xr)),Vr=reactExports.useRef(!1),Wr=Nr?!!Nr.closest("form"):!0,[qr=!1,Kr]=$71cd76cc60e0454e$export$6f32135080cb4c3({prop:Pr,defaultProp:Dr,onChange:jr});return reactExports.createElement($6be4966fd9bbc698$var$SwitchProvider,{scope:Ar,checked:qr,disabled:Fr},reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.button,_extends$1({type:"button",role:"switch","aria-checked":qr,"aria-required":Mr,"data-state":$6be4966fd9bbc698$var$getState(qr),"data-disabled":Fr?"":void 0,disabled:Fr,value:zr},Gr,{ref:Ur,onClick:$e42e1063c40fb3ef$export$b9ecd428b558ff10(_r.onClick,Xr=>{Kr(Zr=>!Zr),Wr&&(Vr.current=Xr.isPropagationStopped(),Vr.current||Xr.stopPropagation())})})),Wr&&reactExports.createElement($6be4966fd9bbc698$var$BubbleInput,{control:Nr,bubbles:!Vr.current,name:Rr,value:zr,checked:qr,required:Mr,disabled:Fr,style:{transform:"translateX(-100%)"}}))}),$6be4966fd9bbc698$var$THUMB_NAME="SwitchThumb",$6be4966fd9bbc698$export$4d07bf653ea69106=reactExports.forwardRef((_r,Tr)=>{const{__scopeSwitch:Ar,...Rr}=_r,Pr=$6be4966fd9bbc698$var$useSwitchContext($6be4966fd9bbc698$var$THUMB_NAME,Ar);return reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.span,_extends$1({"data-state":$6be4966fd9bbc698$var$getState(Pr.checked),"data-disabled":Pr.disabled?"":void 0},Rr,{ref:Tr}))}),$6be4966fd9bbc698$var$BubbleInput=_r=>{const{control:Tr,checked:Ar,bubbles:Rr=!0,...Pr}=_r,Dr=reactExports.useRef(null),Mr=$010c2913dbd2fe3d$export$5cae361ad82dce8b(Ar),Fr=$db6c3485150b8e66$export$1ab7ae714698c4b8(Tr);return reactExports.useEffect(()=>{const zr=Dr.current,jr=window.HTMLInputElement.prototype,Nr=Object.getOwnPropertyDescriptor(jr,"checked").set;if(Mr!==Ar&&Nr){const Lr=new Event("click",{bubbles:Rr});Nr.call(zr,Ar),zr.dispatchEvent(Lr)}},[Mr,Ar,Rr]),reactExports.createElement("input",_extends$1({type:"checkbox","aria-hidden":!0,defaultChecked:Ar},Pr,{tabIndex:-1,ref:Dr,style:{..._r.style,...Fr,position:"absolute",pointerEvents:"none",opacity:0,margin:0}}))};function $6be4966fd9bbc698$var$getState(_r){return _r?"checked":"unchecked"}const $6be4966fd9bbc698$export$be92b6f5f03c0fe9=$6be4966fd9bbc698$export$b5d5cf8927ab7262,$6be4966fd9bbc698$export$6521433ed15a34db=$6be4966fd9bbc698$export$4d07bf653ea69106,Je=_r=>{var Tr=_r.toString().split(":"),Ar=Math.ceil(parseInt(Tr[0])),Rr=Math.ceil(parseInt(Tr[1])),Pr=Qe(Math.ceil(parseInt(Tr[2])),2);let Dr=`${Ar!==0&&Rr<10?(Rr+"").padStart(2,"0"):Rr}:${Pr}`;return Ar!==0&&(Dr=`${Ar}:${Dr}`),Dr},pe=_r=>{const Tr=new Date(_r*1e3).toISOString().substr(11,8);return Je(Tr)},ge=(_r,Tr)=>{if(typeof _r!="object"||_r===null)return Tr;for(const Ar in Tr)typeof Tr[Ar]=="object"&&Tr[Ar]!==null&&!Array.isArray(Tr[Ar])?(_r[Ar]||(_r[Ar]={}),_r[Ar]=ge(_r[Ar],Tr[Ar])):_r[Ar]=Tr[Ar];return _r},fe=(_r,Tr)=>Object.hasOwn(_r,Tr)?_r[Tr].toString():void 0,Qe=(_r,Tr)=>String(_r).padStart(Tr,"0"),H={background:"transparent",canvasBackgroundColor:"#6662",canvasHeight:"61.8vh",ignoreCaptionLabels:[],informationPanel:{open:!0,renderAbout:!0,renderSupplementing:!0,renderToggle:!0},openSeadragon:{},requestHeaders:{"Content-Type":"application/json"},showIIIFBadge:!0,showTitle:!0,withCredentials:!1};var ce;const W={activeCanvas:"",activeManifest:"",collection:{},configOptions:H,informationOpen:(ce=H==null?void 0:H.informationPanel)==null?void 0:ce.open,isLoaded:!1,vault:new Vault},he=React$1.createContext(W),xe=React$1.createContext(W);function et(_r,Tr){switch(Tr.type){case"updateActiveCanvas":return Tr.canvasId||(Tr.canvasId=""),{..._r,activeCanvas:Tr.canvasId};case"updateActiveManifest":return{..._r,activeManifest:Tr.manifestId};case"updateCollection":return{..._r,collection:Tr.collection};case"updateConfigOptions":return{..._r,configOptions:ge(_r.configOptions,Tr.configOptions)};case"updateInformationOpen":return{..._r,informationOpen:Tr.informationOpen};case"updateIsLoaded":return{..._r,isLoaded:Tr.isLoaded};default:throw new Error(`Unhandled action type: ${Tr.type}`)}}const tt=({initialState:_r=W,children:Tr})=>{const[Ar,Rr]=reactExports.useReducer(et,_r);return React$1.createElement(he.Provider,{value:Ar},React$1.createElement(xe.Provider,{value:Rr},Tr))};function k(){const _r=React$1.useContext(he);if(_r===void 0)throw new Error("useViewerState must be used within a ViewerProvider");return _r}function F(){const _r=React$1.useContext(xe);if(_r===void 0)throw new Error("useViewerDispatch must be used within a ViewerProvider");return _r}const ve=(_r,Tr,Ar,Rr)=>{var Pr,Dr;const Mr={canvas:void 0,accompanyingCanvas:void 0,annotationPage:void 0,annotations:[]},Fr=zr=>{if(zr){if(!zr.body||!zr.motivation){console.error("Invalid annotation after Hyperion parsing: missing either 'body' or 'motivation'",zr);return}let jr=zr.body;Array.isArray(jr)&&(jr=jr[0]);const Gr=_r.get(jr.id);if(!Gr)return;switch(Ar){case"painting":return zr.target===Tr.id&&zr.motivation&&zr.motivation[0]==="painting"&&Rr.includes(Gr.type)&&(zr.body=Gr),!!zr;case"supplementing":return;default:throw new Error("Invalid annotation motivation.")}}};return Mr.canvas=_r.get(Tr),Mr.canvas&&(Mr.annotationPage=_r.get(Mr.canvas.items[0]),Mr.accompanyingCanvas=(Pr=Mr.canvas)!=null&&Pr.accompanyingCanvas?_r.get((Dr=Mr.canvas)==null?void 0:Dr.accompanyingCanvas):void 0),Mr.annotationPage&&(Mr.annotations=_r.get(Mr.annotationPage.items).filter(Fr)),Mr},P=(_r,Tr="en")=>{if(!_r)return"";if(!_r[Tr]){const Ar=Object.getOwnPropertyNames(_r);if(Ar.length>0)return _r[Ar[0]]}return _r[Tr]},B=(_r,Tr)=>{const Ar=ve(_r,{id:Tr,type:"Canvas"},"painting",["Image","Sound","Video"]);if(Ar.annotations.length!==0&&Ar.annotations[0]&&Ar.annotations[0].body)return Ar.annotations[0].body},nt=(_r,Tr,Ar)=>{const Rr=_r.get({id:Tr,type:"Canvas"});if(!(Rr!=null&&Rr.annotations)||!Rr.annotations[0])return[];const Pr=_r.get(Rr.annotations[0]),Dr=_r.get(Pr.items);return Array.isArray(Dr)?Dr.filter(Mr=>{var Fr;if(Mr.body&&(Fr=Mr.motivation)!=null&&Fr.includes("supplementing")){let zr=Mr.body;Array.isArray(zr)&&(zr=zr[0]);const jr=_r.get(zr.id);if(jr.format===Ar)return Mr.body=jr,Mr}}).map(Mr=>Mr.body):[]},rt=(_r,Tr,Ar,Rr)=>{let Pr=[];if(Tr.canvas&&Tr.canvas.thumbnail.length>0){const Dr=_r.get(Tr.canvas.thumbnail[0]);Pr.push(Dr)}if(Tr.annotations[0]){if(Tr.annotations[0].thumbnail&&Tr.annotations[0].thumbnail.length>0){const Mr=_r.get(Tr.annotations[0].thumbnail[0]);Pr.push(Mr)}if(!Tr.annotations[0].body)return;const Dr=Tr.annotations[0].body;Dr.type==="Image"&&Pr.push(Dr)}return Pr.length===0?void 0:{id:Pr[0].id,format:Pr[0].format,type:Pr[0].type,width:Ar,height:Rr}},j=209,ot={colors:{primary:"#1a1d1e",primaryMuted:"#26292b",primaryAlt:"#151718",accent:`hsl(${j} 100% 38.2%)`,accentMuted:`hsl(${j} 80% 61.8%)`,accentAlt:`hsl(${j} 80% 30%)`,secondary:"#FFFFFF",secondaryMuted:"#e6e8eb",secondaryAlt:"#c1c8cd"},fontSizes:{1:"12px",2:"13px",3:"15px",4:"17px",5:"19px",6:"21px",7:"27px",8:"35px",9:"59px"},lineHeights:{1:"12px",2:"13px",3:"15px",4:"17px",5:"19px",6:"21px",7:"27px",8:"35px",9:"59px"},sizes:{1:"5px",2:"10px",3:"15px",4:"20px",5:"25px",6:"35px",7:"45px",8:"65px",9:"80px"},space:{1:"5px",2:"10px",3:"15px",4:"20px",5:"25px",6:"35px",7:"45px",8:"65px",9:"80px"},radii:{1:"4px",2:"6px",3:"8px",4:"12px",round:"50%",pill:"9999px"},transitions:{all:"all 300ms cubic-bezier(0.16, 1, 0.3, 1)"},zIndices:{1:"100",2:"200",3:"300",4:"400",max:"999"}},Z={xxs:"(max-width: 349px)",xs:"(max-width: 575px)",sm:"(max-width: 767px)",md:"(max-width: 991px)",lg:"(max-width: 90rem)",xl:"(min-width: calc(90rem + 1px))"},{styled:d,css:Hr,keyframes:X,createTheme:Br}=q$1({theme:ot,media:Z}),at=d("div",{display:"flex",flexDirection:"column",alignItems:"center"}),it=d("p",{fontWeight:"bold",fontSize:"x-large"}),lt=d("span",{fontSize:"medium"}),st=({error:_r})=>{const{message:Tr}=_r;return React$1.createElement(at,{role:"alert"},React$1.createElement(it,{"data-testid":"headline"},"Something went wrong"),Tr&&React$1.createElement(lt,null,`Error message: ${Tr}`," "))},be=d("div",{position:"relative",zIndex:"0"}),ye=d("div",{display:"flex",flexDirection:"row",overflow:"hidden","@sm":{flexDirection:"column"}}),Ee=d("div",{display:"flex",flexDirection:"column",flexGrow:"1",flexShrink:"1",width:"61.8%","@sm":{width:"100%"}}),we=d($409067139f391064$export$41fb9f06171c75f4,{display:"none",border:"none",padding:"0",transition:"$all",opacity:"1",background:"#6663",margin:"1rem 0",borderRadius:"6px","&[data-information-panel='false']":{opacity:"0",marginTop:"-59px"},"@sm":{display:"flex","> span":{display:"flex",flexGrow:"1",fontSize:"0.8333em",justifyContent:"center",padding:"0.5rem",fontFamily:"inherit"}}}),Ce=d($409067139f391064$export$7c6e2c02157bb7d2,{width:"100%",display:"flex"}),ct=d("aside",{display:"flex",flexGrow:"1",flexShrink:"0",width:"38.2%",maxHeight:"100%","@sm":{width:"100%"}}),dt=d("div",{display:"flex",flexDirection:"column",fontSmooth:"auto",webkitFontSmoothing:"antialiased","> div":{display:"flex",flexDirection:"column",flexGrow:"1",justifyContent:"flex-start","@sm":{[`& ${ye}`]:{flexGrow:"1"},[`& ${Ee}`]:{flexGrow:"0"}}},"@sm":{padding:"0"},"&[data-information-panel-open='true']":{"@sm":{position:"fixed",height:"100%",width:"100%",top:"0",left:"0",zIndex:"2500000000",[`& ${be}`]:{display:"none"},[`& ${we}`]:{margin:"1rem"},[`& ${Ce}`]:{height:"100%"}}}}),mt=d($69cb30bb0017df05$export$be92b6f5f03c0fe9,{display:"flex",flexDirection:"column",width:"100%",height:"100%",flexGrow:"1",flexShrink:"0",position:"relative",zIndex:"1",maskImage:"linear-gradient(180deg, rgba(0, 0, 0, 1) calc(100% - 2rem), transparent 100%)","@sm":{marginTop:"0.5rem",boxShadow:"none"}}),ut=d($69cb30bb0017df05$export$54c2e3dc7acea9f5,{display:"flex",flexGrow:"0",margin:"0 1.618rem",borderBottom:"4px solid #6663","@sm":{margin:"0 1rem"}}),ee=d($69cb30bb0017df05$export$41fb9f06171c75f4,{display:"flex",position:"relative",padding:"0.5rem 1rem",background:"none",backgroundColor:"transparent",fontFamily:"inherit",border:"none",opacity:"0.7",fontSize:"1rem",marginRight:"1rem",lineHeight:"1rem",whiteSpace:"nowrap",cursor:"pointer",fontWeight:400,transition:"$all","&::after":{width:"0",height:"4px",content:"",position:"absolute",bottom:"-4px",left:"0",transition:"$all"},"&[data-state='active']":{opacity:"1",fontWeight:700,"&::after":{width:"100%",backgroundColor:"$accent"}}}),te=d($69cb30bb0017df05$export$7c6e2c02157bb7d2,{display:"flex",flexGrow:"1",flexShrink:"0",position:"absolute",top:"0",left:"0","&[data-state='active']":{width:"100%",height:"calc(100% - 2rem)",padding:"1.618rem 0"}}),pt=d("div",{position:"relative",height:"100%",width:"100%",overflowY:"scroll"}),gt=d("div",{padding:" 0 1.618rem 2rem",display:"flex",flexDirection:"column",overflow:"scroll",position:"absolute",fontWeight:"400",fontSize:"1rem",zIndex:"0",img:{maxWidth:"100px",maxHeight:"100px",objectFit:"contain",color:"transparent",margin:"0 0 1rem",borderRadius:"3px",backgroundColor:"$secondaryMuted"},video:{display:"none"},"a, a:visited":{color:"$accent"},p:{fontSize:"1rem",lineHeight:"1.45em",margin:"0"},dl:{margin:"0",dt:{fontWeight:"700",margin:"1rem 0 0.25rem"},dd:{margin:"0"}},".manifest-property-title":{fontWeight:"700",margin:"1rem 0 0.25rem"},"ul, ol":{padding:"0",margin:"0",li:{fontSize:"1rem",lineHeight:"1.45em",listStyle:"none",margin:"0.25rem 0 0.25rem"}}}),ft=d("div",{position:"relative",width:"100%",height:"100%",zIndex:"0"}),Se=(_r,Tr="none")=>{if(!_r)return null;if(typeof _r=="string")return[_r];if(!_r[Tr]){const Ar=Object.getOwnPropertyNames(_r);if(Ar.length>0)return _r[Ar[0]]}return!_r[Tr]||!Array.isArray(_r[Tr])?null:_r[Tr]},M=(_r,Tr="none",Ar=", ")=>{const Rr=Se(_r,Tr);return Array.isArray(Rr)?Rr.join(`${Ar}`):Rr};function ht(_r){return{__html:xt(_r)}}function A(_r,Tr){const Ar=Object.keys(_r).filter(Pr=>Tr.includes(Pr)?null:Pr);let Rr=new Object;return Ar.forEach(Pr=>{Rr[Pr]=_r[Pr]}),Rr}function xt(_r){return Ye(_r,{allowedAttributes:{a:["href"],img:["alt","src","height","width"]},allowedSchemes:["http","https","mailto"],allowedTags:["a","b","br","i","img","p","small","span","sub","sup"]})}const vt=d("span",{}),z=_r=>{const{as:Tr,label:Ar}=_r;let Rr=A(_r,["as","label"]);return React$1.createElement(vt,{as:Tr,...Rr},M(Ar,Rr.lang))},bt=(_r,Tr="200,",Ar="full")=>{Array.isArray(_r)&&(_r=_r[0]);const{id:Rr,service:Pr}=_r;let Dr;if(!Pr)return Rr;if(Array.isArray(_r.service)&&_r.service.length>0&&(Dr=Pr[0]),Dr){if(Dr["@id"])return`${Dr["@id"]}/${Ar}/${Tr}/0/default.jpg`;if(Dr.id)return`${Dr.id}/${Ar}/${Tr}/0/default.jpg`}},ne=d("img",{objectFit:"cover"}),yt=_r=>{const Tr=reactExports.useRef(null),{contentResource:Ar,altAsLabel:Rr,region:Pr="full"}=_r;let Dr;Rr&&(Dr=M(Rr));const Mr=A(_r,["contentResource","altAsLabel"]),{type:Fr,id:zr,width:jr=200,height:Gr=200,format:Nr,duration:Lr}=Ar;reactExports.useEffect(()=>{if(!zr&&!Tr.current||["Image"].includes(Fr)||!zr.includes("m3u8"))return;const Vr=new Hls;return Tr.current&&(Vr.attachMedia(Tr.current),Vr.on(Hls.Events.MEDIA_ATTACHED,function(){Vr.loadSource(zr)})),Vr.on(Hls.Events.ERROR,function(Wr,qr){if(qr.fatal)switch(qr.type){case Hls.ErrorTypes.NETWORK_ERROR:console.error(`fatal ${Wr} network error encountered, try to recover`),Vr.startLoad();break;case Hls.ErrorTypes.MEDIA_ERROR:console.error(`fatal ${Wr} media error encountered, try to recover`),Vr.recoverMediaError();break;default:Vr.destroy();break}}),()=>{Vr&&(Vr.detachMedia(),Vr.destroy())}},[]),reactExports.useEffect(()=>Ur(),[]);const Ur=()=>{if(!Tr.current)return;let Vr=0,Wr=30;if(Lr&&(Wr=Lr),!zr.split("#t=")&&Lr&&(Vr=Lr*.1),zr.split("#t=").pop()){const Kr=zr.split("#t=").pop();Kr&&(Vr=parseInt(Kr.split(",")[0]))}const qr=Tr.current;qr.autoplay=!0,qr.currentTime=Vr,setTimeout(()=>Ur(),Wr*1e3)};switch(Fr){case"Image":const Vr=bt(Ar,`${jr},${Gr}`,Pr);return React$1.createElement(ne,{as:"img",alt:Dr,css:{width:jr,height:Gr},key:zr,src:Vr,...Mr});case"Video":return React$1.createElement(ne,{as:"video",css:{width:jr,height:Gr},disablePictureInPicture:!0,key:zr,loop:!0,muted:!0,onPause:Ur,ref:Tr,src:zr});default:return console.warn(`Resource type: ${Fr} is not valid or not yet supported in Primitives.`),React$1.createElement(React$1.Fragment,null)}},Et=d("a",{}),wt=_r=>{const{children:Tr,homepage:Ar}=_r,Rr=A(_r,["children","homepage"]);return React$1.createElement(React$1.Fragment,null,Ar&&Ar.map(Pr=>{const Dr=M(Pr.label,Rr.lang);return React$1.createElement(Et,{"aria-label":Tr?Dr:void 0,href:Pr.id,key:Pr.id,...Rr},Tr||Dr)}))},Ct={delimiter:", "},Y=reactExports.createContext(void 0),ke=()=>{const _r=reactExports.useContext(Y);if(_r===void 0)throw new Error("usePrimitivesContext must be used with a PrimitivesProvider");return _r},K=({children:_r,initialState:Tr=Ct})=>{const Ar=St(Tr,"delimiter");return React$1.createElement(Y.Provider,{value:{delimiter:Ar}},_r)},St=(_r,Tr)=>Object.hasOwn(_r,Tr)?_r[Tr].toString():void 0,kt=d("span",{}),re=_r=>{const{as:Tr,markup:Ar}=_r,{delimiter:Rr}=ke();if(!Ar)return React$1.createElement(React$1.Fragment,null);let Pr=A(_r,["as","markup"]);const Dr=ht(M(Ar,Pr.lang,Rr));return React$1.createElement(kt,{as:Tr,...Pr,dangerouslySetInnerHTML:Dr})},Ie=_r=>React$1.useContext(Y)?React$1.createElement(re,{..._r}):React$1.createElement(K,null,React$1.createElement(re,{..._r})),It=({as:_r="dd",lang:Tr,value:Ar})=>React$1.createElement(Ie,{markup:Ar,as:_r,lang:Tr}),$t=d("span",{}),Tt=({as:_r="dd",customValueContent:Tr,lang:Ar,value:Rr})=>{var Pr;const{delimiter:Dr}=ke(),Mr=(Pr=Se(Rr,Ar))==null?void 0:Pr.map(Fr=>reactExports.cloneElement(Tr,{value:Fr}));return React$1.createElement($t,{as:_r,lang:Ar},Mr==null?void 0:Mr.map((Fr,zr)=>[zr>0&&`${Dr}`,React$1.createElement(reactExports.Fragment,{key:zr},Fr)]))},$e=_r=>{var Tr;const{item:Ar,lang:Rr,customValueContent:Pr}=_r,{label:Dr,value:Mr}=Ar,Fr=(Tr=M(Dr))==null?void 0:Tr.replace(" ","-").toLowerCase();return React$1.createElement("div",{role:"group","data-label":Fr},React$1.createElement(z,{as:"dt",label:Dr,lang:Rr}),Pr?React$1.createElement(Tt,{as:"dd",customValueContent:Pr,value:Mr,lang:Rr}):React$1.createElement(It,{as:"dd",value:Mr,lang:Rr}))};function At(_r,Tr){const Ar=Tr.filter(Rr=>{const{matchingLabel:Pr}=Rr,Dr=Object.keys(Rr.matchingLabel)[0],Mr=M(Pr,Dr);if(M(_r,Dr)===Mr)return!0}).map(Rr=>Rr.Content);if(Array.isArray(Ar))return Ar[0]}const Mt=d("dl",{}),Rt=_r=>{const{as:Tr,customValueContent:Ar,metadata:Rr}=_r;if(!Array.isArray(Rr))return React$1.createElement(React$1.Fragment,null);const Pr=fe(_r,"customValueDelimiter");let Dr=A(_r,["as","customValueContent","customValueDelimiter","metadata"]);return React$1.createElement(K,{...typeof Pr=="string"?{initialState:{delimiter:Pr}}:void 0},Rr.length>0&&React$1.createElement(Mt,{as:Tr,...Dr},Rr.map((Mr,Fr)=>{const zr=Ar?At(Mr.label,Ar):void 0;return React$1.createElement($e,{customValueContent:zr,item:Mr,key:Fr,lang:Dr==null?void 0:Dr.lang})})))};d("li",{});d("ul",{});const zt=d("dl",{}),Lt=_r=>{const{as:Tr,requiredStatement:Ar}=_r;if(!Ar)return React$1.createElement(React$1.Fragment,null);const Rr=fe(_r,"customValueDelimiter");let Pr=A(_r,["as","customValueDelimiter","requiredStatement"]);return React$1.createElement(K,{...typeof Rr=="string"?{initialState:{delimiter:Rr}}:void 0},React$1.createElement(zt,{as:Tr,...Pr},React$1.createElement($e,{item:Ar,lang:Pr.lang})))},Ft=d("li",{}),Pt=d("ul",{}),Vt=_r=>{const{as:Tr,seeAlso:Ar}=_r,Rr=A(_r,["as","seeAlso"]);return React$1.createElement(Pt,{as:Tr},Ar&&Ar.map(Pr=>{const Dr=M(Pr.label,Rr.lang);return React$1.createElement(Ft,{key:Pr.id},React$1.createElement("a",{href:Pr.id,...Rr},Dr||Pr.id))}))},Ht=_r=>{const{as:Tr,summary:Ar}=_r;let Rr=A(_r,["as","customValueDelimiter","summary"]);return React$1.createElement(Ie,{as:Tr,markup:Ar,...Rr})},Te=_r=>{const{thumbnail:Tr,region:Ar}=_r,Rr=A(_r,["thumbnail"]);return React$1.createElement(React$1.Fragment,null,Tr&&Tr.map(Pr=>React$1.createElement(yt,{contentResource:Pr,key:Pr.id,region:Ar,...Rr})))},Bt=({homepage:_r})=>(_r==null?void 0:_r.length)===0?React$1.createElement(React$1.Fragment,null):React$1.createElement(React$1.Fragment,null,React$1.createElement("span",{className:"manifest-property-title"},"Homepage"),React$1.createElement(wt,{homepage:_r})),Ot=({id:_r,htmlLabel:Tr,parent:Ar="manifest"})=>React$1.createElement(React$1.Fragment,null,React$1.createElement("span",{className:"manifest-property-title"},Tr),React$1.createElement("a",{href:_r,target:"_blank",id:`iiif-${Ar}-id`},_r)),Dt=({metadata:_r,parent:Tr="manifest"})=>_r?React$1.createElement(React$1.Fragment,null,React$1.createElement(Rt,{metadata:_r,id:`iiif-${Tr}-metadata`})):React$1.createElement(React$1.Fragment,null),Wt=({requiredStatement:_r,parent:Tr="manifest"})=>_r?React$1.createElement(React$1.Fragment,null,React$1.createElement(Lt,{requiredStatement:_r,id:`iiif-${Tr}-required-statement`})):React$1.createElement(React$1.Fragment,null),jt=({rights:_r})=>_r?React$1.createElement(React$1.Fragment,null,React$1.createElement("span",{className:"manifest-property-title"},"Rights"),React$1.createElement("a",{href:_r,target:"_blank"},_r)):React$1.createElement(React$1.Fragment,null),Nt=({seeAlso:_r})=>(_r==null?void 0:_r.length)===0?React$1.createElement(React$1.Fragment,null):React$1.createElement(React$1.Fragment,null,React$1.createElement("span",{className:"manifest-property-title"},"See Also"),React$1.createElement(Vt,{seeAlso:_r})),Gt=({summary:_r,parent:Tr="manifest"})=>_r?React$1.createElement(React$1.Fragment,null,React$1.createElement(Ht,{summary:_r,as:"p",id:`iiif-${Tr}-summary`})):React$1.createElement(React$1.Fragment,null),qt=({label:_r,thumbnail:Tr})=>(Tr==null?void 0:Tr.length)===0?React$1.createElement(React$1.Fragment,null):React$1.createElement(React$1.Fragment,null,React$1.createElement(Te,{altAsLabel:_r||{none:["resource"]},thumbnail:Tr,style:{backgroundColor:"#6663",objectFit:"cover"}})),Ut=()=>{const _r=k(),{activeManifest:Tr,vault:Ar}=_r,[Rr,Pr]=reactExports.useState(),[Dr,Mr]=reactExports.useState([]),[Fr,zr]=reactExports.useState([]),[jr,Gr]=reactExports.useState([]);return reactExports.useEffect(()=>{var Nr,Lr,Ur;const Vr=Ar.get(Tr);Pr(Vr),((Nr=Vr.homepage)==null?void 0:Nr.length)>0&&Mr(Ar.get(Vr.homepage)),((Lr=Vr.seeAlso)==null?void 0:Lr.length)>0&&zr(Ar.get(Vr.seeAlso)),((Ur=Vr.thumbnail)==null?void 0:Ur.length)>0&&Gr(Ar.get(Vr.thumbnail))},[Tr,Ar]),Rr?React$1.createElement(ft,null,React$1.createElement(gt,null,React$1.createElement(qt,{thumbnail:jr,label:Rr.label}),React$1.createElement(Gt,{summary:Rr.summary}),React$1.createElement(Dt,{metadata:Rr.metadata}),React$1.createElement(Wt,{requiredStatement:Rr.requiredStatement}),React$1.createElement(jt,{rights:Rr.rights}),React$1.createElement(Bt,{homepage:Dr}),React$1.createElement(Nt,{seeAlso:Fr}),React$1.createElement(Ot,{id:Rr.id,htmlLabel:"IIIF Manifest"}))):React$1.createElement(React$1.Fragment,null)},_t=()=>{function _r(Pr){return Pr.map(Dr=>{const Mr=Dr.identifier||v4();return{...Dr,identifier:Mr}})}function Tr(Pr){var Dr;const Mr=[],Fr=[],zr=_r(Pr);for(const jr of zr){for(;Fr.length>0&&Fr[Fr.length-1].end<=jr.start;)Fr.pop();Fr.length>0?(Fr[Fr.length-1].children||(Fr[Fr.length-1].children=[]),(Dr=Fr[Fr.length-1].children)==null||Dr.push(jr),Fr.push(jr)):(Mr.push(jr),Fr.push(jr))}return Mr}function Ar(Pr,Dr=[]){return Dr.some(Mr=>Pr.start>=Mr.start&&Pr.end<=Mr.end)}function Rr(Pr=[]){return Pr.sort((Dr,Mr)=>Dr.start-Mr.start)}return{addIdentifiersToParsedCues:_r,createNestedCues:Tr,isChild:Ar,orderCuesByTime:Rr}},oe=X({from:{transform:"rotate(360deg)"},to:{transform:"rotate(0deg)"}}),Zt=d($f99a8c78507165f7$export$be92b6f5f03c0fe9,{display:"flex",flexDirection:"column",width:"100%"}),Ae=d($f99a8c78507165f7$export$6d08773d2e66f8f2,{position:"relative",cursor:"pointer",display:"flex",width:"100%",justifyContent:"space-between",textAlign:"left",margin:"0",padding:"0.5rem 1.618rem",fontFamily:"inherit",lineHeight:"1.25em",fontSize:"1rem",color:"inherit",border:"none",background:"none","@sm":{padding:"0.5rem 1rem",fontSize:"0.8333rem"},"&::before":{content:"",width:"12px",height:"12px",borderRadius:"12px",position:"absolute",backgroundColor:"$primaryMuted",opacity:"0",left:"8px",marginTop:"3px",boxSizing:"content-box","@sm":{content:"unset"}},"&::after":{content:"",width:"4px",height:"6px",position:"absolute",backgroundColor:"$secondary",opacity:"0",clipPath:"polygon(100% 50%, 0 100%, 0 0)",left:"13px",marginTop:"6px",boxSizing:"content-box","@sm":{content:"unset"}},strong:{marginLeft:"1rem"},"&:hover":{color:"$accent","&::before":{backgroundColor:"$accent",opacity:"1"},"&::after":{content:"",width:"4px",height:"6px",position:"absolute",backgroundColor:"$secondary",clipPath:"polygon(100% 50%, 0 100%, 0 0)",opacity:"1"}},"&[aria-checked='true']":{backgroundColor:"#6663","&::before":{content:"",width:"6px",height:"6px",position:"absolute",backgroundColor:"transparent",border:"3px solid $accentMuted",borderRadius:"12px",left:"8px",marginTop:"4px",opacity:"1",animation:"1s linear infinite",animationName:oe,boxSizing:"content-box","@sm":{content:"unset"}},"&::after":{content:"",width:"6px",height:"6px",position:"absolute",backgroundColor:"transparent",border:"3px solid $accent",clipPath:"polygon(100% 0, 100% 100%, 0 0)",borderRadius:"12px",left:"8px",marginTop:"4px",opacity:"1",animation:"1.5s linear infinite",animationName:oe,boxSizing:"content-box","@sm":{content:"unset"}}}}),Xt=({label:_r,start:Tr,end:Ar})=>{const[Rr,Pr]=reactExports.useState(!1),Dr=document.getElementById("clover-iiif-video");reactExports.useEffect(()=>(Dr==null||Dr.addEventListener("timeupdate",()=>{const{currentTime:Fr}=Dr;Pr(Tr<=Fr&&Fr<Ar)}),()=>document.removeEventListener("timeupdate",()=>{})),[Dr]);const Mr=()=>{Dr&&(Dr.pause(),Dr.currentTime=Tr,Dr.play())};return React$1.createElement(Ae,{"aria-checked":Rr,"data-testid":"information-panel-cue",onClick:Mr,value:_r},_r,React$1.createElement("strong",null,pe(Tr)))},Yt=d("ul",{listStyle:"none",paddingLeft:"1rem",position:"relative","&&:first-child":{paddingLeft:"0"},"& li ul":{[`& ${Ae}`]:{backgroundColor:"unset","&::before":{content:"none"},"&::after":{content:"none"}}},"&:first-child":{margin:"0 0 1.618rem"}}),Me=({items:_r})=>React$1.createElement(Yt,null,_r.map(Tr=>{const{text:Ar,start:Rr,end:Pr,children:Dr,identifier:Mr}=Tr;return React$1.createElement("li",{key:Mr},React$1.createElement(Xt,{label:Ar,start:Rr,end:Pr}),Dr&&React$1.createElement(Me,{items:Dr}))})),Kt=({resource:_r})=>{const[Tr,Ar]=React$1.useState([]),{id:Rr,label:Pr}=_r,{createNestedCues:Dr,orderCuesByTime:Mr}=_t();return reactExports.useEffect(()=>{Rr&&fetch(Rr,{headers:{"Content-Type":"text/plain",Accept:"application/json"}}).then(Fr=>Fr.text()).then(Fr=>{const zr=nodeWebvtt.parse(Fr).cues,jr=Mr(zr),Gr=Dr(jr);Ar(Gr)}).catch(Fr=>console.error(Rr,Fr.toString()))},[Rr]),React$1.createElement(Zt,{"aria-label":`navigate ${P(Pr,"en")}`},React$1.createElement(Me,{items:Tr}))},Jt=({activeCanvas:_r,resources:Tr})=>{const Ar=k(),{configOptions:Rr}=Ar,{informationPanel:Pr}=Rr,[Dr,Mr]=reactExports.useState(),Fr=(Pr==null?void 0:Pr.renderAbout)||(Rr==null?void 0:Rr.renderAbout),zr=Pr==null?void 0:Pr.renderSupplementing;reactExports.useEffect(()=>{Fr?Mr("manifest-about"):Tr&&(Tr==null?void 0:Tr.length)>0&&!Fr&&Mr(Tr[0].id)},[_r,Tr]);const jr=Gr=>{Mr(Gr)};return Tr?React$1.createElement(mt,{"data-testid":"information-panel",defaultValue:Dr,onValueChange:jr,orientation:"horizontal",value:Dr},React$1.createElement(ut,{"aria-label":"select chapter","data-testid":"information-panel-list"},Fr&&React$1.createElement(ee,{value:"manifest-about"},"About"),zr&&Tr&&Tr.map(({id:Gr,label:Nr})=>React$1.createElement(ee,{key:Gr,value:Gr},React$1.createElement(z,{label:Nr})))),React$1.createElement(pt,null,Fr&&React$1.createElement(te,{value:"manifest-about"},React$1.createElement(Ut,null)),zr&&Tr&&Tr.map(Gr=>React$1.createElement(te,{key:Gr.id,value:Gr.id},React$1.createElement(Kt,{resource:Gr}))))):React$1.createElement(React$1.Fragment,null)},Qt=d($f99a8c78507165f7$export$be92b6f5f03c0fe9,{display:"flex",flexDirection:"row",flexGrow:"1",padding:"1.618rem",overflowX:"scroll",position:"relative",zIndex:"0"}),en=()=>React$1.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M256 112v288M400 256H112"}),tn=()=>React$1.createElement(React$1.Fragment,null,React$1.createElement("path",{d:"M232 416a23.88 23.88 0 01-14.2-4.68 8.27 8.27 0 01-.66-.51L125.76 336H56a24 24 0 01-24-24V200a24 24 0 0124-24h69.75l91.37-74.81a8.27 8.27 0 01.66-.51A24 24 0 01256 120v272a24 24 0 01-24 24zm-106.18-80zm-.27-159.86zM320 336a16 16 0 01-14.29-23.19c9.49-18.87 14.3-38 14.3-56.81 0-19.38-4.66-37.94-14.25-56.73a16 16 0 0128.5-14.54C346.19 208.12 352 231.44 352 256c0 23.86-6 47.81-17.7 71.19A16 16 0 01320 336z"}),React$1.createElement("path",{d:"M368 384a16 16 0 01-13.86-24C373.05 327.09 384 299.51 384 256c0-44.17-10.93-71.56-29.82-103.94a16 16 0 0127.64-16.12C402.92 172.11 416 204.81 416 256c0 50.43-13.06 83.29-34.13 120a16 16 0 01-13.87 8z"}),React$1.createElement("path",{d:"M416 432a16 16 0 01-13.39-24.74C429.85 365.47 448 323.76 448 256c0-66.5-18.18-108.62-45.49-151.39a16 16 0 1127-17.22C459.81 134.89 480 181.74 480 256c0 64.75-14.66 113.63-50.6 168.74A16 16 0 01416 432z"})),nn=()=>React$1.createElement("path",{d:"M289.94 256l95-95A24 24 0 00351 127l-95 95-95-95a24 24 0 00-34 34l95 95-95 95a24 24 0 1034 34l95-95 95 95a24 24 0 0034-34z"}),rn=()=>React$1.createElement("path",{d:"M416 64H96a64.07 64.07 0 00-64 64v256a64.07 64.07 0 0064 64h320a64.07 64.07 0 0064-64V128a64.07 64.07 0 00-64-64zm-80 64a48 48 0 11-48 48 48.05 48.05 0 0148-48zM96 416a32 32 0 01-32-32v-67.63l94.84-84.3a48.06 48.06 0 0165.8 1.9l64.95 64.81L172.37 416zm352-32a32 32 0 01-32 32H217.63l121.42-121.42a47.72 47.72 0 0161.64-.16L448 333.84z"}),on=()=>React$1.createElement("path",{d:"M464 384.39a32 32 0 01-13-2.77 15.77 15.77 0 01-2.71-1.54l-82.71-58.22A32 32 0 01352 295.7v-79.4a32 32 0 0113.58-26.16l82.71-58.22a15.77 15.77 0 012.71-1.54 32 32 0 0145 29.24v192.76a32 32 0 01-32 32zM268 400H84a68.07 68.07 0 01-68-68V180a68.07 68.07 0 0168-68h184.48A67.6 67.6 0 01336 179.52V332a68.07 68.07 0 01-68 68z"}),Re=d("svg",{display:"inline-flex",variants:{isLarge:{true:{height:"4rem",width:"4rem"}},isMedium:{true:{height:"2rem",width:"2rem"}},isSmall:{true:{height:"1rem",width:"1rem"}}}}),an=({children:_r})=>React$1.createElement("title",null,_r),S=_r=>React$1.createElement(Re,{..._r,"data-testid":"icon-svg",role:"img",viewBox:"0 0 512 512",xmlns:"http://www.w3.org/2000/svg"},_r.children);S.Title=an;S.Add=en;S.Audio=tn;S.Close=nn;S.Image=rn;S.Video=on;const ln=X({"0%":{opacity:0,transform:"translateY(1rem)"},"100%":{opacity:1,transform:"translateY(0)"}}),sn=X({"0%":{opacity:0,transform:"translateY(1rem)"},"100%":{opacity:1,transform:"translateY(0)"}}),ze=d($cb5cc270b50c6fcd$export$21b07c8f274aebd5,{fill:"$secondaryAlt"}),cn=d($cb5cc270b50c6fcd$export$f39c2d165cd861fe,{position:"absolute",right:"0",top:"0",padding:"0.5rem",margin:"0",cursor:"pointer",border:"none",background:"none",fill:"inherit","&:hover":{opacity:"0.75"}}),dn=d($cb5cc270b50c6fcd$export$7c6e2c02157bb7d2,{border:"none",backgroundColor:"white",fill:"inhrerit",padding:"1rem 2rem 1rem 1rem",width:"auto",minWidth:"200px",maxWidth:"350px",borderRadius:"3px",boxShadow:"5px 5px 13px #0002",animationDuration:"0.3s",animationTimingFunction:"cubic-bezier(0.16, 1, 0.3, 1)",'&[data-side="top"]':{animationName:sn},'&[data-side="bottom"]':{animationName:ln},'&[data-align="end"]':{[`& ${ze}`]:{margin:"0 0.7rem"}}}),mn=d($cb5cc270b50c6fcd$export$41fb9f06171c75f4,{display:"inline-flex",padding:"0.5rem 0",margin:"0 0.5rem 0 0",cursor:"pointer",border:"none",background:"none","> button, > span":{margin:"0"}}),un=d($cb5cc270b50c6fcd$export$be92b6f5f03c0fe9,{boxSizing:"content-box"}),pn=_r=>React$1.createElement(mn,{..._r},_r.children),gn=_r=>React$1.createElement(dn,{..._r},React$1.createElement(ze,null),React$1.createElement(cn,null,React$1.createElement(S,{isSmall:!0},React$1.createElement(S.Close,null))),_r.children),V=({children:_r})=>React$1.createElement(un,null,_r);V.Trigger=pn;V.Content=gn;const q=d("div",{boxSizing:"border-box",display:"inline-flex",alignItems:"center",borderRadius:"5px",padding:"$1",marginBottom:"$2",marginRight:"$2",backgroundColor:"$lightGrey",color:"$richBlack50",textTransform:"uppercase",fontSize:"$2",objectFit:"contain",lineHeight:"1em !important","&:last-child":{marginRight:"0"},[`${Re}`]:{position:"absolute",left:"$1",height:"$3",width:"$3"},variants:{isIcon:{true:{position:"relative",paddingLeft:"$5"}}}}),U=d("span",{display:"flex"}),fn=d("span",{display:"flex",width:"1.2111rem",height:"0.7222rem"}),hn=d("span",{display:"inline-flex",marginLeft:"5px",marginBottom:"-1px"}),xn=d($f99a8c78507165f7$export$6d08773d2e66f8f2,{display:"flex",flexShrink:"0",margin:"0 1.618rem 0 0",padding:"0",cursor:"pointer",background:"none",border:"none",fontFamily:"inherit",lineHeight:"1.25em",fontSize:"1rem",textAlign:"left","&:last-child":{marginRight:"1rem"},figure:{margin:"0",width:"161.8px","> div":{position:"relative",display:"flex",backgroundColor:"$secondaryAlt",width:"inherit",height:"100px",overflow:"hidden",borderRadius:"3px",transition:"$all",img:{width:"100%",height:"100%",objectFit:"cover",filter:"blur(0)",transform:"scale3d(1, 1, 1)",transition:"$all",color:"transparent"},[`& ${U}`]:{position:"absolute",right:"0",bottom:"0",[`& ${q}`]:{margin:"0",paddingLeft:"0",fontSize:"0.7222rem",backgroundColor:"#000d",color:"$secondary",fill:"$secondary",borderBottomLeftRadius:"0",borderTopRightRadius:"0"}}},figcaption:{marginTop:"0.5rem",fontWeight:"400",fontSize:"0.8333rem",display:"-webkit-box",overflow:"hidden",MozBoxOrient:"vertical",WebkitBoxOrient:"vertical",WebkitLineClamp:"5","@sm":{fontSize:"0.8333rem"}}},"&[aria-checked='true']":{figure:{"> div":{backgroundColor:"$primaryAlt","&::before":{position:"absolute",zIndex:"1",color:"$secondaryMuted",content:"Active Item",textTransform:"uppercase",fontWeight:"700",fontSize:"0.6111rem",letterSpacing:"0.03rem",display:"flex",width:"100%",height:"100%",flexDirection:"column",justifyContent:"center",textAlign:"center",textShadow:"5px 5px 5px #0003"},img:{opacity:"0.3",transform:"scale3d(1.1, 1.1, 1.1)",filter:"blur(2px)"},[`& ${U}`]:{[`& ${q}`]:{backgroundColor:"$accent"}}}},figcaption:{fontWeight:"700"}}}),vn=({type:_r})=>{switch(_r){case"Sound":return React$1.createElement(S.Audio,null);case"Image":return React$1.createElement(S.Image,null);case"Video":return React$1.createElement(S.Video,null);default:return React$1.createElement(S.Image,null)}},bn=({canvas:_r,canvasIndex:Tr,isActive:Ar,thumbnail:Rr,type:Pr,handleChange:Dr})=>React$1.createElement(xn,{"aria-checked":Ar,"data-testid":"media-thumbnail","data-canvas":Tr,onClick:()=>Dr(_r.id),value:_r.id},React$1.createElement("figure",null,React$1.createElement("div",null,(Rr==null?void 0:Rr.id)&&React$1.createElement("img",{src:Rr.id,alt:_r!=null&&_r.label?P(_r.label):""}),React$1.createElement(U,null,React$1.createElement(q,{isIcon:!0,"data-testid":"thumbnail-tag"},React$1.createElement(fn,null),React$1.createElement(S,{"aria-label":Pr},React$1.createElement(vn,{type:Pr})),["Video","Sound"].includes(Pr)&&React$1.createElement(hn,null,pe(_r.duration))))),(_r==null?void 0:_r.label)&&React$1.createElement("figcaption",{"data-testid":"fig-caption"},React$1.createElement(z,{label:_r.label})))),yn=_r=>_r.body?_r.body.type:"Image",Le=d("div",{position:"absolute",right:"1rem",top:"1rem",display:"flex",justifyContent:"flex-end",zIndex:"1"}),En=d("input",{flexGrow:"1",border:"none",backgroundColor:"$secondaryMuted",color:"$primary",marginRight:"1rem",height:"2rem",padding:"0 1rem",borderRadius:"2rem",fontFamily:"inherit",fontSize:"1rem",lineHeight:"1rem",boxShadow:"inset 1px 1px 2px #0003","&::placeholder":{color:"$primaryMuted"}}),N=d("button",{display:"flex",background:"none",border:"none",width:"2rem !important",height:"2rem !important",padding:"0",margin:"0",fontWeight:"700",borderRadius:"2rem",backgroundColor:"$accent",color:"$secondary",cursor:"pointer",boxSizing:"content-box !important",transition:"$all",svg:{height:"60%",width:"60%",padding:"20%",fill:"$secondary",stroke:"$secondary",opacity:"1",filter:"drop-shadow(5px 5px 5px #000D)",boxSizing:"inherit",transition:"$all"},"&:disabled":{backgroundColor:"transparent",boxShadow:"none",svg:{opacity:"0.25"}}}),wn=d("div",{display:"flex",marginRight:"0.618rem",backgroundColor:"$accentAlt",borderRadius:"2rem",boxShadow:"5px 5px 5px #0003",color:"$secondary",alignItems:"center","> span":{display:"flex",margin:"0 0.5rem",fontSize:"0.7222rem"}}),Cn=d("div",{display:"flex",position:"relative",zIndex:"1",width:"100%",padding:"0",transition:"$all",variants:{isToggle:{true:{paddingTop:"2.618rem",[`& ${Le}`]:{width:"calc(100% - 2rem)","@sm":{width:"calc(100% - 2rem)"}}}}}}),Sn=(_r,Tr)=>{reactExports.useEffect(()=>{function Ar(Rr){Rr.key===_r&&Tr()}return window.addEventListener("keyup",Ar),()=>window.removeEventListener("keyup",Ar)},[])},kn=()=>React$1.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},React$1.createElement("title",null,"Arrow Back"),React$1.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",strokeWidth:"45",d:"M244 400L100 256l144-144M120 256h292"})),In=()=>React$1.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},React$1.createElement("title",null,"Arrow Forward"),React$1.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",strokeWidth:"45",d:"M268 112l144 144-144 144M392 256H100"})),$n=()=>React$1.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},React$1.createElement("title",null,"Close"),React$1.createElement("path",{d:"M289.94 256l95-95A24 24 0 00351 127l-95 95-95-95a24 24 0 00-34 34l95 95-95 95a24 24 0 1034 34l95-95 95 95a24 24 0 0034-34z"})),Tn=()=>React$1.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},React$1.createElement("title",null,"Search"),React$1.createElement("path",{d:"M456.69 421.39L362.6 327.3a173.81 173.81 0 0034.84-104.58C397.44 126.38 319.06 48 222.72 48S48 126.38 48 222.72s78.38 174.72 174.72 174.72A173.81 173.81 0 00327.3 362.6l94.09 94.09a25 25 0 0035.3-35.3zM97.92 222.72a124.8 124.8 0 11124.8 124.8 124.95 124.95 0 01-124.8-124.8z"})),An=({handleCanvasToggle:_r,handleFilter:Tr,activeIndex:Ar,canvasLength:Rr})=>{const[Pr,Dr]=reactExports.useState(!1),[Mr,Fr]=reactExports.useState(!1),[zr,jr]=reactExports.useState(!1);reactExports.useEffect(()=>{jr(Ar===0),Ar===Rr-1?Fr(!0):Fr(!1)},[Ar]),Sn("Escape",()=>{Dr(!1),Tr("")});const Gr=()=>{Dr(Lr=>!Lr),Tr("")},Nr=Lr=>Tr(Lr.target.value);return React$1.createElement(Cn,{isToggle:Pr},React$1.createElement(Le,null,Pr&&React$1.createElement(En,{autoFocus:!0,onChange:Nr,placeholder:"Search"}),!Pr&&React$1.createElement(wn,null,React$1.createElement(N,{onClick:()=>_r(-1),disabled:zr,type:"button"},React$1.createElement(kn,null)),React$1.createElement("span",null,Ar+1," of ",Rr),React$1.createElement(N,{onClick:()=>_r(1),disabled:Mr,type:"button"},React$1.createElement(In,null))),React$1.createElement(N,{onClick:Gr,type:"button"},Pr?React$1.createElement($n,null):React$1.createElement(Tn,null))))},Mn=({items:_r})=>{const Tr=F(),Ar=k(),{activeCanvas:Rr,vault:Pr}=Ar,[Dr,Mr]=reactExports.useState(""),[Fr,zr]=reactExports.useState([]),[jr,Gr]=reactExports.useState(0),Nr=React$1.useRef(null),Lr="painting",Ur=["Image","Sound","Video"],Vr=Kr=>{Rr!==Kr&&Tr({type:"updateActiveCanvas",canvasId:Kr})};reactExports.useEffect(()=>{if(!Fr.length){const Kr=_r.map(Xr=>ve(Pr,Xr,Lr,Ur)).filter(Xr=>Xr.annotations.length>0);zr(Kr)}},[]),reactExports.useEffect(()=>{Fr.forEach((Kr,Xr)=>{Kr!=null&&Kr.canvas&&Kr.canvas.id===Rr&&Gr(Xr)})},[Rr]),reactExports.useEffect(()=>{const Kr=document.querySelector(`[data-canvas="${jr}"]`);if(Kr instanceof HTMLElement&&Nr.current){const Xr=Kr.offsetLeft-Nr.current.offsetWidth/2+Kr.offsetWidth/2;Nr.current.scrollTo({left:Xr,behavior:"smooth"})}},[jr]);const Wr=Kr=>Mr(Kr),qr=Kr=>{const Xr=Fr[jr+Kr];Xr!=null&&Xr.canvas&&Vr(Xr.canvas.id)};return React$1.createElement(React$1.Fragment,null,React$1.createElement(An,{handleFilter:Wr,handleCanvasToggle:qr,activeIndex:jr,canvasLength:Fr.length}),React$1.createElement(Qt,{"aria-label":"select item","data-testid":"media",ref:Nr},Fr.filter(Kr=>{var Xr;if((Xr=Kr.canvas)!=null&&Xr.label){const Zr=P(Kr.canvas.label);if(Array.isArray(Zr))return Zr[0].toLowerCase().includes(Dr.toLowerCase())}}).map((Kr,Xr)=>{var Zr,_i;return React$1.createElement(bn,{canvas:Kr.canvas,canvasIndex:Xr,handleChange:Vr,isActive:Rr===((Zr=Kr==null?void 0:Kr.canvas)==null?void 0:Zr.id),key:(_i=Kr==null?void 0:Kr.canvas)==null?void 0:_i.id,thumbnail:rt(Pr,Kr,200,200),type:yn(Kr.annotations[0])})})))},Rn=d("div",{position:"absolute !important",zIndex:"1",top:"1rem",left:"1rem",width:"161.8px",height:"100px",backgroundColor:"#000D",boxShadow:"5px 5px 5px #0002",borderRadius:"3px",".displayregion":{border:" 3px solid $accent !important",boxShadow:"0 0 3px #0006"},"@sm":{width:"123px",height:"76px"},"@xs":{width:"100px",height:"61.8px"}}),zn=d("div",{position:"relative",width:"100%",height:"100%",zIndex:"0"}),Ln=d("div",{width:"100%",height:"61.8vh",maxHeight:"100vh",background:"black",backgroundSize:"contain",color:"white",position:"relative",zIndex:"1",overflow:"hidden"}),Fe=d("button",{display:"flex",height:"2rem",width:"2rem",borderRadius:"2rem",padding:"0",margin:"0",fontFamily:"inherit",background:"none",border:"none",color:"white",cursor:"pointer",marginLeft:"0.618rem",backgroundColor:"$primary",filter:"drop-shadow(2px 2px 5px #0003)",transition:"$all",boxSizing:"content-box !important","&:first-child":{marginLeft:"0"},"@xs":{marginBottom:"0.618rem",marginLeft:"0","&:last-child":{marginBottom:"0"}},svg:{height:"60%",width:"60%",padding:"20%",fill:"$secondary",stroke:"$secondary",filter:"drop-shadow(2px 2px 5px #0003)",transition:"$all",boxSizing:"inherit"},"&:hover, &:focus":{backgroundColor:"$accent"},"&#rotateRight":{"&:hover, &:focus":{svg:{rotate:"45deg"}}},"&#rotateLeft":{transform:"scaleX(-1)","&:hover, &:focus":{svg:{rotate:"45deg"}}},"&#reset":{"&:hover, &:focus":{svg:{rotate:"-15deg"}}}}),R=({id:_r,label:Tr,children:Ar})=>React$1.createElement(Fe,{id:_r,"data-testid":"openseadragon-button"},React$1.createElement("svg",{xmlns:"http://www.w3.org/2000/svg","aria-labelledby":`${_r}-svg-title`,"data-testid":"openseadragon-button-svg",focusable:"false",viewBox:"0 0 512 512",role:"img"},React$1.createElement("title",{id:`${_r}-svg-title`},Tr),Ar)),Fn=d("div",{position:"absolute",zIndex:"1",top:"1rem",display:"flex","@xs":{flexDirection:"column",zIndex:"2"},variants:{hasPlaceholder:{true:{right:"3.618rem","@xs":{top:"3.618rem",right:"1rem"}},false:{right:"1rem","@xs":{top:"1rem",right:"1rem"}}}}}),Pn=()=>React$1.createElement("path",{strokeLinecap:"round",strokeMiterlimit:"10",strokeWidth:"45",d:"M256 112v288M400 256H112"}),Vn=()=>React$1.createElement("path",{strokeLinecap:"round",strokeMiterlimit:"10",strokeWidth:"45",d:"M400 256H112"}),Hn=()=>React$1.createElement("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M432 320v112H320M421.8 421.77L304 304M80 192V80h112M90.2 90.23L208 208M320 80h112v112M421.77 90.2L304 208M192 432H80V320M90.23 421.8L208 304"}),Bn=()=>React$1.createElement("path",{d:"M448 440a16 16 0 01-12.61-6.15c-22.86-29.27-44.07-51.86-73.32-67C335 352.88 301 345.59 256 344.23V424a16 16 0 01-27 11.57l-176-168a16 16 0 010-23.14l176-168A16 16 0 01256 88v80.36c74.14 3.41 129.38 30.91 164.35 81.87C449.32 292.44 464 350.9 464 424a16 16 0 01-16 16z"}),ae=()=>React$1.createElement(React$1.Fragment,null,React$1.createElement("path",{fill:"none",strokeLinecap:"round",strokeMiterlimit:"10",strokeWidth:"45",d:"M400 148l-21.12-24.57A191.43 191.43 0 00240 64C134 64 48 150 48 256s86 192 192 192a192.09 192.09 0 00181.07-128"}),React$1.createElement("path",{d:"M464 97.42V208a16 16 0 01-16 16H337.42c-14.26 0-21.4-17.23-11.32-27.31L436.69 86.1C446.77 76 464 83.16 464 97.42z"})),On=({hasPlaceholder:_r,options:Tr})=>React$1.createElement(Fn,{"data-testid":"openseadragon-controls",hasPlaceholder:_r,id:"openseadragon-controls"},Tr.showZoomControl&&React$1.createElement(React$1.Fragment,null,React$1.createElement(R,{id:"zoomIn",label:"zoom in"},React$1.createElement(Pn,null)),React$1.createElement(R,{id:"zoomOut",label:"zoom out"},React$1.createElement(Vn,null))),Tr.showFullPageControl&&React$1.createElement(R,{id:"fullPage",label:"full page"},React$1.createElement(Hn,null)),Tr.showRotationControl&&React$1.createElement(React$1.Fragment,null,React$1.createElement(R,{id:"rotateRight",label:"rotate right"},React$1.createElement(ae,null)),React$1.createElement(R,{id:"rotateLeft",label:"rotate left"},React$1.createElement(ae,null))),Tr.showHomeControl&&React$1.createElement(R,{id:"reset",label:"reset"},React$1.createElement(Bn,null))),Dn=_r=>fetch(`${_r.replace(/\/$/,"")}/info.json`).then(Tr=>Tr.json()).then(Tr=>Tr).catch(Tr=>{console.error(`The IIIF tilesource ${_r.replace(/\/$/,"")}/info.json failed to load: ${Tr}`)}),Wn=_r=>{let Tr,Ar;if(Array.isArray(_r)&&(Tr=_r[0],Tr)){let Rr;"@id"in Tr?Rr=Tr["@id"]:Rr=Tr.id,Ar=Rr}return Ar},jn=({uri:_r,imageType:Tr,hasPlaceholder:Ar})=>{const[Rr,Pr]=reactExports.useState(),Dr=k(),{configOptions:Mr}=Dr,Fr=v4(),zr={id:`openseadragon-viewport-${Fr}`,loadTilesWithAjax:!0,fullPageButton:"fullPage",homeButton:"reset",rotateLeftButton:"rotateLeft",rotateRightButton:"rotateRight",zoomInButton:"zoomIn",zoomOutButton:"zoomOut",showNavigator:!0,showFullPageControl:!0,showHomeControl:!0,showRotationControl:!0,showZoomControl:!0,navigatorBorderColor:"transparent",navigatorId:`openseadragon-navigator-${Fr}`,gestureSettingsMouse:{clickToZoom:!0,dblClickToZoom:!0,pinchToZoom:!0,scrollToZoom:!0},...Mr.openSeadragon,ajaxWithCredentials:Mr.withCredentials};return reactExports.useEffect(()=>{_r!==Rr&&Pr(_r)},[]),reactExports.useEffect(()=>{if(Rr)switch(Tr){case"simpleImage":Q(zr).addSimpleImage({url:Rr});break;case"tiledImage":Dn(Rr).then(jr=>Q(zr).addTiledImage({tileSource:jr}));break;default:console.warn(`Unable to render ${Rr} in OpenSeadragon as type: "${Tr}"`);break}},[Rr]),React$1.createElement(Ln,{css:{backgroundColor:Mr.canvasBackgroundColor,height:Mr.canvasHeight}},React$1.createElement(On,{options:zr,hasPlaceholder:Ar}),React$1.createElement(Rn,{id:`openseadragon-navigator-${Fr}`}),React$1.createElement(zn,{id:`openseadragon-viewport-${Fr}`}))},Nn=({body:_r,hasPlaceholder:Tr})=>{const[Ar,Rr]=reactExports.useState(),[Pr,Dr]=reactExports.useState();return reactExports.useEffect(()=>{Array.isArray(_r.service)&&_r.service.length>0?(Rr("tiledImage"),Dr(Wn(_r.service))):(Rr("simpleImage"),Dr(_r.id))},[_r]),React$1.createElement(jn,{uri:Pr,key:Pr,imageType:Ar,hasPlaceholder:Tr})},Pe=d("button",{background:"none",border:"none",cursor:"zoom-in",width:"100%",height:"100%",margin:"0",padding:"0",display:"flex",transition:"$all","& img":{width:"100%",height:"100%",objectFit:"contain",color:"transparent",transition:"$all"},variants:{isMedia:{true:{cursor:"pointer"}}}}),Gn=({isMedia:_r,label:Tr,placeholderCanvas:Ar,setIsInteractive:Rr})=>{const{vault:Pr}=k(),Dr=B(Pr,Ar),Mr=Tr?P(Tr):["placeholder image"];return React$1.createElement(Pe,{onClick:()=>Rr(!0),isMedia:_r},React$1.createElement("img",{src:(Dr==null?void 0:Dr.id)||"",alt:Mr.join(),height:Dr==null?void 0:Dr.height,width:Dr==null?void 0:Dr.width}))},Ve=d(Fe,{position:"absolute",width:"2rem",top:"1rem",right:"1rem",zIndex:100,display:"flex",alignItems:"center",justifyContent:"center",textAlign:"center",transition:"$all",borderRadius:"50%",backgroundColor:"$accent",cursor:"pointer","&:hover, &:focus":{backgroundColor:"$accent !important"},variants:{isInteractive:{true:{"&:hover":{opacity:"1"}},false:{}},isMedia:{true:{cursor:"pointer !important"}}},compoundVariants:[{isInteractive:!1,isMedia:!0,css:{top:"50%",right:"50%",width:"4rem",height:"4rem",transform:"translate(50%,-50%)"}}]}),qn=d("div",{position:"relative",zIndex:"0","&:hover":{[`${Ve}`]:{backgroundColor:"$accent"},[`${Pe}`]:{backgroundColor:"#6662",img:{filter:"brightness(0.85)"}}}}),Un=d("div",{position:"relative",backgroundColor:"$primaryAlt",display:"flex",flexGrow:"0",flexShrink:"1",maxHeight:"500px",zIndex:"1",video:{backgroundColor:"transparent",objectFit:"contain",width:"100%",height:"100%",position:"relative",zIndex:"1"}}),_n=d("canvas",{position:"absolute",width:"100%",height:"100%",zIndex:"0"}),Zn=React$1.forwardRef((_r,Tr)=>{const Ar=React$1.useRef(null);React$1.useEffect(()=>{Tr&&(Tr.current.onplay=Rr)},[Tr]);function Rr(){const Dr=Tr.current,Mr=new AudioContext,Fr=Mr.createMediaElementSource(Dr);let zr=Mr.createAnalyser();const jr=Ar.current;if(!jr)return;jr.width=Dr.offsetWidth,jr.height=Dr.offsetHeight;const Gr=jr.getContext("2d");Fr.connect(zr),zr.connect(Mr.destination),zr.fftSize=256;const Nr=zr.frequencyBinCount,Lr=new Uint8Array(Nr);setInterval(function(){Pr(zr,Gr,Nr,Lr,jr.width,jr.height)},20)}function Pr(Dr,Mr,Fr,zr,jr,Gr){let Nr=jr/Fr*2.6,Lr,Ur=0;Dr.getByteFrequencyData(zr),Mr.fillStyle="#000000",Mr.fillRect(0,0,jr,Gr);for(let Vr=0;Vr<Fr;Vr++)Lr=zr[Vr]*2,Mr.fillStyle="rgba(78, 42, 132, 1)",Mr.fillRect(Ur,Gr-Lr,Nr,Lr),Ur+=Nr+6}return React$1.createElement(_n,{ref:Ar})}),Xn=({resource:_r,ignoreCaptionLabels:Tr})=>{const Ar=P(_r.label,"en");return Ar.some(Rr=>Tr.includes(Rr))?null:React$1.createElement("track",{key:_r.id,src:_r.id,label:Ar,srcLang:"en","data-testid":"player-track"})},Yn=({resources:_r,painting:Tr})=>{var Ar;const[Rr,Pr]=React$1.useState(0),[Dr,Mr]=React$1.useState(),Fr=React$1.useRef(null),zr=(Ar=Tr==null?void 0:Tr.format)==null?void 0:Ar.includes("audio/"),jr=k(),{activeCanvas:Gr,configOptions:Nr,vault:Lr}=jr;return reactExports.useEffect(()=>{if(!Tr.id||!Fr.current||Tr.id.split(".").pop()!=="m3u8")return;const Ur={xhrSetup:function(Wr,qr){Wr.withCredentials=Nr.withCredentials}},Vr=new Hls(Ur);return Vr.attachMedia(Fr.current),Vr.on(Hls.Events.MEDIA_ATTACHED,function(){Vr.loadSource(Tr.id)}),Vr.on(Hls.Events.ERROR,function(Wr,qr){if(qr.fatal)switch(qr.type){case Hls.ErrorTypes.NETWORK_ERROR:console.error(`fatal ${Wr} network error encountered, try to recover`),Vr.startLoad();break;case Hls.ErrorTypes.MEDIA_ERROR:console.error(`fatal ${Wr} media error encountered, try to recover`),Vr.recoverMediaError();break;default:Vr.destroy();break}}),()=>{if(Vr&&Fr.current){const Wr=Fr.current;Vr.detachMedia(),Vr.destroy(),Wr.currentTime=0}}},[Tr.id]),reactExports.useEffect(()=>{var Ur,Vr,Wr,qr;const Kr=Lr.get(Gr),Xr=(Ur=Kr.accompanyingCanvas)!=null&&Ur.id?B(Lr,(Vr=Kr.accompanyingCanvas)==null?void 0:Vr.id):null,Zr=(Wr=Kr.placeholderCanvas)!=null&&Wr.id?B(Lr,(qr=Kr.placeholderCanvas)==null?void 0:qr.id):null;Xr&&Zr?Mr(Rr===0?Zr.id:Xr.id):(Xr&&Mr(Xr.id),Zr&&Mr(Zr.id))},[Gr,Rr]),reactExports.useEffect(()=>{if(Fr!=null&&Fr.current){const Ur=Fr.current;return Ur==null||Ur.addEventListener("timeupdate",()=>Pr(Ur.currentTime)),()=>document.removeEventListener("timeupdate",()=>{})}},[Fr==null?void 0:Fr.current]),React$1.createElement(Un,{css:{backgroundColor:Nr.canvasBackgroundColor,maxHeight:Nr.canvasHeight}},React$1.createElement("video",{id:"clover-iiif-video",key:Tr.id,ref:Fr,controls:!0,height:Tr.height,width:Tr.width,crossOrigin:"anonymous",poster:Dr,style:{maxHeight:Nr.canvasHeight}},React$1.createElement("source",{src:Tr.id,type:Tr.format}),_r.length>0&&_r.map(Ur=>React$1.createElement(Xn,{resource:Ur,ignoreCaptionLabels:Nr.ignoreCaptionLabels,key:Ur.id})),"Sorry, your browser doesn't support embedded videos."),zr&&React$1.createElement(Zn,{ref:Fr}))},Kn=()=>React$1.createElement("svg",{xmlns:"http://www.w3.org/2000/svg","aria-labelledby":"close-svg-title",focusable:"false",viewBox:"0 0 512 512",role:"img"},React$1.createElement("title",{id:"close-svg-title"},"close"),React$1.createElement("path",{d:"M289.94 256l95-95A24 24 0 00351 127l-95 95-95-95a24 24 0 00-34 34l95 95-95 95a24 24 0 1034 34l95-95 95 95a24 24 0 0034-34z"})),Jn=({isMedia:_r})=>React$1.createElement("svg",{xmlns:"http://www.w3.org/2000/svg","aria-labelledby":"open-svg-title",focusable:"false",viewBox:"0 0 512 512",role:"img"},React$1.createElement("title",{id:"open-svg-title"},"open"),_r?React$1.createElement("path",{d:"M133 440a35.37 35.37 0 01-17.5-4.67c-12-6.8-19.46-20-19.46-34.33V111c0-14.37 7.46-27.53 19.46-34.33a35.13 35.13 0 0135.77.45l247.85 148.36a36 36 0 010 61l-247.89 148.4A35.5 35.5 0 01133 440z"}):React$1.createElement(React$1.Fragment,null,React$1.createElement("path",{d:"m456.69,421.39l-94.09-94.09c22.65-30.16,34.88-66.86,34.84-104.58,0-96.34-78.38-174.72-174.72-174.72S48,126.38,48,222.72s78.38,174.72,174.72,174.72c37.72.04,74.42-12.19,104.58-34.84l94.09,94.09c10.29,9.2,26.1,8.32,35.3-1.98,8.48-9.49,8.48-23.83,0-33.32Zm-233.97-73.87c-68.89-.08-124.72-55.91-124.8-124.8h0c0-68.93,55.87-124.8,124.8-124.8s124.8,55.87,124.8,124.8-55.87,124.8-124.8,124.8Z"}),React$1.createElement("path",{d:"m279.5,197.76h-3.35s-28.47,0-28.47,0v-31.82c-.77-13.79-12.57-24.33-26.36-23.56-12.71.71-22.85,10.86-23.56,23.56v3.35h0v28.47h-31.82c-13.79.77-24.33,12.57-23.56,26.36.71,12.71,10.86,22.85,23.56,23.56h3.35s28.47,0,28.47,0v31.82c.77,13.79,12.57,24.33,26.36,23.56,12.71-.71,22.85-10.86,23.56-23.56v-3.35h0v-28.47h31.82c13.79-.77,24.33-12.57,23.56-26.36-.71-12.71-10.86-22.85-23.56-23.56Z"}))),Qn=({handleToggle:_r,isInteractive:Tr,isMedia:Ar})=>React$1.createElement(Ve,{onClick:_r,isInteractive:Tr,isMedia:Ar},Tr?React$1.createElement(Kn,null):React$1.createElement(Jn,{isMedia:Ar})),er=({activeCanvas:_r,isMedia:Tr,painting:Ar,resources:Rr})=>{var Pr;const[Dr,Mr]=React$1.useState(!1),{configOptions:Fr,vault:zr}=k(),jr=zr.get(_r),Gr=(Pr=jr==null?void 0:jr.placeholderCanvas)==null?void 0:Pr.id,Nr=!!Gr,Lr=Gr&&!Dr&&!Tr,Ur=()=>Mr(!Dr);return React$1.createElement(qn,{css:{maxHeight:Fr.canvasHeight,backgroundColor:Fr.canvasBackgroundColor}},Gr&&!Tr&&React$1.createElement(Qn,{handleToggle:Ur,isInteractive:Dr,isMedia:Tr}),Lr&&!Tr&&React$1.createElement(Gn,{isMedia:Tr,label:jr==null?void 0:jr.label,placeholderCanvas:Gr,setIsInteractive:Mr}),!Lr&&React$1.createElement("div",null,Tr?React$1.createElement(Yn,{painting:Ar,resources:Rr}):Ar&&React$1.createElement(Nn,{body:Ar,hasPlaceholder:Nr,key:_r})))},tr=({activeCanvas:_r,painting:Tr,resources:Ar,items:Rr,isAudioVideo:Pr})=>{const{informationOpen:Dr,configOptions:Mr}=k(),{informationPanel:Fr}=Mr,zr=(Fr==null?void 0:Fr.renderAbout)||(Fr==null?void 0:Fr.renderSupplementing)&&Ar.length>0;return React$1.createElement(ye,{className:"clover-content"},React$1.createElement(Ee,null,React$1.createElement(er,{activeCanvas:_r,isMedia:Pr,painting:Tr,resources:Ar}),zr&&React$1.createElement(we,null,React$1.createElement("span",null,Dr?"View Items":"More Information")),Rr.length>1&&React$1.createElement(be,{className:"clover-canvases"},React$1.createElement(Mn,{items:Rr,activeItem:0}))),Dr&&zr&&React$1.createElement(ct,null,React$1.createElement(Ce,null,React$1.createElement(Jt,{activeCanvas:_r,resources:Ar}))))},nr=d("svg",{height:"19px",color:"$accent",fill:"$accent",stroke:"$accent",display:"flex",margin:"0.25rem 0.85rem"}),rr=d($cc7e05a45900e73f$export$41fb9f06171c75f4,{fontSize:"1.25rem",fontWeight:"400",fontFamily:"inherit",alignSelf:"flex-start",flexGrow:"1",backgroundColor:"$secondary",cursor:"pointer",transition:"$all",border:"1px solid $secondaryMuted",boxShadow:"2px 2px 5px #0001",borderRadius:"3px",display:"flex",alignItems:"center",paddingLeft:"0.5rem","@sm":{fontSize:"1rem"}}),or=d($cc7e05a45900e73f$export$7c6e2c02157bb7d2,{borderRadius:"3px",boxShadow:"3px 3px 8px #0003",backgroundColor:"$secondary",marginTop:"2.25rem",marginLeft:"6px",paddingBottom:"0.25rem",maxHeight:"calc(61.8vh - 2.5rem) !important",borderTopLeftRadius:"0",border:"1px solid $secondaryMuted",maxWidth:"90vw"}),ar=d($cc7e05a45900e73f$export$6d08773d2e66f8f2,{display:"flex",alignItems:"center",fontFamily:"inherit",padding:"0.25rem 0.5rem",color:"$primary",fontWeight:"400",fontSize:"0.8333rem",cursor:"pointer",backgroundColor:"$secondary",width:"calc(100% - 1rem)","> span":{whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"},'&[data-state="checked"]':{fontWeight:"700",color:"$primary !important"},"&:hover":{color:"$accent"},img:{width:"31px",height:"31px",marginRight:"0.5rem",borderRadius:"3px"}}),ir=d($cc7e05a45900e73f$export$b04be29aa201d4f5,{color:"$primaryMuted",fontFamily:"inherit",fontSize:"0.85rem",padding:"0.5rem 1rem 0.5rem 0.5rem",display:"flex",alignItems:"center",marginBottom:"0.25rem",borderRadius:"3px",borderTopLeftRadius:"0",borderBottomLeftRadius:"0",borderBottomRightRadius:"0",backgroundColor:"$secondaryMuted"}),He=d("div",{position:"relative",zIndex:"5"}),lr=d(V.Trigger,{width:"30px",padding:"5px"}),sr=d(V.Content,{display:"flex",flexDirection:"column",fontSize:"0.8333rem",border:"none",boxShadow:"2px 2px 5px #0003",zIndex:"2",button:{display:"flex",textDecoration:"none",marginBottom:"0.5em",color:"$accentAlt",cursor:"pointer",background:"$secondary",border:"none","&:last-child":{marginBottom:"0"}}}),cr=d("span",{fontSize:"1.33rem",alignSelf:"flex-start",flexGrow:"0",flexShrink:"1",padding:"1rem","@sm":{fontSize:"1rem"},"&.visually-hidden":{position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",border:"0"}}),dr=d("header",{display:"flex",backgroundColor:"transparent !important",justifyContent:"space-between",alignItems:"flex-start",width:"100%",[`> ${He}`]:{flexGrow:"1",flexShrink:"0"},form:{flexGrow:"0",flexShrink:"1"}}),mr=d("div",{display:"flex",alignItems:"flex-end",justifyContent:"flex-end",padding:"1rem",flexShrink:"0",flexGrow:"1"}),G=({direction:_r,title:Tr})=>{const Ar=()=>React$1.createElement("path",{d:"M414 321.94L274.22 158.82a24 24 0 00-36.44 0L98 321.94c-13.34 15.57-2.28 39.62 18.22 39.62h279.6c20.5 0 31.56-24.05 18.18-39.62z"}),Rr=()=>React$1.createElement("path",{d:"M98 190.06l139.78 163.12a24 24 0 0036.44 0L414 190.06c13.34-15.57 2.28-39.62-18.22-39.62h-279.6c-20.5 0-31.56 24.05-18.18 39.62z"});return React$1.createElement(nr,{xmlns:"http://www.w3.org/2000/svg",focusable:"false",viewBox:"0 0 512 512",role:"img"},React$1.createElement("title",null,Tr),_r==="up"&&React$1.createElement(Ar,null),_r==="down"&&React$1.createElement(Rr,null))},ur=()=>{const _r=F(),Tr=k(),{activeManifest:Ar,collection:Rr,configOptions:Pr,vault:Dr}=Tr,Mr=Pr==null?void 0:Pr.canvasHeight,Fr=zr=>{_r({type:"updateActiveManifest",manifestId:zr})};return React$1.createElement(He,null,React$1.createElement($cc7e05a45900e73f$export$be92b6f5f03c0fe9,{value:Ar,onValueChange:Fr},React$1.createElement(rr,null,React$1.createElement($cc7e05a45900e73f$export$4c8d1a57a761ef94,null),React$1.createElement($cc7e05a45900e73f$export$f04a61298a47a40f,null,React$1.createElement(G,{direction:"down",title:"select from collection"}))),React$1.createElement(or,{css:{maxHeight:`${Mr} !important`}},React$1.createElement($cc7e05a45900e73f$export$2f60d3ec9ad468f2,null,React$1.createElement(G,{direction:"up",title:"scroll up for more"})),React$1.createElement($cc7e05a45900e73f$export$d5c6c08dc2d3ca7,null,React$1.createElement($cc7e05a45900e73f$export$eb2fcfdbd7ba97d4,null,React$1.createElement(ir,null,React$1.createElement(z,{label:Rr.label})),Rr.items.map(zr=>React$1.createElement(ar,{value:zr.id,key:zr.id},(zr==null?void 0:zr.thumbnail)&&React$1.createElement(Te,{thumbnail:Dr.get(zr==null?void 0:zr.thumbnail)}),React$1.createElement($cc7e05a45900e73f$export$d6e5bf9c43ea9319,null,React$1.createElement(z,{label:zr.label})),React$1.createElement($cc7e05a45900e73f$export$c3468e2714d175fa,null))))),React$1.createElement($cc7e05a45900e73f$export$bf1aedc3039c8d63,null,React$1.createElement(G,{direction:"down",title:"scroll down for more"})))))},pr=(_r,Tr=2500)=>{const[Ar,Rr]=reactExports.useState(),Pr=reactExports.useCallback(()=>{navigator.clipboard.writeText(_r).then(()=>Rr("copied"),()=>Rr("failed"))},[_r]);return reactExports.useEffect(()=>{if(!Ar)return;const Dr=setTimeout(()=>Rr(void 0),Tr);return()=>clearTimeout(Dr)},[Ar]),[Ar,Pr]},gr=d("span",{display:"flex",alignContent:"center",alignItems:"center",padding:"0.125rem 0.25rem 0",marginTop:"-0.125rem",marginLeft:"0.5rem",backgroundColor:"$accent",color:"$secondary",borderRadius:"3px",fontSize:"0.6111rem",textTransform:"uppercase",lineHeight:"1em"}),fr=({status:_r})=>_r?React$1.createElement(gr,{"data-copy-status":_r},_r):null,ie=({textPrompt:_r,textToCopy:Tr})=>{const[Ar,Rr]=pr(Tr);return React$1.createElement("button",{onClick:Rr},_r," ",React$1.createElement(fr,{status:Ar}))},hr=()=>{const _r="#ed1d33",Tr="#2873ab";return React$1.createElement("svg",{viewBox:"0 0 493.35999 441.33334",id:"iiif-logo",version:"1.1"},React$1.createElement("title",null,"IIIF Manifest Options"),React$1.createElement("g",{transform:"matrix(1.3333333,0,0,-1.3333333,0,441.33333)"},React$1.createElement("g",{transform:"scale(0.1)"},React$1.createElement("path",{style:{fill:Tr},d:"M 65.2422,2178.75 775.242,1915 773.992,15 65.2422,276.25 v 1902.5"}),React$1.createElement("path",{style:{fill:Tr},d:"m 804.145,2640.09 c 81.441,-240.91 -26.473,-436.2 -241.04,-436.2 -214.558,0 -454.511,195.29 -535.9527,436.2 -81.4335,240.89 26.4805,436.18 241.0387,436.18 214.567,0 454.512,-195.29 535.954,-436.18"}),React$1.createElement("path",{style:{fill:_r},d:"M 1678.58,2178.75 968.578,1915 969.828,15 1678.58,276.25 v 1902.5"}),React$1.createElement("path",{style:{fill:_r},d:"m 935.082,2640.09 c -81.437,-240.91 26.477,-436.2 241.038,-436.2 214.56,0 454.51,195.29 535.96,436.2 81.43,240.89 -26.48,436.18 -241.04,436.18 -214.57,0 -454.52,-195.29 -535.958,-436.18"}),React$1.createElement("path",{style:{fill:Tr},d:"m 1860.24,2178.75 710,-263.75 -1.25,-1900 -708.75,261.25 v 1902.5"}),React$1.createElement("path",{style:{fill:Tr},d:"m 2603.74,2640.09 c 81.45,-240.91 -26.47,-436.2 -241.03,-436.2 -214.58,0 -454.52,195.29 -535.96,436.2 -81.44,240.89 26.48,436.18 241.03,436.18 214.57,0 454.51,-195.29 535.96,-436.18"}),React$1.createElement("path",{style:{fill:_r},d:"m 3700.24,3310 v -652.5 c 0,0 -230,90 -257.5,-142.5 -2.5,-247.5 0,-336.25 0,-336.25 l 257.5,83.75 V 1690 l -258.61,-92.5 V 262.5 L 2735.24,0 v 2360 c 0,0 -15,850 965,950"}))))},xr=d($6be4966fd9bbc698$export$be92b6f5f03c0fe9,{all:"unset",height:"2rem",width:"3.236rem",backgroundColor:"#6663",borderRadius:"9999px",position:"relative",WebkitTapHighlightColor:"transparent",cursor:"pointer","&:focus":{boxShadow:"0 0 0 2px $secondaryAlt"},'&[data-state="checked"]':{backgroundColor:"$accent",boxShadow:"inset 2px 2px 5px #0003"}}),vr=d($6be4966fd9bbc698$export$6521433ed15a34db,{display:"block",height:"calc(2rem - 12px)",width:"calc(2rem - 12px)",backgroundColor:"$secondary",borderRadius:"100%",boxShadow:"2px 2px 5px #0001",transition:"$all",transform:"translateX(6px)",willChange:"transform",'&[data-state="checked"]':{transform:"translateX(calc(1.236rem + 6px))"}}),br=d("label",{fontSize:"0.8333rem",fontWeight:"400",lineHeight:"1em",userSelect:"none",cursor:"pointer",paddingRight:"0.618rem"}),yr=d("form",{display:"flex",flexShrink:"0",flexGrow:"1",alignItems:"center",marginLeft:"1.618rem"}),Er=()=>{var _r;const{configOptions:Tr}=k(),Ar=F(),[Rr,Pr]=reactExports.useState((_r=Tr==null?void 0:Tr.informationPanel)==null?void 0:_r.open);return reactExports.useEffect(()=>{Ar({type:"updateInformationOpen",informationOpen:Rr})},[Rr]),React$1.createElement(yr,null,React$1.createElement(br,{htmlFor:"information-toggle",css:Rr?{opacity:"1"}:{}},"More Information"),React$1.createElement(xr,{checked:Rr,onCheckedChange:()=>Pr(!Rr),id:"information-toggle","aria-label":"information panel toggle",name:"toggled?"},React$1.createElement(vr,null)))},Be=_r=>{const Tr=()=>window.matchMedia?window.matchMedia(_r).matches:!1,[Ar,Rr]=reactExports.useState(Tr);return reactExports.useEffect(()=>{const Pr=()=>Rr(Tr);return window.addEventListener("resize",Pr),()=>window.removeEventListener("resize",Pr)}),Ar},wr=({manifestId:_r,manifestLabel:Tr})=>{const Ar=k(),{collection:Rr,configOptions:Pr}=Ar,{showTitle:Dr,showIIIFBadge:Mr,informationPanel:Fr}=Pr,zr=Mr||(Fr==null?void 0:Fr.renderToggle),jr=Be(Z.sm);return React$1.createElement(dr,{className:"clover-header"},Rr!=null&&Rr.items?React$1.createElement(ur,null):React$1.createElement(cr,{className:Dr?"":"visually-hidden"},Dr&&React$1.createElement(z,{label:Tr})),zr&&React$1.createElement(mr,null,Mr&&React$1.createElement(V,null,React$1.createElement(lr,null,React$1.createElement(hr,null)),React$1.createElement(sr,null,(Rr==null?void 0:Rr.items)&&React$1.createElement("button",{onClick:Gr=>{Gr.preventDefault(),window.open(Rr.id,"_blank")}},"View Collection"),React$1.createElement("button",{onClick:Gr=>{Gr.preventDefault(),window.open(_r,"_blank")}},"View Manifest")," ",(Rr==null?void 0:Rr.items)&&React$1.createElement(ie,{textPrompt:"Copy Collection URL",textToCopy:Rr.id}),React$1.createElement(ie,{textPrompt:"Copy Manifest URL",textToCopy:_r}))),Fr.renderToggle&&!jr&&React$1.createElement(Er,null)))},Cr=(_r=!1)=>{const[Tr,Ar]=reactExports.useState(_r);return reactExports.useLayoutEffect(()=>{if(!Tr)return;const Rr=document.documentElement.style.overflow;return document.documentElement.style.overflow="hidden",()=>{document.documentElement.style.overflow=Rr}},[Tr]),reactExports.useEffect(()=>{Tr!==_r&&Ar(_r)},[_r]),[Tr,Ar]},Sr=({manifest:_r,theme:Tr})=>{const Ar=k(),Rr=F(),{activeCanvas:Pr,informationOpen:Dr,vault:Mr,configOptions:Fr}=Ar,[zr,jr]=reactExports.useState(!1),[Gr,Nr]=reactExports.useState(!1),[Lr,Ur]=reactExports.useState(void 0),[Vr,Wr]=reactExports.useState([]),[qr,Kr]=Cr(!1),Xr=Be(Z.sm),Zr=_i=>{Rr({type:"updateInformationOpen",informationOpen:_i})};return reactExports.useEffect(()=>{Fr!=null&&Fr.informationPanel.open&&Zr(!Xr)},[Xr]),reactExports.useEffect(()=>{if(!Xr){Kr(!1);return}Kr(Dr)},[Dr]),reactExports.useEffect(()=>{const _i=B(Mr,Pr),Jr=nt(Mr,Pr,"text/vtt");_i&&(Nr(["Sound","Video"].indexOf(_i.type)>-1),Ur({..._i})),Wr(Jr),jr(Jr.length!==0)},[Pr]),React$1.createElement(ErrorBoundary,{FallbackComponent:st},React$1.createElement(dt,{className:`${Tr} clover-iiif`,css:{background:Fr==null?void 0:Fr.background},"data-body-locked":qr,"data-information-panel":zr,"data-information-panel-open":Dr},React$1.createElement($409067139f391064$export$be92b6f5f03c0fe9,{open:Dr,onOpenChange:Zr},React$1.createElement(wr,{manifestLabel:_r.label,manifestId:_r.id}),React$1.createElement(tr,{activeCanvas:Pr,painting:Lr,resources:Vr,items:_r.items,isAudioVideo:Gr}))))},le={ignoreCache:!1,headers:{Accept:"application/json, text/javascript, text/plain"},timeout:5e3,withCredentials:!1};function kr(_r){return{ok:_r.status>=200&&_r.status<300,status:_r.status,statusText:_r.statusText,headers:_r.getAllResponseHeaders(),data:_r.responseText,json:()=>JSON.parse(_r.responseText)}}function se(_r,Tr=null){return{ok:!1,status:_r.status,statusText:_r.statusText,headers:_r.getAllResponseHeaders(),data:Tr||_r.statusText,json:()=>JSON.parse(Tr||_r.statusText)}}function Ir(_r,Tr=le){const Ar=Tr.headers||le.headers;return new Promise((Rr,Pr)=>{const Dr=new XMLHttpRequest;Dr.open("get",_r),Dr.withCredentials=Tr.withCredentials,Ar&&Object.keys(Ar).forEach(Mr=>Dr.setRequestHeader(Mr,Ar[Mr])),Dr.onload=()=>{Rr(kr(Dr))},Dr.onerror=()=>{Pr(se(Dr,"Failed to make request."))},Dr.ontimeout=()=>{Pr(se(Dr,"Request took longer than expected."))},Dr.send()})}const Or=({canvasIdCallback:_r=()=>{},customTheme:Tr,iiifContent:Ar,id:Rr,manifestId:Pr,options:Dr})=>{var Mr;let Fr=Ar;return Rr&&(Fr=Rr),Pr&&(Fr=Pr),React$1.createElement(tt,{initialState:{...W,informationOpen:!!((Mr=Dr==null?void 0:Dr.informationPanel)!=null&&Mr.open),vault:new Vault({customFetcher:zr=>Ir(zr,{withCredentials:Dr==null?void 0:Dr.withCredentials,headers:Dr==null?void 0:Dr.requestHeaders}).then(jr=>JSON.parse(jr.data))})}},React$1.createElement($r,{iiifContent:Fr,canvasIdCallback:_r,customTheme:Tr,options:Dr}))},$r=({canvasIdCallback:_r,customTheme:Tr,iiifContent:Ar,options:Rr})=>{const Pr=F(),Dr=k(),{activeCanvas:Mr,activeManifest:Fr,isLoaded:zr,vault:jr}=Dr,[Gr,Nr]=reactExports.useState(),[Lr,Ur]=reactExports.useState();let Vr={};return Tr&&(Vr=Q$1("custom",Tr)),reactExports.useEffect(()=>{_r&&_r(Mr)},[Mr]),reactExports.useEffect(()=>{Fr&&jr.loadManifest(Fr).then(Wr=>{Ur(Wr),Pr({type:"updateActiveCanvas",canvasId:Wr.items[0]&&Wr.items[0].id})}).catch(Wr=>{console.error(`Manifest failed to load: ${Wr}`)}).finally(()=>{Pr({type:"updateIsLoaded",isLoaded:!0})})},[Fr]),reactExports.useEffect(()=>{Pr({type:"updateConfigOptions",configOptions:Rr}),jr.load(Ar).then(Wr=>{Nr(Wr)}).catch(Wr=>{console.error(`The IIIF resource ${Ar} failed to load: ${Wr}`)})},[Ar,Rr]),reactExports.useEffect(()=>{let Wr=[];(Gr==null?void 0:Gr.type)==="Collection"?(Pr({type:"updateCollection",collection:Gr}),Wr=Gr.items.filter(qr=>qr.type==="Manifest").map(qr=>qr.id),Wr.length>0&&Pr({type:"updateActiveManifest",manifestId:Wr[0]})):(Gr==null?void 0:Gr.type)==="Manifest"&&Pr({type:"updateActiveManifest",manifestId:Gr.id})},[Gr]),zr?!Lr||!Lr.items?(console.log(`The IIIF manifest ${Ar} failed to load.`),React$1.createElement(React$1.Fragment,null)):Lr.items.length===0?(console.log(`The IIIF manifest ${Ar} does not contain canvases.`),React$1.createElement(React$1.Fragment,null)):React$1.createElement(Sr,{manifest:Lr,theme:Vr,key:Lr.id}):React$1.createElement(React$1.Fragment,null,"Loading")};function isIdBuilder(_r){return Tr=>typeof Tr=="string"&&new RegExp(_r.source,_r.flags).test(Tr)}const isNumericId=isIdBuilder(/^[1-9][0-9]*$/),isEntityId=isIdBuilder(/^((Q|P|L|M)[1-9][0-9]*|L[1-9][0-9]*-(F|S)[1-9][0-9]*)$/),isEntitySchemaId=isIdBuilder(/^E[1-9][0-9]*$/),isItemId=isIdBuilder(/^Q[1-9][0-9]*$/),isPropertyId=isIdBuilder(/^P[1-9][0-9]*$/),isLexemeId=isIdBuilder(/^L[1-9][0-9]*$/),isFormId=isIdBuilder(/^L[1-9][0-9]*-F[1-9][0-9]*$/),isSenseId=isIdBuilder(/^L[1-9][0-9]*-S[1-9][0-9]*$/),isMediaInfoId=isIdBuilder(/^M[1-9][0-9]*$/),isGuid=isIdBuilder(/^((Q|P|L|M)[1-9][0-9]*|L[1-9][0-9]*-(F|S)[1-9][0-9]*)\$[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i),isHash=isIdBuilder(/^[0-9a-f]{40}$/),isRevisionId=isIdBuilder(/^\d+$/),isNonNestedEntityId=isIdBuilder(/^(Q|P|L|M)[1-9][0-9]*$/);function isPropertyClaimsId(_r){if(typeof _r!="string")return!1;const[Tr,Ar]=_r.split("#");return isEntityId(Tr)&&isPropertyId(Ar)}function isEntityPageTitle(_r){return typeof _r!="string"?!1:_r.startsWith("Item:")?isItemId(_r.substring(5)):_r.startsWith("Lexeme:")?isLexemeId(_r.substring(7)):_r.startsWith("Property:")?isPropertyId(_r.substring(9)):isItemId(_r)}function getNumericId(_r){if(!isNonNestedEntityId(_r))throw new Error(`invalid entity id: ${_r}`);return _r.replace(/^(Q|P|L|M)/,"")}function getImageUrl(_r,Tr){let Ar=`https://commons.wikimedia.org/wiki/Special:FilePath/${_r}`;return typeof Tr=="number"&&(Ar+=`?width=${Tr}`),Ar}function getEntityIdFromGuid(_r){const Tr=_r.split(/[$-]/);if(Tr.length===6)return Tr[0].toUpperCase();if(Tr.length===7)return Tr.slice(0,2).join("-").toUpperCase();throw new Error(`invalid guid: ${_r}`)}const helpers=Object.freeze(Object.defineProperty({__proto__:null,getEntityIdFromGuid,getImageUrl,getNumericId,isEntityId,isEntityPageTitle,isEntitySchemaId,isFormId,isGuid,isHash,isItemId,isLexemeId,isMediaInfoId,isNonNestedEntityId,isNumericId,isPropertyClaimsId,isPropertyId,isRevisionId,isSenseId},Symbol.toStringTag,{value:"Module"}));function shortLang(_r){return _r.toLowerCase().split("_")[0]}function forceArray(_r){return typeof _r=="string"?[_r]:Array.isArray(_r)?[..._r]:[]}function isPlainObject(_r){return!!_r&&typeof _r=="object"&&!Array.isArray(_r)}const fixedEncodeURIComponent=_r=>encodeURIComponent(_r).replace(/[!'()*]/g,encodeCharacter),replaceSpaceByUnderscores=_r=>_r.replace(/\s/g,"_");function uniq(_r){return Array.from(new Set(_r))}const encodeCharacter=_r=>"%"+_r.charCodeAt(0).toString(16);function rejectObsoleteInterface(_r){if(_r.length!==1||!isPlainObject(_r[0]))throw new Error(`Since wikibase-sdk v9.0.0, this function expects arguments to be passed in an object
    See https://github.com/maxlath/wikibase-sdk/blob/main/CHANGELOG.md`)}function isOfType(_r,Tr){return typeof Tr=="string"&&_r.includes(Tr)}function isAKey(_r,Tr){return Object.prototype.hasOwnProperty.call(_r,Tr)}function typedEntries(_r){return Object.entries(_r)}function wikibaseTimeToDateObject(_r){typeof _r=="object"&&(_r=_r.time);const Tr=_r[0];let[Ar,Rr]=_r.slice(1).split("T");Ar=Ar.replace(/-00/g,"-01");const Pr=`${Ar}T${Rr}`;return fullDateData(Tr,Pr)}const fullDateData=(_r,Tr)=>{const Ar=Tr.split("-")[0];return _r==="-"||Ar.length>4?expandedYearDate(_r,Tr,Ar):new Date(Tr)},expandedYearDate=(_r,Tr,Ar)=>{let Rr;return Ar.length===4?Rr=`${_r}00${Tr}`:Ar.length===5?Rr=`${_r}0${Tr}`:Rr=_r+Tr,new Date(Rr)};function bestEffort(_r){return Tr=>{try{return _r(Tr)}catch{Tr=typeof Tr=="string"?Tr:Tr.time;const Rr=Tr[0];let[Pr,Dr]=Tr.slice(1).split("T");if(!Rr||!Pr||!Dr)throw new Error("TimeInput is invalid: "+JSON.stringify(Tr));return Pr=Pr.replace(/-00/g,"-01"),`${Rr}${Pr}T${Dr}`}}}const toEpochTime=_r=>wikibaseTimeToDateObject(_r).getTime(),toISOString=_r=>wikibaseTimeToDateObject(_r).toISOString(),toSimpleDay=_r=>{if(typeof _r=="object"){const{time:Tr,precision:Ar}=_r;Ar===9?_r=Tr.replace("-01-01T","-00-00T"):Ar===10?_r=Tr.replace("-01T","-00T"):_r=Tr}return _r.split("T")[0].replace(/^\+/,"").replace(/^(-?)0+/,"$1").replace(/-00$/,"").replace(/-00$/,"")},wikibaseTimeToEpochTime=bestEffort(toEpochTime),wikibaseTimeToISOString=bestEffort(toISOString),wikibaseTimeToSimpleDay=bestEffort(toSimpleDay),timeHelpers=Object.freeze(Object.defineProperty({__proto__:null,wikibaseTimeToDateObject,wikibaseTimeToEpochTime,wikibaseTimeToISOString,wikibaseTimeToSimpleDay},Symbol.toStringTag,{value:"Module"})),simple=_r=>_r.value,monolingualtext=(_r,Tr)=>Tr.keepRichValues?_r.value:_r.value.text,entity=(_r,Tr)=>prefixedId(_r,Tr.entityPrefix),entityLetter={item:"Q",lexeme:"L",property:"P"},prefixedId=(_r,Tr)=>{const{value:Ar}=_r,Rr=Ar.id||entityLetter[Ar["entity-type"]]+Ar["numeric-id"];return typeof Tr=="string"?`${Tr}:${Rr}`:Rr},quantity=(_r,Tr)=>{const{value:Ar}=_r,Rr=parseFloat(Ar.amount);if(Tr.keepRichValues){const Pr={amount:parseFloat(Ar.amount),unit:Ar.unit.replace(/^https?:\/\/.*\/entity\//,"")};return Ar.upperBound!=null&&(Pr.upperBound=parseFloat(Ar.upperBound)),Ar.lowerBound!=null&&(Pr.lowerBound=parseFloat(Ar.lowerBound)),Pr}else return Rr},coordinate=(_r,Tr)=>Tr.keepRichValues?_r.value:[_r.value.latitude,_r.value.longitude],time=(_r,Tr)=>{let Ar;if(typeof Tr.timeConverter=="function"?Ar=Tr.timeConverter(_r.value):Ar=getTimeConverter(Tr.timeConverter)(_r.value),Tr.keepRichValues){const{timezone:Rr,before:Pr,after:Dr,precision:Mr,calendarmodel:Fr}=_r.value;return{time:Ar,timezone:Rr,before:Pr,after:Dr,precision:Mr,calendarmodel:Fr}}else return Ar},getTimeConverter=(_r="iso")=>{const Tr=timeConverters[_r];if(!Tr)throw new Error(`invalid converter key: ${JSON.stringify(_r).substring(0,100)}`);return Tr},timeConverters={iso:wikibaseTimeToISOString,epoch:wikibaseTimeToEpochTime,"simple-day":wikibaseTimeToSimpleDay,none:_r=>typeof _r=="string"?_r:_r.time},parsers={commonsMedia:simple,"external-id":simple,"geo-shape":simple,"globe-coordinate":coordinate,math:simple,monolingualtext,"musical-notation":simple,quantity,string:simple,"tabular-data":simple,time,url:simple,"wikibase-entityid":entity,"wikibase-form":entity,"wikibase-item":entity,"wikibase-lexeme":entity,"wikibase-property":entity,"wikibase-sense":entity},normalizeDatatype=_r=>_r.toLowerCase().replace(/[\s-]/g,""),normalizedParsers={};for(const[_r,Tr]of Object.entries(parsers))normalizedParsers[normalizeDatatype(_r)]=Tr;function parseClaim(_r,Tr,Ar,Rr){_r=_r||Tr.type;try{const Pr=normalizedParsers[normalizeDatatype(_r)];return Pr(Tr,Ar)}catch(Pr){throw Pr.message==="parsers[datatype] is not a function"&&(Pr.message=`${_r} claim parser isn't implemented
      Claim id: ${Rr}
      Please report to https://github.com/maxlath/wikibase-sdk/issues`),Pr}}function truthyPropertyClaims(_r){const Tr={};for(const Ar of _r){const{rank:Rr}=Ar;Tr[Rr]=Tr[Rr]||[],Tr[Rr].push(Ar)}return Tr.preferred||Tr.normal||[]}function nonDeprecatedPropertyClaims(_r){return _r.filter(Tr=>Tr.rank!=="deprecated")}function truthyClaims(_r){const Tr={};for(const[Ar,Rr]of typedEntries(_r))Tr[Ar]=truthyPropertyClaims(Rr);return Tr}const rankHelpers=Object.freeze(Object.defineProperty({__proto__:null,nonDeprecatedPropertyClaims,truthyClaims,truthyPropertyClaims},Symbol.toStringTag,{value:"Module"}));function simplifySnaks(_r,Tr){const{propertyPrefix:Ar}=Tr,Rr={};for(let Pr in _r){const Dr=_r[Pr];Ar&&(Pr=Ar+":"+Pr),Rr[Pr]=simplifyPropertySnaks(Dr,Tr)}return Rr}function simplifyPropertySnaks(_r,Tr){if(_r==null||_r.length===0)return[];const{keepNonTruthy:Ar,keepNonDeprecated:Rr,areSubSnaks:Pr}=parseKeepOptions(Tr);return Rr?_r=nonDeprecatedPropertyClaims(_r):Ar||Pr||(_r=truthyPropertyClaims(_r)),_r=_r.map(Dr=>simplifyClaim(Dr,Tr)).filter(Dr=>Dr!==void 0),_r[0]&&typeof _r[0]!="object"?uniq(_r):_r}function simplifySnak(_r,Tr){const{keepQualifiers:Ar,keepReferences:Rr,keepIds:Pr,keepHashes:Dr,keepTypes:Mr,keepSnaktypes:Fr,keepRanks:zr}=parseKeepOptions(Tr),{mainsnak:jr,rank:Gr}=_r;let Nr,Lr,Ur,Vr,Wr,qr;if(jr?(Lr=jr.datatype,Ur=jr.datavalue,Vr=jr.snaktype):(Ur=_r.datavalue,Lr=_r.datatype,Vr=_r.snaktype,_r.hash?Wr=!0:qr=!0),Ur)Nr=parseClaim(Lr,Ur,Tr,_r.id);else if(Vr==="somevalue")Nr=Tr.somevalueValue;else if(Vr==="novalue")Nr=Tr.novalueValue;else throw new Error("no datavalue or special snaktype found");if(Wr){if(!(Dr||Mr||Fr))return Nr;const Zr={value:Nr};return Dr&&(Zr.hash=_r.hash),Mr&&(Zr.type=Lr),Fr&&(Zr.snaktype=Vr),Zr}if(qr)return Mr?{type:Lr,value:Nr}:Nr;if(!(Ar||Rr||Pr||Mr||Fr||zr))return Nr;const Kr={value:Nr};Mr&&(Kr.type=Lr),Fr&&(Kr.snaktype=Vr),zr&&(Kr.rank=Gr);const Xr=getSubSnakOptions(Tr);return Xr.keepHashes=Dr,Ar&&(Kr.qualifiers=simplifyQualifiers(_r.qualifiers,Xr)),Rr&&(_r.references=_r.references||[],Kr.references=simplifyReferences(_r.references,Xr)),Pr&&(Kr.id=_r.id),Kr}function simplifyClaims(_r,Tr={}){return simplifySnaks(_r,Tr)}function simplifyPropertyClaims(_r,Tr={}){return simplifyPropertySnaks(_r,Tr)}function simplifyClaim(_r,Tr={}){return simplifySnak(_r,Tr)}function simplifyQualifiers(_r,Tr={}){return simplifySnaks(_r,getSubSnakOptions(Tr))}function simplifyPropertyQualifiers(_r,Tr={}){return simplifyPropertySnaks(_r,getSubSnakOptions(Tr))}function simplifyQualifier(_r,Tr={}){return simplifySnak(_r,Tr)}function simplifyReferences(_r,Tr={}){return _r.map(Ar=>simplifyReferenceRecord(Ar,Tr))}function simplifyReferenceRecord(_r,Tr={}){const Ar=getSubSnakOptions(Tr),Rr=simplifySnaks(_r.snaks,Ar);return Ar.keepHashes?{snaks:Rr,hash:_r.hash}:Rr}const getSubSnakOptions=(_r={})=>_r.areSubSnaks?_r:Object.assign({},_r,{areSubSnaks:!0}),keepOptions=["keepQualifiers","keepReferences","keepIds","keepHashes","keepTypes","keepSnaktypes","keepRanks","keepRichValues"],parseKeepOptions=(_r={})=>(_r.keepAll&&keepOptions.forEach(Tr=>{_r[Tr]==null&&(_r[Tr]=!0)}),_r);function singleValue(_r){const Tr={};for(const[Ar,Rr]of typedEntries(_r))Tr[Ar]=Rr!=null?Rr.value:null;return Tr}function multiValue(_r){const Tr={};for(const[Ar,Rr]of typedEntries(_r))Tr[Ar]=Rr!=null?Rr.map(Pr=>Pr.value):[];return Tr}function simplifyLabels(_r){return singleValue(_r)}function simplifyDescriptions(_r){return singleValue(_r)}function simplifyAliases(_r){return multiValue(_r)}function simplifyLemmas(_r){return singleValue(_r)}function simplifyRepresentations(_r){return singleValue(_r)}function simplifyGlosses(_r){return singleValue(_r)}const simplifyForm=(_r,Tr={})=>{const{id:Ar,representations:Rr,grammaticalFeatures:Pr,claims:Dr}=_r;if(!isFormId(Ar))throw new Error("invalid form object");return{id:Ar,representations:simplifyRepresentations(Rr),grammaticalFeatures:Pr,claims:simplifyClaims(Dr,Tr)}},simplifyForms=(_r,Tr={})=>_r.map(Ar=>simplifyForm(Ar,Tr)),simplifySense=(_r,Tr={})=>{const{id:Ar,glosses:Rr,claims:Pr}=_r;if(!isSenseId(Ar))throw new Error("invalid sense object");return{id:Ar,glosses:simplifyGlosses(Rr),claims:simplifyClaims(Pr,Tr)}};function simplifySenses(_r,Tr={}){return _r.map(Ar=>simplifySense(Ar,Tr))}const languages=["aa","ab","ace","ady","af","ak","als","alt","ami","am","ang","anp","an","arc","ar","ary","arz","ast","as","atj","avk","av","awa","ay","azb","az","ban","bar","bat_smg","ba","bcl","be_x_old","be","bg","bh","bi","bjn","blk","bm","bn","bo","bpy","br","bs","bug","bxr","ca","cbk_zam","cdo","ceb","ce","cho","chr","ch","chy","ckb","co","crh","cr","csb","cs","cu","cv","cy","dag","da","de","din","diq","dsb","dty","dv","dz","ee","el","eml","en","eo","es","et","eu","ext","fa","ff","fiu_vro","fi","fj","fo","frp","frr","fr","fur","fy","gag","gan","ga","gcr","gd","glk","gl","gn","gom","gor","got","guc","gur","gu","guw","gv","hak","ha","haw","he","hif","hi","ho","hr","hsb","ht","hu","hy","hyw","hz","ia","id","ie","ig","ii","ik","ilo","inh","io","is","it","iu","jam","ja","jbo","jv","kaa","kab","ka","kbd","kbp","kcg","kg","ki","kj","kk","kl","km","kn","koi","ko","krc","kr","ksh","ks","ku","kv","kw","ky","lad","la","lbe","lb","lez","lfn","lg","lij","li","lld","lmo","ln","lo","lrc","ltg","lt","lv","mad","mai","map_bms","mdf","mg","mhr","mh","min","mi","mk","ml","mni","mn","mnw","mo","mrj","mr","ms","mt","mus","mwl","myv","my","mzn","nah","nap","na","nds_nl","nds","ne","new","ng","nia","nl","nn","nov","no","nqo","nrm","nso","nv","ny","oc","olo","om","or","os","pag","pam","pap","pa","pcd","pcm","pdc","pfl","pih","pi","pl","pms","pnb","pnt","ps","pt","pwn","qu","rm","rmy","rn","roa_rup","roa_tara","ro","rue","ru","rw","sah","sat","sa","scn","sco","sc","sd","se","sg","shi","shn","sh","shy","simple","si","skr","sk","sl","smn","sm","sn","sources","so","sq","srn","sr","ss","stq","st","su","sv","sw","szl","szy","ta","tay","tcy","tet","te","tg","th","ti","tk","tl","tn","to","tpi","trv","tr","ts","tt","tum","tw","tyv","ty","udm","ug","uk","ur","uz","vec","vep","ve","vi","vls","vo","war","wa","wo","wuu","xal","xh","xmf","yi","yo","yue","za","zea","zh_classical","zh_min_nan","zh_yue","zh","zu"],specialSites={commonswiki:"commons",mediawikiwiki:"mediawiki",metawiki:"meta",specieswiki:"specieswiki",wikidatawiki:"wikidata",wikimaniawiki:"wikimania"},wikidataBase="https://www.wikidata.org/wiki/";function getSitelinkUrl({site:_r,title:Tr}){if(rejectObsoleteInterface(arguments),!_r)throw new Error("missing a site");if(!Tr)throw new Error("missing a title");if(isAKey(siteUrlBuilders,_r))return siteUrlBuilders[_r](Tr);const Ar=_r.replace(/wiki$/,"");if(isAKey(siteUrlBuilders,Ar))return siteUrlBuilders[Ar](Tr);const{lang:Rr,project:Pr}=getSitelinkData(_r);return Tr=fixedEncodeURIComponent(replaceSpaceByUnderscores(Tr)),`https://${Rr}.${Pr}.org/wiki/${Tr}`}const wikimediaSite=_r=>Tr=>`https://${_r}.wikimedia.org/wiki/${Tr}`,siteUrlBuilders={commons:wikimediaSite("commons"),mediawiki:_r=>`https://www.mediawiki.org/wiki/${_r}`,meta:wikimediaSite("meta"),species:wikimediaSite("species"),wikidata:_r=>{const Tr=prefixByEntityLetter[_r[0]];let Ar=Tr?`${Tr}:${_r}`:_r;return Ar=Ar.replace("-","#"),`${wikidataBase}${Ar}`},wikimania:wikimediaSite("wikimania")},prefixByEntityLetter={E:"EntitySchema",L:"Lexeme",P:"Property"},sitelinkUrlPattern=/^https?:\/\/([\w-]{2,10})\.(\w+)\.org\/\w+\/(.*)/;function getSitelinkData(_r){if(_r.startsWith("http")){const Tr=_r,Ar=Tr.match(sitelinkUrlPattern);if(!Ar)throw new Error(`invalid sitelink url: ${Tr}`);let[Rr,Pr,Dr]=Ar.slice(1);Dr=decodeURIComponent(Dr);let Mr;return Rr==="www"?(Rr="en",Mr=Pr):Rr==="commons"?(Rr="en",Pr=Mr="commons"):(Rr=Rr.replace(/-/g,"_"),Mr=`${Rr}${Pr}`.replace("wikipedia","wiki")),{lang:Rr,project:Pr,key:Mr,title:Dr,url:Tr}}else{const Tr=_r;if(isAKey(specialSites,_r))return{lang:"en",project:specialSites[_r],key:Tr};let[Ar,Rr,Pr]=Tr.split("wik");if(Pr!=null)throw new Error(`invalid sitelink key: ${Tr}`);if(!isOfType(languages,Ar))throw new Error(`sitelink lang not found: ${Ar}. Updating wikibase-sdk to a more recent version might fix the issue.`);Ar=Ar.replace(/_/g,"-");const Dr=projectsBySuffix[Rr];if(!Dr)throw new Error(`sitelink project not found: ${Dr}`);return{lang:Ar,project:Dr,key:Tr}}}const isSitelinkKey=_r=>{try{return getSitelinkData(_r),!0}catch{return!1}},wikimediaLanguageCodes=languages,projectsBySuffix={i:"wikipedia",isource:"wikisource",iquote:"wikiquote",tionary:"wiktionary",ibooks:"wikibooks",iversity:"wikiversity",ivoyage:"wikivoyage",inews:"wikinews"};[...Object.values(projectsBySuffix),...Object.values(specialSites)];const sitelinksHelpers=Object.freeze(Object.defineProperty({__proto__:null,getSitelinkData,getSitelinkUrl,isSitelinkKey,wikimediaLanguageCodes},Symbol.toStringTag,{value:"Module"}));function simplifySitelinks(_r,Tr={}){let{addUrl:Ar,keepBadges:Rr,keepAll:Pr}=Tr;return Rr=Rr||Pr,Object.keys(_r).reduce(aggregateValues({sitelinks:_r,addUrl:Ar,keepBadges:Rr}),{})}const aggregateValues=({sitelinks:_r,addUrl:Tr,keepBadges:Ar})=>(Rr,Pr)=>{if(_r[Pr]==null)return Rr[Pr]=_r[Pr],Rr;const{title:Dr,badges:Mr}=_r[Pr];return Tr||Ar?(Rr[Pr]={title:Dr},Tr&&(Rr[Pr].url=getSitelinkUrl({site:Pr,title:Dr})),Ar&&(Rr[Pr].badges=Mr)):Rr[Pr]=Dr,Rr},simplify$1={labels:simplifyLabels,descriptions:simplifyDescriptions,aliases:simplifyAliases,claims:simplifyClaims,statements:simplifyClaims,sitelinks:simplifySitelinks,lemmas:simplifyLemmas,forms:simplifyForms,senses:simplifySenses},simplifyEntity=(_r,Tr={})=>{const{type:Ar}=_r,Rr={id:_r.id,type:Ar,modified:_r.modified};return Ar==="item"?(simplifyIfDefined(_r,Rr,"labels"),simplifyIfDefined(_r,Rr,"descriptions"),simplifyIfDefined(_r,Rr,"aliases"),simplifyIfDefined(_r,Rr,"claims",Tr),simplifyIfDefined(_r,Rr,"sitelinks",Tr)):Ar==="property"?(Rr.datatype=_r.datatype,simplifyIfDefined(_r,Rr,"labels"),simplifyIfDefined(_r,Rr,"descriptions"),simplifyIfDefined(_r,Rr,"aliases"),simplifyIfDefined(_r,Rr,"claims",Tr)):Ar==="lexeme"?(simplifyIfDefined(_r,Rr,"lemmas"),Rr.lexicalCategory=_r.lexicalCategory,Rr.language=_r.language,simplifyIfDefined(_r,Rr,"claims",Tr),simplifyIfDefined(_r,Rr,"forms",Tr),simplifyIfDefined(_r,Rr,"senses",Tr)):Ar==="mediainfo"&&(simplifyIfDefined(_r,Rr,"labels"),simplifyIfDefined(_r,Rr,"descriptions"),simplifyIfDefined(_r,Rr,"statements",Tr)),Rr},simplifyIfDefined=(_r,Tr,Ar,Rr)=>{_r[Ar]!=null&&(Tr[Ar]=simplify$1[Ar](_r[Ar],Rr))},simplifyEntities=(_r,Tr={})=>{_r.entities&&(_r=_r.entities);const{entityPrefix:Ar}=Tr,Rr={};for(const[Pr,Dr]of Object.entries(_r)){const Mr=Ar?`${Ar}:${Pr}`:Pr;Rr[Mr]=simplifyEntity(Dr,Tr)}return Rr};function entities(_r){_r=_r.body||_r;const{entities:Tr}=_r;return simplifyEntities(Tr)}function pagesTitles(_r){return _r=_r.body||_r,_r.query.search.map(Tr=>Tr.title)}const parse=Object.freeze(Object.defineProperty({__proto__:null,entities,pagesTitles},Symbol.toStringTag,{value:"Module"}));function simplifySparqlResults(_r,Tr={}){typeof _r=="string"&&(_r=JSON.parse(_r));const{vars:Ar}=_r.head,Rr=_r.results.bindings;if(Ar.length===1&&Tr.minimize){const Fr=Ar[0];return Rr.map(zr=>parseValue(zr[Fr])).filter(zr=>zr!=null)}const{richVars:Pr,associatedVars:Dr,standaloneVars:Mr}=identifyVars(Ar);return Rr.map(Fr=>getSimplifiedResult(Pr,Dr,Mr,Fr))}function parseValue(_r){if(!_r||_r.type==="bnode")return null;const{value:Tr}=_r;if(_r.type==="uri")return parseUri(Tr);const Ar=(_r.datatype||"").replace("http://www.w3.org/2001/XMLSchema#","");return Ar==="decimal"||Ar==="integer"||Ar==="float"||Ar==="double"?parseFloat(Tr):Ar==="boolean"?Tr==="true":Tr}function parseUri(_r){return _r.match(/http.*\/entity\/statement\//)?convertStatementUriToGuid(_r):_r.replace(/^https?:\/\/.*\/entity\//,"").replace(/^https?:\/\/.*\/prop\/direct\//,"")}function convertStatementUriToGuid(_r){_r=_r.replace(/^https?:\/\/.*\/entity\/statement\//,"");const Tr=_r.split("-");return Tr[0]+"$"+Tr.slice(1).join("-")}function identifyVars(_r){let Tr=_r.filter(Dr=>{const Mr=new RegExp(`^${Dr}[A-Z]\\w+`);return _r.some(Fr=>Mr.test(Fr))});Tr=Tr.filter(Dr=>!Tr.some(Mr=>Dr!==Mr&&Dr.startsWith(Mr)));const Ar=new RegExp(`^(${Tr.join("|")})[A-Z]`),Rr=_r.filter(Dr=>Ar.test(Dr)),Pr=_r.filter(Dr=>!Tr.includes(Dr)&&!Ar.test(Dr));return{richVars:Tr,associatedVars:Rr,standaloneVars:Pr}}function getSimplifiedResult(_r,Tr,Ar,Rr){const Pr={};for(const Dr of _r){const Mr={},Fr=parseValue(Rr[Dr]);Fr!=null&&(Mr.value=Fr);for(const zr of Tr)zr.startsWith(Dr)&&addAssociatedValue(Rr,Dr,zr,Mr);Object.keys(Mr).length>0&&(Pr[Dr]=Mr)}for(const Dr of Ar){const Mr=parseValue(Rr[Dr]);Mr!=null&&(Pr[Dr]=Mr)}return Pr}function addAssociatedValue(_r,Tr,Ar,Rr){let Pr=Ar.split(Tr)[1];Pr=Pr[0].toLowerCase()+Pr.slice(1),Pr=Pr==="altLabel"?"aliases":Pr;const Dr=_r[Ar];Dr!=null&&(Rr[Pr]=Dr.value)}const simplify=Object.freeze(Object.defineProperty({__proto__:null,aliases:simplifyAliases,claim:simplifyClaim,claims:simplifyClaims,descriptions:simplifyDescriptions,entities:simplifyEntities,entity:simplifyEntity,form:simplifyForm,forms:simplifyForms,glosses:simplifyGlosses,labels:simplifyLabels,lemmas:simplifyLemmas,propertyClaims:simplifyPropertyClaims,propertyQualifiers:simplifyPropertyQualifiers,propertySnaks:simplifyPropertyClaims,qualifier:simplifyQualifier,qualifiers:simplifyQualifiers,references:simplifyReferences,representations:simplifyRepresentations,sense:simplifySense,senses:simplifySenses,sitelinks:simplifySitelinks,snak:simplifyClaim,snaks:simplifyClaims,sparqlResults:simplifySparqlResults},Symbol.toStringTag,{value:"Module"})),namespacePattern=/^\d+[|\d]*$/;function cirrusSearchPagesFactory(_r){return function(Ar){rejectObsoleteInterface(arguments);for(const[Vr,Wr]of Object.entries(Ar))if(Vr.startsWith("sr")){const qr=Vr.replace(/^sr/,"");if(!isAKey(Ar,qr))throw new Error(`${Vr} is not a valid option`);if(Ar[qr]!=null)throw new Error(`${qr} and ${Vr} are the same`);Ar[qr]=Wr}const{search:Rr,haswbstatement:Pr,format:Dr="json",limit:Mr,offset:Fr,profile:zr,sort:jr}=Ar;let{namespace:Gr,prop:Nr}=Ar;if(!(Rr||Pr))throw new Error('missing "search" or "haswbstatement" parameter');let Lr="";if(Rr&&(Lr+=Rr),Pr){const Vr=Pr instanceof Array?Pr:[Pr];for(const Wr of Vr)Wr[0]==="-"?Lr+=` -haswbstatement:${Wr.slice(1)}`:Lr+=` haswbstatement:${Wr}`}if(Mr!=null&&(typeof Mr!="number"||Mr<1))throw new Error(`invalid limit: ${Mr}`);if(Fr!=null&&(typeof Fr!="number"||Fr<0))throw new Error(`invalid offset: ${Fr}`);if(Gr instanceof Array?Gr=Gr.join("|"):typeof Gr=="number"&&(Gr=Gr.toString()),Gr&&!namespacePattern.test(Gr))throw new Error(`invalid namespace: ${Gr}`);if(zr!=null&&typeof zr!="string")throw new Error(`invalid profile: ${zr} (${typeof zr}, expected string)`);if(jr!=null&&typeof jr!="string")throw new Error(`invalid sort: ${jr} (${typeof jr}, expected string)`);let Ur;if(Nr!=null){if(Nr instanceof Array&&(Nr=Nr.join("|")),typeof Nr!="string")throw new Error(`invalid prop: ${Nr} (${typeof Nr}, expected string)`);Ur=Nr.toString()}return _r({action:"query",list:"search",srsearch:Lr.trim(),format:Dr,srnamespace:Gr,srlimit:Mr,sroffset:Fr,srqiprofile:zr,srsort:jr,srprop:Ur})}}function validate(_r,Tr){return function(Ar){if(!Tr(Ar))throw new Error(`invalid ${_r}: ${Ar} (type: ${typeOf(Ar)})`)}}const entityId=validate("entity id",isEntityId),propertyId=validate("property id",isPropertyId),entityPageTitle=validate("entity page title",isEntityPageTitle),revisionId=validate("revision id",isRevisionId);function typeOf(_r){const Tr=typeof _r;if(Tr==="object"){if(_r===null)return"null";if(_r instanceof Array)return"array";if(_r instanceof Promise)return"promise"}return Tr==="number"&&Number.isNaN(_r)?"NaN":Tr}function getEntitiesFactory(_r){return function({ids:Ar,languages:Rr,props:Pr,format:Dr="json",redirects:Mr}){if(rejectObsoleteInterface(arguments),!(Ar&&Ar.length>0))throw new Error("no id provided");Ar=forceArray(Ar),Ar.forEach(zr=>entityId(zr)),Ar.length>50&&console.warn(`getEntities accepts 50 ids max to match Wikidata API limitations:
      this request won't get all the desired entities.
      You can use getManyEntities instead to generate several request urls
      to work around this limitation`);const Fr={action:"wbgetentities",ids:Ar.join("|"),format:Dr};return Mr===!1&&(Fr.redirects="no"),Rr&&(Rr=forceArray(Rr).map(shortLang),Fr.languages=Rr.join("|")),Pr&&Pr.length>0&&(Fr.props=forceArray(Pr).join("|")),_r(Fr)}}function getEntitiesFromSitelinksFactory(_r){return function({titles:Ar,sites:Rr,languages:Pr,props:Dr,format:Mr="json",redirects:Fr}){if(rejectObsoleteInterface(arguments),!(Ar&&Ar.length>0))throw new Error("no titles provided");Rr&&Rr.length>0||(Rr=["enwiki"]),Ar=forceArray(Ar),Rr=forceArray(Rr).map(parseSite),Dr=forceArray(Dr);const zr={action:"wbgetentities",titles:Ar.join("|"),sites:Rr.join("|"),format:Mr};return Rr.length===1&&Ar.length===1&&(zr.normalize=!0),Pr&&(Pr=forceArray(Pr).map(shortLang),zr.languages=Pr.join("|")),Dr.length>0&&(zr.props=Dr.join("|")),Fr===!1&&(zr.redirects="no"),_r(zr)}}function parseSite(_r){return isOfType(languages,_r)?`${_r}wiki`:_r}function getEntityRevisionFactory(_r,Tr){return function({id:Rr,revision:Pr}){return rejectObsoleteInterface(arguments),entityId(Rr),revisionId(Pr),`${_r}/${Tr}/index.php?title=Special:EntityData/${Rr}.json&revision=${Pr}`}}function getManyEntitiesFactory(_r){const Tr=getEntitiesFactory(_r);return function({ids:Rr,languages:Pr,props:Dr,format:Mr,redirects:Fr}){if(rejectObsoleteInterface(arguments),!(Rr instanceof Array))throw new Error("getManyEntities expects an array of ids");return getChunks(Rr).map(zr=>Tr({ids:zr,languages:Pr,props:Dr,format:Mr,redirects:Fr}))}}function getChunks(_r){const Tr=[];for(;_r.length>0;){const Ar=_r.slice(0,50);_r=_r.slice(50),Tr.push(Ar)}return Tr}function sparqlQueryFactory(_r){return function(Ar){const Rr=fixedEncodeURIComponent(Ar);return`${_r}?format=json&query=${Rr}`}}const itemsOnly="FILTER NOT EXISTS { ?subject rdf:type wikibase:Property . } ",getReverseClaimsFactory=_r=>{const Tr=sparqlQueryFactory(_r);return function(Rr){let{properties:Pr}=Rr;const{values:Dr,limit:Mr,caseInsensitive:Fr,keepProperties:zr}=Rr,jr=Fr?caseInsensitiveValueQuery:directValueQuery,Gr=zr?"":itemsOnly;Pr=forceArray(Pr),Pr.forEach(Ur=>propertyId(Ur));let Lr=`SELECT DISTINCT ?subject WHERE { ${getValueBlock(Dr,jr,Pr,Gr)} }`;return Mr&&(Lr+=` LIMIT ${Mr}`),Tr(Lr)}},getValueBlock=(_r,Tr,Ar,Rr)=>(Ar=Ar.map(prefixifyProperty).join("|"),_r instanceof Array?"{ "+_r.map(getValueString).map(Dr=>Tr(Ar,Dr,Rr)).join("} UNION {")+" }":Tr(Ar,getValueString(_r),Rr)),getValueString=_r=>(isItemId(_r)?_r=`wd:${_r}`:typeof _r=="string"&&(_r=`'${_r}'`),_r),directValueQuery=(_r,Tr,Ar)=>`?subject ${_r} ${Tr} .
    ${Ar}`,caseInsensitiveValueQuery=(_r,Tr,Ar)=>`?subject ${_r} ?value .
    FILTER (lcase(?value) = ${Tr.toLowerCase()})
    ${Ar}`,prefixifyProperty=_r=>"wdt:"+_r;function getRevisionsFactory(_r){return function({ids:Ar,format:Rr,limit:Pr,start:Dr,end:Mr,prop:Fr,user:zr,excludeuser:jr,tag:Gr}){rejectObsoleteInterface(arguments),Ar=forceArray(Ar),Ar.forEach(Ur=>entityPageTitle(Ur));const Nr=Ar.length===1,Lr={action:"query",prop:"revisions"};return Lr.titles=Ar.join("|"),Lr.format=Rr||"json",Nr&&(Lr.rvlimit=Pr||"max"),Nr&&Dr&&(Lr.rvstart=getEpochSeconds(Dr)),Nr&&Mr&&(Lr.rvend=getEpochSeconds(Mr)),Fr?Lr.rvprop=forceArray(Fr).join("|"):Lr.rvprop="ids|flags|timestamp|user|userid|size|slotsize|sha1|slotsha1|contentmodel|comment|parsedcomment|content|tags|roles|oresscores",Lr.rvslots="*",zr&&(Lr.rvuser=zr),jr&&(Lr.rvexcludeuser=jr),Gr&&(Lr.rvtag=Gr),_r(Lr)}}const getEpochSeconds=_r=>typeof _r=="number"&&_r<earliestPointInMs?_r:Math.trunc(new Date(_r).getTime()/1e3),earliestPointInMs=new Date("2000-01-01").getTime(),EntityTypes=["item","property","lexeme","form","sense"],searchEntitiesFactory=_r=>function({search:Ar,language:Rr="en",uselang:Pr,limit:Dr="20",continue:Mr="0",format:Fr="json",type:zr="item"}){if(rejectObsoleteInterface(arguments),Pr=Pr||Rr,!(Ar&&Ar.length>0))throw new Error("search can't be empty");if(!isOfType(EntityTypes,zr))throw new Error(`invalid type: ${zr}`);return _r({action:"wbsearchentities",search:Ar,language:Rr,limit:Dr,continue:Mr,format:Fr,uselang:Pr,type:zr})},isBrowser=typeof location<"u"&&typeof document<"u";function buildUrlFactory(_r){return Tr=>{isBrowser&&(Tr=Object.assign(Object.assign({},Tr),{origin:"*"}));const Ar=Object.entries(Tr).filter(([,Pr])=>Pr!=null).map(([Pr,Dr])=>[Pr,String(Dr)]),Rr=new URLSearchParams(Ar).toString();return _r+"?"+Rr}}const tip=`Tip: if you just want to access functions that don't need an instance or a sparqlEndpoint,
those are also exposed directly on the module object. Exemple:
import { isItemId, simplify } from 'wikibase-sdk'`,common=Object.assign(Object.assign(Object.assign(Object.assign({simplify,parse},helpers),sitelinksHelpers),rankHelpers),timeHelpers);function WBK(_r){if(!isPlainObject(_r))throw new Error("invalid config");const{instance:Tr,sparqlEndpoint:Ar}=_r;let{wgScriptPath:Rr="w"}=_r;if(Rr=Rr.replace(/^\//,""),!(Tr||Ar))throw new Error(`one of instance or sparqlEndpoint should be set at initialization.
${tip}`);let Pr,Dr,Mr;if(Tr){validateEndpoint("instance",Tr),Dr=Tr.replace(/\/$/,"").replace(`/${Rr}/api.php`,""),Mr=`${Dr}/${Rr}/api.php`;const zr=buildUrlFactory(Mr);Pr={searchEntities:searchEntitiesFactory(zr),cirrusSearchPages:cirrusSearchPagesFactory(zr),getEntities:getEntitiesFactory(zr),getManyEntities:getManyEntitiesFactory(zr),getRevisions:getRevisionsFactory(zr),getEntityRevision:getEntityRevisionFactory(Tr,Rr),getEntitiesFromSitelinks:getEntitiesFromSitelinksFactory(zr)}}else Pr={searchEntities:missingInstance("searchEntities"),cirrusSearchPages:missingInstance("cirrusSearchPages"),getEntities:missingInstance("getEntities"),getManyEntities:missingInstance("getManyEntities"),getRevisions:missingInstance("getRevisions"),getEntityRevision:missingInstance("getEntityRevision"),getEntitiesFromSitelinks:missingInstance("getEntitiesFromSitelinks")};let Fr;return Ar?(validateEndpoint("sparqlEndpoint",Ar),Fr={sparqlQuery:sparqlQueryFactory(Ar),getReverseClaims:getReverseClaimsFactory(Ar)}):Fr={sparqlQuery:missingSparqlEndpoint("sparqlQuery"),getReverseClaims:missingSparqlEndpoint("getReverseClaims")},Object.assign(Object.assign(Object.assign({instance:{root:Dr,apiEndpoint:Mr}},common),Pr),Fr)}const validateEndpoint=(_r,Tr)=>{if(!(typeof Tr=="string"&&Tr.startsWith("http")))throw new Error(`invalid ${_r}: ${Tr}`)},missingConfig=_r=>Tr=>()=>{throw new Error(`${Tr} requires ${_r} to be set at initialization`)},missingSparqlEndpoint=missingConfig("a sparqlEndpoint"),missingInstance=missingConfig("an instance"),api={sparqlQuery:()=>{const _r=WBK({instance:"https://www.wikidata.org",sparqlEndpoint:"https://query.wikidata.org/sparql"}),Rr=`
    SELECT ?work ?workLabel (YEAR(?inception) as ?year) ?countryLabel ?locationLabel ?iiif
    WHERE
    {
      ?work wdt:P31 wd:Q3305213.
      ?work wdt:P17 ?country.
      ?work wdt:P186 wd:Q12321255.
      ?work wdt:P571 ?inception.
      ?work wdt:P276 ?location.
      ?work wdt:P6108 ?iiif
    FILTER (?country IN ( wd:Q31, wd:Q213, wd:Q35, wd:Q142, wd:Q36, wd:Q39, wd:Q32, wd:Q40, wd:Q55 ) )
    SERVICE wikibase:label { bd:serviceParam wikibase:language "[AUTO_LANGUAGE],en" }
    }
    ORDER BY ?year ?work ?workLabel
    LIMIT 10
    `;return _r.sparqlQuery(Rr)}};/*! For license information please see browser.mjs.LICENSE.txt */var __webpack_modules__={486:function(_r,Tr,Ar){var Rr;_r=Ar.nmd(_r),(function(){var Pr,Dr="Expected a function",Mr="__lodash_hash_undefined__",Fr="__lodash_placeholder__",zr=32,jr=128,Gr=1/0,Nr=9007199254740991,Lr=NaN,Ur=4294967295,Vr=[["ary",jr],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",zr],["partialRight",64],["rearg",256]],Wr="[object Arguments]",qr="[object Array]",Kr="[object Boolean]",Xr="[object Date]",Zr="[object Error]",_i="[object Function]",Jr="[object GeneratorFunction]",es="[object Map]",ts="[object Number]",is="[object Object]",rs="[object Promise]",as="[object RegExp]",ls="[object Set]",fs="[object String]",Ts="[object Symbol]",$s="[object WeakMap]",xs="[object ArrayBuffer]",ys="[object DataView]",ps="[object Float32Array]",vs="[object Float64Array]",Ds="[object Int8Array]",js="[object Int16Array]",zs="[object Int32Array]",qs="[object Uint8Array]",fo="[object Uint8ClampedArray]",Qs="[object Uint16Array]",no="[object Uint32Array]",yo=/\b__p \+= '';/g,Js=/\b(__p \+=) '' \+/g,lo=/(__e\(.*?\)|\b__t\)) \+\n'';/g,vo=/&(?:amp|lt|gt|quot|#39);/g,Ro=/[&<>"']/g,Co=RegExp(vo.source),Do=RegExp(Ro.source),ds=/<%-([\s\S]+?)%>/g,Os=/<%([\s\S]+?)%>/g,Ws=/<%=([\s\S]+?)%>/g,to=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,io=/^\w*$/,ko=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,go=/[\\^$.*+?()[\]{}|]/g,To=RegExp(go.source),Ho=/^\s+/,Uo=/\s/,Io=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,xl=/\{\n\/\* \[wrapped with (.+)\] \*/,Xo=/,? & /,El=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Dl=/[()=,{}\[\]\/\s]/,ru=/\\(\\)?/g,Ul=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Kl=/\w*$/,vu=/^[-+]0x[0-9a-f]+$/i,Vo=/^0b[01]+$/i,Fs=/^\[object .+?Constructor\]$/,Ks=/^0o[0-7]+$/i,gs=/^(?:0|[1-9]\d*)$/,hs=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Ps=/($^)/,ks=/['\n\r\u2028\u2029\\]/g,Zs="\\ud800-\\udfff",bo="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",ho="\\u2700-\\u27bf",eo="a-z\\xdf-\\xf6\\xf8-\\xff",Po="A-Z\\xc0-\\xd6\\xd8-\\xde",qo="\\ufe0e\\ufe0f",zo="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Hs="["+Zs+"]",wo="["+zo+"]",xo="["+bo+"]",Yl="\\d+",xu="["+ho+"]",ju="["+eo+"]",_f="[^"+Zs+zo+Yl+ho+eo+Po+"]",zu="\\ud83c[\\udffb-\\udfff]",_h="[^"+Zs+"]",ep="(?:\\ud83c[\\udde6-\\uddff]){2}",Ru="[\\ud800-\\udbff][\\udc00-\\udfff]",Su="["+Po+"]",lp="\\u200d",cu="(?:"+ju+"|"+_f+")",Ll="(?:"+Su+"|"+_f+")",Vu="(?:['](?:d|ll|m|re|s|t|ve))?",Ou="(?:['](?:D|LL|M|RE|S|T|VE))?",tp="(?:"+xo+"|"+zu+")?",up="["+qo+"]?",cp=up+tp+"(?:"+lp+"(?:"+[_h,ep,Ru].join("|")+")"+up+tp+")*",dp="(?:"+[xu,ep,Ru].join("|")+")"+cp,Rp="(?:"+[_h+xo+"?",xo,ep,Ru,Hs].join("|")+")",Zu=RegExp("[']","g"),fp=RegExp(xo,"g"),Qu=RegExp(zu+"(?="+zu+")|"+Rp+cp,"g"),Hu=RegExp([Su+"?"+ju+"+"+Vu+"(?="+[wo,Su,"$"].join("|")+")",Ll+"+"+Ou+"(?="+[wo,Su+cu,"$"].join("|")+")",Su+"?"+cu+"+"+Vu,Su+"+"+Ou,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Yl,dp].join("|"),"g"),Pl=RegExp("["+lp+Zs+bo+qo+"]"),hp=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Cp=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Ip=-1,Ml={};Ml[ps]=Ml[vs]=Ml[Ds]=Ml[js]=Ml[zs]=Ml[qs]=Ml[fo]=Ml[Qs]=Ml[no]=!0,Ml[Wr]=Ml[qr]=Ml[xs]=Ml[Kr]=Ml[ys]=Ml[Xr]=Ml[Zr]=Ml[_i]=Ml[es]=Ml[ts]=Ml[is]=Ml[as]=Ml[ls]=Ml[fs]=Ml[$s]=!1;var Fl={};Fl[Wr]=Fl[qr]=Fl[xs]=Fl[ys]=Fl[Kr]=Fl[Xr]=Fl[ps]=Fl[vs]=Fl[Ds]=Fl[js]=Fl[zs]=Fl[es]=Fl[ts]=Fl[is]=Fl[as]=Fl[ls]=Fl[fs]=Fl[Ts]=Fl[qs]=Fl[fo]=Fl[Qs]=Fl[no]=!0,Fl[Zr]=Fl[_i]=Fl[$s]=!1;var Nu={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},pp=parseFloat,gp=parseInt,Fu=typeof Ar.g=="object"&&Ar.g&&Ar.g.Object===Object&&Ar.g,Pp=typeof self=="object"&&self&&self.Object===Object&&self,eu=Fu||Pp||Function("return this")(),mp=Tr&&!Tr.nodeType&&Tr,iu=mp&&_r&&!_r.nodeType&&_r,yp=iu&&iu.exports===mp,Ju=yp&&Fu.process,Nl=function(){try{return iu&&iu.require&&iu.require("util").types||Ju&&Ju.binding&&Ju.binding("util")}catch{}}(),zl=Nl&&Nl.isArrayBuffer,Eu=Nl&&Nl.isDate,Cs=Nl&&Nl.isMap,Ls=Nl&&Nl.isRegExp,Us=Nl&&Nl.isSet,Xs=Nl&&Nl.isTypedArray;function po(Ys,ro,oo){switch(oo.length){case 0:return Ys.call(ro);case 1:return Ys.call(ro,oo[0]);case 2:return Ys.call(ro,oo[0],oo[1]);case 3:return Ys.call(ro,oo[0],oo[1],oo[2])}return Ys.apply(ro,oo)}function ms(Ys,ro,oo,So){for(var ba=-1,$l=Ys==null?0:Ys.length;++ba<$l;){var tu=Ys[ba];ro(So,tu,oo(tu),Ys)}return So}function os(Ys,ro){for(var oo=-1,So=Ys==null?0:Ys.length;++oo<So&&ro(Ys[oo],oo,Ys)!==!1;);return Ys}function us(Ys,ro){for(var oo=Ys==null?0:Ys.length;oo--&&ro(Ys[oo],oo,Ys)!==!1;);return Ys}function Ss(Ys,ro){for(var oo=-1,So=Ys==null?0:Ys.length;++oo<So;)if(!ro(Ys[oo],oo,Ys))return!1;return!0}function ss(Ys,ro){for(var oo=-1,So=Ys==null?0:Ys.length,ba=0,$l=[];++oo<So;){var tu=Ys[oo];ro(tu,oo,Ys)&&($l[ba++]=tu)}return $l}function bs(Ys,ro){return!(Ys==null||!Ys.length)&&Oo(Ys,ro,0)>-1}function _s(Ys,ro,oo){for(var So=-1,ba=Ys==null?0:Ys.length;++So<ba;)if(oo(ro,Ys[So]))return!0;return!1}function Es(Ys,ro){for(var oo=-1,So=Ys==null?0:Ys.length,ba=Array(So);++oo<So;)ba[oo]=ro(Ys[oo],oo,Ys);return ba}function As(Ys,ro){for(var oo=-1,So=ro.length,ba=Ys.length;++oo<So;)Ys[ba+oo]=ro[oo];return Ys}function Ms(Ys,ro,oo,So){var ba=-1,$l=Ys==null?0:Ys.length;for(So&&$l&&(oo=Ys[++ba]);++ba<$l;)oo=ro(oo,Ys[ba],ba,Ys);return oo}function Vs(Ys,ro,oo,So){var ba=Ys==null?0:Ys.length;for(So&&ba&&(oo=Ys[--ba]);ba--;)oo=ro(oo,Ys[ba],ba,Ys);return oo}function so(Ys,ro){for(var oo=-1,So=Ys==null?0:Ys.length;++oo<So;)if(ro(Ys[oo],oo,Ys))return!0;return!1}var _o=No("length");function Ao(Ys,ro,oo){var So;return oo(Ys,function(ba,$l,tu){if(ro(ba,$l,tu))return So=$l,!1}),So}function Go(Ys,ro,oo,So){for(var ba=Ys.length,$l=oo+(So?1:-1);So?$l--:++$l<ba;)if(ro(Ys[$l],$l,Ys))return $l;return-1}function Oo(Ys,ro,oo){return ro==ro?function(So,ba,$l){for(var tu=$l-1,np=So.length;++tu<np;)if(So[tu]===ba)return tu;return-1}(Ys,ro,oo):Go(Ys,Ko,oo)}function Zo(Ys,ro,oo,So){for(var ba=oo-1,$l=Ys.length;++ba<$l;)if(So(Ys[ba],ro))return ba;return-1}function Ko(Ys){return Ys!=Ys}function Wo(Ys,ro){var oo=Ys==null?0:Ys.length;return oo?Qo(Ys,ro)/oo:Lr}function No(Ys){return function(ro){return ro==null?Pr:ro[Ys]}}function Fo(Ys){return function(ro){return Ys==null?Pr:Ys[ro]}}function Bo(Ys,ro,oo,So,ba){return ba(Ys,function($l,tu,np){oo=So?(So=!1,$l):ro(oo,$l,tu,np)}),oo}function Qo(Ys,ro){for(var oo,So=-1,ba=Ys.length;++So<ba;){var $l=ro(Ys[So]);$l!==Pr&&(oo=oo===Pr?$l:oo+$l)}return oo}function jo(Ys,ro){for(var oo=-1,So=Array(Ys);++oo<Ys;)So[oo]=ro(oo);return So}function _a(Ys){return Ys&&Ys.slice(0,v0(Ys)+1).replace(Ho,"")}function _l(Ys){return function(ro){return Ys(ro)}}function Hl(Ys,ro){return Es(ro,function(oo){return Ys[oo]})}function Rl(Ys,ro){return Ys.has(ro)}function Ql(Ys,ro){for(var oo=-1,So=Ys.length;++oo<So&&Oo(ro,Ys[oo],0)>-1;);return oo}function Wl(Ys,ro){for(var oo=Ys.length;oo--&&Oo(ro,Ys[oo],0)>-1;);return oo}var pu=Fo({:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"}),du=Fo({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function wu(Ys){return"\\"+Nu[Ys]}function ou(Ys){return Pl.test(Ys)}function $a(Ys){var ro=-1,oo=Array(Ys.size);return Ys.forEach(function(So,ba){oo[++ro]=[ba,So]}),oo}function Il(Ys,ro){return function(oo){return Ys(ro(oo))}}function Jl(Ys,ro){for(var oo=-1,So=Ys.length,ba=0,$l=[];++oo<So;){var tu=Ys[oo];tu!==ro&&tu!==Fr||(Ys[oo]=Fr,$l[ba++]=oo)}return $l}function fu(Ys){var ro=-1,oo=Array(Ys.size);return Ys.forEach(function(So){oo[++ro]=So}),oo}function gu(Ys){var ro=-1,oo=Array(Ys.size);return Ys.forEach(function(So){oo[++ro]=[So,So]}),oo}function hu(Ys){return ou(Ys)?function(ro){for(var oo=Qu.lastIndex=0;Qu.test(ro);)++oo;return oo}(Ys):_o(Ys)}function au(Ys){return ou(Ys)?function(ro){return ro.match(Qu)||[]}(Ys):function(ro){return ro.split("")}(Ys)}function v0(Ys){for(var ro=Ys.length;ro--&&Uo.test(Ys.charAt(ro)););return ro}var vp=Fo({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),Kp=function Ys(ro){var oo,So=(ro=ro==null?eu:Kp.defaults(eu.Object(),ro,Kp.pick(eu,Cp))).Array,ba=ro.Date,$l=ro.Error,tu=ro.Function,np=ro.Math,Xl=ro.Object,sm=ro.RegExp,Xv=ro.String,Gu=ro.TypeError,b0=So.prototype,Zv=tu.prototype,Yp=Xl.prototype,x0=ro["__core-js_shared__"],E0=Zv.toString,Gl=Yp.hasOwnProperty,Qv=0,ry=(oo=/[^.]+$/.exec(x0&&x0.keys&&x0.keys.IE_PROTO||""))?"Symbol(src)_1."+oo:"",w0=Yp.toString,Jv=E0.call(Xl),e1=eu._,t1=sm("^"+E0.call(Gl).replace(go,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),T0=yp?ro.Buffer:Pr,Op=ro.Symbol,S0=ro.Uint8Array,iy=T0?T0.allocUnsafe:Pr,_0=Il(Xl.getPrototypeOf,Xl),sy=Xl.create,oy=Yp.propertyIsEnumerable,$0=b0.splice,ay=Op?Op.isConcatSpreadable:Pr,i0=Op?Op.iterator:Pr,Bp=Op?Op.toStringTag:Pr,A0=function(){try{var Yr=Hp(Xl,"defineProperty");return Yr({},"",{}),Yr}catch{}}(),n1=ro.clearTimeout!==eu.clearTimeout&&ro.clearTimeout,r1=ba&&ba.now!==eu.Date.now&&ba.now,i1=ro.setTimeout!==eu.setTimeout&&ro.setTimeout,R0=np.ceil,C0=np.floor,om=Xl.getOwnPropertySymbols,s1=T0?T0.isBuffer:Pr,ly=ro.isFinite,o1=b0.join,a1=Il(Xl.keys,Xl),mu=np.max,_u=np.min,l1=ba.now,u1=ro.parseInt,uy=np.random,c1=b0.reverse,am=Hp(ro,"DataView"),s0=Hp(ro,"Map"),lm=Hp(ro,"Promise"),Xp=Hp(ro,"Set"),o0=Hp(ro,"WeakMap"),a0=Hp(Xl,"create"),I0=o0&&new o0,Zp={},d1=Gp(am),f1=Gp(s0),h1=Gp(lm),p1=Gp(Xp),g1=Gp(o0),P0=Op?Op.prototype:Pr,l0=P0?P0.valueOf:Pr,cy=P0?P0.toString:Pr;function Rs(Yr){if(su(Yr)&&!Sl(Yr)&&!(Yr instanceof Ol)){if(Yr instanceof Wu)return Yr;if(Gl.call(Yr,"__wrapped__"))return fv(Yr)}return new Wu(Yr)}var Qp=function(){function Yr(){}return function(Qr){if(!nu(Qr))return{};if(sy)return sy(Qr);Yr.prototype=Qr;var ns=new Yr;return Yr.prototype=Pr,ns}}();function O0(){}function Wu(Yr,Qr){this.__wrapped__=Yr,this.__actions__=[],this.__chain__=!!Qr,this.__index__=0,this.__values__=Pr}function Ol(Yr){this.__wrapped__=Yr,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Ur,this.__views__=[]}function Up(Yr){var Qr=-1,ns=Yr==null?0:Yr.length;for(this.clear();++Qr<ns;){var cs=Yr[Qr];this.set(cs[0],cs[1])}}function bp(Yr){var Qr=-1,ns=Yr==null?0:Yr.length;for(this.clear();++Qr<ns;){var cs=Yr[Qr];this.set(cs[0],cs[1])}}function xp(Yr){var Qr=-1,ns=Yr==null?0:Yr.length;for(this.clear();++Qr<ns;){var cs=Yr[Qr];this.set(cs[0],cs[1])}}function jp(Yr){var Qr=-1,ns=Yr==null?0:Yr.length;for(this.__data__=new xp;++Qr<ns;)this.add(Yr[Qr])}function _c(Yr){var Qr=this.__data__=new bp(Yr);this.size=Qr.size}function dy(Yr,Qr){var ns=Sl(Yr),cs=!ns&&Wp(Yr),ws=!ns&&!cs&&Np(Yr),Is=!ns&&!cs&&!ws&&n0(Yr),Ns=ns||cs||ws||Is,Bs=Ns?jo(Yr.length,Xv):[],Gs=Bs.length;for(var uo in Yr)!Qr&&!Gl.call(Yr,uo)||Ns&&(uo=="length"||ws&&(uo=="offset"||uo=="parent")||Is&&(uo=="buffer"||uo=="byteLength"||uo=="byteOffset")||Sp(uo,Gs))||Bs.push(uo);return Bs}function fy(Yr){var Qr=Yr.length;return Qr?Yr[bm(0,Qr-1)]:Pr}function m1(Yr,Qr){return W0(ku(Yr),zp(Qr,0,Yr.length))}function y1(Yr){return W0(ku(Yr))}function um(Yr,Qr,ns){(ns!==Pr&&!_d(Yr[Qr],ns)||ns===Pr&&!(Qr in Yr))&&Ep(Yr,Qr,ns)}function u0(Yr,Qr,ns){var cs=Yr[Qr];Gl.call(Yr,Qr)&&_d(cs,ns)&&(ns!==Pr||Qr in Yr)||Ep(Yr,Qr,ns)}function k0(Yr,Qr){for(var ns=Yr.length;ns--;)if(_d(Yr[ns][0],Qr))return ns;return-1}function v1(Yr,Qr,ns,cs){return kp(Yr,function(ws,Is,Ns){Qr(cs,ws,ns(ws),Ns)}),cs}function hy(Yr,Qr){return Yr&&ip(Qr,bu(Qr),Yr)}function Ep(Yr,Qr,ns){Qr=="__proto__"&&A0?A0(Yr,Qr,{configurable:!0,enumerable:!0,value:ns,writable:!0}):Yr[Qr]=ns}function cm(Yr,Qr){for(var ns=-1,cs=Qr.length,ws=So(cs),Is=Yr==null;++ns<cs;)ws[ns]=Is?Pr:Wm(Yr,Qr[ns]);return ws}function zp(Yr,Qr,ns){return Yr==Yr&&(ns!==Pr&&(Yr=Yr<=ns?Yr:ns),Qr!==Pr&&(Yr=Yr>=Qr?Yr:Qr)),Yr}function qu(Yr,Qr,ns,cs,ws,Is){var Ns,Bs=1&Qr,Gs=2&Qr,uo=4&Qr;if(ns&&(Ns=ws?ns(Yr,cs,ws,Is):ns(Yr)),Ns!==Pr)return Ns;if(!nu(Yr))return Yr;var ao=Sl(Yr);if(ao){if(Ns=function(co){var Eo=co.length,na=new co.constructor(Eo);return Eo&&typeof co[0]=="string"&&Gl.call(co,"index")&&(na.index=co.index,na.input=co.input),na}(Yr),!Bs)return ku(Yr,Ns)}else{var mo=$u(Yr),Lo=mo==_i||mo==Jr;if(Np(Yr))return Fy(Yr,Bs);if(mo==is||mo==Wr||Lo&&!ws){if(Ns=Gs||Lo?{}:rv(Yr),!Bs)return Gs?function(co,Eo){return ip(co,tv(co),Eo)}(Yr,function(co,Eo){return co&&ip(Eo,Lu(Eo),co)}(Ns,Yr)):function(co,Eo){return ip(co,km(co),Eo)}(Yr,hy(Ns,Yr))}else{if(!Fl[mo])return ws?Yr:{};Ns=function(co,Eo,na){var $o,Tl=co.constructor;switch(Eo){case xs:return $m(co);case Kr:case Xr:return new Tl(+co);case ys:return function(yl,Bl){var Yo=Bl?$m(yl.buffer):yl.buffer;return new yl.constructor(Yo,yl.byteOffset,yl.byteLength)}(co,na);case ps:case vs:case Ds:case js:case zs:case qs:case fo:case Qs:case no:return By(co,na);case es:return new Tl;case ts:case fs:return new Tl(co);case as:return function(yl){var Bl=new yl.constructor(yl.source,Kl.exec(yl));return Bl.lastIndex=yl.lastIndex,Bl}(co);case ls:return new Tl;case Ts:return $o=co,l0?Xl(l0.call($o)):{}}}(Yr,mo,Bs)}}Is||(Is=new _c);var Mo=Is.get(Yr);if(Mo)return Mo;Is.set(Yr,Ns),Iv(Yr)?Yr.forEach(function(co){Ns.add(qu(co,Qr,ns,co,Yr,Is))}):Rv(Yr)&&Yr.forEach(function(co,Eo){Ns.set(Eo,qu(co,Qr,ns,Eo,Yr,Is))});var Jo=ao?Pr:(uo?Gs?Im:Cm:Gs?Lu:bu)(Yr);return os(Jo||Yr,function(co,Eo){Jo&&(co=Yr[Eo=co]),u0(Ns,Eo,qu(co,Qr,ns,Eo,Yr,Is))}),Ns}function py(Yr,Qr,ns){var cs=ns.length;if(Yr==null)return!cs;for(Yr=Xl(Yr);cs--;){var ws=ns[cs],Is=Qr[ws],Ns=Yr[ws];if(Ns===Pr&&!(ws in Yr)||!Is(Ns))return!1}return!0}function gy(Yr,Qr,ns){if(typeof Yr!="function")throw new Gu(Dr);return m0(function(){Yr.apply(Pr,ns)},Qr)}function c0(Yr,Qr,ns,cs){var ws=-1,Is=bs,Ns=!0,Bs=Yr.length,Gs=[],uo=Qr.length;if(!Bs)return Gs;ns&&(Qr=Es(Qr,_l(ns))),cs?(Is=_s,Ns=!1):Qr.length>=200&&(Is=Rl,Ns=!1,Qr=new jp(Qr));e:for(;++ws<Bs;){var ao=Yr[ws],mo=ns==null?ao:ns(ao);if(ao=cs||ao!==0?ao:0,Ns&&mo==mo){for(var Lo=uo;Lo--;)if(Qr[Lo]===mo)continue e;Gs.push(ao)}else Is(Qr,mo,cs)||Gs.push(ao)}return Gs}Rs.templateSettings={escape:ds,evaluate:Os,interpolate:Ws,variable:"",imports:{_:Rs}},Rs.prototype=O0.prototype,Rs.prototype.constructor=Rs,Wu.prototype=Qp(O0.prototype),Wu.prototype.constructor=Wu,Ol.prototype=Qp(O0.prototype),Ol.prototype.constructor=Ol,Up.prototype.clear=function(){this.__data__=a0?a0(null):{},this.size=0},Up.prototype.delete=function(Yr){var Qr=this.has(Yr)&&delete this.__data__[Yr];return this.size-=Qr?1:0,Qr},Up.prototype.get=function(Yr){var Qr=this.__data__;if(a0){var ns=Qr[Yr];return ns===Mr?Pr:ns}return Gl.call(Qr,Yr)?Qr[Yr]:Pr},Up.prototype.has=function(Yr){var Qr=this.__data__;return a0?Qr[Yr]!==Pr:Gl.call(Qr,Yr)},Up.prototype.set=function(Yr,Qr){var ns=this.__data__;return this.size+=this.has(Yr)?0:1,ns[Yr]=a0&&Qr===Pr?Mr:Qr,this},bp.prototype.clear=function(){this.__data__=[],this.size=0},bp.prototype.delete=function(Yr){var Qr=this.__data__,ns=k0(Qr,Yr);return!(ns<0||(ns==Qr.length-1?Qr.pop():$0.call(Qr,ns,1),--this.size,0))},bp.prototype.get=function(Yr){var Qr=this.__data__,ns=k0(Qr,Yr);return ns<0?Pr:Qr[ns][1]},bp.prototype.has=function(Yr){return k0(this.__data__,Yr)>-1},bp.prototype.set=function(Yr,Qr){var ns=this.__data__,cs=k0(ns,Yr);return cs<0?(++this.size,ns.push([Yr,Qr])):ns[cs][1]=Qr,this},xp.prototype.clear=function(){this.size=0,this.__data__={hash:new Up,map:new(s0||bp),string:new Up}},xp.prototype.delete=function(Yr){var Qr=G0(this,Yr).delete(Yr);return this.size-=Qr?1:0,Qr},xp.prototype.get=function(Yr){return G0(this,Yr).get(Yr)},xp.prototype.has=function(Yr){return G0(this,Yr).has(Yr)},xp.prototype.set=function(Yr,Qr){var ns=G0(this,Yr),cs=ns.size;return ns.set(Yr,Qr),this.size+=ns.size==cs?0:1,this},jp.prototype.add=jp.prototype.push=function(Yr){return this.__data__.set(Yr,Mr),this},jp.prototype.has=function(Yr){return this.__data__.has(Yr)},_c.prototype.clear=function(){this.__data__=new bp,this.size=0},_c.prototype.delete=function(Yr){var Qr=this.__data__,ns=Qr.delete(Yr);return this.size=Qr.size,ns},_c.prototype.get=function(Yr){return this.__data__.get(Yr)},_c.prototype.has=function(Yr){return this.__data__.has(Yr)},_c.prototype.set=function(Yr,Qr){var ns=this.__data__;if(ns instanceof bp){var cs=ns.__data__;if(!s0||cs.length<199)return cs.push([Yr,Qr]),this.size=++ns.size,this;ns=this.__data__=new xp(cs)}return ns.set(Yr,Qr),this.size=ns.size,this};var kp=Vy(rp),yy=Vy(fm,!0);function b1(Yr,Qr){var ns=!0;return kp(Yr,function(cs,ws,Is){return ns=!!Qr(cs,ws,Is)}),ns}function D0(Yr,Qr,ns){for(var cs=-1,ws=Yr.length;++cs<ws;){var Is=Yr[cs],Ns=Qr(Is);if(Ns!=null&&(Bs===Pr?Ns==Ns&&!Uu(Ns):ns(Ns,Bs)))var Bs=Ns,Gs=Is}return Gs}function vy(Yr,Qr){var ns=[];return kp(Yr,function(cs,ws,Is){Qr(cs,ws,Is)&&ns.push(cs)}),ns}function Tu(Yr,Qr,ns,cs,ws){var Is=-1,Ns=Yr.length;for(ns||(ns=I1),ws||(ws=[]);++Is<Ns;){var Bs=Yr[Is];Qr>0&&ns(Bs)?Qr>1?Tu(Bs,Qr-1,ns,cs,ws):As(ws,Bs):cs||(ws[ws.length]=Bs)}return ws}var dm=Hy(),by=Hy(!0);function rp(Yr,Qr){return Yr&&dm(Yr,Qr,bu)}function fm(Yr,Qr){return Yr&&by(Yr,Qr,bu)}function L0(Yr,Qr){return ss(Qr,function(ns){return _p(Yr[ns])})}function Vp(Yr,Qr){for(var ns=0,cs=(Qr=Lp(Qr,Yr)).length;Yr!=null&&ns<cs;)Yr=Yr[sp(Qr[ns++])];return ns&&ns==cs?Yr:Pr}function xy(Yr,Qr,ns){var cs=Qr(Yr);return Sl(Yr)?cs:As(cs,ns(Yr))}function Cu(Yr){return Yr==null?Yr===Pr?"[object Undefined]":"[object Null]":Bp&&Bp in Xl(Yr)?function(Qr){var ns=Gl.call(Qr,Bp),cs=Qr[Bp];try{Qr[Bp]=Pr;var ws=!0}catch{}var Is=w0.call(Qr);return ws&&(ns?Qr[Bp]=cs:delete Qr[Bp]),Is}(Yr):function(Qr){return w0.call(Qr)}(Yr)}function hm(Yr,Qr){return Yr>Qr}function x1(Yr,Qr){return Yr!=null&&Gl.call(Yr,Qr)}function E1(Yr,Qr){return Yr!=null&&Qr in Xl(Yr)}function pm(Yr,Qr,ns){for(var cs=ns?_s:bs,ws=Yr[0].length,Is=Yr.length,Ns=Is,Bs=So(Is),Gs=1/0,uo=[];Ns--;){var ao=Yr[Ns];Ns&&Qr&&(ao=Es(ao,_l(Qr))),Gs=_u(ao.length,Gs),Bs[Ns]=!ns&&(Qr||ws>=120&&ao.length>=120)?new jp(Ns&&ao):Pr}ao=Yr[0];var mo=-1,Lo=Bs[0];e:for(;++mo<ws&&uo.length<Gs;){var Mo=ao[mo],Jo=Qr?Qr(Mo):Mo;if(Mo=ns||Mo!==0?Mo:0,!(Lo?Rl(Lo,Jo):cs(uo,Jo,ns))){for(Ns=Is;--Ns;){var co=Bs[Ns];if(!(co?Rl(co,Jo):cs(Yr[Ns],Jo,ns)))continue e}Lo&&Lo.push(Jo),uo.push(Mo)}}return uo}function d0(Yr,Qr,ns){var cs=(Yr=av(Yr,Qr=Lp(Qr,Yr)))==null?Yr:Yr[sp(Yu(Qr))];return cs==null?Pr:po(cs,Yr,ns)}function Ey(Yr){return su(Yr)&&Cu(Yr)==Wr}function f0(Yr,Qr,ns,cs,ws){return Yr===Qr||(Yr==null||Qr==null||!su(Yr)&&!su(Qr)?Yr!=Yr&&Qr!=Qr:function(Is,Ns,Bs,Gs,uo,ao){var mo=Sl(Is),Lo=Sl(Ns),Mo=mo?qr:$u(Is),Jo=Lo?qr:$u(Ns),co=(Mo=Mo==Wr?is:Mo)==is,Eo=(Jo=Jo==Wr?is:Jo)==is,na=Mo==Jo;if(na&&Np(Is)){if(!Np(Ns))return!1;mo=!0,co=!1}if(na&&!co)return ao||(ao=new _c),mo||n0(Is)?ev(Is,Ns,Bs,Gs,uo,ao):function(Yo,xa,yu,uu,Pu,Zl,Au){switch(yu){case ys:if(Yo.byteLength!=xa.byteLength||Yo.byteOffset!=xa.byteOffset)return!1;Yo=Yo.buffer,xa=xa.buffer;case xs:return!(Yo.byteLength!=xa.byteLength||!Zl(new S0(Yo),new S0(xa)));case Kr:case Xr:case ts:return _d(+Yo,+xa);case Zr:return Yo.name==xa.name&&Yo.message==xa.message;case as:case fs:return Yo==xa+"";case es:var op=$a;case ls:var Fp=1&uu;if(op||(op=fu),Yo.size!=xa.size&&!Fp)return!1;var qp=Au.get(Yo);if(qp)return qp==xa;uu|=2,Au.set(Yo,xa);var Ap=ev(op(Yo),op(xa),uu,Pu,Zl,Au);return Au.delete(Yo),Ap;case Ts:if(l0)return l0.call(Yo)==l0.call(xa)}return!1}(Is,Ns,Mo,Bs,Gs,uo,ao);if(!(1&Bs)){var $o=co&&Gl.call(Is,"__wrapped__"),Tl=Eo&&Gl.call(Ns,"__wrapped__");if($o||Tl){var yl=$o?Is.value():Is,Bl=Tl?Ns.value():Ns;return ao||(ao=new _c),uo(yl,Bl,Bs,Gs,ao)}}return!!na&&(ao||(ao=new _c),function(Yo,xa,yu,uu,Pu,Zl){var Au=1&yu,op=Cm(Yo),Fp=op.length;if(Fp!=Cm(xa).length&&!Au)return!1;for(var qp=Fp;qp--;){var Ap=op[qp];if(!(Au?Ap in xa:Gl.call(xa,Ap)))return!1}var Hv=Zl.get(Yo),Gv=Zl.get(xa);if(Hv&&Gv)return Hv==xa&&Gv==Yo;var em=!0;Zl.set(Yo,xa),Zl.set(xa,Yo);for(var ny=Au;++qp<Fp;){var tm=Yo[Ap=op[qp]],nm=xa[Ap];if(uu)var Wv=Au?uu(nm,tm,Ap,xa,Yo,Zl):uu(tm,nm,Ap,Yo,xa,Zl);if(!(Wv===Pr?tm===nm||Pu(tm,nm,yu,uu,Zl):Wv)){em=!1;break}ny||(ny=Ap=="constructor")}if(em&&!ny){var rm=Yo.constructor,im=xa.constructor;rm==im||!("constructor"in Yo)||!("constructor"in xa)||typeof rm=="function"&&rm instanceof rm&&typeof im=="function"&&im instanceof im||(em=!1)}return Zl.delete(Yo),Zl.delete(xa),em}(Is,Ns,Bs,Gs,uo,ao))}(Yr,Qr,ns,cs,f0,ws))}function gm(Yr,Qr,ns,cs){var ws=ns.length,Is=ws,Ns=!cs;if(Yr==null)return!Is;for(Yr=Xl(Yr);ws--;){var Bs=ns[ws];if(Ns&&Bs[2]?Bs[1]!==Yr[Bs[0]]:!(Bs[0]in Yr))return!1}for(;++ws<Is;){var Gs=(Bs=ns[ws])[0],uo=Yr[Gs],ao=Bs[1];if(Ns&&Bs[2]){if(uo===Pr&&!(Gs in Yr))return!1}else{var mo=new _c;if(cs)var Lo=cs(uo,ao,Gs,Yr,Qr,mo);if(!(Lo===Pr?f0(ao,uo,3,cs,mo):Lo))return!1}}return!0}function wy(Yr){return!(!nu(Yr)||(Qr=Yr,ry&&ry in Qr))&&(_p(Yr)?t1:Fs).test(Gp(Yr));var Qr}function Ty(Yr){return typeof Yr=="function"?Yr:Yr==null?Mu:typeof Yr=="object"?Sl(Yr)?$y(Yr[0],Yr[1]):_y(Yr):Vv(Yr)}function mm(Yr){if(!g0(Yr))return a1(Yr);var Qr=[];for(var ns in Xl(Yr))Gl.call(Yr,ns)&&ns!="constructor"&&Qr.push(ns);return Qr}function ym(Yr,Qr){return Yr<Qr}function Sy(Yr,Qr){var ns=-1,cs=Du(Yr)?So(Yr.length):[];return kp(Yr,function(ws,Is,Ns){cs[++ns]=Qr(ws,Is,Ns)}),cs}function _y(Yr){var Qr=Om(Yr);return Qr.length==1&&Qr[0][2]?sv(Qr[0][0],Qr[0][1]):function(ns){return ns===Yr||gm(ns,Yr,Qr)}}function $y(Yr,Qr){return Dm(Yr)&&iv(Qr)?sv(sp(Yr),Qr):function(ns){var cs=Wm(ns,Yr);return cs===Pr&&cs===Qr?qm(ns,Yr):f0(Qr,cs,3)}}function M0(Yr,Qr,ns,cs,ws){Yr!==Qr&&dm(Qr,function(Is,Ns){if(ws||(ws=new _c),nu(Is))(function(Gs,uo,ao,mo,Lo,Mo,Jo){var co=Mm(Gs,ao),Eo=Mm(uo,ao),na=Jo.get(Eo);if(na)um(Gs,ao,na);else{var $o=Mo?Mo(co,Eo,ao+"",Gs,uo,Jo):Pr,Tl=$o===Pr;if(Tl){var yl=Sl(Eo),Bl=!yl&&Np(Eo),Yo=!yl&&!Bl&&n0(Eo);$o=Eo,yl||Bl||Yo?Sl(co)?$o=co:lu(co)?$o=ku(co):Bl?(Tl=!1,$o=Fy(Eo,!0)):Yo?(Tl=!1,$o=By(Eo,!0)):$o=[]:y0(Eo)||Wp(Eo)?($o=co,Wp(co)?$o=kv(co):nu(co)&&!_p(co)||($o=rv(Eo))):Tl=!1}Tl&&(Jo.set(Eo,$o),Lo($o,Eo,mo,Mo,Jo),Jo.delete(Eo)),um(Gs,ao,$o)}})(Yr,Qr,Ns,ns,M0,cs,ws);else{var Bs=cs?cs(Mm(Yr,Ns),Is,Ns+"",Yr,Qr,ws):Pr;Bs===Pr&&(Bs=Is),um(Yr,Ns,Bs)}},Lu)}function Ay(Yr,Qr){var ns=Yr.length;if(ns)return Sp(Qr+=Qr<0?ns:0,ns)?Yr[Qr]:Pr}function Ry(Yr,Qr,ns){Qr=Qr.length?Es(Qr,function(Is){return Sl(Is)?function(Ns){return Vp(Ns,Is.length===1?Is[0]:Is)}:Is}):[Mu];var cs=-1;Qr=Es(Qr,_l(ga()));var ws=Sy(Yr,function(Is,Ns,Bs){var Gs=Es(Qr,function(uo){return uo(Is)});return{criteria:Gs,index:++cs,value:Is}});return function(Is,Ns){var Bs=Is.length;for(Is.sort(function(Gs,uo){return function(ao,mo,Lo){for(var Mo=-1,Jo=ao.criteria,co=mo.criteria,Eo=Jo.length,na=Lo.length;++Mo<Eo;){var $o=Uy(Jo[Mo],co[Mo]);if($o)return Mo>=na?$o:$o*(Lo[Mo]=="desc"?-1:1)}return ao.index-mo.index}(Gs,uo,ns)});Bs--;)Is[Bs]=Is[Bs].value;return Is}(ws)}function Cy(Yr,Qr,ns){for(var cs=-1,ws=Qr.length,Is={};++cs<ws;){var Ns=Qr[cs],Bs=Vp(Yr,Ns);ns(Bs,Ns)&&h0(Is,Lp(Ns,Yr),Bs)}return Is}function vm(Yr,Qr,ns,cs){var ws=cs?Zo:Oo,Is=-1,Ns=Qr.length,Bs=Yr;for(Yr===Qr&&(Qr=ku(Qr)),ns&&(Bs=Es(Yr,_l(ns)));++Is<Ns;)for(var Gs=0,uo=Qr[Is],ao=ns?ns(uo):uo;(Gs=ws(Bs,ao,Gs,cs))>-1;)Bs!==Yr&&$0.call(Bs,Gs,1),$0.call(Yr,Gs,1);return Yr}function Iy(Yr,Qr){for(var ns=Yr?Qr.length:0,cs=ns-1;ns--;){var ws=Qr[ns];if(ns==cs||ws!==Is){var Is=ws;Sp(ws)?$0.call(Yr,ws,1):wm(Yr,ws)}}return Yr}function bm(Yr,Qr){return Yr+C0(uy()*(Qr-Yr+1))}function xm(Yr,Qr){var ns="";if(!Yr||Qr<1||Qr>Nr)return ns;do Qr%2&&(ns+=Yr),(Qr=C0(Qr/2))&&(Yr+=Yr);while(Qr);return ns}function Cl(Yr,Qr){return Nm(ov(Yr,Qr,Mu),Yr+"")}function w1(Yr){return fy(r0(Yr))}function T1(Yr,Qr){var ns=r0(Yr);return W0(ns,zp(Qr,0,ns.length))}function h0(Yr,Qr,ns,cs){if(!nu(Yr))return Yr;for(var ws=-1,Is=(Qr=Lp(Qr,Yr)).length,Ns=Is-1,Bs=Yr;Bs!=null&&++ws<Is;){var Gs=sp(Qr[ws]),uo=ns;if(Gs==="__proto__"||Gs==="constructor"||Gs==="prototype")return Yr;if(ws!=Ns){var ao=Bs[Gs];(uo=cs?cs(ao,Gs,Bs):Pr)===Pr&&(uo=nu(ao)?ao:Sp(Qr[ws+1])?[]:{})}u0(Bs,Gs,uo),Bs=Bs[Gs]}return Yr}var Py=I0?function(Yr,Qr){return I0.set(Yr,Qr),Yr}:Mu,S1=A0?function(Yr,Qr){return A0(Yr,"toString",{configurable:!0,enumerable:!1,value:Ym(Qr),writable:!0})}:Mu;function _1(Yr){return W0(r0(Yr))}function Ku(Yr,Qr,ns){var cs=-1,ws=Yr.length;Qr<0&&(Qr=-Qr>ws?0:ws+Qr),(ns=ns>ws?ws:ns)<0&&(ns+=ws),ws=Qr>ns?0:ns-Qr>>>0,Qr>>>=0;for(var Is=So(ws);++cs<ws;)Is[cs]=Yr[cs+Qr];return Is}function $1(Yr,Qr){var ns;return kp(Yr,function(cs,ws,Is){return!(ns=Qr(cs,ws,Is))}),!!ns}function N0(Yr,Qr,ns){var cs=0,ws=Yr==null?cs:Yr.length;if(typeof Qr=="number"&&Qr==Qr&&ws<=2147483647){for(;cs<ws;){var Is=cs+ws>>>1,Ns=Yr[Is];Ns!==null&&!Uu(Ns)&&(ns?Ns<=Qr:Ns<Qr)?cs=Is+1:ws=Is}return ws}return Em(Yr,Qr,Mu,ns)}function Em(Yr,Qr,ns,cs){var ws=0,Is=Yr==null?0:Yr.length;if(Is===0)return 0;for(var Ns=(Qr=ns(Qr))!=Qr,Bs=Qr===null,Gs=Uu(Qr),uo=Qr===Pr;ws<Is;){var ao=C0((ws+Is)/2),mo=ns(Yr[ao]),Lo=mo!==Pr,Mo=mo===null,Jo=mo==mo,co=Uu(mo);if(Ns)var Eo=cs||Jo;else Eo=uo?Jo&&(cs||Lo):Bs?Jo&&Lo&&(cs||!Mo):Gs?Jo&&Lo&&!Mo&&(cs||!co):!Mo&&!co&&(cs?mo<=Qr:mo<Qr);Eo?ws=ao+1:Is=ao}return _u(Is,4294967294)}function Oy(Yr,Qr){for(var ns=-1,cs=Yr.length,ws=0,Is=[];++ns<cs;){var Ns=Yr[ns],Bs=Qr?Qr(Ns):Ns;if(!ns||!_d(Bs,Gs)){var Gs=Bs;Is[ws++]=Ns===0?0:Ns}}return Is}function ky(Yr){return typeof Yr=="number"?Yr:Uu(Yr)?Lr:+Yr}function Bu(Yr){if(typeof Yr=="string")return Yr;if(Sl(Yr))return Es(Yr,Bu)+"";if(Uu(Yr))return cy?cy.call(Yr):"";var Qr=Yr+"";return Qr=="0"&&1/Yr==-1/0?"-0":Qr}function Dp(Yr,Qr,ns){var cs=-1,ws=bs,Is=Yr.length,Ns=!0,Bs=[],Gs=Bs;if(ns)Ns=!1,ws=_s;else if(Is>=200){var uo=Qr?null:R1(Yr);if(uo)return fu(uo);Ns=!1,ws=Rl,Gs=new jp}else Gs=Qr?[]:Bs;e:for(;++cs<Is;){var ao=Yr[cs],mo=Qr?Qr(ao):ao;if(ao=ns||ao!==0?ao:0,Ns&&mo==mo){for(var Lo=Gs.length;Lo--;)if(Gs[Lo]===mo)continue e;Qr&&Gs.push(mo),Bs.push(ao)}else ws(Gs,mo,ns)||(Gs!==Bs&&Gs.push(mo),Bs.push(ao))}return Bs}function wm(Yr,Qr){return(Yr=av(Yr,Qr=Lp(Qr,Yr)))==null||delete Yr[sp(Yu(Qr))]}function Dy(Yr,Qr,ns,cs){return h0(Yr,Qr,ns(Vp(Yr,Qr)),cs)}function F0(Yr,Qr,ns,cs){for(var ws=Yr.length,Is=cs?ws:-1;(cs?Is--:++Is<ws)&&Qr(Yr[Is],Is,Yr););return ns?Ku(Yr,cs?0:Is,cs?Is+1:ws):Ku(Yr,cs?Is+1:0,cs?ws:Is)}function Ly(Yr,Qr){var ns=Yr;return ns instanceof Ol&&(ns=ns.value()),Ms(Qr,function(cs,ws){return ws.func.apply(ws.thisArg,As([cs],ws.args))},ns)}function Tm(Yr,Qr,ns){var cs=Yr.length;if(cs<2)return cs?Dp(Yr[0]):[];for(var ws=-1,Is=So(cs);++ws<cs;)for(var Ns=Yr[ws],Bs=-1;++Bs<cs;)Bs!=ws&&(Is[ws]=c0(Is[ws]||Ns,Yr[Bs],Qr,ns));return Dp(Tu(Is,1),Qr,ns)}function My(Yr,Qr,ns){for(var cs=-1,ws=Yr.length,Is=Qr.length,Ns={};++cs<ws;){var Bs=cs<Is?Qr[cs]:Pr;ns(Ns,Yr[cs],Bs)}return Ns}function Sm(Yr){return lu(Yr)?Yr:[]}function _m(Yr){return typeof Yr=="function"?Yr:Mu}function Lp(Yr,Qr){return Sl(Yr)?Yr:Dm(Yr,Qr)?[Yr]:dv(Vl(Yr))}var A1=Cl;function Mp(Yr,Qr,ns){var cs=Yr.length;return ns=ns===Pr?cs:ns,!Qr&&ns>=cs?Yr:Ku(Yr,Qr,ns)}var Ny=n1||function(Yr){return eu.clearTimeout(Yr)};function Fy(Yr,Qr){if(Qr)return Yr.slice();var ns=Yr.length,cs=iy?iy(ns):new Yr.constructor(ns);return Yr.copy(cs),cs}function $m(Yr){var Qr=new Yr.constructor(Yr.byteLength);return new S0(Qr).set(new S0(Yr)),Qr}function By(Yr,Qr){var ns=Qr?$m(Yr.buffer):Yr.buffer;return new Yr.constructor(ns,Yr.byteOffset,Yr.length)}function Uy(Yr,Qr){if(Yr!==Qr){var ns=Yr!==Pr,cs=Yr===null,ws=Yr==Yr,Is=Uu(Yr),Ns=Qr!==Pr,Bs=Qr===null,Gs=Qr==Qr,uo=Uu(Qr);if(!Bs&&!uo&&!Is&&Yr>Qr||Is&&Ns&&Gs&&!Bs&&!uo||cs&&Ns&&Gs||!ns&&Gs||!ws)return 1;if(!cs&&!Is&&!uo&&Yr<Qr||uo&&ns&&ws&&!cs&&!Is||Bs&&ns&&ws||!Ns&&ws||!Gs)return-1}return 0}function jy(Yr,Qr,ns,cs){for(var ws=-1,Is=Yr.length,Ns=ns.length,Bs=-1,Gs=Qr.length,uo=mu(Is-Ns,0),ao=So(Gs+uo),mo=!cs;++Bs<Gs;)ao[Bs]=Qr[Bs];for(;++ws<Ns;)(mo||ws<Is)&&(ao[ns[ws]]=Yr[ws]);for(;uo--;)ao[Bs++]=Yr[ws++];return ao}function zy(Yr,Qr,ns,cs){for(var ws=-1,Is=Yr.length,Ns=-1,Bs=ns.length,Gs=-1,uo=Qr.length,ao=mu(Is-Bs,0),mo=So(ao+uo),Lo=!cs;++ws<ao;)mo[ws]=Yr[ws];for(var Mo=ws;++Gs<uo;)mo[Mo+Gs]=Qr[Gs];for(;++Ns<Bs;)(Lo||ws<Is)&&(mo[Mo+ns[Ns]]=Yr[ws++]);return mo}function ku(Yr,Qr){var ns=-1,cs=Yr.length;for(Qr||(Qr=So(cs));++ns<cs;)Qr[ns]=Yr[ns];return Qr}function ip(Yr,Qr,ns,cs){var ws=!ns;ns||(ns={});for(var Is=-1,Ns=Qr.length;++Is<Ns;){var Bs=Qr[Is],Gs=cs?cs(ns[Bs],Yr[Bs],Bs,ns,Yr):Pr;Gs===Pr&&(Gs=Yr[Bs]),ws?Ep(ns,Bs,Gs):u0(ns,Bs,Gs)}return ns}function B0(Yr,Qr){return function(ns,cs){var ws=Sl(ns)?ms:v1,Is=Qr?Qr():{};return ws(ns,Yr,ga(cs,2),Is)}}function Jp(Yr){return Cl(function(Qr,ns){var cs=-1,ws=ns.length,Is=ws>1?ns[ws-1]:Pr,Ns=ws>2?ns[2]:Pr;for(Is=Yr.length>3&&typeof Is=="function"?(ws--,Is):Pr,Ns&&Iu(ns[0],ns[1],Ns)&&(Is=ws<3?Pr:Is,ws=1),Qr=Xl(Qr);++cs<ws;){var Bs=ns[cs];Bs&&Yr(Qr,Bs,cs,Is)}return Qr})}function Vy(Yr,Qr){return function(ns,cs){if(ns==null)return ns;if(!Du(ns))return Yr(ns,cs);for(var ws=ns.length,Is=Qr?ws:-1,Ns=Xl(ns);(Qr?Is--:++Is<ws)&&cs(Ns[Is],Is,Ns)!==!1;);return ns}}function Hy(Yr){return function(Qr,ns,cs){for(var ws=-1,Is=Xl(Qr),Ns=cs(Qr),Bs=Ns.length;Bs--;){var Gs=Ns[Yr?Bs:++ws];if(ns(Is[Gs],Gs,Is)===!1)break}return Qr}}function Gy(Yr){return function(Qr){var ns=ou(Qr=Vl(Qr))?au(Qr):Pr,cs=ns?ns[0]:Qr.charAt(0),ws=ns?Mp(ns,1).join(""):Qr.slice(1);return cs[Yr]()+ws}}function e0(Yr){return function(Qr){return Ms(jv(Uv(Qr).replace(Zu,"")),Yr,"")}}function p0(Yr){return function(){var Qr=arguments;switch(Qr.length){case 0:return new Yr;case 1:return new Yr(Qr[0]);case 2:return new Yr(Qr[0],Qr[1]);case 3:return new Yr(Qr[0],Qr[1],Qr[2]);case 4:return new Yr(Qr[0],Qr[1],Qr[2],Qr[3]);case 5:return new Yr(Qr[0],Qr[1],Qr[2],Qr[3],Qr[4]);case 6:return new Yr(Qr[0],Qr[1],Qr[2],Qr[3],Qr[4],Qr[5]);case 7:return new Yr(Qr[0],Qr[1],Qr[2],Qr[3],Qr[4],Qr[5],Qr[6])}var ns=Qp(Yr.prototype),cs=Yr.apply(ns,Qr);return nu(cs)?cs:ns}}function Wy(Yr){return function(Qr,ns,cs){var ws=Xl(Qr);if(!Du(Qr)){var Is=ga(ns,3);Qr=bu(Qr),ns=function(Bs){return Is(ws[Bs],Bs,ws)}}var Ns=Yr(Qr,ns,cs);return Ns>-1?ws[Is?Qr[Ns]:Ns]:Pr}}function qy(Yr){return Tp(function(Qr){var ns=Qr.length,cs=ns,ws=Wu.prototype.thru;for(Yr&&Qr.reverse();cs--;){var Is=Qr[cs];if(typeof Is!="function")throw new Gu(Dr);if(ws&&!Ns&&H0(Is)=="wrapper")var Ns=new Wu([],!0)}for(cs=Ns?cs:ns;++cs<ns;){var Bs=H0(Is=Qr[cs]),Gs=Bs=="wrapper"?Pm(Is):Pr;Ns=Gs&&Lm(Gs[0])&&Gs[1]==424&&!Gs[4].length&&Gs[9]==1?Ns[H0(Gs[0])].apply(Ns,Gs[3]):Is.length==1&&Lm(Is)?Ns[Bs]():Ns.thru(Is)}return function(){var uo=arguments,ao=uo[0];if(Ns&&uo.length==1&&Sl(ao))return Ns.plant(ao).value();for(var mo=0,Lo=ns?Qr[mo].apply(this,uo):ao;++mo<ns;)Lo=Qr[mo].call(this,Lo);return Lo}})}function U0(Yr,Qr,ns,cs,ws,Is,Ns,Bs,Gs,uo){var ao=Qr&jr,mo=1&Qr,Lo=2&Qr,Mo=24&Qr,Jo=512&Qr,co=Lo?Pr:p0(Yr);return function Eo(){for(var na=arguments.length,$o=So(na),Tl=na;Tl--;)$o[Tl]=arguments[Tl];if(Mo)var yl=t0(Eo),Bl=function(uu,Pu){for(var Zl=uu.length,Au=0;Zl--;)uu[Zl]===Pu&&++Au;return Au}($o,yl);if(cs&&($o=jy($o,cs,ws,Mo)),Is&&($o=zy($o,Is,Ns,Mo)),na-=Bl,Mo&&na<uo){var Yo=Jl($o,yl);return Xy(Yr,Qr,U0,Eo.placeholder,ns,$o,Yo,Bs,Gs,uo-na)}var xa=mo?ns:this,yu=Lo?xa[Yr]:Yr;return na=$o.length,Bs?$o=function(uu,Pu){for(var Zl=uu.length,Au=_u(Pu.length,Zl),op=ku(uu);Au--;){var Fp=Pu[Au];uu[Au]=Sp(Fp,Zl)?op[Fp]:Pr}return uu}($o,Bs):Jo&&na>1&&$o.reverse(),ao&&Gs<na&&($o.length=Gs),this&&this!==eu&&this instanceof Eo&&(yu=co||p0(yu)),yu.apply(xa,$o)}}function Ky(Yr,Qr){return function(ns,cs){return function(ws,Is,Ns,Bs){return rp(ws,function(Gs,uo,ao){Is(Bs,Ns(Gs),uo,ao)}),Bs}(ns,Yr,Qr(cs),{})}}function j0(Yr,Qr){return function(ns,cs){var ws;if(ns===Pr&&cs===Pr)return Qr;if(ns!==Pr&&(ws=ns),cs!==Pr){if(ws===Pr)return cs;typeof ns=="string"||typeof cs=="string"?(ns=Bu(ns),cs=Bu(cs)):(ns=ky(ns),cs=ky(cs)),ws=Yr(ns,cs)}return ws}}function Am(Yr){return Tp(function(Qr){return Qr=Es(Qr,_l(ga())),Cl(function(ns){var cs=this;return Yr(Qr,function(ws){return po(ws,cs,ns)})})})}function z0(Yr,Qr){var ns=(Qr=Qr===Pr?" ":Bu(Qr)).length;if(ns<2)return ns?xm(Qr,Yr):Qr;var cs=xm(Qr,R0(Yr/hu(Qr)));return ou(Qr)?Mp(au(cs),0,Yr).join(""):cs.slice(0,Yr)}function Yy(Yr){return function(Qr,ns,cs){return cs&&typeof cs!="number"&&Iu(Qr,ns,cs)&&(ns=cs=Pr),Qr=$p(Qr),ns===Pr?(ns=Qr,Qr=0):ns=$p(ns),function(ws,Is,Ns,Bs){for(var Gs=-1,uo=mu(R0((Is-ws)/(Ns||1)),0),ao=So(uo);uo--;)ao[Bs?uo:++Gs]=ws,ws+=Ns;return ao}(Qr,ns,cs=cs===Pr?Qr<ns?1:-1:$p(cs),Yr)}}function V0(Yr){return function(Qr,ns){return typeof Qr=="string"&&typeof ns=="string"||(Qr=Xu(Qr),ns=Xu(ns)),Yr(Qr,ns)}}function Xy(Yr,Qr,ns,cs,ws,Is,Ns,Bs,Gs,uo){var ao=8&Qr;Qr|=ao?zr:64,4&(Qr&=~(ao?64:zr))||(Qr&=-4);var mo=[Yr,Qr,ws,ao?Is:Pr,ao?Ns:Pr,ao?Pr:Is,ao?Pr:Ns,Bs,Gs,uo],Lo=ns.apply(Pr,mo);return Lm(Yr)&&lv(Lo,mo),Lo.placeholder=cs,uv(Lo,Yr,Qr)}function Rm(Yr){var Qr=np[Yr];return function(ns,cs){if(ns=Xu(ns),(cs=cs==null?0:_u(Al(cs),292))&&ly(ns)){var ws=(Vl(ns)+"e").split("e");return+((ws=(Vl(Qr(ws[0]+"e"+(+ws[1]+cs)))+"e").split("e"))[0]+"e"+(+ws[1]-cs))}return Qr(ns)}}var R1=Xp&&1/fu(new Xp([,-0]))[1]==Gr?function(Yr){return new Xp(Yr)}:Qm;function Zy(Yr){return function(Qr){var ns=$u(Qr);return ns==es?$a(Qr):ns==ls?gu(Qr):function(cs,ws){return Es(ws,function(Is){return[Is,cs[Is]]})}(Qr,Yr(Qr))}}function wp(Yr,Qr,ns,cs,ws,Is,Ns,Bs){var Gs=2&Qr;if(!Gs&&typeof Yr!="function")throw new Gu(Dr);var uo=cs?cs.length:0;if(uo||(Qr&=-97,cs=ws=Pr),Ns=Ns===Pr?Ns:mu(Al(Ns),0),Bs=Bs===Pr?Bs:Al(Bs),uo-=ws?ws.length:0,64&Qr){var ao=cs,mo=ws;cs=ws=Pr}var Lo=Gs?Pr:Pm(Yr),Mo=[Yr,Qr,ns,cs,ws,ao,mo,Is,Ns,Bs];if(Lo&&function(co,Eo){var na=co[1],$o=Eo[1],Tl=na|$o,yl=Tl<131,Bl=$o==jr&&na==8||$o==jr&&na==256&&co[7].length<=Eo[8]||$o==384&&Eo[7].length<=Eo[8]&&na==8;if(!yl&&!Bl)return co;1&$o&&(co[2]=Eo[2],Tl|=1&na?0:4);var Yo=Eo[3];if(Yo){var xa=co[3];co[3]=xa?jy(xa,Yo,Eo[4]):Yo,co[4]=xa?Jl(co[3],Fr):Eo[4]}(Yo=Eo[5])&&(xa=co[5],co[5]=xa?zy(xa,Yo,Eo[6]):Yo,co[6]=xa?Jl(co[5],Fr):Eo[6]),(Yo=Eo[7])&&(co[7]=Yo),$o&jr&&(co[8]=co[8]==null?Eo[8]:_u(co[8],Eo[8])),co[9]==null&&(co[9]=Eo[9]),co[0]=Eo[0],co[1]=Tl}(Mo,Lo),Yr=Mo[0],Qr=Mo[1],ns=Mo[2],cs=Mo[3],ws=Mo[4],!(Bs=Mo[9]=Mo[9]===Pr?Gs?0:Yr.length:mu(Mo[9]-uo,0))&&24&Qr&&(Qr&=-25),Qr&&Qr!=1)Jo=Qr==8||Qr==16?function(co,Eo,na){var $o=p0(co);return function Tl(){for(var yl=arguments.length,Bl=So(yl),Yo=yl,xa=t0(Tl);Yo--;)Bl[Yo]=arguments[Yo];var yu=yl<3&&Bl[0]!==xa&&Bl[yl-1]!==xa?[]:Jl(Bl,xa);return(yl-=yu.length)<na?Xy(co,Eo,U0,Tl.placeholder,Pr,Bl,yu,Pr,Pr,na-yl):po(this&&this!==eu&&this instanceof Tl?$o:co,this,Bl)}}(Yr,Qr,Bs):Qr!=zr&&Qr!=33||ws.length?U0.apply(Pr,Mo):function(co,Eo,na,$o){var Tl=1&Eo,yl=p0(co);return function Bl(){for(var Yo=-1,xa=arguments.length,yu=-1,uu=$o.length,Pu=So(uu+xa),Zl=this&&this!==eu&&this instanceof Bl?yl:co;++yu<uu;)Pu[yu]=$o[yu];for(;xa--;)Pu[yu++]=arguments[++Yo];return po(Zl,Tl?na:this,Pu)}}(Yr,Qr,ns,cs);else var Jo=function(co,Eo,na){var $o=1&Eo,Tl=p0(co);return function yl(){return(this&&this!==eu&&this instanceof yl?Tl:co).apply($o?na:this,arguments)}}(Yr,Qr,ns);return uv((Lo?Py:lv)(Jo,Mo),Yr,Qr)}function Qy(Yr,Qr,ns,cs){return Yr===Pr||_d(Yr,Yp[ns])&&!Gl.call(cs,ns)?Qr:Yr}function Jy(Yr,Qr,ns,cs,ws,Is){return nu(Yr)&&nu(Qr)&&(Is.set(Qr,Yr),M0(Yr,Qr,Pr,Jy,Is),Is.delete(Qr)),Yr}function C1(Yr){return y0(Yr)?Pr:Yr}function ev(Yr,Qr,ns,cs,ws,Is){var Ns=1&ns,Bs=Yr.length,Gs=Qr.length;if(Bs!=Gs&&!(Ns&&Gs>Bs))return!1;var uo=Is.get(Yr),ao=Is.get(Qr);if(uo&&ao)return uo==Qr&&ao==Yr;var mo=-1,Lo=!0,Mo=2&ns?new jp:Pr;for(Is.set(Yr,Qr),Is.set(Qr,Yr);++mo<Bs;){var Jo=Yr[mo],co=Qr[mo];if(cs)var Eo=Ns?cs(co,Jo,mo,Qr,Yr,Is):cs(Jo,co,mo,Yr,Qr,Is);if(Eo!==Pr){if(Eo)continue;Lo=!1;break}if(Mo){if(!so(Qr,function(na,$o){if(!Rl(Mo,$o)&&(Jo===na||ws(Jo,na,ns,cs,Is)))return Mo.push($o)})){Lo=!1;break}}else if(Jo!==co&&!ws(Jo,co,ns,cs,Is)){Lo=!1;break}}return Is.delete(Yr),Is.delete(Qr),Lo}function Tp(Yr){return Nm(ov(Yr,Pr,gv),Yr+"")}function Cm(Yr){return xy(Yr,bu,km)}function Im(Yr){return xy(Yr,Lu,tv)}var Pm=I0?function(Yr){return I0.get(Yr)}:Qm;function H0(Yr){for(var Qr=Yr.name+"",ns=Zp[Qr],cs=Gl.call(Zp,Qr)?ns.length:0;cs--;){var ws=ns[cs],Is=ws.func;if(Is==null||Is==Yr)return ws.name}return Qr}function t0(Yr){return(Gl.call(Rs,"placeholder")?Rs:Yr).placeholder}function ga(){var Yr=Rs.iteratee||Xm;return Yr=Yr===Xm?Ty:Yr,arguments.length?Yr(arguments[0],arguments[1]):Yr}function G0(Yr,Qr){var ns,cs,ws=Yr.__data__;return((cs=typeof(ns=Qr))=="string"||cs=="number"||cs=="symbol"||cs=="boolean"?ns!=="__proto__":ns===null)?ws[typeof Qr=="string"?"string":"hash"]:ws.map}function Om(Yr){for(var Qr=bu(Yr),ns=Qr.length;ns--;){var cs=Qr[ns],ws=Yr[cs];Qr[ns]=[cs,ws,iv(ws)]}return Qr}function Hp(Yr,Qr){var ns=function(cs,ws){return cs==null?Pr:cs[ws]}(Yr,Qr);return wy(ns)?ns:Pr}var km=om?function(Yr){return Yr==null?[]:(Yr=Xl(Yr),ss(om(Yr),function(Qr){return oy.call(Yr,Qr)}))}:Jm,tv=om?function(Yr){for(var Qr=[];Yr;)As(Qr,km(Yr)),Yr=_0(Yr);return Qr}:Jm,$u=Cu;function nv(Yr,Qr,ns){for(var cs=-1,ws=(Qr=Lp(Qr,Yr)).length,Is=!1;++cs<ws;){var Ns=sp(Qr[cs]);if(!(Is=Yr!=null&&ns(Yr,Ns)))break;Yr=Yr[Ns]}return Is||++cs!=ws?Is:!!(ws=Yr==null?0:Yr.length)&&Q0(ws)&&Sp(Ns,ws)&&(Sl(Yr)||Wp(Yr))}function rv(Yr){return typeof Yr.constructor!="function"||g0(Yr)?{}:Qp(_0(Yr))}function I1(Yr){return Sl(Yr)||Wp(Yr)||!!(ay&&Yr&&Yr[ay])}function Sp(Yr,Qr){var ns=typeof Yr;return!!(Qr=Qr??Nr)&&(ns=="number"||ns!="symbol"&&gs.test(Yr))&&Yr>-1&&Yr%1==0&&Yr<Qr}function Iu(Yr,Qr,ns){if(!nu(ns))return!1;var cs=typeof Qr;return!!(cs=="number"?Du(ns)&&Sp(Qr,ns.length):cs=="string"&&Qr in ns)&&_d(ns[Qr],Yr)}function Dm(Yr,Qr){if(Sl(Yr))return!1;var ns=typeof Yr;return!(ns!="number"&&ns!="symbol"&&ns!="boolean"&&Yr!=null&&!Uu(Yr))||io.test(Yr)||!to.test(Yr)||Qr!=null&&Yr in Xl(Qr)}function Lm(Yr){var Qr=H0(Yr),ns=Rs[Qr];if(typeof ns!="function"||!(Qr in Ol.prototype))return!1;if(Yr===ns)return!0;var cs=Pm(ns);return!!cs&&Yr===cs[0]}(am&&$u(new am(new ArrayBuffer(1)))!=ys||s0&&$u(new s0)!=es||lm&&$u(lm.resolve())!=rs||Xp&&$u(new Xp)!=ls||o0&&$u(new o0)!=$s)&&($u=function(Yr){var Qr=Cu(Yr),ns=Qr==is?Yr.constructor:Pr,cs=ns?Gp(ns):"";if(cs)switch(cs){case d1:return ys;case f1:return es;case h1:return rs;case p1:return ls;case g1:return $s}return Qr});var P1=x0?_p:ey;function g0(Yr){var Qr=Yr&&Yr.constructor;return Yr===(typeof Qr=="function"&&Qr.prototype||Yp)}function iv(Yr){return Yr==Yr&&!nu(Yr)}function sv(Yr,Qr){return function(ns){return ns!=null&&ns[Yr]===Qr&&(Qr!==Pr||Yr in Xl(ns))}}function ov(Yr,Qr,ns){return Qr=mu(Qr===Pr?Yr.length-1:Qr,0),function(){for(var cs=arguments,ws=-1,Is=mu(cs.length-Qr,0),Ns=So(Is);++ws<Is;)Ns[ws]=cs[Qr+ws];ws=-1;for(var Bs=So(Qr+1);++ws<Qr;)Bs[ws]=cs[ws];return Bs[Qr]=ns(Ns),po(Yr,this,Bs)}}function av(Yr,Qr){return Qr.length<2?Yr:Vp(Yr,Ku(Qr,0,-1))}function Mm(Yr,Qr){if((Qr!=="constructor"||typeof Yr[Qr]!="function")&&Qr!="__proto__")return Yr[Qr]}var lv=cv(Py),m0=i1||function(Yr,Qr){return eu.setTimeout(Yr,Qr)},Nm=cv(S1);function uv(Yr,Qr,ns){var cs=Qr+"";return Nm(Yr,function(ws,Is){var Ns=Is.length;if(!Ns)return ws;var Bs=Ns-1;return Is[Bs]=(Ns>1?"& ":"")+Is[Bs],Is=Is.join(Ns>2?", ":" "),ws.replace(Io,`{
/* [wrapped with `+Is+`] */
`)}(cs,function(ws,Is){return os(Vr,function(Ns){var Bs="_."+Ns[0];Is&Ns[1]&&!bs(ws,Bs)&&ws.push(Bs)}),ws.sort()}(function(ws){var Is=ws.match(xl);return Is?Is[1].split(Xo):[]}(cs),ns)))}function cv(Yr){var Qr=0,ns=0;return function(){var cs=l1(),ws=16-(cs-ns);if(ns=cs,ws>0){if(++Qr>=800)return arguments[0]}else Qr=0;return Yr.apply(Pr,arguments)}}function W0(Yr,Qr){var ns=-1,cs=Yr.length,ws=cs-1;for(Qr=Qr===Pr?cs:Qr;++ns<Qr;){var Is=bm(ns,ws),Ns=Yr[Is];Yr[Is]=Yr[ns],Yr[ns]=Ns}return Yr.length=Qr,Yr}var Fm,Bm,dv=(Fm=X0(function(Yr){var Qr=[];return Yr.charCodeAt(0)===46&&Qr.push(""),Yr.replace(ko,function(ns,cs,ws,Is){Qr.push(ws?Is.replace(ru,"$1"):cs||ns)}),Qr},function(Yr){return Bm.size===500&&Bm.clear(),Yr}),Bm=Fm.cache,Fm);function sp(Yr){if(typeof Yr=="string"||Uu(Yr))return Yr;var Qr=Yr+"";return Qr=="0"&&1/Yr==-1/0?"-0":Qr}function Gp(Yr){if(Yr!=null){try{return E0.call(Yr)}catch{}try{return Yr+""}catch{}}return""}function fv(Yr){if(Yr instanceof Ol)return Yr.clone();var Qr=new Wu(Yr.__wrapped__,Yr.__chain__);return Qr.__actions__=ku(Yr.__actions__),Qr.__index__=Yr.__index__,Qr.__values__=Yr.__values__,Qr}var O1=Cl(function(Yr,Qr){return lu(Yr)?c0(Yr,Tu(Qr,1,lu,!0)):[]}),k1=Cl(function(Yr,Qr){var ns=Yu(Qr);return lu(ns)&&(ns=Pr),lu(Yr)?c0(Yr,Tu(Qr,1,lu,!0),ga(ns,2)):[]}),D1=Cl(function(Yr,Qr){var ns=Yu(Qr);return lu(ns)&&(ns=Pr),lu(Yr)?c0(Yr,Tu(Qr,1,lu,!0),Pr,ns):[]});function hv(Yr,Qr,ns){var cs=Yr==null?0:Yr.length;if(!cs)return-1;var ws=ns==null?0:Al(ns);return ws<0&&(ws=mu(cs+ws,0)),Go(Yr,ga(Qr,3),ws)}function pv(Yr,Qr,ns){var cs=Yr==null?0:Yr.length;if(!cs)return-1;var ws=cs-1;return ns!==Pr&&(ws=Al(ns),ws=ns<0?mu(cs+ws,0):_u(ws,cs-1)),Go(Yr,ga(Qr,3),ws,!0)}function gv(Yr){return Yr!=null&&Yr.length?Tu(Yr,1):[]}function mv(Yr){return Yr&&Yr.length?Yr[0]:Pr}var L1=Cl(function(Yr){var Qr=Es(Yr,Sm);return Qr.length&&Qr[0]===Yr[0]?pm(Qr):[]}),M1=Cl(function(Yr){var Qr=Yu(Yr),ns=Es(Yr,Sm);return Qr===Yu(ns)?Qr=Pr:ns.pop(),ns.length&&ns[0]===Yr[0]?pm(ns,ga(Qr,2)):[]}),N1=Cl(function(Yr){var Qr=Yu(Yr),ns=Es(Yr,Sm);return(Qr=typeof Qr=="function"?Qr:Pr)&&ns.pop(),ns.length&&ns[0]===Yr[0]?pm(ns,Pr,Qr):[]});function Yu(Yr){var Qr=Yr==null?0:Yr.length;return Qr?Yr[Qr-1]:Pr}var F1=Cl(yv);function yv(Yr,Qr){return Yr&&Yr.length&&Qr&&Qr.length?vm(Yr,Qr):Yr}var B1=Tp(function(Yr,Qr){var ns=Yr==null?0:Yr.length,cs=cm(Yr,Qr);return Iy(Yr,Es(Qr,function(ws){return Sp(ws,ns)?+ws:ws}).sort(Uy)),cs});function Um(Yr){return Yr==null?Yr:c1.call(Yr)}var U1=Cl(function(Yr){return Dp(Tu(Yr,1,lu,!0))}),j1=Cl(function(Yr){var Qr=Yu(Yr);return lu(Qr)&&(Qr=Pr),Dp(Tu(Yr,1,lu,!0),ga(Qr,2))}),z1=Cl(function(Yr){var Qr=Yu(Yr);return Qr=typeof Qr=="function"?Qr:Pr,Dp(Tu(Yr,1,lu,!0),Pr,Qr)});function jm(Yr){if(!Yr||!Yr.length)return[];var Qr=0;return Yr=ss(Yr,function(ns){if(lu(ns))return Qr=mu(ns.length,Qr),!0}),jo(Qr,function(ns){return Es(Yr,No(ns))})}function vv(Yr,Qr){if(!Yr||!Yr.length)return[];var ns=jm(Yr);return Qr==null?ns:Es(ns,function(cs){return po(Qr,Pr,cs)})}var V1=Cl(function(Yr,Qr){return lu(Yr)?c0(Yr,Qr):[]}),H1=Cl(function(Yr){return Tm(ss(Yr,lu))}),G1=Cl(function(Yr){var Qr=Yu(Yr);return lu(Qr)&&(Qr=Pr),Tm(ss(Yr,lu),ga(Qr,2))}),W1=Cl(function(Yr){var Qr=Yu(Yr);return Qr=typeof Qr=="function"?Qr:Pr,Tm(ss(Yr,lu),Pr,Qr)}),q1=Cl(jm),K1=Cl(function(Yr){var Qr=Yr.length,ns=Qr>1?Yr[Qr-1]:Pr;return ns=typeof ns=="function"?(Yr.pop(),ns):Pr,vv(Yr,ns)});function bv(Yr){var Qr=Rs(Yr);return Qr.__chain__=!0,Qr}function q0(Yr,Qr){return Qr(Yr)}var Y1=Tp(function(Yr){var Qr=Yr.length,ns=Qr?Yr[0]:0,cs=this.__wrapped__,ws=function(Is){return cm(Is,Yr)};return!(Qr>1||this.__actions__.length)&&cs instanceof Ol&&Sp(ns)?((cs=cs.slice(ns,+ns+(Qr?1:0))).__actions__.push({func:q0,args:[ws],thisArg:Pr}),new Wu(cs,this.__chain__).thru(function(Is){return Qr&&!Is.length&&Is.push(Pr),Is})):this.thru(ws)}),X1=B0(function(Yr,Qr,ns){Gl.call(Yr,ns)?++Yr[ns]:Ep(Yr,ns,1)}),Z1=Wy(hv),Q1=Wy(pv);function xv(Yr,Qr){return(Sl(Yr)?os:kp)(Yr,ga(Qr,3))}function Ev(Yr,Qr){return(Sl(Yr)?us:yy)(Yr,ga(Qr,3))}var J1=B0(function(Yr,Qr,ns){Gl.call(Yr,ns)?Yr[ns].push(Qr):Ep(Yr,ns,[Qr])}),_b=Cl(function(Yr,Qr,ns){var cs=-1,ws=typeof Qr=="function",Is=Du(Yr)?So(Yr.length):[];return kp(Yr,function(Ns){Is[++cs]=ws?po(Qr,Ns,ns):d0(Ns,Qr,ns)}),Is}),ex=B0(function(Yr,Qr,ns){Ep(Yr,ns,Qr)});function K0(Yr,Qr){return(Sl(Yr)?Es:Sy)(Yr,ga(Qr,3))}var tx=B0(function(Yr,Qr,ns){Yr[ns?0:1].push(Qr)},function(){return[[],[]]}),nx=Cl(function(Yr,Qr){if(Yr==null)return[];var ns=Qr.length;return ns>1&&Iu(Yr,Qr[0],Qr[1])?Qr=[]:ns>2&&Iu(Qr[0],Qr[1],Qr[2])&&(Qr=[Qr[0]]),Ry(Yr,Tu(Qr,1),[])}),Y0=r1||function(){return eu.Date.now()};function wv(Yr,Qr,ns){return Qr=ns?Pr:Qr,Qr=Yr&&Qr==null?Yr.length:Qr,wp(Yr,jr,Pr,Pr,Pr,Pr,Qr)}function Tv(Yr,Qr){var ns;if(typeof Qr!="function")throw new Gu(Dr);return Yr=Al(Yr),function(){return--Yr>0&&(ns=Qr.apply(this,arguments)),Yr<=1&&(Qr=Pr),ns}}var zm=Cl(function(Yr,Qr,ns){var cs=1;if(ns.length){var ws=Jl(ns,t0(zm));cs|=zr}return wp(Yr,cs,Qr,ns,ws)}),Sv=Cl(function(Yr,Qr,ns){var cs=3;if(ns.length){var ws=Jl(ns,t0(Sv));cs|=zr}return wp(Qr,cs,Yr,ns,ws)});function _v(Yr,Qr,ns){var cs,ws,Is,Ns,Bs,Gs,uo=0,ao=!1,mo=!1,Lo=!0;if(typeof Yr!="function")throw new Gu(Dr);function Mo($o){var Tl=cs,yl=ws;return cs=ws=Pr,uo=$o,Ns=Yr.apply(yl,Tl)}function Jo($o){var Tl=$o-Gs;return Gs===Pr||Tl>=Qr||Tl<0||mo&&$o-uo>=Is}function co(){var $o=Y0();if(Jo($o))return Eo($o);Bs=m0(co,function(Tl){var yl=Qr-(Tl-Gs);return mo?_u(yl,Is-(Tl-uo)):yl}($o))}function Eo($o){return Bs=Pr,Lo&&cs?Mo($o):(cs=ws=Pr,Ns)}function na(){var $o=Y0(),Tl=Jo($o);if(cs=arguments,ws=this,Gs=$o,Tl){if(Bs===Pr)return function(yl){return uo=yl,Bs=m0(co,Qr),ao?Mo(yl):Ns}(Gs);if(mo)return Ny(Bs),Bs=m0(co,Qr),Mo(Gs)}return Bs===Pr&&(Bs=m0(co,Qr)),Ns}return Qr=Xu(Qr)||0,nu(ns)&&(ao=!!ns.leading,Is=(mo="maxWait"in ns)?mu(Xu(ns.maxWait)||0,Qr):Is,Lo="trailing"in ns?!!ns.trailing:Lo),na.cancel=function(){Bs!==Pr&&Ny(Bs),uo=0,cs=Gs=ws=Bs=Pr},na.flush=function(){return Bs===Pr?Ns:Eo(Y0())},na}var rx=Cl(function(Yr,Qr){return gy(Yr,1,Qr)}),ix=Cl(function(Yr,Qr,ns){return gy(Yr,Xu(Qr)||0,ns)});function X0(Yr,Qr){if(typeof Yr!="function"||Qr!=null&&typeof Qr!="function")throw new Gu(Dr);var ns=function(){var cs=arguments,ws=Qr?Qr.apply(this,cs):cs[0],Is=ns.cache;if(Is.has(ws))return Is.get(ws);var Ns=Yr.apply(this,cs);return ns.cache=Is.set(ws,Ns)||Is,Ns};return ns.cache=new(X0.Cache||xp),ns}function Z0(Yr){if(typeof Yr!="function")throw new Gu(Dr);return function(){var Qr=arguments;switch(Qr.length){case 0:return!Yr.call(this);case 1:return!Yr.call(this,Qr[0]);case 2:return!Yr.call(this,Qr[0],Qr[1]);case 3:return!Yr.call(this,Qr[0],Qr[1],Qr[2])}return!Yr.apply(this,Qr)}}X0.Cache=xp;var sx=A1(function(Yr,Qr){var ns=(Qr=Qr.length==1&&Sl(Qr[0])?Es(Qr[0],_l(ga())):Es(Tu(Qr,1),_l(ga()))).length;return Cl(function(cs){for(var ws=-1,Is=_u(cs.length,ns);++ws<Is;)cs[ws]=Qr[ws].call(this,cs[ws]);return po(Yr,this,cs)})}),Vm=Cl(function(Yr,Qr){var ns=Jl(Qr,t0(Vm));return wp(Yr,zr,Pr,Qr,ns)}),$v=Cl(function(Yr,Qr){var ns=Jl(Qr,t0($v));return wp(Yr,64,Pr,Qr,ns)}),ox=Tp(function(Yr,Qr){return wp(Yr,256,Pr,Pr,Pr,Qr)});function _d(Yr,Qr){return Yr===Qr||Yr!=Yr&&Qr!=Qr}var ax=V0(hm),lx=V0(function(Yr,Qr){return Yr>=Qr}),Wp=Ey(function(){return arguments}())?Ey:function(Yr){return su(Yr)&&Gl.call(Yr,"callee")&&!oy.call(Yr,"callee")},Sl=So.isArray,ux=zl?_l(zl):function(Yr){return su(Yr)&&Cu(Yr)==xs};function Du(Yr){return Yr!=null&&Q0(Yr.length)&&!_p(Yr)}function lu(Yr){return su(Yr)&&Du(Yr)}var Np=s1||ey,cx=Eu?_l(Eu):function(Yr){return su(Yr)&&Cu(Yr)==Xr};function Hm(Yr){if(!su(Yr))return!1;var Qr=Cu(Yr);return Qr==Zr||Qr=="[object DOMException]"||typeof Yr.message=="string"&&typeof Yr.name=="string"&&!y0(Yr)}function _p(Yr){if(!nu(Yr))return!1;var Qr=Cu(Yr);return Qr==_i||Qr==Jr||Qr=="[object AsyncFunction]"||Qr=="[object Proxy]"}function Av(Yr){return typeof Yr=="number"&&Yr==Al(Yr)}function Q0(Yr){return typeof Yr=="number"&&Yr>-1&&Yr%1==0&&Yr<=Nr}function nu(Yr){var Qr=typeof Yr;return Yr!=null&&(Qr=="object"||Qr=="function")}function su(Yr){return Yr!=null&&typeof Yr=="object"}var Rv=Cs?_l(Cs):function(Yr){return su(Yr)&&$u(Yr)==es};function Cv(Yr){return typeof Yr=="number"||su(Yr)&&Cu(Yr)==ts}function y0(Yr){if(!su(Yr)||Cu(Yr)!=is)return!1;var Qr=_0(Yr);if(Qr===null)return!0;var ns=Gl.call(Qr,"constructor")&&Qr.constructor;return typeof ns=="function"&&ns instanceof ns&&E0.call(ns)==Jv}var Gm=Ls?_l(Ls):function(Yr){return su(Yr)&&Cu(Yr)==as},Iv=Us?_l(Us):function(Yr){return su(Yr)&&$u(Yr)==ls};function J0(Yr){return typeof Yr=="string"||!Sl(Yr)&&su(Yr)&&Cu(Yr)==fs}function Uu(Yr){return typeof Yr=="symbol"||su(Yr)&&Cu(Yr)==Ts}var n0=Xs?_l(Xs):function(Yr){return su(Yr)&&Q0(Yr.length)&&!!Ml[Cu(Yr)]},dx=V0(ym),fx=V0(function(Yr,Qr){return Yr<=Qr});function Pv(Yr){if(!Yr)return[];if(Du(Yr))return J0(Yr)?au(Yr):ku(Yr);if(i0&&Yr[i0])return function(ns){for(var cs,ws=[];!(cs=ns.next()).done;)ws.push(cs.value);return ws}(Yr[i0]());var Qr=$u(Yr);return(Qr==es?$a:Qr==ls?fu:r0)(Yr)}function $p(Yr){return Yr?(Yr=Xu(Yr))===Gr||Yr===-1/0?17976931348623157e292*(Yr<0?-1:1):Yr==Yr?Yr:0:Yr===0?Yr:0}function Al(Yr){var Qr=$p(Yr),ns=Qr%1;return Qr==Qr?ns?Qr-ns:Qr:0}function Ov(Yr){return Yr?zp(Al(Yr),0,Ur):0}function Xu(Yr){if(typeof Yr=="number")return Yr;if(Uu(Yr))return Lr;if(nu(Yr)){var Qr=typeof Yr.valueOf=="function"?Yr.valueOf():Yr;Yr=nu(Qr)?Qr+"":Qr}if(typeof Yr!="string")return Yr===0?Yr:+Yr;Yr=_a(Yr);var ns=Vo.test(Yr);return ns||Ks.test(Yr)?gp(Yr.slice(2),ns?2:8):vu.test(Yr)?Lr:+Yr}function kv(Yr){return ip(Yr,Lu(Yr))}function Vl(Yr){return Yr==null?"":Bu(Yr)}var hx=Jp(function(Yr,Qr){if(g0(Qr)||Du(Qr))ip(Qr,bu(Qr),Yr);else for(var ns in Qr)Gl.call(Qr,ns)&&u0(Yr,ns,Qr[ns])}),Dv=Jp(function(Yr,Qr){ip(Qr,Lu(Qr),Yr)}),_g=Jp(function(Yr,Qr,ns,cs){ip(Qr,Lu(Qr),Yr,cs)}),px=Jp(function(Yr,Qr,ns,cs){ip(Qr,bu(Qr),Yr,cs)}),gx=Tp(cm),mx=Cl(function(Yr,Qr){Yr=Xl(Yr);var ns=-1,cs=Qr.length,ws=cs>2?Qr[2]:Pr;for(ws&&Iu(Qr[0],Qr[1],ws)&&(cs=1);++ns<cs;)for(var Is=Qr[ns],Ns=Lu(Is),Bs=-1,Gs=Ns.length;++Bs<Gs;){var uo=Ns[Bs],ao=Yr[uo];(ao===Pr||_d(ao,Yp[uo])&&!Gl.call(Yr,uo))&&(Yr[uo]=Is[uo])}return Yr}),yx=Cl(function(Yr){return Yr.push(Pr,Jy),po(Lv,Pr,Yr)});function Wm(Yr,Qr,ns){var cs=Yr==null?Pr:Vp(Yr,Qr);return cs===Pr?ns:cs}function qm(Yr,Qr){return Yr!=null&&nv(Yr,Qr,E1)}var vx=Ky(function(Yr,Qr,ns){Qr!=null&&typeof Qr.toString!="function"&&(Qr=w0.call(Qr)),Yr[Qr]=ns},Ym(Mu)),bx=Ky(function(Yr,Qr,ns){Qr!=null&&typeof Qr.toString!="function"&&(Qr=w0.call(Qr)),Gl.call(Yr,Qr)?Yr[Qr].push(ns):Yr[Qr]=[ns]},ga),xx=Cl(d0);function bu(Yr){return Du(Yr)?dy(Yr):mm(Yr)}function Lu(Yr){return Du(Yr)?dy(Yr,!0):function(Qr){if(!nu(Qr))return function(Is){var Ns=[];if(Is!=null)for(var Bs in Xl(Is))Ns.push(Bs);return Ns}(Qr);var ns=g0(Qr),cs=[];for(var ws in Qr)(ws!="constructor"||!ns&&Gl.call(Qr,ws))&&cs.push(ws);return cs}(Yr)}var Ex=Jp(function(Yr,Qr,ns){M0(Yr,Qr,ns)}),Lv=Jp(function(Yr,Qr,ns,cs){M0(Yr,Qr,ns,cs)}),wx=Tp(function(Yr,Qr){var ns={};if(Yr==null)return ns;var cs=!1;Qr=Es(Qr,function(Is){return Is=Lp(Is,Yr),cs||(cs=Is.length>1),Is}),ip(Yr,Im(Yr),ns),cs&&(ns=qu(ns,7,C1));for(var ws=Qr.length;ws--;)wm(ns,Qr[ws]);return ns}),Tx=Tp(function(Yr,Qr){return Yr==null?{}:function(ns,cs){return Cy(ns,cs,function(ws,Is){return qm(ns,Is)})}(Yr,Qr)});function Mv(Yr,Qr){if(Yr==null)return{};var ns=Es(Im(Yr),function(cs){return[cs]});return Qr=ga(Qr),Cy(Yr,ns,function(cs,ws){return Qr(cs,ws[0])})}var Nv=Zy(bu),Fv=Zy(Lu);function r0(Yr){return Yr==null?[]:Hl(Yr,bu(Yr))}var Sx=e0(function(Yr,Qr,ns){return Qr=Qr.toLowerCase(),Yr+(ns?Bv(Qr):Qr)});function Bv(Yr){return Km(Vl(Yr).toLowerCase())}function Uv(Yr){return(Yr=Vl(Yr))&&Yr.replace(hs,pu).replace(fp,"")}var _x=e0(function(Yr,Qr,ns){return Yr+(ns?"-":"")+Qr.toLowerCase()}),$x=e0(function(Yr,Qr,ns){return Yr+(ns?" ":"")+Qr.toLowerCase()}),Ax=Gy("toLowerCase"),Rx=e0(function(Yr,Qr,ns){return Yr+(ns?"_":"")+Qr.toLowerCase()}),Cx=e0(function(Yr,Qr,ns){return Yr+(ns?" ":"")+Km(Qr)}),Ix=e0(function(Yr,Qr,ns){return Yr+(ns?" ":"")+Qr.toUpperCase()}),Km=Gy("toUpperCase");function jv(Yr,Qr,ns){return Yr=Vl(Yr),(Qr=ns?Pr:Qr)===Pr?function(cs){return hp.test(cs)}(Yr)?function(cs){return cs.match(Hu)||[]}(Yr):function(cs){return cs.match(El)||[]}(Yr):Yr.match(Qr)||[]}var zv=Cl(function(Yr,Qr){try{return po(Yr,Pr,Qr)}catch(ns){return Hm(ns)?ns:new $l(ns)}}),Px=Tp(function(Yr,Qr){return os(Qr,function(ns){ns=sp(ns),Ep(Yr,ns,zm(Yr[ns],Yr))}),Yr});function Ym(Yr){return function(){return Yr}}var Ox=qy(),kx=qy(!0);function Mu(Yr){return Yr}function Xm(Yr){return Ty(typeof Yr=="function"?Yr:qu(Yr,1))}var Dx=Cl(function(Yr,Qr){return function(ns){return d0(ns,Yr,Qr)}}),Lx=Cl(function(Yr,Qr){return function(ns){return d0(Yr,ns,Qr)}});function Zm(Yr,Qr,ns){var cs=bu(Qr),ws=L0(Qr,cs);ns!=null||nu(Qr)&&(ws.length||!cs.length)||(ns=Qr,Qr=Yr,Yr=this,ws=L0(Qr,bu(Qr)));var Is=!(nu(ns)&&"chain"in ns&&!ns.chain),Ns=_p(Yr);return os(ws,function(Bs){var Gs=Qr[Bs];Yr[Bs]=Gs,Ns&&(Yr.prototype[Bs]=function(){var uo=this.__chain__;if(Is||uo){var ao=Yr(this.__wrapped__);return(ao.__actions__=ku(this.__actions__)).push({func:Gs,args:arguments,thisArg:Yr}),ao.__chain__=uo,ao}return Gs.apply(Yr,As([this.value()],arguments))})}),Yr}function Qm(){}var Mx=Am(Es),Nx=Am(Ss),Fx=Am(so);function Vv(Yr){return Dm(Yr)?No(sp(Yr)):function(Qr){return function(ns){return Vp(ns,Qr)}}(Yr)}var Bx=Yy(),Ux=Yy(!0);function Jm(){return[]}function ey(){return!1}var ty,jx=j0(function(Yr,Qr){return Yr+Qr},0),zx=Rm("ceil"),Vx=j0(function(Yr,Qr){return Yr/Qr},1),Hx=Rm("floor"),Gx=j0(function(Yr,Qr){return Yr*Qr},1),Wx=Rm("round"),qx=j0(function(Yr,Qr){return Yr-Qr},0);return Rs.after=function(Yr,Qr){if(typeof Qr!="function")throw new Gu(Dr);return Yr=Al(Yr),function(){if(--Yr<1)return Qr.apply(this,arguments)}},Rs.ary=wv,Rs.assign=hx,Rs.assignIn=Dv,Rs.assignInWith=_g,Rs.assignWith=px,Rs.at=gx,Rs.before=Tv,Rs.bind=zm,Rs.bindAll=Px,Rs.bindKey=Sv,Rs.castArray=function(){if(!arguments.length)return[];var Yr=arguments[0];return Sl(Yr)?Yr:[Yr]},Rs.chain=bv,Rs.chunk=function(Yr,Qr,ns){Qr=(ns?Iu(Yr,Qr,ns):Qr===Pr)?1:mu(Al(Qr),0);var cs=Yr==null?0:Yr.length;if(!cs||Qr<1)return[];for(var ws=0,Is=0,Ns=So(R0(cs/Qr));ws<cs;)Ns[Is++]=Ku(Yr,ws,ws+=Qr);return Ns},Rs.compact=function(Yr){for(var Qr=-1,ns=Yr==null?0:Yr.length,cs=0,ws=[];++Qr<ns;){var Is=Yr[Qr];Is&&(ws[cs++]=Is)}return ws},Rs.concat=function(){var Yr=arguments.length;if(!Yr)return[];for(var Qr=So(Yr-1),ns=arguments[0],cs=Yr;cs--;)Qr[cs-1]=arguments[cs];return As(Sl(ns)?ku(ns):[ns],Tu(Qr,1))},Rs.cond=function(Yr){var Qr=Yr==null?0:Yr.length,ns=ga();return Yr=Qr?Es(Yr,function(cs){if(typeof cs[1]!="function")throw new Gu(Dr);return[ns(cs[0]),cs[1]]}):[],Cl(function(cs){for(var ws=-1;++ws<Qr;){var Is=Yr[ws];if(po(Is[0],this,cs))return po(Is[1],this,cs)}})},Rs.conforms=function(Yr){return function(Qr){var ns=bu(Qr);return function(cs){return py(cs,Qr,ns)}}(qu(Yr,1))},Rs.constant=Ym,Rs.countBy=X1,Rs.create=function(Yr,Qr){var ns=Qp(Yr);return Qr==null?ns:hy(ns,Qr)},Rs.curry=function Yr(Qr,ns,cs){var ws=wp(Qr,8,Pr,Pr,Pr,Pr,Pr,ns=cs?Pr:ns);return ws.placeholder=Yr.placeholder,ws},Rs.curryRight=function Yr(Qr,ns,cs){var ws=wp(Qr,16,Pr,Pr,Pr,Pr,Pr,ns=cs?Pr:ns);return ws.placeholder=Yr.placeholder,ws},Rs.debounce=_v,Rs.defaults=mx,Rs.defaultsDeep=yx,Rs.defer=rx,Rs.delay=ix,Rs.difference=O1,Rs.differenceBy=k1,Rs.differenceWith=D1,Rs.drop=function(Yr,Qr,ns){var cs=Yr==null?0:Yr.length;return cs?Ku(Yr,(Qr=ns||Qr===Pr?1:Al(Qr))<0?0:Qr,cs):[]},Rs.dropRight=function(Yr,Qr,ns){var cs=Yr==null?0:Yr.length;return cs?Ku(Yr,0,(Qr=cs-(Qr=ns||Qr===Pr?1:Al(Qr)))<0?0:Qr):[]},Rs.dropRightWhile=function(Yr,Qr){return Yr&&Yr.length?F0(Yr,ga(Qr,3),!0,!0):[]},Rs.dropWhile=function(Yr,Qr){return Yr&&Yr.length?F0(Yr,ga(Qr,3),!0):[]},Rs.fill=function(Yr,Qr,ns,cs){var ws=Yr==null?0:Yr.length;return ws?(ns&&typeof ns!="number"&&Iu(Yr,Qr,ns)&&(ns=0,cs=ws),function(Is,Ns,Bs,Gs){var uo=Is.length;for((Bs=Al(Bs))<0&&(Bs=-Bs>uo?0:uo+Bs),(Gs=Gs===Pr||Gs>uo?uo:Al(Gs))<0&&(Gs+=uo),Gs=Bs>Gs?0:Ov(Gs);Bs<Gs;)Is[Bs++]=Ns;return Is}(Yr,Qr,ns,cs)):[]},Rs.filter=function(Yr,Qr){return(Sl(Yr)?ss:vy)(Yr,ga(Qr,3))},Rs.flatMap=function(Yr,Qr){return Tu(K0(Yr,Qr),1)},Rs.flatMapDeep=function(Yr,Qr){return Tu(K0(Yr,Qr),Gr)},Rs.flatMapDepth=function(Yr,Qr,ns){return ns=ns===Pr?1:Al(ns),Tu(K0(Yr,Qr),ns)},Rs.flatten=gv,Rs.flattenDeep=function(Yr){return Yr!=null&&Yr.length?Tu(Yr,Gr):[]},Rs.flattenDepth=function(Yr,Qr){return Yr!=null&&Yr.length?Tu(Yr,Qr=Qr===Pr?1:Al(Qr)):[]},Rs.flip=function(Yr){return wp(Yr,512)},Rs.flow=Ox,Rs.flowRight=kx,Rs.fromPairs=function(Yr){for(var Qr=-1,ns=Yr==null?0:Yr.length,cs={};++Qr<ns;){var ws=Yr[Qr];cs[ws[0]]=ws[1]}return cs},Rs.functions=function(Yr){return Yr==null?[]:L0(Yr,bu(Yr))},Rs.functionsIn=function(Yr){return Yr==null?[]:L0(Yr,Lu(Yr))},Rs.groupBy=J1,Rs.initial=function(Yr){return Yr!=null&&Yr.length?Ku(Yr,0,-1):[]},Rs.intersection=L1,Rs.intersectionBy=M1,Rs.intersectionWith=N1,Rs.invert=vx,Rs.invertBy=bx,Rs.invokeMap=_b,Rs.iteratee=Xm,Rs.keyBy=ex,Rs.keys=bu,Rs.keysIn=Lu,Rs.map=K0,Rs.mapKeys=function(Yr,Qr){var ns={};return Qr=ga(Qr,3),rp(Yr,function(cs,ws,Is){Ep(ns,Qr(cs,ws,Is),cs)}),ns},Rs.mapValues=function(Yr,Qr){var ns={};return Qr=ga(Qr,3),rp(Yr,function(cs,ws,Is){Ep(ns,ws,Qr(cs,ws,Is))}),ns},Rs.matches=function(Yr){return _y(qu(Yr,1))},Rs.matchesProperty=function(Yr,Qr){return $y(Yr,qu(Qr,1))},Rs.memoize=X0,Rs.merge=Ex,Rs.mergeWith=Lv,Rs.method=Dx,Rs.methodOf=Lx,Rs.mixin=Zm,Rs.negate=Z0,Rs.nthArg=function(Yr){return Yr=Al(Yr),Cl(function(Qr){return Ay(Qr,Yr)})},Rs.omit=wx,Rs.omitBy=function(Yr,Qr){return Mv(Yr,Z0(ga(Qr)))},Rs.once=function(Yr){return Tv(2,Yr)},Rs.orderBy=function(Yr,Qr,ns,cs){return Yr==null?[]:(Sl(Qr)||(Qr=Qr==null?[]:[Qr]),Sl(ns=cs?Pr:ns)||(ns=ns==null?[]:[ns]),Ry(Yr,Qr,ns))},Rs.over=Mx,Rs.overArgs=sx,Rs.overEvery=Nx,Rs.overSome=Fx,Rs.partial=Vm,Rs.partialRight=$v,Rs.partition=tx,Rs.pick=Tx,Rs.pickBy=Mv,Rs.property=Vv,Rs.propertyOf=function(Yr){return function(Qr){return Yr==null?Pr:Vp(Yr,Qr)}},Rs.pull=F1,Rs.pullAll=yv,Rs.pullAllBy=function(Yr,Qr,ns){return Yr&&Yr.length&&Qr&&Qr.length?vm(Yr,Qr,ga(ns,2)):Yr},Rs.pullAllWith=function(Yr,Qr,ns){return Yr&&Yr.length&&Qr&&Qr.length?vm(Yr,Qr,Pr,ns):Yr},Rs.pullAt=B1,Rs.range=Bx,Rs.rangeRight=Ux,Rs.rearg=ox,Rs.reject=function(Yr,Qr){return(Sl(Yr)?ss:vy)(Yr,Z0(ga(Qr,3)))},Rs.remove=function(Yr,Qr){var ns=[];if(!Yr||!Yr.length)return ns;var cs=-1,ws=[],Is=Yr.length;for(Qr=ga(Qr,3);++cs<Is;){var Ns=Yr[cs];Qr(Ns,cs,Yr)&&(ns.push(Ns),ws.push(cs))}return Iy(Yr,ws),ns},Rs.rest=function(Yr,Qr){if(typeof Yr!="function")throw new Gu(Dr);return Cl(Yr,Qr=Qr===Pr?Qr:Al(Qr))},Rs.reverse=Um,Rs.sampleSize=function(Yr,Qr,ns){return Qr=(ns?Iu(Yr,Qr,ns):Qr===Pr)?1:Al(Qr),(Sl(Yr)?m1:T1)(Yr,Qr)},Rs.set=function(Yr,Qr,ns){return Yr==null?Yr:h0(Yr,Qr,ns)},Rs.setWith=function(Yr,Qr,ns,cs){return cs=typeof cs=="function"?cs:Pr,Yr==null?Yr:h0(Yr,Qr,ns,cs)},Rs.shuffle=function(Yr){return(Sl(Yr)?y1:_1)(Yr)},Rs.slice=function(Yr,Qr,ns){var cs=Yr==null?0:Yr.length;return cs?(ns&&typeof ns!="number"&&Iu(Yr,Qr,ns)?(Qr=0,ns=cs):(Qr=Qr==null?0:Al(Qr),ns=ns===Pr?cs:Al(ns)),Ku(Yr,Qr,ns)):[]},Rs.sortBy=nx,Rs.sortedUniq=function(Yr){return Yr&&Yr.length?Oy(Yr):[]},Rs.sortedUniqBy=function(Yr,Qr){return Yr&&Yr.length?Oy(Yr,ga(Qr,2)):[]},Rs.split=function(Yr,Qr,ns){return ns&&typeof ns!="number"&&Iu(Yr,Qr,ns)&&(Qr=ns=Pr),(ns=ns===Pr?Ur:ns>>>0)?(Yr=Vl(Yr))&&(typeof Qr=="string"||Qr!=null&&!Gm(Qr))&&!(Qr=Bu(Qr))&&ou(Yr)?Mp(au(Yr),0,ns):Yr.split(Qr,ns):[]},Rs.spread=function(Yr,Qr){if(typeof Yr!="function")throw new Gu(Dr);return Qr=Qr==null?0:mu(Al(Qr),0),Cl(function(ns){var cs=ns[Qr],ws=Mp(ns,0,Qr);return cs&&As(ws,cs),po(Yr,this,ws)})},Rs.tail=function(Yr){var Qr=Yr==null?0:Yr.length;return Qr?Ku(Yr,1,Qr):[]},Rs.take=function(Yr,Qr,ns){return Yr&&Yr.length?Ku(Yr,0,(Qr=ns||Qr===Pr?1:Al(Qr))<0?0:Qr):[]},Rs.takeRight=function(Yr,Qr,ns){var cs=Yr==null?0:Yr.length;return cs?Ku(Yr,(Qr=cs-(Qr=ns||Qr===Pr?1:Al(Qr)))<0?0:Qr,cs):[]},Rs.takeRightWhile=function(Yr,Qr){return Yr&&Yr.length?F0(Yr,ga(Qr,3),!1,!0):[]},Rs.takeWhile=function(Yr,Qr){return Yr&&Yr.length?F0(Yr,ga(Qr,3)):[]},Rs.tap=function(Yr,Qr){return Qr(Yr),Yr},Rs.throttle=function(Yr,Qr,ns){var cs=!0,ws=!0;if(typeof Yr!="function")throw new Gu(Dr);return nu(ns)&&(cs="leading"in ns?!!ns.leading:cs,ws="trailing"in ns?!!ns.trailing:ws),_v(Yr,Qr,{leading:cs,maxWait:Qr,trailing:ws})},Rs.thru=q0,Rs.toArray=Pv,Rs.toPairs=Nv,Rs.toPairsIn=Fv,Rs.toPath=function(Yr){return Sl(Yr)?Es(Yr,sp):Uu(Yr)?[Yr]:ku(dv(Vl(Yr)))},Rs.toPlainObject=kv,Rs.transform=function(Yr,Qr,ns){var cs=Sl(Yr),ws=cs||Np(Yr)||n0(Yr);if(Qr=ga(Qr,4),ns==null){var Is=Yr&&Yr.constructor;ns=ws?cs?new Is:[]:nu(Yr)&&_p(Is)?Qp(_0(Yr)):{}}return(ws?os:rp)(Yr,function(Ns,Bs,Gs){return Qr(ns,Ns,Bs,Gs)}),ns},Rs.unary=function(Yr){return wv(Yr,1)},Rs.union=U1,Rs.unionBy=j1,Rs.unionWith=z1,Rs.uniq=function(Yr){return Yr&&Yr.length?Dp(Yr):[]},Rs.uniqBy=function(Yr,Qr){return Yr&&Yr.length?Dp(Yr,ga(Qr,2)):[]},Rs.uniqWith=function(Yr,Qr){return Qr=typeof Qr=="function"?Qr:Pr,Yr&&Yr.length?Dp(Yr,Pr,Qr):[]},Rs.unset=function(Yr,Qr){return Yr==null||wm(Yr,Qr)},Rs.unzip=jm,Rs.unzipWith=vv,Rs.update=function(Yr,Qr,ns){return Yr==null?Yr:Dy(Yr,Qr,_m(ns))},Rs.updateWith=function(Yr,Qr,ns,cs){return cs=typeof cs=="function"?cs:Pr,Yr==null?Yr:Dy(Yr,Qr,_m(ns),cs)},Rs.values=r0,Rs.valuesIn=function(Yr){return Yr==null?[]:Hl(Yr,Lu(Yr))},Rs.without=V1,Rs.words=jv,Rs.wrap=function(Yr,Qr){return Vm(_m(Qr),Yr)},Rs.xor=H1,Rs.xorBy=G1,Rs.xorWith=W1,Rs.zip=q1,Rs.zipObject=function(Yr,Qr){return My(Yr||[],Qr||[],u0)},Rs.zipObjectDeep=function(Yr,Qr){return My(Yr||[],Qr||[],h0)},Rs.zipWith=K1,Rs.entries=Nv,Rs.entriesIn=Fv,Rs.extend=Dv,Rs.extendWith=_g,Zm(Rs,Rs),Rs.add=jx,Rs.attempt=zv,Rs.camelCase=Sx,Rs.capitalize=Bv,Rs.ceil=zx,Rs.clamp=function(Yr,Qr,ns){return ns===Pr&&(ns=Qr,Qr=Pr),ns!==Pr&&(ns=(ns=Xu(ns))==ns?ns:0),Qr!==Pr&&(Qr=(Qr=Xu(Qr))==Qr?Qr:0),zp(Xu(Yr),Qr,ns)},Rs.clone=function(Yr){return qu(Yr,4)},Rs.cloneDeep=function(Yr){return qu(Yr,5)},Rs.cloneDeepWith=function(Yr,Qr){return qu(Yr,5,Qr=typeof Qr=="function"?Qr:Pr)},Rs.cloneWith=function(Yr,Qr){return qu(Yr,4,Qr=typeof Qr=="function"?Qr:Pr)},Rs.conformsTo=function(Yr,Qr){return Qr==null||py(Yr,Qr,bu(Qr))},Rs.deburr=Uv,Rs.defaultTo=function(Yr,Qr){return Yr==null||Yr!=Yr?Qr:Yr},Rs.divide=Vx,Rs.endsWith=function(Yr,Qr,ns){Yr=Vl(Yr),Qr=Bu(Qr);var cs=Yr.length,ws=ns=ns===Pr?cs:zp(Al(ns),0,cs);return(ns-=Qr.length)>=0&&Yr.slice(ns,ws)==Qr},Rs.eq=_d,Rs.escape=function(Yr){return(Yr=Vl(Yr))&&Do.test(Yr)?Yr.replace(Ro,du):Yr},Rs.escapeRegExp=function(Yr){return(Yr=Vl(Yr))&&To.test(Yr)?Yr.replace(go,"\\$&"):Yr},Rs.every=function(Yr,Qr,ns){var cs=Sl(Yr)?Ss:b1;return ns&&Iu(Yr,Qr,ns)&&(Qr=Pr),cs(Yr,ga(Qr,3))},Rs.find=Z1,Rs.findIndex=hv,Rs.findKey=function(Yr,Qr){return Ao(Yr,ga(Qr,3),rp)},Rs.findLast=Q1,Rs.findLastIndex=pv,Rs.findLastKey=function(Yr,Qr){return Ao(Yr,ga(Qr,3),fm)},Rs.floor=Hx,Rs.forEach=xv,Rs.forEachRight=Ev,Rs.forIn=function(Yr,Qr){return Yr==null?Yr:dm(Yr,ga(Qr,3),Lu)},Rs.forInRight=function(Yr,Qr){return Yr==null?Yr:by(Yr,ga(Qr,3),Lu)},Rs.forOwn=function(Yr,Qr){return Yr&&rp(Yr,ga(Qr,3))},Rs.forOwnRight=function(Yr,Qr){return Yr&&fm(Yr,ga(Qr,3))},Rs.get=Wm,Rs.gt=ax,Rs.gte=lx,Rs.has=function(Yr,Qr){return Yr!=null&&nv(Yr,Qr,x1)},Rs.hasIn=qm,Rs.head=mv,Rs.identity=Mu,Rs.includes=function(Yr,Qr,ns,cs){Yr=Du(Yr)?Yr:r0(Yr),ns=ns&&!cs?Al(ns):0;var ws=Yr.length;return ns<0&&(ns=mu(ws+ns,0)),J0(Yr)?ns<=ws&&Yr.indexOf(Qr,ns)>-1:!!ws&&Oo(Yr,Qr,ns)>-1},Rs.indexOf=function(Yr,Qr,ns){var cs=Yr==null?0:Yr.length;if(!cs)return-1;var ws=ns==null?0:Al(ns);return ws<0&&(ws=mu(cs+ws,0)),Oo(Yr,Qr,ws)},Rs.inRange=function(Yr,Qr,ns){return Qr=$p(Qr),ns===Pr?(ns=Qr,Qr=0):ns=$p(ns),function(cs,ws,Is){return cs>=_u(ws,Is)&&cs<mu(ws,Is)}(Yr=Xu(Yr),Qr,ns)},Rs.invoke=xx,Rs.isArguments=Wp,Rs.isArray=Sl,Rs.isArrayBuffer=ux,Rs.isArrayLike=Du,Rs.isArrayLikeObject=lu,Rs.isBoolean=function(Yr){return Yr===!0||Yr===!1||su(Yr)&&Cu(Yr)==Kr},Rs.isBuffer=Np,Rs.isDate=cx,Rs.isElement=function(Yr){return su(Yr)&&Yr.nodeType===1&&!y0(Yr)},Rs.isEmpty=function(Yr){if(Yr==null)return!0;if(Du(Yr)&&(Sl(Yr)||typeof Yr=="string"||typeof Yr.splice=="function"||Np(Yr)||n0(Yr)||Wp(Yr)))return!Yr.length;var Qr=$u(Yr);if(Qr==es||Qr==ls)return!Yr.size;if(g0(Yr))return!mm(Yr).length;for(var ns in Yr)if(Gl.call(Yr,ns))return!1;return!0},Rs.isEqual=function(Yr,Qr){return f0(Yr,Qr)},Rs.isEqualWith=function(Yr,Qr,ns){var cs=(ns=typeof ns=="function"?ns:Pr)?ns(Yr,Qr):Pr;return cs===Pr?f0(Yr,Qr,Pr,ns):!!cs},Rs.isError=Hm,Rs.isFinite=function(Yr){return typeof Yr=="number"&&ly(Yr)},Rs.isFunction=_p,Rs.isInteger=Av,Rs.isLength=Q0,Rs.isMap=Rv,Rs.isMatch=function(Yr,Qr){return Yr===Qr||gm(Yr,Qr,Om(Qr))},Rs.isMatchWith=function(Yr,Qr,ns){return ns=typeof ns=="function"?ns:Pr,gm(Yr,Qr,Om(Qr),ns)},Rs.isNaN=function(Yr){return Cv(Yr)&&Yr!=+Yr},Rs.isNative=function(Yr){if(P1(Yr))throw new $l("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return wy(Yr)},Rs.isNil=function(Yr){return Yr==null},Rs.isNull=function(Yr){return Yr===null},Rs.isNumber=Cv,Rs.isObject=nu,Rs.isObjectLike=su,Rs.isPlainObject=y0,Rs.isRegExp=Gm,Rs.isSafeInteger=function(Yr){return Av(Yr)&&Yr>=-9007199254740991&&Yr<=Nr},Rs.isSet=Iv,Rs.isString=J0,Rs.isSymbol=Uu,Rs.isTypedArray=n0,Rs.isUndefined=function(Yr){return Yr===Pr},Rs.isWeakMap=function(Yr){return su(Yr)&&$u(Yr)==$s},Rs.isWeakSet=function(Yr){return su(Yr)&&Cu(Yr)=="[object WeakSet]"},Rs.join=function(Yr,Qr){return Yr==null?"":o1.call(Yr,Qr)},Rs.kebabCase=_x,Rs.last=Yu,Rs.lastIndexOf=function(Yr,Qr,ns){var cs=Yr==null?0:Yr.length;if(!cs)return-1;var ws=cs;return ns!==Pr&&(ws=(ws=Al(ns))<0?mu(cs+ws,0):_u(ws,cs-1)),Qr==Qr?function(Is,Ns,Bs){for(var Gs=Bs+1;Gs--;)if(Is[Gs]===Ns)return Gs;return Gs}(Yr,Qr,ws):Go(Yr,Ko,ws,!0)},Rs.lowerCase=$x,Rs.lowerFirst=Ax,Rs.lt=dx,Rs.lte=fx,Rs.max=function(Yr){return Yr&&Yr.length?D0(Yr,Mu,hm):Pr},Rs.maxBy=function(Yr,Qr){return Yr&&Yr.length?D0(Yr,ga(Qr,2),hm):Pr},Rs.mean=function(Yr){return Wo(Yr,Mu)},Rs.meanBy=function(Yr,Qr){return Wo(Yr,ga(Qr,2))},Rs.min=function(Yr){return Yr&&Yr.length?D0(Yr,Mu,ym):Pr},Rs.minBy=function(Yr,Qr){return Yr&&Yr.length?D0(Yr,ga(Qr,2),ym):Pr},Rs.stubArray=Jm,Rs.stubFalse=ey,Rs.stubObject=function(){return{}},Rs.stubString=function(){return""},Rs.stubTrue=function(){return!0},Rs.multiply=Gx,Rs.nth=function(Yr,Qr){return Yr&&Yr.length?Ay(Yr,Al(Qr)):Pr},Rs.noConflict=function(){return eu._===this&&(eu._=e1),this},Rs.noop=Qm,Rs.now=Y0,Rs.pad=function(Yr,Qr,ns){Yr=Vl(Yr);var cs=(Qr=Al(Qr))?hu(Yr):0;if(!Qr||cs>=Qr)return Yr;var ws=(Qr-cs)/2;return z0(C0(ws),ns)+Yr+z0(R0(ws),ns)},Rs.padEnd=function(Yr,Qr,ns){Yr=Vl(Yr);var cs=(Qr=Al(Qr))?hu(Yr):0;return Qr&&cs<Qr?Yr+z0(Qr-cs,ns):Yr},Rs.padStart=function(Yr,Qr,ns){Yr=Vl(Yr);var cs=(Qr=Al(Qr))?hu(Yr):0;return Qr&&cs<Qr?z0(Qr-cs,ns)+Yr:Yr},Rs.parseInt=function(Yr,Qr,ns){return ns||Qr==null?Qr=0:Qr&&(Qr=+Qr),u1(Vl(Yr).replace(Ho,""),Qr||0)},Rs.random=function(Yr,Qr,ns){if(ns&&typeof ns!="boolean"&&Iu(Yr,Qr,ns)&&(Qr=ns=Pr),ns===Pr&&(typeof Qr=="boolean"?(ns=Qr,Qr=Pr):typeof Yr=="boolean"&&(ns=Yr,Yr=Pr)),Yr===Pr&&Qr===Pr?(Yr=0,Qr=1):(Yr=$p(Yr),Qr===Pr?(Qr=Yr,Yr=0):Qr=$p(Qr)),Yr>Qr){var cs=Yr;Yr=Qr,Qr=cs}if(ns||Yr%1||Qr%1){var ws=uy();return _u(Yr+ws*(Qr-Yr+pp("1e-"+((ws+"").length-1))),Qr)}return bm(Yr,Qr)},Rs.reduce=function(Yr,Qr,ns){var cs=Sl(Yr)?Ms:Bo,ws=arguments.length<3;return cs(Yr,ga(Qr,4),ns,ws,kp)},Rs.reduceRight=function(Yr,Qr,ns){var cs=Sl(Yr)?Vs:Bo,ws=arguments.length<3;return cs(Yr,ga(Qr,4),ns,ws,yy)},Rs.repeat=function(Yr,Qr,ns){return Qr=(ns?Iu(Yr,Qr,ns):Qr===Pr)?1:Al(Qr),xm(Vl(Yr),Qr)},Rs.replace=function(){var Yr=arguments,Qr=Vl(Yr[0]);return Yr.length<3?Qr:Qr.replace(Yr[1],Yr[2])},Rs.result=function(Yr,Qr,ns){var cs=-1,ws=(Qr=Lp(Qr,Yr)).length;for(ws||(ws=1,Yr=Pr);++cs<ws;){var Is=Yr==null?Pr:Yr[sp(Qr[cs])];Is===Pr&&(cs=ws,Is=ns),Yr=_p(Is)?Is.call(Yr):Is}return Yr},Rs.round=Wx,Rs.runInContext=Ys,Rs.sample=function(Yr){return(Sl(Yr)?fy:w1)(Yr)},Rs.size=function(Yr){if(Yr==null)return 0;if(Du(Yr))return J0(Yr)?hu(Yr):Yr.length;var Qr=$u(Yr);return Qr==es||Qr==ls?Yr.size:mm(Yr).length},Rs.snakeCase=Rx,Rs.some=function(Yr,Qr,ns){var cs=Sl(Yr)?so:$1;return ns&&Iu(Yr,Qr,ns)&&(Qr=Pr),cs(Yr,ga(Qr,3))},Rs.sortedIndex=function(Yr,Qr){return N0(Yr,Qr)},Rs.sortedIndexBy=function(Yr,Qr,ns){return Em(Yr,Qr,ga(ns,2))},Rs.sortedIndexOf=function(Yr,Qr){var ns=Yr==null?0:Yr.length;if(ns){var cs=N0(Yr,Qr);if(cs<ns&&_d(Yr[cs],Qr))return cs}return-1},Rs.sortedLastIndex=function(Yr,Qr){return N0(Yr,Qr,!0)},Rs.sortedLastIndexBy=function(Yr,Qr,ns){return Em(Yr,Qr,ga(ns,2),!0)},Rs.sortedLastIndexOf=function(Yr,Qr){if(Yr!=null&&Yr.length){var ns=N0(Yr,Qr,!0)-1;if(_d(Yr[ns],Qr))return ns}return-1},Rs.startCase=Cx,Rs.startsWith=function(Yr,Qr,ns){return Yr=Vl(Yr),ns=ns==null?0:zp(Al(ns),0,Yr.length),Qr=Bu(Qr),Yr.slice(ns,ns+Qr.length)==Qr},Rs.subtract=qx,Rs.sum=function(Yr){return Yr&&Yr.length?Qo(Yr,Mu):0},Rs.sumBy=function(Yr,Qr){return Yr&&Yr.length?Qo(Yr,ga(Qr,2)):0},Rs.template=function(Yr,Qr,ns){var cs=Rs.templateSettings;ns&&Iu(Yr,Qr,ns)&&(Qr=Pr),Yr=Vl(Yr),Qr=_g({},Qr,cs,Qy);var ws,Is,Ns=_g({},Qr.imports,cs.imports,Qy),Bs=bu(Ns),Gs=Hl(Ns,Bs),uo=0,ao=Qr.interpolate||Ps,mo="__p += '",Lo=sm((Qr.escape||Ps).source+"|"+ao.source+"|"+(ao===Ws?Ul:Ps).source+"|"+(Qr.evaluate||Ps).source+"|$","g"),Mo="//# sourceURL="+(Gl.call(Qr,"sourceURL")?(Qr.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Ip+"]")+`
`;Yr.replace(Lo,function(Eo,na,$o,Tl,yl,Bl){return $o||($o=Tl),mo+=Yr.slice(uo,Bl).replace(ks,wu),na&&(ws=!0,mo+=`' +
__e(`+na+`) +
'`),yl&&(Is=!0,mo+=`';
`+yl+`;
__p += '`),$o&&(mo+=`' +
((__t = (`+$o+`)) == null ? '' : __t) +
'`),uo=Bl+Eo.length,Eo}),mo+=`';
`;var Jo=Gl.call(Qr,"variable")&&Qr.variable;if(Jo){if(Dl.test(Jo))throw new $l("Invalid `variable` option passed into `_.template`")}else mo=`with (obj) {
`+mo+`
}
`;mo=(Is?mo.replace(yo,""):mo).replace(Js,"$1").replace(lo,"$1;"),mo="function("+(Jo||"obj")+`) {
`+(Jo?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(ws?", __e = _.escape":"")+(Is?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+mo+`return __p
}`;var co=zv(function(){return tu(Bs,Mo+"return "+mo).apply(Pr,Gs)});if(co.source=mo,Hm(co))throw co;return co},Rs.times=function(Yr,Qr){if((Yr=Al(Yr))<1||Yr>Nr)return[];var ns=Ur,cs=_u(Yr,Ur);Qr=ga(Qr),Yr-=Ur;for(var ws=jo(cs,Qr);++ns<Yr;)Qr(ns);return ws},Rs.toFinite=$p,Rs.toInteger=Al,Rs.toLength=Ov,Rs.toLower=function(Yr){return Vl(Yr).toLowerCase()},Rs.toNumber=Xu,Rs.toSafeInteger=function(Yr){return Yr?zp(Al(Yr),-9007199254740991,Nr):Yr===0?Yr:0},Rs.toString=Vl,Rs.toUpper=function(Yr){return Vl(Yr).toUpperCase()},Rs.trim=function(Yr,Qr,ns){if((Yr=Vl(Yr))&&(ns||Qr===Pr))return _a(Yr);if(!Yr||!(Qr=Bu(Qr)))return Yr;var cs=au(Yr),ws=au(Qr);return Mp(cs,Ql(cs,ws),Wl(cs,ws)+1).join("")},Rs.trimEnd=function(Yr,Qr,ns){if((Yr=Vl(Yr))&&(ns||Qr===Pr))return Yr.slice(0,v0(Yr)+1);if(!Yr||!(Qr=Bu(Qr)))return Yr;var cs=au(Yr);return Mp(cs,0,Wl(cs,au(Qr))+1).join("")},Rs.trimStart=function(Yr,Qr,ns){if((Yr=Vl(Yr))&&(ns||Qr===Pr))return Yr.replace(Ho,"");if(!Yr||!(Qr=Bu(Qr)))return Yr;var cs=au(Yr);return Mp(cs,Ql(cs,au(Qr))).join("")},Rs.truncate=function(Yr,Qr){var ns=30,cs="...";if(nu(Qr)){var ws="separator"in Qr?Qr.separator:ws;ns="length"in Qr?Al(Qr.length):ns,cs="omission"in Qr?Bu(Qr.omission):cs}var Is=(Yr=Vl(Yr)).length;if(ou(Yr)){var Ns=au(Yr);Is=Ns.length}if(ns>=Is)return Yr;var Bs=ns-hu(cs);if(Bs<1)return cs;var Gs=Ns?Mp(Ns,0,Bs).join(""):Yr.slice(0,Bs);if(ws===Pr)return Gs+cs;if(Ns&&(Bs+=Gs.length-Bs),Gm(ws)){if(Yr.slice(Bs).search(ws)){var uo,ao=Gs;for(ws.global||(ws=sm(ws.source,Vl(Kl.exec(ws))+"g")),ws.lastIndex=0;uo=ws.exec(ao);)var mo=uo.index;Gs=Gs.slice(0,mo===Pr?Bs:mo)}}else if(Yr.indexOf(Bu(ws),Bs)!=Bs){var Lo=Gs.lastIndexOf(ws);Lo>-1&&(Gs=Gs.slice(0,Lo))}return Gs+cs},Rs.unescape=function(Yr){return(Yr=Vl(Yr))&&Co.test(Yr)?Yr.replace(vo,vp):Yr},Rs.uniqueId=function(Yr){var Qr=++Qv;return Vl(Yr)+Qr},Rs.upperCase=Ix,Rs.upperFirst=Km,Rs.each=xv,Rs.eachRight=Ev,Rs.first=mv,Zm(Rs,(ty={},rp(Rs,function(Yr,Qr){Gl.call(Rs.prototype,Qr)||(ty[Qr]=Yr)}),ty),{chain:!1}),Rs.VERSION="4.17.21",os(["bind","bindKey","curry","curryRight","partial","partialRight"],function(Yr){Rs[Yr].placeholder=Rs}),os(["drop","take"],function(Yr,Qr){Ol.prototype[Yr]=function(ns){ns=ns===Pr?1:mu(Al(ns),0);var cs=this.__filtered__&&!Qr?new Ol(this):this.clone();return cs.__filtered__?cs.__takeCount__=_u(ns,cs.__takeCount__):cs.__views__.push({size:_u(ns,Ur),type:Yr+(cs.__dir__<0?"Right":"")}),cs},Ol.prototype[Yr+"Right"]=function(ns){return this.reverse()[Yr](ns).reverse()}}),os(["filter","map","takeWhile"],function(Yr,Qr){var ns=Qr+1,cs=ns==1||ns==3;Ol.prototype[Yr]=function(ws){var Is=this.clone();return Is.__iteratees__.push({iteratee:ga(ws,3),type:ns}),Is.__filtered__=Is.__filtered__||cs,Is}}),os(["head","last"],function(Yr,Qr){var ns="take"+(Qr?"Right":"");Ol.prototype[Yr]=function(){return this[ns](1).value()[0]}}),os(["initial","tail"],function(Yr,Qr){var ns="drop"+(Qr?"":"Right");Ol.prototype[Yr]=function(){return this.__filtered__?new Ol(this):this[ns](1)}}),Ol.prototype.compact=function(){return this.filter(Mu)},Ol.prototype.find=function(Yr){return this.filter(Yr).head()},Ol.prototype.findLast=function(Yr){return this.reverse().find(Yr)},Ol.prototype.invokeMap=Cl(function(Yr,Qr){return typeof Yr=="function"?new Ol(this):this.map(function(ns){return d0(ns,Yr,Qr)})}),Ol.prototype.reject=function(Yr){return this.filter(Z0(ga(Yr)))},Ol.prototype.slice=function(Yr,Qr){Yr=Al(Yr);var ns=this;return ns.__filtered__&&(Yr>0||Qr<0)?new Ol(ns):(Yr<0?ns=ns.takeRight(-Yr):Yr&&(ns=ns.drop(Yr)),Qr!==Pr&&(ns=(Qr=Al(Qr))<0?ns.dropRight(-Qr):ns.take(Qr-Yr)),ns)},Ol.prototype.takeRightWhile=function(Yr){return this.reverse().takeWhile(Yr).reverse()},Ol.prototype.toArray=function(){return this.take(Ur)},rp(Ol.prototype,function(Yr,Qr){var ns=/^(?:filter|find|map|reject)|While$/.test(Qr),cs=/^(?:head|last)$/.test(Qr),ws=Rs[cs?"take"+(Qr=="last"?"Right":""):Qr],Is=cs||/^find/.test(Qr);ws&&(Rs.prototype[Qr]=function(){var Ns=this.__wrapped__,Bs=cs?[1]:arguments,Gs=Ns instanceof Ol,uo=Bs[0],ao=Gs||Sl(Ns),mo=function(na){var $o=ws.apply(Rs,As([na],Bs));return cs&&Lo?$o[0]:$o};ao&&ns&&typeof uo=="function"&&uo.length!=1&&(Gs=ao=!1);var Lo=this.__chain__,Mo=!!this.__actions__.length,Jo=Is&&!Lo,co=Gs&&!Mo;if(!Is&&ao){Ns=co?Ns:new Ol(this);var Eo=Yr.apply(Ns,Bs);return Eo.__actions__.push({func:q0,args:[mo],thisArg:Pr}),new Wu(Eo,Lo)}return Jo&&co?Yr.apply(this,Bs):(Eo=this.thru(mo),Jo?cs?Eo.value()[0]:Eo.value():Eo)})}),os(["pop","push","shift","sort","splice","unshift"],function(Yr){var Qr=b0[Yr],ns=/^(?:push|sort|unshift)$/.test(Yr)?"tap":"thru",cs=/^(?:pop|shift)$/.test(Yr);Rs.prototype[Yr]=function(){var ws=arguments;if(cs&&!this.__chain__){var Is=this.value();return Qr.apply(Sl(Is)?Is:[],ws)}return this[ns](function(Ns){return Qr.apply(Sl(Ns)?Ns:[],ws)})}}),rp(Ol.prototype,function(Yr,Qr){var ns=Rs[Qr];if(ns){var cs=ns.name+"";Gl.call(Zp,cs)||(Zp[cs]=[]),Zp[cs].push({name:Qr,func:ns})}}),Zp[U0(Pr,2).name]=[{name:"wrapper",func:Pr}],Ol.prototype.clone=function(){var Yr=new Ol(this.__wrapped__);return Yr.__actions__=ku(this.__actions__),Yr.__dir__=this.__dir__,Yr.__filtered__=this.__filtered__,Yr.__iteratees__=ku(this.__iteratees__),Yr.__takeCount__=this.__takeCount__,Yr.__views__=ku(this.__views__),Yr},Ol.prototype.reverse=function(){if(this.__filtered__){var Yr=new Ol(this);Yr.__dir__=-1,Yr.__filtered__=!0}else(Yr=this.clone()).__dir__*=-1;return Yr},Ol.prototype.value=function(){var Yr=this.__wrapped__.value(),Qr=this.__dir__,ns=Sl(Yr),cs=Qr<0,ws=ns?Yr.length:0,Is=function(Bl,Yo,xa){for(var yu=-1,uu=xa.length;++yu<uu;){var Pu=xa[yu],Zl=Pu.size;switch(Pu.type){case"drop":Bl+=Zl;break;case"dropRight":Yo-=Zl;break;case"take":Yo=_u(Yo,Bl+Zl);break;case"takeRight":Bl=mu(Bl,Yo-Zl)}}return{start:Bl,end:Yo}}(0,ws,this.__views__),Ns=Is.start,Bs=Is.end,Gs=Bs-Ns,uo=cs?Bs:Ns-1,ao=this.__iteratees__,mo=ao.length,Lo=0,Mo=_u(Gs,this.__takeCount__);if(!ns||!cs&&ws==Gs&&Mo==Gs)return Ly(Yr,this.__actions__);var Jo=[];e:for(;Gs--&&Lo<Mo;){for(var co=-1,Eo=Yr[uo+=Qr];++co<mo;){var na=ao[co],$o=na.iteratee,Tl=na.type,yl=$o(Eo);if(Tl==2)Eo=yl;else if(!yl){if(Tl==1)continue e;break e}}Jo[Lo++]=Eo}return Jo},Rs.prototype.at=Y1,Rs.prototype.chain=function(){return bv(this)},Rs.prototype.commit=function(){return new Wu(this.value(),this.__chain__)},Rs.prototype.next=function(){this.__values__===Pr&&(this.__values__=Pv(this.value()));var Yr=this.__index__>=this.__values__.length;return{done:Yr,value:Yr?Pr:this.__values__[this.__index__++]}},Rs.prototype.plant=function(Yr){for(var Qr,ns=this;ns instanceof O0;){var cs=fv(ns);cs.__index__=0,cs.__values__=Pr,Qr?ws.__wrapped__=cs:Qr=cs;var ws=cs;ns=ns.__wrapped__}return ws.__wrapped__=Yr,Qr},Rs.prototype.reverse=function(){var Yr=this.__wrapped__;if(Yr instanceof Ol){var Qr=Yr;return this.__actions__.length&&(Qr=new Ol(this)),(Qr=Qr.reverse()).__actions__.push({func:q0,args:[Um],thisArg:Pr}),new Wu(Qr,this.__chain__)}return this.thru(Um)},Rs.prototype.toJSON=Rs.prototype.valueOf=Rs.prototype.value=function(){return Ly(this.__wrapped__,this.__actions__)},Rs.prototype.first=Rs.prototype.head,i0&&(Rs.prototype[i0]=function(){return this}),Rs}();eu._=Kp,(Rr=(function(){return Kp}).call(Tr,Ar,Tr,_r))===Pr||(_r.exports=Rr)}).call(this)},793:module=>{var t;t=()=>(()=>{var __webpack_modules__={8453:(_r,Tr,Ar)=>{Ar.r(Tr),Ar.d(Tr,{InferenceSession:()=>Ur,Tensor:()=>Nr,env:()=>Mr,registerBackend:()=>Dr});const Rr={},Pr=[],Dr=(Vr,Wr,qr)=>{if(!Wr||typeof Wr.init!="function"||typeof Wr.createSessionHandler!="function")throw new TypeError("not a valid backend");{const Kr=Rr[Vr];if(Kr===void 0)Rr[Vr]={backend:Wr,priority:qr};else{if(Kr.priority>qr)return;if(Kr.priority===qr&&Kr.backend!==Wr)throw new Error(`cannot register backend "${Vr}" using priority ${qr}`)}if(qr>=0){const Xr=Pr.indexOf(Vr);Xr!==-1&&Pr.splice(Xr,1);for(let Zr=0;Zr<Pr.length;Zr++)if(Rr[Pr[Zr]].priority<=qr)return void Pr.splice(Zr,0,Vr);Pr.push(Vr)}}},Mr=new class{constructor(){this.wasm={},this.webgl={},this.webgpu={},this.logLevelInternal="warning"}set logLevel(Vr){if(Vr!==void 0){if(typeof Vr!="string"||["verbose","info","warning","error","fatal"].indexOf(Vr)===-1)throw new Error(`Unsupported logging level: ${Vr}`);this.logLevelInternal=Vr}}get logLevel(){return this.logLevelInternal}},Fr=new Map([["float32",Float32Array],["uint8",Uint8Array],["int8",Int8Array],["uint16",Uint16Array],["int16",Int16Array],["int32",Int32Array],["bool",Uint8Array],["float64",Float64Array],["uint32",Uint32Array]]),zr=new Map([[Float32Array,"float32"],[Uint8Array,"uint8"],[Int8Array,"int8"],[Uint16Array,"uint16"],[Int16Array,"int16"],[Int32Array,"int32"],[Float64Array,"float64"],[Uint32Array,"uint32"]]);let jr=!1;class Gr{constructor(Wr,qr,Kr){let Xr,Zr,_i;if((()=>{if(!jr){jr=!0;const es=typeof BigInt64Array<"u"&&typeof BigInt64Array.from=="function",ts=typeof BigUint64Array<"u"&&typeof BigUint64Array.from=="function";es&&(Fr.set("int64",BigInt64Array),zr.set(BigInt64Array,"int64")),ts&&(Fr.set("uint64",BigUint64Array),zr.set(BigUint64Array,"uint64"))}})(),typeof Wr=="string")if(Xr=Wr,_i=Kr,Wr==="string"){if(!Array.isArray(qr))throw new TypeError("A string tensor's data must be a string array.");Zr=qr}else{const es=Fr.get(Wr);if(es===void 0)throw new TypeError(`Unsupported tensor type: ${Wr}.`);if(Array.isArray(qr))Zr=es.from(qr);else{if(!(qr instanceof es))throw new TypeError(`A ${Xr} tensor's data must be type of ${es}`);Zr=qr}}else if(_i=qr,Array.isArray(Wr)){if(Wr.length===0)throw new TypeError("Tensor type cannot be inferred from an empty array.");const es=typeof Wr[0];if(es==="string")Xr="string",Zr=Wr;else{if(es!=="boolean")throw new TypeError(`Invalid element type of data array: ${es}.`);Xr="bool",Zr=Uint8Array.from(Wr)}}else{const es=zr.get(Wr.constructor);if(es===void 0)throw new TypeError(`Unsupported type for tensor data: ${Wr.constructor}.`);Xr=es,Zr=Wr}if(_i===void 0)_i=[Zr.length];else if(!Array.isArray(_i))throw new TypeError("A tensor's dims must be a number array");const Jr=(es=>{let ts=1;for(let is=0;is<es.length;is++){const rs=es[is];if(typeof rs!="number"||!Number.isSafeInteger(rs))throw new TypeError(`dims[${is}] must be an integer, got: ${rs}`);if(rs<0)throw new RangeError(`dims[${is}] must be a non-negative integer, got: ${rs}`);ts*=rs}return ts})(_i);if(Jr!==Zr.length)throw new Error(`Tensor's size(${Jr}) does not match data length(${Zr.length}).`);this.dims=_i,this.type=Xr,this.data=Zr,this.size=Jr}static bufferToTensor(Wr,qr){if(Wr===void 0)throw new Error("Image buffer must be defined");if(qr.height===void 0||qr.width===void 0)throw new Error("Image height and width must be defined");if(qr.tensorLayout==="NHWC")throw new Error("NHWC Tensor layout is not supported yet");const{height:Kr,width:Xr}=qr,Zr=qr.norm??{mean:255,bias:0};let _i,Jr;_i=typeof Zr.mean=="number"?[Zr.mean,Zr.mean,Zr.mean,Zr.mean]:[Zr.mean[0],Zr.mean[1],Zr.mean[2],Zr.mean[3]??255],Jr=typeof Zr.bias=="number"?[Zr.bias,Zr.bias,Zr.bias,Zr.bias]:[Zr.bias[0],Zr.bias[1],Zr.bias[2],Zr.bias[3]??0];const es=qr.bitmapFormat!==void 0?qr.bitmapFormat:"RGBA",ts=qr.tensorFormat!==void 0&&qr.tensorFormat!==void 0?qr.tensorFormat:"RGB",is=Kr*Xr,rs=ts==="RGBA"?new Float32Array(4*is):new Float32Array(3*is);let as=4,ls=0,fs=1,Ts=2,$s=3,xs=0,ys=is,ps=2*is,vs=-1;es==="RGB"&&(as=3,ls=0,fs=1,Ts=2,$s=-1),ts==="RGBA"?vs=3*is:ts==="RBG"?(xs=0,ps=is,ys=2*is):ts==="BGR"&&(ps=0,ys=is,xs=2*is);for(let Ds=0;Ds<is;Ds++,ls+=as,Ts+=as,fs+=as,$s+=as)rs[xs++]=(Wr[ls]+Jr[0])/_i[0],rs[ys++]=(Wr[fs]+Jr[1])/_i[1],rs[ps++]=(Wr[Ts]+Jr[2])/_i[2],vs!==-1&&$s!==-1&&(rs[vs++]=(Wr[$s]+Jr[3])/_i[3]);return new Gr("float32",rs,ts==="RGBA"?[1,4,Kr,Xr]:[1,3,Kr,Xr])}static async fromImage(Wr,qr){const Kr=typeof HTMLImageElement<"u"&&Wr instanceof HTMLImageElement,Xr=typeof ImageData<"u"&&Wr instanceof ImageData,Zr=typeof ImageBitmap<"u"&&Wr instanceof ImageBitmap,_i=typeof Wr=="string";let Jr,es=qr??{};if(Kr){const ts=document.createElement("canvas");ts.width=Wr.width,ts.height=Wr.height;const is=ts.getContext("2d");if(is==null)throw new Error("Can not access image data");{let rs=Wr.height,as=Wr.width;if(qr!==void 0&&qr.resizedHeight!==void 0&&qr.resizedWidth!==void 0&&(rs=qr.resizedHeight,as=qr.resizedWidth),qr!==void 0){if(es=qr,qr.tensorFormat!==void 0)throw new Error("Image input config format must be RGBA for HTMLImageElement");if(es.tensorFormat="RGBA",qr.height!==void 0&&qr.height!==rs)throw new Error("Image input config height doesn't match HTMLImageElement height");if(es.height=rs,qr.width!==void 0&&qr.width!==as)throw new Error("Image input config width doesn't match HTMLImageElement width");es.width=as}else es.tensorFormat="RGBA",es.height=rs,es.width=as;is.drawImage(Wr,0,0),Jr=is.getImageData(0,0,as,rs).data}}else{if(!Xr){if(Zr){if(qr===void 0)throw new Error("Please provide image config with format for Imagebitmap");if(qr.bitmapFormat!==void 0)throw new Error("Image input config format must be defined for ImageBitmap");const ts=document.createElement("canvas").getContext("2d");if(ts!=null){const is=Wr.height,rs=Wr.width;if(ts.drawImage(Wr,0,0,rs,is),Jr=ts.getImageData(0,0,rs,is).data,qr!==void 0){if(qr.height!==void 0&&qr.height!==is)throw new Error("Image input config height doesn't match ImageBitmap height");if(es.height=is,qr.width!==void 0&&qr.width!==rs)throw new Error("Image input config width doesn't match ImageBitmap width");es.width=rs}else es.height=is,es.width=rs;return Gr.bufferToTensor(Jr,es)}throw new Error("Can not access image data")}if(_i)return new Promise((ts,is)=>{const rs=document.createElement("canvas"),as=rs.getContext("2d");if(!Wr||!as)return is();const ls=new Image;ls.crossOrigin="Anonymous",ls.src=Wr,ls.onload=()=>{rs.width=ls.width,rs.height=ls.height,as.drawImage(ls,0,0,rs.width,rs.height);const fs=as.getImageData(0,0,rs.width,rs.height);if(qr!==void 0){if(qr.height!==void 0&&qr.height!==rs.height)throw new Error("Image input config height doesn't match height");if(es.height=rs.height,qr.width!==void 0&&qr.width!==rs.width)throw new Error("Image input config width doesn't match width");es.width=rs.width}else es.height=rs.height,es.width=rs.width;ts(Gr.bufferToTensor(fs.data,es))}});throw new Error("Input data provided is not supported - aborted tensor creation")}{const ts="RGBA";let is,rs;if(qr!==void 0&&qr.resizedWidth!==void 0&&qr.resizedHeight!==void 0?(is=qr.resizedHeight,rs=qr.resizedWidth):(is=Wr.height,rs=Wr.width),qr!==void 0){if(es=qr,qr.bitmapFormat!==void 0&&qr.bitmapFormat!==ts)throw new Error("Image input config format must be RGBA for ImageData");es.bitmapFormat="RGBA"}else es.bitmapFormat="RGBA";if(es.height=is,es.width=rs,qr!==void 0){const as=document.createElement("canvas");as.width=rs,as.height=is;const ls=as.getContext("2d");if(ls==null)throw new Error("Can not access image data");ls.putImageData(Wr,0,0),Jr=ls.getImageData(0,0,rs,is).data}else Jr=Wr.data}}if(Jr!==void 0)return Gr.bufferToTensor(Jr,es);throw new Error("Input data provided is not supported - aborted tensor creation")}toDataURL(Wr){const qr=document.createElement("canvas");qr.width=this.dims[3],qr.height=this.dims[2];const Kr=qr.getContext("2d");if(Kr!=null){let Xr,Zr;(Wr==null?void 0:Wr.tensorLayout)!==void 0&&Wr.tensorLayout==="NHWC"?(Xr=this.dims[2],Zr=this.dims[3]):(Xr=this.dims[3],Zr=this.dims[2]);const _i=(Wr==null?void 0:Wr.format)!==void 0?Wr.format:"RGB",Jr=Wr==null?void 0:Wr.norm;let es,ts;Jr===void 0||Jr.mean===void 0?es=[255,255,255,255]:typeof Jr.mean=="number"?es=[Jr.mean,Jr.mean,Jr.mean,Jr.mean]:(es=[Jr.mean[0],Jr.mean[1],Jr.mean[2],0],Jr.mean[3]!==void 0&&(es[3]=Jr.mean[3])),Jr===void 0||Jr.bias===void 0?ts=[0,0,0,0]:typeof Jr.bias=="number"?ts=[Jr.bias,Jr.bias,Jr.bias,Jr.bias]:(ts=[Jr.bias[0],Jr.bias[1],Jr.bias[2],0],Jr.bias[3]!==void 0&&(ts[3]=Jr.bias[3]));const is=Zr*Xr;let rs=0,as=is,ls=2*is,fs=-1;_i==="RGBA"?(rs=0,as=is,ls=2*is,fs=3*is):_i==="RGB"?(rs=0,as=is,ls=2*is):_i==="RBG"&&(rs=0,ls=is,as=2*is);for(let Ts=0;Ts<Zr;Ts++)for(let $s=0;$s<Xr;$s++){const xs=(this.data[rs++]-ts[0])*es[0],ys=(this.data[as++]-ts[1])*es[1],ps=(this.data[ls++]-ts[2])*es[2],vs=fs===-1?255:(this.data[fs++]-ts[3])*es[3];Kr.fillStyle="rgba("+xs+","+ys+","+ps+","+vs+")",Kr.fillRect($s,Ts,1,1)}return qr.toDataURL()}throw new Error("Can not access image data")}toImageData(Wr){const qr=document.createElement("canvas").getContext("2d");let Kr;if(qr==null)throw new Error("Can not access image data");{let Xr,Zr,_i;(Wr==null?void 0:Wr.tensorLayout)!==void 0&&Wr.tensorLayout==="NHWC"?(Xr=this.dims[2],Zr=this.dims[1],_i=this.dims[3]):(Xr=this.dims[3],Zr=this.dims[2],_i=this.dims[1]);const Jr=Wr!==void 0&&Wr.format!==void 0?Wr.format:"RGB",es=Wr==null?void 0:Wr.norm;let ts,is;es===void 0||es.mean===void 0?ts=[255,255,255,255]:typeof es.mean=="number"?ts=[es.mean,es.mean,es.mean,es.mean]:(ts=[es.mean[0],es.mean[1],es.mean[2],255],es.mean[3]!==void 0&&(ts[3]=es.mean[3])),es===void 0||es.bias===void 0?is=[0,0,0,0]:typeof es.bias=="number"?is=[es.bias,es.bias,es.bias,es.bias]:(is=[es.bias[0],es.bias[1],es.bias[2],0],es.bias[3]!==void 0&&(is[3]=es.bias[3]));const rs=Zr*Xr;if(Wr!==void 0){if(Wr.height!==void 0&&Wr.height!==Zr)throw new Error("Image output config height doesn't match tensor height");if(Wr.width!==void 0&&Wr.width!==Xr)throw new Error("Image output config width doesn't match tensor width");if(Wr.format!==void 0&&_i===4&&Wr.format!=="RGBA"||_i===3&&Wr.format!=="RGB"&&Wr.format!=="BGR")throw new Error("Tensor format doesn't match input tensor dims")}const as=4;let ls=0,fs=1,Ts=2,$s=3,xs=0,ys=rs,ps=2*rs,vs=-1;Jr==="RGBA"?(xs=0,ys=rs,ps=2*rs,vs=3*rs):Jr==="RGB"?(xs=0,ys=rs,ps=2*rs):Jr==="RBG"&&(xs=0,ps=rs,ys=2*rs),Kr=qr.createImageData(Xr,Zr);for(let Ds=0;Ds<Zr*Xr;ls+=as,fs+=as,Ts+=as,$s+=as,Ds++)Kr.data[ls]=(this.data[xs++]-is[0])*ts[0],Kr.data[fs]=(this.data[ys++]-is[1])*ts[1],Kr.data[Ts]=(this.data[ps++]-is[2])*ts[2],Kr.data[$s]=vs===-1?255:(this.data[vs++]-is[3])*ts[3]}return Kr}reshape(Wr){return new Gr(this.type,this.data,Wr)}}const Nr=Gr;class Lr{constructor(Wr){this.handler=Wr}async run(Wr,qr,Kr){const Xr={};let Zr={};if(typeof Wr!="object"||Wr===null||Wr instanceof Nr||Array.isArray(Wr))throw new TypeError("'feeds' must be an object that use input names as keys and OnnxValue as corresponding values.");let _i=!0;if(typeof qr=="object"){if(qr===null)throw new TypeError("Unexpected argument[1]: cannot be null.");if(qr instanceof Nr)throw new TypeError("'fetches' cannot be a Tensor");if(Array.isArray(qr)){if(qr.length===0)throw new TypeError("'fetches' cannot be an empty array.");_i=!1;for(const ts of qr){if(typeof ts!="string")throw new TypeError("'fetches' must be a string array or an object.");if(this.outputNames.indexOf(ts)===-1)throw new RangeError(`'fetches' contains invalid output name: ${ts}.`);Xr[ts]=null}if(typeof Kr=="object"&&Kr!==null)Zr=Kr;else if(Kr!==void 0)throw new TypeError("'options' must be an object.")}else{let ts=!1;const is=Object.getOwnPropertyNames(qr);for(const rs of this.outputNames)if(is.indexOf(rs)!==-1){const as=qr[rs];(as===null||as instanceof Nr)&&(ts=!0,_i=!1,Xr[rs]=as)}if(ts){if(typeof Kr=="object"&&Kr!==null)Zr=Kr;else if(Kr!==void 0)throw new TypeError("'options' must be an object.")}else Zr=qr}}else if(qr!==void 0)throw new TypeError("Unexpected argument[1]: must be 'fetches' or 'options'.");for(const ts of this.inputNames)if(Wr[ts]===void 0)throw new Error(`input '${ts}' is missing in 'feeds'.`);if(_i)for(const ts of this.outputNames)Xr[ts]=null;const Jr=await this.handler.run(Wr,Xr,Zr),es={};for(const ts in Jr)Object.hasOwnProperty.call(Jr,ts)&&(es[ts]=new Nr(Jr[ts].type,Jr[ts].data,Jr[ts].dims));return es}static async create(Wr,qr,Kr,Xr){let Zr,_i={};if(typeof Wr=="string"){if(Zr=Wr,typeof qr=="object"&&qr!==null)_i=qr;else if(qr!==void 0)throw new TypeError("'options' must be an object.")}else if(Wr instanceof Uint8Array){if(Zr=Wr,typeof qr=="object"&&qr!==null)_i=qr;else if(qr!==void 0)throw new TypeError("'options' must be an object.")}else{if(!(Wr instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&Wr instanceof SharedArrayBuffer))throw new TypeError("Unexpected argument[0]: must be 'path' or 'buffer'.");{const is=Wr;let rs=0,as=Wr.byteLength;if(typeof qr=="object"&&qr!==null)_i=qr;else if(typeof qr=="number"){if(rs=qr,!Number.isSafeInteger(rs))throw new RangeError("'byteOffset' must be an integer.");if(rs<0||rs>=is.byteLength)throw new RangeError(`'byteOffset' is out of range [0, ${is.byteLength}).`);if(as=Wr.byteLength-rs,typeof Kr=="number"){if(as=Kr,!Number.isSafeInteger(as))throw new RangeError("'byteLength' must be an integer.");if(as<=0||rs+as>is.byteLength)throw new RangeError(`'byteLength' is out of range (0, ${is.byteLength-rs}].`);if(typeof Xr=="object"&&Xr!==null)_i=Xr;else if(Xr!==void 0)throw new TypeError("'options' must be an object.")}else if(Kr!==void 0)throw new TypeError("'byteLength' must be a number.")}else if(qr!==void 0)throw new TypeError("'options' must be an object.");Zr=new Uint8Array(is,rs,as)}}const Jr=(_i.executionProviders||[]).map(is=>typeof is=="string"?is:is.name),es=await(async is=>{const rs=is.length===0?Pr:is,as=[];for(const ls of rs){const fs=Rr[ls];if(fs){if(fs.initialized)return fs.backend;if(fs.aborted)continue;const Ts=!!fs.initPromise;try{return Ts||(fs.initPromise=fs.backend.init()),await fs.initPromise,fs.initialized=!0,fs.backend}catch($s){Ts||as.push({name:ls,err:$s}),fs.aborted=!0}finally{delete fs.initPromise}}}throw new Error(`no available backend found. ERR: ${as.map(ls=>`[${ls.name}] ${ls.err}`).join(", ")}`)})(Jr),ts=await es.createSessionHandler(Zr,_i);return new Lr(ts)}startProfiling(){this.handler.startProfiling()}endProfiling(){this.handler.endProfiling()}get inputNames(){return this.handler.inputNames}get outputNames(){return this.handler.outputNames}}const Ur=Lr},5716:(_r,Tr,Ar)=>{Tr.R=void 0;const Rr=Ar(6027),Pr=Ar(1723);Tr.R=new class{async init(){}async createSessionHandler(Dr,Mr){const Fr=new Rr.Session(Mr);return await Fr.loadModel(Dr),new Pr.OnnxjsSessionHandler(Fr)}}},2818:(_r,Tr,Ar)=>{Tr.c8=Tr.rX=void 0;const Rr=Ar(8453),Pr=Ar(5381),Dr=Ar(9544),Mr=Ar(6640);Tr.rX=()=>{if((typeof Rr.env.wasm.initTimeout!="number"||Rr.env.wasm.initTimeout<0)&&(Rr.env.wasm.initTimeout=0),typeof Rr.env.wasm.simd!="boolean"&&(Rr.env.wasm.simd=!0),typeof Rr.env.wasm.proxy!="boolean"&&(Rr.env.wasm.proxy=!1),typeof Rr.env.wasm.numThreads!="number"||!Number.isInteger(Rr.env.wasm.numThreads)||Rr.env.wasm.numThreads<=0){const Fr=typeof navigator>"u"?(0,Pr.cpus)().length:navigator.hardwareConcurrency;Rr.env.wasm.numThreads=Math.min(4,Math.ceil((Fr||1)/2))}},Tr.c8=new class{async init(){(0,Tr.rX)(),await(0,Dr.initWasm)()}async createSessionHandler(Fr,zr){const jr=new Mr.OnnxruntimeWebAssemblySessionHandler;return await jr.loadModel(Fr,zr),Promise.resolve(jr)}}},1057:function(_r,Tr,Ar){var Rr=this&&this.__createBinding||(Object.create?function(Mr,Fr,zr,jr){jr===void 0&&(jr=zr);var Gr=Object.getOwnPropertyDescriptor(Fr,zr);Gr&&!("get"in Gr?!Fr.__esModule:Gr.writable||Gr.configurable)||(Gr={enumerable:!0,get:function(){return Fr[zr]}}),Object.defineProperty(Mr,jr,Gr)}:function(Mr,Fr,zr,jr){jr===void 0&&(jr=zr),Mr[jr]=Fr[zr]}),Pr=this&&this.__exportStar||function(Mr,Fr){for(var zr in Mr)zr==="default"||Object.prototype.hasOwnProperty.call(Fr,zr)||Rr(Fr,Mr,zr)};Object.defineProperty(Tr,"__esModule",{value:!0}),Pr(Ar(8453),Tr);const Dr=Ar(8453);{const Mr=Ar(5716).R;(0,Dr.registerBackend)("webgl",Mr,-10)}{const Mr=Ar(2818).c8;(0,Dr.registerBackend)("cpu",Mr,10),(0,Dr.registerBackend)("wasm",Mr,10),(0,Dr.registerBackend)("xnnpack",Mr,9)}},4910:(_r,Tr)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.createAttributeWithCacheKey=void 0;class Ar{constructor(Pr){Object.assign(this,Pr)}get cacheKey(){return this._cacheKey||(this._cacheKey=Object.getOwnPropertyNames(this).sort().map(Pr=>`${this[Pr]}`).join(";")),this._cacheKey}}Tr.createAttributeWithCacheKey=Rr=>new Ar(Rr)},6874:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.Attribute=void 0;const Rr=Ar(1446),Pr=Ar(1287),Dr=Ar(9240),Mr=Ar(7273);var Fr=Pr.onnxruntime.experimental.fbs;class zr{constructor(Gr){if(this._attributes=new Map,Gr!=null){for(const Nr of Gr)Nr instanceof Rr.onnx.AttributeProto?this._attributes.set(Nr.name,[zr.getValue(Nr),zr.getType(Nr)]):Nr instanceof Fr.Attribute&&this._attributes.set(Nr.name(),[zr.getValue(Nr),zr.getType(Nr)]);if(this._attributes.size<Gr.length)throw new Error("duplicated attribute names")}}set(Gr,Nr,Lr){this._attributes.set(Gr,[Lr,Nr])}delete(Gr){this._attributes.delete(Gr)}getFloat(Gr,Nr){return this.get(Gr,"float",Nr)}getInt(Gr,Nr){return this.get(Gr,"int",Nr)}getString(Gr,Nr){return this.get(Gr,"string",Nr)}getTensor(Gr,Nr){return this.get(Gr,"tensor",Nr)}getFloats(Gr,Nr){return this.get(Gr,"floats",Nr)}getInts(Gr,Nr){return this.get(Gr,"ints",Nr)}getStrings(Gr,Nr){return this.get(Gr,"strings",Nr)}getTensors(Gr,Nr){return this.get(Gr,"tensors",Nr)}get(Gr,Nr,Lr){const Ur=this._attributes.get(Gr);if(Ur===void 0){if(Lr!==void 0)return Lr;throw new Error(`required attribute not found: ${Gr}`)}if(Ur[1]!==Nr)throw new Error(`type mismatch: expected ${Nr} but got ${Ur[1]}`);return Ur[0]}static getType(Gr){const Nr=Gr instanceof Rr.onnx.AttributeProto?Gr.type:Gr.type();switch(Nr){case Rr.onnx.AttributeProto.AttributeType.FLOAT:return"float";case Rr.onnx.AttributeProto.AttributeType.INT:return"int";case Rr.onnx.AttributeProto.AttributeType.STRING:return"string";case Rr.onnx.AttributeProto.AttributeType.TENSOR:return"tensor";case Rr.onnx.AttributeProto.AttributeType.FLOATS:return"floats";case Rr.onnx.AttributeProto.AttributeType.INTS:return"ints";case Rr.onnx.AttributeProto.AttributeType.STRINGS:return"strings";case Rr.onnx.AttributeProto.AttributeType.TENSORS:return"tensors";default:throw new Error(`attribute type is not supported yet: ${Rr.onnx.AttributeProto.AttributeType[Nr]}`)}}static getValue(Gr){const Nr=Gr instanceof Rr.onnx.AttributeProto?Gr.type:Gr.type();if(Nr===Rr.onnx.AttributeProto.AttributeType.GRAPH||Nr===Rr.onnx.AttributeProto.AttributeType.GRAPHS)throw new Error("graph attribute is not supported yet");const Lr=this.getValueNoCheck(Gr);if(Nr===Rr.onnx.AttributeProto.AttributeType.INT&&Mr.LongUtil.isLong(Lr))return Mr.LongUtil.longToNumber(Lr);if(Nr===Rr.onnx.AttributeProto.AttributeType.INTS){const Ur=Lr,Vr=new Array(Ur.length);for(let Wr=0;Wr<Ur.length;Wr++){const qr=Ur[Wr];Vr[Wr]=Mr.LongUtil.longToNumber(qr)}return Vr}if(Nr===Rr.onnx.AttributeProto.AttributeType.TENSOR)return Gr instanceof Rr.onnx.AttributeProto?Dr.Tensor.fromProto(Lr):Dr.Tensor.fromOrtTensor(Lr);if(Nr===Rr.onnx.AttributeProto.AttributeType.TENSORS){if(Gr instanceof Rr.onnx.AttributeProto)return Lr.map(Ur=>Dr.Tensor.fromProto(Ur));if(Gr instanceof Fr.Attribute)return Lr.map(Ur=>Dr.Tensor.fromOrtTensor(Ur))}if(Nr===Rr.onnx.AttributeProto.AttributeType.STRING&&Gr instanceof Rr.onnx.AttributeProto){const Ur=Lr;return(0,Mr.decodeUtf8String)(Ur)}return Nr===Rr.onnx.AttributeProto.AttributeType.STRINGS&&Gr instanceof Rr.onnx.AttributeProto?Lr.map(Mr.decodeUtf8String):Lr}static getValueNoCheck(Gr){return Gr instanceof Rr.onnx.AttributeProto?this.getValueNoCheckFromOnnxFormat(Gr):this.getValueNoCheckFromOrtFormat(Gr)}static getValueNoCheckFromOnnxFormat(Gr){switch(Gr.type){case Rr.onnx.AttributeProto.AttributeType.FLOAT:return Gr.f;case Rr.onnx.AttributeProto.AttributeType.INT:return Gr.i;case Rr.onnx.AttributeProto.AttributeType.STRING:return Gr.s;case Rr.onnx.AttributeProto.AttributeType.TENSOR:return Gr.t;case Rr.onnx.AttributeProto.AttributeType.GRAPH:return Gr.g;case Rr.onnx.AttributeProto.AttributeType.FLOATS:return Gr.floats;case Rr.onnx.AttributeProto.AttributeType.INTS:return Gr.ints;case Rr.onnx.AttributeProto.AttributeType.STRINGS:return Gr.strings;case Rr.onnx.AttributeProto.AttributeType.TENSORS:return Gr.tensors;case Rr.onnx.AttributeProto.AttributeType.GRAPHS:return Gr.graphs;default:throw new Error(`unsupported attribute type: ${Rr.onnx.AttributeProto.AttributeType[Gr.type]}`)}}static getValueNoCheckFromOrtFormat(Gr){switch(Gr.type()){case Fr.AttributeType.FLOAT:return Gr.f();case Fr.AttributeType.INT:return Gr.i();case Fr.AttributeType.STRING:return Gr.s();case Fr.AttributeType.TENSOR:return Gr.t();case Fr.AttributeType.GRAPH:return Gr.g();case Fr.AttributeType.FLOATS:return Gr.floatsArray();case Fr.AttributeType.INTS:{const Nr=[];for(let Lr=0;Lr<Gr.intsLength();Lr++)Nr.push(Gr.ints(Lr));return Nr}case Fr.AttributeType.STRINGS:{const Nr=[];for(let Lr=0;Lr<Gr.stringsLength();Lr++)Nr.push(Gr.strings(Lr));return Nr}case Fr.AttributeType.TENSORS:{const Nr=[];for(let Lr=0;Lr<Gr.tensorsLength();Lr++)Nr.push(Gr.tensors(Lr));return Nr}default:throw new Error(`unsupported attribute type: ${Fr.AttributeType[Gr.type()]}`)}}}Tr.Attribute=zr},1975:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.resolveBackend=Tr.backend=void 0;const Rr=Ar(4418),Pr=new Map;async function Dr(Mr){const Fr=Tr.backend;if(Fr[Mr]!==void 0&&function(zr){const jr=zr;return"initialize"in jr&&typeof jr.initialize=="function"&&"createSessionHandler"in jr&&typeof jr.createSessionHandler=="function"&&"dispose"in jr&&typeof jr.dispose=="function"}(Fr[Mr])){const zr=Fr[Mr];let jr=zr.initialize();if(typeof jr=="object"&&"then"in jr&&(jr=await jr),jr)return Pr.set(Mr,zr),zr}}Tr.backend={webgl:new Rr.WebGLBackend},Tr.resolveBackend=async function Mr(Fr){if(!Fr)return Mr(["webgl"]);{const zr=typeof Fr=="string"?[Fr]:Fr;for(const jr of zr){const Gr=Pr.get(jr);if(Gr)return Gr;const Nr=await Dr(jr);if(Nr)return Nr}}throw new Error("no available backend to use")}},4418:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.WebGLBackend=void 0;const Rr=Ar(8453),Pr=Ar(1315),Dr=Ar(2171),Mr=Ar(3389);Tr.WebGLBackend=class{get contextId(){return Rr.env.webgl.contextId}set contextId(Fr){Rr.env.webgl.contextId=Fr}get matmulMaxBatchSize(){return Rr.env.webgl.matmulMaxBatchSize}set matmulMaxBatchSize(Fr){Rr.env.webgl.matmulMaxBatchSize=Fr}get textureCacheMode(){return Rr.env.webgl.textureCacheMode}set textureCacheMode(Fr){Rr.env.webgl.textureCacheMode=Fr}get pack(){return Rr.env.webgl.pack}set pack(Fr){Rr.env.webgl.pack=Fr}get async(){return Rr.env.webgl.async}set async(Fr){Rr.env.webgl.async=Fr}initialize(){try{return this.glContext=(0,Mr.createWebGLContext)(this.contextId),typeof this.matmulMaxBatchSize!="number"&&(this.matmulMaxBatchSize=16),typeof this.textureCacheMode!="string"&&(this.textureCacheMode="full"),typeof this.pack!="boolean"&&(this.pack=!1),typeof this.async!="boolean"&&(this.async=!1),Pr.Logger.setWithEnv(Rr.env),Pr.Logger.verbose("WebGLBackend",`Created WebGLContext: ${typeof this.glContext} with matmulMaxBatchSize: ${this.matmulMaxBatchSize}; textureCacheMode: ${this.textureCacheMode}; pack: ${this.pack}; async: ${this.async}.`),!0}catch(Fr){return Pr.Logger.warning("WebGLBackend",`Unable to initialize WebGLBackend. ${Fr}`),!1}}createSessionHandler(Fr){return new Dr.WebGLSessionHandler(this,Fr)}dispose(){this.glContext.dispose()}}},6859:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.CoordsGlslLib=void 0;const Rr=Ar(7273),Pr=Ar(1997),Dr=Ar(6757),Mr=Ar(7618),Fr=Ar(432);class zr extends Pr.GlslLib{constructor(Gr){super(Gr)}getFunctions(){return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},this.offsetToCoords()),this.coordsToOffset()),this.toVec()),this.valueFrom()),this.getCommonUtilFuncs()),this.getInputsSamplingSnippets()),this.getOutputSamplingSnippet())}getCustomTypes(){return{}}offsetToCoords(){return{offsetToCoords:new Pr.GlslLibRoutine(`
      vec2 offsetToCoords(int offset, int width, int height) {
        int t = offset / width;
        int s = offset - t*width;
        vec2 coords = (vec2(s,t) + vec2(0.5,0.5)) / vec2(width, height);
        return coords;
      }
      `)}}coordsToOffset(){return{coordsToOffset:new Pr.GlslLibRoutine(`
      int coordsToOffset(vec2 coords, int width, int height) {
        float s = coords.s * float(width);
        float t = coords.t * float(height);
        int offset = int(t) * width + int(s);
        return offset;
      }
      `)}}getOutputSamplingSnippet(){const Gr=this.context.outputTextureLayout;return Gr.isPacked?this.getPackedOutputSamplingSnippet(Gr):this.getUnpackedOutputSamplingSnippet(Gr)}getPackedOutputSamplingSnippet(Gr){const Nr=Gr.unpackedShape,Lr=[Gr.width,Gr.height],Ur={},Vr="getOutputCoords";switch(Nr.length){case 0:Ur[Vr]=this.getOutputScalarCoords();break;case 1:Ur[Vr]=this.getOutputPacked1DCoords(Nr,Lr);break;case 2:Ur[Vr]=this.getOutputPacked2DCoords(Nr,Lr);break;case 3:Ur[Vr]=this.getOutputPacked3DCoords(Nr,Lr);break;default:Ur[Vr]=this.getOutputPackedNDCoords(Nr,Lr)}const Wr=`
      void setOutput(vec4 val) {
        ${(0,Dr.getGlsl)(this.context.glContext.version).output} = val;
      }
    `;return Ur.floatTextureSetRGBA=new Pr.GlslLibRoutine(Wr),Ur}getUnpackedOutputSamplingSnippet(Gr){const Nr=Gr.unpackedShape,Lr=[Gr.width,Gr.height],Ur={},Vr="getOutputCoords";switch(Nr.length){case 0:Ur[Vr]=this.getOutputScalarCoords();break;case 1:Ur[Vr]=this.getOutputUnpacked1DCoords(Nr,Lr);break;case 2:Ur[Vr]=this.getOutputUnpacked2DCoords(Nr,Lr);break;case 3:Ur[Vr]=this.getOutputUnpacked3DCoords(Nr,Lr);break;case 4:Ur[Vr]=this.getOutputUnpacked4DCoords(Nr,Lr);break;case 5:Ur[Vr]=this.getOutputUnpacked5DCoords(Nr,Lr);break;case 6:Ur[Vr]=this.getOutputUnpacked6DCoords(Nr,Lr);break;default:throw new Error(`Unsupported output dimensionality: ${Nr.length}`)}const Wr=`
        void setOutput(float val) {
          ${(0,Dr.getGlsl)(this.context.glContext.version).output} = vec4(val, 0, 0, 0);
        }
    `;return Ur.floatTextureSetR=new Pr.GlslLibRoutine(Wr),Ur}getOutputScalarCoords(){return new Pr.GlslLibRoutine(`
      int getOutputCoords() {
        return 0;
      }
    `)}getOutputPacked1DCoords(Gr,Nr){const Lr=Nr;let Ur="";return Lr[0]===1?(Ur=`
          int getOutputCoords() {
            return 2 * int(TexCoords.y * ${Lr[1]}.0);
          }
        `,new Pr.GlslLibRoutine(Ur)):Lr[1]===1?(Ur=`
          int getOutputCoords() {
            return 2 * int(TexCoords.x * ${Lr[0]}.0);
          }
        `,new Pr.GlslLibRoutine(Ur)):(Ur=`
        int getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                 vec2(${Lr[0]}, ${Lr[1]}));
          return 2 * (resTexRC.y * ${Lr[0]} + resTexRC.x);
        }
      `,new Pr.GlslLibRoutine(Ur))}getOutputPacked2DCoords(Gr,Nr){let Lr="";if(Rr.ArrayUtil.arraysEqual(Gr,Nr))return Lr=`
        ivec2 getOutputCoords() {
          return 2 * ivec2(TexCoords.xy * vec2(${Nr[0]}, ${Nr[1]}));
        }
      `,new Pr.GlslLibRoutine(Lr);const Ur=Nr,Vr=Math.ceil(Gr[1]/2);return Lr=`
        ivec2 getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                vec2(${Ur[0]}, ${Ur[1]}));

          int index = resTexRC.y * ${Ur[0]} + resTexRC.x;

          // reverse r and c order for packed texture
          int r = imod(index, ${Vr}) * 2;
          int c = 2 * (index / ${Vr});

          return ivec2(r, c);
        }
      `,new Pr.GlslLibRoutine(Lr)}getOutputPacked3DCoords(Gr,Nr){const Lr=[Nr[0],Nr[1]],Ur=Math.ceil(Gr[2]/2),Vr=Ur*Math.ceil(Gr[1]/2),Wr=`
        ivec3 getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                vec2(${Lr[0]}, ${Lr[1]}));
          int index = resTexRC.y * ${Lr[0]} + resTexRC.x;

          int b = index / ${Vr};
          index -= b * ${Vr};

          // reverse r and c order for packed texture
          int r = imod(index, ${Ur}) * 2;
          int c = 2 * (index / ${Ur});

          return ivec3(b, r, c);
        }
      `;return new Pr.GlslLibRoutine(Wr)}getOutputPackedNDCoords(Gr,Nr){const Lr=[Nr[0],Nr[1]],Ur=Math.ceil(Gr[Gr.length-1]/2),Vr=Ur*Math.ceil(Gr[Gr.length-2]/2);let Wr=Vr,qr="",Kr="b, r, c";for(let Zr=2;Zr<Gr.length-1;Zr++)Wr*=Gr[Gr.length-Zr-1],qr=`
      int b${Zr} = index / ${Wr};
      index -= b${Zr} * ${Wr};
    `+qr,Kr=`b${Zr}, `+Kr;const Xr=`
      ivec${Gr.length} getOutputCoords() {
        ivec2 resTexRC = ivec2(TexCoords.xy *
                              vec2(${Lr[0]}, ${Lr[1]}));
        int index = resTexRC.y * ${Lr[0]} + resTexRC.x;

        ${qr}

        int b = index / ${Vr};
        index -= b * ${Vr};

        // reverse r and c order for packed texture
        int r = imod(index, ${Ur}) * 2;
        int c = 2 * (index / ${Ur});

        return ivec${Gr.length}(${Kr});
      }
    `;return new Pr.GlslLibRoutine(Xr)}getOutputUnpacked1DCoords(Gr,Nr){const Lr=`
        int getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                vec2(${Nr[0]}, ${Nr[1]}));
          return resTexRC.y * ${Nr[0]} + resTexRC.x;
        }
      `;return new Pr.GlslLibRoutine(Lr)}getOutputUnpacked2DCoords(Gr,Nr){const Lr=`
        ivec2 getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                vec2(${Nr[0]}, ${Nr[1]}));
          int index = resTexRC.y * ${Nr[0]} + resTexRC.x;
          int r = index / ${Gr[1]};
          int c = index - r * ${Gr[1]};
          return ivec2(r, c);
        }
      `;return new Pr.GlslLibRoutine(Lr)}getOutputUnpacked3DCoords(Gr,Nr){let Lr="";const Ur=Gr.length;let Vr=null;Ur<2&&(Vr=[]),Vr=new Array(Ur-1),Vr[Ur-2]=Gr[Ur-1];for(let Kr=Ur-3;Kr>=0;--Kr)Vr[Kr]=Vr[Kr+1]*Gr[Kr+1];const Wr=["r","c","d"],qr=Vr.map((Kr,Xr)=>`int ${Wr[Xr]} = index / ${Kr}; ${Xr===Vr.length-1?`int ${Wr[Xr+1]} = index - ${Wr[Xr]} * ${Kr}`:`index -= ${Wr[Xr]} * ${Kr}`};`).join("");return Lr=`
        ivec3 getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                vec2(${Nr[0]}, ${Nr[1]}));
          int index = resTexRC.y * ${Nr[0]} + resTexRC.x;
          ${qr}
          return ivec3(r, c, d);
        }
      `,new Pr.GlslLibRoutine(Lr)}getOutputUnpacked4DCoords(Gr,Nr){let Lr="";const Ur=Gr.length;let Vr=null;Ur<2&&(Vr=[]),Vr=new Array(Ur-1),Vr[Ur-2]=Gr[Ur-1];for(let Kr=Ur-3;Kr>=0;--Kr)Vr[Kr]=Vr[Kr+1]*Gr[Kr+1];const Wr=["r","c","d","d2"],qr=Vr.map((Kr,Xr)=>`int ${Wr[Xr]} = index / ${Kr}; ${Xr===Vr.length-1?`int ${Wr[Xr+1]} = index - ${Wr[Xr]} * ${Kr}`:`index -= ${Wr[Xr]} * ${Kr}`};`).join("");return Lr=`
      ivec4 getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                vec2(${Nr[0]}, ${Nr[1]}));
          int index = resTexRC.y * ${Nr[0]} + resTexRC.x;
          ${qr}
          return ivec4(r, c, d, d2);
        }
      `,new Pr.GlslLibRoutine(Lr)}getOutputUnpacked5DCoords(Gr,Nr){let Lr="";const Ur=Gr.length;let Vr=null;Ur<2&&(Vr=[]),Vr=new Array(Ur-1),Vr[Ur-2]=Gr[Ur-1];for(let Kr=Ur-3;Kr>=0;--Kr)Vr[Kr]=Vr[Kr+1]*Gr[Kr+1];const Wr=["r","c","d","d2","d3"],qr=Vr.map((Kr,Xr)=>`int ${Wr[Xr]} = index / ${Kr}; ${Xr===Vr.length-1?`int ${Wr[Xr+1]} = index - ${Wr[Xr]} * ${Kr}`:`index -= ${Wr[Xr]} * ${Kr}`};`).join("");return Lr=`
      ivec5 getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                vec2(${Nr[0]}, ${Nr[1]}));
          int index = resTexRC.y * ${Nr[0]} + resTexRC.x;
          ${qr}
          return ivec5(r, c, d, d2, d3);
        }
      `,new Pr.GlslLibRoutine(Lr)}getOutputUnpacked6DCoords(Gr,Nr){let Lr="";const Ur=Gr.length;let Vr=null;Ur<2&&(Vr=[]),Vr=new Array(Ur-1),Vr[Ur-2]=Gr[Ur-1];for(let Kr=Ur-3;Kr>=0;--Kr)Vr[Kr]=Vr[Kr+1]*Gr[Kr+1];const Wr=["r","c","d","d2","d3","d4"],qr=Vr.map((Kr,Xr)=>`int ${Wr[Xr]} = index / ${Kr}; ${Xr===Vr.length-1?`int ${Wr[Xr+1]} = index - ${Wr[Xr]} * ${Kr}`:`index -= ${Wr[Xr]} * ${Kr}`};`).join("");return Lr=`
     ivec6 getOutputCoords() {
         ivec2 resTexRC = ivec2(TexCoords.xy *
                               vec2(${Nr[0]}, ${Nr[1]}));
         int index = resTexRC.y * ${Nr[0]} + resTexRC.x;
         ${qr}
         return ivec6(r, c, d, d2, d3, d4);
       }
     `,new Pr.GlslLibRoutine(Lr)}getCommonUtilFuncs(){const Gr={};let Nr="uvFromFlat";Gr[Nr]=new Pr.GlslLibRoutine(`
    vec2 uvFromFlat(int texNumR, int texNumC, int index) {
      int texC = index / texNumR;
      int texR = index - texC * texNumR;
      // TODO: swap texR, texC order in following function so row is corresponding to u and column is corresponding to
      //       v.
      return (vec2(texR, texC) + halfCR) / vec2(texNumR, texNumC);
    }
    `),Nr="packedUVfrom1D",Gr[Nr]=new Pr.GlslLibRoutine(`
      vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
        int texelIndex = index / 2;
        int texR = texelIndex / texNumC;
        int texC = texelIndex - texR * texNumC;
        return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
      }
      `),Nr="packedUVfrom2D",Gr[Nr]=new Pr.GlslLibRoutine(`
      vec2 packedUVfrom2D(int texNumR, int texNumC, int texelsInLogicalRow, int row, int col) {
        int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
        int texR = texelIndex / texNumC;
        int texC = texelIndex - texR * texNumC;
        return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
      }
      `),Nr="packedUVfrom3D",Gr[Nr]=new Pr.GlslLibRoutine(`
      vec2 packedUVfrom3D(int texNumR, int texNumC,
          int texelsInBatch, int texelsInLogicalRow, int b,
          int row, int col) {
        int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
        int texR = index / texNumC;
        int texC = index - texR * texNumC;
        return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
      }
      `),Nr="sampleTexture";const Lr=(0,Dr.getGlsl)(this.context.glContext.version);return Gr[Nr]=new Pr.GlslLibRoutine(`
        float sampleTexture(sampler2D textureSampler, vec2 uv) {
            return ${Lr.texture2D}(textureSampler, uv).r;
        }`),Gr}getInputsSamplingSnippets(){const Gr={},Nr=this.context.outputTextureLayout;return this.context.programInfo.inputNames.forEach((Lr,Ur)=>{const Vr=this.context.inputTextureLayouts[Ur],Wr=(0,Fr.generateShaderFuncNameFromInputSamplerName)(Lr);Vr.isPacked?Gr[Wr]=this.getPackedSamplerFromInput(Wr,Lr,Vr):Gr[Wr]=this.getUnpackedSamplerFromInput(Wr,Lr,Vr);const qr=(0,Fr.generateShaderFuncNameFromInputSamplerNameAtOutCoords)(Lr);Vr.unpackedShape.length<=Nr.unpackedShape.length&&(Vr.isPacked?Gr[qr]=this.getPackedSamplerAtOutputCoords(qr,Vr,Nr,Lr):Gr[qr]=this.getUnpackedSamplerAtOutputCoords(qr,Vr,Nr,Lr))}),Gr}getPackedSamplerAtOutputCoords(Gr,Nr,Lr,Ur){const Vr=Nr.unpackedShape,Wr=Lr.unpackedShape,qr=Ur,Kr=(0,Fr.generateShaderFuncNameFromInputSamplerName)(qr),Xr=Vr.length,Zr=Wr.length,_i=Rr.BroadcastUtil.getBroadcastDims(Vr,Wr),Jr=(0,Fr.getCoordsDataType)(Zr),es=Zr-Xr;let ts;const is=(0,Fr.getGlChannels)();ts=Xr===0?"":Zr<2&&_i.length>=1?"coords = 0;":_i.map($s=>`coords.${is[$s+es]} = 0;`).join(`
`);let rs="";rs=Zr<2&&Xr>0?"coords":Vr.map(($s,xs)=>`coords.${is[xs+es]}`).join(", ");let as="return outputValue;";const ls=Rr.ShapeUtil.size(Vr)===1,fs=Rr.ShapeUtil.size(Wr)===1;if(Xr!==1||ls||fs){if(ls&&!fs)as=Zr===1?`
          return vec4(outputValue.x, outputValue.x, 0., 0.);
        `:`
          return vec4(outputValue.x);
        `;else if(_i.length){const $s=Xr-2,xs=Xr-1;_i.indexOf($s)>-1&&_i.indexOf(xs)>-1?as="return vec4(outputValue.x);":_i.indexOf($s)>-1?as="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":_i.indexOf(xs)>-1&&(as="return vec4(outputValue.xx, outputValue.zz);")}}else as=`
        return vec4(outputValue.xy, outputValue.xy);
      `;const Ts=`
      vec4 ${Gr}() {
        ${Jr} coords = getOutputCoords();
        
        int lastDim = coords.${is[Zr-1]};
        coords.${is[Zr-1]} = coords.${is[Zr-2]};
        coords.${is[Zr-2]} = lastDim;
      
        ${ts}
        vec4 outputValue = ${Kr}(${rs});
        ${as}
      }
    `;return new Pr.GlslLibRoutine(Ts,["coordinates.getOutputCoords"])}getUnpackedSamplerAtOutputCoords(Gr,Nr,Lr,Ur){const Vr=[Lr.width,Lr.height],Wr=[Nr.width,Nr.height],qr=Nr.unpackedShape.length,Kr=Lr.unpackedShape.length,Xr=Nr.unpackedShape,Zr=Lr.unpackedShape,_i=(0,Fr.generateShaderFuncNameFromInputSamplerName)(Ur);if(qr===Kr&&Rr.ArrayUtil.arraysEqual(Wr,Vr)){const fs=`
          float ${Gr}() {
            return sampleTexture(${Ur}, TexCoords);
          }
        `;return new Pr.GlslLibRoutine(fs,["coordinates.sampleTexture"])}const Jr=(0,Fr.getCoordsDataType)(Kr),es=Rr.BroadcastUtil.getBroadcastDims(Xr,Zr),ts=Kr-qr;let is;const rs=(0,Fr.getGlChannels)();is=qr===0?"":Kr<2&&es.length>=1?"coords = 0;":es.map(fs=>`coords.${rs[fs+ts]} = 0;`).join(`
`);let as="";as=Kr<2&&qr>0?"coords":Nr.unpackedShape.map((fs,Ts)=>`coords.${rs[Ts+ts]}`).join(", ");const ls=`
        float ${Gr}() {
          ${Jr} coords = getOutputCoords();
          ${is}
          return ${_i}(${as});
        }
      `;return new Pr.GlslLibRoutine(ls,["coordinates.getOutputCoords"])}getPackedSamplerFromInput(Gr,Nr,Lr){switch(Lr.unpackedShape.length){case 0:return this.getPackedSamplerScalar(Gr,Nr);case 1:return this.getPackedSampler1D(Gr,Nr,Lr);case 2:return this.getPackedSampler2D(Gr,Nr,Lr);case 3:return this.getPackedSampler3D(Gr,Nr,Lr);default:return this.getPackedSamplerND(Gr,Nr,Lr)}}getUnpackedSamplerFromInput(Gr,Nr,Lr){const Ur=Lr.unpackedShape;switch(Ur.length){case 0:return this.getUnpackedSamplerScalar(Gr,Nr,Lr);case 1:return this.getUnpackedSampler1D(Gr,Nr,Lr);case 2:return this.getUnpackedSampler2D(Gr,Nr,Lr);case 3:return this.getUnpackedSampler3D(Gr,Nr,Lr);case 4:return this.getUnpackedSampler4D(Gr,Nr,Lr);case 5:return this.getUnpackedSampler5D(Gr,Nr,Lr);case 6:return this.getUnpackedSampler6D(Gr,Nr,Lr);default:throw new Error(`Unsupported dimension ${Ur.length}-D`)}}getPackedSamplerScalar(Gr,Nr){const Lr=`
          vec4 ${Gr}() {
            return ${(0,Dr.getGlsl)(this.context.glContext.version).texture2D}(${Nr}, halfCR);
          }
        `;return new Pr.GlslLibRoutine(Lr)}getPackedSampler1D(Gr,Nr,Lr){const Ur=[Lr.width,Lr.height],Vr=[Ur[1],Ur[0]],Wr=(0,Dr.getGlsl)(this.context.glContext.version),qr=`vec4 ${Gr}(int index) {
      vec2 uv = packedUVfrom1D(
      ${Vr[0]}, ${Vr[1]}, index);
      return ${Wr.texture2D}(${Nr}, uv);
    }`;return new Pr.GlslLibRoutine(qr,["coordinates.packedUVfrom1D"])}getPackedSampler2D(Gr,Nr,Lr){const Ur=Lr.unpackedShape,Vr=[Lr.width,Lr.height],Wr=(0,Dr.getGlsl)(this.context.glContext.version),qr=Vr[0],Kr=Vr[1];if(Vr!=null&&Rr.ArrayUtil.arraysEqual(Ur,Vr)){const Jr=`vec4 ${Gr}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${Kr}.0, ${qr}.0);
        return ${Wr.texture2D}(${Nr}, uv);
      }`;return new Pr.GlslLibRoutine(Jr)}const Xr=Vr,Zr=Math.ceil(Ur[1]/2),_i=`vec4 ${Gr}(int row, int col) {
      vec2 uv = packedUVfrom2D(${Xr[1]}, ${Xr[0]}, ${Zr}, row, col);
      return ${Wr.texture2D}(${Nr}, uv);
    }`;return new Pr.GlslLibRoutine(_i,["coordinates.packedUVfrom2D"])}getPackedSampler3D(Gr,Nr,Lr){const Ur=Lr.unpackedShape,Vr=[Lr.width,Lr.height],Wr=[Vr[0],Vr[1]],qr=(0,Dr.getGlsl)(this.context.glContext.version);if(Ur[0]===1){const Jr=Ur.slice(1),es=[1,2],ts=(0,Fr.squeezeInputShape)(Ur,Jr),is=["b","row","col"],rs=JSON.parse(JSON.stringify(Lr));rs.unpackedShape=ts;const as=this.getPackedSamplerFromInput(Gr,Nr,rs),ls=`${as.routineBody}
      vec4 ${Gr}(int b, int row, int col) {
        return ${Gr}(${(0,Fr.getSqueezedParams)(is,es)});
      } `;return new Pr.GlslLibRoutine(ls,as.dependencies)}const Kr=Wr[0],Xr=Wr[1],Zr=Math.ceil(Ur[2]/2),_i=`vec4 ${Gr}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${Xr}, ${Kr}, ${Zr*Math.ceil(Ur[1]/2)}, ${Zr}, b, row, col);
      return ${qr.texture2D}(${Nr}, uv);}`;return new Pr.GlslLibRoutine(_i,["coordinates.packedUVfrom3D"])}getPackedSamplerND(Gr,Nr,Lr){const Ur=Lr.unpackedShape,Vr=Ur.length,Wr=[Lr.width,Lr.height],qr=(0,Dr.getGlsl)(this.context.glContext.version),Kr=[Wr[0],Wr[1]],Xr=Kr[1],Zr=Kr[0],_i=Math.ceil(Ur[Vr-1]/2);let Jr=_i*Math.ceil(Ur[Vr-2]/2),es="int b, int row, int col",ts=`b * ${Jr} + (row / 2) * ${_i} + (col / 2)`;for(let rs=2;rs<Vr-1;rs++)es=`int b${rs}, `+es,Jr*=Ur[Vr-rs-1],ts=`b${rs} * ${Jr} + `+ts;const is=`vec4 ${Gr}(${es}) {
      int index = ${ts};
      int texR = index / ${Zr};
      int texC = index - texR * ${Zr};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${Zr}, ${Xr});
      return ${qr.texture2D}(${Nr}, uv);
    }`;return new Pr.GlslLibRoutine(is)}getUnpackedSamplerScalar(Gr,Nr,Lr){const[Ur,Vr]=[Lr.width,Lr.height];if(Ur===1&&Vr===1){const qr=`
          float ${Gr}() {
            return sampleTexture(${Nr}, halfCR);
          }
        `;return new Pr.GlslLibRoutine(qr,["coordinates.sampleTexture"])}const Wr=`
        float ${Gr}() {
          int offset_${Nr} = coordsToOffset(TexCoords, ${Ur}, ${Vr});
          vec2 uv = uvFromFlat(${Ur}, ${Vr}, offset_${Nr});
          return sampleTexture(${Nr}, uv);
        }
      `;return new Pr.GlslLibRoutine(Wr,["coordinates.uvFromFlat","coordinates.sampleTexture","coordinates.coordsToOffset"])}getUnpackedSampler1D(Gr,Nr,Lr){const Ur=Lr.width,Vr=Lr.height;if(Vr===1&&Ur===1){const qr=`
        float ${Gr}(int index) {
          return sampleTexture(${Nr}, halfCR);
        }
      `;return new Pr.GlslLibRoutine(qr,["coordinates.sampleTexture"])}if(Vr===1){const qr=`
          float ${Gr}(int index) {
            vec2 uv = vec2((float(index) + 0.5) / ${Ur}.0, 0.5);
            return sampleTexture(${Nr}, uv);
          }
        `;return new Pr.GlslLibRoutine(qr,["coordinates.sampleTexture"])}if(Ur===1){const qr=`
          float ${Gr}(int index) {
            vec2 uv = vec2(0.5, (float(index) + 0.5) / ${Vr}.0);
            return sampleTexture(${Nr}, uv);
          }
        `;return new Pr.GlslLibRoutine(qr,["coordinates.sampleTexture"])}const Wr=`
        float ${Gr}(int index) {
          vec2 uv = uvFromFlat(${Ur}, ${Vr}, index);
          return sampleTexture(${Nr}, uv);
        }
      `;return new Pr.GlslLibRoutine(Wr,["coordinates.uvFromFlat","coordinates.sampleTexture"])}getUnpackedSampler2D(Gr,Nr,Lr){const Ur=Lr.unpackedShape,Vr=[Lr.height,Lr.width];if(Vr!=null&&Rr.ArrayUtil.arraysEqual(Ur,Vr)){const Jr=`
          float ${Gr}(int row, int col) {
            vec2 uv = (vec2(row, col) + halfCR) / vec2(${Vr[1]}.0, ${Vr[0]}.0);
            return sampleTexture(${Nr}, uv);
          }
        `;return new Pr.GlslLibRoutine(Jr,["coordinates.sampleTexture"])}const{newShape:Wr,keptDims:qr}=(0,Mr.squeezeShape)(Ur),Kr=Wr;if(Kr.length<Ur.length){const Jr=(0,Fr.squeezeInputShape)(Ur,Kr),es=JSON.parse(JSON.stringify(Lr));es.unpackedShape=Jr;const ts=["col","row"],is=`
          ${this.getUnpackedSamplerFromInput(Gr,Nr,es).routineBody}
          float ${Gr}(int row, int col) {
            return ${Gr}(${(0,Fr.getSqueezedParams)(ts,qr)});
          }
        `;return new Pr.GlslLibRoutine(is,["coordinates.sampleTexture"])}const Xr=Vr[1],Zr=Vr[0];if(Zr===1){const Jr=`
          float ${Gr}(int row, int col) {
            int offset_${Nr} = coordsToOffset(TexCoords, ${Xr}, ${Zr});
            float index = dot(vec3(row, col, offset_${Nr}), vec3(${Ur[1]}, 1, 1));
            vec2 uv = vec2(0.5, (index + 0.5) / ${Xr}.0);
            return sampleTexture(${Nr}, uv);
          }
        `;return new Pr.GlslLibRoutine(Jr,["coordinates.sampleTexture","coordinates.coordsToOffset"])}if(Xr===1){const Jr=`
          float ${Gr}(int row, int col) {
            int offset_${Nr} = coordsToOffset(TexCoords, ${Xr}, ${Zr});
            float index = dot(vec3(row, col, offset_${Nr}), vec3(${Ur[1]}, 1, 1));
            vec2 uv = vec2((index + 0.5) / ${Zr}.0, 0.5);
            return sampleTexture(${Nr}, uv);
          }
        `;return new Pr.GlslLibRoutine(Jr,["coordinates.sampleTexture","coordinates.coordsToOffset"])}const _i=`
        float ${Gr}(int row, int col) {
          int index = col * ${Ur[1]} + row;
          vec2 uv = uvFromFlat(${Xr}, ${Zr}, index);
          return sampleTexture(${Nr}, uv);
        }
      `;return new Pr.GlslLibRoutine(_i,["coordinates.uvFromFlat","coordinates.sampleTexture","coordinates.coordsToOffset"])}getUnpackedSampler3D(Gr,Nr,Lr){const Ur=Lr.unpackedShape,Vr=Ur[1]*Ur[2],Wr=Ur[2],{newShape:qr,keptDims:Kr}=(0,Mr.squeezeShape)(Ur),Xr=qr;if(Xr.length<Ur.length){const _i=(0,Fr.squeezeInputShape)(Ur,Xr),Jr=["batch","col","row"],es=JSON.parse(JSON.stringify(Lr));es.unpackedShape=_i;const ts=this.getUnpackedSamplerFromInput(Gr,Nr,es),is=Kr.reverse(),rs=`
          ${ts.routineBody}
          float ${Gr}(int batch, int row, int col) {
            return ${Gr}(${(0,Fr.getSqueezedParams)(Jr,is)});
          }
        `;return new Pr.GlslLibRoutine(rs,ts.dependencies)}const Zr=`
          float ${Gr}(int depth, int row, int col) {
            // Explicitly use integer operations as dot() only works on floats.
            int index = depth * ${Vr} + col * ${Wr} + row;
            vec2 uv = uvFromFlat(${Lr.width}, ${Lr.height}, index);
            return sampleTexture(${Nr}, uv);
          }
      `;return new Pr.GlslLibRoutine(Zr,["coordinates.uvFromFlat","coordinates.sampleTexture","coordinates.coordsToOffset"])}getUnpackedSampler4D(Gr,Nr,Lr){const Ur=Lr.unpackedShape,Vr=Ur[3],Wr=Ur[2]*Vr,qr=`
        float ${Gr}(int row, int col, int depth, int depth2) {
          int index = row * ${Ur[1]*Wr} + col * ${Wr} +
              depth2 * ${Vr} + depth;
          vec2 uv = uvFromFlat(${Lr.width}, ${Lr.height}, index);
          return sampleTexture(${Nr}, uv);
        }
      `;return new Pr.GlslLibRoutine(qr,["coordinates.uvFromFlat","coordinates.sampleTexture"])}getUnpackedSampler5D(Gr,Nr,Lr){const Ur=Lr.unpackedShape,Vr=Ur[4],Wr=Ur[3]*Vr,qr=Ur[2]*Wr,Kr=Ur[1]*qr,{newShape:Xr,keptDims:Zr}=(0,Mr.squeezeShape)(Ur);if(Xr.length<Ur.length){const Jr=(0,Fr.squeezeInputShape)(Ur,Xr),es=["row","col","depth","depth2","depth3"],ts=JSON.parse(JSON.stringify(Lr));ts.unpackedShape=Jr;const is=`
          ${this.getUnpackedSamplerFromInput(Gr,Nr,ts).routineBody}
          float ${Gr}(int row, int col, int depth, int depth2, int depth3) {
            return ${Gr}(${(0,Fr.getSqueezedParams)(es,Zr)});
          }
        `;return new Pr.GlslLibRoutine(is,["coordinates.sampleTexture","coordinates.uvFromFlat"])}const _i=`
        float ${Gr}(int row, int col, int depth, int depth2, int depth3) {
          int index = row * ${Kr} + col * ${qr} + depth * ${Wr} +
          depth3 * ${Vr} + depth2;
          vec2 uv = uvFromFlat(${Lr.width}, ${Lr.height}, index);
          return sampleTexture(${Nr}, uv);
        }
      `;return new Pr.GlslLibRoutine(_i,["coordinates.sampleTexture","coordinates.uvFromFlat"])}getUnpackedSampler6D(Gr,Nr,Lr){const Ur=Lr.unpackedShape,Vr=Ur[5],Wr=Ur[4]*Vr,qr=Ur[3]*Wr,Kr=Ur[2]*qr,Xr=Ur[1]*Kr,{newShape:Zr,keptDims:_i}=(0,Mr.squeezeShape)(Ur);if(Zr.length<Ur.length){const es=(0,Fr.squeezeInputShape)(Ur,Zr),ts=["row","col","depth","depth2","depth3","depth4"],is=JSON.parse(JSON.stringify(Lr));is.unpackedShape=es;const rs=`
            ${this.getUnpackedSamplerFromInput(Gr,Nr,is).routineBody}
            float ${Gr}(int row, int col, int depth,
              int depth2, int depth3, int depth4) {
              return ${Gr}(${(0,Fr.getSqueezedParams)(ts,_i)});
            }
          `;return new Pr.GlslLibRoutine(rs,["coordinates.sampleTexture","coordinates.uvFromFlat"])}const Jr=`
          float ${Gr}(int row, int col, int depth,
            int depth2, int depth3, int depth4) {
            int index = row * ${Xr} + col * ${Kr} + depth * ${qr} +
            depth2 * ${Wr} + depth3 * ${Vr} + depth4;
            vec2 uv = uvFromFlat(${Lr.width}, ${Lr.height}, index);
            return sampleTexture(${Nr}, uv);
          }
        `;return new Pr.GlslLibRoutine(Jr,["coordinates.uvFromFlat","coordinates.sampleTexture","coordinates.coordsToOffset"])}toVec(){const Gr=this.context.outputTextureLayout,Nr=Gr.shape.length,Lr=Gr.strides,Ur=Gr.width,Vr=Gr.height,Wr=[];for(let Kr=0;Kr<Nr-1;++Kr)Wr.push(`
        c[${Kr}] = offset / ${Lr[Kr]};`),Wr.push(`
        offset -= c[${Kr}] * ${Lr[Kr]};`);Wr.push(`
        c[${Nr-1}] = offset;`);const qr=`
      void toVec(vec2 texCoords, out int c[${Nr}]) {
        int offset = coordsToOffset(texCoords, ${Ur}, ${Vr});
        ${Wr.join("")}
      }
      void toVec(int offset, out int c[${Nr}]) {
        ${Wr.join("")}
      }
    `;return{toVec:new Pr.GlslLibRoutine(qr,["coordinates.coordsToOffset"])}}valueFrom(){const Gr={};return this.context.programInfo.inputNames.forEach((Nr,Lr)=>{const Ur=this.context.inputTextureLayouts[Lr],Vr=(Ur.unpackedShape.length>0?Ur.unpackedShape:Ur.shape).length;let Wr=`_${Nr}`;Gr[Wr]=new Pr.GlslLibRoutine(this.getValueFromSingle(Nr,Vr,Ur.width,Ur.height,!1),[`shapeUtils.indicesToOffset${Wr}`,"coordinates.offsetToCoords","fragcolor.getColorAsFloat"]),Wr+="_T",Gr[Wr]=new Pr.GlslLibRoutine(this.getValueFromSingle(Nr,Vr,Ur.width,Ur.height,!0),[`shapeUtils.indicesToOffset${Wr}`,"coordinates.offsetToCoords","fragcolor.getColorAsFloat"])}),Gr}getValueFromSingle(Gr,Nr,Lr,Ur,Vr){let Wr=`_${Gr}`;return Vr&&(Wr+="_T"),`
        float ${Wr}(int m[${Nr}]) {
          int offset = indicesToOffset${Wr}(m);
          vec2 coords = offsetToCoords(offset, ${Lr}, ${Ur});
          float value = getColorAsFloat(${(0,Dr.getGlsl)(this.context.glContext.version).texture2D}(${Gr}, coords));
          return value;
        }
        `}getPackedValueFrom(Gr,Nr,Lr,Ur,Vr){let Wr=`_${Gr}_Pack`;return Vr&&(Wr+="_T"),`
        vec4 ${Wr}(int m[${Nr}]) {
          int offset = indicesToOffset_${Gr}(m);
          vec2 coords = offsetToCoords(offset, ${Lr}, ${Ur});
          return ${(0,Dr.getGlsl)(this.context.glContext.version).texture2D}(${Gr}, coords);
        }
        `}}Tr.CoordsGlslLib=zr},1997:(_r,Tr)=>{var Ar;Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.TopologicalSortGlslRoutines=Tr.GlslLibRoutineNode=Tr.GlslLibRoutine=Tr.GlslLib=Tr.GlslContext=Tr.FunctionType=void 0,(Ar=Tr.FunctionType||(Tr.FunctionType={}))[Ar.ValueBased=0]="ValueBased",Ar[Ar.Positional=1]="Positional",Tr.GlslContext=class{constructor(Rr,Pr,Dr,Mr){this.glContext=Rr,this.programInfo=Pr,this.inputTextureLayouts=Dr,this.outputTextureLayout=Mr}},Tr.GlslLib=class{constructor(Rr){this.context=Rr}},Tr.GlslLibRoutine=class{constructor(Rr,Pr){this.routineBody=Rr,this.dependencies=Pr}},Tr.GlslLibRoutineNode=class{constructor(Rr,Pr,Dr){this.name=Rr,this.dependencies=Dr||[],Pr&&(this.routineBody=Pr)}addDependency(Rr){Rr&&this.dependencies.push(Rr)}},Tr.TopologicalSortGlslRoutines=class{static returnOrderedNodes(Rr){if(!Rr||Rr.length===0)return[];if(Rr.length===1)return Rr;const Pr=new Set,Dr=new Set,Mr=new Array;return this.createOrderedNodes(Rr,Pr,Dr,Mr),Mr}static createOrderedNodes(Rr,Pr,Dr,Mr){for(let Fr=0;Fr<Rr.length;++Fr)this.dfsTraverse(Rr[Fr],Pr,Dr,Mr)}static dfsTraverse(Rr,Pr,Dr,Mr){if(!Rr||Dr.has(Rr.name))return;if(Pr.has(Rr.name))throw new Error("Cyclic dependency detected. Can't topologically sort routines needed for shader.");Pr.add(Rr.name);const Fr=Rr.dependencies;if(Fr&&Fr.length>0)for(let zr=0;zr<Fr.length;++zr)this.dfsTraverse(Fr[zr],Pr,Dr,Mr);Mr.push(Rr),Dr.add(Rr.name),Pr.delete(Rr.name)}}},1371:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.EncodingGlslLib=void 0;const Rr=Ar(1997);class Pr extends Rr.GlslLib{constructor(Mr){super(Mr)}getFunctions(){return Object.assign(Object.assign({},this.encodeFloat32()),this.decodeFloat32())}getCustomTypes(){return{}}encodeFloat32(){return{encode:new Rr.GlslLibRoutine(`highp vec4 encode(highp float f) {
        return vec4(f, 0.0, 0.0, 0.0);
      }
        `)}}decodeFloat32(){return{decode:new Rr.GlslLibRoutine(`highp float decode(highp vec4 rgba) {
        return rgba.r;
      }
        `)}}encodeUint8(){const Mr=Pr.isLittleEndian()?"rgba.rgba=rgba.abgr;":"";return{encode:new Rr.GlslLibRoutine(`
      highp vec4 encode(highp float f) {
        highp float F = abs(f);
        highp float Sign = step(0.0,-f);
        highp float Exponent = floor(log2(F));
        highp float Mantissa = (exp2(- Exponent) * F);
        Exponent = floor(log2(F) + 127.0) + floor(log2(Mantissa));
        highp vec4 rgba;
        rgba[0] = 128.0 * Sign  + floor(Exponent*exp2(-1.0));
        rgba[1] = 128.0 * mod(Exponent,2.0) + mod(floor(Mantissa*128.0),128.0);
        rgba[2] = floor(mod(floor(Mantissa*exp2(23.0 -8.0)),exp2(8.0)));
        rgba[3] = floor(exp2(23.0)*mod(Mantissa,exp2(-15.0)));
        ${Mr}
        rgba = rgba / 255.0; // values need to be normalized to [0,1]
        return rgba;
    }
        `)}}decodeUint8(){const Mr=Pr.isLittleEndian()?"rgba.rgba=rgba.abgr;":"";return{decode:new Rr.GlslLibRoutine(`
        highp float decode(highp vec4 rgba) {
          rgba = rgba * 255.0; // values need to be de-normalized from [0,1] to [0,255]
          ${Mr}
          highp float Sign = 1.0 - step(128.0,rgba[0])*2.0;
          highp float Exponent = 2.0 * mod(rgba[0],128.0) + step(128.0,rgba[1]) - 127.0;
          highp float Mantissa = mod(rgba[1],128.0)*65536.0 + rgba[2]*256.0 +rgba[3] + float(0x800000);
          highp float Result =  Sign * exp2(Exponent) * (Mantissa * exp2(-23.0 ));
          return Result;
      }
        `)}}static isLittleEndian(){const Mr=new ArrayBuffer(4),Fr=new Uint32Array(Mr),zr=new Uint8Array(Mr);if(Fr[0]=3735928559,zr[0]===239)return!0;if(zr[0]===222)return!1;throw new Error("unknown endianness")}}Tr.EncodingGlslLib=Pr},2691:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.FragColorGlslLib=void 0;const Rr=Ar(1997),Pr=Ar(6757);class Dr extends Rr.GlslLib{constructor(Fr){super(Fr)}getFunctions(){return Object.assign(Object.assign({},this.setFragColor()),this.getColorAsFloat())}getCustomTypes(){return{}}setFragColor(){const Fr=(0,Pr.getGlsl)(this.context.glContext.version);return{setFragColor:new Rr.GlslLibRoutine(`
        void setFragColor(float value) {
            ${Fr.output} = encode(value);
        }
        `,["encoding.encode"])}}getColorAsFloat(){return{getColorAsFloat:new Rr.GlslLibRoutine(`
        float getColorAsFloat(vec4 color) {
            return decode(color);
        }
        `,["encoding.decode"])}}}Tr.FragColorGlslLib=Dr},3878:(_r,Tr)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.replaceInlines=void 0;const Ar=/@inline[\s\n\r]+(\w+)[\s\n\r]+([0-9a-zA-Z_]+)\s*\(([^)]*)\)\s*{(([^}]|[\n\r])*)}/gm;Tr.replaceInlines=function(Rr){const Pr={};let Dr;for(;(Dr=Ar.exec(Rr))!==null;){const Mr=Dr[3].split(",").map(Fr=>{const zr=Fr.trim().split(" ");return zr&&zr.length===2?{type:zr[0],name:zr[1]}:null}).filter(Fr=>Fr!==null);Pr[Dr[2]]={params:Mr,body:Dr[4]}}for(const Mr in Pr){const Fr="(\\w+)?\\s+([_0-9a-zA-Z]+)\\s+=\\s+__FUNC__\\((.*)\\)\\s*;".replace("__FUNC__",Mr),zr=new RegExp(Fr,"gm");for(;(Dr=zr.exec(Rr))!==null;){const jr=Dr[1],Gr=Dr[2],Nr=Dr[3].split(","),Lr=jr?`${jr} ${Gr};`:"";let Ur=Pr[Mr].body,Vr="";Pr[Mr].params.forEach((qr,Kr)=>{qr&&(Vr+=`${qr.type} ${qr.name} = ${Nr[Kr]};
`)}),Ur=`${Vr}
 ${Ur}`,Ur=Ur.replace("return",`${Gr} = `);const Wr=`
      ${Lr}
      {
        ${Ur}
      }
      `;Rr=Rr.replace(Dr[0],Wr)}}return Rr.replace(Ar,"")}},8897:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.GlslPreprocessor=void 0;const Rr=Ar(1997),Pr=Ar(3878),Dr=Ar(1248),Mr=Ar(6757);Tr.GlslPreprocessor=class{constructor(Fr,zr,jr,Gr){this.libs={},this.glslLibRoutineDependencyGraph={},this.context=new Rr.GlslContext(Fr,zr,jr,Gr),Object.keys(Dr.glslRegistry).forEach(Lr=>{const Ur=new Dr.glslRegistry[Lr](this.context);this.libs[Lr]=Ur});const Nr=this.glslLibRoutineDependencyGraph;for(const Lr in this.libs){const Ur=this.libs[Lr].getFunctions();for(const Vr in Ur){const Wr=Lr+"."+Vr;let qr;Nr[Wr]?(qr=Nr[Wr],qr.routineBody=Ur[Vr].routineBody):(qr=new Rr.GlslLibRoutineNode(Wr,Ur[Vr].routineBody),Nr[Wr]=qr);const Kr=Ur[Vr].dependencies;if(Kr)for(let Xr=0;Xr<Kr.length;++Xr)if(Nr[Kr[Xr]])qr.addDependency(Nr[Kr[Xr]]);else{const Zr=new Rr.GlslLibRoutineNode(Kr[Xr]);Nr[Kr[Xr]]=Zr,qr.addDependency(Zr)}}}}preprocess(){const Fr=this.context.programInfo;let zr=Fr.shaderSource;return this.context.programInfo.hasMain||(zr=`${zr}
      ${(0,Mr.getDefaultFragShaderMain)(this.context.glContext.version,this.context.outputTextureLayout.shape.length)}`),zr=(0,Pr.replaceInlines)(zr),`${(0,Mr.getFragShaderPreamble)(this.context.glContext.version)}
    ${this.getUniforms(Fr.inputNames,Fr.variables)}
    ${this.getImports(zr)}
    ${zr}`}getImports(Fr){const zr=this.selectGlslLibRoutinesToBeIncluded(Fr);if(zr.length===0)return"";let jr="";for(let Gr=0;Gr<zr.length;++Gr){if(!zr[Gr].routineBody)throw new Error(`Missing body for the Glsl Library routine: ${zr[Gr].name}`);jr+=zr[Gr].routineBody+`
`}return jr}selectGlslLibRoutinesToBeIncluded(Fr){const zr=[];return Object.keys(this.glslLibRoutineDependencyGraph).forEach(jr=>{const Gr=jr.split(".")[1];Fr.indexOf(Gr)!==-1&&zr.push(this.glslLibRoutineDependencyGraph[jr])}),Rr.TopologicalSortGlslRoutines.returnOrderedNodes(zr)}getUniforms(Fr,zr){const jr=[];if(Fr)for(const Gr of Fr)jr.push(`uniform sampler2D ${Gr};`);if(zr)for(const Gr of zr)jr.push(`uniform ${Gr.type} ${Gr.name}${Gr.arrayLength?`[${Gr.arrayLength}]`:""};`);return jr.join(`
`)}}},1248:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.glslRegistry=void 0;const Rr=Ar(6859),Pr=Ar(1371),Dr=Ar(2691),Mr=Ar(9183),Fr=Ar(9314);Tr.glslRegistry={encoding:Pr.EncodingGlslLib,fragcolor:Dr.FragColorGlslLib,vec:Fr.VecGlslLib,shapeUtils:Mr.ShapeUtilsGlslLib,coordinates:Rr.CoordsGlslLib}},9183:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.ShapeUtilsGlslLib=void 0;const Rr=Ar(1997);class Pr extends Rr.GlslLib{constructor(Mr){super(Mr)}getFunctions(){return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},this.bcastIndex()),this.bcastMatmulIndex()),this.offsetToIndices()),this.indicesToOffset()),this.incrementIndices())}getCustomTypes(){return{}}bcastIndex(){const Mr=this.context.outputTextureLayout.shape.length,Fr={};return this.context.programInfo.inputNames.forEach((zr,jr)=>{const Gr=this.context.inputTextureLayouts[jr].unpackedShape;if(Gr.length<=Mr){const Nr=Gr.length,Lr=Mr-Nr,Ur=`bcastIndices_${zr}`;let Vr="";for(let qr=0;qr<Nr;++qr)Vr+=`
          realIndices[${qr}] = int( mod(float(bcastedIndices[${Lr+qr}]), ${Gr[qr]}.0) );
          `;const Wr=`
        void ${Ur} (int bcastedIndices[${Mr}], out int realIndices[${Nr}]) {
          ${Vr}
        }
        `;Fr[Ur]=new Rr.GlslLibRoutine(Wr)}}),Fr}bcastMatmulIndex(){const Mr=this.context.outputTextureLayout.shape.length,Fr={};return this.context.programInfo.inputNames.forEach((zr,jr)=>{const Gr=this.context.inputTextureLayouts[jr].shape;if(!(Gr.length<2||Gr.length>Mr)){const Nr=Gr.length,Lr=Mr-Nr,Ur=`bcastMatmulIndices_${zr}`;let Vr="";for(let qr=0;qr<Nr-2;++qr)Vr+=`
          realIndices[${qr}] = int( mod(float(bcastedIndices[${Lr+qr}]), ${Gr[qr]}.0) );
          `;const Wr=`
        void ${Ur}(int bcastedIndices[${Mr}], out int realIndices[${Nr}]) {
          ${Vr}
          realIndices[${Nr-1}] = bcastedIndices[${Mr-1}];
          realIndices[${Nr-2}] = bcastedIndices[${Mr-2}];
        }
        `;Fr[Ur]=new Rr.GlslLibRoutine(Wr)}}),Fr}indicesToOffset(){const Mr={};return this.context.programInfo.inputNames.forEach((Fr,zr)=>{const jr=this.context.inputTextureLayouts[zr].shape,Gr=this.context.inputTextureLayouts[zr].strides,Nr=jr.length;let Lr=`indicesToOffset_${Fr}`;Mr[Lr]=new Rr.GlslLibRoutine(Pr.indexToOffsetSingle(Lr,Nr,Gr)),Lr=`indicesToOffset_${Fr}_T`,Mr[Lr]=new Rr.GlslLibRoutine(Pr.indexToOffsetSingle(Lr,Nr,Gr.slice().reverse()))}),Mr}static indexToOffsetSingle(Mr,Fr,zr){let jr="";for(let Gr=Fr-1;Gr>=0;--Gr)jr+=`
        offset += indices[${Gr}] * ${zr[Gr]};
        `;return`
      int ${Mr}(int indices[${Fr}]) {
        int offset = 0;
        ${jr}
        return offset;
      }
      `}offsetToIndices(){const Mr={};return this.context.programInfo.inputNames.forEach((Fr,zr)=>{const jr=this.context.inputTextureLayouts[zr].shape,Gr=this.context.inputTextureLayouts[zr].strides,Nr=jr.length;let Lr=`offsetToIndices_${Fr}`;Mr[Lr]=new Rr.GlslLibRoutine(Pr.offsetToIndicesSingle(Lr,Nr,Gr)),Lr=`offsetToIndices_${Fr}_T`,Mr[Lr]=new Rr.GlslLibRoutine(Pr.offsetToIndicesSingle(Lr,Nr,Gr.slice().reverse()))}),Mr}static offsetToIndicesSingle(Mr,Fr,zr){const jr=[];for(let Gr=0;Gr<Fr-1;++Gr)jr.push(`
      indices[${Gr}] = offset / ${zr[Gr]};`),jr.push(`
        offset -= indices[${Gr}] * ${zr[Gr]};`);return jr.push(`
      indices[${Fr-1}] = offset;`),`
      void ${Mr}(int offset, out int indices[${Fr}]) {
        ${jr.join("")}
      }
      `}incrementIndices(){const Mr={};return this.context.programInfo.inputNames.forEach((Fr,zr)=>{const jr=this.context.inputTextureLayouts[zr].shape,Gr=jr.length,Nr=`incrementIndices_${Fr}`;let Lr="";for(let Vr=0;Vr<Gr;++Vr)Lr+=`
        shape[${Vr}] = ${jr[Vr]};`;const Ur=`
        void ${Nr}(int axis, out int indices[${Gr}]) {
          int shape[${Gr}];
          ${Lr};
          for(int i = ${Gr} -1 ; i >= 0; --i) {
            if(i > axis) continue;
            indices[i] += 1;
            if(indices[i] < shape[i]) {
              break;
            }
            indices[i] = 0;
          }
        }
        `;Mr[Nr]=new Rr.GlslLibRoutine(Ur)}),Mr}}Tr.ShapeUtilsGlslLib=Pr},6757:(_r,Tr)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.getDefaultFragShaderMain=Tr.getFragShaderPreamble=Tr.getVertexShaderSource=Tr.getGlsl=void 0;const Ar={version:"",attribute:"attribute",varyingVertex:"varying",varyingFrag:"varying",texture2D:"texture2D",output:"gl_FragColor",outputDeclaration:""},Rr={version:"#version 300 es",attribute:"in",varyingVertex:"out",varyingFrag:"in",texture2D:"texture",output:"outputColor",outputDeclaration:"out vec4 outputColor;"};function Pr(Dr){return Dr===1?Ar:Rr}Tr.getGlsl=Pr,Tr.getVertexShaderSource=function(Dr){const Mr=Pr(Dr);return`${Mr.version}
      precision highp float;
      ${Mr.attribute} vec3 position;
      ${Mr.attribute} vec2 textureCoord;

      ${Mr.varyingVertex} vec2 TexCoords;

      void main()
      {
          gl_Position = vec4(position, 1.0);
          TexCoords = textureCoord;
      }`},Tr.getFragShaderPreamble=function(Dr){const Mr=Pr(Dr);return`${Mr.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${Mr.varyingFrag} vec2 TexCoords;
    ${Mr.outputDeclaration}
    const vec2 halfCR = vec2(0.5, 0.5);

    // Custom vector types to handle higher dimenalities.
    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    `},Tr.getDefaultFragShaderMain=function(Dr,Mr){return`
  void main() {
    int indices[${Mr}];
    toVec(TexCoords, indices);
    vec4 result = vec4(process(indices));
    ${Pr(Dr).output} = result;
  }
  `}},9314:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.VecGlslLib=void 0;const Rr=Ar(1997);class Pr extends Rr.GlslLib{constructor(Mr){super(Mr)}getCustomTypes(){return{}}getFunctions(){return Object.assign(Object.assign(Object.assign(Object.assign({},this.binaryVecFunctions()),this.copyVec()),this.setVecItem()),this.getVecItem())}binaryVecFunctions(){const Mr=this.context.outputTextureLayout.shape.length,Fr={add:"+=",sub:"-=",mul:"*=",div:"/="},zr={};for(const jr in Fr){const Gr=`${jr}Vec`;let Nr="";for(let Ur=0;Ur<Mr;++Ur)Nr+=`
          dest[${Ur}] ${Fr[jr]} src[${Ur}];
          `;const Lr=`
        void ${Gr}(int src[${Mr}], out int dest[${Mr}]) {
          ${Nr}
        }
        `;zr[Gr]=new Rr.GlslLibRoutine(Lr)}return zr}copyVec(){const Mr=this.context.outputTextureLayout.shape.length;let Fr="";for(let jr=0;jr<Mr;++jr)Fr+=`
        dest[${jr}] = src[${jr}];
        `;const zr=`
      void copyVec(int src[${Mr}], out int dest[${Mr}]) {
        ${Fr}
      }
      `;return{copyVec:new Rr.GlslLibRoutine(zr)}}setVecItem(){const Mr=this.context.outputTextureLayout.shape.length;let Fr=`
        if(index < 0)
            index =${Mr} + index;
        if (index == 0)
            m[0] = value;
        `;for(let jr=1;jr<Mr-1;++jr)Fr+=`
        else if (index == ${jr})
            m[${jr}] = value;
            `;Fr+=`
        else
            m[${Mr-1}] = value;
        `;const zr=`
      void setVecItem(out int m[${Mr}], int index, int value) {
        ${Fr}
      }
        `;return{setVecItem:new Rr.GlslLibRoutine(zr)}}getVecItem(){const Mr=this.context.outputTextureLayout.shape.length;let Fr=`
        if(index < 0)
            index = ${Mr} + index;
        if (index == 0)
            return m[0];
      `;for(let jr=1;jr<Mr-1;++jr)Fr+=`
        else if (index == ${jr})
            return m[${jr}];
      `;Fr+=`
        else
            return m[${Mr-1}];
        `;const zr=`
      int getVecItem(int m[${Mr}], int index) {
        ${Fr}
      }
    `;return{getVecItem:new Rr.GlslLibRoutine(zr)}}}Tr.VecGlslLib=Pr},7860:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.WebGLInferenceHandler=void 0;const Rr=Ar(1315),Pr=Ar(9240),Dr=Ar(7273),Mr=Ar(9),Fr=Ar(7379),zr=Ar(2488),jr=Ar(540),Gr=Ar(3314),Nr=Ar(5639);Tr.WebGLInferenceHandler=class{constructor(Lr){this.session=Lr,this.packedTextureDataCache=new Map,this.unpackedTextureDataCache=new Map}calculateTextureWidthAndHeight(Lr,Ur){return(0,Gr.calculateTextureWidthAndHeight)(this.session.layoutStrategy,Lr,Ur)}executeProgram(Lr,Ur){if(Ur.length<Lr.inputNames.length)throw new Error(`Input size mustn't be less than ${Lr.inputNames.length}.`);if(Lr.inputNames.length!==Lr.inputTypes.length)throw new Error("input names size does not match input types");const Vr=[];for(let _i=0;_i<Lr.inputNames.length;++_i)Vr[_i]=this.getOrCreateTextureData(Ur[_i],Lr.inputTypes[_i]);const Wr=((_i,Jr)=>{const es=Jr.map(is=>`${is.unpackedShape.join(",")};${is.width}x${is.height}`).join("_");let ts=_i.name;return _i.cacheHint&&(ts+="["+_i.cacheHint+"]"),ts+=":"+es,ts})(Lr,Vr);let qr=this.session.programManager.getArtifact(Wr);const Kr=qr?qr.programInfo:typeof Lr.get=="function"?Lr.get():Lr,Xr=(0,Gr.createTextureLayoutFromTextureType)(this.session.layoutStrategy,Kr.output.dims,Kr.output.textureType),Zr=this.createTextureData(Xr,Kr.output.type);return qr||(qr=this.session.programManager.build(Kr,Vr,Zr),this.session.programManager.setArtifact(Wr,qr)),this.runProgram(qr,Vr,Zr),Zr}run(Lr,Ur){return this.executeProgram(Lr,Ur).tensor}runProgram(Lr,Ur,Vr){for(let Wr=0;Wr<Ur.length;++Wr)if(!!Ur[Wr].isPacked!=(Lr.programInfo.inputTypes[Wr]===Nr.TextureType.packed))throw new Error(`input[${Wr}] property packed inconsistent`);if(!!Vr.isPacked!=(Lr.programInfo.output.textureType===Nr.TextureType.packed))throw new Error("output property packed inconsistent");this.session.programManager.run(Lr,Ur,Vr)}getOrCreateTextureData(Lr,Ur){let Vr=this.getTextureData(Lr.dataId,Ur===Nr.TextureType.packed);if(!Vr&&(Vr=this.getTextureData(Lr.dataId,Ur!==Nr.TextureType.packed),Vr))return Ur===Nr.TextureType.packed?this.pack(Vr):this.unpack(Vr);if(!Vr){const Wr=(0,Gr.createTextureLayoutFromTextureType)(this.session.layoutStrategy,Lr.dims,Ur);if(Ur===Nr.TextureType.packedLastDimension){const Xr=Lr.dims;if(Xr.length===4){const Zr=[Xr[0],Math.ceil(Xr[1]*Xr[2]*Xr[3]/4)],_i=(0,Gr.createTextureLayoutFromTextureType)(this.session.layoutStrategy,Zr,Ur);let Jr=Lr.numberData;if(Xr[1]*Xr[2]*Xr[3]%4!=0){const es=Xr[0],ts=Xr[1]*Xr[2]*Xr[3],is=Math.ceil(ts*1/4)*4;Jr=new Float32Array(es*is);for(let rs=0;rs<es;++rs){const as=rs*ts,ls=rs*is+rs%1*ts;Jr.set(Lr.numberData.subarray(as,as+ts),ls)}}return this.createTextureData(_i,Lr.type,Jr,Lr,1)}}if(Ur===Nr.TextureType.packed){const qr=(0,Gr.createTextureLayoutFromShape)(this.session.layoutStrategy,Lr.dims,1,[],{reverseWH:!0}),Kr=this.createTextureData(qr,Lr.type,Lr.numberData,Lr,1);Vr=this.pack(Kr)}else Vr=this.createTextureData(Wr,Lr.type,Lr.numberData,Lr,1)}return Vr}createTextureDataFromLayoutBindTensor(Lr,Ur,Vr,Wr){return this.createTextureData(Lr,Ur,Vr,Wr,1)}createTextureData(Lr,Ur,Vr,Wr,qr){Rr.Logger.verbose("InferenceHandler",`Creating TextureData: layout:[${JSON.stringify(Lr)}]`);const Kr=this.session.textureManager.createTextureFromLayout(Ur,Lr,Vr,qr);return this.createTextureDataFromTexture(Lr,Ur,Kr,Wr)}reshapeUnpacked(Lr,Ur){const Vr=this.getOrCreateTextureData(Lr,Nr.TextureType.unpacked),Wr={channels:Vr.channels,height:Vr.height,width:Vr.width,shape:Ur.length!==0?Ur:[1],strides:Dr.ShapeUtil.computeStrides(Ur),unpackedShape:Ur};return this.createTextureDataFromTexture(Wr,Lr.type,Vr.texture).tensor}reshapePacked(Lr,Ur){const Vr=this.getOrCreateTextureData(Lr,Nr.TextureType.packed);if((0,Fr.isReshapeCheap)(Lr.dims,Ur)){const Zr={channels:Vr.channels,height:Vr.height,width:Vr.width,shape:Ur.length!==0?Ur:[1],strides:Dr.ShapeUtil.computeStrides(Ur),unpackedShape:Ur,isPacked:!0};return this.createTextureDataFromTexture(Zr,Lr.type,Vr.texture).tensor}const Wr=(0,Fr.processDims3D)(Lr.dims),qr=(0,Fr.processDims3D)(Ur),Kr=this.reshapePacked(Lr,Wr),Xr=this.run((0,Fr.createPackedReshape3DProgramInfoLoader)(this,Kr,qr),[Kr]);return this.reshapePacked(Xr,Ur)}cast(Lr,Ur){const Vr=this.getOrCreateTextureData(Lr,Nr.TextureType.unpacked);return this.createTextureDataFromTexture(Vr,Ur,Vr.texture).tensor}createTextureDataFromTexture(Lr,Ur,Vr,Wr,qr){const Kr=Object.assign(Object.assign({},Lr),{tensor:Wr||new Pr.Tensor(Lr.unpackedShape,Ur,Xr=>this.readTexture(Kr),async Xr=>this.readTextureAsync(Kr),void 0,qr),texture:Vr});return this.setTextureData(Kr.tensor.dataId,Kr,Lr.isPacked),Kr}getTextureData(Lr,Ur=!1){return this.session.isInitializer(Lr)?this.session.getTextureData(Lr,Ur):Ur?this.packedTextureDataCache.get(Lr):this.unpackedTextureDataCache.get(Lr)}setTextureData(Lr,Ur,Vr=!1){this.session.isInitializer(Lr)?this.session.setTextureData(Lr,Ur,Vr):(Vr?this.packedTextureDataCache:this.unpackedTextureDataCache).set(Lr,Ur)}isTextureLayoutCached(Lr,Ur=!1){return!!this.getTextureData(Lr.dataId,Ur)}dispose(){this.session.textureManager.clearActiveTextures(),this.packedTextureDataCache.forEach(Lr=>this.session.textureManager.releaseTexture(Lr)),this.packedTextureDataCache=new Map,this.unpackedTextureDataCache.forEach(Lr=>this.session.textureManager.releaseTexture(Lr)),this.unpackedTextureDataCache=new Map}readTexture(Lr){return Lr.isPacked?this.readTexture(this.unpack(Lr)):this.session.backend.glContext.isFloat32DownloadSupported?this.session.textureManager.readTexture(Lr,Lr.tensor.type,Lr.channels):this.session.textureManager.readUint8TextureAsFloat((0,zr.encodeAsUint8)(this,Lr))}async readTextureAsync(Lr){return Lr.isPacked?this.readTextureAsync(this.unpack(Lr)):this.session.backend.glContext.isFloat32DownloadSupported?this.session.textureManager.readTextureAsync(Lr,Lr.tensor.type,Lr.channels):this.session.textureManager.readUint8TextureAsFloat((0,zr.encodeAsUint8)(this,Lr))}pack(Lr){return this.executeProgram((0,Mr.createPackProgramInfoLoader)(this,Lr.tensor),[Lr.tensor])}unpack(Lr){return this.executeProgram((0,jr.createUnpackProgramInfoLoader)(this,Lr.tensor),[Lr.tensor])}}},4110:function(_r,Tr,Ar){var Rr=this&&this.__createBinding||(Object.create?function(js,zs,qs,fo){fo===void 0&&(fo=qs);var Qs=Object.getOwnPropertyDescriptor(zs,qs);Qs&&!("get"in Qs?!zs.__esModule:Qs.writable||Qs.configurable)||(Qs={enumerable:!0,get:function(){return zs[qs]}}),Object.defineProperty(js,fo,Qs)}:function(js,zs,qs,fo){fo===void 0&&(fo=qs),js[fo]=zs[qs]}),Pr=this&&this.__setModuleDefault||(Object.create?function(js,zs){Object.defineProperty(js,"default",{enumerable:!0,value:zs})}:function(js,zs){js.default=zs}),Dr=this&&this.__importStar||function(js){if(js&&js.__esModule)return js;var zs={};if(js!=null)for(var qs in js)qs!=="default"&&Object.prototype.hasOwnProperty.call(js,qs)&&Rr(zs,js,qs);return Pr(zs,js),zs};Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.WEBGL_OP_RESOLVE_RULES=void 0;const Mr=Ar(8817),Fr=Dr(Ar(5194)),zr=Ar(4752),jr=Ar(6668),Gr=Ar(9754),Nr=Ar(5042),Lr=Ar(6742),Ur=Ar(4125),Vr=Ar(6149),Wr=Ar(5378),qr=Ar(6981),Kr=Ar(7413),Xr=Ar(7006),Zr=Ar(8276),_i=Ar(5565),Jr=Ar(2834),es=Ar(1010),ts=Ar(8126),is=Ar(2801),rs=Ar(565),as=Ar(2444),ls=Ar(815),fs=Ar(564),Ts=Ar(5416),$s=Ar(1240),xs=Ar(5944),ys=Ar(5707),ps=Dr(Ar(9087)),vs=Ar(7862),Ds=Ar(3980);Tr.WEBGL_OP_RESOLVE_RULES=[["Abs","","6+",ps.abs],["Acos","","7+",ps.acos],["Add","","7+",Fr.add],["And","","7+",Fr.and],["Asin","","7+",ps.asin],["Atan","","7+",ps.atan],["AveragePool","","7+",Jr.averagePool,Jr.parseAveragePoolAttributes],["BatchNormalization","","7+",Mr.batchNormalization,Mr.parseBatchNormalizationAttributes],["Cast","","6+",zr.cast,zr.parseCastAttributes],["Ceil","","6+",ps.ceil],["Clip","","6-10",ps.clip,ps.parseClipAttributes],["Clip","","11+",ps.clipV11],["Concat","","4+",jr.concat,jr.parseConcatAttributes],["Conv","","1+",Gr.conv,Gr.parseConvAttributes],["ConvTranspose","","1+",Nr.convTranspose,Nr.parseConvTransposeAttributes],["Cos","","7+",ps.cos],["Div","","7+",Fr.div],["Dropout","","7+",ps.identity],["DepthToSpace","","1+",Lr.depthToSpace,Lr.parseDepthToSpaceAttributes],["Equal","","7+",Fr.equal],["Elu","","6+",ps.elu,ps.parseEluAttributes],["Exp","","6+",ps.exp],["Flatten","","1+",Ur.flatten,Ur.parseFlattenAttributes],["Floor","","6+",ps.floor],["FusedConv","com.microsoft","1+",Gr.conv,Gr.parseConvAttributes],["Gather","","1+",Vr.gather,Vr.parseGatherAttributes],["Gemm","","7-10",Wr.gemm,Wr.parseGemmAttributesV7],["Gemm","","11+",Wr.gemm,Wr.parseGemmAttributesV11],["GlobalAveragePool","","1+",Jr.globalAveragePool,Jr.parseGlobalAveragePoolAttributes],["GlobalMaxPool","","1+",Jr.globalMaxPool],["Greater","","7+",Fr.greater],["Identity","","1+",ps.identity],["ImageScaler","","1+",qr.imageScaler,qr.parseImageScalerAttributes],["InstanceNormalization","","6+",Kr.instanceNormalization,Kr.parseInstanceNormalizationAttributes],["LeakyRelu","","6+",ps.leakyRelu,ps.parseLeakyReluAttributes],["Less","","7+",Fr.less],["LRN","","1+",Xr.lrn,Xr.parseLrnAttributes],["Log","","6+",ps.log],["MatMul","","1+",Zr.matMul,Zr.parseMatMulAttributes],["MaxPool","","1+",Jr.maxPool,Jr.parseMaxPoolAttributes],["Mul","","7+",Fr.mul],["Neg","","6+",ps.neg],["Not","","1+",ps.not],["Or","","7+",Fr.or],["Pad","","2-10",_i.padV2,_i.parsePadAttributesV2],["Pad","","11+",_i.padV11,_i.parsePadAttributesV11],["Pow","","7+",Fr.pow],["PRelu","","7+",Fr.pRelu],["ReduceLogSum","","1+",es.reduceLogSum,es.parseReduceAttributes],["ReduceMax","","1+",es.reduceMax,es.parseReduceAttributes],["ReduceMean","","1+",es.reduceMean,es.parseReduceAttributes],["ReduceMin","","1+",es.reduceMin,es.parseReduceAttributes],["ReduceProd","","1+",es.reduceProd,es.parseReduceAttributes],["ReduceSum","","1-12",es.reduceSum,es.parseReduceAttributes],["ReduceSumSquare","","1+",es.reduceLogSumSquare,es.parseReduceAttributes],["Relu","","6+",ps.relu],["Reshape","","5+",ts.reshape],["Resize","","10",is.resize,is.parseResizeAttributesV10],["Resize","","11+",is.resize,is.parseResizeAttributesV11],["Shape","","1+",rs.shape],["Sigmoid","","6+",ps.sigmoid],["Sin","","7+",ps.sin],["Slice","","10+",as.sliceV10],["Slice","","1-9",as.slice,as.parseSliceAttributes],["Softmax","","1-12",ls.softmax,ls.parseSoftmaxAttributes],["Softmax","","13+",ls.softmaxV13,ls.parseSoftmaxAttributesV13],["Split","","2-12",fs.split,fs.parseSplitAttributes],["Sqrt","","6+",ps.sqrt],["Squeeze","","1-12",Ts.squeeze,Ts.parseSqueezeAttributes],["Squeeze","","13+",Ts.squeezeV13],["Sub","","7+",Fr.sub],["Sum","","6+",$s.sum],["Tan","","7+",ps.tan],["Tanh","","6+",ps.tanh],["Tile","","6+",xs.tile],["Transpose","","1+",ys.transpose,ys.parseTransposeAttributes],["Upsample","","7-8",Ds.upsample,Ds.parseUpsampleAttributesV7],["Upsample","","9",Ds.upsample,Ds.parseUpsampleAttributesV9],["Unsqueeze","","1-12",vs.unsqueeze,vs.parseUnsqueezeAttributes],["Unsqueeze","","13+",vs.unsqueezeV13],["Xor","","7+",Fr.xor]]},8817:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.parseBatchNormalizationAttributes=Tr.batchNormalization=void 0;const Rr=Ar(4910),Pr=Ar(6757),Dr=Ar(5639),Mr={name:"BatchNormalization",inputNames:["A","Scale","B","Mean","Variance"],inputTypes:[Dr.TextureType.unpacked,Dr.TextureType.unpacked,Dr.TextureType.unpacked,Dr.TextureType.unpacked,Dr.TextureType.unpacked]};Tr.batchNormalization=(jr,Gr,Nr)=>(zr(Gr),[jr.run(Object.assign(Object.assign({},Mr),{cacheHint:Nr.cacheKey,get:()=>Fr(jr,Gr,Nr)}),Gr)]),Tr.parseBatchNormalizationAttributes=jr=>{const Gr=jr.attributes.getFloat("epsilon",1e-5),Nr=jr.attributes.getFloat("momentum",.9),Lr=jr.attributes.getInt("spatial",1);return(0,Rr.createAttributeWithCacheKey)({epsilon:Gr,momentum:Nr,spatial:Lr})};const Fr=(jr,Gr,Nr)=>{const Lr=(0,Pr.getGlsl)(jr.session.backend.glContext.version),Ur=Gr[0].dims.length,[Vr,Wr]=jr.calculateTextureWidthAndHeight(Gr[1].dims,Dr.TextureType.unpacked),qr=`
  float process(int[${Ur}] indices) {
    vec2 position = offsetToCoords(indices[1], ${Vr}, ${Wr});
    float scale = getColorAsFloat(${Lr.texture2D}(Scale, position));
    float mean = getColorAsFloat(${Lr.texture2D}(Mean, position));
    float variance = getColorAsFloat(${Lr.texture2D}(Variance, position));
    float b = getColorAsFloat(${Lr.texture2D}(B, position));

    return scale * ( (_A(indices) - mean) / sqrt(variance + float(${Nr.epsilon})) ) + b;
  }`;return Object.assign(Object.assign({},Mr),{output:{dims:Gr[0].dims,type:Gr[0].type,textureType:Dr.TextureType.unpacked},shaderSource:qr})},zr=jr=>{if(!jr||jr.length!==5)throw new Error("BatchNormalization requires 5 inputs.");const Gr=jr[0],Nr=jr[1],Lr=jr[2],Ur=jr[3],Vr=jr[4];if(Gr.dims.length<3||Nr.dims.length!==1||Lr.dims.length!==1||Ur.dims.length!==1||Vr.dims.length!==1)throw new Error("invalid input shape.");if(Nr.dims[0]!==Gr.dims[1]||Lr.dims[0]!==Gr.dims[1]||Ur.dims[0]!==Gr.dims[1]||Vr.dims[0]!==Gr.dims[1])throw new Error("invalid input shape.");if(Gr.type!=="float32"&&Gr.type!=="float64"||Nr.type!=="float32"&&Nr.type!=="float64"||Lr.type!=="float32"&&Lr.type!=="float64"||Ur.type!=="float32"&&Ur.type!=="float64"||Vr.type!=="float32"&&Vr.type!=="float64")throw new Error("invalid input tensor types.")}},5194:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.xor=Tr.sub=Tr.pRelu=Tr.pow=Tr.or=Tr.mul=Tr.less=Tr.greater=Tr.equal=Tr.div=Tr.and=Tr.add=Tr.glslPRelu=Tr.glslPow=Tr.glslXor=Tr.glslOr=Tr.glslAnd=Tr.glslLess=Tr.glslGreater=Tr.glslEqual=Tr.glslSub=Tr.glslMul=Tr.glslDiv=Tr.glslAdd=void 0;const Rr=Ar(7273),Pr=Ar(1997),Dr=Ar(6757),Mr=Ar(5639);function Fr(){const Jr="add_";return{body:`
  float ${Jr}(float a, float b) {
    return a + b;
  }
  vec4 ${Jr}(vec4 v1, vec4 v2) {
    return v1 + v2;
  }
  `,name:Jr,type:Pr.FunctionType.ValueBased}}function zr(){const Jr="div_";return{body:`
  float ${Jr}(float a, float b) {
    return a / b;
  }
  vec4 ${Jr}(vec4 v1, vec4 v2) {
    return v1 / v2;
  }
  `,name:Jr,type:Pr.FunctionType.ValueBased}}function jr(){const Jr="mul_";return{body:`
  float ${Jr}(float a, float b) {
    return a * b;
  }
  vec4 ${Jr}(vec4 v1, vec4 v2) {
    return v1 * v2;
  }
  `,name:Jr,type:Pr.FunctionType.ValueBased}}function Gr(){const Jr="sub_";return{body:`
  float ${Jr}(float a, float b) {
    return a - b;
  }
  vec4 ${Jr}(vec4 v1, vec4 v2) {
    return v1 - v2;
  }
  `,name:Jr,type:Pr.FunctionType.ValueBased}}function Nr(){const Jr="equal_";return{body:`
  float ${Jr}(float a, float b) {
    return float(a == b);
  }
  vec4 ${Jr}(vec4 v1, vec4 v2) {
    return vec4(equal(v1, v2));
  }
  `,name:Jr,type:Pr.FunctionType.ValueBased}}function Lr(){const Jr="greater_";return{body:`
  float ${Jr}(float a, float b) {
    return float(a > b);
  }
  vec4 ${Jr}(vec4 v1, vec4 v2) {
    return vec4( v1.r > v2.r ,
      v1.g > v2.g,
      v1.b > v2.b,
      v1.a > v2.a );
  }
  `,name:Jr,type:Pr.FunctionType.ValueBased}}function Ur(){const Jr="less_";return{body:`
  float ${Jr}(float a, float b) {
    return float(a < b);
  }
  vec4 ${Jr}(vec4 v1, vec4 v2) {
    return vec4( v1.r < v2.r ,
                v1.g < v2.g,
                v1.b < v2.b,
                v1.a < v2.a );
  }
  `,name:Jr,type:Pr.FunctionType.ValueBased}}function Vr(){const Jr="and_";return{body:`
  float ${Jr}(float a, float b) {
    return float( bool(a) && bool(b) );
  }
  vec4 ${Jr}(vec4 v1, vec4 v2) {
    bvec4 b1 = bvec4(v1);
    bvec4 b2 = bvec4(v2);
    return vec4( b1.r && b2.r ,
                b1.g && b2.g,
                b1.b && b2.b,
                b1.a && b2.a );
  }
  `,name:Jr,type:Pr.FunctionType.ValueBased}}function Wr(){const Jr="or_";return{body:`
  float ${Jr}(float a, float b) {
    return float( bool(a) || bool(b) );
  }
  vec4 ${Jr}(vec4 v1, vec4 v2) {
    bvec4 b1 = bvec4(v1);
    bvec4 b2 = bvec4(v2);
    return vec4( b1.r || b2.r ,
                b1.g || b2.g,
                b1.b || b2.b,
                b1.a || b2.a );
  }
  `,name:Jr,type:Pr.FunctionType.ValueBased}}function qr(){const Jr="xor_";return{body:`
  float ${Jr}(float a, float b) {
    return float( bool(a) ^^ bool(b) );
  }
  vec4 ${Jr}(vec4 v1, vec4 v2) {
    bvec4 b1 = bvec4(v1);
    bvec4 b2 = bvec4(v2);
    return vec4( b1.r ^^ b2.r ,
                b1.g ^^ b2.g,
                b1.b ^^ b2.b,
                b1.a ^^ b2.a );
  }
  `,name:Jr,type:Pr.FunctionType.ValueBased}}function Kr(){return function(Jr){const es=`${Jr}_`;return{body:`
  float ${es}(float a, float b) {
    return ${Jr}(a, b);
  }
  vec4 ${es}(vec4 v1, vec4 v2) {
    return ${Jr}(v1, v2);
  }
  `,name:es,type:Pr.FunctionType.ValueBased}}("pow")}function Xr(){const Jr="prelu_";return{body:`
  float ${Jr}(float a, float b) {
    return a < 0.0 ? a * b: a;
  }
  vec4 ${Jr}(vec4 v1, vec4 v2) {
    return vec4(
      v1.r < 0.0 ? v1.r * v2.r: v1.r,
      v1.g < 0.0 ? v1.g * v2.g: v1.g,
      v1.b < 0.0 ? v1.b * v2.b: v1.b,
      v1.a < 0.0 ? v1.a * v2.a: v1.a
      );
  }
  `,name:Jr,type:Pr.FunctionType.ValueBased}}Tr.glslAdd=Fr,Tr.glslDiv=zr,Tr.glslMul=jr,Tr.glslSub=Gr,Tr.glslEqual=Nr,Tr.glslGreater=Lr,Tr.glslLess=Ur,Tr.glslAnd=Vr,Tr.glslOr=Wr,Tr.glslXor=qr,Tr.glslPow=Kr,Tr.glslPRelu=Xr;const Zr=(Jr,es,ts,is=es[0].type,rs)=>{const as=Jr.session.pack?Mr.TextureType.packed:Mr.TextureType.unpacked;return{name:ts.name,inputNames:["A","B"],inputTypes:[as,as],cacheHint:rs,get:()=>_i(Jr,es,ts,is)}},_i=(Jr,es,ts,is=es[0].type)=>{const rs=Jr.session.pack?Mr.TextureType.packed:Mr.TextureType.unpacked,as=!Rr.ShapeUtil.areEqual(es[0].dims,es[1].dims);let ls=es[0].dims;const fs=Jr.session.pack;if(as){const xs=Rr.BroadcastUtil.calcShape(es[0].dims,es[1].dims,!1);if(!xs)throw new Error("Can't perform binary op on the given tensors");ls=xs;const ys=ls.length,ps=es[0].dims.length!==0?es[0].dims.length:1,vs=es[1].dims.length!==0?es[1].dims.length:1,Ds=es[0].dims.length!==0?"bcastIndices_A(indices, aindices);":"aindices[0] = 0;",js=es[1].dims.length!==0?"bcastIndices_B(indices, bindices);":"bindices[0] = 0;",zs=(0,Dr.getGlsl)(Jr.session.backend.glContext.version),qs=fs?`
      ${ts.body}
      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();
        vec4 result = ${ts.name}(a, b);
        ${zs.output} = result;
      }`:`
      ${ts.body}
      float process(int indices[${ys}]) {
        int aindices[${ps}];
        int bindices[${vs}];
        ${Ds}
        ${js}
        return ${ts.name}(_A(aindices), _B(bindices));
      }`;return{name:ts.name,inputNames:["A","B"],inputTypes:[rs,rs],output:{dims:ls,type:is,textureType:rs},shaderSource:qs,hasMain:fs}}const Ts=(0,Dr.getGlsl)(Jr.session.backend.glContext.version),$s=`
    ${ts.body}
    void main() {
      vec4 v1 = ${Ts.texture2D}(A, TexCoords);
      vec4 v2 = ${Ts.texture2D}(B, TexCoords);
      vec4 result = ${ts.name}(v1, v2);
      ${Ts.output} = result;
    }
    `;return{name:ts.name,inputNames:["A","B"],inputTypes:[rs,rs],output:{dims:es[0].dims,type:is,textureType:rs},shaderSource:$s,hasMain:!0}};Tr.add=(Jr,es)=>[Jr.run(Zr(Jr,es,Fr()),es)],Tr.and=(Jr,es)=>[Jr.run(Zr(Jr,es,Vr(),"bool"),es)],Tr.div=(Jr,es)=>[Jr.run(Zr(Jr,es,zr()),es)],Tr.equal=(Jr,es)=>[Jr.run(Zr(Jr,es,Nr(),"bool"),es)],Tr.greater=(Jr,es)=>[Jr.run(Zr(Jr,es,Lr(),"bool"),es)],Tr.less=(Jr,es)=>[Jr.run(Zr(Jr,es,Ur(),"bool"),es)],Tr.mul=(Jr,es)=>[Jr.run(Zr(Jr,es,jr()),es)],Tr.or=(Jr,es)=>[Jr.run(Zr(Jr,es,Wr(),"bool"),es)],Tr.pow=(Jr,es)=>[Jr.run(Zr(Jr,es,Kr()),es)],Tr.pRelu=(Jr,es)=>[Jr.run(Zr(Jr,es,Xr()),es)],Tr.sub=(Jr,es)=>[Jr.run(Zr(Jr,es,Gr()),es)],Tr.xor=(Jr,es)=>[Jr.run(Zr(Jr,es,qr(),"bool"),es)]},4752:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.parseCastAttributes=Tr.cast=void 0;const Rr=Ar(7273);Tr.cast=(Dr,Mr,Fr)=>(Pr(Mr),[Dr.cast(Mr[0],Fr)]),Tr.parseCastAttributes=Dr=>Rr.ProtoUtil.tensorDataTypeFromProto(Dr.attributes.getInt("to"));const Pr=Dr=>{if(!Dr||Dr.length!==1)throw new Error("Cast requires 1 input.");if(Dr[0].type==="string")throw new Error("Invalid input type.")}},4595:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.createPackedConcatProgramInfoLoader=void 0;const Rr=Ar(6757),Pr=Ar(5639),Dr=Ar(432),Mr=Ar(5614);Tr.createPackedConcatProgramInfoLoader=(zr,jr,Gr)=>{const Nr=(Lr=jr.length,Ur=Gr.cacheKey,{name:"Concat (packed)",inputNames:Array.from({length:Lr},(Vr,Wr)=>`X${Wr}`),inputTypes:Array(Lr).fill(Pr.TextureType.packed),cacheHint:Ur});var Lr,Ur;return Object.assign(Object.assign({},Nr),{get:()=>((Vr,Wr,qr,Kr)=>{const Xr=qr[0].dims.slice();if(Kr>=Xr.length||Kr<-1*Xr.length)throw new Error("axis specified for concat doesn't match input dimensionality");Kr<0&&(Kr=Xr.length+Kr);const Zr=Xr.slice(0);for(let Ds=1;Ds<qr.length;Ds++){const js=qr[Ds].dims.slice();for(let zs=0;zs<Xr.length;zs++)if(zs===Kr)Zr[Kr]+=js[zs];else if(Xr[zs]!==js[zs])throw new Error("non concat dimensions must match")}const _i=Zr.length,Jr=(0,Mr.getChannels)("coords",_i),es=(0,Dr.getCoordsDataType)(_i),ts=(0,Mr.unpackFromChannel)(),is=qr.map(Ds=>Ds.dims),rs=(0,Dr.getGlChannels)(_i),as=new Array(is.length-1);as[0]=is[0][Kr];for(let Ds=1;Ds<as.length;Ds++)as[Ds]=as[Ds-1]+is[Ds][Kr];const ls=rs[Kr],fs=rs.slice(-2),Ts=rs.join();let $s=`if (${ls} < ${as[0]}) {
        return getChannel(
            getX0(${Ts}), vec2(${fs.join()}));
        }`;for(let Ds=1;Ds<as.length;Ds++){const js=as[Ds-1];$s+=`
            if (${ls} < ${as[Ds]}  && ${ls} >= ${as[Ds-1]}) {
              return getChannel(
                getX${Ds}(${Fr(rs,ls,js)}),
                vec2(${Fr(fs,ls,js)}));
            }`}const xs=as.length,ys=as[as.length-1];$s+=`
            return getChannel(
              getX${xs}(${Fr(rs,ls,ys)}),
              vec2(${Fr(fs,ls,ys)}));`;const ps=(0,Rr.getGlsl)(Vr.session.backend.glContext.version),vs=`
          ${ts}
          float getValue(${rs.map(Ds=>"int "+Ds)}) {
            ${$s}
          }

          void main() {
            ${es} coords = getOutputCoords();
            int lastDim = coords.${rs[_i-1]};
            coords.${rs[_i-1]} = coords.${rs[_i-2]};
            coords.${rs[_i-2]} = lastDim;

            vec4 result = vec4(getValue(${Jr}), 0., 0., 0.);

            ${Jr[_i-1]} = ${Jr[_i-1]} + 1;
            if (${Jr[_i-1]} < ${Zr[_i-1]}) {
              result.g = getValue(${Jr});
            }

            ${Jr[_i-2]} = ${Jr[_i-2]} + 1;
            if (${Jr[_i-2]} < ${Zr[_i-2]}) {
              result.a = getValue(${Jr});
            }

            ${Jr[_i-1]} = ${Jr[_i-1]} - 1;
            if (${Jr[_i-2]} < ${Zr[_i-2]} &&
                ${Jr[_i-1]} < ${Zr[_i-1]}) {
              result.b = getValue(${Jr});
            }
            ${ps.output} = result;
          }
        `;return Object.assign(Object.assign({},Wr),{output:{dims:Zr,type:qr[0].type,textureType:Pr.TextureType.packed},shaderSource:vs,hasMain:!0})})(zr,Nr,jr,Gr.axis)})};const Fr=(zr,jr,Gr)=>{const Nr=zr.indexOf(jr);return zr.map((Lr,Ur)=>Ur===Nr?`${Lr} - ${Gr}`:Lr).join()}},6668:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.parseConcatAttributes=Tr.concat=void 0;const Rr=Ar(4910),Pr=Ar(5639),Dr=Ar(4595);Tr.concat=(Lr,Ur,Vr)=>(Nr(Ur),Lr.session.pack&&Ur[0].dims.length>1?[Lr.run((0,Dr.createPackedConcatProgramInfoLoader)(Lr,Ur,Vr),Ur)]:[Lr.run(Mr(Lr,Ur,Vr),Ur)]);const Mr=(Lr,Ur,Vr)=>{const Wr=(qr=Ur.length,Kr=Vr.cacheKey,{name:"Concat",inputNames:Array.from({length:qr},(Xr,Zr)=>`X${Zr}`),inputTypes:Array(qr).fill(Pr.TextureType.unpacked),cacheHint:Kr});var qr,Kr;return Object.assign(Object.assign({},Wr),{get:()=>((Xr,Zr,_i,Jr)=>{const es=_i[0].dims.slice();if(Jr>=es.length||Jr<-1*es.length)throw new Error("axis specified for concat doesn't match input dimensionality");Jr<0&&(Jr=es.length+Jr);const ts=es.slice(0);for(let Ts=1;Ts<_i.length;Ts++){const $s=_i[Ts].dims.slice();for(let xs=0;xs<es.length;xs++)if(xs===Jr)ts[Jr]+=$s[xs];else if(es[xs]!==$s[xs])throw new Error("non concat dimensions must match")}const is=ts.length,rs=new Array(_i.length);let as=0;for(let Ts=0;Ts<rs.length;++Ts)as+=_i[Ts].dims[Jr],rs[Ts]=as;let ls="";ls=_i.length<5?Fr(rs):zr(rs);const fs=`
        ${jr(_i.length,is)}
        ${Gr(rs)}
        ${ls}
        float process(int indices[${is}]) {
          int textureIndex = getTextureWhereDataResides (indices[${Jr}]);

          if(textureIndex != 0) {
            indices[${Jr}] = indices[${Jr}] - int(getSizeInConcatAxisValueFromIndex(textureIndex-int(1)));
          }

          return fetchDataFromCorrectTexture(textureIndex, indices);
        }`;return Object.assign(Object.assign({},Zr),{output:{dims:ts,type:_i[0].type,textureType:Pr.TextureType.unpacked},shaderSource:fs})})(0,Wr,Ur,Vr.axis)})},Fr=Lr=>`int getTextureWhereDataResides(int index) {
      ${Lr.map((Ur,Vr)=>`if(index<${Ur}) {return ${Vr};}
`).join("")}
    }`,zr=Lr=>Fr(Lr),jr=(Lr,Ur)=>{const Vr=[`float fetchDataFromCorrectTexture(int textureIndex, int indices[${Ur}]) {`];for(let Wr=0;Wr<Lr;++Wr)Wr===0?Vr.push(`	if (textureIndex == ${Wr}) { return _X${Wr}(indices); }`):Wr===Lr-1?Vr.push(`	else { return _X${Wr}(indices); }`):Vr.push(`	else if (textureIndex == ${Wr}) { return _X${Wr}(indices); }`);return Vr.push("	}"),Vr.join(`
`)},Gr=Lr=>{const Ur=["int getSizeInConcatAxisValueFromIndex(int index) {"];for(let Vr=0;Vr<Lr.length;++Vr)Vr===0?Ur.push(`	if (index == ${Vr}) { return ${Lr[Vr]}; }`):Vr===Lr.length-1?Ur.push(`	else { return ${Lr[Vr]}; }`):Ur.push(`	else if (index == ${Vr}) { return ${Lr[Vr]}; }`);return Ur.push("	}"),Ur.join(`
`)};Tr.parseConcatAttributes=Lr=>(0,Rr.createAttributeWithCacheKey)({axis:Lr.attributes.getInt("axis")});const Nr=Lr=>{if(!Lr||Lr.length<1)throw new Error("too few inputs");const Ur=Lr[0].type,Vr=Lr[0].dims.length;if(Ur==="string")throw new Error("string tensor is not supported yet");for(const Wr of Lr){if(Wr.type!==Ur)throw new Error("input tensors should be one type");if(Wr.dims.length!==Vr)throw new Error("input tensors should have the same shape")}}},7825:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.createUnpackedGroupedConvProgramInfoLoader=void 0;const Rr=Ar(1315),Pr=Ar(6757),Dr=Ar(5639),Mr=Ar(9754),Fr=Ar(2150);Tr.createUnpackedGroupedConvProgramInfoLoader=(zr,jr,Gr)=>{const Nr=(Lr=jr.length>2,Ur=Gr.cacheKey,{name:"GroupedConv",inputNames:Lr?["X","W","Bias"]:["X","W"],inputTypes:Lr?[Dr.TextureType.unpacked,Dr.TextureType.unpacked,Dr.TextureType.unpacked]:[Dr.TextureType.unpacked,Dr.TextureType.unpacked],cacheHint:Ur});var Lr,Ur;return Object.assign(Object.assign({},Nr),{get:()=>((Vr,Wr,qr,Kr)=>{const Xr=Wr.length>2?"value += getBias(output_channel);":"",Zr=Wr[0].dims.slice(),_i=Wr[1].dims.slice(),Jr=_i[0]/Kr.group;Rr.Logger.verbose("GroupedConv",`autpPad:${Kr.autoPad}, dilations:${Kr.dilations}, group:${Kr.group}, kernelShape:${Kr.kernelShape}, pads:${Kr.pads}, strides:${Kr.strides}`);const es=(0,Mr.calculateOutputShape)(Zr,_i,Kr.dilations,Kr.pads,Kr.strides),ts=(0,Pr.getGlsl)(Vr.session.backend.glContext.version),{activationFunction:is,applyActivation:rs}=(0,Fr.getActivationSnippet)(Kr),as=`
  const ivec2 strides = ivec2(${Kr.strides[0]}, ${Kr.strides[1]});
  const ivec2 pads = ivec2(${Kr.pads[0]}, ${Kr.pads[1]});
  ${is}
  void main() {
    ivec4 coords = getOutputCoords();
    int batch = coords.x;
    int output_channel = coords.y;
    ivec2 xRCCorner = coords.zw * strides - pads;
    int group_id = output_channel / ${Jr};

    float value = 0.0;
    for (int wInChannel = 0; wInChannel < ${_i[1]}; wInChannel++) {
      int input_channel = group_id * ${_i[1]} + wInChannel;
      for (int wHeight = 0; wHeight < ${_i[2]}; wHeight++) {
        int xHeight = xRCCorner.x + wHeight * ${Kr.dilations[0]};

        if (xHeight < 0 || xHeight >= ${Zr[2]}) {
          continue;
        }

        for (int wWidth = 0; wWidth < ${_i[3]}; wWidth++) {
          int xWidth = xRCCorner.y + wWidth * ${Kr.dilations[1]};
          if (xWidth < 0 || xWidth >= ${Zr[3]}) {
            continue;
          }

          float xVal = getX(batch, input_channel, xWidth, xHeight);
          float wVal = getW(output_channel, wInChannel, wWidth, wHeight);
          value += xVal*wVal;
        }
      }
    }
    ${Xr}
    ${rs}
    ${ts.output} = vec4(value, .0, .0, .0);
  }
`;return Object.assign(Object.assign({},qr),{output:{dims:es,type:Wr[0].type,textureType:Dr.TextureType.unpacked},shaderSource:as,hasMain:!0})})(zr,jr,Nr,Gr)})}},7708:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.conv2DPacked=Tr.conv2DPackedPointwise=void 0;const Rr=Ar(9754),Pr=Ar(5950),Dr=Ar(5632);Tr.conv2DPackedPointwise=(Mr,Fr,zr)=>{const jr=Fr[0].dims,Gr=Fr[1].dims,Nr=(0,Rr.calculateOutputShape)(jr,Gr,zr.dilations,zr.pads,zr.strides),Lr=Mr.reshapePacked(Fr[0],[jr[1],jr[2]*jr[3]]),Ur=Mr.reshapePacked(Fr[1],[Gr[0],Gr[1]]),Vr=Fr.length>2?[Ur,Lr,Fr[2]]:[Ur,Lr],Wr=Mr.run((0,Dr.createPackedMatmulProgramInfoLoader)(Mr,Vr,zr),Vr);return Mr.reshapePacked(Wr,Nr)},Tr.conv2DPacked=(Mr,Fr,zr)=>{const jr=Fr[0].dims,Gr=Fr[1].dims,Nr=(0,Rr.calculateOutputShape)(jr,Gr,zr.dilations,zr.pads,zr.strides),Lr=Mr.run((0,Pr.createPackedIm2ColProgramInfoLoader)(Mr,Fr[0],Fr[1],Nr,zr),[Fr[0]]),Ur=Mr.reshapePacked(Fr[1],[Gr[0],Gr[1]*Gr[2]*Gr[3]]),Vr=Fr.length===3?[Ur,Lr,Fr[2]]:[Ur,Lr],Wr=Mr.run((0,Dr.createPackedMatmulProgramInfoLoader)(Mr,Vr,zr),Vr);return Mr.reshapePacked(Wr,Nr)}},5042:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.parseConvTransposeAttributes=Tr.convTranspose=void 0;const Rr=Ar(4910),Pr=Ar(6757),Dr=Ar(5639),Mr=Ar(2150),Fr=(Ur,Vr,Wr,qr,Kr,Xr)=>(Ur-1)*Vr+Wr+(qr-1)*Kr+1-Xr,zr=(Ur,Vr,Wr,qr,Kr)=>{const Xr=Math.floor(Ur/2);Vr==="SAME_UPPER"?(Wr[qr]=Xr,Wr[Kr]=Ur-Xr):Vr==="SAME_LOWER"&&(Wr[qr]=Ur-Xr,Wr[Kr]=Xr)};Tr.convTranspose=(Ur,Vr,Wr)=>(Lr(Vr,Wr),jr(Ur,Vr,Wr));const jr=(Ur,Vr,Wr)=>{const qr=Nr(Wr,Vr);return[Gr(Ur,Vr,qr)]},Gr=(Ur,Vr,Wr)=>Ur.run(((qr,Kr,Xr)=>{const Zr=(_i=Kr.length>2,Jr=Xr.cacheKey,{name:"ConvTranspose",inputNames:_i?["X","W","B"]:["X","W"],inputTypes:_i?[Dr.TextureType.unpacked,Dr.TextureType.unpacked,Dr.TextureType.unpacked]:[Dr.TextureType.unpacked,Dr.TextureType.unpacked],cacheHint:Jr});var _i,Jr;return Object.assign(Object.assign({},Zr),{get:()=>((es,ts,is,rs)=>{const as=ts.length>2?"getB(output_channel)":"0.0",ls=ts[0].dims,fs=ts[1].dims,Ts=fs[1],$s=fs[0]/rs.group,xs=[ts[0].dims[0],ts[1].dims[1]*rs.group,...rs.outputShape],ys=(0,Pr.getGlsl)(es.session.backend.glContext.version),{activationFunction:ps,applyActivation:vs}=(0,Mr.getActivationSnippet)(rs),Ds=`
  const ivec2 strides = ivec2(${rs.strides[0]}, ${rs.strides[1]});
  const ivec2 pads = ivec2(${rs.pads[0]}, ${rs.pads[1]});
  ${ps}
  void main() {
    ivec4 coords = getOutputCoords();
    int batch = coords.x;
    int output_channel = coords.y;

    ivec2 loc = coords.zw + pads;

    int group_id = output_channel / ${Ts};
    int wOutChannel = output_channel - group_id * ${Ts};

    float value = ${as};
    for (int inChannelOffset = 0; inChannelOffset < ${$s}; inChannelOffset++) {
      int input_channel = group_id * ${$s} + inChannelOffset;
      for (int wWOff = 0; wWOff < ${fs[2]}; wWOff++) {
        for (int wHOff = 0; wHOff < ${fs[3]}; wHOff++) {
          ivec2 wOff = ivec2(wWOff * ${rs.dilations[0]}, wHOff * ${rs.dilations[1]});
          ivec2 wLoc = loc - wOff;
          ivec2 wLocIn = wLoc / strides;
          if (
            wLocIn * strides == wLoc &&
            wLocIn.x >= 0 && wLocIn.x < ${ls[2]} &&
            wLocIn.y >= 0 && wLocIn.y < ${ls[3]}
          ) {
            float xVal = getX(batch, input_channel, wLocIn.y, wLocIn.x);
            float wVal = getW(input_channel, wOutChannel, wHOff, wWOff);
            value += xVal * wVal;
          }
        }
      }
    }
    ${vs}
    ${ys.output} = vec4(value, .0, .0, .0);
  }
`;return Object.assign(Object.assign({},is),{output:{dims:xs,type:ts[0].type,textureType:Dr.TextureType.unpacked},shaderSource:Ds,hasMain:!0})})(qr,Kr,Zr,Xr)})})(Ur,Vr,Wr),Vr),Nr=(Ur,Vr)=>{const Wr=Ur.kernelShape.slice();if(Ur.kernelShape.length===0)for(let Zr=2;Zr<Vr[1].dims.length;++Zr)Wr.push(Vr[1].dims[Zr]);const qr=Ur.pads.slice(),Kr=Ur.outputShape.slice();((Zr,_i,Jr,es,ts,is,rs,as)=>{const ls=Zr.length-2,fs=as.length===0;for(let Ts=0;Ts<ls;++Ts){const $s=fs?Zr[Ts+2]*is[Ts]:as[Ts],xs=Fr(Zr[Ts+2],is[Ts],ts[Ts],_i[Ts],Jr[Ts],$s);zr(xs,es,ts,Ts,Ts+ls),fs&&as.push(is[Ts]*(Zr[Ts+2]-1)+rs[Ts]+(_i[Ts]-1)*Jr[Ts]+1-ts[Ts]-ts[Ts+ls])}})(Vr[0].dims,Wr,Ur.dilations,Ur.autoPad,qr,Ur.strides,Ur.outputPadding,Kr);const Xr=Object.assign({},Ur);return Object.assign(Xr,{kernelShape:Wr,pads:qr,outputShape:Kr,cacheKey:Ur.cacheKey}),Xr};Tr.parseConvTransposeAttributes=Ur=>{const Vr=Ur.attributes,Wr=(0,Mr.parseInternalActivationAttributes)(Vr),qr=Vr.getString("auto_pad","NOTSET"),Kr=Vr.getInts("dilations",[1,1]),Xr=Vr.getInt("group",1),Zr=Vr.getInts("kernel_shape",[]),_i=Vr.getInts("output_padding",[0,0]),Jr=Vr.getInts("output_shape",[]),es=Vr.getInts("pads",[0,0,0,0]),ts=Vr.getInts("strides",[1,1]);return(0,Rr.createAttributeWithCacheKey)(Object.assign({autoPad:qr,dilations:Kr,group:Xr,kernelShape:Zr,outputPadding:_i,outputShape:Jr,pads:es,strides:ts},Wr))};const Lr=(Ur,Vr)=>{if(!Ur||Ur.length!==2&&Ur.length!==3)throw new Error("Conv requires 2 or 3 inputs");if(Ur[0].dims.length!==4||Ur[1].dims.length!==4)throw new Error("currently only support 2-dimensional conv");if(Ur[0].dims[1]!==Ur[1].dims[0])throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");const Wr=Ur[1].dims[1]*Vr.group;if(Ur.length===3&&(Ur[2].dims.length!==1||Ur[2].dims[0]!==Wr))throw new Error("invalid bias");const qr=Ur[0].dims.length-2;if(Vr.dilations.length!==qr)throw new Error(`dilations should be ${qr}D`);if(Vr.strides.length!==qr)throw new Error(`strides should be ${qr}D`);if(Vr.pads.length!==2*qr)throw new Error(`pads should be ${2*qr}D`);if(Vr.outputPadding.length!==qr)throw new Error(`output_padding should be ${qr}D`);if(Vr.kernelShape.length!==0&&Vr.kernelShape.length!==Ur[1].dims.length-2)throw new Error("invalid kernel shape");if(Vr.outputShape.length!==0&&Vr.outputShape.length!==Ur[0].dims.length-2)throw new Error("invalid output shape");if(Ur[0].type!=="float32"||Ur[1].type!=="float32")throw new Error("ConvTranspose input(X,W) should be float tensor");if(Ur.length===3&&Ur[2].type!=="float32")throw new Error("ConvTranspose input(bias) should be float tensor")}},9754:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.parseConvAttributes=Tr.conv=Tr.calculateOutputShape=void 0;const Rr=Ar(4910),Pr=Ar(7273),Dr=Ar(7825),Mr=Ar(7708),Fr=Ar(3281),zr=Ar(2150),jr=Ar(1625),Gr=Ar(8276);Tr.calculateOutputShape=(qr,Kr,Xr,Zr,_i)=>{const Jr=qr[0],es=qr.slice(2),ts=es.length,is=Kr[0],rs=Kr.slice(2).map((ls,fs)=>ls+(ls-1)*(Xr[fs]-1)),as=es.map((ls,fs)=>ls+Zr[fs]+Zr[fs+ts]).map((ls,fs)=>Math.floor((ls-rs[fs]+_i[fs])/_i[fs]));return[Jr,is].concat(...as)},Tr.conv=(qr,Kr,Xr)=>(Wr(Kr,Xr),Nr(qr,Kr,Xr));const Nr=(qr,Kr,Xr)=>{const Zr=Vr(Xr,Kr),_i=qr.session.pack,Jr=Zr.kernelShape[0]===1&&Zr.kernelShape[1]===1;return Zr.group>1?[qr.run((0,Dr.createUnpackedGroupedConvProgramInfoLoader)(qr,Kr,Zr),Kr)]:Jr&&_i?[Lr(qr,Kr,Zr)]:_i&&Kr[0].dims.length===4&&Kr[0].dims[0]===1&&!Jr?[(0,Mr.conv2DPacked)(qr,Kr,Zr)]:[Ur(qr,Kr,Zr)]},Lr=(qr,Kr,Xr)=>{const Zr=Kr[0].dims,_i=Kr[1].dims,Jr=(0,Tr.calculateOutputShape)(Zr,_i,Xr.dilations,Xr.pads,Xr.strides),es=qr.reshapeUnpacked(Kr[0],[Zr[1],Zr[2]*Zr[3]]),ts=qr.reshapeUnpacked(Kr[1],[_i[0],_i[1]]),is=Kr.length>2?[ts,es,Kr[2]]:[ts,es],rs=qr.run((0,Gr.createMatmulProgramInfoLoader)(is,Xr),is);return qr.reshapeUnpacked(rs,Jr)},Ur=(qr,Kr,Xr)=>{const Zr=Kr[0].dims,_i=Kr[1].dims,Jr=(0,Tr.calculateOutputShape)(Zr,_i,Xr.dilations,Xr.pads,Xr.strides),es=qr.run((0,jr.createIm2ColProgramInfoLoader)(qr,Kr[0],Kr[1],Jr,Xr),[Kr[0]]),ts=Kr.length===3?[es,Kr[1],Kr[2]]:[es,Kr[1]];return qr.run((0,Fr.createDotProductProgramInfoLoader)(qr,Kr,Jr,Xr),ts)},Vr=(qr,Kr)=>{const Xr=qr.kernelShape.slice();if(qr.kernelShape.length===0)for(let Jr=2;Jr<Kr[1].dims.length;++Jr)Xr.push(Kr[1].dims[Jr]);const Zr=qr.pads.slice();Pr.PoolConvUtil.adjustPadsBasedOnAutoPad(Kr[0].dims,qr.strides,qr.dilations,Xr,Zr,qr.autoPad);const _i=Object.assign({},qr);return Object.assign(_i,{kernelShape:Xr,pads:Zr,cacheKey:qr.cacheKey}),_i};Tr.parseConvAttributes=qr=>{const Kr=qr.attributes,Xr=(0,zr.parseInternalActivationAttributes)(Kr),Zr=Kr.getString("auto_pad","NOTSET"),_i=Kr.getInts("dilations",[1,1]),Jr=Kr.getInt("group",1),es=Kr.getInts("kernel_shape",[]),ts=Kr.getInts("pads",[0,0,0,0]),is=Kr.getInts("strides",[1,1]);return(0,Rr.createAttributeWithCacheKey)(Object.assign({autoPad:Zr,dilations:_i,group:Jr,kernelShape:es,pads:ts,strides:is},Xr))};const Wr=(qr,Kr)=>{if(!qr||qr.length!==2&&qr.length!==3)throw new Error("Conv requires 2 or 3 inputs");if(qr[0].dims.length!==4||qr[1].dims.length!==4)throw new Error("currently only support 2-dimensional conv");if(qr[0].dims[1]!==qr[1].dims[1]*Kr.group)throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");if(qr.length===3&&(qr[2].dims.length!==1||qr[1].dims[0]!==qr[2].dims[0]))throw new Error("invalid bias");const Xr=qr[0].dims.length-2;if(Kr.dilations.length!==Xr)throw new Error(`dilations should be ${Xr}D`);if(Kr.strides.length!==Xr)throw new Error(`strides should be ${Xr}D`);if(Kr.pads.length!==2*Xr)throw new Error(`pads should be ${2*Xr}D`);if(Kr.kernelShape.length!==0&&Kr.kernelShape.length!==qr[1].dims.length-2)throw new Error("invalid kernel shape");if(qr[0].type!=="float32"||qr[1].type!=="float32")throw new Error("Conv input(X,W) should be float tensor");if(qr.length===3&&qr[2].type!=="float32")throw new Error("Conv input(bias) should be float tensor")}},6742:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.parseDepthToSpaceAttributes=Tr.depthToSpace=void 0;const Rr=Ar(5707);Tr.depthToSpace=(Dr,Mr,Fr)=>{Pr(Mr);const zr=Fr.blocksize,jr=zr*zr,Gr=Fr.mode==="DCR"?[0,3,4,1,5,2]:[0,1,4,2,5,3],Nr=Fr.mode==="DCR"?[Mr[0].dims[0],zr,zr,Mr[0].dims[1]/jr,Mr[0].dims[2],Mr[0].dims[3]]:[Mr[0].dims[0],Mr[0].dims[1]/jr,zr,zr,Mr[0].dims[2],Mr[0].dims[3]],Lr=Dr.reshapeUnpacked(Mr[0],Nr),Ur={perm:Gr,cacheKey:`${Gr}`},[Vr]=(0,Rr.transpose)(Dr,[Lr],Ur),Wr=[Mr[0].dims[0],Mr[0].dims[1]/jr,Mr[0].dims[2]*zr,Mr[0].dims[3]*zr];return[Dr.reshapeUnpacked(Vr,Wr)]},Tr.parseDepthToSpaceAttributes=Dr=>{const Mr=Dr.attributes.getInt("blocksize");if(Mr<1)throw new Error(`blocksize must be >= 1, but got : ${Mr} for DepthToSpace`);const Fr=Dr.attributes.getString("mode","DCR");if(Fr!=="DCR"&&Fr!=="CRD")throw new Error(`unrecognized mode: ${Fr} for DepthToSpace`);return{mode:Fr,blocksize:Mr}};const Pr=Dr=>{if(Dr.length!==1)throw new Error(`DepthToSpace expect 1 inputs, but got ${Dr.length}`);if(Dr[0].type==="string"||Dr[0].dims.length!==4)throw new TypeError("DepthToSpace input should be a 4-D numeric tensor")}},3281:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.createDotProductProgramInfoLoader=void 0;const Rr=Ar(7273),Pr=Ar(6757),Dr=Ar(5639),Mr=Ar(2150),Fr=Ar(1625);Tr.createDotProductProgramInfoLoader=(zr,jr,Gr,Nr)=>{const Lr=((Ur,Vr)=>({name:"ConvDotProduct",inputNames:Ur?["Im2Col","K","B"]:["Im2Col","K"],inputTypes:Ur?[Dr.TextureType.unpacked,Dr.TextureType.packedLastDimension,Dr.TextureType.unpacked]:[Dr.TextureType.unpacked,Dr.TextureType.packedLastDimension],cacheKey:Vr.activationCacheKey}))(jr.length>2,Nr);return Object.assign(Object.assign({},Lr),{get:()=>((Ur,Vr,Wr,qr,Kr)=>{const Xr=Wr[0].dims,Zr=Wr[1].dims,_i=[Zr[0],Math.ceil(Xr[1]*Zr[2]*Zr[3]/4)],Jr=(0,Fr.calculateIm2ColDims)(Xr,Zr,qr),[es,ts]=Ur.calculateTextureWidthAndHeight(_i,Dr.TextureType.packedLastDimension),is=Rr.ShapeUtil.computeStrides(Jr),[rs,as]=Ur.calculateTextureWidthAndHeight(Jr,Dr.TextureType.packedLastDimension),ls=qr.length,fs=Wr.length<3?"0.0":"_B(b)",Ts=Math.ceil(Xr[1]*Zr[2]*Zr[3]/4),{activationFunction:$s,applyActivation:xs}=(0,Mr.getActivationSnippet)(Kr),ys=(0,Pr.getGlsl)(Ur.session.backend.glContext.version),ps=`
${$s}
float process(int indices[${ls}]) {
  int b[1];
  b[0] = indices[1];
  int im2col[4];
  im2col[0] = indices[0];
  im2col[1] = indices[2];
  im2col[2] = indices[3];
  int im2colOffset = im2col[0] * ${is[0]} + im2col[1] * ${is[1]} + im2col[2] * ${is[2]};
  int kernelOffset = indices[1] * ${_i[1]};
  float value = ${fs};
  for (int i = 0; i < ${Ts}; ++i) {
    vec2 im2colCoords = offsetToCoords(im2colOffset, ${rs}, ${as});
    vec2 kernelCoords = offsetToCoords(kernelOffset, ${es}, ${ts});
    value += dot(${ys.texture2D}(Im2Col, im2colCoords), ${ys.texture2D}(K, kernelCoords));
    ++im2colOffset;
    ++kernelOffset;
  }
  ${xs}
  return value;
}`;return Object.assign(Object.assign({},Vr),{output:{dims:qr,type:Wr[0].type,textureType:Dr.TextureType.unpacked},shaderSource:ps})})(zr,Lr,jr,Gr,Nr)})}},4125:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.parseFlattenAttributes=Tr.flatten=void 0;const Rr=Ar(7273);Tr.flatten=(Dr,Mr,Fr)=>{Pr(Mr,Fr);const zr=Rr.ShapeUtil.flattenShape(Mr[0].dims,Fr);return[Dr.reshapeUnpacked(Mr[0],zr)]},Tr.parseFlattenAttributes=Dr=>Dr.attributes.getInt("axis",1);const Pr=(Dr,Mr)=>{if(!Dr||Dr.length!==1)throw new Error("Flatten requires 1 input.");const Fr=Dr[0].dims.length;if(Fr===0)throw new Error("scalar tensor is not supported.");if(Mr<-Fr||Mr>Fr)throw new Error("Invalid axis");if(Dr[0].type==="string")throw new Error("string tensor is not supported.")}},2150:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.parseInternalActivationAttributes=Tr.getActivationSnippet=void 0;const Rr=Ar(7273),Pr=Ar(9087);Tr.getActivationSnippet=function(Dr){let Mr;switch(Dr.activation){case"Relu":Mr=(0,Pr.glslRelu)();break;case"Sigmoid":Mr=(0,Pr.glslSigmoid)();break;case"Clip":Mr=(0,Pr.glslClip)(Dr.clipMin,Dr.clipMax);break;default:return{activationFunction:"",applyActivation:""}}const Fr=Mr.name;return{activationFunction:Mr.body,applyActivation:`value = ${Fr}_(value);`}},Tr.parseInternalActivationAttributes=Dr=>{const Mr=Dr.getString("activation","");if(Mr==="Clip"){const[Fr,zr]=Dr.getFloats("activation_params",[Rr.MIN_CLIP,Rr.MAX_CLIP]);return{activation:Mr,clipMax:zr,clipMin:Fr,activationCacheKey:`${Mr}:${Fr},${zr}`}}return{activation:Mr,activationCacheKey:Mr}}},6149:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.parseGatherAttributes=Tr.gather=void 0;const Rr=Ar(4910),Pr=Ar(6145),Dr=Ar(7273),Mr=Ar(5639);Tr.gather=(Gr,Nr,Lr)=>(jr(Nr,Lr.axis),[Gr.run(zr(Gr,Nr,Lr),Nr)]),Tr.parseGatherAttributes=Gr=>(0,Rr.createAttributeWithCacheKey)({axis:Gr.attributes.getInt("axis",0)});const Fr={name:"Gather",inputNames:["A","B"],inputTypes:[Mr.TextureType.unpacked,Mr.TextureType.unpacked]},zr=(Gr,Nr,Lr)=>{const Ur=Object.assign(Object.assign({},Fr),{cacheHint:Lr.cacheKey});return Object.assign(Object.assign({},Ur),{get:()=>((Vr,Wr,qr,Kr)=>{const Xr=qr[0].dims.slice(),Zr=qr[1].dims.slice(),_i=new Array(Xr.length+Zr.length-1);Kr=Dr.ShapeUtil.normalizeAxis(Kr,Xr.length);const Jr=[];for(let ts=0;ts<_i.length;ts++)ts<Kr?(_i[ts]=Xr[ts],Jr.push(`inputIdx[${ts}] = outputIdx[${ts}];`)):ts<Kr+Zr.length?(_i[ts]=Zr[ts-Kr],Jr.push(`indexDataIdx[${ts-Kr}] = outputIdx[${ts}];`)):(_i[ts]=Xr[ts-Zr.length+1],Jr.push(`inputIdx[${ts-Zr.length+1}] = outputIdx[${ts}];`));const es=`
      float process(int outputIdx[${_i.length||1}]) {
        int inputIdx[${Xr.length}];
        int indexDataIdx[${Zr.length||1}];
        indexDataIdx[0] = 0;
        ${Jr.join(`
        `)}
        int idx = int(_B(indexDataIdx));
        inputIdx[${Kr}] = idx < 0 ? idx + ${Xr[Kr]} : idx;
        return _A(inputIdx);
      }`;return Object.assign(Object.assign({},Wr),{output:{dims:_i,type:qr[0].type,textureType:Mr.TextureType.unpacked},shaderSource:es})})(0,Ur,Nr,Lr.axis)})},jr=(Gr,Nr)=>{if(!Gr||Gr.length!==2)throw new Error("Gather requires 2 inputs.");const Lr=Gr[0].dims.length;if(Lr<1)throw new Error("Invalid input shape.");if(Nr<-Lr||Nr>Lr-1)throw new Error("Invalid axis.");if(Pr.NUMBER_TYPES.indexOf(Gr[0].type)===-1)throw new Error("Invaid input type.");if(Gr[1].type!=="int32"&&Gr[1].type!=="int16")throw new Error("Invaid input type.")}},5378:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.parseGemmAttributesV11=Tr.parseGemmAttributesV7=Tr.gemm=void 0;const Rr=Ar(4910),Pr=Ar(7273),Dr=Ar(5639);Tr.gemm=(Gr,Nr,Lr)=>(jr(Nr,Lr),[Gr.run(Fr(Nr,Lr),Nr)]);const Mr=(Gr,Nr)=>{const Lr=Gr.attributes.getInt("transA",0)!==0,Ur=Gr.attributes.getInt("transB",0)!==0,Vr=Gr.attributes.getFloat("alpha",1),Wr=Gr.attributes.getFloat("beta",1);return(0,Rr.createAttributeWithCacheKey)({transA:Lr,transB:Ur,alpha:Vr,beta:Wr,isOptionalC:Nr})};Tr.parseGemmAttributesV7=Gr=>Mr(Gr,!1),Tr.parseGemmAttributesV11=Gr=>Mr(Gr,!0);const Fr=(Gr,Nr)=>{const Lr={name:"Gemm",inputNames:Gr.length===3?["A","B","C"]:["A","B"],inputTypes:Gr.length===3?[Dr.TextureType.unpacked,Dr.TextureType.unpacked,Dr.TextureType.unpacked]:[Dr.TextureType.unpacked,Dr.TextureType.unpacked],key:Nr.cacheKey};return Object.assign(Object.assign({},Lr),{get:()=>zr(Lr,Gr,Nr)})},zr=(Gr,Nr,Lr)=>{const Ur=Nr[0].dims.slice(),Vr=Nr[1].dims.slice(),[Wr,qr]=Pr.GemmUtil.getShapeOfGemmResult(Ur,Lr.transA,Vr,Lr.transB,Nr.length===3?Nr[2].dims:void 0),Kr=[Wr,qr];if(!Kr)throw new Error("Can't use gemm on the given tensors");let Xr=Ur[Ur.length-1],Zr="";Lr.transA&&(Xr=Ur[0]),Lr.transA&&Lr.transB?Zr="value += _A_T(a) * _B_T(b);":Lr.transA&&!Lr.transB?Zr="value += _A_T(a) * _B(b);":!Lr.transA&&Lr.transB?Zr="value += _A(a) * _B_T(b);":Lr.transA||Lr.transB||(Zr="value += _A(a) * _B(b);");const _i=Kr.length,Jr=`
      float process(int indices[${_i}]) {
          int a[${_i}];
          int b[${_i}];
          ${Nr.length===3?`int c[${Nr[2].dims.length}];`:""}

          copyVec(indices, a);
          copyVec(indices, b);
          ${Nr.length===3?"bcastIndices_C(indices, c);":""}

          float value = 0.0;
          for (int k=0; k<${Xr}; ++k) {
              a[${_i-1}] = k;
              b[${_i-2}] = k;
              ${Zr}
          }

          value = value * alpha;
          ${Nr.length===3?"value += beta * _C(c);":""}
          return value;
      }`;return Object.assign(Object.assign({},Gr),{output:{dims:Kr,type:Nr[0].type,textureType:Dr.TextureType.unpacked},variables:[{name:"alpha",type:"float",data:Lr.alpha},{name:"beta",type:"float",data:Lr.beta}],shaderSource:Jr})},jr=(Gr,Nr)=>{if(!Gr)throw new Error("Input is missing");if(Nr.isOptionalC&&(Gr.length<2||Gr.length>3))throw new Error("Invaid input shape.");if(!Nr.isOptionalC&&Gr.length!==3)throw new Error("Gemm requires 3 inputs");if(Gr.length===3&&Gr[2].dims.length!==1&&Gr[2].dims.length!==2)throw new Error("Invalid input shape of C");if(Gr[0].type!=="float32"&&Gr[0].type!=="float64"||Gr[1].type!=="float32"&&Gr[1].type!=="float64"||Gr.length===3&&Gr[2].type!=="float32"&&Gr[2].type!=="float64")throw new Error("Invalid input type.");if(Gr[0].type!==Gr[1].type||Gr.length===3&&Gr[0].type!==Gr[2].type)throw new Error("Input types are mismatched")}},5950:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.createPackedIm2ColProgramInfoLoader=void 0;const Rr=Ar(6757),Pr=Ar(5639),Dr=Ar(5614);Tr.createPackedIm2ColProgramInfoLoader=(Mr,Fr,zr,jr,Gr)=>{const Nr=(Lr=Gr.cacheKey,{name:"Im2Col (packed)",inputNames:["A"],inputTypes:[Pr.TextureType.packed],cacheHint:Lr});var Lr;return Object.assign(Object.assign({},Nr),{get:()=>((Ur,Vr,Wr,qr,Kr,Xr)=>{const Zr=Wr.dims,_i=qr.dims,Jr=Kr.length,es=[_i[1]*_i[2]*_i[3],Kr[2]*Kr[3]],ts=_i[2]*_i[3],is=(0,Dr.unpackFromChannel)(),rs=(0,Rr.getGlsl)(Ur.session.backend.glContext.version);let as="";for(let fs=0;fs<=1;fs++)for(let Ts=0;Ts<=1;Ts++)as+=`
            blockIndex = rc.x + ${Ts};
            pos = rc.y + ${fs};

            if(blockIndex < ${es[1]} && pos < ${es[0]}) {
              offsetY = int(blockIndex / (${Kr[Jr-1]})) * ${Xr.strides[0]} -
                ${Xr.pads[0]};
              d0 = offsetY + ${Xr.dilations[0]} * (imod(pos, ${ts}) / ${_i[2]});

              if(d0 < ${Zr[2]} && d0 >= 0) {
                offsetX = imod(blockIndex, ${Kr[Jr-1]}) * ${Xr.strides[1]} -
                  ${Xr.pads[1]};
                d1 = offsetX + ${Xr.dilations[1]} * imod(imod(pos, ${ts}), ${_i[2]});

                if(d1 < ${Zr[3]} && d1 >= 0) {

                  ch = int(float(pos)/ ${ts}.);
                    innerDims = vec2(d0, d1);
                    result[${2*fs+Ts}] = getChannel(
                      getA(0, ch, int(innerDims.x),
                      int(innerDims.y)), innerDims);
                }
              }
            }

          `;const ls=`
      ${is}

      void main() {
        ivec2 rc = getOutputCoords();
          vec4 result = vec4(0.0);
          int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
          vec2 innerDims;
          ${as}
          ${rs.output} = result;
      }
            `;return Object.assign(Object.assign({},Vr),{output:{dims:es,type:Wr.type,textureType:Pr.TextureType.packed},shaderSource:ls,hasMain:!0})})(Mr,Nr,Fr,zr,jr,Gr)})}},1625:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.calculateIm2ColDims=Tr.createIm2ColProgramInfoLoader=void 0;const Rr=Ar(5639);Tr.createIm2ColProgramInfoLoader=(Pr,Dr,Mr,Fr,zr)=>{const jr=(Gr=zr.cacheKey,{name:"Im2Col",inputNames:["X"],inputTypes:[Rr.TextureType.unpacked],cacheHint:Gr});var Gr;return Object.assign(Object.assign({},jr),{get:()=>((Nr,Lr,Ur,Vr,Wr,qr)=>{const Kr=Ur.dims,Xr=Vr.dims,Zr=Wr.length,_i=(0,Tr.calculateIm2ColDims)(Kr,Xr,Wr,4),Jr=`
        const int XC = ${Kr[1]};
        const int XH = ${Kr[2]};
        const int XW = ${Kr[3]};
        const int KH = ${qr.kernelShape[0]};
        const int KW = ${qr.kernelShape[1]};
        const int dilationH = ${qr.dilations[0]};
        const int dilationW = ${qr.dilations[1]};
        const int strideH = ${qr.strides[0]};
        const int strideW = ${qr.strides[1]};
        const int padH = ${qr.pads[0]};
        const int padW = ${qr.pads[1]};
        const int KHKW = KH*KW;
        const int XCKHKW = XC * KHKW;
        const int outputChannels = 4;
        vec4 process(int indices[${Zr}]) {
          int b  = indices[0]; // batch size
          int oh = indices[1] * strideH - padH; //output height
          int ow = indices[2] * strideW - padW; //output width
          int p = indices[3] * outputChannels; //patch
          vec4 value = vec4(0.0);
          for(int i=0; i < outputChannels; ++i) {
            if(p < XCKHKW) {
              int patchC = p / KHKW;
              int patchH = (p - patchC*KHKW) / KW;
              int patchW = (p - patchC*KHKW) - patchH * KW;
              int xh2 = oh + patchH * dilationH;
              int xw2 = ow + patchW * dilationW;
              int x[${Kr.length}];
              x[0] = b;
              x[1] = patchC;
              x[2] = xh2;
              x[3] = xw2;
              if(xh2 >= 0 &&
                  xh2 < XH &&
                  xw2 >= 0 &&
                  xw2 < XW) {
                value[i] = _X(x);
              }
            }
            ++p;
          }
          return value;
        }
        `;return Object.assign(Object.assign({},Lr),{output:{dims:_i,type:Ur.type,textureType:Rr.TextureType.packedLastDimension},shaderSource:Jr})})(0,jr,Dr,Mr,Fr,zr)})},Tr.calculateIm2ColDims=(Pr,Dr,Mr,Fr=4)=>[Mr[0],Mr[2],Mr[3],Math.ceil(Pr[1]*Dr[2]*Dr[3]/Fr)]},6981:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.parseImageScalerAttributes=Tr.imageScaler=void 0;const Rr=Ar(4910),Pr=Ar(5639);Tr.imageScaler=(jr,Gr,Nr)=>(zr(Gr),[jr.run(Mr(jr,Gr,Nr),Gr)]),Tr.parseImageScalerAttributes=jr=>{const Gr=jr.attributes.getFloat("scale"),Nr=jr.attributes.getFloats("bias");return(0,Rr.createAttributeWithCacheKey)({scale:Gr,bias:Nr})};const Dr={name:"ImageScaler",inputNames:["X"],inputTypes:[Pr.TextureType.unpacked]},Mr=(jr,Gr,Nr)=>{const Lr=Object.assign(Object.assign({},Dr),{cacheHint:Nr.cacheKey});return Object.assign(Object.assign({},Lr),{get:()=>((Ur,Vr,Wr,qr)=>{const Kr=Wr[0].dims.slice(),Xr=Kr.length,Zr=`
      ${Fr(qr.bias.length)}
      float process(int indices[${Xr}]) {
        return _X(indices) * scale + getBias(bias, indices[1]);
      }`;return Object.assign(Object.assign({},Vr),{output:{dims:Kr,type:Wr[0].type,textureType:Pr.TextureType.unpacked},variables:[{name:"bias",type:"float",arrayLength:qr.bias.length,data:qr.bias},{name:"scale",type:"float",data:qr.scale}],shaderSource:Zr})})(0,Lr,Gr,Nr)})},Fr=jr=>{const Gr=[`float getBias(float bias[${jr}], int channel) {`];for(let Nr=0;Nr<jr;++Nr)Nr===0?Gr.push(`	if (channel == ${Nr}) { return bias[${Nr}]; }`):Nr===jr-1?Gr.push(`	else { return bias[${Nr}]; }`):Gr.push(`	else if (channel == ${Nr}) { return bias[${Nr}]; }`);return Gr.push("	}"),Gr.join(`
`)},zr=jr=>{if(!jr||jr.length!==1)throw new Error("ImageScaler requires 1 input.");if(jr[0].dims.length!==4)throw new Error("Invalid input shape.");if(jr[0].type!=="float32"&&jr[0].type!=="float64")throw new Error("Invalid input type.")}},7413:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.parseInstanceNormalizationAttributes=Tr.instanceNormalization=void 0;const Rr=Ar(6757),Pr=Ar(5639);Tr.instanceNormalization=(Gr,Nr,Lr)=>{jr(Nr);const Ur=Gr.run(Mr(Nr[0]),Nr);return[Gr.run(zr(Gr,Nr[0],Lr,Ur.dims),[Nr[0],Ur,Nr[1],Nr[2]])]},Tr.parseInstanceNormalizationAttributes=Gr=>Gr.attributes.getFloat("epsilon",1e-5);const Dr={name:"InstanceNormalization_MeanAndVariance",inputNames:["X"],inputTypes:[Pr.TextureType.unpacked]},Mr=Gr=>Object.assign(Object.assign({},Dr),{get:()=>((Nr,Lr)=>{const Ur=Lr.dims.slice(),Vr=Ur[1],Wr=Ur[2]*Ur[3],qr=[Ur[0],Vr],Kr=`
      vec4 process(int[2] indices) {
        vec4 v = vec4(0.0);
        int a[4];
        a[0] = indices[0];
        a[1] = indices[1];
        float temp = 0.0;
        for(int a2=0; a2<${Ur[2]}; a2++) {
          a[2] = a2;
          for(int a3=0; a3<${Ur[3]}; a3++) {
            a[3] = a3;
            float x = _X(a);
            temp += x;
          }
        }
        float mean = temp / float(${Wr});
        temp = 0.0;
        for(int a2=0; a2<${Ur[2]}; a2++) {
          a[2] = a2;
          for(int a3=0; a3<${Ur[3]}; a3++) {
            a[3] = a3;
            float x = _X(a);
            temp += (x - mean) * (x - mean);
          }
        }
        v.r = mean;
        v.g = temp / float(${Wr});

        return v;
      }`;return Object.assign(Object.assign({},Nr),{output:{dims:qr,type:Lr.type,textureType:Pr.TextureType.packedLastDimension},shaderSource:Kr})})(Dr,Gr)}),Fr={name:"InstanceNormalization_ComputeOutput",inputNames:["X","MeanAndVariance","Scale","B"],inputTypes:[Pr.TextureType.unpacked,Pr.TextureType.packedLastDimension,Pr.TextureType.unpacked,Pr.TextureType.unpacked]},zr=(Gr,Nr,Lr,Ur)=>{const Vr=Object.assign(Object.assign({},Fr),{cacheHint:`${Lr}`});return Object.assign(Object.assign({},Vr),{get:()=>((Wr,qr,Kr,Xr,Zr)=>{const _i=(0,Rr.getGlsl)(Wr.session.backend.glContext.version),[Jr,es]=Wr.calculateTextureWidthAndHeight(Zr,Pr.TextureType.packedLastDimension),[ts,is]=[Jr/4,es],rs=`
      vec4 get_MeanAndVariance(int[2] mv) {
        int offset = indicesToOffset_MeanAndVariance(mv);
        vec2 coords = offsetToCoords(offset, ${ts}, ${is});
        return ${_i.texture2D}(MeanAndVariance, coords);
      }

      float process(int[4] indices) {
        int mv[2];
        mv[0] = indices[0];
        mv[1] = indices[1];
        vec4 mean_and_variance = get_MeanAndVariance(mv);
        float mean = mean_and_variance.r;
        float variance = mean_and_variance.g;

        int sb[1];
        sb[0] = indices[1];
        float scale = _Scale(sb);
        float b = _B(sb);

        return scale * (_X(indices) - mean) / sqrt(variance + epsilon) + b;
      }`;return Object.assign(Object.assign({},qr),{output:{dims:Kr.dims,type:Kr.type,textureType:Pr.TextureType.unpacked},variables:[{name:"epsilon",type:"float",data:Xr}],shaderSource:rs})})(Gr,Vr,Nr,Lr,Ur)})},jr=Gr=>{if(!Gr||Gr.length!==3)throw new Error("InstanceNormalization requires 3 inputs.");const Nr=Gr[0],Lr=Gr[1],Ur=Gr[2];if(Nr.dims.length<3||Lr.dims.length!==1||Ur.dims.length!==1)throw new Error("Invalid input shape.");if(Lr.dims[0]!==Nr.dims[1]||Ur.dims[0]!==Nr.dims[1])throw new Error("Input shapes are mismatched.");if(Nr.type!=="float32"&&Nr.type!=="float64"||Lr.type!=="float32"&&Lr.type!=="float64"||Ur.type!=="float32"&&Ur.type!=="float64")throw new Error("Invalid input type.");if(Gr[0].dims.length!==4)throw new Error("Only support 4-D input shape.")}},7006:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.createLrnProgramInfoLoader=Tr.parseLrnAttributes=Tr.lrn=void 0;const Rr=Ar(4910),Pr=Ar(5639);Tr.lrn=(zr,jr,Gr)=>(Fr(jr),[zr.run(Mr(jr,Gr),jr)]),Tr.parseLrnAttributes=zr=>{const jr=zr.attributes.getFloat("alpha",1e-4),Gr=zr.attributes.getFloat("beta",.75),Nr=zr.attributes.getFloat("bias",1),Lr=zr.attributes.getInt("size");return(0,Rr.createAttributeWithCacheKey)({alpha:jr,beta:Gr,bias:Nr,size:Lr})};const Dr={name:"LRN",inputNames:["X"],inputTypes:[Pr.TextureType.unpacked]};function Mr(zr,jr){return Object.assign(Object.assign({},Dr),{cacheHint:jr.cacheKey,get:()=>function(Gr,Nr){const Lr=Gr[0].dims[1],Ur=Gr[0].dims.length,Vr=-Math.floor((Nr.size-1)/2),Wr=Math.ceil((Nr.size-1)/2),qr=`float(${Nr.alpha}) / float(${Nr.size})`,Kr=`
    float process(int indices[${Ur}]) {
        int c = indices[1];
        float x = _X(indices);
        float square_sum = 0.0;

        for (int i = ${Vr}; i <= ${Wr}; i++) {
          int idx = c + i;
          if (c >= 0 && c < ${Lr}) {
            indices[1] = idx;
            float j = _X(indices);
            square_sum += j * j;
          }
        }
        return x / pow(float(${Nr.bias}) + ${qr} * square_sum, float(${Nr.beta}));
    }`;return Object.assign(Object.assign({},Dr),{cacheHint:Nr.cacheKey,output:{dims:Gr[0].dims,type:Gr[0].type,textureType:Pr.TextureType.unpacked},shaderSource:Kr})}(zr,jr)})}Tr.createLrnProgramInfoLoader=Mr;const Fr=zr=>{if(!zr||zr.length!==1)throw new Error("LRN requires 1 input.");if(zr[0].dims.length!==4)throw new Error('currently only support LRN for input with "NCHW" format');if(zr[0].type!=="float32")throw new Error("input should be float type")}},5632:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.createPackedMatmulProgramInfoLoader=void 0;const Rr=Ar(7273),Pr=Ar(6757),Dr=Ar(5639),Mr=Ar(432),Fr=Ar(2150),zr=Ar(8276);Tr.createPackedMatmulProgramInfoLoader=(jr,Gr,Nr)=>{const Lr=(Ur=Gr.length>2,Vr=Nr.activationCacheKey,{name:"MatMul (packed)",inputNames:Ur?["A","B","Bias"]:["A","B"],inputTypes:Ur?[Dr.TextureType.packed,Dr.TextureType.packed,Dr.TextureType.packed]:[Dr.TextureType.packed,Dr.TextureType.packed],cacheHint:Vr});var Ur,Vr;return Object.assign(Object.assign({},Lr),{get:()=>((Wr,qr,Kr,Xr)=>{const Zr=Kr.length>2,_i=Zr?"value += getBiasForMatmul();":"",Jr=Kr[0].dims,es=Kr[1].dims,ts=Rr.BroadcastUtil.calcShape(Jr,es,!0),is=!Rr.ShapeUtil.areEqual(Kr[0].dims,Kr[1].dims);if(!ts)throw new Error("Can't use matmul on the given tensors");const rs=Jr[Jr.length-1],as=Math.ceil(rs/2),ls=Jr.length,fs=es.length,Ts=(0,Pr.getGlsl)(Wr.session.backend.glContext.version),$s=(0,Mr.getCoordsDataType)(ts.length),xs=ts.length,ys=(0,Mr.getGlChannels)(),{activationFunction:ps,applyActivation:vs}=(0,Fr.getActivationSnippet)(Xr),Ds=Zr?`${(0,zr.getBiasForMatmul)($s,ys,Kr[2].dims,ts,!0)}`:"",js=is?`${function(Qs,no,yo,Js){let lo=[],vo=[];const Ro=yo[0].dims,Co=yo[1].dims,Do=Ro.length,ds=Co.length,Os=Js.length,Ws=Os-Do,to=Os-ds;lo=Ro.map((Uo,Io)=>`coords.${no[Io+Ws]}`),lo[Do-1]="i*2",lo.join(", "),vo=Co.map((Uo,Io)=>`coords.${no[Io+to]}`),vo[ds-2]="i*2",vo.join(", ");const io=Rr.BroadcastUtil.getBroadcastDims(Ro,Js),ko=Rr.BroadcastUtil.getBroadcastDims(Co,Js),go=io.map(Uo=>`coords.${no[Uo+Ws]} = 0;`).join(`
`),To=ko.map(Uo=>`coords.${no[Uo+to]} = 0;`).join(`
`),Ho=`int lastDim = coords.${no[Os-1]};
  coords.${no[Os-1]} = coords.${no[Os-2]};
  coords.${no[Os-2]} = lastDim;`;return`
vec4 getAAtOutCoordsMatmul(int i) {
  ${Qs} coords = getOutputCoords();
  ${Ho}
  ${go}
  vec4 outputValue = getA(${lo});
  return outputValue;
}

vec4 getBAtOutCoordsMatmul(int i) {
  ${Qs} coords = getOutputCoords();
  ${Ho}
  ${To}
  vec4 outputValue = getB(${vo});
  return outputValue;
}`}($s,ys,Kr,ts)}`:"",zs=is?"getAAtOutCoordsMatmul(i)":`getA(${function(Qs,no){let yo="";for(let Js=0;Js<no-2;Js++)yo+=`rc.${Qs[Js]}, `;return yo+=`rc.${Qs[no-2]}, i*2`,yo}(ys,ls)})`,qs=is?"getBAtOutCoordsMatmul(i)":`getB(${function(Qs,no){let yo="";for(let Js=0;Js<no-2;Js++)yo+=`rc.${Qs[Js]}, `;return yo+=`i*2, rc.${Qs[no-1]}`,yo}(ys,fs)})`,fo=`
            ${js}
            ${Ds}
            ${ps}
            void main() {
              ${is?"":`${$s} rc =
          getOutputCoords(); int lastDim = rc.${ys[xs-1]}; rc.${ys[xs-1]} =
          rc.${ys[xs-2]}; rc.${ys[xs-2]} = lastDim;
      `}

              vec4 value = vec4(0);
              for (int i = 0; i < ${as}; i++) {
                vec4 a = ${zs};
                vec4 b = ${qs};

                value += (a.rrbb * b.rgrg);
                value += (a.ggaa * b.baba);
              }
              ${_i}
              ${vs}
              ${Ts.output} = value;
            }`;return Object.assign(Object.assign({},qr),{output:{dims:ts,type:Kr[0].type,textureType:Dr.TextureType.packed},shaderSource:fo,hasMain:!0})})(jr,Lr,Gr,Nr)})}},8276:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.getBiasForMatmul=Tr.createMatmulProgramInfoLoader=Tr.parseMatMulAttributes=Tr.matMul=void 0;const Rr=Ar(7273),Pr=Ar(5639),Dr=Ar(432),Mr=Ar(2150),Fr=Ar(5632);Tr.matMul=(Lr,Ur,Vr)=>(Gr(Ur),Lr.session.pack?[Lr.run((0,Fr.createPackedMatmulProgramInfoLoader)(Lr,Ur,Vr),Ur)]:[Lr.run(jr(Ur,Vr),Ur)]),Tr.parseMatMulAttributes=Lr=>(0,Mr.parseInternalActivationAttributes)(Lr.attributes);const zr=(Lr,Ur)=>({name:"MatMul",inputNames:Lr?["A","B","Bias"]:["A","B"],inputTypes:Lr?[Pr.TextureType.unpacked,Pr.TextureType.unpacked,Pr.TextureType.unpacked]:[Pr.TextureType.unpacked,Pr.TextureType.unpacked],cacheHint:Ur});function jr(Lr,Ur){const Vr=zr(Lr.length>2,Ur.activationCacheKey);return Object.assign(Object.assign({},Vr),{get:()=>function(Wr,qr,Kr){const Xr=qr[0].dims,Zr=qr[1].dims,_i=Rr.BroadcastUtil.calcShape(Xr,Zr,!0);if(!_i)throw new Error("Can't use matmul on the given tensors");const Jr=(0,Dr.getCoordsDataType)(_i.length),es=(0,Dr.getGlChannels)(),{activationFunction:ts,applyActivation:is}=(0,Mr.getActivationSnippet)(Kr),rs=qr.length>2,as=rs?"value += getBiasForMatmul();":"",ls=rs?`${Nr(Jr,es,qr[2].dims,_i,!1)}`:"",fs=_i.length,Ts=Xr.length,$s=Zr.length,xs=`
    ${ts}
    ${ls}
    float process(int indices[${fs}]) {
        int a[${Ts}];
        int b[${$s}];
        bcastMatmulIndices_A(indices, a);
        bcastMatmulIndices_B(indices, b);

        float value;
        for (int k=0; k<${Xr[Xr.length-1]}; ++k) {
            a[${Ts-1}] = k;
            b[${$s-2}] = k;
            value += _A(a) * _B(b);
        }
        ${as}
        ${is}
        return value;
    }`;return Object.assign(Object.assign({},Wr),{output:{dims:_i,type:qr[0].type,textureType:Pr.TextureType.unpacked},shaderSource:xs})}(Vr,Lr,Ur)})}Tr.createMatmulProgramInfoLoader=jr;const Gr=Lr=>{if(!Lr||Lr.length!==2)throw new Error("MatMul requires 2 inputs.");if(Lr[0].dims[Lr[0].dims.length-1]!==Lr[1].dims[Lr[1].dims.length-2])throw new Error("shared dimension does not match.");if(Lr[0].type!=="float32"&&Lr[0].type!=="float64"||Lr[1].type!=="float32"&&Lr[1].type!=="float64")throw new Error("inputs should be float type");if(Lr[0].type!==Lr[1].type)throw new Error("inputs types should match")};function Nr(Lr,Ur,Vr,Wr,qr){let Kr="";const Xr=Vr.length,Zr=Wr.length,_i=Zr-Xr;Kr=Zr<2&&Xr>0?"coords":Vr.map((ts,is)=>`coords.${Ur[is+_i]}`).join(", ");const Jr=Rr.BroadcastUtil.getBroadcastDims(Vr,Wr).map(ts=>`coords.${Ur[ts+_i]} = 0;`).join(`
`);let es="vec4(outputValue.xx, outputValue.yy)";return Rr.ShapeUtil.size(Vr)===1&&(es="vec4(outputValue.x)"),qr?`
vec4 getBiasForMatmul() {
  ${Lr} coords = getOutputCoords();
  ${Jr}
  vec4 outputValue = getBias(${Kr});
  return ${es};
}`:`
float getBiasForMatmul() {
  ${Lr} coords = getOutputCoords();
  ${Jr}
  return getBias(coords.x);
}`}Tr.getBiasForMatmul=Nr},9:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.createPackProgramInfoLoader=void 0;const Rr=Ar(6757),Pr=Ar(5639),Dr=Ar(432),Mr=Ar(5614),Fr={name:"pack",inputNames:["A"],inputTypes:[Pr.TextureType.unpackedReversed]};Tr.createPackProgramInfoLoader=(zr,jr)=>Object.assign(Object.assign({},Fr),{get:()=>((Gr,Nr)=>{const Lr=(0,Rr.getGlsl)(Gr.session.backend.glContext.version),Ur=Nr.dims,Vr=Ur.length,Wr=Nr.dims.length,qr=(0,Dr.getCoordsDataType)(Wr),Kr=(0,Mr.getChannels)("rc",Wr),Xr=(Zr=Wr,_i=Kr,Jr=Ur[Ur.length-2],es=Ur[Ur.length-1],Zr===0||Zr===1?"":`
    int r = ${_i[Zr-2]};
    int c = ${_i[Zr-1]};
    int rp1 = ${_i[Zr-2]} + 1;
    int cp1 = ${_i[Zr-1]} + 1;
    bool rEdge = rp1 >= ${es};
    bool cEdge = cp1 >= ${Jr};
    `);var Zr,_i,Jr,es;let ts;ts=Vr===0?[1,1]:Vr===1?[Ur[0],1]:[Ur[Wr-1],Ur[Wr-2]];const is=function(ls,fs,Ts){if(ls===0)return"false";if(ls===1)return`rc > ${fs[0]}`;let $s="";for(let xs=ls-2;xs<ls;xs++)$s+=`${Ts[xs]} >= ${fs[xs-ls+2]}`,xs<ls-1&&($s+="||");return $s}(Wr,ts,Kr),rs=function(ls,fs){const Ts=ls.length;if(Ts===0)return"getA(), 0, 0, 0";if(Ts===1)return`getA(rc),
            rc + 1 >= ${ls[0]} ? 0. : getA(rc + 1),
            0, 0`;let $s="";if(Ts>2)for(let xs=0;xs<Ts-2;++xs)$s+=`${fs[xs]},`;return`getA(${$s}r, c),
          rEdge ? 0. : getA(${$s}rp1, c),
          cEdge ? 0. : getA(${$s}r, cp1),
          rEdge || cEdge ? 0. : getA(${$s}rp1, cp1)`}(Ur,Kr),as=`
        void main() {
          ${qr} rc = getOutputCoords();

          if(${is}) {
            ${Lr.output} = vec4(0);
          } else {
            ${Xr}

            ${Lr.output} = vec4(${rs});
          }
        }
      `;return Object.assign(Object.assign({},Fr),{hasMain:!0,output:{dims:Nr.dims,type:Nr.type,textureType:Pr.TextureType.packed},shaderSource:as})})(zr,jr)})},5614:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.unpackFromChannel=Tr.getChannels=Tr.getVecChannels=void 0;const Rr=Ar(432);function Pr(Dr,Mr){return(0,Rr.getGlChannels)(Mr).map(Fr=>`${Dr}.${Fr}`)}Tr.getVecChannels=Pr,Tr.getChannels=function(Dr,Mr){return Mr===1?[Dr]:Pr(Dr,Mr)},Tr.unpackFromChannel=function(){return`
    float getChannel(vec4 frag, int dim) {
      int modCoord = imod(dim, 2);
      return modCoord == 0 ? frag.r : frag.g;
    }

    float getChannel(vec4 frag, vec2 innerDims) {
      vec2 modCoord = mod(innerDims, 2.);
      return modCoord.x == 0. ?
        (modCoord.y == 0. ? frag.r : frag.g) :
        (modCoord.y == 0. ? frag.b : frag.a);
    }
  `}},5565:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.parsePadAttributesV11=Tr.padV11=Tr.parsePadAttributesV2=Tr.padV2=void 0;const Rr=Ar(4910),Pr=Ar(7273),Dr=Ar(6757),Mr=Ar(5639),Fr={name:"Pad",inputNames:["A"],inputTypes:[Mr.TextureType.unpacked]};Tr.padV2=(qr,Kr,Xr)=>(Gr(Kr),[qr.run(Object.assign(Object.assign({},Fr),{cacheHint:Xr.cacheKey,get:()=>jr(qr,Kr[0],Xr)}),Kr)]),Tr.parsePadAttributesV2=qr=>{const Kr=qr.attributes.getString("mode","constant"),Xr=qr.attributes.getFloat("value",0),Zr=qr.attributes.getInts("pads");return(0,Rr.createAttributeWithCacheKey)({mode:Kr,value:Xr,pads:Zr})},Tr.padV11=(qr,Kr,Xr)=>{Nr(Kr);const Zr=zr(qr,Kr,Xr);return(0,Tr.padV2)(qr,[Kr[0]],Zr)},Tr.parsePadAttributesV11=qr=>qr.attributes.getString("mode","constant");const zr=(qr,Kr,Xr)=>{if(!qr.session.isInitializer(Kr[1].dataId)||Kr.length>=3&&!qr.session.isInitializer(Kr[2].dataId))throw new Error("dynamic pad attributes are not allowed");const Zr=Array.from(Kr[1].integerData),_i=Kr.length>=3?Kr[2].floatData[0]:0;return(0,Rr.createAttributeWithCacheKey)({mode:Xr,pads:Zr,value:_i})},jr=(qr,Kr,Xr)=>{const Zr=Pr.ShapeUtil.padShape(Kr.dims.slice(),Xr.pads),_i=Zr.length,Jr=`
      ${Lr(qr,Kr,Xr)}
      float process(int[${_i}] indices) {
          return padA(indices);
      }`;return{name:"Pad",inputNames:["A"],inputTypes:[Mr.TextureType.unpacked],output:{dims:Zr,type:Kr.type,textureType:Mr.TextureType.unpacked},shaderSource:Jr}},Gr=qr=>{if(!qr||qr.length!==1)throw new Error("Pad requires 1 input");if(qr[0].type!=="float32"&&qr[0].type!=="float64")throw new Error("Invalid input type.")},Nr=qr=>{if(!qr||qr.length!==2&&qr.length!==3)throw new Error("Pad requires 2 or 3 inputs");if(qr[1].type!=="int32")throw new Error("Invalid input type.");if(qr.length>=3&&qr[2].type==="string")throw new Error("Invalid input type.")},Lr=(qr,Kr,Xr)=>{const Zr=(0,Dr.getGlsl)(qr.session.backend.glContext.version),[_i,Jr]=qr.calculateTextureWidthAndHeight(Kr.dims,Mr.TextureType.unpacked),es=Pr.ShapeUtil.computeStrides(Kr.dims);switch(Xr.mode){case"constant":return Ur(Zr,Kr.dims,es,_i,Jr,Xr.pads,Xr.value);case"reflect":return Vr(Zr,Kr.dims,es,_i,Jr,Xr.pads);case"edge":return Wr(Zr,Kr.dims,es,_i,Jr,Xr.pads);default:throw new Error("Invalid mode")}},Ur=(qr,Kr,Xr,Zr,_i,Jr,es)=>{const ts=Kr.length;let is="";for(let rs=ts-1;rs>=0;--rs)is+=`
        k = m[${rs}] - ${Jr[rs]};
        if (k < 0)  return constant;
        if (k >= ${Kr[rs]}) return constant;
        offset += k * ${Xr[rs]};
        `;return`
      float padA(int m[${ts}]) {
        const float constant = float(${es});
        int offset = 0;
        int k = 0;
        ${is}
        vec2 coords = offsetToCoords(offset, ${Zr}, ${_i});
        float value = getColorAsFloat(${qr.texture2D}(A, coords));
        return value;
      }
      `},Vr=(qr,Kr,Xr,Zr,_i,Jr)=>{const es=Kr.length;let ts="";for(let is=es-1;is>=0;--is)ts+=`
        k = m[${is}] - ${Jr[is]};
        if (k < 0) { k = -k; }
        {
          const int _2n_1 = ${2*(Kr[is]-1)};
          k = int( mod( float(k), float(_2n_1) ) ) ;
          if(k >= ${Kr[is]}) { k = _2n_1 - k; }
        }
        offset += k * ${Xr[is]};
        `;return`
      float padA(int m[${es}]) {
        int offset = 0;
        int k = 0;
        ${ts}
        vec2 coords = offsetToCoords(offset, ${Zr}, ${_i});
        float value = getColorAsFloat(${qr.texture2D}(A, coords));
        return value;
      }
      `},Wr=(qr,Kr,Xr,Zr,_i,Jr)=>{const es=Kr.length;let ts="";for(let is=es-1;is>=0;--is)ts+=`
        k = m[${is}] - ${Jr[is]};
        if (k < 0)  k = 0;
        if (k >= ${Kr[is]}) k = ${Kr[is]-1};
        offset += k * ${Xr[is]};
      `;return`
      float padA(int m[${es}]) {
        int offset = 0;
        int k = 0;
        ${ts}
        vec2 coords = offsetToCoords(offset, ${Zr}, ${_i});
        float value = getColorAsFloat(${qr.texture2D}(A, coords));
        return value;
      }
      `}},2834:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.globalMaxPool=Tr.parseMaxPoolAttributes=Tr.maxPool=Tr.parseGlobalAveragePoolAttributes=Tr.globalAveragePool=Tr.parseAveragePoolAttributes=Tr.averagePool=void 0;const Rr=Ar(4910),Pr=Ar(7273),Dr=Ar(5639);Tr.averagePool=(Wr,qr,Kr)=>{Nr(qr);const Xr={name:"AveragePool",inputNames:["X"],inputTypes:[Dr.TextureType.unpacked],cacheHint:Kr.cacheKey};return[Wr.run(Object.assign(Object.assign({},Xr),{get:()=>Mr(qr,Xr,!1,Kr)}),qr)]},Tr.parseAveragePoolAttributes=Wr=>{const qr=Wr.attributes.getString("auto_pad","NOTSET"),Kr=Wr.attributes.getInt("ceil_mode",0),Xr=Wr.attributes.getInt("count_include_pad",0)!==0,Zr=Wr.attributes.getInts("kernel_shape"),_i=Wr.attributes.getInts("strides",[]),Jr=Wr.attributes.getInts("pads",[]);if(Kr!==0)throw new Error("using ceil() in shape computation is not yet supported for AveragePool");return(0,Rr.createAttributeWithCacheKey)({autoPad:qr,ceilMode:Kr,countIncludePad:Xr,kernelShape:Zr,strides:_i,pads:Jr})};const Mr=(Wr,qr,Kr,Xr)=>{const[Zr,_i]=zr(Wr,Xr,Kr),Jr=Pr.ShapeUtil.size(Zr.kernelShape);let es="";Zr.countIncludePad?es+=`value /= float(${Jr});`:es+=`value /= float(${Jr} - pad);`;const ts=`
        ${Lr(Wr[0].dims,Zr,"value += _X(x);",es,"0.0")}
      `;return Object.assign(Object.assign({},qr),{output:{dims:_i,type:Wr[0].type,textureType:Dr.TextureType.unpacked},shaderSource:ts})};Tr.globalAveragePool=(Wr,qr,Kr)=>{Nr(qr);const Xr={name:"GlobalAveragePool",inputNames:["X"],inputTypes:[Dr.TextureType.unpacked],cacheHint:`${Kr.countIncludePad}`};return[Wr.run(Object.assign(Object.assign({},Xr),{get:()=>Mr(qr,Xr,!0,Kr)}),qr)]},Tr.parseGlobalAveragePoolAttributes=Wr=>{const qr=Wr.attributes.getInt("count_include_pad",0)!==0;return(0,Rr.createAttributeWithCacheKey)({autoPad:"",ceilMode:0,countIncludePad:qr,kernelShape:[],strides:[],pads:[]})},Tr.maxPool=(Wr,qr,Kr)=>{Nr(qr);const Xr={name:"MaxPool",inputNames:["X"],inputTypes:[Dr.TextureType.unpacked],cacheHint:Kr.cacheKey};return[Wr.run(Object.assign(Object.assign({},Xr),{get:()=>Fr(qr,Xr,!1,Kr)}),qr)]},Tr.parseMaxPoolAttributes=Wr=>{const qr=Wr.attributes.getString("auto_pad","NOTSET"),Kr=Wr.attributes.getInt("ceil_mode",0),Xr=Wr.attributes.getInts("kernel_shape"),Zr=Wr.attributes.getInts("strides",[]),_i=Wr.attributes.getInts("pads",[]),Jr=Wr.attributes.getInt("storage_order",0),es=Wr.attributes.getInts("dilations",[]);if(Jr!==0)throw new Error("column major storage order is not yet supported for MaxPool");if(Kr!==0)throw new Error("using ceil() in shape computation is not yet supported for MaxPool");return(0,Rr.createAttributeWithCacheKey)({autoPad:qr,ceilMode:Kr,countIncludePad:!1,kernelShape:Xr,strides:Zr,pads:_i,storageOrder:Jr,dilations:es})};const Fr=(Wr,qr,Kr,Xr)=>{const[Zr,_i]=zr(Wr,Xr,Kr),Jr=`
      ${Lr(Wr[0].dims,Zr,`
      value = max(_X(x), value);
    `,"","-1e5")}
    `;return Object.assign(Object.assign({},qr),{output:{dims:_i,type:Wr[0].type,textureType:Dr.TextureType.unpacked},shaderSource:Jr})},zr=(Wr,qr,Kr)=>{const Xr=Wr[0].dims.slice(),Zr=Object.hasOwnProperty.call(qr,"dilations"),_i=qr.kernelShape.slice(),Jr=qr.strides.slice(),es=Zr?qr.dilations.slice():[],ts=qr.pads.slice();Pr.PoolConvUtil.adjustPoolAttributes(Kr,Xr,_i,Jr,es,ts);const is=Pr.PoolConvUtil.computePoolOutputShape(Kr,Xr,Jr,es,_i,ts,qr.autoPad),rs=Object.assign({},qr);return Zr?Object.assign(rs,{kernelShape:_i,strides:Jr,pads:ts,dilations:es,cacheKey:qr.cacheKey}):Object.assign(rs,{kernelShape:_i,strides:Jr,pads:ts,cacheKey:qr.cacheKey}),[rs,is]},jr={autoPad:"",ceilMode:0,countIncludePad:!1,kernelShape:[],strides:[],pads:[],storageOrder:0,dilations:[],cacheKey:""},Gr={name:"GlobalMaxPool",inputNames:["X"],inputTypes:[Dr.TextureType.unpacked]};Tr.globalMaxPool=(Wr,qr)=>(Nr(qr),[Wr.run(Object.assign(Object.assign({},Gr),{get:()=>Fr(qr,Gr,!0,jr)}),qr)]);const Nr=Wr=>{if(!Wr||Wr.length!==1)throw new Error("Pool ops requires 1 input.");if(Wr[0].type!=="float32"&&Wr[0].type!=="float64")throw new Error("Invalid input type.")},Lr=(Wr,qr,Kr,Xr,Zr)=>{const _i=Wr.length;if(qr.kernelShape.length<=2){const Jr=qr.kernelShape[qr.kernelShape.length-1],es=qr.strides[qr.strides.length-1],ts=qr.pads[qr.pads.length/2-1],is=qr.pads[qr.pads.length-1],rs=Wr[_i-1];let as="",ls="",fs="";if(as=ts+is!==0?`
          for (int i = 0; i < ${Jr}; i++) {
            x[${_i} - 1] = indices[${_i} - 1] * ${es} - ${ts} + i;
            if (x[${_i} - 1] < 0 || x[${_i} - 1] >= ${rs}) {
              pad++;
              continue;
            }
            ${Kr}
          }`:`
          for (int i = 0; i < ${Jr}; i++) {
            x[${_i} - 1] = indices[${_i} - 1] * ${es} - ${ts} + i;
            ${Kr}
          }`,qr.kernelShape.length===2){const Ts=qr.kernelShape[qr.kernelShape.length-2],$s=qr.strides[qr.strides.length-2],xs=qr.pads[qr.pads.length/2-2],ys=qr.pads[qr.pads.length-2],ps=Wr[_i-2];ls=xs+ys!==0?`
            for (int j = 0; j < ${Ts}; j++) {
              x[${_i} - 2] = indices[${_i} - 2] * ${$s} - ${xs} + j;
              if (x[${_i} - 2] < 0 || x[${_i} - 2] >= ${ps}) {
                pad+= ${Jr};
                continue;
              }
          `:`
            for (int j = 0; j < ${Ts}; j++) {
              x[${_i} - 2] = indices[${_i} - 2] * ${$s} - ${xs} + j;
            `,fs=`
          }
        `}return`
        float process(int indices[${_i}]) {
          int x[${_i}];
          copyVec(indices, x);

          float value = ${Zr};
          int pad = 0;
          ${ls}
          ${as}
          ${fs}
          ${Xr}
          return value;
        }
      `}{const Jr=Pr.ShapeUtil.size(qr.kernelShape),es=Pr.ShapeUtil.computeStrides(qr.kernelShape),ts=es.length,is=qr.pads.length,rs=Vr(ts),as=Ur(Wr,"inputDims"),ls=Ur(qr.pads,"pads"),fs=Ur(es,"kernelStrides"),Ts=Ur(qr.strides,"strides");let $s="";return $s=qr.pads.reduce((xs,ys)=>xs+ys)?`
            if (x[j] >= inputDims[j] || x[j] < 0) {
              pad++;
              isPad = true;
              break;
            }
          }
          if (!isPad) {
            ${Kr}
          }`:`
          }
          ${Kr}
        `,`
        ${rs}
        float process(int indices[${_i}]) {
          int x[${_i}];
          copyVec(indices, x);
          int offset[${ts}];
          int pads[${is}];
          int inputDims[${_i}];
          int kernelStrides[${ts}];
          int strides[${ts}];
          ${ls}
          ${as}
          ${Ts}
          ${fs}

          float value = ${Zr};
          int pad = 0;
          bool isPad = false;
          for (int i = 0; i < ${Jr}; i++) {
            offsetToIndices(i, kernelStrides, offset);
            isPad = false;
            for (int j = ${_i} - ${ts}; j < ${_i}; j++) {
              x[j] = indices[j] * strides[j - ${_i} + ${ts}]
                + offset[j - ${_i} + ${ts}] - pads[j - 2];
              ${$s}
          }
          ${Xr}

          return value;
        }
      `}},Ur=(Wr,qr)=>{let Kr="";for(let Xr=0;Xr<Wr.length;Xr++)Kr+=`
      ${qr}[${Xr}] = ${Wr[Xr]};
    `;return Kr},Vr=Wr=>`
  void offsetToIndices(int offset, int[${Wr}] strides, out int[${Wr}] indices) {
    if (${Wr} == 0) {
      return;
    }
    for (int i = 0; i < ${Wr} - 1; ++i) {
      indices[i] = offset / strides[i];
      offset -= indices[i] * strides[i];
    }
    indices[${Wr} - 1] = offset;
  }`},1010:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.reduceLogSumSquare=Tr.reduceLogSum=Tr.reduceProd=Tr.reduceMin=Tr.reduceMax=Tr.reduceMean=Tr.reduceSum=Tr.parseReduceAttributes=void 0;const Rr=Ar(4910),Pr=Ar(6145),Dr=Ar(7273),Mr=Ar(5639),Fr=(Gr,Nr,Lr,Ur,Vr)=>{jr(Nr);const Wr={name:Ur,inputNames:["A"],inputTypes:[Mr.TextureType.unpacked]};return[Gr.run(Object.assign(Object.assign({},Wr),{cacheHint:Lr.cacheKey,get:()=>zr(Gr,Nr,Lr,Ur,Vr,Wr)}),Nr)]};Tr.parseReduceAttributes=Gr=>{const Nr=Gr.attributes.getInts("axes",[]),Lr=Gr.attributes.getInt("keepdims",1)===1;return(0,Rr.createAttributeWithCacheKey)({axes:Nr,keepDims:Lr})};const zr=(Gr,Nr,Lr,Ur,Vr,Wr)=>{const qr=[],Kr=Nr[0].dims.length||1,Xr=[],Zr=Dr.ShapeUtil.normalizeAxes(Lr.axes,Nr[0].dims.length),_i=Vr(Nr,Zr);let Jr=_i[1];for(let ts=0;ts<Nr[0].dims.length;ts++)Zr.indexOf(ts)>=0||Zr.length===0?(Lr.keepDims&&qr.push(1),Jr=`
          for(int j${ts} = 0; j${ts} < ${Nr[0].dims[ts]}; j${ts}++) {
            inputIdx[${ts}] = j${ts};
            ${Jr}
          }`):(Xr.push(`inputIdx[${ts}] = outputIdx[${qr.length}];`),qr.push(Nr[0].dims[ts]));const es=`
      float process(int outputIdx[${qr.length||1}]) {
        float value;                 // final result
        int inputIdx[${Kr}];      // addressing input data
        ${Xr.join(`
`)}
        ${_i[0]}       // init ops for reduce max/min
        ${Jr}
        ${_i[2]}       // final computation for reduce mean
        return value;
      }`;return Object.assign(Object.assign({},Wr),{output:{dims:qr,type:Nr[0].type,textureType:Mr.TextureType.unpacked},shaderSource:es})},jr=Gr=>{if(!Gr||Gr.length!==1)throw new Error("Reduce op requires 1 input.");if(Pr.NUMBER_TYPES.indexOf(Gr[0].type)===-1)throw new Error("Invalid input type.")};Tr.reduceSum=(Gr,Nr,Lr)=>Fr(Gr,Nr,Lr,"ReduceSum",()=>["value = 0.0;","value += _A(inputIdx);",""]),Tr.reduceMean=(Gr,Nr,Lr)=>Fr(Gr,Nr,Lr,"ReduceMean",(Ur,Vr)=>{let Wr=1;for(let qr=0;qr<Ur[0].dims.length;qr++)(Vr.indexOf(qr)>=0||Vr.length===0)&&(Wr*=Ur[0].dims[qr]);return["value = 0.0;","value += _A(inputIdx);",`value /= ${Wr}.;`]}),Tr.reduceMax=(Gr,Nr,Lr)=>Fr(Gr,Nr,Lr,"ReduceMax",(Ur,Vr)=>{const Wr=[];for(let qr=0;qr<Ur[0].dims.length;qr++)(Vr.indexOf(qr)>=0||Vr.length===0)&&Wr.push(`inputIdx[${qr}] = 0;`);return[`${Wr.join(`
`)}
value = _A(inputIdx);`,"value = max(value, _A(inputIdx));",""]}),Tr.reduceMin=(Gr,Nr,Lr)=>Fr(Gr,Nr,Lr,"ReduceMin",(Ur,Vr)=>{const Wr=[];for(let qr=0;qr<Ur[0].dims.length;qr++)(Vr.indexOf(qr)>=0||Vr.length===0)&&Wr.push(`inputIdx[${qr}] = 0;`);return[`${Wr.join(`
`)}
value = _A(inputIdx);`,"value = min(value, _A(inputIdx));",""]}),Tr.reduceProd=(Gr,Nr,Lr)=>Fr(Gr,Nr,Lr,"ReduceProd",()=>["value = 1.0;","value *= _A(inputIdx);",""]),Tr.reduceLogSum=(Gr,Nr,Lr)=>Fr(Gr,Nr,Lr,"ReduceLogSum",()=>["value = 0.0;","value += _A(inputIdx);","value = log(value);"]),Tr.reduceLogSumSquare=(Gr,Nr,Lr)=>Fr(Gr,Nr,Lr,"ReduceLogSumSquare",()=>["float t; value = 0.0;","t = _A(inputIdx); value += t * t;",""])},7379:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.isReshapeCheap=Tr.processDims3D=Tr.createPackedReshape3DProgramInfoLoader=void 0;const Rr=Ar(7273),Pr=Ar(6757),Dr=Ar(5639),Mr=Ar(5614);Tr.createPackedReshape3DProgramInfoLoader=(Fr,zr,jr)=>{const Gr=(Nr=>({name:"Reshape (packed)",inputTypes:[Dr.TextureType.packed],inputNames:["A"],cacheHint:`${Nr}`}))(jr);return Object.assign(Object.assign({},Gr),{get:()=>((Nr,Lr,Ur,Vr)=>{const Wr=Lr.dims,qr=Vr;let Kr="";for(let _i=0;_i<4;_i++){let Jr="";switch(_i){case 0:Jr="outputCoords = rc;";break;case 1:Jr="outputCoords = ivec3(rc.x, rc.y+1, rc.z);";break;case 2:Jr="outputCoords = ivec3(rc.x, rc.y, rc.z+1);";break;case 3:Jr="outputCoords = ivec3(rc.x, rc.y+1, rc.z+1);";break;default:throw new Error}Kr+=`
        ${Jr}
        ${_i>0?"if(outputCoords.y < rows && outputCoords.z < cols){":""}
          int flattenedIndex = getFlattenedIndex(outputCoords);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flattenedIndex);
          vec2 innerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${_i}] = getChannel(getA(inputRC.x, inputRC.y, inputRC.z), innerDims);

        ${_i>0?"}":""}
      `}const Xr=(0,Pr.getGlsl)(Nr.session.backend.glContext.version),Zr=`
      ${function(_i){const Jr=Rr.ShapeUtil.computeStrides(_i),es=["b","r","c"],ts="index";return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${Jr.map((is,rs)=>`int ${es[rs]} = ${ts} / ${is}; ${rs===Jr.length-1?`int ${es[rs+1]} = ${ts} - ${es[rs]} * ${is}`:`index -= ${es[rs]} * ${is}`};`).join("")}
      return ivec3(b, r, c);
    }
  `}(Wr)}
      ${function(_i){const Jr=Rr.ShapeUtil.computeStrides(_i);return`
  int getFlattenedIndex(ivec3 coords) {
    // reverse y, z order
    return coords.x * ${Jr[0]} + coords.z * ${Jr[1]} + coords.y;
  }
`}(qr)}
      ${(0,Mr.unpackFromChannel)()}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.0);

        ivec3 outputCoords;
        int rows = ${qr[2]};
        int cols = ${qr[1]};

        ${Kr}
        ${Xr.output} = result;
      }
    `;return Object.assign(Object.assign({},Ur),{output:{dims:qr,type:Lr.type,textureType:Dr.TextureType.packed},shaderSource:Zr,hasMain:!0})})(Fr,zr,Gr,jr)})},Tr.processDims3D=function(Fr){if(Fr.length===0)return[1,1,1];let zr=1;for(let jr=0;jr<Fr.length-2;++jr)zr*=Fr[jr];return[zr,Fr.length>1?Fr[Fr.length-2]:1,Fr[Fr.length-1]]},Tr.isReshapeCheap=function(Fr,zr){let jr=!1;return jr=Fr.length===0||zr.length===0||(Fr.length<2||zr.length<2?Fr[Fr.length-1]===zr[zr.length-1]:Fr[Fr.length-1]===zr[zr.length-1]&&Fr[Fr.length-2]===zr[zr.length-2]),jr}},8126:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.reshape=void 0;const Rr=Ar(7273);Tr.reshape=(Pr,Dr)=>{const Mr=Rr.ShapeUtil.calculateReshapedDims(Dr[0].dims,Dr[1].integerData);return Pr.session.pack?[Pr.reshapePacked(Dr[0],Mr)]:[Pr.reshapeUnpacked(Dr[0],Mr)]}},2801:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.parseResizeAttributesV11=Tr.parseResizeAttributesV10=Tr.resize=void 0;const Rr=Ar(6757),Pr=Ar(5639),Dr=Ar(432),Mr=Ar(5614),Fr=Ar(3980),zr={name:"Resize",inputNames:["A"],inputTypes:[Pr.TextureType.packed]};Tr.resize=(Ur,Vr,Wr)=>((0,Fr.validateInputs)(Vr,Wr),[Ur.run(Object.assign(Object.assign({},zr),{cacheHint:Wr.cacheKey,get:()=>jr(Ur,Vr,Wr)}),Vr)]),Tr.parseResizeAttributesV10=Ur=>(0,Fr.parseUpsampleAttributes)(Ur,10),Tr.parseResizeAttributesV11=Ur=>(0,Fr.parseUpsampleAttributes)(Ur,11);const jr=(Ur,Vr,Wr)=>{const qr=(0,Rr.getGlsl)(Ur.session.backend.glContext.version),[Kr,Xr]=Gr(Vr,Wr);if(Kr.every($s=>$s===1)&&Wr.coordinateTransformMode!=="tf_crop_and_resize")return Object.assign(Object.assign({},zr),{output:{dims:Xr,type:Vr[0].type,textureType:Pr.TextureType.packed},hasMain:!0,shaderSource:`void main() {
                    vec4 v = ${qr.texture2D}(X, TexCoords);
                    ${qr.output} = v;
                }`});const Zr=Xr.length;if(Zr<2)throw new Error(`output dimension should be at least 2, but got ${Zr}`);const _i=Xr[Zr-2],Jr=Xr[Zr-1],es=Vr[0].dims;if(Zr!==es.length)throw new Error(`output dimension should match input ${es.length}, but got ${Zr}`);const ts=es[Zr-2],is=es[Zr-1],rs=Kr[Zr-2],as=Kr[Zr-1];let ls="";if(Wr.mode!=="linear")throw new Error(`resize (packed) does not support mode: '${Wr.mode}'`);switch(Wr.coordinateTransformMode){case"asymmetric":ls=`
                    vec4 getSourceFracIndex(ivec4 coords) {
                        return vec4(coords) / scaleWHWH;
                    }
                `;break;case"half_pixel":ls=`
                    vec4 getSourceFracIndex(ivec4 coords) {
                        return (vec4(coords) + 0.5) / scaleWHWH - 0.5;
                    }
                `;break;case"pytorch_half_pixel":ls=`
                    vec4 getSourceFracIndex(ivec4 coords) {
                        vec4 fcoords = vec4(coords);
                        return vec4(
                            ${Jr}.0 > 1.0 ? (fcoords.x + 0.5) / scaleWHWH.x - 0.5 : 0.0,
                            ${_i}.0 > 1.0 ? (fcoords.y + 0.5) / scaleWHWH.y - 0.5 : 0.0,
                            ${Jr}.0 > 1.0 ? (fcoords.z + 0.5) / scaleWHWH.z - 0.5 : 0.0,
                            ${_i}.0 > 1.0 ? (fcoords.w + 0.5) / scaleWHWH.w - 0.5 : 0.0
                          );
                    }
                `;break;case"align_corners":ls=`
                    vec4 getSourceFracIndex(ivec4 coords) {
                        vec4 resized = vec4(${Jr}.0 - 1.0, ${_i}.0 - 1.0, ${Jr}.0 - 1.0,
                            ${_i}.0 - 1.0);
                        vec4 original = vec4(${is}.0 - 1.0, ${ts}.0 - 1.0, ${is}.0 - 1.0,
                            ${ts}.0 - 1.0);
                        vec4 new_scale = original / resized;
                        return vec4(coords) * new_scale;
                    }
                `;break;default:throw new Error(`resize (packed) does not support coordinateTransformMode:                                 '${Wr.coordinateTransformMode}'`)}const fs=(0,Dr.getCoordsDataType)(Zr),Ts=`
            const vec2 inputWH = vec2(${ts}.0, ${is}.0);
            const vec4 scaleWHWH = vec4(float(${rs}), float(${as}), float(${rs}), float(${as}));
            ${(0,Mr.unpackFromChannel)()}
            ${ls}
            float getAValue(int x10, int r, int c, int d) {
                return getChannel(getA(x10, r, c, d), vec2(c, d));
            }
            void main() {
                ${fs} rc = getOutputCoords();

                int batch = rc[0];
                int depth = rc[1];

                // retrieve the 4 coordinates that is used in the 4 packed output values.
                ivec4 coords = ivec4(rc.wz, rc.w + 1, rc.z + 1);

                // calculate the source index in fraction
                vec4 sourceFrac = getSourceFracIndex(coords);

                // get the lower and upper bound of the 4 values that will be packed into one texel.
                ivec4 x00 = ivec4(max(sourceFrac.xy, vec2(0.0)), min(inputWH - 1.0, ceil(sourceFrac.xy)));
                ivec4 x01 = ivec4(max(sourceFrac.xw, vec2(0.0)), min(inputWH - 1.0, ceil(sourceFrac.xw)));
                ivec4 x10 = ivec4(max(sourceFrac.zy, vec2(0.0)), min(inputWH - 1.0, ceil(sourceFrac.zy)));
                ivec4 x11 = ivec4(max(sourceFrac.zw, vec2(0.0)), min(inputWH - 1.0, ceil(sourceFrac.zw)));

                bool hasNextRow = rc.w < ${_i-1};
                bool hasNextCol = rc.z < ${Jr-1};

                // pack x00, x01, x10, x11's top-left corner into one vec4 structure
                vec4 topLeft = vec4(
                    getAValue(batch, depth, x00.x, x00.y),
                    hasNextCol ? getAValue(batch, depth, x01.x, x01.y) : 0.0,
                    hasNextRow ? getAValue(batch, depth, x10.x, x10.y) : 0.0,
                    (hasNextRow && hasNextCol) ? getAValue(batch, depth, x11.x, x11.y) : 0.0);

                // pack x00, x01, x10, x11's top-right corner into one vec4 structure
                vec4 topRight = vec4(
                    getAValue(batch, depth, x00.x, x00.w),
                    hasNextCol ? getAValue(batch, depth, x01.x, x01.w) : 0.0,
                    hasNextRow ? getAValue(batch, depth, x10.x, x10.w) : 0.0,
                    (hasNextRow && hasNextCol) ? getAValue(batch, depth, x11.x, x11.w) : 0.0);

                // pack x00, x01, x10, x11's bottom-left corner into one vec4 structure
                vec4 bottomLeft = vec4(
                    getAValue(batch, depth, x00.z, x00.y),
                    hasNextCol ? getAValue(batch, depth, x01.z, x01.y) : 0.0,
                    hasNextRow ? getAValue(batch, depth, x10.z, x10.y) : 0.0,
                    (hasNextRow && hasNextCol) ? getAValue(batch, depth, x11.z, x11.y) : 0.0);

                // pack x00, x01, x10, x11's bottom-right corner into one vec4 structure
                vec4 bottomRight = vec4(
                    getAValue(batch, depth, x00.z, x00.w),
                    hasNextCol ? getAValue(batch, depth, x01.z, x01.w) : 0.0,
                    hasNextRow ? getAValue(batch, depth, x10.z, x10.w) : 0.0,
                    (hasNextRow && hasNextCol) ? getAValue(batch, depth, x11.z, x11.w) : 0.0);

                // calculate the interpolation fraction on u and v direction
                vec4 frac = vec4(sourceFrac) - floor(sourceFrac);
                vec4 clampFrac = clamp(frac, vec4(0.0), vec4(1.0));

                vec4 top = mix(topLeft, topRight, clampFrac.ywyw);
                vec4 bottom = mix(bottomLeft, bottomRight, clampFrac.ywyw);
                vec4 newValue = mix(top, bottom, clampFrac.xxzz);

                ${qr.output} = vec4(newValue);
            }
        `;return Object.assign(Object.assign({},zr),{output:{dims:Xr,type:Vr[0].type,textureType:Pr.TextureType.packed},hasMain:!0,shaderSource:Ts})},Gr=(Ur,Vr)=>{const Wr=Ur[0].dims;let qr,Kr=Vr.scales;if(Kr.length===0){const Zr=Ur[Vr.scalesInputIdx];if(Zr&&Zr.size!==0){if(Ur[Vr.sizesInputIdx])throw new Error("Only one of scales or sizes must be provided as input.");Kr=Nr(Zr,Vr.mode,Vr.isResize)}else{const _i=Ur[Vr.sizesInputIdx];if(!_i||_i.size===0)throw new Error("Either scales or sizes MUST be provided as input.");qr=Array.from(_i.integerData),Kr=Lr(qr,Wr,Vr.mode,Vr.isResize)}}else if(Ur[Vr.sizesInputIdx])throw new Error("Only one of scales or sizes must be provided as input.");const Xr=qr||Wr.map((Zr,_i)=>Math.floor(Zr*Kr[_i]));return[Kr,Xr]},Nr=(Ur,Vr,Wr)=>{const qr=Array.from(Ur.floatData);return(0,Fr.scalesValidation)(qr,Vr,Wr),qr},Lr=(Ur,Vr,Wr,qr)=>{const Kr=Vr.length,Xr=new Array(Kr);for(let Zr=0,_i=Kr;Zr<_i;Zr++)if(Vr[Zr]===0){if(Ur[Zr]!==0)throw new Error("Input dim is zero but required output dim is non-zero.");Xr[Zr]=1}else Xr[Zr]=Ur[Zr]/Vr[Zr];return(0,Fr.scalesValidation)(Xr,Wr,qr),Xr}},565:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.shape=void 0;const Rr=Ar(9240);Tr.shape=(Dr,Mr)=>(Pr(Mr),[new Rr.Tensor([Mr[0].dims.length],"int32",void 0,void 0,new Int32Array(Mr[0].dims))]);const Pr=Dr=>{if(!Dr||Dr.length!==1)throw new Error("Shape requires 1 input.")}},2444:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.sliceV10=Tr.parseSliceAttributes=Tr.slice=void 0;const Rr=Ar(4910),Pr=Ar(6145),Dr=Ar(7273),Mr=Ar(5639),Fr={name:"Slice",inputNames:["A"],inputTypes:[Mr.TextureType.unpacked]};Tr.slice=(Lr,Ur,Vr)=>(jr(Ur),[Lr.run(Object.assign(Object.assign({},Fr),{cacheHint:Vr.cacheKey,get:()=>zr(Lr,Ur[0],Vr)}),Ur)]),Tr.parseSliceAttributes=Lr=>{const Ur=Lr.attributes.getInts("starts"),Vr=Lr.attributes.getInts("ends"),Wr=Lr.attributes.getInts("axes",[]);return(0,Rr.createAttributeWithCacheKey)({starts:Ur,ends:Vr,axes:Wr})};const zr=(Lr,Ur,Vr)=>{const Wr=Vr.axes.length===0?Ur.dims.slice(0).map((es,ts)=>ts):Vr.axes,qr=Dr.ShapeUtil.normalizeAxes(Wr,Ur.dims.length),Kr=Vr.starts.map((es,ts)=>es>Ur.dims[qr[ts]]-1?Ur.dims[qr[ts]]:Dr.ShapeUtil.normalizeAxis(es,Ur.dims[qr[ts]])),Xr=Vr.ends.map((es,ts)=>es>Ur.dims[qr[ts]]-1?Ur.dims[qr[ts]]:Dr.ShapeUtil.normalizeAxis(es,Ur.dims[qr[ts]])),Zr=Ur.dims.slice(),_i=[];for(let es=0;es<qr.length;es++)Zr[qr[es]]=Xr[es]-Kr[es],Kr[es]>0&&_i.push(`outputIdx[${qr[es]}] += ${Kr[es]};`);const Jr=`
      float process(int outputIdx[${Zr.length}]) {
        ${_i.join(`
      `)}
        return _A(outputIdx);
      }`;return Object.assign(Object.assign({},Fr),{output:{dims:Zr,type:Ur.type,textureType:Mr.TextureType.unpacked},shaderSource:Jr})},jr=Lr=>{if(!Lr||Lr.length!==1)throw new Error("Slice requires 1 input.");if(Pr.NUMBER_TYPES.indexOf(Lr[0].type)===-1)throw new Error("Invalid input type.")};Tr.sliceV10=(Lr,Ur)=>{Nr(Ur);const Vr=Gr(Lr,Ur);return[Lr.run(Object.assign(Object.assign({},Fr),{cacheHint:Vr.cacheKey,get:()=>zr(Lr,Ur[0],Vr)}),[Ur[0]])]};const Gr=(Lr,Ur)=>{if(!Lr.session.isInitializer(Ur[1].dataId)||!Lr.session.isInitializer(Ur[2].dataId)||Ur.length>=4&&!Lr.session.isInitializer(Ur[3].dataId)||Ur.length>=5&&!Lr.session.isInitializer(Ur[4].dataId))throw new Error("dynamic slice attributes are not allowed");if(Ur.length>=5&&Ur[4].integerData.some(Kr=>Kr!==1))throw new Error("currently non-1 steps is not supported for Slice");const Vr=Array.from(Ur[1].integerData),Wr=Array.from(Ur[2].integerData),qr=Ur.length>=4?Array.from(Ur[3].integerData):[];return{starts:Vr,ends:Wr,axes:qr,cacheKey:`${qr};${Vr};${Wr}`}},Nr=Lr=>{if(!Lr||Lr.length<3||Lr.length>5)throw new Error("Invalid input number.");if(Lr[1].type!=="int32"||Lr[1].dims.length!==1)throw new Error("Invalid input type.");if(Lr[2].type!=="int32"||Lr[2].dims.length!==1)throw new Error("Invalid input type.");if(Lr.length>=4&&(Lr[3].type!=="int32"||Lr[3].dims.length!==1))throw new Error("Invalid input type.");if(Lr.length>=5&&(Lr[4].type!=="int32"||Lr[4].dims.length!==1))throw new Error("Invalid input type.")}},815:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.softmaxV13=Tr.parseSoftmaxAttributesV13=Tr.parseSoftmaxAttributes=Tr.softmax=void 0;const Rr=Ar(4910),Pr=Ar(7273),Dr=Ar(6757),Mr=Ar(5639),Fr=Ar(5707),zr={name:"SoftmaxComputeMax",inputNames:["A"],inputTypes:[Mr.TextureType.unpacked]},jr={name:"SoftmaxComputeScale",inputNames:["A","Max"],inputTypes:[Mr.TextureType.unpacked,Mr.TextureType.unpacked]},Gr={name:"SoftMax",inputNames:["A","Max","Norm"],inputTypes:[Mr.TextureType.unpacked,Mr.TextureType.unpacked,Mr.TextureType.unpacked]};Tr.softmax=(qr,Kr,Xr)=>{Wr(Kr);const Zr=Kr[0].dims.slice(),_i=Pr.ShapeUtil.normalizeAxis(Xr.axis,Zr.length),Jr=Pr.ShapeUtil.sizeToDimension(Zr,_i),es=Pr.ShapeUtil.sizeFromDimension(Zr,_i);return Nr(qr,Kr,Xr,Jr,es)},Tr.parseSoftmaxAttributes=qr=>(0,Rr.createAttributeWithCacheKey)({axis:qr.attributes.getInt("axis",1)}),Tr.parseSoftmaxAttributesV13=qr=>(0,Rr.createAttributeWithCacheKey)({axis:qr.attributes.getInt("axis",-1)}),Tr.softmaxV13=(qr,Kr,Xr)=>{Wr(Kr);const Zr=Kr[0].dims.slice(),_i=Pr.ShapeUtil.normalizeAxis(Xr.axis,Zr.length),Jr=Zr.length,es=_i!==Jr-1,ts=[];let is,rs=[],as=[];es&&(rs=Array.from({length:Jr}).map(($s,xs)=>xs),rs[_i]=Jr-1,rs[Jr-1]=_i,rs.map($s=>ts.push(Zr[$s])),is=(0,Rr.createAttributeWithCacheKey)({perm:rs}),as=(0,Fr.transpose)(qr,Kr,is));const ls=es?Pr.ShapeUtil.sizeToDimension(ts,Jr-1):Pr.ShapeUtil.sizeToDimension(Zr,Jr-1),fs=es?Pr.ShapeUtil.sizeFromDimension(ts,Jr-1):Pr.ShapeUtil.sizeFromDimension(Zr,Jr-1),Ts=Nr(qr,es?as:Kr,Xr,ls,fs);return es?(0,Fr.transpose)(qr,Ts,is):Ts};const Nr=(qr,Kr,Xr,Zr,_i)=>{const Jr=Lr(qr,Kr[0],Zr,_i,[Zr]),es=qr.run(Object.assign(Object.assign({},zr),{cacheHint:Xr.cacheKey,get:()=>Jr}),Kr),ts=Ur(qr,Kr[0],Zr,_i,Jr.output.dims,[Zr]),is=qr.run(Object.assign(Object.assign({},jr),{cacheHint:Xr.cacheKey,get:()=>ts}),[Kr[0],es]),rs=Vr(qr,Kr[0],Zr,_i,Jr.output.dims,ts.output.dims);return[qr.run(Object.assign(Object.assign({},Gr),{cacheHint:Xr.cacheKey,get:()=>rs}),[Kr[0],es,is])]},Lr=(qr,Kr,Xr,Zr,_i)=>{const[Jr,es]=qr.calculateTextureWidthAndHeight(Kr.dims,Mr.TextureType.unpacked),ts=_i.length;if(Xr<1||Zr<1)throw new Error("Logical row count N and feature count D must be greater than or equal to 1");if(_i.length!==1)throw new Error("Dimensionality of the output should be 1");if(_i[0]!==Xr)throw new Error("Shape of the output should be equal to logical row count");const is=(0,Dr.getGlsl)(qr.session.backend.glContext.version),rs=`
      float process(int[${ts}] indices) {
        int logical_row_start_offset = indices[0] * ${Zr};

        float max = getColorAsFloat(${is.texture2D}(A, offsetToCoords(logical_row_start_offset, ${Jr},
        ${es} )));
        for(int i=1; i<${Zr}; ++i)
        {
          float current = getColorAsFloat(${is.texture2D}(A, offsetToCoords(logical_row_start_offset + i,
            ${Jr}, ${es})));
          if(current > max)
          max = current;
        }

        return max;
      }`;return Object.assign(Object.assign({},zr),{output:{dims:_i,type:Kr.type,textureType:Mr.TextureType.unpacked},shaderSource:rs})},Ur=(qr,Kr,Xr,Zr,_i,Jr)=>{const[es,ts]=qr.calculateTextureWidthAndHeight(Kr.dims,Mr.TextureType.unpacked),is=Jr.length;if(Xr<1||Zr<1)throw new Error("Logical row count N and feature count D must be greater than or equal to 1");if(Jr.length!==1)throw new Error("Dimensionality of the output should be 1");if(Jr[0]!==Xr)throw new Error("Shape of the output should be equal to logical row count");if(_i.length!==1)throw new Error("Dimensionality of the intermediate results should be 1");if(_i[0]!==Xr)throw new Error("Shape of the intermediate results should be equal to logical row count");const rs=`
      float process(int[${is}] indices) {
        int logical_row_start_offset = indices[0] * ${Zr};

        float norm_factor = 0.0;
        float max = _Max(indices);
        for(int i=0; i<${Zr}; ++i)
        {
          norm_factor += exp(getColorAsFloat(${(0,Dr.getGlsl)(qr.session.backend.glContext.version).texture2D}(A, offsetToCoords(logical_row_start_offset + i,
            ${es}, ${ts}))) - max);
        }

        return norm_factor;
      }`;return Object.assign(Object.assign({},jr),{output:{dims:Jr,type:Kr.type,textureType:Mr.TextureType.unpacked},shaderSource:rs})},Vr=(qr,Kr,Xr,Zr,_i,Jr)=>{const[es,ts]=qr.calculateTextureWidthAndHeight(Kr.dims,Mr.TextureType.unpacked),is=Kr.dims.length;if(Xr<1||Zr<1)throw new Error("Logical row count N and feature count D must be greater than or equal to 1");if(_i.length!==1||Jr.length!==1)throw new Error("Dimensionality of the intermediate results should be 1");if(_i[0]!==Xr||Jr[0]!==Xr)throw new Error("Shape of the intermediate results should be equal to logical row count");const rs=`
      float process(int[${is}] indices) {

      // get offset of current logical tensor index from the 2-D texture coordinates (TexCoords)
      int offset = coordsToOffset(TexCoords, ${es}, ${ts});

      //determine the logical row for this index
      int logical_row_index[1];
      logical_row_index[0] = offset / ${Zr};

      float norm_factor = _Norm(logical_row_index);

      // avoid possible division by 0
      // if norm_facor is 0, all elements are zero
      // if so, return 0
      if(norm_factor == 0.0)
        return 0.0;

      return exp(_A(indices) - _Max(logical_row_index)) / norm_factor;
    }`;return Object.assign(Object.assign({},Gr),{output:{dims:Kr.dims,type:Kr.type,textureType:Mr.TextureType.unpacked},shaderSource:rs})},Wr=qr=>{if(!qr||qr.length!==1)throw new Error("Softmax requires 1 input.");if(qr[0].type!=="float32"&&qr[0].type!=="float64")throw new Error("Invalid input type")}},564:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.parseSplitAttributes=Tr.split=void 0;const Rr=Ar(4910),Pr=Ar(7273),Dr=Ar(5639),Mr={name:"Split",inputNames:["A"],inputTypes:[Dr.TextureType.unpacked]};Tr.split=(Gr,Nr,Lr)=>{jr(Nr);const Ur=Pr.ShapeUtil.normalizeAxis(Lr.axis,Nr[0].dims.length),Vr=Fr(Gr,Nr,Ur,Lr),Wr=[];for(let qr=0;qr<Vr;++qr)Wr.push(Gr.run(Object.assign(Object.assign({},Mr),{cacheHint:`${Lr.cacheKey};${qr}`,get:()=>zr(Gr,Nr[0],Lr,Ur,qr)}),Nr));return Wr},Tr.parseSplitAttributes=Gr=>{const Nr=Gr.attributes.getInt("axis",0),Lr=Gr.attributes.getInts("split",[]),Ur=Gr.outputs.length;return(0,Rr.createAttributeWithCacheKey)({axis:Nr,split:Lr,numOutputs:Ur})};const Fr=(Gr,Nr,Lr,Ur)=>{const[,Vr]=Pr.SplitUtil.splitShape(Nr[0].dims,Lr,Ur.split,Ur.numOutputs);return Vr.length},zr=(Gr,Nr,Lr,Ur,Vr)=>{const[Wr,qr]=Pr.SplitUtil.splitShape(Nr.dims,Ur,Lr.split,Lr.numOutputs),Kr=qr[Vr],Xr=Wr[Vr],Zr=`
      float process(int indices[${Xr.length}]) {
        indices[${Ur}] += ${Kr};
        return _A(indices);
      }
    `;return Object.assign(Object.assign({},Mr),{cacheHint:`${Lr.cacheKey}:${Vr}`,output:{dims:Xr,type:Nr.type,textureType:Dr.TextureType.unpacked},shaderSource:Zr})},jr=Gr=>{if(!Gr||Gr.length!==1)throw new Error("Split requires one input.");if(Gr[0].type!=="int8"&&Gr[0].type!=="uint8"&&Gr[0].type!=="int16"&&Gr[0].type!=="uint16"&&Gr[0].type!=="int32"&&Gr[0].type!=="uint32"&&Gr[0].type!=="float32"&&Gr[0].type!=="float64"&&Gr[0].type!=="bool")throw new Error("Invalid input type.")}},5416:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.parseSqueezeAttributes=Tr.squeezeV13=Tr.squeeze=void 0;const Rr=Ar(7273);Tr.squeeze=(Mr,Fr,zr)=>{Pr(Fr);const jr=Rr.ShapeUtil.squeezeShape(Fr[0].dims,zr);return[Mr.reshapeUnpacked(Fr[0],jr)]},Tr.squeezeV13=(Mr,Fr)=>(Dr(Fr),(0,Tr.squeeze)(Mr,[Fr[0]],Array.from(Fr[1].integerData))),Tr.parseSqueezeAttributes=Mr=>Mr.attributes.getInts("axes");const Pr=Mr=>{if(!Mr||Mr.length!==1)throw new Error("Squeeze requires 1 input.");if(Mr[0].type==="string")throw new Error("invalid input tensor types.")},Dr=Mr=>{if(!Mr||Mr.length!==2)throw new Error("Squeeze requires 2 inputs.");if(Mr[1].type!=="int32")throw new Error("Invalid input type.")}},1240:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.sum=void 0;const Rr=Ar(6757),Pr=Ar(5639);Tr.sum=(Fr,zr)=>{Mr(zr);const jr={name:"Sum",inputNames:zr.map((Gr,Nr)=>`X${Nr}`),inputTypes:new Array(zr.length).fill(Pr.TextureType.unpacked)};return[Fr.run(Object.assign(Object.assign({},jr),{get:()=>Dr(Fr,zr,jr)}),zr)]};const Dr=(Fr,zr,jr)=>{const Gr=(0,Rr.getGlsl)(Fr.session.backend.glContext.version),Nr=zr[0].dims.slice(),Lr=`
      void main() {
        vec4 result = ${zr.map((Ur,Vr)=>`${Gr.texture2D}(X${Vr},TexCoords)`).join(" + ")};
        ${Gr.output} = result;
      }
    `;return Object.assign(Object.assign({},jr),{output:{dims:Nr,type:zr[0].type,textureType:Pr.TextureType.unpacked},hasMain:!0,shaderSource:Lr})},Mr=Fr=>{if(!Fr||Fr.length===0)throw new Error("Sum requires inputs.");const zr=Fr[0].dims.length;for(let jr=1;jr<Fr.length;jr++){if(zr!==Fr[jr].dims.length)throw new Error("Input shapes are mismatched.");for(let Gr=0;Gr<zr;Gr++)if(Fr[0].dims[Gr]!==Fr[jr].dims[Gr])throw new Error("Input shapes are not matched.")}if(Fr[0].type!=="float32"&&Fr[0].type!=="float64")throw new Error("Invalid input type.");for(let jr=1;jr<Fr.length;jr++)if(Fr[0].type!==Fr[jr].type)throw new Error("Input types are not matched.")}},5944:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.tile=void 0;const Rr=Ar(6145),Pr=Ar(5639);Tr.tile=(Fr,zr)=>{Mr(zr);const jr={name:"Tile",inputNames:["A"],inputTypes:[Pr.TextureType.unpacked]};return[Fr.run(Object.assign(Object.assign({},jr),{get:()=>Dr(Fr,zr,jr)}),zr)]};const Dr=(Fr,zr,jr)=>{const Gr=zr[0].dims.slice(),Nr=new Array(Gr.length),Lr=[];for(let Wr=0;Wr<Gr.length;Wr++)Nr[Wr]=Gr[Wr]*zr[1].numberData[Wr],Lr.push(`inputIdx[${Wr}] = int(mod(float(outputIdx[${Wr}]), ${Gr[Wr]}.));`);const Ur=Nr.length,Vr=`
      float process(int outputIdx[${Ur}]) {
        int inputIdx[${Ur}];
        ${Lr.join(`
`)}
        return _A(inputIdx);
      }
    `;return Object.assign(Object.assign({},jr),{output:{dims:Nr,type:zr[0].type,textureType:Pr.TextureType.unpacked},shaderSource:Vr})},Mr=Fr=>{if(!Fr||Fr.length!==2)throw new Error("Tile requires 2 input.");if(Fr[1].dims.length!==1)throw new Error("The second input shape must 1 dimension.");if(Fr[1].dims[0]!==Fr[0].dims.length)throw new Error("Invalid input shape.");if(Rr.NUMBER_TYPES.indexOf(Fr[0].type)===-1)throw new Error("Invalid input type.");if(Fr[1].type!=="int32"&&Fr[1].type!=="int16")throw new Error("Invalid repeat type.")}},5707:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.parseTransposeAttributes=Tr.transpose=void 0;const Rr=Ar(4910),Pr=Ar(7273),Dr=Ar(5639),Mr={name:"Transpose",inputNames:["A"],inputTypes:[Dr.TextureType.unpacked]};Tr.transpose=(Lr,Ur,Vr)=>(Nr(Ur),[Lr.run(Object.assign(Object.assign({},Mr),{cacheHint:Vr.cacheKey,get:()=>Fr(Lr,Ur[0],Vr.perm)}),Ur)]),Tr.parseTransposeAttributes=Lr=>(0,Rr.createAttributeWithCacheKey)({perm:Lr.attributes.getInts("perm",[])});const Fr=(Lr,Ur,Vr)=>{const Wr=Ur.dims;Vr=zr(Wr,Vr);const qr=jr(Wr,Vr),Kr=Wr.length,Xr=`
      ${Gr("perm",Vr,Kr)}
      float process(int indices[${Kr}]) {
        int a[${Kr}];
        perm(a, indices);
        return _A(a);
      }`;return Object.assign(Object.assign({},Mr),{output:{dims:qr,type:Ur.type,textureType:Dr.TextureType.unpacked},shaderSource:Xr})},zr=(Lr,Ur)=>(Ur&&Ur.length!==Lr.length&&(Ur=[...Lr.keys()].reverse()),Ur),jr=(Lr,Ur)=>(Ur=zr(Lr,Ur),Pr.ShapeUtil.sortBasedOnPerm(Lr,Ur)),Gr=(Lr,Ur,Vr)=>{const Wr=[];Wr.push(`void ${Lr}(out int a[${Vr}], int src[${Vr}]) {`);for(let qr=0;qr<Vr;++qr)Wr.push(`	a[${Ur[qr]}]=src[${qr}];`);return Wr.push("	}"),Wr.join(`
`)},Nr=Lr=>{if(!Lr||Lr.length!==1)throw new Error("Transpose requires 1 input.");if(Lr[0].type!=="float32"&&Lr[0].type!=="float64")throw new Error("input should be float tensor")}},2488:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.encodeAsUint8=void 0;const Rr=Ar(6757),Pr=Ar(5639);Tr.encodeAsUint8=(Dr,Mr)=>{const Fr=Mr.shape,zr=(0,Rr.getGlsl)(Dr.session.backend.glContext.version),jr=`
    const float FLOAT_MAX = 1.70141184e38;
    const float FLOAT_MIN = 1.17549435e-38;

    bool isNaN(float val) {
      return (val < 1.0 || 0.0 < val || val == 0.0) ? false : true;
    }

    highp vec4 encodeAsUint8(highp float v) {
      if (isNaN(v)) {
        return vec4(255, 255, 255, 255);
      }

      highp float av = abs(v);

      if(av < FLOAT_MIN) {
        return vec4(0.0, 0.0, 0.0, 0.0);
      } else if(v > FLOAT_MAX) {
        return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
      } else if(v < -FLOAT_MAX) {
        return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
      }

      highp vec4 c = vec4(0,0,0,0);

      highp float e = floor(log2(av));
      highp float m = exp2(fract(log2(av))) - 1.0;

      c[2] = floor(128.0 * m);
      m -= c[2] / 128.0;
      c[1] = floor(32768.0 * m);
      m -= c[1] / 32768.0;
      c[0] = floor(8388608.0 * m);

      highp float ebias = e + 127.0;
      c[3] = floor(ebias / 2.0);
      ebias -= c[3] * 2.0;
      c[2] += floor(ebias) * 128.0;

      c[3] += 128.0 * step(0.0, -v);

      return c / 255.0;
    }

    void main() {
      float value = ${zr.texture2D}(X,TexCoords).r;
      ${zr.output} = encodeAsUint8(value);
    }`,Gr={name:"Uint8Encode",inputTypes:[Pr.TextureType.unpacked],inputNames:["X"],output:{dims:Fr,type:Mr.tensor.type,textureType:Pr.TextureType.downloadUint8AsFloat},shaderSource:jr,hasMain:!0};return Dr.executeProgram(Gr,[Mr.tensor])}},9087:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.tanh=Tr.tan=Tr.sqrt=Tr.sin=Tr.sigmoid=Tr.relu=Tr.not=Tr.neg=Tr.log=Tr.parseLeakyReluAttributes=Tr.leakyRelu=Tr.identity=Tr.floor=Tr.exp=Tr.parseEluAttributes=Tr.elu=Tr.cos=Tr.ceil=Tr.clipV11=Tr.parseClipAttributes=Tr.clip=Tr.atan=Tr.asin=Tr.acos=Tr.abs=Tr.glslTanh=Tr.glslTan=Tr.glslSqrt=Tr.glslSigmoid=Tr.glslRelu=Tr.glslSin=Tr.glslNot=Tr.glslNeg=Tr.glslLog=Tr.glslLeakyRelu=Tr.glslIdentity=Tr.glslClip=Tr.glslFloor=Tr.glslExp=Tr.glslElu=Tr.glslCos=Tr.glslCeil=Tr.glslAtan=Tr.glslAsin=Tr.glslAcos=Tr.glslAbs=void 0;const Rr=Ar(4910),Pr=Ar(7273),Dr=Ar(1997),Mr=Ar(6757),Fr=Ar(5639);function zr(){return Ts("abs")}function jr(){return Ts("acos")}function Gr(){return Ts("asin")}function Nr(){return Ts("atan")}function Lr(){return Ts("ceil")}function Ur(){return Ts("cos")}function Vr(ys){const ps="elu";return{body:`
  const float alpha = float(${ys});

  float ${ps}_(float a) {
    return a >= 0.0 ? a: (exp(a) - 1.0) * alpha;
  }
  vec4 ${ps}_(vec4 v) {
    return vec4(${ps}_(v.x), ${ps}_(v.y), ${ps}_(v.z), ${ps}_(v.w));
  }
  `,name:ps,type:Dr.FunctionType.ValueBased}}function Wr(){return Ts("exp")}function qr(){return Ts("floor")}function Kr(ys,ps){const vs="clip";return{body:`
  const float min = float(${ys});
  const float max = float(${ps});

  float ${vs}_(float a) {
    return clamp(a, min, max);
  }
  vec4 ${vs}_(vec4 v) {
    return clamp(v, min, max);
  }
  `,name:vs,type:Dr.FunctionType.ValueBased}}function Xr(){const ys="indentity";return{body:`
  float ${ys}_(float a) {
    return a;
  }
  vec4 ${ys}_(vec4 v) {
    return v;
  }
  `,name:ys,type:Dr.FunctionType.ValueBased}}function Zr(ys){const ps="leakyRelu";return{body:`
  const float alpha = float(${ys});

  float ${ps}_(float a) {
    return a < 0.0 ? a * alpha : a;
  }
  vec4 ${ps}_(vec4 v) {
    return vec4(${ps}_(v.x), ${ps}_(v.y), ${ps}_(v.z), ${ps}_(v.w));
  }
  `,name:ps,type:Dr.FunctionType.ValueBased}}function _i(){return Ts("log")}function Jr(){const ys="neg";return{body:`
  float ${ys}_(float a) {
    return -a;
  }
  vec4 ${ys}_(vec4 v) {
    return -v;
  }
  `,name:ys,type:Dr.FunctionType.ValueBased}}function es(){const ys="not";return{body:`
  float ${ys}_(float a) {
    return float( ! bool(a) );
  }
  bool ${ys}_(bool a) {
    return !a;
  }
  vec4 ${ys}_(vec4 v) {
    return vec4(!bool(v.x), !bool(v.y), !bool(v.z), !bool(v.w));
  }
  bvec4 ${ys}_(bvec4 v) {
    return bvec4(!v.x, !v.y, !v.z, !v.w);
  }
  `,name:ys,type:Dr.FunctionType.ValueBased}}function ts(){return Ts("sin")}function is(){const ys="relu";return{body:`
  float ${ys}_(float a) {
    return max( a, 0.0 );
  }
  vec4 ${ys}_(vec4 v) {
    return max( v, 0.0 );
  }
  `,name:ys,type:Dr.FunctionType.ValueBased}}function rs(){const ys="sigmoid";return{body:`
  float ${ys}_(float a) {
    return 1.0 / (1.0 + exp(-a));
  }
  vec4 ${ys}_(vec4 v) {
    return 1.0 / (1.0 + exp(-v));
  }
  `,name:ys,type:Dr.FunctionType.ValueBased}}function as(){return Ts("sqrt")}function ls(){return Ts("tan")}function fs(){const ys="tanh";return{body:`
  float ${ys}_(float a) {
    a = clamp(a, -10., 10.);
    a = exp(2.*a);
    return (a - 1.) / (a + 1.);
  }
  vec4 ${ys}_(vec4 v) {
    v = clamp(v, -10., 10.);
    v = exp(2.*v);
    return (v - 1.) / (v + 1.);
  }
  `,name:ys,type:Dr.FunctionType.ValueBased}}function Ts(ys){return{body:`
  float ${ys}_(float a) {
    return ${ys}(a);
  }
  vec4 ${ys}_(vec4 v) {
    return ${ys}(v);
  }
  `,name:ys,type:Dr.FunctionType.ValueBased}}Tr.glslAbs=zr,Tr.glslAcos=jr,Tr.glslAsin=Gr,Tr.glslAtan=Nr,Tr.glslCeil=Lr,Tr.glslCos=Ur,Tr.glslElu=Vr,Tr.glslExp=Wr,Tr.glslFloor=qr,Tr.glslClip=Kr,Tr.glslIdentity=Xr,Tr.glslLeakyRelu=Zr,Tr.glslLog=_i,Tr.glslNeg=Jr,Tr.glslNot=es,Tr.glslSin=ts,Tr.glslRelu=is,Tr.glslSigmoid=rs,Tr.glslSqrt=as,Tr.glslTan=ls,Tr.glslTanh=fs;const $s=(ys,ps,vs,Ds)=>{const js=ys.session.pack?Fr.TextureType.packed:Fr.TextureType.unpacked,zs={name:vs.name,inputTypes:[js],inputNames:["A"],cacheHint:Ds};return Object.assign(Object.assign({},zs),{get:()=>((qs,fo,Qs,no)=>{const yo=qs.session.pack?Fr.TextureType.packed:Fr.TextureType.unpacked,Js=(0,Mr.getGlsl)(qs.session.backend.glContext.version);return Object.assign(Object.assign({},fo),{output:{dims:Qs.dims,type:Qs.type,textureType:yo},shaderSource:`
     ${no.body}
     void main() {
       vec4 v = ${Js.texture2D}(A, TexCoords);
       v = ${no.name}_(v);
       ${Js.output} = v;
     }
     `,hasMain:!0})})(ys,zs,ps,vs)})};Tr.abs=(ys,ps)=>[ys.run($s(ys,ps[0],zr()),ps)],Tr.acos=(ys,ps)=>[ys.run($s(ys,ps[0],jr()),ps)],Tr.asin=(ys,ps)=>[ys.run($s(ys,ps[0],Gr()),ps)],Tr.atan=(ys,ps)=>[ys.run($s(ys,ps[0],Nr()),ps)],Tr.clip=(ys,ps,vs)=>[ys.run($s(ys,ps[0],Kr(vs.min,vs.max),vs.cacheKey),ps)],Tr.parseClipAttributes=ys=>(0,Rr.createAttributeWithCacheKey)({min:ys.attributes.getFloat("min",Pr.MIN_CLIP),max:ys.attributes.getFloat("max",Pr.MAX_CLIP)}),Tr.clipV11=(ys,ps)=>{const vs=xs(ys,ps);return(0,Tr.clip)(ys,[ps[0]],vs)};const xs=(ys,ps)=>{if(ps.length>=3&&(!ys.session.isInitializer(ps[1].dataId)||!ys.session.isInitializer(ps[2].dataId)))throw new Error("dynamic clip attributes are not allowed");const vs=ps.length>=3?ps[1].numberData[0]:Pr.MIN_CLIP,Ds=ps.length>=3?ps[2].numberData[0]:Pr.MAX_CLIP;return(0,Rr.createAttributeWithCacheKey)({min:vs,max:Ds})};Tr.ceil=(ys,ps)=>[ys.run($s(ys,ps[0],Lr()),ps)],Tr.cos=(ys,ps)=>[ys.run($s(ys,ps[0],Ur()),ps)],Tr.elu=(ys,ps,vs)=>[ys.run($s(ys,ps[0],Vr(vs.alpha),vs.cacheKey),ps)],Tr.parseEluAttributes=ys=>(0,Rr.createAttributeWithCacheKey)({alpha:ys.attributes.getFloat("alpha",1)}),Tr.exp=(ys,ps)=>[ys.run($s(ys,ps[0],Wr()),ps)],Tr.floor=(ys,ps)=>[ys.run($s(ys,ps[0],qr()),ps)],Tr.identity=(ys,ps)=>[ys.run($s(ys,ps[0],Xr()),ps)],Tr.leakyRelu=(ys,ps,vs)=>[ys.run($s(ys,ps[0],Zr(vs.alpha),vs.cacheKey),ps)],Tr.parseLeakyReluAttributes=ys=>(0,Rr.createAttributeWithCacheKey)({alpha:ys.attributes.getFloat("alpha",.01)}),Tr.log=(ys,ps)=>[ys.run($s(ys,ps[0],_i()),ps)],Tr.neg=(ys,ps)=>[ys.run($s(ys,ps[0],Jr()),ps)],Tr.not=(ys,ps)=>[ys.run($s(ys,ps[0],es()),ps)],Tr.relu=(ys,ps)=>[ys.run($s(ys,ps[0],is()),ps)],Tr.sigmoid=(ys,ps)=>[ys.run($s(ys,ps[0],rs()),ps)],Tr.sin=(ys,ps)=>[ys.run($s(ys,ps[0],ts()),ps)],Tr.sqrt=(ys,ps)=>[ys.run($s(ys,ps[0],as()),ps)],Tr.tan=(ys,ps)=>[ys.run($s(ys,ps[0],ls()),ps)],Tr.tanh=(ys,ps)=>[ys.run($s(ys,ps[0],fs()),ps)]},540:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.createUnpackProgramInfoLoader=Tr.createUnpackProgramInfo=void 0;const Rr=Ar(6757),Pr=Ar(5639),Dr=Ar(432),Mr=Ar(5614),Fr={name:"unpack",inputNames:["A"],inputTypes:[Pr.TextureType.packed]};Tr.createUnpackProgramInfo=(zr,jr)=>{const Gr=jr.dims.length,Nr=(0,Mr.getChannels)("rc",Gr),Lr=Nr.slice(-2),Ur=(0,Dr.getCoordsDataType)(Gr),Vr=(0,Mr.unpackFromChannel)(),Wr=jr.dims.length===0?"":function(Xr,Zr){if(Xr===1)return"rc";let _i="";for(let Jr=0;Jr<Xr;Jr++)_i+=Zr[Jr],Jr<Xr-1&&(_i+=",");return _i}(Gr,Nr),qr=Gr<=1?"rc":`vec2(${Lr.join(",")})`,Kr=`
    ${Vr}
    void main() {
      ${Ur} rc = getOutputCoords();

       // Sample the texture with the coords to get the rgba channel value.
       vec4 packedInput = getA(${Wr});

       ${(0,Rr.getGlsl)(zr.session.backend.glContext.version).output} = vec4(getChannel(packedInput, ${qr}), 0, 0, 0);
     }
   `;return Object.assign(Object.assign({},Fr),{hasMain:!0,output:{dims:jr.dims,type:jr.type,textureType:Pr.TextureType.unpacked},shaderSource:Kr})},Tr.createUnpackProgramInfoLoader=(zr,jr)=>Object.assign(Object.assign({},Fr),{get:()=>(0,Tr.createUnpackProgramInfo)(zr,jr)})},7862:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.parseUnsqueezeAttributes=Tr.unsqueezeV13=Tr.unsqueeze=void 0;const Rr=Ar(7273);Tr.unsqueeze=(Mr,Fr,zr)=>{Pr(Fr);const jr=Rr.ShapeUtil.unsqueezeShape(Fr[0].dims,zr);return[Mr.reshapeUnpacked(Fr[0],jr)]},Tr.unsqueezeV13=(Mr,Fr)=>(Dr(Fr),(0,Tr.unsqueeze)(Mr,[Fr[0]],Array.from(Fr[1].integerData))),Tr.parseUnsqueezeAttributes=Mr=>Mr.attributes.getInts("axes");const Pr=Mr=>{if(!Mr||Mr.length!==1)throw new Error("Unsqueeze requires 1 input.");if(Mr[0].type==="string")throw new Error("invalid input tensor types.")},Dr=Mr=>{if(!Mr||Mr.length!==2)throw new Error("Unsqueeze requires 2 inputs.");if(Mr[1].type!=="int32")throw new Error("Invalid input type.")}},3980:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.scalesValidation=Tr.validateInputs=Tr.parseUpsampleAttributes=Tr.parseUpsampleAttributesV9=Tr.parseUpsampleAttributesV7=Tr.upsample=void 0;const Rr=Ar(4910),Pr=Ar(6757),Dr=Ar(5639),Mr={name:"Upsample",inputNames:["X"],inputTypes:[Dr.TextureType.unpacked]};Tr.upsample=(zr,jr,Gr)=>((0,Tr.validateInputs)(jr,Gr),[zr.run(Object.assign(Object.assign({},Mr),{cacheHint:Gr.cacheKey,get:()=>Fr(zr,jr,Gr)}),jr)]),Tr.parseUpsampleAttributesV7=zr=>(0,Tr.parseUpsampleAttributes)(zr,7),Tr.parseUpsampleAttributesV9=zr=>(0,Tr.parseUpsampleAttributes)(zr,9),Tr.parseUpsampleAttributes=(zr,jr)=>{const Gr=jr>=10,Nr=zr.attributes.getString("mode","nearest");if(Nr!=="nearest"&&Nr!=="linear"&&(jr<11||Nr!=="cubic"))throw new Error(`unrecognized mode: ${Nr}`);let Lr=[];jr<9&&(Lr=zr.attributes.getFloats("scales"),(0,Tr.scalesValidation)(Lr,Nr,Gr));const Ur=zr.attributes.getFloat("extrapolation_value",0),Vr=jr>10?zr.attributes.getString("coordinate_transformation_mode","half_pixel"):"asymmetric";if(["asymmetric","pytorch_half_pixel","tf_half_pixel_for_nn","align_corners","tf_crop_and_resize","half_pixel"].indexOf(Vr)===-1)throw new Error(`coordinate_transform_mode '${Vr}' is not supported`);const Wr=Vr==="tf_crop_and_resize",qr=Wr,Kr=Nr==="nearest"&&jr>=11?zr.attributes.getString("nearest_mode","round_prefer_floor"):"";if(["round_prefer_floor","round_prefer_ceil","floor","ceil",""].indexOf(Kr)===-1)throw new Error(`nearest_mode '${Kr}' is not supported`);const Xr=zr.attributes.getFloat("cubic_coeff_a",-.75),Zr=zr.attributes.getInt("exclude_outside",0)!==0;if(Zr&&Nr!=="cubic")throw new Error("exclude_outside can be set to 1 only when mode is CUBIC.");const _i=jr<11||Nr==="nearest"&&Vr==="asymmetric"&&Kr==="floor";let Jr=0,es=0,ts=0;return jr>10?zr.inputs.length>2?(Jr=1,es=2,ts=3):(es=1,ts=2):jr===9&&(es=1),(0,Rr.createAttributeWithCacheKey)({opset:jr,isResize:Gr,mode:Nr,scales:Lr,extrapolationValue:Ur,coordinateTransformMode:Vr,useExtrapolation:qr,needRoiInput:Wr,nearestMode:Kr,cubicCoefficientA:Xr,excludeOutside:Zr,useNearest2xOptimization:_i,roiInputIdx:Jr,scalesInputIdx:es,sizesInputIdx:ts})};const Fr=(zr,jr,Gr)=>{const Nr=(0,Pr.getGlsl)(zr.session.backend.glContext.version),[Lr,Ur]=zr.calculateTextureWidthAndHeight(jr[0].dims,Dr.TextureType.unpacked),Vr=jr[0].dims.map((ts,is)=>Math.floor(ts*Gr.scales[is])),[Wr,qr]=zr.calculateTextureWidthAndHeight(Vr,Dr.TextureType.unpacked),Kr=Vr.length,Xr=new Array(Kr),Zr=new Array(Kr);let _i=`
      int output_pitches[${Kr}];
      int input_pitches[${Kr}];
      `;for(let ts=Kr-1;ts>=0;ts--)Xr[ts]=ts===Kr-1?1:Xr[ts+1]*Vr[ts+1],Zr[ts]=ts===Kr-1?1:Zr[ts+1]*jr[0].dims[ts+1],_i+=`
        output_pitches[${ts}] = ${Xr[ts]};
        input_pitches[${ts}] = ${Zr[ts]};
        `;const Jr=`
      float getInputFloat(int index) {
        vec2 coords = offsetToCoords(index, ${Lr}, ${Ur});
        float value = getColorAsFloat(${Nr.texture2D}(X, coords));
        return value;
      }
      `,es=Gr.mode==="nearest"?`
    ${Jr}
    float process(int indices[${Kr}]) {
      int input_index = 0;
      int output_index = coordsToOffset(TexCoords, ${Wr}, ${qr});

      ${_i}

      int d, m;
      for (int dim = 0; dim < ${Kr}; ++dim) {
        d = output_index / output_pitches[dim];
        m = output_index - d * output_pitches[dim];
        output_index = m;

        if (scales[dim] != 1 && d > 0) {
          int d2 = d / scales[dim];
          m = d - d2 * scales[dim];
          d = d2;
        }
        input_index += input_pitches[dim] * d;
      }

      return getInputFloat(input_index);
    }`:Kr===4?`
    ${Jr}
    float process(int indices[4]) {
      int input_index = 0;
      int output_index = coordsToOffset(TexCoords, ${Wr}, ${qr});

      ${_i}

      int m;
      int index_of_dim0, index_of_dim1, index_of_dim2, index_of_dim3;
      index_of_dim0 = output_index / output_pitches[0];
      m = output_index - index_of_dim0 * output_pitches[0];
      index_of_dim1 = m / output_pitches[1];
      m = m - index_of_dim1 * output_pitches[1];
      index_of_dim2 = m / output_pitches[2];
      m = m - index_of_dim2 * output_pitches[2];
      index_of_dim3 = m;

      int index_of_input_dim2, index_of_input_dim3, x_offset, y_offset;
      index_of_input_dim2 = index_of_dim2 / scales[2];
      y_offset = index_of_dim2 - index_of_input_dim2 * scales[2];
      index_of_input_dim3 = index_of_dim3 / scales[3];
      x_offset = index_of_dim3 - index_of_input_dim3 * scales[3];

      input_index = index_of_dim0 * input_pitches[0] +
            index_of_dim1 * input_pitches[1] +
            index_of_input_dim2 * input_pitches[2] +
            index_of_input_dim3;

      float x00 = getInputFloat(input_index);
      float x10, x01, x11;

      bool end_of_dim2 = false;
      if (index_of_input_dim2 == (${jr[0].dims[2]} - 1)) {
        // It's the end in dimension 2
        x01 = x00;
        end_of_dim2 = true;
      } else {
        x01 = getInputFloat(input_index + input_pitches[2]);
      }

      if (index_of_input_dim3 == (input_pitches[2] - 1)) {
        // It's the end in dimension 3
        x10 = x00;
        x11 = x01;
      }
      else {
        x10 = getInputFloat(input_index + 1);
        x11 = end_of_dim2 ? x10 : getInputFloat(input_index + input_pitches[2] + 1);
      }

      float y0 = x00 + float(y_offset) * (x01 - x00) / float(scales[2]);
      float y1 = x10 + float(y_offset) * (x11 - x10) / float(scales[2]);
      return y0 + float(x_offset) * (y1 - y0) / float(scales[3]);
    }`:`
    ${Jr}
    float process(int indices[2]) {
      int input_index = 0;
      int output_index = coordsToOffset(TexCoords, ${Wr}, ${qr});

      ${_i}

      int m;
      int index_of_dim0, index_of_dim1;
      index_of_dim0 = output_index / output_pitches[0];
      m = output_index - index_of_dim0 * output_pitches[0];
      index_of_dim1 = m;

      int index_of_input_dim0, index_of_input_dim1, x_offset, y_offset;
      index_of_input_dim0 = index_of_dim0 / scales[0];
      y_offset = index_of_dim0 - index_of_input_dim0 * scales[0];
      index_of_input_dim1 = index_of_dim1 / scales[1];
      x_offset = index_of_dim1 - index_of_input_dim1 * scales[1];

      input_index = index_of_input_dim0 * input_pitches[0] + index_of_input_dim1;

      float x00 = getInputFloat(input_index);
      float x10, x01, x11;

      bool end_of_dim0 = false;
      if (index_of_input_dim0 == (${jr[0].dims[0]} - 1)) {
        // It's the end in dimension 0
        x01 = x00;
        end_of_dim0 = true;
      } else {
        x01 = getInputFloat(input_index + input_pitches[0]);
      }

      if (index_of_input_dim1 == (input_pitches[0] - 1)) {
        // It's the end in dimension 1
        x10 = x00;
        x11 = x01;
      }
      else {
        x10 = getInputFloat(input_index + 1);
        x11 = end_of_dim0 ? x10 : getInputFloat(input_index + input_pitches[0] + 1);
      }

      float y0 = x00 + float(y_offset) * (x01 - x00) / float(scales[0]);
      float y1 = x10 + float(y_offset) * (x11 - x10) / float(scales[0]);
      return y0 + float(x_offset) * (y1 - y0) / float(scales[1]);
    }`;return Object.assign(Object.assign({},Mr),{output:{dims:Vr,type:jr[0].type,textureType:Dr.TextureType.unpacked},shaderSource:es,variables:[{name:"scales",type:"int",arrayLength:Gr.scales.length,data:Gr.scales.map(ts=>Math.ceil(ts))}]})};Tr.validateInputs=(zr,jr)=>{if(!zr||jr.opset<9&&zr.length!==1||jr.opset>=9&&jr.opset<11&&zr.length!==2||jr.opset>=11&&zr.length<2)throw new Error("invalid inputs.");if(jr.scales.length>0&&zr[0].dims.length!==jr.scales.length)throw new Error("Invalid input shape.");if(zr[0].type==="string")throw new Error("Invalid input tensor types.")},Tr.scalesValidation=(zr,jr,Gr)=>{if(Gr){for(const Nr of zr)if(Nr<=0)throw new Error("Scale value should be greater than 0.")}else for(const Nr of zr)if(Nr<1)throw new Error("Scale value should be greater than or equal to 1.");if(!(jr!=="linear"&&jr!=="cubic"||zr.length===2||zr.length===4&&zr[0]===1&&zr[1]===1))throw new Error(`'Linear' mode and 'Cubic' mode only support 2-D inputs ('Bilinear', 'Bicubic')         or 4-D inputs with the corresponding outermost 2 scale values being 1         in the ${Gr?"Resize":"Upsample"} opeartor.`)}},2757:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.ProgramManager=void 0;const Rr=Ar(8453),Pr=Ar(1315),Dr=Ar(8897),Mr=Ar(6757);Tr.ProgramManager=class{constructor(Fr,zr,jr){this.profiler=Fr,this.glContext=zr,this.textureLayoutStrategy=jr,this.repo=new Map,this.attributesBound=!1}getArtifact(Fr){return this.repo.get(Fr)}setArtifact(Fr,zr){this.repo.set(Fr,zr)}run(Fr,zr,jr){var Gr;this.profiler.event("op",`ProgramManager.run ${(Gr=Fr.programInfo.name)!==null&&Gr!==void 0?Gr:"unknown kernel"}`,()=>{var Nr;const Lr=this.glContext.gl,Ur=Fr.program;Lr.useProgram(Ur);try{this.bindOutput(jr),this.attributesBound||this.bindAttributes(Fr.attribLocations),this.bindUniforms(Fr.uniformLocations,(Nr=Fr.programInfo.variables)!==null&&Nr!==void 0?Nr:[],zr)}catch(Vr){throw Pr.Logger.error("ProgramManager",Fr.programInfo.shaderSource),Vr}this.profiler.event("backend","GlContext.draw()",()=>{this.glContext.draw()})},this.glContext)}dispose(){this.vertexShader&&this.glContext.deleteShader(this.vertexShader),this.repo.forEach(Fr=>this.glContext.deleteProgram(Fr.program))}build(Fr,zr,jr){return this.profiler.event("backend","ProgramManager.build",()=>{const Gr=new Dr.GlslPreprocessor(this.glContext,Fr,zr,jr),Nr=Gr.preprocess(),Lr=this.compile(Nr);return{programInfo:Fr,program:Lr,uniformLocations:this.getUniformLocations(Lr,Gr.context.programInfo.inputNames,Gr.context.programInfo.variables),attribLocations:this.getAttribLocations(Lr)}})}compile(Fr){if(!this.vertexShader){Pr.Logger.verbose("ProrgramManager","Compiling and caching Vertex shader for the first time");const Gr=(0,Mr.getVertexShaderSource)(this.glContext.version);this.vertexShader=this.glContext.compileShader(Gr,this.glContext.gl.VERTEX_SHADER)}Rr.env.debug&&Pr.Logger.verbose("ProrgramManager",`FragShader:
${Fr}
`);const zr=this.glContext.compileShader(Fr,this.glContext.gl.FRAGMENT_SHADER),jr=this.glContext.createProgram(this.vertexShader,zr);return this.glContext.deleteShader(zr),jr}bindOutput(Fr){const zr=Fr.width,jr=Fr.height;Pr.Logger.verbose("ProrgramManager",`Binding output texture to Framebuffer: w/h=${zr}/${jr}, shape=${Fr.shape}, type=${Fr.tensor.type}`),this.glContext.attachFramebuffer(Fr.texture,zr,jr)}bindAttributes(Fr){const zr=Fr.position,jr=Fr.textureCoord;this.glContext.setVertexAttributes(zr,jr),this.attributesBound=!0}bindUniforms(Fr,zr,jr){var Gr;const Nr=this.glContext.gl;let Lr=0;for(const{name:Ur,type:Vr,location:Wr,arrayLength:qr}of Fr){const Kr=(Gr=zr.find(Xr=>Xr.name===Ur))===null||Gr===void 0?void 0:Gr.data;if(Vr!=="sampler2D"&&!Kr)throw new Error(`variable '${Ur}' does not have data defined in program info`);switch(Vr){case"sampler2D":this.bindTexture(jr[Lr],Wr,Lr),Lr++;break;case"float":qr?Nr.uniform1fv(Wr,Kr):Nr.uniform1f(Wr,Kr);break;case"int":qr?Nr.uniform1iv(Wr,Kr):Nr.uniform1i(Wr,Kr);break;default:throw new Error(`Uniform not implemented: ${Vr}`)}}}bindTexture(Fr,zr,jr){this.glContext.bindTextureToUniform(Fr.texture,jr,zr)}getAttribLocations(Fr){return{position:this.getAttribLocation(Fr,"position"),textureCoord:this.getAttribLocation(Fr,"textureCoord")}}getUniformLocations(Fr,zr,jr){const Gr=[];if(zr)for(const Nr of zr)Gr.push({name:Nr,type:"sampler2D",location:this.getUniformLocation(Fr,Nr)});if(jr)for(const Nr of jr)Gr.push(Object.assign(Object.assign({},Nr),{location:this.getUniformLocation(Fr,Nr.name)}));return Gr}getUniformLocation(Fr,zr){const jr=this.glContext.gl.getUniformLocation(Fr,zr);if(jr===null)throw new Error(`Uniform ${zr} not found.`);return jr}getAttribLocation(Fr,zr){return this.glContext.gl.getAttribLocation(Fr,zr)}}},2171:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.WebGLSessionHandler=void 0;const Rr=Ar(1315),Pr=Ar(5881),Dr=Ar(7860),Mr=Ar(4110),Fr=Ar(2757),zr=Ar(7618),jr=Ar(5243);Tr.WebGLSessionHandler=class{constructor(Gr,Nr){this.backend=Gr,this.context=Nr,this.layoutStrategy=new zr.PreferLogicalStrategy(Gr.glContext.maxTextureSize),this.programManager=new Fr.ProgramManager(this.context.profiler,Gr.glContext,this.layoutStrategy),this.textureManager=new jr.TextureManager(Gr.glContext,this.layoutStrategy,this.context.profiler,{reuseTextures:Gr.textureCacheMode==="full"}),this.packedTextureDataCache=new Map,this.unpackedTextureDataCache=new Map,this.pack=Gr.pack,this.pack2unpackMap=new Map,this.unpack2packMap=new Map}createInferenceHandler(){return new Dr.WebGLInferenceHandler(this)}onGraphInitialized(Gr){const Nr=Gr.getValues().filter(Lr=>Lr.from===-1&&Lr.tensor).map(Lr=>Lr.tensor.dataId);this.initializers=new Set(Nr)}isInitializer(Gr){return!!this.initializers&&this.initializers.has(Gr)}addInitializer(Gr){this.initializers.add(Gr)}getTextureData(Gr,Nr){return Nr?this.packedTextureDataCache.get(Gr):this.unpackedTextureDataCache.get(Gr)}setTextureData(Gr,Nr,Lr=!1){Rr.Logger.verbose("WebGLSessionHandler","Storing Texture data in cache"),Lr?this.packedTextureDataCache.set(Gr,Nr):this.unpackedTextureDataCache.set(Gr,Nr)}dispose(){this.programManager.dispose(),this.textureManager.clearActiveTextures(),this.packedTextureDataCache.forEach(Gr=>this.textureManager.releaseTexture(Gr,!0)),this.packedTextureDataCache=new Map,this.unpackedTextureDataCache.forEach(Gr=>this.textureManager.releaseTexture(Gr,!0)),this.unpackedTextureDataCache=new Map}resolve(Gr,Nr,Lr){const Ur=(0,Pr.resolveOperator)(Gr,Nr,Mr.WEBGL_OP_RESOLVE_RULES);return{impl:Ur.opImpl,context:Ur.opInit?Ur.opInit(Gr,Lr):Gr}}}},9622:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.Uint8DataEncoder=Tr.RGBAFloatDataEncoder=Tr.RedFloat32DataEncoder=void 0;const Rr=Ar(1315);Tr.RedFloat32DataEncoder=class{constructor(Pr,Dr=1){if(Dr===1)this.internalFormat=Pr.R32F,this.format=Pr.RED,this.textureType=Pr.FLOAT,this.channelSize=Dr;else{if(Dr!==4)throw new Error(`Invalid number of channels: ${Dr}`);this.internalFormat=Pr.RGBA32F,this.format=Pr.RGBA,this.textureType=Pr.FLOAT,this.channelSize=Dr}}encode(Pr,Dr){let Mr,Fr;return Pr.constructor!==Float32Array&&(Rr.Logger.warning("Encoder","data was not of type Float32; creating new Float32Array"),Fr=new Float32Array(Pr)),Dr*this.channelSize>Pr.length?(Rr.Logger.warning("Encoder","Source data too small. Allocating larger array"),Fr=Pr,Mr=this.allocate(Dr*this.channelSize),Fr.forEach((zr,jr)=>Mr[jr]=zr)):(Fr=Pr,Mr=Fr),Mr}allocate(Pr){return new Float32Array(4*Pr)}decode(Pr,Dr){return this.channelSize===1?Pr.filter((Mr,Fr)=>Fr%4==0).subarray(0,Dr):Pr.subarray(0,Dr)}},Tr.RGBAFloatDataEncoder=class{constructor(Pr,Dr=1,Mr){if(Dr!==1&&Dr!==4)throw new Error(`Invalid number of channels: ${Dr}`);this.internalFormat=Pr.RGBA,this.format=Pr.RGBA,this.channelSize=Dr,this.textureType=Mr||Pr.FLOAT}encode(Pr,Dr){let Mr=Pr;return this.channelSize===1&&(Rr.Logger.verbose("Encoder","Exploding into a larger array"),Mr=this.allocate(Dr),Pr.forEach((Fr,zr)=>Mr[4*zr]=Fr)),Mr}allocate(Pr){return new Float32Array(4*Pr)}decode(Pr,Dr){return this.channelSize===1?Pr.filter((Mr,Fr)=>Fr%4==0).subarray(0,Dr):Pr.subarray(0,Dr)}},Tr.Uint8DataEncoder=class{constructor(Pr,Dr=1){if(this.channelSize=4,Dr===1)this.internalFormat=Pr.ALPHA,this.format=Pr.ALPHA,this.textureType=Pr.UNSIGNED_BYTE,this.channelSize=Dr;else{if(Dr!==4)throw new Error(`Invalid number of channels: ${Dr}`);this.internalFormat=Pr.RGBA,this.format=Pr.RGBA,this.textureType=Pr.UNSIGNED_BYTE,this.channelSize=Dr}}encode(Pr,Dr){return new Uint8Array(Pr.buffer,Pr.byteOffset,Pr.byteLength)}allocate(Pr){return new Uint8Array(Pr*this.channelSize)}decode(Pr,Dr){if(Pr instanceof Uint8Array)return Pr.subarray(0,Dr);throw new Error(`Invalid array type: ${Pr.constructor}`)}}},7618:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.getBatchDim=Tr.sizeToSquarishShape=Tr.getRowsCols=Tr.sizeFromShape=Tr.isInt=Tr.parseAxisParam=Tr.squeezeShape=Tr.PreferLogicalStrategy=Tr.AlwaysKeepOriginalSizeStrategy=void 0;const Rr=Ar(1315),Pr=Ar(7273);function Dr(Gr,Nr){const Lr=[],Ur=[],Vr=Nr!=null&&Array.isArray(Nr)&&Nr.length===0,Wr=Nr==null||Vr?null:Mr(Nr,Gr).sort();let qr=0;for(let Kr=0;Kr<Gr.length;++Kr){if(Wr!=null){if(Wr[qr]===Kr&&Gr[Kr]!==1)throw new Error(`Can't squeeze axis ${Kr} since its dim '${Gr[Kr]}' is not 1`);(Wr[qr]==null||Wr[qr]>Kr)&&Gr[Kr]===1&&(Lr.push(Gr[Kr]),Ur.push(Kr)),Wr[qr]<=Kr&&qr++}Gr[Kr]!==1&&(Lr.push(Gr[Kr]),Ur.push(Kr))}return{newShape:Lr,keptDims:Ur}}function Mr(Gr,Nr){const Lr=Nr.length;return Gr=Gr==null?Nr.map((Ur,Vr)=>Vr):[].concat(Gr),(0,Pr.assert)(Gr.every(Ur=>Ur>=-Lr&&Ur<Lr),()=>`All values in axis param must be in range [-${Lr}, ${Lr}) but got axis ${Gr}`),(0,Pr.assert)(Gr.every(Fr),()=>`All values in axis param must be integers but got axis ${Gr}`),Gr.map(Ur=>Ur<0?Lr+Ur:Ur)}function Fr(Gr){return Gr%1==0}function zr(Gr){if(Gr.length===0)return 1;let Nr=Gr[0];for(let Lr=1;Lr<Gr.length;Lr++)Nr*=Gr[Lr];return Nr}function jr(Gr){const Nr=Math.ceil(Math.sqrt(Gr));return[Nr,Math.ceil(Gr/Nr)]}Tr.AlwaysKeepOriginalSizeStrategy=class{constructor(Gr){this.maxTextureSize=Gr}computeTextureWH(Gr,Nr){if(Gr.length===0)return[1,1];const Lr=this.maxTextureSize;if(Nr&&Nr.breakAxis!==void 0){const Wr=Nr.breakAxis>=Gr.length?1:Gr.slice(Nr.breakAxis).reduce((Kr,Xr)=>Kr*Xr),qr=Nr.breakAxis<=0?1:Gr.slice(0,Nr.breakAxis).reduce((Kr,Xr)=>Kr*Xr);if(!(Wr>Lr||qr>Lr))return[Wr,qr];Rr.Logger.verbose("TextureLayout",`Given width/height preferences were unattainable: shape:${Gr}, breakAxis:${Nr.breakAxis}`)}const Ur=Gr.reduce((Wr,qr)=>Wr*qr);let Vr=Math.floor(Math.sqrt(Ur));for(;Vr<Lr&&Vr<Ur&&Ur%Vr!=0;Vr++);if(Vr>=Lr||Ur%Vr!=0)throw new Error(`The given dimensions are outside this GPU's boundaries: ${Gr}`);return[Vr,Ur/Vr]}},Tr.PreferLogicalStrategy=class{constructor(Gr){this.maxTextureSize=Gr}computeTextureWH(Gr,Nr){const Lr=this.computeTexture(Gr,Nr);return Nr&&Nr.isPacked&&(Lr[0]/=2,Lr[1]/=2),Nr&&Nr.reverseWH?[Lr[1],Lr[0]]:Lr}computeTexture(Gr,Nr){const Lr=Nr&&Nr.isPacked;if(Gr.length===0)return Lr?[2,2]:[1,1];let Ur=this.maxTextureSize;if(Nr&&Nr.breakAxis!==void 0){const qr=Nr.breakAxis>=Gr.length?1:Gr.slice(Nr.breakAxis).reduce((Xr,Zr)=>Xr*Zr),Kr=Nr.breakAxis<=0?1:Gr.slice(0,Nr.breakAxis).reduce((Xr,Zr)=>Xr*Zr);if(!(qr>Ur||Kr>Ur))return[qr,Kr];Rr.Logger.verbose("TextureLayout",`Given width/height preferences were unattainable: shape:${Gr}, breakAxis:${Nr.breakAxis}`)}let Vr=Gr.slice(0);Lr&&(Ur*=2,Vr=Vr.map((qr,Kr)=>Kr>=Vr.length-2?Vr[Kr]%2==0?Vr[Kr]:Vr[Kr]+1:Vr[Kr]),Vr.length===1&&(Vr=[2,Vr[0]])),Vr.length!==2&&(Vr=Dr(Vr).newShape);const Wr=zr(Vr);return Vr.length<=1&&Wr<=Ur?[1,Wr]:Vr.length===2&&Vr[0]<=Ur&&Vr[1]<=Ur?Vr:Vr.length===3&&Vr[0]*Vr[1]<=Ur&&Vr[2]<=Ur?[Vr[0]*Vr[1],Vr[2]]:Vr.length===3&&Vr[0]<=Ur&&Vr[1]*Vr[2]<=Ur?[Vr[0],Vr[1]*Vr[2]]:Vr.length===4&&Vr[0]*Vr[1]*Vr[2]<=Ur&&Vr[3]<=Ur?[Vr[0]*Vr[1]*Vr[2],Vr[3]]:Vr.length===4&&Vr[0]<=Ur&&Vr[1]*Vr[2]*Vr[3]<=Ur?[Vr[0],Vr[1]*Vr[2]*Vr[3]]:Lr?jr(Wr/4).map(qr=>2*qr):jr(Wr)}},Tr.squeezeShape=Dr,Tr.parseAxisParam=Mr,Tr.isInt=Fr,Tr.sizeFromShape=zr,Tr.getRowsCols=function(Gr){if(Gr.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[Gr.length>1?Gr[Gr.length-2]:1,Gr[Gr.length-1]]},Tr.sizeToSquarishShape=jr,Tr.getBatchDim=function(Gr,Nr=2){return zr(Gr.slice(0,Gr.length-Nr))}},3314:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.createTextureLayoutFromShape=Tr.calculateTextureWidthAndHeight=Tr.createTextureLayoutFromTextureType=void 0;const Rr=Ar(7273),Pr=Ar(5639);Tr.createTextureLayoutFromTextureType=(Dr,Mr,Fr)=>{const zr=Fr===Pr.TextureType.unpacked||Fr===Pr.TextureType.unpackedReversed?1:4,jr=Fr===Pr.TextureType.packed,Gr=Fr===Pr.TextureType.unpackedReversed||Fr===Pr.TextureType.packed,Nr=Fr===Pr.TextureType.packedLastDimension?Mr.length-1:void 0,Lr=Fr===Pr.TextureType.packedLastDimension?Mr.map((Ur,Vr)=>Vr===Mr.length-1?4*Ur:Ur):void 0;return(0,Tr.createTextureLayoutFromShape)(Dr,Mr,zr,Lr,{isPacked:jr,reverseWH:Gr,breakAxis:Nr})},Tr.calculateTextureWidthAndHeight=(Dr,Mr,Fr)=>{const zr=(0,Tr.createTextureLayoutFromTextureType)(Dr,Mr,Fr);return[zr.width,zr.height]},Tr.createTextureLayoutFromShape=(Dr,Mr,Fr=1,zr,jr)=>{const Gr=!(!jr||!jr.isPacked),[Nr,Lr]=Dr.computeTextureWH(Gr&&zr||Mr,jr),Ur=Mr.length;let Vr=Mr.slice(0);if(Ur===0&&(Vr=[1]),Fr===1)zr=Mr;else if(Gr){if(Fr!==4)throw new Error("a packed texture must be 4-channel");zr=Mr,Ur>0&&(Vr[Ur-1]=Math.ceil(Vr[Ur-1]/2)),Ur>1&&(Vr[Ur-2]=Math.ceil(Vr[Ur-2]/2))}else if(!zr)throw new Error("Unpacked shape is needed when using channels > 1");return{width:Nr,height:Lr,channels:Fr,isPacked:Gr,shape:Vr,strides:Rr.ShapeUtil.computeStrides(Vr),unpackedShape:zr,reversedWH:jr&&jr.reverseWH}}},5243:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.TextureManager=void 0;const Rr=Ar(1315);Tr.TextureManager=class{constructor(Pr,Dr,Mr,Fr){this.glContext=Pr,this.layoutStrategy=Dr,this.profiler=Mr,this.config=Fr,this.pendingRead=new Map,Fr.reuseTextures&&(this.inUseTextures=new Map,this.idleTextures=new Map,this.textureLookup=new Map)}createTextureFromLayout(Pr,Dr,Mr,Fr){const zr=this.toEncoderType(Pr),jr=this.glContext.getEncoder(zr,Dr.channels||1,Fr);if(Dr.isPacked&&Fr===1)throw new Error("not implemented");const Gr=Dr.width,Nr=Dr.height;let Lr,Ur;if(this.config.reuseTextures){Lr=`${Gr}x${Nr}_${jr.format}_${jr.internalFormat}_${jr.textureType}`,Ur=this.inUseTextures.get(Lr),Ur||(Ur=[],this.inUseTextures.set(Lr,Ur));const Wr=this.idleTextures.get(Lr);if(Wr&&Wr.length>0){const qr=Wr.pop();return Ur.push(qr),Fr===1&&this.glContext.updateTexture(qr,Gr,Nr,jr,this.toTextureData(Pr,Mr)),qr}}Rr.Logger.verbose("TextureManager",`Creating new texture of size ${Dr.width}x${Dr.height}`);const Vr=this.glContext.allocateTexture(Gr,Nr,jr,this.toTextureData(Pr,Mr));return this.config.reuseTextures&&(Ur.push(Vr),this.textureLookup.set(Vr,Lr)),Vr}readTexture(Pr,Dr,Mr){return Mr||(Mr=1),this.profiler.event("backend","TextureManager.readTexture",()=>{const Fr=Pr.shape.reduce((jr,Gr)=>jr*Gr)*Mr,zr=this.glContext.readTexture(Pr.texture,Pr.width,Pr.height,Fr,this.toEncoderType(Dr),Mr);return this.toTensorData(Dr,zr)})}async readTextureAsync(Pr,Dr,Mr){const Fr=Pr.tensor.dataId;if(Mr||(Mr=1),this.pendingRead.has(Fr)){const zr=this.pendingRead.get(Fr);return new Promise(jr=>zr==null?void 0:zr.push(jr))}return this.profiler.event("backend","TextureManager.readTextureAsync",async()=>{this.pendingRead.set(Fr,[]);const zr=Pr.shape.reduce((Lr,Ur)=>Lr*Ur)*Mr;await this.glContext.createAndWaitForFence();const jr=this.glContext.readTexture(Pr.texture,Pr.width,Pr.height,zr,this.toEncoderType(Dr),Mr),Gr=this.toTensorData(Dr,jr),Nr=this.pendingRead.get(Fr);return this.pendingRead.delete(Fr),Nr==null||Nr.forEach(Lr=>Lr(Gr)),Gr})}readUint8TextureAsFloat(Pr){return this.profiler.event("backend","TextureManager.readUint8TextureAsFloat",()=>{const Dr=Pr.shape.reduce((Fr,zr)=>Fr*zr),Mr=this.glContext.readTexture(Pr.texture,Pr.width,Pr.height,4*Dr,"byte",4);return new Float32Array(Mr.buffer,Mr.byteOffset,Dr)})}releaseTexture(Pr,Dr){let Mr;if(this.config.reuseTextures&&(Mr=this.textureLookup.get(Pr.texture),Mr)){Dr&&this.textureLookup.delete(Mr);const Fr=this.inUseTextures.get(Mr);if(Fr){const zr=Fr.indexOf(Pr.texture);if(zr!==-1){Fr.splice(zr,1);let jr=this.idleTextures.get(Mr);jr||(jr=[],this.idleTextures.set(Mr,jr)),jr.push(Pr.texture)}}}Mr&&!Dr||(Rr.Logger.verbose("TextureManager",`Deleting texture of size ${Pr.width}x${Pr.height}`),this.glContext.deleteTexture(Pr.texture))}toTensorData(Pr,Dr){switch(Pr){case"int16":return Dr instanceof Int16Array?Dr:Int16Array.from(Dr);case"int32":return Dr instanceof Int32Array?Dr:Int32Array.from(Dr);case"int8":return Dr instanceof Int8Array?Dr:Int8Array.from(Dr);case"uint16":return Dr instanceof Uint16Array?Dr:Uint16Array.from(Dr);case"uint32":return Dr instanceof Uint32Array?Dr:Uint32Array.from(Dr);case"uint8":case"bool":return Dr instanceof Uint8Array?Dr:Uint8Array.from(Dr);case"float32":return Dr instanceof Float32Array?Dr:Float32Array.from(Dr);case"float64":return Dr instanceof Float64Array?Dr:Float64Array.from(Dr);default:throw new Error(`TensorData type ${Pr} is not supported`)}}toTextureData(Pr,Dr){if(Dr)return Dr instanceof Float32Array?Dr:new Float32Array(Dr)}toEncoderType(Pr){return"float"}clearActiveTextures(){this.glContext.clearActiveTextures()}}},5639:(_r,Tr)=>{var Ar;Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.TextureType=void 0,(Ar=Tr.TextureType||(Tr.TextureType={}))[Ar.unpacked=0]="unpacked",Ar[Ar.unpackedReversed=1]="unpackedReversed",Ar[Ar.packed=2]="packed",Ar[Ar.downloadUint8AsFloat=3]="downloadUint8AsFloat",Ar[Ar.packedLastDimension=4]="packedLastDimension"},432:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.getGlChannels=Tr.getCoordsDataType=Tr.getSqueezedParams=Tr.squeezeInputShape=Tr.generateShaderFuncNameFromInputSamplerNameAtOutCoords=Tr.generateShaderFuncNameFromInputSamplerName=Tr.repeatedTry=Tr.getPackedShape=void 0;const Rr=Ar(7273);Tr.getPackedShape=function(Pr){const Dr=Pr.length;return Pr.slice(0,Dr-1).concat(Pr[Dr-1]/4)},Tr.repeatedTry=async function(Pr,Dr=Fr=>0,Mr){return new Promise((Fr,zr)=>{let jr=0;const Gr=()=>{if(Pr())return void Fr();jr++;const Nr=Dr(jr);Mr!=null&&jr>=Mr?zr():setTimeout(Gr,Nr)};Gr()})},Tr.generateShaderFuncNameFromInputSamplerName=function(Pr){return(0,Rr.assert)(Pr!==void 0&&Pr.length!==0,()=>"empty string found for sampler name"),"get"+Pr.charAt(0).toUpperCase()+Pr.slice(1)},Tr.generateShaderFuncNameFromInputSamplerNameAtOutCoords=function(Pr){return(0,Rr.assert)(Pr!==void 0&&Pr.length!==0,()=>"empty string found for sampler name"),"get"+Pr.charAt(0).toUpperCase()+Pr.slice(1)+"AtOutCoords"},Tr.squeezeInputShape=function(Pr,Dr){let Mr=JSON.parse(JSON.stringify(Pr));return Mr=Dr,Mr},Tr.getSqueezedParams=function(Pr,Dr){return Dr.map(Mr=>Pr[Mr]).join(", ")},Tr.getCoordsDataType=function(Pr){if(Pr<=1)return"int";if(Pr===2)return"ivec2";if(Pr===3)return"ivec3";if(Pr===4)return"ivec4";if(Pr===5)return"ivec5";if(Pr===6)return"ivec6";throw Error(`GPU for rank ${Pr} is not yet supported`)},Tr.getGlChannels=function(Pr=6){return["x","y","z","w","u","v"].slice(0,Pr)}},3389:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.createNewWebGLContext=Tr.createWebGLContext=void 0;const Rr=Ar(1315),Pr=Ar(3524),Dr={};function Mr(Fr){const zr=function(){if(typeof document>"u"){if(typeof OffscreenCanvas>"u")throw new TypeError("failed to create canvas: OffscreenCanvas is not supported");return new OffscreenCanvas(1,1)}const Nr=document.createElement("canvas");return Nr.width=1,Nr.height=1,Nr}();let jr;const Gr={alpha:!1,depth:!1,antialias:!1,stencil:!1,preserveDrawingBuffer:!1,premultipliedAlpha:!1,failIfMajorPerformanceCaveat:!1};if((!Fr||Fr==="webgl2")&&(jr=zr.getContext("webgl2",Gr),jr))try{return new Pr.WebGLContext(jr,2)}catch(Nr){Rr.Logger.warning("GlContextFactory",`failed to create WebGLContext using contextId 'webgl2'. Error: ${Nr}`)}if((!Fr||Fr==="webgl")&&(jr=zr.getContext("webgl",Gr)||zr.getContext("experimental-webgl",Gr),jr))try{return new Pr.WebGLContext(jr,1)}catch(Nr){Rr.Logger.warning("GlContextFactory",`failed to create WebGLContext using contextId 'webgl' or 'experimental-webgl'. Error: ${Nr}`)}throw new Error("WebGL is not supported")}Tr.createWebGLContext=function Fr(zr){let jr;zr&&zr!=="webgl2"||!("webgl2"in Dr)?zr&&zr!=="webgl"||!("webgl"in Dr)||(jr=Dr.webgl):jr=Dr.webgl2,jr=jr||Mr(zr),zr=zr||jr.version===1?"webgl":"webgl2";const Gr=jr.gl;return Dr[zr]=jr,Gr.isContextLost()?(delete Dr[zr],Fr(zr)):(Gr.disable(Gr.DEPTH_TEST),Gr.disable(Gr.STENCIL_TEST),Gr.disable(Gr.BLEND),Gr.disable(Gr.DITHER),Gr.disable(Gr.POLYGON_OFFSET_FILL),Gr.disable(Gr.SAMPLE_COVERAGE),Gr.enable(Gr.SCISSOR_TEST),Gr.enable(Gr.CULL_FACE),Gr.cullFace(Gr.BACK),jr)},Tr.createNewWebGLContext=Mr},3524:function(_r,Tr,Ar){var Rr=this&&this.__createBinding||(Object.create?function(Gr,Nr,Lr,Ur){Ur===void 0&&(Ur=Lr);var Vr=Object.getOwnPropertyDescriptor(Nr,Lr);Vr&&!("get"in Vr?!Nr.__esModule:Vr.writable||Vr.configurable)||(Vr={enumerable:!0,get:function(){return Nr[Lr]}}),Object.defineProperty(Gr,Ur,Vr)}:function(Gr,Nr,Lr,Ur){Ur===void 0&&(Ur=Lr),Gr[Ur]=Nr[Lr]}),Pr=this&&this.__setModuleDefault||(Object.create?function(Gr,Nr){Object.defineProperty(Gr,"default",{enumerable:!0,value:Nr})}:function(Gr,Nr){Gr.default=Nr}),Dr=this&&this.__importStar||function(Gr){if(Gr&&Gr.__esModule)return Gr;var Nr={};if(Gr!=null)for(var Lr in Gr)Lr!=="default"&&Object.prototype.hasOwnProperty.call(Gr,Lr)&&Rr(Nr,Gr,Lr);return Pr(Nr,Gr),Nr};Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.WebGLContext=Tr.linearSearchLastTrue=void 0;const Mr=Ar(8453),Fr=Dr(Ar(9622)),zr=Ar(432);function jr(Gr){let Nr=0;for(;Nr<Gr.length&&Gr[Nr]();++Nr);return Nr-1}Tr.linearSearchLastTrue=jr,Tr.WebGLContext=class{constructor(Gr,Nr){this.frameBufferBound=!1,this.itemsToPoll=[],this.gl=Gr,this.version=Nr,this.getExtensions(),this.vertexbuffer=this.createVertexbuffer(),this.framebuffer=this.createFramebuffer(),this.queryVitalParameters()}allocateTexture(Gr,Nr,Lr,Ur){const Vr=this.gl,Wr=Vr.createTexture();Vr.bindTexture(Vr.TEXTURE_2D,Wr),Vr.texParameteri(Vr.TEXTURE_2D,Vr.TEXTURE_MIN_FILTER,Vr.NEAREST),Vr.texParameteri(Vr.TEXTURE_2D,Vr.TEXTURE_MAG_FILTER,Vr.NEAREST),Vr.texParameteri(Vr.TEXTURE_2D,Vr.TEXTURE_WRAP_S,Vr.CLAMP_TO_EDGE),Vr.texParameteri(Vr.TEXTURE_2D,Vr.TEXTURE_WRAP_T,Vr.CLAMP_TO_EDGE);const qr=Ur?Lr.encode(Ur,Gr*Nr):null;return Vr.texImage2D(Vr.TEXTURE_2D,0,Lr.internalFormat,Gr,Nr,0,Lr.format,Lr.textureType,qr),this.checkError(),Wr}updateTexture(Gr,Nr,Lr,Ur,Vr){const Wr=this.gl;Wr.bindTexture(Wr.TEXTURE_2D,Gr);const qr=Ur.encode(Vr,Nr*Lr);Wr.texSubImage2D(Wr.TEXTURE_2D,0,0,0,Nr,Lr,Ur.format,Ur.textureType,qr),this.checkError()}attachFramebuffer(Gr,Nr,Lr){const Ur=this.gl;Ur.bindTexture(Ur.TEXTURE_2D,Gr),Ur.bindFramebuffer(Ur.FRAMEBUFFER,this.framebuffer),Ur.framebufferTexture2D(Ur.FRAMEBUFFER,Ur.COLOR_ATTACHMENT0,Ur.TEXTURE_2D,Gr,0),this.checkError(),Ur.viewport(0,0,Nr,Lr),Ur.scissor(0,0,Nr,Lr)}readTexture(Gr,Nr,Lr,Ur,Vr,Wr){const qr=this.gl;Wr||(Wr=1),this.frameBufferBound||this.attachFramebuffer(Gr,Nr,Lr);const Kr=this.getEncoder(Vr,Wr),Xr=Kr.allocate(Nr*Lr);return qr.bindTexture(qr.TEXTURE_2D,Gr),qr.framebufferTexture2D(qr.FRAMEBUFFER,qr.COLOR_ATTACHMENT0,qr.TEXTURE_2D,Gr,0),qr.readPixels(0,0,Nr,Lr,qr.RGBA,Kr.textureType,Xr),this.checkError(),Kr.decode(Xr,Ur)}isFramebufferReady(){return!0}getActiveTexture(){const Gr=this.gl;return"TEXTURE"+(Gr.getParameter(this.gl.ACTIVE_TEXTURE)-Gr.TEXTURE0)}getTextureBinding(){return this.gl.getParameter(this.gl.TEXTURE_BINDING_2D)}getFramebufferBinding(){return this.gl.getParameter(this.gl.FRAMEBUFFER_BINDING)}setVertexAttributes(Gr,Nr){const Lr=this.gl;Lr.vertexAttribPointer(Gr,3,Lr.FLOAT,!1,20,0),Lr.enableVertexAttribArray(Gr),Nr!==-1&&(Lr.vertexAttribPointer(Nr,2,Lr.FLOAT,!1,20,12),Lr.enableVertexAttribArray(Nr)),this.checkError()}createProgram(Gr,Nr){const Lr=this.gl,Ur=Lr.createProgram();return Lr.attachShader(Ur,Gr),Lr.attachShader(Ur,Nr),Lr.linkProgram(Ur),Ur}compileShader(Gr,Nr){const Lr=this.gl,Ur=Lr.createShader(Nr);if(!Ur)throw new Error(`createShader() returned null with type ${Nr}`);if(Lr.shaderSource(Ur,Gr),Lr.compileShader(Ur),Lr.getShaderParameter(Ur,Lr.COMPILE_STATUS)===!1)throw new Error(`Failed to compile shader: ${Lr.getShaderInfoLog(Ur)}
Shader source:
${Gr}`);return Ur}deleteShader(Gr){this.gl.deleteShader(Gr)}bindTextureToUniform(Gr,Nr,Lr){const Ur=this.gl;Ur.activeTexture(Ur.TEXTURE0+Nr),this.checkError(),Ur.bindTexture(Ur.TEXTURE_2D,Gr),this.checkError(),Ur.uniform1i(Lr,Nr),this.checkError()}draw(){this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.checkError()}checkError(){if(Mr.env.debug){const Gr=this.gl,Nr=Gr.getError();let Lr="";switch(Nr){case Gr.NO_ERROR:return;case Gr.INVALID_ENUM:Lr="INVALID_ENUM";break;case Gr.INVALID_VALUE:Lr="INVALID_VALUE";break;case Gr.INVALID_OPERATION:Lr="INVALID_OPERATION";break;case Gr.INVALID_FRAMEBUFFER_OPERATION:Lr="INVALID_FRAMEBUFFER_OPERATION";break;case Gr.OUT_OF_MEMORY:Lr="OUT_OF_MEMORY";break;case Gr.CONTEXT_LOST_WEBGL:Lr="CONTEXT_LOST_WEBGL";break;default:Lr=`Unknown WebGL Error: ${Nr.toString(16)}`}throw new Error(Lr)}}deleteTexture(Gr){this.gl.deleteTexture(Gr)}deleteProgram(Gr){this.gl.deleteProgram(Gr)}getEncoder(Gr,Nr,Lr=0){if(this.version===2)return new Fr.RedFloat32DataEncoder(this.gl,Nr);switch(Gr){case"float":return Lr===1||this.isRenderFloat32Supported?new Fr.RGBAFloatDataEncoder(this.gl,Nr):new Fr.RGBAFloatDataEncoder(this.gl,Nr,this.textureHalfFloatExtension.HALF_FLOAT_OES);case"int":throw new Error("not implemented");case"byte":return new Fr.Uint8DataEncoder(this.gl,Nr);default:throw new Error(`Invalid dataType: ${Gr}`)}}clearActiveTextures(){const Gr=this.gl;for(let Nr=0;Nr<this.maxTextureImageUnits;++Nr)Gr.activeTexture(Gr.TEXTURE0+Nr),Gr.bindTexture(Gr.TEXTURE_2D,null)}dispose(){if(this.disposed)return;const Gr=this.gl;Gr.bindFramebuffer(Gr.FRAMEBUFFER,null),Gr.deleteFramebuffer(this.framebuffer),Gr.bindBuffer(Gr.ARRAY_BUFFER,null),Gr.deleteBuffer(this.vertexbuffer),Gr.bindBuffer(Gr.ELEMENT_ARRAY_BUFFER,null),Gr.finish(),this.disposed=!0}createDefaultGeometry(){return new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0])}createVertexbuffer(){const Gr=this.gl,Nr=Gr.createBuffer();if(!Nr)throw new Error("createBuffer() returned null");const Lr=this.createDefaultGeometry();return Gr.bindBuffer(Gr.ARRAY_BUFFER,Nr),Gr.bufferData(Gr.ARRAY_BUFFER,Lr,Gr.STATIC_DRAW),this.checkError(),Nr}createFramebuffer(){const Gr=this.gl.createFramebuffer();if(!Gr)throw new Error("createFramebuffer returned null");return Gr}queryVitalParameters(){const Gr=this.gl;if(this.isFloatTextureAttachableToFrameBuffer=this.checkFloatTextureAttachableToFrameBuffer(),this.isRenderFloat32Supported=this.checkRenderFloat32(),this.isFloat32DownloadSupported=this.checkFloat32Download(),this.version===1&&!this.textureHalfFloatExtension&&!this.isRenderFloat32Supported)throw new Error("both float32 and float16 TextureType are not supported");this.isBlendSupported=!this.isRenderFloat32Supported||this.checkFloat32Blend(),this.maxTextureSize=Gr.getParameter(Gr.MAX_TEXTURE_SIZE),this.maxTextureImageUnits=Gr.getParameter(Gr.MAX_TEXTURE_IMAGE_UNITS),this.version}getExtensions(){this.version===2?(this.colorBufferFloatExtension=this.gl.getExtension("EXT_color_buffer_float"),this.disjointTimerQueryWebgl2Extension=this.gl.getExtension("EXT_disjoint_timer_query_webgl2")):(this.textureFloatExtension=this.gl.getExtension("OES_texture_float"),this.textureHalfFloatExtension=this.gl.getExtension("OES_texture_half_float"))}checkFloatTextureAttachableToFrameBuffer(){const Gr=this.gl,Nr=Gr.createTexture();Gr.bindTexture(Gr.TEXTURE_2D,Nr);const Lr=this.version===2?Gr.RGBA32F:Gr.RGBA;Gr.texImage2D(Gr.TEXTURE_2D,0,Lr,1,1,0,Gr.RGBA,Gr.FLOAT,null);const Ur=Gr.createFramebuffer();Gr.bindFramebuffer(Gr.FRAMEBUFFER,Ur),Gr.framebufferTexture2D(Gr.FRAMEBUFFER,Gr.COLOR_ATTACHMENT0,Gr.TEXTURE_2D,Nr,0);const Vr=Gr.checkFramebufferStatus(Gr.FRAMEBUFFER)===Gr.FRAMEBUFFER_COMPLETE;return Gr.bindTexture(Gr.TEXTURE_2D,null),Gr.bindFramebuffer(Gr.FRAMEBUFFER,null),Gr.deleteTexture(Nr),Gr.deleteFramebuffer(Ur),Vr}checkRenderFloat32(){if(this.version===2){if(!this.colorBufferFloatExtension)return!1}else if(!this.textureFloatExtension)return!1;return this.isFloatTextureAttachableToFrameBuffer}checkFloat32Download(){if(this.version===2){if(!this.colorBufferFloatExtension)return!1}else if(!this.textureFloatExtension||!this.gl.getExtension("WEBGL_color_buffer_float"))return!1;return this.isFloatTextureAttachableToFrameBuffer}checkFloat32Blend(){const Gr=this.gl;let Nr,Lr,Ur,Vr,Wr;try{Nr=Gr.createTexture(),Lr=Gr.createFramebuffer(),Gr.bindTexture(Gr.TEXTURE_2D,Nr);const qr=this.version===2?Gr.RGBA32F:Gr.RGBA;return Gr.texImage2D(Gr.TEXTURE_2D,0,qr,1,1,0,Gr.RGBA,Gr.FLOAT,null),Gr.bindFramebuffer(Gr.FRAMEBUFFER,Lr),Gr.framebufferTexture2D(Gr.FRAMEBUFFER,Gr.COLOR_ATTACHMENT0,Gr.TEXTURE_2D,Nr,0),Gr.enable(Gr.BLEND),Ur=Gr.createShader(Gr.VERTEX_SHADER),!!Ur&&(Gr.shaderSource(Ur,"void main(){}"),Gr.compileShader(Ur),Vr=Gr.createShader(Gr.FRAGMENT_SHADER),!!Vr&&(Gr.shaderSource(Vr,"precision highp float;void main(){gl_FragColor=vec4(0.5);}"),Gr.compileShader(Vr),Wr=Gr.createProgram(),!!Wr&&(Gr.attachShader(Wr,Ur),Gr.attachShader(Wr,Vr),Gr.linkProgram(Wr),Gr.useProgram(Wr),Gr.drawArrays(Gr.POINTS,0,1),Gr.getError()===Gr.NO_ERROR)))}finally{Gr.disable(Gr.BLEND),Wr&&Gr.deleteProgram(Wr),Ur&&Gr.deleteShader(Ur),Vr&&Gr.deleteShader(Vr),Lr&&(Gr.bindFramebuffer(Gr.FRAMEBUFFER,null),Gr.deleteFramebuffer(Lr)),Nr&&(Gr.bindTexture(Gr.TEXTURE_2D,null),Gr.deleteTexture(Nr))}}beginTimer(){if(this.version===2&&this.disjointTimerQueryWebgl2Extension){const Gr=this.gl,Nr=this.disjointTimerQueryWebgl2Extension,Lr=Gr.createQuery();return Gr.beginQuery(Nr.TIME_ELAPSED_EXT,Lr),Lr}throw new Error("WebGL1 profiling currently not supported.")}endTimer(){if(this.version!==2||!this.disjointTimerQueryWebgl2Extension)throw new Error("WebGL1 profiling currently not supported");{const Gr=this.gl,Nr=this.disjointTimerQueryWebgl2Extension;Gr.endQuery(Nr.TIME_ELAPSED_EXT)}}isTimerResultAvailable(Gr){let Nr=!1,Lr=!1;if(this.version!==2||!this.disjointTimerQueryWebgl2Extension)throw new Error("WebGL1 profiling currently not supported");{const Ur=this.gl,Vr=this.disjointTimerQueryWebgl2Extension;Nr=Ur.getQueryParameter(Gr,Ur.QUERY_RESULT_AVAILABLE),Lr=Ur.getParameter(Vr.GPU_DISJOINT_EXT)}return Nr&&!Lr}getTimerResult(Gr){let Nr=0;if(this.version!==2)throw new Error("WebGL1 profiling currently not supported");{const Lr=this.gl;Nr=Lr.getQueryParameter(Gr,Lr.QUERY_RESULT),Lr.deleteQuery(Gr)}return Nr/1e6}async waitForQueryAndGetTime(Gr){return await(0,zr.repeatedTry)(()=>this.isTimerResultAvailable(Gr)),this.getTimerResult(Gr)}async createAndWaitForFence(){const Gr=this.createFence(this.gl);return this.pollFence(Gr)}createFence(Gr){let Nr;const Lr=Gr,Ur=Lr.fenceSync(Lr.SYNC_GPU_COMMANDS_COMPLETE,0);return Gr.flush(),Nr=Ur===null?()=>!0:()=>{const Vr=Lr.clientWaitSync(Ur,0,0);return Vr===Lr.ALREADY_SIGNALED||Vr===Lr.CONDITION_SATISFIED},{query:Ur,isFencePassed:Nr}}async pollFence(Gr){return new Promise(Nr=>{this.addItemToPoll(()=>Gr.isFencePassed(),()=>Nr())})}pollItems(){const Gr=jr(this.itemsToPoll.map(Nr=>Nr.isDoneFn));for(let Nr=0;Nr<=Gr;++Nr){const{resolveFn:Lr}=this.itemsToPoll[Nr];Lr()}this.itemsToPoll=this.itemsToPoll.slice(Gr+1)}async addItemToPoll(Gr,Nr){this.itemsToPoll.push({isDoneFn:Gr,resolveFn:Nr}),this.itemsToPoll.length>1||await(0,zr.repeatedTry)(()=>(this.pollItems(),this.itemsToPoll.length===0))}}},6496:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.ExecutionPlan=void 0;const Rr=Ar(1315);class Pr{constructor(Mr,Fr){this.op=Mr,this.node=Fr}}Tr.ExecutionPlan=class{constructor(Dr,Mr,Fr){this.graph=Dr,this.profiler=Fr,this.initialize(Mr)}initialize(Dr){this.profiler.event("session","ExecutionPlan.initialize",()=>{const Mr=this.graph.getNodes();if(Mr.length!==Dr.length)throw new Error("The size of nodes and OPs do not match.");this._ops=Dr.map((Fr,zr)=>new Pr(Fr,Mr[zr])),this.reset(),this._starter=[],this._ops.forEach((Fr,zr)=>{let jr=!0;for(const Gr of Fr.node.inputs)if(!this._values[Gr]&&this.graph.getInputIndices().indexOf(Gr)===-1){jr=!1;break}jr&&this._starter.push(zr)})})}reset(){this._values=this.graph.getValues().map(Dr=>Dr.tensor)}async execute(Dr,Mr){return this.profiler.event("session","ExecutionPlan.execute",async()=>{this.reset();const Fr=Dr.createInferenceHandler(),zr=this.graph.getInputIndices();if(Mr.length!==zr.length)throw new Error(`number of input tensors don't match the number of inputs to the model: actual: ${Mr.length} expected: ${zr.length}`);Mr.forEach((Vr,Wr)=>{const qr=zr[Wr];this._values[qr]=Vr});const jr=this._starter.slice(0),Gr=this.graph.getValues(),Nr=this.graph.getNodes();let Lr=0;for(;Lr<jr.length;){const Vr=jr[Lr++],Wr=this._ops[Vr],qr=Wr.node.inputs.map(_i=>this._values[_i]);if(qr.indexOf(void 0)!==-1)throw new Error(`unresolved input detected: op: ${Wr.node}`);const Kr=qr;Rr.Logger.verbose("ExecPlan",`Runing op:${Wr.node.name} (${Kr.map((_i,Jr)=>`'${Wr.node.inputs[Jr]}': ${_i.type}[${_i.dims.join(",")}]`).join(", ")})`);const Xr=await this.profiler.event("node",Wr.node.name,async()=>Wr.op.impl(Fr,Kr,Wr.op.context));if(Xr.length!==Wr.node.outputs.length)throw new Error("the size of output does not match model definition.");Xr.forEach((_i,Jr)=>{const es=Wr.node.outputs[Jr];if(this._values[es])throw new Error(`output [${es}] already has value: op:${Wr.node.name}`);this._values[es]=_i});const Zr=new Set;Xr.forEach((_i,Jr)=>{const es=Wr.node.outputs[Jr];for(const ts of Gr[es].to){const is=Nr[ts];let rs=!0;for(const as of is.inputs)if(!this._values[as]){rs=!1;break}rs&&Zr.add(ts)}}),jr.push(...Zr)}const Ur=[];for(let Vr=0;Vr<this.graph.getOutputIndices().length;Vr++){const Wr=this.graph.getOutputIndices()[Vr],qr=this._values[Wr];if(qr===void 0)throw new Error(`required output [${Wr}] does not have value`);Wr===0?await qr.getData():qr.data,Ur.push(qr)}return Rr.Logger.verbose("ExecPlan","disposing of inferenceHandler"),Fr.dispose(),Ur})}}},4662:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.Graph=void 0;const Rr=Ar(1446),Pr=Ar(6874),Dr=Ar(1287),Mr=Ar(9240),Fr=Ar(7273);var zr=Dr.onnxruntime.experimental.fbs;Tr.Graph={from:(Lr,Ur)=>new Nr(Lr,Ur)};class jr{constructor(Ur){this._from=void 0,this._to=[],this.tensor=void 0,this.type=void 0,Ur&&(this.type=Fr.ProtoUtil.tensorValueTypeFromProto(Ur.type.tensorType))}get from(){return this._from}get to(){return this._to}}class Gr{constructor(Ur,Vr){Ur instanceof Rr.onnx.NodeProto?(this.name=Ur.name,this.opType=Ur.opType,this.attributes=new Pr.Attribute(Ur.attribute)):Ur instanceof zr.Node&&(this.name=Vr??Ur.name(),this.opType=Ur.opType(),this.attributes=new Pr.Attribute(Fr.ProtoUtil.tensorAttributesFromORTFormat(Ur))),this.inputs=[],this.outputs=[],this.executeNode=!0}}class Nr{constructor(Ur,Vr){if(!Ur)throw new TypeError("graph is empty");this.buildGraph(Ur),this.transformGraph(Vr),this.checkIsAcyclic()}getInputIndices(){return this._allInputIndices}getInputNames(){return this._allInputNames}getOutputIndices(){return this._allOutputIndices}getOutputNames(){return this._allOutputNames}getValues(){return this._allData}getNodes(){return this._nodes}buildGraph(Ur){if(Ur instanceof Rr.onnx.GraphProto)this.buildGraphFromOnnxFormat(Ur);else{if(!(Ur instanceof zr.Graph))throw new TypeError("Graph type is not supported.");this.buildGraphFromOrtFormat(Ur)}}buildGraphFromOnnxFormat(Ur){const Vr=new Map;this._allData=[],this._allInputIndices=[],this._allInputNames=[],this._allOutputIndices=[],this._allOutputNames=[],this._nodes=[];const Wr=new Map;if(!Ur.input)throw new Error("missing information in graph: input");const qr=[];for(const Kr of Ur.input){if(Vr.has(Kr.name))throw new Error(`duplicated input name: ${Kr.name}`);const Xr=this._allData.push(new jr(Kr))-1;Vr.set(Kr.name,Xr),qr.push(Kr.name)}if(!Ur.initializer)throw new Error("missing information in graph: initializer");for(const Kr of Ur.initializer){let Xr=Vr.get(Kr.name);if(Xr===void 0){const Zr=new jr;Zr.type={shape:{dims:Fr.ProtoUtil.tensorDimsFromProto(Kr.dims)},tensorType:Fr.ProtoUtil.tensorDataTypeFromProto(Kr.dataType)},Xr=this._allData.push(Zr)-1,Vr.set(Kr.name,Xr)}this._allData[Xr]._from=-1,this._allData[Xr].tensor=Mr.Tensor.fromProto(Kr)}for(let Kr=0;Kr<this._allData.length;Kr++)this._allData[Kr].tensor||(this._allInputIndices.push(Kr),this._allInputNames.push(qr[Kr]));if(!Ur.output)throw new Error("missing information in graph: output");for(const Kr of Ur.output){if(Vr.has(Kr.name))throw new Error(`duplicated output name: ${Kr.name}`);const Xr=this._allData.push(new jr(Kr))-1;Vr.set(Kr.name,Xr),this._allOutputIndices.push(Xr),this._allOutputNames.push(Kr.name)}if(!Ur.node)throw new Error("missing information in graph: node");for(const Kr of Ur.node){if(!Kr.name)for(let Zr=0;;Zr++){const _i=`unnamed_${Kr.opType}_${Zr}`;if(!Wr.has(_i)){Kr.name=_i;break}}if(Wr.has(Kr.name))throw new Error(`duplicated node name: ${Kr.name}`);const Xr=this._nodes.push(new Gr(Kr))-1;Wr.set(Kr.name,Xr)}for(let Kr=0;Kr<this._nodes.length;Kr++){const Xr=this._nodes[Kr],Zr=Ur.node[Kr];if(!Zr.output)throw new Error(`missing output for node: ${Zr.name}`);for(const _i of Zr.output){let Jr=Vr.get(_i);if(Jr===void 0&&(Jr=this._allData.push(new jr)-1,Vr.set(_i,Jr)),Xr.outputs.push(Jr),this._allData[Jr]._from!==void 0)throw new Error(`multiple nodes output to one data value: ${Jr}`);if(this._allData[Jr]._from=Kr,Zr.opType==="Constant"){if(!Zr.attribute||Zr.attribute.length!==1||!Zr.attribute[0].t)throw new Error("missing attributes or missing tensor value in attributes for this Constant operator");if(!Zr.output||Zr.output.length!==1)throw new Error("missing output or incorrect number of outputs for this Constant operator");Xr.outputs.pop(),Xr.executeNode=!1,this._allData[Jr]._from=-1,this._allData[Jr].tensor=Mr.Tensor.fromProto(Zr.attribute[0].t)}}}for(let Kr=0;Kr<this._nodes.length;Kr++){const Xr=this._nodes[Kr],Zr=Ur.node[Kr];if(!Zr.input)throw new Error(`missing input for node: ${Zr.name}`);for(const _i of Zr.input){const Jr=Vr.get(_i);if(Jr===void 0){if(_i===""&&Zr.input.length===3&&Zr.opType==="Resize")continue;throw new Error(`unrecognized input '${_i}' for node: ${Zr.name}`)}Xr.inputs.push(Jr),this._allData[Jr]._to.push(Kr)}}return!0}buildGraphFromOrtFormat(Ur){var Vr,Wr,qr;const Kr=new Map;this._allData=[],this._allInputIndices=[],this._allInputNames=[],this._allOutputIndices=[],this._allOutputNames=[],this._nodes=[];const Xr=new Map,Zr=[];for(let _i=0;_i<Ur.inputsLength();_i++){const Jr=Ur.inputs(_i);if(Kr.has(Jr))throw new Error(`duplicated input name: ${Jr}`);for(let es=0;es<Ur.nodeArgsLength();es++)if(((Vr=Ur.nodeArgs(es))===null||Vr===void 0?void 0:Vr.name())===Jr){const ts=new jr;if(((qr=(Wr=Ur.nodeArgs(es))===null||Wr===void 0?void 0:Wr.type())===null||qr===void 0?void 0:qr.valueType())!==zr.TypeInfoValue.tensor_type)throw new Error("Unexpected value type for the nodeArg.");const is=Ur.nodeArgs(es).type().value(new zr.TensorTypeAndShape),rs=Fr.ProtoUtil.tensorDataTypeFromProto(is.elemType()),as=is.shape(),ls=[];for(let Ts=0;Ts<as.dimLength();Ts++)ls.push(Fr.LongUtil.longToNumber(as.dim(Ts).value().dimValue()));ts.type={shape:{dims:ls},tensorType:rs};const fs=this._allData.push(ts)-1;Kr.set(Jr,fs),Zr.push(Jr)}}for(let _i=0;_i<Ur.initializersLength();_i++){const Jr=Ur.initializers(_i);let es=Kr.get(Jr.name());if(es===void 0){const ts=new jr,is=Fr.ProtoUtil.tensorDimsFromORTFormat(Jr),rs=Fr.ProtoUtil.tensorDataTypeFromProto(Jr.dataType());ts.type={shape:{dims:is},tensorType:rs},es=this._allData.push(ts)-1,Kr.set(Jr.name(),es)}this._allData[es]._from=-1,this._allData[es].tensor=Mr.Tensor.fromOrtTensor(Jr)}for(let _i=0;_i<this._allData.length;_i++)this._allData[_i].tensor||(this._allInputIndices.push(_i),this._allInputNames.push(Zr[_i]));for(let _i=0;_i<Ur.outputsLength();_i++){const Jr=Ur.outputs(_i);if(Kr.has(Jr))throw new Error(`duplicated output name: ${Jr}`);const es=this._allData.push(new jr)-1;Kr.set(Jr,es),this._allOutputIndices.push(es),this._allOutputNames.push(Jr)}if(!Ur.nodes)throw new Error("missing information in graph: node");for(let _i=0;_i<Ur.nodesLength();_i++){const Jr=Ur.nodes(_i);let es=Jr.name();if(!es)for(let is=0;es=`unnamed_${Jr.opType()}_${is}`,Xr.has(es);is++);if(Xr.has(es))throw new Error(`duplicated node name: ${es}`);const ts=this._nodes.push(new Gr(Jr,es))-1;Xr.set(es,ts)}for(let _i=0;_i<this._nodes.length;_i++){const Jr=this._nodes[_i],es=Ur.nodes(_i);if(es==null)throw new Error(`No node exists at index ${_i}`);if((es==null?void 0:es.outputsLength())===0)throw new Error(`missing output for node: ${es.name}`);for(let ts=0;ts<(es==null?void 0:es.outputsLength());ts++){const is=es==null?void 0:es.outputs(ts);let rs=Kr.get(is);if(rs===void 0&&(rs=this._allData.push(new jr)-1,Kr.set(is,rs)),Jr.outputs.push(rs),this._allData[rs]._from!==void 0)throw new Error(`multiple nodes output to one data value: ${rs}`);if(this._allData[rs]._from=_i,es.opType()==="Constant"){if(es.attributesLength()!==1||!es.attributes(0).t())throw new Error("missing attributes or missing tensor value in attributes for this Constant operator");if(es.outputsLength()!==1)throw new Error("missing output or incorrect number of outputs for this Constant operator");Jr.outputs.pop(),Jr.executeNode=!1,this._allData[rs]._from=-1,this._allData[rs].tensor=Mr.Tensor.fromOrtTensor(es.attributes(0).t())}}}for(let _i=0;_i<this._nodes.length;_i++){const Jr=this._nodes[_i],es=Ur.nodes(_i);if(es.inputsLength()===0)throw new Error(`missing input for node: ${es.name}`);for(let ts=0;ts<es.inputsLength();ts++){const is=es.inputs(ts),rs=Kr.get(is);if(rs===void 0)throw new Error(`unrecognized input '${is}' for node: ${es.name()}`);Jr.inputs.push(rs),this._allData[rs]._to.push(_i)}}}checkIsAcyclic(){const Ur=new Set;this._allInputIndices.forEach(qr=>{this._allData[qr]._to.forEach(Kr=>{Ur.add(Kr)})});const Vr=Array.from(Ur),Wr=new Array(this._nodes.length).fill("white");for(;Vr.length>0;){const qr=Vr.pop();Wr[qr]==="gray"?Wr[qr]="black":(Vr.push(qr),Wr[qr]="gray",this._nodes[qr].outputs.forEach(Kr=>{const Xr=this._allData[Kr];if(Xr.tensor!==void 0)throw new Error("node outputs should not be initialized");if(Xr._from!==qr)throw new Error("from property of the Value object doesn't match index of Node being processed");Xr._to.forEach(Zr=>{if(Wr[Zr]==="gray")throw new Error("model graph is cyclic");Wr[Zr]==="white"&&Vr.push(Zr)})}))}}transformGraph(Ur){this.removeAllIdentityNodes(),this.removeAllDropoutNodes(),this.fuseConvActivationNodes(),Ur&&Ur.transformGraph(this),this.finalizeGraph()}finalizeGraph(){let Ur=0;const Vr=new Array(this._nodes.length,0);let Wr=0;for(let qr=0;qr<this._nodes.length;qr++)Vr[qr]=Wr,this._nodes[qr].executeNode?(Wr!==qr&&(this._nodes[Wr]=this._nodes[qr]),Wr++):this._nodes[qr].outputs.forEach(Kr=>{this._allData[Kr]._from=-2});this._nodes.splice(Wr,this._nodes.length-Wr);for(let qr=0;qr<this._allData.length;qr++){const Kr=this._allData[qr];Kr._from!==void 0&&Kr._from!==-1&&Kr._from!==-2&&(Kr._from=Vr[Kr._from]);for(let Xr=0;Xr<Kr._to.length;Xr++){if(!(Kr._to[Xr]>=0))throw new Error("Trying to update a removed node");Kr._to[Xr]=Vr[Kr._to[Xr]]}}Ur=0;for(let qr=0;qr<this._allData.length;qr++)if(this._allData[qr].from!==-2||this._allOutputIndices.indexOf(qr+Ur)!==-1){if(Ur>0){let Kr=-1;this._allData[qr].from!==void 0&&this._allData[qr].from!==-1?(Kr=this._nodes[this._allData[qr].from].outputs.indexOf(qr+Ur),Kr!==-1&&(this._nodes[this._allData[qr].from].outputs[Kr]=qr)):(Kr=this._allInputIndices.indexOf(qr+Ur),Kr!==-1&&(this._allInputIndices[Kr]=qr)),this._allData[qr].to.forEach(Xr=>{Kr=this._nodes[Xr].inputs.indexOf(qr+Ur),Kr!==-1&&(this._nodes[Xr].inputs[Kr]=qr)}),this._allData[qr].to.length===0&&(Kr=this._allOutputIndices.indexOf(qr+Ur),Kr!==-1&&(this._allOutputIndices[Kr]=qr))}}else Ur++,this._allData.splice(qr,1),qr--}deleteNode(Ur){const Vr=this._nodes[Ur];if(Vr.outputs.length>1){for(let Zr=1;Zr<Vr.outputs.length;Zr++)if(this._allData[Vr.outputs[Zr]].to.length>0)throw new Error("Node deletion with more than one output connected to other nodes is not supported. ")}Vr.executeNode=!1;const Wr=Vr.inputs[0],qr=Vr.outputs[0],Kr=this._allData[qr].to;for(let Zr=0;Zr<Vr.inputs.length;Zr++){const _i=this._allData[Vr.inputs[Zr]].to.indexOf(Ur);if(_i===-1)throw new Error("The Value object doesn't have the current Node in it's 'to' property ");this._allData[Vr.inputs[Zr]].to.splice(_i,1)}this._allData[qr]._to=[];const Xr=this._allOutputIndices.indexOf(qr);if(Xr!==-1&&(this._allOutputIndices[Xr]=Wr),Kr&&Kr.length>0)for(const Zr of Kr){const _i=this._nodes[Zr].inputs.indexOf(qr);if(_i===-1)throw new Error("The Node object doesn't have the output Value in it's 'inputs' property ");this._nodes[Zr].inputs[_i]=Wr,this._allData[Wr].to.push(Zr)}}removeAllDropoutNodes(){let Ur=0;for(const Vr of this._nodes){if(Vr.opType==="Dropout"){if(Vr.inputs.length!==1)throw new Error("Dropout nodes should only contain one input. ");if(Vr.outputs.length!==1&&Vr.outputs.length!==2)throw new Error("Dropout nodes should contain either 1 or 2 output(s)");if(Vr.outputs.length===2&&this._allData[Vr.outputs[1]]._to.length!==0)throw new Error("Dropout nodes's second output should not be referenced by other nodes");this.deleteNode(Ur)}Ur++}}removeAllIdentityNodes(){let Ur=0;for(const Vr of this._nodes)Vr.opType==="Identity"&&this.deleteNode(Ur),Ur++}isActivation(Ur){switch(Ur.opType){case"Relu":case"Sigmoid":case"Clip":return!0;default:return!1}}fuseConvActivationNodes(){for(const Ur of this._nodes)if(Ur.opType==="Conv"){const Vr=this._allData[Ur.outputs[0]]._to;if(Vr.length===1&&this.isActivation(this._nodes[Vr[0]])){const Wr=this._nodes[Vr[0]];if(Wr.opType==="Clip")if(Wr.inputs.length===1)try{Ur.attributes.set("activation_params","floats",[Wr.attributes.getFloat("min"),Wr.attributes.getFloat("max")])}catch{Ur.attributes.set("activation_params","floats",[Fr.MIN_CLIP,Fr.MAX_CLIP])}else{if(!(Wr.inputs.length>=3&&this._allData[Wr.inputs[1]].tensor!==void 0&&this._allData[Wr.inputs[2]].tensor!==void 0))continue;Ur.attributes.set("activation_params","floats",[this._allData[Wr.inputs[1]].tensor.floatData[0],this._allData[Wr.inputs[2]].tensor.floatData[0]])}Ur.attributes.set("activation","string",Wr.opType),this.deleteNode(Vr[0])}}}}},1315:(_r,Tr)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.now=Tr.Profiler=Tr.Logger=void 0;const Ar={verbose:1e3,info:2e3,warning:4e3,error:5e3,fatal:6e3},Rr={none:new class{log(Gr,Nr,Lr){}},console:new class{log(Gr,Nr,Lr){console.log(`${this.color(Gr)} ${Lr?"\x1B[35m"+Lr+"\x1B[0m ":""}${Nr}`)}color(Gr){switch(Gr){case"verbose":return"\x1B[34;40mv\x1B[0m";case"info":return"\x1B[32mi\x1B[0m";case"warning":return"\x1B[30;43mw\x1B[0m";case"error":return"\x1B[31;40me\x1B[0m";case"fatal":return"\x1B[101mf\x1B[0m";default:throw new Error(`unsupported severity: ${Gr}`)}}}},Pr={provider:"console",minimalSeverity:"warning",logDateTime:!0,logSourceLocation:!1};let Dr={"":Pr};function Mr(Gr,Nr,Lr,Ur){if(Nr===void 0)return Vr=Gr,{verbose:Mr.verbose.bind(null,Vr),info:Mr.info.bind(null,Vr),warning:Mr.warning.bind(null,Vr),error:Mr.error.bind(null,Vr),fatal:Mr.fatal.bind(null,Vr)};if(Lr===void 0)Fr(Gr,Nr);else if(typeof Lr=="number"&&Ur===void 0)Fr(Gr,Nr);else if(typeof Lr=="string"&&Ur===void 0)Fr(Gr,Lr,0,Nr);else{if(typeof Lr!="string"||typeof Ur!="number")throw new TypeError("input is valid");Fr(Gr,Lr,0,Nr)}var Vr}function Fr(Gr,Nr,Lr,Ur){const Vr=Dr[Ur||""]||Dr[""];Ar[Gr]<Ar[Vr.minimalSeverity]||(Vr.logDateTime&&(Nr=`${new Date().toISOString()}|${Nr}`),Vr.logSourceLocation,Rr[Vr.provider].log(Gr,Nr,Ur))}(function(Gr){function Nr(Ur){Dr={},Lr("",Ur||{})}function Lr(Ur,Vr){if(Ur==="*")Nr(Vr);else{const Wr=Dr[Ur]||Pr;Dr[Ur]={provider:Vr.provider||Wr.provider,minimalSeverity:Vr.minimalSeverity||Wr.minimalSeverity,logDateTime:Vr.logDateTime===void 0?Wr.logDateTime:Vr.logDateTime,logSourceLocation:Vr.logSourceLocation===void 0?Wr.logSourceLocation:Vr.logSourceLocation}}}Gr.verbose=function(Ur,Vr){Gr("verbose",Ur,Vr)},Gr.info=function(Ur,Vr){Gr("info",Ur,Vr)},Gr.warning=function(Ur,Vr){Gr("warning",Ur,Vr)},Gr.error=function(Ur,Vr){Gr("error",Ur,Vr)},Gr.fatal=function(Ur,Vr){Gr("fatal",Ur,Vr)},Gr.reset=Nr,Gr.set=Lr,Gr.setWithEnv=function(Ur){const Vr={};Ur.logLevel&&(Vr.minimalSeverity=Ur.logLevel),Lr("",Vr)}})(Mr||(Mr={})),Tr.Logger=Mr;class zr{constructor(Nr,Lr,Ur,Vr,Wr,qr){this.category=Nr,this.name=Lr,this.startTime=Ur,this.endCallback=Vr,this.timer=Wr,this.ctx=qr}async end(){return this.endCallback(this)}async checkTimer(){if(this.ctx===void 0||this.timer===void 0)throw new Error("No webgl timer found");return this.ctx.endTimer(),this.ctx.waitForQueryAndGetTime(this.timer)}}class jr{constructor(Nr,Lr,Ur,Vr){this.category=Nr,this.name=Lr,this.startTime=Ur,this.endTime=Vr}}Tr.Profiler=class{static create(Gr){return Gr===void 0?new this:new this(Gr.maxNumberEvents,Gr.flushBatchSize,Gr.flushIntervalInMilliseconds)}constructor(Gr,Nr,Lr){this._started=!1,this._flushPointer=0,this._started=!1,this._maxNumberEvents=Gr===void 0?1e4:Gr,this._flushBatchSize=Nr===void 0?10:Nr,this._flushIntervalInMilliseconds=Lr===void 0?5e3:Lr}start(){this._started=!0,this._timingEvents=[],this._flushTime=(0,Tr.now)(),this._flushPointer=0}stop(){for(this._started=!1;this._flushPointer<this._timingEvents.length;this._flushPointer++)this.logOneEvent(this._timingEvents[this._flushPointer])}event(Gr,Nr,Lr,Ur){const Vr=this._started?this.begin(Gr,Nr,Ur):void 0;let Wr=!1;const qr=Lr();if(qr&&typeof qr.then=="function")return Wr=!0,new Promise((Kr,Xr)=>{qr.then(async Zr=>{Vr&&await Vr.end(),Kr(Zr)},async Zr=>{Vr&&await Vr.end(),Xr(Zr)})});if(!Wr&&Vr){const Kr=Vr.end();if(Kr&&typeof Kr.then=="function")return new Promise((Xr,Zr)=>{Kr.then(()=>{Xr(qr)},_i=>{Zr(_i)})})}return qr}begin(Gr,Nr,Lr){if(!this._started)throw new Error("profiler is not started yet");if(Lr===void 0){const Ur=(0,Tr.now)();return this.flush(Ur),new zr(Gr,Nr,Ur,Vr=>this.endSync(Vr))}{const Ur=Lr.beginTimer();return new zr(Gr,Nr,0,async Vr=>this.end(Vr),Ur,Lr)}}async end(Gr){const Nr=await Gr.checkTimer();this._timingEvents.length<this._maxNumberEvents&&(this._timingEvents.push(new jr(Gr.category,Gr.name,Gr.startTime,Nr)),this.flush(Nr))}endSync(Gr){const Nr=(0,Tr.now)();this._timingEvents.length<this._maxNumberEvents&&(this._timingEvents.push(new jr(Gr.category,Gr.name,Gr.startTime,Nr)),this.flush(Nr))}logOneEvent(Gr){Tr.Logger.verbose(`Profiler.${Gr.category}`,`${(Gr.endTime-Gr.startTime).toFixed(2)}ms on event '${Gr.name}' at ${Gr.endTime.toFixed(2)}`)}flush(Gr){if(this._timingEvents.length-this._flushPointer>=this._flushBatchSize||Gr-this._flushTime>=this._flushIntervalInMilliseconds){for(const Nr=this._flushPointer;this._flushPointer<Nr+this._flushBatchSize&&this._flushPointer<this._timingEvents.length;this._flushPointer++)this.logOneEvent(this._timingEvents[this._flushPointer]);this._flushTime=(0,Tr.now)()}}get started(){return this._started}},Tr.now=typeof performance<"u"&&performance.now?()=>performance.now():Date.now},1745:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.Model=void 0;const Rr=Ar(5686),Pr=Ar(1446),Dr=Ar(4662),Mr=Ar(1287),Fr=Ar(7273);var zr=Mr.onnxruntime.experimental.fbs;Tr.Model=class{constructor(){}load(jr,Gr,Nr){if(!Nr)try{return void this.loadFromOnnxFormat(jr,Gr)}catch(Lr){if(Nr!==void 0)throw Lr}this.loadFromOrtFormat(jr,Gr)}loadFromOnnxFormat(jr,Gr){const Nr=Pr.onnx.ModelProto.decode(jr);if(Fr.LongUtil.longToNumber(Nr.irVersion)<3)throw new Error("only support ONNX model with IR_VERSION>=3");this._opsets=Nr.opsetImport.map(Lr=>({domain:Lr.domain,version:Fr.LongUtil.longToNumber(Lr.version)})),this._graph=Dr.Graph.from(Nr.graph,Gr)}loadFromOrtFormat(jr,Gr){const Nr=new Rr.flatbuffers.ByteBuffer(jr),Lr=zr.InferenceSession.getRootAsInferenceSession(Nr).model();if(Fr.LongUtil.longToNumber(Lr.irVersion())<3)throw new Error("only support ONNX model with IR_VERSION>=3");this._opsets=[];for(let Ur=0;Ur<Lr.opsetImportLength();Ur++){const Vr=Lr.opsetImport(Ur);this._opsets.push({domain:Vr==null?void 0:Vr.domain(),version:Fr.LongUtil.longToNumber(Vr.version())})}this._graph=Dr.Graph.from(Lr.graph(),Gr)}get graph(){return this._graph}get opsets(){return this._opsets}}},6145:(_r,Tr)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.FLOAT_TYPES=Tr.INT_TYPES=Tr.NUMBER_TYPES=void 0,Tr.NUMBER_TYPES=["float32","float64","int32","int16","int8","uint16","uint32","uint8"],Tr.INT_TYPES=["int32","int16","int8","uint16","uint32","uint8"],Tr.FLOAT_TYPES=["float32","float64"]},5881:(_r,Tr)=>{function Ar(Rr,Pr){if(Pr.endsWith("+")){const Dr=Number.parseInt(Pr.substring(0,Pr.length-1),10);return!isNaN(Dr)&&Dr<=Rr}if(Pr.split("-").length===2){const Dr=Pr.split("-"),Mr=Number.parseInt(Dr[0],10),Fr=Number.parseInt(Dr[1],10);return!isNaN(Mr)&&!isNaN(Fr)&&Mr<=Rr&&Rr<=Fr}return Number.parseInt(Pr,10)===Rr}Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.resolveOperator=void 0,Tr.resolveOperator=function(Rr,Pr,Dr){for(const Mr of Dr){const Fr=Mr[0],zr=Mr[1],jr=Mr[2],Gr=Mr[3],Nr=Mr[4];if(Rr.opType===Fr){for(const Lr of Pr)if((Lr.domain===zr||Lr.domain==="ai.onnx"&&zr==="")&&Ar(Lr.version,jr))return{opImpl:Gr,opInit:Nr}}}throw new TypeError(`cannot resolve operator '${Rr.opType}' with opsets: ${Pr.map(Mr=>`${Mr.domain||"ai.onnx"} v${Mr.version}`).join(", ")}`)}},1287:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.onnxruntime=void 0;const Rr=Ar(5686);var Pr,Dr;(function(Mr){(function(Fr){Fr[Fr.UNDEFINED=0]="UNDEFINED",Fr[Fr.FLOAT=1]="FLOAT",Fr[Fr.INT=2]="INT",Fr[Fr.STRING=3]="STRING",Fr[Fr.TENSOR=4]="TENSOR",Fr[Fr.GRAPH=5]="GRAPH",Fr[Fr.FLOATS=6]="FLOATS",Fr[Fr.INTS=7]="INTS",Fr[Fr.STRINGS=8]="STRINGS",Fr[Fr.TENSORS=9]="TENSORS",Fr[Fr.GRAPHS=10]="GRAPHS",Fr[Fr.SPARSE_TENSOR=11]="SPARSE_TENSOR",Fr[Fr.SPARSE_TENSORS=12]="SPARSE_TENSORS"})(Mr.AttributeType||(Mr.AttributeType={}))})((Dr=(Pr=Tr.onnxruntime||(Tr.onnxruntime={})).experimental||(Pr.experimental={})).fbs||(Dr.fbs={})),function(Mr){(function(Fr){(function(zr){(function(jr){jr[jr.UNKNOWN=0]="UNKNOWN",jr[jr.VALUE=1]="VALUE",jr[jr.PARAM=2]="PARAM"})(zr.DimensionValueType||(zr.DimensionValueType={}))})(Fr.fbs||(Fr.fbs={}))})(Mr.experimental||(Mr.experimental={}))}(Tr.onnxruntime||(Tr.onnxruntime={})),function(Mr){(function(Fr){(function(zr){(function(jr){jr[jr.UNDEFINED=0]="UNDEFINED",jr[jr.FLOAT=1]="FLOAT",jr[jr.UINT8=2]="UINT8",jr[jr.INT8=3]="INT8",jr[jr.UINT16=4]="UINT16",jr[jr.INT16=5]="INT16",jr[jr.INT32=6]="INT32",jr[jr.INT64=7]="INT64",jr[jr.STRING=8]="STRING",jr[jr.BOOL=9]="BOOL",jr[jr.FLOAT16=10]="FLOAT16",jr[jr.DOUBLE=11]="DOUBLE",jr[jr.UINT32=12]="UINT32",jr[jr.UINT64=13]="UINT64",jr[jr.COMPLEX64=14]="COMPLEX64",jr[jr.COMPLEX128=15]="COMPLEX128",jr[jr.BFLOAT16=16]="BFLOAT16"})(zr.TensorDataType||(zr.TensorDataType={}))})(Fr.fbs||(Fr.fbs={}))})(Mr.experimental||(Mr.experimental={}))}(Tr.onnxruntime||(Tr.onnxruntime={})),function(Mr){(function(Fr){(function(zr){(function(jr){jr[jr.Primitive=0]="Primitive",jr[jr.Fused=1]="Fused"})(zr.NodeType||(zr.NodeType={}))})(Fr.fbs||(Fr.fbs={}))})(Mr.experimental||(Mr.experimental={}))}(Tr.onnxruntime||(Tr.onnxruntime={})),function(Mr){(function(Fr){(function(zr){(function(jr){jr[jr.NONE=0]="NONE",jr[jr.tensor_type=1]="tensor_type",jr[jr.sequence_type=2]="sequence_type",jr[jr.map_type=3]="map_type"})(zr.TypeInfoValue||(zr.TypeInfoValue={}))})(Fr.fbs||(Fr.fbs={}))})(Mr.experimental||(Mr.experimental={}))}(Tr.onnxruntime||(Tr.onnxruntime={})),function(Mr){(function(Fr){(function(zr){class jr{constructor(){this.bb=null,this.bb_pos=0}__init(Nr,Lr){return this.bb_pos=Nr,this.bb=Lr,this}static getRootAsShape(Nr,Lr){return(Lr||new jr).__init(Nr.readInt32(Nr.position())+Nr.position(),Nr)}static getSizePrefixedRootAsShape(Nr,Lr){return Nr.setPosition(Nr.position()+Rr.flatbuffers.SIZE_PREFIX_LENGTH),(Lr||new jr).__init(Nr.readInt32(Nr.position())+Nr.position(),Nr)}dim(Nr,Lr){let Ur=this.bb.__offset(this.bb_pos,4);return Ur?(Lr||new Mr.experimental.fbs.Dimension).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+Ur)+4*Nr),this.bb):null}dimLength(){let Nr=this.bb.__offset(this.bb_pos,4);return Nr?this.bb.__vector_len(this.bb_pos+Nr):0}static startShape(Nr){Nr.startObject(1)}static addDim(Nr,Lr){Nr.addFieldOffset(0,Lr,0)}static createDimVector(Nr,Lr){Nr.startVector(4,Lr.length,4);for(let Ur=Lr.length-1;Ur>=0;Ur--)Nr.addOffset(Lr[Ur]);return Nr.endVector()}static startDimVector(Nr,Lr){Nr.startVector(4,Lr,4)}static endShape(Nr){return Nr.endObject()}static createShape(Nr,Lr){return jr.startShape(Nr),jr.addDim(Nr,Lr),jr.endShape(Nr)}}zr.Shape=jr})(Fr.fbs||(Fr.fbs={}))})(Mr.experimental||(Mr.experimental={}))}(Tr.onnxruntime||(Tr.onnxruntime={})),function(Mr){(function(Fr){(function(zr){class jr{constructor(){this.bb=null,this.bb_pos=0}__init(Nr,Lr){return this.bb_pos=Nr,this.bb=Lr,this}static getRootAsDimension(Nr,Lr){return(Lr||new jr).__init(Nr.readInt32(Nr.position())+Nr.position(),Nr)}static getSizePrefixedRootAsDimension(Nr,Lr){return Nr.setPosition(Nr.position()+Rr.flatbuffers.SIZE_PREFIX_LENGTH),(Lr||new jr).__init(Nr.readInt32(Nr.position())+Nr.position(),Nr)}value(Nr){let Lr=this.bb.__offset(this.bb_pos,4);return Lr?(Nr||new Mr.experimental.fbs.DimensionValue).__init(this.bb.__indirect(this.bb_pos+Lr),this.bb):null}denotation(Nr){let Lr=this.bb.__offset(this.bb_pos,6);return Lr?this.bb.__string(this.bb_pos+Lr,Nr):null}static startDimension(Nr){Nr.startObject(2)}static addValue(Nr,Lr){Nr.addFieldOffset(0,Lr,0)}static addDenotation(Nr,Lr){Nr.addFieldOffset(1,Lr,0)}static endDimension(Nr){return Nr.endObject()}static createDimension(Nr,Lr,Ur){return jr.startDimension(Nr),jr.addValue(Nr,Lr),jr.addDenotation(Nr,Ur),jr.endDimension(Nr)}}zr.Dimension=jr})(Fr.fbs||(Fr.fbs={}))})(Mr.experimental||(Mr.experimental={}))}(Tr.onnxruntime||(Tr.onnxruntime={})),function(Mr){(function(Fr){(function(zr){class jr{constructor(){this.bb=null,this.bb_pos=0}__init(Nr,Lr){return this.bb_pos=Nr,this.bb=Lr,this}static getRootAsDimensionValue(Nr,Lr){return(Lr||new jr).__init(Nr.readInt32(Nr.position())+Nr.position(),Nr)}static getSizePrefixedRootAsDimensionValue(Nr,Lr){return Nr.setPosition(Nr.position()+Rr.flatbuffers.SIZE_PREFIX_LENGTH),(Lr||new jr).__init(Nr.readInt32(Nr.position())+Nr.position(),Nr)}dimType(){let Nr=this.bb.__offset(this.bb_pos,4);return Nr?this.bb.readInt8(this.bb_pos+Nr):Mr.experimental.fbs.DimensionValueType.UNKNOWN}dimValue(){let Nr=this.bb.__offset(this.bb_pos,6);return Nr?this.bb.readInt64(this.bb_pos+Nr):this.bb.createLong(0,0)}dimParam(Nr){let Lr=this.bb.__offset(this.bb_pos,8);return Lr?this.bb.__string(this.bb_pos+Lr,Nr):null}static startDimensionValue(Nr){Nr.startObject(3)}static addDimType(Nr,Lr){Nr.addFieldInt8(0,Lr,Mr.experimental.fbs.DimensionValueType.UNKNOWN)}static addDimValue(Nr,Lr){Nr.addFieldInt64(1,Lr,Nr.createLong(0,0))}static addDimParam(Nr,Lr){Nr.addFieldOffset(2,Lr,0)}static endDimensionValue(Nr){return Nr.endObject()}static createDimensionValue(Nr,Lr,Ur,Vr){return jr.startDimensionValue(Nr),jr.addDimType(Nr,Lr),jr.addDimValue(Nr,Ur),jr.addDimParam(Nr,Vr),jr.endDimensionValue(Nr)}}zr.DimensionValue=jr})(Fr.fbs||(Fr.fbs={}))})(Mr.experimental||(Mr.experimental={}))}(Tr.onnxruntime||(Tr.onnxruntime={})),function(Mr){(function(Fr){(function(zr){class jr{constructor(){this.bb=null,this.bb_pos=0}__init(Nr,Lr){return this.bb_pos=Nr,this.bb=Lr,this}static getRootAsTensorTypeAndShape(Nr,Lr){return(Lr||new jr).__init(Nr.readInt32(Nr.position())+Nr.position(),Nr)}static getSizePrefixedRootAsTensorTypeAndShape(Nr,Lr){return Nr.setPosition(Nr.position()+Rr.flatbuffers.SIZE_PREFIX_LENGTH),(Lr||new jr).__init(Nr.readInt32(Nr.position())+Nr.position(),Nr)}elemType(){let Nr=this.bb.__offset(this.bb_pos,4);return Nr?this.bb.readInt32(this.bb_pos+Nr):Mr.experimental.fbs.TensorDataType.UNDEFINED}shape(Nr){let Lr=this.bb.__offset(this.bb_pos,6);return Lr?(Nr||new Mr.experimental.fbs.Shape).__init(this.bb.__indirect(this.bb_pos+Lr),this.bb):null}static startTensorTypeAndShape(Nr){Nr.startObject(2)}static addElemType(Nr,Lr){Nr.addFieldInt32(0,Lr,Mr.experimental.fbs.TensorDataType.UNDEFINED)}static addShape(Nr,Lr){Nr.addFieldOffset(1,Lr,0)}static endTensorTypeAndShape(Nr){return Nr.endObject()}static createTensorTypeAndShape(Nr,Lr,Ur){return jr.startTensorTypeAndShape(Nr),jr.addElemType(Nr,Lr),jr.addShape(Nr,Ur),jr.endTensorTypeAndShape(Nr)}}zr.TensorTypeAndShape=jr})(Fr.fbs||(Fr.fbs={}))})(Mr.experimental||(Mr.experimental={}))}(Tr.onnxruntime||(Tr.onnxruntime={})),function(Mr){(function(Fr){(function(zr){class jr{constructor(){this.bb=null,this.bb_pos=0}__init(Nr,Lr){return this.bb_pos=Nr,this.bb=Lr,this}static getRootAsMapType(Nr,Lr){return(Lr||new jr).__init(Nr.readInt32(Nr.position())+Nr.position(),Nr)}static getSizePrefixedRootAsMapType(Nr,Lr){return Nr.setPosition(Nr.position()+Rr.flatbuffers.SIZE_PREFIX_LENGTH),(Lr||new jr).__init(Nr.readInt32(Nr.position())+Nr.position(),Nr)}keyType(){let Nr=this.bb.__offset(this.bb_pos,4);return Nr?this.bb.readInt32(this.bb_pos+Nr):Mr.experimental.fbs.TensorDataType.UNDEFINED}valueType(Nr){let Lr=this.bb.__offset(this.bb_pos,6);return Lr?(Nr||new Mr.experimental.fbs.TypeInfo).__init(this.bb.__indirect(this.bb_pos+Lr),this.bb):null}static startMapType(Nr){Nr.startObject(2)}static addKeyType(Nr,Lr){Nr.addFieldInt32(0,Lr,Mr.experimental.fbs.TensorDataType.UNDEFINED)}static addValueType(Nr,Lr){Nr.addFieldOffset(1,Lr,0)}static endMapType(Nr){return Nr.endObject()}static createMapType(Nr,Lr,Ur){return jr.startMapType(Nr),jr.addKeyType(Nr,Lr),jr.addValueType(Nr,Ur),jr.endMapType(Nr)}}zr.MapType=jr})(Fr.fbs||(Fr.fbs={}))})(Mr.experimental||(Mr.experimental={}))}(Tr.onnxruntime||(Tr.onnxruntime={})),function(Mr){(function(Fr){(function(zr){class jr{constructor(){this.bb=null,this.bb_pos=0}__init(Nr,Lr){return this.bb_pos=Nr,this.bb=Lr,this}static getRootAsSequenceType(Nr,Lr){return(Lr||new jr).__init(Nr.readInt32(Nr.position())+Nr.position(),Nr)}static getSizePrefixedRootAsSequenceType(Nr,Lr){return Nr.setPosition(Nr.position()+Rr.flatbuffers.SIZE_PREFIX_LENGTH),(Lr||new jr).__init(Nr.readInt32(Nr.position())+Nr.position(),Nr)}elemType(Nr){let Lr=this.bb.__offset(this.bb_pos,4);return Lr?(Nr||new Mr.experimental.fbs.TypeInfo).__init(this.bb.__indirect(this.bb_pos+Lr),this.bb):null}static startSequenceType(Nr){Nr.startObject(1)}static addElemType(Nr,Lr){Nr.addFieldOffset(0,Lr,0)}static endSequenceType(Nr){return Nr.endObject()}static createSequenceType(Nr,Lr){return jr.startSequenceType(Nr),jr.addElemType(Nr,Lr),jr.endSequenceType(Nr)}}zr.SequenceType=jr})(Fr.fbs||(Fr.fbs={}))})(Mr.experimental||(Mr.experimental={}))}(Tr.onnxruntime||(Tr.onnxruntime={})),function(Mr){(function(Fr){(Fr.fbs||(Fr.fbs={})).EdgeEnd=class{constructor(){this.bb=null,this.bb_pos=0}__init(zr,jr){return this.bb_pos=zr,this.bb=jr,this}nodeIndex(){return this.bb.readUint32(this.bb_pos)}srcArgIndex(){return this.bb.readInt32(this.bb_pos+4)}dstArgIndex(){return this.bb.readInt32(this.bb_pos+8)}static createEdgeEnd(zr,jr,Gr,Nr){return zr.prep(4,12),zr.writeInt32(Nr),zr.writeInt32(Gr),zr.writeInt32(jr),zr.offset()}}})(Mr.experimental||(Mr.experimental={}))}(Tr.onnxruntime||(Tr.onnxruntime={})),function(Mr){(function(Fr){(function(zr){class jr{constructor(){this.bb=null,this.bb_pos=0}__init(Nr,Lr){return this.bb_pos=Nr,this.bb=Lr,this}static getRootAsNodeEdge(Nr,Lr){return(Lr||new jr).__init(Nr.readInt32(Nr.position())+Nr.position(),Nr)}static getSizePrefixedRootAsNodeEdge(Nr,Lr){return Nr.setPosition(Nr.position()+Rr.flatbuffers.SIZE_PREFIX_LENGTH),(Lr||new jr).__init(Nr.readInt32(Nr.position())+Nr.position(),Nr)}nodeIndex(){let Nr=this.bb.__offset(this.bb_pos,4);return Nr?this.bb.readUint32(this.bb_pos+Nr):0}inputEdges(Nr,Lr){let Ur=this.bb.__offset(this.bb_pos,6);return Ur?(Lr||new Mr.experimental.fbs.EdgeEnd).__init(this.bb.__vector(this.bb_pos+Ur)+12*Nr,this.bb):null}inputEdgesLength(){let Nr=this.bb.__offset(this.bb_pos,6);return Nr?this.bb.__vector_len(this.bb_pos+Nr):0}outputEdges(Nr,Lr){let Ur=this.bb.__offset(this.bb_pos,8);return Ur?(Lr||new Mr.experimental.fbs.EdgeEnd).__init(this.bb.__vector(this.bb_pos+Ur)+12*Nr,this.bb):null}outputEdgesLength(){let Nr=this.bb.__offset(this.bb_pos,8);return Nr?this.bb.__vector_len(this.bb_pos+Nr):0}static startNodeEdge(Nr){Nr.startObject(3)}static addNodeIndex(Nr,Lr){Nr.addFieldInt32(0,Lr,0)}static addInputEdges(Nr,Lr){Nr.addFieldOffset(1,Lr,0)}static startInputEdgesVector(Nr,Lr){Nr.startVector(12,Lr,4)}static addOutputEdges(Nr,Lr){Nr.addFieldOffset(2,Lr,0)}static startOutputEdgesVector(Nr,Lr){Nr.startVector(12,Lr,4)}static endNodeEdge(Nr){return Nr.endObject()}static createNodeEdge(Nr,Lr,Ur,Vr){return jr.startNodeEdge(Nr),jr.addNodeIndex(Nr,Lr),jr.addInputEdges(Nr,Ur),jr.addOutputEdges(Nr,Vr),jr.endNodeEdge(Nr)}}zr.NodeEdge=jr})(Fr.fbs||(Fr.fbs={}))})(Mr.experimental||(Mr.experimental={}))}(Tr.onnxruntime||(Tr.onnxruntime={})),function(Mr){(function(Fr){(function(zr){class jr{constructor(){this.bb=null,this.bb_pos=0}__init(Nr,Lr){return this.bb_pos=Nr,this.bb=Lr,this}static getRootAsNode(Nr,Lr){return(Lr||new jr).__init(Nr.readInt32(Nr.position())+Nr.position(),Nr)}static getSizePrefixedRootAsNode(Nr,Lr){return Nr.setPosition(Nr.position()+Rr.flatbuffers.SIZE_PREFIX_LENGTH),(Lr||new jr).__init(Nr.readInt32(Nr.position())+Nr.position(),Nr)}name(Nr){let Lr=this.bb.__offset(this.bb_pos,4);return Lr?this.bb.__string(this.bb_pos+Lr,Nr):null}docString(Nr){let Lr=this.bb.__offset(this.bb_pos,6);return Lr?this.bb.__string(this.bb_pos+Lr,Nr):null}domain(Nr){let Lr=this.bb.__offset(this.bb_pos,8);return Lr?this.bb.__string(this.bb_pos+Lr,Nr):null}sinceVersion(){let Nr=this.bb.__offset(this.bb_pos,10);return Nr?this.bb.readInt32(this.bb_pos+Nr):0}index(){let Nr=this.bb.__offset(this.bb_pos,12);return Nr?this.bb.readUint32(this.bb_pos+Nr):0}opType(Nr){let Lr=this.bb.__offset(this.bb_pos,14);return Lr?this.bb.__string(this.bb_pos+Lr,Nr):null}type(){let Nr=this.bb.__offset(this.bb_pos,16);return Nr?this.bb.readInt32(this.bb_pos+Nr):Mr.experimental.fbs.NodeType.Primitive}executionProviderType(Nr){let Lr=this.bb.__offset(this.bb_pos,18);return Lr?this.bb.__string(this.bb_pos+Lr,Nr):null}inputs(Nr,Lr){let Ur=this.bb.__offset(this.bb_pos,20);return Ur?this.bb.__string(this.bb.__vector(this.bb_pos+Ur)+4*Nr,Lr):null}inputsLength(){let Nr=this.bb.__offset(this.bb_pos,20);return Nr?this.bb.__vector_len(this.bb_pos+Nr):0}outputs(Nr,Lr){let Ur=this.bb.__offset(this.bb_pos,22);return Ur?this.bb.__string(this.bb.__vector(this.bb_pos+Ur)+4*Nr,Lr):null}outputsLength(){let Nr=this.bb.__offset(this.bb_pos,22);return Nr?this.bb.__vector_len(this.bb_pos+Nr):0}attributes(Nr,Lr){let Ur=this.bb.__offset(this.bb_pos,24);return Ur?(Lr||new Mr.experimental.fbs.Attribute).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+Ur)+4*Nr),this.bb):null}attributesLength(){let Nr=this.bb.__offset(this.bb_pos,24);return Nr?this.bb.__vector_len(this.bb_pos+Nr):0}inputArgCounts(Nr){let Lr=this.bb.__offset(this.bb_pos,26);return Lr?this.bb.readInt32(this.bb.__vector(this.bb_pos+Lr)+4*Nr):0}inputArgCountsLength(){let Nr=this.bb.__offset(this.bb_pos,26);return Nr?this.bb.__vector_len(this.bb_pos+Nr):0}inputArgCountsArray(){let Nr=this.bb.__offset(this.bb_pos,26);return Nr?new Int32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+Nr),this.bb.__vector_len(this.bb_pos+Nr)):null}implicitInputs(Nr,Lr){let Ur=this.bb.__offset(this.bb_pos,28);return Ur?this.bb.__string(this.bb.__vector(this.bb_pos+Ur)+4*Nr,Lr):null}implicitInputsLength(){let Nr=this.bb.__offset(this.bb_pos,28);return Nr?this.bb.__vector_len(this.bb_pos+Nr):0}static startNode(Nr){Nr.startObject(13)}static addName(Nr,Lr){Nr.addFieldOffset(0,Lr,0)}static addDocString(Nr,Lr){Nr.addFieldOffset(1,Lr,0)}static addDomain(Nr,Lr){Nr.addFieldOffset(2,Lr,0)}static addSinceVersion(Nr,Lr){Nr.addFieldInt32(3,Lr,0)}static addIndex(Nr,Lr){Nr.addFieldInt32(4,Lr,0)}static addOpType(Nr,Lr){Nr.addFieldOffset(5,Lr,0)}static addType(Nr,Lr){Nr.addFieldInt32(6,Lr,Mr.experimental.fbs.NodeType.Primitive)}static addExecutionProviderType(Nr,Lr){Nr.addFieldOffset(7,Lr,0)}static addInputs(Nr,Lr){Nr.addFieldOffset(8,Lr,0)}static createInputsVector(Nr,Lr){Nr.startVector(4,Lr.length,4);for(let Ur=Lr.length-1;Ur>=0;Ur--)Nr.addOffset(Lr[Ur]);return Nr.endVector()}static startInputsVector(Nr,Lr){Nr.startVector(4,Lr,4)}static addOutputs(Nr,Lr){Nr.addFieldOffset(9,Lr,0)}static createOutputsVector(Nr,Lr){Nr.startVector(4,Lr.length,4);for(let Ur=Lr.length-1;Ur>=0;Ur--)Nr.addOffset(Lr[Ur]);return Nr.endVector()}static startOutputsVector(Nr,Lr){Nr.startVector(4,Lr,4)}static addAttributes(Nr,Lr){Nr.addFieldOffset(10,Lr,0)}static createAttributesVector(Nr,Lr){Nr.startVector(4,Lr.length,4);for(let Ur=Lr.length-1;Ur>=0;Ur--)Nr.addOffset(Lr[Ur]);return Nr.endVector()}static startAttributesVector(Nr,Lr){Nr.startVector(4,Lr,4)}static addInputArgCounts(Nr,Lr){Nr.addFieldOffset(11,Lr,0)}static createInputArgCountsVector(Nr,Lr){Nr.startVector(4,Lr.length,4);for(let Ur=Lr.length-1;Ur>=0;Ur--)Nr.addInt32(Lr[Ur]);return Nr.endVector()}static startInputArgCountsVector(Nr,Lr){Nr.startVector(4,Lr,4)}static addImplicitInputs(Nr,Lr){Nr.addFieldOffset(12,Lr,0)}static createImplicitInputsVector(Nr,Lr){Nr.startVector(4,Lr.length,4);for(let Ur=Lr.length-1;Ur>=0;Ur--)Nr.addOffset(Lr[Ur]);return Nr.endVector()}static startImplicitInputsVector(Nr,Lr){Nr.startVector(4,Lr,4)}static endNode(Nr){return Nr.endObject()}static createNode(Nr,Lr,Ur,Vr,Wr,qr,Kr,Xr,Zr,_i,Jr,es,ts,is){return jr.startNode(Nr),jr.addName(Nr,Lr),jr.addDocString(Nr,Ur),jr.addDomain(Nr,Vr),jr.addSinceVersion(Nr,Wr),jr.addIndex(Nr,qr),jr.addOpType(Nr,Kr),jr.addType(Nr,Xr),jr.addExecutionProviderType(Nr,Zr),jr.addInputs(Nr,_i),jr.addOutputs(Nr,Jr),jr.addAttributes(Nr,es),jr.addInputArgCounts(Nr,ts),jr.addImplicitInputs(Nr,is),jr.endNode(Nr)}}zr.Node=jr})(Fr.fbs||(Fr.fbs={}))})(Mr.experimental||(Mr.experimental={}))}(Tr.onnxruntime||(Tr.onnxruntime={})),function(Mr){(function(Fr){(function(zr){class jr{constructor(){this.bb=null,this.bb_pos=0}__init(Nr,Lr){return this.bb_pos=Nr,this.bb=Lr,this}static getRootAsValueInfo(Nr,Lr){return(Lr||new jr).__init(Nr.readInt32(Nr.position())+Nr.position(),Nr)}static getSizePrefixedRootAsValueInfo(Nr,Lr){return Nr.setPosition(Nr.position()+Rr.flatbuffers.SIZE_PREFIX_LENGTH),(Lr||new jr).__init(Nr.readInt32(Nr.position())+Nr.position(),Nr)}name(Nr){let Lr=this.bb.__offset(this.bb_pos,4);return Lr?this.bb.__string(this.bb_pos+Lr,Nr):null}docString(Nr){let Lr=this.bb.__offset(this.bb_pos,6);return Lr?this.bb.__string(this.bb_pos+Lr,Nr):null}type(Nr){let Lr=this.bb.__offset(this.bb_pos,8);return Lr?(Nr||new Mr.experimental.fbs.TypeInfo).__init(this.bb.__indirect(this.bb_pos+Lr),this.bb):null}static startValueInfo(Nr){Nr.startObject(3)}static addName(Nr,Lr){Nr.addFieldOffset(0,Lr,0)}static addDocString(Nr,Lr){Nr.addFieldOffset(1,Lr,0)}static addType(Nr,Lr){Nr.addFieldOffset(2,Lr,0)}static endValueInfo(Nr){return Nr.endObject()}static createValueInfo(Nr,Lr,Ur,Vr){return jr.startValueInfo(Nr),jr.addName(Nr,Lr),jr.addDocString(Nr,Ur),jr.addType(Nr,Vr),jr.endValueInfo(Nr)}}zr.ValueInfo=jr})(Fr.fbs||(Fr.fbs={}))})(Mr.experimental||(Mr.experimental={}))}(Tr.onnxruntime||(Tr.onnxruntime={})),function(Mr){(function(Fr){(function(zr){class jr{constructor(){this.bb=null,this.bb_pos=0}__init(Nr,Lr){return this.bb_pos=Nr,this.bb=Lr,this}static getRootAsTypeInfo(Nr,Lr){return(Lr||new jr).__init(Nr.readInt32(Nr.position())+Nr.position(),Nr)}static getSizePrefixedRootAsTypeInfo(Nr,Lr){return Nr.setPosition(Nr.position()+Rr.flatbuffers.SIZE_PREFIX_LENGTH),(Lr||new jr).__init(Nr.readInt32(Nr.position())+Nr.position(),Nr)}denotation(Nr){let Lr=this.bb.__offset(this.bb_pos,4);return Lr?this.bb.__string(this.bb_pos+Lr,Nr):null}valueType(){let Nr=this.bb.__offset(this.bb_pos,6);return Nr?this.bb.readUint8(this.bb_pos+Nr):Mr.experimental.fbs.TypeInfoValue.NONE}value(Nr){let Lr=this.bb.__offset(this.bb_pos,8);return Lr?this.bb.__union(Nr,this.bb_pos+Lr):null}static startTypeInfo(Nr){Nr.startObject(3)}static addDenotation(Nr,Lr){Nr.addFieldOffset(0,Lr,0)}static addValueType(Nr,Lr){Nr.addFieldInt8(1,Lr,Mr.experimental.fbs.TypeInfoValue.NONE)}static addValue(Nr,Lr){Nr.addFieldOffset(2,Lr,0)}static endTypeInfo(Nr){return Nr.endObject()}static createTypeInfo(Nr,Lr,Ur,Vr){return jr.startTypeInfo(Nr),jr.addDenotation(Nr,Lr),jr.addValueType(Nr,Ur),jr.addValue(Nr,Vr),jr.endTypeInfo(Nr)}}zr.TypeInfo=jr})(Fr.fbs||(Fr.fbs={}))})(Mr.experimental||(Mr.experimental={}))}(Tr.onnxruntime||(Tr.onnxruntime={})),function(Mr){(function(Fr){(function(zr){class jr{constructor(){this.bb=null,this.bb_pos=0}__init(Nr,Lr){return this.bb_pos=Nr,this.bb=Lr,this}static getRootAsOperatorSetId(Nr,Lr){return(Lr||new jr).__init(Nr.readInt32(Nr.position())+Nr.position(),Nr)}static getSizePrefixedRootAsOperatorSetId(Nr,Lr){return Nr.setPosition(Nr.position()+Rr.flatbuffers.SIZE_PREFIX_LENGTH),(Lr||new jr).__init(Nr.readInt32(Nr.position())+Nr.position(),Nr)}domain(Nr){let Lr=this.bb.__offset(this.bb_pos,4);return Lr?this.bb.__string(this.bb_pos+Lr,Nr):null}version(){let Nr=this.bb.__offset(this.bb_pos,6);return Nr?this.bb.readInt64(this.bb_pos+Nr):this.bb.createLong(0,0)}static startOperatorSetId(Nr){Nr.startObject(2)}static addDomain(Nr,Lr){Nr.addFieldOffset(0,Lr,0)}static addVersion(Nr,Lr){Nr.addFieldInt64(1,Lr,Nr.createLong(0,0))}static endOperatorSetId(Nr){return Nr.endObject()}static createOperatorSetId(Nr,Lr,Ur){return jr.startOperatorSetId(Nr),jr.addDomain(Nr,Lr),jr.addVersion(Nr,Ur),jr.endOperatorSetId(Nr)}}zr.OperatorSetId=jr})(Fr.fbs||(Fr.fbs={}))})(Mr.experimental||(Mr.experimental={}))}(Tr.onnxruntime||(Tr.onnxruntime={})),function(Mr){(function(Fr){(function(zr){class jr{constructor(){this.bb=null,this.bb_pos=0}__init(Nr,Lr){return this.bb_pos=Nr,this.bb=Lr,this}static getRootAsTensor(Nr,Lr){return(Lr||new jr).__init(Nr.readInt32(Nr.position())+Nr.position(),Nr)}static getSizePrefixedRootAsTensor(Nr,Lr){return Nr.setPosition(Nr.position()+Rr.flatbuffers.SIZE_PREFIX_LENGTH),(Lr||new jr).__init(Nr.readInt32(Nr.position())+Nr.position(),Nr)}name(Nr){let Lr=this.bb.__offset(this.bb_pos,4);return Lr?this.bb.__string(this.bb_pos+Lr,Nr):null}docString(Nr){let Lr=this.bb.__offset(this.bb_pos,6);return Lr?this.bb.__string(this.bb_pos+Lr,Nr):null}dims(Nr){let Lr=this.bb.__offset(this.bb_pos,8);return Lr?this.bb.readInt64(this.bb.__vector(this.bb_pos+Lr)+8*Nr):this.bb.createLong(0,0)}dimsLength(){let Nr=this.bb.__offset(this.bb_pos,8);return Nr?this.bb.__vector_len(this.bb_pos+Nr):0}dataType(){let Nr=this.bb.__offset(this.bb_pos,10);return Nr?this.bb.readInt32(this.bb_pos+Nr):Mr.experimental.fbs.TensorDataType.UNDEFINED}rawData(Nr){let Lr=this.bb.__offset(this.bb_pos,12);return Lr?this.bb.readUint8(this.bb.__vector(this.bb_pos+Lr)+Nr):0}rawDataLength(){let Nr=this.bb.__offset(this.bb_pos,12);return Nr?this.bb.__vector_len(this.bb_pos+Nr):0}rawDataArray(){let Nr=this.bb.__offset(this.bb_pos,12);return Nr?new Uint8Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+Nr),this.bb.__vector_len(this.bb_pos+Nr)):null}stringData(Nr,Lr){let Ur=this.bb.__offset(this.bb_pos,14);return Ur?this.bb.__string(this.bb.__vector(this.bb_pos+Ur)+4*Nr,Lr):null}stringDataLength(){let Nr=this.bb.__offset(this.bb_pos,14);return Nr?this.bb.__vector_len(this.bb_pos+Nr):0}static startTensor(Nr){Nr.startObject(6)}static addName(Nr,Lr){Nr.addFieldOffset(0,Lr,0)}static addDocString(Nr,Lr){Nr.addFieldOffset(1,Lr,0)}static addDims(Nr,Lr){Nr.addFieldOffset(2,Lr,0)}static createDimsVector(Nr,Lr){Nr.startVector(8,Lr.length,8);for(let Ur=Lr.length-1;Ur>=0;Ur--)Nr.addInt64(Lr[Ur]);return Nr.endVector()}static startDimsVector(Nr,Lr){Nr.startVector(8,Lr,8)}static addDataType(Nr,Lr){Nr.addFieldInt32(3,Lr,Mr.experimental.fbs.TensorDataType.UNDEFINED)}static addRawData(Nr,Lr){Nr.addFieldOffset(4,Lr,0)}static createRawDataVector(Nr,Lr){Nr.startVector(1,Lr.length,1);for(let Ur=Lr.length-1;Ur>=0;Ur--)Nr.addInt8(Lr[Ur]);return Nr.endVector()}static startRawDataVector(Nr,Lr){Nr.startVector(1,Lr,1)}static addStringData(Nr,Lr){Nr.addFieldOffset(5,Lr,0)}static createStringDataVector(Nr,Lr){Nr.startVector(4,Lr.length,4);for(let Ur=Lr.length-1;Ur>=0;Ur--)Nr.addOffset(Lr[Ur]);return Nr.endVector()}static startStringDataVector(Nr,Lr){Nr.startVector(4,Lr,4)}static endTensor(Nr){return Nr.endObject()}static createTensor(Nr,Lr,Ur,Vr,Wr,qr,Kr){return jr.startTensor(Nr),jr.addName(Nr,Lr),jr.addDocString(Nr,Ur),jr.addDims(Nr,Vr),jr.addDataType(Nr,Wr),jr.addRawData(Nr,qr),jr.addStringData(Nr,Kr),jr.endTensor(Nr)}}zr.Tensor=jr})(Fr.fbs||(Fr.fbs={}))})(Mr.experimental||(Mr.experimental={}))}(Tr.onnxruntime||(Tr.onnxruntime={})),function(Mr){(function(Fr){(function(zr){class jr{constructor(){this.bb=null,this.bb_pos=0}__init(Nr,Lr){return this.bb_pos=Nr,this.bb=Lr,this}static getRootAsSparseTensor(Nr,Lr){return(Lr||new jr).__init(Nr.readInt32(Nr.position())+Nr.position(),Nr)}static getSizePrefixedRootAsSparseTensor(Nr,Lr){return Nr.setPosition(Nr.position()+Rr.flatbuffers.SIZE_PREFIX_LENGTH),(Lr||new jr).__init(Nr.readInt32(Nr.position())+Nr.position(),Nr)}values(Nr){let Lr=this.bb.__offset(this.bb_pos,4);return Lr?(Nr||new Mr.experimental.fbs.Tensor).__init(this.bb.__indirect(this.bb_pos+Lr),this.bb):null}indices(Nr){let Lr=this.bb.__offset(this.bb_pos,6);return Lr?(Nr||new Mr.experimental.fbs.Tensor).__init(this.bb.__indirect(this.bb_pos+Lr),this.bb):null}dims(Nr){let Lr=this.bb.__offset(this.bb_pos,8);return Lr?this.bb.readInt64(this.bb.__vector(this.bb_pos+Lr)+8*Nr):this.bb.createLong(0,0)}dimsLength(){let Nr=this.bb.__offset(this.bb_pos,8);return Nr?this.bb.__vector_len(this.bb_pos+Nr):0}static startSparseTensor(Nr){Nr.startObject(3)}static addValues(Nr,Lr){Nr.addFieldOffset(0,Lr,0)}static addIndices(Nr,Lr){Nr.addFieldOffset(1,Lr,0)}static addDims(Nr,Lr){Nr.addFieldOffset(2,Lr,0)}static createDimsVector(Nr,Lr){Nr.startVector(8,Lr.length,8);for(let Ur=Lr.length-1;Ur>=0;Ur--)Nr.addInt64(Lr[Ur]);return Nr.endVector()}static startDimsVector(Nr,Lr){Nr.startVector(8,Lr,8)}static endSparseTensor(Nr){return Nr.endObject()}static createSparseTensor(Nr,Lr,Ur,Vr){return jr.startSparseTensor(Nr),jr.addValues(Nr,Lr),jr.addIndices(Nr,Ur),jr.addDims(Nr,Vr),jr.endSparseTensor(Nr)}}zr.SparseTensor=jr})(Fr.fbs||(Fr.fbs={}))})(Mr.experimental||(Mr.experimental={}))}(Tr.onnxruntime||(Tr.onnxruntime={})),function(Mr){(function(Fr){(function(zr){class jr{constructor(){this.bb=null,this.bb_pos=0}__init(Nr,Lr){return this.bb_pos=Nr,this.bb=Lr,this}static getRootAsAttribute(Nr,Lr){return(Lr||new jr).__init(Nr.readInt32(Nr.position())+Nr.position(),Nr)}static getSizePrefixedRootAsAttribute(Nr,Lr){return Nr.setPosition(Nr.position()+Rr.flatbuffers.SIZE_PREFIX_LENGTH),(Lr||new jr).__init(Nr.readInt32(Nr.position())+Nr.position(),Nr)}name(Nr){let Lr=this.bb.__offset(this.bb_pos,4);return Lr?this.bb.__string(this.bb_pos+Lr,Nr):null}docString(Nr){let Lr=this.bb.__offset(this.bb_pos,6);return Lr?this.bb.__string(this.bb_pos+Lr,Nr):null}type(){let Nr=this.bb.__offset(this.bb_pos,8);return Nr?this.bb.readInt32(this.bb_pos+Nr):Mr.experimental.fbs.AttributeType.UNDEFINED}f(){let Nr=this.bb.__offset(this.bb_pos,10);return Nr?this.bb.readFloat32(this.bb_pos+Nr):0}i(){let Nr=this.bb.__offset(this.bb_pos,12);return Nr?this.bb.readInt64(this.bb_pos+Nr):this.bb.createLong(0,0)}s(Nr){let Lr=this.bb.__offset(this.bb_pos,14);return Lr?this.bb.__string(this.bb_pos+Lr,Nr):null}t(Nr){let Lr=this.bb.__offset(this.bb_pos,16);return Lr?(Nr||new Mr.experimental.fbs.Tensor).__init(this.bb.__indirect(this.bb_pos+Lr),this.bb):null}g(Nr){let Lr=this.bb.__offset(this.bb_pos,18);return Lr?(Nr||new Mr.experimental.fbs.Graph).__init(this.bb.__indirect(this.bb_pos+Lr),this.bb):null}floats(Nr){let Lr=this.bb.__offset(this.bb_pos,20);return Lr?this.bb.readFloat32(this.bb.__vector(this.bb_pos+Lr)+4*Nr):0}floatsLength(){let Nr=this.bb.__offset(this.bb_pos,20);return Nr?this.bb.__vector_len(this.bb_pos+Nr):0}floatsArray(){let Nr=this.bb.__offset(this.bb_pos,20);return Nr?new Float32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+Nr),this.bb.__vector_len(this.bb_pos+Nr)):null}ints(Nr){let Lr=this.bb.__offset(this.bb_pos,22);return Lr?this.bb.readInt64(this.bb.__vector(this.bb_pos+Lr)+8*Nr):this.bb.createLong(0,0)}intsLength(){let Nr=this.bb.__offset(this.bb_pos,22);return Nr?this.bb.__vector_len(this.bb_pos+Nr):0}strings(Nr,Lr){let Ur=this.bb.__offset(this.bb_pos,24);return Ur?this.bb.__string(this.bb.__vector(this.bb_pos+Ur)+4*Nr,Lr):null}stringsLength(){let Nr=this.bb.__offset(this.bb_pos,24);return Nr?this.bb.__vector_len(this.bb_pos+Nr):0}tensors(Nr,Lr){let Ur=this.bb.__offset(this.bb_pos,26);return Ur?(Lr||new Mr.experimental.fbs.Tensor).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+Ur)+4*Nr),this.bb):null}tensorsLength(){let Nr=this.bb.__offset(this.bb_pos,26);return Nr?this.bb.__vector_len(this.bb_pos+Nr):0}graphs(Nr,Lr){let Ur=this.bb.__offset(this.bb_pos,28);return Ur?(Lr||new Mr.experimental.fbs.Graph).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+Ur)+4*Nr),this.bb):null}graphsLength(){let Nr=this.bb.__offset(this.bb_pos,28);return Nr?this.bb.__vector_len(this.bb_pos+Nr):0}static startAttribute(Nr){Nr.startObject(13)}static addName(Nr,Lr){Nr.addFieldOffset(0,Lr,0)}static addDocString(Nr,Lr){Nr.addFieldOffset(1,Lr,0)}static addType(Nr,Lr){Nr.addFieldInt32(2,Lr,Mr.experimental.fbs.AttributeType.UNDEFINED)}static addF(Nr,Lr){Nr.addFieldFloat32(3,Lr,0)}static addI(Nr,Lr){Nr.addFieldInt64(4,Lr,Nr.createLong(0,0))}static addS(Nr,Lr){Nr.addFieldOffset(5,Lr,0)}static addT(Nr,Lr){Nr.addFieldOffset(6,Lr,0)}static addG(Nr,Lr){Nr.addFieldOffset(7,Lr,0)}static addFloats(Nr,Lr){Nr.addFieldOffset(8,Lr,0)}static createFloatsVector(Nr,Lr){Nr.startVector(4,Lr.length,4);for(let Ur=Lr.length-1;Ur>=0;Ur--)Nr.addFloat32(Lr[Ur]);return Nr.endVector()}static startFloatsVector(Nr,Lr){Nr.startVector(4,Lr,4)}static addInts(Nr,Lr){Nr.addFieldOffset(9,Lr,0)}static createIntsVector(Nr,Lr){Nr.startVector(8,Lr.length,8);for(let Ur=Lr.length-1;Ur>=0;Ur--)Nr.addInt64(Lr[Ur]);return Nr.endVector()}static startIntsVector(Nr,Lr){Nr.startVector(8,Lr,8)}static addStrings(Nr,Lr){Nr.addFieldOffset(10,Lr,0)}static createStringsVector(Nr,Lr){Nr.startVector(4,Lr.length,4);for(let Ur=Lr.length-1;Ur>=0;Ur--)Nr.addOffset(Lr[Ur]);return Nr.endVector()}static startStringsVector(Nr,Lr){Nr.startVector(4,Lr,4)}static addTensors(Nr,Lr){Nr.addFieldOffset(11,Lr,0)}static createTensorsVector(Nr,Lr){Nr.startVector(4,Lr.length,4);for(let Ur=Lr.length-1;Ur>=0;Ur--)Nr.addOffset(Lr[Ur]);return Nr.endVector()}static startTensorsVector(Nr,Lr){Nr.startVector(4,Lr,4)}static addGraphs(Nr,Lr){Nr.addFieldOffset(12,Lr,0)}static createGraphsVector(Nr,Lr){Nr.startVector(4,Lr.length,4);for(let Ur=Lr.length-1;Ur>=0;Ur--)Nr.addOffset(Lr[Ur]);return Nr.endVector()}static startGraphsVector(Nr,Lr){Nr.startVector(4,Lr,4)}static endAttribute(Nr){return Nr.endObject()}static createAttribute(Nr,Lr,Ur,Vr,Wr,qr,Kr,Xr,Zr,_i,Jr,es,ts,is){return jr.startAttribute(Nr),jr.addName(Nr,Lr),jr.addDocString(Nr,Ur),jr.addType(Nr,Vr),jr.addF(Nr,Wr),jr.addI(Nr,qr),jr.addS(Nr,Kr),jr.addT(Nr,Xr),jr.addG(Nr,Zr),jr.addFloats(Nr,_i),jr.addInts(Nr,Jr),jr.addStrings(Nr,es),jr.addTensors(Nr,ts),jr.addGraphs(Nr,is),jr.endAttribute(Nr)}}zr.Attribute=jr})(Fr.fbs||(Fr.fbs={}))})(Mr.experimental||(Mr.experimental={}))}(Tr.onnxruntime||(Tr.onnxruntime={})),function(Mr){(function(Fr){(function(zr){class jr{constructor(){this.bb=null,this.bb_pos=0}__init(Nr,Lr){return this.bb_pos=Nr,this.bb=Lr,this}static getRootAsGraph(Nr,Lr){return(Lr||new jr).__init(Nr.readInt32(Nr.position())+Nr.position(),Nr)}static getSizePrefixedRootAsGraph(Nr,Lr){return Nr.setPosition(Nr.position()+Rr.flatbuffers.SIZE_PREFIX_LENGTH),(Lr||new jr).__init(Nr.readInt32(Nr.position())+Nr.position(),Nr)}initializers(Nr,Lr){let Ur=this.bb.__offset(this.bb_pos,4);return Ur?(Lr||new Mr.experimental.fbs.Tensor).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+Ur)+4*Nr),this.bb):null}initializersLength(){let Nr=this.bb.__offset(this.bb_pos,4);return Nr?this.bb.__vector_len(this.bb_pos+Nr):0}nodeArgs(Nr,Lr){let Ur=this.bb.__offset(this.bb_pos,6);return Ur?(Lr||new Mr.experimental.fbs.ValueInfo).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+Ur)+4*Nr),this.bb):null}nodeArgsLength(){let Nr=this.bb.__offset(this.bb_pos,6);return Nr?this.bb.__vector_len(this.bb_pos+Nr):0}nodes(Nr,Lr){let Ur=this.bb.__offset(this.bb_pos,8);return Ur?(Lr||new Mr.experimental.fbs.Node).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+Ur)+4*Nr),this.bb):null}nodesLength(){let Nr=this.bb.__offset(this.bb_pos,8);return Nr?this.bb.__vector_len(this.bb_pos+Nr):0}maxNodeIndex(){let Nr=this.bb.__offset(this.bb_pos,10);return Nr?this.bb.readUint32(this.bb_pos+Nr):0}nodeEdges(Nr,Lr){let Ur=this.bb.__offset(this.bb_pos,12);return Ur?(Lr||new Mr.experimental.fbs.NodeEdge).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+Ur)+4*Nr),this.bb):null}nodeEdgesLength(){let Nr=this.bb.__offset(this.bb_pos,12);return Nr?this.bb.__vector_len(this.bb_pos+Nr):0}inputs(Nr,Lr){let Ur=this.bb.__offset(this.bb_pos,14);return Ur?this.bb.__string(this.bb.__vector(this.bb_pos+Ur)+4*Nr,Lr):null}inputsLength(){let Nr=this.bb.__offset(this.bb_pos,14);return Nr?this.bb.__vector_len(this.bb_pos+Nr):0}outputs(Nr,Lr){let Ur=this.bb.__offset(this.bb_pos,16);return Ur?this.bb.__string(this.bb.__vector(this.bb_pos+Ur)+4*Nr,Lr):null}outputsLength(){let Nr=this.bb.__offset(this.bb_pos,16);return Nr?this.bb.__vector_len(this.bb_pos+Nr):0}sparseInitializers(Nr,Lr){let Ur=this.bb.__offset(this.bb_pos,18);return Ur?(Lr||new Mr.experimental.fbs.SparseTensor).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+Ur)+4*Nr),this.bb):null}sparseInitializersLength(){let Nr=this.bb.__offset(this.bb_pos,18);return Nr?this.bb.__vector_len(this.bb_pos+Nr):0}static startGraph(Nr){Nr.startObject(8)}static addInitializers(Nr,Lr){Nr.addFieldOffset(0,Lr,0)}static createInitializersVector(Nr,Lr){Nr.startVector(4,Lr.length,4);for(let Ur=Lr.length-1;Ur>=0;Ur--)Nr.addOffset(Lr[Ur]);return Nr.endVector()}static startInitializersVector(Nr,Lr){Nr.startVector(4,Lr,4)}static addNodeArgs(Nr,Lr){Nr.addFieldOffset(1,Lr,0)}static createNodeArgsVector(Nr,Lr){Nr.startVector(4,Lr.length,4);for(let Ur=Lr.length-1;Ur>=0;Ur--)Nr.addOffset(Lr[Ur]);return Nr.endVector()}static startNodeArgsVector(Nr,Lr){Nr.startVector(4,Lr,4)}static addNodes(Nr,Lr){Nr.addFieldOffset(2,Lr,0)}static createNodesVector(Nr,Lr){Nr.startVector(4,Lr.length,4);for(let Ur=Lr.length-1;Ur>=0;Ur--)Nr.addOffset(Lr[Ur]);return Nr.endVector()}static startNodesVector(Nr,Lr){Nr.startVector(4,Lr,4)}static addMaxNodeIndex(Nr,Lr){Nr.addFieldInt32(3,Lr,0)}static addNodeEdges(Nr,Lr){Nr.addFieldOffset(4,Lr,0)}static createNodeEdgesVector(Nr,Lr){Nr.startVector(4,Lr.length,4);for(let Ur=Lr.length-1;Ur>=0;Ur--)Nr.addOffset(Lr[Ur]);return Nr.endVector()}static startNodeEdgesVector(Nr,Lr){Nr.startVector(4,Lr,4)}static addInputs(Nr,Lr){Nr.addFieldOffset(5,Lr,0)}static createInputsVector(Nr,Lr){Nr.startVector(4,Lr.length,4);for(let Ur=Lr.length-1;Ur>=0;Ur--)Nr.addOffset(Lr[Ur]);return Nr.endVector()}static startInputsVector(Nr,Lr){Nr.startVector(4,Lr,4)}static addOutputs(Nr,Lr){Nr.addFieldOffset(6,Lr,0)}static createOutputsVector(Nr,Lr){Nr.startVector(4,Lr.length,4);for(let Ur=Lr.length-1;Ur>=0;Ur--)Nr.addOffset(Lr[Ur]);return Nr.endVector()}static startOutputsVector(Nr,Lr){Nr.startVector(4,Lr,4)}static addSparseInitializers(Nr,Lr){Nr.addFieldOffset(7,Lr,0)}static createSparseInitializersVector(Nr,Lr){Nr.startVector(4,Lr.length,4);for(let Ur=Lr.length-1;Ur>=0;Ur--)Nr.addOffset(Lr[Ur]);return Nr.endVector()}static startSparseInitializersVector(Nr,Lr){Nr.startVector(4,Lr,4)}static endGraph(Nr){return Nr.endObject()}static createGraph(Nr,Lr,Ur,Vr,Wr,qr,Kr,Xr,Zr){return jr.startGraph(Nr),jr.addInitializers(Nr,Lr),jr.addNodeArgs(Nr,Ur),jr.addNodes(Nr,Vr),jr.addMaxNodeIndex(Nr,Wr),jr.addNodeEdges(Nr,qr),jr.addInputs(Nr,Kr),jr.addOutputs(Nr,Xr),jr.addSparseInitializers(Nr,Zr),jr.endGraph(Nr)}}zr.Graph=jr})(Fr.fbs||(Fr.fbs={}))})(Mr.experimental||(Mr.experimental={}))}(Tr.onnxruntime||(Tr.onnxruntime={})),function(Mr){(function(Fr){(function(zr){class jr{constructor(){this.bb=null,this.bb_pos=0}__init(Nr,Lr){return this.bb_pos=Nr,this.bb=Lr,this}static getRootAsModel(Nr,Lr){return(Lr||new jr).__init(Nr.readInt32(Nr.position())+Nr.position(),Nr)}static getSizePrefixedRootAsModel(Nr,Lr){return Nr.setPosition(Nr.position()+Rr.flatbuffers.SIZE_PREFIX_LENGTH),(Lr||new jr).__init(Nr.readInt32(Nr.position())+Nr.position(),Nr)}irVersion(){let Nr=this.bb.__offset(this.bb_pos,4);return Nr?this.bb.readInt64(this.bb_pos+Nr):this.bb.createLong(0,0)}opsetImport(Nr,Lr){let Ur=this.bb.__offset(this.bb_pos,6);return Ur?(Lr||new Mr.experimental.fbs.OperatorSetId).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+Ur)+4*Nr),this.bb):null}opsetImportLength(){let Nr=this.bb.__offset(this.bb_pos,6);return Nr?this.bb.__vector_len(this.bb_pos+Nr):0}producerName(Nr){let Lr=this.bb.__offset(this.bb_pos,8);return Lr?this.bb.__string(this.bb_pos+Lr,Nr):null}producerVersion(Nr){let Lr=this.bb.__offset(this.bb_pos,10);return Lr?this.bb.__string(this.bb_pos+Lr,Nr):null}domain(Nr){let Lr=this.bb.__offset(this.bb_pos,12);return Lr?this.bb.__string(this.bb_pos+Lr,Nr):null}modelVersion(){let Nr=this.bb.__offset(this.bb_pos,14);return Nr?this.bb.readInt64(this.bb_pos+Nr):this.bb.createLong(0,0)}docString(Nr){let Lr=this.bb.__offset(this.bb_pos,16);return Lr?this.bb.__string(this.bb_pos+Lr,Nr):null}graph(Nr){let Lr=this.bb.__offset(this.bb_pos,18);return Lr?(Nr||new Mr.experimental.fbs.Graph).__init(this.bb.__indirect(this.bb_pos+Lr),this.bb):null}graphDocString(Nr){let Lr=this.bb.__offset(this.bb_pos,20);return Lr?this.bb.__string(this.bb_pos+Lr,Nr):null}static startModel(Nr){Nr.startObject(9)}static addIrVersion(Nr,Lr){Nr.addFieldInt64(0,Lr,Nr.createLong(0,0))}static addOpsetImport(Nr,Lr){Nr.addFieldOffset(1,Lr,0)}static createOpsetImportVector(Nr,Lr){Nr.startVector(4,Lr.length,4);for(let Ur=Lr.length-1;Ur>=0;Ur--)Nr.addOffset(Lr[Ur]);return Nr.endVector()}static startOpsetImportVector(Nr,Lr){Nr.startVector(4,Lr,4)}static addProducerName(Nr,Lr){Nr.addFieldOffset(2,Lr,0)}static addProducerVersion(Nr,Lr){Nr.addFieldOffset(3,Lr,0)}static addDomain(Nr,Lr){Nr.addFieldOffset(4,Lr,0)}static addModelVersion(Nr,Lr){Nr.addFieldInt64(5,Lr,Nr.createLong(0,0))}static addDocString(Nr,Lr){Nr.addFieldOffset(6,Lr,0)}static addGraph(Nr,Lr){Nr.addFieldOffset(7,Lr,0)}static addGraphDocString(Nr,Lr){Nr.addFieldOffset(8,Lr,0)}static endModel(Nr){return Nr.endObject()}static createModel(Nr,Lr,Ur,Vr,Wr,qr,Kr,Xr,Zr,_i){return jr.startModel(Nr),jr.addIrVersion(Nr,Lr),jr.addOpsetImport(Nr,Ur),jr.addProducerName(Nr,Vr),jr.addProducerVersion(Nr,Wr),jr.addDomain(Nr,qr),jr.addModelVersion(Nr,Kr),jr.addDocString(Nr,Xr),jr.addGraph(Nr,Zr),jr.addGraphDocString(Nr,_i),jr.endModel(Nr)}}zr.Model=jr})(Fr.fbs||(Fr.fbs={}))})(Mr.experimental||(Mr.experimental={}))}(Tr.onnxruntime||(Tr.onnxruntime={})),function(Mr){(function(Fr){(function(zr){class jr{constructor(){this.bb=null,this.bb_pos=0}__init(Nr,Lr){return this.bb_pos=Nr,this.bb=Lr,this}static getRootAsKernelCreateInfos(Nr,Lr){return(Lr||new jr).__init(Nr.readInt32(Nr.position())+Nr.position(),Nr)}static getSizePrefixedRootAsKernelCreateInfos(Nr,Lr){return Nr.setPosition(Nr.position()+Rr.flatbuffers.SIZE_PREFIX_LENGTH),(Lr||new jr).__init(Nr.readInt32(Nr.position())+Nr.position(),Nr)}nodeIndices(Nr){let Lr=this.bb.__offset(this.bb_pos,4);return Lr?this.bb.readUint32(this.bb.__vector(this.bb_pos+Lr)+4*Nr):0}nodeIndicesLength(){let Nr=this.bb.__offset(this.bb_pos,4);return Nr?this.bb.__vector_len(this.bb_pos+Nr):0}nodeIndicesArray(){let Nr=this.bb.__offset(this.bb_pos,4);return Nr?new Uint32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+Nr),this.bb.__vector_len(this.bb_pos+Nr)):null}kernelDefHashes(Nr){let Lr=this.bb.__offset(this.bb_pos,6);return Lr?this.bb.readUint64(this.bb.__vector(this.bb_pos+Lr)+8*Nr):this.bb.createLong(0,0)}kernelDefHashesLength(){let Nr=this.bb.__offset(this.bb_pos,6);return Nr?this.bb.__vector_len(this.bb_pos+Nr):0}static startKernelCreateInfos(Nr){Nr.startObject(2)}static addNodeIndices(Nr,Lr){Nr.addFieldOffset(0,Lr,0)}static createNodeIndicesVector(Nr,Lr){Nr.startVector(4,Lr.length,4);for(let Ur=Lr.length-1;Ur>=0;Ur--)Nr.addInt32(Lr[Ur]);return Nr.endVector()}static startNodeIndicesVector(Nr,Lr){Nr.startVector(4,Lr,4)}static addKernelDefHashes(Nr,Lr){Nr.addFieldOffset(1,Lr,0)}static createKernelDefHashesVector(Nr,Lr){Nr.startVector(8,Lr.length,8);for(let Ur=Lr.length-1;Ur>=0;Ur--)Nr.addInt64(Lr[Ur]);return Nr.endVector()}static startKernelDefHashesVector(Nr,Lr){Nr.startVector(8,Lr,8)}static endKernelCreateInfos(Nr){return Nr.endObject()}static createKernelCreateInfos(Nr,Lr,Ur){return jr.startKernelCreateInfos(Nr),jr.addNodeIndices(Nr,Lr),jr.addKernelDefHashes(Nr,Ur),jr.endKernelCreateInfos(Nr)}}zr.KernelCreateInfos=jr})(Fr.fbs||(Fr.fbs={}))})(Mr.experimental||(Mr.experimental={}))}(Tr.onnxruntime||(Tr.onnxruntime={})),function(Mr){(function(Fr){(function(zr){class jr{constructor(){this.bb=null,this.bb_pos=0}__init(Nr,Lr){return this.bb_pos=Nr,this.bb=Lr,this}static getRootAsSubGraphSessionState(Nr,Lr){return(Lr||new jr).__init(Nr.readInt32(Nr.position())+Nr.position(),Nr)}static getSizePrefixedRootAsSubGraphSessionState(Nr,Lr){return Nr.setPosition(Nr.position()+Rr.flatbuffers.SIZE_PREFIX_LENGTH),(Lr||new jr).__init(Nr.readInt32(Nr.position())+Nr.position(),Nr)}graphId(Nr){let Lr=this.bb.__offset(this.bb_pos,4);return Lr?this.bb.__string(this.bb_pos+Lr,Nr):null}sessionState(Nr){let Lr=this.bb.__offset(this.bb_pos,6);return Lr?(Nr||new Mr.experimental.fbs.SessionState).__init(this.bb.__indirect(this.bb_pos+Lr),this.bb):null}static startSubGraphSessionState(Nr){Nr.startObject(2)}static addGraphId(Nr,Lr){Nr.addFieldOffset(0,Lr,0)}static addSessionState(Nr,Lr){Nr.addFieldOffset(1,Lr,0)}static endSubGraphSessionState(Nr){let Lr=Nr.endObject();return Nr.requiredField(Lr,4),Lr}static createSubGraphSessionState(Nr,Lr,Ur){return jr.startSubGraphSessionState(Nr),jr.addGraphId(Nr,Lr),jr.addSessionState(Nr,Ur),jr.endSubGraphSessionState(Nr)}}zr.SubGraphSessionState=jr})(Fr.fbs||(Fr.fbs={}))})(Mr.experimental||(Mr.experimental={}))}(Tr.onnxruntime||(Tr.onnxruntime={})),function(Mr){(function(Fr){(function(zr){class jr{constructor(){this.bb=null,this.bb_pos=0}__init(Nr,Lr){return this.bb_pos=Nr,this.bb=Lr,this}static getRootAsSessionState(Nr,Lr){return(Lr||new jr).__init(Nr.readInt32(Nr.position())+Nr.position(),Nr)}static getSizePrefixedRootAsSessionState(Nr,Lr){return Nr.setPosition(Nr.position()+Rr.flatbuffers.SIZE_PREFIX_LENGTH),(Lr||new jr).__init(Nr.readInt32(Nr.position())+Nr.position(),Nr)}kernels(Nr){let Lr=this.bb.__offset(this.bb_pos,4);return Lr?(Nr||new Mr.experimental.fbs.KernelCreateInfos).__init(this.bb.__indirect(this.bb_pos+Lr),this.bb):null}subGraphSessionStates(Nr,Lr){let Ur=this.bb.__offset(this.bb_pos,6);return Ur?(Lr||new Mr.experimental.fbs.SubGraphSessionState).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+Ur)+4*Nr),this.bb):null}subGraphSessionStatesLength(){let Nr=this.bb.__offset(this.bb_pos,6);return Nr?this.bb.__vector_len(this.bb_pos+Nr):0}static startSessionState(Nr){Nr.startObject(2)}static addKernels(Nr,Lr){Nr.addFieldOffset(0,Lr,0)}static addSubGraphSessionStates(Nr,Lr){Nr.addFieldOffset(1,Lr,0)}static createSubGraphSessionStatesVector(Nr,Lr){Nr.startVector(4,Lr.length,4);for(let Ur=Lr.length-1;Ur>=0;Ur--)Nr.addOffset(Lr[Ur]);return Nr.endVector()}static startSubGraphSessionStatesVector(Nr,Lr){Nr.startVector(4,Lr,4)}static endSessionState(Nr){return Nr.endObject()}static createSessionState(Nr,Lr,Ur){return jr.startSessionState(Nr),jr.addKernels(Nr,Lr),jr.addSubGraphSessionStates(Nr,Ur),jr.endSessionState(Nr)}}zr.SessionState=jr})(Fr.fbs||(Fr.fbs={}))})(Mr.experimental||(Mr.experimental={}))}(Tr.onnxruntime||(Tr.onnxruntime={})),function(Mr){(function(Fr){(function(zr){class jr{constructor(){this.bb=null,this.bb_pos=0}__init(Nr,Lr){return this.bb_pos=Nr,this.bb=Lr,this}static getRootAsInferenceSession(Nr,Lr){return(Lr||new jr).__init(Nr.readInt32(Nr.position())+Nr.position(),Nr)}static getSizePrefixedRootAsInferenceSession(Nr,Lr){return Nr.setPosition(Nr.position()+Rr.flatbuffers.SIZE_PREFIX_LENGTH),(Lr||new jr).__init(Nr.readInt32(Nr.position())+Nr.position(),Nr)}static bufferHasIdentifier(Nr){return Nr.__has_identifier("ORTM")}ortVersion(Nr){let Lr=this.bb.__offset(this.bb_pos,4);return Lr?this.bb.__string(this.bb_pos+Lr,Nr):null}model(Nr){let Lr=this.bb.__offset(this.bb_pos,6);return Lr?(Nr||new Mr.experimental.fbs.Model).__init(this.bb.__indirect(this.bb_pos+Lr),this.bb):null}sessionState(Nr){let Lr=this.bb.__offset(this.bb_pos,8);return Lr?(Nr||new Mr.experimental.fbs.SessionState).__init(this.bb.__indirect(this.bb_pos+Lr),this.bb):null}static startInferenceSession(Nr){Nr.startObject(3)}static addOrtVersion(Nr,Lr){Nr.addFieldOffset(0,Lr,0)}static addModel(Nr,Lr){Nr.addFieldOffset(1,Lr,0)}static addSessionState(Nr,Lr){Nr.addFieldOffset(2,Lr,0)}static endInferenceSession(Nr){return Nr.endObject()}static finishInferenceSessionBuffer(Nr,Lr){Nr.finish(Lr,"ORTM")}static finishSizePrefixedInferenceSessionBuffer(Nr,Lr){Nr.finish(Lr,"ORTM",!0)}static createInferenceSession(Nr,Lr,Ur,Vr){return jr.startInferenceSession(Nr),jr.addOrtVersion(Nr,Lr),jr.addModel(Nr,Ur),jr.addSessionState(Nr,Vr),jr.endInferenceSession(Nr)}}zr.InferenceSession=jr})(Fr.fbs||(Fr.fbs={}))})(Mr.experimental||(Mr.experimental={}))}(Tr.onnxruntime||(Tr.onnxruntime={}))},1723:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.OnnxjsSessionHandler=void 0;const Rr=Ar(8453),Pr=Ar(9240);Tr.OnnxjsSessionHandler=class{constructor(Dr){this.session=Dr,this.inputNames=this.session.inputNames,this.outputNames=this.session.outputNames}async dispose(){}async run(Dr,Mr,Fr){const zr=new Map;for(const Nr in Dr)if(Object.hasOwnProperty.call(Dr,Nr)){const Lr=Dr[Nr];zr.set(Nr,new Pr.Tensor(Lr.dims,Lr.type,void 0,void 0,Lr.data))}const jr=await this.session.run(zr),Gr={};return jr.forEach((Nr,Lr)=>{Gr[Lr]=new Rr.Tensor(Nr.type,Nr.data,Nr.dims)}),Gr}startProfiling(){this.session.startProfiling()}endProfiling(){this.session.endProfiling()}}},6027:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.Session=void 0;const Rr=Ar(7067),Pr=Ar(1296),Dr=Ar(1975),Mr=Ar(6496),Fr=Ar(1315),zr=Ar(1745);Tr.Session=class{constructor(jr={}){this._initialized=!1,this.backendHint=jr.backendHint,this.profiler=Fr.Profiler.create(jr.profiler),this.context={profiler:this.profiler,graphInputTypes:[],graphInputDims:[]}}get inputNames(){return this._model.graph.getInputNames()}get outputNames(){return this._model.graph.getOutputNames()}startProfiling(){this.profiler.start()}endProfiling(){this.profiler.stop()}async loadModel(jr,Gr,Nr){await this.profiler.event("session","Session.loadModel",async()=>{const Lr=await(0,Dr.resolveBackend)(this.backendHint);if(this.sessionHandler=Lr.createSessionHandler(this.context),this._model=new zr.Model,typeof jr=="string"){const Ur=jr.endsWith(".ort");if(typeof fetch>"u"){const Vr=await(0,Pr.promisify)(Rr.readFile)(jr);this.initialize(Vr,Ur)}else{const Vr=await fetch(jr),Wr=await Vr.arrayBuffer();this.initialize(new Uint8Array(Wr),Ur)}}else if(ArrayBuffer.isView(jr))this.initialize(jr);else{const Ur=new Uint8Array(jr,Gr||0,Nr||jr.byteLength);this.initialize(Ur)}})}initialize(jr,Gr){if(this._initialized)throw new Error("already initialized");this.profiler.event("session","Session.initialize",()=>{const Nr=this.sessionHandler.transformGraph?this.sessionHandler:void 0;this._model.load(jr,Nr,Gr),this.sessionHandler.onGraphInitialized&&this.sessionHandler.onGraphInitialized(this._model.graph),this.initializeOps(this._model.graph),this._executionPlan=new Mr.ExecutionPlan(this._model.graph,this._ops,this.profiler)}),this._initialized=!0}async run(jr){if(!this._initialized)throw new Error("session not initialized yet");return this.profiler.event("session","Session.run",async()=>{const Gr=this.normalizeAndValidateInputs(jr),Nr=await this._executionPlan.execute(this.sessionHandler,Gr);return this.createOutput(Nr)})}normalizeAndValidateInputs(jr){const Gr=this._model.graph.getInputNames();if(Array.isArray(jr)){if(jr.length!==Gr.length)throw new Error(`incorrect input array length: expected ${Gr.length} but got ${jr.length}`)}else{if(jr.size!==Gr.length)throw new Error(`incorrect input map size: expected ${Gr.length} but got ${jr.size}`);const Nr=new Array(jr.size);let Lr=0;for(let Ur=0;Ur<Gr.length;++Ur){const Vr=jr.get(Gr[Ur]);if(!Vr)throw new Error(`missing input tensor for: '${name}'`);Nr[Lr++]=Vr}jr=Nr}if(this.context.graphInputTypes&&this.context.graphInputTypes.length!==0&&this.context.graphInputDims&&this.context.graphInputDims.length!==0)this.validateInputTensorDims(this.context.graphInputDims,jr,!1);else{const Nr=this._model.graph.getInputIndices(),Lr=this._model.graph.getValues(),Ur=new Array(Nr.length);for(let Vr=0;Vr<Nr.length;++Vr){const Wr=Lr[Nr[Vr]];Ur[Vr]=Wr.type.shape.dims,this.context.graphInputTypes.push(Wr.type.tensorType),this.context.graphInputDims.push(jr[Vr].dims)}this.validateInputTensorDims(Ur,jr,!0)}return this.validateInputTensorTypes(this.context.graphInputTypes,jr),jr}validateInputTensorTypes(jr,Gr){for(let Nr=0;Nr<Gr.length;Nr++){const Lr=jr[Nr],Ur=Gr[Nr].type;if(Lr!==Ur)throw new Error(`input tensor[${Nr}] check failed: expected type '${Lr}' but got ${Ur}`)}}validateInputTensorDims(jr,Gr,Nr){for(let Lr=0;Lr<Gr.length;Lr++){const Ur=jr[Lr],Vr=Gr[Lr].dims;if(!this.compareTensorDims(Ur,Vr,Nr))throw new Error(`input tensor[${Lr}] check failed: expected shape '[${Ur.join(",")}]' but got [${Vr.join(",")}]`)}}compareTensorDims(jr,Gr,Nr){if(jr.length!==Gr.length)return!1;for(let Lr=0;Lr<jr.length;++Lr)if(jr[Lr]!==Gr[Lr]&&(!Nr||jr[Lr]!==0))return!1;return!0}createOutput(jr){const Gr=this._model.graph.getOutputNames();if(jr.length!==Gr.length)throw new Error("expected number of outputs do not match number of generated outputs");const Nr=new Map;for(let Lr=0;Lr<Gr.length;++Lr)Nr.set(Gr[Lr],jr[Lr]);return Nr}initializeOps(jr){const Gr=jr.getNodes();this._ops=new Array(Gr.length);for(let Nr=0;Nr<Gr.length;Nr++)this._ops[Nr]=this.sessionHandler.resolve(Gr[Nr],this._model.opsets,jr)}}},9240:function(_r,Tr,Ar){var Rr=this&&this.__importDefault||function(Wr){return Wr&&Wr.__esModule?Wr:{default:Wr}};Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.Tensor=void 0;const Pr=Ar(3442),Dr=Rr(Ar(3720)),Mr=Ar(1446),Fr=Ar(1287),zr=Ar(7273);var jr=Fr.onnxruntime.experimental.fbs;class Gr{get data(){if(this.cache===void 0){const qr=this.dataProvider(this.dataId);if(qr.length!==this.size)throw new Error("Length of data provided by the Data Provider is inconsistent with the dims of this Tensor.");this.cache=qr}return this.cache}get stringData(){if(this.type!=="string")throw new TypeError("data type is not string");return this.data}get integerData(){switch(this.type){case"uint8":case"int8":case"uint16":case"int16":case"int32":case"uint32":case"bool":return this.data;default:throw new TypeError("data type is not integer (uint8, int8, uint16, int16, int32, uint32, bool)")}}get floatData(){switch(this.type){case"float32":case"float64":return this.data;default:throw new TypeError("data type is not float (float32, float64)")}}get numberData(){if(this.type!=="string")return this.data;throw new TypeError("type cannot be non-number (string)")}get(qr){return this.data[zr.ShapeUtil.indicesToOffset(qr,this.strides)]}set(qr,Kr){this.data[zr.ShapeUtil.indicesToOffset(qr,this.strides)]=Kr}async getData(){return this.cache===void 0&&(this.cache=await this.asyncDataProvider(this.dataId)),this.cache}get strides(){return this._strides||(this._strides=zr.ShapeUtil.computeStrides(this.dims)),this._strides}constructor(qr,Kr,Xr,Zr,_i,Jr=Pr.Guid.create()){this.dims=qr,this.type=Kr,this.dataProvider=Xr,this.asyncDataProvider=Zr,this.cache=_i,this.dataId=Jr,this.size=zr.ShapeUtil.validateDimsAndCalcSize(qr);const es=this.size,ts=Xr===void 0&&Zr===void 0&&_i===void 0;if(_i!==void 0&&_i.length!==es)throw new RangeError("Input dims doesn't match data length.");if(Kr==="string"){if(!(_i===void 0||Array.isArray(_i)&&_i.every(is=>typeof is=="string")))throw new TypeError("cache should be a string array");ts&&(this.cache=new Array(es))}else{if(_i!==void 0){const is=Lr(Kr);if(!(_i instanceof is))throw new TypeError(`cache should be type ${is.name}`)}if(ts){const is=new ArrayBuffer(es*function(rs){switch(rs){case"bool":case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;case"float64":return 8;default:throw new Error(`cannot calculate sizeof() on type ${rs}`)}}(Kr));this.cache=function(rs,as){return new(Lr(as))(rs)}(is,Kr)}}}static fromProto(qr){if(!qr)throw new Error("cannot construct Value from an empty tensor");const Kr=zr.ProtoUtil.tensorDataTypeFromProto(qr.dataType),Xr=zr.ProtoUtil.tensorDimsFromProto(qr.dims),Zr=new Gr(Xr,Kr);if(Kr==="string")qr.stringData.forEach((_i,Jr)=>{Zr.data[Jr]=(0,zr.decodeUtf8String)(_i)});else if(qr.rawData&&typeof qr.rawData.byteLength=="number"&&qr.rawData.byteLength>0){const _i=Zr.data,Jr=new DataView(qr.rawData.buffer,qr.rawData.byteOffset,qr.rawData.byteLength),es=Nr(qr.dataType),ts=qr.rawData.byteLength/es;if(qr.rawData.byteLength%es!=0)throw new Error("invalid buffer length");if(_i.length!==ts)throw new Error("buffer length mismatch");for(let is=0;is<ts;is++){const rs=Vr(Jr,qr.dataType,is*es);_i[is]=rs}}else{let _i;switch(qr.dataType){case Mr.onnx.TensorProto.DataType.FLOAT:_i=qr.floatData;break;case Mr.onnx.TensorProto.DataType.INT32:case Mr.onnx.TensorProto.DataType.INT16:case Mr.onnx.TensorProto.DataType.UINT16:case Mr.onnx.TensorProto.DataType.INT8:case Mr.onnx.TensorProto.DataType.UINT8:case Mr.onnx.TensorProto.DataType.BOOL:_i=qr.int32Data;break;case Mr.onnx.TensorProto.DataType.INT64:_i=qr.int64Data;break;case Mr.onnx.TensorProto.DataType.DOUBLE:_i=qr.doubleData;break;case Mr.onnx.TensorProto.DataType.UINT32:case Mr.onnx.TensorProto.DataType.UINT64:_i=qr.uint64Data;break;default:throw new Error("unspecific error")}if(_i==null)throw new Error("failed to populate data from a tensorproto value");const Jr=Zr.data;if(Jr.length!==_i.length)throw new Error("array length mismatch");for(let es=0;es<_i.length;es++){const ts=_i[es];Dr.default.isLong(ts)?Jr[es]=Ur(ts,qr.dataType):Jr[es]=ts}}return Zr}static fromData(qr,Kr,Xr){return new Gr(Kr,Xr,void 0,void 0,qr)}static fromOrtTensor(qr){if(!qr)throw new Error("cannot construct Value from an empty tensor");const Kr=zr.ProtoUtil.tensorDimsFromORTFormat(qr),Xr=zr.ProtoUtil.tensorDataTypeFromProto(qr.dataType()),Zr=new Gr(Kr,Xr);if(Xr==="string")for(let _i=0;_i<qr.stringDataLength();_i++)Zr.data[_i]=qr.stringData(_i);else if(qr.rawDataArray()&&typeof qr.rawDataLength()=="number"&&qr.rawDataLength()>0){const _i=Zr.data,Jr=new DataView(qr.rawDataArray().buffer,qr.rawDataArray().byteOffset,qr.rawDataLength()),es=Nr(qr.dataType()),ts=qr.rawDataLength()/es;if(qr.rawDataLength()%es!=0)throw new Error("invalid buffer length");if(_i.length!==ts)throw new Error("buffer length mismatch");for(let is=0;is<ts;is++){const rs=Vr(Jr,qr.dataType(),is*es);_i[is]=rs}}return Zr}}function Nr(Wr){switch(Wr){case Mr.onnx.TensorProto.DataType.UINT8:case Mr.onnx.TensorProto.DataType.INT8:case Mr.onnx.TensorProto.DataType.BOOL:return 1;case Mr.onnx.TensorProto.DataType.UINT16:case Mr.onnx.TensorProto.DataType.INT16:return 2;case Mr.onnx.TensorProto.DataType.FLOAT:case Mr.onnx.TensorProto.DataType.INT32:case Mr.onnx.TensorProto.DataType.UINT32:return 4;case Mr.onnx.TensorProto.DataType.INT64:case Mr.onnx.TensorProto.DataType.DOUBLE:case Mr.onnx.TensorProto.DataType.UINT64:return 8;default:throw new Error(`cannot calculate sizeof() on type ${Mr.onnx.TensorProto.DataType[Wr]}`)}}function Lr(Wr){switch(Wr){case"bool":case"uint8":return Uint8Array;case"int8":return Int8Array;case"int16":return Int16Array;case"uint16":return Uint16Array;case"int32":return Int32Array;case"uint32":return Uint32Array;case"float32":return Float32Array;case"float64":return Float64Array;default:throw new Error("unspecified error")}}function Ur(Wr,qr){if(qr===Mr.onnx.TensorProto.DataType.INT64||qr===jr.TensorDataType.INT64){if(Wr.greaterThanOrEqual(2147483648)||Wr.lessThan(-2147483648))throw new TypeError("int64 is not supported")}else{if(qr!==Mr.onnx.TensorProto.DataType.UINT32&&qr!==jr.TensorDataType.UINT32&&qr!==Mr.onnx.TensorProto.DataType.UINT64&&qr!==jr.TensorDataType.UINT64)throw new TypeError(`not a LONG type: ${Mr.onnx.TensorProto.DataType[qr]}`);if(Wr.greaterThanOrEqual(4294967296)||Wr.lessThan(0))throw new TypeError("uint64 is not supported")}return Wr.toNumber()}function Vr(Wr,qr,Kr){switch(qr){case Mr.onnx.TensorProto.DataType.BOOL:case Mr.onnx.TensorProto.DataType.UINT8:return Wr.getUint8(Kr);case Mr.onnx.TensorProto.DataType.INT8:return Wr.getInt8(Kr);case Mr.onnx.TensorProto.DataType.UINT16:return Wr.getUint16(Kr,!0);case Mr.onnx.TensorProto.DataType.INT16:return Wr.getInt16(Kr,!0);case Mr.onnx.TensorProto.DataType.FLOAT:return Wr.getFloat32(Kr,!0);case Mr.onnx.TensorProto.DataType.INT32:return Wr.getInt32(Kr,!0);case Mr.onnx.TensorProto.DataType.UINT32:return Wr.getUint32(Kr,!0);case Mr.onnx.TensorProto.DataType.INT64:return Ur(Dr.default.fromBits(Wr.getUint32(Kr,!0),Wr.getUint32(Kr+4,!0),!1),qr);case Mr.onnx.TensorProto.DataType.DOUBLE:return Wr.getFloat64(Kr,!0);case Mr.onnx.TensorProto.DataType.UINT64:return Ur(Dr.default.fromBits(Wr.getUint32(Kr,!0),Wr.getUint32(Kr+4,!0),!0),qr);default:throw new Error(`cannot read from DataView for type ${Mr.onnx.TensorProto.DataType[qr]}`)}}Tr.Tensor=Gr},7273:function(_r,Tr,Ar){var Rr=this&&this.__importDefault||function(qr){return qr&&qr.__esModule?qr:{default:qr}};Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.decodeUtf8String=Tr.MAX_CLIP=Tr.MIN_CLIP=Tr.PoolConvUtil=Tr.ReduceUtil=Tr.SplitUtil=Tr.MathUtil=Tr.ShapeUtil=Tr.LongUtil=Tr.ProtoUtil=Tr.GemmUtil=Tr.arrayCopyHelper=Tr.BroadcastUtil=Tr.MatMulUtil=Tr.ArrayUtil=Tr.assert=Tr.checkInputsShape=void 0;const Pr=Ar(5686),Dr=Rr(Ar(3720)),Mr=Ar(1446),Fr=Ar(9240);Tr.checkInputsShape=function(qr,...Kr){if(!qr||qr.length!==Kr.length)return!1;for(let Xr=0;Xr<qr.length;Xr++)if(!qr[Xr].dims||qr[Xr].dims.length!==Kr[Xr])return!1;return!0},Tr.assert=function(qr,Kr){if(!qr)throw new Error(typeof Kr=="string"?Kr:Kr())},Tr.ArrayUtil=class{static arraysEqual(qr,Kr){if(qr.length!==Kr.length)return!1;for(let Xr=0;Xr<qr.length;Xr++)if(qr[Xr]!==Kr[Xr])return!1;return!0}};class zr{static preprocessInputShapes(Kr,Xr){return[Kr.length===1?[1,Kr[0]]:Kr,Xr.length===1?[Xr[0],1]:Xr]}static postprocessOutputShape(Kr,Xr,Zr){Xr===1&&Kr.splice(Kr.length-2,1),Zr===1&&Kr.pop()}static calcMatMulShape(Kr,Xr){return Kr[1]!==Xr[0]?void 0:[Kr[0],Xr[1]]}}Tr.MatMulUtil=zr;class jr{static calcShape(Kr,Xr,Zr=!1){const _i=Kr.length,Jr=Xr.length;if(_i===0)return Xr;if(Jr===0)return Kr;const es=Math.max(Kr.length,Xr.length),ts=new Array(es);if(Zr){if(_i<2||Jr<2)return;const is=zr.calcMatMulShape([Kr[_i-2],Kr[_i-1]],[Xr[Jr-2],Xr[Jr-1]]);if(is===void 0)return;[ts[es-2],ts[es-1]]=is}for(let is=Zr?3:1;is<=es;is++){const rs=_i-is<0?1:Kr[_i-is],as=Jr-is<0?1:Xr[Jr-is];if(rs!==as&&rs>1&&as>1)return;ts[es-is]=Math.max(rs,as)}return ts}static index(Kr,Xr){const Zr=new Array(Xr.length);return jr.fillIndex(Kr,Xr,Zr),Zr}static fillIndex(Kr,Xr,Zr){const _i=Kr.length-Xr.length;for(let Jr=0;Jr<Xr.length;Jr++)Zr[Jr]=Kr[_i+Jr]%Xr[Jr]}static calc(Kr,Xr,Zr,_i,Jr){const es=jr.calcShape(Kr.dims,Xr.dims);if(es){if(_i&&!Lr.areEqual(es,Kr.dims))return;const ts=Lr.size(es),is=_i?Kr:new Fr.Tensor(es,Jr||Kr.type);if(es.length===0)is.set([],Zr(Kr.get([]),Xr.get([])));else{const rs=new Array(es.length),as=new Array(Kr.dims.length),ls=new Array(Xr.dims.length);let fs,Ts=0,$s=0,xs=!1,ys=!1;Kr.dims.length===0&&(Ts=Kr.get([]),xs=!0),Xr.dims.length===0&&($s=Xr.get([]),ys=!0);for(let ps=0;ps<ts;ps++){fs=ps;for(let vs=es.length-1;vs>=0;vs--)rs[vs]=fs%es[vs],fs=Math.floor(fs/es[vs]);xs||(jr.fillIndex(rs,Kr.dims,as),Ts=Kr.get(as)),ys||(jr.fillIndex(rs,Xr.dims,ls),$s=Xr.get(ls)),is.set(rs,Zr(Ts,$s))}}return is}}static isValidBroadcast(Kr,Xr){const Zr=Kr.length,_i=Xr.length;if(Zr>_i)return!1;for(let Jr=1;Jr<=Zr;Jr++)if(Kr[Zr-Jr]!==1&&Kr[Zr-Jr]!==Xr[_i-Jr])return!1;return!0}static getBroadcastDims(Kr,Xr){const Zr=Kr.length,_i=[];for(let Jr=0;Jr<Zr;Jr++){const es=Zr-1-Jr,ts=Kr[es]||1;(Xr[Xr.length-1-Jr]||1)>1&&ts===1&&_i.unshift(es)}return _i}}Tr.BroadcastUtil=jr,Tr.arrayCopyHelper=function(qr,Kr,Xr,Zr,_i){if(Zr<0||Zr>=Kr.length)throw new Error("sourceIndex out of bounds");if(Xr<0||Xr>=qr.length)throw new Error("targetIndex out of bounds");if(Zr+_i>Kr.length)throw new Error("source indices to be copied are outside bounds");if(Xr+_i>qr.length)throw new Error("target array is too small to hold result");for(let Jr=0;Jr<_i;Jr++)qr[Xr+Jr]=Kr[Zr+Jr]},Tr.GemmUtil=class{static getShapeOfGemmResult(qr,Kr,Xr,Zr,_i){if(qr.length!==2||Xr.length!==2)throw new Error("shape need to be of size 2");let Jr,es,ts;Kr?(Jr=qr[1],es=qr[0]):(Jr=qr[0],es=qr[1]);let is=-1;if(Zr?(ts=Xr[0],is=1):(ts=Xr[1],is=0),Xr[is]!==es)throw new Error("dimension mismatch");if(Jr<=0||ts<=0||es<=0)throw new Error("invalid shape specified");if(_i&&!jr.isValidBroadcast(_i,[Jr,ts]))throw new Error("gemm: invalid bias shape for broadcast");return[Jr,ts,es]}};class Gr{static tensorDataTypeFromProto(Kr){switch(Kr){case Mr.onnx.TensorProto.DataType.INT8:return"int8";case Mr.onnx.TensorProto.DataType.UINT8:return"uint8";case Mr.onnx.TensorProto.DataType.BOOL:return"bool";case Mr.onnx.TensorProto.DataType.INT16:return"int16";case Mr.onnx.TensorProto.DataType.UINT16:return"uint16";case Mr.onnx.TensorProto.DataType.INT32:return"int32";case Mr.onnx.TensorProto.DataType.UINT32:return"uint32";case Mr.onnx.TensorProto.DataType.FLOAT:return"float32";case Mr.onnx.TensorProto.DataType.DOUBLE:return"float64";case Mr.onnx.TensorProto.DataType.STRING:return"string";case Mr.onnx.TensorProto.DataType.INT64:return"int32";case Mr.onnx.TensorProto.DataType.UINT64:return"uint32";default:throw new Error(`unsupported data type: ${Mr.onnx.TensorProto.DataType[Kr]}`)}}static tensorDataTypeStringToEnum(Kr){switch(Kr){case"int8":return Mr.onnx.TensorProto.DataType.INT8;case"uint8":return Mr.onnx.TensorProto.DataType.UINT8;case"bool":return Mr.onnx.TensorProto.DataType.BOOL;case"int16":return Mr.onnx.TensorProto.DataType.INT16;case"uint16":return Mr.onnx.TensorProto.DataType.UINT16;case"int32":return Mr.onnx.TensorProto.DataType.INT32;case"uint32":return Mr.onnx.TensorProto.DataType.UINT32;case"float32":return Mr.onnx.TensorProto.DataType.FLOAT;case"float64":return Mr.onnx.TensorProto.DataType.DOUBLE;case"string":return Mr.onnx.TensorProto.DataType.STRING;case"int64":return Mr.onnx.TensorProto.DataType.INT64;case"uint64":return Mr.onnx.TensorProto.DataType.UINT64;default:throw new Error(`unsupported data type: ${Kr}`)}}static tensorDimsFromProto(Kr){return Kr.map(Xr=>Dr.default.isLong(Xr)?Xr.toNumber():Xr)}static tensorValueTypeFromProto(Kr){return{tensorType:Gr.tensorDataTypeFromProto(Kr.elemType),shape:{dims:Gr.tensorDimsFromProto(Kr.shape.dim.map(Xr=>Xr.dimValue))}}}static tensorDimsFromORTFormat(Kr){const Xr=[];for(let Zr=0;Zr<Kr.dimsLength();Zr++)Xr.push(Nr.longToNumber(Kr.dims(Zr)));return Xr}static tensorAttributesFromORTFormat(Kr){const Xr=[];for(let Zr=0;Zr<Kr.attributesLength();Zr++)Xr.push(Kr.attributes(Zr));return Xr}}Tr.ProtoUtil=Gr;class Nr{static longToNumber(Kr,Xr){return Dr.default.isLong(Kr)?Kr.toNumber():Kr instanceof Pr.flatbuffers.Long?Dr.default.fromValue({low:Kr.low,high:Kr.high,unsigned:Xr!=null&&Xr}).toNumber():Kr}static isLong(Kr){return Dr.default.isLong(Kr)||Kr instanceof Pr.flatbuffers.Long}}Tr.LongUtil=Nr;class Lr{static size(Kr){return Lr.getSizeFromDimensionRange(Kr,0,Kr.length)}static sizeFromDimension(Kr,Xr){if(Xr<0||Xr>Kr.length)throw new Error(`invalid dimension of ${Xr} for sizeFromDimension as Tensor has ${Kr.length} dimensions.`);return Lr.getSizeFromDimensionRange(Kr,Xr,Kr.length)}static sizeToDimension(Kr,Xr){if(Xr<0||Xr>Kr.length)throw new Error(`invalid dimension of ${Xr} for sizeToDimension as Tensor has ${Kr.length} dimensions.`);return Lr.getSizeFromDimensionRange(Kr,0,Xr)}static getSizeFromDimensionRange(Kr,Xr,Zr){let _i=1;for(let Jr=Xr;Jr<Zr;Jr++){if(Kr[Jr]<=0)throw new Error("cannot get valid size from specified dimension range. Most likely the range contains 0 or negative values in them.");_i*=Kr[Jr]}return _i}static computeStrides(Kr){const Xr=Kr.length;if(Xr===0)return[];if(Xr===1)return[1];const Zr=new Array(Xr);Zr[Xr-1]=1,Zr[Xr-2]=Kr[Xr-1];for(let _i=Xr-3;_i>=0;--_i)Zr[_i]=Zr[_i+1]*Kr[_i+1];return Zr}static transpose(Kr){return Kr.slice().reverse()}static indicesToOffset(Kr,Xr,Zr){Zr===void 0&&(Zr=Kr.length);let _i=0;for(let Jr=0;Jr<Zr;++Jr)_i+=Xr[Jr]*Kr[Jr];return _i}static offsetToIndices(Kr,Xr){const Zr=Xr.length;if(Zr===0)return[];if(Zr===1)return[Kr*Xr[0]];const _i=new Array(Xr.length);for(let Jr=0;Jr<_i.length-1;++Jr)_i[Jr]=Math.floor(Kr/Xr[Jr]),Kr-=_i[Jr]*Xr[Jr];return _i[_i.length-1]=Kr,_i}static normalizeAxis(Kr,Xr){if(Kr<-Xr&&Kr>=Xr)throw new Error("unsupported axis for this operation.");return Kr<0?Kr+Xr:Kr}static normalizeAxes(Kr,Xr){return Kr.map(Zr=>this.normalizeAxis(Zr,Xr))}static incrementIndex(Kr,Xr,Zr){if(Xr.length===0||Kr.length===0)throw new Error("Index incrementing unsupported for scalar Tensor");if(Zr===void 0)Zr=Xr.length;else if(Zr<=0||Zr>Xr.length)throw new Error("Incorrect axis to increment on");for(let _i=Zr-1;_i>=0&&(Kr[_i]++,!(Kr[_i]<Xr[_i]));--_i)Kr[_i]=0}static calculateReshapedDims(Kr,Xr){if(Xr.length===0){if(Kr.length===0||Lr.size(Kr)===1)return[];throw new Error("cannot reshape to a scalar Tensor")}const Zr=Xr.length,_i=new Array(Zr);let Jr=-1,es=1;for(let is=0;is<Zr;is++){if(Xr[is]<-1)throw new Error("a dimension in shape hints cannot be less than -1");if(Xr[is]===-1){if(Jr!==-1)throw new Error("at most one dimension in shape hints can be -1");Jr=is}else{if(Xr[is]===0){if(is>=Kr.length)throw new Error("the dimension with value zero exceeds the dimension size of the input tensor");_i[is]=Kr[is]}else _i[is]=Xr[is];es*=_i[is]}}const ts=Lr.size(Kr);if(Jr!==-1){if(ts%es!=0)throw new Error(`the input tensor cannot be reshaped to the requested shape. Input shape: [${Kr}] Output shape: [${Xr}]`);_i[Jr]=ts/es}else if(es!==ts)throw new Error("reshapedDims and originalDims don't have matching sizes");return _i}static sortBasedOnPerm(Kr,Xr){return Xr?Xr.map(Zr=>Kr[Zr]):Kr.slice().reverse()}static padShape(Kr,Xr){const Zr=Kr.length;return Kr.map((_i,Jr)=>_i+Xr[Jr]+Xr[Jr+Zr])}static areEqual(Kr,Xr){return Kr.length===Xr.length&&Kr.every((Zr,_i)=>Zr===Xr[_i])}static validateDimsAndCalcSize(Kr){if(Kr.length>6)throw new TypeError("Only rank 0 to 6 is supported for tensor shape.");let Xr=1;for(const Zr of Kr){if(!Number.isInteger(Zr))throw new TypeError(`Invalid shape: ${Zr} is not an integer`);if(Zr<0||Zr>2147483647)throw new TypeError(`Invalid shape: length ${Zr} is not allowed`);Xr*=Zr}return Xr}static flattenShape(Kr,Xr){Xr<0&&(Xr+=Kr.length);const Zr=Kr.reduce((Jr,es)=>Jr*es,1),_i=Kr.slice(Xr).reduce((Jr,es)=>Jr*es,1);return[Zr/_i,_i]}static squeezeShape(Kr,Xr){const Zr=new Array;Xr=Lr.normalizeAxes(Xr,Kr.length);for(let _i=0;_i<Kr.length;_i++){const Jr=Xr.indexOf(_i)>=0;if(Jr&&Kr[_i]!==1)throw new Error("squeeze an axis of size different than 1");(Xr.length===0&&Kr[_i]>1||Xr.length>0&&!Jr)&&Zr.push(Kr[_i])}return Zr}static unsqueezeShape(Kr,Xr){const Zr=new Array(Kr.length+Xr.length);Zr.fill(0);for(let Jr=0;Jr<Xr.length;Jr++){const es=Lr.normalizeAxis(Xr[Jr],Zr.length);if(es>=Zr.length)throw new Error("'axes' has an out of range axis");if(Zr[es]!==0)throw new Error("'axes' has a duplicate axis");Zr[es]=1}let _i=0;for(let Jr=0;Jr<Zr.length;Jr++)Zr[Jr]===0&&(Zr[Jr]=Kr[_i++]);if(_i!==Kr.length)throw new Error("the unsqueezed dimension could not be established");return Zr}}Tr.ShapeUtil=Lr,Tr.MathUtil=class{static sqr(qr,Kr,Xr,Zr,_i){if(Zr<0||Zr>=Kr.length)throw new Error("sourceIndex out of bounds");if(Xr<0||Xr>=qr.length)throw new Error("targetIndex out of bounds");if(Zr+_i>Kr.length)throw new Error("source indices to be copied are outside bounds");if(Xr+_i>qr.length)throw new Error("target array is too small to hold result");for(let Jr=0;Jr<_i;Jr++)qr[Xr+Jr]+=Math.pow(Kr[Zr+Jr],2)}static axpy(qr,Kr,Xr,Zr,_i,Jr){if(Zr<0||Zr>=Kr.length)throw new Error("sourceIndex out of bounds");if(Xr<0||Xr>=qr.length)throw new Error("targetIndex out of bounds");if(Zr+_i>Kr.length)throw new Error("source indices to be copied are outside bounds");if(Xr+_i>qr.length)throw new Error("target array is too small to hold result");for(let es=0;es<_i;es++)qr[Xr+es]+=Jr*Kr[Zr+es]}static powx(qr,Kr,Xr,Zr,_i,Jr){if(Zr<0||Zr>=Kr.length)throw new Error("sourceIndex out of bounds");if(Xr<0||Xr>=qr.length)throw new Error("targetIndex out of bounds");if(Zr+_i>Kr.length)throw new Error("source indices to be copied are outside bounds");if(Xr+_i>qr.length)throw new Error("target array is too small to hold result");for(let es=0;es<_i;es++)qr[Xr+es]=Math.pow(Kr[Zr+es],Jr)}static mul(qr,Kr,Xr,Zr,_i){if(Zr<0||Zr>=Kr.length)throw new Error("sourceIndex out of bounds");if(Xr<0||Xr>=qr.length)throw new Error("targetIndex out of bounds");if(Zr+_i>Kr.length)throw new Error("source indices to be copied are outside bounds");if(Xr+_i>qr.length)throw new Error("target array is too small to hold result");for(let Jr=0;Jr<_i;Jr++)qr[Xr+Jr]=Kr[Zr+Jr]*qr[Xr+Jr]}};class Ur{static splitShape(Kr,Xr,Zr,_i){if(Zr.length===0){if(!_i)throw new Error("need to know number of outputs when the 'split' attribute is not specified");Ur.determineSplit(Kr[Xr],_i,Zr)}const Jr=[],es=[0];for(let ts=0;ts<Zr.length;++ts){ts!==0&&es.push(es[ts-1]+Zr[ts-1]);const is=Kr.slice();is[Xr]=Zr[ts],Jr.push(is)}return[Jr,es]}static determineSplit(Kr,Xr,Zr){if(Kr%Xr!=0)throw new Error("cannot split tensor to equal sized parts");for(let _i=0;_i<Xr;++_i)Zr.push(Kr/Xr)}}Tr.SplitUtil=Ur;class Vr{static calcReduce(Kr,Xr,Zr,_i,Jr){const es=Kr.dims.slice(0);Xr.length===0&&es.forEach((Ts,$s)=>Xr.push($s));const ts=Vr.calcReduceShape(es,Xr,!0),is=Lr.size(ts),rs=new Fr.Tensor(ts,Kr.type),as=Lr.computeStrides(ts),ls=Lr.computeStrides(es),fs=new Array(es.length);for(let Ts=0;Ts<is;Ts++){const $s=Lr.offsetToIndices(Ts,as);jr.fillIndex($s,es,fs),rs.set($s,Vr.calcReduceByAxis(Kr.numberData,Xr,es,0,Lr.indicesToOffset(fs,ls),_i,Jr))}return Zr?rs:new Fr.Tensor(Vr.calcReduceShape(es,Xr,Zr),rs.type,void 0,void 0,rs.data,rs.dataId)}static calcReduceByAxis(Kr,Xr,Zr,_i,Jr,es,ts){let is=0;if(_i>=Xr.length)return es(Kr[Jr]);const rs=Xr[_i],as=rs>=Zr.length?1:Lr.size(Zr.slice(rs+1));for(let ls=0;ls<Zr[rs];ls++)is=ls===0?Vr.calcReduceByAxis(Kr,Xr,Zr,_i+1,Jr,es,ts):ts(is,Vr.calcReduceByAxis(Kr,Xr,Zr,_i+1,Jr,es,ts)),Jr+=as;return is}static calcReduceShape(Kr,Xr,Zr){const _i=Kr.slice();for(let Jr=0;Jr<Xr.length;Jr++)_i[Xr[Jr]]=Zr?1:0;return _i.filter(Jr=>Jr!==0)}}Tr.ReduceUtil=Vr;class Wr{static adjustPoolAttributes(Kr,Xr,Zr,_i,Jr,es){if(!Kr&&Zr.length!==Xr.length-2)throw new Error("length of specified kernel shapes should be 2 less than length of input dimensions");if(Kr)for(let ts=0;ts<Xr.length-2;ts++)ts>=Zr.length?Zr.push(Xr[ts+2]):Zr[ts]=Xr[ts+2];for(let ts=0;ts<Zr.length;ts++)if(ts<_i.length){if(_i[ts]<0)throw new Error("strides should be greater than or equal to 1")}else _i.push(1);for(let ts=0;ts<Zr.length;ts++)if(ts<Jr.length){if(Jr[ts]<0)throw new Error("dilations should be greater than or equal to 1")}else Jr.push(1);for(let ts=0;ts<2*Zr.length;ts++)if(ts<es.length){if(es[ts]<0)throw new Error("pad should be greater than or equal to 1")}else es.push(0);for(let ts=0;ts<Zr.length;ts++){if(Zr[ts]<=0)throw new Error("kernel shapes need to be greater than 0");if(es[ts]>=Zr[ts]||es[ts+Zr.length]>=Zr[ts])throw new Error("pads should be smaller than kernel")}}static adjustPadsBasedOnAutoPad(Kr,Xr,Zr,_i,Jr,es){if(es){if(Jr.length!==2*(Kr.length-2))throw new Error("length of pads should be twice the length of data dimensions");if(Xr.length!==Kr.length-2)throw new Error("length of strides should be the length of data dimensions");if(_i.length!==Kr.length-2)throw new Error("length of kernel shapes should be the length of data dimensions");for(let ts=0;ts<Kr.length-2;ts++)Wr.adjustPadAndReturnShape(Kr[ts+2],Xr[ts],Zr[ts],_i[ts],Jr,ts,ts+Kr.length-2,es)}}static computePoolOutputShape(Kr,Xr,Zr,_i,Jr,es,ts){if(Xr.length<=0)throw new Error("input shape must be of size greater than 0");const is=[Xr[0],Xr[1]];return Wr.computeShapeHelper(Kr,Xr,is,Zr,_i,Jr,es,ts),is}static computeConvOutputShape(Kr,Xr,Zr,_i,Jr,es,ts){if(Kr.length<=0||Xr.length<=0)throw new Error("invalid input tensor dims or invalid filter tensor dims");const is=[Kr[0],Xr[0]];return Wr.computeShapeHelper(!1,Kr,is,Zr,_i,Jr,es,ts),is}static computeShapeHelper(Kr,Xr,Zr,_i,Jr,es,ts,is){if(Kr)for(let rs=0;rs<Xr.length-2;rs++)Zr.push(1);else for(let rs=0;rs<Xr.length-2;rs++)Zr.push(Wr.adjustPadAndReturnShape(Xr[rs+2],_i[rs],Jr[rs],es[rs],ts,rs,rs+Xr.length-2,is))}static adjustPadAndReturnShape(Kr,Xr,Zr,_i,Jr,es,ts,is){const rs=Zr*(_i-1)+1;if(!is||is==="NOTSET")return Math.floor((Kr+Jr[es]+Jr[ts]-rs)/Xr+1);switch(is){case"VALID":return Jr[es]=0,Jr[ts]=0,Math.floor((Kr-rs)/Xr+1);case"SAME_LOWER":case"SAME_UPPER":if(Zr!==1)throw new Error("Dilation not supported for SAME_UPPER or SAME_LOWER");{const as=((Kr+Xr-1)/Xr-1)*Xr+_i-Kr;return Jr[es]=Math.floor(is==="SAME_LOWER"?(as+1)/2:as/2),Jr[ts]=as-Jr[es],Math.floor((Kr+as-_i)/Xr+1)}default:throw new Error("Unsupported AutoPad type")}}}Tr.PoolConvUtil=Wr,Tr.MIN_CLIP=-34028234663852886e22,Tr.MAX_CLIP=34028234663852886e22,Tr.decodeUtf8String=function(qr){return new TextDecoder().decode(qr)}},3838:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.WebGpuBackend=void 0;const Rr=Ar(8453),Pr=Ar(4955),Dr=Ar(7771),Mr=Ar(8510),Fr=Ar(8305);Tr.WebGpuBackend=class{constructor(){this.currentKernelId=null,this.commandEncoder=null,this.computePassEncoder=null,this.pendingDispatchNumber=0,this.profilingEnabled=!1}get currentKernelCustomData(){if(this.currentKernelId===null)throw new Error("currentKernelCustomData(): currentKernelId is null. (should not happen)");let zr=this.kernelCustomData.get(this.currentKernelId);return zr||(zr={},this.kernelCustomData.set(this.currentKernelId,zr)),zr}async initialize(){if(!navigator.gpu)throw new Error("WebGpuBackend: WebGPU is not available.");const zr=await navigator.gpu.requestAdapter();if(!zr)throw new Error("WebGpuBackend: Failed to get GPU adapter.");const jr={requiredLimits:{maxComputeWorkgroupStorageSize:zr.limits.maxComputeWorkgroupStorageSize,maxComputeWorkgroupsPerDimension:zr.limits.maxComputeWorkgroupsPerDimension,maxStorageBufferBindingSize:zr.limits.maxStorageBufferBindingSize}};zr.features.has("timestamp-query-inside-passes")&&Rr.env.webgpu.profilingMode==="default"&&(this.profilingEnabled=!0,jr.requiredFeatures=["timestamp-query-inside-passes"]),this.device=await zr.requestDevice(jr),this.gpuDataManager=(0,Dr.createGpuDataManager)(this),this.programManager=new Fr.ProgramManager(this),this.kernels=new Map,this.kernelPersistentData=new Map,this.kernelCustomData=new Map,this.device.onuncapturederror=Gr=>{Gr.error instanceof GPUValidationError&&console.error(`An uncaught WebGPU validation error was raised: ${Gr.error.message}`)},this.profilingEnabled&&(this.profilingQuerySet=this.device.createQuerySet({type:"timestamp",count:2}))}dispose(){}getCommandEncoder(){return this.commandEncoder||(this.commandEncoder=this.device.createCommandEncoder()),this.commandEncoder}getComputePassEncoder(){return this.computePassEncoder||(this.computePassEncoder=this.getCommandEncoder().beginComputePass()),this.computePassEncoder}endComputePass(){this.computePassEncoder&&(this.computePassEncoder.end(),this.computePassEncoder=null)}flush(){this.endComputePass(),this.device.queue.submit([this.getCommandEncoder().finish()]),this.gpuDataManager.refreshPendingBuffers(),this.commandEncoder=null,this.pendingDispatchNumber=0}run(zr,jr,Gr,Nr,Lr){if(jr.length!==zr.inputTypes.length)throw new Error(`Input size must be equal to ${zr.inputTypes.length}.`);const Ur=[];for(let Jr=0;Jr<jr.length;++Jr){const es=this.gpuDataManager.get(jr[Jr].data);if(!es)throw new Error(`no GPU data for input: ${jr[Jr].data}`);Ur[Jr]=es}const Vr=((Jr,es,ts)=>{const is=es.map(ls=>`${ls.join(",")}`).join("_"),rs=ts.join("_");let as=Jr.name;return Jr.cacheHint&&(as+="["+Jr.cacheHint+"]"),as+=":"+is+";"+rs,as})(zr,jr.map(Jr=>Jr.dims),Ur.map(Jr=>Jr.type));let Wr=this.programManager.getArtifact(Vr);const qr=Wr?Wr.programInfo:typeof zr.get=="function"?zr.get():zr,Kr=Gr.length===0?qr.outputs.map((Jr,es)=>es):Gr;if(Kr.length!==qr.outputs.length)throw new Error(`Output size ${Kr.length} must be equal to ${qr.outputs.length}.`);const Xr=[],Zr=[];for(let Jr=0;Jr<qr.outputs.length;++Jr){if(!Number.isInteger(Kr[Jr])||Kr[Jr]<-2||Kr[Jr]>=qr.outputs.length)throw new Error(`Invalid output index: ${Kr[Jr]}`);const es=Kr[Jr]===-1,ts=Kr[Jr]===-2,is=es||ts?Lr(qr.outputs[Jr].dataType,qr.outputs[Jr].dims):Nr(Kr[Jr],qr.outputs[Jr].dataType,qr.outputs[Jr].dims),rs=this.gpuDataManager.get(is.data);if(!rs)throw new Error(`no GPU data for output: ${is.data}`);if(es&&this.temporaryData.push(rs),ts){let as=this.kernelPersistentData.get(this.currentKernelId);as||(as=[],this.kernelPersistentData.set(this.currentKernelId,as)),as.push(rs)}Xr.push(is),Zr.push(rs)}const _i=this.programManager.normalizeDispatchGroupSize(qr.dispatchGroup(jr));return Wr||(Wr=this.programManager.build(qr,_i),this.programManager.setArtifact(Vr,Wr)),(0,Pr.LOG_DEBUG)("info",()=>`[ProgramManager] run "${qr.name}" (key=${Vr}) with ${_i[0]}x${_i[1]}x${_i[2]}`),this.programManager.run(Wr,Ur,Zr,_i),Xr}upload(zr,jr){this.gpuDataManager.upload(zr,jr)}memcpy(zr,jr){this.gpuDataManager.memcpy(zr,jr)}async download(zr,jr){const Gr=await this.gpuDataManager.download(zr);jr().set(new Uint8Array(Gr))}alloc(zr){return this.gpuDataManager.create(zr).id}free(zr){return this.gpuDataManager.release(zr)}createKernel(zr,jr,Gr){const Nr=Mr.WEBGPU_OP_RESOLVE_RULES.get(zr);if(!Nr)throw new Error(`kernel not implemented: ${zr}`);this.kernels.set(jr,[zr,Nr[0],[Nr[1],Gr]])}releaseKernel(zr){const jr=this.kernelPersistentData.get(zr);if(jr){for(const Gr of jr)this.gpuDataManager.release(Gr.id);this.kernelPersistentData.delete(zr)}this.kernelCustomData.delete(zr),this.kernels.delete(zr)}computeKernel(zr,jr){const Gr=this.kernels.get(zr);if(!Gr)throw new Error(`kernel not created: ${zr}`);const[Nr,Lr,Ur]=Gr;if(this.currentKernelId!==null)throw new Error(`kernel "${Nr}" is not allowed to be called recursively`);this.currentKernelId=zr,Ur[0]&&(Ur[1]=Ur[0](Ur[1]),Ur[0]=void 0),(0,Pr.LOG_DEBUG)("info",()=>`[WebGPU] Start to run kernel "${Nr}"...`),this.temporaryData=[];try{return Lr(jr,Ur[1]),0}catch(Vr){return(0,Pr.LOG_DEBUG)("warning",`[WebGPU] Kernel "${Nr}" failed. Error: ${Vr}`),1}finally{for(const Vr of this.temporaryData)this.gpuDataManager.release(Vr.id);this.temporaryData=[],this.currentKernelId=null}}}},7675:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.init=void 0;const Rr=Ar(7917),Pr=Ar(3838),Dr=Ar(4955),Mr=Ar(6952);class Fr{constructor(Gr,Nr,Lr,Ur){this.module=Gr,this.dataType=Nr,this.data=Lr,this.dims=Ur}getFloat32Array(){return new Float32Array(this.module.HEAP8.buffer,this.data,Mr.ShapeUtil.size(this.dims))}reshape(Gr){if(Mr.ShapeUtil.size(Gr)!==Mr.ShapeUtil.size(this.dims))throw new Error("Invalid new shape");return new Fr(this.module,this.dataType,this.data,Gr)}}class zr{get customData(){return this.backend.currentKernelCustomData}constructor(Gr,Nr,Lr){this.module=Gr,this.backend=Nr;const Ur=Gr.HEAPU32;let Vr=Lr>>2;this.opKernelContext=Ur[Vr++];const Wr=Ur[Vr++],qr=[];for(let Kr=0;Kr<Wr;Kr++){const Xr=Ur[Vr++],Zr=Ur[Vr++],_i=Ur[Vr++],Jr=[];for(let es=0;es<_i;es++)Jr.push(Ur[Vr++]);qr.push(new Fr(Gr,Xr,Zr,Jr))}this.inputs=qr}compute(Gr,Nr){var Lr,Ur,Vr;const Wr=(Ur=(Lr=Nr==null?void 0:Nr.inputs)===null||Lr===void 0?void 0:Lr.map(Kr=>typeof Kr=="number"?this.inputs[Kr]:Kr))!==null&&Ur!==void 0?Ur:this.inputs,qr=(Vr=Nr==null?void 0:Nr.outputs)!==null&&Vr!==void 0?Vr:[];return this.backend.run(Gr,Wr,qr,(Kr,Xr,Zr)=>new Fr(this.module,Xr,this.output(Kr,Zr),Zr),(Kr,Xr)=>{const Zr=(0,Rr.getTensorElementSize)(Kr);if(!Zr)throw new Error(`Unsupported data type: ${Kr}`);const _i=Zr*Mr.ShapeUtil.size(Xr);return new Fr(this.module,Kr,this.backend.gpuDataManager.create(_i).id,Xr)})}output(Gr,Nr){const Lr=this.module.stackSave();try{const Ur=this.module.stackAlloc(4*(1+Nr.length));let Vr=Ur>>2;this.module.HEAPU32[Vr++]=Nr.length;for(let Wr=0;Wr<Nr.length;Wr++)this.module.HEAPU32[Vr++]=Nr[Wr];return this.module._JsepOutput(this.opKernelContext,Gr,Ur)}finally{this.module.stackRestore(Lr)}}}Tr.init=async jr=>{const Gr=jr.jsepInit;if(Gr&&navigator.gpu){const Nr=new Pr.WebGpuBackend;await Nr.initialize(),Gr({backend:Nr},Lr=>Nr.alloc(Lr),Lr=>Nr.free(Lr),(Lr,Ur,Vr,Wr=!1)=>{if(Wr)(0,Dr.LOG_DEBUG)("verbose",()=>`[WebGPU] jsepCopyGpuToGpu: src=${Lr}, dst=${Ur}, size=${Vr}`),Nr.memcpy(Lr,Ur);else{(0,Dr.LOG_DEBUG)("verbose",()=>`[WebGPU] jsepCopyCpuToGpu: dataOffset=${Lr}, gpuDataId=${Ur}, size=${Vr}`);const qr=jr.HEAPU8.subarray(Lr,Lr+Vr);Nr.upload(Ur,qr)}},async(Lr,Ur,Vr)=>{(0,Dr.LOG_DEBUG)("verbose",()=>`[WebGPU] jsepCopyGpuToCpu: gpuDataId=${Lr}, dataOffset=${Ur}, size=${Vr}`),await Nr.download(Lr,()=>jr.HEAPU8.subarray(Ur,Ur+Vr))},(Lr,Ur,Vr)=>Nr.createKernel(Lr,Ur,Vr),Lr=>Nr.releaseKernel(Lr),(Lr,Ur)=>{(0,Dr.LOG_DEBUG)("verbose",()=>`[WebGPU] jsepRun: kernel=${Lr}, contextDataOffset=${Ur}`);const Vr=new zr(jr,Nr,Ur);return Nr.computeKernel(Lr,Vr)})}}},4955:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.LOG_DEBUG=Tr.LOG=void 0;const Rr=Ar(8453),Pr=Ar(7917),Dr=["V","I","W","E","F"];Tr.LOG=(Mr,Fr)=>{const zr=(0,Pr.logLevelStringToEnum)(Mr);var jr,Gr;zr>=(0,Pr.logLevelStringToEnum)(Rr.env.logLevel)&&(jr=zr,Gr=typeof Fr=="function"?Fr():Fr,console.log(`[${Dr[jr]},${new Date().toISOString()}]${Gr}`))},Tr.LOG_DEBUG=(...Mr)=>{Rr.env.debug&&(0,Tr.LOG)(...Mr)}},6952:(_r,Tr)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.MAX_CLIP=Tr.MIN_CLIP=Tr.GemmUtil=Tr.PoolConvUtil=Tr.ShapeUtil=Tr.BroadcastUtil=Tr.MatMulUtil=void 0;class Ar{static calcMatMulShape(Fr,zr){return Fr[1]!==zr[0]?void 0:[Fr[0],zr[1]]}}Tr.MatMulUtil=Ar;class Rr{static calcShape(Fr,zr,jr=!1){const Gr=Fr.length,Nr=zr.length;if(Gr===0)return zr;if(Nr===0)return Fr;const Lr=Math.max(Fr.length,zr.length),Ur=new Array(Lr);if(jr){if(Gr<2||Nr<2)return;const Vr=Ar.calcMatMulShape([Fr[Gr-2],Fr[Gr-1]],[zr[Nr-2],zr[Nr-1]]);if(Vr===void 0)return;[Ur[Lr-2],Ur[Lr-1]]=Vr}for(let Vr=jr?3:1;Vr<=Lr;Vr++){const Wr=Gr-Vr<0?1:Fr[Gr-Vr],qr=Nr-Vr<0?1:zr[Nr-Vr];if(Wr!==qr&&Wr>1&&qr>1)return;Ur[Lr-Vr]=Math.max(Wr,qr)}return Ur}static isValidBroadcast(Fr,zr){const jr=Fr.length,Gr=zr.length;if(jr>Gr)return!1;for(let Nr=1;Nr<=jr;Nr++)if(Fr[jr-Nr]!==1&&Fr[jr-Nr]!==zr[Gr-Nr])return!1;return!0}}Tr.BroadcastUtil=Rr;class Pr{static size(Fr){return Pr.getSizeFromDimensionRange(Fr,0,Fr.length)}static sizeFromDimension(Fr,zr){if(zr<0||zr>Fr.length)throw new Error(`invalid dimension of ${zr} for sizeFromDimension as Tensor has ${Fr.length} dimensions.`);return Pr.getSizeFromDimensionRange(Fr,zr,Fr.length)}static sizeToDimension(Fr,zr){if(zr<0||zr>Fr.length)throw new Error(`invalid dimension of ${zr} for sizeToDimension as Tensor has ${Fr.length} dimensions.`);return Pr.getSizeFromDimensionRange(Fr,0,zr)}static getSizeFromDimensionRange(Fr,zr,jr){let Gr=1;for(let Nr=zr;Nr<jr;Nr++){if(Fr[Nr]<=0)throw new Error("cannot get valid size from specified dimension range. Most likely the range contains 0 or negative values in them.");Gr*=Fr[Nr]}return Gr}static computeStrides(Fr){const zr=Fr.length;if(zr===0)return[];if(zr===1)return[1];const jr=new Array(zr);jr[zr-1]=1,jr[zr-2]=Fr[zr-1];for(let Gr=zr-3;Gr>=0;--Gr)jr[Gr]=jr[Gr+1]*Fr[Gr+1];return jr}static normalizeAxis(Fr,zr){if(Fr<-zr&&Fr>=zr)throw new Error("unsupported axis for this operation.");return Fr<0?Fr+zr:Fr}static normalizeAxes(Fr,zr){return Fr.map(jr=>this.normalizeAxis(jr,zr??Fr.length))}static sortBasedOnPerm(Fr,zr){return zr?zr.map(jr=>Fr[jr]):Fr.slice().reverse()}static padShape(Fr,zr){const jr=Fr.length;return Fr.map((Gr,Nr)=>Gr+zr[Nr]+zr[Nr+jr])}static areEqual(Fr,zr){return Fr.length===zr.length&&Fr.every((jr,Gr)=>jr===zr[Gr])}}Tr.ShapeUtil=Pr;class Dr{static adjustPoolAttributes(Fr,zr,jr,Gr,Nr,Lr){if(!Fr&&jr.length!==zr.length-2)throw new Error("length of specified kernel shapes should be 2 less than length of input dimensions");if(Fr)for(let Ur=0;Ur<zr.length-2;Ur++)Ur>=jr.length?jr.push(zr[Ur+2]):jr[Ur]=zr[Ur+2];for(let Ur=0;Ur<jr.length;Ur++)if(Ur<Gr.length){if(Gr[Ur]<0)throw new Error("strides should be greater than or equal to 1")}else Gr.push(1);for(let Ur=0;Ur<jr.length;Ur++)if(Ur<Nr.length){if(Nr[Ur]<0)throw new Error("dilations should be greater than or equal to 1")}else Nr.push(1);for(let Ur=0;Ur<2*jr.length;Ur++)if(Ur<Lr.length){if(Lr[Ur]<0)throw new Error("pad should be greater than or equal to 1")}else Lr.push(0);for(let Ur=0;Ur<jr.length;Ur++){if(jr[Ur]<=0)throw new Error("kernel shapes need to be greater than 0");if(Lr[Ur]>=jr[Ur]||Lr[Ur+jr.length]>=jr[Ur])throw new Error("pads should be smaller than kernel")}}static adjustPadsBasedOnAutoPad(Fr,zr,jr,Gr,Nr,Lr,Ur){if(Ur){if(Nr.length!==2*(Fr.length-2))throw new Error("length of pads should be twice the length of data dimensions");if(zr.length!==Fr.length-2)throw new Error("length of strides should be the length of data dimensions");if(Gr.length!==Fr.length-2)throw new Error("length of kernel shapes should be the length of data dimensions");for(let Vr=0;Vr<Fr.length-2;Vr++)Dr.adjustPadAndReturnShape(Fr[Vr+(Lr?1:2)],zr[Vr],jr[Vr],Gr[Vr],Nr,Vr,Vr+Fr.length-2,Ur)}}static computePoolOutputShape(Fr,zr,jr,Gr,Nr,Lr,Ur){if(zr.length<=0)throw new Error("input shape must be of size greater than 0");const Vr=[zr[0],zr[1]];return Dr.computeShapeHelper(Fr,zr,Vr,jr,Gr,Nr,Lr,Ur),Vr}static computeConvOutputShape(Fr,zr,jr,Gr,Nr,Lr,Ur){if(Fr.length<=0||zr.length<=0)throw new Error("invalid input tensor dims or invalid filter tensor dims");const Vr=[Fr[0],zr[0]];return Dr.computeShapeHelper(!1,Fr,Vr,jr,Gr,Nr,Lr,Ur),Vr}static computeShapeHelper(Fr,zr,jr,Gr,Nr,Lr,Ur,Vr){if(Fr)for(let Wr=0;Wr<zr.length-2;Wr++)jr.push(1);else for(let Wr=0;Wr<zr.length-2;Wr++)jr.push(Dr.adjustPadAndReturnShape(zr[Wr+2],Gr[Wr],Nr[Wr],Lr[Wr],Ur,Wr,Wr+zr.length-2,Vr))}static adjustPadAndReturnShape(Fr,zr,jr,Gr,Nr,Lr,Ur,Vr){const Wr=jr*(Gr-1)+1;if(!Vr||Vr==="NOTSET")return Math.floor((Fr+Nr[Lr]+Nr[Ur]-Wr)/zr+1);switch(Vr){case"VALID":return Nr[Lr]=0,Nr[Ur]=0,Math.floor((Fr-Wr)/zr+1);case"SAME_LOWER":case"SAME_UPPER":if(jr!==1)throw new Error("Dilation not supported for SAME_UPPER or SAME_LOWER");{const qr=((Fr+zr-1)/zr-1)*zr+Gr-Fr;return Nr[Lr]=Math.floor(Vr==="SAME_LOWER"?(qr+1)/2:qr/2),Nr[Ur]=qr-Nr[Lr],Math.floor((Fr+qr-Gr)/zr+1)}default:throw new Error("Unsupported AutoPad type")}}}Tr.PoolConvUtil=Dr,Tr.GemmUtil=class{static getShapeOfGemmResult(Mr,Fr,zr,jr,Gr){if(Mr.length!==2||zr.length!==2)throw new Error("shape need to be of size 2");let Nr,Lr,Ur;Fr?(Nr=Mr[1],Lr=Mr[0]):(Nr=Mr[0],Lr=Mr[1]);let Vr=-1;if(jr?(Ur=zr[0],Vr=1):(Ur=zr[1],Vr=0),zr[Vr]!==Lr)throw new Error("dimension mismatch");if(Nr<=0||Ur<=0||Lr<=0)throw new Error("invalid shape specified");if(Gr&&!Rr.isValidBroadcast(Gr,[Nr,Ur]))throw new Error("gemm: invalid bias shape for broadcast");return[Nr,Ur,Lr]}},Tr.MIN_CLIP=-34028234663852886e22,Tr.MAX_CLIP=34028234663852886e22},387:(_r,Tr)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.createAttributeWithCacheKey=void 0;class Ar{constructor(Pr){Object.assign(this,Pr)}get cacheKey(){return this._cacheKey||(this._cacheKey=Object.getOwnPropertyNames(this).sort().map(Pr=>`${this[Pr]}`).join(";")),this._cacheKey}}Tr.createAttributeWithCacheKey=Rr=>new Ar(Rr)},7771:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.createGpuDataManager=void 0;const Rr=Ar(4955),Pr=Ar(1163),Dr=zr=>16*Math.ceil(zr/16);let Mr=0;class Fr{constructor(jr){this.backend=jr,this.storageCache=new Map,this.downloadCache=new Map,this.buffersForUploadingPending=[],this.buffersPending=[]}upload(jr,Gr){const Nr=Gr.buffer,Lr=Gr.byteOffset,Ur=Gr.byteLength,Vr=Dr(Ur),Wr=this.storageCache.get(jr);if(!Wr)throw new Error("gpu data for uploading does not exist");if(Wr.originalSize!==Ur)throw new Error(`inconsistent data size. gpu data size=${Wr.originalSize}, data size=${Ur}`);const qr=this.backend.device.createBuffer({mappedAtCreation:!0,size:Vr,usage:GPUBufferUsage.MAP_WRITE|GPUBufferUsage.COPY_SRC}),Kr=qr.getMappedRange();new Uint8Array(Kr).set(new Uint8Array(Nr,Lr,Ur)),qr.unmap();const Xr=this.backend.getCommandEncoder();this.backend.endComputePass(),Xr.copyBufferToBuffer(qr,0,Wr.gpuData.buffer,0,Vr),(0,Rr.LOG_DEBUG)("verbose",()=>`[WebGPU] GpuDataManager.upload(id=${jr})`),this.buffersForUploadingPending.push(qr)}memcpy(jr,Gr){const Nr=this.storageCache.get(jr);if(!Nr)throw new Error("source gpu data for memcpy does not exist");const Lr=this.storageCache.get(Gr);if(!Lr)throw new Error("destination gpu data for memcpy does not exist");if(Nr.originalSize!==Lr.originalSize)throw new Error("inconsistent source and destination gpu data size");const Ur=Dr(Nr.originalSize);this.backend.getCommandEncoder().copyBufferToBuffer(Nr.gpuData.buffer,0,Lr.gpuData.buffer,0,Ur)}create(jr,Gr=GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST){const Nr=Dr(jr),Lr=this.backend.device.createBuffer({size:Nr,usage:Gr}),Ur={id:Mr++,type:Pr.GpuDataType.default,buffer:Lr};return this.storageCache.set(Ur.id,{gpuData:Ur,originalSize:jr}),(0,Rr.LOG_DEBUG)("verbose",()=>`[WebGPU] GpuDataManager.create(size=${jr}) => id=${Ur.id}`),Ur}get(jr){var Gr;return(Gr=this.storageCache.get(jr))===null||Gr===void 0?void 0:Gr.gpuData}release(jr){const Gr=this.storageCache.get(jr);if(!Gr)throw new Error("releasing data does not exist");return(0,Rr.LOG_DEBUG)("verbose",()=>`[WebGPU] GpuDataManager.release(id=${jr}), gpuDataId=${Gr.gpuData.id}`),this.storageCache.delete(jr),this.buffersPending.push(Gr.gpuData.buffer),this.downloadCache.get(jr)&&this.downloadCache.delete(jr),Gr.originalSize}async download(jr){const Gr=this.downloadCache.get(jr);if(Gr)return Gr.data;const Nr=this.storageCache.get(jr);if(!Nr)throw new Error("data does not exist");const Lr=this.backend.getCommandEncoder();this.backend.endComputePass();const Ur=this.backend.device.createBuffer({size:Nr.originalSize,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ});Lr.copyBufferToBuffer(Nr.gpuData.buffer,0,Ur,0,Nr.originalSize),this.backend.flush();const Vr=new Promise(Wr=>{Ur.mapAsync(GPUMapMode.READ).then(()=>{const qr=Ur.getMappedRange().slice(0);Ur.destroy(),Wr(qr)})});return this.downloadCache.set(jr,{data:Vr}),Vr}refreshPendingBuffers(){for(const jr of this.buffersForUploadingPending)jr.destroy();for(const jr of this.buffersPending)jr.destroy()}}Tr.createGpuDataManager=(...zr)=>new Fr(...zr)},8510:function(_r,Tr,Ar){var Rr=this&&this.__createBinding||(Object.create?function(Ur,Vr,Wr,qr){qr===void 0&&(qr=Wr);var Kr=Object.getOwnPropertyDescriptor(Vr,Wr);Kr&&!("get"in Kr?!Vr.__esModule:Kr.writable||Kr.configurable)||(Kr={enumerable:!0,get:function(){return Vr[Wr]}}),Object.defineProperty(Ur,qr,Kr)}:function(Ur,Vr,Wr,qr){qr===void 0&&(qr=Wr),Ur[qr]=Vr[Wr]}),Pr=this&&this.__setModuleDefault||(Object.create?function(Ur,Vr){Object.defineProperty(Ur,"default",{enumerable:!0,value:Vr})}:function(Ur,Vr){Ur.default=Vr}),Dr=this&&this.__importStar||function(Ur){if(Ur&&Ur.__esModule)return Ur;var Vr={};if(Ur!=null)for(var Wr in Ur)Wr!=="default"&&Object.prototype.hasOwnProperty.call(Ur,Wr)&&Rr(Vr,Ur,Wr);return Pr(Vr,Ur),Vr};Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.WEBGPU_OP_RESOLVE_RULES=void 0;const Mr=Dr(Ar(504)),Fr=Ar(9770),zr=Ar(4271),jr=Ar(1522),Gr=Dr(Ar(5262)),Nr=Ar(2625),Lr=Dr(Ar(9302));Tr.WEBGPU_OP_RESOLVE_RULES=new Map([["Abs",[Lr.abs]],["Acos",[Lr.acos]],["Acosh",[Lr.acosh]],["Add",[Mr.add]],["Asin",[Lr.asin]],["Asinh",[Lr.asinh]],["Atan",[Lr.atan]],["Atanh",[Lr.atanh]],["AveragePool",[Gr.averagePool,Gr.parseAveragePoolAttributes]],["Ceil",[Lr.ceil]],["ClipV10",[Lr.clipV10]],["Clip",[Lr.clip]],["Conv",[Fr.conv,Fr.parseConvAttributes]],["Cos",[Lr.cos]],["Cosh",[Lr.cosh]],["Div",[Mr.div]],["Elu",[Lr.elu,Lr.parseAlphaAttributes]],["Erf",[Lr.erf]],["Exp",[Lr.exp]],["Floor",[Lr.floor]],["Gemm",[zr.gemm,zr.parseGemmAttributes]],["GlobalAveragePool",[Gr.globalAveragePool,Gr.parseGlobalAveragePoolAttributes]],["GlobalMaxPool",[Gr.globalMaxPool,Gr.parseGlobalMaxPoolAttributes]],["LeakyRelu",[Lr.leakyRelu,Lr.parseAlphaAttributes]],["MatMul",[jr.matMul]],["MaxPool",[Gr.maxPool,Gr.parseMaxPoolAttributes]],["Mul",[Mr.mul]],["Neg",[Lr.neg]],["Pow",[Mr.pow]],["Reciprocal",[Lr.reciprocal]],["Relu",[Lr.relu]],["Sigmoid",[Lr.sigmoid]],["Sin",[Lr.sin]],["Sinh",[Lr.sinh]],["Sqrt",[Lr.sqrt]],["Sub",[Mr.sub]],["Tan",[Lr.tan]],["Tanh",[Lr.tanh]],["ThresholdedRelu",[Lr.thresholdedRelu,Lr.parseAlphaAttributes]],["Transpose",[Nr.transpose,Nr.parseTransposeAttributes]]])},1427:(_r,Tr)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.biasActivationSnippet=Tr.activationFnSnippet=Tr.typeSnippet=void 0,Tr.typeSnippet=Ar=>{switch(Ar){case 1:return"f32";case 2:return"vec2<f32>";case 3:return"vec3<f32>";case 4:return"vec4<f32>";default:throw new Error(`${Ar}-component is not supported.`)}},Tr.activationFnSnippet=(Ar,Rr=!1,Pr=!1,Dr=3)=>"",Tr.biasActivationSnippet=(Ar,Rr)=>`
      ${Ar?"value = value + getBiasByOutputCoords(coords);":""}
      ${Rr?"value = activation(value, coords);":""}
      `},9456:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.createConv2DMatMulProgramInfo=void 0;const Rr=Ar(4955),Pr=Ar(6952),Dr=Ar(1163),Mr=Ar(1427),Fr=Ar(4085),zr=Ar(158);Tr.createConv2DMatMulProgramInfo=(jr,Gr,Nr,Lr,Ur,Vr,Wr,qr,Kr)=>{const Xr=Nr.format==="NHWC",Zr=Xr?jr[0].dims[3]:jr[0].dims[1],_i=Lr[0],Jr=Xr?Lr[2]:Lr[3],es=Xr?Lr[1]:Lr[2],ts=Xr?Lr[3]:Lr[1],is=((Zr%4==0||Zr%3==0)&&Xr||Jr%4==0&&!Xr)&&ts%4==0,rs=Xr?ts:Jr*es,as=Xr?Jr*es:ts,ls=is?[8,8,1]:[rs<=4?4:16,rs>4&&as<=4?4:16,1],fs=is?[4,4,1]:[rs<=4?1:2,rs>4&&as<=4?1:2,1],Ts=[Math.ceil(rs/ls[0]/fs[0]),Math.ceil(as/ls[1]/fs[1]),Math.ceil(_i/ls[2]/fs[1])];(0,Rr.LOG_DEBUG)("verbose",()=>`[conv2d_mm_webgpu] dispatch = ${Ts}`);const $s=is?Xr&&Zr%4!=0?3:4:fs[0],xs=ls[1]*fs[1],ys=ls[0]*fs[0],ps=Math.max(ls[0]*$s,ls[1]),vs=Ur%xs==0,Ds=Vr%ys==0,js=Wr%ps==0,zs=is?[$s,4,4]:[1,1,1],qs=[`@group(0) @binding(0) var<storage, read> x: array<${is&&$s===4?"vec4<f32>":"f32"}>;`,`@group(0) @binding(1) var<storage, read> w: array<${is?"vec4<f32>":"f32"}>;`];let fo=`
      fn setOutputAtIndex(flatIndex : i32, value : ${is?"vec4<f32>":"f32"}) {
        result[flatIndex] = ${is?"vec4<f32>":"f32"}(value);
      }
      fn setOutputAtCoords(d0 : i32, d1 : i32, d2 : i32, d3 : i32, value : ${is?"vec4<f32>":"f32"}) {
        let flatIndex = getOutputIndexFromCoords(vec4<i32>(d0, d1, d2, d3));
        setOutputAtIndex(flatIndex ${is?"/ 4":""}, value);
      }`;return qr&&(qs.push(`@group(0) @binding(2) var<storage, read> bias: array<${is?"vec4<f32>":"f32"}>;`),fo+=`
        fn getBiasByOutputCoords(coords : vec4<i32>) -> ${is?"vec4<f32>":"f32"} {
          return bias[coords.${Xr?"w":"y"}${is?"/ 4":""}];
        }`),Object.assign(Object.assign({},Gr),{outputs:[{dims:Lr,dataType:jr[0].dataType,gpuDataType:Dr.GpuDataType.default}],dispatchGroup:()=>({x:Ts[0],y:Ts[1],z:Ts[2]}),getShaderSource:()=>`
        ${Fr.utilFunctions}
        //struct Uniforms { xShape : vec4<i32>, wShape : vec4<i32>, outShape : vec4<i32>,
        //  outShapeStrides: vec3<i32>, filterDims : vec2<i32>, pad : vec2<i32>, stride : vec2<i32>,
        //  dilation : vec2<i32>, dimAOuter : i32, dimBOuter : i32, dimInner : i32 };
        ${qs.join("")}
        @group(0) @binding(${qs.length}) var<storage, read_write> result: array<${is?"vec4<f32>":"f32"}>;
        //@group(0) @binding(${qs.length+1}) var<uniform> uniforms: Uniforms;

        const xShape : vec4<i32> = vec4<i32>(${jr[0].dims.join(",")});
        const wShape : vec4<i32> = vec4<i32>(${jr[1].dims.join(",")});
        const outShape : vec4<i32> = vec4<i32>(${Lr.join(",")});
        const outShapeStrides : vec3<i32> = vec3<i32>(${Pr.ShapeUtil.computeStrides(Lr).slice(0,3).join(",")});
        const filterDims : vec2<i32> = vec2<i32>(${Nr.kernelShape[0]}, ${Nr.kernelShape[1]});
        const pad : vec2<i32> = vec2<i32>(${Nr.pads[0]}, ${Nr.pads[1]});
        const stride : vec2<i32> = vec2<i32>(${Nr.strides[0]}, ${Nr.strides[1]});
        const dilation : vec2<i32> = vec2<i32>(${Nr.dilations[0]}, ${Nr.dilations[1]});
        const dimAOuter : i32 = ${Ur};
        const dimBOuter : i32 = ${Vr};
        const dimInner : i32 = ${Wr};
        ${fo}
        ${((Qs,no,yo,Js,lo=!1,vo,Ro=!1,Co=4,Do=4,ds=4)=>{const Os=Qs?`
    let coord = vec4<i32>(batch, xRow, xCol, xCh);
    `:`
    let coord = vec4<i32>(batch, xCh, xRow, xCol);
    `,Ws=Qs?`
    let coords = vec4<i32>(
      batch,
      row / outWidth,
      row % outWidth,
      col);
    `:`
    let coords = vec4<i32>(
      batch,
      row,
      col / outWidth,
      col % outWidth);
    `,to=Qs?"xShape[1]":"xShape[2]",io=Qs?"xShape[2]":"xShape[3]",ko=Qs?"row":"col",go=Qs?"col":"row",To=`
    let inChannels = wShape[2];
    let outWidth = ${Qs?"outShape[2]":"outShape[3]"};
    let outRow = ${ko} / outWidth;
    let outCol = ${ko} % outWidth;

    let WRow = ${go} / (filterDims[1] * inChannels);
    let WCol = ${go} / inChannels % filterDims[1];
    let xRow = outRow * stride[0] + dilation[0] * WRow - pad[0];
    let xCol = outCol * stride[1] + dilation[1] * WCol - pad[1];
    let xCh = ${go} % inChannels;
    var resData = ${(0,Mr.typeSnippet)(Co)}(0.0);
    // The bounds checking is always needed since we use it to pad zero for
    // the 'same' padding type.
    if (xRow >= 0 && xRow < ${to} && xCol >= 0 && xCol < ${io}) {
      ${Os}
      let xIndex = getIndexFromCoords4D(coord, xShape);
      ${(El=>{switch(El){case 1:return"resData = x[xIndex];";case 3:return"resData = vec3<f32>(x[xIndex], x[xIndex + 1], x[xIndex + 2]);";case 4:return"resData = x[xIndex / 4];";default:throw new Error(`innerElementSize ${El} is not supported.`)}})(Co)}
    }
    return resData;`,Ho=Qs?no&&Js?`
    let col = colIn * ${Co};
    ${To}`:`
    let col = colIn * ${Co};
    if (row < dimAOuter && col < dimInner) {
      ${To}
    }
    return ${(0,Mr.typeSnippet)(Co)}(0.0);`:Js&&yo?`
    let col = colIn * ${Co};
    ${To}`:`
    let col = colIn * ${Co};
    if (row < dimInner && col < dimBOuter) {
      ${To}
    }
    return ${(0,Mr.typeSnippet)(Co)}(0.0);`,Uo=`${(El=>{switch(El){case 1:return"return w[row * wShape[3] + colIn];";case 4:return"return w[row * wShape[3] / 4 + colIn];";default:throw new Error(`innerElementSize ${El} is not supported.`)}})(Do)}`,Io=(0,Mr.typeSnippet)(ds),xl=Qs?(0,Mr.typeSnippet)(Co):(0,Mr.typeSnippet)(Do),Xo=Qs?(0,Mr.typeSnippet)(Do):(0,Mr.typeSnippet)(Co);return`
    ${(0,Mr.activationFnSnippet)(vo,Ro,ds===4,4)}
    fn mm_readA(batch: i32, row : i32, colIn : i32) -> ${xl} {
      ${Qs?Ho:Uo}
    }

    fn mm_readB(batch: i32, row : i32, colIn : i32) -> ${Xo} {
      ${Qs?Uo:Ho}
    }

    fn mm_write(batch: i32, row : i32, colIn : i32, valueIn : ${Io}) {
      let col = colIn * ${ds};
      if (row < dimAOuter && col < dimBOuter)
      {
      var value = valueIn;
      let outWidth = ${Qs?"outShape[2]":"outShape[3]"};
      ${Ws}
      ${(0,Mr.biasActivationSnippet)(lo,vo)}
      setOutputAtCoords(coords[0], coords[1], coords[2], coords[3], value);
      }
    }`})(Xr,vs,Ds,js,qr,void 0,!1,zs[0],zs[1],zs[2])}
            ${is?(0,zr.makeMatMulPackedVec4Source)(fs,ls,!Xr,ps):(0,zr.makeMatMulPackedSource)(fs,ls,!Xr,ps,!1,void 0,Kr)}`})}},4085:(_r,Tr)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.utilFunctions=void 0,Tr.utilFunctions=`
fn getIndexFromCoords4D(coords : vec4<i32>, shape : vec4<i32>) -> i32 {
  return dot(coords, vec4<i32>(
      shape.y * shape.z * shape.w, shape.z * shape.w, shape.w, 1));
}
fn getOutputIndexFromCoords(coords : vec4<i32>) -> i32 {
  return dot(coords, vec4<i32>(
    outShapeStrides.x, outShapeStrides.y, outShapeStrides.z, 1));
}
`},158:(_r,Tr)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.makeMatMulPackedSource=Tr.makeMatMulPackedVec4Source=void 0,Tr.makeMatMulPackedVec4Source=(Rr,Pr,Dr=!1,Mr=32,Fr=!1,zr=32,jr=!1)=>{const Gr=Pr[1]*Rr[1],Nr=Pr[0]*Rr[0],Lr=Dr?Gr:Mr,Ur=Dr?Mr:Gr,Vr=Lr/Pr[0],Wr=Mr/Pr[1];if((!Dr||Vr!==4||Rr[1]!==4)&&(Dr||Vr!==3&&Vr!==4)||Lr%Pr[0]!=0||Mr%Pr[1]!=0||Rr[0]!==4)throw new Error(`If transposeA ${Dr} is true, innerElementSize ${Vr} and workPerThread[1] ${Rr[1]} must be 4.
      Otherwise, innerElementSize ${Vr} must be 3 or 4.
  tileAWidth ${Lr} must be divisible by workgroupSize[0]${Pr[0]}. tileInner ${Mr} must be divisible by workgroupSize[1] ${Pr[1]}. colPerThread ${Rr[0]} must be 4.`);return`
var<workgroup> mm_Asub : array<array<vec${Vr}<f32>, ${Lr/Vr}>, ${Ur}>;
var<workgroup> mm_Bsub : array<array<vec4<f32>, ${Nr/Rr[0]}>, ${Mr}>;

const rowPerThread = ${Rr[1]};
const colPerThread = ${Rr[0]};
const innerElementSize = ${Vr};
const tileInner = ${Mr};

@compute @workgroup_size(${Pr[0]}, ${Pr[1]}, ${Pr[2]})
fn main(@builtin(local_invocation_id) localId : vec3<u32>,
        @builtin(global_invocation_id) globalId : vec3<u32>,
        @builtin(workgroup_id) workgroupId : vec3<u32>) {
  let localRow = i32(localId.y);
  let tileRow = ${jr?"0":"localRow * rowPerThread"};
  let tileCol = i32(localId.x);

  let globalRow = ${jr?"0":"i32(globalId.y) * rowPerThread"};
  let globalCol = i32(globalId.x);
  let batch = ${Fr?"0":"i32(globalId.z)"};
  let globalRowStart = i32(workgroupId.y) * ${Gr};

  let numTiles = ${Fr?`${Math.ceil(zr/Mr)}`:"(dimInner - 1) / tileInner + 1"};
  var kStart = ${Fr?`i32(globalId.z) * ${zr}`:"0"};

  var acc: array<vec4<f32>, rowPerThread>;

  // Loop over shared dimension.
  let tileRowB = localRow * ${Wr};
  for (var t = 0; t < numTiles; t = t + 1) {
      // Load one tile of A into local memory.
      for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
          let inputRow = tileRow + innerRow;
          let inputCol = tileCol;
          ${qr=Dr,qr?`
        mm_Asub[inputRow][inputCol] = mm_readA(batch,
          kStart + inputRow,
          globalRowStart / innerElementSize + inputCol);
        `:`
        mm_Asub[inputRow][inputCol] = mm_readA(batch,
          globalRow + innerRow,
          kStart / innerElementSize + inputCol);
        `}
      }

      // Load one tile of B into local memory.
      for (var innerRow = 0; innerRow < ${Wr}; innerRow = innerRow + 1) {
          let inputRow = tileRowB + innerRow;
          let inputCol = tileCol;
          mm_Bsub[inputRow][inputCol] = mm_readB(batch, kStart + inputRow, globalCol);
      }
      kStart = kStart + tileInner;
      workgroupBarrier();

      // Compute acc values for a single thread.
      for (var k = 0; k < tileInner / innerElementSize; k = k + 1) {
          let BCached0 = mm_Bsub[k * innerElementSize][tileCol];
          let BCached1 = mm_Bsub[k * innerElementSize + 1][tileCol];
          let BCached2 = mm_Bsub[k * innerElementSize + 2][tileCol];
          ${Vr===3?"":"let BCached3 = mm_Bsub[k * innerElementSize + 3][tileCol];"}

          ${((Kr,Xr)=>Kr?`
        let ACached0 = mm_Asub[k * innerElementSize][localRow];
        let ACached1 = mm_Asub[k * innerElementSize + 1][localRow];
        let ACached2 = mm_Asub[k * innerElementSize + 2][localRow];
        ${Xr===3?"":"let ACached3 = mm_Asub[k * innerElementSize + 3][localRow];"}
        for (var i = 0; i < rowPerThread; i = i + 1) {
          acc[i] = BCached0 * ACached0[i] + acc[i];
          acc[i] = BCached1 * ACached1[i] + acc[i];
          acc[i] = BCached2 * ACached2[i] + acc[i];
          ${Xr===3?"":"acc[i] = BCached3 * ACached3[i] + acc[i];"}
        }`:`
        for (var i = 0; i < rowPerThread; i = i + 1) {
          let ACached = mm_Asub[tileRow + i][k];
          acc[i] = BCached0 * ACached.x + acc[i];
          acc[i] = BCached1 * ACached.y + acc[i];
          acc[i] = BCached2 * ACached.z + acc[i];
          ${Xr===3?"":"acc[i] = BCached3 * ACached.w + acc[i];"}
        }`)(Dr,Vr)}
      }

      workgroupBarrier();
  }

  for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
      mm_write(batch, globalRow + innerRow, globalCol, acc[innerRow]);
  }
}`;var qr};const Ar=Rr=>Rr?`
            mm_Asub[inputRow][inputCol] = mm_readA(batch,
              kStart + inputRow,
              globalRowStart + inputCol);
            `:`
            mm_Asub[inputRow][inputCol] = mm_readA(batch,
              globalRowStart + inputRow,
              kStart + inputCol);
            `;Tr.makeMatMulPackedSource=(Rr,Pr,Dr=!1,Mr=32,Fr=!1,zr=32,jr=!1)=>{const Gr=Rr[1]*Pr[1],Nr=Rr[0]*Pr[0],Lr=Dr?Gr:Mr,Ur=Dr?Mr:Gr;if(Ur%Pr[1]!=0||Lr%Pr[0]!=0||Mr%Pr[1]!=0)throw new Error(`tileAHight ${Ur} must be divisible by workgroupSize[1]${Pr[1]}, tileAWidth ${Lr} must be divisible by workgroupSize[0]${Pr[0]}, tileInner ${Mr} must be divisible by workgroupSize[1]${Pr[1]}`);const Vr=Ur/Pr[1],Wr=Lr/Pr[0],qr=Mr/Pr[1],Kr=jr?`
    let localRow = i32(localId.y);
    let localCol = i32(localId.x);
    let globalRowStart = i32(workgroupId.y) * ${Gr};
    let globalColStart = i32(workgroupId.x) * ${Nr};

    // Loop over shared dimension.
    for (var t = 0; t < numTiles; t = t + 1) {
      // Load one tile of A into local memory.
      for (var inputRow = localRow; inputRow < ${Ur}; inputRow = inputRow + ${Pr[1]}) {
        for (var inputCol = localCol; inputCol < ${Lr}; inputCol = inputCol + ${Pr[0]}) {
          ${Ar(Dr)}
        }
      }
      // Load one tile of B into local memory.
      for (var inputRow = localRow; inputRow < ${Mr}; inputRow = inputRow + ${Pr[1]}) {
            for (var inputCol = localCol; inputCol < ${Nr}; inputCol = inputCol + ${Pr[0]}) {
          mm_Bsub[inputRow][inputCol] = mm_readB(batch,
            kStart + inputRow,
            globalColStart + inputCol);
        }
      }
      kStart = kStart + tileInner;
      workgroupBarrier();

      // Compute acc values for a single thread.
      var BCached : array<f32, colPerThread>;
      for (var k = 0; k < tileInner; k = k + 1) {
        for (var inner = 0; inner < colPerThread; inner = inner + 1) {
          BCached[inner] = mm_Bsub[k][localCol + inner * ${Pr[0]}];
        }
        for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
          let ACached = ${Dr?`mm_Asub[k][localRow + innerRow * ${Pr[1]}];`:`mm_Asub[localRow + innerRow * ${Pr[1]}][k];`}
          for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
            acc[innerRow][innerCol] = acc[innerRow][innerCol] +
                ACached * BCached[innerCol];
          }
        }
      }
      workgroupBarrier();
    }
    for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
      let gRow = globalRowStart + localRow + innerRow * ${Pr[1]};
      for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
        let gCol = globalColStart + localCol + innerCol * ${Pr[0]};
        mm_write(batch, gRow, gCol, acc[innerRow][innerCol]);
      }
    }
    `:`
let tileRow = i32(localId.y) * rowPerThread;
let tileCol = i32(localId.x) * colPerThread;

let globalRow = i32(globalId.y) * rowPerThread;
let globalCol = i32(globalId.x) * colPerThread;
let globalRowStart = i32(workgroupId.y) * ${Gr};

let tileRowA = i32(localId.y) * ${Vr};
let tileColA = i32(localId.x) * ${Wr};
let tileRowB = i32(localId.y) * ${qr};
// Loop over shared dimension.
for (var t = 0; t < numTiles; t = t + 1) {
  // Load one tile of A into local memory.
  for (var innerRow = 0; innerRow < ${Vr}; innerRow = innerRow + 1) {
    for (var innerCol = 0; innerCol < ${Wr}; innerCol = innerCol + 1) {
      let inputRow = tileRowA + innerRow;
      let inputCol = tileColA + innerCol;
      ${Ar(Dr)}
    }
  }

  // Load one tile of B into local memory.
  for (var innerRow = 0; innerRow < ${qr}; innerRow = innerRow + 1) {
    for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
      let inputRow = tileRowB + innerRow;
      let inputCol = tileCol + innerCol;
      mm_Bsub[inputRow][inputCol] = mm_readB(batch,
        kStart + inputRow,
        globalCol + innerCol);
    }
  }
  kStart = kStart + tileInner;
  workgroupBarrier();

  // Compute acc values for a single thread.
  var BCached : array<f32, colPerThread>;
  for (var k = 0; k < tileInner; k = k + 1) {
    for (var inner = 0; inner < colPerThread; inner = inner + 1) {
      BCached[inner] = mm_Bsub[k][tileCol + inner];
    }

    for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
      ${(Xr=>Xr?"let ACached = mm_Asub[k][tileRow + innerRow];":"let ACached = mm_Asub[tileRow + innerRow][k];")(Dr)}
      for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
        acc[innerRow][innerCol] = acc[innerRow][innerCol] + ACached * BCached[innerCol];
      }
    }
  }

  workgroupBarrier();
}

for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
  for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
    mm_write(batch, globalRow + innerRow, globalCol + innerCol,
        acc[innerRow][innerCol]);
  }
}
`;return`
  var<workgroup> mm_Asub : array<array<f32, ${Lr}>, ${Ur}>;
  var<workgroup> mm_Bsub : array<array<f32, ${Nr}>, ${Mr}>;
  const rowPerThread = ${Rr[1]};
  const colPerThread = ${Rr[0]};
  const tileInner = ${Mr};

@compute @workgroup_size(${Pr[0]}, ${Pr[1]}, ${Pr[2]})
fn main(@builtin(local_invocation_id) localId : vec3<u32>,
        @builtin(global_invocation_id) globalId : vec3<u32>,
        @builtin(workgroup_id) workgroupId : vec3<u32>) {
    let batch = ${Fr?"0":"i32(globalId.z)"};
    let numTiles = ${Fr?`${Math.ceil(zr/Mr)}`:"(dimInner - 1) / tileInner + 1"};
    var kStart = ${Fr?`i32(globalId.z) * ${zr}`:"0"};

    var acc : array<array<f32, colPerThread>, rowPerThread>;

    // Without this initialization strange values show up in acc.
    for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
      for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
        acc[innerRow][innerCol] = 0.0;
      }
    }
    ${Kr}
  }
`}},504:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.sub=Tr.pow=Tr.mul=Tr.div=Tr.add=void 0;const Rr=Ar(6952),Pr=Ar(1163),Dr=Ar(2075),Mr=(Fr,zr,jr,Gr,Nr)=>{const Lr={name:zr,inputTypes:[Pr.GpuDataType.default,Pr.GpuDataType.default],cacheHint:Nr};return Object.assign(Object.assign({},Lr),{get:()=>((Ur,Vr,Wr,qr,Kr,Xr=Vr.dataType)=>{var Zr,_i;const Jr=!Rr.ShapeUtil.areEqual(Vr.dims,Wr.dims);let es=Vr.dims,ts=Rr.ShapeUtil.size(Vr.dims),is=!1;if(Jr){const rs=Rr.BroadcastUtil.calcShape(Vr.dims,Wr.dims,!1);if(!rs)throw new Error("Can't perform binary op on the given tensors");es=rs,ts=Rr.ShapeUtil.size(es);let as=1;for(let ls=0;ls<es.length;ls++){const fs=(Zr=Vr.dims[Vr.dims.length-ls])!==null&&Zr!==void 0?Zr:1;if(fs!==((_i=Wr.dims[Wr.dims.length-ls])!==null&&_i!==void 0?_i:1))break;as*=fs}as%4==0&&(is=!0)}else is=!0;return Object.assign(Object.assign({},Ur),{getShaderSource:rs=>((as,ls,fs,Ts,$s,xs,ys,ps,vs="f32",Ds="f32",js="f32")=>{const zs=Rr.ShapeUtil.size(Ts),qs=Math.ceil(zs/4);let fo,Qs;typeof ys=="string"?fo=Qs=(lo,vo)=>`${ys}((${lo}),(${vo}))`:typeof ys=="function"?fo=Qs=ys:(fo=ys.scalar,Qs=ys.vector);let no="";const yo=(0,Dr.createIndicesHelper)("output",Ts);if(xs){const lo=vo=>{const Ro=Rr.ShapeUtil.computeStrides(vo),Co=[];for(let Do=vo.length-1;Do>=0;Do--){const ds=Ts.length===0?"0u":Ts.length===1?"(*outputIndices)":`(*outputIndices)[${Do+Ts.length-vo.length}]`;Co.push(`${Ro[Do]}u * (${ds} % ${vo[Do]}u)`)}return Co.length>0?Co.join("+"):"0u"};no=`
  ${yo.o2iImpl}

  fn calcOffsetA(outputIndices: ptr<function, ${yo.iType}>) -> u32 {
    return ${lo(ls)};
  }

  fn calcOffsetB(outputIndices: ptr<function, ${yo.iType}>) -> u32 {
    return ${lo(fs)};
  }
  `}let Js;if($s)Js=xs?`
      ${yo.indicesVariableDeclaration("outputIndices")}
      ${yo.o2iCall("global_idx * 4u","outputIndices")}
      let offsetA = calcOffsetA(&outputIndices);
      let offsetB = calcOffsetB(&outputIndices);
      outputData[global_idx] = ${Qs("aData[offsetA / 4u]","bData[offsetB / 4u]")};`:`outputData[global_idx] = ${Qs("aData[global_idx]","bData[global_idx]")};`;else{if(!xs)throw new Error("no necessary to use scalar implementation for element-wise binary op implementation.");const lo=vo=>{const Ro=`aData[indexA${vo}][componentA${vo}]`,Co=`bData[indexB${vo}][componentB${vo}]`;return`
      ${yo.o2iCall(`global_idx * 4u + ${vo}u`,"outputIndices")}
      let offsetA${vo} = calcOffsetA(&outputIndices);
      let offsetB${vo} = calcOffsetB(&outputIndices);
      let indexA${vo} = offsetA${vo} / 4u;
      let indexB${vo} = offsetB${vo} / 4u;
      let componentA${vo} = offsetA${vo} % 4u;
      let componentB${vo} = offsetB${vo} % 4u;
      outputData[global_idx][${vo}] = ${fo(Ro,Co)};`};Js=`
      ${yo.indicesVariableDeclaration("outputIndices")}
      ${lo(0)}
      ${lo(1)}
      ${lo(2)}
      ${lo(3)}`}return`
  @group(0) @binding(0) var<storage, read> aData : array<vec4<${vs}>>;
  @group(0) @binding(1) var<storage, read> bData : array<vec4<${Ds}>>;
  @group(0) @binding(2) var<storage, read_write> outputData : array<vec4<${js}>>;

  ${ps??""}
  ${no}

  ${as.mainStart()}
    ${as.guardAgainstOutOfBoundsWorkgroupSizes(qs)}
    ${Js}
  }`})(rs,Vr.dims,Wr.dims,es,is,Jr,qr,Kr),outputs:[{dims:es,dataType:Xr,gpuDataType:Pr.GpuDataType.default}],dispatchGroup:()=>({x:Math.ceil(ts/64/(is?4:1))})})})(Lr,Fr[0],Fr[1],jr,Gr)})};Tr.add=Fr=>{Fr.compute(Mr(Fr.inputs,"Add",(zr,jr)=>`${zr}+${jr}`))},Tr.div=Fr=>{Fr.compute(Mr(Fr.inputs,"Div",(zr,jr)=>`${zr}/${jr}`))},Tr.mul=Fr=>{Fr.compute(Mr(Fr.inputs,"Mul",(zr,jr)=>`${zr}*${jr}`))},Tr.pow=Fr=>{Fr.compute(Mr(Fr.inputs,"Pow",{scalar:(zr,jr)=>`pow_f32(${zr},${jr})`,vector:(zr,jr)=>`pow_vf32(${zr},${jr})`},`
    fn pow_f32(a : f32, b : f32) -> f32 {
      if (b == 0.0) {
        return 1.0;
      } else if (a < 0.0 && b != floor(b)) {
        return pow(a, b); // NaN
      }
      return select(sign(a), 1.0, round(abs(b) % 2.0) != 1.0) * pow(abs(a), b);
    }
    fn pow_vf32(a : vec4<f32>, b : vec4<f32>) -> vec4<f32> {
      // TODO: implement vectorized pow
      return vec4<f32>(pow_f32(a.x, b.x), pow_f32(a.y, b.y), pow_f32(a.z, b.z), pow_f32(a.w, b.w));
    }
      `))},Tr.sub=Fr=>{Fr.compute(Mr(Fr.inputs,"Sub",(zr,jr)=>`${zr}-${jr}`))}},2075:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.createShaderHelper=Tr.createIndicesHelper=Tr.WORKGROUP_SIZE=void 0;const Rr=Ar(6952);Tr.WORKGROUP_SIZE=64,Tr.createIndicesHelper=(Dr,Mr)=>{const Fr=Mr.length<2?"u32":`array<u32, ${Mr.length}>`,zr=Rr.ShapeUtil.computeStrides(Mr);let jr="";for(let Lr=0;Lr<Mr.length-1;Lr++)jr+=`
    let dim${Lr} = current / ${zr[Lr]}u;
    let rest${Lr} = current % ${zr[Lr]}u;
    (*indices)[${Lr}] = dim${Lr};
    current = rest${Lr};
    `;jr+=`(*indices)[${Mr.length-1}] = current;`;const Gr=Mr.length<2?"":`
  fn ih_o2i_${Dr}(offset: u32, indices: ptr<function, ${Fr}>) {
    var current = offset;
    ${jr}
  }`,Nr=[];if(Mr.length===0)Nr.push("0u");else if(Mr.length<2)Nr.push("(*indices)");else for(let Lr=Mr.length-1;Lr>=0;Lr--)Nr.push(`${zr[Lr]}u * ((*indices)[${Lr}])`);return{o2iImpl:Gr,o2iCall:(Lr,Ur)=>Mr.length<2?`${Ur}=${Lr};`:`ih_o2i_${Dr}(${Lr}, &${Ur});`,i2oImpl:Mr.length<2?"":`
  fn ih_i2o_${Dr}(indices: ptr<function, ${Fr}>) -> u32 {
    return ${Nr.join("+")};
  }`,i2oExpression:(Lr,Ur)=>Mr.length<2?`(${Ur?"*":""}${Lr})`:`ih_i2o_${Dr}(${Ur?"":"&"}${Lr})`,indicesVariableDeclaration:(Lr,Ur)=>`var ${Lr}:${Fr}${Ur?`=${Fr}(${Ur.join(",")})`:""};`,iType:Fr}};class Pr{constructor(Mr){this.normalizedDispatchGroup=Mr}guardAgainstOutOfBoundsWorkgroupSizes(Mr){return`if (global_idx >= ${typeof Mr=="number"?`${Mr}u`:Mr}) { return; }`}mainStart(Mr=Tr.WORKGROUP_SIZE){const Fr=typeof Mr=="number"?Mr:Mr[0],zr=typeof Mr=="number"?1:Mr[1],jr=typeof Mr=="number"?1:Mr[2],Gr=this.normalizedDispatchGroup[1]===1&&this.normalizedDispatchGroup[2]===1;return`@compute @workgroup_size(${Fr}, ${zr}, ${jr})
  fn main(${Gr?"@builtin(global_invocation_id) global_id : vec3<u32>":`@builtin(local_invocation_index) local_index : u32,
    @builtin(workgroup_id) workgroup_id : vec3<u32>`}) {
    ${Gr?"let global_idx = global_id.x;":`let global_idx = (workgroup_id.z * ${this.normalizedDispatchGroup[0]*this.normalizedDispatchGroup[1]}u +
          workgroup_id.y * ${this.normalizedDispatchGroup[0]}u + workgroup_id.x) * ${Fr*zr*jr}u + local_index;`}
  `}}Tr.createShaderHelper=Dr=>new Pr(Dr)},9192:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.createGroupedConvProgramInfoLoader=void 0;const Rr=Ar(6952),Pr=Ar(1163),Dr=Ar(2075),Mr=Ar(9770),Fr=Ar(3997);Tr.createGroupedConvProgramInfoLoader=(zr,jr,Gr)=>{const Nr=(Lr=zr.length>2,Ur=jr.cacheKey,{name:"GroupedConv",inputTypes:Lr?[Pr.GpuDataType.default,Pr.GpuDataType.default,Pr.GpuDataType.default]:[Pr.GpuDataType.default,Pr.GpuDataType.default],cacheHint:Ur});var Lr,Ur;return Object.assign(Object.assign({},Nr),{get:()=>((Vr,Wr,qr,Kr)=>{const Xr=Vr.length>2,Zr=Xr?"value += b[output_channel];":"",_i=Vr[0].dims,Jr=Vr[1].dims,es=Jr[0]/qr.group,ts="f32",{activationFunction:is,applyActivation:rs}=(0,Fr.getActicationSnippet)(qr),as=[`@group(0) @binding(0) var<storage, read> x : array<${ts}>;`,`@group(0) @binding(1) var<storage, read> w : array<${ts}>;`];Xr&&as.push(`@group(0) @binding(2) var<storage, read> b : array<${ts}>;`);const ls=qr.format==="NHWC",fs=(0,Mr.calculateOutputShape)(_i,Jr,qr.dilations,qr.pads,qr.strides,ls),Ts=Rr.ShapeUtil.size(fs),$s=(0,Dr.createIndicesHelper)("output",fs),xs=(0,Dr.createIndicesHelper)("x",_i),ys=(0,Dr.createIndicesHelper)("w",Jr);return Object.assign(Object.assign({},Wr),{outputs:[{dims:Kr?Kr(fs):fs,dataType:Vr[0].dataType,gpuDataType:Pr.GpuDataType.default}],getShaderSource:ps=>`
  const strides: vec2<u32> = vec2(${qr.strides[0]}u, ${qr.strides[1]}u);
  const pads: vec2<u32> = vec2(${qr.pads[0]}u, ${qr.pads[1]}u);

  ${as.join(`
`)}
  @group(0) @binding(${as.length}) var<storage, read_write> output : array<${ts}>;

  ${is}
  ${$s.o2iImpl}
  ${xs.i2oImpl}
  ${ys.i2oImpl}

  ${ps.mainStart()}
    ${ps.guardAgainstOutOfBoundsWorkgroupSizes(Ts)}

    ${$s.indicesVariableDeclaration("outputIndices")}
    ${$s.o2iCall("global_idx","outputIndices")}
    let batch: u32 = outputIndices[0];
    let output_channel: u32 = outputIndices[${ls?3:1}];
    let xRCCorner: vec2<u32> = vec2<u32>(outputIndices[${ls?1:2}], outputIndices[${ls?2:3}]) * strides - pads;
    let group_id: u32 = output_channel / ${es}u;

    var value: ${ts} = ${ts}(0);
    for (var wInChannel: u32 = 0u; wInChannel < ${Jr[1]}u; wInChannel++) {
      let input_channel = group_id * ${Jr[1]}u + wInChannel;
      for (var wHeight: u32 = 0u; wHeight < ${Jr[2]}u; wHeight++) {
        let xHeight = xRCCorner.x + wHeight * ${qr.dilations[0]}u;

        if (xHeight < 0u || xHeight >= ${_i[ls?1:2]}u) {
          continue;
        }

        for (var wWidth: u32 = 0u; wWidth < ${Jr[3]}u; wWidth++) {
          let xWidth = xRCCorner.y + wWidth * ${qr.dilations[1]}u;
          if (xWidth < 0u || xWidth >= ${_i[ls?2:3]}u) {
            continue;
          }

          ${xs.indicesVariableDeclaration("xIndices",ls?["batch","xHeight","xWidth","input_channel"]:["batch","input_channel","xHeight","xWidth"])}
          let xVal = x[${xs.i2oExpression("xIndices")}];
          ${ys.indicesVariableDeclaration("wIndices",["output_channel","wInChannel","wHeight","wWidth"])}
          let wVal = w[${ys.i2oExpression("wIndices")}];
          value += xVal*wVal;
        }
      }
    }
    ${Zr}
    ${rs}
    output[global_idx] = value;
  }`,dispatchGroup:()=>({x:Math.ceil(Ts/64)})})})(zr,Nr,jr,Gr)})}},9770:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.conv=Tr.parseConvAttributes=Tr.calculateOutputShape=void 0;const Rr=Ar(6952),Pr=Ar(387),Dr=Ar(9192),Mr=Ar(3822),Fr=Ar(3997),zr=Ar(2625);Tr.calculateOutputShape=(Nr,Lr,Ur,Vr,Wr,qr)=>{const Kr=Nr[0],Xr=Nr.slice(qr?1:2,qr?3:4),Zr=Xr.length,_i=Lr[0],Jr=Lr.slice(2).map((ts,is)=>ts+(ts-1)*(Ur[is]-1)),es=Xr.map((ts,is)=>ts+Vr[is]+Vr[is+Zr]).map((ts,is)=>Math.floor((ts-Jr[is]+Wr[is])/Wr[is]));return es.splice(0,0,Kr),es.splice(qr?3:1,0,_i),es};const jr=(0,Pr.createAttributeWithCacheKey)({perm:[2,3,1,0]}),Gr=(Nr,Lr)=>{const Ur=Nr.kernelShape.slice();for(let qr=2;qr<Lr[1].dims.length;++qr)Ur[qr-2]===0&&(Ur[qr-2]=Lr[1].dims[qr]);const Vr=Nr.pads.slice();Rr.PoolConvUtil.adjustPadsBasedOnAutoPad(Lr[0].dims,Nr.strides,Nr.dilations,Ur,Vr,Nr.format==="NHWC",Nr.autoPad);const Wr=Object.assign({},Nr);return Object.assign(Wr,{kernelShape:Ur,pads:Vr,cacheKey:Nr.cacheKey}),Wr};Tr.parseConvAttributes=Nr=>{const Lr=(0,Fr.parseInternalActivationAttributes)(Nr),Ur=Nr.format,Vr=["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][Nr.auto_pad],Wr=Nr.dilations,qr=Nr.group,Kr=Nr.kernel_shape,Xr=Nr.pads,Zr=Nr.strides,_i=Nr.w_is_const();return(0,Pr.createAttributeWithCacheKey)(Object.assign({autoPad:Vr,format:Ur,dilations:Wr,group:qr,kernelShape:Kr,pads:Xr,strides:Zr,wIsConst:_i},Lr))},Tr.conv=(Nr,Lr)=>{((Ur,Vr)=>{if(!Ur||Ur.length!==2&&Ur.length!==3)throw new Error("Conv requires 2 or 3 inputs");if(Ur[0].dims.length!==4&&Ur[0].dims.length!==3)throw new Error("currently only support conv 1D and 2D");if(Ur[0].dims.length!==Ur[1].dims.length)throw new Error("filter does not have same dimension as input");if(Ur[0].dims[Vr.format==="NHWC"?Ur[0].dims.length-1:1]!==Ur[1].dims[1]*Vr.group)throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");if(Ur.length===3&&(Ur[2].dims.length!==1||Ur[1].dims[0]!==Ur[2].dims[0]))throw new Error("invalid bias");const Wr=Ur[0].dims.length-2;if(Vr.dilations.length!==Wr)throw new Error(`dilations should be ${Wr}D`);if(Vr.strides.length!==Wr)throw new Error(`strides should be ${Wr}D`);if(Vr.pads.length!==2*Wr)throw new Error(`pads should be ${2*Wr}D`);if(Vr.kernelShape.length!==0&&Vr.kernelShape.length!==Ur[1].dims.length-2)throw new Error("invalid kernel shape");if(Ur[0].dataType!==1||Ur[1].dataType!==1)throw new Error("Conv input(X,W) should be float tensor");if(Ur.length===3&&Ur[2].dataType!==1)throw new Error("Conv input(bias) should be float tensor")})(Nr.inputs,Lr),Nr.inputs[0].dims.length===3?((Ur,Vr)=>{const Wr=Vr.format==="NHWC",qr=[Ur.inputs[0].reshape(Wr?[Ur.inputs[0].dims[0],1,Ur.inputs[0].dims[1],Ur.inputs[0].dims[2]]:[Ur.inputs[0].dims[0],Ur.inputs[0].dims[1],1,Ur.inputs[0].dims[2]]),Ur.inputs[1].reshape([Ur.inputs[1].dims[0],Ur.inputs[1].dims[1],1,Ur.inputs[1].dims[2]])];Ur.inputs.length===3&&qr.push(Ur.inputs[2]);const Kr=[0,Vr.pads[0],0,Vr.pads[1]],Xr=[1].concat(Vr.strides),Zr=[1].concat(Vr.dilations),_i=[1].concat(Vr.kernelShape),Jr=Gr(Object.assign(Object.assign({},Vr),{pads:Kr,strides:Xr,dilations:Zr,kernelShape:_i}),qr);Ur.compute((0,Dr.createGroupedConvProgramInfoLoader)(qr,Jr,es=>Wr?[es[0],es[2],es[3]]:[]))})(Nr,Lr):((Ur,Vr,Wr)=>{var qr;const Kr=Gr(Wr,Vr),Xr=Vr.length===3,Zr=Wr.format==="NHWC",_i=Vr[0].dims[Zr?1:2],Jr=Vr[0].dims[Zr?2:3],es=Vr[0].dims[Zr?3:1],ts=Vr[1].dims[2],is=Vr[1].dims[3],rs=(0,Tr.calculateOutputShape)(Vr[0].dims,Vr[1].dims,Wr.dilations,Kr.pads,Wr.strides,Zr),as=rs[Zr?1:2],ls=rs[Zr?2:3],fs=rs[Zr?3:1];if(Zr&&ts===_i&&is===Jr&&Wr.autoPad==="VALID"||ts===1&&is===1&&Wr.dilations[0]===1&&Wr.dilations[1]===1&&Wr.strides[0]===1&&Wr.strides[1]===1&&(Wr.autoPad==="SAME_UPPER"||Wr.autoPad==="SAME_LOWER"||Wr.autoPad==="VALID")||!Zr||Wr.group!==1)return void Ur.compute((0,Dr.createGroupedConvProgramInfoLoader)(Vr,Kr));const Ts=Zr?as*ls:fs,$s=Zr?fs:as*ls,xs=ts*is*es,ys=(qr=Ur.customData.wT)!==null&&qr!==void 0?qr:Ur.compute(Object.assign(Object.assign({},zr.transposeProgramMetadata),{cacheHint:jr.cacheKey,get:()=>(0,zr.createTransposeProgramInfo)(Vr[1],jr.perm)}),{inputs:[1],outputs:[Wr.wIsConst?-2:-1]})[0];Wr.wIsConst&&!Ur.customData.wT&&(Ur.customData.wT=ys);const ps=[Vr[0],ys];Xr&&(Zr||Vr[2].dims.length!==1?ps.push(Vr[2]):ps.push(Vr[2].reshape([Vr[2].dims[0],1,1]))),Ur.compute((0,Mr.createConv2DMatMulProgramInfoLoader)(ps,Kr,rs,Ts,$s,xs,Xr,!0),{inputs:ps})})(Nr,Nr.inputs,Lr)}},3822:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.createConv2DMatMulProgramInfoLoader=void 0;const Rr=Ar(1163),Pr=Ar(9456);Tr.createConv2DMatMulProgramInfoLoader=(Dr,Mr,Fr,zr,jr,Gr,Nr,Lr)=>{const Ur=((Vr,Wr)=>({name:"Conv2DMatMul",inputTypes:Vr?[Rr.GpuDataType.default,Rr.GpuDataType.default,Rr.GpuDataType.default]:[Rr.GpuDataType.default,Rr.GpuDataType.default],cacheHint:Wr}))(Nr,Mr.cacheKey);return Object.assign(Object.assign({},Ur),{get:()=>(0,Pr.createConv2DMatMulProgramInfo)(Dr,Ur,Mr,Fr,zr,jr,Gr,Nr,Lr)})}},3997:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.parseInternalActivationAttributes=Tr.getActicationSnippet=void 0;const Rr=Ar(6952);Tr.getActicationSnippet=Pr=>{switch(Pr.activation){case"Relu":return{activationFunction:"",applyActivation:"value = max(value, 0.0);"};case"Sigmoid":return{activationFunction:"",applyActivation:"value = (1.0 / (1.0 + exp(-value)));"};case"Clip":return{activationFunction:`const clip_min_=f32(${Pr.clipMin});const clip_max_=f32(${Pr.clipMax});`,applyActivation:"value = clamp(value, clip_min_, clip_max_);"};default:return{activationFunction:"",applyActivation:""}}},Tr.parseInternalActivationAttributes=Pr=>{const Dr=(Pr==null?void 0:Pr.activation)||"";if(Dr==="Clip"){const[Mr,Fr]=(Pr==null?void 0:Pr.activation_params)||[Rr.MIN_CLIP,Rr.MAX_CLIP];return{activation:Dr,clipMax:Fr,clipMin:Mr,activationCacheKey:`${Dr}:${Mr},${Fr}`}}return{activation:Dr,activationCacheKey:Dr}}},4271:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.parseGemmAttributes=Tr.gemm=void 0;const Rr=Ar(6952),Pr=Ar(387),Dr=Ar(1163);Tr.gemm=(Mr,Fr)=>{(zr=>{if(!zr)throw new Error("Input is missing");if(zr.length<2||zr.length>3)throw new Error("Invaid input number.");if(zr.length===3&&zr[2].dims.length>2)throw new Error("Invalid input shape of C");if(zr[0].dataType!==1||zr[1].dataType!==1||zr.length===3&&zr[2].dataType!==1)throw new Error("Invalid input type.");if(zr[0].dataType!==zr[1].dataType||zr.length===3&&zr[0].dataType!==zr[2].dataType)throw new Error("Input types are mismatched")})(Mr.inputs),Mr.compute(((zr,jr)=>{const Gr={name:"Gemm",inputTypes:zr.length===3?[Dr.GpuDataType.default,Dr.GpuDataType.default,Dr.GpuDataType.default]:[Dr.GpuDataType.default,Dr.GpuDataType.default],cacheHint:jr.cacheKey};return Object.assign(Object.assign({},Gr),{get:()=>((Nr,Lr,Ur)=>{const Vr=Lr[0].dims.slice(),Wr=Lr[1].dims.slice(),[qr,Kr,Xr]=Rr.GemmUtil.getShapeOfGemmResult(Vr,Ur.transA,Wr,Ur.transB,Lr.length===3?Lr[2].dims:void 0),Zr=[qr,Kr];if(!Zr)throw new Error("Can't use gemm on the given tensors");const _i=Rr.ShapeUtil.size(Zr);let Jr="";Ur.transA&&Ur.transB?Jr="value += a[k * M + m] * b[n * K + k];":Ur.transA&&!Ur.transB?Jr="value += a[k * M + m] * b[k * N + n];":!Ur.transA&&Ur.transB?Jr="value += a[m * K + k] * b[n * K + k];":Ur.transA||Ur.transB||(Jr="value += a[m * K + k] * b[k * N + n];");const es="f32",ts=Ur.alpha===1?"":"value *= alpha;",is=Lr.length===3?`value += beta * c[${((as,ls,fs)=>{if(fs.length===0)return"0u";const Ts=fs.length===1&&as!==1||fs.length===2&&fs[0]!==as,$s=fs[fs.length-1]!==ls;let xs="0u";return Ts||(xs+=`+ m * ${fs[fs.length-1]}u`),$s||(xs+="+n"),xs})(qr,Kr,Lr[2].dims)}];`:"",rs=[`@group(0) @binding(0) var<storage, read> a : array<${es}>;`,`@group(0) @binding(1) var<storage, read> b : array<${es}>;`];return Lr.length===3&&rs.push(`@group(0) @binding(2) var<storage, read> c : array<${es}>;`),Object.assign(Object.assign({},Nr),{outputs:[{dims:Zr,dataType:Lr[0].dataType,gpuDataType:Dr.GpuDataType.default}],getShaderSource:as=>`
  const M: u32 = ${qr}u;
  const N: u32 = ${Kr}u;
  const K: u32 = ${Xr}u;
  const alpha = ${es}(${Ur.alpha});
  const beta = ${es}(${Ur.beta});

  ${rs.join(`
`)}
  @group(0) @binding(${Lr.length}) var<storage, read_write> output : array<${es}>;

  ${as.mainStart()}
    ${as.guardAgainstOutOfBoundsWorkgroupSizes(_i)}

    let m = global_id.x / N;
    let n = global_id.x % N;

    var value = ${es}(0);
    for (var k: u32 = 0u; k<${Xr}u; k++) {
      ${Jr}
    }

    ${ts}
    ${is}
    output[global_id.x] = value;

  }`,dispatchGroup:()=>({x:Math.ceil(_i/64)})})})(Gr,zr,jr)})})(Mr.inputs,Fr))},Tr.parseGemmAttributes=Mr=>(0,Pr.createAttributeWithCacheKey)(Mr)},1522:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.matMul=Tr.createMatmulProgramInfoLoader=void 0;const Rr=Ar(6952),Pr=Ar(1163),Dr=Ar(3997);Tr.createMatmulProgramInfoLoader=(Mr,Fr)=>{const zr=(jr=Mr.length>2,Gr=Fr.activationCacheKey,{name:"MatMul",inputTypes:jr?[Pr.GpuDataType.default,Pr.GpuDataType.default,Pr.GpuDataType.default]:[Pr.GpuDataType.default,Pr.GpuDataType.default],cacheHint:Gr});var jr,Gr;return Object.assign(Object.assign({},zr),{get:()=>((Nr,Lr,Ur)=>{const Vr=Lr[0].dims,Wr=Lr[1].dims,qr=Rr.BroadcastUtil.calcShape(Vr,Wr,!0);if(!qr)throw new Error("Can't use matmul on the given tensors");const Kr=Rr.ShapeUtil.size(qr),Xr="f32",{activationFunction:Zr,applyActivation:_i}=(0,Dr.getActicationSnippet)(Ur),Jr=qr[qr.length-2],es=Vr[Vr.length-1],ts=qr[qr.length-1];return Object.assign(Object.assign({},Nr),{outputs:[{dims:qr,dataType:Lr[0].dataType,gpuDataType:Pr.GpuDataType.default}],getShaderSource:is=>`
  const M: u32 = ${Jr}u;
  const N: u32 = ${ts}u;
  const K: u32 = ${es}u;

  @group(0) @binding(0) var<storage, read> a : array<${Xr}>;
  @group(0) @binding(1) var<storage, read> b : array<${Xr}>;
  @group(0) @binding(2) var<storage, read_write> output : array<${Xr}>;

  ${Zr}

  ${is.mainStart()}
    ${is.guardAgainstOutOfBoundsWorkgroupSizes(Kr)}

    let stack = global_idx / (M * N);
    let mn = global_idx % (M * N);
    let n = global_idx % N;
    let m = mn / N;

    let offsetA = stack * (M * K);
    let offsetB = stack * (K * N);

    var value = ${Xr}(0);
    for (var k: u32 = 0u; k<${es}u; k++) {
      value += a[offsetA + m * K + k] * b[offsetB + k * N + n];
    }
    ${_i}
    output[global_idx] = value;
  }`,dispatchGroup:()=>({x:Math.ceil(Kr/64)})})})(zr,Mr,Fr)})},Tr.matMul=Mr=>{(Fr=>{if(!Fr||Fr.length!==2)throw new Error("MatMul requires 2 inputs.");if(Fr[0].dims[Fr[0].dims.length-1]!==Fr[1].dims[Fr[1].dims.length-2])throw new Error("shared dimension does not match.");if(Fr[0].dataType!==1||Fr[1].dataType!==1)throw new Error("inputs should be float type")})(Mr.inputs),Mr.compute((0,Tr.createMatmulProgramInfoLoader)(Mr.inputs,{activation:"",activationCacheKey:""}))}},5262:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.globalMaxPool=Tr.parseGlobalMaxPoolAttributes=Tr.parseMaxPoolAttributes=Tr.maxPool=Tr.globalAveragePool=Tr.parseGlobalAveragePoolAttributes=Tr.averagePool=Tr.parseAveragePoolAttributes=void 0;const Rr=Ar(6952),Pr=Ar(387),Dr=Ar(1163),Mr=Ar(2075),Fr=Vr=>{if(!Vr||Vr.length!==1)throw new Error("Pool ops requires 1 input.");if(Vr[0].dims.length!==4)throw new Error("Pool ops supports 2-D inputs only for now.");if(Vr[0].dataType!==1)throw new Error("Invalid input type.")},zr=(Vr,Wr,qr)=>{const Kr=Wr.format==="NHWC",Xr=Kr?[Vr[0].dims[0],Vr[0].dims[3],Vr[0].dims[1],Vr[0].dims[2]]:Vr[0].dims.slice(),Zr=Object.hasOwnProperty.call(Wr,"dilations"),_i=Wr.kernelShape.slice(),Jr=Wr.strides.slice(),es=Zr?Wr.dilations.slice():[],ts=Wr.pads.slice();Rr.PoolConvUtil.adjustPoolAttributes(qr,Xr,_i,Jr,es,ts);const is=Rr.PoolConvUtil.computePoolOutputShape(qr,Xr,Jr,es,_i,ts,Wr.autoPad),rs=Object.assign({},Wr);return Zr?Object.assign(rs,{kernelShape:_i,strides:Jr,pads:ts,dilations:es,cacheKey:Wr.cacheKey}):Object.assign(rs,{kernelShape:_i,strides:Jr,pads:ts,cacheKey:Wr.cacheKey}),[rs,Kr?[is[0],is[2],is[3],is[1]]:is]},jr=(Vr,Wr,qr,Kr,Xr,Zr,_i,Jr)=>{const es=Kr.format==="NHWC",ts=Wr.length,is=Rr.ShapeUtil.size(qr),rs=(0,Mr.createIndicesHelper)("output",qr),as=(0,Mr.createIndicesHelper)("x",Wr);if(Kr.kernelShape.length<=2){const ls=Kr.kernelShape[Kr.kernelShape.length-1],fs=Kr.strides[Kr.strides.length-1],Ts=Kr.pads[Kr.pads.length/2-1],$s=ts-(es?2:1);let xs="",ys="",ps="";if(xs=Ts+Kr.pads[Kr.pads.length-1]!==0?`
              for (var i: u32 = 0u; i < ${ls}u; i++) {
                xIndices[${$s}] = indices[${$s}] * ${fs} - ${Ts} + i;
                if (xIndices[${$s}] < 0 || xIndices[${$s}] >= ${Wr[$s]}) {
                  pad++;
                  continue;
                }
                let x_val = x[${as.i2oExpression("xIndices")}];
                ${Xr}
              }`:`
              for (var i: u32 = 0u; i < ${ls}u; i++) {
                xIndices[${$s}] = indices[${$s}] * ${fs} - ${Ts} + i;
                let x_val = x[${as.i2oExpression("xIndices")}];
                ${Xr}
              }`,Kr.kernelShape.length===2){const vs=Kr.kernelShape[Kr.kernelShape.length-2],Ds=Kr.strides[Kr.strides.length-2],js=Kr.pads[Kr.pads.length/2-2],zs=Kr.pads[Kr.pads.length-2],qs=ts-(es?3:2),fo=Wr[qs];ys=js+zs!==0?`
                for (var j: u32 = 0u; j < ${vs}u; j++) {
                  xIndices[${qs}] = indices[${qs}] * ${Ds} - ${js} + j;
                  if (xIndices[${qs}] < 0 || xIndices[${qs}] >= ${fo}) {
                    pad+= ${ls};
                    continue;
                  }
              `:`
                for (var j: u32 = 0u; j < ${vs}u; j++) {
                  xIndices[${qs}] = indices[${qs}] * ${Ds} - ${js} + j;
                `,ps=`
              }
            `}return`
            @group(0) @binding(0) var<storage, read> x : array<${_i}>;
            @group(0) @binding(1) var<storage, read_write> output : array<${_i}>;

            ${rs.o2iImpl}
            ${as.i2oImpl}

            ${Vr.mainStart()}
              ${Vr.guardAgainstOutOfBoundsWorkgroupSizes(is)}

              ${rs.indicesVariableDeclaration("indices")}
              ${rs.o2iCall("global_idx","indices")}
              ${rs.indicesVariableDeclaration("xIndices")}
              ${rs.o2iCall("global_idx","xIndices")}

              var value: ${_i} = ${_i}(${Jr});
              var pad = 0;
              ${ys}
              ${xs}
              ${ps}
              ${Zr}

              output[global_idx] = value;
            }`}{if(es)throw new Error("Pooling with kernelShape.length > 2 is not supported for NHWC format.");const ls=Rr.ShapeUtil.size(Kr.kernelShape),fs=Rr.ShapeUtil.computeStrides(Kr.kernelShape),Ts=fs.length,$s=Kr.pads.length;let xs="";return xs=Kr.pads.reduce((ys,ps)=>ys+ps)?`
                if (xIndices[j] >= inputDims[j]) {
                  pad++;
                  isPad = true;
                  break;
                }
              }
              if (!isPad) {
                let x_val = x[${as.i2oExpression("xIndices")}];
                ${Xr}
              }`:`
              }
              let x_val = x[${as.i2oExpression("xIndices")}];
              ${Xr}
            `,`
            @group(0) @binding(0) var<storage, read> x : array<${_i}>;
            @group(0) @binding(1) var<storage, read_write> output : array<${_i}>;

            ${rs.o2iImpl}
            ${as.i2oImpl}

            const pads = array<u32, ${$s}>(${Kr.pads.map(ys=>`${ys}u`).join(",")});
            const inputDims = array<u32, ${ts}>(${Wr.map(ys=>`${ys}u`).join(",")});
            const kernelStrides = array<u32, ${Ts}>(${fs.map(ys=>`${ys}u`).join(",")});
            const strides = array<u32, ${Ts}>(${Kr.strides.map(ys=>`${ys}u`).join(",")});

            ${Vr.mainStart()}
              ${Vr.guardAgainstOutOfBoundsWorkgroupSizes(is)}

              ${rs.indicesVariableDeclaration("indices")}
              ${rs.o2iCall("global_idx","indices")}
              ${rs.indicesVariableDeclaration("xIndices")}
              ${rs.o2iCall("global_idx","xIndices")}

              var offsets: array<u32, ${Ts}>;

              var value = ${_i}(${Jr});
              var pad = 0;
              var isPad = false;

              for (var i: u32 = 0u; i < ${ls}u; i++) {
                var offset = i;
                for (var j = 0u; j < ${Ts-1}u; j++) {
                  offsets[j] = offset / kernelStrides[j];
                  offset -= offsets[j] * kernelStrides[j];
                }
                offsets[${Ts-1}] = offset;

                isPad = false;
                for (var j = ${ts-Ts}u; j < ${ts}u; j++) {
                  xIndices[j] = indices[j] * strides[j - ${ts-Ts}u]
                    + offsets[j - ${ts-Ts}u] - pads[j - 2u];
                  ${xs}
              }
              ${Zr}

              output[global_idx] = value;
            }`}},Gr=Vr=>({format:Vr.format,autoPad:["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][Vr.auto_pad],ceilMode:Vr.ceil_mode,kernelShape:Vr.kernel_shape,strides:Vr.strides,pads:Vr.pads}),Nr=(Vr,Wr,qr,Kr)=>{const[Xr,Zr]=zr(Vr,Kr,qr),_i=Rr.ShapeUtil.size(Xr.kernelShape),Jr="f32";let es="";return Xr.countIncludePad?es+=`value /= ${Jr}(${_i});`:es+=`value /= ${Jr}(${_i} - pad);`,Object.assign(Object.assign({},Wr),{outputs:[{dims:Zr,dataType:Vr[0].dataType,gpuDataType:Dr.GpuDataType.default}],getShaderSource:ts=>jr(ts,Vr[0].dims,Zr,Xr,"value += x_val;",es,Jr,"0.0"),dispatchGroup:()=>({x:Math.ceil(Rr.ShapeUtil.size(Zr)/64)})})};Tr.parseAveragePoolAttributes=Vr=>{const Wr=Vr.count_include_pad!==0,qr=Gr(Vr);if(qr.ceilMode!==0)throw new Error("using ceil() in shape computation is not yet supported for AveragePool");return(0,Pr.createAttributeWithCacheKey)(Object.assign({countIncludePad:Wr},qr))},Tr.averagePool=(Vr,Wr)=>{Fr(Vr.inputs);const qr={name:"AveragePool",inputTypes:[Dr.GpuDataType.default],cacheHint:Wr.cacheKey};Vr.compute(Object.assign(Object.assign({},qr),{get:()=>Nr(Vr.inputs,qr,!1,Wr)}))};const Lr={autoPad:"",ceilMode:0,countIncludePad:!1,kernelShape:[],strides:[],pads:[],storageOrder:0,dilations:[],cacheKey:""};Tr.parseGlobalAveragePoolAttributes=Vr=>{const Wr=Vr.format;return Object.assign(Object.assign({format:Wr},Lr),{cacheKey:Wr})},Tr.globalAveragePool=(Vr,Wr)=>{Fr(Vr.inputs);const qr={name:"GlobalAveragePool",inputTypes:[Dr.GpuDataType.default],cacheHint:Wr.cacheKey};Vr.compute(Object.assign(Object.assign({},qr),{get:()=>Nr(Vr.inputs,qr,!0,Wr)}))};const Ur=(Vr,Wr,qr,Kr)=>{const[Xr,Zr]=zr(Vr,Kr,qr);return Object.assign(Object.assign({},Wr),{outputs:[{dims:Zr,dataType:Vr[0].dataType,gpuDataType:Dr.GpuDataType.default}],getShaderSource:_i=>jr(_i,Vr[0].dims,Zr,Xr,`
      value = max(x_val, value);
    `,"","f32","-1e5"),dispatchGroup:()=>({x:Math.ceil(Rr.ShapeUtil.size(Zr)/64)})})};Tr.maxPool=(Vr,Wr)=>{Fr(Vr.inputs);const qr={name:"MaxPool",inputTypes:[Dr.GpuDataType.default],cacheHint:Wr.cacheKey};Vr.compute(Object.assign(Object.assign({},qr),{get:()=>Ur(Vr.inputs,qr,!1,Wr)}))},Tr.parseMaxPoolAttributes=Vr=>{const Wr=Vr.storage_order,qr=Vr.dilations,Kr=Gr(Vr);if(Wr!==0)throw new Error("column major storage order is not yet supported for MaxPool");if(Kr.ceilMode!==0)throw new Error("using ceil() in shape computation is not yet supported for MaxPool");return(0,Pr.createAttributeWithCacheKey)(Object.assign({storageOrder:Wr,dilations:qr},Kr))},Tr.parseGlobalMaxPoolAttributes=Vr=>{const Wr=Vr.format;return Object.assign(Object.assign({format:Wr},Lr),{cacheKey:Wr})},Tr.globalMaxPool=(Vr,Wr)=>{Fr(Vr.inputs);const qr={name:"GlobalMaxPool",inputTypes:[Dr.GpuDataType.default],cacheHint:Wr.cacheKey};Vr.compute(Object.assign(Object.assign({},qr),{get:()=>Ur(Vr.inputs,qr,!0,Wr)}))}},2625:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.parseTransposeAttributes=Tr.transpose=Tr.createTransposeProgramInfo=Tr.transposeProgramMetadata=void 0;const Rr=Ar(6952),Pr=Ar(387),Dr=Ar(1163),Mr=Ar(2075);Tr.transposeProgramMetadata={name:"Transpose",inputTypes:[Dr.GpuDataType.default]};const Fr=(zr,jr)=>jr&&jr.length!==zr.length?[...zr.keys()].reverse():jr;Tr.createTransposeProgramInfo=(zr,jr)=>{const Gr=zr.dims,Nr=Fr(Gr,jr),Lr=((Kr,Xr)=>Rr.ShapeUtil.sortBasedOnPerm(Kr,Fr(Kr,Xr)))(Gr,Nr),Ur=Gr.length,Vr=Rr.ShapeUtil.size(Lr),Wr=(0,Mr.createIndicesHelper)("output",Lr),qr=(0,Mr.createIndicesHelper)("a",Gr);return Object.assign(Object.assign({},Tr.transposeProgramMetadata),{outputs:[{dims:Lr,dataType:zr.dataType,gpuDataType:Dr.GpuDataType.default}],getShaderSource:Kr=>`
  @group(0) @binding(0) var<storage, read> a : array<f32>;
  @group(0) @binding(1) var<storage, read_write> output : array<f32>;

  ${((Xr,Zr)=>{const _i=[];_i.push(`fn perm(a: ptr<function, array<u32, ${Zr}>>, i: ptr<function, array<u32, ${Zr}>>) {`);for(let Jr=0;Jr<Zr;++Jr)_i.push(`	(*a)[${Xr[Jr]}]=(*i)[${Jr}];`);return _i.push("	}"),_i.join(`
`)})(Nr,Ur)}
  ${Wr.o2iImpl}
  ${qr.i2oImpl}

  ${Kr.mainStart()}
    ${Kr.guardAgainstOutOfBoundsWorkgroupSizes(Vr)}

    ${Wr.indicesVariableDeclaration("indices")}
    ${Wr.o2iCall("global_idx","indices")}
    ${qr.indicesVariableDeclaration("aIndices")}
    perm(&aIndices, &indices);

    output[global_idx] = a[${qr.i2oExpression("aIndices")}];
  }`,dispatchGroup:()=>({x:Math.ceil(Vr/64)})})},Tr.transpose=(zr,jr)=>{(Gr=>{if(!Gr||Gr.length!==1)throw new Error("Transpose requires 1 input.");if(Gr[0].dataType!==1)throw new Error("input should be float tensor")})(zr.inputs),zr.compute(Object.assign(Object.assign({},Tr.transposeProgramMetadata),{cacheHint:jr.cacheKey,get:()=>(0,Tr.createTransposeProgramInfo)(zr.inputs[0],jr.perm)}))},Tr.parseTransposeAttributes=zr=>(0,Pr.createAttributeWithCacheKey)({perm:zr.perm})},9302:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.thresholdedRelu=Tr.tanh=Tr.tan=Tr.sqrt=Tr.sinh=Tr.sin=Tr.sigmoid=Tr.relu=Tr.reciprocal=Tr.neg=Tr.leakyRelu=Tr.floor=Tr.exp=Tr.erf=Tr.elu=Tr.parseAlphaAttributes=Tr.cosh=Tr.cos=Tr.ceil=Tr.clip=Tr.clipV10=Tr.atanh=Tr.atan=Tr.asinh=Tr.asin=Tr.acosh=Tr.acos=Tr.abs=void 0;const Rr=Ar(6952),Pr=Ar(387),Dr=Ar(1163),Mr=(Fr,zr,jr,Gr,Nr)=>{const Lr={name:zr,inputTypes:[Dr.GpuDataType.default],cacheHint:Nr};return Object.assign(Object.assign({},Lr),{get:()=>((Ur,Vr,Wr,qr)=>Object.assign(Object.assign({},Ur),{getShaderSource:Kr=>((Xr,Zr,_i,Jr)=>{const es=Math.ceil(Zr/4);let ts="";return ts=typeof _i=="string"?`${_i}(a)`:_i("a"),`
  @group(0) @binding(0) var<storage, read> inputData : array<vec4<f32>>;
  @group(0) @binding(1) var<storage, read_write> outputData : array<vec4<f32>>;

  ${Jr??""}

  ${Xr.mainStart()}
    ${Xr.guardAgainstOutOfBoundsWorkgroupSizes(es)}

    let a = inputData[global_idx];
    outputData[global_idx] = ${ts};
  }`})(Kr,Rr.ShapeUtil.size(Vr.dims),Wr,qr),outputs:[{dims:Vr.dims,dataType:Vr.dataType,gpuDataType:Dr.GpuDataType.default}],dispatchGroup:Kr=>({x:Math.ceil(Rr.ShapeUtil.size(Kr[0].dims)/64/4)})}))(Lr,Fr,jr,Gr)})};Tr.abs=Fr=>{Fr.compute(Mr(Fr.inputs[0],"Abs","abs"))},Tr.acos=Fr=>{Fr.compute(Mr(Fr.inputs[0],"Acos","acos"))},Tr.acosh=Fr=>{Fr.compute(Mr(Fr.inputs[0],"Acosh","acosh"))},Tr.asin=Fr=>{Fr.compute(Mr(Fr.inputs[0],"Asin","asin"))},Tr.asinh=Fr=>{Fr.compute(Mr(Fr.inputs[0],"Asinh","asinh"))},Tr.atan=Fr=>{Fr.compute(Mr(Fr.inputs[0],"Atan","atan"))},Tr.atanh=Fr=>{Fr.compute(Mr(Fr.inputs[0],"Atanh","atanh"))},Tr.clipV10=(Fr,zr)=>{Fr.compute(Mr(Fr.inputs[0],"Clip",jr=>`clamp(${jr}, clip_min_, clip_max_)`,`
    const clip_min_: vec4<f32> = vec4(f32(${zr.min}));
    const clip_max_: vec4<f32> = vec4(f32(${zr.max}));
`,zr.cacheKey),{inputs:[0]})},Tr.clip=Fr=>{const zr=(jr=>{const Gr=jr.length>=2?jr[1].getFloat32Array()[0]:Rr.MIN_CLIP,Nr=jr.length>=3?jr[2].getFloat32Array()[0]:Rr.MAX_CLIP;return(0,Pr.createAttributeWithCacheKey)({min:Gr,max:Nr})})(Fr.inputs);(0,Tr.clipV10)(Fr,zr)},Tr.ceil=Fr=>{Fr.compute(Mr(Fr.inputs[0],"Ceil","ceil"))},Tr.cos=Fr=>{Fr.compute(Mr(Fr.inputs[0],"Cos","cos"))},Tr.cosh=Fr=>{Fr.compute(Mr(Fr.inputs[0],"Cosh","cosh"))},Tr.parseAlphaAttributes=Fr=>(0,Pr.createAttributeWithCacheKey)(Fr),Tr.elu=(Fr,zr)=>{Fr.compute(Mr(Fr.inputs[0],"Elu",jr=>`elu_vf32(${jr})`,`
  const elu_alpha_: f32 = f32(${zr.alpha});

  fn elu_f32(a: f32) -> f32 {
  return select((exp(a) - 1.0) * elu_alpha_, a, a >= 0.0);
  }

  fn elu_vf32(v: vec4<f32>) -> vec4<f32> {
  return vec4(elu_f32(v.x), elu_f32(v.y), elu_f32(v.z), elu_f32(v.w));
  }`,zr.cacheKey))},Tr.erf=Fr=>{Fr.compute(Mr(Fr.inputs[0],"Erf",zr=>`erf_vf32(${zr})`,`
  const r0: f32 = 0.3275911;
  const r1: f32 = 0.254829592;
  const r2: f32 = -0.284496736;
  const r3: f32 = 1.421413741;
  const r4: f32 = -1.453152027;
  const r5: f32 = 1.061405429;

  fn erf_vf32(v: vec4<f32>) -> vec4<f32> {
    let absv = abs(v);
    let x = 1.0 / (1.0 + r0 * absv);
    return sign(v) * (1.0 - ((((r5 * x + r4) * x + r3) * x + r2) * x + r1) * x * exp(-absv * absv));
  }`))},Tr.exp=Fr=>{Fr.compute(Mr(Fr.inputs[0],"Exp","exp"))},Tr.floor=Fr=>{Fr.compute(Mr(Fr.inputs[0],"Floor","floor"))},Tr.leakyRelu=(Fr,zr)=>{Fr.compute(Mr(Fr.inputs[0],"LeakyRelu",jr=>`select(leaky_relu_alpha_ * ${jr}, ${jr}, ${jr} >= vec4<f32>(0.0))`,`const leaky_relu_alpha_: f32 = f32(${zr.alpha});`,zr.cacheKey))},Tr.neg=Fr=>{Fr.compute(Mr(Fr.inputs[0],"Neg",zr=>`-${zr}`))},Tr.reciprocal=Fr=>{Fr.compute(Mr(Fr.inputs[0],"Reciprocal",zr=>`1.0/${zr}`))},Tr.relu=Fr=>{Fr.compute(Mr(Fr.inputs[0],"Relu",zr=>`select(vec4<f32>(0.0), ${zr}, ${zr} > vec4<f32>(0.0))`))},Tr.sigmoid=Fr=>{Fr.compute(Mr(Fr.inputs[0],"Sigmoid",zr=>`(1.0 / (1.0 + exp(-${zr})))`))},Tr.sin=Fr=>{Fr.compute(Mr(Fr.inputs[0],"Sin","sin"))},Tr.sinh=Fr=>{Fr.compute(Mr(Fr.inputs[0],"Sinh","sinh"))},Tr.sqrt=Fr=>{Fr.compute(Mr(Fr.inputs[0],"Sqrt","sqrt"))},Tr.tan=Fr=>{Fr.compute(Mr(Fr.inputs[0],"Tan","tan"))},Tr.tanh=Fr=>{Fr.compute(Mr(Fr.inputs[0],"Tanh","tanh"))},Tr.thresholdedRelu=(Fr,zr)=>(Fr.compute(Mr(Fr.inputs[0],"ThresholdedRelu",jr=>`select(vec4<f32>(0.0), ${jr}, ${jr} > thresholded_relu_alpha_)`,`const thresholded_relu_alpha_: vec4<f32> = vec4<f32>(${zr.alpha});`,zr.cacheKey)),0)},8305:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.ProgramManager=void 0;const Rr=Ar(4955),Pr=Ar(2075);Tr.ProgramManager=class{constructor(Dr){this.backend=Dr,this.repo=new Map,this.attributesBound=!1}getArtifact(Dr){return this.repo.get(Dr)}setArtifact(Dr,Mr){this.repo.set(Dr,Mr)}run(Dr,Mr,Fr,zr){const jr=this.backend.device,Gr=this.backend.getComputePassEncoder();this.backend.profilingEnabled&&Gr.writeTimestamp(this.backend.profilingQuerySet,0),Gr.setPipeline(Dr.computePipeline);const Nr=[];for(const Ur of Mr)Nr.push({binding:Nr.length,resource:{buffer:Ur.buffer}});for(const Ur of Fr)Nr.push({binding:Nr.length,resource:{buffer:Ur.buffer}});const Lr=jr.createBindGroup({layout:Dr.computePipeline.getBindGroupLayout(0),entries:Nr});if(Gr.setBindGroup(0,Lr),Gr.dispatchWorkgroups(...zr),this.backend.pendingDispatchNumber++,this.backend.profilingEnabled){Gr.writeTimestamp(this.backend.profilingQuerySet,1);const Ur=this.backend.gpuDataManager.create(16,GPUBufferUsage.COPY_SRC|GPUBufferUsage.QUERY_RESOLVE),Vr=this.backend.gpuDataManager.create(16,GPUBufferUsage.MAP_READ|GPUBufferUsage.COPY_DST);this.backend.endComputePass(),this.backend.getCommandEncoder().resolveQuerySet(this.backend.profilingQuerySet,0,2,Ur.buffer,0),this.backend.getCommandEncoder().copyBufferToBuffer(Ur.buffer,0,Vr.buffer,0,16),this.backend.flush();const Wr=this.backend.currentKernelId,qr=this.backend.kernels.get(Wr)[0];Vr.buffer.mapAsync(GPUMapMode.READ).then(()=>{const Kr=new BigUint64Array(Vr.buffer.getMappedRange()),Xr=Kr[0],Zr=Kr[1];Vr.buffer.unmap(),this.backend.profilingTimeBase===void 0&&(this.backend.profilingTimeBase=Xr);const _i=Number(Xr-this.backend.profilingTimeBase),Jr=Number(Zr-this.backend.profilingTimeBase);if(!Number.isSafeInteger(_i)||!Number.isSafeInteger(Jr))throw new RangeError("incorrect timestamp range");this.backend.gpuDataManager.release(Ur.id),this.backend.gpuDataManager.release(Vr.id),console.log(`[profiling] kernel "${Wr}|${qr}" execution time: ${Jr-_i} ns`)})}this.backend.pendingDispatchNumber>=16&&this.backend.flush()}dispose(){}build(Dr,Mr){const Fr=this.backend.device,zr=Dr.getShaderSource((0,Pr.createShaderHelper)(Mr)),jr=Fr.createShaderModule({code:zr});return(0,Rr.LOG_DEBUG)("verbose",()=>`[WebGPU] shader code: ${zr}`),{programInfo:Dr,computePipeline:Fr.createComputePipeline({compute:{module:jr,entryPoint:"main"},layout:"auto"})}}normalizeDispatchGroupSize(Dr){const Mr=typeof Dr=="number"?Dr:Dr.x,Fr=typeof Dr=="number"?1:Dr.y||1,zr=typeof Dr=="number"?1:Dr.z||1,jr=this.backend.device.limits.maxComputeWorkgroupsPerDimension;if(Mr<=jr&&Fr<=jr&&zr<=jr)return[Mr,Fr,zr];const Gr=Mr*Fr*zr;let Nr=Math.ceil(Math.sqrt(Gr));if(Nr>jr){if(Nr=Math.ceil(Math.cbrt(Gr)),Nr>jr)throw new Error("Total dispatch size exceeds WebGPU maximum.");return[Nr,Nr,Nr]}return[Nr,Nr,1]}}},1163:(_r,Tr)=>{var Ar;Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.GpuDataType=void 0,(Ar=Tr.GpuDataType||(Tr.GpuDataType={}))[Ar.default=0]="default",Ar[Ar.upload=1]="upload",Ar[Ar.profile=2]="profile"},3899:(_r,Tr)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.iterateExtraOptions=void 0,Tr.iterateExtraOptions=(Ar,Rr,Pr,Dr)=>{if(typeof Ar=="object"&&Ar!==null){if(Pr.has(Ar))throw new Error("Circular reference in options");Pr.add(Ar)}Object.entries(Ar).forEach(([Mr,Fr])=>{const zr=Rr?Rr+Mr:Mr;if(typeof Fr=="object")(0,Tr.iterateExtraOptions)(Fr,zr+".",Pr,Dr);else if(typeof Fr=="string"||typeof Fr=="number")Dr(zr,Fr.toString());else{if(typeof Fr!="boolean")throw new Error("Can't handle extra config type: "+typeof Fr);Dr(zr,Fr?"1":"0")}})}},9544:function(_r,Tr,Ar){var Rr,Pr=this&&this.__createBinding||(Object.create?function(ls,fs,Ts,$s){$s===void 0&&($s=Ts);var xs=Object.getOwnPropertyDescriptor(fs,Ts);xs&&!("get"in xs?!fs.__esModule:xs.writable||xs.configurable)||(xs={enumerable:!0,get:function(){return fs[Ts]}}),Object.defineProperty(ls,$s,xs)}:function(ls,fs,Ts,$s){$s===void 0&&($s=Ts),ls[$s]=fs[Ts]}),Dr=this&&this.__setModuleDefault||(Object.create?function(ls,fs){Object.defineProperty(ls,"default",{enumerable:!0,value:fs})}:function(ls,fs){ls.default=fs}),Mr=this&&this.__importStar||function(ls){if(ls&&ls.__esModule)return ls;var fs={};if(ls!=null)for(var Ts in ls)Ts!=="default"&&Object.prototype.hasOwnProperty.call(ls,Ts)&&Pr(fs,ls,Ts);return Dr(fs,ls),fs};Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.endProfiling=Tr.run=Tr.releaseSession=Tr.createSession=Tr.createSessionFinalize=Tr.createSessionAllocate=Tr.initOrt=Tr.initWasm=void 0;const Fr=Ar(8453),zr=Ar(7675),jr=Mr(Ar(1259)),Gr=Ar(263),Nr=()=>!!Fr.env.wasm.proxy&&typeof document<"u";let Lr,Ur,Vr,Wr=!1,qr=!1,Kr=!1;const Xr=[],Zr=[],_i=[],Jr=[],es=[],ts=[],is=()=>{if(Wr||!qr||Kr||!Lr)throw new Error("worker not ready")},rs=ls=>{switch(ls.data.type){case"init-wasm":Wr=!1,ls.data.err?(Kr=!0,Ur[1](ls.data.err)):(qr=!0,Ur[0]());break;case"init-ort":ls.data.err?Vr[1](ls.data.err):Vr[0]();break;case"create_allocate":ls.data.err?Xr.shift()[1](ls.data.err):Xr.shift()[0](ls.data.out);break;case"create_finalize":ls.data.err?Zr.shift()[1](ls.data.err):Zr.shift()[0](ls.data.out);break;case"create":ls.data.err?_i.shift()[1](ls.data.err):_i.shift()[0](ls.data.out);break;case"release":ls.data.err?Jr.shift()[1](ls.data.err):Jr.shift()[0]();break;case"run":ls.data.err?es.shift()[1](ls.data.err):es.shift()[0](ls.data.out);break;case"end-profiling":ls.data.err?ts.shift()[1](ls.data.err):ts.shift()[0]()}},as=typeof document<"u"?(Rr=document==null?void 0:document.currentScript)===null||Rr===void 0?void 0:Rr.src:void 0;Tr.initWasm=async()=>{if(Nr()){if(qr)return;if(Wr)throw new Error("multiple calls to 'initWasm()' detected.");if(Kr)throw new Error("previous call to 'initWasm()' failed.");return Wr=!0,Fr.env.wasm.wasmPaths===void 0&&as&&as.indexOf("blob:")!==0&&(Fr.env.wasm.wasmPaths=as.substr(0,+as.lastIndexOf("/")+1)),new Promise((ls,fs)=>{Lr==null||Lr.terminate(),Lr=Ar(8050).Z(),Lr.onmessage=rs,Ur=[ls,fs];const Ts={type:"init-wasm",in:Fr.env.wasm};Lr.postMessage(Ts)})}return(0,Gr.initializeWebAssembly)(Fr.env.wasm)},Tr.initOrt=async(ls,fs)=>{if(Nr())return is(),new Promise((Ts,$s)=>{Vr=[Ts,$s];const xs={type:"init-ort",in:{numThreads:ls,loggingLevel:fs}};Lr.postMessage(xs)});jr.initOrt(ls,fs),await(0,zr.init)((0,Gr.getInstance)())},Tr.createSessionAllocate=async ls=>Nr()?(is(),new Promise((fs,Ts)=>{Xr.push([fs,Ts]);const $s={type:"create_allocate",in:{model:ls}};Lr.postMessage($s,[ls.buffer])})):jr.createSessionAllocate(ls),Tr.createSessionFinalize=async(ls,fs)=>Nr()?(is(),new Promise((Ts,$s)=>{Zr.push([Ts,$s]);const xs={type:"create_finalize",in:{modeldata:ls,options:fs}};Lr.postMessage(xs)})):jr.createSessionFinalize(ls,fs),Tr.createSession=async(ls,fs)=>Nr()?(is(),new Promise((Ts,$s)=>{_i.push([Ts,$s]);const xs={type:"create",in:{model:ls,options:fs}};Lr.postMessage(xs,[ls.buffer])})):jr.createSession(ls,fs),Tr.releaseSession=async ls=>{if(Nr())return is(),new Promise((fs,Ts)=>{Jr.push([fs,Ts]);const $s={type:"release",in:ls};Lr.postMessage($s)});jr.releaseSession(ls)},Tr.run=async(ls,fs,Ts,$s,xs)=>Nr()?(is(),new Promise((ys,ps)=>{es.push([ys,ps]);const vs={type:"run",in:{sessionId:ls,inputIndices:fs,inputs:Ts,outputIndices:$s,options:xs}};Lr.postMessage(vs,jr.extractTransferableBuffers(Ts))})):jr.run(ls,fs,Ts,$s,xs),Tr.endProfiling=async ls=>{if(Nr())return is(),new Promise((fs,Ts)=>{ts.push([fs,Ts]);const $s={type:"end-profiling",in:ls};Lr.postMessage($s)});jr.endProfiling(ls)}},7918:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.setRunOptions=void 0;const Rr=Ar(3899),Pr=Ar(9444),Dr=Ar(263);Tr.setRunOptions=Mr=>{const Fr=(0,Dr.getInstance)();let zr=0;const jr=[],Gr=Mr||{};try{if((Mr==null?void 0:Mr.logSeverityLevel)===void 0)Gr.logSeverityLevel=2;else if(typeof Mr.logSeverityLevel!="number"||!Number.isInteger(Mr.logSeverityLevel)||Mr.logSeverityLevel<0||Mr.logSeverityLevel>4)throw new Error(`log serverity level is not valid: ${Mr.logSeverityLevel}`);if((Mr==null?void 0:Mr.logVerbosityLevel)===void 0)Gr.logVerbosityLevel=0;else if(typeof Mr.logVerbosityLevel!="number"||!Number.isInteger(Mr.logVerbosityLevel))throw new Error(`log verbosity level is not valid: ${Mr.logVerbosityLevel}`);(Mr==null?void 0:Mr.terminate)===void 0&&(Gr.terminate=!1);let Nr=0;if((Mr==null?void 0:Mr.tag)!==void 0&&(Nr=(0,Pr.allocWasmString)(Mr.tag,jr)),zr=Fr._OrtCreateRunOptions(Gr.logSeverityLevel,Gr.logVerbosityLevel,!!Gr.terminate,Nr),zr===0)throw new Error("Can't create run options");return(Mr==null?void 0:Mr.extra)!==void 0&&(0,Rr.iterateExtraOptions)(Mr.extra,"",new WeakSet,(Lr,Ur)=>{const Vr=(0,Pr.allocWasmString)(Lr,jr),Wr=(0,Pr.allocWasmString)(Ur,jr);if(Fr._OrtAddRunConfigEntry(zr,Vr,Wr)!==0)throw new Error(`Can't set a run config entry: ${Lr} - ${Ur}`)}),[zr,jr]}catch(Nr){throw zr!==0&&Fr._OrtReleaseRunOptions(zr),jr.forEach(Fr._free),Nr}}},6640:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.OnnxruntimeWebAssemblySessionHandler=void 0;const Rr=Ar(2806),Pr=Ar(8453),Dr=Ar(2850),Mr=Ar(9544),Fr=Ar(7917);let zr;Tr.OnnxruntimeWebAssemblySessionHandler=class{async createSessionAllocate(jr){const Gr=await fetch(jr),Nr=await Gr.arrayBuffer();return(0,Mr.createSessionAllocate)(new Uint8Array(Nr))}async loadModel(jr,Gr){if(zr||(await(0,Mr.initOrt)(Pr.env.wasm.numThreads,(0,Fr.logLevelStringToEnum)(Pr.env.logLevel)),zr=!0),typeof jr=="string")if(typeof fetch>"u"){const Nr=await(0,Dr.promisify)(Rr.readFile)(jr);[this.sessionId,this.inputNames,this.outputNames]=await(0,Mr.createSession)(Nr,Gr)}else{const Nr=await this.createSessionAllocate(jr);[this.sessionId,this.inputNames,this.outputNames]=await(0,Mr.createSessionFinalize)(Nr,Gr)}else[this.sessionId,this.inputNames,this.outputNames]=await(0,Mr.createSession)(jr,Gr)}async dispose(){return(0,Mr.releaseSession)(this.sessionId)}async run(jr,Gr,Nr){const Lr=[],Ur=[];Object.entries(jr).forEach(Kr=>{const Xr=Kr[0],Zr=Kr[1],_i=this.inputNames.indexOf(Xr);if(_i===-1)throw new Error(`invalid input '${Xr}'`);Lr.push(Zr),Ur.push(_i)});const Vr=[];Object.entries(Gr).forEach(Kr=>{const Xr=Kr[0],Zr=this.outputNames.indexOf(Xr);if(Zr===-1)throw new Error(`invalid output '${Xr}'`);Vr.push(Zr)});const Wr=await(0,Mr.run)(this.sessionId,Ur,Lr.map(Kr=>[Kr.type,Kr.dims,Kr.data]),Vr,Nr),qr={};for(let Kr=0;Kr<Wr.length;Kr++)qr[this.outputNames[Vr[Kr]]]=new Pr.Tensor(Wr[Kr][0],Wr[Kr][2],Wr[Kr][1]);return qr}startProfiling(){}endProfiling(){(0,Mr.endProfiling)(this.sessionId)}}},7622:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.setSessionOptions=void 0;const Rr=Ar(3899),Pr=Ar(9444),Dr=Ar(263);Tr.setSessionOptions=Mr=>{var Fr,zr,jr,Gr;const Nr=(0,Dr.getInstance)();let Lr=0;const Ur=[],Vr=Mr||{};(Wr=>{Wr.extra||(Wr.extra={}),Wr.extra.session||(Wr.extra.session={});const qr=Wr.extra.session;qr.use_ort_model_bytes_directly||(qr.use_ort_model_bytes_directly="1"),Wr.executionProviders&&Wr.executionProviders.some(Kr=>(typeof Kr=="string"?Kr:Kr.name)==="webgpu")&&(Wr.enableMemPattern=!1)})(Vr);try{const Wr=(Jr=>{switch(Jr){case"disabled":return 0;case"basic":return 1;case"extended":return 2;case"all":return 99;default:throw new Error(`unsupported graph optimization level: ${Jr}`)}})((Fr=Vr.graphOptimizationLevel)!==null&&Fr!==void 0?Fr:"all"),qr=(Jr=>{switch(Jr){case"sequential":return 0;case"parallel":return 1;default:throw new Error(`unsupported execution mode: ${Jr}`)}})((zr=Vr.executionMode)!==null&&zr!==void 0?zr:"sequential"),Kr=typeof Vr.logId=="string"?(0,Pr.allocWasmString)(Vr.logId,Ur):0,Xr=(jr=Vr.logSeverityLevel)!==null&&jr!==void 0?jr:2;if(!Number.isInteger(Xr)||Xr<0||Xr>4)throw new Error(`log serverity level is not valid: ${Xr}`);const Zr=(Gr=Vr.logVerbosityLevel)!==null&&Gr!==void 0?Gr:0;if(!Number.isInteger(Zr)||Zr<0||Zr>4)throw new Error(`log verbosity level is not valid: ${Zr}`);const _i=typeof Vr.optimizedModelFilePath=="string"?(0,Pr.allocWasmString)(Vr.optimizedModelFilePath,Ur):0;if(Lr=Nr._OrtCreateSessionOptions(Wr,!!Vr.enableCpuMemArena,!!Vr.enableMemPattern,qr,!!Vr.enableProfiling,0,Kr,Xr,Zr,_i),Lr===0)throw new Error("Can't create session options");return Vr.executionProviders&&((Jr,es,ts)=>{for(const is of es){let rs=typeof is=="string"?is:is.name;switch(rs){case"xnnpack":rs="XNNPACK";break;case"webgpu":rs="JS";break;case"wasm":case"cpu":continue;default:throw new Error(`not supported EP: ${rs}`)}const as=(0,Pr.allocWasmString)(rs,ts);if((0,Dr.getInstance)()._OrtAppendExecutionProvider(Jr,as)!==0)throw new Error(`Can't append execution provider: ${rs}`)}})(Lr,Vr.executionProviders,Ur),Vr.extra!==void 0&&(0,Rr.iterateExtraOptions)(Vr.extra,"",new WeakSet,(Jr,es)=>{const ts=(0,Pr.allocWasmString)(Jr,Ur),is=(0,Pr.allocWasmString)(es,Ur);if(Nr._OrtAddSessionConfigEntry(Lr,ts,is)!==0)throw new Error(`Can't set a session config entry: ${Jr} - ${es}`)}),[Lr,Ur]}catch(Wr){throw Lr!==0&&Nr._OrtReleaseSessionOptions(Lr),Ur.forEach(Nr._free),Wr}}},9444:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.allocWasmString=void 0;const Rr=Ar(263);Tr.allocWasmString=(Pr,Dr)=>{const Mr=(0,Rr.getInstance)(),Fr=Mr.lengthBytesUTF8(Pr)+1,zr=Mr._malloc(Fr);return Mr.stringToUTF8(Pr,zr,Fr),Dr.push(zr),zr}},7917:(_r,Tr)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.logLevelStringToEnum=Tr.tensorTypeToTypedArrayConstructor=Tr.getTensorElementSize=Tr.tensorDataTypeEnumToString=Tr.tensorDataTypeStringToEnum=void 0,Tr.tensorDataTypeStringToEnum=Ar=>{switch(Ar){case"int8":return 3;case"uint8":return 2;case"bool":return 9;case"int16":return 5;case"uint16":return 4;case"int32":return 6;case"uint32":return 12;case"float32":return 1;case"float64":return 11;case"string":return 8;case"int64":return 7;case"uint64":return 13;default:throw new Error(`unsupported data type: ${Ar}`)}},Tr.tensorDataTypeEnumToString=Ar=>{switch(Ar){case 3:return"int8";case 2:return"uint8";case 9:return"bool";case 5:return"int16";case 4:return"uint16";case 6:return"int32";case 12:return"uint32";case 1:return"float32";case 11:return"float64";case 8:return"string";case 7:return"int64";case 13:return"uint64";default:throw new Error(`unsupported data type: ${Ar}`)}},Tr.getTensorElementSize=Ar=>[void 0,4,1,1,2,2,4,8,void 0,1,2,8,4,8,void 0,void 0,void 0][Ar],Tr.tensorTypeToTypedArrayConstructor=Ar=>{switch(Ar){case"float32":return Float32Array;case"uint8":case"bool":return Uint8Array;case"int8":return Int8Array;case"uint16":return Uint16Array;case"int16":return Int16Array;case"int32":return Int32Array;case"float64":return Float64Array;case"uint32":return Uint32Array;case"int64":return BigInt64Array;case"uint64":return BigUint64Array;default:throw new Error(`unsupported type: ${Ar}`)}},Tr.logLevelStringToEnum=Ar=>{switch(Ar){case"verbose":return 0;case"info":return 1;case"warning":return 2;case"error":return 3;case"fatal":return 4;default:throw new Error(`unsupported logging level: ${Ar}`)}}},1259:(_r,Tr,Ar)=>{Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.extractTransferableBuffers=Tr.endProfiling=Tr.run=Tr.releaseSession=Tr.createSession=Tr.createSessionFinalize=Tr.createSessionAllocate=Tr.initOrt=void 0;const Rr=Ar(7918),Pr=Ar(7622),Dr=Ar(9444),Mr=Ar(7917),Fr=Ar(263);Tr.initOrt=(jr,Gr)=>{const Nr=(0,Fr.getInstance)()._OrtInit(jr,Gr);if(Nr!==0)throw new Error(`Can't initialize onnxruntime. error code = ${Nr}`)};const zr=new Map;Tr.createSessionAllocate=jr=>{const Gr=(0,Fr.getInstance)(),Nr=Gr._malloc(jr.byteLength);return Gr.HEAPU8.set(jr,Nr),[Nr,jr.byteLength]},Tr.createSessionFinalize=(jr,Gr)=>{const Nr=(0,Fr.getInstance)();let Lr=0,Ur=0,Vr=[];try{if([Ur,Vr]=(0,Pr.setSessionOptions)(Gr),Lr=Nr._OrtCreateSession(jr[0],jr[1],Ur),Lr===0)throw new Error("Can't create a session")}finally{Nr._free(jr[0]),Ur!==0&&Nr._OrtReleaseSessionOptions(Ur),Vr.forEach(Nr._free)}const Wr=Nr._OrtGetInputCount(Lr),qr=Nr._OrtGetOutputCount(Lr),Kr=[],Xr=[],Zr=[],_i=[];for(let Jr=0;Jr<Wr;Jr++){const es=Nr._OrtGetInputName(Lr,Jr);if(es===0)throw new Error("Can't get an input name");Xr.push(es),Kr.push(Nr.UTF8ToString(es))}for(let Jr=0;Jr<qr;Jr++){const es=Nr._OrtGetOutputName(Lr,Jr);if(es===0)throw new Error("Can't get an output name");_i.push(es),Zr.push(Nr.UTF8ToString(es))}return zr.set(Lr,[Lr,Xr,_i]),[Lr,Kr,Zr]},Tr.createSession=(jr,Gr)=>{const Nr=(0,Tr.createSessionAllocate)(jr);return(0,Tr.createSessionFinalize)(Nr,Gr)},Tr.releaseSession=jr=>{const Gr=(0,Fr.getInstance)(),Nr=zr.get(jr);if(!Nr)throw new Error("invalid session id");const Lr=Nr[0],Ur=Nr[1],Vr=Nr[2];Ur.forEach(Gr._OrtFree),Vr.forEach(Gr._OrtFree),Gr._OrtReleaseSession(Lr),zr.delete(jr)},Tr.run=async(jr,Gr,Nr,Lr,Ur)=>{const Vr=(0,Fr.getInstance)(),Wr=zr.get(jr);if(!Wr)throw new Error("invalid session id");const qr=Wr[0],Kr=Wr[1],Xr=Wr[2],Zr=Gr.length,_i=Lr.length;let Jr=0,es=[];const ts=[],is=[];try{[Jr,es]=(0,Rr.setRunOptions)(Ur);for(let $s=0;$s<Zr;$s++){const xs=Nr[$s][0],ys=Nr[$s][1],ps=Nr[$s][2];let vs,Ds;if(Array.isArray(ps)){Ds=4*ps.length,vs=Vr._malloc(Ds),is.push(vs);let qs=vs/4;for(let fo=0;fo<ps.length;fo++){if(typeof ps[fo]!="string")throw new TypeError(`tensor data at index ${fo} is not a string`);Vr.HEAPU32[qs++]=(0,Dr.allocWasmString)(ps[fo],is)}}else Ds=ps.byteLength,vs=Vr._malloc(Ds),is.push(vs),Vr.HEAPU8.set(new Uint8Array(ps.buffer,ps.byteOffset,Ds),vs);const js=Vr.stackSave(),zs=Vr.stackAlloc(4*ys.length);try{let qs=zs/4;ys.forEach(Qs=>Vr.HEAP32[qs++]=Qs);const fo=Vr._OrtCreateTensor((0,Mr.tensorDataTypeStringToEnum)(xs),vs,Ds,zs,ys.length);if(fo===0)throw new Error("Can't create a tensor");ts.push(fo)}finally{Vr.stackRestore(js)}}const rs=Vr.stackSave(),as=Vr.stackAlloc(4*Zr),ls=Vr.stackAlloc(4*Zr),fs=Vr.stackAlloc(4*_i),Ts=Vr.stackAlloc(4*_i);try{let $s=as/4,xs=ls/4,ys=fs/4,ps=Ts/4;for(let zs=0;zs<Zr;zs++)Vr.HEAPU32[$s++]=ts[zs],Vr.HEAPU32[xs++]=Kr[Gr[zs]];for(let zs=0;zs<_i;zs++)Vr.HEAPU32[ys++]=0,Vr.HEAPU32[ps++]=Xr[Lr[zs]];let vs=Vr._OrtRun(qr,ls,as,Zr,Ts,_i,fs,Jr);const Ds=Vr.jsepRunPromise;Ds&&Ds.then!==void 0&&(vs=await Ds);const js=[];if(vs===0)for(let zs=0;zs<_i;zs++){const qs=Vr.HEAPU32[fs/4+zs],fo=Vr.stackSave(),Qs=Vr.stackAlloc(16);let no,yo=0;try{if(vs=Vr._OrtGetTensorData(qs,Qs,Qs+4,Qs+8,Qs+12),vs!==0)throw new Error(`Can't access output tensor data. error code = ${vs}`);let Js=Qs/4;const lo=Vr.HEAPU32[Js++];yo=Vr.HEAPU32[Js++];const vo=Vr.HEAPU32[Js++],Ro=Vr.HEAPU32[Js++],Co=[];for(let ds=0;ds<Ro;ds++)Co.push(Vr.HEAPU32[vo/4+ds]);Vr._OrtFree(vo);const Do=Co.length===0?1:Co.reduce((ds,Os)=>ds*Os);if(no=(0,Mr.tensorDataTypeEnumToString)(lo),no==="string"){const ds=[];let Os=yo/4;for(let Ws=0;Ws<Do;Ws++){const to=Vr.HEAPU32[Os++],io=Ws===Do-1?void 0:Vr.HEAPU32[Os]-to;ds.push(Vr.UTF8ToString(to,io))}js.push([no,Co,ds])}else{const ds=new((0,Mr.tensorTypeToTypedArrayConstructor)(no))(Do);new Uint8Array(ds.buffer,ds.byteOffset,ds.byteLength).set(Vr.HEAPU8.subarray(yo,yo+ds.byteLength)),js.push([no,Co,ds])}}finally{Vr.stackRestore(fo),no==="string"&&yo&&Vr._free(yo),Vr._OrtReleaseTensor(qs)}}if(vs===0)return js;throw new Error(`failed to call OrtRun(). error code = ${vs}.`)}finally{Vr.stackRestore(rs)}}finally{ts.forEach(Vr._OrtReleaseTensor),is.forEach(Vr._free),Vr._OrtReleaseRunOptions(Jr),es.forEach(Vr._free)}},Tr.endProfiling=jr=>{const Gr=(0,Fr.getInstance)(),Nr=zr.get(jr);if(!Nr)throw new Error("invalid session id");const Lr=Nr[0],Ur=Gr._OrtEndProfiling(Lr);if(Ur===0)throw new Error("Can't get an profile file name");Gr._OrtFree(Ur)},Tr.extractTransferableBuffers=jr=>{const Gr=[];for(const Nr of jr){const Lr=Nr[2];!Array.isArray(Lr)&&Lr.buffer&&Gr.push(Lr.buffer)}return Gr}},263:function(_r,Tr,Ar){var Rr=this&&this.__createBinding||(Object.create?function(Ur,Vr,Wr,qr){qr===void 0&&(qr=Wr);var Kr=Object.getOwnPropertyDescriptor(Vr,Wr);Kr&&!("get"in Kr?!Vr.__esModule:Kr.writable||Kr.configurable)||(Kr={enumerable:!0,get:function(){return Vr[Wr]}}),Object.defineProperty(Ur,qr,Kr)}:function(Ur,Vr,Wr,qr){qr===void 0&&(qr=Wr),Ur[qr]=Vr[Wr]}),Pr=this&&this.__setModuleDefault||(Object.create?function(Ur,Vr){Object.defineProperty(Ur,"default",{enumerable:!0,value:Vr})}:function(Ur,Vr){Ur.default=Vr}),Dr=this&&this.__importStar||function(Ur){if(Ur&&Ur.__esModule)return Ur;var Vr={};if(Ur!=null)for(var Wr in Ur)Wr!=="default"&&Object.prototype.hasOwnProperty.call(Ur,Wr)&&Rr(Vr,Ur,Wr);return Pr(Vr,Ur),Vr};Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.dispose=Tr.getInstance=Tr.initializeWebAssembly=void 0;const Mr=Dr(Ar(6449)),Fr=Ar(932),zr=Ar(3474);let jr,Gr=!1,Nr=!1,Lr=!1;Tr.initializeWebAssembly=async Ur=>{if(Gr)return Promise.resolve();if(Nr)throw new Error("multiple calls to 'initializeWebAssembly()' detected.");if(Lr)throw new Error("previous call to 'initializeWebAssembly()' failed.");Nr=!0;const Vr=Ur.initTimeout,Wr=Ur.numThreads,qr=Ur.simd,Kr=Wr>1&&(()=>{try{return typeof SharedArrayBuffer<"u"&&(typeof MessageChannel<"u"&&new MessageChannel().port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11])))}catch{return!1}})(),Xr=qr&&(()=>{try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,30,1,28,0,65,0,253,15,253,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,253,186,1,26,11]))}catch{return!1}})(),Zr=Ur.wasmPaths,_i=typeof Zr=="string"?Zr:void 0,Jr=((rs,as)=>as?rs?"ort-wasm-simd-threaded.wasm":"ort-wasm-threaded.wasm":rs?"ort-wasm-simd.wasm":"ort-wasm.wasm")(Xr,Kr),es=typeof Zr=="object"?Zr[Jr]:void 0;let ts=!1;const is=[];if(Vr>0&&is.push(new Promise(rs=>{setTimeout(()=>{ts=!0,rs()},Vr)})),is.push(new Promise((rs,as)=>{const ls=Kr?zr:Fr,fs={locateFile:(Ts,$s)=>Kr&&Ts.endsWith(".worker.js")&&typeof Blob<"u"?URL.createObjectURL(new Blob([Ar(4154)],{type:"text/javascript"})):Ts.endsWith(".wasm")?es||(_i??$s)+Jr:$s+Ts};if(Kr)if(typeof Blob>"u")fs.mainScriptUrlOrBlob=Mr.join("/","ort-wasm-threaded.js");else{const Ts=`var ortWasmThreaded=(function(){var _scriptDir;return ${ls.toString()}})();`;fs.mainScriptUrlOrBlob=new Blob([Ts],{type:"text/javascript"})}ls(fs).then(Ts=>{Nr=!1,Gr=!0,jr=Ts,rs()},Ts=>{Nr=!1,Lr=!0,as(Ts)})})),await Promise.race(is),ts)throw new Error(`WebAssembly backend initializing failed due to timeout: ${Vr}ms`)},Tr.getInstance=()=>{if(Gr&&jr)return jr;throw new Error("WebAssembly is not initialized yet.")},Tr.dispose=()=>{var Ur;!Gr||Nr||Lr||(Nr=!0,(Ur=jr.PThread)===null||Ur===void 0||Ur.terminateAllThreads(),jr=void 0,Nr=!1,Gr=!1,Lr=!0)}},8050:(_r,Tr,Ar)=>{Ar.d(Tr,{Z:()=>Dr});var Rr=Ar(6614),Pr=Ar.n(Rr);function Dr(){return Pr()('/*!\n* ONNX Runtime Web v1.15.1\n* Copyright (c) Microsoft Corporation. All rights reserved.\n* Licensed under the MIT License.\n*/\n(()=>{var e={899:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.iterateExtraOptions=void 0,t.iterateExtraOptions=(e,n,r,a)=>{if("object"==typeof e&&null!==e){if(r.has(e))throw new Error("Circular reference in options");r.add(e)}Object.entries(e).forEach((([e,o])=>{const i=n?n+e:e;if("object"==typeof o)(0,t.iterateExtraOptions)(o,i+".",r,a);else if("string"==typeof o||"number"==typeof o)a(i,o.toString());else{if("boolean"!=typeof o)throw new Error("Can\'t handle extra config type: "+typeof o);a(i,o?"1":"0")}}))}},918:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setRunOptions=void 0;const r=n(899),a=n(444),o=n(263);t.setRunOptions=e=>{const t=(0,o.getInstance)();let n=0;const i=[],s=e||{};try{if(void 0===(null==e?void 0:e.logSeverityLevel))s.logSeverityLevel=2;else if("number"!=typeof e.logSeverityLevel||!Number.isInteger(e.logSeverityLevel)||e.logSeverityLevel<0||e.logSeverityLevel>4)throw new Error(`log serverity level is not valid: ${e.logSeverityLevel}`);if(void 0===(null==e?void 0:e.logVerbosityLevel))s.logVerbosityLevel=0;else if("number"!=typeof e.logVerbosityLevel||!Number.isInteger(e.logVerbosityLevel))throw new Error(`log verbosity level is not valid: ${e.logVerbosityLevel}`);void 0===(null==e?void 0:e.terminate)&&(s.terminate=!1);let o=0;if(void 0!==(null==e?void 0:e.tag)&&(o=(0,a.allocWasmString)(e.tag,i)),n=t._OrtCreateRunOptions(s.logSeverityLevel,s.logVerbosityLevel,!!s.terminate,o),0===n)throw new Error("Can\'t create run options");return void 0!==(null==e?void 0:e.extra)&&(0,r.iterateExtraOptions)(e.extra,"",new WeakSet,((e,r)=>{const o=(0,a.allocWasmString)(e,i),s=(0,a.allocWasmString)(r,i);if(0!==t._OrtAddRunConfigEntry(n,o,s))throw new Error(`Can\'t set a run config entry: ${e} - ${r}`)})),[n,i]}catch(e){throw 0!==n&&t._OrtReleaseRunOptions(n),i.forEach(t._free),e}}},622:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setSessionOptions=void 0;const r=n(899),a=n(444),o=n(263);t.setSessionOptions=e=>{var t,n,i,s;const u=(0,o.getInstance)();let c=0;const l=[],f=e||{};(e=>{e.extra||(e.extra={}),e.extra.session||(e.extra.session={});const t=e.extra.session;t.use_ort_model_bytes_directly||(t.use_ort_model_bytes_directly="1"),e.executionProviders&&e.executionProviders.some((e=>"webgpu"===("string"==typeof e?e:e.name)))&&(e.enableMemPattern=!1)})(f);try{const e=(e=>{switch(e){case"disabled":return 0;case"basic":return 1;case"extended":return 2;case"all":return 99;default:throw new Error(`unsupported graph optimization level: ${e}`)}})(null!==(t=f.graphOptimizationLevel)&&void 0!==t?t:"all"),p=(e=>{switch(e){case"sequential":return 0;case"parallel":return 1;default:throw new Error(`unsupported execution mode: ${e}`)}})(null!==(n=f.executionMode)&&void 0!==n?n:"sequential"),d="string"==typeof f.logId?(0,a.allocWasmString)(f.logId,l):0,m=null!==(i=f.logSeverityLevel)&&void 0!==i?i:2;if(!Number.isInteger(m)||m<0||m>4)throw new Error(`log serverity level is not valid: ${m}`);const g=null!==(s=f.logVerbosityLevel)&&void 0!==s?s:0;if(!Number.isInteger(g)||g<0||g>4)throw new Error(`log verbosity level is not valid: ${g}`);const h="string"==typeof f.optimizedModelFilePath?(0,a.allocWasmString)(f.optimizedModelFilePath,l):0;if(c=u._OrtCreateSessionOptions(e,!!f.enableCpuMemArena,!!f.enableMemPattern,p,!!f.enableProfiling,0,d,m,g,h),0===c)throw new Error("Can\'t create session options");return f.executionProviders&&((e,t,n)=>{for(const r of t){let t="string"==typeof r?r:r.name;switch(t){case"xnnpack":t="XNNPACK";break;case"webgpu":t="JS";break;case"wasm":case"cpu":continue;default:throw new Error(`not supported EP: ${t}`)}const i=(0,a.allocWasmString)(t,n);if(0!==(0,o.getInstance)()._OrtAppendExecutionProvider(e,i))throw new Error(`Can\'t append execution provider: ${t}`)}})(c,f.executionProviders,l),void 0!==f.extra&&(0,r.iterateExtraOptions)(f.extra,"",new WeakSet,((e,t)=>{const n=(0,a.allocWasmString)(e,l),r=(0,a.allocWasmString)(t,l);if(0!==u._OrtAddSessionConfigEntry(c,n,r))throw new Error(`Can\'t set a session config entry: ${e} - ${t}`)})),[c,l]}catch(e){throw 0!==c&&u._OrtReleaseSessionOptions(c),l.forEach(u._free),e}}},444:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.allocWasmString=void 0;const r=n(263);t.allocWasmString=(e,t)=>{const n=(0,r.getInstance)(),a=n.lengthBytesUTF8(e)+1,o=n._malloc(a);return n.stringToUTF8(e,o,a),t.push(o),o}},917:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logLevelStringToEnum=t.tensorTypeToTypedArrayConstructor=t.getTensorElementSize=t.tensorDataTypeEnumToString=t.tensorDataTypeStringToEnum=void 0,t.tensorDataTypeStringToEnum=e=>{switch(e){case"int8":return 3;case"uint8":return 2;case"bool":return 9;case"int16":return 5;case"uint16":return 4;case"int32":return 6;case"uint32":return 12;case"float32":return 1;case"float64":return 11;case"string":return 8;case"int64":return 7;case"uint64":return 13;default:throw new Error(`unsupported data type: ${e}`)}},t.tensorDataTypeEnumToString=e=>{switch(e){case 3:return"int8";case 2:return"uint8";case 9:return"bool";case 5:return"int16";case 4:return"uint16";case 6:return"int32";case 12:return"uint32";case 1:return"float32";case 11:return"float64";case 8:return"string";case 7:return"int64";case 13:return"uint64";default:throw new Error(`unsupported data type: ${e}`)}},t.getTensorElementSize=e=>[void 0,4,1,1,2,2,4,8,void 0,1,2,8,4,8,void 0,void 0,void 0][e],t.tensorTypeToTypedArrayConstructor=e=>{switch(e){case"float32":return Float32Array;case"uint8":case"bool":return Uint8Array;case"int8":return Int8Array;case"uint16":return Uint16Array;case"int16":return Int16Array;case"int32":return Int32Array;case"float64":return Float64Array;case"uint32":return Uint32Array;case"int64":return BigInt64Array;case"uint64":return BigUint64Array;default:throw new Error(`unsupported type: ${e}`)}},t.logLevelStringToEnum=e=>{switch(e){case"verbose":return 0;case"info":return 1;case"warning":return 2;case"error":return 3;case"fatal":return 4;default:throw new Error(`unsupported logging level: ${e}`)}}},259:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.extractTransferableBuffers=t.endProfiling=t.run=t.releaseSession=t.createSession=t.createSessionFinalize=t.createSessionAllocate=t.initOrt=void 0;const r=n(918),a=n(622),o=n(444),i=n(917),s=n(263);t.initOrt=(e,t)=>{const n=(0,s.getInstance)()._OrtInit(e,t);if(0!==n)throw new Error(`Can\'t initialize onnxruntime. error code = ${n}`)};const u=new Map;t.createSessionAllocate=e=>{const t=(0,s.getInstance)(),n=t._malloc(e.byteLength);return t.HEAPU8.set(e,n),[n,e.byteLength]},t.createSessionFinalize=(e,t)=>{const n=(0,s.getInstance)();let r=0,o=0,i=[];try{if([o,i]=(0,a.setSessionOptions)(t),r=n._OrtCreateSession(e[0],e[1],o),0===r)throw new Error("Can\'t create a session")}finally{n._free(e[0]),0!==o&&n._OrtReleaseSessionOptions(o),i.forEach(n._free)}const c=n._OrtGetInputCount(r),l=n._OrtGetOutputCount(r),f=[],p=[],d=[],m=[];for(let e=0;e<c;e++){const t=n._OrtGetInputName(r,e);if(0===t)throw new Error("Can\'t get an input name");p.push(t),f.push(n.UTF8ToString(t))}for(let e=0;e<l;e++){const t=n._OrtGetOutputName(r,e);if(0===t)throw new Error("Can\'t get an output name");m.push(t),d.push(n.UTF8ToString(t))}return u.set(r,[r,p,m]),[r,f,d]},t.createSession=(e,n)=>{const r=(0,t.createSessionAllocate)(e);return(0,t.createSessionFinalize)(r,n)},t.releaseSession=e=>{const t=(0,s.getInstance)(),n=u.get(e);if(!n)throw new Error("invalid session id");const r=n[0],a=n[1],o=n[2];a.forEach(t._OrtFree),o.forEach(t._OrtFree),t._OrtReleaseSession(r),u.delete(e)},t.run=async(e,t,n,a,c)=>{const l=(0,s.getInstance)(),f=u.get(e);if(!f)throw new Error("invalid session id");const p=f[0],d=f[1],m=f[2],g=t.length,h=a.length;let y=0,v=[];const b=[],w=[];try{[y,v]=(0,r.setRunOptions)(c);for(let e=0;e<g;e++){const t=n[e][0],r=n[e][1],a=n[e][2];let s,u;if(Array.isArray(a)){u=4*a.length,s=l._malloc(u),w.push(s);let e=s/4;for(let t=0;t<a.length;t++){if("string"!=typeof a[t])throw new TypeError(`tensor data at index ${t} is not a string`);l.HEAPU32[e++]=(0,o.allocWasmString)(a[t],w)}}else u=a.byteLength,s=l._malloc(u),w.push(s),l.HEAPU8.set(new Uint8Array(a.buffer,a.byteOffset,u),s);const c=l.stackSave(),f=l.stackAlloc(4*r.length);try{let e=f/4;r.forEach((t=>l.HEAP32[e++]=t));const n=l._OrtCreateTensor((0,i.tensorDataTypeStringToEnum)(t),s,u,f,r.length);if(0===n)throw new Error("Can\'t create a tensor");b.push(n)}finally{l.stackRestore(c)}}const e=l.stackSave(),s=l.stackAlloc(4*g),u=l.stackAlloc(4*g),f=l.stackAlloc(4*h),_=l.stackAlloc(4*h);try{let e=s/4,n=u/4,r=f/4,o=_/4;for(let r=0;r<g;r++)l.HEAPU32[e++]=b[r],l.HEAPU32[n++]=d[t[r]];for(let e=0;e<h;e++)l.HEAPU32[r++]=0,l.HEAPU32[o++]=m[a[e]];let c=l._OrtRun(p,u,s,g,_,h,f,y);const v=l.jsepRunPromise;v&&void 0!==v.then&&(c=await v);const w=[];if(0===c)for(let e=0;e<h;e++){const t=l.HEAPU32[f/4+e],n=l.stackSave(),r=l.stackAlloc(16);let a,o=0;try{if(c=l._OrtGetTensorData(t,r,r+4,r+8,r+12),0!==c)throw new Error(`Can\'t access output tensor data. error code = ${c}`);let e=r/4;const n=l.HEAPU32[e++];o=l.HEAPU32[e++];const s=l.HEAPU32[e++],u=l.HEAPU32[e++],f=[];for(let e=0;e<u;e++)f.push(l.HEAPU32[s/4+e]);l._OrtFree(s);const p=0===f.length?1:f.reduce(((e,t)=>e*t));if(a=(0,i.tensorDataTypeEnumToString)(n),"string"===a){const e=[];let t=o/4;for(let n=0;n<p;n++){const r=l.HEAPU32[t++],a=n===p-1?void 0:l.HEAPU32[t]-r;e.push(l.UTF8ToString(r,a))}w.push([a,f,e])}else{const e=new((0,i.tensorTypeToTypedArrayConstructor)(a))(p);new Uint8Array(e.buffer,e.byteOffset,e.byteLength).set(l.HEAPU8.subarray(o,o+e.byteLength)),w.push([a,f,e])}}finally{l.stackRestore(n),"string"===a&&o&&l._free(o),l._OrtReleaseTensor(t)}}if(0===c)return w;throw new Error(`failed to call OrtRun(). error code = ${c}.`)}finally{l.stackRestore(e)}}finally{b.forEach(l._OrtReleaseTensor),w.forEach(l._free),l._OrtReleaseRunOptions(y),v.forEach(l._free)}},t.endProfiling=e=>{const t=(0,s.getInstance)(),n=u.get(e);if(!n)throw new Error("invalid session id");const r=n[0],a=t._OrtEndProfiling(r);if(0===a)throw new Error("Can\'t get an profile file name");t._OrtFree(a)},t.extractTransferableBuffers=e=>{const t=[];for(const n of e){const e=n[2];!Array.isArray(e)&&e.buffer&&t.push(e.buffer)}return t}},263:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var a=Object.getOwnPropertyDescriptor(t,n);a&&!("get"in a?!t.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,a)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.dispose=t.getInstance=t.initializeWebAssembly=void 0;const i=o(n(449)),s=n(932),u=n(474);let c,l=!1,f=!1,p=!1;t.initializeWebAssembly=async e=>{if(l)return Promise.resolve();if(f)throw new Error("multiple calls to \'initializeWebAssembly()\' detected.");if(p)throw new Error("previous call to \'initializeWebAssembly()\' failed.");f=!0;const t=e.initTimeout,r=e.numThreads,a=e.simd,o=r>1&&(()=>{try{return"undefined"!=typeof SharedArrayBuffer&&("undefined"!=typeof MessageChannel&&(new MessageChannel).port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11])))}catch(e){return!1}})(),d=a&&(()=>{try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,30,1,28,0,65,0,253,15,253,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,253,186,1,26,11]))}catch(e){return!1}})(),m=e.wasmPaths,g="string"==typeof m?m:void 0,h=((e,t)=>t?e?"ort-wasm-simd-threaded.wasm":"ort-wasm-threaded.wasm":e?"ort-wasm-simd.wasm":"ort-wasm.wasm")(d,o),y="object"==typeof m?m[h]:void 0;let v=!1;const b=[];if(t>0&&b.push(new Promise((e=>{setTimeout((()=>{v=!0,e()}),t)}))),b.push(new Promise(((e,t)=>{const r=o?u:s,a={locateFile:(e,t)=>o&&e.endsWith(".worker.js")&&"undefined"!=typeof Blob?URL.createObjectURL(new Blob([n(154)],{type:"text/javascript"})):e.endsWith(".wasm")?y||(null!=g?g:t)+h:t+e};if(o)if("undefined"==typeof Blob)a.mainScriptUrlOrBlob=i.join("/","ort-wasm-threaded.js");else{const e=`var ortWasmThreaded=(function(){var _scriptDir;return ${r.toString()}})();`;a.mainScriptUrlOrBlob=new Blob([e],{type:"text/javascript"})}r(a).then((t=>{f=!1,l=!0,c=t,e()}),(e=>{f=!1,p=!0,t(e)}))}))),await Promise.race(b),v)throw new Error(`WebAssembly backend initializing failed due to timeout: ${t}ms`)},t.getInstance=()=>{if(l&&c)return c;throw new Error("WebAssembly is not initialized yet.")},t.dispose=()=>{var e;!l||f||p||(f=!0,null===(e=c.PThread)||void 0===e||e.terminateAllThreads(),c=void 0,f=!1,l=!1,p=!0)}},474:(e,t,n)=>{var _scriptDir,r=(_scriptDir=(_scriptDir="undefined"!=typeof document&&document.currentScript?document.currentScript.src:void 0)||"/index.js",function(e){function t(){return P.buffer!=D&&G(P.buffer),F}function r(){return P.buffer!=D&&G(P.buffer),U}function a(){return P.buffer!=D&&G(P.buffer),I}function o(){return P.buffer!=D&&G(P.buffer),W}function i(){return P.buffer!=D&&G(P.buffer),j}var s,u,c;e=e||{},s||(s=void 0!==e?e:{}),s.ready=new Promise((function(e,t){u=e,c=t}));var l,f,p,d,m,g,h=Object.assign({},s),y="./this.program",v=(e,t)=>{throw t},b="object"==typeof window,w="function"==typeof importScripts,_="object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node,O=s.ENVIRONMENT_IS_PTHREAD||!1,S="";function T(e){return s.locateFile?s.locateFile(e,S):S+e}if(_){let t;S=w?n(908).dirname(S)+"/":"//",g=()=>{m||(d=n(384),m=n(908))},l=function(e,t){return g(),e=m.normalize(e),d.readFileSync(e,t?void 0:"utf8")},p=e=>((e=l(e,!0)).buffer||(e=new Uint8Array(e)),e),f=(e,t,n)=>{g(),e=m.normalize(e),d.readFile(e,(function(e,r){e?n(e):t(r.buffer)}))},1<process.argv.length&&(y=process.argv[1].replace(/\\\\/g,"/")),process.argv.slice(2),process.on("uncaughtException",(function(e){if(!(e instanceof ie))throw e})),process.on("unhandledRejection",(function(e){throw e})),v=(e,t)=>{if(C)throw process.exitCode=e,t;t instanceof ie||x("exiting due to exception: "+t),process.exit(e)},s.inspect=function(){return"[Emscripten Module object]"};try{t=n(925)}catch(e){throw console.error(\'The "worker_threads" module is not supported in this node.js build - perhaps a newer version is needed?\'),e}n.g.Worker=t.Worker}else(b||w)&&(w?S=self.location.href:"undefined"!=typeof document&&document.currentScript&&(S=document.currentScript.src),_scriptDir&&(S=_scriptDir),S=0!==S.indexOf("blob:")?S.substr(0,S.replace(/[?#].*/,"").lastIndexOf("/")+1):"",_||(l=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},w&&(p=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),f=(e,t,n)=>{var r=new XMLHttpRequest;r.open("GET",e,!0),r.responseType="arraybuffer",r.onload=()=>{200==r.status||0==r.status&&r.response?t(r.response):n()},r.onerror=n,r.send(null)}));_&&"undefined"==typeof performance&&(n.g.performance=n(953).performance);var A=console.log.bind(console),E=console.warn.bind(console);_&&(g(),A=e=>d.writeSync(1,e+"\\n"),E=e=>d.writeSync(2,e+"\\n"));var M,R=s.print||A,x=s.printErr||E;Object.assign(s,h),h=null,s.thisProgram&&(y=s.thisProgram),s.quit&&(v=s.quit),s.wasmBinary&&(M=s.wasmBinary);var C=s.noExitRuntime||!0;"object"!=typeof WebAssembly&&ne("no native wasm support detected");var P,k,D,F,U,I,W,j,H=!1,L="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function Y(e,t,n){var r=(t>>>=0)+n;for(n=t;e[n]&&!(n>=r);)++n;if(16<n-t&&e.buffer&&L)return L.decode(e.buffer instanceof SharedArrayBuffer?e.slice(t,n):e.subarray(t,n));for(r="";t<n;){var a=e[t++];if(128&a){var o=63&e[t++];if(192==(224&a))r+=String.fromCharCode((31&a)<<6|o);else{var i=63&e[t++];65536>(a=224==(240&a)?(15&a)<<12|o<<6|i:(7&a)<<18|o<<12|i<<6|63&e[t++])?r+=String.fromCharCode(a):(a-=65536,r+=String.fromCharCode(55296|a>>10,56320|1023&a))}}else r+=String.fromCharCode(a)}return r}function z(e,t){return(e>>>=0)?Y(r(),e,t):""}function B(e,t,n,r){if(!(0<r))return 0;var a=n>>>=0;r=n+r-1;for(var o=0;o<e.length;++o){var i=e.charCodeAt(o);if(55296<=i&&57343>=i&&(i=65536+((1023&i)<<10)|1023&e.charCodeAt(++o)),127>=i){if(n>=r)break;t[n++>>>0]=i}else{if(2047>=i){if(n+1>=r)break;t[n++>>>0]=192|i>>6}else{if(65535>=i){if(n+2>=r)break;t[n++>>>0]=224|i>>12}else{if(n+3>=r)break;t[n++>>>0]=240|i>>18,t[n++>>>0]=128|i>>12&63}t[n++>>>0]=128|i>>6&63}t[n++>>>0]=128|63&i}}return t[n>>>0]=0,n-a}function N(e){for(var t=0,n=0;n<e.length;++n){var r=e.charCodeAt(n);127>=r?t++:2047>=r?t+=2:55296<=r&&57343>=r?(t+=4,++n):t+=3}return t}function G(e){D=e,s.HEAP8=F=new Int8Array(e),s.HEAP16=new Int16Array(e),s.HEAP32=I=new Int32Array(e),s.HEAPU8=U=new Uint8Array(e),s.HEAPU16=new Uint16Array(e),s.HEAPU32=W=new Uint32Array(e),s.HEAPF32=new Float32Array(e),s.HEAPF64=j=new Float64Array(e)}O&&(D=s.buffer);var q=s.INITIAL_MEMORY||16777216;if(O)P=s.wasmMemory,D=s.buffer;else if(s.wasmMemory)P=s.wasmMemory;else if(!((P=new WebAssembly.Memory({initial:q/65536,maximum:65536,shared:!0})).buffer instanceof SharedArrayBuffer))throw x("requested a shared WebAssembly.Memory but the returned buffer is not a SharedArrayBuffer, indicating that while the browser has SharedArrayBuffer it does not have WebAssembly threads support - you may need to set a flag"),_&&console.log("(on node you may need: --experimental-wasm-threads --experimental-wasm-bulk-memory and also use a recent version)"),Error("bad memory");P&&(D=P.buffer),q=D.byteLength,G(D);var $,V=[],J=[],Q=[];function X(){var e=s.preRun.shift();V.unshift(e)}var K,Z=0,ee=null,te=null;function ne(e){throw O?postMessage({cmd:"onAbort",arg:e}):s.onAbort&&s.onAbort(e),x(e="Aborted("+e+")"),H=!0,e=new WebAssembly.RuntimeError(e+". Build with -sASSERTIONS for more info."),c(e),e}function re(){return K.startsWith("data:application/octet-stream;base64,")}function ae(){var e=K;try{if(e==K&&M)return new Uint8Array(M);if(p)return p(e);throw"both async and sync fetching of the wasm failed"}catch(e){ne(e)}}K="ort-wasm-threaded.wasm",re()||(K=T(K));var oe={};function ie(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}function se(e){(e=fe.La[e])||ne(),fe.Xa(e)}function ue(e){var t=fe.lb();if(!t)return 6;fe.Ra.push(t),fe.La[e.Ka]=t,t.Ka=e.Ka;var n={cmd:"run",start_routine:e.pb,arg:e.ib,pthread_ptr:e.Ka};return t.Qa=()=>{n.time=performance.now(),t.postMessage(n,e.vb)},t.loaded&&(t.Qa(),delete t.Qa),0}function ce(e){if(O)return He(1,1,e);C||(fe.qb(),s.onExit&&s.onExit(e),H=!0),v(e,new ie(e))}function le(e,t){if(!t&&O)throw de(e),"unwind";ce(e)}var fe={Oa:[],Ra:[],$a:[],La:{},Ua:function(){O&&fe.mb()},xb:function(){},mb:function(){fe.receiveObjectTransfer=fe.ob,fe.threadInitTLS=fe.Za,fe.setExitStatus=fe.Ya,C=!1},Ya:function(){},qb:function(){for(var e of Object.values(fe.La))fe.Xa(e);for(e of fe.Oa)e.terminate();fe.Oa=[]},Xa:function(e){var t=e.Ka;delete fe.La[t],fe.Oa.push(e),fe.Ra.splice(fe.Ra.indexOf(e),1),e.Ka=0,ct(t)},ob:function(){},Za:function(){fe.$a.forEach((e=>e()))},nb:function(e,t){e.onmessage=n=>{var r=(n=n.data).cmd;if(e.Ka&&(fe.kb=e.Ka),n.targetThread&&n.targetThread!=rt()){var a=fe.La[n.yb];a?a.postMessage(n,n.transferList):x(\'Internal error! Worker sent a message "\'+r+\'" to target pthread \'+n.targetThread+", but that thread no longer exists!")}else"processProxyingQueue"===r?De(n.queue):"spawnThread"===r?ue(n):"cleanupThread"===r?se(n.thread):"killThread"===r?(n=n.thread,r=fe.La[n],delete fe.La[n],r.terminate(),ct(n),fe.Ra.splice(fe.Ra.indexOf(r),1),r.Ka=0):"cancelThread"===r?fe.La[n.thread].postMessage({cmd:"cancel"}):"loaded"===r?(e.loaded=!0,t&&t(e),e.Qa&&(e.Qa(),delete e.Qa)):"print"===r?R("Thread "+n.threadId+": "+n.text):"printErr"===r?x("Thread "+n.threadId+": "+n.text):"alert"===r?alert("Thread "+n.threadId+": "+n.text):"setimmediate"===n.target?e.postMessage(n):"onAbort"===r?s.onAbort&&s.onAbort(n.arg):r&&x("worker sent an unknown command "+r);fe.kb=void 0},e.onerror=e=>{throw x("worker sent an error! "+e.filename+":"+e.lineno+": "+e.message),e},_&&(e.on("message",(function(t){e.onmessage({data:t})})),e.on("error",(function(t){e.onerror(t)})),e.on("detachedExit",(function(){}))),e.postMessage({cmd:"load",urlOrBlob:s.mainScriptUrlOrBlob||_scriptDir,wasmMemory:P,wasmModule:k})},hb:function(){var e=T("ort-wasm-threaded.worker.js");fe.Oa.push(new Worker(e))},lb:function(){return 0==fe.Oa.length&&(fe.hb(),fe.nb(fe.Oa[0])),fe.Oa.pop()}};function pe(e){for(;0<e.length;)e.shift()(s)}function de(e){if(O)return He(2,0,e);try{le(e)}catch(e){e instanceof ie||"unwind"==e||v(1,e)}}s.PThread=fe,s.establishStackSpace=function(){var e=rt(),t=a()[e+44>>2>>>0];e=a()[e+48>>2>>>0],ft(t,t-e),dt(t)};var me,ge,he=[];function ye(e){this.Pa=e-24,this.gb=function(e){o()[this.Pa+4>>2>>>0]=e},this.cb=function(e){o()[this.Pa+8>>2>>>0]=e},this.eb=function(){a()[this.Pa>>2>>>0]=0},this.bb=function(){t()[this.Pa+12>>0>>>0]=0},this.fb=function(){t()[this.Pa+13>>0>>>0]=0},this.Ua=function(e,t){this.ab(),this.gb(e),this.cb(t),this.eb(),this.bb(),this.fb()},this.ab=function(){o()[this.Pa+16>>2>>>0]=0}}function ve(e,t,n,r){return O?He(3,1,e,t,n,r):be(e,t,n,r)}function be(e,t,n,r){if("undefined"==typeof SharedArrayBuffer)return x("Current environment does not support SharedArrayBuffer, pthreads are not available!"),6;var a=[];return O&&0===a.length?ve(e,t,n,r):(e={pb:n,Ka:e,ib:r,vb:a},O?(e.wb="spawnThread",postMessage(e,a),0):ue(e))}function we(e,t,n){return O?He(4,1,e,t,n):0}function _e(e,t){if(O)return He(5,1,e,t)}function Oe(e,t){if(O)return He(6,1,e,t)}function Se(e,t,n){if(O)return He(7,1,e,t,n)}function Te(e,t,n){return O?He(8,1,e,t,n):0}function Ae(e,t){if(O)return He(9,1,e,t)}function Ee(e,t,n){if(O)return He(10,1,e,t,n)}function Me(e,t,n,r){if(O)return He(11,1,e,t,n,r)}function Re(e,t,n,r){if(O)return He(12,1,e,t,n,r)}function xe(e,t,n,r){if(O)return He(13,1,e,t,n,r)}function Ce(e){if(O)return He(14,1,e)}function Pe(e,t){if(O)return He(15,1,e,t)}function ke(e,t,n){if(O)return He(16,1,e,t,n)}function De(e){Atomics.store(a(),e>>2,1),rt()&&ut(e),Atomics.compareExchange(a(),e>>2,1,0)}function Fe(e){return o()[e>>>2]+4294967296*a()[e+4>>>2]}function Ue(e,t,n,r,a,o){return O?He(17,1,e,t,n,r,a,o):-52}function Ie(e,t,n,r,a,o){if(O)return He(18,1,e,t,n,r,a,o)}function We(e){var n=N(e)+1,r=at(n);return r&&B(e,t(),r,n),r}function je(e,t,n){function r(e){return(e=e.toTimeString().match(/\\(([A-Za-z ]+)\\)$/))?e[1]:"GMT"}if(O)return He(19,1,e,t,n);var i=(new Date).getFullYear(),s=new Date(i,0,1),u=new Date(i,6,1);i=s.getTimezoneOffset();var c=u.getTimezoneOffset(),l=Math.max(i,c);a()[e>>2>>>0]=60*l,a()[t>>2>>>0]=Number(i!=c),e=r(s),t=r(u),e=We(e),t=We(t),c<i?(o()[n>>2>>>0]=e,o()[n+4>>2>>>0]=t):(o()[n>>2>>>0]=t,o()[n+4>>2>>>0]=e)}function He(e,t){var n=arguments.length-2,r=arguments;return function(e){var t=pt();return e=e(),dt(t),e}((()=>{for(var a=mt(8*n),o=a>>3,s=0;s<n;s++){var u=r[2+s];i()[o+s>>>0]=u}return st(e,n,a,t)}))}s.invokeEntryPoint=function(e,t){var n=he[e];n||(e>=he.length&&(he.length=e+1),he[e]=n=$.get(e)),e=n(t),C?fe.Ya(e):lt(e)},s.executeNotifiedProxyingQueue=De,ge=_?()=>{var e=process.hrtime();return 1e3*e[0]+e[1]/1e6}:O?()=>performance.now()-s.__performance_now_clock_drift:()=>performance.now();var Le,Ye=[],ze={};function Be(){if(!Le){var e,t={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"==typeof navigator&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:y||"./this.program"};for(e in ze)void 0===ze[e]?delete t[e]:t[e]=ze[e];var n=[];for(e in t)n.push(e+"="+t[e]);Le=n}return Le}function Ne(e,n){if(O)return He(20,1,e,n);var r=0;return Be().forEach((function(a,i){var s=n+r;for(i=o()[e+4*i>>2>>>0]=s,s=0;s<a.length;++s)t()[i++>>0>>>0]=a.charCodeAt(s);t()[i>>0>>>0]=0,r+=a.length+1})),0}function Ge(e,t){if(O)return He(21,1,e,t);var n=Be();o()[e>>2>>>0]=n.length;var r=0;return n.forEach((function(e){r+=e.length+1})),o()[t>>2>>>0]=r,0}function qe(e){return O?He(22,1,e):52}function $e(e,t,n,r){return O?He(23,1,e,t,n,r):52}function Ve(e,t,n,r,a){return O?He(24,1,e,t,n,r,a):70}var Je=[null,[],[]];function Qe(e,t,n,a){if(O)return He(25,1,e,t,n,a);for(var i=0,s=0;s<n;s++){var u=o()[t>>2>>>0],c=o()[t+4>>2>>>0];t+=8;for(var l=0;l<c;l++){var f=r()[u+l>>>0],p=Je[e];0===f||10===f?((1===e?R:x)(Y(p,0)),p.length=0):p.push(f)}i+=c}return o()[a>>2>>>0]=i,0}function Xe(e){return 0==e%4&&(0!=e%100||0==e%400)}var Ke=[31,29,31,30,31,30,31,31,30,31,30,31],Ze=[31,28,31,30,31,30,31,31,30,31,30,31];function et(e,n,r,o){function i(e,t,n){for(e="number"==typeof e?e.toString():e||"";e.length<t;)e=n[0]+e;return e}function s(e,t){return i(e,t,"0")}function u(e,t){function n(e){return 0>e?-1:0<e?1:0}var r;return 0===(r=n(e.getFullYear()-t.getFullYear()))&&0===(r=n(e.getMonth()-t.getMonth()))&&(r=n(e.getDate()-t.getDate())),r}function c(e){switch(e.getDay()){case 0:return new Date(e.getFullYear()-1,11,29);case 1:return e;case 2:return new Date(e.getFullYear(),0,3);case 3:return new Date(e.getFullYear(),0,2);case 4:return new Date(e.getFullYear(),0,1);case 5:return new Date(e.getFullYear()-1,11,31);case 6:return new Date(e.getFullYear()-1,11,30)}}function l(e){var t=e.Ma;for(e=new Date(new Date(e.Na+1900,0,1).getTime());0<t;){var n=e.getMonth(),r=(Xe(e.getFullYear())?Ke:Ze)[n];if(!(t>r-e.getDate())){e.setDate(e.getDate()+t);break}t-=r-e.getDate()+1,e.setDate(1),11>n?e.setMonth(n+1):(e.setMonth(0),e.setFullYear(e.getFullYear()+1))}return n=new Date(e.getFullYear()+1,0,4),t=c(new Date(e.getFullYear(),0,4)),n=c(n),0>=u(t,e)?0>=u(n,e)?e.getFullYear()+1:e.getFullYear():e.getFullYear()-1}var f=a()[o+40>>2>>>0];for(var p in o={tb:a()[o>>2>>>0],sb:a()[o+4>>2>>>0],Sa:a()[o+8>>2>>>0],Va:a()[o+12>>2>>>0],Ta:a()[o+16>>2>>>0],Na:a()[o+20>>2>>>0],Ja:a()[o+24>>2>>>0],Ma:a()[o+28>>2>>>0],zb:a()[o+32>>2>>>0],rb:a()[o+36>>2>>>0],ub:f?z(f):""},r=z(r),f={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"})r=r.replace(new RegExp(p,"g"),f[p]);var d="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),m="January February March April May June July August September October November December".split(" ");for(p in f={"%a":function(e){return d[e.Ja].substring(0,3)},"%A":function(e){return d[e.Ja]},"%b":function(e){return m[e.Ta].substring(0,3)},"%B":function(e){return m[e.Ta]},"%C":function(e){return s((e.Na+1900)/100|0,2)},"%d":function(e){return s(e.Va,2)},"%e":function(e){return i(e.Va,2," ")},"%g":function(e){return l(e).toString().substring(2)},"%G":function(e){return l(e)},"%H":function(e){return s(e.Sa,2)},"%I":function(e){return 0==(e=e.Sa)?e=12:12<e&&(e-=12),s(e,2)},"%j":function(e){for(var t=0,n=0;n<=e.Ta-1;t+=(Xe(e.Na+1900)?Ke:Ze)[n++]);return s(e.Va+t,3)},"%m":function(e){return s(e.Ta+1,2)},"%M":function(e){return s(e.sb,2)},"%n":function(){return"\\n"},"%p":function(e){return 0<=e.Sa&&12>e.Sa?"AM":"PM"},"%S":function(e){return s(e.tb,2)},"%t":function(){return"\\t"},"%u":function(e){return e.Ja||7},"%U":function(e){return s(Math.floor((e.Ma+7-e.Ja)/7),2)},"%V":function(e){var t=Math.floor((e.Ma+7-(e.Ja+6)%7)/7);if(2>=(e.Ja+371-e.Ma-2)%7&&t++,t)53==t&&(4==(n=(e.Ja+371-e.Ma)%7)||3==n&&Xe(e.Na)||(t=1));else{t=52;var n=(e.Ja+7-e.Ma-1)%7;(4==n||5==n&&Xe(e.Na%400-1))&&t++}return s(t,2)},"%w":function(e){return e.Ja},"%W":function(e){return s(Math.floor((e.Ma+7-(e.Ja+6)%7)/7),2)},"%y":function(e){return(e.Na+1900).toString().substring(2)},"%Y":function(e){return e.Na+1900},"%z":function(e){var t=0<=(e=e.rb);return e=Math.abs(e)/60,(t?"+":"-")+String("0000"+(e/60*100+e%60)).slice(-4)},"%Z":function(e){return e.ub},"%%":function(){return"%"}},r=r.replace(/%%/g,"\\0\\0"),f)r.includes(p)&&(r=r.replace(new RegExp(p,"g"),f[p](o)));return p=function(e){var t=Array(N(e)+1);return B(e,t,0,t.length),t}(r=r.replace(/\\0\\0/g,"%")),p.length>n?0:(function(e,n){t().set(e,n>>>0)}(p,e),p.length-1)}fe.Ua();var tt=[null,ce,de,ve,we,_e,Oe,Se,Te,Ae,Ee,Me,Re,xe,Ce,Pe,ke,Ue,Ie,je,Ne,Ge,qe,$e,Ve,Qe],nt={b:function(e){return at(e+24)+24},c:function(e,t,n){throw new ye(e).Ua(t,n),e},L:function(e){ot(e,!w,1,!b),fe.Za()},l:function(e){O?postMessage({cmd:"cleanupThread",thread:e}):se(e)},D:be,i:we,R:_e,z:Oe,B:Se,T:Te,P:Ae,I:Ee,O:Me,p:Re,A:xe,x:Ce,Q:Pe,y:ke,r:function(){},j:function(){ne("To use dlopen, you need enable dynamic linking, see https://github.com/emscripten-core/emscripten/wiki/Linking")},s:function(){ne("To use dlopen, you need enable dynamic linking, see https://github.com/emscripten-core/emscripten/wiki/Linking")},q:function(){return Date.now()},E:function(){return 2097152},V:function(){return!0},F:function(e,t,n,r){if(e==t)setTimeout((()=>De(r)));else if(O)postMessage({targetThread:e,cmd:"processProxyingQueue",queue:r});else{if(!(e=fe.La[e]))return;e.postMessage({cmd:"processProxyingQueue",queue:r})}return 1},K:function(){return-1},W:function(e,t){e=new Date(1e3*Fe(e)),a()[t>>2>>>0]=e.getUTCSeconds(),a()[t+4>>2>>>0]=e.getUTCMinutes(),a()[t+8>>2>>>0]=e.getUTCHours(),a()[t+12>>2>>>0]=e.getUTCDate(),a()[t+16>>2>>>0]=e.getUTCMonth(),a()[t+20>>2>>>0]=e.getUTCFullYear()-1900,a()[t+24>>2>>>0]=e.getUTCDay(),e=(e.getTime()-Date.UTC(e.getUTCFullYear(),0,1,0,0,0,0))/864e5|0,a()[t+28>>2>>>0]=e},X:function(e,t){e=new Date(1e3*Fe(e)),a()[t>>2>>>0]=e.getSeconds(),a()[t+4>>2>>>0]=e.getMinutes(),a()[t+8>>2>>>0]=e.getHours(),a()[t+12>>2>>>0]=e.getDate(),a()[t+16>>2>>>0]=e.getMonth(),a()[t+20>>2>>>0]=e.getFullYear()-1900,a()[t+24>>2>>>0]=e.getDay();var n=new Date(e.getFullYear(),0,1),r=(e.getTime()-n.getTime())/864e5|0;a()[t+28>>2>>>0]=r,a()[t+36>>2>>>0]=-60*e.getTimezoneOffset(),r=new Date(e.getFullYear(),6,1).getTimezoneOffset(),e=0|(r!=(n=n.getTimezoneOffset())&&e.getTimezoneOffset()==Math.min(n,r)),a()[t+32>>2>>>0]=e},Y:function(e){var t=new Date(a()[e+20>>2>>>0]+1900,a()[e+16>>2>>>0],a()[e+12>>2>>>0],a()[e+8>>2>>>0],a()[e+4>>2>>>0],a()[e>>2>>>0],0),n=a()[e+32>>2>>>0],r=t.getTimezoneOffset(),o=new Date(t.getFullYear(),0,1),i=new Date(t.getFullYear(),6,1).getTimezoneOffset(),s=o.getTimezoneOffset(),u=Math.min(s,i);return 0>n?a()[e+32>>2>>>0]=Number(i!=s&&u==r):0<n!=(u==r)&&(i=Math.max(s,i),t.setTime(t.getTime()+6e4*((0<n?u:i)-r))),a()[e+24>>2>>>0]=t.getDay(),n=(t.getTime()-o.getTime())/864e5|0,a()[e+28>>2>>>0]=n,a()[e>>2>>>0]=t.getSeconds(),a()[e+4>>2>>>0]=t.getMinutes(),a()[e+8>>2>>>0]=t.getHours(),a()[e+12>>2>>>0]=t.getDate(),a()[e+16>>2>>>0]=t.getMonth(),t.getTime()/1e3|0},G:Ue,H:Ie,Z:function e(t,n,r){e.jb||(e.jb=!0,je(t,n,r))},d:function(){ne("")},m:function(){if(!_&&!w){var e="Blocking on the main thread is very dangerous, see https://emscripten.org/docs/porting/pthreads.html#blocking-on-the-main-browser-thread";me||(me={}),me[e]||(me[e]=1,_&&(e="warning: "+e),x(e))}},w:function(){return 4294901760},f:ge,S:function(e,t,n){r().copyWithin(e>>>0,t>>>0,t+n>>>0)},g:function(){return _?n(993).cpus().length:navigator.hardwareConcurrency},J:function(e,t,n){Ye.length=t,n>>=3;for(var r=0;r<t;r++)Ye[r]=i()[n+r>>>0];return(0>e?oe[-e-1]:tt[e]).apply(null,Ye)},v:function(e){var t=r().length;if((e>>>=0)<=t||4294901760<e)return!1;for(var n=1;4>=n;n*=2){var a=t*(1+.2/n);a=Math.min(a,e+100663296);var o=Math;a=Math.max(e,a),o=o.min.call(o,4294901760,a+(65536-a%65536)%65536);e:{try{P.grow(o-D.byteLength+65535>>>16),G(P.buffer);var i=1;break e}catch(e){}i=void 0}if(i)return!0}return!1},U:function(){throw"unwind"},M:Ne,N:Ge,k:le,h:qe,o:$e,t:Ve,n:Qe,u:function e(r,a){e.Wa||(e.Wa=function(){if("object"==typeof crypto&&"function"==typeof crypto.getRandomValues){var e=new Uint8Array(1);return()=>(crypto.getRandomValues(e),e[0])}if(_)try{var t=n(760);return()=>t.randomBytes(1)[0]}catch(e){}return()=>ne("randomDevice")}());for(var o=0;o<a;o++)t()[r+o>>0>>>0]=e.Wa();return 0},a:P||s.wasmMemory,C:et,e:function(e,t,n,r){return et(e,t,n,r)}};!function(){function e(e,t){s.asm=e.exports,fe.$a.push(s.asm.wa),$=s.asm.za,J.unshift(s.asm._),k=t,O||(Z--,s.monitorRunDependencies&&s.monitorRunDependencies(Z),0==Z&&(null!==ee&&(clearInterval(ee),ee=null),te&&(e=te,te=null,e())))}function t(t){e(t.instance,t.module)}function n(e){return function(){if(!M&&(b||w)){if("function"==typeof fetch&&!K.startsWith("file://"))return fetch(K,{credentials:"same-origin"}).then((function(e){if(!e.ok)throw"failed to load wasm binary file at \'"+K+"\'";return e.arrayBuffer()})).catch((function(){return ae()}));if(f)return new Promise((function(e,t){f(K,(function(t){e(new Uint8Array(t))}),t)}))}return Promise.resolve().then((function(){return ae()}))}().then((function(e){return WebAssembly.instantiate(e,r)})).then((function(e){return e})).then(e,(function(e){x("failed to asynchronously prepare wasm: "+e),ne(e)}))}var r={a:nt};if(O||(Z++,s.monitorRunDependencies&&s.monitorRunDependencies(Z)),s.instantiateWasm)try{return s.instantiateWasm(r,e)}catch(e){return x("Module.instantiateWasm callback failed with error: "+e),!1}(M||"function"!=typeof WebAssembly.instantiateStreaming||re()||K.startsWith("file://")||_||"function"!=typeof fetch?n(t):fetch(K,{credentials:"same-origin"}).then((function(e){return WebAssembly.instantiateStreaming(e,r).then(t,(function(e){return x("wasm streaming compile failed: "+e),x("falling back to ArrayBuffer instantiation"),n(t)}))}))).catch(c)}(),s.___wasm_call_ctors=function(){return(s.___wasm_call_ctors=s.asm._).apply(null,arguments)},s._OrtInit=function(){return(s._OrtInit=s.asm.$).apply(null,arguments)},s._OrtCreateSessionOptions=function(){return(s._OrtCreateSessionOptions=s.asm.aa).apply(null,arguments)},s._OrtAppendExecutionProvider=function(){return(s._OrtAppendExecutionProvider=s.asm.ba).apply(null,arguments)},s._OrtAddSessionConfigEntry=function(){return(s._OrtAddSessionConfigEntry=s.asm.ca).apply(null,arguments)},s._OrtReleaseSessionOptions=function(){return(s._OrtReleaseSessionOptions=s.asm.da).apply(null,arguments)},s._OrtCreateSession=function(){return(s._OrtCreateSession=s.asm.ea).apply(null,arguments)},s._OrtReleaseSession=function(){return(s._OrtReleaseSession=s.asm.fa).apply(null,arguments)},s._OrtGetInputCount=function(){return(s._OrtGetInputCount=s.asm.ga).apply(null,arguments)},s._OrtGetOutputCount=function(){return(s._OrtGetOutputCount=s.asm.ha).apply(null,arguments)},s._OrtGetInputName=function(){return(s._OrtGetInputName=s.asm.ia).apply(null,arguments)},s._OrtGetOutputName=function(){return(s._OrtGetOutputName=s.asm.ja).apply(null,arguments)},s._OrtFree=function(){return(s._OrtFree=s.asm.ka).apply(null,arguments)},s._OrtCreateTensor=function(){return(s._OrtCreateTensor=s.asm.la).apply(null,arguments)},s._OrtGetTensorData=function(){return(s._OrtGetTensorData=s.asm.ma).apply(null,arguments)},s._OrtReleaseTensor=function(){return(s._OrtReleaseTensor=s.asm.na).apply(null,arguments)},s._OrtCreateRunOptions=function(){return(s._OrtCreateRunOptions=s.asm.oa).apply(null,arguments)},s._OrtAddRunConfigEntry=function(){return(s._OrtAddRunConfigEntry=s.asm.pa).apply(null,arguments)},s._OrtReleaseRunOptions=function(){return(s._OrtReleaseRunOptions=s.asm.qa).apply(null,arguments)},s._OrtRun=function(){return(s._OrtRun=s.asm.ra).apply(null,arguments)},s._OrtEndProfiling=function(){return(s._OrtEndProfiling=s.asm.sa).apply(null,arguments)};var rt=s._pthread_self=function(){return(rt=s._pthread_self=s.asm.ta).apply(null,arguments)},at=s._malloc=function(){return(at=s._malloc=s.asm.ua).apply(null,arguments)};s._free=function(){return(s._free=s.asm.va).apply(null,arguments)},s.__emscripten_tls_init=function(){return(s.__emscripten_tls_init=s.asm.wa).apply(null,arguments)};var ot=s.__emscripten_thread_init=function(){return(ot=s.__emscripten_thread_init=s.asm.xa).apply(null,arguments)};s.__emscripten_thread_crashed=function(){return(s.__emscripten_thread_crashed=s.asm.ya).apply(null,arguments)};var it,st=s._emscripten_run_in_main_runtime_thread_js=function(){return(st=s._emscripten_run_in_main_runtime_thread_js=s.asm.Aa).apply(null,arguments)},ut=s.__emscripten_proxy_execute_task_queue=function(){return(ut=s.__emscripten_proxy_execute_task_queue=s.asm.Ba).apply(null,arguments)},ct=s.__emscripten_thread_free_data=function(){return(ct=s.__emscripten_thread_free_data=s.asm.Ca).apply(null,arguments)},lt=s.__emscripten_thread_exit=function(){return(lt=s.__emscripten_thread_exit=s.asm.Da).apply(null,arguments)},ft=s._emscripten_stack_set_limits=function(){return(ft=s._emscripten_stack_set_limits=s.asm.Ea).apply(null,arguments)},pt=s.stackSave=function(){return(pt=s.stackSave=s.asm.Fa).apply(null,arguments)},dt=s.stackRestore=function(){return(dt=s.stackRestore=s.asm.Ga).apply(null,arguments)},mt=s.stackAlloc=function(){return(mt=s.stackAlloc=s.asm.Ha).apply(null,arguments)};function gt(){function e(){if(!it&&(it=!0,s.calledRun=!0,!H)&&(O||pe(J),u(s),s.onRuntimeInitialized&&s.onRuntimeInitialized(),!O)){if(s.postRun)for("function"==typeof s.postRun&&(s.postRun=[s.postRun]);s.postRun.length;){var e=s.postRun.shift();Q.unshift(e)}pe(Q)}}if(!(0<Z))if(O)u(s),O||pe(J),postMessage({cmd:"loaded"});else{if(s.preRun)for("function"==typeof s.preRun&&(s.preRun=[s.preRun]);s.preRun.length;)X();pe(V),0<Z||(s.setStatus?(s.setStatus("Running..."),setTimeout((function(){setTimeout((function(){s.setStatus("")}),1),e()}),1)):e())}}if(s.___cxa_is_pointer_type=function(){return(s.___cxa_is_pointer_type=s.asm.Ia).apply(null,arguments)},s.UTF8ToString=z,s.stringToUTF8=function(e,t,n){return B(e,r(),t,n)},s.lengthBytesUTF8=N,s.keepRuntimeAlive=function(){return C},s.wasmMemory=P,s.stackSave=pt,s.stackRestore=dt,s.stackAlloc=mt,s.ExitStatus=ie,s.PThread=fe,te=function e(){it||gt(),it||(te=e)},s.preInit)for("function"==typeof s.preInit&&(s.preInit=[s.preInit]);0<s.preInit.length;)s.preInit.pop()();return gt(),e.ready});e.exports=r},932:(e,t,n)=>{var _scriptDir,r=(_scriptDir=(_scriptDir="undefined"!=typeof document&&document.currentScript?document.currentScript.src:void 0)||"/index.js",function(e){var t,r,a;e=e||{},t||(t=void 0!==e?e:{}),t.ready=new Promise((function(e,t){r=e,a=t}));var o,i,s,u,c,l,f=Object.assign({},t),p="./this.program",d=(e,t)=>{throw t},m="object"==typeof window,g="function"==typeof importScripts,h="object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node,y="";h?(y=g?n(908).dirname(y)+"/":"//",l=()=>{c||(u=n(384),c=n(908))},o=function(e,t){return l(),e=c.normalize(e),u.readFileSync(e,t?void 0:"utf8")},s=e=>((e=o(e,!0)).buffer||(e=new Uint8Array(e)),e),i=(e,t,n)=>{l(),e=c.normalize(e),u.readFile(e,(function(e,r){e?n(e):t(r.buffer)}))},1<process.argv.length&&(p=process.argv[1].replace(/\\\\/g,"/")),process.argv.slice(2),process.on("uncaughtException",(function(e){if(!(e instanceof $))throw e})),process.on("unhandledRejection",(function(e){throw e})),d=(e,t)=>{if(_)throw process.exitCode=e,t;t instanceof $||w("exiting due to exception: "+t),process.exit(e)},t.inspect=function(){return"[Emscripten Module object]"}):(m||g)&&(g?y=self.location.href:"undefined"!=typeof document&&document.currentScript&&(y=document.currentScript.src),_scriptDir&&(y=_scriptDir),y=0!==y.indexOf("blob:")?y.substr(0,y.replace(/[?#].*/,"").lastIndexOf("/")+1):"",o=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},g&&(s=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),i=(e,t,n)=>{var r=new XMLHttpRequest;r.open("GET",e,!0),r.responseType="arraybuffer",r.onload=()=>{200==r.status||0==r.status&&r.response?t(r.response):n()},r.onerror=n,r.send(null)});var v,b=t.print||console.log.bind(console),w=t.printErr||console.warn.bind(console);Object.assign(t,f),f=null,t.thisProgram&&(p=t.thisProgram),t.quit&&(d=t.quit),t.wasmBinary&&(v=t.wasmBinary);var _=t.noExitRuntime||!0;"object"!=typeof WebAssembly&&B("no native wasm support detected");var O,S,T,A,E,M,R=!1,x="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function C(e,t,n){var r=(t>>>=0)+n;for(n=t;e[n]&&!(n>=r);)++n;if(16<n-t&&e.buffer&&x)return x.decode(e.subarray(t,n));for(r="";t<n;){var a=e[t++];if(128&a){var o=63&e[t++];if(192==(224&a))r+=String.fromCharCode((31&a)<<6|o);else{var i=63&e[t++];65536>(a=224==(240&a)?(15&a)<<12|o<<6|i:(7&a)<<18|o<<12|i<<6|63&e[t++])?r+=String.fromCharCode(a):(a-=65536,r+=String.fromCharCode(55296|a>>10,56320|1023&a))}}else r+=String.fromCharCode(a)}return r}function P(e,t){return(e>>>=0)?C(A,e,t):""}function k(e,t,n,r){if(!(0<r))return 0;var a=n>>>=0;r=n+r-1;for(var o=0;o<e.length;++o){var i=e.charCodeAt(o);if(55296<=i&&57343>=i&&(i=65536+((1023&i)<<10)|1023&e.charCodeAt(++o)),127>=i){if(n>=r)break;t[n++>>>0]=i}else{if(2047>=i){if(n+1>=r)break;t[n++>>>0]=192|i>>6}else{if(65535>=i){if(n+2>=r)break;t[n++>>>0]=224|i>>12}else{if(n+3>=r)break;t[n++>>>0]=240|i>>18,t[n++>>>0]=128|i>>12&63}t[n++>>>0]=128|i>>6&63}t[n++>>>0]=128|63&i}}return t[n>>>0]=0,n-a}function D(e){for(var t=0,n=0;n<e.length;++n){var r=e.charCodeAt(n);127>=r?t++:2047>=r?t+=2:55296<=r&&57343>=r?(t+=4,++n):t+=3}return t}function F(){var e=O.buffer;S=e,t.HEAP8=T=new Int8Array(e),t.HEAP16=new Int16Array(e),t.HEAP32=E=new Int32Array(e),t.HEAPU8=A=new Uint8Array(e),t.HEAPU16=new Uint16Array(e),t.HEAPU32=M=new Uint32Array(e),t.HEAPF32=new Float32Array(e),t.HEAPF64=new Float64Array(e)}var U=[],I=[],W=[];function j(){var e=t.preRun.shift();U.unshift(e)}var H,L=0,Y=null,z=null;function B(e){throw t.onAbort&&t.onAbort(e),w(e="Aborted("+e+")"),R=!0,e=new WebAssembly.RuntimeError(e+". Build with -sASSERTIONS for more info."),a(e),e}function N(){return H.startsWith("data:application/octet-stream;base64,")}if(H="ort-wasm.wasm",!N()){var G=H;H=t.locateFile?t.locateFile(G,y):y+G}function q(){var e=H;try{if(e==H&&v)return new Uint8Array(v);if(s)return s(e);throw"both async and sync fetching of the wasm failed"}catch(e){B(e)}}function $(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}function V(e){for(;0<e.length;)e.shift()(t)}function J(e){this.sa=e-24,this.Ia=function(e){M[this.sa+4>>2>>>0]=e},this.Ba=function(e){M[this.sa+8>>2>>>0]=e},this.Ga=function(){E[this.sa>>2>>>0]=0},this.Aa=function(){T[this.sa+12>>0>>>0]=0},this.Ha=function(){T[this.sa+13>>0>>>0]=0},this.ya=function(e,t){this.za(),this.Ia(e),this.Ba(t),this.Ga(),this.Aa(),this.Ha()},this.za=function(){M[this.sa+16>>2>>>0]=0}}function Q(e){var t=D(e)+1,n=ie(t);return n&&k(e,T,n,t),n}var X={};function K(){if(!Z){var e,t={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"==typeof navigator&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:p||"./this.program"};for(e in X)void 0===X[e]?delete t[e]:t[e]=X[e];var n=[];for(e in t)n.push(e+"="+t[e]);Z=n}return Z}var Z,ee=[null,[],[]];function te(e){return 0==e%4&&(0!=e%100||0==e%400)}var ne=[31,29,31,30,31,30,31,31,30,31,30,31],re=[31,28,31,30,31,30,31,31,30,31,30,31];function ae(e,t,n,r){function a(e,t,n){for(e="number"==typeof e?e.toString():e||"";e.length<t;)e=n[0]+e;return e}function o(e,t){return a(e,t,"0")}function i(e,t){function n(e){return 0>e?-1:0<e?1:0}var r;return 0===(r=n(e.getFullYear()-t.getFullYear()))&&0===(r=n(e.getMonth()-t.getMonth()))&&(r=n(e.getDate()-t.getDate())),r}function s(e){switch(e.getDay()){case 0:return new Date(e.getFullYear()-1,11,29);case 1:return e;case 2:return new Date(e.getFullYear(),0,3);case 3:return new Date(e.getFullYear(),0,2);case 4:return new Date(e.getFullYear(),0,1);case 5:return new Date(e.getFullYear()-1,11,31);case 6:return new Date(e.getFullYear()-1,11,30)}}function u(e){var t=e.qa;for(e=new Date(new Date(e.ra+1900,0,1).getTime());0<t;){var n=e.getMonth(),r=(te(e.getFullYear())?ne:re)[n];if(!(t>r-e.getDate())){e.setDate(e.getDate()+t);break}t-=r-e.getDate()+1,e.setDate(1),11>n?e.setMonth(n+1):(e.setMonth(0),e.setFullYear(e.getFullYear()+1))}return n=new Date(e.getFullYear()+1,0,4),t=s(new Date(e.getFullYear(),0,4)),n=s(n),0>=i(t,e)?0>=i(n,e)?e.getFullYear()+1:e.getFullYear():e.getFullYear()-1}var c=E[r+40>>2>>>0];for(var l in r={Ea:E[r>>2>>>0],Da:E[r+4>>2>>>0],ta:E[r+8>>2>>>0],va:E[r+12>>2>>>0],ua:E[r+16>>2>>>0],ra:E[r+20>>2>>>0],la:E[r+24>>2>>>0],qa:E[r+28>>2>>>0],Ja:E[r+32>>2>>>0],Ca:E[r+36>>2>>>0],Fa:c?P(c):""},n=P(n),c={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"})n=n.replace(new RegExp(l,"g"),c[l]);var f="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),p="January February March April May June July August September October November December".split(" ");for(l in c={"%a":function(e){return f[e.la].substring(0,3)},"%A":function(e){return f[e.la]},"%b":function(e){return p[e.ua].substring(0,3)},"%B":function(e){return p[e.ua]},"%C":function(e){return o((e.ra+1900)/100|0,2)},"%d":function(e){return o(e.va,2)},"%e":function(e){return a(e.va,2," ")},"%g":function(e){return u(e).toString().substring(2)},"%G":function(e){return u(e)},"%H":function(e){return o(e.ta,2)},"%I":function(e){return 0==(e=e.ta)?e=12:12<e&&(e-=12),o(e,2)},"%j":function(e){for(var t=0,n=0;n<=e.ua-1;t+=(te(e.ra+1900)?ne:re)[n++]);return o(e.va+t,3)},"%m":function(e){return o(e.ua+1,2)},"%M":function(e){return o(e.Da,2)},"%n":function(){return"\\n"},"%p":function(e){return 0<=e.ta&&12>e.ta?"AM":"PM"},"%S":function(e){return o(e.Ea,2)},"%t":function(){return"\\t"},"%u":function(e){return e.la||7},"%U":function(e){return o(Math.floor((e.qa+7-e.la)/7),2)},"%V":function(e){var t=Math.floor((e.qa+7-(e.la+6)%7)/7);if(2>=(e.la+371-e.qa-2)%7&&t++,t)53==t&&(4==(n=(e.la+371-e.qa)%7)||3==n&&te(e.ra)||(t=1));else{t=52;var n=(e.la+7-e.qa-1)%7;(4==n||5==n&&te(e.ra%400-1))&&t++}return o(t,2)},"%w":function(e){return e.la},"%W":function(e){return o(Math.floor((e.qa+7-(e.la+6)%7)/7),2)},"%y":function(e){return(e.ra+1900).toString().substring(2)},"%Y":function(e){return e.ra+1900},"%z":function(e){var t=0<=(e=e.Ca);return e=Math.abs(e)/60,(t?"+":"-")+String("0000"+(e/60*100+e%60)).slice(-4)},"%Z":function(e){return e.Fa},"%%":function(){return"%"}},n=n.replace(/%%/g,"\\0\\0"),c)n.includes(l)&&(n=n.replace(new RegExp(l,"g"),c[l](r)));return l=function(e){var t=Array(D(e)+1);return k(e,t,0,t.length),t}(n=n.replace(/\\0\\0/g,"%")),l.length>t?0:(T.set(l,e>>>0),l.length-1)}var oe={a:function(e){return ie(e+24)+24},b:function(e,t,n){throw new J(e).ya(t,n),e},g:function(){return 0},I:function(){},w:function(){},y:function(){},K:function(){return 0},G:function(){},C:function(){},F:function(){},k:function(){},x:function(){},u:function(){},H:function(){},v:function(){},n:function(){},p:function(){B("To use dlopen, you need enable dynamic linking, see https://github.com/emscripten-core/emscripten/wiki/Linking")},o:function(){B("To use dlopen, you need enable dynamic linking, see https://github.com/emscripten-core/emscripten/wiki/Linking")},l:function(){return Date.now()},L:function(){return!0},M:function(e,t){e=new Date(1e3*(M[e>>>2]+4294967296*E[e+4>>>2])),E[t>>2>>>0]=e.getUTCSeconds(),E[t+4>>2>>>0]=e.getUTCMinutes(),E[t+8>>2>>>0]=e.getUTCHours(),E[t+12>>2>>>0]=e.getUTCDate(),E[t+16>>2>>>0]=e.getUTCMonth(),E[t+20>>2>>>0]=e.getUTCFullYear()-1900,E[t+24>>2>>>0]=e.getUTCDay(),E[t+28>>2>>>0]=(e.getTime()-Date.UTC(e.getUTCFullYear(),0,1,0,0,0,0))/864e5|0},N:function(e,t){e=new Date(1e3*(M[e>>>2]+4294967296*E[e+4>>>2])),E[t>>2>>>0]=e.getSeconds(),E[t+4>>2>>>0]=e.getMinutes(),E[t+8>>2>>>0]=e.getHours(),E[t+12>>2>>>0]=e.getDate(),E[t+16>>2>>>0]=e.getMonth(),E[t+20>>2>>>0]=e.getFullYear()-1900,E[t+24>>2>>>0]=e.getDay();var n=new Date(e.getFullYear(),0,1);E[t+28>>2>>>0]=(e.getTime()-n.getTime())/864e5|0,E[t+36>>2>>>0]=-60*e.getTimezoneOffset();var r=new Date(e.getFullYear(),6,1).getTimezoneOffset();n=n.getTimezoneOffset(),E[t+32>>2>>>0]=0|(r!=n&&e.getTimezoneOffset()==Math.min(n,r))},O:function(e){var t=new Date(E[e+20>>2>>>0]+1900,E[e+16>>2>>>0],E[e+12>>2>>>0],E[e+8>>2>>>0],E[e+4>>2>>>0],E[e>>2>>>0],0),n=E[e+32>>2>>>0],r=t.getTimezoneOffset(),a=new Date(t.getFullYear(),0,1),o=new Date(t.getFullYear(),6,1).getTimezoneOffset(),i=a.getTimezoneOffset(),s=Math.min(i,o);return 0>n?E[e+32>>2>>>0]=Number(o!=i&&s==r):0<n!=(s==r)&&(o=Math.max(i,o),t.setTime(t.getTime()+6e4*((0<n?s:o)-r))),E[e+24>>2>>>0]=t.getDay(),E[e+28>>2>>>0]=(t.getTime()-a.getTime())/864e5|0,E[e>>2>>>0]=t.getSeconds(),E[e+4>>2>>>0]=t.getMinutes(),E[e+8>>2>>>0]=t.getHours(),E[e+12>>2>>>0]=t.getDate(),E[e+16>>2>>>0]=t.getMonth(),t.getTime()/1e3|0},z:function(){return-52},B:function(){},m:function e(t,n,r){e.xa||(e.xa=!0,function(e,t,n){function r(e){return(e=e.toTimeString().match(/\\(([A-Za-z ]+)\\)$/))?e[1]:"GMT"}var a=(new Date).getFullYear(),o=new Date(a,0,1),i=new Date(a,6,1);a=o.getTimezoneOffset();var s=i.getTimezoneOffset();E[e>>2>>>0]=60*Math.max(a,s),E[t>>2>>>0]=Number(a!=s),e=r(o),t=r(i),e=Q(e),t=Q(t),s<a?(M[n>>2>>>0]=e,M[n+4>>2>>>0]=t):(M[n>>2>>>0]=t,M[n+4>>2>>>0]=e)}(t,n,r))},d:function(){B("")},t:function(){return 4294901760},h:h?()=>{var e=process.hrtime();return 1e3*e[0]+e[1]/1e6}:()=>performance.now(),J:function(e,t,n){A.copyWithin(e>>>0,t>>>0,t+n>>>0)},f:function(e){var t=A.length;if(4294901760<(e>>>=0))return!1;for(var n=1;4>=n;n*=2){var r=t*(1+.2/n);r=Math.min(r,e+100663296);var a=Math;r=Math.max(e,r),a=a.min.call(a,4294901760,r+(65536-r%65536)%65536);e:{try{O.grow(a-S.byteLength+65535>>>16),F();var o=1;break e}catch(e){}o=void 0}if(o)return!0}return!1},D:function(e,t){var n=0;return K().forEach((function(r,a){var o=t+n;for(a=M[e+4*a>>2>>>0]=o,o=0;o<r.length;++o)T[a++>>0>>>0]=r.charCodeAt(o);T[a>>0>>>0]=0,n+=r.length+1})),0},E:function(e,t){var n=K();M[e>>2>>>0]=n.length;var r=0;return n.forEach((function(e){r+=e.length+1})),M[t>>2>>>0]=r,0},r:function(e){_||(t.onExit&&t.onExit(e),R=!0),d(e,new $(e))},e:function(){return 52},j:function(){return 52},q:function(){return 70},i:function(e,t,n,r){for(var a=0,o=0;o<n;o++){var i=M[t>>2>>>0],s=M[t+4>>2>>>0];t+=8;for(var u=0;u<s;u++){var c=A[i+u>>>0],l=ee[e];0===c||10===c?((1===e?b:w)(C(l,0)),l.length=0):l.push(c)}a+=s}return M[r>>2>>>0]=a,0},s:function e(t,r){e.wa||(e.wa=function(){if("object"==typeof crypto&&"function"==typeof crypto.getRandomValues){var e=new Uint8Array(1);return()=>(crypto.getRandomValues(e),e[0])}if(h)try{var t=n(760);return()=>t.randomBytes(1)[0]}catch(e){}return()=>B("randomDevice")}());for(var a=0;a<r;a++)T[t+a>>0>>>0]=e.wa();return 0},A:ae,c:function(e,t,n,r){return ae(e,t,n,r)}};!function(){function e(e){t.asm=e.exports,O=t.asm.P,F(),I.unshift(t.asm.Q),L--,t.monitorRunDependencies&&t.monitorRunDependencies(L),0==L&&(null!==Y&&(clearInterval(Y),Y=null),z&&(e=z,z=null,e()))}function n(t){e(t.instance)}function r(e){return function(){if(!v&&(m||g)){if("function"==typeof fetch&&!H.startsWith("file://"))return fetch(H,{credentials:"same-origin"}).then((function(e){if(!e.ok)throw"failed to load wasm binary file at \'"+H+"\'";return e.arrayBuffer()})).catch((function(){return q()}));if(i)return new Promise((function(e,t){i(H,(function(t){e(new Uint8Array(t))}),t)}))}return Promise.resolve().then((function(){return q()}))}().then((function(e){return WebAssembly.instantiate(e,o)})).then((function(e){return e})).then(e,(function(e){w("failed to asynchronously prepare wasm: "+e),B(e)}))}var o={a:oe};if(L++,t.monitorRunDependencies&&t.monitorRunDependencies(L),t.instantiateWasm)try{return t.instantiateWasm(o,e)}catch(e){return w("Module.instantiateWasm callback failed with error: "+e),!1}(v||"function"!=typeof WebAssembly.instantiateStreaming||N()||H.startsWith("file://")||h||"function"!=typeof fetch?r(n):fetch(H,{credentials:"same-origin"}).then((function(e){return WebAssembly.instantiateStreaming(e,o).then(n,(function(e){return w("wasm streaming compile failed: "+e),w("falling back to ArrayBuffer instantiation"),r(n)}))}))).catch(a)}(),t.___wasm_call_ctors=function(){return(t.___wasm_call_ctors=t.asm.Q).apply(null,arguments)},t._OrtInit=function(){return(t._OrtInit=t.asm.R).apply(null,arguments)},t._OrtCreateSessionOptions=function(){return(t._OrtCreateSessionOptions=t.asm.S).apply(null,arguments)},t._OrtAppendExecutionProvider=function(){return(t._OrtAppendExecutionProvider=t.asm.T).apply(null,arguments)},t._OrtAddSessionConfigEntry=function(){return(t._OrtAddSessionConfigEntry=t.asm.U).apply(null,arguments)},t._OrtReleaseSessionOptions=function(){return(t._OrtReleaseSessionOptions=t.asm.V).apply(null,arguments)},t._OrtCreateSession=function(){return(t._OrtCreateSession=t.asm.W).apply(null,arguments)},t._OrtReleaseSession=function(){return(t._OrtReleaseSession=t.asm.X).apply(null,arguments)},t._OrtGetInputCount=function(){return(t._OrtGetInputCount=t.asm.Y).apply(null,arguments)},t._OrtGetOutputCount=function(){return(t._OrtGetOutputCount=t.asm.Z).apply(null,arguments)},t._OrtGetInputName=function(){return(t._OrtGetInputName=t.asm._).apply(null,arguments)},t._OrtGetOutputName=function(){return(t._OrtGetOutputName=t.asm.$).apply(null,arguments)},t._OrtFree=function(){return(t._OrtFree=t.asm.aa).apply(null,arguments)},t._OrtCreateTensor=function(){return(t._OrtCreateTensor=t.asm.ba).apply(null,arguments)},t._OrtGetTensorData=function(){return(t._OrtGetTensorData=t.asm.ca).apply(null,arguments)},t._OrtReleaseTensor=function(){return(t._OrtReleaseTensor=t.asm.da).apply(null,arguments)},t._OrtCreateRunOptions=function(){return(t._OrtCreateRunOptions=t.asm.ea).apply(null,arguments)},t._OrtAddRunConfigEntry=function(){return(t._OrtAddRunConfigEntry=t.asm.fa).apply(null,arguments)},t._OrtReleaseRunOptions=function(){return(t._OrtReleaseRunOptions=t.asm.ga).apply(null,arguments)},t._OrtRun=function(){return(t._OrtRun=t.asm.ha).apply(null,arguments)},t._OrtEndProfiling=function(){return(t._OrtEndProfiling=t.asm.ia).apply(null,arguments)};var ie=t._malloc=function(){return(ie=t._malloc=t.asm.ja).apply(null,arguments)};t._free=function(){return(t._free=t.asm.ka).apply(null,arguments)};var se,ue=t.stackSave=function(){return(ue=t.stackSave=t.asm.ma).apply(null,arguments)},ce=t.stackRestore=function(){return(ce=t.stackRestore=t.asm.na).apply(null,arguments)},le=t.stackAlloc=function(){return(le=t.stackAlloc=t.asm.oa).apply(null,arguments)};function fe(){function e(){if(!se&&(se=!0,t.calledRun=!0,!R)){if(V(I),r(t),t.onRuntimeInitialized&&t.onRuntimeInitialized(),t.postRun)for("function"==typeof t.postRun&&(t.postRun=[t.postRun]);t.postRun.length;){var e=t.postRun.shift();W.unshift(e)}V(W)}}if(!(0<L)){if(t.preRun)for("function"==typeof t.preRun&&(t.preRun=[t.preRun]);t.preRun.length;)j();V(U),0<L||(t.setStatus?(t.setStatus("Running..."),setTimeout((function(){setTimeout((function(){t.setStatus("")}),1),e()}),1)):e())}}if(t.___cxa_is_pointer_type=function(){return(t.___cxa_is_pointer_type=t.asm.pa).apply(null,arguments)},t.UTF8ToString=P,t.stringToUTF8=function(e,t,n){return k(e,A,t,n)},t.lengthBytesUTF8=D,t.stackSave=ue,t.stackRestore=ce,t.stackAlloc=le,z=function e(){se||fe(),se||(z=e)},t.preInit)for("function"==typeof t.preInit&&(t.preInit=[t.preInit]);0<t.preInit.length;)t.preInit.pop()();return fe(),e.ready});e.exports=r},154:e=>{"use strict";e.exports=\'"use strict";var e={},t="object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node;if(t){var r=require("worker_threads"),a=r.parentPort;a.on("message",(e=>onmessage({data:e})));var o=require("fs");Object.assign(global,{self:global,require:require,Module:e,location:{href:__filename},Worker:r.Worker,importScripts:function(e){(0,eval)(o.readFileSync(e,"utf8"))},postMessage:function(e){a.postMessage(e)},performance:global.performance||{now:function(){return Date.now()}}})}var s=!1,n=[],i=function(){var e=Array.prototype.slice.call(arguments).join(" ");t?o.writeSync(2,e+"\\\\n"):console.error(e)};self.alert=function(){var t=Array.prototype.slice.call(arguments).join(" ");postMessage({cmd:"alert",text:t,threadId:e._pthread_self()})},e.instantiateWasm=(t,r)=>{var a=new WebAssembly.Instance(e.wasmModule,t);return r(a),e.wasmModule=null,a.exports},self.onunhandledrejection=e=>{throw e.reason??e},self.onmessage=t=>{try{if("load"===t.data.cmd){if(e.wasmModule=t.data.wasmModule,e.wasmMemory=t.data.wasmMemory,e.buffer=e.wasmMemory.buffer,e.ENVIRONMENT_IS_PTHREAD=!0,"string"==typeof t.data.urlOrBlob)importScripts(t.data.urlOrBlob);else{var r=URL.createObjectURL(t.data.urlOrBlob);importScripts(r),URL.revokeObjectURL(r)}ortWasmThreaded(e).then((function(t){e=t}))}else if("run"===t.data.cmd){e.__performance_now_clock_drift=performance.now()-t.data.time,e.__emscripten_thread_init(t.data.pthread_ptr,0,0,1),e.establishStackSpace(),e.PThread.receiveObjectTransfer(t.data),e.PThread.threadInitTLS(),s||(n.forEach((t=>{e.executeNotifiedProxyingQueue(t)})),n=[],s=!0);try{e.invokeEntryPoint(t.data.start_routine,t.data.arg)}catch(t){if("unwind"!=t){if(!(t instanceof e.ExitStatus))throw t;e.keepRuntimeAlive()||e.__emscripten_thread_exit(t.status)}}}else"cancel"===t.data.cmd?e._pthread_self()&&e.__emscripten_thread_exit(-1):"setimmediate"===t.data.target||("processProxyingQueue"===t.data.cmd?s?e.executeNotifiedProxyingQueue(t.data.queue):n.push(t.data.queue):(i("worker.js received unknown command "+t.data.cmd),i(t.data)))}catch(t){throw i("worker.js onmessage() captured an uncaught exception: "+t),t&&t.stack&&i(t.stack),e.__emscripten_thread_crashed&&e.__emscripten_thread_crashed(),t}};\\n\'},760:()=>{},384:()=>{},993:()=>{},908:()=>{},953:()=>{},925:()=>{},449:()=>{}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var o=t[r]={exports:{}};return e[r].call(o.exports,o,o.exports,n),o.exports}n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),(()=>{"use strict";const e=n(259),t=n(263);self.onmessage=n=>{switch(n.data.type){case"init-wasm":(0,t.initializeWebAssembly)(n.data.in).then((()=>postMessage({type:"init-wasm"})),(e=>postMessage({type:"init-wasm",err:e})));break;case"init-ort":try{const{numThreads:t,loggingLevel:r}=n.data.in;(0,e.initOrt)(t,r),postMessage({type:"init-ort"})}catch(e){postMessage({type:"init-ort",err:e})}break;case"create_allocate":try{const{model:t}=n.data.in,r=(0,e.createSessionAllocate)(t);postMessage({type:"create_allocate",out:r})}catch(e){postMessage({type:"create_allocate",err:e})}break;case"create_finalize":try{const{modeldata:t,options:r}=n.data.in,a=(0,e.createSessionFinalize)(t,r);postMessage({type:"create_finalize",out:a})}catch(e){postMessage({type:"create_finalize",err:e})}break;case"create":try{const{model:t,options:r}=n.data.in,a=(0,e.createSession)(t,r);postMessage({type:"create",out:a})}catch(e){postMessage({type:"create",err:e})}break;case"release":try{const t=n.data.in;(0,e.releaseSession)(t),postMessage({type:"release"})}catch(e){postMessage({type:"release",err:e})}break;case"run":try{const{sessionId:t,inputIndices:r,inputs:a,outputIndices:o,options:i}=n.data.in;(0,e.run)(t,r,a,o,i).then((t=>{postMessage({type:"run",out:t},(0,e.extractTransferableBuffers)(t))}),(e=>{postMessage({type:"run",err:e})}))}catch(e){postMessage({type:"run",err:e})}break;case"end-profiling":try{const t=n.data.in;(0,e.endProfiling)(t),postMessage({type:"end-profiling"})}catch(e){postMessage({type:"end-profiling",err:e})}}}})()})();\n',"Worker",void 0,void 0)}},6614:_r=>{_r.exports=function(Tr,Ar,Rr,Pr){var Dr=self||window;try{try{var Mr;try{Mr=new Dr.Blob([Tr])}catch{(Mr=new(Dr.BlobBuilder||Dr.WebKitBlobBuilder||Dr.MozBlobBuilder||Dr.MSBlobBuilder)).append(Tr),Mr=Mr.getBlob()}var Fr=Dr.URL||Dr.webkitURL,zr=Fr.createObjectURL(Mr),jr=new Dr[Ar](zr,Rr);return Fr.revokeObjectURL(zr),jr}catch{return new Dr[Ar]("data:application/javascript,".concat(encodeURIComponent(Tr)),Rr)}}catch{if(!Pr)throw Error("Inline worker is not supported");return new Dr[Ar](Pr,Rr)}}},3474:(_r,Tr,Ar)=>{var Rr,Pr=(Rr=(Rr=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0)||"/index.js",function(Dr){function Mr(){return Ds.buffer!=zs&&ds(Ds.buffer),qs}function Fr(){return Ds.buffer!=zs&&ds(Ds.buffer),fo}function zr(){return Ds.buffer!=zs&&ds(Ds.buffer),Qs}function jr(){return Ds.buffer!=zs&&ds(Ds.buffer),no}function Gr(){return Ds.buffer!=zs&&ds(Ds.buffer),yo}var Nr,Lr,Ur;Dr=Dr||{},Nr||(Nr=Dr!==void 0?Dr:{}),Nr.ready=new Promise(function(Cs,Ls){Lr=Cs,Ur=Ls});var Vr,Wr,qr,Kr,Xr,Zr,_i=Object.assign({},Nr),Jr="./this.program",es=(Cs,Ls)=>{throw Ls},ts=typeof window=="object",is=typeof importScripts=="function",rs=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",as=Nr.ENVIRONMENT_IS_PTHREAD||!1,ls="";function fs(Cs){return Nr.locateFile?Nr.locateFile(Cs,ls):ls+Cs}if(rs){let Cs;ls=is?Ar(908).dirname(ls)+"/":"//",Zr=()=>{Xr||(Kr=Ar(1384),Xr=Ar(908))},Vr=function(Ls,Us){return Zr(),Ls=Xr.normalize(Ls),Kr.readFileSync(Ls,Us?void 0:"utf8")},qr=Ls=>((Ls=Vr(Ls,!0)).buffer||(Ls=new Uint8Array(Ls)),Ls),Wr=(Ls,Us,Xs)=>{Zr(),Ls=Xr.normalize(Ls),Kr.readFile(Ls,function(po,ms){po?Xs(po):Us(ms.buffer)})},1<process.argv.length&&(Jr=process.argv[1].replace(/\\/g,"/")),process.argv.slice(2),process.on("uncaughtException",function(Ls){if(!(Ls instanceof Dl))throw Ls}),process.on("unhandledRejection",function(Ls){throw Ls}),es=(Ls,Us)=>{if(vs)throw process.exitCode=Ls,Us;Us instanceof Dl||ps("exiting due to exception: "+Us),process.exit(Ls)},Nr.inspect=function(){return"[Emscripten Module object]"};try{Cs=Ar(9925)}catch(Ls){throw console.error('The "worker_threads" module is not supported in this node.js build - perhaps a newer version is needed?'),Ls}Ar.g.Worker=Cs.Worker}else(ts||is)&&(is?ls=self.location.href:typeof document<"u"&&document.currentScript&&(ls=document.currentScript.src),Rr&&(ls=Rr),ls=ls.indexOf("blob:")!==0?ls.substr(0,ls.replace(/[?#].*/,"").lastIndexOf("/")+1):"",rs||(Vr=Cs=>{var Ls=new XMLHttpRequest;return Ls.open("GET",Cs,!1),Ls.send(null),Ls.responseText},is&&(qr=Cs=>{var Ls=new XMLHttpRequest;return Ls.open("GET",Cs,!1),Ls.responseType="arraybuffer",Ls.send(null),new Uint8Array(Ls.response)}),Wr=(Cs,Ls,Us)=>{var Xs=new XMLHttpRequest;Xs.open("GET",Cs,!0),Xs.responseType="arraybuffer",Xs.onload=()=>{Xs.status==200||Xs.status==0&&Xs.response?Ls(Xs.response):Us()},Xs.onerror=Us,Xs.send(null)}));rs&&typeof performance>"u"&&(Ar.g.performance=Ar(6953).performance);var Ts=console.log.bind(console),$s=console.warn.bind(console);rs&&(Zr(),Ts=Cs=>Kr.writeSync(1,Cs+`
`),$s=Cs=>Kr.writeSync(2,Cs+`
`));var xs,ys=Nr.print||Ts,ps=Nr.printErr||$s;Object.assign(Nr,_i),_i=null,Nr.thisProgram&&(Jr=Nr.thisProgram),Nr.quit&&(es=Nr.quit),Nr.wasmBinary&&(xs=Nr.wasmBinary);var vs=Nr.noExitRuntime||!0;typeof WebAssembly!="object"&&Io("no native wasm support detected");var Ds,js,zs,qs,fo,Qs,no,yo,Js=!1,lo=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function vo(Cs,Ls,Us){var Xs=(Ls>>>=0)+Us;for(Us=Ls;Cs[Us]&&!(Us>=Xs);)++Us;if(16<Us-Ls&&Cs.buffer&&lo)return lo.decode(Cs.buffer instanceof SharedArrayBuffer?Cs.slice(Ls,Us):Cs.subarray(Ls,Us));for(Xs="";Ls<Us;){var po=Cs[Ls++];if(128&po){var ms=63&Cs[Ls++];if((224&po)==192)Xs+=String.fromCharCode((31&po)<<6|ms);else{var os=63&Cs[Ls++];65536>(po=(240&po)==224?(15&po)<<12|ms<<6|os:(7&po)<<18|ms<<12|os<<6|63&Cs[Ls++])?Xs+=String.fromCharCode(po):(po-=65536,Xs+=String.fromCharCode(55296|po>>10,56320|1023&po))}}else Xs+=String.fromCharCode(po)}return Xs}function Ro(Cs,Ls){return(Cs>>>=0)?vo(Fr(),Cs,Ls):""}function Co(Cs,Ls,Us,Xs){if(!(0<Xs))return 0;var po=Us>>>=0;Xs=Us+Xs-1;for(var ms=0;ms<Cs.length;++ms){var os=Cs.charCodeAt(ms);if(55296<=os&&57343>=os&&(os=65536+((1023&os)<<10)|1023&Cs.charCodeAt(++ms)),127>=os){if(Us>=Xs)break;Ls[Us++>>>0]=os}else{if(2047>=os){if(Us+1>=Xs)break;Ls[Us++>>>0]=192|os>>6}else{if(65535>=os){if(Us+2>=Xs)break;Ls[Us++>>>0]=224|os>>12}else{if(Us+3>=Xs)break;Ls[Us++>>>0]=240|os>>18,Ls[Us++>>>0]=128|os>>12&63}Ls[Us++>>>0]=128|os>>6&63}Ls[Us++>>>0]=128|63&os}}return Ls[Us>>>0]=0,Us-po}function Do(Cs){for(var Ls=0,Us=0;Us<Cs.length;++Us){var Xs=Cs.charCodeAt(Us);127>=Xs?Ls++:2047>=Xs?Ls+=2:55296<=Xs&&57343>=Xs?(Ls+=4,++Us):Ls+=3}return Ls}function ds(Cs){zs=Cs,Nr.HEAP8=qs=new Int8Array(Cs),Nr.HEAP16=new Int16Array(Cs),Nr.HEAP32=Qs=new Int32Array(Cs),Nr.HEAPU8=fo=new Uint8Array(Cs),Nr.HEAPU16=new Uint16Array(Cs),Nr.HEAPU32=no=new Uint32Array(Cs),Nr.HEAPF32=new Float32Array(Cs),Nr.HEAPF64=yo=new Float64Array(Cs)}as&&(zs=Nr.buffer);var Os=Nr.INITIAL_MEMORY||16777216;if(as)Ds=Nr.wasmMemory,zs=Nr.buffer;else if(Nr.wasmMemory)Ds=Nr.wasmMemory;else if(!((Ds=new WebAssembly.Memory({initial:Os/65536,maximum:65536,shared:!0})).buffer instanceof SharedArrayBuffer))throw ps("requested a shared WebAssembly.Memory but the returned buffer is not a SharedArrayBuffer, indicating that while the browser has SharedArrayBuffer it does not have WebAssembly threads support - you may need to set a flag"),rs&&console.log("(on node you may need: --experimental-wasm-threads --experimental-wasm-bulk-memory and also use a recent version)"),Error("bad memory");Ds&&(zs=Ds.buffer),Os=zs.byteLength,ds(zs);var Ws,to=[],io=[],ko=[];function go(){var Cs=Nr.preRun.shift();to.unshift(Cs)}var To,Ho=0,Uo=null;function Io(Cs){throw as?postMessage({cmd:"onAbort",arg:Cs}):Nr.onAbort&&Nr.onAbort(Cs),ps(Cs="Aborted("+Cs+")"),Js=!0,Cs=new WebAssembly.RuntimeError(Cs+". Build with -sASSERTIONS for more info."),Ur(Cs),Cs}function xl(){return To.startsWith("data:application/octet-stream;base64,")}function Xo(){var Cs=To;try{if(Cs==To&&xs)return new Uint8Array(xs);if(qr)return qr(Cs);throw"both async and sync fetching of the wasm failed"}catch(Ls){Io(Ls)}}To="ort-wasm-threaded.wasm",xl()||(To=fs(To));var El={};function Dl(Cs){this.name="ExitStatus",this.message="Program terminated with exit("+Cs+")",this.status=Cs}function ru(Cs){(Cs=Vo.La[Cs])||Io(),Vo.Xa(Cs)}function Ul(Cs){var Ls=Vo.lb();if(!Ls)return 6;Vo.Ra.push(Ls),Vo.La[Cs.Ka]=Ls,Ls.Ka=Cs.Ka;var Us={cmd:"run",start_routine:Cs.pb,arg:Cs.ib,pthread_ptr:Cs.Ka};return Ls.Qa=()=>{Us.time=performance.now(),Ls.postMessage(Us,Cs.vb)},Ls.loaded&&(Ls.Qa(),delete Ls.Qa),0}function Kl(Cs){if(as)return Ll(1,1,Cs);vs||(Vo.qb(),Nr.onExit&&Nr.onExit(Cs),Js=!0),es(Cs,new Dl(Cs))}function vu(Cs,Ls){if(!Ls&&as)throw Ks(Cs),"unwind";Kl(Cs)}var Vo={Oa:[],Ra:[],$a:[],La:{},Ua:function(){as&&Vo.mb()},xb:function(){},mb:function(){Vo.receiveObjectTransfer=Vo.ob,Vo.threadInitTLS=Vo.Za,Vo.setExitStatus=Vo.Ya,vs=!1},Ya:function(){},qb:function(){for(var Cs of Object.values(Vo.La))Vo.Xa(Cs);for(Cs of Vo.Oa)Cs.terminate();Vo.Oa=[]},Xa:function(Cs){var Ls=Cs.Ka;delete Vo.La[Ls],Vo.Oa.push(Cs),Vo.Ra.splice(Vo.Ra.indexOf(Cs),1),Cs.Ka=0,mp(Ls)},ob:function(){},Za:function(){Vo.$a.forEach(Cs=>Cs())},nb:function(Cs,Ls){Cs.onmessage=Us=>{var Xs=(Us=Us.data).cmd;if(Cs.Ka&&(Vo.kb=Cs.Ka),Us.targetThread&&Us.targetThread!=Nu()){var po=Vo.La[Us.yb];po?po.postMessage(Us,Us.transferList):ps('Internal error! Worker sent a message "'+Xs+'" to target pthread '+Us.targetThread+", but that thread no longer exists!")}else Xs==="processProxyingQueue"?_h(Us.queue):Xs==="spawnThread"?Ul(Us):Xs==="cleanupThread"?ru(Us.thread):Xs==="killThread"?(Us=Us.thread,Xs=Vo.La[Us],delete Vo.La[Us],Xs.terminate(),mp(Us),Vo.Ra.splice(Vo.Ra.indexOf(Xs),1),Xs.Ka=0):Xs==="cancelThread"?Vo.La[Us.thread].postMessage({cmd:"cancel"}):Xs==="loaded"?(Cs.loaded=!0,Ls&&Ls(Cs),Cs.Qa&&(Cs.Qa(),delete Cs.Qa)):Xs==="print"?ys("Thread "+Us.threadId+": "+Us.text):Xs==="printErr"?ps("Thread "+Us.threadId+": "+Us.text):Xs==="alert"?alert("Thread "+Us.threadId+": "+Us.text):Us.target==="setimmediate"?Cs.postMessage(Us):Xs==="onAbort"?Nr.onAbort&&Nr.onAbort(Us.arg):Xs&&ps("worker sent an unknown command "+Xs);Vo.kb=void 0},Cs.onerror=Us=>{throw ps("worker sent an error! "+Us.filename+":"+Us.lineno+": "+Us.message),Us},rs&&(Cs.on("message",function(Us){Cs.onmessage({data:Us})}),Cs.on("error",function(Us){Cs.onerror(Us)}),Cs.on("detachedExit",function(){})),Cs.postMessage({cmd:"load",urlOrBlob:Nr.mainScriptUrlOrBlob||Rr,wasmMemory:Ds,wasmModule:js})},hb:function(){var Cs=fs("ort-wasm-threaded.worker.js");Vo.Oa.push(new Worker(Cs))},lb:function(){return Vo.Oa.length==0&&(Vo.hb(),Vo.nb(Vo.Oa[0])),Vo.Oa.pop()}};function Fs(Cs){for(;0<Cs.length;)Cs.shift()(Nr)}function Ks(Cs){if(as)return Ll(2,0,Cs);try{vu(Cs)}catch(Ls){Ls instanceof Dl||Ls=="unwind"||es(1,Ls)}}Nr.PThread=Vo,Nr.establishStackSpace=function(){var Cs=Nu(),Ls=zr()[Cs+44>>2>>>0];Cs=zr()[Cs+48>>2>>>0],yp(Ls,Ls-Cs),Nl(Ls)};var gs,hs,Ps=[];function ks(Cs){this.Pa=Cs-24,this.gb=function(Ls){jr()[this.Pa+4>>2>>>0]=Ls},this.cb=function(Ls){jr()[this.Pa+8>>2>>>0]=Ls},this.eb=function(){zr()[this.Pa>>2>>>0]=0},this.bb=function(){Mr()[this.Pa+12>>0>>>0]=0},this.fb=function(){Mr()[this.Pa+13>>0>>>0]=0},this.Ua=function(Ls,Us){this.ab(),this.gb(Ls),this.cb(Us),this.eb(),this.bb(),this.fb()},this.ab=function(){jr()[this.Pa+16>>2>>>0]=0}}function Zs(Cs,Ls,Us,Xs){return as?Ll(3,1,Cs,Ls,Us,Xs):bo(Cs,Ls,Us,Xs)}function bo(Cs,Ls,Us,Xs){if(typeof SharedArrayBuffer>"u")return ps("Current environment does not support SharedArrayBuffer, pthreads are not available!"),6;var po=[];return as&&po.length===0?Zs(Cs,Ls,Us,Xs):(Cs={pb:Us,Ka:Cs,ib:Xs,vb:po},as?(Cs.wb="spawnThread",postMessage(Cs,po),0):Ul(Cs))}function ho(Cs,Ls,Us){return as?Ll(4,1,Cs,Ls,Us):0}function eo(Cs,Ls){if(as)return Ll(5,1,Cs,Ls)}function Po(Cs,Ls){if(as)return Ll(6,1,Cs,Ls)}function qo(Cs,Ls,Us){if(as)return Ll(7,1,Cs,Ls,Us)}function zo(Cs,Ls,Us){return as?Ll(8,1,Cs,Ls,Us):0}function Hs(Cs,Ls){if(as)return Ll(9,1,Cs,Ls)}function wo(Cs,Ls,Us){if(as)return Ll(10,1,Cs,Ls,Us)}function xo(Cs,Ls,Us,Xs){if(as)return Ll(11,1,Cs,Ls,Us,Xs)}function Yl(Cs,Ls,Us,Xs){if(as)return Ll(12,1,Cs,Ls,Us,Xs)}function xu(Cs,Ls,Us,Xs){if(as)return Ll(13,1,Cs,Ls,Us,Xs)}function ju(Cs){if(as)return Ll(14,1,Cs)}function _f(Cs,Ls){if(as)return Ll(15,1,Cs,Ls)}function zu(Cs,Ls,Us){if(as)return Ll(16,1,Cs,Ls,Us)}function _h(Cs){Atomics.store(zr(),Cs>>2,1),Nu()&&eu(Cs),Atomics.compareExchange(zr(),Cs>>2,1,0)}function ep(Cs){return jr()[Cs>>>2]+4294967296*zr()[Cs+4>>>2]}function Ru(Cs,Ls,Us,Xs,po,ms){return as?Ll(17,1,Cs,Ls,Us,Xs,po,ms):-52}function Su(Cs,Ls,Us,Xs,po,ms){if(as)return Ll(18,1,Cs,Ls,Us,Xs,po,ms)}function lp(Cs){var Ls=Do(Cs)+1,Us=pp(Ls);return Us&&Co(Cs,Mr(),Us,Ls),Us}function cu(Cs,Ls,Us){function Xs(ss){return(ss=ss.toTimeString().match(/\(([A-Za-z ]+)\)$/))?ss[1]:"GMT"}if(as)return Ll(19,1,Cs,Ls,Us);var po=new Date().getFullYear(),ms=new Date(po,0,1),os=new Date(po,6,1);po=ms.getTimezoneOffset();var us=os.getTimezoneOffset(),Ss=Math.max(po,us);zr()[Cs>>2>>>0]=60*Ss,zr()[Ls>>2>>>0]=+(po!=us),Cs=Xs(ms),Ls=Xs(os),Cs=lp(Cs),Ls=lp(Ls),us<po?(jr()[Us>>2>>>0]=Cs,jr()[Us+4>>2>>>0]=Ls):(jr()[Us>>2>>>0]=Ls,jr()[Us+4>>2>>>0]=Cs)}function Ll(Cs,Ls){var Us=arguments.length-2,Xs=arguments;return function(po){var ms=Ju();return po=po(),Nl(ms),po}(()=>{for(var po=zl(8*Us),ms=po>>3,os=0;os<Us;os++){var us=Xs[2+os];Gr()[ms+os>>>0]=us}return Pp(Cs,Us,po,Ls)})}Nr.invokeEntryPoint=function(Cs,Ls){var Us=Ps[Cs];Us||(Cs>=Ps.length&&(Ps.length=Cs+1),Ps[Cs]=Us=Ws.get(Cs)),Cs=Us(Ls),vs?Vo.Ya(Cs):iu(Cs)},Nr.executeNotifiedProxyingQueue=_h,hs=rs?()=>{var Cs=process.hrtime();return 1e3*Cs[0]+Cs[1]/1e6}:as?()=>performance.now()-Nr.__performance_now_clock_drift:()=>performance.now();var Vu,Ou=[],tp={};function up(){if(!Vu){var Cs,Ls={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:Jr||"./this.program"};for(Cs in tp)tp[Cs]===void 0?delete Ls[Cs]:Ls[Cs]=tp[Cs];var Us=[];for(Cs in Ls)Us.push(Cs+"="+Ls[Cs]);Vu=Us}return Vu}function cp(Cs,Ls){if(as)return Ll(20,1,Cs,Ls);var Us=0;return up().forEach(function(Xs,po){var ms=Ls+Us;for(po=jr()[Cs+4*po>>2>>>0]=ms,ms=0;ms<Xs.length;++ms)Mr()[po++>>0>>>0]=Xs.charCodeAt(ms);Mr()[po>>0>>>0]=0,Us+=Xs.length+1}),0}function dp(Cs,Ls){if(as)return Ll(21,1,Cs,Ls);var Us=up();jr()[Cs>>2>>>0]=Us.length;var Xs=0;return Us.forEach(function(po){Xs+=po.length+1}),jr()[Ls>>2>>>0]=Xs,0}function Rp(Cs){return as?Ll(22,1,Cs):52}function Zu(Cs,Ls,Us,Xs){return as?Ll(23,1,Cs,Ls,Us,Xs):52}function fp(Cs,Ls,Us,Xs,po){return as?Ll(24,1,Cs,Ls,Us,Xs,po):70}var Qu=[null,[],[]];function Hu(Cs,Ls,Us,Xs){if(as)return Ll(25,1,Cs,Ls,Us,Xs);for(var po=0,ms=0;ms<Us;ms++){var os=jr()[Ls>>2>>>0],us=jr()[Ls+4>>2>>>0];Ls+=8;for(var Ss=0;Ss<us;Ss++){var ss=Fr()[os+Ss>>>0],bs=Qu[Cs];ss===0||ss===10?((Cs===1?ys:ps)(vo(bs,0)),bs.length=0):bs.push(ss)}po+=us}return jr()[Xs>>2>>>0]=po,0}function Pl(Cs){return Cs%4==0&&(Cs%100!=0||Cs%400==0)}var hp=[31,29,31,30,31,30,31,31,30,31,30,31],Cp=[31,28,31,30,31,30,31,31,30,31,30,31];function Ip(Cs,Ls,Us,Xs){function po(As,Ms,Vs){for(As=typeof As=="number"?As.toString():As||"";As.length<Ms;)As=Vs[0]+As;return As}function ms(As,Ms){return po(As,Ms,"0")}function os(As,Ms){function Vs(_o){return 0>_o?-1:0<_o?1:0}var so;return(so=Vs(As.getFullYear()-Ms.getFullYear()))===0&&(so=Vs(As.getMonth()-Ms.getMonth()))===0&&(so=Vs(As.getDate()-Ms.getDate())),so}function us(As){switch(As.getDay()){case 0:return new Date(As.getFullYear()-1,11,29);case 1:return As;case 2:return new Date(As.getFullYear(),0,3);case 3:return new Date(As.getFullYear(),0,2);case 4:return new Date(As.getFullYear(),0,1);case 5:return new Date(As.getFullYear()-1,11,31);case 6:return new Date(As.getFullYear()-1,11,30)}}function Ss(As){var Ms=As.Ma;for(As=new Date(new Date(As.Na+1900,0,1).getTime());0<Ms;){var Vs=As.getMonth(),so=(Pl(As.getFullYear())?hp:Cp)[Vs];if(!(Ms>so-As.getDate())){As.setDate(As.getDate()+Ms);break}Ms-=so-As.getDate()+1,As.setDate(1),11>Vs?As.setMonth(Vs+1):(As.setMonth(0),As.setFullYear(As.getFullYear()+1))}return Vs=new Date(As.getFullYear()+1,0,4),Ms=us(new Date(As.getFullYear(),0,4)),Vs=us(Vs),0>=os(Ms,As)?0>=os(Vs,As)?As.getFullYear()+1:As.getFullYear():As.getFullYear()-1}var ss=zr()[Xs+40>>2>>>0];for(var bs in Xs={tb:zr()[Xs>>2>>>0],sb:zr()[Xs+4>>2>>>0],Sa:zr()[Xs+8>>2>>>0],Va:zr()[Xs+12>>2>>>0],Ta:zr()[Xs+16>>2>>>0],Na:zr()[Xs+20>>2>>>0],Ja:zr()[Xs+24>>2>>>0],Ma:zr()[Xs+28>>2>>>0],zb:zr()[Xs+32>>2>>>0],rb:zr()[Xs+36>>2>>>0],ub:ss?Ro(ss):""},Us=Ro(Us),ss={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"})Us=Us.replace(new RegExp(bs,"g"),ss[bs]);var _s="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),Es="January February March April May June July August September October November December".split(" ");for(bs in ss={"%a":function(As){return _s[As.Ja].substring(0,3)},"%A":function(As){return _s[As.Ja]},"%b":function(As){return Es[As.Ta].substring(0,3)},"%B":function(As){return Es[As.Ta]},"%C":function(As){return ms((As.Na+1900)/100|0,2)},"%d":function(As){return ms(As.Va,2)},"%e":function(As){return po(As.Va,2," ")},"%g":function(As){return Ss(As).toString().substring(2)},"%G":function(As){return Ss(As)},"%H":function(As){return ms(As.Sa,2)},"%I":function(As){return(As=As.Sa)==0?As=12:12<As&&(As-=12),ms(As,2)},"%j":function(As){for(var Ms=0,Vs=0;Vs<=As.Ta-1;Ms+=(Pl(As.Na+1900)?hp:Cp)[Vs++]);return ms(As.Va+Ms,3)},"%m":function(As){return ms(As.Ta+1,2)},"%M":function(As){return ms(As.sb,2)},"%n":function(){return`
`},"%p":function(As){return 0<=As.Sa&&12>As.Sa?"AM":"PM"},"%S":function(As){return ms(As.tb,2)},"%t":function(){return"	"},"%u":function(As){return As.Ja||7},"%U":function(As){return ms(Math.floor((As.Ma+7-As.Ja)/7),2)},"%V":function(As){var Ms=Math.floor((As.Ma+7-(As.Ja+6)%7)/7);if(2>=(As.Ja+371-As.Ma-2)%7&&Ms++,Ms)Ms==53&&((Vs=(As.Ja+371-As.Ma)%7)==4||Vs==3&&Pl(As.Na)||(Ms=1));else{Ms=52;var Vs=(As.Ja+7-As.Ma-1)%7;(Vs==4||Vs==5&&Pl(As.Na%400-1))&&Ms++}return ms(Ms,2)},"%w":function(As){return As.Ja},"%W":function(As){return ms(Math.floor((As.Ma+7-(As.Ja+6)%7)/7),2)},"%y":function(As){return(As.Na+1900).toString().substring(2)},"%Y":function(As){return As.Na+1900},"%z":function(As){var Ms=0<=(As=As.rb);return As=Math.abs(As)/60,(Ms?"+":"-")+("0000"+(As/60*100+As%60)).slice(-4)},"%Z":function(As){return As.ub},"%%":function(){return"%"}},Us=Us.replace(/%%/g,"\0\0"),ss)Us.includes(bs)&&(Us=Us.replace(new RegExp(bs,"g"),ss[bs](Xs)));return bs=function(As){var Ms=Array(Do(As)+1);return Co(As,Ms,0,Ms.length),Ms}(Us=Us.replace(/\0\0/g,"%")),bs.length>Ls?0:(function(As,Ms){Mr().set(As,Ms>>>0)}(bs,Cs),bs.length-1)}Vo.Ua();var Ml=[null,Kl,Ks,Zs,ho,eo,Po,qo,zo,Hs,wo,xo,Yl,xu,ju,_f,zu,Ru,Su,cu,cp,dp,Rp,Zu,fp,Hu],Fl={b:function(Cs){return pp(Cs+24)+24},c:function(Cs,Ls,Us){throw new ks(Cs).Ua(Ls,Us),Cs},L:function(Cs){gp(Cs,!is,1,!ts),Vo.Za()},l:function(Cs){as?postMessage({cmd:"cleanupThread",thread:Cs}):ru(Cs)},D:bo,i:ho,R:eo,z:Po,B:qo,T:zo,P:Hs,I:wo,O:xo,p:Yl,A:xu,x:ju,Q:_f,y:zu,r:function(){},j:function(){Io("To use dlopen, you need enable dynamic linking, see https://github.com/emscripten-core/emscripten/wiki/Linking")},s:function(){Io("To use dlopen, you need enable dynamic linking, see https://github.com/emscripten-core/emscripten/wiki/Linking")},q:function(){return Date.now()},E:function(){return 2097152},V:function(){return!0},F:function(Cs,Ls,Us,Xs){if(Cs==Ls)setTimeout(()=>_h(Xs));else if(as)postMessage({targetThread:Cs,cmd:"processProxyingQueue",queue:Xs});else{if(!(Cs=Vo.La[Cs]))return;Cs.postMessage({cmd:"processProxyingQueue",queue:Xs})}return 1},K:function(){return-1},W:function(Cs,Ls){Cs=new Date(1e3*ep(Cs)),zr()[Ls>>2>>>0]=Cs.getUTCSeconds(),zr()[Ls+4>>2>>>0]=Cs.getUTCMinutes(),zr()[Ls+8>>2>>>0]=Cs.getUTCHours(),zr()[Ls+12>>2>>>0]=Cs.getUTCDate(),zr()[Ls+16>>2>>>0]=Cs.getUTCMonth(),zr()[Ls+20>>2>>>0]=Cs.getUTCFullYear()-1900,zr()[Ls+24>>2>>>0]=Cs.getUTCDay(),Cs=(Cs.getTime()-Date.UTC(Cs.getUTCFullYear(),0,1,0,0,0,0))/864e5|0,zr()[Ls+28>>2>>>0]=Cs},X:function(Cs,Ls){Cs=new Date(1e3*ep(Cs)),zr()[Ls>>2>>>0]=Cs.getSeconds(),zr()[Ls+4>>2>>>0]=Cs.getMinutes(),zr()[Ls+8>>2>>>0]=Cs.getHours(),zr()[Ls+12>>2>>>0]=Cs.getDate(),zr()[Ls+16>>2>>>0]=Cs.getMonth(),zr()[Ls+20>>2>>>0]=Cs.getFullYear()-1900,zr()[Ls+24>>2>>>0]=Cs.getDay();var Us=new Date(Cs.getFullYear(),0,1),Xs=(Cs.getTime()-Us.getTime())/864e5|0;zr()[Ls+28>>2>>>0]=Xs,zr()[Ls+36>>2>>>0]=-60*Cs.getTimezoneOffset(),Xs=new Date(Cs.getFullYear(),6,1).getTimezoneOffset(),Cs=0|(Xs!=(Us=Us.getTimezoneOffset())&&Cs.getTimezoneOffset()==Math.min(Us,Xs)),zr()[Ls+32>>2>>>0]=Cs},Y:function(Cs){var Ls=new Date(zr()[Cs+20>>2>>>0]+1900,zr()[Cs+16>>2>>>0],zr()[Cs+12>>2>>>0],zr()[Cs+8>>2>>>0],zr()[Cs+4>>2>>>0],zr()[Cs>>2>>>0],0),Us=zr()[Cs+32>>2>>>0],Xs=Ls.getTimezoneOffset(),po=new Date(Ls.getFullYear(),0,1),ms=new Date(Ls.getFullYear(),6,1).getTimezoneOffset(),os=po.getTimezoneOffset(),us=Math.min(os,ms);return 0>Us?zr()[Cs+32>>2>>>0]=+(ms!=os&&us==Xs):0<Us!=(us==Xs)&&(ms=Math.max(os,ms),Ls.setTime(Ls.getTime()+6e4*((0<Us?us:ms)-Xs))),zr()[Cs+24>>2>>>0]=Ls.getDay(),Us=(Ls.getTime()-po.getTime())/864e5|0,zr()[Cs+28>>2>>>0]=Us,zr()[Cs>>2>>>0]=Ls.getSeconds(),zr()[Cs+4>>2>>>0]=Ls.getMinutes(),zr()[Cs+8>>2>>>0]=Ls.getHours(),zr()[Cs+12>>2>>>0]=Ls.getDate(),zr()[Cs+16>>2>>>0]=Ls.getMonth(),Ls.getTime()/1e3|0},G:Ru,H:Su,Z:function Cs(Ls,Us,Xs){Cs.jb||(Cs.jb=!0,cu(Ls,Us,Xs))},d:function(){Io("")},m:function(){if(!rs&&!is){var Cs="Blocking on the main thread is very dangerous, see https://emscripten.org/docs/porting/pthreads.html#blocking-on-the-main-browser-thread";gs||(gs={}),gs[Cs]||(gs[Cs]=1,rs&&(Cs="warning: "+Cs),ps(Cs))}},w:function(){return 4294901760},f:hs,S:function(Cs,Ls,Us){Fr().copyWithin(Cs>>>0,Ls>>>0,Ls+Us>>>0)},g:function(){return rs?Ar(3993).cpus().length:navigator.hardwareConcurrency},J:function(Cs,Ls,Us){Ou.length=Ls,Us>>=3;for(var Xs=0;Xs<Ls;Xs++)Ou[Xs]=Gr()[Us+Xs>>>0];return(0>Cs?El[-Cs-1]:Ml[Cs]).apply(null,Ou)},v:function(Cs){var Ls=Fr().length;if((Cs>>>=0)<=Ls||4294901760<Cs)return!1;for(var Us=1;4>=Us;Us*=2){var Xs=Ls*(1+.2/Us);Xs=Math.min(Xs,Cs+100663296);var po=Math;Xs=Math.max(Cs,Xs),po=po.min.call(po,4294901760,Xs+(65536-Xs%65536)%65536);e:{try{Ds.grow(po-zs.byteLength+65535>>>16),ds(Ds.buffer);var ms=1;break e}catch{}ms=void 0}if(ms)return!0}return!1},U:function(){throw"unwind"},M:cp,N:dp,k:vu,h:Rp,o:Zu,t:fp,n:Hu,u:function Cs(Ls,Us){Cs.Wa||(Cs.Wa=function(){if(typeof crypto=="object"&&typeof crypto.getRandomValues=="function"){var po=new Uint8Array(1);return()=>(crypto.getRandomValues(po),po[0])}if(rs)try{var ms=Ar(760);return()=>ms.randomBytes(1)[0]}catch{}return()=>Io("randomDevice")}());for(var Xs=0;Xs<Us;Xs++)Mr()[Ls+Xs>>0>>>0]=Cs.Wa();return 0},a:Ds||Nr.wasmMemory,C:Ip,e:function(Cs,Ls,Us,Xs){return Ip(Cs,Ls,Us,Xs)}};(function(){function Cs(po,ms){Nr.asm=po.exports,Vo.$a.push(Nr.asm.wa),Ws=Nr.asm.za,io.unshift(Nr.asm._),js=ms,as||(Ho--,Nr.monitorRunDependencies&&Nr.monitorRunDependencies(Ho),Ho==0&&Uo&&(po=Uo,Uo=null,po()))}function Ls(po){Cs(po.instance,po.module)}function Us(po){return function(){if(!xs&&(ts||is)){if(typeof fetch=="function"&&!To.startsWith("file://"))return fetch(To,{credentials:"same-origin"}).then(function(ms){if(!ms.ok)throw"failed to load wasm binary file at '"+To+"'";return ms.arrayBuffer()}).catch(function(){return Xo()});if(Wr)return new Promise(function(ms,os){Wr(To,function(us){ms(new Uint8Array(us))},os)})}return Promise.resolve().then(function(){return Xo()})}().then(function(ms){return WebAssembly.instantiate(ms,Xs)}).then(function(ms){return ms}).then(po,function(ms){ps("failed to asynchronously prepare wasm: "+ms),Io(ms)})}var Xs={a:Fl};if(as||(Ho++,Nr.monitorRunDependencies&&Nr.monitorRunDependencies(Ho)),Nr.instantiateWasm)try{return Nr.instantiateWasm(Xs,Cs)}catch(po){return ps("Module.instantiateWasm callback failed with error: "+po),!1}(xs||typeof WebAssembly.instantiateStreaming!="function"||xl()||To.startsWith("file://")||rs||typeof fetch!="function"?Us(Ls):fetch(To,{credentials:"same-origin"}).then(function(po){return WebAssembly.instantiateStreaming(po,Xs).then(Ls,function(ms){return ps("wasm streaming compile failed: "+ms),ps("falling back to ArrayBuffer instantiation"),Us(Ls)})})).catch(Ur)})(),Nr.___wasm_call_ctors=function(){return(Nr.___wasm_call_ctors=Nr.asm._).apply(null,arguments)},Nr._OrtInit=function(){return(Nr._OrtInit=Nr.asm.$).apply(null,arguments)},Nr._OrtCreateSessionOptions=function(){return(Nr._OrtCreateSessionOptions=Nr.asm.aa).apply(null,arguments)},Nr._OrtAppendExecutionProvider=function(){return(Nr._OrtAppendExecutionProvider=Nr.asm.ba).apply(null,arguments)},Nr._OrtAddSessionConfigEntry=function(){return(Nr._OrtAddSessionConfigEntry=Nr.asm.ca).apply(null,arguments)},Nr._OrtReleaseSessionOptions=function(){return(Nr._OrtReleaseSessionOptions=Nr.asm.da).apply(null,arguments)},Nr._OrtCreateSession=function(){return(Nr._OrtCreateSession=Nr.asm.ea).apply(null,arguments)},Nr._OrtReleaseSession=function(){return(Nr._OrtReleaseSession=Nr.asm.fa).apply(null,arguments)},Nr._OrtGetInputCount=function(){return(Nr._OrtGetInputCount=Nr.asm.ga).apply(null,arguments)},Nr._OrtGetOutputCount=function(){return(Nr._OrtGetOutputCount=Nr.asm.ha).apply(null,arguments)},Nr._OrtGetInputName=function(){return(Nr._OrtGetInputName=Nr.asm.ia).apply(null,arguments)},Nr._OrtGetOutputName=function(){return(Nr._OrtGetOutputName=Nr.asm.ja).apply(null,arguments)},Nr._OrtFree=function(){return(Nr._OrtFree=Nr.asm.ka).apply(null,arguments)},Nr._OrtCreateTensor=function(){return(Nr._OrtCreateTensor=Nr.asm.la).apply(null,arguments)},Nr._OrtGetTensorData=function(){return(Nr._OrtGetTensorData=Nr.asm.ma).apply(null,arguments)},Nr._OrtReleaseTensor=function(){return(Nr._OrtReleaseTensor=Nr.asm.na).apply(null,arguments)},Nr._OrtCreateRunOptions=function(){return(Nr._OrtCreateRunOptions=Nr.asm.oa).apply(null,arguments)},Nr._OrtAddRunConfigEntry=function(){return(Nr._OrtAddRunConfigEntry=Nr.asm.pa).apply(null,arguments)},Nr._OrtReleaseRunOptions=function(){return(Nr._OrtReleaseRunOptions=Nr.asm.qa).apply(null,arguments)},Nr._OrtRun=function(){return(Nr._OrtRun=Nr.asm.ra).apply(null,arguments)},Nr._OrtEndProfiling=function(){return(Nr._OrtEndProfiling=Nr.asm.sa).apply(null,arguments)};var Nu=Nr._pthread_self=function(){return(Nu=Nr._pthread_self=Nr.asm.ta).apply(null,arguments)},pp=Nr._malloc=function(){return(pp=Nr._malloc=Nr.asm.ua).apply(null,arguments)};Nr._free=function(){return(Nr._free=Nr.asm.va).apply(null,arguments)},Nr.__emscripten_tls_init=function(){return(Nr.__emscripten_tls_init=Nr.asm.wa).apply(null,arguments)};var gp=Nr.__emscripten_thread_init=function(){return(gp=Nr.__emscripten_thread_init=Nr.asm.xa).apply(null,arguments)};Nr.__emscripten_thread_crashed=function(){return(Nr.__emscripten_thread_crashed=Nr.asm.ya).apply(null,arguments)};var Fu,Pp=Nr._emscripten_run_in_main_runtime_thread_js=function(){return(Pp=Nr._emscripten_run_in_main_runtime_thread_js=Nr.asm.Aa).apply(null,arguments)},eu=Nr.__emscripten_proxy_execute_task_queue=function(){return(eu=Nr.__emscripten_proxy_execute_task_queue=Nr.asm.Ba).apply(null,arguments)},mp=Nr.__emscripten_thread_free_data=function(){return(mp=Nr.__emscripten_thread_free_data=Nr.asm.Ca).apply(null,arguments)},iu=Nr.__emscripten_thread_exit=function(){return(iu=Nr.__emscripten_thread_exit=Nr.asm.Da).apply(null,arguments)},yp=Nr._emscripten_stack_set_limits=function(){return(yp=Nr._emscripten_stack_set_limits=Nr.asm.Ea).apply(null,arguments)},Ju=Nr.stackSave=function(){return(Ju=Nr.stackSave=Nr.asm.Fa).apply(null,arguments)},Nl=Nr.stackRestore=function(){return(Nl=Nr.stackRestore=Nr.asm.Ga).apply(null,arguments)},zl=Nr.stackAlloc=function(){return(zl=Nr.stackAlloc=Nr.asm.Ha).apply(null,arguments)};function Eu(){function Cs(){if(!Fu&&(Fu=!0,Nr.calledRun=!0,!Js)&&(as||Fs(io),Lr(Nr),Nr.onRuntimeInitialized&&Nr.onRuntimeInitialized(),!as)){if(Nr.postRun)for(typeof Nr.postRun=="function"&&(Nr.postRun=[Nr.postRun]);Nr.postRun.length;){var Ls=Nr.postRun.shift();ko.unshift(Ls)}Fs(ko)}}if(!(0<Ho))if(as)Lr(Nr),as||Fs(io),postMessage({cmd:"loaded"});else{if(Nr.preRun)for(typeof Nr.preRun=="function"&&(Nr.preRun=[Nr.preRun]);Nr.preRun.length;)go();Fs(to),0<Ho||(Nr.setStatus?(Nr.setStatus("Running..."),setTimeout(function(){setTimeout(function(){Nr.setStatus("")},1),Cs()},1)):Cs())}}if(Nr.___cxa_is_pointer_type=function(){return(Nr.___cxa_is_pointer_type=Nr.asm.Ia).apply(null,arguments)},Nr.UTF8ToString=Ro,Nr.stringToUTF8=function(Cs,Ls,Us){return Co(Cs,Fr(),Ls,Us)},Nr.lengthBytesUTF8=Do,Nr.keepRuntimeAlive=function(){return vs},Nr.wasmMemory=Ds,Nr.stackSave=Ju,Nr.stackRestore=Nl,Nr.stackAlloc=zl,Nr.ExitStatus=Dl,Nr.PThread=Vo,Uo=function Cs(){Fu||Eu(),Fu||(Uo=Cs)},Nr.preInit)for(typeof Nr.preInit=="function"&&(Nr.preInit=[Nr.preInit]);0<Nr.preInit.length;)Nr.preInit.pop()();return Eu(),Dr.ready});_r.exports=Pr},932:(_r,Tr,Ar)=>{var Rr,Pr=(Rr=(Rr=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0)||"/index.js",function(Dr){var Mr,Fr,zr;Dr=Dr||{},Mr||(Mr=Dr!==void 0?Dr:{}),Mr.ready=new Promise(function(Fs,Ks){Fr=Fs,zr=Ks});var jr,Gr,Nr,Lr,Ur,Vr,Wr=Object.assign({},Mr),qr="./this.program",Kr=(Fs,Ks)=>{throw Ks},Xr=typeof window=="object",Zr=typeof importScripts=="function",_i=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",Jr="";_i?(Jr=Zr?Ar(908).dirname(Jr)+"/":"//",Vr=()=>{Ur||(Lr=Ar(1384),Ur=Ar(908))},jr=function(Fs,Ks){return Vr(),Fs=Ur.normalize(Fs),Lr.readFileSync(Fs,Ks?void 0:"utf8")},Nr=Fs=>((Fs=jr(Fs,!0)).buffer||(Fs=new Uint8Array(Fs)),Fs),Gr=(Fs,Ks,gs)=>{Vr(),Fs=Ur.normalize(Fs),Lr.readFile(Fs,function(hs,Ps){hs?gs(hs):Ks(Ps.buffer)})},1<process.argv.length&&(qr=process.argv[1].replace(/\\/g,"/")),process.argv.slice(2),process.on("uncaughtException",function(Fs){if(!(Fs instanceof Os))throw Fs}),process.on("unhandledRejection",function(Fs){throw Fs}),Kr=(Fs,Ks)=>{if(rs)throw process.exitCode=Fs,Ks;Ks instanceof Os||is("exiting due to exception: "+Ks),process.exit(Fs)},Mr.inspect=function(){return"[Emscripten Module object]"}):(Xr||Zr)&&(Zr?Jr=self.location.href:typeof document<"u"&&document.currentScript&&(Jr=document.currentScript.src),Rr&&(Jr=Rr),Jr=Jr.indexOf("blob:")!==0?Jr.substr(0,Jr.replace(/[?#].*/,"").lastIndexOf("/")+1):"",jr=Fs=>{var Ks=new XMLHttpRequest;return Ks.open("GET",Fs,!1),Ks.send(null),Ks.responseText},Zr&&(Nr=Fs=>{var Ks=new XMLHttpRequest;return Ks.open("GET",Fs,!1),Ks.responseType="arraybuffer",Ks.send(null),new Uint8Array(Ks.response)}),Gr=(Fs,Ks,gs)=>{var hs=new XMLHttpRequest;hs.open("GET",Fs,!0),hs.responseType="arraybuffer",hs.onload=()=>{hs.status==200||hs.status==0&&hs.response?Ks(hs.response):gs()},hs.onerror=gs,hs.send(null)});var es,ts=Mr.print||console.log.bind(console),is=Mr.printErr||console.warn.bind(console);Object.assign(Mr,Wr),Wr=null,Mr.thisProgram&&(qr=Mr.thisProgram),Mr.quit&&(Kr=Mr.quit),Mr.wasmBinary&&(es=Mr.wasmBinary);var rs=Mr.noExitRuntime||!0;typeof WebAssembly!="object"&&Ro("no native wasm support detected");var as,ls,fs,Ts,$s,xs,ys=!1,ps=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function vs(Fs,Ks,gs){var hs=(Ks>>>=0)+gs;for(gs=Ks;Fs[gs]&&!(gs>=hs);)++gs;if(16<gs-Ks&&Fs.buffer&&ps)return ps.decode(Fs.subarray(Ks,gs));for(hs="";Ks<gs;){var Ps=Fs[Ks++];if(128&Ps){var ks=63&Fs[Ks++];if((224&Ps)==192)hs+=String.fromCharCode((31&Ps)<<6|ks);else{var Zs=63&Fs[Ks++];65536>(Ps=(240&Ps)==224?(15&Ps)<<12|ks<<6|Zs:(7&Ps)<<18|ks<<12|Zs<<6|63&Fs[Ks++])?hs+=String.fromCharCode(Ps):(Ps-=65536,hs+=String.fromCharCode(55296|Ps>>10,56320|1023&Ps))}}else hs+=String.fromCharCode(Ps)}return hs}function Ds(Fs,Ks){return(Fs>>>=0)?vs(Ts,Fs,Ks):""}function js(Fs,Ks,gs,hs){if(!(0<hs))return 0;var Ps=gs>>>=0;hs=gs+hs-1;for(var ks=0;ks<Fs.length;++ks){var Zs=Fs.charCodeAt(ks);if(55296<=Zs&&57343>=Zs&&(Zs=65536+((1023&Zs)<<10)|1023&Fs.charCodeAt(++ks)),127>=Zs){if(gs>=hs)break;Ks[gs++>>>0]=Zs}else{if(2047>=Zs){if(gs+1>=hs)break;Ks[gs++>>>0]=192|Zs>>6}else{if(65535>=Zs){if(gs+2>=hs)break;Ks[gs++>>>0]=224|Zs>>12}else{if(gs+3>=hs)break;Ks[gs++>>>0]=240|Zs>>18,Ks[gs++>>>0]=128|Zs>>12&63}Ks[gs++>>>0]=128|Zs>>6&63}Ks[gs++>>>0]=128|63&Zs}}return Ks[gs>>>0]=0,gs-Ps}function zs(Fs){for(var Ks=0,gs=0;gs<Fs.length;++gs){var hs=Fs.charCodeAt(gs);127>=hs?Ks++:2047>=hs?Ks+=2:55296<=hs&&57343>=hs?(Ks+=4,++gs):Ks+=3}return Ks}function qs(){var Fs=as.buffer;ls=Fs,Mr.HEAP8=fs=new Int8Array(Fs),Mr.HEAP16=new Int16Array(Fs),Mr.HEAP32=$s=new Int32Array(Fs),Mr.HEAPU8=Ts=new Uint8Array(Fs),Mr.HEAPU16=new Uint16Array(Fs),Mr.HEAPU32=xs=new Uint32Array(Fs),Mr.HEAPF32=new Float32Array(Fs),Mr.HEAPF64=new Float64Array(Fs)}var fo=[],Qs=[],no=[];function yo(){var Fs=Mr.preRun.shift();fo.unshift(Fs)}var Js,lo=0,vo=null;function Ro(Fs){throw Mr.onAbort&&Mr.onAbort(Fs),is(Fs="Aborted("+Fs+")"),ys=!0,Fs=new WebAssembly.RuntimeError(Fs+". Build with -sASSERTIONS for more info."),zr(Fs),Fs}function Co(){return Js.startsWith("data:application/octet-stream;base64,")}if(Js="ort-wasm.wasm",!Co()){var Do=Js;Js=Mr.locateFile?Mr.locateFile(Do,Jr):Jr+Do}function ds(){var Fs=Js;try{if(Fs==Js&&es)return new Uint8Array(es);if(Nr)return Nr(Fs);throw"both async and sync fetching of the wasm failed"}catch(Ks){Ro(Ks)}}function Os(Fs){this.name="ExitStatus",this.message="Program terminated with exit("+Fs+")",this.status=Fs}function Ws(Fs){for(;0<Fs.length;)Fs.shift()(Mr)}function to(Fs){this.sa=Fs-24,this.Ia=function(Ks){xs[this.sa+4>>2>>>0]=Ks},this.Ba=function(Ks){xs[this.sa+8>>2>>>0]=Ks},this.Ga=function(){$s[this.sa>>2>>>0]=0},this.Aa=function(){fs[this.sa+12>>0>>>0]=0},this.Ha=function(){fs[this.sa+13>>0>>>0]=0},this.ya=function(Ks,gs){this.za(),this.Ia(Ks),this.Ba(gs),this.Ga(),this.Aa(),this.Ha()},this.za=function(){xs[this.sa+16>>2>>>0]=0}}function io(Fs){var Ks=zs(Fs)+1,gs=Dl(Ks);return gs&&js(Fs,fs,gs,Ks),gs}var ko={};function go(){if(!To){var Fs,Ks={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:qr||"./this.program"};for(Fs in ko)ko[Fs]===void 0?delete Ks[Fs]:Ks[Fs]=ko[Fs];var gs=[];for(Fs in Ks)gs.push(Fs+"="+Ks[Fs]);To=gs}return To}var To,Ho=[null,[],[]];function Uo(Fs){return Fs%4==0&&(Fs%100!=0||Fs%400==0)}var Io=[31,29,31,30,31,30,31,31,30,31,30,31],xl=[31,28,31,30,31,30,31,31,30,31,30,31];function Xo(Fs,Ks,gs,hs){function Ps(Hs,wo,xo){for(Hs=typeof Hs=="number"?Hs.toString():Hs||"";Hs.length<wo;)Hs=xo[0]+Hs;return Hs}function ks(Hs,wo){return Ps(Hs,wo,"0")}function Zs(Hs,wo){function xo(xu){return 0>xu?-1:0<xu?1:0}var Yl;return(Yl=xo(Hs.getFullYear()-wo.getFullYear()))===0&&(Yl=xo(Hs.getMonth()-wo.getMonth()))===0&&(Yl=xo(Hs.getDate()-wo.getDate())),Yl}function bo(Hs){switch(Hs.getDay()){case 0:return new Date(Hs.getFullYear()-1,11,29);case 1:return Hs;case 2:return new Date(Hs.getFullYear(),0,3);case 3:return new Date(Hs.getFullYear(),0,2);case 4:return new Date(Hs.getFullYear(),0,1);case 5:return new Date(Hs.getFullYear()-1,11,31);case 6:return new Date(Hs.getFullYear()-1,11,30)}}function ho(Hs){var wo=Hs.qa;for(Hs=new Date(new Date(Hs.ra+1900,0,1).getTime());0<wo;){var xo=Hs.getMonth(),Yl=(Uo(Hs.getFullYear())?Io:xl)[xo];if(!(wo>Yl-Hs.getDate())){Hs.setDate(Hs.getDate()+wo);break}wo-=Yl-Hs.getDate()+1,Hs.setDate(1),11>xo?Hs.setMonth(xo+1):(Hs.setMonth(0),Hs.setFullYear(Hs.getFullYear()+1))}return xo=new Date(Hs.getFullYear()+1,0,4),wo=bo(new Date(Hs.getFullYear(),0,4)),xo=bo(xo),0>=Zs(wo,Hs)?0>=Zs(xo,Hs)?Hs.getFullYear()+1:Hs.getFullYear():Hs.getFullYear()-1}var eo=$s[hs+40>>2>>>0];for(var Po in hs={Ea:$s[hs>>2>>>0],Da:$s[hs+4>>2>>>0],ta:$s[hs+8>>2>>>0],va:$s[hs+12>>2>>>0],ua:$s[hs+16>>2>>>0],ra:$s[hs+20>>2>>>0],la:$s[hs+24>>2>>>0],qa:$s[hs+28>>2>>>0],Ja:$s[hs+32>>2>>>0],Ca:$s[hs+36>>2>>>0],Fa:eo?Ds(eo):""},gs=Ds(gs),eo={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"})gs=gs.replace(new RegExp(Po,"g"),eo[Po]);var qo="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),zo="January February March April May June July August September October November December".split(" ");for(Po in eo={"%a":function(Hs){return qo[Hs.la].substring(0,3)},"%A":function(Hs){return qo[Hs.la]},"%b":function(Hs){return zo[Hs.ua].substring(0,3)},"%B":function(Hs){return zo[Hs.ua]},"%C":function(Hs){return ks((Hs.ra+1900)/100|0,2)},"%d":function(Hs){return ks(Hs.va,2)},"%e":function(Hs){return Ps(Hs.va,2," ")},"%g":function(Hs){return ho(Hs).toString().substring(2)},"%G":function(Hs){return ho(Hs)},"%H":function(Hs){return ks(Hs.ta,2)},"%I":function(Hs){return(Hs=Hs.ta)==0?Hs=12:12<Hs&&(Hs-=12),ks(Hs,2)},"%j":function(Hs){for(var wo=0,xo=0;xo<=Hs.ua-1;wo+=(Uo(Hs.ra+1900)?Io:xl)[xo++]);return ks(Hs.va+wo,3)},"%m":function(Hs){return ks(Hs.ua+1,2)},"%M":function(Hs){return ks(Hs.Da,2)},"%n":function(){return`
`},"%p":function(Hs){return 0<=Hs.ta&&12>Hs.ta?"AM":"PM"},"%S":function(Hs){return ks(Hs.Ea,2)},"%t":function(){return"	"},"%u":function(Hs){return Hs.la||7},"%U":function(Hs){return ks(Math.floor((Hs.qa+7-Hs.la)/7),2)},"%V":function(Hs){var wo=Math.floor((Hs.qa+7-(Hs.la+6)%7)/7);if(2>=(Hs.la+371-Hs.qa-2)%7&&wo++,wo)wo==53&&((xo=(Hs.la+371-Hs.qa)%7)==4||xo==3&&Uo(Hs.ra)||(wo=1));else{wo=52;var xo=(Hs.la+7-Hs.qa-1)%7;(xo==4||xo==5&&Uo(Hs.ra%400-1))&&wo++}return ks(wo,2)},"%w":function(Hs){return Hs.la},"%W":function(Hs){return ks(Math.floor((Hs.qa+7-(Hs.la+6)%7)/7),2)},"%y":function(Hs){return(Hs.ra+1900).toString().substring(2)},"%Y":function(Hs){return Hs.ra+1900},"%z":function(Hs){var wo=0<=(Hs=Hs.Ca);return Hs=Math.abs(Hs)/60,(wo?"+":"-")+("0000"+(Hs/60*100+Hs%60)).slice(-4)},"%Z":function(Hs){return Hs.Fa},"%%":function(){return"%"}},gs=gs.replace(/%%/g,"\0\0"),eo)gs.includes(Po)&&(gs=gs.replace(new RegExp(Po,"g"),eo[Po](hs)));return Po=function(Hs){var wo=Array(zs(Hs)+1);return js(Hs,wo,0,wo.length),wo}(gs=gs.replace(/\0\0/g,"%")),Po.length>Ks?0:(fs.set(Po,Fs>>>0),Po.length-1)}var El={a:function(Fs){return Dl(Fs+24)+24},b:function(Fs,Ks,gs){throw new to(Fs).ya(Ks,gs),Fs},g:function(){return 0},I:function(){},w:function(){},y:function(){},K:function(){return 0},G:function(){},C:function(){},F:function(){},k:function(){},x:function(){},u:function(){},H:function(){},v:function(){},n:function(){},p:function(){Ro("To use dlopen, you need enable dynamic linking, see https://github.com/emscripten-core/emscripten/wiki/Linking")},o:function(){Ro("To use dlopen, you need enable dynamic linking, see https://github.com/emscripten-core/emscripten/wiki/Linking")},l:function(){return Date.now()},L:function(){return!0},M:function(Fs,Ks){Fs=new Date(1e3*(xs[Fs>>>2]+4294967296*$s[Fs+4>>>2])),$s[Ks>>2>>>0]=Fs.getUTCSeconds(),$s[Ks+4>>2>>>0]=Fs.getUTCMinutes(),$s[Ks+8>>2>>>0]=Fs.getUTCHours(),$s[Ks+12>>2>>>0]=Fs.getUTCDate(),$s[Ks+16>>2>>>0]=Fs.getUTCMonth(),$s[Ks+20>>2>>>0]=Fs.getUTCFullYear()-1900,$s[Ks+24>>2>>>0]=Fs.getUTCDay(),$s[Ks+28>>2>>>0]=(Fs.getTime()-Date.UTC(Fs.getUTCFullYear(),0,1,0,0,0,0))/864e5|0},N:function(Fs,Ks){Fs=new Date(1e3*(xs[Fs>>>2]+4294967296*$s[Fs+4>>>2])),$s[Ks>>2>>>0]=Fs.getSeconds(),$s[Ks+4>>2>>>0]=Fs.getMinutes(),$s[Ks+8>>2>>>0]=Fs.getHours(),$s[Ks+12>>2>>>0]=Fs.getDate(),$s[Ks+16>>2>>>0]=Fs.getMonth(),$s[Ks+20>>2>>>0]=Fs.getFullYear()-1900,$s[Ks+24>>2>>>0]=Fs.getDay();var gs=new Date(Fs.getFullYear(),0,1);$s[Ks+28>>2>>>0]=(Fs.getTime()-gs.getTime())/864e5|0,$s[Ks+36>>2>>>0]=-60*Fs.getTimezoneOffset();var hs=new Date(Fs.getFullYear(),6,1).getTimezoneOffset();gs=gs.getTimezoneOffset(),$s[Ks+32>>2>>>0]=0|(hs!=gs&&Fs.getTimezoneOffset()==Math.min(gs,hs))},O:function(Fs){var Ks=new Date($s[Fs+20>>2>>>0]+1900,$s[Fs+16>>2>>>0],$s[Fs+12>>2>>>0],$s[Fs+8>>2>>>0],$s[Fs+4>>2>>>0],$s[Fs>>2>>>0],0),gs=$s[Fs+32>>2>>>0],hs=Ks.getTimezoneOffset(),Ps=new Date(Ks.getFullYear(),0,1),ks=new Date(Ks.getFullYear(),6,1).getTimezoneOffset(),Zs=Ps.getTimezoneOffset(),bo=Math.min(Zs,ks);return 0>gs?$s[Fs+32>>2>>>0]=+(ks!=Zs&&bo==hs):0<gs!=(bo==hs)&&(ks=Math.max(Zs,ks),Ks.setTime(Ks.getTime()+6e4*((0<gs?bo:ks)-hs))),$s[Fs+24>>2>>>0]=Ks.getDay(),$s[Fs+28>>2>>>0]=(Ks.getTime()-Ps.getTime())/864e5|0,$s[Fs>>2>>>0]=Ks.getSeconds(),$s[Fs+4>>2>>>0]=Ks.getMinutes(),$s[Fs+8>>2>>>0]=Ks.getHours(),$s[Fs+12>>2>>>0]=Ks.getDate(),$s[Fs+16>>2>>>0]=Ks.getMonth(),Ks.getTime()/1e3|0},z:function(){return-52},B:function(){},m:function Fs(Ks,gs,hs){Fs.xa||(Fs.xa=!0,function(Ps,ks,Zs){function bo(zo){return(zo=zo.toTimeString().match(/\(([A-Za-z ]+)\)$/))?zo[1]:"GMT"}var ho=new Date().getFullYear(),eo=new Date(ho,0,1),Po=new Date(ho,6,1);ho=eo.getTimezoneOffset();var qo=Po.getTimezoneOffset();$s[Ps>>2>>>0]=60*Math.max(ho,qo),$s[ks>>2>>>0]=+(ho!=qo),Ps=bo(eo),ks=bo(Po),Ps=io(Ps),ks=io(ks),qo<ho?(xs[Zs>>2>>>0]=Ps,xs[Zs+4>>2>>>0]=ks):(xs[Zs>>2>>>0]=ks,xs[Zs+4>>2>>>0]=Ps)}(Ks,gs,hs))},d:function(){Ro("")},t:function(){return 4294901760},h:_i?()=>{var Fs=process.hrtime();return 1e3*Fs[0]+Fs[1]/1e6}:()=>performance.now(),J:function(Fs,Ks,gs){Ts.copyWithin(Fs>>>0,Ks>>>0,Ks+gs>>>0)},f:function(Fs){var Ks=Ts.length;if(4294901760<(Fs>>>=0))return!1;for(var gs=1;4>=gs;gs*=2){var hs=Ks*(1+.2/gs);hs=Math.min(hs,Fs+100663296);var Ps=Math;hs=Math.max(Fs,hs),Ps=Ps.min.call(Ps,4294901760,hs+(65536-hs%65536)%65536);e:{try{as.grow(Ps-ls.byteLength+65535>>>16),qs();var ks=1;break e}catch{}ks=void 0}if(ks)return!0}return!1},D:function(Fs,Ks){var gs=0;return go().forEach(function(hs,Ps){var ks=Ks+gs;for(Ps=xs[Fs+4*Ps>>2>>>0]=ks,ks=0;ks<hs.length;++ks)fs[Ps++>>0>>>0]=hs.charCodeAt(ks);fs[Ps>>0>>>0]=0,gs+=hs.length+1}),0},E:function(Fs,Ks){var gs=go();xs[Fs>>2>>>0]=gs.length;var hs=0;return gs.forEach(function(Ps){hs+=Ps.length+1}),xs[Ks>>2>>>0]=hs,0},r:function(Fs){rs||(Mr.onExit&&Mr.onExit(Fs),ys=!0),Kr(Fs,new Os(Fs))},e:function(){return 52},j:function(){return 52},q:function(){return 70},i:function(Fs,Ks,gs,hs){for(var Ps=0,ks=0;ks<gs;ks++){var Zs=xs[Ks>>2>>>0],bo=xs[Ks+4>>2>>>0];Ks+=8;for(var ho=0;ho<bo;ho++){var eo=Ts[Zs+ho>>>0],Po=Ho[Fs];eo===0||eo===10?((Fs===1?ts:is)(vs(Po,0)),Po.length=0):Po.push(eo)}Ps+=bo}return xs[hs>>2>>>0]=Ps,0},s:function Fs(Ks,gs){Fs.wa||(Fs.wa=function(){if(typeof crypto=="object"&&typeof crypto.getRandomValues=="function"){var Ps=new Uint8Array(1);return()=>(crypto.getRandomValues(Ps),Ps[0])}if(_i)try{var ks=Ar(760);return()=>ks.randomBytes(1)[0]}catch{}return()=>Ro("randomDevice")}());for(var hs=0;hs<gs;hs++)fs[Ks+hs>>0>>>0]=Fs.wa();return 0},A:Xo,c:function(Fs,Ks,gs,hs){return Xo(Fs,Ks,gs,hs)}};(function(){function Fs(Ps){Mr.asm=Ps.exports,as=Mr.asm.P,qs(),Qs.unshift(Mr.asm.Q),lo--,Mr.monitorRunDependencies&&Mr.monitorRunDependencies(lo),lo==0&&vo&&(Ps=vo,vo=null,Ps())}function Ks(Ps){Fs(Ps.instance)}function gs(Ps){return function(){if(!es&&(Xr||Zr)){if(typeof fetch=="function"&&!Js.startsWith("file://"))return fetch(Js,{credentials:"same-origin"}).then(function(ks){if(!ks.ok)throw"failed to load wasm binary file at '"+Js+"'";return ks.arrayBuffer()}).catch(function(){return ds()});if(Gr)return new Promise(function(ks,Zs){Gr(Js,function(bo){ks(new Uint8Array(bo))},Zs)})}return Promise.resolve().then(function(){return ds()})}().then(function(ks){return WebAssembly.instantiate(ks,hs)}).then(function(ks){return ks}).then(Ps,function(ks){is("failed to asynchronously prepare wasm: "+ks),Ro(ks)})}var hs={a:El};if(lo++,Mr.monitorRunDependencies&&Mr.monitorRunDependencies(lo),Mr.instantiateWasm)try{return Mr.instantiateWasm(hs,Fs)}catch(Ps){return is("Module.instantiateWasm callback failed with error: "+Ps),!1}(es||typeof WebAssembly.instantiateStreaming!="function"||Co()||Js.startsWith("file://")||_i||typeof fetch!="function"?gs(Ks):fetch(Js,{credentials:"same-origin"}).then(function(Ps){return WebAssembly.instantiateStreaming(Ps,hs).then(Ks,function(ks){return is("wasm streaming compile failed: "+ks),is("falling back to ArrayBuffer instantiation"),gs(Ks)})})).catch(zr)})(),Mr.___wasm_call_ctors=function(){return(Mr.___wasm_call_ctors=Mr.asm.Q).apply(null,arguments)},Mr._OrtInit=function(){return(Mr._OrtInit=Mr.asm.R).apply(null,arguments)},Mr._OrtCreateSessionOptions=function(){return(Mr._OrtCreateSessionOptions=Mr.asm.S).apply(null,arguments)},Mr._OrtAppendExecutionProvider=function(){return(Mr._OrtAppendExecutionProvider=Mr.asm.T).apply(null,arguments)},Mr._OrtAddSessionConfigEntry=function(){return(Mr._OrtAddSessionConfigEntry=Mr.asm.U).apply(null,arguments)},Mr._OrtReleaseSessionOptions=function(){return(Mr._OrtReleaseSessionOptions=Mr.asm.V).apply(null,arguments)},Mr._OrtCreateSession=function(){return(Mr._OrtCreateSession=Mr.asm.W).apply(null,arguments)},Mr._OrtReleaseSession=function(){return(Mr._OrtReleaseSession=Mr.asm.X).apply(null,arguments)},Mr._OrtGetInputCount=function(){return(Mr._OrtGetInputCount=Mr.asm.Y).apply(null,arguments)},Mr._OrtGetOutputCount=function(){return(Mr._OrtGetOutputCount=Mr.asm.Z).apply(null,arguments)},Mr._OrtGetInputName=function(){return(Mr._OrtGetInputName=Mr.asm._).apply(null,arguments)},Mr._OrtGetOutputName=function(){return(Mr._OrtGetOutputName=Mr.asm.$).apply(null,arguments)},Mr._OrtFree=function(){return(Mr._OrtFree=Mr.asm.aa).apply(null,arguments)},Mr._OrtCreateTensor=function(){return(Mr._OrtCreateTensor=Mr.asm.ba).apply(null,arguments)},Mr._OrtGetTensorData=function(){return(Mr._OrtGetTensorData=Mr.asm.ca).apply(null,arguments)},Mr._OrtReleaseTensor=function(){return(Mr._OrtReleaseTensor=Mr.asm.da).apply(null,arguments)},Mr._OrtCreateRunOptions=function(){return(Mr._OrtCreateRunOptions=Mr.asm.ea).apply(null,arguments)},Mr._OrtAddRunConfigEntry=function(){return(Mr._OrtAddRunConfigEntry=Mr.asm.fa).apply(null,arguments)},Mr._OrtReleaseRunOptions=function(){return(Mr._OrtReleaseRunOptions=Mr.asm.ga).apply(null,arguments)},Mr._OrtRun=function(){return(Mr._OrtRun=Mr.asm.ha).apply(null,arguments)},Mr._OrtEndProfiling=function(){return(Mr._OrtEndProfiling=Mr.asm.ia).apply(null,arguments)};var Dl=Mr._malloc=function(){return(Dl=Mr._malloc=Mr.asm.ja).apply(null,arguments)};Mr._free=function(){return(Mr._free=Mr.asm.ka).apply(null,arguments)};var ru,Ul=Mr.stackSave=function(){return(Ul=Mr.stackSave=Mr.asm.ma).apply(null,arguments)},Kl=Mr.stackRestore=function(){return(Kl=Mr.stackRestore=Mr.asm.na).apply(null,arguments)},vu=Mr.stackAlloc=function(){return(vu=Mr.stackAlloc=Mr.asm.oa).apply(null,arguments)};function Vo(){function Fs(){if(!ru&&(ru=!0,Mr.calledRun=!0,!ys)){if(Ws(Qs),Fr(Mr),Mr.onRuntimeInitialized&&Mr.onRuntimeInitialized(),Mr.postRun)for(typeof Mr.postRun=="function"&&(Mr.postRun=[Mr.postRun]);Mr.postRun.length;){var Ks=Mr.postRun.shift();no.unshift(Ks)}Ws(no)}}if(!(0<lo)){if(Mr.preRun)for(typeof Mr.preRun=="function"&&(Mr.preRun=[Mr.preRun]);Mr.preRun.length;)yo();Ws(fo),0<lo||(Mr.setStatus?(Mr.setStatus("Running..."),setTimeout(function(){setTimeout(function(){Mr.setStatus("")},1),Fs()},1)):Fs())}}if(Mr.___cxa_is_pointer_type=function(){return(Mr.___cxa_is_pointer_type=Mr.asm.pa).apply(null,arguments)},Mr.UTF8ToString=Ds,Mr.stringToUTF8=function(Fs,Ks,gs){return js(Fs,Ts,Ks,gs)},Mr.lengthBytesUTF8=zs,Mr.stackSave=Ul,Mr.stackRestore=Kl,Mr.stackAlloc=vu,vo=function Fs(){ru||Vo(),ru||(vo=Fs)},Mr.preInit)for(typeof Mr.preInit=="function"&&(Mr.preInit=[Mr.preInit]);0<Mr.preInit.length;)Mr.preInit.pop()();return Vo(),Dr.ready});_r.exports=Pr},4537:_r=>{_r.exports=function(Tr,Ar){for(var Rr=new Array(arguments.length-1),Pr=0,Dr=2,Mr=!0;Dr<arguments.length;)Rr[Pr++]=arguments[Dr++];return new Promise(function(Fr,zr){Rr[Pr]=function(jr){if(Mr)if(Mr=!1,jr)zr(jr);else{for(var Gr=new Array(arguments.length-1),Nr=0;Nr<Gr.length;)Gr[Nr++]=arguments[Nr];Fr.apply(null,Gr)}};try{Tr.apply(Ar||null,Rr)}catch(jr){Mr&&(Mr=!1,zr(jr))}})}},7419:(_r,Tr)=>{var Ar=Tr;Ar.length=function(Fr){var zr=Fr.length;if(!zr)return 0;for(var jr=0;--zr%4>1&&Fr.charAt(zr)==="=";)++jr;return Math.ceil(3*Fr.length)/4-jr};for(var Rr=new Array(64),Pr=new Array(123),Dr=0;Dr<64;)Pr[Rr[Dr]=Dr<26?Dr+65:Dr<52?Dr+71:Dr<62?Dr-4:Dr-59|43]=Dr++;Ar.encode=function(Fr,zr,jr){for(var Gr,Nr=null,Lr=[],Ur=0,Vr=0;zr<jr;){var Wr=Fr[zr++];switch(Vr){case 0:Lr[Ur++]=Rr[Wr>>2],Gr=(3&Wr)<<4,Vr=1;break;case 1:Lr[Ur++]=Rr[Gr|Wr>>4],Gr=(15&Wr)<<2,Vr=2;break;case 2:Lr[Ur++]=Rr[Gr|Wr>>6],Lr[Ur++]=Rr[63&Wr],Vr=0}Ur>8191&&((Nr||(Nr=[])).push(String.fromCharCode.apply(String,Lr)),Ur=0)}return Vr&&(Lr[Ur++]=Rr[Gr],Lr[Ur++]=61,Vr===1&&(Lr[Ur++]=61)),Nr?(Ur&&Nr.push(String.fromCharCode.apply(String,Lr.slice(0,Ur))),Nr.join("")):String.fromCharCode.apply(String,Lr.slice(0,Ur))};var Mr="invalid encoding";Ar.decode=function(Fr,zr,jr){for(var Gr,Nr=jr,Lr=0,Ur=0;Ur<Fr.length;){var Vr=Fr.charCodeAt(Ur++);if(Vr===61&&Lr>1)break;if((Vr=Pr[Vr])===void 0)throw Error(Mr);switch(Lr){case 0:Gr=Vr,Lr=1;break;case 1:zr[jr++]=Gr<<2|(48&Vr)>>4,Gr=Vr,Lr=2;break;case 2:zr[jr++]=(15&Gr)<<4|(60&Vr)>>2,Gr=Vr,Lr=3;break;case 3:zr[jr++]=(3&Gr)<<6|Vr,Lr=0}}if(Lr===1)throw Error(Mr);return jr-Nr},Ar.test=function(Fr){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(Fr)}},9211:_r=>{function Tr(){this._listeners={}}_r.exports=Tr,Tr.prototype.on=function(Ar,Rr,Pr){return(this._listeners[Ar]||(this._listeners[Ar]=[])).push({fn:Rr,ctx:Pr||this}),this},Tr.prototype.off=function(Ar,Rr){if(Ar===void 0)this._listeners={};else if(Rr===void 0)this._listeners[Ar]=[];else for(var Pr=this._listeners[Ar],Dr=0;Dr<Pr.length;)Pr[Dr].fn===Rr?Pr.splice(Dr,1):++Dr;return this},Tr.prototype.emit=function(Ar){var Rr=this._listeners[Ar];if(Rr){for(var Pr=[],Dr=1;Dr<arguments.length;)Pr.push(arguments[Dr++]);for(Dr=0;Dr<Rr.length;)Rr[Dr].fn.apply(Rr[Dr++].ctx,Pr)}return this}},945:_r=>{function Tr(Mr){return typeof Float32Array<"u"?function(){var Fr=new Float32Array([-0]),zr=new Uint8Array(Fr.buffer),jr=zr[3]===128;function Gr(Vr,Wr,qr){Fr[0]=Vr,Wr[qr]=zr[0],Wr[qr+1]=zr[1],Wr[qr+2]=zr[2],Wr[qr+3]=zr[3]}function Nr(Vr,Wr,qr){Fr[0]=Vr,Wr[qr]=zr[3],Wr[qr+1]=zr[2],Wr[qr+2]=zr[1],Wr[qr+3]=zr[0]}function Lr(Vr,Wr){return zr[0]=Vr[Wr],zr[1]=Vr[Wr+1],zr[2]=Vr[Wr+2],zr[3]=Vr[Wr+3],Fr[0]}function Ur(Vr,Wr){return zr[3]=Vr[Wr],zr[2]=Vr[Wr+1],zr[1]=Vr[Wr+2],zr[0]=Vr[Wr+3],Fr[0]}Mr.writeFloatLE=jr?Gr:Nr,Mr.writeFloatBE=jr?Nr:Gr,Mr.readFloatLE=jr?Lr:Ur,Mr.readFloatBE=jr?Ur:Lr}():function(){function Fr(jr,Gr,Nr,Lr){var Ur=Gr<0?1:0;if(Ur&&(Gr=-Gr),Gr===0)jr(1/Gr>0?0:2147483648,Nr,Lr);else if(isNaN(Gr))jr(2143289344,Nr,Lr);else if(Gr>34028234663852886e22)jr((Ur<<31|2139095040)>>>0,Nr,Lr);else if(Gr<11754943508222875e-54)jr((Ur<<31|Math.round(Gr/1401298464324817e-60))>>>0,Nr,Lr);else{var Vr=Math.floor(Math.log(Gr)/Math.LN2);jr((Ur<<31|Vr+127<<23|8388607&Math.round(Gr*Math.pow(2,-Vr)*8388608))>>>0,Nr,Lr)}}function zr(jr,Gr,Nr){var Lr=jr(Gr,Nr),Ur=2*(Lr>>31)+1,Vr=Lr>>>23&255,Wr=8388607&Lr;return Vr===255?Wr?NaN:Ur*(1/0):Vr===0?1401298464324817e-60*Ur*Wr:Ur*Math.pow(2,Vr-150)*(Wr+8388608)}Mr.writeFloatLE=Fr.bind(null,Ar),Mr.writeFloatBE=Fr.bind(null,Rr),Mr.readFloatLE=zr.bind(null,Pr),Mr.readFloatBE=zr.bind(null,Dr)}(),typeof Float64Array<"u"?function(){var Fr=new Float64Array([-0]),zr=new Uint8Array(Fr.buffer),jr=zr[7]===128;function Gr(Vr,Wr,qr){Fr[0]=Vr,Wr[qr]=zr[0],Wr[qr+1]=zr[1],Wr[qr+2]=zr[2],Wr[qr+3]=zr[3],Wr[qr+4]=zr[4],Wr[qr+5]=zr[5],Wr[qr+6]=zr[6],Wr[qr+7]=zr[7]}function Nr(Vr,Wr,qr){Fr[0]=Vr,Wr[qr]=zr[7],Wr[qr+1]=zr[6],Wr[qr+2]=zr[5],Wr[qr+3]=zr[4],Wr[qr+4]=zr[3],Wr[qr+5]=zr[2],Wr[qr+6]=zr[1],Wr[qr+7]=zr[0]}function Lr(Vr,Wr){return zr[0]=Vr[Wr],zr[1]=Vr[Wr+1],zr[2]=Vr[Wr+2],zr[3]=Vr[Wr+3],zr[4]=Vr[Wr+4],zr[5]=Vr[Wr+5],zr[6]=Vr[Wr+6],zr[7]=Vr[Wr+7],Fr[0]}function Ur(Vr,Wr){return zr[7]=Vr[Wr],zr[6]=Vr[Wr+1],zr[5]=Vr[Wr+2],zr[4]=Vr[Wr+3],zr[3]=Vr[Wr+4],zr[2]=Vr[Wr+5],zr[1]=Vr[Wr+6],zr[0]=Vr[Wr+7],Fr[0]}Mr.writeDoubleLE=jr?Gr:Nr,Mr.writeDoubleBE=jr?Nr:Gr,Mr.readDoubleLE=jr?Lr:Ur,Mr.readDoubleBE=jr?Ur:Lr}():function(){function Fr(jr,Gr,Nr,Lr,Ur,Vr){var Wr=Lr<0?1:0;if(Wr&&(Lr=-Lr),Lr===0)jr(0,Ur,Vr+Gr),jr(1/Lr>0?0:2147483648,Ur,Vr+Nr);else if(isNaN(Lr))jr(0,Ur,Vr+Gr),jr(2146959360,Ur,Vr+Nr);else if(Lr>17976931348623157e292)jr(0,Ur,Vr+Gr),jr((Wr<<31|2146435072)>>>0,Ur,Vr+Nr);else{var qr;if(Lr<22250738585072014e-324)jr((qr=Lr/5e-324)>>>0,Ur,Vr+Gr),jr((Wr<<31|qr/4294967296)>>>0,Ur,Vr+Nr);else{var Kr=Math.floor(Math.log(Lr)/Math.LN2);Kr===1024&&(Kr=1023),jr(4503599627370496*(qr=Lr*Math.pow(2,-Kr))>>>0,Ur,Vr+Gr),jr((Wr<<31|Kr+1023<<20|1048576*qr&1048575)>>>0,Ur,Vr+Nr)}}}function zr(jr,Gr,Nr,Lr,Ur){var Vr=jr(Lr,Ur+Gr),Wr=jr(Lr,Ur+Nr),qr=2*(Wr>>31)+1,Kr=Wr>>>20&2047,Xr=4294967296*(1048575&Wr)+Vr;return Kr===2047?Xr?NaN:qr*(1/0):Kr===0?5e-324*qr*Xr:qr*Math.pow(2,Kr-1075)*(Xr+4503599627370496)}Mr.writeDoubleLE=Fr.bind(null,Ar,0,4),Mr.writeDoubleBE=Fr.bind(null,Rr,4,0),Mr.readDoubleLE=zr.bind(null,Pr,0,4),Mr.readDoubleBE=zr.bind(null,Dr,4,0)}(),Mr}function Ar(Mr,Fr,zr){Fr[zr]=255&Mr,Fr[zr+1]=Mr>>>8&255,Fr[zr+2]=Mr>>>16&255,Fr[zr+3]=Mr>>>24}function Rr(Mr,Fr,zr){Fr[zr]=Mr>>>24,Fr[zr+1]=Mr>>>16&255,Fr[zr+2]=Mr>>>8&255,Fr[zr+3]=255&Mr}function Pr(Mr,Fr){return(Mr[Fr]|Mr[Fr+1]<<8|Mr[Fr+2]<<16|Mr[Fr+3]<<24)>>>0}function Dr(Mr,Fr){return(Mr[Fr]<<24|Mr[Fr+1]<<16|Mr[Fr+2]<<8|Mr[Fr+3])>>>0}_r.exports=Tr(Tr)},7199:module=>{function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(_r){}return null}module.exports=inquire},6662:_r=>{_r.exports=function(Tr,Ar,Rr){var Pr=Rr||8192,Dr=Pr>>>1,Mr=null,Fr=Pr;return function(zr){if(zr<1||zr>Dr)return Tr(zr);Fr+zr>Pr&&(Mr=Tr(Pr),Fr=0);var jr=Ar.call(Mr,Fr,Fr+=zr);return 7&Fr&&(Fr=1+(7|Fr)),jr}}},4997:(_r,Tr)=>{var Ar=Tr;Ar.length=function(Rr){for(var Pr=0,Dr=0,Mr=0;Mr<Rr.length;++Mr)(Dr=Rr.charCodeAt(Mr))<128?Pr+=1:Dr<2048?Pr+=2:(64512&Dr)==55296&&(64512&Rr.charCodeAt(Mr+1))==56320?(++Mr,Pr+=4):Pr+=3;return Pr},Ar.read=function(Rr,Pr,Dr){if(Dr-Pr<1)return"";for(var Mr,Fr=null,zr=[],jr=0;Pr<Dr;)(Mr=Rr[Pr++])<128?zr[jr++]=Mr:Mr>191&&Mr<224?zr[jr++]=(31&Mr)<<6|63&Rr[Pr++]:Mr>239&&Mr<365?(Mr=((7&Mr)<<18|(63&Rr[Pr++])<<12|(63&Rr[Pr++])<<6|63&Rr[Pr++])-65536,zr[jr++]=55296+(Mr>>10),zr[jr++]=56320+(1023&Mr)):zr[jr++]=(15&Mr)<<12|(63&Rr[Pr++])<<6|63&Rr[Pr++],jr>8191&&((Fr||(Fr=[])).push(String.fromCharCode.apply(String,zr)),jr=0);return Fr?(jr&&Fr.push(String.fromCharCode.apply(String,zr.slice(0,jr))),Fr.join("")):String.fromCharCode.apply(String,zr.slice(0,jr))},Ar.write=function(Rr,Pr,Dr){for(var Mr,Fr,zr=Dr,jr=0;jr<Rr.length;++jr)(Mr=Rr.charCodeAt(jr))<128?Pr[Dr++]=Mr:Mr<2048?(Pr[Dr++]=Mr>>6|192,Pr[Dr++]=63&Mr|128):(64512&Mr)==55296&&(64512&(Fr=Rr.charCodeAt(jr+1)))==56320?(Mr=65536+((1023&Mr)<<10)+(1023&Fr),++jr,Pr[Dr++]=Mr>>18|240,Pr[Dr++]=Mr>>12&63|128,Pr[Dr++]=Mr>>6&63|128,Pr[Dr++]=63&Mr|128):(Pr[Dr++]=Mr>>12|224,Pr[Dr++]=Mr>>6&63|128,Pr[Dr++]=63&Mr|128);return Dr-zr}},3442:(_r,Tr)=>{Tr.__esModule=!0;var Ar=function(){function Rr(Pr){if(!Pr)throw new TypeError("Invalid argument; `value` has no value.");this.value=Rr.EMPTY,Pr&&Rr.isGuid(Pr)&&(this.value=Pr)}return Rr.isGuid=function(Pr){var Dr=Pr.toString();return Pr&&(Pr instanceof Rr||Rr.validator.test(Dr))},Rr.create=function(){return new Rr([Rr.gen(2),Rr.gen(1),Rr.gen(1),Rr.gen(1),Rr.gen(3)].join("-"))},Rr.createEmpty=function(){return new Rr("emptyguid")},Rr.parse=function(Pr){return new Rr(Pr)},Rr.raw=function(){return[Rr.gen(2),Rr.gen(1),Rr.gen(1),Rr.gen(1),Rr.gen(3)].join("-")},Rr.gen=function(Pr){for(var Dr="",Mr=0;Mr<Pr;Mr++)Dr+=(65536*(1+Math.random())|0).toString(16).substring(1);return Dr},Rr.prototype.equals=function(Pr){return Rr.isGuid(Pr)&&this.value===Pr.toString()},Rr.prototype.isEmpty=function(){return this.value===Rr.EMPTY},Rr.prototype.toString=function(){return this.value},Rr.prototype.toJSON=function(){return{value:this.value}},Rr.validator=new RegExp("^[a-z0-9]{8}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{12}$","i"),Rr.EMPTY="00000000-0000-0000-0000-000000000000",Rr}();Tr.Guid=Ar},3720:_r=>{_r.exports=Ar;var Tr=null;try{Tr=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function Ar(rs,as,ls){this.low=0|rs,this.high=0|as,this.unsigned=!!ls}function Rr(rs){return(rs&&rs.__isLong__)===!0}Ar.prototype.__isLong__,Object.defineProperty(Ar.prototype,"__isLong__",{value:!0}),Ar.isLong=Rr;var Pr={},Dr={};function Mr(rs,as){var ls,fs,Ts;return as?(Ts=0<=(rs>>>=0)&&rs<256)&&(fs=Dr[rs])?fs:(ls=zr(rs,(0|rs)<0?-1:0,!0),Ts&&(Dr[rs]=ls),ls):(Ts=-128<=(rs|=0)&&rs<128)&&(fs=Pr[rs])?fs:(ls=zr(rs,rs<0?-1:0,!1),Ts&&(Pr[rs]=ls),ls)}function Fr(rs,as){if(isNaN(rs))return as?Kr:qr;if(as){if(rs<0)return Kr;if(rs>=Ur)return es}else{if(rs<=-Vr)return ts;if(rs+1>=Vr)return Jr}return rs<0?Fr(-rs,as).neg():zr(rs%Lr|0,rs/Lr|0,as)}function zr(rs,as,ls){return new Ar(rs,as,ls)}Ar.fromInt=Mr,Ar.fromNumber=Fr,Ar.fromBits=zr;var jr=Math.pow;function Gr(rs,as,ls){if(rs.length===0)throw Error("empty string");if(rs==="NaN"||rs==="Infinity"||rs==="+Infinity"||rs==="-Infinity")return qr;if(typeof as=="number"?(ls=as,as=!1):as=!!as,(ls=ls||10)<2||36<ls)throw RangeError("radix");var fs;if((fs=rs.indexOf("-"))>0)throw Error("interior hyphen");if(fs===0)return Gr(rs.substring(1),as,ls).neg();for(var Ts=Fr(jr(ls,8)),$s=qr,xs=0;xs<rs.length;xs+=8){var ys=Math.min(8,rs.length-xs),ps=parseInt(rs.substring(xs,xs+ys),ls);if(ys<8){var vs=Fr(jr(ls,ys));$s=$s.mul(vs).add(Fr(ps))}else $s=($s=$s.mul(Ts)).add(Fr(ps))}return $s.unsigned=as,$s}function Nr(rs,as){return typeof rs=="number"?Fr(rs,as):typeof rs=="string"?Gr(rs,as):zr(rs.low,rs.high,typeof as=="boolean"?as:rs.unsigned)}Ar.fromString=Gr,Ar.fromValue=Nr;var Lr=4294967296,Ur=Lr*Lr,Vr=Ur/2,Wr=Mr(1<<24),qr=Mr(0);Ar.ZERO=qr;var Kr=Mr(0,!0);Ar.UZERO=Kr;var Xr=Mr(1);Ar.ONE=Xr;var Zr=Mr(1,!0);Ar.UONE=Zr;var _i=Mr(-1);Ar.NEG_ONE=_i;var Jr=zr(-1,2147483647,!1);Ar.MAX_VALUE=Jr;var es=zr(-1,-1,!0);Ar.MAX_UNSIGNED_VALUE=es;var ts=zr(0,-2147483648,!1);Ar.MIN_VALUE=ts;var is=Ar.prototype;is.toInt=function(){return this.unsigned?this.low>>>0:this.low},is.toNumber=function(){return this.unsigned?(this.high>>>0)*Lr+(this.low>>>0):this.high*Lr+(this.low>>>0)},is.toString=function(rs){if((rs=rs||10)<2||36<rs)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(ts)){var as=Fr(rs),ls=this.div(as),fs=ls.mul(as).sub(this);return ls.toString(rs)+fs.toInt().toString(rs)}return"-"+this.neg().toString(rs)}for(var Ts=Fr(jr(rs,6),this.unsigned),$s=this,xs="";;){var ys=$s.div(Ts),ps=($s.sub(ys.mul(Ts)).toInt()>>>0).toString(rs);if(($s=ys).isZero())return ps+xs;for(;ps.length<6;)ps="0"+ps;xs=""+ps+xs}},is.getHighBits=function(){return this.high},is.getHighBitsUnsigned=function(){return this.high>>>0},is.getLowBits=function(){return this.low},is.getLowBitsUnsigned=function(){return this.low>>>0},is.getNumBitsAbs=function(){if(this.isNegative())return this.eq(ts)?64:this.neg().getNumBitsAbs();for(var rs=this.high!=0?this.high:this.low,as=31;as>0&&!(rs&1<<as);as--);return this.high!=0?as+33:as+1},is.isZero=function(){return this.high===0&&this.low===0},is.eqz=is.isZero,is.isNegative=function(){return!this.unsigned&&this.high<0},is.isPositive=function(){return this.unsigned||this.high>=0},is.isOdd=function(){return(1&this.low)==1},is.isEven=function(){return(1&this.low)==0},is.equals=function(rs){return Rr(rs)||(rs=Nr(rs)),(this.unsigned===rs.unsigned||this.high>>>31!=1||rs.high>>>31!=1)&&this.high===rs.high&&this.low===rs.low},is.eq=is.equals,is.notEquals=function(rs){return!this.eq(rs)},is.neq=is.notEquals,is.ne=is.notEquals,is.lessThan=function(rs){return this.comp(rs)<0},is.lt=is.lessThan,is.lessThanOrEqual=function(rs){return this.comp(rs)<=0},is.lte=is.lessThanOrEqual,is.le=is.lessThanOrEqual,is.greaterThan=function(rs){return this.comp(rs)>0},is.gt=is.greaterThan,is.greaterThanOrEqual=function(rs){return this.comp(rs)>=0},is.gte=is.greaterThanOrEqual,is.ge=is.greaterThanOrEqual,is.compare=function(rs){if(Rr(rs)||(rs=Nr(rs)),this.eq(rs))return 0;var as=this.isNegative(),ls=rs.isNegative();return as&&!ls?-1:!as&&ls?1:this.unsigned?rs.high>>>0>this.high>>>0||rs.high===this.high&&rs.low>>>0>this.low>>>0?-1:1:this.sub(rs).isNegative()?-1:1},is.comp=is.compare,is.negate=function(){return!this.unsigned&&this.eq(ts)?ts:this.not().add(Xr)},is.neg=is.negate,is.add=function(rs){Rr(rs)||(rs=Nr(rs));var as=this.high>>>16,ls=65535&this.high,fs=this.low>>>16,Ts=65535&this.low,$s=rs.high>>>16,xs=65535&rs.high,ys=rs.low>>>16,ps=0,vs=0,Ds=0,js=0;return Ds+=(js+=Ts+(65535&rs.low))>>>16,vs+=(Ds+=fs+ys)>>>16,ps+=(vs+=ls+xs)>>>16,ps+=as+$s,zr((Ds&=65535)<<16|(js&=65535),(ps&=65535)<<16|(vs&=65535),this.unsigned)},is.subtract=function(rs){return Rr(rs)||(rs=Nr(rs)),this.add(rs.neg())},is.sub=is.subtract,is.multiply=function(rs){if(this.isZero())return qr;if(Rr(rs)||(rs=Nr(rs)),Tr)return zr(Tr.mul(this.low,this.high,rs.low,rs.high),Tr.get_high(),this.unsigned);if(rs.isZero())return qr;if(this.eq(ts))return rs.isOdd()?ts:qr;if(rs.eq(ts))return this.isOdd()?ts:qr;if(this.isNegative())return rs.isNegative()?this.neg().mul(rs.neg()):this.neg().mul(rs).neg();if(rs.isNegative())return this.mul(rs.neg()).neg();if(this.lt(Wr)&&rs.lt(Wr))return Fr(this.toNumber()*rs.toNumber(),this.unsigned);var as=this.high>>>16,ls=65535&this.high,fs=this.low>>>16,Ts=65535&this.low,$s=rs.high>>>16,xs=65535&rs.high,ys=rs.low>>>16,ps=65535&rs.low,vs=0,Ds=0,js=0,zs=0;return js+=(zs+=Ts*ps)>>>16,Ds+=(js+=fs*ps)>>>16,js&=65535,Ds+=(js+=Ts*ys)>>>16,vs+=(Ds+=ls*ps)>>>16,Ds&=65535,vs+=(Ds+=fs*ys)>>>16,Ds&=65535,vs+=(Ds+=Ts*xs)>>>16,vs+=as*ps+ls*ys+fs*xs+Ts*$s,zr((js&=65535)<<16|(zs&=65535),(vs&=65535)<<16|(Ds&=65535),this.unsigned)},is.mul=is.multiply,is.divide=function(rs){if(Rr(rs)||(rs=Nr(rs)),rs.isZero())throw Error("division by zero");var as,ls,fs;if(Tr)return this.unsigned||this.high!==-2147483648||rs.low!==-1||rs.high!==-1?zr((this.unsigned?Tr.div_u:Tr.div_s)(this.low,this.high,rs.low,rs.high),Tr.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?Kr:qr;if(this.unsigned){if(rs.unsigned||(rs=rs.toUnsigned()),rs.gt(this))return Kr;if(rs.gt(this.shru(1)))return Zr;fs=Kr}else{if(this.eq(ts))return rs.eq(Xr)||rs.eq(_i)?ts:rs.eq(ts)?Xr:(as=this.shr(1).div(rs).shl(1)).eq(qr)?rs.isNegative()?Xr:_i:(ls=this.sub(rs.mul(as)),fs=as.add(ls.div(rs)));if(rs.eq(ts))return this.unsigned?Kr:qr;if(this.isNegative())return rs.isNegative()?this.neg().div(rs.neg()):this.neg().div(rs).neg();if(rs.isNegative())return this.div(rs.neg()).neg();fs=qr}for(ls=this;ls.gte(rs);){as=Math.max(1,Math.floor(ls.toNumber()/rs.toNumber()));for(var Ts=Math.ceil(Math.log(as)/Math.LN2),$s=Ts<=48?1:jr(2,Ts-48),xs=Fr(as),ys=xs.mul(rs);ys.isNegative()||ys.gt(ls);)ys=(xs=Fr(as-=$s,this.unsigned)).mul(rs);xs.isZero()&&(xs=Xr),fs=fs.add(xs),ls=ls.sub(ys)}return fs},is.div=is.divide,is.modulo=function(rs){return Rr(rs)||(rs=Nr(rs)),Tr?zr((this.unsigned?Tr.rem_u:Tr.rem_s)(this.low,this.high,rs.low,rs.high),Tr.get_high(),this.unsigned):this.sub(this.div(rs).mul(rs))},is.mod=is.modulo,is.rem=is.modulo,is.not=function(){return zr(~this.low,~this.high,this.unsigned)},is.and=function(rs){return Rr(rs)||(rs=Nr(rs)),zr(this.low&rs.low,this.high&rs.high,this.unsigned)},is.or=function(rs){return Rr(rs)||(rs=Nr(rs)),zr(this.low|rs.low,this.high|rs.high,this.unsigned)},is.xor=function(rs){return Rr(rs)||(rs=Nr(rs)),zr(this.low^rs.low,this.high^rs.high,this.unsigned)},is.shiftLeft=function(rs){return Rr(rs)&&(rs=rs.toInt()),(rs&=63)==0?this:rs<32?zr(this.low<<rs,this.high<<rs|this.low>>>32-rs,this.unsigned):zr(0,this.low<<rs-32,this.unsigned)},is.shl=is.shiftLeft,is.shiftRight=function(rs){return Rr(rs)&&(rs=rs.toInt()),(rs&=63)==0?this:rs<32?zr(this.low>>>rs|this.high<<32-rs,this.high>>rs,this.unsigned):zr(this.high>>rs-32,this.high>=0?0:-1,this.unsigned)},is.shr=is.shiftRight,is.shiftRightUnsigned=function(rs){if(Rr(rs)&&(rs=rs.toInt()),(rs&=63)==0)return this;var as=this.high;return rs<32?zr(this.low>>>rs|as<<32-rs,as>>>rs,this.unsigned):zr(rs===32?as:as>>>rs-32,0,this.unsigned)},is.shru=is.shiftRightUnsigned,is.shr_u=is.shiftRightUnsigned,is.toSigned=function(){return this.unsigned?zr(this.low,this.high,!1):this},is.toUnsigned=function(){return this.unsigned?this:zr(this.low,this.high,!0)},is.toBytes=function(rs){return rs?this.toBytesLE():this.toBytesBE()},is.toBytesLE=function(){var rs=this.high,as=this.low;return[255&as,as>>>8&255,as>>>16&255,as>>>24,255&rs,rs>>>8&255,rs>>>16&255,rs>>>24]},is.toBytesBE=function(){var rs=this.high,as=this.low;return[rs>>>24,rs>>>16&255,rs>>>8&255,255&rs,as>>>24,as>>>16&255,as>>>8&255,255&as]},Ar.fromBytes=function(rs,as,ls){return ls?Ar.fromBytesLE(rs,as):Ar.fromBytesBE(rs,as)},Ar.fromBytesLE=function(rs,as){return new Ar(rs[0]|rs[1]<<8|rs[2]<<16|rs[3]<<24,rs[4]|rs[5]<<8|rs[6]<<16|rs[7]<<24,as)},Ar.fromBytesBE=function(rs,as){return new Ar(rs[4]<<24|rs[5]<<16|rs[6]<<8|rs[7],rs[0]<<24|rs[1]<<16|rs[2]<<8|rs[3],as)}},1446:(_r,Tr,Ar)=>{var Rr,Pr,Dr,Mr=Ar(2100),Fr=Mr.Reader,zr=Mr.Writer,jr=Mr.util,Gr=Mr.roots.default||(Mr.roots.default={});Gr.onnx=((Dr={}).Version=(Rr={},(Pr=Object.create(Rr))[Rr[0]="_START_VERSION"]=0,Pr[Rr[1]="IR_VERSION_2017_10_10"]=1,Pr[Rr[2]="IR_VERSION_2017_10_30"]=2,Pr[Rr[3]="IR_VERSION_2017_11_3"]=3,Pr[Rr[4]="IR_VERSION_2019_1_22"]=4,Pr[Rr[5]="IR_VERSION"]=5,Pr),Dr.AttributeProto=function(){function Nr(Lr){if(this.floats=[],this.ints=[],this.strings=[],this.tensors=[],this.graphs=[],Lr)for(var Ur=Object.keys(Lr),Vr=0;Vr<Ur.length;++Vr)Lr[Ur[Vr]]!=null&&(this[Ur[Vr]]=Lr[Ur[Vr]])}return Nr.prototype.name="",Nr.prototype.refAttrName="",Nr.prototype.docString="",Nr.prototype.type=0,Nr.prototype.f=0,Nr.prototype.i=jr.Long?jr.Long.fromBits(0,0,!1):0,Nr.prototype.s=jr.newBuffer([]),Nr.prototype.t=null,Nr.prototype.g=null,Nr.prototype.floats=jr.emptyArray,Nr.prototype.ints=jr.emptyArray,Nr.prototype.strings=jr.emptyArray,Nr.prototype.tensors=jr.emptyArray,Nr.prototype.graphs=jr.emptyArray,Nr.create=function(Lr){return new Nr(Lr)},Nr.encode=function(Lr,Ur){if(Ur||(Ur=zr.create()),Lr.name!=null&&Lr.hasOwnProperty("name")&&Ur.uint32(10).string(Lr.name),Lr.f!=null&&Lr.hasOwnProperty("f")&&Ur.uint32(21).float(Lr.f),Lr.i!=null&&Lr.hasOwnProperty("i")&&Ur.uint32(24).int64(Lr.i),Lr.s!=null&&Lr.hasOwnProperty("s")&&Ur.uint32(34).bytes(Lr.s),Lr.t!=null&&Lr.hasOwnProperty("t")&&Gr.onnx.TensorProto.encode(Lr.t,Ur.uint32(42).fork()).ldelim(),Lr.g!=null&&Lr.hasOwnProperty("g")&&Gr.onnx.GraphProto.encode(Lr.g,Ur.uint32(50).fork()).ldelim(),Lr.floats!=null&&Lr.floats.length){Ur.uint32(58).fork();for(var Vr=0;Vr<Lr.floats.length;++Vr)Ur.float(Lr.floats[Vr]);Ur.ldelim()}if(Lr.ints!=null&&Lr.ints.length){for(Ur.uint32(66).fork(),Vr=0;Vr<Lr.ints.length;++Vr)Ur.int64(Lr.ints[Vr]);Ur.ldelim()}if(Lr.strings!=null&&Lr.strings.length)for(Vr=0;Vr<Lr.strings.length;++Vr)Ur.uint32(74).bytes(Lr.strings[Vr]);if(Lr.tensors!=null&&Lr.tensors.length)for(Vr=0;Vr<Lr.tensors.length;++Vr)Gr.onnx.TensorProto.encode(Lr.tensors[Vr],Ur.uint32(82).fork()).ldelim();if(Lr.graphs!=null&&Lr.graphs.length)for(Vr=0;Vr<Lr.graphs.length;++Vr)Gr.onnx.GraphProto.encode(Lr.graphs[Vr],Ur.uint32(90).fork()).ldelim();return Lr.docString!=null&&Lr.hasOwnProperty("docString")&&Ur.uint32(106).string(Lr.docString),Lr.type!=null&&Lr.hasOwnProperty("type")&&Ur.uint32(160).int32(Lr.type),Lr.refAttrName!=null&&Lr.hasOwnProperty("refAttrName")&&Ur.uint32(170).string(Lr.refAttrName),Ur},Nr.encodeDelimited=function(Lr,Ur){return this.encode(Lr,Ur).ldelim()},Nr.decode=function(Lr,Ur){Lr instanceof Fr||(Lr=Fr.create(Lr));for(var Vr=Ur===void 0?Lr.len:Lr.pos+Ur,Wr=new Gr.onnx.AttributeProto;Lr.pos<Vr;){var qr=Lr.uint32();switch(qr>>>3){case 1:Wr.name=Lr.string();break;case 21:Wr.refAttrName=Lr.string();break;case 13:Wr.docString=Lr.string();break;case 20:Wr.type=Lr.int32();break;case 2:Wr.f=Lr.float();break;case 3:Wr.i=Lr.int64();break;case 4:Wr.s=Lr.bytes();break;case 5:Wr.t=Gr.onnx.TensorProto.decode(Lr,Lr.uint32());break;case 6:Wr.g=Gr.onnx.GraphProto.decode(Lr,Lr.uint32());break;case 7:if(Wr.floats&&Wr.floats.length||(Wr.floats=[]),(7&qr)==2)for(var Kr=Lr.uint32()+Lr.pos;Lr.pos<Kr;)Wr.floats.push(Lr.float());else Wr.floats.push(Lr.float());break;case 8:if(Wr.ints&&Wr.ints.length||(Wr.ints=[]),(7&qr)==2)for(Kr=Lr.uint32()+Lr.pos;Lr.pos<Kr;)Wr.ints.push(Lr.int64());else Wr.ints.push(Lr.int64());break;case 9:Wr.strings&&Wr.strings.length||(Wr.strings=[]),Wr.strings.push(Lr.bytes());break;case 10:Wr.tensors&&Wr.tensors.length||(Wr.tensors=[]),Wr.tensors.push(Gr.onnx.TensorProto.decode(Lr,Lr.uint32()));break;case 11:Wr.graphs&&Wr.graphs.length||(Wr.graphs=[]),Wr.graphs.push(Gr.onnx.GraphProto.decode(Lr,Lr.uint32()));break;default:Lr.skipType(7&qr)}}return Wr},Nr.decodeDelimited=function(Lr){return Lr instanceof Fr||(Lr=new Fr(Lr)),this.decode(Lr,Lr.uint32())},Nr.verify=function(Lr){if(typeof Lr!="object"||Lr===null)return"object expected";if(Lr.name!=null&&Lr.hasOwnProperty("name")&&!jr.isString(Lr.name))return"name: string expected";if(Lr.refAttrName!=null&&Lr.hasOwnProperty("refAttrName")&&!jr.isString(Lr.refAttrName))return"refAttrName: string expected";if(Lr.docString!=null&&Lr.hasOwnProperty("docString")&&!jr.isString(Lr.docString))return"docString: string expected";if(Lr.type!=null&&Lr.hasOwnProperty("type"))switch(Lr.type){default:return"type: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:}if(Lr.f!=null&&Lr.hasOwnProperty("f")&&typeof Lr.f!="number")return"f: number expected";if(Lr.i!=null&&Lr.hasOwnProperty("i")&&!(jr.isInteger(Lr.i)||Lr.i&&jr.isInteger(Lr.i.low)&&jr.isInteger(Lr.i.high)))return"i: integer|Long expected";if(Lr.s!=null&&Lr.hasOwnProperty("s")&&!(Lr.s&&typeof Lr.s.length=="number"||jr.isString(Lr.s)))return"s: buffer expected";if(Lr.t!=null&&Lr.hasOwnProperty("t")&&(Vr=Gr.onnx.TensorProto.verify(Lr.t)))return"t."+Vr;if(Lr.g!=null&&Lr.hasOwnProperty("g")&&(Vr=Gr.onnx.GraphProto.verify(Lr.g)))return"g."+Vr;if(Lr.floats!=null&&Lr.hasOwnProperty("floats")){if(!Array.isArray(Lr.floats))return"floats: array expected";for(var Ur=0;Ur<Lr.floats.length;++Ur)if(typeof Lr.floats[Ur]!="number")return"floats: number[] expected"}if(Lr.ints!=null&&Lr.hasOwnProperty("ints")){if(!Array.isArray(Lr.ints))return"ints: array expected";for(Ur=0;Ur<Lr.ints.length;++Ur)if(!(jr.isInteger(Lr.ints[Ur])||Lr.ints[Ur]&&jr.isInteger(Lr.ints[Ur].low)&&jr.isInteger(Lr.ints[Ur].high)))return"ints: integer|Long[] expected"}if(Lr.strings!=null&&Lr.hasOwnProperty("strings")){if(!Array.isArray(Lr.strings))return"strings: array expected";for(Ur=0;Ur<Lr.strings.length;++Ur)if(!(Lr.strings[Ur]&&typeof Lr.strings[Ur].length=="number"||jr.isString(Lr.strings[Ur])))return"strings: buffer[] expected"}if(Lr.tensors!=null&&Lr.hasOwnProperty("tensors")){if(!Array.isArray(Lr.tensors))return"tensors: array expected";for(Ur=0;Ur<Lr.tensors.length;++Ur)if(Vr=Gr.onnx.TensorProto.verify(Lr.tensors[Ur]))return"tensors."+Vr}if(Lr.graphs!=null&&Lr.hasOwnProperty("graphs")){if(!Array.isArray(Lr.graphs))return"graphs: array expected";for(Ur=0;Ur<Lr.graphs.length;++Ur){var Vr;if(Vr=Gr.onnx.GraphProto.verify(Lr.graphs[Ur]))return"graphs."+Vr}}return null},Nr.fromObject=function(Lr){if(Lr instanceof Gr.onnx.AttributeProto)return Lr;var Ur=new Gr.onnx.AttributeProto;switch(Lr.name!=null&&(Ur.name=String(Lr.name)),Lr.refAttrName!=null&&(Ur.refAttrName=String(Lr.refAttrName)),Lr.docString!=null&&(Ur.docString=String(Lr.docString)),Lr.type){case"UNDEFINED":case 0:Ur.type=0;break;case"FLOAT":case 1:Ur.type=1;break;case"INT":case 2:Ur.type=2;break;case"STRING":case 3:Ur.type=3;break;case"TENSOR":case 4:Ur.type=4;break;case"GRAPH":case 5:Ur.type=5;break;case"FLOATS":case 6:Ur.type=6;break;case"INTS":case 7:Ur.type=7;break;case"STRINGS":case 8:Ur.type=8;break;case"TENSORS":case 9:Ur.type=9;break;case"GRAPHS":case 10:Ur.type=10}if(Lr.f!=null&&(Ur.f=Number(Lr.f)),Lr.i!=null&&(jr.Long?(Ur.i=jr.Long.fromValue(Lr.i)).unsigned=!1:typeof Lr.i=="string"?Ur.i=parseInt(Lr.i,10):typeof Lr.i=="number"?Ur.i=Lr.i:typeof Lr.i=="object"&&(Ur.i=new jr.LongBits(Lr.i.low>>>0,Lr.i.high>>>0).toNumber())),Lr.s!=null&&(typeof Lr.s=="string"?jr.base64.decode(Lr.s,Ur.s=jr.newBuffer(jr.base64.length(Lr.s)),0):Lr.s.length&&(Ur.s=Lr.s)),Lr.t!=null){if(typeof Lr.t!="object")throw TypeError(".onnx.AttributeProto.t: object expected");Ur.t=Gr.onnx.TensorProto.fromObject(Lr.t)}if(Lr.g!=null){if(typeof Lr.g!="object")throw TypeError(".onnx.AttributeProto.g: object expected");Ur.g=Gr.onnx.GraphProto.fromObject(Lr.g)}if(Lr.floats){if(!Array.isArray(Lr.floats))throw TypeError(".onnx.AttributeProto.floats: array expected");Ur.floats=[];for(var Vr=0;Vr<Lr.floats.length;++Vr)Ur.floats[Vr]=Number(Lr.floats[Vr])}if(Lr.ints){if(!Array.isArray(Lr.ints))throw TypeError(".onnx.AttributeProto.ints: array expected");for(Ur.ints=[],Vr=0;Vr<Lr.ints.length;++Vr)jr.Long?(Ur.ints[Vr]=jr.Long.fromValue(Lr.ints[Vr])).unsigned=!1:typeof Lr.ints[Vr]=="string"?Ur.ints[Vr]=parseInt(Lr.ints[Vr],10):typeof Lr.ints[Vr]=="number"?Ur.ints[Vr]=Lr.ints[Vr]:typeof Lr.ints[Vr]=="object"&&(Ur.ints[Vr]=new jr.LongBits(Lr.ints[Vr].low>>>0,Lr.ints[Vr].high>>>0).toNumber())}if(Lr.strings){if(!Array.isArray(Lr.strings))throw TypeError(".onnx.AttributeProto.strings: array expected");for(Ur.strings=[],Vr=0;Vr<Lr.strings.length;++Vr)typeof Lr.strings[Vr]=="string"?jr.base64.decode(Lr.strings[Vr],Ur.strings[Vr]=jr.newBuffer(jr.base64.length(Lr.strings[Vr])),0):Lr.strings[Vr].length&&(Ur.strings[Vr]=Lr.strings[Vr])}if(Lr.tensors){if(!Array.isArray(Lr.tensors))throw TypeError(".onnx.AttributeProto.tensors: array expected");for(Ur.tensors=[],Vr=0;Vr<Lr.tensors.length;++Vr){if(typeof Lr.tensors[Vr]!="object")throw TypeError(".onnx.AttributeProto.tensors: object expected");Ur.tensors[Vr]=Gr.onnx.TensorProto.fromObject(Lr.tensors[Vr])}}if(Lr.graphs){if(!Array.isArray(Lr.graphs))throw TypeError(".onnx.AttributeProto.graphs: array expected");for(Ur.graphs=[],Vr=0;Vr<Lr.graphs.length;++Vr){if(typeof Lr.graphs[Vr]!="object")throw TypeError(".onnx.AttributeProto.graphs: object expected");Ur.graphs[Vr]=Gr.onnx.GraphProto.fromObject(Lr.graphs[Vr])}}return Ur},Nr.toObject=function(Lr,Ur){Ur||(Ur={});var Vr={};if((Ur.arrays||Ur.defaults)&&(Vr.floats=[],Vr.ints=[],Vr.strings=[],Vr.tensors=[],Vr.graphs=[]),Ur.defaults){if(Vr.name="",Vr.f=0,jr.Long){var Wr=new jr.Long(0,0,!1);Vr.i=Ur.longs===String?Wr.toString():Ur.longs===Number?Wr.toNumber():Wr}else Vr.i=Ur.longs===String?"0":0;Ur.bytes===String?Vr.s="":(Vr.s=[],Ur.bytes!==Array&&(Vr.s=jr.newBuffer(Vr.s))),Vr.t=null,Vr.g=null,Vr.docString="",Vr.type=Ur.enums===String?"UNDEFINED":0,Vr.refAttrName=""}if(Lr.name!=null&&Lr.hasOwnProperty("name")&&(Vr.name=Lr.name),Lr.f!=null&&Lr.hasOwnProperty("f")&&(Vr.f=Ur.json&&!isFinite(Lr.f)?String(Lr.f):Lr.f),Lr.i!=null&&Lr.hasOwnProperty("i")&&(typeof Lr.i=="number"?Vr.i=Ur.longs===String?String(Lr.i):Lr.i:Vr.i=Ur.longs===String?jr.Long.prototype.toString.call(Lr.i):Ur.longs===Number?new jr.LongBits(Lr.i.low>>>0,Lr.i.high>>>0).toNumber():Lr.i),Lr.s!=null&&Lr.hasOwnProperty("s")&&(Vr.s=Ur.bytes===String?jr.base64.encode(Lr.s,0,Lr.s.length):Ur.bytes===Array?Array.prototype.slice.call(Lr.s):Lr.s),Lr.t!=null&&Lr.hasOwnProperty("t")&&(Vr.t=Gr.onnx.TensorProto.toObject(Lr.t,Ur)),Lr.g!=null&&Lr.hasOwnProperty("g")&&(Vr.g=Gr.onnx.GraphProto.toObject(Lr.g,Ur)),Lr.floats&&Lr.floats.length){Vr.floats=[];for(var qr=0;qr<Lr.floats.length;++qr)Vr.floats[qr]=Ur.json&&!isFinite(Lr.floats[qr])?String(Lr.floats[qr]):Lr.floats[qr]}if(Lr.ints&&Lr.ints.length)for(Vr.ints=[],qr=0;qr<Lr.ints.length;++qr)typeof Lr.ints[qr]=="number"?Vr.ints[qr]=Ur.longs===String?String(Lr.ints[qr]):Lr.ints[qr]:Vr.ints[qr]=Ur.longs===String?jr.Long.prototype.toString.call(Lr.ints[qr]):Ur.longs===Number?new jr.LongBits(Lr.ints[qr].low>>>0,Lr.ints[qr].high>>>0).toNumber():Lr.ints[qr];if(Lr.strings&&Lr.strings.length)for(Vr.strings=[],qr=0;qr<Lr.strings.length;++qr)Vr.strings[qr]=Ur.bytes===String?jr.base64.encode(Lr.strings[qr],0,Lr.strings[qr].length):Ur.bytes===Array?Array.prototype.slice.call(Lr.strings[qr]):Lr.strings[qr];if(Lr.tensors&&Lr.tensors.length)for(Vr.tensors=[],qr=0;qr<Lr.tensors.length;++qr)Vr.tensors[qr]=Gr.onnx.TensorProto.toObject(Lr.tensors[qr],Ur);if(Lr.graphs&&Lr.graphs.length)for(Vr.graphs=[],qr=0;qr<Lr.graphs.length;++qr)Vr.graphs[qr]=Gr.onnx.GraphProto.toObject(Lr.graphs[qr],Ur);return Lr.docString!=null&&Lr.hasOwnProperty("docString")&&(Vr.docString=Lr.docString),Lr.type!=null&&Lr.hasOwnProperty("type")&&(Vr.type=Ur.enums===String?Gr.onnx.AttributeProto.AttributeType[Lr.type]:Lr.type),Lr.refAttrName!=null&&Lr.hasOwnProperty("refAttrName")&&(Vr.refAttrName=Lr.refAttrName),Vr},Nr.prototype.toJSON=function(){return this.constructor.toObject(this,Mr.util.toJSONOptions)},Nr.AttributeType=function(){var Lr={},Ur=Object.create(Lr);return Ur[Lr[0]="UNDEFINED"]=0,Ur[Lr[1]="FLOAT"]=1,Ur[Lr[2]="INT"]=2,Ur[Lr[3]="STRING"]=3,Ur[Lr[4]="TENSOR"]=4,Ur[Lr[5]="GRAPH"]=5,Ur[Lr[6]="FLOATS"]=6,Ur[Lr[7]="INTS"]=7,Ur[Lr[8]="STRINGS"]=8,Ur[Lr[9]="TENSORS"]=9,Ur[Lr[10]="GRAPHS"]=10,Ur}(),Nr}(),Dr.ValueInfoProto=function(){function Nr(Lr){if(Lr)for(var Ur=Object.keys(Lr),Vr=0;Vr<Ur.length;++Vr)Lr[Ur[Vr]]!=null&&(this[Ur[Vr]]=Lr[Ur[Vr]])}return Nr.prototype.name="",Nr.prototype.type=null,Nr.prototype.docString="",Nr.create=function(Lr){return new Nr(Lr)},Nr.encode=function(Lr,Ur){return Ur||(Ur=zr.create()),Lr.name!=null&&Lr.hasOwnProperty("name")&&Ur.uint32(10).string(Lr.name),Lr.type!=null&&Lr.hasOwnProperty("type")&&Gr.onnx.TypeProto.encode(Lr.type,Ur.uint32(18).fork()).ldelim(),Lr.docString!=null&&Lr.hasOwnProperty("docString")&&Ur.uint32(26).string(Lr.docString),Ur},Nr.encodeDelimited=function(Lr,Ur){return this.encode(Lr,Ur).ldelim()},Nr.decode=function(Lr,Ur){Lr instanceof Fr||(Lr=Fr.create(Lr));for(var Vr=Ur===void 0?Lr.len:Lr.pos+Ur,Wr=new Gr.onnx.ValueInfoProto;Lr.pos<Vr;){var qr=Lr.uint32();switch(qr>>>3){case 1:Wr.name=Lr.string();break;case 2:Wr.type=Gr.onnx.TypeProto.decode(Lr,Lr.uint32());break;case 3:Wr.docString=Lr.string();break;default:Lr.skipType(7&qr)}}return Wr},Nr.decodeDelimited=function(Lr){return Lr instanceof Fr||(Lr=new Fr(Lr)),this.decode(Lr,Lr.uint32())},Nr.verify=function(Lr){if(typeof Lr!="object"||Lr===null)return"object expected";if(Lr.name!=null&&Lr.hasOwnProperty("name")&&!jr.isString(Lr.name))return"name: string expected";if(Lr.type!=null&&Lr.hasOwnProperty("type")){var Ur=Gr.onnx.TypeProto.verify(Lr.type);if(Ur)return"type."+Ur}return Lr.docString!=null&&Lr.hasOwnProperty("docString")&&!jr.isString(Lr.docString)?"docString: string expected":null},Nr.fromObject=function(Lr){if(Lr instanceof Gr.onnx.ValueInfoProto)return Lr;var Ur=new Gr.onnx.ValueInfoProto;if(Lr.name!=null&&(Ur.name=String(Lr.name)),Lr.type!=null){if(typeof Lr.type!="object")throw TypeError(".onnx.ValueInfoProto.type: object expected");Ur.type=Gr.onnx.TypeProto.fromObject(Lr.type)}return Lr.docString!=null&&(Ur.docString=String(Lr.docString)),Ur},Nr.toObject=function(Lr,Ur){Ur||(Ur={});var Vr={};return Ur.defaults&&(Vr.name="",Vr.type=null,Vr.docString=""),Lr.name!=null&&Lr.hasOwnProperty("name")&&(Vr.name=Lr.name),Lr.type!=null&&Lr.hasOwnProperty("type")&&(Vr.type=Gr.onnx.TypeProto.toObject(Lr.type,Ur)),Lr.docString!=null&&Lr.hasOwnProperty("docString")&&(Vr.docString=Lr.docString),Vr},Nr.prototype.toJSON=function(){return this.constructor.toObject(this,Mr.util.toJSONOptions)},Nr}(),Dr.NodeProto=function(){function Nr(Lr){if(this.input=[],this.output=[],this.attribute=[],Lr)for(var Ur=Object.keys(Lr),Vr=0;Vr<Ur.length;++Vr)Lr[Ur[Vr]]!=null&&(this[Ur[Vr]]=Lr[Ur[Vr]])}return Nr.prototype.input=jr.emptyArray,Nr.prototype.output=jr.emptyArray,Nr.prototype.name="",Nr.prototype.opType="",Nr.prototype.domain="",Nr.prototype.attribute=jr.emptyArray,Nr.prototype.docString="",Nr.create=function(Lr){return new Nr(Lr)},Nr.encode=function(Lr,Ur){if(Ur||(Ur=zr.create()),Lr.input!=null&&Lr.input.length)for(var Vr=0;Vr<Lr.input.length;++Vr)Ur.uint32(10).string(Lr.input[Vr]);if(Lr.output!=null&&Lr.output.length)for(Vr=0;Vr<Lr.output.length;++Vr)Ur.uint32(18).string(Lr.output[Vr]);if(Lr.name!=null&&Lr.hasOwnProperty("name")&&Ur.uint32(26).string(Lr.name),Lr.opType!=null&&Lr.hasOwnProperty("opType")&&Ur.uint32(34).string(Lr.opType),Lr.attribute!=null&&Lr.attribute.length)for(Vr=0;Vr<Lr.attribute.length;++Vr)Gr.onnx.AttributeProto.encode(Lr.attribute[Vr],Ur.uint32(42).fork()).ldelim();return Lr.docString!=null&&Lr.hasOwnProperty("docString")&&Ur.uint32(50).string(Lr.docString),Lr.domain!=null&&Lr.hasOwnProperty("domain")&&Ur.uint32(58).string(Lr.domain),Ur},Nr.encodeDelimited=function(Lr,Ur){return this.encode(Lr,Ur).ldelim()},Nr.decode=function(Lr,Ur){Lr instanceof Fr||(Lr=Fr.create(Lr));for(var Vr=Ur===void 0?Lr.len:Lr.pos+Ur,Wr=new Gr.onnx.NodeProto;Lr.pos<Vr;){var qr=Lr.uint32();switch(qr>>>3){case 1:Wr.input&&Wr.input.length||(Wr.input=[]),Wr.input.push(Lr.string());break;case 2:Wr.output&&Wr.output.length||(Wr.output=[]),Wr.output.push(Lr.string());break;case 3:Wr.name=Lr.string();break;case 4:Wr.opType=Lr.string();break;case 7:Wr.domain=Lr.string();break;case 5:Wr.attribute&&Wr.attribute.length||(Wr.attribute=[]),Wr.attribute.push(Gr.onnx.AttributeProto.decode(Lr,Lr.uint32()));break;case 6:Wr.docString=Lr.string();break;default:Lr.skipType(7&qr)}}return Wr},Nr.decodeDelimited=function(Lr){return Lr instanceof Fr||(Lr=new Fr(Lr)),this.decode(Lr,Lr.uint32())},Nr.verify=function(Lr){if(typeof Lr!="object"||Lr===null)return"object expected";if(Lr.input!=null&&Lr.hasOwnProperty("input")){if(!Array.isArray(Lr.input))return"input: array expected";for(var Ur=0;Ur<Lr.input.length;++Ur)if(!jr.isString(Lr.input[Ur]))return"input: string[] expected"}if(Lr.output!=null&&Lr.hasOwnProperty("output")){if(!Array.isArray(Lr.output))return"output: array expected";for(Ur=0;Ur<Lr.output.length;++Ur)if(!jr.isString(Lr.output[Ur]))return"output: string[] expected"}if(Lr.name!=null&&Lr.hasOwnProperty("name")&&!jr.isString(Lr.name))return"name: string expected";if(Lr.opType!=null&&Lr.hasOwnProperty("opType")&&!jr.isString(Lr.opType))return"opType: string expected";if(Lr.domain!=null&&Lr.hasOwnProperty("domain")&&!jr.isString(Lr.domain))return"domain: string expected";if(Lr.attribute!=null&&Lr.hasOwnProperty("attribute")){if(!Array.isArray(Lr.attribute))return"attribute: array expected";for(Ur=0;Ur<Lr.attribute.length;++Ur){var Vr=Gr.onnx.AttributeProto.verify(Lr.attribute[Ur]);if(Vr)return"attribute."+Vr}}return Lr.docString!=null&&Lr.hasOwnProperty("docString")&&!jr.isString(Lr.docString)?"docString: string expected":null},Nr.fromObject=function(Lr){if(Lr instanceof Gr.onnx.NodeProto)return Lr;var Ur=new Gr.onnx.NodeProto;if(Lr.input){if(!Array.isArray(Lr.input))throw TypeError(".onnx.NodeProto.input: array expected");Ur.input=[];for(var Vr=0;Vr<Lr.input.length;++Vr)Ur.input[Vr]=String(Lr.input[Vr])}if(Lr.output){if(!Array.isArray(Lr.output))throw TypeError(".onnx.NodeProto.output: array expected");for(Ur.output=[],Vr=0;Vr<Lr.output.length;++Vr)Ur.output[Vr]=String(Lr.output[Vr])}if(Lr.name!=null&&(Ur.name=String(Lr.name)),Lr.opType!=null&&(Ur.opType=String(Lr.opType)),Lr.domain!=null&&(Ur.domain=String(Lr.domain)),Lr.attribute){if(!Array.isArray(Lr.attribute))throw TypeError(".onnx.NodeProto.attribute: array expected");for(Ur.attribute=[],Vr=0;Vr<Lr.attribute.length;++Vr){if(typeof Lr.attribute[Vr]!="object")throw TypeError(".onnx.NodeProto.attribute: object expected");Ur.attribute[Vr]=Gr.onnx.AttributeProto.fromObject(Lr.attribute[Vr])}}return Lr.docString!=null&&(Ur.docString=String(Lr.docString)),Ur},Nr.toObject=function(Lr,Ur){Ur||(Ur={});var Vr={};if((Ur.arrays||Ur.defaults)&&(Vr.input=[],Vr.output=[],Vr.attribute=[]),Ur.defaults&&(Vr.name="",Vr.opType="",Vr.docString="",Vr.domain=""),Lr.input&&Lr.input.length){Vr.input=[];for(var Wr=0;Wr<Lr.input.length;++Wr)Vr.input[Wr]=Lr.input[Wr]}if(Lr.output&&Lr.output.length)for(Vr.output=[],Wr=0;Wr<Lr.output.length;++Wr)Vr.output[Wr]=Lr.output[Wr];if(Lr.name!=null&&Lr.hasOwnProperty("name")&&(Vr.name=Lr.name),Lr.opType!=null&&Lr.hasOwnProperty("opType")&&(Vr.opType=Lr.opType),Lr.attribute&&Lr.attribute.length)for(Vr.attribute=[],Wr=0;Wr<Lr.attribute.length;++Wr)Vr.attribute[Wr]=Gr.onnx.AttributeProto.toObject(Lr.attribute[Wr],Ur);return Lr.docString!=null&&Lr.hasOwnProperty("docString")&&(Vr.docString=Lr.docString),Lr.domain!=null&&Lr.hasOwnProperty("domain")&&(Vr.domain=Lr.domain),Vr},Nr.prototype.toJSON=function(){return this.constructor.toObject(this,Mr.util.toJSONOptions)},Nr}(),Dr.ModelProto=function(){function Nr(Lr){if(this.opsetImport=[],this.metadataProps=[],Lr)for(var Ur=Object.keys(Lr),Vr=0;Vr<Ur.length;++Vr)Lr[Ur[Vr]]!=null&&(this[Ur[Vr]]=Lr[Ur[Vr]])}return Nr.prototype.irVersion=jr.Long?jr.Long.fromBits(0,0,!1):0,Nr.prototype.opsetImport=jr.emptyArray,Nr.prototype.producerName="",Nr.prototype.producerVersion="",Nr.prototype.domain="",Nr.prototype.modelVersion=jr.Long?jr.Long.fromBits(0,0,!1):0,Nr.prototype.docString="",Nr.prototype.graph=null,Nr.prototype.metadataProps=jr.emptyArray,Nr.create=function(Lr){return new Nr(Lr)},Nr.encode=function(Lr,Ur){if(Ur||(Ur=zr.create()),Lr.irVersion!=null&&Lr.hasOwnProperty("irVersion")&&Ur.uint32(8).int64(Lr.irVersion),Lr.producerName!=null&&Lr.hasOwnProperty("producerName")&&Ur.uint32(18).string(Lr.producerName),Lr.producerVersion!=null&&Lr.hasOwnProperty("producerVersion")&&Ur.uint32(26).string(Lr.producerVersion),Lr.domain!=null&&Lr.hasOwnProperty("domain")&&Ur.uint32(34).string(Lr.domain),Lr.modelVersion!=null&&Lr.hasOwnProperty("modelVersion")&&Ur.uint32(40).int64(Lr.modelVersion),Lr.docString!=null&&Lr.hasOwnProperty("docString")&&Ur.uint32(50).string(Lr.docString),Lr.graph!=null&&Lr.hasOwnProperty("graph")&&Gr.onnx.GraphProto.encode(Lr.graph,Ur.uint32(58).fork()).ldelim(),Lr.opsetImport!=null&&Lr.opsetImport.length)for(var Vr=0;Vr<Lr.opsetImport.length;++Vr)Gr.onnx.OperatorSetIdProto.encode(Lr.opsetImport[Vr],Ur.uint32(66).fork()).ldelim();if(Lr.metadataProps!=null&&Lr.metadataProps.length)for(Vr=0;Vr<Lr.metadataProps.length;++Vr)Gr.onnx.StringStringEntryProto.encode(Lr.metadataProps[Vr],Ur.uint32(114).fork()).ldelim();return Ur},Nr.encodeDelimited=function(Lr,Ur){return this.encode(Lr,Ur).ldelim()},Nr.decode=function(Lr,Ur){Lr instanceof Fr||(Lr=Fr.create(Lr));for(var Vr=Ur===void 0?Lr.len:Lr.pos+Ur,Wr=new Gr.onnx.ModelProto;Lr.pos<Vr;){var qr=Lr.uint32();switch(qr>>>3){case 1:Wr.irVersion=Lr.int64();break;case 8:Wr.opsetImport&&Wr.opsetImport.length||(Wr.opsetImport=[]),Wr.opsetImport.push(Gr.onnx.OperatorSetIdProto.decode(Lr,Lr.uint32()));break;case 2:Wr.producerName=Lr.string();break;case 3:Wr.producerVersion=Lr.string();break;case 4:Wr.domain=Lr.string();break;case 5:Wr.modelVersion=Lr.int64();break;case 6:Wr.docString=Lr.string();break;case 7:Wr.graph=Gr.onnx.GraphProto.decode(Lr,Lr.uint32());break;case 14:Wr.metadataProps&&Wr.metadataProps.length||(Wr.metadataProps=[]),Wr.metadataProps.push(Gr.onnx.StringStringEntryProto.decode(Lr,Lr.uint32()));break;default:Lr.skipType(7&qr)}}return Wr},Nr.decodeDelimited=function(Lr){return Lr instanceof Fr||(Lr=new Fr(Lr)),this.decode(Lr,Lr.uint32())},Nr.verify=function(Lr){if(typeof Lr!="object"||Lr===null)return"object expected";if(Lr.irVersion!=null&&Lr.hasOwnProperty("irVersion")&&!(jr.isInteger(Lr.irVersion)||Lr.irVersion&&jr.isInteger(Lr.irVersion.low)&&jr.isInteger(Lr.irVersion.high)))return"irVersion: integer|Long expected";if(Lr.opsetImport!=null&&Lr.hasOwnProperty("opsetImport")){if(!Array.isArray(Lr.opsetImport))return"opsetImport: array expected";for(var Ur=0;Ur<Lr.opsetImport.length;++Ur)if(Vr=Gr.onnx.OperatorSetIdProto.verify(Lr.opsetImport[Ur]))return"opsetImport."+Vr}if(Lr.producerName!=null&&Lr.hasOwnProperty("producerName")&&!jr.isString(Lr.producerName))return"producerName: string expected";if(Lr.producerVersion!=null&&Lr.hasOwnProperty("producerVersion")&&!jr.isString(Lr.producerVersion))return"producerVersion: string expected";if(Lr.domain!=null&&Lr.hasOwnProperty("domain")&&!jr.isString(Lr.domain))return"domain: string expected";if(Lr.modelVersion!=null&&Lr.hasOwnProperty("modelVersion")&&!(jr.isInteger(Lr.modelVersion)||Lr.modelVersion&&jr.isInteger(Lr.modelVersion.low)&&jr.isInteger(Lr.modelVersion.high)))return"modelVersion: integer|Long expected";if(Lr.docString!=null&&Lr.hasOwnProperty("docString")&&!jr.isString(Lr.docString))return"docString: string expected";if(Lr.graph!=null&&Lr.hasOwnProperty("graph")&&(Vr=Gr.onnx.GraphProto.verify(Lr.graph)))return"graph."+Vr;if(Lr.metadataProps!=null&&Lr.hasOwnProperty("metadataProps")){if(!Array.isArray(Lr.metadataProps))return"metadataProps: array expected";for(Ur=0;Ur<Lr.metadataProps.length;++Ur){var Vr;if(Vr=Gr.onnx.StringStringEntryProto.verify(Lr.metadataProps[Ur]))return"metadataProps."+Vr}}return null},Nr.fromObject=function(Lr){if(Lr instanceof Gr.onnx.ModelProto)return Lr;var Ur=new Gr.onnx.ModelProto;if(Lr.irVersion!=null&&(jr.Long?(Ur.irVersion=jr.Long.fromValue(Lr.irVersion)).unsigned=!1:typeof Lr.irVersion=="string"?Ur.irVersion=parseInt(Lr.irVersion,10):typeof Lr.irVersion=="number"?Ur.irVersion=Lr.irVersion:typeof Lr.irVersion=="object"&&(Ur.irVersion=new jr.LongBits(Lr.irVersion.low>>>0,Lr.irVersion.high>>>0).toNumber())),Lr.opsetImport){if(!Array.isArray(Lr.opsetImport))throw TypeError(".onnx.ModelProto.opsetImport: array expected");Ur.opsetImport=[];for(var Vr=0;Vr<Lr.opsetImport.length;++Vr){if(typeof Lr.opsetImport[Vr]!="object")throw TypeError(".onnx.ModelProto.opsetImport: object expected");Ur.opsetImport[Vr]=Gr.onnx.OperatorSetIdProto.fromObject(Lr.opsetImport[Vr])}}if(Lr.producerName!=null&&(Ur.producerName=String(Lr.producerName)),Lr.producerVersion!=null&&(Ur.producerVersion=String(Lr.producerVersion)),Lr.domain!=null&&(Ur.domain=String(Lr.domain)),Lr.modelVersion!=null&&(jr.Long?(Ur.modelVersion=jr.Long.fromValue(Lr.modelVersion)).unsigned=!1:typeof Lr.modelVersion=="string"?Ur.modelVersion=parseInt(Lr.modelVersion,10):typeof Lr.modelVersion=="number"?Ur.modelVersion=Lr.modelVersion:typeof Lr.modelVersion=="object"&&(Ur.modelVersion=new jr.LongBits(Lr.modelVersion.low>>>0,Lr.modelVersion.high>>>0).toNumber())),Lr.docString!=null&&(Ur.docString=String(Lr.docString)),Lr.graph!=null){if(typeof Lr.graph!="object")throw TypeError(".onnx.ModelProto.graph: object expected");Ur.graph=Gr.onnx.GraphProto.fromObject(Lr.graph)}if(Lr.metadataProps){if(!Array.isArray(Lr.metadataProps))throw TypeError(".onnx.ModelProto.metadataProps: array expected");for(Ur.metadataProps=[],Vr=0;Vr<Lr.metadataProps.length;++Vr){if(typeof Lr.metadataProps[Vr]!="object")throw TypeError(".onnx.ModelProto.metadataProps: object expected");Ur.metadataProps[Vr]=Gr.onnx.StringStringEntryProto.fromObject(Lr.metadataProps[Vr])}}return Ur},Nr.toObject=function(Lr,Ur){Ur||(Ur={});var Vr={};if((Ur.arrays||Ur.defaults)&&(Vr.opsetImport=[],Vr.metadataProps=[]),Ur.defaults){if(jr.Long){var Wr=new jr.Long(0,0,!1);Vr.irVersion=Ur.longs===String?Wr.toString():Ur.longs===Number?Wr.toNumber():Wr}else Vr.irVersion=Ur.longs===String?"0":0;Vr.producerName="",Vr.producerVersion="",Vr.domain="",jr.Long?(Wr=new jr.Long(0,0,!1),Vr.modelVersion=Ur.longs===String?Wr.toString():Ur.longs===Number?Wr.toNumber():Wr):Vr.modelVersion=Ur.longs===String?"0":0,Vr.docString="",Vr.graph=null}if(Lr.irVersion!=null&&Lr.hasOwnProperty("irVersion")&&(typeof Lr.irVersion=="number"?Vr.irVersion=Ur.longs===String?String(Lr.irVersion):Lr.irVersion:Vr.irVersion=Ur.longs===String?jr.Long.prototype.toString.call(Lr.irVersion):Ur.longs===Number?new jr.LongBits(Lr.irVersion.low>>>0,Lr.irVersion.high>>>0).toNumber():Lr.irVersion),Lr.producerName!=null&&Lr.hasOwnProperty("producerName")&&(Vr.producerName=Lr.producerName),Lr.producerVersion!=null&&Lr.hasOwnProperty("producerVersion")&&(Vr.producerVersion=Lr.producerVersion),Lr.domain!=null&&Lr.hasOwnProperty("domain")&&(Vr.domain=Lr.domain),Lr.modelVersion!=null&&Lr.hasOwnProperty("modelVersion")&&(typeof Lr.modelVersion=="number"?Vr.modelVersion=Ur.longs===String?String(Lr.modelVersion):Lr.modelVersion:Vr.modelVersion=Ur.longs===String?jr.Long.prototype.toString.call(Lr.modelVersion):Ur.longs===Number?new jr.LongBits(Lr.modelVersion.low>>>0,Lr.modelVersion.high>>>0).toNumber():Lr.modelVersion),Lr.docString!=null&&Lr.hasOwnProperty("docString")&&(Vr.docString=Lr.docString),Lr.graph!=null&&Lr.hasOwnProperty("graph")&&(Vr.graph=Gr.onnx.GraphProto.toObject(Lr.graph,Ur)),Lr.opsetImport&&Lr.opsetImport.length){Vr.opsetImport=[];for(var qr=0;qr<Lr.opsetImport.length;++qr)Vr.opsetImport[qr]=Gr.onnx.OperatorSetIdProto.toObject(Lr.opsetImport[qr],Ur)}if(Lr.metadataProps&&Lr.metadataProps.length)for(Vr.metadataProps=[],qr=0;qr<Lr.metadataProps.length;++qr)Vr.metadataProps[qr]=Gr.onnx.StringStringEntryProto.toObject(Lr.metadataProps[qr],Ur);return Vr},Nr.prototype.toJSON=function(){return this.constructor.toObject(this,Mr.util.toJSONOptions)},Nr}(),Dr.StringStringEntryProto=function(){function Nr(Lr){if(Lr)for(var Ur=Object.keys(Lr),Vr=0;Vr<Ur.length;++Vr)Lr[Ur[Vr]]!=null&&(this[Ur[Vr]]=Lr[Ur[Vr]])}return Nr.prototype.key="",Nr.prototype.value="",Nr.create=function(Lr){return new Nr(Lr)},Nr.encode=function(Lr,Ur){return Ur||(Ur=zr.create()),Lr.key!=null&&Lr.hasOwnProperty("key")&&Ur.uint32(10).string(Lr.key),Lr.value!=null&&Lr.hasOwnProperty("value")&&Ur.uint32(18).string(Lr.value),Ur},Nr.encodeDelimited=function(Lr,Ur){return this.encode(Lr,Ur).ldelim()},Nr.decode=function(Lr,Ur){Lr instanceof Fr||(Lr=Fr.create(Lr));for(var Vr=Ur===void 0?Lr.len:Lr.pos+Ur,Wr=new Gr.onnx.StringStringEntryProto;Lr.pos<Vr;){var qr=Lr.uint32();switch(qr>>>3){case 1:Wr.key=Lr.string();break;case 2:Wr.value=Lr.string();break;default:Lr.skipType(7&qr)}}return Wr},Nr.decodeDelimited=function(Lr){return Lr instanceof Fr||(Lr=new Fr(Lr)),this.decode(Lr,Lr.uint32())},Nr.verify=function(Lr){return typeof Lr!="object"||Lr===null?"object expected":Lr.key!=null&&Lr.hasOwnProperty("key")&&!jr.isString(Lr.key)?"key: string expected":Lr.value!=null&&Lr.hasOwnProperty("value")&&!jr.isString(Lr.value)?"value: string expected":null},Nr.fromObject=function(Lr){if(Lr instanceof Gr.onnx.StringStringEntryProto)return Lr;var Ur=new Gr.onnx.StringStringEntryProto;return Lr.key!=null&&(Ur.key=String(Lr.key)),Lr.value!=null&&(Ur.value=String(Lr.value)),Ur},Nr.toObject=function(Lr,Ur){Ur||(Ur={});var Vr={};return Ur.defaults&&(Vr.key="",Vr.value=""),Lr.key!=null&&Lr.hasOwnProperty("key")&&(Vr.key=Lr.key),Lr.value!=null&&Lr.hasOwnProperty("value")&&(Vr.value=Lr.value),Vr},Nr.prototype.toJSON=function(){return this.constructor.toObject(this,Mr.util.toJSONOptions)},Nr}(),Dr.TensorAnnotation=function(){function Nr(Lr){if(this.quantParameterTensorNames=[],Lr)for(var Ur=Object.keys(Lr),Vr=0;Vr<Ur.length;++Vr)Lr[Ur[Vr]]!=null&&(this[Ur[Vr]]=Lr[Ur[Vr]])}return Nr.prototype.tensorName="",Nr.prototype.quantParameterTensorNames=jr.emptyArray,Nr.create=function(Lr){return new Nr(Lr)},Nr.encode=function(Lr,Ur){if(Ur||(Ur=zr.create()),Lr.tensorName!=null&&Lr.hasOwnProperty("tensorName")&&Ur.uint32(10).string(Lr.tensorName),Lr.quantParameterTensorNames!=null&&Lr.quantParameterTensorNames.length)for(var Vr=0;Vr<Lr.quantParameterTensorNames.length;++Vr)Gr.onnx.StringStringEntryProto.encode(Lr.quantParameterTensorNames[Vr],Ur.uint32(18).fork()).ldelim();return Ur},Nr.encodeDelimited=function(Lr,Ur){return this.encode(Lr,Ur).ldelim()},Nr.decode=function(Lr,Ur){Lr instanceof Fr||(Lr=Fr.create(Lr));for(var Vr=Ur===void 0?Lr.len:Lr.pos+Ur,Wr=new Gr.onnx.TensorAnnotation;Lr.pos<Vr;){var qr=Lr.uint32();switch(qr>>>3){case 1:Wr.tensorName=Lr.string();break;case 2:Wr.quantParameterTensorNames&&Wr.quantParameterTensorNames.length||(Wr.quantParameterTensorNames=[]),Wr.quantParameterTensorNames.push(Gr.onnx.StringStringEntryProto.decode(Lr,Lr.uint32()));break;default:Lr.skipType(7&qr)}}return Wr},Nr.decodeDelimited=function(Lr){return Lr instanceof Fr||(Lr=new Fr(Lr)),this.decode(Lr,Lr.uint32())},Nr.verify=function(Lr){if(typeof Lr!="object"||Lr===null)return"object expected";if(Lr.tensorName!=null&&Lr.hasOwnProperty("tensorName")&&!jr.isString(Lr.tensorName))return"tensorName: string expected";if(Lr.quantParameterTensorNames!=null&&Lr.hasOwnProperty("quantParameterTensorNames")){if(!Array.isArray(Lr.quantParameterTensorNames))return"quantParameterTensorNames: array expected";for(var Ur=0;Ur<Lr.quantParameterTensorNames.length;++Ur){var Vr=Gr.onnx.StringStringEntryProto.verify(Lr.quantParameterTensorNames[Ur]);if(Vr)return"quantParameterTensorNames."+Vr}}return null},Nr.fromObject=function(Lr){if(Lr instanceof Gr.onnx.TensorAnnotation)return Lr;var Ur=new Gr.onnx.TensorAnnotation;if(Lr.tensorName!=null&&(Ur.tensorName=String(Lr.tensorName)),Lr.quantParameterTensorNames){if(!Array.isArray(Lr.quantParameterTensorNames))throw TypeError(".onnx.TensorAnnotation.quantParameterTensorNames: array expected");Ur.quantParameterTensorNames=[];for(var Vr=0;Vr<Lr.quantParameterTensorNames.length;++Vr){if(typeof Lr.quantParameterTensorNames[Vr]!="object")throw TypeError(".onnx.TensorAnnotation.quantParameterTensorNames: object expected");Ur.quantParameterTensorNames[Vr]=Gr.onnx.StringStringEntryProto.fromObject(Lr.quantParameterTensorNames[Vr])}}return Ur},Nr.toObject=function(Lr,Ur){Ur||(Ur={});var Vr={};if((Ur.arrays||Ur.defaults)&&(Vr.quantParameterTensorNames=[]),Ur.defaults&&(Vr.tensorName=""),Lr.tensorName!=null&&Lr.hasOwnProperty("tensorName")&&(Vr.tensorName=Lr.tensorName),Lr.quantParameterTensorNames&&Lr.quantParameterTensorNames.length){Vr.quantParameterTensorNames=[];for(var Wr=0;Wr<Lr.quantParameterTensorNames.length;++Wr)Vr.quantParameterTensorNames[Wr]=Gr.onnx.StringStringEntryProto.toObject(Lr.quantParameterTensorNames[Wr],Ur)}return Vr},Nr.prototype.toJSON=function(){return this.constructor.toObject(this,Mr.util.toJSONOptions)},Nr}(),Dr.GraphProto=function(){function Nr(Lr){if(this.node=[],this.initializer=[],this.input=[],this.output=[],this.valueInfo=[],this.quantizationAnnotation=[],Lr)for(var Ur=Object.keys(Lr),Vr=0;Vr<Ur.length;++Vr)Lr[Ur[Vr]]!=null&&(this[Ur[Vr]]=Lr[Ur[Vr]])}return Nr.prototype.node=jr.emptyArray,Nr.prototype.name="",Nr.prototype.initializer=jr.emptyArray,Nr.prototype.docString="",Nr.prototype.input=jr.emptyArray,Nr.prototype.output=jr.emptyArray,Nr.prototype.valueInfo=jr.emptyArray,Nr.prototype.quantizationAnnotation=jr.emptyArray,Nr.create=function(Lr){return new Nr(Lr)},Nr.encode=function(Lr,Ur){if(Ur||(Ur=zr.create()),Lr.node!=null&&Lr.node.length)for(var Vr=0;Vr<Lr.node.length;++Vr)Gr.onnx.NodeProto.encode(Lr.node[Vr],Ur.uint32(10).fork()).ldelim();if(Lr.name!=null&&Lr.hasOwnProperty("name")&&Ur.uint32(18).string(Lr.name),Lr.initializer!=null&&Lr.initializer.length)for(Vr=0;Vr<Lr.initializer.length;++Vr)Gr.onnx.TensorProto.encode(Lr.initializer[Vr],Ur.uint32(42).fork()).ldelim();if(Lr.docString!=null&&Lr.hasOwnProperty("docString")&&Ur.uint32(82).string(Lr.docString),Lr.input!=null&&Lr.input.length)for(Vr=0;Vr<Lr.input.length;++Vr)Gr.onnx.ValueInfoProto.encode(Lr.input[Vr],Ur.uint32(90).fork()).ldelim();if(Lr.output!=null&&Lr.output.length)for(Vr=0;Vr<Lr.output.length;++Vr)Gr.onnx.ValueInfoProto.encode(Lr.output[Vr],Ur.uint32(98).fork()).ldelim();if(Lr.valueInfo!=null&&Lr.valueInfo.length)for(Vr=0;Vr<Lr.valueInfo.length;++Vr)Gr.onnx.ValueInfoProto.encode(Lr.valueInfo[Vr],Ur.uint32(106).fork()).ldelim();if(Lr.quantizationAnnotation!=null&&Lr.quantizationAnnotation.length)for(Vr=0;Vr<Lr.quantizationAnnotation.length;++Vr)Gr.onnx.TensorAnnotation.encode(Lr.quantizationAnnotation[Vr],Ur.uint32(114).fork()).ldelim();return Ur},Nr.encodeDelimited=function(Lr,Ur){return this.encode(Lr,Ur).ldelim()},Nr.decode=function(Lr,Ur){Lr instanceof Fr||(Lr=Fr.create(Lr));for(var Vr=Ur===void 0?Lr.len:Lr.pos+Ur,Wr=new Gr.onnx.GraphProto;Lr.pos<Vr;){var qr=Lr.uint32();switch(qr>>>3){case 1:Wr.node&&Wr.node.length||(Wr.node=[]),Wr.node.push(Gr.onnx.NodeProto.decode(Lr,Lr.uint32()));break;case 2:Wr.name=Lr.string();break;case 5:Wr.initializer&&Wr.initializer.length||(Wr.initializer=[]),Wr.initializer.push(Gr.onnx.TensorProto.decode(Lr,Lr.uint32()));break;case 10:Wr.docString=Lr.string();break;case 11:Wr.input&&Wr.input.length||(Wr.input=[]),Wr.input.push(Gr.onnx.ValueInfoProto.decode(Lr,Lr.uint32()));break;case 12:Wr.output&&Wr.output.length||(Wr.output=[]),Wr.output.push(Gr.onnx.ValueInfoProto.decode(Lr,Lr.uint32()));break;case 13:Wr.valueInfo&&Wr.valueInfo.length||(Wr.valueInfo=[]),Wr.valueInfo.push(Gr.onnx.ValueInfoProto.decode(Lr,Lr.uint32()));break;case 14:Wr.quantizationAnnotation&&Wr.quantizationAnnotation.length||(Wr.quantizationAnnotation=[]),Wr.quantizationAnnotation.push(Gr.onnx.TensorAnnotation.decode(Lr,Lr.uint32()));break;default:Lr.skipType(7&qr)}}return Wr},Nr.decodeDelimited=function(Lr){return Lr instanceof Fr||(Lr=new Fr(Lr)),this.decode(Lr,Lr.uint32())},Nr.verify=function(Lr){if(typeof Lr!="object"||Lr===null)return"object expected";if(Lr.node!=null&&Lr.hasOwnProperty("node")){if(!Array.isArray(Lr.node))return"node: array expected";for(var Ur=0;Ur<Lr.node.length;++Ur)if(Vr=Gr.onnx.NodeProto.verify(Lr.node[Ur]))return"node."+Vr}if(Lr.name!=null&&Lr.hasOwnProperty("name")&&!jr.isString(Lr.name))return"name: string expected";if(Lr.initializer!=null&&Lr.hasOwnProperty("initializer")){if(!Array.isArray(Lr.initializer))return"initializer: array expected";for(Ur=0;Ur<Lr.initializer.length;++Ur)if(Vr=Gr.onnx.TensorProto.verify(Lr.initializer[Ur]))return"initializer."+Vr}if(Lr.docString!=null&&Lr.hasOwnProperty("docString")&&!jr.isString(Lr.docString))return"docString: string expected";if(Lr.input!=null&&Lr.hasOwnProperty("input")){if(!Array.isArray(Lr.input))return"input: array expected";for(Ur=0;Ur<Lr.input.length;++Ur)if(Vr=Gr.onnx.ValueInfoProto.verify(Lr.input[Ur]))return"input."+Vr}if(Lr.output!=null&&Lr.hasOwnProperty("output")){if(!Array.isArray(Lr.output))return"output: array expected";for(Ur=0;Ur<Lr.output.length;++Ur)if(Vr=Gr.onnx.ValueInfoProto.verify(Lr.output[Ur]))return"output."+Vr}if(Lr.valueInfo!=null&&Lr.hasOwnProperty("valueInfo")){if(!Array.isArray(Lr.valueInfo))return"valueInfo: array expected";for(Ur=0;Ur<Lr.valueInfo.length;++Ur)if(Vr=Gr.onnx.ValueInfoProto.verify(Lr.valueInfo[Ur]))return"valueInfo."+Vr}if(Lr.quantizationAnnotation!=null&&Lr.hasOwnProperty("quantizationAnnotation")){if(!Array.isArray(Lr.quantizationAnnotation))return"quantizationAnnotation: array expected";for(Ur=0;Ur<Lr.quantizationAnnotation.length;++Ur){var Vr;if(Vr=Gr.onnx.TensorAnnotation.verify(Lr.quantizationAnnotation[Ur]))return"quantizationAnnotation."+Vr}}return null},Nr.fromObject=function(Lr){if(Lr instanceof Gr.onnx.GraphProto)return Lr;var Ur=new Gr.onnx.GraphProto;if(Lr.node){if(!Array.isArray(Lr.node))throw TypeError(".onnx.GraphProto.node: array expected");Ur.node=[];for(var Vr=0;Vr<Lr.node.length;++Vr){if(typeof Lr.node[Vr]!="object")throw TypeError(".onnx.GraphProto.node: object expected");Ur.node[Vr]=Gr.onnx.NodeProto.fromObject(Lr.node[Vr])}}if(Lr.name!=null&&(Ur.name=String(Lr.name)),Lr.initializer){if(!Array.isArray(Lr.initializer))throw TypeError(".onnx.GraphProto.initializer: array expected");for(Ur.initializer=[],Vr=0;Vr<Lr.initializer.length;++Vr){if(typeof Lr.initializer[Vr]!="object")throw TypeError(".onnx.GraphProto.initializer: object expected");Ur.initializer[Vr]=Gr.onnx.TensorProto.fromObject(Lr.initializer[Vr])}}if(Lr.docString!=null&&(Ur.docString=String(Lr.docString)),Lr.input){if(!Array.isArray(Lr.input))throw TypeError(".onnx.GraphProto.input: array expected");for(Ur.input=[],Vr=0;Vr<Lr.input.length;++Vr){if(typeof Lr.input[Vr]!="object")throw TypeError(".onnx.GraphProto.input: object expected");Ur.input[Vr]=Gr.onnx.ValueInfoProto.fromObject(Lr.input[Vr])}}if(Lr.output){if(!Array.isArray(Lr.output))throw TypeError(".onnx.GraphProto.output: array expected");for(Ur.output=[],Vr=0;Vr<Lr.output.length;++Vr){if(typeof Lr.output[Vr]!="object")throw TypeError(".onnx.GraphProto.output: object expected");Ur.output[Vr]=Gr.onnx.ValueInfoProto.fromObject(Lr.output[Vr])}}if(Lr.valueInfo){if(!Array.isArray(Lr.valueInfo))throw TypeError(".onnx.GraphProto.valueInfo: array expected");for(Ur.valueInfo=[],Vr=0;Vr<Lr.valueInfo.length;++Vr){if(typeof Lr.valueInfo[Vr]!="object")throw TypeError(".onnx.GraphProto.valueInfo: object expected");Ur.valueInfo[Vr]=Gr.onnx.ValueInfoProto.fromObject(Lr.valueInfo[Vr])}}if(Lr.quantizationAnnotation){if(!Array.isArray(Lr.quantizationAnnotation))throw TypeError(".onnx.GraphProto.quantizationAnnotation: array expected");for(Ur.quantizationAnnotation=[],Vr=0;Vr<Lr.quantizationAnnotation.length;++Vr){if(typeof Lr.quantizationAnnotation[Vr]!="object")throw TypeError(".onnx.GraphProto.quantizationAnnotation: object expected");Ur.quantizationAnnotation[Vr]=Gr.onnx.TensorAnnotation.fromObject(Lr.quantizationAnnotation[Vr])}}return Ur},Nr.toObject=function(Lr,Ur){Ur||(Ur={});var Vr={};if((Ur.arrays||Ur.defaults)&&(Vr.node=[],Vr.initializer=[],Vr.input=[],Vr.output=[],Vr.valueInfo=[],Vr.quantizationAnnotation=[]),Ur.defaults&&(Vr.name="",Vr.docString=""),Lr.node&&Lr.node.length){Vr.node=[];for(var Wr=0;Wr<Lr.node.length;++Wr)Vr.node[Wr]=Gr.onnx.NodeProto.toObject(Lr.node[Wr],Ur)}if(Lr.name!=null&&Lr.hasOwnProperty("name")&&(Vr.name=Lr.name),Lr.initializer&&Lr.initializer.length)for(Vr.initializer=[],Wr=0;Wr<Lr.initializer.length;++Wr)Vr.initializer[Wr]=Gr.onnx.TensorProto.toObject(Lr.initializer[Wr],Ur);if(Lr.docString!=null&&Lr.hasOwnProperty("docString")&&(Vr.docString=Lr.docString),Lr.input&&Lr.input.length)for(Vr.input=[],Wr=0;Wr<Lr.input.length;++Wr)Vr.input[Wr]=Gr.onnx.ValueInfoProto.toObject(Lr.input[Wr],Ur);if(Lr.output&&Lr.output.length)for(Vr.output=[],Wr=0;Wr<Lr.output.length;++Wr)Vr.output[Wr]=Gr.onnx.ValueInfoProto.toObject(Lr.output[Wr],Ur);if(Lr.valueInfo&&Lr.valueInfo.length)for(Vr.valueInfo=[],Wr=0;Wr<Lr.valueInfo.length;++Wr)Vr.valueInfo[Wr]=Gr.onnx.ValueInfoProto.toObject(Lr.valueInfo[Wr],Ur);if(Lr.quantizationAnnotation&&Lr.quantizationAnnotation.length)for(Vr.quantizationAnnotation=[],Wr=0;Wr<Lr.quantizationAnnotation.length;++Wr)Vr.quantizationAnnotation[Wr]=Gr.onnx.TensorAnnotation.toObject(Lr.quantizationAnnotation[Wr],Ur);return Vr},Nr.prototype.toJSON=function(){return this.constructor.toObject(this,Mr.util.toJSONOptions)},Nr}(),Dr.TensorProto=function(){function Nr(Lr){if(this.dims=[],this.floatData=[],this.int32Data=[],this.stringData=[],this.int64Data=[],this.externalData=[],this.doubleData=[],this.uint64Data=[],Lr)for(var Ur=Object.keys(Lr),Vr=0;Vr<Ur.length;++Vr)Lr[Ur[Vr]]!=null&&(this[Ur[Vr]]=Lr[Ur[Vr]])}return Nr.prototype.dims=jr.emptyArray,Nr.prototype.dataType=0,Nr.prototype.segment=null,Nr.prototype.floatData=jr.emptyArray,Nr.prototype.int32Data=jr.emptyArray,Nr.prototype.stringData=jr.emptyArray,Nr.prototype.int64Data=jr.emptyArray,Nr.prototype.name="",Nr.prototype.docString="",Nr.prototype.rawData=jr.newBuffer([]),Nr.prototype.externalData=jr.emptyArray,Nr.prototype.dataLocation=0,Nr.prototype.doubleData=jr.emptyArray,Nr.prototype.uint64Data=jr.emptyArray,Nr.create=function(Lr){return new Nr(Lr)},Nr.encode=function(Lr,Ur){if(Ur||(Ur=zr.create()),Lr.dims!=null&&Lr.dims.length){Ur.uint32(10).fork();for(var Vr=0;Vr<Lr.dims.length;++Vr)Ur.int64(Lr.dims[Vr]);Ur.ldelim()}if(Lr.dataType!=null&&Lr.hasOwnProperty("dataType")&&Ur.uint32(16).int32(Lr.dataType),Lr.segment!=null&&Lr.hasOwnProperty("segment")&&Gr.onnx.TensorProto.Segment.encode(Lr.segment,Ur.uint32(26).fork()).ldelim(),Lr.floatData!=null&&Lr.floatData.length){for(Ur.uint32(34).fork(),Vr=0;Vr<Lr.floatData.length;++Vr)Ur.float(Lr.floatData[Vr]);Ur.ldelim()}if(Lr.int32Data!=null&&Lr.int32Data.length){for(Ur.uint32(42).fork(),Vr=0;Vr<Lr.int32Data.length;++Vr)Ur.int32(Lr.int32Data[Vr]);Ur.ldelim()}if(Lr.stringData!=null&&Lr.stringData.length)for(Vr=0;Vr<Lr.stringData.length;++Vr)Ur.uint32(50).bytes(Lr.stringData[Vr]);if(Lr.int64Data!=null&&Lr.int64Data.length){for(Ur.uint32(58).fork(),Vr=0;Vr<Lr.int64Data.length;++Vr)Ur.int64(Lr.int64Data[Vr]);Ur.ldelim()}if(Lr.name!=null&&Lr.hasOwnProperty("name")&&Ur.uint32(66).string(Lr.name),Lr.rawData!=null&&Lr.hasOwnProperty("rawData")&&Ur.uint32(74).bytes(Lr.rawData),Lr.doubleData!=null&&Lr.doubleData.length){for(Ur.uint32(82).fork(),Vr=0;Vr<Lr.doubleData.length;++Vr)Ur.double(Lr.doubleData[Vr]);Ur.ldelim()}if(Lr.uint64Data!=null&&Lr.uint64Data.length){for(Ur.uint32(90).fork(),Vr=0;Vr<Lr.uint64Data.length;++Vr)Ur.uint64(Lr.uint64Data[Vr]);Ur.ldelim()}if(Lr.docString!=null&&Lr.hasOwnProperty("docString")&&Ur.uint32(98).string(Lr.docString),Lr.externalData!=null&&Lr.externalData.length)for(Vr=0;Vr<Lr.externalData.length;++Vr)Gr.onnx.StringStringEntryProto.encode(Lr.externalData[Vr],Ur.uint32(106).fork()).ldelim();return Lr.dataLocation!=null&&Lr.hasOwnProperty("dataLocation")&&Ur.uint32(112).int32(Lr.dataLocation),Ur},Nr.encodeDelimited=function(Lr,Ur){return this.encode(Lr,Ur).ldelim()},Nr.decode=function(Lr,Ur){Lr instanceof Fr||(Lr=Fr.create(Lr));for(var Vr=Ur===void 0?Lr.len:Lr.pos+Ur,Wr=new Gr.onnx.TensorProto;Lr.pos<Vr;){var qr=Lr.uint32();switch(qr>>>3){case 1:if(Wr.dims&&Wr.dims.length||(Wr.dims=[]),(7&qr)==2)for(var Kr=Lr.uint32()+Lr.pos;Lr.pos<Kr;)Wr.dims.push(Lr.int64());else Wr.dims.push(Lr.int64());break;case 2:Wr.dataType=Lr.int32();break;case 3:Wr.segment=Gr.onnx.TensorProto.Segment.decode(Lr,Lr.uint32());break;case 4:if(Wr.floatData&&Wr.floatData.length||(Wr.floatData=[]),(7&qr)==2)for(Kr=Lr.uint32()+Lr.pos;Lr.pos<Kr;)Wr.floatData.push(Lr.float());else Wr.floatData.push(Lr.float());break;case 5:if(Wr.int32Data&&Wr.int32Data.length||(Wr.int32Data=[]),(7&qr)==2)for(Kr=Lr.uint32()+Lr.pos;Lr.pos<Kr;)Wr.int32Data.push(Lr.int32());else Wr.int32Data.push(Lr.int32());break;case 6:Wr.stringData&&Wr.stringData.length||(Wr.stringData=[]),Wr.stringData.push(Lr.bytes());break;case 7:if(Wr.int64Data&&Wr.int64Data.length||(Wr.int64Data=[]),(7&qr)==2)for(Kr=Lr.uint32()+Lr.pos;Lr.pos<Kr;)Wr.int64Data.push(Lr.int64());else Wr.int64Data.push(Lr.int64());break;case 8:Wr.name=Lr.string();break;case 12:Wr.docString=Lr.string();break;case 9:Wr.rawData=Lr.bytes();break;case 13:Wr.externalData&&Wr.externalData.length||(Wr.externalData=[]),Wr.externalData.push(Gr.onnx.StringStringEntryProto.decode(Lr,Lr.uint32()));break;case 14:Wr.dataLocation=Lr.int32();break;case 10:if(Wr.doubleData&&Wr.doubleData.length||(Wr.doubleData=[]),(7&qr)==2)for(Kr=Lr.uint32()+Lr.pos;Lr.pos<Kr;)Wr.doubleData.push(Lr.double());else Wr.doubleData.push(Lr.double());break;case 11:if(Wr.uint64Data&&Wr.uint64Data.length||(Wr.uint64Data=[]),(7&qr)==2)for(Kr=Lr.uint32()+Lr.pos;Lr.pos<Kr;)Wr.uint64Data.push(Lr.uint64());else Wr.uint64Data.push(Lr.uint64());break;default:Lr.skipType(7&qr)}}return Wr},Nr.decodeDelimited=function(Lr){return Lr instanceof Fr||(Lr=new Fr(Lr)),this.decode(Lr,Lr.uint32())},Nr.verify=function(Lr){if(typeof Lr!="object"||Lr===null)return"object expected";if(Lr.dims!=null&&Lr.hasOwnProperty("dims")){if(!Array.isArray(Lr.dims))return"dims: array expected";for(var Ur=0;Ur<Lr.dims.length;++Ur)if(!(jr.isInteger(Lr.dims[Ur])||Lr.dims[Ur]&&jr.isInteger(Lr.dims[Ur].low)&&jr.isInteger(Lr.dims[Ur].high)))return"dims: integer|Long[] expected"}if(Lr.dataType!=null&&Lr.hasOwnProperty("dataType")&&!jr.isInteger(Lr.dataType))return"dataType: integer expected";if(Lr.segment!=null&&Lr.hasOwnProperty("segment")&&(Vr=Gr.onnx.TensorProto.Segment.verify(Lr.segment)))return"segment."+Vr;if(Lr.floatData!=null&&Lr.hasOwnProperty("floatData")){if(!Array.isArray(Lr.floatData))return"floatData: array expected";for(Ur=0;Ur<Lr.floatData.length;++Ur)if(typeof Lr.floatData[Ur]!="number")return"floatData: number[] expected"}if(Lr.int32Data!=null&&Lr.hasOwnProperty("int32Data")){if(!Array.isArray(Lr.int32Data))return"int32Data: array expected";for(Ur=0;Ur<Lr.int32Data.length;++Ur)if(!jr.isInteger(Lr.int32Data[Ur]))return"int32Data: integer[] expected"}if(Lr.stringData!=null&&Lr.hasOwnProperty("stringData")){if(!Array.isArray(Lr.stringData))return"stringData: array expected";for(Ur=0;Ur<Lr.stringData.length;++Ur)if(!(Lr.stringData[Ur]&&typeof Lr.stringData[Ur].length=="number"||jr.isString(Lr.stringData[Ur])))return"stringData: buffer[] expected"}if(Lr.int64Data!=null&&Lr.hasOwnProperty("int64Data")){if(!Array.isArray(Lr.int64Data))return"int64Data: array expected";for(Ur=0;Ur<Lr.int64Data.length;++Ur)if(!(jr.isInteger(Lr.int64Data[Ur])||Lr.int64Data[Ur]&&jr.isInteger(Lr.int64Data[Ur].low)&&jr.isInteger(Lr.int64Data[Ur].high)))return"int64Data: integer|Long[] expected"}if(Lr.name!=null&&Lr.hasOwnProperty("name")&&!jr.isString(Lr.name))return"name: string expected";if(Lr.docString!=null&&Lr.hasOwnProperty("docString")&&!jr.isString(Lr.docString))return"docString: string expected";if(Lr.rawData!=null&&Lr.hasOwnProperty("rawData")&&!(Lr.rawData&&typeof Lr.rawData.length=="number"||jr.isString(Lr.rawData)))return"rawData: buffer expected";if(Lr.externalData!=null&&Lr.hasOwnProperty("externalData")){if(!Array.isArray(Lr.externalData))return"externalData: array expected";for(Ur=0;Ur<Lr.externalData.length;++Ur){var Vr;if(Vr=Gr.onnx.StringStringEntryProto.verify(Lr.externalData[Ur]))return"externalData."+Vr}}if(Lr.dataLocation!=null&&Lr.hasOwnProperty("dataLocation"))switch(Lr.dataLocation){default:return"dataLocation: enum value expected";case 0:case 1:}if(Lr.doubleData!=null&&Lr.hasOwnProperty("doubleData")){if(!Array.isArray(Lr.doubleData))return"doubleData: array expected";for(Ur=0;Ur<Lr.doubleData.length;++Ur)if(typeof Lr.doubleData[Ur]!="number")return"doubleData: number[] expected"}if(Lr.uint64Data!=null&&Lr.hasOwnProperty("uint64Data")){if(!Array.isArray(Lr.uint64Data))return"uint64Data: array expected";for(Ur=0;Ur<Lr.uint64Data.length;++Ur)if(!(jr.isInteger(Lr.uint64Data[Ur])||Lr.uint64Data[Ur]&&jr.isInteger(Lr.uint64Data[Ur].low)&&jr.isInteger(Lr.uint64Data[Ur].high)))return"uint64Data: integer|Long[] expected"}return null},Nr.fromObject=function(Lr){if(Lr instanceof Gr.onnx.TensorProto)return Lr;var Ur=new Gr.onnx.TensorProto;if(Lr.dims){if(!Array.isArray(Lr.dims))throw TypeError(".onnx.TensorProto.dims: array expected");Ur.dims=[];for(var Vr=0;Vr<Lr.dims.length;++Vr)jr.Long?(Ur.dims[Vr]=jr.Long.fromValue(Lr.dims[Vr])).unsigned=!1:typeof Lr.dims[Vr]=="string"?Ur.dims[Vr]=parseInt(Lr.dims[Vr],10):typeof Lr.dims[Vr]=="number"?Ur.dims[Vr]=Lr.dims[Vr]:typeof Lr.dims[Vr]=="object"&&(Ur.dims[Vr]=new jr.LongBits(Lr.dims[Vr].low>>>0,Lr.dims[Vr].high>>>0).toNumber())}if(Lr.dataType!=null&&(Ur.dataType=0|Lr.dataType),Lr.segment!=null){if(typeof Lr.segment!="object")throw TypeError(".onnx.TensorProto.segment: object expected");Ur.segment=Gr.onnx.TensorProto.Segment.fromObject(Lr.segment)}if(Lr.floatData){if(!Array.isArray(Lr.floatData))throw TypeError(".onnx.TensorProto.floatData: array expected");for(Ur.floatData=[],Vr=0;Vr<Lr.floatData.length;++Vr)Ur.floatData[Vr]=Number(Lr.floatData[Vr])}if(Lr.int32Data){if(!Array.isArray(Lr.int32Data))throw TypeError(".onnx.TensorProto.int32Data: array expected");for(Ur.int32Data=[],Vr=0;Vr<Lr.int32Data.length;++Vr)Ur.int32Data[Vr]=0|Lr.int32Data[Vr]}if(Lr.stringData){if(!Array.isArray(Lr.stringData))throw TypeError(".onnx.TensorProto.stringData: array expected");for(Ur.stringData=[],Vr=0;Vr<Lr.stringData.length;++Vr)typeof Lr.stringData[Vr]=="string"?jr.base64.decode(Lr.stringData[Vr],Ur.stringData[Vr]=jr.newBuffer(jr.base64.length(Lr.stringData[Vr])),0):Lr.stringData[Vr].length&&(Ur.stringData[Vr]=Lr.stringData[Vr])}if(Lr.int64Data){if(!Array.isArray(Lr.int64Data))throw TypeError(".onnx.TensorProto.int64Data: array expected");for(Ur.int64Data=[],Vr=0;Vr<Lr.int64Data.length;++Vr)jr.Long?(Ur.int64Data[Vr]=jr.Long.fromValue(Lr.int64Data[Vr])).unsigned=!1:typeof Lr.int64Data[Vr]=="string"?Ur.int64Data[Vr]=parseInt(Lr.int64Data[Vr],10):typeof Lr.int64Data[Vr]=="number"?Ur.int64Data[Vr]=Lr.int64Data[Vr]:typeof Lr.int64Data[Vr]=="object"&&(Ur.int64Data[Vr]=new jr.LongBits(Lr.int64Data[Vr].low>>>0,Lr.int64Data[Vr].high>>>0).toNumber())}if(Lr.name!=null&&(Ur.name=String(Lr.name)),Lr.docString!=null&&(Ur.docString=String(Lr.docString)),Lr.rawData!=null&&(typeof Lr.rawData=="string"?jr.base64.decode(Lr.rawData,Ur.rawData=jr.newBuffer(jr.base64.length(Lr.rawData)),0):Lr.rawData.length&&(Ur.rawData=Lr.rawData)),Lr.externalData){if(!Array.isArray(Lr.externalData))throw TypeError(".onnx.TensorProto.externalData: array expected");for(Ur.externalData=[],Vr=0;Vr<Lr.externalData.length;++Vr){if(typeof Lr.externalData[Vr]!="object")throw TypeError(".onnx.TensorProto.externalData: object expected");Ur.externalData[Vr]=Gr.onnx.StringStringEntryProto.fromObject(Lr.externalData[Vr])}}switch(Lr.dataLocation){case"DEFAULT":case 0:Ur.dataLocation=0;break;case"EXTERNAL":case 1:Ur.dataLocation=1}if(Lr.doubleData){if(!Array.isArray(Lr.doubleData))throw TypeError(".onnx.TensorProto.doubleData: array expected");for(Ur.doubleData=[],Vr=0;Vr<Lr.doubleData.length;++Vr)Ur.doubleData[Vr]=Number(Lr.doubleData[Vr])}if(Lr.uint64Data){if(!Array.isArray(Lr.uint64Data))throw TypeError(".onnx.TensorProto.uint64Data: array expected");for(Ur.uint64Data=[],Vr=0;Vr<Lr.uint64Data.length;++Vr)jr.Long?(Ur.uint64Data[Vr]=jr.Long.fromValue(Lr.uint64Data[Vr])).unsigned=!0:typeof Lr.uint64Data[Vr]=="string"?Ur.uint64Data[Vr]=parseInt(Lr.uint64Data[Vr],10):typeof Lr.uint64Data[Vr]=="number"?Ur.uint64Data[Vr]=Lr.uint64Data[Vr]:typeof Lr.uint64Data[Vr]=="object"&&(Ur.uint64Data[Vr]=new jr.LongBits(Lr.uint64Data[Vr].low>>>0,Lr.uint64Data[Vr].high>>>0).toNumber(!0))}return Ur},Nr.toObject=function(Lr,Ur){Ur||(Ur={});var Vr={};if((Ur.arrays||Ur.defaults)&&(Vr.dims=[],Vr.floatData=[],Vr.int32Data=[],Vr.stringData=[],Vr.int64Data=[],Vr.doubleData=[],Vr.uint64Data=[],Vr.externalData=[]),Ur.defaults&&(Vr.dataType=0,Vr.segment=null,Vr.name="",Ur.bytes===String?Vr.rawData="":(Vr.rawData=[],Ur.bytes!==Array&&(Vr.rawData=jr.newBuffer(Vr.rawData))),Vr.docString="",Vr.dataLocation=Ur.enums===String?"DEFAULT":0),Lr.dims&&Lr.dims.length){Vr.dims=[];for(var Wr=0;Wr<Lr.dims.length;++Wr)typeof Lr.dims[Wr]=="number"?Vr.dims[Wr]=Ur.longs===String?String(Lr.dims[Wr]):Lr.dims[Wr]:Vr.dims[Wr]=Ur.longs===String?jr.Long.prototype.toString.call(Lr.dims[Wr]):Ur.longs===Number?new jr.LongBits(Lr.dims[Wr].low>>>0,Lr.dims[Wr].high>>>0).toNumber():Lr.dims[Wr]}if(Lr.dataType!=null&&Lr.hasOwnProperty("dataType")&&(Vr.dataType=Lr.dataType),Lr.segment!=null&&Lr.hasOwnProperty("segment")&&(Vr.segment=Gr.onnx.TensorProto.Segment.toObject(Lr.segment,Ur)),Lr.floatData&&Lr.floatData.length)for(Vr.floatData=[],Wr=0;Wr<Lr.floatData.length;++Wr)Vr.floatData[Wr]=Ur.json&&!isFinite(Lr.floatData[Wr])?String(Lr.floatData[Wr]):Lr.floatData[Wr];if(Lr.int32Data&&Lr.int32Data.length)for(Vr.int32Data=[],Wr=0;Wr<Lr.int32Data.length;++Wr)Vr.int32Data[Wr]=Lr.int32Data[Wr];if(Lr.stringData&&Lr.stringData.length)for(Vr.stringData=[],Wr=0;Wr<Lr.stringData.length;++Wr)Vr.stringData[Wr]=Ur.bytes===String?jr.base64.encode(Lr.stringData[Wr],0,Lr.stringData[Wr].length):Ur.bytes===Array?Array.prototype.slice.call(Lr.stringData[Wr]):Lr.stringData[Wr];if(Lr.int64Data&&Lr.int64Data.length)for(Vr.int64Data=[],Wr=0;Wr<Lr.int64Data.length;++Wr)typeof Lr.int64Data[Wr]=="number"?Vr.int64Data[Wr]=Ur.longs===String?String(Lr.int64Data[Wr]):Lr.int64Data[Wr]:Vr.int64Data[Wr]=Ur.longs===String?jr.Long.prototype.toString.call(Lr.int64Data[Wr]):Ur.longs===Number?new jr.LongBits(Lr.int64Data[Wr].low>>>0,Lr.int64Data[Wr].high>>>0).toNumber():Lr.int64Data[Wr];if(Lr.name!=null&&Lr.hasOwnProperty("name")&&(Vr.name=Lr.name),Lr.rawData!=null&&Lr.hasOwnProperty("rawData")&&(Vr.rawData=Ur.bytes===String?jr.base64.encode(Lr.rawData,0,Lr.rawData.length):Ur.bytes===Array?Array.prototype.slice.call(Lr.rawData):Lr.rawData),Lr.doubleData&&Lr.doubleData.length)for(Vr.doubleData=[],Wr=0;Wr<Lr.doubleData.length;++Wr)Vr.doubleData[Wr]=Ur.json&&!isFinite(Lr.doubleData[Wr])?String(Lr.doubleData[Wr]):Lr.doubleData[Wr];if(Lr.uint64Data&&Lr.uint64Data.length)for(Vr.uint64Data=[],Wr=0;Wr<Lr.uint64Data.length;++Wr)typeof Lr.uint64Data[Wr]=="number"?Vr.uint64Data[Wr]=Ur.longs===String?String(Lr.uint64Data[Wr]):Lr.uint64Data[Wr]:Vr.uint64Data[Wr]=Ur.longs===String?jr.Long.prototype.toString.call(Lr.uint64Data[Wr]):Ur.longs===Number?new jr.LongBits(Lr.uint64Data[Wr].low>>>0,Lr.uint64Data[Wr].high>>>0).toNumber(!0):Lr.uint64Data[Wr];if(Lr.docString!=null&&Lr.hasOwnProperty("docString")&&(Vr.docString=Lr.docString),Lr.externalData&&Lr.externalData.length)for(Vr.externalData=[],Wr=0;Wr<Lr.externalData.length;++Wr)Vr.externalData[Wr]=Gr.onnx.StringStringEntryProto.toObject(Lr.externalData[Wr],Ur);return Lr.dataLocation!=null&&Lr.hasOwnProperty("dataLocation")&&(Vr.dataLocation=Ur.enums===String?Gr.onnx.TensorProto.DataLocation[Lr.dataLocation]:Lr.dataLocation),Vr},Nr.prototype.toJSON=function(){return this.constructor.toObject(this,Mr.util.toJSONOptions)},Nr.DataType=function(){var Lr={},Ur=Object.create(Lr);return Ur[Lr[0]="UNDEFINED"]=0,Ur[Lr[1]="FLOAT"]=1,Ur[Lr[2]="UINT8"]=2,Ur[Lr[3]="INT8"]=3,Ur[Lr[4]="UINT16"]=4,Ur[Lr[5]="INT16"]=5,Ur[Lr[6]="INT32"]=6,Ur[Lr[7]="INT64"]=7,Ur[Lr[8]="STRING"]=8,Ur[Lr[9]="BOOL"]=9,Ur[Lr[10]="FLOAT16"]=10,Ur[Lr[11]="DOUBLE"]=11,Ur[Lr[12]="UINT32"]=12,Ur[Lr[13]="UINT64"]=13,Ur[Lr[14]="COMPLEX64"]=14,Ur[Lr[15]="COMPLEX128"]=15,Ur[Lr[16]="BFLOAT16"]=16,Ur}(),Nr.Segment=function(){function Lr(Ur){if(Ur)for(var Vr=Object.keys(Ur),Wr=0;Wr<Vr.length;++Wr)Ur[Vr[Wr]]!=null&&(this[Vr[Wr]]=Ur[Vr[Wr]])}return Lr.prototype.begin=jr.Long?jr.Long.fromBits(0,0,!1):0,Lr.prototype.end=jr.Long?jr.Long.fromBits(0,0,!1):0,Lr.create=function(Ur){return new Lr(Ur)},Lr.encode=function(Ur,Vr){return Vr||(Vr=zr.create()),Ur.begin!=null&&Ur.hasOwnProperty("begin")&&Vr.uint32(8).int64(Ur.begin),Ur.end!=null&&Ur.hasOwnProperty("end")&&Vr.uint32(16).int64(Ur.end),Vr},Lr.encodeDelimited=function(Ur,Vr){return this.encode(Ur,Vr).ldelim()},Lr.decode=function(Ur,Vr){Ur instanceof Fr||(Ur=Fr.create(Ur));for(var Wr=Vr===void 0?Ur.len:Ur.pos+Vr,qr=new Gr.onnx.TensorProto.Segment;Ur.pos<Wr;){var Kr=Ur.uint32();switch(Kr>>>3){case 1:qr.begin=Ur.int64();break;case 2:qr.end=Ur.int64();break;default:Ur.skipType(7&Kr)}}return qr},Lr.decodeDelimited=function(Ur){return Ur instanceof Fr||(Ur=new Fr(Ur)),this.decode(Ur,Ur.uint32())},Lr.verify=function(Ur){return typeof Ur!="object"||Ur===null?"object expected":Ur.begin!=null&&Ur.hasOwnProperty("begin")&&!(jr.isInteger(Ur.begin)||Ur.begin&&jr.isInteger(Ur.begin.low)&&jr.isInteger(Ur.begin.high))?"begin: integer|Long expected":Ur.end!=null&&Ur.hasOwnProperty("end")&&!(jr.isInteger(Ur.end)||Ur.end&&jr.isInteger(Ur.end.low)&&jr.isInteger(Ur.end.high))?"end: integer|Long expected":null},Lr.fromObject=function(Ur){if(Ur instanceof Gr.onnx.TensorProto.Segment)return Ur;var Vr=new Gr.onnx.TensorProto.Segment;return Ur.begin!=null&&(jr.Long?(Vr.begin=jr.Long.fromValue(Ur.begin)).unsigned=!1:typeof Ur.begin=="string"?Vr.begin=parseInt(Ur.begin,10):typeof Ur.begin=="number"?Vr.begin=Ur.begin:typeof Ur.begin=="object"&&(Vr.begin=new jr.LongBits(Ur.begin.low>>>0,Ur.begin.high>>>0).toNumber())),Ur.end!=null&&(jr.Long?(Vr.end=jr.Long.fromValue(Ur.end)).unsigned=!1:typeof Ur.end=="string"?Vr.end=parseInt(Ur.end,10):typeof Ur.end=="number"?Vr.end=Ur.end:typeof Ur.end=="object"&&(Vr.end=new jr.LongBits(Ur.end.low>>>0,Ur.end.high>>>0).toNumber())),Vr},Lr.toObject=function(Ur,Vr){Vr||(Vr={});var Wr={};if(Vr.defaults){if(jr.Long){var qr=new jr.Long(0,0,!1);Wr.begin=Vr.longs===String?qr.toString():Vr.longs===Number?qr.toNumber():qr}else Wr.begin=Vr.longs===String?"0":0;jr.Long?(qr=new jr.Long(0,0,!1),Wr.end=Vr.longs===String?qr.toString():Vr.longs===Number?qr.toNumber():qr):Wr.end=Vr.longs===String?"0":0}return Ur.begin!=null&&Ur.hasOwnProperty("begin")&&(typeof Ur.begin=="number"?Wr.begin=Vr.longs===String?String(Ur.begin):Ur.begin:Wr.begin=Vr.longs===String?jr.Long.prototype.toString.call(Ur.begin):Vr.longs===Number?new jr.LongBits(Ur.begin.low>>>0,Ur.begin.high>>>0).toNumber():Ur.begin),Ur.end!=null&&Ur.hasOwnProperty("end")&&(typeof Ur.end=="number"?Wr.end=Vr.longs===String?String(Ur.end):Ur.end:Wr.end=Vr.longs===String?jr.Long.prototype.toString.call(Ur.end):Vr.longs===Number?new jr.LongBits(Ur.end.low>>>0,Ur.end.high>>>0).toNumber():Ur.end),Wr},Lr.prototype.toJSON=function(){return this.constructor.toObject(this,Mr.util.toJSONOptions)},Lr}(),Nr.DataLocation=function(){var Lr={},Ur=Object.create(Lr);return Ur[Lr[0]="DEFAULT"]=0,Ur[Lr[1]="EXTERNAL"]=1,Ur}(),Nr}(),Dr.TensorShapeProto=function(){function Nr(Lr){if(this.dim=[],Lr)for(var Ur=Object.keys(Lr),Vr=0;Vr<Ur.length;++Vr)Lr[Ur[Vr]]!=null&&(this[Ur[Vr]]=Lr[Ur[Vr]])}return Nr.prototype.dim=jr.emptyArray,Nr.create=function(Lr){return new Nr(Lr)},Nr.encode=function(Lr,Ur){if(Ur||(Ur=zr.create()),Lr.dim!=null&&Lr.dim.length)for(var Vr=0;Vr<Lr.dim.length;++Vr)Gr.onnx.TensorShapeProto.Dimension.encode(Lr.dim[Vr],Ur.uint32(10).fork()).ldelim();return Ur},Nr.encodeDelimited=function(Lr,Ur){return this.encode(Lr,Ur).ldelim()},Nr.decode=function(Lr,Ur){Lr instanceof Fr||(Lr=Fr.create(Lr));for(var Vr=Ur===void 0?Lr.len:Lr.pos+Ur,Wr=new Gr.onnx.TensorShapeProto;Lr.pos<Vr;){var qr=Lr.uint32();qr>>>3==1?(Wr.dim&&Wr.dim.length||(Wr.dim=[]),Wr.dim.push(Gr.onnx.TensorShapeProto.Dimension.decode(Lr,Lr.uint32()))):Lr.skipType(7&qr)}return Wr},Nr.decodeDelimited=function(Lr){return Lr instanceof Fr||(Lr=new Fr(Lr)),this.decode(Lr,Lr.uint32())},Nr.verify=function(Lr){if(typeof Lr!="object"||Lr===null)return"object expected";if(Lr.dim!=null&&Lr.hasOwnProperty("dim")){if(!Array.isArray(Lr.dim))return"dim: array expected";for(var Ur=0;Ur<Lr.dim.length;++Ur){var Vr=Gr.onnx.TensorShapeProto.Dimension.verify(Lr.dim[Ur]);if(Vr)return"dim."+Vr}}return null},Nr.fromObject=function(Lr){if(Lr instanceof Gr.onnx.TensorShapeProto)return Lr;var Ur=new Gr.onnx.TensorShapeProto;if(Lr.dim){if(!Array.isArray(Lr.dim))throw TypeError(".onnx.TensorShapeProto.dim: array expected");Ur.dim=[];for(var Vr=0;Vr<Lr.dim.length;++Vr){if(typeof Lr.dim[Vr]!="object")throw TypeError(".onnx.TensorShapeProto.dim: object expected");Ur.dim[Vr]=Gr.onnx.TensorShapeProto.Dimension.fromObject(Lr.dim[Vr])}}return Ur},Nr.toObject=function(Lr,Ur){Ur||(Ur={});var Vr={};if((Ur.arrays||Ur.defaults)&&(Vr.dim=[]),Lr.dim&&Lr.dim.length){Vr.dim=[];for(var Wr=0;Wr<Lr.dim.length;++Wr)Vr.dim[Wr]=Gr.onnx.TensorShapeProto.Dimension.toObject(Lr.dim[Wr],Ur)}return Vr},Nr.prototype.toJSON=function(){return this.constructor.toObject(this,Mr.util.toJSONOptions)},Nr.Dimension=function(){function Lr(Vr){if(Vr)for(var Wr=Object.keys(Vr),qr=0;qr<Wr.length;++qr)Vr[Wr[qr]]!=null&&(this[Wr[qr]]=Vr[Wr[qr]])}var Ur;return Lr.prototype.dimValue=jr.Long?jr.Long.fromBits(0,0,!1):0,Lr.prototype.dimParam="",Lr.prototype.denotation="",Object.defineProperty(Lr.prototype,"value",{get:jr.oneOfGetter(Ur=["dimValue","dimParam"]),set:jr.oneOfSetter(Ur)}),Lr.create=function(Vr){return new Lr(Vr)},Lr.encode=function(Vr,Wr){return Wr||(Wr=zr.create()),Vr.dimValue!=null&&Vr.hasOwnProperty("dimValue")&&Wr.uint32(8).int64(Vr.dimValue),Vr.dimParam!=null&&Vr.hasOwnProperty("dimParam")&&Wr.uint32(18).string(Vr.dimParam),Vr.denotation!=null&&Vr.hasOwnProperty("denotation")&&Wr.uint32(26).string(Vr.denotation),Wr},Lr.encodeDelimited=function(Vr,Wr){return this.encode(Vr,Wr).ldelim()},Lr.decode=function(Vr,Wr){Vr instanceof Fr||(Vr=Fr.create(Vr));for(var qr=Wr===void 0?Vr.len:Vr.pos+Wr,Kr=new Gr.onnx.TensorShapeProto.Dimension;Vr.pos<qr;){var Xr=Vr.uint32();switch(Xr>>>3){case 1:Kr.dimValue=Vr.int64();break;case 2:Kr.dimParam=Vr.string();break;case 3:Kr.denotation=Vr.string();break;default:Vr.skipType(7&Xr)}}return Kr},Lr.decodeDelimited=function(Vr){return Vr instanceof Fr||(Vr=new Fr(Vr)),this.decode(Vr,Vr.uint32())},Lr.verify=function(Vr){if(typeof Vr!="object"||Vr===null)return"object expected";var Wr={};if(Vr.dimValue!=null&&Vr.hasOwnProperty("dimValue")&&(Wr.value=1,!(jr.isInteger(Vr.dimValue)||Vr.dimValue&&jr.isInteger(Vr.dimValue.low)&&jr.isInteger(Vr.dimValue.high))))return"dimValue: integer|Long expected";if(Vr.dimParam!=null&&Vr.hasOwnProperty("dimParam")){if(Wr.value===1)return"value: multiple values";if(Wr.value=1,!jr.isString(Vr.dimParam))return"dimParam: string expected"}return Vr.denotation!=null&&Vr.hasOwnProperty("denotation")&&!jr.isString(Vr.denotation)?"denotation: string expected":null},Lr.fromObject=function(Vr){if(Vr instanceof Gr.onnx.TensorShapeProto.Dimension)return Vr;var Wr=new Gr.onnx.TensorShapeProto.Dimension;return Vr.dimValue!=null&&(jr.Long?(Wr.dimValue=jr.Long.fromValue(Vr.dimValue)).unsigned=!1:typeof Vr.dimValue=="string"?Wr.dimValue=parseInt(Vr.dimValue,10):typeof Vr.dimValue=="number"?Wr.dimValue=Vr.dimValue:typeof Vr.dimValue=="object"&&(Wr.dimValue=new jr.LongBits(Vr.dimValue.low>>>0,Vr.dimValue.high>>>0).toNumber())),Vr.dimParam!=null&&(Wr.dimParam=String(Vr.dimParam)),Vr.denotation!=null&&(Wr.denotation=String(Vr.denotation)),Wr},Lr.toObject=function(Vr,Wr){Wr||(Wr={});var qr={};return Wr.defaults&&(qr.denotation=""),Vr.dimValue!=null&&Vr.hasOwnProperty("dimValue")&&(typeof Vr.dimValue=="number"?qr.dimValue=Wr.longs===String?String(Vr.dimValue):Vr.dimValue:qr.dimValue=Wr.longs===String?jr.Long.prototype.toString.call(Vr.dimValue):Wr.longs===Number?new jr.LongBits(Vr.dimValue.low>>>0,Vr.dimValue.high>>>0).toNumber():Vr.dimValue,Wr.oneofs&&(qr.value="dimValue")),Vr.dimParam!=null&&Vr.hasOwnProperty("dimParam")&&(qr.dimParam=Vr.dimParam,Wr.oneofs&&(qr.value="dimParam")),Vr.denotation!=null&&Vr.hasOwnProperty("denotation")&&(qr.denotation=Vr.denotation),qr},Lr.prototype.toJSON=function(){return this.constructor.toObject(this,Mr.util.toJSONOptions)},Lr}(),Nr}(),Dr.TypeProto=function(){function Nr(Ur){if(Ur)for(var Vr=Object.keys(Ur),Wr=0;Wr<Vr.length;++Wr)Ur[Vr[Wr]]!=null&&(this[Vr[Wr]]=Ur[Vr[Wr]])}var Lr;return Nr.prototype.tensorType=null,Nr.prototype.denotation="",Object.defineProperty(Nr.prototype,"value",{get:jr.oneOfGetter(Lr=["tensorType"]),set:jr.oneOfSetter(Lr)}),Nr.create=function(Ur){return new Nr(Ur)},Nr.encode=function(Ur,Vr){return Vr||(Vr=zr.create()),Ur.tensorType!=null&&Ur.hasOwnProperty("tensorType")&&Gr.onnx.TypeProto.Tensor.encode(Ur.tensorType,Vr.uint32(10).fork()).ldelim(),Ur.denotation!=null&&Ur.hasOwnProperty("denotation")&&Vr.uint32(50).string(Ur.denotation),Vr},Nr.encodeDelimited=function(Ur,Vr){return this.encode(Ur,Vr).ldelim()},Nr.decode=function(Ur,Vr){Ur instanceof Fr||(Ur=Fr.create(Ur));for(var Wr=Vr===void 0?Ur.len:Ur.pos+Vr,qr=new Gr.onnx.TypeProto;Ur.pos<Wr;){var Kr=Ur.uint32();switch(Kr>>>3){case 1:qr.tensorType=Gr.onnx.TypeProto.Tensor.decode(Ur,Ur.uint32());break;case 6:qr.denotation=Ur.string();break;default:Ur.skipType(7&Kr)}}return qr},Nr.decodeDelimited=function(Ur){return Ur instanceof Fr||(Ur=new Fr(Ur)),this.decode(Ur,Ur.uint32())},Nr.verify=function(Ur){if(typeof Ur!="object"||Ur===null)return"object expected";if(Ur.tensorType!=null&&Ur.hasOwnProperty("tensorType")){var Vr=Gr.onnx.TypeProto.Tensor.verify(Ur.tensorType);if(Vr)return"tensorType."+Vr}return Ur.denotation!=null&&Ur.hasOwnProperty("denotation")&&!jr.isString(Ur.denotation)?"denotation: string expected":null},Nr.fromObject=function(Ur){if(Ur instanceof Gr.onnx.TypeProto)return Ur;var Vr=new Gr.onnx.TypeProto;if(Ur.tensorType!=null){if(typeof Ur.tensorType!="object")throw TypeError(".onnx.TypeProto.tensorType: object expected");Vr.tensorType=Gr.onnx.TypeProto.Tensor.fromObject(Ur.tensorType)}return Ur.denotation!=null&&(Vr.denotation=String(Ur.denotation)),Vr},Nr.toObject=function(Ur,Vr){Vr||(Vr={});var Wr={};return Vr.defaults&&(Wr.denotation=""),Ur.tensorType!=null&&Ur.hasOwnProperty("tensorType")&&(Wr.tensorType=Gr.onnx.TypeProto.Tensor.toObject(Ur.tensorType,Vr),Vr.oneofs&&(Wr.value="tensorType")),Ur.denotation!=null&&Ur.hasOwnProperty("denotation")&&(Wr.denotation=Ur.denotation),Wr},Nr.prototype.toJSON=function(){return this.constructor.toObject(this,Mr.util.toJSONOptions)},Nr.Tensor=function(){function Ur(Vr){if(Vr)for(var Wr=Object.keys(Vr),qr=0;qr<Wr.length;++qr)Vr[Wr[qr]]!=null&&(this[Wr[qr]]=Vr[Wr[qr]])}return Ur.prototype.elemType=0,Ur.prototype.shape=null,Ur.create=function(Vr){return new Ur(Vr)},Ur.encode=function(Vr,Wr){return Wr||(Wr=zr.create()),Vr.elemType!=null&&Vr.hasOwnProperty("elemType")&&Wr.uint32(8).int32(Vr.elemType),Vr.shape!=null&&Vr.hasOwnProperty("shape")&&Gr.onnx.TensorShapeProto.encode(Vr.shape,Wr.uint32(18).fork()).ldelim(),Wr},Ur.encodeDelimited=function(Vr,Wr){return this.encode(Vr,Wr).ldelim()},Ur.decode=function(Vr,Wr){Vr instanceof Fr||(Vr=Fr.create(Vr));for(var qr=Wr===void 0?Vr.len:Vr.pos+Wr,Kr=new Gr.onnx.TypeProto.Tensor;Vr.pos<qr;){var Xr=Vr.uint32();switch(Xr>>>3){case 1:Kr.elemType=Vr.int32();break;case 2:Kr.shape=Gr.onnx.TensorShapeProto.decode(Vr,Vr.uint32());break;default:Vr.skipType(7&Xr)}}return Kr},Ur.decodeDelimited=function(Vr){return Vr instanceof Fr||(Vr=new Fr(Vr)),this.decode(Vr,Vr.uint32())},Ur.verify=function(Vr){if(typeof Vr!="object"||Vr===null)return"object expected";if(Vr.elemType!=null&&Vr.hasOwnProperty("elemType")&&!jr.isInteger(Vr.elemType))return"elemType: integer expected";if(Vr.shape!=null&&Vr.hasOwnProperty("shape")){var Wr=Gr.onnx.TensorShapeProto.verify(Vr.shape);if(Wr)return"shape."+Wr}return null},Ur.fromObject=function(Vr){if(Vr instanceof Gr.onnx.TypeProto.Tensor)return Vr;var Wr=new Gr.onnx.TypeProto.Tensor;if(Vr.elemType!=null&&(Wr.elemType=0|Vr.elemType),Vr.shape!=null){if(typeof Vr.shape!="object")throw TypeError(".onnx.TypeProto.Tensor.shape: object expected");Wr.shape=Gr.onnx.TensorShapeProto.fromObject(Vr.shape)}return Wr},Ur.toObject=function(Vr,Wr){Wr||(Wr={});var qr={};return Wr.defaults&&(qr.elemType=0,qr.shape=null),Vr.elemType!=null&&Vr.hasOwnProperty("elemType")&&(qr.elemType=Vr.elemType),Vr.shape!=null&&Vr.hasOwnProperty("shape")&&(qr.shape=Gr.onnx.TensorShapeProto.toObject(Vr.shape,Wr)),qr},Ur.prototype.toJSON=function(){return this.constructor.toObject(this,Mr.util.toJSONOptions)},Ur}(),Nr}(),Dr.OperatorSetIdProto=function(){function Nr(Lr){if(Lr)for(var Ur=Object.keys(Lr),Vr=0;Vr<Ur.length;++Vr)Lr[Ur[Vr]]!=null&&(this[Ur[Vr]]=Lr[Ur[Vr]])}return Nr.prototype.domain="",Nr.prototype.version=jr.Long?jr.Long.fromBits(0,0,!1):0,Nr.create=function(Lr){return new Nr(Lr)},Nr.encode=function(Lr,Ur){return Ur||(Ur=zr.create()),Lr.domain!=null&&Lr.hasOwnProperty("domain")&&Ur.uint32(10).string(Lr.domain),Lr.version!=null&&Lr.hasOwnProperty("version")&&Ur.uint32(16).int64(Lr.version),Ur},Nr.encodeDelimited=function(Lr,Ur){return this.encode(Lr,Ur).ldelim()},Nr.decode=function(Lr,Ur){Lr instanceof Fr||(Lr=Fr.create(Lr));for(var Vr=Ur===void 0?Lr.len:Lr.pos+Ur,Wr=new Gr.onnx.OperatorSetIdProto;Lr.pos<Vr;){var qr=Lr.uint32();switch(qr>>>3){case 1:Wr.domain=Lr.string();break;case 2:Wr.version=Lr.int64();break;default:Lr.skipType(7&qr)}}return Wr},Nr.decodeDelimited=function(Lr){return Lr instanceof Fr||(Lr=new Fr(Lr)),this.decode(Lr,Lr.uint32())},Nr.verify=function(Lr){return typeof Lr!="object"||Lr===null?"object expected":Lr.domain!=null&&Lr.hasOwnProperty("domain")&&!jr.isString(Lr.domain)?"domain: string expected":Lr.version!=null&&Lr.hasOwnProperty("version")&&!(jr.isInteger(Lr.version)||Lr.version&&jr.isInteger(Lr.version.low)&&jr.isInteger(Lr.version.high))?"version: integer|Long expected":null},Nr.fromObject=function(Lr){if(Lr instanceof Gr.onnx.OperatorSetIdProto)return Lr;var Ur=new Gr.onnx.OperatorSetIdProto;return Lr.domain!=null&&(Ur.domain=String(Lr.domain)),Lr.version!=null&&(jr.Long?(Ur.version=jr.Long.fromValue(Lr.version)).unsigned=!1:typeof Lr.version=="string"?Ur.version=parseInt(Lr.version,10):typeof Lr.version=="number"?Ur.version=Lr.version:typeof Lr.version=="object"&&(Ur.version=new jr.LongBits(Lr.version.low>>>0,Lr.version.high>>>0).toNumber())),Ur},Nr.toObject=function(Lr,Ur){Ur||(Ur={});var Vr={};if(Ur.defaults)if(Vr.domain="",jr.Long){var Wr=new jr.Long(0,0,!1);Vr.version=Ur.longs===String?Wr.toString():Ur.longs===Number?Wr.toNumber():Wr}else Vr.version=Ur.longs===String?"0":0;return Lr.domain!=null&&Lr.hasOwnProperty("domain")&&(Vr.domain=Lr.domain),Lr.version!=null&&Lr.hasOwnProperty("version")&&(typeof Lr.version=="number"?Vr.version=Ur.longs===String?String(Lr.version):Lr.version:Vr.version=Ur.longs===String?jr.Long.prototype.toString.call(Lr.version):Ur.longs===Number?new jr.LongBits(Lr.version.low>>>0,Lr.version.high>>>0).toNumber():Lr.version),Vr},Nr.prototype.toJSON=function(){return this.constructor.toObject(this,Mr.util.toJSONOptions)},Nr}(),Dr),_r.exports=Gr},2100:(_r,Tr,Ar)=>{_r.exports=Ar(9482)},9482:(_r,Tr,Ar)=>{var Rr=Tr;function Pr(){Rr.util._configure(),Rr.Writer._configure(Rr.BufferWriter),Rr.Reader._configure(Rr.BufferReader)}Rr.build="minimal",Rr.Writer=Ar(1173),Rr.BufferWriter=Ar(3155),Rr.Reader=Ar(1408),Rr.BufferReader=Ar(593),Rr.util=Ar(9693),Rr.rpc=Ar(5994),Rr.roots=Ar(5054),Rr.configure=Pr,Pr()},1408:(_r,Tr,Ar)=>{_r.exports=zr;var Rr,Pr=Ar(9693),Dr=Pr.LongBits,Mr=Pr.utf8;function Fr(Wr,qr){return RangeError("index out of range: "+Wr.pos+" + "+(qr||1)+" > "+Wr.len)}function zr(Wr){this.buf=Wr,this.pos=0,this.len=Wr.length}var jr,Gr=typeof Uint8Array<"u"?function(Wr){if(Wr instanceof Uint8Array||Array.isArray(Wr))return new zr(Wr);throw Error("illegal buffer")}:function(Wr){if(Array.isArray(Wr))return new zr(Wr);throw Error("illegal buffer")},Nr=function(){return Pr.Buffer?function(Wr){return(zr.create=function(qr){return Pr.Buffer.isBuffer(qr)?new Rr(qr):Gr(qr)})(Wr)}:Gr};function Lr(){var Wr=new Dr(0,0),qr=0;if(!(this.len-this.pos>4)){for(;qr<3;++qr){if(this.pos>=this.len)throw Fr(this);if(Wr.lo=(Wr.lo|(127&this.buf[this.pos])<<7*qr)>>>0,this.buf[this.pos++]<128)return Wr}return Wr.lo=(Wr.lo|(127&this.buf[this.pos++])<<7*qr)>>>0,Wr}for(;qr<4;++qr)if(Wr.lo=(Wr.lo|(127&this.buf[this.pos])<<7*qr)>>>0,this.buf[this.pos++]<128)return Wr;if(Wr.lo=(Wr.lo|(127&this.buf[this.pos])<<28)>>>0,Wr.hi=(Wr.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return Wr;if(qr=0,this.len-this.pos>4){for(;qr<5;++qr)if(Wr.hi=(Wr.hi|(127&this.buf[this.pos])<<7*qr+3)>>>0,this.buf[this.pos++]<128)return Wr}else for(;qr<5;++qr){if(this.pos>=this.len)throw Fr(this);if(Wr.hi=(Wr.hi|(127&this.buf[this.pos])<<7*qr+3)>>>0,this.buf[this.pos++]<128)return Wr}throw Error("invalid varint encoding")}function Ur(Wr,qr){return(Wr[qr-4]|Wr[qr-3]<<8|Wr[qr-2]<<16|Wr[qr-1]<<24)>>>0}function Vr(){if(this.pos+8>this.len)throw Fr(this,8);return new Dr(Ur(this.buf,this.pos+=4),Ur(this.buf,this.pos+=4))}zr.create=Nr(),zr.prototype._slice=Pr.Array.prototype.subarray||Pr.Array.prototype.slice,zr.prototype.uint32=(jr=4294967295,function(){if(jr=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128||(jr=(jr|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)||(jr=(jr|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)||(jr=(jr|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)||(jr=(jr|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128))return jr;if((this.pos+=5)>this.len)throw this.pos=this.len,Fr(this,10);return jr}),zr.prototype.int32=function(){return 0|this.uint32()},zr.prototype.sint32=function(){var Wr=this.uint32();return Wr>>>1^-(1&Wr)|0},zr.prototype.bool=function(){return this.uint32()!==0},zr.prototype.fixed32=function(){if(this.pos+4>this.len)throw Fr(this,4);return Ur(this.buf,this.pos+=4)},zr.prototype.sfixed32=function(){if(this.pos+4>this.len)throw Fr(this,4);return 0|Ur(this.buf,this.pos+=4)},zr.prototype.float=function(){if(this.pos+4>this.len)throw Fr(this,4);var Wr=Pr.float.readFloatLE(this.buf,this.pos);return this.pos+=4,Wr},zr.prototype.double=function(){if(this.pos+8>this.len)throw Fr(this,4);var Wr=Pr.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,Wr},zr.prototype.bytes=function(){var Wr=this.uint32(),qr=this.pos,Kr=this.pos+Wr;if(Kr>this.len)throw Fr(this,Wr);return this.pos+=Wr,Array.isArray(this.buf)?this.buf.slice(qr,Kr):qr===Kr?new this.buf.constructor(0):this._slice.call(this.buf,qr,Kr)},zr.prototype.string=function(){var Wr=this.bytes();return Mr.read(Wr,0,Wr.length)},zr.prototype.skip=function(Wr){if(typeof Wr=="number"){if(this.pos+Wr>this.len)throw Fr(this,Wr);this.pos+=Wr}else do if(this.pos>=this.len)throw Fr(this);while(128&this.buf[this.pos++]);return this},zr.prototype.skipType=function(Wr){switch(Wr){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(Wr=7&this.uint32())!=4;)this.skipType(Wr);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+Wr+" at offset "+this.pos)}return this},zr._configure=function(Wr){Rr=Wr,zr.create=Nr(),Rr._configure();var qr=Pr.Long?"toLong":"toNumber";Pr.merge(zr.prototype,{int64:function(){return Lr.call(this)[qr](!1)},uint64:function(){return Lr.call(this)[qr](!0)},sint64:function(){return Lr.call(this).zzDecode()[qr](!1)},fixed64:function(){return Vr.call(this)[qr](!0)},sfixed64:function(){return Vr.call(this)[qr](!1)}})}},593:(_r,Tr,Ar)=>{_r.exports=Dr;var Rr=Ar(1408);(Dr.prototype=Object.create(Rr.prototype)).constructor=Dr;var Pr=Ar(9693);function Dr(Mr){Rr.call(this,Mr)}Dr._configure=function(){Pr.Buffer&&(Dr.prototype._slice=Pr.Buffer.prototype.slice)},Dr.prototype.string=function(){var Mr=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+Mr,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+Mr,this.len))},Dr._configure()},5054:_r=>{_r.exports={}},5994:(_r,Tr,Ar)=>{Tr.Service=Ar(7948)},7948:(_r,Tr,Ar)=>{_r.exports=Pr;var Rr=Ar(9693);function Pr(Dr,Mr,Fr){if(typeof Dr!="function")throw TypeError("rpcImpl must be a function");Rr.EventEmitter.call(this),this.rpcImpl=Dr,this.requestDelimited=!!Mr,this.responseDelimited=!!Fr}(Pr.prototype=Object.create(Rr.EventEmitter.prototype)).constructor=Pr,Pr.prototype.rpcCall=function Dr(Mr,Fr,zr,jr,Gr){if(!jr)throw TypeError("request must be specified");var Nr=this;if(!Gr)return Rr.asPromise(Dr,Nr,Mr,Fr,zr,jr);if(Nr.rpcImpl)try{return Nr.rpcImpl(Mr,Fr[Nr.requestDelimited?"encodeDelimited":"encode"](jr).finish(),function(Lr,Ur){if(Lr)return Nr.emit("error",Lr,Mr),Gr(Lr);if(Ur!==null){if(!(Ur instanceof zr))try{Ur=zr[Nr.responseDelimited?"decodeDelimited":"decode"](Ur)}catch(Vr){return Nr.emit("error",Vr,Mr),Gr(Vr)}return Nr.emit("data",Ur,Mr),Gr(null,Ur)}Nr.end(!0)})}catch(Lr){return Nr.emit("error",Lr,Mr),void setTimeout(function(){Gr(Lr)},0)}else setTimeout(function(){Gr(Error("already ended"))},0)},Pr.prototype.end=function(Dr){return this.rpcImpl&&(Dr||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},1945:(_r,Tr,Ar)=>{_r.exports=Pr;var Rr=Ar(9693);function Pr(zr,jr){this.lo=zr>>>0,this.hi=jr>>>0}var Dr=Pr.zero=new Pr(0,0);Dr.toNumber=function(){return 0},Dr.zzEncode=Dr.zzDecode=function(){return this},Dr.length=function(){return 1};var Mr=Pr.zeroHash="\0\0\0\0\0\0\0\0";Pr.fromNumber=function(zr){if(zr===0)return Dr;var jr=zr<0;jr&&(zr=-zr);var Gr=zr>>>0,Nr=(zr-Gr)/4294967296>>>0;return jr&&(Nr=~Nr>>>0,Gr=~Gr>>>0,++Gr>4294967295&&(Gr=0,++Nr>4294967295&&(Nr=0))),new Pr(Gr,Nr)},Pr.from=function(zr){if(typeof zr=="number")return Pr.fromNumber(zr);if(Rr.isString(zr)){if(!Rr.Long)return Pr.fromNumber(parseInt(zr,10));zr=Rr.Long.fromString(zr)}return zr.low||zr.high?new Pr(zr.low>>>0,zr.high>>>0):Dr},Pr.prototype.toNumber=function(zr){if(!zr&&this.hi>>>31){var jr=1+~this.lo>>>0,Gr=~this.hi>>>0;return jr||(Gr=Gr+1>>>0),-(jr+4294967296*Gr)}return this.lo+4294967296*this.hi},Pr.prototype.toLong=function(zr){return Rr.Long?new Rr.Long(0|this.lo,0|this.hi,!!zr):{low:0|this.lo,high:0|this.hi,unsigned:!!zr}};var Fr=String.prototype.charCodeAt;Pr.fromHash=function(zr){return zr===Mr?Dr:new Pr((Fr.call(zr,0)|Fr.call(zr,1)<<8|Fr.call(zr,2)<<16|Fr.call(zr,3)<<24)>>>0,(Fr.call(zr,4)|Fr.call(zr,5)<<8|Fr.call(zr,6)<<16|Fr.call(zr,7)<<24)>>>0)},Pr.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},Pr.prototype.zzEncode=function(){var zr=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^zr)>>>0,this.lo=(this.lo<<1^zr)>>>0,this},Pr.prototype.zzDecode=function(){var zr=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^zr)>>>0,this.hi=(this.hi>>>1^zr)>>>0,this},Pr.prototype.length=function(){var zr=this.lo,jr=(this.lo>>>28|this.hi<<4)>>>0,Gr=this.hi>>>24;return Gr===0?jr===0?zr<16384?zr<128?1:2:zr<2097152?3:4:jr<16384?jr<128?5:6:jr<2097152?7:8:Gr<128?9:10}},9693:function(_r,Tr,Ar){var Rr=Tr;function Pr(Mr,Fr,zr){for(var jr=Object.keys(Fr),Gr=0;Gr<jr.length;++Gr)Mr[jr[Gr]]!==void 0&&zr||(Mr[jr[Gr]]=Fr[jr[Gr]]);return Mr}function Dr(Mr){function Fr(zr,jr){if(!(this instanceof Fr))return new Fr(zr,jr);Object.defineProperty(this,"message",{get:function(){return zr}}),Error.captureStackTrace?Error.captureStackTrace(this,Fr):Object.defineProperty(this,"stack",{value:new Error().stack||""}),jr&&Pr(this,jr)}return(Fr.prototype=Object.create(Error.prototype)).constructor=Fr,Object.defineProperty(Fr.prototype,"name",{get:function(){return Mr}}),Fr.prototype.toString=function(){return this.name+": "+this.message},Fr}Rr.asPromise=Ar(4537),Rr.base64=Ar(7419),Rr.EventEmitter=Ar(9211),Rr.float=Ar(945),Rr.inquire=Ar(7199),Rr.utf8=Ar(4997),Rr.pool=Ar(6662),Rr.LongBits=Ar(1945),Rr.isNode=!!(Ar.g!==void 0&&Ar.g&&Ar.g.process&&Ar.g.process.versions&&Ar.g.process.versions.node),Rr.global=Rr.isNode&&Ar.g||typeof window<"u"&&window||typeof self<"u"&&self||this,Rr.emptyArray=Object.freeze?Object.freeze([]):[],Rr.emptyObject=Object.freeze?Object.freeze({}):{},Rr.isInteger=Number.isInteger||function(Mr){return typeof Mr=="number"&&isFinite(Mr)&&Math.floor(Mr)===Mr},Rr.isString=function(Mr){return typeof Mr=="string"||Mr instanceof String},Rr.isObject=function(Mr){return Mr&&typeof Mr=="object"},Rr.isset=Rr.isSet=function(Mr,Fr){var zr=Mr[Fr];return!(zr==null||!Mr.hasOwnProperty(Fr))&&(typeof zr!="object"||(Array.isArray(zr)?zr.length:Object.keys(zr).length)>0)},Rr.Buffer=function(){try{var Mr=Rr.inquire("buffer").Buffer;return Mr.prototype.utf8Write?Mr:null}catch{return null}}(),Rr._Buffer_from=null,Rr._Buffer_allocUnsafe=null,Rr.newBuffer=function(Mr){return typeof Mr=="number"?Rr.Buffer?Rr._Buffer_allocUnsafe(Mr):new Rr.Array(Mr):Rr.Buffer?Rr._Buffer_from(Mr):typeof Uint8Array>"u"?Mr:new Uint8Array(Mr)},Rr.Array=typeof Uint8Array<"u"?Uint8Array:Array,Rr.Long=Rr.global.dcodeIO&&Rr.global.dcodeIO.Long||Rr.global.Long||Rr.inquire("long"),Rr.key2Re=/^true|false|0|1$/,Rr.key32Re=/^-?(?:0|[1-9][0-9]*)$/,Rr.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,Rr.longToHash=function(Mr){return Mr?Rr.LongBits.from(Mr).toHash():Rr.LongBits.zeroHash},Rr.longFromHash=function(Mr,Fr){var zr=Rr.LongBits.fromHash(Mr);return Rr.Long?Rr.Long.fromBits(zr.lo,zr.hi,Fr):zr.toNumber(!!Fr)},Rr.merge=Pr,Rr.lcFirst=function(Mr){return Mr.charAt(0).toLowerCase()+Mr.substring(1)},Rr.newError=Dr,Rr.ProtocolError=Dr("ProtocolError"),Rr.oneOfGetter=function(Mr){for(var Fr={},zr=0;zr<Mr.length;++zr)Fr[Mr[zr]]=1;return function(){for(var jr=Object.keys(this),Gr=jr.length-1;Gr>-1;--Gr)if(Fr[jr[Gr]]===1&&this[jr[Gr]]!==void 0&&this[jr[Gr]]!==null)return jr[Gr]}},Rr.oneOfSetter=function(Mr){return function(Fr){for(var zr=0;zr<Mr.length;++zr)Mr[zr]!==Fr&&delete this[Mr[zr]]}},Rr.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},Rr._configure=function(){var Mr=Rr.Buffer;Mr?(Rr._Buffer_from=Mr.from!==Uint8Array.from&&Mr.from||function(Fr,zr){return new Mr(Fr,zr)},Rr._Buffer_allocUnsafe=Mr.allocUnsafe||function(Fr){return new Mr(Fr)}):Rr._Buffer_from=Rr._Buffer_allocUnsafe=null}},1173:(_r,Tr,Ar)=>{_r.exports=Nr;var Rr,Pr=Ar(9693),Dr=Pr.LongBits,Mr=Pr.base64,Fr=Pr.utf8;function zr(Xr,Zr,_i){this.fn=Xr,this.len=Zr,this.next=void 0,this.val=_i}function jr(){}function Gr(Xr){this.head=Xr.head,this.tail=Xr.tail,this.len=Xr.len,this.next=Xr.states}function Nr(){this.len=0,this.head=new zr(jr,0,0),this.tail=this.head,this.states=null}var Lr=function(){return Pr.Buffer?function(){return(Nr.create=function(){return new Rr})()}:function(){return new Nr}};function Ur(Xr,Zr,_i){Zr[_i]=255&Xr}function Vr(Xr,Zr){this.len=Xr,this.next=void 0,this.val=Zr}function Wr(Xr,Zr,_i){for(;Xr.hi;)Zr[_i++]=127&Xr.lo|128,Xr.lo=(Xr.lo>>>7|Xr.hi<<25)>>>0,Xr.hi>>>=7;for(;Xr.lo>127;)Zr[_i++]=127&Xr.lo|128,Xr.lo=Xr.lo>>>7;Zr[_i++]=Xr.lo}function qr(Xr,Zr,_i){Zr[_i]=255&Xr,Zr[_i+1]=Xr>>>8&255,Zr[_i+2]=Xr>>>16&255,Zr[_i+3]=Xr>>>24}Nr.create=Lr(),Nr.alloc=function(Xr){return new Pr.Array(Xr)},Pr.Array!==Array&&(Nr.alloc=Pr.pool(Nr.alloc,Pr.Array.prototype.subarray)),Nr.prototype._push=function(Xr,Zr,_i){return this.tail=this.tail.next=new zr(Xr,Zr,_i),this.len+=Zr,this},Vr.prototype=Object.create(zr.prototype),Vr.prototype.fn=function(Xr,Zr,_i){for(;Xr>127;)Zr[_i++]=127&Xr|128,Xr>>>=7;Zr[_i]=Xr},Nr.prototype.uint32=function(Xr){return this.len+=(this.tail=this.tail.next=new Vr((Xr>>>=0)<128?1:Xr<16384?2:Xr<2097152?3:Xr<268435456?4:5,Xr)).len,this},Nr.prototype.int32=function(Xr){return Xr<0?this._push(Wr,10,Dr.fromNumber(Xr)):this.uint32(Xr)},Nr.prototype.sint32=function(Xr){return this.uint32((Xr<<1^Xr>>31)>>>0)},Nr.prototype.uint64=function(Xr){var Zr=Dr.from(Xr);return this._push(Wr,Zr.length(),Zr)},Nr.prototype.int64=Nr.prototype.uint64,Nr.prototype.sint64=function(Xr){var Zr=Dr.from(Xr).zzEncode();return this._push(Wr,Zr.length(),Zr)},Nr.prototype.bool=function(Xr){return this._push(Ur,1,Xr?1:0)},Nr.prototype.fixed32=function(Xr){return this._push(qr,4,Xr>>>0)},Nr.prototype.sfixed32=Nr.prototype.fixed32,Nr.prototype.fixed64=function(Xr){var Zr=Dr.from(Xr);return this._push(qr,4,Zr.lo)._push(qr,4,Zr.hi)},Nr.prototype.sfixed64=Nr.prototype.fixed64,Nr.prototype.float=function(Xr){return this._push(Pr.float.writeFloatLE,4,Xr)},Nr.prototype.double=function(Xr){return this._push(Pr.float.writeDoubleLE,8,Xr)};var Kr=Pr.Array.prototype.set?function(Xr,Zr,_i){Zr.set(Xr,_i)}:function(Xr,Zr,_i){for(var Jr=0;Jr<Xr.length;++Jr)Zr[_i+Jr]=Xr[Jr]};Nr.prototype.bytes=function(Xr){var Zr=Xr.length>>>0;if(!Zr)return this._push(Ur,1,0);if(Pr.isString(Xr)){var _i=Nr.alloc(Zr=Mr.length(Xr));Mr.decode(Xr,_i,0),Xr=_i}return this.uint32(Zr)._push(Kr,Zr,Xr)},Nr.prototype.string=function(Xr){var Zr=Fr.length(Xr);return Zr?this.uint32(Zr)._push(Fr.write,Zr,Xr):this._push(Ur,1,0)},Nr.prototype.fork=function(){return this.states=new Gr(this),this.head=this.tail=new zr(jr,0,0),this.len=0,this},Nr.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new zr(jr,0,0),this.len=0),this},Nr.prototype.ldelim=function(){var Xr=this.head,Zr=this.tail,_i=this.len;return this.reset().uint32(_i),_i&&(this.tail.next=Xr.next,this.tail=Zr,this.len+=_i),this},Nr.prototype.finish=function(){for(var Xr=this.head.next,Zr=this.constructor.alloc(this.len),_i=0;Xr;)Xr.fn(Xr.val,Zr,_i),_i+=Xr.len,Xr=Xr.next;return Zr},Nr._configure=function(Xr){Rr=Xr,Nr.create=Lr(),Rr._configure()}},3155:(_r,Tr,Ar)=>{_r.exports=Dr;var Rr=Ar(1173);(Dr.prototype=Object.create(Rr.prototype)).constructor=Dr;var Pr=Ar(9693);function Dr(){Rr.call(this)}function Mr(Fr,zr,jr){Fr.length<40?Pr.utf8.write(Fr,zr,jr):zr.utf8Write?zr.utf8Write(Fr,jr):zr.write(Fr,jr)}Dr._configure=function(){Dr.alloc=Pr._Buffer_allocUnsafe,Dr.writeBytesBuffer=Pr.Buffer&&Pr.Buffer.prototype instanceof Uint8Array&&Pr.Buffer.prototype.set.name==="set"?function(Fr,zr,jr){zr.set(Fr,jr)}:function(Fr,zr,jr){if(Fr.copy)Fr.copy(zr,jr,0,Fr.length);else for(var Gr=0;Gr<Fr.length;)zr[jr++]=Fr[Gr++]}},Dr.prototype.bytes=function(Fr){Pr.isString(Fr)&&(Fr=Pr._Buffer_from(Fr,"base64"));var zr=Fr.length>>>0;return this.uint32(zr),zr&&this._push(Dr.writeBytesBuffer,zr,Fr),this},Dr.prototype.string=function(Fr){var zr=Pr.Buffer.byteLength(Fr);return this.uint32(zr),zr&&this._push(Mr,zr,Fr),this},Dr._configure()},4154:_r=>{_r.exports=`"use strict";var e={},t="object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node;if(t){var r=require("worker_threads"),a=r.parentPort;a.on("message",(e=>onmessage({data:e})));var o=require("fs");Object.assign(global,{self:global,require:require,Module:e,location:{href:__filename},Worker:r.Worker,importScripts:function(e){(0,eval)(o.readFileSync(e,"utf8"))},postMessage:function(e){a.postMessage(e)},performance:global.performance||{now:function(){return Date.now()}}})}var s=!1,n=[],i=function(){var e=Array.prototype.slice.call(arguments).join(" ");t?o.writeSync(2,e+"\\n"):console.error(e)};self.alert=function(){var t=Array.prototype.slice.call(arguments).join(" ");postMessage({cmd:"alert",text:t,threadId:e._pthread_self()})},e.instantiateWasm=(t,r)=>{var a=new WebAssembly.Instance(e.wasmModule,t);return r(a),e.wasmModule=null,a.exports},self.onunhandledrejection=e=>{throw e.reason??e},self.onmessage=t=>{try{if("load"===t.data.cmd){if(e.wasmModule=t.data.wasmModule,e.wasmMemory=t.data.wasmMemory,e.buffer=e.wasmMemory.buffer,e.ENVIRONMENT_IS_PTHREAD=!0,"string"==typeof t.data.urlOrBlob)importScripts(t.data.urlOrBlob);else{var r=URL.createObjectURL(t.data.urlOrBlob);importScripts(r),URL.revokeObjectURL(r)}ortWasmThreaded(e).then((function(t){e=t}))}else if("run"===t.data.cmd){e.__performance_now_clock_drift=performance.now()-t.data.time,e.__emscripten_thread_init(t.data.pthread_ptr,0,0,1),e.establishStackSpace(),e.PThread.receiveObjectTransfer(t.data),e.PThread.threadInitTLS(),s||(n.forEach((t=>{e.executeNotifiedProxyingQueue(t)})),n=[],s=!0);try{e.invokeEntryPoint(t.data.start_routine,t.data.arg)}catch(t){if("unwind"!=t){if(!(t instanceof e.ExitStatus))throw t;e.keepRuntimeAlive()||e.__emscripten_thread_exit(t.status)}}}else"cancel"===t.data.cmd?e._pthread_self()&&e.__emscripten_thread_exit(-1):"setimmediate"===t.data.target||("processProxyingQueue"===t.data.cmd?s?e.executeNotifiedProxyingQueue(t.data.queue):n.push(t.data.queue):(i("worker.js received unknown command "+t.data.cmd),i(t.data)))}catch(t){throw i("worker.js onmessage() captured an uncaught exception: "+t),t&&t.stack&&i(t.stack),e.__emscripten_thread_crashed&&e.__emscripten_thread_crashed(),t}};
`},7067:()=>{},1296:()=>{},760:()=>{},1384:()=>{},3993:()=>{},908:()=>{},6953:()=>{},9925:()=>{},2806:()=>{},6449:()=>{},2850:()=>{},5381:()=>{},5686:(_r,Tr,Ar)=>{Ar.r(Tr),Ar.d(Tr,{flatbuffers:()=>Rr});var Rr={};Rr.Offset,Rr.Table,Rr.SIZEOF_SHORT=2,Rr.SIZEOF_INT=4,Rr.FILE_IDENTIFIER_LENGTH=4,Rr.SIZE_PREFIX_LENGTH=4,Rr.Encoding={UTF8_BYTES:1,UTF16_STRING:2},Rr.int32=new Int32Array(2),Rr.float32=new Float32Array(Rr.int32.buffer),Rr.float64=new Float64Array(Rr.int32.buffer),Rr.isLittleEndian=new Uint16Array(new Uint8Array([1,0]).buffer)[0]===1,Rr.Long=function(Pr,Dr){this.low=0|Pr,this.high=0|Dr},Rr.Long.create=function(Pr,Dr){return Pr==0&&Dr==0?Rr.Long.ZERO:new Rr.Long(Pr,Dr)},Rr.Long.prototype.toFloat64=function(){return(this.low>>>0)+4294967296*this.high},Rr.Long.prototype.equals=function(Pr){return this.low==Pr.low&&this.high==Pr.high},Rr.Long.ZERO=new Rr.Long(0,0),Rr.Builder=function(Pr){if(Pr)Dr=Pr;else var Dr=1024;this.bb=Rr.ByteBuffer.allocate(Dr),this.space=Dr,this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1},Rr.Builder.prototype.clear=function(){this.bb.clear(),this.space=this.bb.capacity(),this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1},Rr.Builder.prototype.forceDefaults=function(Pr){this.force_defaults=Pr},Rr.Builder.prototype.dataBuffer=function(){return this.bb},Rr.Builder.prototype.asUint8Array=function(){return this.bb.bytes().subarray(this.bb.position(),this.bb.position()+this.offset())},Rr.Builder.prototype.prep=function(Pr,Dr){Pr>this.minalign&&(this.minalign=Pr);for(var Mr=1+~(this.bb.capacity()-this.space+Dr)&Pr-1;this.space<Mr+Pr+Dr;){var Fr=this.bb.capacity();this.bb=Rr.Builder.growByteBuffer(this.bb),this.space+=this.bb.capacity()-Fr}this.pad(Mr)},Rr.Builder.prototype.pad=function(Pr){for(var Dr=0;Dr<Pr;Dr++)this.bb.writeInt8(--this.space,0)},Rr.Builder.prototype.writeInt8=function(Pr){this.bb.writeInt8(this.space-=1,Pr)},Rr.Builder.prototype.writeInt16=function(Pr){this.bb.writeInt16(this.space-=2,Pr)},Rr.Builder.prototype.writeInt32=function(Pr){this.bb.writeInt32(this.space-=4,Pr)},Rr.Builder.prototype.writeInt64=function(Pr){this.bb.writeInt64(this.space-=8,Pr)},Rr.Builder.prototype.writeFloat32=function(Pr){this.bb.writeFloat32(this.space-=4,Pr)},Rr.Builder.prototype.writeFloat64=function(Pr){this.bb.writeFloat64(this.space-=8,Pr)},Rr.Builder.prototype.addInt8=function(Pr){this.prep(1,0),this.writeInt8(Pr)},Rr.Builder.prototype.addInt16=function(Pr){this.prep(2,0),this.writeInt16(Pr)},Rr.Builder.prototype.addInt32=function(Pr){this.prep(4,0),this.writeInt32(Pr)},Rr.Builder.prototype.addInt64=function(Pr){this.prep(8,0),this.writeInt64(Pr)},Rr.Builder.prototype.addFloat32=function(Pr){this.prep(4,0),this.writeFloat32(Pr)},Rr.Builder.prototype.addFloat64=function(Pr){this.prep(8,0),this.writeFloat64(Pr)},Rr.Builder.prototype.addFieldInt8=function(Pr,Dr,Mr){(this.force_defaults||Dr!=Mr)&&(this.addInt8(Dr),this.slot(Pr))},Rr.Builder.prototype.addFieldInt16=function(Pr,Dr,Mr){(this.force_defaults||Dr!=Mr)&&(this.addInt16(Dr),this.slot(Pr))},Rr.Builder.prototype.addFieldInt32=function(Pr,Dr,Mr){(this.force_defaults||Dr!=Mr)&&(this.addInt32(Dr),this.slot(Pr))},Rr.Builder.prototype.addFieldInt64=function(Pr,Dr,Mr){!this.force_defaults&&Dr.equals(Mr)||(this.addInt64(Dr),this.slot(Pr))},Rr.Builder.prototype.addFieldFloat32=function(Pr,Dr,Mr){(this.force_defaults||Dr!=Mr)&&(this.addFloat32(Dr),this.slot(Pr))},Rr.Builder.prototype.addFieldFloat64=function(Pr,Dr,Mr){(this.force_defaults||Dr!=Mr)&&(this.addFloat64(Dr),this.slot(Pr))},Rr.Builder.prototype.addFieldOffset=function(Pr,Dr,Mr){(this.force_defaults||Dr!=Mr)&&(this.addOffset(Dr),this.slot(Pr))},Rr.Builder.prototype.addFieldStruct=function(Pr,Dr,Mr){Dr!=Mr&&(this.nested(Dr),this.slot(Pr))},Rr.Builder.prototype.nested=function(Pr){if(Pr!=this.offset())throw new Error("FlatBuffers: struct must be serialized inline.")},Rr.Builder.prototype.notNested=function(){if(this.isNested)throw new Error("FlatBuffers: object serialization must not be nested.")},Rr.Builder.prototype.slot=function(Pr){this.vtable[Pr]=this.offset()},Rr.Builder.prototype.offset=function(){return this.bb.capacity()-this.space},Rr.Builder.growByteBuffer=function(Pr){var Dr=Pr.capacity();if(3221225472&Dr)throw new Error("FlatBuffers: cannot grow buffer beyond 2 gigabytes.");var Mr=Dr<<1,Fr=Rr.ByteBuffer.allocate(Mr);return Fr.setPosition(Mr-Dr),Fr.bytes().set(Pr.bytes(),Mr-Dr),Fr},Rr.Builder.prototype.addOffset=function(Pr){this.prep(Rr.SIZEOF_INT,0),this.writeInt32(this.offset()-Pr+Rr.SIZEOF_INT)},Rr.Builder.prototype.startObject=function(Pr){this.notNested(),this.vtable==null&&(this.vtable=[]),this.vtable_in_use=Pr;for(var Dr=0;Dr<Pr;Dr++)this.vtable[Dr]=0;this.isNested=!0,this.object_start=this.offset()},Rr.Builder.prototype.endObject=function(){if(this.vtable==null||!this.isNested)throw new Error("FlatBuffers: endObject called without startObject");this.addInt32(0);for(var Pr=this.offset(),Dr=this.vtable_in_use-1;Dr>=0&&this.vtable[Dr]==0;Dr--);for(var Mr=Dr+1;Dr>=0;Dr--)this.addInt16(this.vtable[Dr]!=0?Pr-this.vtable[Dr]:0);this.addInt16(Pr-this.object_start);var Fr=(Mr+2)*Rr.SIZEOF_SHORT;this.addInt16(Fr);var zr=0,jr=this.space;e:for(Dr=0;Dr<this.vtables.length;Dr++){var Gr=this.bb.capacity()-this.vtables[Dr];if(Fr==this.bb.readInt16(Gr)){for(var Nr=Rr.SIZEOF_SHORT;Nr<Fr;Nr+=Rr.SIZEOF_SHORT)if(this.bb.readInt16(jr+Nr)!=this.bb.readInt16(Gr+Nr))continue e;zr=this.vtables[Dr];break}}return zr?(this.space=this.bb.capacity()-Pr,this.bb.writeInt32(this.space,zr-Pr)):(this.vtables.push(this.offset()),this.bb.writeInt32(this.bb.capacity()-Pr,this.offset()-Pr)),this.isNested=!1,Pr},Rr.Builder.prototype.finish=function(Pr,Dr,Mr){var Fr=Mr?Rr.SIZE_PREFIX_LENGTH:0;if(Dr){var zr=Dr;if(this.prep(this.minalign,Rr.SIZEOF_INT+Rr.FILE_IDENTIFIER_LENGTH+Fr),zr.length!=Rr.FILE_IDENTIFIER_LENGTH)throw new Error("FlatBuffers: file identifier must be length "+Rr.FILE_IDENTIFIER_LENGTH);for(var jr=Rr.FILE_IDENTIFIER_LENGTH-1;jr>=0;jr--)this.writeInt8(zr.charCodeAt(jr))}this.prep(this.minalign,Rr.SIZEOF_INT+Fr),this.addOffset(Pr),Fr&&this.addInt32(this.bb.capacity()-this.space),this.bb.setPosition(this.space)},Rr.Builder.prototype.finishSizePrefixed=function(Pr,Dr){this.finish(Pr,Dr,!0)},Rr.Builder.prototype.requiredField=function(Pr,Dr){var Mr=this.bb.capacity()-Pr,Fr=Mr-this.bb.readInt32(Mr);if(this.bb.readInt16(Fr+Dr)==0)throw new Error("FlatBuffers: field "+Dr+" must be set")},Rr.Builder.prototype.startVector=function(Pr,Dr,Mr){this.notNested(),this.vector_num_elems=Dr,this.prep(Rr.SIZEOF_INT,Pr*Dr),this.prep(Mr,Pr*Dr)},Rr.Builder.prototype.endVector=function(){return this.writeInt32(this.vector_num_elems),this.offset()},Rr.Builder.prototype.createString=function(Pr){if(Pr instanceof Uint8Array)var Dr=Pr;else{Dr=[];for(var Mr=0;Mr<Pr.length;){var Fr,zr=Pr.charCodeAt(Mr++);(Fr=zr<55296||zr>=56320?zr:(zr<<10)+Pr.charCodeAt(Mr++)+-56613888)<128?Dr.push(Fr):(Fr<2048?Dr.push(Fr>>6&31|192):(Fr<65536?Dr.push(Fr>>12&15|224):Dr.push(Fr>>18&7|240,Fr>>12&63|128),Dr.push(Fr>>6&63|128)),Dr.push(63&Fr|128))}}this.addInt8(0),this.startVector(1,Dr.length,1),this.bb.setPosition(this.space-=Dr.length),Mr=0;for(var jr=this.space,Gr=this.bb.bytes();Mr<Dr.length;Mr++)Gr[jr++]=Dr[Mr];return this.endVector()},Rr.Builder.prototype.createLong=function(Pr,Dr){return Rr.Long.create(Pr,Dr)},Rr.ByteBuffer=function(Pr){this.bytes_=Pr,this.position_=0},Rr.ByteBuffer.allocate=function(Pr){return new Rr.ByteBuffer(new Uint8Array(Pr))},Rr.ByteBuffer.prototype.clear=function(){this.position_=0},Rr.ByteBuffer.prototype.bytes=function(){return this.bytes_},Rr.ByteBuffer.prototype.position=function(){return this.position_},Rr.ByteBuffer.prototype.setPosition=function(Pr){this.position_=Pr},Rr.ByteBuffer.prototype.capacity=function(){return this.bytes_.length},Rr.ByteBuffer.prototype.readInt8=function(Pr){return this.readUint8(Pr)<<24>>24},Rr.ByteBuffer.prototype.readUint8=function(Pr){return this.bytes_[Pr]},Rr.ByteBuffer.prototype.readInt16=function(Pr){return this.readUint16(Pr)<<16>>16},Rr.ByteBuffer.prototype.readUint16=function(Pr){return this.bytes_[Pr]|this.bytes_[Pr+1]<<8},Rr.ByteBuffer.prototype.readInt32=function(Pr){return this.bytes_[Pr]|this.bytes_[Pr+1]<<8|this.bytes_[Pr+2]<<16|this.bytes_[Pr+3]<<24},Rr.ByteBuffer.prototype.readUint32=function(Pr){return this.readInt32(Pr)>>>0},Rr.ByteBuffer.prototype.readInt64=function(Pr){return new Rr.Long(this.readInt32(Pr),this.readInt32(Pr+4))},Rr.ByteBuffer.prototype.readUint64=function(Pr){return new Rr.Long(this.readUint32(Pr),this.readUint32(Pr+4))},Rr.ByteBuffer.prototype.readFloat32=function(Pr){return Rr.int32[0]=this.readInt32(Pr),Rr.float32[0]},Rr.ByteBuffer.prototype.readFloat64=function(Pr){return Rr.int32[Rr.isLittleEndian?0:1]=this.readInt32(Pr),Rr.int32[Rr.isLittleEndian?1:0]=this.readInt32(Pr+4),Rr.float64[0]},Rr.ByteBuffer.prototype.writeInt8=function(Pr,Dr){this.bytes_[Pr]=Dr},Rr.ByteBuffer.prototype.writeUint8=function(Pr,Dr){this.bytes_[Pr]=Dr},Rr.ByteBuffer.prototype.writeInt16=function(Pr,Dr){this.bytes_[Pr]=Dr,this.bytes_[Pr+1]=Dr>>8},Rr.ByteBuffer.prototype.writeUint16=function(Pr,Dr){this.bytes_[Pr]=Dr,this.bytes_[Pr+1]=Dr>>8},Rr.ByteBuffer.prototype.writeInt32=function(Pr,Dr){this.bytes_[Pr]=Dr,this.bytes_[Pr+1]=Dr>>8,this.bytes_[Pr+2]=Dr>>16,this.bytes_[Pr+3]=Dr>>24},Rr.ByteBuffer.prototype.writeUint32=function(Pr,Dr){this.bytes_[Pr]=Dr,this.bytes_[Pr+1]=Dr>>8,this.bytes_[Pr+2]=Dr>>16,this.bytes_[Pr+3]=Dr>>24},Rr.ByteBuffer.prototype.writeInt64=function(Pr,Dr){this.writeInt32(Pr,Dr.low),this.writeInt32(Pr+4,Dr.high)},Rr.ByteBuffer.prototype.writeUint64=function(Pr,Dr){this.writeUint32(Pr,Dr.low),this.writeUint32(Pr+4,Dr.high)},Rr.ByteBuffer.prototype.writeFloat32=function(Pr,Dr){Rr.float32[0]=Dr,this.writeInt32(Pr,Rr.int32[0])},Rr.ByteBuffer.prototype.writeFloat64=function(Pr,Dr){Rr.float64[0]=Dr,this.writeInt32(Pr,Rr.int32[Rr.isLittleEndian?0:1]),this.writeInt32(Pr+4,Rr.int32[Rr.isLittleEndian?1:0])},Rr.ByteBuffer.prototype.getBufferIdentifier=function(){if(this.bytes_.length<this.position_+Rr.SIZEOF_INT+Rr.FILE_IDENTIFIER_LENGTH)throw new Error("FlatBuffers: ByteBuffer is too short to contain an identifier.");for(var Pr="",Dr=0;Dr<Rr.FILE_IDENTIFIER_LENGTH;Dr++)Pr+=String.fromCharCode(this.readInt8(this.position_+Rr.SIZEOF_INT+Dr));return Pr},Rr.ByteBuffer.prototype.__offset=function(Pr,Dr){var Mr=Pr-this.readInt32(Pr);return Dr<this.readInt16(Mr)?this.readInt16(Mr+Dr):0},Rr.ByteBuffer.prototype.__union=function(Pr,Dr){return Pr.bb_pos=Dr+this.readInt32(Dr),Pr.bb=this,Pr},Rr.ByteBuffer.prototype.__string=function(Pr,Dr){Pr+=this.readInt32(Pr);var Mr=this.readInt32(Pr),Fr="",zr=0;if(Pr+=Rr.SIZEOF_INT,Dr===Rr.Encoding.UTF8_BYTES)return this.bytes_.subarray(Pr,Pr+Mr);for(;zr<Mr;){var jr,Gr=this.readUint8(Pr+zr++);if(Gr<192)jr=Gr;else{var Nr=this.readUint8(Pr+zr++);if(Gr<224)jr=(31&Gr)<<6|63&Nr;else{var Lr=this.readUint8(Pr+zr++);jr=Gr<240?(15&Gr)<<12|(63&Nr)<<6|63&Lr:(7&Gr)<<18|(63&Nr)<<12|(63&Lr)<<6|63&this.readUint8(Pr+zr++)}}jr<65536?Fr+=String.fromCharCode(jr):(jr-=65536,Fr+=String.fromCharCode(55296+(jr>>10),56320+(1023&jr)))}return Fr},Rr.ByteBuffer.prototype.__indirect=function(Pr){return Pr+this.readInt32(Pr)},Rr.ByteBuffer.prototype.__vector=function(Pr){return Pr+this.readInt32(Pr)+Rr.SIZEOF_INT},Rr.ByteBuffer.prototype.__vector_len=function(Pr){return this.readInt32(Pr+this.readInt32(Pr))},Rr.ByteBuffer.prototype.__has_identifier=function(Pr){if(Pr.length!=Rr.FILE_IDENTIFIER_LENGTH)throw new Error("FlatBuffers: file identifier must be length "+Rr.FILE_IDENTIFIER_LENGTH);for(var Dr=0;Dr<Rr.FILE_IDENTIFIER_LENGTH;Dr++)if(Pr.charCodeAt(Dr)!=this.readInt8(this.position_+Rr.SIZEOF_INT+Dr))return!1;return!0},Rr.ByteBuffer.prototype.createLong=function(Pr,Dr){return Rr.Long.create(Pr,Dr)}}},__webpack_module_cache__={};function __nested_webpack_require_606622__(_r){var Tr=__webpack_module_cache__[_r];if(Tr!==void 0)return Tr.exports;var Ar=__webpack_module_cache__[_r]={exports:{}};return __webpack_modules__[_r].call(Ar.exports,Ar,Ar.exports,__nested_webpack_require_606622__),Ar.exports}__nested_webpack_require_606622__.n=_r=>{var Tr=_r&&_r.__esModule?()=>_r.default:()=>_r;return __nested_webpack_require_606622__.d(Tr,{a:Tr}),Tr},__nested_webpack_require_606622__.d=(_r,Tr)=>{for(var Ar in Tr)__nested_webpack_require_606622__.o(Tr,Ar)&&!__nested_webpack_require_606622__.o(_r,Ar)&&Object.defineProperty(_r,Ar,{enumerable:!0,get:Tr[Ar]})},__nested_webpack_require_606622__.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),__nested_webpack_require_606622__.o=(_r,Tr)=>Object.prototype.hasOwnProperty.call(_r,Tr),__nested_webpack_require_606622__.r=_r=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(_r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(_r,"__esModule",{value:!0})};var __nested_webpack_exports__=__nested_webpack_require_606622__(1057);return __nested_webpack_exports__})(),module.exports=t()},60:_r=>{_r.exports="https://unpkg.com/@imgly/background-removal@1.0.6/dist/a620c8c752bdf5c69d98.onnx"},920:_r=>{_r.exports="https://unpkg.com/@imgly/background-removal@1.0.6/dist/2ebb460f4adfe0ebf34d.onnx"},111:_r=>{_r.exports="https://unpkg.com/@imgly/background-removal@1.0.6/dist/ec79eeba92555e43251e.wasm"},965:_r=>{_r.exports="https://unpkg.com/@imgly/background-removal@1.0.6/dist/5fd9e75c3bb1f31c2207.wasm"},48:_r=>{_r.exports="https://unpkg.com/@imgly/background-removal@1.0.6/dist/deea8254622ca47c4771.wasm"},884:_r=>{_r.exports="https://unpkg.com/@imgly/background-removal@1.0.6/dist/9f4d6e330a4b1cebd316.wasm"},342:_r=>{_r.exports="https://unpkg.com/@imgly/background-removal@1.0.6/dist/eac818d9d05525e8f209.wasm"},393:_r=>{_r.exports="https://unpkg.com/@imgly/background-removal@1.0.6/dist/c285eb5377ad8280cf32.wasm"}},__webpack_module_cache__={};function __webpack_require__(_r){var Tr=__webpack_module_cache__[_r];if(Tr!==void 0)return Tr.exports;var Ar=__webpack_module_cache__[_r]={id:_r,loaded:!1,exports:{}};return __webpack_modules__[_r].call(Ar.exports,Ar,Ar.exports,__webpack_require__),Ar.loaded=!0,Ar.exports}__webpack_require__.d=(_r,Tr)=>{for(var Ar in Tr)__webpack_require__.o(Tr,Ar)&&!__webpack_require__.o(_r,Ar)&&Object.defineProperty(_r,Ar,{enumerable:!0,get:Tr[Ar]})},__webpack_require__.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),__webpack_require__.o=(_r,Tr)=>Object.prototype.hasOwnProperty.call(_r,Tr),__webpack_require__.nmd=_r=>(_r.paths=[],_r.children||(_r.children=[]),_r);var __webpack_exports__={};(()=>{function _r(ms,os,us,Ss){return new(us||(us=Promise))(function(ss,bs){function _s(Ms){try{As(Ss.next(Ms))}catch(Vs){bs(Vs)}}function Es(Ms){try{As(Ss.throw(Ms))}catch(Vs){bs(Vs)}}function As(Ms){var Vs;Ms.done?ss(Ms.value):(Vs=Ms.value,Vs instanceof us?Vs:new us(function(so){so(Vs)})).then(_s,Es)}As((Ss=Ss.apply(ms,os||[])).next())})}function Tr(ms,os){var us,Ss,ss,bs,_s={label:0,sent:function(){if(1&ss[0])throw ss[1];return ss[1]},trys:[],ops:[]};return bs={next:Es(0),throw:Es(1),return:Es(2)},typeof Symbol=="function"&&(bs[Symbol.iterator]=function(){return this}),bs;function Es(As){return function(Ms){return function(Vs){if(us)throw new TypeError("Generator is already executing.");for(;bs&&(bs=0,Vs[0]&&(_s=0)),_s;)try{if(us=1,Ss&&(ss=2&Vs[0]?Ss.return:Vs[0]?Ss.throw||((ss=Ss.return)&&ss.call(Ss),0):Ss.next)&&!(ss=ss.call(Ss,Vs[1])).done)return ss;switch(Ss=0,ss&&(Vs=[2&Vs[0],ss.value]),Vs[0]){case 0:case 1:ss=Vs;break;case 4:return _s.label++,{value:Vs[1],done:!1};case 5:_s.label++,Ss=Vs[1],Vs=[0];continue;case 7:Vs=_s.ops.pop(),_s.trys.pop();continue;default:if(!((ss=(ss=_s.trys).length>0&&ss[ss.length-1])||Vs[0]!==6&&Vs[0]!==2)){_s=0;continue}if(Vs[0]===3&&(!ss||Vs[1]>ss[0]&&Vs[1]<ss[3])){_s.label=Vs[1];break}if(Vs[0]===6&&_s.label<ss[1]){_s.label=ss[1],ss=Vs;break}if(ss&&_s.label<ss[2]){_s.label=ss[2],_s.ops.push(Vs);break}ss[2]&&_s.ops.pop(),_s.trys.pop();continue}Vs=os.call(ms,_s)}catch(so){Vs=[6,so],Ss=0}finally{us=ss=0}if(5&Vs[0])throw Vs[1];return{value:Vs[0]?Vs[1]:void 0,done:!0}}([As,Ms])}}}function Ar(ms){return _r(this,void 0,void 0,function(){return Tr(this,function(os){switch(os.label){case 0:return[4,createImageBitmap(ms)];case 1:return[2,Pr(os.sent())]}})})}function Rr(ms,os,us){return os===void 0&&(os=.8),us===void 0&&(us="image/png"),_r(this,void 0,void 0,function(){var Ss;return Tr(this,function(ss){return(Ss=new OffscreenCanvas(ms.width,ms.height)).getContext("2d").putImageData(ms,0,0),[2,Ss.convertToBlob({quality:os,type:us})]})})}function Pr(ms){var os=new OffscreenCanvas(ms.width,ms.height),us=os.getContext("2d");return us.drawImage(ms,0,0),us.getImageData(0,0,os.width,os.height)}function Dr(ms,os,us){return _r(this,void 0,void 0,function(){return Tr(this,function(Ss){switch(Ss.label){case 0:return[4,createImageBitmap(ms,{resizeWidth:os,resizeHeight:us,resizeQuality:"high",premultiplyAlpha:"premultiply"})];case 1:return[2,Pr(Ss.sent())]}})})}function Mr(ms){return function(os){return new RegExp("^(?:[a-z+]+:)?//","i").test(os)}(ms)?ms:new URL(ms,window.location.href).href}function Fr(ms){return _r(this,void 0,void 0,function(){return Tr(this,function(os){switch(os.label){case 0:return typeof ms=="string"&&(ms=Mr(ms),ms=new URL(ms)),ms instanceof URL?[4,fetch(ms,{})]:[3,3];case 1:return[4,os.sent().blob()];case 2:ms=os.sent(),os.label=3;case 3:return(ms instanceof ArrayBuffer||ArrayBuffer.isView(ms))&&(ms=new Blob([ms])),ms instanceof Blob?[4,Ar(ms)]:[3,5];case 4:ms=os.sent(),os.label=5;case 5:return[2,ms]}})})}function zr(ms,os,us,Ss){return _r(this,void 0,void 0,function(){var ss,bs,_s,Es,As,Ms,Vs,so,_o,Ao,Go,Oo,Zo,Ko,Wo,No;return Tr(this,function(Fo){switch(Fo.label){case 0:return os.progress&&os.progress("compute:inference",0,1),ss=1024,bs=ms.width,_s=ms.height,Es=[1,3,ss,ss],[4,Dr(ms,ss,ss)];case 1:return As=Fo.sent(),Ms=function(Hl,Rl,Ql){Rl===void 0&&(Rl=[128,128,128]),Ql===void 0&&(Ql=[256,256,256]);for(var Wl=Hl.data,pu=Hl.width*Hl.height,du=new Float32Array(3*pu),wu=0,ou=0;wu<Wl.length;wu+=4,ou+=1)du[ou]=(Wl[wu]-Rl[0])/Ql[0],du[ou+pu]=(Wl[wu+1]-Rl[1])/Ql[1],du[ou+pu+pu]=(Wl[wu+2]-Rl[2])/Ql[2];return du}(As),[4,us.runSession(Ss,[["input",{data:Ms,shape:Es,dataType:"float32"}]],["output"])];case 2:for(Vs=Fo.sent(),so=ss*ss,_o=0;_o<4*so;_o+=4)Ao=_o/4,Go=Vs[0].data[Ao],As.data[_o+3]=255*Go;return Bo=ms.width,Qo=ms.height,jo=ss/Bo,_a=ss/Qo,_l=Math.min(jo,_a),Oo=[Math.floor(Bo*_l),Math.floor(Qo*_l)],Zo=Oo[0],Ko=Oo[1],Wo=Math.min(Zo,bs),No=Math.min(Ko,_s),[4,Dr(As,Wo,No)];case 3:return As=Fo.sent(),os.progress&&os.progress("compute:inference",1,1),[2,As]}var Bo,Qo,jo,_a,_l})})}var jr,Gr;__webpack_require__.d(__webpack_exports__,{Z:()=>Us}),typeof SuppressedError=="function"&&SuppressedError,function(ms){ms.assertEqual=os=>os,ms.assertIs=function(os){},ms.assertNever=function(os){throw new Error},ms.arrayToEnum=os=>{const us={};for(const Ss of os)us[Ss]=Ss;return us},ms.getValidEnumValues=os=>{const us=ms.objectKeys(os).filter(ss=>typeof os[os[ss]]!="number"),Ss={};for(const ss of us)Ss[ss]=os[ss];return ms.objectValues(Ss)},ms.objectValues=os=>ms.objectKeys(os).map(function(us){return os[us]}),ms.objectKeys=typeof Object.keys=="function"?os=>Object.keys(os):os=>{const us=[];for(const Ss in os)Object.prototype.hasOwnProperty.call(os,Ss)&&us.push(Ss);return us},ms.find=(os,us)=>{for(const Ss of os)if(us(Ss))return Ss},ms.isInteger=typeof Number.isInteger=="function"?os=>Number.isInteger(os):os=>typeof os=="number"&&isFinite(os)&&Math.floor(os)===os,ms.joinValues=function(os,us=" | "){return os.map(Ss=>typeof Ss=="string"?`'${Ss}'`:Ss).join(us)},ms.jsonStringifyReplacer=(os,us)=>typeof us=="bigint"?us.toString():us}(jr||(jr={})),function(ms){ms.mergeShapes=(os,us)=>({...os,...us})}(Gr||(Gr={}));const Nr=jr.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Lr=ms=>{switch(typeof ms){case"undefined":return Nr.undefined;case"string":return Nr.string;case"number":return isNaN(ms)?Nr.nan:Nr.number;case"boolean":return Nr.boolean;case"function":return Nr.function;case"bigint":return Nr.bigint;case"symbol":return Nr.symbol;case"object":return Array.isArray(ms)?Nr.array:ms===null?Nr.null:ms.then&&typeof ms.then=="function"&&ms.catch&&typeof ms.catch=="function"?Nr.promise:typeof Map<"u"&&ms instanceof Map?Nr.map:typeof Set<"u"&&ms instanceof Set?Nr.set:typeof Date<"u"&&ms instanceof Date?Nr.date:Nr.object;default:return Nr.unknown}},Ur=jr.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class Vr extends Error{constructor(os){super(),this.issues=[],this.addIssue=Ss=>{this.issues=[...this.issues,Ss]},this.addIssues=(Ss=[])=>{this.issues=[...this.issues,...Ss]};const us=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,us):this.__proto__=us,this.name="ZodError",this.issues=os}get errors(){return this.issues}format(os){const us=os||function(bs){return bs.message},Ss={_errors:[]},ss=bs=>{for(const _s of bs.issues)if(_s.code==="invalid_union")_s.unionErrors.map(ss);else if(_s.code==="invalid_return_type")ss(_s.returnTypeError);else if(_s.code==="invalid_arguments")ss(_s.argumentsError);else if(_s.path.length===0)Ss._errors.push(us(_s));else{let Es=Ss,As=0;for(;As<_s.path.length;){const Ms=_s.path[As];As===_s.path.length-1?(Es[Ms]=Es[Ms]||{_errors:[]},Es[Ms]._errors.push(us(_s))):Es[Ms]=Es[Ms]||{_errors:[]},Es=Es[Ms],As++}}};return ss(this),Ss}toString(){return this.message}get message(){return JSON.stringify(this.issues,jr.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(os=us=>us.message){const us={},Ss=[];for(const ss of this.issues)ss.path.length>0?(us[ss.path[0]]=us[ss.path[0]]||[],us[ss.path[0]].push(os(ss))):Ss.push(os(ss));return{formErrors:Ss,fieldErrors:us}}get formErrors(){return this.flatten()}}Vr.create=ms=>new Vr(ms);const Wr=(ms,os)=>{let us;switch(ms.code){case Ur.invalid_type:us=ms.received===Nr.undefined?"Required":`Expected ${ms.expected}, received ${ms.received}`;break;case Ur.invalid_literal:us=`Invalid literal value, expected ${JSON.stringify(ms.expected,jr.jsonStringifyReplacer)}`;break;case Ur.unrecognized_keys:us=`Unrecognized key(s) in object: ${jr.joinValues(ms.keys,", ")}`;break;case Ur.invalid_union:us="Invalid input";break;case Ur.invalid_union_discriminator:us=`Invalid discriminator value. Expected ${jr.joinValues(ms.options)}`;break;case Ur.invalid_enum_value:us=`Invalid enum value. Expected ${jr.joinValues(ms.options)}, received '${ms.received}'`;break;case Ur.invalid_arguments:us="Invalid function arguments";break;case Ur.invalid_return_type:us="Invalid function return type";break;case Ur.invalid_date:us="Invalid date";break;case Ur.invalid_string:typeof ms.validation=="object"?"includes"in ms.validation?(us=`Invalid input: must include "${ms.validation.includes}"`,typeof ms.validation.position=="number"&&(us=`${us} at one or more positions greater than or equal to ${ms.validation.position}`)):"startsWith"in ms.validation?us=`Invalid input: must start with "${ms.validation.startsWith}"`:"endsWith"in ms.validation?us=`Invalid input: must end with "${ms.validation.endsWith}"`:jr.assertNever(ms.validation):us=ms.validation!=="regex"?`Invalid ${ms.validation}`:"Invalid";break;case Ur.too_small:us=ms.type==="array"?`Array must contain ${ms.exact?"exactly":ms.inclusive?"at least":"more than"} ${ms.minimum} element(s)`:ms.type==="string"?`String must contain ${ms.exact?"exactly":ms.inclusive?"at least":"over"} ${ms.minimum} character(s)`:ms.type==="number"?`Number must be ${ms.exact?"exactly equal to ":ms.inclusive?"greater than or equal to ":"greater than "}${ms.minimum}`:ms.type==="date"?`Date must be ${ms.exact?"exactly equal to ":ms.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(ms.minimum))}`:"Invalid input";break;case Ur.too_big:us=ms.type==="array"?`Array must contain ${ms.exact?"exactly":ms.inclusive?"at most":"less than"} ${ms.maximum} element(s)`:ms.type==="string"?`String must contain ${ms.exact?"exactly":ms.inclusive?"at most":"under"} ${ms.maximum} character(s)`:ms.type==="number"?`Number must be ${ms.exact?"exactly":ms.inclusive?"less than or equal to":"less than"} ${ms.maximum}`:ms.type==="bigint"?`BigInt must be ${ms.exact?"exactly":ms.inclusive?"less than or equal to":"less than"} ${ms.maximum}`:ms.type==="date"?`Date must be ${ms.exact?"exactly":ms.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(ms.maximum))}`:"Invalid input";break;case Ur.custom:us="Invalid input";break;case Ur.invalid_intersection_types:us="Intersection results could not be merged";break;case Ur.not_multiple_of:us=`Number must be a multiple of ${ms.multipleOf}`;break;case Ur.not_finite:us="Number must be finite";break;default:us=os.defaultError,jr.assertNever(ms)}return{message:us}};let qr=Wr;function Kr(){return qr}const Xr=ms=>{const{data:os,path:us,errorMaps:Ss,issueData:ss}=ms,bs=[...us,...ss.path||[]],_s={...ss,path:bs};let Es="";const As=Ss.filter(Ms=>!!Ms).slice().reverse();for(const Ms of As)Es=Ms(_s,{data:os,defaultError:Es}).message;return{...ss,path:bs,message:ss.message||Es}};function Zr(ms,os){const us=Xr({issueData:os,data:ms.data,path:ms.path,errorMaps:[ms.common.contextualErrorMap,ms.schemaErrorMap,Kr(),Wr].filter(Ss=>!!Ss)});ms.common.issues.push(us)}class _i{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(os,us){const Ss=[];for(const ss of us){if(ss.status==="aborted")return Jr;ss.status==="dirty"&&os.dirty(),Ss.push(ss.value)}return{status:os.value,value:Ss}}static async mergeObjectAsync(os,us){const Ss=[];for(const ss of us)Ss.push({key:await ss.key,value:await ss.value});return _i.mergeObjectSync(os,Ss)}static mergeObjectSync(os,us){const Ss={};for(const ss of us){const{key:bs,value:_s}=ss;if(bs.status==="aborted"||_s.status==="aborted")return Jr;bs.status==="dirty"&&os.dirty(),_s.status==="dirty"&&os.dirty(),(_s.value!==void 0||ss.alwaysSet)&&(Ss[bs.value]=_s.value)}return{status:os.value,value:Ss}}}const Jr=Object.freeze({status:"aborted"}),es=ms=>({status:"dirty",value:ms}),ts=ms=>({status:"valid",value:ms}),is=ms=>ms.status==="aborted",rs=ms=>ms.status==="dirty",as=ms=>ms.status==="valid",ls=ms=>typeof Promise<"u"&&ms instanceof Promise;var fs;(function(ms){ms.errToObj=os=>typeof os=="string"?{message:os}:os||{},ms.toString=os=>typeof os=="string"?os:os==null?void 0:os.message})(fs||(fs={}));class Ts{constructor(os,us,Ss,ss){this._cachedPath=[],this.parent=os,this.data=us,this._path=Ss,this._key=ss}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const $s=(ms,os)=>{if(as(os))return{success:!0,data:os.value};if(!ms.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const us=new Vr(ms.common.issues);return this._error=us,this._error}}};function xs(ms){if(!ms)return{};const{errorMap:os,invalid_type_error:us,required_error:Ss,description:ss}=ms;if(os&&(us||Ss))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return os?{errorMap:os,description:ss}:{errorMap:(bs,_s)=>bs.code!=="invalid_type"?{message:_s.defaultError}:_s.data===void 0?{message:Ss??_s.defaultError}:{message:us??_s.defaultError},description:ss}}class ys{constructor(os){this.spa=this.safeParseAsync,this._def=os,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(os){return Lr(os.data)}_getOrReturnCtx(os,us){return us||{common:os.parent.common,data:os.data,parsedType:Lr(os.data),schemaErrorMap:this._def.errorMap,path:os.path,parent:os.parent}}_processInputParams(os){return{status:new _i,ctx:{common:os.parent.common,data:os.data,parsedType:Lr(os.data),schemaErrorMap:this._def.errorMap,path:os.path,parent:os.parent}}}_parseSync(os){const us=this._parse(os);if(ls(us))throw new Error("Synchronous parse encountered promise.");return us}_parseAsync(os){const us=this._parse(os);return Promise.resolve(us)}parse(os,us){const Ss=this.safeParse(os,us);if(Ss.success)return Ss.data;throw Ss.error}safeParse(os,us){var Ss;const ss={common:{issues:[],async:(Ss=us==null?void 0:us.async)!==null&&Ss!==void 0&&Ss,contextualErrorMap:us==null?void 0:us.errorMap},path:(us==null?void 0:us.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:os,parsedType:Lr(os)},bs=this._parseSync({data:os,path:ss.path,parent:ss});return $s(ss,bs)}async parseAsync(os,us){const Ss=await this.safeParseAsync(os,us);if(Ss.success)return Ss.data;throw Ss.error}async safeParseAsync(os,us){const Ss={common:{issues:[],contextualErrorMap:us==null?void 0:us.errorMap,async:!0},path:(us==null?void 0:us.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:os,parsedType:Lr(os)},ss=this._parse({data:os,path:Ss.path,parent:Ss}),bs=await(ls(ss)?ss:Promise.resolve(ss));return $s(Ss,bs)}refine(os,us){const Ss=ss=>typeof us=="string"||us===void 0?{message:us}:typeof us=="function"?us(ss):us;return this._refinement((ss,bs)=>{const _s=os(ss),Es=()=>bs.addIssue({code:Ur.custom,...Ss(ss)});return typeof Promise<"u"&&_s instanceof Promise?_s.then(As=>!!As||(Es(),!1)):!!_s||(Es(),!1)})}refinement(os,us){return this._refinement((Ss,ss)=>!!os(Ss)||(ss.addIssue(typeof us=="function"?us(Ss,ss):us),!1))}_refinement(os){return new Ps({schema:this,typeName:xo.ZodEffects,effect:{type:"refinement",refinement:os}})}superRefine(os){return this._refinement(os)}optional(){return ks.create(this,this._def)}nullable(){return Zs.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ko.create(this,this._def)}promise(){return hs.create(this,this._def)}or(os){return Ho.create([this,os],this._def)}and(os){return Xo.create(this,os,this._def)}transform(os){return new Ps({...xs(this._def),schema:this,typeName:xo.ZodEffects,effect:{type:"transform",transform:os}})}default(os){const us=typeof os=="function"?os:()=>os;return new bo({...xs(this._def),innerType:this,defaultValue:us,typeName:xo.ZodDefault})}brand(){return new qo({typeName:xo.ZodBranded,type:this,...xs(this._def)})}catch(os){const us=typeof os=="function"?os:()=>os;return new ho({...xs(this._def),innerType:this,catchValue:us,typeName:xo.ZodCatch})}describe(os){return new this.constructor({...this._def,description:os})}pipe(os){return zo.create(this,os)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const ps=/^c[^\s-]{8,}$/i,vs=/^[a-z][a-z0-9]*$/,Ds=/[0-9A-HJKMNP-TV-Z]{26}/,js=/^([a-f0-9]{8}-[a-f0-9]{4}-[1-5][a-f0-9]{3}-[a-f0-9]{4}-[a-f0-9]{12}|00000000-0000-0000-0000-000000000000)$/i,zs=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\])|(\[IPv6:(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))\])|([A-Za-z0-9]([A-Za-z0-9-]*[A-Za-z0-9])*(\.[A-Za-z]{2,})+))$/,qs=/^(\p{Extended_Pictographic}|\p{Emoji_Component})+$/u,fo=/^(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))$/,Qs=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/;class no extends ys{constructor(){super(...arguments),this._regex=(os,us,Ss)=>this.refinement(ss=>os.test(ss),{validation:us,code:Ur.invalid_string,...fs.errToObj(Ss)}),this.nonempty=os=>this.min(1,fs.errToObj(os)),this.trim=()=>new no({...this._def,checks:[...this._def.checks,{kind:"trim"}]}),this.toLowerCase=()=>new no({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]}),this.toUpperCase=()=>new no({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}_parse(os){if(this._def.coerce&&(os.data=String(os.data)),this._getType(os)!==Nr.string){const Es=this._getOrReturnCtx(os);return Zr(Es,{code:Ur.invalid_type,expected:Nr.string,received:Es.parsedType}),Jr}const us=new _i;let Ss;for(const Es of this._def.checks)if(Es.kind==="min")os.data.length<Es.value&&(Ss=this._getOrReturnCtx(os,Ss),Zr(Ss,{code:Ur.too_small,minimum:Es.value,type:"string",inclusive:!0,exact:!1,message:Es.message}),us.dirty());else if(Es.kind==="max")os.data.length>Es.value&&(Ss=this._getOrReturnCtx(os,Ss),Zr(Ss,{code:Ur.too_big,maximum:Es.value,type:"string",inclusive:!0,exact:!1,message:Es.message}),us.dirty());else if(Es.kind==="length"){const As=os.data.length>Es.value,Ms=os.data.length<Es.value;(As||Ms)&&(Ss=this._getOrReturnCtx(os,Ss),As?Zr(Ss,{code:Ur.too_big,maximum:Es.value,type:"string",inclusive:!0,exact:!0,message:Es.message}):Ms&&Zr(Ss,{code:Ur.too_small,minimum:Es.value,type:"string",inclusive:!0,exact:!0,message:Es.message}),us.dirty())}else if(Es.kind==="email")zs.test(os.data)||(Ss=this._getOrReturnCtx(os,Ss),Zr(Ss,{validation:"email",code:Ur.invalid_string,message:Es.message}),us.dirty());else if(Es.kind==="emoji")qs.test(os.data)||(Ss=this._getOrReturnCtx(os,Ss),Zr(Ss,{validation:"emoji",code:Ur.invalid_string,message:Es.message}),us.dirty());else if(Es.kind==="uuid")js.test(os.data)||(Ss=this._getOrReturnCtx(os,Ss),Zr(Ss,{validation:"uuid",code:Ur.invalid_string,message:Es.message}),us.dirty());else if(Es.kind==="cuid")ps.test(os.data)||(Ss=this._getOrReturnCtx(os,Ss),Zr(Ss,{validation:"cuid",code:Ur.invalid_string,message:Es.message}),us.dirty());else if(Es.kind==="cuid2")vs.test(os.data)||(Ss=this._getOrReturnCtx(os,Ss),Zr(Ss,{validation:"cuid2",code:Ur.invalid_string,message:Es.message}),us.dirty());else if(Es.kind==="ulid")Ds.test(os.data)||(Ss=this._getOrReturnCtx(os,Ss),Zr(Ss,{validation:"ulid",code:Ur.invalid_string,message:Es.message}),us.dirty());else if(Es.kind==="url")try{new URL(os.data)}catch{Ss=this._getOrReturnCtx(os,Ss),Zr(Ss,{validation:"url",code:Ur.invalid_string,message:Es.message}),us.dirty()}else Es.kind==="regex"?(Es.regex.lastIndex=0,Es.regex.test(os.data)||(Ss=this._getOrReturnCtx(os,Ss),Zr(Ss,{validation:"regex",code:Ur.invalid_string,message:Es.message}),us.dirty())):Es.kind==="trim"?os.data=os.data.trim():Es.kind==="includes"?os.data.includes(Es.value,Es.position)||(Ss=this._getOrReturnCtx(os,Ss),Zr(Ss,{code:Ur.invalid_string,validation:{includes:Es.value,position:Es.position},message:Es.message}),us.dirty()):Es.kind==="toLowerCase"?os.data=os.data.toLowerCase():Es.kind==="toUpperCase"?os.data=os.data.toUpperCase():Es.kind==="startsWith"?os.data.startsWith(Es.value)||(Ss=this._getOrReturnCtx(os,Ss),Zr(Ss,{code:Ur.invalid_string,validation:{startsWith:Es.value},message:Es.message}),us.dirty()):Es.kind==="endsWith"?os.data.endsWith(Es.value)||(Ss=this._getOrReturnCtx(os,Ss),Zr(Ss,{code:Ur.invalid_string,validation:{endsWith:Es.value},message:Es.message}),us.dirty()):Es.kind==="datetime"?((_s=Es).precision?_s.offset?new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${_s.precision}}(([+-]\\d{2}(:?\\d{2})?)|Z)$`):new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${_s.precision}}Z$`):_s.precision===0?_s.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}Z$"):_s.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?Z$")).test(os.data)||(Ss=this._getOrReturnCtx(os,Ss),Zr(Ss,{code:Ur.invalid_string,validation:"datetime",message:Es.message}),us.dirty()):Es.kind==="ip"?(ss=os.data,((bs=Es.version)!=="v4"&&bs||!fo.test(ss))&&(bs!=="v6"&&bs||!Qs.test(ss))&&(Ss=this._getOrReturnCtx(os,Ss),Zr(Ss,{validation:"ip",code:Ur.invalid_string,message:Es.message}),us.dirty())):jr.assertNever(Es);var ss,bs,_s;return{status:us.value,value:os.data}}_addCheck(os){return new no({...this._def,checks:[...this._def.checks,os]})}email(os){return this._addCheck({kind:"email",...fs.errToObj(os)})}url(os){return this._addCheck({kind:"url",...fs.errToObj(os)})}emoji(os){return this._addCheck({kind:"emoji",...fs.errToObj(os)})}uuid(os){return this._addCheck({kind:"uuid",...fs.errToObj(os)})}cuid(os){return this._addCheck({kind:"cuid",...fs.errToObj(os)})}cuid2(os){return this._addCheck({kind:"cuid2",...fs.errToObj(os)})}ulid(os){return this._addCheck({kind:"ulid",...fs.errToObj(os)})}ip(os){return this._addCheck({kind:"ip",...fs.errToObj(os)})}datetime(os){var us;return typeof os=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,message:os}):this._addCheck({kind:"datetime",precision:(os==null?void 0:os.precision)===void 0?null:os==null?void 0:os.precision,offset:(us=os==null?void 0:os.offset)!==null&&us!==void 0&&us,...fs.errToObj(os==null?void 0:os.message)})}regex(os,us){return this._addCheck({kind:"regex",regex:os,...fs.errToObj(us)})}includes(os,us){return this._addCheck({kind:"includes",value:os,position:us==null?void 0:us.position,...fs.errToObj(us==null?void 0:us.message)})}startsWith(os,us){return this._addCheck({kind:"startsWith",value:os,...fs.errToObj(us)})}endsWith(os,us){return this._addCheck({kind:"endsWith",value:os,...fs.errToObj(us)})}min(os,us){return this._addCheck({kind:"min",value:os,...fs.errToObj(us)})}max(os,us){return this._addCheck({kind:"max",value:os,...fs.errToObj(us)})}length(os,us){return this._addCheck({kind:"length",value:os,...fs.errToObj(us)})}get isDatetime(){return!!this._def.checks.find(os=>os.kind==="datetime")}get isEmail(){return!!this._def.checks.find(os=>os.kind==="email")}get isURL(){return!!this._def.checks.find(os=>os.kind==="url")}get isEmoji(){return!!this._def.checks.find(os=>os.kind==="emoji")}get isUUID(){return!!this._def.checks.find(os=>os.kind==="uuid")}get isCUID(){return!!this._def.checks.find(os=>os.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(os=>os.kind==="cuid2")}get isULID(){return!!this._def.checks.find(os=>os.kind==="ulid")}get isIP(){return!!this._def.checks.find(os=>os.kind==="ip")}get minLength(){let os=null;for(const us of this._def.checks)us.kind==="min"&&(os===null||us.value>os)&&(os=us.value);return os}get maxLength(){let os=null;for(const us of this._def.checks)us.kind==="max"&&(os===null||us.value<os)&&(os=us.value);return os}}function yo(ms,os){const us=(ms.toString().split(".")[1]||"").length,Ss=(os.toString().split(".")[1]||"").length,ss=us>Ss?us:Ss;return parseInt(ms.toFixed(ss).replace(".",""))%parseInt(os.toFixed(ss).replace(".",""))/Math.pow(10,ss)}no.create=ms=>{var os;return new no({checks:[],typeName:xo.ZodString,coerce:(os=ms==null?void 0:ms.coerce)!==null&&os!==void 0&&os,...xs(ms)})};class Js extends ys{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(os){if(this._def.coerce&&(os.data=Number(os.data)),this._getType(os)!==Nr.number){const ss=this._getOrReturnCtx(os);return Zr(ss,{code:Ur.invalid_type,expected:Nr.number,received:ss.parsedType}),Jr}let us;const Ss=new _i;for(const ss of this._def.checks)ss.kind==="int"?jr.isInteger(os.data)||(us=this._getOrReturnCtx(os,us),Zr(us,{code:Ur.invalid_type,expected:"integer",received:"float",message:ss.message}),Ss.dirty()):ss.kind==="min"?(ss.inclusive?os.data<ss.value:os.data<=ss.value)&&(us=this._getOrReturnCtx(os,us),Zr(us,{code:Ur.too_small,minimum:ss.value,type:"number",inclusive:ss.inclusive,exact:!1,message:ss.message}),Ss.dirty()):ss.kind==="max"?(ss.inclusive?os.data>ss.value:os.data>=ss.value)&&(us=this._getOrReturnCtx(os,us),Zr(us,{code:Ur.too_big,maximum:ss.value,type:"number",inclusive:ss.inclusive,exact:!1,message:ss.message}),Ss.dirty()):ss.kind==="multipleOf"?yo(os.data,ss.value)!==0&&(us=this._getOrReturnCtx(os,us),Zr(us,{code:Ur.not_multiple_of,multipleOf:ss.value,message:ss.message}),Ss.dirty()):ss.kind==="finite"?Number.isFinite(os.data)||(us=this._getOrReturnCtx(os,us),Zr(us,{code:Ur.not_finite,message:ss.message}),Ss.dirty()):jr.assertNever(ss);return{status:Ss.value,value:os.data}}gte(os,us){return this.setLimit("min",os,!0,fs.toString(us))}gt(os,us){return this.setLimit("min",os,!1,fs.toString(us))}lte(os,us){return this.setLimit("max",os,!0,fs.toString(us))}lt(os,us){return this.setLimit("max",os,!1,fs.toString(us))}setLimit(os,us,Ss,ss){return new Js({...this._def,checks:[...this._def.checks,{kind:os,value:us,inclusive:Ss,message:fs.toString(ss)}]})}_addCheck(os){return new Js({...this._def,checks:[...this._def.checks,os]})}int(os){return this._addCheck({kind:"int",message:fs.toString(os)})}positive(os){return this._addCheck({kind:"min",value:0,inclusive:!1,message:fs.toString(os)})}negative(os){return this._addCheck({kind:"max",value:0,inclusive:!1,message:fs.toString(os)})}nonpositive(os){return this._addCheck({kind:"max",value:0,inclusive:!0,message:fs.toString(os)})}nonnegative(os){return this._addCheck({kind:"min",value:0,inclusive:!0,message:fs.toString(os)})}multipleOf(os,us){return this._addCheck({kind:"multipleOf",value:os,message:fs.toString(us)})}finite(os){return this._addCheck({kind:"finite",message:fs.toString(os)})}safe(os){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:fs.toString(os)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:fs.toString(os)})}get minValue(){let os=null;for(const us of this._def.checks)us.kind==="min"&&(os===null||us.value>os)&&(os=us.value);return os}get maxValue(){let os=null;for(const us of this._def.checks)us.kind==="max"&&(os===null||us.value<os)&&(os=us.value);return os}get isInt(){return!!this._def.checks.find(os=>os.kind==="int"||os.kind==="multipleOf"&&jr.isInteger(os.value))}get isFinite(){let os=null,us=null;for(const Ss of this._def.checks){if(Ss.kind==="finite"||Ss.kind==="int"||Ss.kind==="multipleOf")return!0;Ss.kind==="min"?(us===null||Ss.value>us)&&(us=Ss.value):Ss.kind==="max"&&(os===null||Ss.value<os)&&(os=Ss.value)}return Number.isFinite(us)&&Number.isFinite(os)}}Js.create=ms=>new Js({checks:[],typeName:xo.ZodNumber,coerce:(ms==null?void 0:ms.coerce)||!1,...xs(ms)});class lo extends ys{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(os){if(this._def.coerce&&(os.data=BigInt(os.data)),this._getType(os)!==Nr.bigint){const ss=this._getOrReturnCtx(os);return Zr(ss,{code:Ur.invalid_type,expected:Nr.bigint,received:ss.parsedType}),Jr}let us;const Ss=new _i;for(const ss of this._def.checks)ss.kind==="min"?(ss.inclusive?os.data<ss.value:os.data<=ss.value)&&(us=this._getOrReturnCtx(os,us),Zr(us,{code:Ur.too_small,type:"bigint",minimum:ss.value,inclusive:ss.inclusive,message:ss.message}),Ss.dirty()):ss.kind==="max"?(ss.inclusive?os.data>ss.value:os.data>=ss.value)&&(us=this._getOrReturnCtx(os,us),Zr(us,{code:Ur.too_big,type:"bigint",maximum:ss.value,inclusive:ss.inclusive,message:ss.message}),Ss.dirty()):ss.kind==="multipleOf"?os.data%ss.value!==BigInt(0)&&(us=this._getOrReturnCtx(os,us),Zr(us,{code:Ur.not_multiple_of,multipleOf:ss.value,message:ss.message}),Ss.dirty()):jr.assertNever(ss);return{status:Ss.value,value:os.data}}gte(os,us){return this.setLimit("min",os,!0,fs.toString(us))}gt(os,us){return this.setLimit("min",os,!1,fs.toString(us))}lte(os,us){return this.setLimit("max",os,!0,fs.toString(us))}lt(os,us){return this.setLimit("max",os,!1,fs.toString(us))}setLimit(os,us,Ss,ss){return new lo({...this._def,checks:[...this._def.checks,{kind:os,value:us,inclusive:Ss,message:fs.toString(ss)}]})}_addCheck(os){return new lo({...this._def,checks:[...this._def.checks,os]})}positive(os){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:fs.toString(os)})}negative(os){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:fs.toString(os)})}nonpositive(os){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:fs.toString(os)})}nonnegative(os){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:fs.toString(os)})}multipleOf(os,us){return this._addCheck({kind:"multipleOf",value:os,message:fs.toString(us)})}get minValue(){let os=null;for(const us of this._def.checks)us.kind==="min"&&(os===null||us.value>os)&&(os=us.value);return os}get maxValue(){let os=null;for(const us of this._def.checks)us.kind==="max"&&(os===null||us.value<os)&&(os=us.value);return os}}lo.create=ms=>{var os;return new lo({checks:[],typeName:xo.ZodBigInt,coerce:(os=ms==null?void 0:ms.coerce)!==null&&os!==void 0&&os,...xs(ms)})};class vo extends ys{_parse(os){if(this._def.coerce&&(os.data=!!os.data),this._getType(os)!==Nr.boolean){const us=this._getOrReturnCtx(os);return Zr(us,{code:Ur.invalid_type,expected:Nr.boolean,received:us.parsedType}),Jr}return ts(os.data)}}vo.create=ms=>new vo({typeName:xo.ZodBoolean,coerce:(ms==null?void 0:ms.coerce)||!1,...xs(ms)});class Ro extends ys{_parse(os){if(this._def.coerce&&(os.data=new Date(os.data)),this._getType(os)!==Nr.date){const ss=this._getOrReturnCtx(os);return Zr(ss,{code:Ur.invalid_type,expected:Nr.date,received:ss.parsedType}),Jr}if(isNaN(os.data.getTime()))return Zr(this._getOrReturnCtx(os),{code:Ur.invalid_date}),Jr;const us=new _i;let Ss;for(const ss of this._def.checks)ss.kind==="min"?os.data.getTime()<ss.value&&(Ss=this._getOrReturnCtx(os,Ss),Zr(Ss,{code:Ur.too_small,message:ss.message,inclusive:!0,exact:!1,minimum:ss.value,type:"date"}),us.dirty()):ss.kind==="max"?os.data.getTime()>ss.value&&(Ss=this._getOrReturnCtx(os,Ss),Zr(Ss,{code:Ur.too_big,message:ss.message,inclusive:!0,exact:!1,maximum:ss.value,type:"date"}),us.dirty()):jr.assertNever(ss);return{status:us.value,value:new Date(os.data.getTime())}}_addCheck(os){return new Ro({...this._def,checks:[...this._def.checks,os]})}min(os,us){return this._addCheck({kind:"min",value:os.getTime(),message:fs.toString(us)})}max(os,us){return this._addCheck({kind:"max",value:os.getTime(),message:fs.toString(us)})}get minDate(){let os=null;for(const us of this._def.checks)us.kind==="min"&&(os===null||us.value>os)&&(os=us.value);return os!=null?new Date(os):null}get maxDate(){let os=null;for(const us of this._def.checks)us.kind==="max"&&(os===null||us.value<os)&&(os=us.value);return os!=null?new Date(os):null}}Ro.create=ms=>new Ro({checks:[],coerce:(ms==null?void 0:ms.coerce)||!1,typeName:xo.ZodDate,...xs(ms)});class Co extends ys{_parse(os){if(this._getType(os)!==Nr.symbol){const us=this._getOrReturnCtx(os);return Zr(us,{code:Ur.invalid_type,expected:Nr.symbol,received:us.parsedType}),Jr}return ts(os.data)}}Co.create=ms=>new Co({typeName:xo.ZodSymbol,...xs(ms)});class Do extends ys{_parse(os){if(this._getType(os)!==Nr.undefined){const us=this._getOrReturnCtx(os);return Zr(us,{code:Ur.invalid_type,expected:Nr.undefined,received:us.parsedType}),Jr}return ts(os.data)}}Do.create=ms=>new Do({typeName:xo.ZodUndefined,...xs(ms)});class ds extends ys{_parse(os){if(this._getType(os)!==Nr.null){const us=this._getOrReturnCtx(os);return Zr(us,{code:Ur.invalid_type,expected:Nr.null,received:us.parsedType}),Jr}return ts(os.data)}}ds.create=ms=>new ds({typeName:xo.ZodNull,...xs(ms)});class Os extends ys{constructor(){super(...arguments),this._any=!0}_parse(os){return ts(os.data)}}Os.create=ms=>new Os({typeName:xo.ZodAny,...xs(ms)});class Ws extends ys{constructor(){super(...arguments),this._unknown=!0}_parse(os){return ts(os.data)}}Ws.create=ms=>new Ws({typeName:xo.ZodUnknown,...xs(ms)});class to extends ys{_parse(os){const us=this._getOrReturnCtx(os);return Zr(us,{code:Ur.invalid_type,expected:Nr.never,received:us.parsedType}),Jr}}to.create=ms=>new to({typeName:xo.ZodNever,...xs(ms)});class io extends ys{_parse(os){if(this._getType(os)!==Nr.undefined){const us=this._getOrReturnCtx(os);return Zr(us,{code:Ur.invalid_type,expected:Nr.void,received:us.parsedType}),Jr}return ts(os.data)}}io.create=ms=>new io({typeName:xo.ZodVoid,...xs(ms)});class ko extends ys{_parse(os){const{ctx:us,status:Ss}=this._processInputParams(os),ss=this._def;if(us.parsedType!==Nr.array)return Zr(us,{code:Ur.invalid_type,expected:Nr.array,received:us.parsedType}),Jr;if(ss.exactLength!==null){const _s=us.data.length>ss.exactLength.value,Es=us.data.length<ss.exactLength.value;(_s||Es)&&(Zr(us,{code:_s?Ur.too_big:Ur.too_small,minimum:Es?ss.exactLength.value:void 0,maximum:_s?ss.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:ss.exactLength.message}),Ss.dirty())}if(ss.minLength!==null&&us.data.length<ss.minLength.value&&(Zr(us,{code:Ur.too_small,minimum:ss.minLength.value,type:"array",inclusive:!0,exact:!1,message:ss.minLength.message}),Ss.dirty()),ss.maxLength!==null&&us.data.length>ss.maxLength.value&&(Zr(us,{code:Ur.too_big,maximum:ss.maxLength.value,type:"array",inclusive:!0,exact:!1,message:ss.maxLength.message}),Ss.dirty()),us.common.async)return Promise.all([...us.data].map((_s,Es)=>ss.type._parseAsync(new Ts(us,_s,us.path,Es)))).then(_s=>_i.mergeArray(Ss,_s));const bs=[...us.data].map((_s,Es)=>ss.type._parseSync(new Ts(us,_s,us.path,Es)));return _i.mergeArray(Ss,bs)}get element(){return this._def.type}min(os,us){return new ko({...this._def,minLength:{value:os,message:fs.toString(us)}})}max(os,us){return new ko({...this._def,maxLength:{value:os,message:fs.toString(us)}})}length(os,us){return new ko({...this._def,exactLength:{value:os,message:fs.toString(us)}})}nonempty(os){return this.min(1,os)}}function go(ms){if(ms instanceof To){const os={};for(const us in ms.shape){const Ss=ms.shape[us];os[us]=ks.create(go(Ss))}return new To({...ms._def,shape:()=>os})}return ms instanceof ko?new ko({...ms._def,type:go(ms.element)}):ms instanceof ks?ks.create(go(ms.unwrap())):ms instanceof Zs?Zs.create(go(ms.unwrap())):ms instanceof El?El.create(ms.items.map(os=>go(os))):ms}ko.create=(ms,os)=>new ko({type:ms,minLength:null,maxLength:null,exactLength:null,typeName:xo.ZodArray,...xs(os)});class To extends ys{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const os=this._def.shape(),us=jr.objectKeys(os);return this._cached={shape:os,keys:us}}_parse(os){if(this._getType(os)!==Nr.object){const As=this._getOrReturnCtx(os);return Zr(As,{code:Ur.invalid_type,expected:Nr.object,received:As.parsedType}),Jr}const{status:us,ctx:Ss}=this._processInputParams(os),{shape:ss,keys:bs}=this._getCached(),_s=[];if(!(this._def.catchall instanceof to&&this._def.unknownKeys==="strip"))for(const As in Ss.data)bs.includes(As)||_s.push(As);const Es=[];for(const As of bs){const Ms=ss[As],Vs=Ss.data[As];Es.push({key:{status:"valid",value:As},value:Ms._parse(new Ts(Ss,Vs,Ss.path,As)),alwaysSet:As in Ss.data})}if(this._def.catchall instanceof to){const As=this._def.unknownKeys;if(As==="passthrough")for(const Ms of _s)Es.push({key:{status:"valid",value:Ms},value:{status:"valid",value:Ss.data[Ms]}});else if(As==="strict")_s.length>0&&(Zr(Ss,{code:Ur.unrecognized_keys,keys:_s}),us.dirty());else if(As!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const As=this._def.catchall;for(const Ms of _s){const Vs=Ss.data[Ms];Es.push({key:{status:"valid",value:Ms},value:As._parse(new Ts(Ss,Vs,Ss.path,Ms)),alwaysSet:Ms in Ss.data})}}return Ss.common.async?Promise.resolve().then(async()=>{const As=[];for(const Ms of Es){const Vs=await Ms.key;As.push({key:Vs,value:await Ms.value,alwaysSet:Ms.alwaysSet})}return As}).then(As=>_i.mergeObjectSync(us,As)):_i.mergeObjectSync(us,Es)}get shape(){return this._def.shape()}strict(os){return fs.errToObj,new To({...this._def,unknownKeys:"strict",...os!==void 0?{errorMap:(us,Ss)=>{var ss,bs,_s,Es;const As=(_s=(bs=(ss=this._def).errorMap)===null||bs===void 0?void 0:bs.call(ss,us,Ss).message)!==null&&_s!==void 0?_s:Ss.defaultError;return us.code==="unrecognized_keys"?{message:(Es=fs.errToObj(os).message)!==null&&Es!==void 0?Es:As}:{message:As}}}:{}})}strip(){return new To({...this._def,unknownKeys:"strip"})}passthrough(){return new To({...this._def,unknownKeys:"passthrough"})}extend(os){return new To({...this._def,shape:()=>({...this._def.shape(),...os})})}merge(os){return new To({unknownKeys:os._def.unknownKeys,catchall:os._def.catchall,shape:()=>({...this._def.shape(),...os._def.shape()}),typeName:xo.ZodObject})}setKey(os,us){return this.augment({[os]:us})}catchall(os){return new To({...this._def,catchall:os})}pick(os){const us={};return jr.objectKeys(os).forEach(Ss=>{os[Ss]&&this.shape[Ss]&&(us[Ss]=this.shape[Ss])}),new To({...this._def,shape:()=>us})}omit(os){const us={};return jr.objectKeys(this.shape).forEach(Ss=>{os[Ss]||(us[Ss]=this.shape[Ss])}),new To({...this._def,shape:()=>us})}deepPartial(){return go(this)}partial(os){const us={};return jr.objectKeys(this.shape).forEach(Ss=>{const ss=this.shape[Ss];os&&!os[Ss]?us[Ss]=ss:us[Ss]=ss.optional()}),new To({...this._def,shape:()=>us})}required(os){const us={};return jr.objectKeys(this.shape).forEach(Ss=>{if(os&&!os[Ss])us[Ss]=this.shape[Ss];else{let ss=this.shape[Ss];for(;ss instanceof ks;)ss=ss._def.innerType;us[Ss]=ss}}),new To({...this._def,shape:()=>us})}keyof(){return Fs(jr.objectKeys(this.shape))}}To.create=(ms,os)=>new To({shape:()=>ms,unknownKeys:"strip",catchall:to.create(),typeName:xo.ZodObject,...xs(os)}),To.strictCreate=(ms,os)=>new To({shape:()=>ms,unknownKeys:"strict",catchall:to.create(),typeName:xo.ZodObject,...xs(os)}),To.lazycreate=(ms,os)=>new To({shape:ms,unknownKeys:"strip",catchall:to.create(),typeName:xo.ZodObject,...xs(os)});class Ho extends ys{_parse(os){const{ctx:us}=this._processInputParams(os),Ss=this._def.options;if(us.common.async)return Promise.all(Ss.map(async ss=>{const bs={...us,common:{...us.common,issues:[]},parent:null};return{result:await ss._parseAsync({data:us.data,path:us.path,parent:bs}),ctx:bs}})).then(function(ss){for(const _s of ss)if(_s.result.status==="valid")return _s.result;for(const _s of ss)if(_s.result.status==="dirty")return us.common.issues.push(..._s.ctx.common.issues),_s.result;const bs=ss.map(_s=>new Vr(_s.ctx.common.issues));return Zr(us,{code:Ur.invalid_union,unionErrors:bs}),Jr});{let ss;const bs=[];for(const Es of Ss){const As={...us,common:{...us.common,issues:[]},parent:null},Ms=Es._parseSync({data:us.data,path:us.path,parent:As});if(Ms.status==="valid")return Ms;Ms.status!=="dirty"||ss||(ss={result:Ms,ctx:As}),As.common.issues.length&&bs.push(As.common.issues)}if(ss)return us.common.issues.push(...ss.ctx.common.issues),ss.result;const _s=bs.map(Es=>new Vr(Es));return Zr(us,{code:Ur.invalid_union,unionErrors:_s}),Jr}}get options(){return this._def.options}}Ho.create=(ms,os)=>new Ho({options:ms,typeName:xo.ZodUnion,...xs(os)});const Uo=ms=>ms instanceof vu?Uo(ms.schema):ms instanceof Ps?Uo(ms.innerType()):ms instanceof Vo?[ms.value]:ms instanceof Ks?ms.options:ms instanceof gs?Object.keys(ms.enum):ms instanceof bo?Uo(ms._def.innerType):ms instanceof Do?[void 0]:ms instanceof ds?[null]:null;class Io extends ys{_parse(os){const{ctx:us}=this._processInputParams(os);if(us.parsedType!==Nr.object)return Zr(us,{code:Ur.invalid_type,expected:Nr.object,received:us.parsedType}),Jr;const Ss=this.discriminator,ss=us.data[Ss],bs=this.optionsMap.get(ss);return bs?us.common.async?bs._parseAsync({data:us.data,path:us.path,parent:us}):bs._parseSync({data:us.data,path:us.path,parent:us}):(Zr(us,{code:Ur.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[Ss]}),Jr)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(os,us,Ss){const ss=new Map;for(const bs of us){const _s=Uo(bs.shape[os]);if(!_s)throw new Error(`A discriminator value for key \`${os}\` could not be extracted from all schema options`);for(const Es of _s){if(ss.has(Es))throw new Error(`Discriminator property ${String(os)} has duplicate value ${String(Es)}`);ss.set(Es,bs)}}return new Io({typeName:xo.ZodDiscriminatedUnion,discriminator:os,options:us,optionsMap:ss,...xs(Ss)})}}function xl(ms,os){const us=Lr(ms),Ss=Lr(os);if(ms===os)return{valid:!0,data:ms};if(us===Nr.object&&Ss===Nr.object){const ss=jr.objectKeys(os),bs=jr.objectKeys(ms).filter(Es=>ss.indexOf(Es)!==-1),_s={...ms,...os};for(const Es of bs){const As=xl(ms[Es],os[Es]);if(!As.valid)return{valid:!1};_s[Es]=As.data}return{valid:!0,data:_s}}if(us===Nr.array&&Ss===Nr.array){if(ms.length!==os.length)return{valid:!1};const ss=[];for(let bs=0;bs<ms.length;bs++){const _s=xl(ms[bs],os[bs]);if(!_s.valid)return{valid:!1};ss.push(_s.data)}return{valid:!0,data:ss}}return us===Nr.date&&Ss===Nr.date&&+ms==+os?{valid:!0,data:ms}:{valid:!1}}class Xo extends ys{_parse(os){const{status:us,ctx:Ss}=this._processInputParams(os),ss=(bs,_s)=>{if(is(bs)||is(_s))return Jr;const Es=xl(bs.value,_s.value);return Es.valid?((rs(bs)||rs(_s))&&us.dirty(),{status:us.value,value:Es.data}):(Zr(Ss,{code:Ur.invalid_intersection_types}),Jr)};return Ss.common.async?Promise.all([this._def.left._parseAsync({data:Ss.data,path:Ss.path,parent:Ss}),this._def.right._parseAsync({data:Ss.data,path:Ss.path,parent:Ss})]).then(([bs,_s])=>ss(bs,_s)):ss(this._def.left._parseSync({data:Ss.data,path:Ss.path,parent:Ss}),this._def.right._parseSync({data:Ss.data,path:Ss.path,parent:Ss}))}}Xo.create=(ms,os,us)=>new Xo({left:ms,right:os,typeName:xo.ZodIntersection,...xs(us)});class El extends ys{_parse(os){const{status:us,ctx:Ss}=this._processInputParams(os);if(Ss.parsedType!==Nr.array)return Zr(Ss,{code:Ur.invalid_type,expected:Nr.array,received:Ss.parsedType}),Jr;if(Ss.data.length<this._def.items.length)return Zr(Ss,{code:Ur.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Jr;!this._def.rest&&Ss.data.length>this._def.items.length&&(Zr(Ss,{code:Ur.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),us.dirty());const ss=[...Ss.data].map((bs,_s)=>{const Es=this._def.items[_s]||this._def.rest;return Es?Es._parse(new Ts(Ss,bs,Ss.path,_s)):null}).filter(bs=>!!bs);return Ss.common.async?Promise.all(ss).then(bs=>_i.mergeArray(us,bs)):_i.mergeArray(us,ss)}get items(){return this._def.items}rest(os){return new El({...this._def,rest:os})}}El.create=(ms,os)=>{if(!Array.isArray(ms))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new El({items:ms,typeName:xo.ZodTuple,rest:null,...xs(os)})};class Dl extends ys{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(os){const{status:us,ctx:Ss}=this._processInputParams(os);if(Ss.parsedType!==Nr.object)return Zr(Ss,{code:Ur.invalid_type,expected:Nr.object,received:Ss.parsedType}),Jr;const ss=[],bs=this._def.keyType,_s=this._def.valueType;for(const Es in Ss.data)ss.push({key:bs._parse(new Ts(Ss,Es,Ss.path,Es)),value:_s._parse(new Ts(Ss,Ss.data[Es],Ss.path,Es))});return Ss.common.async?_i.mergeObjectAsync(us,ss):_i.mergeObjectSync(us,ss)}get element(){return this._def.valueType}static create(os,us,Ss){return new Dl(us instanceof ys?{keyType:os,valueType:us,typeName:xo.ZodRecord,...xs(Ss)}:{keyType:no.create(),valueType:os,typeName:xo.ZodRecord,...xs(us)})}}class ru extends ys{_parse(os){const{status:us,ctx:Ss}=this._processInputParams(os);if(Ss.parsedType!==Nr.map)return Zr(Ss,{code:Ur.invalid_type,expected:Nr.map,received:Ss.parsedType}),Jr;const ss=this._def.keyType,bs=this._def.valueType,_s=[...Ss.data.entries()].map(([Es,As],Ms)=>({key:ss._parse(new Ts(Ss,Es,Ss.path,[Ms,"key"])),value:bs._parse(new Ts(Ss,As,Ss.path,[Ms,"value"]))}));if(Ss.common.async){const Es=new Map;return Promise.resolve().then(async()=>{for(const As of _s){const Ms=await As.key,Vs=await As.value;if(Ms.status==="aborted"||Vs.status==="aborted")return Jr;Ms.status!=="dirty"&&Vs.status!=="dirty"||us.dirty(),Es.set(Ms.value,Vs.value)}return{status:us.value,value:Es}})}{const Es=new Map;for(const As of _s){const Ms=As.key,Vs=As.value;if(Ms.status==="aborted"||Vs.status==="aborted")return Jr;Ms.status!=="dirty"&&Vs.status!=="dirty"||us.dirty(),Es.set(Ms.value,Vs.value)}return{status:us.value,value:Es}}}}ru.create=(ms,os,us)=>new ru({valueType:os,keyType:ms,typeName:xo.ZodMap,...xs(us)});class Ul extends ys{_parse(os){const{status:us,ctx:Ss}=this._processInputParams(os);if(Ss.parsedType!==Nr.set)return Zr(Ss,{code:Ur.invalid_type,expected:Nr.set,received:Ss.parsedType}),Jr;const ss=this._def;ss.minSize!==null&&Ss.data.size<ss.minSize.value&&(Zr(Ss,{code:Ur.too_small,minimum:ss.minSize.value,type:"set",inclusive:!0,exact:!1,message:ss.minSize.message}),us.dirty()),ss.maxSize!==null&&Ss.data.size>ss.maxSize.value&&(Zr(Ss,{code:Ur.too_big,maximum:ss.maxSize.value,type:"set",inclusive:!0,exact:!1,message:ss.maxSize.message}),us.dirty());const bs=this._def.valueType;function _s(As){const Ms=new Set;for(const Vs of As){if(Vs.status==="aborted")return Jr;Vs.status==="dirty"&&us.dirty(),Ms.add(Vs.value)}return{status:us.value,value:Ms}}const Es=[...Ss.data.values()].map((As,Ms)=>bs._parse(new Ts(Ss,As,Ss.path,Ms)));return Ss.common.async?Promise.all(Es).then(As=>_s(As)):_s(Es)}min(os,us){return new Ul({...this._def,minSize:{value:os,message:fs.toString(us)}})}max(os,us){return new Ul({...this._def,maxSize:{value:os,message:fs.toString(us)}})}size(os,us){return this.min(os,us).max(os,us)}nonempty(os){return this.min(1,os)}}Ul.create=(ms,os)=>new Ul({valueType:ms,minSize:null,maxSize:null,typeName:xo.ZodSet,...xs(os)});class Kl extends ys{constructor(){super(...arguments),this.validate=this.implement}_parse(os){const{ctx:us}=this._processInputParams(os);if(us.parsedType!==Nr.function)return Zr(us,{code:Ur.invalid_type,expected:Nr.function,received:us.parsedType}),Jr;function Ss(Es,As){return Xr({data:Es,path:us.path,errorMaps:[us.common.contextualErrorMap,us.schemaErrorMap,Kr(),Wr].filter(Ms=>!!Ms),issueData:{code:Ur.invalid_arguments,argumentsError:As}})}function ss(Es,As){return Xr({data:Es,path:us.path,errorMaps:[us.common.contextualErrorMap,us.schemaErrorMap,Kr(),Wr].filter(Ms=>!!Ms),issueData:{code:Ur.invalid_return_type,returnTypeError:As}})}const bs={errorMap:us.common.contextualErrorMap},_s=us.data;return this._def.returns instanceof hs?ts(async(...Es)=>{const As=new Vr([]),Ms=await this._def.args.parseAsync(Es,bs).catch(so=>{throw As.addIssue(Ss(Es,so)),As}),Vs=await _s(...Ms);return await this._def.returns._def.type.parseAsync(Vs,bs).catch(so=>{throw As.addIssue(ss(Vs,so)),As})}):ts((...Es)=>{const As=this._def.args.safeParse(Es,bs);if(!As.success)throw new Vr([Ss(Es,As.error)]);const Ms=_s(...As.data),Vs=this._def.returns.safeParse(Ms,bs);if(!Vs.success)throw new Vr([ss(Ms,Vs.error)]);return Vs.data})}parameters(){return this._def.args}returnType(){return this._def.returns}args(...os){return new Kl({...this._def,args:El.create(os).rest(Ws.create())})}returns(os){return new Kl({...this._def,returns:os})}implement(os){return this.parse(os)}strictImplement(os){return this.parse(os)}static create(os,us,Ss){return new Kl({args:os||El.create([]).rest(Ws.create()),returns:us||Ws.create(),typeName:xo.ZodFunction,...xs(Ss)})}}class vu extends ys{get schema(){return this._def.getter()}_parse(os){const{ctx:us}=this._processInputParams(os);return this._def.getter()._parse({data:us.data,path:us.path,parent:us})}}vu.create=(ms,os)=>new vu({getter:ms,typeName:xo.ZodLazy,...xs(os)});class Vo extends ys{_parse(os){if(os.data!==this._def.value){const us=this._getOrReturnCtx(os);return Zr(us,{received:us.data,code:Ur.invalid_literal,expected:this._def.value}),Jr}return{status:"valid",value:os.data}}get value(){return this._def.value}}function Fs(ms,os){return new Ks({values:ms,typeName:xo.ZodEnum,...xs(os)})}Vo.create=(ms,os)=>new Vo({value:ms,typeName:xo.ZodLiteral,...xs(os)});class Ks extends ys{_parse(os){if(typeof os.data!="string"){const us=this._getOrReturnCtx(os),Ss=this._def.values;return Zr(us,{expected:jr.joinValues(Ss),received:us.parsedType,code:Ur.invalid_type}),Jr}if(this._def.values.indexOf(os.data)===-1){const us=this._getOrReturnCtx(os),Ss=this._def.values;return Zr(us,{received:us.data,code:Ur.invalid_enum_value,options:Ss}),Jr}return ts(os.data)}get options(){return this._def.values}get enum(){const os={};for(const us of this._def.values)os[us]=us;return os}get Values(){const os={};for(const us of this._def.values)os[us]=us;return os}get Enum(){const os={};for(const us of this._def.values)os[us]=us;return os}extract(os){return Ks.create(os)}exclude(os){return Ks.create(this.options.filter(us=>!os.includes(us)))}}Ks.create=Fs;class gs extends ys{_parse(os){const us=jr.getValidEnumValues(this._def.values),Ss=this._getOrReturnCtx(os);if(Ss.parsedType!==Nr.string&&Ss.parsedType!==Nr.number){const ss=jr.objectValues(us);return Zr(Ss,{expected:jr.joinValues(ss),received:Ss.parsedType,code:Ur.invalid_type}),Jr}if(us.indexOf(os.data)===-1){const ss=jr.objectValues(us);return Zr(Ss,{received:Ss.data,code:Ur.invalid_enum_value,options:ss}),Jr}return ts(os.data)}get enum(){return this._def.values}}gs.create=(ms,os)=>new gs({values:ms,typeName:xo.ZodNativeEnum,...xs(os)});class hs extends ys{unwrap(){return this._def.type}_parse(os){const{ctx:us}=this._processInputParams(os);if(us.parsedType!==Nr.promise&&us.common.async===!1)return Zr(us,{code:Ur.invalid_type,expected:Nr.promise,received:us.parsedType}),Jr;const Ss=us.parsedType===Nr.promise?us.data:Promise.resolve(us.data);return ts(Ss.then(ss=>this._def.type.parseAsync(ss,{path:us.path,errorMap:us.common.contextualErrorMap})))}}hs.create=(ms,os)=>new hs({type:ms,typeName:xo.ZodPromise,...xs(os)});class Ps extends ys{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===xo.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(os){const{status:us,ctx:Ss}=this._processInputParams(os),ss=this._def.effect||null;if(ss.type==="preprocess"){const _s=ss.transform(Ss.data);return Ss.common.async?Promise.resolve(_s).then(Es=>this._def.schema._parseAsync({data:Es,path:Ss.path,parent:Ss})):this._def.schema._parseSync({data:_s,path:Ss.path,parent:Ss})}const bs={addIssue:_s=>{Zr(Ss,_s),_s.fatal?us.abort():us.dirty()},get path(){return Ss.path}};if(bs.addIssue=bs.addIssue.bind(bs),ss.type==="refinement"){const _s=Es=>{const As=ss.refinement(Es,bs);if(Ss.common.async)return Promise.resolve(As);if(As instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return Es};if(Ss.common.async===!1){const Es=this._def.schema._parseSync({data:Ss.data,path:Ss.path,parent:Ss});return Es.status==="aborted"?Jr:(Es.status==="dirty"&&us.dirty(),_s(Es.value),{status:us.value,value:Es.value})}return this._def.schema._parseAsync({data:Ss.data,path:Ss.path,parent:Ss}).then(Es=>Es.status==="aborted"?Jr:(Es.status==="dirty"&&us.dirty(),_s(Es.value).then(()=>({status:us.value,value:Es.value}))))}if(ss.type==="transform"){if(Ss.common.async===!1){const _s=this._def.schema._parseSync({data:Ss.data,path:Ss.path,parent:Ss});if(!as(_s))return _s;const Es=ss.transform(_s.value,bs);if(Es instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:us.value,value:Es}}return this._def.schema._parseAsync({data:Ss.data,path:Ss.path,parent:Ss}).then(_s=>as(_s)?Promise.resolve(ss.transform(_s.value,bs)).then(Es=>({status:us.value,value:Es})):_s)}jr.assertNever(ss)}}Ps.create=(ms,os,us)=>new Ps({schema:ms,typeName:xo.ZodEffects,effect:os,...xs(us)}),Ps.createWithPreprocess=(ms,os,us)=>new Ps({schema:os,effect:{type:"preprocess",transform:ms},typeName:xo.ZodEffects,...xs(us)});class ks extends ys{_parse(os){return this._getType(os)===Nr.undefined?ts(void 0):this._def.innerType._parse(os)}unwrap(){return this._def.innerType}}ks.create=(ms,os)=>new ks({innerType:ms,typeName:xo.ZodOptional,...xs(os)});class Zs extends ys{_parse(os){return this._getType(os)===Nr.null?ts(null):this._def.innerType._parse(os)}unwrap(){return this._def.innerType}}Zs.create=(ms,os)=>new Zs({innerType:ms,typeName:xo.ZodNullable,...xs(os)});class bo extends ys{_parse(os){const{ctx:us}=this._processInputParams(os);let Ss=us.data;return us.parsedType===Nr.undefined&&(Ss=this._def.defaultValue()),this._def.innerType._parse({data:Ss,path:us.path,parent:us})}removeDefault(){return this._def.innerType}}bo.create=(ms,os)=>new bo({innerType:ms,typeName:xo.ZodDefault,defaultValue:typeof os.default=="function"?os.default:()=>os.default,...xs(os)});class ho extends ys{_parse(os){const{ctx:us}=this._processInputParams(os),Ss={...us,common:{...us.common,issues:[]}},ss=this._def.innerType._parse({data:Ss.data,path:Ss.path,parent:{...Ss}});return ls(ss)?ss.then(bs=>({status:"valid",value:bs.status==="valid"?bs.value:this._def.catchValue({get error(){return new Vr(Ss.common.issues)},input:Ss.data})})):{status:"valid",value:ss.status==="valid"?ss.value:this._def.catchValue({get error(){return new Vr(Ss.common.issues)},input:Ss.data})}}removeCatch(){return this._def.innerType}}ho.create=(ms,os)=>new ho({innerType:ms,typeName:xo.ZodCatch,catchValue:typeof os.catch=="function"?os.catch:()=>os.catch,...xs(os)});class eo extends ys{_parse(os){if(this._getType(os)!==Nr.nan){const us=this._getOrReturnCtx(os);return Zr(us,{code:Ur.invalid_type,expected:Nr.nan,received:us.parsedType}),Jr}return{status:"valid",value:os.data}}}eo.create=ms=>new eo({typeName:xo.ZodNaN,...xs(ms)});const Po=Symbol("zod_brand");class qo extends ys{_parse(os){const{ctx:us}=this._processInputParams(os),Ss=us.data;return this._def.type._parse({data:Ss,path:us.path,parent:us})}unwrap(){return this._def.type}}class zo extends ys{_parse(os){const{status:us,ctx:Ss}=this._processInputParams(os);if(Ss.common.async)return(async()=>{const ss=await this._def.in._parseAsync({data:Ss.data,path:Ss.path,parent:Ss});return ss.status==="aborted"?Jr:ss.status==="dirty"?(us.dirty(),es(ss.value)):this._def.out._parseAsync({data:ss.value,path:Ss.path,parent:Ss})})();{const ss=this._def.in._parseSync({data:Ss.data,path:Ss.path,parent:Ss});return ss.status==="aborted"?Jr:ss.status==="dirty"?(us.dirty(),{status:"dirty",value:ss.value}):this._def.out._parseSync({data:ss.value,path:Ss.path,parent:Ss})}}static create(os,us){return new zo({in:os,out:us,typeName:xo.ZodPipeline})}}const Hs=(ms,os={},us)=>ms?Os.create().superRefine((Ss,ss)=>{var bs,_s;if(!ms(Ss)){const Es=typeof os=="function"?os(Ss):typeof os=="string"?{message:os}:os,As=(_s=(bs=Es.fatal)!==null&&bs!==void 0?bs:us)===null||_s===void 0||_s,Ms=typeof Es=="string"?{message:Es}:Es;ss.addIssue({code:"custom",...Ms,fatal:As})}}):Os.create(),wo={object:To.lazycreate};var xo;(function(ms){ms.ZodString="ZodString",ms.ZodNumber="ZodNumber",ms.ZodNaN="ZodNaN",ms.ZodBigInt="ZodBigInt",ms.ZodBoolean="ZodBoolean",ms.ZodDate="ZodDate",ms.ZodSymbol="ZodSymbol",ms.ZodUndefined="ZodUndefined",ms.ZodNull="ZodNull",ms.ZodAny="ZodAny",ms.ZodUnknown="ZodUnknown",ms.ZodNever="ZodNever",ms.ZodVoid="ZodVoid",ms.ZodArray="ZodArray",ms.ZodObject="ZodObject",ms.ZodUnion="ZodUnion",ms.ZodDiscriminatedUnion="ZodDiscriminatedUnion",ms.ZodIntersection="ZodIntersection",ms.ZodTuple="ZodTuple",ms.ZodRecord="ZodRecord",ms.ZodMap="ZodMap",ms.ZodSet="ZodSet",ms.ZodFunction="ZodFunction",ms.ZodLazy="ZodLazy",ms.ZodLiteral="ZodLiteral",ms.ZodEnum="ZodEnum",ms.ZodEffects="ZodEffects",ms.ZodNativeEnum="ZodNativeEnum",ms.ZodOptional="ZodOptional",ms.ZodNullable="ZodNullable",ms.ZodDefault="ZodDefault",ms.ZodCatch="ZodCatch",ms.ZodPromise="ZodPromise",ms.ZodBranded="ZodBranded",ms.ZodPipeline="ZodPipeline"})(xo||(xo={}));const Yl=no.create,xu=Js.create,ju=eo.create,_f=lo.create,zu=vo.create,_h=Ro.create,ep=Co.create,Ru=Do.create,Su=ds.create,lp=Os.create,cu=Ws.create,Ll=to.create,Vu=io.create,Ou=ko.create,tp=To.create,up=To.strictCreate,cp=Ho.create,dp=Io.create,Rp=Xo.create,Zu=El.create,fp=Dl.create,Qu=ru.create,Hu=Ul.create,Pl=Kl.create,hp=vu.create,Cp=Vo.create,Ip=Ks.create,Ml=gs.create,Fl=hs.create,Nu=Ps.create,pp=ks.create,gp=Zs.create,Fu=Ps.createWithPreprocess,Pp=zo.create;var iu=Object.freeze({__proto__:null,defaultErrorMap:Wr,setErrorMap:function(ms){qr=ms},getErrorMap:Kr,makeIssue:Xr,EMPTY_PATH:[],addIssueToContext:Zr,ParseStatus:_i,INVALID:Jr,DIRTY:es,OK:ts,isAborted:is,isDirty:rs,isValid:as,isAsync:ls,get util(){return jr},get objectUtil(){return Gr},ZodParsedType:Nr,getParsedType:Lr,ZodType:ys,ZodString:no,ZodNumber:Js,ZodBigInt:lo,ZodBoolean:vo,ZodDate:Ro,ZodSymbol:Co,ZodUndefined:Do,ZodNull:ds,ZodAny:Os,ZodUnknown:Ws,ZodNever:to,ZodVoid:io,ZodArray:ko,ZodObject:To,ZodUnion:Ho,ZodDiscriminatedUnion:Io,ZodIntersection:Xo,ZodTuple:El,ZodRecord:Dl,ZodMap:ru,ZodSet:Ul,ZodFunction:Kl,ZodLazy:vu,ZodLiteral:Vo,ZodEnum:Ks,ZodNativeEnum:gs,ZodPromise:hs,ZodEffects:Ps,ZodTransformer:Ps,ZodOptional:ks,ZodNullable:Zs,ZodDefault:bo,ZodCatch:ho,ZodNaN:eo,BRAND:Po,ZodBranded:qo,ZodPipeline:zo,custom:Hs,Schema:ys,ZodSchema:ys,late:wo,get ZodFirstPartyTypeKind(){return xo},coerce:{string:ms=>no.create({...ms,coerce:!0}),number:ms=>Js.create({...ms,coerce:!0}),boolean:ms=>vo.create({...ms,coerce:!0}),bigint:ms=>lo.create({...ms,coerce:!0}),date:ms=>Ro.create({...ms,coerce:!0})},any:lp,array:Ou,bigint:_f,boolean:zu,date:_h,discriminatedUnion:dp,effect:Nu,enum:Ip,function:Pl,instanceof:(ms,os={message:`Input not instance of ${ms.name}`})=>Hs(us=>us instanceof ms,os),intersection:Rp,lazy:hp,literal:Cp,map:Qu,nan:ju,nativeEnum:Ml,never:Ll,null:Su,nullable:gp,number:xu,object:tp,oboolean:()=>zu().optional(),onumber:()=>xu().optional(),optional:pp,ostring:()=>Yl().optional(),pipeline:Pp,preprocess:Fu,promise:Fl,record:fp,set:Hu,strictObject:up,string:Yl,symbol:ep,transformer:Nu,tuple:Zu,undefined:Ru,union:cp,unknown:cu,void:Vu,NEVER:Jr,ZodIssueCode:Ur,quotelessJson:ms=>JSON.stringify(ms,null,2).replace(/"([^"]+)":/g,"$1:"),ZodError:Vr}),yp=iu.object({publicPath:iu.string().optional().describe("The public path to the wasm files and the onnx model.").transform(function(ms){return ms&&Mr(ms)}),debug:iu.boolean().default(!1).describe("Whether to enable debug logging."),proxyToWorker:iu.boolean().default(!0).describe("Whether to proxy inference to a web worker."),fetchArgs:iu.object({}).default({}).describe("Arguments to pass to fetch when loading the model."),progress:iu.function().args(iu.string(),iu.number(),iu.number()).returns(iu.undefined()).describe("Progress callback.").optional(),model:iu.enum(["small","medium"]).default("medium")}).default({});const Ju=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11]));var Nl=__webpack_require__(793),zl=new Map([["small",{url:__webpack_require__(60),size:44342436,mime:"application/octet-stream"}],["medium",{url:__webpack_require__(920),size:88188479,mime:"application/octet-stream"}],["ort-wasm-simd-threaded.jsep.wasm",{url:__webpack_require__(111),size:18215132,mime:"application/wasm"}],["ort-wasm-simd.jsep.wasm",{url:__webpack_require__(48),size:16836274,mime:"application/wasm"}],["ort-wasm-simd-threaded.wasm",{url:__webpack_require__(965),size:10281838,mime:"application/wasm"}],["ort-wasm-simd.wasm",{url:__webpack_require__(884),size:10335238,mime:"application/wasm"}],["ort-wasm-threaded.wasm",{url:__webpack_require__(342),size:9413659,mime:"application/wasm"}],["ort-wasm.wasm",{url:__webpack_require__(393),size:9487920,mime:"application/wasm"}]]);function Eu(ms,os){return _r(this,void 0,void 0,function(){var us,Ss,ss,bs,_s;return Tr(this,function(Es){switch(Es.label){case 0:return us=zl.get(ms),Ss=us.url,os.publicPath&&(Ss=new URL(Ss.split("/").pop(),os.publicPath).toString()),[4,fetch(Ss,os.fetchArgs)];case 1:return ss=Es.sent(),os.progress?[4,Cs(ss,us,os,ms)]:[3,3];case 2:return bs=Es.sent(),[3,5];case 3:return[4,ss.blob()];case 4:bs=[Es.sent()],Es.label=5;case 5:if((_s=new Blob(bs,{type:us.mime})).size!==us.size)throw new Error("Failed to fetch ".concat(ms," with size ").concat(us.size," but got ").concat(_s.size));return[2,_s]}})})}function Cs(ms,os,us,Ss){var ss;return _r(this,void 0,void 0,function(){var bs,_s,Es,As,Ms,Vs,so;return Tr(this,function(_o){switch(_o.label){case 0:bs=ms.body.getReader(),_s=(ss=os.size)!==null&&ss!==void 0?ss:0,Es=0,As=[],_o.label=1;case 1:return[4,bs.read()];case 2:return Ms=_o.sent(),Vs=Ms.done,so=Ms.value,Vs?[3,3]:(As.push(so),Es+=so.length,us.progress&&us.progress("fetch:".concat(Ss),Es,_s),[3,1]);case 3:return[2,As]}})})}var Ls=__webpack_require__(486);const Us=function(ms,os){var us;return _r(this,void 0,void 0,function(){var Ss,ss,bs,_s;return Tr(this,function(Es){switch(Es.label){case 0:return[4,po(os)];case 1:return Ss=Es.sent(),ss=Ss.config,bs=Ss.imports,_s=Ss.session,ss.debug&&(ss.progress=(us=ss.progress)!==null&&us!==void 0?us:function(As,Ms,Vs){console.debug("Downloading ".concat(As,": ").concat(Ms," of ").concat(Vs))},crossOriginIsolated||console.debug("Cross-Origin-Isolated is not enabled. Performance will be degraded. Please see  https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/SharedArrayBuffer.")),[4,Fr(ms)];case 2:if(!((ms=Es.sent())instanceof ImageData))throw new Error("Image not an ImageData | ArrayBuffer | Uint8Array | Blob | URL | string");return[4,zr(ms,ss,bs,_s)];case 3:return[4,Rr(Es.sent())];case 4:return[2,Es.sent()]}})})};function Xs(ms,os){return _r(this,void 0,void 0,function(){var us;return Tr(this,function(Ss){switch(Ss.label){case 0:return ms.debug&&console.debug("Loading model..."),[4,Eu(ms.model,ms)];case 1:return[4,Ss.sent().arrayBuffer()];case 2:return us=Ss.sent(),[4,os.createSession(us)];case 3:return[2,Ss.sent()]}})})}var po=(0,Ls.memoize)(function(ms){return _r(this,void 0,void 0,function(){var os,us;return Tr(this,function(Ss){switch(Ss.label){case 0:return ms=function(ss){var bs=yp.parse(ss??{});return bs.debug&&console.log("Config:",bs),bs}(ms),os=function(ss){var bs=this;return{createSession:function(_s){return _r(bs,void 0,void 0,function(){var Es,As,Ms,Vs,so,_o,Ao,Go,Oo,Zo,Ko,Wo,No,Fo,Bo,Qo,jo,_a,_l;return Tr(this,function(Hl){switch(Hl.label){case 0:return jo={},[4,Ju()];case 1:return jo.simd=Hl.sent(),[4,(async Rl=>{try{return typeof MessageChannel<"u"&&new MessageChannel().port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(Rl)}catch{return!1}})(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]))];case 2:return jo.threads=Hl.sent(),jo.SharedArrayBuffer=typeof SharedArrayBuffer<"u",jo.numThreads=(_l=navigator.hardwareConcurrency)!==null&&_l!==void 0?_l:4,jo.webgpu=navigator.gpu!==void 0,Es=jo,ss.debug&&(console.debug("Capabilities:",Es),Nl.env.debug=!0,Nl.env.logLevel="verbose"),Nl.env.wasm.numThreads=Es.numThreads,Nl.env.wasm.simd=Es.simd,Nl.env.wasm.proxy=ss.proxyToWorker,As=Nl.env.wasm,_a={},Ms="ort-wasm-simd-threaded.wasm",so=(Vs=URL).createObjectURL,[4,Eu("ort-wasm-simd-threaded.wasm",ss)];case 3:return _a[Ms]=so.apply(Vs,[Hl.sent()]),_o="ort-wasm-simd.wasm",Go=(Ao=URL).createObjectURL,[4,Eu("ort-wasm-simd.wasm",ss)];case 4:return _a[_o]=Go.apply(Ao,[Hl.sent()]),Oo="ort-wasm-threaded.wasm",Ko=(Zo=URL).createObjectURL,[4,Eu("ort-wasm-threaded.wasm",ss)];case 5:return _a[Oo]=Ko.apply(Zo,[Hl.sent()]),Wo="ort-wasm.wasm",Fo=(No=URL).createObjectURL,[4,Eu("ort-wasm.wasm",ss)];case 6:return As.wasmPaths=(_a[Wo]=Fo.apply(No,[Hl.sent()]),_a),ss.debug&&console.debug("ort.env.wasm:",Nl.env.wasm),Bo={executionProviders:["wasm"],graphOptimizationLevel:"all",executionMode:"parallel",enableCpuMemArena:!0},[4,Nl.InferenceSession.create(_s,Bo).catch(function(Rl){throw new Error("Failed to create session: ".concat(Rl,". Please check if the publicPath is set correctly."))})];case 7:return Qo=Hl.sent(),URL.revokeObjectURL(Nl.env.wasm.wasmPaths["ort-wasm-simd-threaded.wasm"]),URL.revokeObjectURL(Nl.env.wasm.wasmPaths["ort-wasm-simd.wasm"]),URL.revokeObjectURL(Nl.env.wasm.wasmPaths["ort-wasm-threaded.wasm"]),URL.revokeObjectURL(Nl.env.wasm.wasmPaths["ort-wasm.wasm"]),[2,Qo]}})})},runSession:function(_s,Es,As){return _r(bs,void 0,void 0,function(){var Ms,Vs,so,_o,Ao,Go,Oo,Zo,Ko,Wo,No;return Tr(this,function(Fo){switch(Fo.label){case 0:for(Ms={},Vs=0,so=Es;Vs<so.length;Vs++)_o=so[Vs],Ko=_o[0],No=_o[1],Ms[Ko]=new Nl.Tensor("float32",new Float32Array(No.data),No.shape);return[4,_s.run(Ms,{})];case 1:for(Ao=Fo.sent(),Go=[],Oo=0,Zo=As;Oo<Zo.length;Oo++)Ko=Zo[Oo],Wo=Ao[Ko],No={data:Wo.data,shape:Wo.dims,dataType:"float32"},Go.push(No);return[2,Go]}})})}}}(ms),[4,Xs(ms,os)];case 1:return us=Ss.sent(),[2,{config:ms,imports:os,session:us}]}})})},function(ms){return JSON.stringify(ms)})})();var __webpack_exports__default=__webpack_exports__.Z;const config={model:"small",progress:(_r,Tr,Ar)=>{console.log(`Downloading ${_r}: ${Tr} of ${Ar}`)}};async function findIIIFImageURL(_r){try{const Tr=await fetch(_r);if(!Tr.ok)throw new Error(Tr.statusText);const Ar=await Tr.json();return"@type"in Ar?Ar["@type"]!="sc:Manifest"?(console.log("The JSON for this Manifest doesn't look like a Manifest. It should have either a @type of sc:Manifest but has a type of: "+Ar["@type"]),null):loadv2(Ar):"type"in Ar?Ar.type!="Manifest"?(console.log("The JSON for this Manifest doesn't look like a Manifest. It should have either a type of Manifest but has a type of: "+Ar.type),null):loadv3(Ar):(console.log("The JSON for this Manifest doesn't look like a Manifest. It should have either a @type or type value of Manifest"),null)}catch(Tr){return console.log("I was unable to get the Manifest you supplied due to: "+Tr),null}}function isObject(_r){return typeof _r=="object"&&!Array.isArray(_r)&&_r!==null}function loadv2(_r){var Tr,Ar,Rr;if("sequences"in _r){let Pr=_r.sequences;isObject(Pr)&&(Pr=[Pr]);let Dr=!1;for(const Mr of Pr)if("canvases"in Mr){Dr=!0;for(const Fr of Mr.canvases){const zr=(Rr=(Ar=(Tr=Fr.images[0])==null?void 0:Tr.resource)==null?void 0:Ar.service)==null?void 0:Rr["@id"];if(zr)return zr}}else Dr||console.log("The manifest you supplied contains no canvases so there are no images to show.")}else console.log("The manifest you supplied contains no sequence so there are no images to show.");return null}function loadv3(_r){if("items"in _r){const Tr=_r.items;for(const Ar of Tr){const Rr=Ar.items[0].items[0].body.service[0]["@id"];if(Rr)return Rr}}else console.log("The manifest you supplied contains no sequence so there are no images to show.");return null}function getStyle(_r,Tr){return parseFloat(window.getComputedStyle(_r).getPropertyValue(Tr))}function getImageSelectionData(_r,Tr){const Ar=Tr.width,Rr=Tr.height,Pr=1280;let Dr="full";const Mr="0",Fr="default",zr=".jpg",jr=document.getElementsByClassName("displayregioncontainer")[0],Gr=document.getElementsByClassName("displayregion")[0],Nr=Ar*jr.clientHeight/Rr,Lr=(jr.clientWidth-Nr)/2,Ur=Ar/Nr;console.log("Multiplier: ",Ur),console.log(`Image resolution (width, height): ${Ar},${Rr}`),console.log(`Canvas resolution (width, height): ${Nr},${jr.clientHeight}`);const Vr=9,Wr=getStyle(Gr,"left"),qr=getStyle(Gr,"top"),Kr=Math.round(Gr.clientWidth+Vr),Xr=Math.round(Gr.clientHeight+Vr);console.log(`Selection region (x, y, width, height): ${Wr},${qr},${Kr},${Xr}`);const Zr=Math.max(Math.round((Wr-Lr)*Ur),0),_i=Math.max(Math.round(qr*Ur),0),Jr=Math.min(Math.round(Kr*Ur),Ar),es=Math.min(Math.round(Xr*Ur),Rr);return Dr=`${Zr},${_i},${Jr},${es}`,console.log(`Calculated selection region (x, y, width, height): ${Zr},${_i},${Jr},${es}`),`${_r}/${Dr}/${Pr},/${Mr}/${Fr}${zr}`}const utils={bgRemoval:async _r=>{const Tr=Date.now();try{const Ar=await __webpack_exports__default(_r,config),Rr=URL.createObjectURL(Ar),Pr=(Date.now()-Tr)/1e3;return console.log("Duration for background removal: ",Pr),console.log("Object URL: ",Rr),Rr}catch(Ar){throw console.error(Ar),Ar}},getIIIFImageURL:async _r=>{try{return await findIIIFImageURL(_r)}catch(Tr){return console.error(Tr),null}},getCroppedImagePath:async _r=>{console.log("Image URL: ",_r);try{const Tr=_r+"/info.json",Ar=await fetch(Tr);if(!Ar.ok)throw new Error(Ar.statusText);const Rr=await Ar.json();return getImageSelectionData(_r,Rr)}catch(Tr){console.error(Tr)}}},options={informationPanel:{open:!1},openSeadragon:{loadTilesWithAjax:!0,showNavigationControl:!1},showTitle:!1,showZoomControl:!1};function CardPanel(){const[_r,Tr]=reactExports.useState(0),[Ar,Rr]=reactExports.useState([]),[Pr,Dr]=reactExports.useState(""),Mr=async Jr=>{try{const es=await utils.getIIIFImageURL(Jr);return console.log("Image URL: ",es),es}catch(es){return console.error("Error:",es),null}},Fr=async Jr=>{if(!Jr)return;const es=Jr.map(async rs=>{const as=await Mr(rs.iiif.value);return as!==null?{id:rs.work.value,name:rs.workLabel.value,year:rs.year.value,country:rs.countryLabel.value,location:rs.locationLabel.value,url:rs.iiif.value,image:as}:null}),is=(await Promise.all(es)).filter(rs=>rs!==null);console.log("Data elements: ",Jr),console.log("Data images: ",is),Rr(is)},zr=async()=>{try{const{data:Jr}=await axios$1.get(api.sparqlQuery());Fr(Jr.results.bindings)}catch(Jr){console.error(Jr)}};reactExports.useEffect(()=>{zr()},[]);const jr=reactExports.useRef(_r),Gr=reactExports.useMemo(()=>Array(Ar.length).fill(0).map(()=>reactExports.createRef()),[Ar]),Nr=Jr=>{Tr(Jr),jr.current=Jr},Lr=_r<Ar.length+1,Ur=_r>=0,Vr=Jr=>{Nr(Jr+1)},Wr=(Jr,es)=>{var ts;console.log(`${Jr} (${es}) left the screen!`,jr.current),jr.current>=es&&((ts=Gr[es].current)==null||ts.restoreCard())},qr=async Jr=>{var es;Ur&&_r<Ar.length&&await((es=Gr[_r].current)==null?void 0:es.swipe(Jr))},Kr=async()=>{var es;if(!Lr)return;const Jr=_r-1;Nr(Jr),await((es=Gr[Jr].current)==null?void 0:es.restoreCard())},Xr=Jr=>{Jr&&console.log("Active canvas ID: ",Jr)},Zr=async Jr=>{try{const es=await utils.getCroppedImagePath(Jr);console.log("Cropped image path: ",es),es&&_i(es)}catch(es){console.error("Error:",es)}},_i=async Jr=>{try{const es=await utils.bgRemoval(Jr);Dr(es),console.log("Resulting image URL: ",es)}catch(es){console.error("Error:",es)}};return jsxRuntimeExports.jsxs("div",{className:"cardWrapper",children:[jsxRuntimeExports.jsx("div",{className:"cardContainer",children:Ar.map(({id:Jr,name:es,year:ts,country:is,location:rs,url:as},ls)=>_r===ls&&jsxRuntimeExports.jsxs(TinderCard$1,{ref:Gr[ls],className:"swipe",onSwipe:()=>Vr(ls),onCardLeftScreen:()=>Wr(es,ls),children:[jsxRuntimeExports.jsx(Or,{iiifContent:as,options,canvasIdCallback:Xr}),jsxRuntimeExports.jsxs("h3",{className:"cardName",children:[es," (",ts,") - ",rs," ",is]})]},Jr))}),jsxRuntimeExports.jsxs("div",{className:"buttons",children:[jsxRuntimeExports.jsx("button",{onClick:()=>qr("left"),children:"Left"}),jsxRuntimeExports.jsx("button",{onClick:()=>Kr(),children:"Undo"}),jsxRuntimeExports.jsx("button",{onClick:()=>qr("right"),children:"Right"}),jsxRuntimeExports.jsx("button",{onClick:()=>Zr(Ar[_r].image),children:"Lift subject"}),Pr&&jsxRuntimeExports.jsx("img",{className:"image",src:Pr,alt:"Background Removed"})]})]})}function App(){return jsxRuntimeExports.jsxs("div",{className:"app",children:[jsxRuntimeExports.jsx("h1",{className:"neonText",children:"GLAMorouS Europe"}),jsxRuntimeExports.jsx(CardPanel,{})]})}const index="";client.createRoot(document.getElementById("root")).render(jsxRuntimeExports.jsx(React$1.StrictMode,{children:jsxRuntimeExports.jsx(App,{})}));
