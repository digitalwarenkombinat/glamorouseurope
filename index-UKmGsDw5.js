function h5(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const a in r)if(a!=="default"&&!(a in t)){const i=Object.getOwnPropertyDescriptor(r,a);i&&Object.defineProperty(t,a,i.get?i:{enumerable:!0,get:()=>r[a]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function e(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(r){if(r.ep)return;r.ep=!0;const a=e(r);fetch(r.href,a)}})();var ba=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function gi(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Lj(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var a=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,a.get?a:{enumerable:!0,get:function(){return t[r]}})}),n}var f5={exports:{}},k0={},g5={exports:{}},Et={};/**
* @license React
* react.production.min.js
*
* Copyright (c) Facebook, Inc. and its affiliates.
*
* This source code is licensed under the MIT license found in the
* LICENSE file in the root directory of this source tree.
*/var oh=Symbol.for("react.element"),Dj=Symbol.for("react.portal"),Fj=Symbol.for("react.fragment"),Bj=Symbol.for("react.strict_mode"),zj=Symbol.for("react.profiler"),jj=Symbol.for("react.provider"),Vj=Symbol.for("react.context"),Wj=Symbol.for("react.forward_ref"),Uj=Symbol.for("react.suspense"),Gj=Symbol.for("react.memo"),Hj=Symbol.for("react.lazy"),m5=Symbol.iterator;function qj(t){return t===null||typeof t!="object"?null:(t=m5&&t[m5]||t["@@iterator"],typeof t=="function"?t:null)}var y5={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b5=Object.assign,v5={};function jc(t,e,n){this.props=t,this.context=e,this.refs=v5,this.updater=n||y5}jc.prototype.isReactComponent={},jc.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")},jc.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function x5(){}x5.prototype=jc.prototype;function ok(t,e,n){this.props=t,this.context=e,this.refs=v5,this.updater=n||y5}var sk=ok.prototype=new x5;sk.constructor=ok,b5(sk,jc.prototype),sk.isPureReactComponent=!0;var w5=Array.isArray,k5=Object.prototype.hasOwnProperty,lk={current:null},S5={key:!0,ref:!0,__self:!0,__source:!0};function C5(t,e,n){var r,a={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)k5.call(e,r)&&!S5.hasOwnProperty(r)&&(a[r]=e[r]);var s=arguments.length-2;if(s===1)a.children=n;else if(1<s){for(var l=Array(s),u=0;u<s;u++)l[u]=arguments[u+2];a.children=l}if(t&&t.defaultProps)for(r in s=t.defaultProps,s)a[r]===void 0&&(a[r]=s[r]);return{$$typeof:oh,type:t,key:i,ref:o,props:a,_owner:lk.current}}function Kj(t,e){return{$$typeof:oh,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function uk(t){return typeof t=="object"&&t!==null&&t.$$typeof===oh}function Xj(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var N5=/\/+/g;function ck(t,e){return typeof t=="object"&&t!==null&&t.key!=null?Xj(""+t.key):e.toString(36)}function S0(t,e,n,r,a){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case oh:case Dj:o=!0}}if(o)return o=t,a=a(o),t=r===""?"."+ck(o,0):r,w5(a)?(n="",t!=null&&(n=t.replace(N5,"$&/")+"/"),S0(a,e,n,"",function(u){return u})):a!=null&&(uk(a)&&(a=Kj(a,n+(!a.key||o&&o.key===a.key?"":(""+a.key).replace(N5,"$&/")+"/")+t)),e.push(a)),1;if(o=0,r=r===""?".":r+":",w5(t))for(var s=0;s<t.length;s++){i=t[s];var l=r+ck(i,s);o+=S0(i,e,n,l,a)}else if(l=qj(t),typeof l=="function")for(t=l.call(t),s=0;!(i=t.next()).done;)i=i.value,l=r+ck(i,s++),o+=S0(i,e,n,l,a);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function C0(t,e,n){if(t==null)return t;var r=[],a=0;return S0(t,r,"","",function(i){return e.call(n,i,a++)}),r}function Yj(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var va={current:null},N0={transition:null},Qj={ReactCurrentDispatcher:va,ReactCurrentBatchConfig:N0,ReactCurrentOwner:lk};Et.Children={map:C0,forEach:function(t,e,n){C0(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return C0(t,function(){e++}),e},toArray:function(t){return C0(t,function(e){return e})||[]},only:function(t){if(!uk(t))throw Error("React.Children.only expected to receive a single React element child.");return t}},Et.Component=jc,Et.Fragment=Fj,Et.Profiler=zj,Et.PureComponent=ok,Et.StrictMode=Bj,Et.Suspense=Uj,Et.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Qj,Et.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=b5({},t.props),a=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=lk.current),e.key!==void 0&&(a=""+e.key),t.type&&t.type.defaultProps)var s=t.type.defaultProps;for(l in e)k5.call(e,l)&&!S5.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&s!==void 0?s[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){s=Array(l);for(var u=0;u<l;u++)s[u]=arguments[u+2];r.children=s}return{$$typeof:oh,type:t.type,key:a,ref:i,props:r,_owner:o}},Et.createContext=function(t){return t={$$typeof:Vj,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:jj,_context:t},t.Consumer=t},Et.createElement=C5,Et.createFactory=function(t){var e=C5.bind(null,t);return e.type=t,e},Et.createRef=function(){return{current:null}},Et.forwardRef=function(t){return{$$typeof:Wj,render:t}},Et.isValidElement=uk,Et.lazy=function(t){return{$$typeof:Hj,_payload:{_status:-1,_result:t},_init:Yj}},Et.memo=function(t,e){return{$$typeof:Gj,type:t,compare:e===void 0?null:e}},Et.startTransition=function(t){var e=N0.transition;N0.transition={};try{t()}finally{N0.transition=e}},Et.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},Et.useCallback=function(t,e){return va.current.useCallback(t,e)},Et.useContext=function(t){return va.current.useContext(t)},Et.useDebugValue=function(){},Et.useDeferredValue=function(t){return va.current.useDeferredValue(t)},Et.useEffect=function(t,e){return va.current.useEffect(t,e)},Et.useId=function(){return va.current.useId()},Et.useImperativeHandle=function(t,e,n){return va.current.useImperativeHandle(t,e,n)},Et.useInsertionEffect=function(t,e){return va.current.useInsertionEffect(t,e)},Et.useLayoutEffect=function(t,e){return va.current.useLayoutEffect(t,e)},Et.useMemo=function(t,e){return va.current.useMemo(t,e)},Et.useReducer=function(t,e,n){return va.current.useReducer(t,e,n)},Et.useRef=function(t){return va.current.useRef(t)},Et.useState=function(t){return va.current.useState(t)},Et.useSyncExternalStore=function(t,e,n){return va.current.useSyncExternalStore(t,e,n)},Et.useTransition=function(){return va.current.useTransition()},Et.version="18.2.0",g5.exports=Et;var R=g5.exports;const G=gi(R),T5=h5({__proto__:null,default:G},[R]);/**
* @license React
* react-jsx-runtime.production.min.js
*
* Copyright (c) Facebook, Inc. and its affiliates.
*
* This source code is licensed under the MIT license found in the
* LICENSE file in the root directory of this source tree.
*/var Zj=R,Jj=Symbol.for("react.element"),eV=Symbol.for("react.fragment"),tV=Object.prototype.hasOwnProperty,nV=Zj.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,rV={key:!0,ref:!0,__self:!0,__source:!0};function I5(t,e,n){var r,a={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)tV.call(e,r)&&!rV.hasOwnProperty(r)&&(a[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)a[r]===void 0&&(a[r]=e[r]);return{$$typeof:Jj,type:t,key:i,ref:o,props:a,_owner:nV.current}}k0.Fragment=eV,k0.jsx=I5,k0.jsxs=I5,f5.exports=k0;var se=f5.exports;const aV={type:"logger",log(t){this.output("log",t)},warn(t){this.output("warn",t)},error(t){this.output("error",t)},output(t,e){console&&console[t]&&console[t].apply(console,e)}};let iV=class DE{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.init(e,n)}init(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.prefix=n.prefix||"i18next:",this.logger=e||aV,this.options=n,this.debug=n.debug}log(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.forward(n,"log","",!0)}warn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.forward(n,"warn","",!0)}error(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.forward(n,"error","")}deprecate(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.forward(n,"warn","WARNING DEPRECATED: ",!0)}forward(e,n,r,a){return a&&!this.debug?null:(typeof e[0]=="string"&&(e[0]=`${r}${this.prefix} ${e[0]}`),this.logger[n](e))}create(e){return new DE(this.logger,{prefix:`${this.prefix}:${e}:`,...this.options})}clone(e){return e=e||this.options,e.prefix=e.prefix||this.prefix,new DE(this.logger,e)}};var So=new iV;class T0{constructor(){this.observers={}}on(e,n){return e.split(" ").forEach(r=>{this.observers[r]||(this.observers[r]=new Map);const a=this.observers[r].get(n)||0;this.observers[r].set(n,a+1)}),this}off(e,n){if(this.observers[e]){if(!n){delete this.observers[e];return}this.observers[e].delete(n)}}emit(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];this.observers[e]&&Array.from(this.observers[e].entries()).forEach(i=>{let[o,s]=i;for(let l=0;l<s;l++)o(...r)}),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach(i=>{let[o,s]=i;for(let l=0;l<s;l++)o.apply(o,[e,...r])})}}function sh(){let t,e;const n=new Promise((r,a)=>{t=r,e=a});return n.resolve=t,n.reject=e,n}function E5(t){return t==null?"":""+t}function oV(t,e,n){t.forEach(r=>{e[r]&&(n[r]=e[r])})}const sV=/###/g;function lh(t,e,n){function r(s){return s&&s.indexOf("###")>-1?s.replace(sV,"."):s}function a(){return!t||typeof t=="string"}const i=typeof e!="string"?e:e.split(".");let o=0;for(;o<i.length-1;){if(a())return{};const s=r(i[o]);!t[s]&&n&&(t[s]=new n),Object.prototype.hasOwnProperty.call(t,s)?t=t[s]:t={},++o}return a()?{}:{obj:t,k:r(i[o])}}function _5(t,e,n){const{obj:r,k:a}=lh(t,e,Object);if(r!==void 0||e.length===1){r[a]=n;return}let i=e[e.length-1],o=e.slice(0,e.length-1),s=lh(t,o,Object);for(;s.obj===void 0&&o.length;)i=`${o[o.length-1]}.${i}`,o=o.slice(0,o.length-1),s=lh(t,o,Object),s&&s.obj&&typeof s.obj[`${s.k}.${i}`]<"u"&&(s.obj=void 0);s.obj[`${s.k}.${i}`]=n}function lV(t,e,n,r){const{obj:a,k:i}=lh(t,e,Object);a[i]=a[i]||[],r&&(a[i]=a[i].concat(n)),r||a[i].push(n)}function I0(t,e){const{obj:n,k:r}=lh(t,e);if(n)return n[r]}function uV(t,e,n){const r=I0(t,n);return r!==void 0?r:I0(e,n)}function O5(t,e,n){for(const r in e)r!=="__proto__"&&r!=="constructor"&&(r in t?typeof t[r]=="string"||t[r]instanceof String||typeof e[r]=="string"||e[r]instanceof String?n&&(t[r]=e[r]):O5(t[r],e[r],n):t[r]=e[r]);return t}function Vc(t){return t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}var cV={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};function dV(t){return typeof t=="string"?t.replace(/[&<>"'\/]/g,e=>cV[e]):t}class pV{constructor(e){this.capacity=e,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(e){const n=this.regExpMap.get(e);if(n!==void 0)return n;const r=new RegExp(e);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(e,r),this.regExpQueue.push(e),r}}const hV=[" ",",","?","!",";"],fV=new pV(20);function gV(t,e,n){e=e||"",n=n||"";const r=hV.filter(o=>e.indexOf(o)<0&&n.indexOf(o)<0);if(r.length===0)return!0;const a=fV.getRegExp(`(${r.map(o=>o==="?"?"\\?":o).join("|")})`);let i=!a.test(t);if(!i){const o=t.indexOf(n);o>0&&!a.test(t.substring(0,o))&&(i=!0)}return i}function dk(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:".";if(!t)return;if(t[e])return t[e];const r=e.split(n);let a=t;for(let i=0;i<r.length;){if(!a||typeof a!="object")return;let o,s="";for(let l=i;l<r.length;++l)if(l!==i&&(s+=n),s+=r[l],o=a[s],o!==void 0){if(["string","number","boolean"].indexOf(typeof o)>-1&&l<r.length-1)continue;i+=l-i+1;break}a=o}return a}function E0(t){return t&&t.indexOf("_")>0?t.replace("_","-"):t}class $5 extends T0{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{ns:["translation"],defaultNS:"translation"};super(),this.data=e||{},this.options=n,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.options.ignoreJSONStructure===void 0&&(this.options.ignoreJSONStructure=!0)}addNamespaces(e){this.options.ns.indexOf(e)<0&&this.options.ns.push(e)}removeNamespaces(e){const n=this.options.ns.indexOf(e);n>-1&&this.options.ns.splice(n,1)}getResource(e,n,r){let a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};const i=a.keySeparator!==void 0?a.keySeparator:this.options.keySeparator,o=a.ignoreJSONStructure!==void 0?a.ignoreJSONStructure:this.options.ignoreJSONStructure;let s;e.indexOf(".")>-1?s=e.split("."):(s=[e,n],r&&(Array.isArray(r)?s.push(...r):typeof r=="string"&&i?s.push(...r.split(i)):s.push(r)));const l=I0(this.data,s);return!l&&!n&&!r&&e.indexOf(".")>-1&&(e=s[0],n=s[1],r=s.slice(2).join(".")),l||!o||typeof r!="string"?l:dk(this.data&&this.data[e]&&this.data[e][n],r,i)}addResource(e,n,r,a){let i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{silent:!1};const o=i.keySeparator!==void 0?i.keySeparator:this.options.keySeparator;let s=[e,n];r&&(s=s.concat(o?r.split(o):r)),e.indexOf(".")>-1&&(s=e.split("."),a=n,n=s[1]),this.addNamespaces(n),_5(this.data,s,a),i.silent||this.emit("added",e,n,r,a)}addResources(e,n,r){let a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{silent:!1};for(const i in r)(typeof r[i]=="string"||Object.prototype.toString.apply(r[i])==="[object Array]")&&this.addResource(e,n,i,r[i],{silent:!0});a.silent||this.emit("added",e,n,r)}addResourceBundle(e,n,r,a,i){let o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{silent:!1,skipCopy:!1},s=[e,n];e.indexOf(".")>-1&&(s=e.split("."),a=r,r=n,n=s[1]),this.addNamespaces(n);let l=I0(this.data,s)||{};o.skipCopy||(r=JSON.parse(JSON.stringify(r))),a?O5(l,r,i):l={...l,...r},_5(this.data,s,l),o.silent||this.emit("added",e,n,r)}removeResourceBundle(e,n){this.hasResourceBundle(e,n)&&delete this.data[e][n],this.removeNamespaces(n),this.emit("removed",e,n)}hasResourceBundle(e,n){return this.getResource(e,n)!==void 0}getResourceBundle(e,n){return n||(n=this.options.defaultNS),this.options.compatibilityAPI==="v1"?{...this.getResource(e,n)}:this.getResource(e,n)}getDataByLanguage(e){return this.data[e]}hasLanguageSomeTranslations(e){const n=this.getDataByLanguage(e);return!!(n&&Object.keys(n)||[]).find(r=>n[r]&&Object.keys(n[r]).length>0)}toJSON(){return this.data}}var R5={processors:{},addPostProcessor(t){this.processors[t.name]=t},handle(t,e,n,r,a){return t.forEach(i=>{this.processors[i]&&(e=this.processors[i].process(e,n,r,a))}),e}};const M5={};class K2 extends T0{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),oV(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],e,this),this.options=n,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.logger=So.create("translator")}changeLanguage(e){e&&(this.language=e)}exists(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}};if(e==null)return!1;const r=this.resolve(e,n);return r&&r.res!==void 0}extractFromKey(e,n){let r=n.nsSeparator!==void 0?n.nsSeparator:this.options.nsSeparator;r===void 0&&(r=":");const a=n.keySeparator!==void 0?n.keySeparator:this.options.keySeparator;let i=n.ns||this.options.defaultNS||[];const o=r&&e.indexOf(r)>-1,s=!this.options.userDefinedKeySeparator&&!n.keySeparator&&!this.options.userDefinedNsSeparator&&!n.nsSeparator&&!gV(e,r,a);if(o&&!s){const l=e.match(this.interpolator.nestingRegexp);if(l&&l.length>0)return{key:e,namespaces:i};const u=e.split(r);(r!==a||r===a&&this.options.ns.indexOf(u[0])>-1)&&(i=u.shift()),e=u.join(a)}return typeof i=="string"&&(i=[i]),{key:e,namespaces:i}}translate(e,n,r){if(typeof n!="object"&&this.options.overloadTranslationOptionHandler&&(n=this.options.overloadTranslationOptionHandler(arguments)),typeof n=="object"&&(n={...n}),n||(n={}),e==null)return"";Array.isArray(e)||(e=[String(e)]);const a=n.returnDetails!==void 0?n.returnDetails:this.options.returnDetails,i=n.keySeparator!==void 0?n.keySeparator:this.options.keySeparator,{key:o,namespaces:s}=this.extractFromKey(e[e.length-1],n),l=s[s.length-1],u=n.lng||this.language,c=n.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(u&&u.toLowerCase()==="cimode"){if(c){const w=n.nsSeparator||this.options.nsSeparator;return a?{res:`${l}${w}${o}`,usedKey:o,exactUsedKey:o,usedLng:u,usedNS:l,usedParams:this.getUsedParamsDetails(n)}:`${l}${w}${o}`}return a?{res:o,usedKey:o,exactUsedKey:o,usedLng:u,usedNS:l,usedParams:this.getUsedParamsDetails(n)}:o}const d=this.resolve(e,n);let p=d&&d.res;const f=d&&d.usedKey||o,m=d&&d.exactUsedKey||o,y=Object.prototype.toString.apply(p),x=["[object Number]","[object Function]","[object RegExp]"],b=n.joinArrays!==void 0?n.joinArrays:this.options.joinArrays,v=!this.i18nFormat||this.i18nFormat.handleAsObject;if(v&&p&&typeof p!="string"&&typeof p!="boolean"&&typeof p!="number"&&x.indexOf(y)<0&&!(typeof b=="string"&&y==="[object Array]")){if(!n.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const w=this.options.returnedObjectHandler?this.options.returnedObjectHandler(f,p,{...n,ns:s}):`key '${o} (${this.language})' returned an object instead of string.`;return a?(d.res=w,d.usedParams=this.getUsedParamsDetails(n),d):w}if(i){const w=y==="[object Array]",S=w?[]:{},C=w?m:f;for(const I in p)if(Object.prototype.hasOwnProperty.call(p,I)){const _=`${C}${i}${I}`;S[I]=this.translate(_,{...n,joinArrays:!1,ns:s}),S[I]===_&&(S[I]=p[I])}p=S}}else if(v&&typeof b=="string"&&y==="[object Array]")p=p.join(b),p&&(p=this.extendTranslation(p,e,n,r));else{let w=!1,S=!1;const C=n.count!==void 0&&typeof n.count!="string",I=K2.hasDefaultValue(n),_=C?this.pluralResolver.getSuffix(u,n.count,n):"",E=n.ordinal&&C?this.pluralResolver.getSuffix(u,n.count,{ordinal:!1}):"",P=C&&!n.ordinal&&n.count===0&&this.pluralResolver.shouldUseIntlApi(),A=P&&n[`defaultValue${this.options.pluralSeparator}zero`]||n[`defaultValue${_}`]||n[`defaultValue${E}`]||n.defaultValue;!this.isValidLookup(p)&&I&&(w=!0,p=A),this.isValidLookup(p)||(S=!0,p=o);const D=(n.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&S?void 0:p,V=I&&A!==p&&this.options.updateMissing;if(S||w||V){if(this.logger.log(V?"updateKey":"missingKey",u,l,o,V?A:p),i){const Z=this.resolve(o,{...n,keySeparator:!1});Z&&Z.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let z=[];const K=this.languageUtils.getFallbackCodes(this.options.fallbackLng,n.lng||this.language);if(this.options.saveMissingTo==="fallback"&&K&&K[0])for(let Z=0;Z<K.length;Z++)z.push(K[Z]);else this.options.saveMissingTo==="all"?z=this.languageUtils.toResolveHierarchy(n.lng||this.language):z.push(n.lng||this.language);const X=(Z,q,F)=>{const Y=I&&F!==p?F:D;this.options.missingKeyHandler?this.options.missingKeyHandler(Z,l,q,Y,V,n):this.backendConnector&&this.backendConnector.saveMissing&&this.backendConnector.saveMissing(Z,l,q,Y,V,n),this.emit("missingKey",Z,l,q,p)};this.options.saveMissing&&(this.options.saveMissingPlurals&&C?z.forEach(Z=>{const q=this.pluralResolver.getSuffixes(Z,n);P&&n[`defaultValue${this.options.pluralSeparator}zero`]&&q.indexOf(`${this.options.pluralSeparator}zero`)<0&&q.push(`${this.options.pluralSeparator}zero`),q.forEach(F=>{X([Z],o+F,n[`defaultValue${F}`]||A)})}):X(z,o,A))}p=this.extendTranslation(p,e,n,d,r),S&&p===o&&this.options.appendNamespaceToMissingKey&&(p=`${l}:${o}`),(S||w)&&this.options.parseMissingKeyHandler&&(this.options.compatibilityAPI!=="v1"?p=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${l}:${o}`:o,w?p:void 0):p=this.options.parseMissingKeyHandler(p))}return a?(d.res=p,d.usedParams=this.getUsedParamsDetails(n),d):p}extendTranslation(e,n,r,a,i){var o=this;if(this.i18nFormat&&this.i18nFormat.parse)e=this.i18nFormat.parse(e,{...this.options.interpolation.defaultVariables,...r},r.lng||this.language||a.usedLng,a.usedNS,a.usedKey,{resolved:a});else if(!r.skipInterpolation){r.interpolation&&this.interpolator.init({...r,interpolation:{...this.options.interpolation,...r.interpolation}});const u=typeof e=="string"&&(r&&r.interpolation&&r.interpolation.skipOnVariables!==void 0?r.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let c;if(u){const p=e.match(this.interpolator.nestingRegexp);c=p&&p.length}let d=r.replace&&typeof r.replace!="string"?r.replace:r;if(this.options.interpolation.defaultVariables&&(d={...this.options.interpolation.defaultVariables,...d}),e=this.interpolator.interpolate(e,d,r.lng||this.language,r),u){const p=e.match(this.interpolator.nestingRegexp),f=p&&p.length;c<f&&(r.nest=!1)}!r.lng&&this.options.compatibilityAPI!=="v1"&&a&&a.res&&(r.lng=a.usedLng),r.nest!==!1&&(e=this.interpolator.nest(e,function(){for(var p=arguments.length,f=new Array(p),m=0;m<p;m++)f[m]=arguments[m];return i&&i[0]===f[0]&&!r.context?(o.logger.warn(`It seems you are nesting recursively key: ${f[0]} in key: ${n[0]}`),null):o.translate(...f,n)},r)),r.interpolation&&this.interpolator.reset()}const s=r.postProcess||this.options.postProcess,l=typeof s=="string"?[s]:s;return e!=null&&l&&l.length&&r.applyPostProcessor!==!1&&(e=R5.handle(l,e,n,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...a,usedParams:this.getUsedParamsDetails(r)},...r}:r,this)),e}resolve(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r,a,i,o,s;return typeof e=="string"&&(e=[e]),e.forEach(l=>{if(this.isValidLookup(r))return;const u=this.extractFromKey(l,n),c=u.key;a=c;let d=u.namespaces;this.options.fallbackNS&&(d=d.concat(this.options.fallbackNS));const p=n.count!==void 0&&typeof n.count!="string",f=p&&!n.ordinal&&n.count===0&&this.pluralResolver.shouldUseIntlApi(),m=n.context!==void 0&&(typeof n.context=="string"||typeof n.context=="number")&&n.context!=="",y=n.lngs?n.lngs:this.languageUtils.toResolveHierarchy(n.lng||this.language,n.fallbackLng);d.forEach(x=>{this.isValidLookup(r)||(s=x,!M5[`${y[0]}-${x}`]&&this.utils&&this.utils.hasLoadedNamespace&&!this.utils.hasLoadedNamespace(s)&&(M5[`${y[0]}-${x}`]=!0,this.logger.warn(`key "${a}" for languages "${y.join(", ")}" won't get resolved as namespace "${s}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),y.forEach(b=>{if(this.isValidLookup(r))return;o=b;const v=[c];if(this.i18nFormat&&this.i18nFormat.addLookupKeys)this.i18nFormat.addLookupKeys(v,c,b,x,n);else{let S;p&&(S=this.pluralResolver.getSuffix(b,n.count,n));const C=`${this.options.pluralSeparator}zero`,I=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(p&&(v.push(c+S),n.ordinal&&S.indexOf(I)===0&&v.push(c+S.replace(I,this.options.pluralSeparator)),f&&v.push(c+C)),m){const _=`${c}${this.options.contextSeparator}${n.context}`;v.push(_),p&&(v.push(_+S),n.ordinal&&S.indexOf(I)===0&&v.push(_+S.replace(I,this.options.pluralSeparator)),f&&v.push(_+C))}}let w;for(;w=v.pop();)this.isValidLookup(r)||(i=w,r=this.getResource(b,x,w,n))}))})}),{res:r,usedKey:a,exactUsedKey:i,usedLng:o,usedNS:s}}isValidLookup(e){return e!==void 0&&!(!this.options.returnNull&&e===null)&&!(!this.options.returnEmptyString&&e==="")}getResource(e,n,r){let a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return this.i18nFormat&&this.i18nFormat.getResource?this.i18nFormat.getResource(e,n,r,a):this.resourceStore.getResource(e,n,r,a)}getUsedParamsDetails(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],r=e.replace&&typeof e.replace!="string";let a=r?e.replace:e;if(r&&typeof e.count<"u"&&(a.count=e.count),this.options.interpolation.defaultVariables&&(a={...this.options.interpolation.defaultVariables,...a}),!r){a={...a};for(const i of n)delete a[i]}return a}static hasDefaultValue(e){const n="defaultValue";for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&n===r.substring(0,n.length)&&e[r]!==void 0)return!0;return!1}}function pk(t){return t.charAt(0).toUpperCase()+t.slice(1)}class A5{constructor(e){this.options=e,this.supportedLngs=this.options.supportedLngs||!1,this.logger=So.create("languageUtils")}getScriptPartFromCode(e){if(e=E0(e),!e||e.indexOf("-")<0)return null;const n=e.split("-");return n.length===2||(n.pop(),n[n.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(n.join("-"))}getLanguagePartFromCode(e){if(e=E0(e),!e||e.indexOf("-")<0)return e;const n=e.split("-");return this.formatLanguageCode(n[0])}formatLanguageCode(e){if(typeof e=="string"&&e.indexOf("-")>-1){const n=["hans","hant","latn","cyrl","cans","mong","arab"];let r=e.split("-");return this.options.lowerCaseLng?r=r.map(a=>a.toLowerCase()):r.length===2?(r[0]=r[0].toLowerCase(),r[1]=r[1].toUpperCase(),n.indexOf(r[1].toLowerCase())>-1&&(r[1]=pk(r[1].toLowerCase()))):r.length===3&&(r[0]=r[0].toLowerCase(),r[1].length===2&&(r[1]=r[1].toUpperCase()),r[0]!=="sgn"&&r[2].length===2&&(r[2]=r[2].toUpperCase()),n.indexOf(r[1].toLowerCase())>-1&&(r[1]=pk(r[1].toLowerCase())),n.indexOf(r[2].toLowerCase())>-1&&(r[2]=pk(r[2].toLowerCase()))),r.join("-")}return this.options.cleanCode||this.options.lowerCaseLng?e.toLowerCase():e}isSupportedCode(e){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(e=this.getLanguagePartFromCode(e)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(e)>-1}getBestMatchFromCodes(e){if(!e)return null;let n;return e.forEach(r=>{if(n)return;const a=this.formatLanguageCode(r);(!this.options.supportedLngs||this.isSupportedCode(a))&&(n=a)}),!n&&this.options.supportedLngs&&e.forEach(r=>{if(n)return;const a=this.getLanguagePartFromCode(r);if(this.isSupportedCode(a))return n=a;n=this.options.supportedLngs.find(i=>{if(i===a||!(i.indexOf("-")<0&&a.indexOf("-")<0)&&i.indexOf(a)===0)return i})}),n||(n=this.getFallbackCodes(this.options.fallbackLng)[0]),n}getFallbackCodes(e,n){if(!e)return[];if(typeof e=="function"&&(e=e(n)),typeof e=="string"&&(e=[e]),Object.prototype.toString.apply(e)==="[object Array]")return e;if(!n)return e.default||[];let r=e[n];return r||(r=e[this.getScriptPartFromCode(n)]),r||(r=e[this.formatLanguageCode(n)]),r||(r=e[this.getLanguagePartFromCode(n)]),r||(r=e.default),r||[]}toResolveHierarchy(e,n){const r=this.getFallbackCodes(n||this.options.fallbackLng||[],e),a=[],i=o=>{o&&(this.isSupportedCode(o)?a.push(o):this.logger.warn(`rejecting language code not found in supportedLngs: ${o}`))};return typeof e=="string"&&(e.indexOf("-")>-1||e.indexOf("_")>-1)?(this.options.load!=="languageOnly"&&i(this.formatLanguageCode(e)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&i(this.getScriptPartFromCode(e)),this.options.load!=="currentOnly"&&i(this.getLanguagePartFromCode(e))):typeof e=="string"&&i(this.formatLanguageCode(e)),r.forEach(o=>{a.indexOf(o)<0&&i(this.formatLanguageCode(o))}),a}}let mV=[{lngs:["ach","ak","am","arn","br","fil","gun","ln","mfe","mg","mi","oc","pt","pt-BR","tg","tl","ti","tr","uz","wa"],nr:[1,2],fc:1},{lngs:["af","an","ast","az","bg","bn","ca","da","de","dev","el","en","eo","es","et","eu","fi","fo","fur","fy","gl","gu","ha","hi","hu","hy","ia","it","kk","kn","ku","lb","mai","ml","mn","mr","nah","nap","nb","ne","nl","nn","no","nso","pa","pap","pms","ps","pt-PT","rm","sco","se","si","so","son","sq","sv","sw","ta","te","tk","ur","yo"],nr:[1,2],fc:2},{lngs:["ay","bo","cgg","fa","ht","id","ja","jbo","ka","km","ko","ky","lo","ms","sah","su","th","tt","ug","vi","wo","zh"],nr:[1],fc:3},{lngs:["be","bs","cnr","dz","hr","ru","sr","uk"],nr:[1,2,5],fc:4},{lngs:["ar"],nr:[0,1,2,3,11,100],fc:5},{lngs:["cs","sk"],nr:[1,2,5],fc:6},{lngs:["csb","pl"],nr:[1,2,5],fc:7},{lngs:["cy"],nr:[1,2,3,8],fc:8},{lngs:["fr"],nr:[1,2],fc:9},{lngs:["ga"],nr:[1,2,3,7,11],fc:10},{lngs:["gd"],nr:[1,2,3,20],fc:11},{lngs:["is"],nr:[1,2],fc:12},{lngs:["jv"],nr:[0,1],fc:13},{lngs:["kw"],nr:[1,2,3,4],fc:14},{lngs:["lt"],nr:[1,2,10],fc:15},{lngs:["lv"],nr:[1,2,0],fc:16},{lngs:["mk"],nr:[1,2],fc:17},{lngs:["mnk"],nr:[0,1,2],fc:18},{lngs:["mt"],nr:[1,2,11,20],fc:19},{lngs:["or"],nr:[2,1],fc:2},{lngs:["ro"],nr:[1,2,20],fc:20},{lngs:["sl"],nr:[5,1,2,3],fc:21},{lngs:["he","iw"],nr:[1,2,20,21],fc:22}],yV={1:function(t){return+(t>1)},2:function(t){return+(t!=1)},3:function(t){return 0},4:function(t){return t%10==1&&t%100!=11?0:t%10>=2&&t%10<=4&&(t%100<10||t%100>=20)?1:2},5:function(t){return t==0?0:t==1?1:t==2?2:t%100>=3&&t%100<=10?3:t%100>=11?4:5},6:function(t){return t==1?0:t>=2&&t<=4?1:2},7:function(t){return t==1?0:t%10>=2&&t%10<=4&&(t%100<10||t%100>=20)?1:2},8:function(t){return t==1?0:t==2?1:t!=8&&t!=11?2:3},9:function(t){return+(t>=2)},10:function(t){return t==1?0:t==2?1:t<7?2:t<11?3:4},11:function(t){return t==1||t==11?0:t==2||t==12?1:t>2&&t<20?2:3},12:function(t){return+(t%10!=1||t%100==11)},13:function(t){return+(t!==0)},14:function(t){return t==1?0:t==2?1:t==3?2:3},15:function(t){return t%10==1&&t%100!=11?0:t%10>=2&&(t%100<10||t%100>=20)?1:2},16:function(t){return t%10==1&&t%100!=11?0:t!==0?1:2},17:function(t){return t==1||t%10==1&&t%100!=11?0:1},18:function(t){return t==0?0:t==1?1:2},19:function(t){return t==1?0:t==0||t%100>1&&t%100<11?1:t%100>10&&t%100<20?2:3},20:function(t){return t==1?0:t==0||t%100>0&&t%100<20?1:2},21:function(t){return t%100==1?1:t%100==2?2:t%100==3||t%100==4?3:0},22:function(t){return t==1?0:t==2?1:(t<0||t>10)&&t%10==0?2:3}};const bV=["v1","v2","v3"],vV=["v4"],P5={zero:0,one:1,two:2,few:3,many:4,other:5};function xV(){const t={};return mV.forEach(e=>{e.lngs.forEach(n=>{t[n]={numbers:e.nr,plurals:yV[e.fc]}})}),t}class wV{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.languageUtils=e,this.options=n,this.logger=So.create("pluralResolver"),(!this.options.compatibilityJSON||vV.includes(this.options.compatibilityJSON))&&(typeof Intl>"u"||!Intl.PluralRules)&&(this.options.compatibilityJSON="v3",this.logger.error("Your environment seems not to be Intl API compatible, use an Intl.PluralRules polyfill. Will fallback to the compatibilityJSON v3 format handling.")),this.rules=xV()}addRule(e,n){this.rules[e]=n}getRule(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.shouldUseIntlApi())try{return new Intl.PluralRules(E0(e==="dev"?"en":e),{type:n.ordinal?"ordinal":"cardinal"})}catch{return}return this.rules[e]||this.rules[this.languageUtils.getLanguagePartFromCode(e)]}needsPlural(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=this.getRule(e,n);return this.shouldUseIntlApi()?r&&r.resolvedOptions().pluralCategories.length>1:r&&r.numbers.length>1}getPluralFormsOfKey(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.getSuffixes(e,r).map(a=>`${n}${a}`)}getSuffixes(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=this.getRule(e,n);return r?this.shouldUseIntlApi()?r.resolvedOptions().pluralCategories.sort((a,i)=>P5[a]-P5[i]).map(a=>`${this.options.prepend}${n.ordinal?`ordinal${this.options.prepend}`:""}${a}`):r.numbers.map(a=>this.getSuffix(e,a,n)):[]}getSuffix(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const a=this.getRule(e,r);return a?this.shouldUseIntlApi()?`${this.options.prepend}${r.ordinal?`ordinal${this.options.prepend}`:""}${a.select(n)}`:this.getSuffixRetroCompatible(a,n):(this.logger.warn(`no plural rule found for: ${e}`),"")}getSuffixRetroCompatible(e,n){const r=e.noAbs?e.plurals(n):e.plurals(Math.abs(n));let a=e.numbers[r];this.options.simplifyPluralSuffix&&e.numbers.length===2&&e.numbers[0]===1&&(a===2?a="plural":a===1&&(a=""));const i=()=>this.options.prepend&&a.toString()?this.options.prepend+a.toString():a.toString();return this.options.compatibilityJSON==="v1"?a===1?"":typeof a=="number"?`_plural_${a.toString()}`:i():this.options.compatibilityJSON==="v2"||this.options.simplifyPluralSuffix&&e.numbers.length===2&&e.numbers[0]===1?i():this.options.prepend&&r.toString()?this.options.prepend+r.toString():r.toString()}shouldUseIntlApi(){return!bV.includes(this.options.compatibilityJSON)}}function L5(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:".",a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,i=uV(t,e,n);return!i&&a&&typeof n=="string"&&(i=dk(t,n,r),i===void 0&&(i=dk(e,n,r))),i}class kV{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.logger=So.create("interpolator"),this.options=e,this.format=e.interpolation&&e.interpolation.format||(n=>n),this.init(e)}init(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.interpolation||(e.interpolation={escapeValue:!0});const n=e.interpolation;this.escape=n.escape!==void 0?n.escape:dV,this.escapeValue=n.escapeValue!==void 0?n.escapeValue:!0,this.useRawValueToEscape=n.useRawValueToEscape!==void 0?n.useRawValueToEscape:!1,this.prefix=n.prefix?Vc(n.prefix):n.prefixEscaped||"{{",this.suffix=n.suffix?Vc(n.suffix):n.suffixEscaped||"}}",this.formatSeparator=n.formatSeparator?n.formatSeparator:n.formatSeparator||",",this.unescapePrefix=n.unescapeSuffix?"":n.unescapePrefix||"-",this.unescapeSuffix=this.unescapePrefix?"":n.unescapeSuffix||"",this.nestingPrefix=n.nestingPrefix?Vc(n.nestingPrefix):n.nestingPrefixEscaped||Vc("$t("),this.nestingSuffix=n.nestingSuffix?Vc(n.nestingSuffix):n.nestingSuffixEscaped||Vc(")"),this.nestingOptionsSeparator=n.nestingOptionsSeparator?n.nestingOptionsSeparator:n.nestingOptionsSeparator||",",this.maxReplaces=n.maxReplaces?n.maxReplaces:1e3,this.alwaysFormat=n.alwaysFormat!==void 0?n.alwaysFormat:!1,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const e=(n,r)=>n&&n.source===r?(n.lastIndex=0,n):new RegExp(r,"g");this.regexp=e(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=e(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=e(this.nestingRegexp,`${this.nestingPrefix}(.+?)${this.nestingSuffix}`)}interpolate(e,n,r,a){let i,o,s;const l=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{};function u(f){return f.replace(/\$/g,"$$$$")}const c=f=>{if(f.indexOf(this.formatSeparator)<0){const b=L5(n,l,f,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(b,void 0,r,{...a,...n,interpolationkey:f}):b}const m=f.split(this.formatSeparator),y=m.shift().trim(),x=m.join(this.formatSeparator).trim();return this.format(L5(n,l,y,this.options.keySeparator,this.options.ignoreJSONStructure),x,r,{...a,...n,interpolationkey:y})};this.resetRegExp();const d=a&&a.missingInterpolationHandler||this.options.missingInterpolationHandler,p=a&&a.interpolation&&a.interpolation.skipOnVariables!==void 0?a.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:f=>u(f)},{regex:this.regexp,safeValue:f=>this.escapeValue?u(this.escape(f)):u(f)}].forEach(f=>{for(s=0;i=f.regex.exec(e);){const m=i[1].trim();if(o=c(m),o===void 0)if(typeof d=="function"){const x=d(e,i,a);o=typeof x=="string"?x:""}else if(a&&Object.prototype.hasOwnProperty.call(a,m))o="";else if(p){o=i[0];continue}else this.logger.warn(`missed to pass in variable ${m} for interpolating ${e}`),o="";else typeof o!="string"&&!this.useRawValueToEscape&&(o=E5(o));const y=f.safeValue(o);if(e=e.replace(i[0],y),p?(f.regex.lastIndex+=o.length,f.regex.lastIndex-=i[0].length):f.regex.lastIndex=0,s++,s>=this.maxReplaces)break}}),e}nest(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a,i,o;function s(l,u){const c=this.nestingOptionsSeparator;if(l.indexOf(c)<0)return l;const d=l.split(new RegExp(`${c}[ ]*{`));let p=`{${d[1]}`;l=d[0],p=this.interpolate(p,o);const f=p.match(/'/g),m=p.match(/"/g);(f&&f.length%2===0&&!m||m.length%2!==0)&&(p=p.replace(/'/g,'"'));try{o=JSON.parse(p),u&&(o={...u,...o})}catch(y){return this.logger.warn(`failed parsing options string in nesting for key ${l}`,y),`${l}${c}${p}`}return delete o.defaultValue,l}for(;a=this.nestingRegexp.exec(e);){let l=[];o={...r},o=o.replace&&typeof o.replace!="string"?o.replace:o,o.applyPostProcessor=!1,delete o.defaultValue;let u=!1;if(a[0].indexOf(this.formatSeparator)!==-1&&!/{.*}/.test(a[1])){const c=a[1].split(this.formatSeparator).map(d=>d.trim());a[1]=c.shift(),l=c,u=!0}if(i=n(s.call(this,a[1].trim(),o),o),i&&a[0]===e&&typeof i!="string")return i;typeof i!="string"&&(i=E5(i)),i||(this.logger.warn(`missed to resolve ${a[1]} for nesting ${e}`),i=""),u&&(i=l.reduce((c,d)=>this.format(c,d,r.lng,{...r,interpolationkey:a[1].trim()}),i.trim())),e=e.replace(a[0],i),this.regexp.lastIndex=0}return e}}function SV(t){let e=t.toLowerCase().trim();const n={};if(t.indexOf("(")>-1){const r=t.split("(");e=r[0].toLowerCase().trim();const a=r[1].substring(0,r[1].length-1);e==="currency"&&a.indexOf(":")<0?n.currency||(n.currency=a.trim()):e==="relativetime"&&a.indexOf(":")<0?n.range||(n.range=a.trim()):a.split(";").forEach(i=>{if(!i)return;const[o,...s]=i.split(":"),l=s.join(":").trim().replace(/^'+|'+$/g,"");n[o.trim()]||(n[o.trim()]=l),l==="false"&&(n[o.trim()]=!1),l==="true"&&(n[o.trim()]=!0),isNaN(l)||(n[o.trim()]=parseInt(l,10))})}return{formatName:e,formatOptions:n}}function Wc(t){const e={};return function(n,r,a){const i=r+JSON.stringify(a);let o=e[i];return o||(o=t(E0(r),a),e[i]=o),o(n)}}class CV{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.logger=So.create("formatter"),this.options=e,this.formats={number:Wc((n,r)=>{const a=new Intl.NumberFormat(n,{...r});return i=>a.format(i)}),currency:Wc((n,r)=>{const a=new Intl.NumberFormat(n,{...r,style:"currency"});return i=>a.format(i)}),datetime:Wc((n,r)=>{const a=new Intl.DateTimeFormat(n,{...r});return i=>a.format(i)}),relativetime:Wc((n,r)=>{const a=new Intl.RelativeTimeFormat(n,{...r});return i=>a.format(i,r.range||"day")}),list:Wc((n,r)=>{const a=new Intl.ListFormat(n,{...r});return i=>a.format(i)})},this.init(e)}init(e){const n=(arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}}).interpolation;this.formatSeparator=n.formatSeparator?n.formatSeparator:n.formatSeparator||","}add(e,n){this.formats[e.toLowerCase().trim()]=n}addCached(e,n){this.formats[e.toLowerCase().trim()]=Wc(n)}format(e,n,r){let a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return n.split(this.formatSeparator).reduce((i,o)=>{const{formatName:s,formatOptions:l}=SV(o);if(this.formats[s]){let u=i;try{const c=a&&a.formatParams&&a.formatParams[a.interpolationkey]||{},d=c.locale||c.lng||a.locale||a.lng||r;u=this.formats[s](i,d,{...l,...a,...c})}catch(c){this.logger.warn(c)}return u}else this.logger.warn(`there was no format function for ${s}`);return i},e)}}function NV(t,e){t.pending[e]!==void 0&&(delete t.pending[e],t.pendingCount--)}class TV extends T0{constructor(e,n,r){let a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};super(),this.backend=e,this.store=n,this.services=r,this.languageUtils=r.languageUtils,this.options=a,this.logger=So.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=a.maxParallelReads||10,this.readingCalls=0,this.maxRetries=a.maxRetries>=0?a.maxRetries:5,this.retryTimeout=a.retryTimeout>=1?a.retryTimeout:350,this.state={},this.queue=[],this.backend&&this.backend.init&&this.backend.init(r,a.backend,a)}queueLoad(e,n,r,a){const i={},o={},s={},l={};return e.forEach(u=>{let c=!0;n.forEach(d=>{const p=`${u}|${d}`;!r.reload&&this.store.hasResourceBundle(u,d)?this.state[p]=2:this.state[p]<0||(this.state[p]===1?o[p]===void 0&&(o[p]=!0):(this.state[p]=1,c=!1,o[p]===void 0&&(o[p]=!0),i[p]===void 0&&(i[p]=!0),l[d]===void 0&&(l[d]=!0)))}),c||(s[u]=!0)}),(Object.keys(i).length||Object.keys(o).length)&&this.queue.push({pending:o,pendingCount:Object.keys(o).length,loaded:{},errors:[],callback:a}),{toLoad:Object.keys(i),pending:Object.keys(o),toLoadLanguages:Object.keys(s),toLoadNamespaces:Object.keys(l)}}loaded(e,n,r){const a=e.split("|"),i=a[0],o=a[1];n&&this.emit("failedLoading",i,o,n),r&&this.store.addResourceBundle(i,o,r,void 0,void 0,{skipCopy:!0}),this.state[e]=n?-1:2;const s={};this.queue.forEach(l=>{lV(l.loaded,[i],o),NV(l,e),n&&l.errors.push(n),l.pendingCount===0&&!l.done&&(Object.keys(l.loaded).forEach(u=>{s[u]||(s[u]={});const c=l.loaded[u];c.length&&c.forEach(d=>{s[u][d]===void 0&&(s[u][d]=!0)})}),l.done=!0,l.errors.length?l.callback(l.errors):l.callback())}),this.emit("loaded",s),this.queue=this.queue.filter(l=>!l.done)}read(e,n,r){let a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:this.retryTimeout,o=arguments.length>5?arguments[5]:void 0;if(!e.length)return o(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:e,ns:n,fcName:r,tried:a,wait:i,callback:o});return}this.readingCalls++;const s=(u,c)=>{if(this.readingCalls--,this.waitingReads.length>0){const d=this.waitingReads.shift();this.read(d.lng,d.ns,d.fcName,d.tried,d.wait,d.callback)}if(u&&c&&a<this.maxRetries){setTimeout(()=>{this.read.call(this,e,n,r,a+1,i*2,o)},i);return}o(u,c)},l=this.backend[r].bind(this.backend);if(l.length===2){try{const u=l(e,n);u&&typeof u.then=="function"?u.then(c=>s(null,c)).catch(s):s(null,u)}catch(u){s(u)}return}return l(e,n,s)}prepareLoading(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),a&&a();typeof e=="string"&&(e=this.languageUtils.toResolveHierarchy(e)),typeof n=="string"&&(n=[n]);const i=this.queueLoad(e,n,r,a);if(!i.toLoad.length)return i.pending.length||a(),null;i.toLoad.forEach(o=>{this.loadOne(o)})}load(e,n,r){this.prepareLoading(e,n,{},r)}reload(e,n,r){this.prepareLoading(e,n,{reload:!0},r)}loadOne(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const r=e.split("|"),a=r[0],i=r[1];this.read(a,i,"read",void 0,void 0,(o,s)=>{o&&this.logger.warn(`${n}loading namespace ${i} for language ${a} failed`,o),!o&&s&&this.logger.log(`${n}loaded namespace ${i} for language ${a}`,s),this.loaded(e,o,s)})}saveMissing(e,n,r,a,i){let o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{},s=arguments.length>6&&arguments[6]!==void 0?arguments[6]:()=>{};if(this.services.utils&&this.services.utils.hasLoadedNamespace&&!this.services.utils.hasLoadedNamespace(n)){this.logger.warn(`did not save key "${r}" as the namespace "${n}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(!(r==null||r==="")){if(this.backend&&this.backend.create){const l={...o,isUpdate:i},u=this.backend.create.bind(this.backend);if(u.length<6)try{let c;u.length===5?c=u(e,n,r,a,l):c=u(e,n,r,a),c&&typeof c.then=="function"?c.then(d=>s(null,d)).catch(s):s(null,c)}catch(c){s(c)}else u(e,n,r,a,s,l)}!e||!e[0]||this.store.addResource(e[0],n,r,a)}}}function D5(){return{debug:!1,initImmediate:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:function(t){let e={};if(typeof t[1]=="object"&&(e=t[1]),typeof t[1]=="string"&&(e.defaultValue=t[1]),typeof t[2]=="string"&&(e.tDescription=t[2]),typeof t[2]=="object"||typeof t[3]=="object"){const n=t[3]||t[2];Object.keys(n).forEach(r=>{e[r]=n[r]})}return e},interpolation:{escapeValue:!0,format:t=>t,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0}}}function F5(t){return typeof t.ns=="string"&&(t.ns=[t.ns]),typeof t.fallbackLng=="string"&&(t.fallbackLng=[t.fallbackLng]),typeof t.fallbackNS=="string"&&(t.fallbackNS=[t.fallbackNS]),t.supportedLngs&&t.supportedLngs.indexOf("cimode")<0&&(t.supportedLngs=t.supportedLngs.concat(["cimode"])),t}function _0(){}function IV(t){Object.getOwnPropertyNames(Object.getPrototypeOf(t)).forEach(e=>{typeof t[e]=="function"&&(t[e]=t[e].bind(t))})}class _m extends T0{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;if(super(),this.options=F5(e),this.services={},this.logger=So,this.modules={external:[]},IV(this),n&&!this.isInitialized&&!e.isClone){if(!this.options.initImmediate)return this.init(e,n),this;setTimeout(()=>{this.init(e,n)},0)}}init(){var e=this;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0;typeof n=="function"&&(r=n,n={}),!n.defaultNS&&n.defaultNS!==!1&&n.ns&&(typeof n.ns=="string"?n.defaultNS=n.ns:n.ns.indexOf("translation")<0&&(n.defaultNS=n.ns[0]));const a=D5();this.options={...a,...this.options,...F5(n)},this.options.compatibilityAPI!=="v1"&&(this.options.interpolation={...a.interpolation,...this.options.interpolation}),n.keySeparator!==void 0&&(this.options.userDefinedKeySeparator=n.keySeparator),n.nsSeparator!==void 0&&(this.options.userDefinedNsSeparator=n.nsSeparator);function i(l){return l?typeof l=="function"?new l:l:null}if(!this.options.isClone){this.modules.logger?So.init(i(this.modules.logger),this.options):So.init(null,this.options);let l;this.modules.formatter?l=this.modules.formatter:typeof Intl<"u"&&(l=CV);const u=new A5(this.options);this.store=new $5(this.options.resources,this.options);const c=this.services;c.logger=So,c.resourceStore=this.store,c.languageUtils=u,c.pluralResolver=new wV(u,{prepend:this.options.pluralSeparator,compatibilityJSON:this.options.compatibilityJSON,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),l&&(!this.options.interpolation.format||this.options.interpolation.format===a.interpolation.format)&&(c.formatter=i(l),c.formatter.init(c,this.options),this.options.interpolation.format=c.formatter.format.bind(c.formatter)),c.interpolator=new kV(this.options),c.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},c.backendConnector=new TV(i(this.modules.backend),c.resourceStore,c,this.options),c.backendConnector.on("*",function(d){for(var p=arguments.length,f=new Array(p>1?p-1:0),m=1;m<p;m++)f[m-1]=arguments[m];e.emit(d,...f)}),this.modules.languageDetector&&(c.languageDetector=i(this.modules.languageDetector),c.languageDetector.init&&c.languageDetector.init(c,this.options.detection,this.options)),this.modules.i18nFormat&&(c.i18nFormat=i(this.modules.i18nFormat),c.i18nFormat.init&&c.i18nFormat.init(this)),this.translator=new K2(this.services,this.options),this.translator.on("*",function(d){for(var p=arguments.length,f=new Array(p>1?p-1:0),m=1;m<p;m++)f[m-1]=arguments[m];e.emit(d,...f)}),this.modules.external.forEach(d=>{d.init&&d.init(this)})}if(this.format=this.options.interpolation.format,r||(r=_0),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const l=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);l.length>0&&l[0]!=="dev"&&(this.options.lng=l[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(l=>{this[l]=function(){return e.store[l](...arguments)}}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(l=>{this[l]=function(){return e.store[l](...arguments),e}});const o=sh(),s=()=>{const l=(u,c)=>{this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),o.resolve(c),r(u,c)};if(this.languages&&this.options.compatibilityAPI!=="v1"&&!this.isInitialized)return l(null,this.t.bind(this));this.changeLanguage(this.options.lng,l)};return this.options.resources||!this.options.initImmediate?s():setTimeout(s,0),o}loadResources(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_0;const r=typeof e=="string"?e:this.language;if(typeof e=="function"&&(n=e),!this.options.resources||this.options.partialBundledLanguages){if(r&&r.toLowerCase()==="cimode"&&(!this.options.preload||this.options.preload.length===0))return n();const a=[],i=o=>{!o||o==="cimode"||this.services.languageUtils.toResolveHierarchy(o).forEach(s=>{s!=="cimode"&&a.indexOf(s)<0&&a.push(s)})};r?i(r):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(o=>i(o)),this.options.preload&&this.options.preload.forEach(o=>i(o)),this.services.backendConnector.load(a,this.options.ns,o=>{!o&&!this.resolvedLanguage&&this.language&&this.setResolvedLanguage(this.language),n(o)})}else n(null)}reloadResources(e,n,r){const a=sh();return e||(e=this.languages),n||(n=this.options.ns),r||(r=_0),this.services.backendConnector.reload(e,n,i=>{a.resolve(),r(i)}),a}use(e){if(!e)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!e.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return e.type==="backend"&&(this.modules.backend=e),(e.type==="logger"||e.log&&e.warn&&e.error)&&(this.modules.logger=e),e.type==="languageDetector"&&(this.modules.languageDetector=e),e.type==="i18nFormat"&&(this.modules.i18nFormat=e),e.type==="postProcessor"&&R5.addPostProcessor(e),e.type==="formatter"&&(this.modules.formatter=e),e.type==="3rdParty"&&this.modules.external.push(e),this}setResolvedLanguage(e){if(!(!e||!this.languages)&&!(["cimode","dev"].indexOf(e)>-1))for(let n=0;n<this.languages.length;n++){const r=this.languages[n];if(!(["cimode","dev"].indexOf(r)>-1)&&this.store.hasLanguageSomeTranslations(r)){this.resolvedLanguage=r;break}}}changeLanguage(e,n){var r=this;this.isLanguageChangingTo=e;const a=sh();this.emit("languageChanging",e);const i=l=>{this.language=l,this.languages=this.services.languageUtils.toResolveHierarchy(l),this.resolvedLanguage=void 0,this.setResolvedLanguage(l)},o=(l,u)=>{u?(i(u),this.translator.changeLanguage(u),this.isLanguageChangingTo=void 0,this.emit("languageChanged",u),this.logger.log("languageChanged",u)):this.isLanguageChangingTo=void 0,a.resolve(function(){return r.t(...arguments)}),n&&n(l,function(){return r.t(...arguments)})},s=l=>{!e&&!l&&this.services.languageDetector&&(l=[]);const u=typeof l=="string"?l:this.services.languageUtils.getBestMatchFromCodes(l);u&&(this.language||i(u),this.translator.language||this.translator.changeLanguage(u),this.services.languageDetector&&this.services.languageDetector.cacheUserLanguage&&this.services.languageDetector.cacheUserLanguage(u)),this.loadResources(u,c=>{o(c,u)})};return!e&&this.services.languageDetector&&!this.services.languageDetector.async?s(this.services.languageDetector.detect()):!e&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect.length===0?this.services.languageDetector.detect().then(s):this.services.languageDetector.detect(s):s(e),a}getFixedT(e,n,r){var a=this;const i=function(o,s){let l;if(typeof s!="object"){for(var u=arguments.length,c=new Array(u>2?u-2:0),d=2;d<u;d++)c[d-2]=arguments[d];l=a.options.overloadTranslationOptionHandler([o,s].concat(c))}else l={...s};l.lng=l.lng||i.lng,l.lngs=l.lngs||i.lngs,l.ns=l.ns||i.ns,l.keyPrefix=l.keyPrefix||r||i.keyPrefix;const p=a.options.keySeparator||".";let f;return l.keyPrefix&&Array.isArray(o)?f=o.map(m=>`${l.keyPrefix}${p}${m}`):f=l.keyPrefix?`${l.keyPrefix}${p}${o}`:o,a.t(f,l)};return typeof e=="string"?i.lng=e:i.lngs=e,i.ns=n,i.keyPrefix=r,i}t(){return this.translator&&this.translator.translate(...arguments)}exists(){return this.translator&&this.translator.exists(...arguments)}setDefaultNamespace(e){this.options.defaultNS=e}hasLoadedNamespace(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const r=n.lng||this.resolvedLanguage||this.languages[0],a=this.options?this.options.fallbackLng:!1,i=this.languages[this.languages.length-1];if(r.toLowerCase()==="cimode")return!0;const o=(s,l)=>{const u=this.services.backendConnector.state[`${s}|${l}`];return u===-1||u===2};if(n.precheck){const s=n.precheck(this,o);if(s!==void 0)return s}return!!(this.hasResourceBundle(r,e)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||o(r,e)&&(!a||o(i,e)))}loadNamespaces(e,n){const r=sh();return this.options.ns?(typeof e=="string"&&(e=[e]),e.forEach(a=>{this.options.ns.indexOf(a)<0&&this.options.ns.push(a)}),this.loadResources(a=>{r.resolve(),n&&n(a)}),r):(n&&n(),Promise.resolve())}loadLanguages(e,n){const r=sh();typeof e=="string"&&(e=[e]);const a=this.options.preload||[],i=e.filter(o=>a.indexOf(o)<0);return i.length?(this.options.preload=a.concat(i),this.loadResources(o=>{r.resolve(),n&&n(o)}),r):(n&&n(),Promise.resolve())}dir(e){if(e||(e=this.resolvedLanguage||(this.languages&&this.languages.length>0?this.languages[0]:this.language)),!e)return"rtl";const n=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"],r=this.services&&this.services.languageUtils||new A5(D5());return n.indexOf(r.getLanguagePartFromCode(e))>-1||e.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;return new _m(e,n)}cloneInstance(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_0;const r=e.forkResourceStore;r&&delete e.forkResourceStore;const a={...this.options,...e,isClone:!0},i=new _m(a);return(e.debug!==void 0||e.prefix!==void 0)&&(i.logger=i.logger.clone(e)),["store","services","language"].forEach(o=>{i[o]=this[o]}),i.services={...this.services},i.services.utils={hasLoadedNamespace:i.hasLoadedNamespace.bind(i)},r&&(i.store=new $5(this.store.data,a),i.services.resourceStore=i.store),i.translator=new K2(i.services,a),i.translator.on("*",function(o){for(var s=arguments.length,l=new Array(s>1?s-1:0),u=1;u<s;u++)l[u-1]=arguments[u];i.emit(o,...l)}),i.init(a,n),i.translator.options=a,i.translator.backendConnector.services.utils={hasLoadedNamespace:i.hasLoadedNamespace.bind(i)},i}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const Lr=_m.createInstance();Lr.createInstance=_m.createInstance,Lr.createInstance,Lr.dir,Lr.init,Lr.loadResources,Lr.reloadResources,Lr.use,Lr.changeLanguage,Lr.getFixedT,Lr.t,Lr.exists,Lr.setDefaultNamespace,Lr.hasLoadedNamespace,Lr.loadNamespaces,Lr.loadLanguages;const B5=R.createContext({dragDropManager:void 0});function uh(t){"@babel/helpers - typeof";return uh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},uh(t)}function EV(t,e){if(uh(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(uh(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _V(t){var e=EV(t,"string");return uh(e)=="symbol"?e:String(e)}function OV(t,e,n){return e=_V(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function z5(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),n.push.apply(n,r)}return n}function j5(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?z5(Object(n),!0).forEach(function(r){OV(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):z5(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Jr(t){return"Minified Redux error #"+t+"; visit https://redux.js.org/Errors?code="+t+" for the full message or use the non-minified dev environment for full errors. "}var V5=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}(),hk=function(){return Math.random().toString(36).substring(7).split("").join(".")},O0={INIT:"@@redux/INIT"+hk(),REPLACE:"@@redux/REPLACE"+hk(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+hk()}};function $V(t){if(typeof t!="object"||t===null)return!1;for(var e=t;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e}function fk(t,e,n){var r;if(typeof e=="function"&&typeof n=="function"||typeof n=="function"&&typeof arguments[3]=="function")throw new Error(Jr(0));if(typeof e=="function"&&typeof n>"u"&&(n=e,e=void 0),typeof n<"u"){if(typeof n!="function")throw new Error(Jr(1));return n(fk)(t,e)}if(typeof t!="function")throw new Error(Jr(2));var a=t,i=e,o=[],s=o,l=!1;function u(){s===o&&(s=o.slice())}function c(){if(l)throw new Error(Jr(3));return i}function d(y){if(typeof y!="function")throw new Error(Jr(4));if(l)throw new Error(Jr(5));var x=!0;return u(),s.push(y),function(){if(x){if(l)throw new Error(Jr(6));x=!1,u();var b=s.indexOf(y);s.splice(b,1),o=null}}}function p(y){if(!$V(y))throw new Error(Jr(7));if(typeof y.type>"u")throw new Error(Jr(8));if(l)throw new Error(Jr(9));try{l=!0,i=a(i,y)}finally{l=!1}for(var x=o=s,b=0;b<x.length;b++){var v=x[b];v()}return y}function f(y){if(typeof y!="function")throw new Error(Jr(10));a=y,p({type:O0.REPLACE})}function m(){var y,x=d;return y={subscribe:function(b){if(typeof b!="object"||b===null)throw new Error(Jr(11));function v(){b.next&&b.next(c())}v();var w=x(v);return{unsubscribe:w}}},y[V5]=function(){return this},y}return p({type:O0.INIT}),r={dispatch:p,subscribe:d,getState:c,replaceReducer:f},r[V5]=m,r}function RV(t){Object.keys(t).forEach(function(e){var n=t[e],r=n(void 0,{type:O0.INIT});if(typeof r>"u")throw new Error(Jr(12));if(typeof n(void 0,{type:O0.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(Jr(13))})}function MV(t){for(var e=Object.keys(t),n={},r=0;r<e.length;r++){var a=e[r];typeof t[a]=="function"&&(n[a]=t[a])}var i=Object.keys(n),o;try{RV(n)}catch(s){o=s}return function(s,l){if(s===void 0&&(s={}),o)throw o;for(var u=!1,c={},d=0;d<i.length;d++){var p=i[d],f=n[p],m=s[p],y=f(m,l);if(typeof y>"u")throw l&&l.type,new Error(Jr(14));c[p]=y,u=u||y!==m}return u=u||i.length!==Object.keys(s).length,u?c:s}}function W5(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.length===0?function(r){return r}:e.length===1?e[0]:e.reduce(function(r,a){return function(){return r(a.apply(void 0,arguments))}})}function AV(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(r){return function(){var a=r.apply(void 0,arguments),i=function(){throw new Error(Jr(15))},o={getState:a.getState,dispatch:function(){return i.apply(void 0,arguments)}},s=e.map(function(l){return l(o)});return i=W5.apply(void 0,s)(a.dispatch),j5(j5({},a),{},{dispatch:i})}}}function gt(t,e,...n){if(PV()&&e===void 0)throw new Error("invariant requires an error message argument");if(!t){let r;if(e===void 0)r=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{let a=0;r=new Error(e.replace(/%s/g,function(){return n[a++]})),r.name="Invariant Violation"}throw r.framesToPop=1,r}}function PV(){return typeof process<"u"&&!0}function LV(t,e,n){return e.split(".").reduce((r,a)=>r&&r[a]?r[a]:n||null,t)}function DV(t,e){return t.filter(n=>n!==e)}function U5(t){return typeof t=="object"}function FV(t,e){const n=new Map,r=i=>{n.set(i,n.has(i)?n.get(i)+1:1)};t.forEach(r),e.forEach(r);const a=[];return n.forEach((i,o)=>{i===1&&a.push(o)}),a}function BV(t,e){return t.filter(n=>e.indexOf(n)>-1)}const gk="dnd-core/INIT_COORDS",$0="dnd-core/BEGIN_DRAG",mk="dnd-core/PUBLISH_DRAG_SOURCE",R0="dnd-core/HOVER",M0="dnd-core/DROP",A0="dnd-core/END_DRAG";function G5(t,e){return{type:gk,payload:{sourceClientOffset:e||null,clientOffset:t||null}}}const zV={type:gk,payload:{clientOffset:null,sourceClientOffset:null}};function jV(t){return function(e=[],n={publishSource:!0}){const{publishSource:r=!0,clientOffset:a,getSourceClientOffset:i}=n,o=t.getMonitor(),s=t.getRegistry();t.dispatch(G5(a)),VV(e,o,s);const l=GV(e,o);if(l==null){t.dispatch(zV);return}let u=null;if(a){if(!i)throw new Error("getSourceClientOffset must be defined");WV(i),u=i(l)}t.dispatch(G5(a,u));const c=s.getSource(l).beginDrag(o,l);if(c==null)return;UV(c),s.pinSource(l);const d=s.getSourceType(l);return{type:$0,payload:{itemType:d,item:c,sourceId:l,clientOffset:a||null,sourceClientOffset:u||null,isSourcePublic:!!r}}}}function VV(t,e,n){gt(!e.isDragging(),"Cannot call beginDrag while dragging."),t.forEach(function(r){gt(n.getSource(r),"Expected sourceIds to be registered.")})}function WV(t){gt(typeof t=="function","When clientOffset is provided, getSourceClientOffset must be a function.")}function UV(t){gt(U5(t),"Item must be an object.")}function GV(t,e){let n=null;for(let r=t.length-1;r>=0;r--)if(e.canDragSource(t[r])){n=t[r];break}return n}function HV(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qV(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{},r=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable}))),r.forEach(function(a){HV(t,a,n[a])})}return t}function KV(t){return function(e={}){const n=t.getMonitor(),r=t.getRegistry();XV(n),ZV(n).forEach((a,i)=>{const o=YV(a,i,r,n),s={type:M0,payload:{dropResult:qV({},e,o)}};t.dispatch(s)})}}function XV(t){gt(t.isDragging(),"Cannot call drop while not dragging."),gt(!t.didDrop(),"Cannot call drop twice during one drag operation.")}function YV(t,e,n,r){const a=n.getTarget(t);let i=a?a.drop(r,t):void 0;return QV(i),typeof i>"u"&&(i=e===0?{}:r.getDropResult()),i}function QV(t){gt(typeof t>"u"||U5(t),"Drop result must either be an object or undefined.")}function ZV(t){const e=t.getTargetIds().filter(t.canDropOnTarget,t);return e.reverse(),e}function JV(t){return function(){const e=t.getMonitor(),n=t.getRegistry();eW(e);const r=e.getSourceId();return r!=null&&(n.getSource(r,!0).endDrag(e,r),n.unpinSource()),{type:A0}}}function eW(t){gt(t.isDragging(),"Cannot call endDrag while not dragging.")}function yk(t,e){return e===null?t===null:Array.isArray(t)?t.some(n=>n===e):t===e}function tW(t){return function(e,{clientOffset:n}={}){nW(e);const r=e.slice(0),a=t.getMonitor(),i=t.getRegistry(),o=a.getItemType();return aW(r,i,o),rW(r,a,i),iW(r,a,i),{type:R0,payload:{targetIds:r,clientOffset:n||null}}}}function nW(t){gt(Array.isArray(t),"Expected targetIds to be an array.")}function rW(t,e,n){gt(e.isDragging(),"Cannot call hover while not dragging."),gt(!e.didDrop(),"Cannot call hover after drop.");for(let r=0;r<t.length;r++){const a=t[r];gt(t.lastIndexOf(a)===r,"Expected targetIds to be unique in the passed array.");const i=n.getTarget(a);gt(i,"Expected targetIds to be registered.")}}function aW(t,e,n){for(let r=t.length-1;r>=0;r--){const a=t[r],i=e.getTargetType(a);yk(i,n)||t.splice(r,1)}}function iW(t,e,n){t.forEach(function(r){n.getTarget(r).hover(e,r)})}function oW(t){return function(){if(t.getMonitor().isDragging())return{type:mk}}}function sW(t){return{beginDrag:jV(t),publishDragSource:oW(t),hover:tW(t),drop:KV(t),endDrag:JV(t)}}class lW{receiveBackend(e){this.backend=e}getMonitor(){return this.monitor}getBackend(){return this.backend}getRegistry(){return this.monitor.registry}getActions(){const e=this,{dispatch:n}=this.store;function r(i){return(...o)=>{const s=i.apply(e,o);typeof s<"u"&&n(s)}}const a=sW(this);return Object.keys(a).reduce((i,o)=>{const s=a[o];return i[o]=r(s),i},{})}dispatch(e){this.store.dispatch(e)}constructor(e,n){this.isSetUp=!1,this.handleRefCountChange=()=>{const r=this.store.getState().refCount>0;this.backend&&(r&&!this.isSetUp?(this.backend.setup(),this.isSetUp=!0):!r&&this.isSetUp&&(this.backend.teardown(),this.isSetUp=!1))},this.store=e,this.monitor=n,e.subscribe(this.handleRefCountChange)}}function uW(t,e){return{x:t.x+e.x,y:t.y+e.y}}function H5(t,e){return{x:t.x-e.x,y:t.y-e.y}}function cW(t){const{clientOffset:e,initialClientOffset:n,initialSourceClientOffset:r}=t;return!e||!n||!r?null:H5(uW(e,r),n)}function dW(t){const{clientOffset:e,initialClientOffset:n}=t;return!e||!n?null:H5(e,n)}const ch=[],bk=[];ch.__IS_NONE__=!0,bk.__IS_ALL__=!0;function pW(t,e){return t===ch?!1:t===bk||typeof e>"u"?!0:BV(e,t).length>0}class hW{subscribeToStateChange(e,n={}){const{handlerIds:r}=n;gt(typeof e=="function","listener must be a function."),gt(typeof r>"u"||Array.isArray(r),"handlerIds, when specified, must be an array of strings.");let a=this.store.getState().stateId;const i=()=>{const o=this.store.getState(),s=o.stateId;try{s===a||s===a+1&&!pW(o.dirtyHandlerIds,r)||e()}finally{a=s}};return this.store.subscribe(i)}subscribeToOffsetChange(e){gt(typeof e=="function","listener must be a function.");let n=this.store.getState().dragOffset;const r=()=>{const a=this.store.getState().dragOffset;a!==n&&(n=a,e())};return this.store.subscribe(r)}canDragSource(e){if(!e)return!1;const n=this.registry.getSource(e);return gt(n,`Expected to find a valid source. sourceId=${e}`),this.isDragging()?!1:n.canDrag(this,e)}canDropOnTarget(e){if(!e)return!1;const n=this.registry.getTarget(e);if(gt(n,`Expected to find a valid target. targetId=${e}`),!this.isDragging()||this.didDrop())return!1;const r=this.registry.getTargetType(e),a=this.getItemType();return yk(r,a)&&n.canDrop(this,e)}isDragging(){return!!this.getItemType()}isDraggingSource(e){if(!e)return!1;const n=this.registry.getSource(e,!0);if(gt(n,`Expected to find a valid source. sourceId=${e}`),!this.isDragging()||!this.isSourcePublic())return!1;const r=this.registry.getSourceType(e),a=this.getItemType();return r!==a?!1:n.isDragging(this,e)}isOverTarget(e,n={shallow:!1}){if(!e)return!1;const{shallow:r}=n;if(!this.isDragging())return!1;const a=this.registry.getTargetType(e),i=this.getItemType();if(i&&!yk(a,i))return!1;const o=this.getTargetIds();if(!o.length)return!1;const s=o.indexOf(e);return r?s===o.length-1:s>-1}getItemType(){return this.store.getState().dragOperation.itemType}getItem(){return this.store.getState().dragOperation.item}getSourceId(){return this.store.getState().dragOperation.sourceId}getTargetIds(){return this.store.getState().dragOperation.targetIds}getDropResult(){return this.store.getState().dragOperation.dropResult}didDrop(){return this.store.getState().dragOperation.didDrop}isSourcePublic(){return!!this.store.getState().dragOperation.isSourcePublic}getInitialClientOffset(){return this.store.getState().dragOffset.initialClientOffset}getInitialSourceClientOffset(){return this.store.getState().dragOffset.initialSourceClientOffset}getClientOffset(){return this.store.getState().dragOffset.clientOffset}getSourceClientOffset(){return cW(this.store.getState().dragOffset)}getDifferenceFromInitialOffset(){return dW(this.store.getState().dragOffset)}constructor(e,n){this.store=e,this.registry=n}}const q5=typeof global<"u"?global:self,K5=q5.MutationObserver||q5.WebKitMutationObserver;function X5(t){return function(){const e=setTimeout(r,0),n=setInterval(r,50);function r(){clearTimeout(e),clearInterval(n),t()}}}function fW(t){let e=1;const n=new K5(t),r=document.createTextNode("");return n.observe(r,{characterData:!0}),function(){e=-e,r.data=e}}const gW=typeof K5=="function"?fW:X5;class mW{enqueueTask(e){const{queue:n,requestFlush:r}=this;n.length||(r(),this.flushing=!0),n[n.length]=e}constructor(){this.queue=[],this.pendingErrors=[],this.flushing=!1,this.index=0,this.capacity=1024,this.flush=()=>{const{queue:e}=this;for(;this.index<e.length;){const n=this.index;if(this.index++,e[n].call(),this.index>this.capacity){for(let r=0,a=e.length-this.index;r<a;r++)e[r]=e[r+this.index];e.length-=this.index,this.index=0}}e.length=0,this.index=0,this.flushing=!1},this.registerPendingError=e=>{this.pendingErrors.push(e),this.requestErrorThrow()},this.requestFlush=gW(this.flush),this.requestErrorThrow=X5(()=>{if(this.pendingErrors.length)throw this.pendingErrors.shift()})}}class yW{call(){try{this.task&&this.task()}catch(e){this.onError(e)}finally{this.task=null,this.release(this)}}constructor(e,n){this.onError=e,this.release=n,this.task=null}}class bW{create(e){const n=this.freeTasks,r=n.length?n.pop():new yW(this.onError,a=>n[n.length]=a);return r.task=e,r}constructor(e){this.onError=e,this.freeTasks=[]}}const Y5=new mW,vW=new bW(Y5.registerPendingError);function xW(t){Y5.enqueueTask(vW.create(t))}const vk="dnd-core/ADD_SOURCE",xk="dnd-core/ADD_TARGET",wk="dnd-core/REMOVE_SOURCE",P0="dnd-core/REMOVE_TARGET";function wW(t){return{type:vk,payload:{sourceId:t}}}function kW(t){return{type:xk,payload:{targetId:t}}}function SW(t){return{type:wk,payload:{sourceId:t}}}function CW(t){return{type:P0,payload:{targetId:t}}}function NW(t){gt(typeof t.canDrag=="function","Expected canDrag to be a function."),gt(typeof t.beginDrag=="function","Expected beginDrag to be a function."),gt(typeof t.endDrag=="function","Expected endDrag to be a function.")}function TW(t){gt(typeof t.canDrop=="function","Expected canDrop to be a function."),gt(typeof t.hover=="function","Expected hover to be a function."),gt(typeof t.drop=="function","Expected beginDrag to be a function.")}function kk(t,e){if(e&&Array.isArray(t)){t.forEach(n=>kk(n,!1));return}gt(typeof t=="string"||typeof t=="symbol",e?"Type can only be a string, a symbol, or an array of either.":"Type can only be a string or a symbol.")}var mi;(function(t){t.SOURCE="SOURCE",t.TARGET="TARGET"})(mi||(mi={}));let IW=0;function EW(){return IW++}function _W(t){const e=EW().toString();switch(t){case mi.SOURCE:return`S${e}`;case mi.TARGET:return`T${e}`;default:throw new Error(`Unknown Handler Role: ${t}`)}}function Q5(t){switch(t[0]){case"S":return mi.SOURCE;case"T":return mi.TARGET;default:throw new Error(`Cannot parse handler ID: ${t}`)}}function Z5(t,e){const n=t.entries();let r=!1;do{const{done:a,value:[,i]}=n.next();if(i===e)return!0;r=!!a}while(!r);return!1}class OW{addSource(e,n){kk(e),NW(n);const r=this.addHandler(mi.SOURCE,e,n);return this.store.dispatch(wW(r)),r}addTarget(e,n){kk(e,!0),TW(n);const r=this.addHandler(mi.TARGET,e,n);return this.store.dispatch(kW(r)),r}containsHandler(e){return Z5(this.dragSources,e)||Z5(this.dropTargets,e)}getSource(e,n=!1){return gt(this.isSourceId(e),"Expected a valid source ID."),n&&e===this.pinnedSourceId?this.pinnedSource:this.dragSources.get(e)}getTarget(e){return gt(this.isTargetId(e),"Expected a valid target ID."),this.dropTargets.get(e)}getSourceType(e){return gt(this.isSourceId(e),"Expected a valid source ID."),this.types.get(e)}getTargetType(e){return gt(this.isTargetId(e),"Expected a valid target ID."),this.types.get(e)}isSourceId(e){return Q5(e)===mi.SOURCE}isTargetId(e){return Q5(e)===mi.TARGET}removeSource(e){gt(this.getSource(e),"Expected an existing source."),this.store.dispatch(SW(e)),xW(()=>{this.dragSources.delete(e),this.types.delete(e)})}removeTarget(e){gt(this.getTarget(e),"Expected an existing target."),this.store.dispatch(CW(e)),this.dropTargets.delete(e),this.types.delete(e)}pinSource(e){const n=this.getSource(e);gt(n,"Expected an existing source."),this.pinnedSourceId=e,this.pinnedSource=n}unpinSource(){gt(this.pinnedSource,"No source is pinned at the time."),this.pinnedSourceId=null,this.pinnedSource=null}addHandler(e,n,r){const a=_W(e);return this.types.set(a,n),e===mi.SOURCE?this.dragSources.set(a,r):e===mi.TARGET&&this.dropTargets.set(a,r),a}constructor(e){this.types=new Map,this.dragSources=new Map,this.dropTargets=new Map,this.pinnedSourceId=null,this.pinnedSource=null,this.store=e}}const $W=(t,e)=>t===e;function RW(t,e){return!t&&!e?!0:!t||!e?!1:t.x===e.x&&t.y===e.y}function MW(t,e,n=$W){if(t.length!==e.length)return!1;for(let r=0;r<t.length;++r)if(!n(t[r],e[r]))return!1;return!0}function AW(t=ch,e){switch(e.type){case R0:break;case vk:case xk:case P0:case wk:return ch;case $0:case mk:case A0:case M0:default:return bk}const{targetIds:n=[],prevTargetIds:r=[]}=e.payload,a=FV(n,r);if(!(a.length>0||!MW(n,r)))return ch;const i=r[r.length-1],o=n[n.length-1];return i!==o&&(i&&a.push(i),o&&a.push(o)),a}function PW(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function LW(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{},r=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable}))),r.forEach(function(a){PW(t,a,n[a])})}return t}const J5={initialSourceClientOffset:null,initialClientOffset:null,clientOffset:null};function DW(t=J5,e){const{payload:n}=e;switch(e.type){case gk:case $0:return{initialSourceClientOffset:n.sourceClientOffset,initialClientOffset:n.clientOffset,clientOffset:n.clientOffset};case R0:return RW(t.clientOffset,n.clientOffset)?t:LW({},t,{clientOffset:n.clientOffset});case A0:case M0:return J5;default:return t}}function FW(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Uc(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{},r=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable}))),r.forEach(function(a){FW(t,a,n[a])})}return t}const BW={itemType:null,item:null,sourceId:null,targetIds:[],dropResult:null,didDrop:!1,isSourcePublic:null};function zW(t=BW,e){const{payload:n}=e;switch(e.type){case $0:return Uc({},t,{itemType:n.itemType,item:n.item,sourceId:n.sourceId,isSourcePublic:n.isSourcePublic,dropResult:null,didDrop:!1});case mk:return Uc({},t,{isSourcePublic:!0});case R0:return Uc({},t,{targetIds:n.targetIds});case P0:return t.targetIds.indexOf(n.targetId)===-1?t:Uc({},t,{targetIds:DV(t.targetIds,n.targetId)});case M0:return Uc({},t,{dropResult:n.dropResult,didDrop:!0,targetIds:[]});case A0:return Uc({},t,{itemType:null,item:null,sourceId:null,dropResult:null,didDrop:!1,isSourcePublic:null,targetIds:[]});default:return t}}function jW(t=0,e){switch(e.type){case vk:case xk:return t+1;case wk:case P0:return t-1;default:return t}}function VW(t=0){return t+1}function WW(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function UW(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{},r=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable}))),r.forEach(function(a){WW(t,a,n[a])})}return t}function GW(t={},e){return{dirtyHandlerIds:AW(t.dirtyHandlerIds,{type:e.type,payload:UW({},e.payload,{prevTargetIds:LV(t,"dragOperation.targetIds",[])})}),dragOffset:DW(t.dragOffset,e),refCount:jW(t.refCount,e),dragOperation:zW(t.dragOperation,e),stateId:VW(t.stateId)}}function HW(t,e=void 0,n={},r=!1){const a=qW(r),i=new hW(a,new OW(a)),o=new lW(a,i),s=t(o,e,n);return o.receiveBackend(s),o}function qW(t){const e=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION__;return fk(GW,t&&e&&e({name:"dnd-core",instanceId:"dnd-core"}))}function KW(t,e){if(t==null)return{};var n=XW(t,e),r,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(a=0;a<i.length;a++)r=i[a],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function XW(t,e){if(t==null)return{};var n={},r=Object.keys(t),a,i;for(i=0;i<r.length;i++)a=r[i],!(e.indexOf(a)>=0)&&(n[a]=t[a]);return n}let eO=0;const L0=Symbol.for("__REACT_DND_CONTEXT_INSTANCE__");var YW=R.memo(function(t){var{children:e}=t,n=KW(t,["children"]);const[r,a]=QW(n);return R.useEffect(()=>{if(a){const i=tO();return++eO,()=>{--eO===0&&(i[L0]=null)}}},[]),se.jsx(B5.Provider,{value:r,children:e})});function QW(t){if("manager"in t)return[{dragDropManager:t.manager},!1];const e=ZW(t.backend,t.context,t.options,t.debugMode),n=!t.context;return[e,n]}function ZW(t,e=tO(),n,r){const a=e;return a[L0]||(a[L0]={dragDropManager:HW(t,e,n,r)}),a[L0]}function tO(){return typeof global<"u"?global:window}const JW=R.memo(function({connect:t,src:e}){return R.useEffect(()=>{if(typeof Image>"u")return;let n=!1;const r=new Image;return r.src=e,r.onload=()=>{t(r),n=!0},()=>{n&&t(null)}}),null});var eU=function t(e,n){if(e===n)return!0;if(e&&n&&typeof e=="object"&&typeof n=="object"){if(e.constructor!==n.constructor)return!1;var r,a,i;if(Array.isArray(e)){if(r=e.length,r!=n.length)return!1;for(a=r;a--!==0;)if(!t(e[a],n[a]))return!1;return!0}if(e.constructor===RegExp)return e.source===n.source&&e.flags===n.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===n.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===n.toString();if(i=Object.keys(e),r=i.length,r!==Object.keys(n).length)return!1;for(a=r;a--!==0;)if(!Object.prototype.hasOwnProperty.call(n,i[a]))return!1;for(a=r;a--!==0;){var o=i[a];if(!t(e[o],n[o]))return!1}return!0}return e!==e&&n!==n};const tU=gi(eU),hu=typeof window<"u"?R.useLayoutEffect:R.useEffect;function nU(t,e,n){const[r,a]=R.useState(()=>e(t)),i=R.useCallback(()=>{const o=e(t);tU(r,o)||(a(o),n&&n())},[r,t,n]);return hu(i),[r,i]}function rU(t,e,n){const[r,a]=nU(t,e,n);return hu(function(){const i=t.getHandlerId();if(i!=null)return t.subscribeToStateChange(a,{handlerIds:[i]})},[t,a]),r}function nO(t,e,n){return rU(e,t||(()=>({})),()=>n.reconnect())}function rO(t,e){const n=[...e||[]];return e==null&&typeof t!="function"&&n.push(t),R.useMemo(()=>typeof t=="function"?t():t,n)}function aU(t){return R.useMemo(()=>t.hooks.dragSource(),[t])}function iU(t){return R.useMemo(()=>t.hooks.dragPreview(),[t])}let Sk=!1,Ck=!1;class oU{receiveHandlerId(e){this.sourceId=e}getHandlerId(){return this.sourceId}canDrag(){gt(!Sk,"You may not call monitor.canDrag() inside your canDrag() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor");try{return Sk=!0,this.internalMonitor.canDragSource(this.sourceId)}finally{Sk=!1}}isDragging(){if(!this.sourceId)return!1;gt(!Ck,"You may not call monitor.isDragging() inside your isDragging() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor");try{return Ck=!0,this.internalMonitor.isDraggingSource(this.sourceId)}finally{Ck=!1}}subscribeToStateChange(e,n){return this.internalMonitor.subscribeToStateChange(e,n)}isDraggingSource(e){return this.internalMonitor.isDraggingSource(e)}isOverTarget(e,n){return this.internalMonitor.isOverTarget(e,n)}getTargetIds(){return this.internalMonitor.getTargetIds()}isSourcePublic(){return this.internalMonitor.isSourcePublic()}getSourceId(){return this.internalMonitor.getSourceId()}subscribeToOffsetChange(e){return this.internalMonitor.subscribeToOffsetChange(e)}canDragSource(e){return this.internalMonitor.canDragSource(e)}canDropOnTarget(e){return this.internalMonitor.canDropOnTarget(e)}getItemType(){return this.internalMonitor.getItemType()}getItem(){return this.internalMonitor.getItem()}getDropResult(){return this.internalMonitor.getDropResult()}didDrop(){return this.internalMonitor.didDrop()}getInitialClientOffset(){return this.internalMonitor.getInitialClientOffset()}getInitialSourceClientOffset(){return this.internalMonitor.getInitialSourceClientOffset()}getSourceClientOffset(){return this.internalMonitor.getSourceClientOffset()}getClientOffset(){return this.internalMonitor.getClientOffset()}getDifferenceFromInitialOffset(){return this.internalMonitor.getDifferenceFromInitialOffset()}constructor(e){this.sourceId=null,this.internalMonitor=e.getMonitor()}}let Nk=!1;class sU{receiveHandlerId(e){this.targetId=e}getHandlerId(){return this.targetId}subscribeToStateChange(e,n){return this.internalMonitor.subscribeToStateChange(e,n)}canDrop(){if(!this.targetId)return!1;gt(!Nk,"You may not call monitor.canDrop() inside your canDrop() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drop-target-monitor");try{return Nk=!0,this.internalMonitor.canDropOnTarget(this.targetId)}finally{Nk=!1}}isOver(e){return this.targetId?this.internalMonitor.isOverTarget(this.targetId,e):!1}getItemType(){return this.internalMonitor.getItemType()}getItem(){return this.internalMonitor.getItem()}getDropResult(){return this.internalMonitor.getDropResult()}didDrop(){return this.internalMonitor.didDrop()}getInitialClientOffset(){return this.internalMonitor.getInitialClientOffset()}getInitialSourceClientOffset(){return this.internalMonitor.getInitialSourceClientOffset()}getSourceClientOffset(){return this.internalMonitor.getSourceClientOffset()}getClientOffset(){return this.internalMonitor.getClientOffset()}getDifferenceFromInitialOffset(){return this.internalMonitor.getDifferenceFromInitialOffset()}constructor(e){this.targetId=null,this.internalMonitor=e.getMonitor()}}function lU(t,e,n){const r=n.getRegistry(),a=r.addTarget(t,e);return[a,()=>r.removeTarget(a)]}function uU(t,e,n){const r=n.getRegistry(),a=r.addSource(t,e);return[a,()=>r.removeSource(a)]}function Tk(t,e,n,r){let a=n?n.call(r,t,e):void 0;if(a!==void 0)return!!a;if(t===e)return!0;if(typeof t!="object"||!t||typeof e!="object"||!e)return!1;const i=Object.keys(t),o=Object.keys(e);if(i.length!==o.length)return!1;const s=Object.prototype.hasOwnProperty.bind(e);for(let l=0;l<i.length;l++){const u=i[l];if(!s(u))return!1;const c=t[u],d=e[u];if(a=n?n.call(r,c,d,u):void 0,a===!1||a===void 0&&c!==d)return!1}return!0}function Ik(t){return t!==null&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function cU(t){if(typeof t.type=="string")return;const e=t.type.displayName||t.type.name||"the component";throw new Error(`Only native element nodes can now be passed to React DnD connectors.You can either wrap ${e} into a <div>, or turn it into a drag source or a drop target itself.`)}function dU(t){return(e=null,n=null)=>{if(!R.isValidElement(e)){const a=e;return t(a,n),a}const r=e;return cU(r),pU(r,n?a=>t(a,n):t)}}function aO(t){const e={};return Object.keys(t).forEach(n=>{const r=t[n];if(n.endsWith("Ref"))e[n]=t[n];else{const a=dU(r);e[n]=()=>a}}),e}function iO(t,e){typeof t=="function"?t(e):t.current=e}function pU(t,e){const n=t.ref;return gt(typeof n!="string","Cannot connect React DnD to an element with an existing string ref. Please convert it to use a callback ref instead, or wrap it into a <span> or <div>. Read more: https://reactjs.org/docs/refs-and-the-dom.html#callback-refs"),n?R.cloneElement(t,{ref:r=>{iO(n,r),iO(e,r)}}):R.cloneElement(t,{ref:e})}class hU{receiveHandlerId(e){this.handlerId!==e&&(this.handlerId=e,this.reconnect())}get connectTarget(){return this.dragSource}get dragSourceOptions(){return this.dragSourceOptionsInternal}set dragSourceOptions(e){this.dragSourceOptionsInternal=e}get dragPreviewOptions(){return this.dragPreviewOptionsInternal}set dragPreviewOptions(e){this.dragPreviewOptionsInternal=e}reconnect(){const e=this.reconnectDragSource();this.reconnectDragPreview(e)}reconnectDragSource(){const e=this.dragSource,n=this.didHandlerIdChange()||this.didConnectedDragSourceChange()||this.didDragSourceOptionsChange();return n&&this.disconnectDragSource(),this.handlerId?e?(n&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragSource=e,this.lastConnectedDragSourceOptions=this.dragSourceOptions,this.dragSourceUnsubscribe=this.backend.connectDragSource(this.handlerId,e,this.dragSourceOptions)),n):(this.lastConnectedDragSource=e,n):n}reconnectDragPreview(e=!1){const n=this.dragPreview,r=e||this.didHandlerIdChange()||this.didConnectedDragPreviewChange()||this.didDragPreviewOptionsChange();if(r&&this.disconnectDragPreview(),!!this.handlerId){if(!n){this.lastConnectedDragPreview=n;return}r&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragPreview=n,this.lastConnectedDragPreviewOptions=this.dragPreviewOptions,this.dragPreviewUnsubscribe=this.backend.connectDragPreview(this.handlerId,n,this.dragPreviewOptions))}}didHandlerIdChange(){return this.lastConnectedHandlerId!==this.handlerId}didConnectedDragSourceChange(){return this.lastConnectedDragSource!==this.dragSource}didConnectedDragPreviewChange(){return this.lastConnectedDragPreview!==this.dragPreview}didDragSourceOptionsChange(){return!Tk(this.lastConnectedDragSourceOptions,this.dragSourceOptions)}didDragPreviewOptionsChange(){return!Tk(this.lastConnectedDragPreviewOptions,this.dragPreviewOptions)}disconnectDragSource(){this.dragSourceUnsubscribe&&(this.dragSourceUnsubscribe(),this.dragSourceUnsubscribe=void 0)}disconnectDragPreview(){this.dragPreviewUnsubscribe&&(this.dragPreviewUnsubscribe(),this.dragPreviewUnsubscribe=void 0,this.dragPreviewNode=null,this.dragPreviewRef=null)}get dragSource(){return this.dragSourceNode||this.dragSourceRef&&this.dragSourceRef.current}get dragPreview(){return this.dragPreviewNode||this.dragPreviewRef&&this.dragPreviewRef.current}clearDragSource(){this.dragSourceNode=null,this.dragSourceRef=null}clearDragPreview(){this.dragPreviewNode=null,this.dragPreviewRef=null}constructor(e){this.hooks=aO({dragSource:(n,r)=>{this.clearDragSource(),this.dragSourceOptions=r||null,Ik(n)?this.dragSourceRef=n:this.dragSourceNode=n,this.reconnectDragSource()},dragPreview:(n,r)=>{this.clearDragPreview(),this.dragPreviewOptions=r||null,Ik(n)?this.dragPreviewRef=n:this.dragPreviewNode=n,this.reconnectDragPreview()}}),this.handlerId=null,this.dragSourceRef=null,this.dragSourceOptionsInternal=null,this.dragPreviewRef=null,this.dragPreviewOptionsInternal=null,this.lastConnectedHandlerId=null,this.lastConnectedDragSource=null,this.lastConnectedDragSourceOptions=null,this.lastConnectedDragPreview=null,this.lastConnectedDragPreviewOptions=null,this.backend=e}}class fU{get connectTarget(){return this.dropTarget}reconnect(){const e=this.didHandlerIdChange()||this.didDropTargetChange()||this.didOptionsChange();e&&this.disconnectDropTarget();const n=this.dropTarget;if(this.handlerId){if(!n){this.lastConnectedDropTarget=n;return}e&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDropTarget=n,this.lastConnectedDropTargetOptions=this.dropTargetOptions,this.unsubscribeDropTarget=this.backend.connectDropTarget(this.handlerId,n,this.dropTargetOptions))}}receiveHandlerId(e){e!==this.handlerId&&(this.handlerId=e,this.reconnect())}get dropTargetOptions(){return this.dropTargetOptionsInternal}set dropTargetOptions(e){this.dropTargetOptionsInternal=e}didHandlerIdChange(){return this.lastConnectedHandlerId!==this.handlerId}didDropTargetChange(){return this.lastConnectedDropTarget!==this.dropTarget}didOptionsChange(){return!Tk(this.lastConnectedDropTargetOptions,this.dropTargetOptions)}disconnectDropTarget(){this.unsubscribeDropTarget&&(this.unsubscribeDropTarget(),this.unsubscribeDropTarget=void 0)}get dropTarget(){return this.dropTargetNode||this.dropTargetRef&&this.dropTargetRef.current}clearDropTarget(){this.dropTargetRef=null,this.dropTargetNode=null}constructor(e){this.hooks=aO({dropTarget:(n,r)=>{this.clearDropTarget(),this.dropTargetOptions=r,Ik(n)?this.dropTargetRef=n:this.dropTargetNode=n,this.reconnect()}}),this.handlerId=null,this.dropTargetRef=null,this.dropTargetOptionsInternal=null,this.lastConnectedHandlerId=null,this.lastConnectedDropTarget=null,this.lastConnectedDropTargetOptions=null,this.backend=e}}function Gc(){const{dragDropManager:t}=R.useContext(B5);return gt(t!=null,"Expected drag drop context"),t}function gU(t,e){const n=Gc(),r=R.useMemo(()=>new hU(n.getBackend()),[n]);return hu(()=>(r.dragSourceOptions=t||null,r.reconnect(),()=>r.disconnectDragSource()),[r,t]),hu(()=>(r.dragPreviewOptions=e||null,r.reconnect(),()=>r.disconnectDragPreview()),[r,e]),r}function mU(){const t=Gc();return R.useMemo(()=>new oU(t),[t])}class yU{beginDrag(){const e=this.spec,n=this.monitor;let r=null;return typeof e.item=="object"?r=e.item:typeof e.item=="function"?r=e.item(n):r={},r??null}canDrag(){const e=this.spec,n=this.monitor;return typeof e.canDrag=="boolean"?e.canDrag:typeof e.canDrag=="function"?e.canDrag(n):!0}isDragging(e,n){const r=this.spec,a=this.monitor,{isDragging:i}=r;return i?i(a):n===e.getSourceId()}endDrag(){const e=this.spec,n=this.monitor,r=this.connector,{end:a}=e;a&&a(n.getItem(),n),r.reconnect()}constructor(e,n,r){this.spec=e,this.monitor=n,this.connector=r}}function bU(t,e,n){const r=R.useMemo(()=>new yU(t,e,n),[e,n]);return R.useEffect(()=>{r.spec=t},[t]),r}function vU(t){return R.useMemo(()=>{const e=t.type;return gt(e!=null,"spec.type must be defined"),e},[t])}function xU(t,e,n){const r=Gc(),a=bU(t,e,n),i=vU(t);hu(function(){if(i!=null){const[o,s]=uU(i,a,r);return e.receiveHandlerId(o),n.receiveHandlerId(o),s}},[r,e,n,a,i])}function wU(t,e){const n=rO(t,e);gt(!n.begin,"useDrag::spec.begin was deprecated in v14. Replace spec.begin() with spec.item(). (see more here - https://react-dnd.github.io/react-dnd/docs/api/use-drag)");const r=mU(),a=gU(n.options,n.previewOptions);return xU(n,r,a),[nO(n.collect,r,a),aU(a),iU(a)]}function kU(t){return R.useMemo(()=>t.hooks.dropTarget(),[t])}function SU(t){const e=Gc(),n=R.useMemo(()=>new fU(e.getBackend()),[e]);return hu(()=>(n.dropTargetOptions=t||null,n.reconnect(),()=>n.disconnectDropTarget()),[t]),n}function CU(){const t=Gc();return R.useMemo(()=>new sU(t),[t])}function NU(t){const{accept:e}=t;return R.useMemo(()=>(gt(t.accept!=null,"accept must be defined"),Array.isArray(e)?e:[e]),[e])}class TU{canDrop(){const e=this.spec,n=this.monitor;return e.canDrop?e.canDrop(n.getItem(),n):!0}hover(){const e=this.spec,n=this.monitor;e.hover&&e.hover(n.getItem(),n)}drop(){const e=this.spec,n=this.monitor;if(e.drop)return e.drop(n.getItem(),n)}constructor(e,n){this.spec=e,this.monitor=n}}function IU(t,e){const n=R.useMemo(()=>new TU(t,e),[e]);return R.useEffect(()=>{n.spec=t},[t]),n}function EU(t,e,n){const r=Gc(),a=IU(t,e),i=NU(t);hu(function(){const[o,s]=lU(i,a,r);return e.receiveHandlerId(o),n.receiveHandlerId(o),s},[r,e,a,n,i.map(o=>o.toString()).join("|")])}function _U(t,e){const n=rO(t,e),r=CU(),a=SU(n.options);return EU(n,r,a),[nO(n.collect,r,a),kU(a)]}var Xs;(function(t){t.mouse="mouse",t.touch="touch",t.keyboard="keyboard"})(Xs||(Xs={}));class OU{get delay(){var e;return(e=this.args.delay)!==null&&e!==void 0?e:0}get scrollAngleRanges(){return this.args.scrollAngleRanges}get getDropTargetElementsAtPoint(){return this.args.getDropTargetElementsAtPoint}get ignoreContextMenu(){var e;return(e=this.args.ignoreContextMenu)!==null&&e!==void 0?e:!1}get enableHoverOutsideTarget(){var e;return(e=this.args.enableHoverOutsideTarget)!==null&&e!==void 0?e:!1}get enableKeyboardEvents(){var e;return(e=this.args.enableKeyboardEvents)!==null&&e!==void 0?e:!1}get enableMouseEvents(){var e;return(e=this.args.enableMouseEvents)!==null&&e!==void 0?e:!1}get enableTouchEvents(){var e;return(e=this.args.enableTouchEvents)!==null&&e!==void 0?e:!0}get touchSlop(){return this.args.touchSlop||0}get delayTouchStart(){var e,n,r,a;return(a=(r=(e=this.args)===null||e===void 0?void 0:e.delayTouchStart)!==null&&r!==void 0?r:(n=this.args)===null||n===void 0?void 0:n.delay)!==null&&a!==void 0?a:0}get delayMouseStart(){var e,n,r,a;return(a=(r=(e=this.args)===null||e===void 0?void 0:e.delayMouseStart)!==null&&r!==void 0?r:(n=this.args)===null||n===void 0?void 0:n.delay)!==null&&a!==void 0?a:0}get window(){if(this.context&&this.context.window)return this.context.window;if(typeof window<"u")return window}get document(){var e;if(!((e=this.context)===null||e===void 0)&&e.document)return this.context.document;if(this.window)return this.window.document}get rootElement(){var e;return((e=this.args)===null||e===void 0?void 0:e.rootElement)||this.document}constructor(e,n){this.args=e,this.context=n}}function $U(t,e,n,r){return Math.sqrt(Math.pow(Math.abs(n-t),2)+Math.pow(Math.abs(r-e),2))}function RU(t,e,n,r,a){if(!a)return!1;const i=Math.atan2(r-e,n-t)*180/Math.PI+180;for(let o=0;o<a.length;++o){const s=a[o];if(s&&(s.start==null||i>=s.start)&&(s.end==null||i<=s.end))return!0}return!1}const MU={Left:1,Right:2,Center:4},AU={Left:0,Center:1,Right:2};function Ek(t){return t.button===void 0||t.button===AU.Left}function PU(t){return t.buttons===void 0||(t.buttons&MU.Left)===0}function oO(t){return!!t.targetTouches}const LU=1;function DU(t){const e=t.nodeType===LU?t:t.parentElement;if(!e)return;const{top:n,left:r}=e.getBoundingClientRect();return{x:r,y:n}}function FU(t,e){if(t.targetTouches.length===1)return D0(t.targetTouches[0]);if(e&&t.touches.length===1&&t.touches[0].target===e.target)return D0(t.touches[0])}function D0(t,e){return oO(t)?FU(t,e):{x:t.clientX,y:t.clientY}}const sO=(()=>{let t=!1;try{addEventListener("test",()=>{},Object.defineProperty({},"passive",{get(){return t=!0,!0}}))}catch{}return t})(),dh={[Xs.mouse]:{start:"mousedown",move:"mousemove",end:"mouseup",contextmenu:"contextmenu"},[Xs.touch]:{start:"touchstart",move:"touchmove",end:"touchend"},[Xs.keyboard]:{keydown:"keydown"}};class Em{profile(){var e;return{sourceNodes:this.sourceNodes.size,sourcePreviewNodes:this.sourcePreviewNodes.size,sourcePreviewNodeOptions:this.sourcePreviewNodeOptions.size,targetNodes:this.targetNodes.size,dragOverTargetIds:((e=this.dragOverTargetIds)===null||e===void 0?void 0:e.length)||0}}get document(){return this.options.document}setup(){const e=this.options.rootElement;e&&(gt(!Em.isSetUp,"Cannot have two Touch backends at the same time."),Em.isSetUp=!0,this.addEventListener(e,"start",this.getTopMoveStartHandler()),this.addEventListener(e,"start",this.handleTopMoveStartCapture,!0),this.addEventListener(e,"move",this.handleTopMove),this.addEventListener(e,"move",this.handleTopMoveCapture,!0),this.addEventListener(e,"end",this.handleTopMoveEndCapture,!0),this.options.enableMouseEvents&&!this.options.ignoreContextMenu&&this.addEventListener(e,"contextmenu",this.handleTopMoveEndCapture),this.options.enableKeyboardEvents&&this.addEventListener(e,"keydown",this.handleCancelOnEscape,!0))}teardown(){const e=this.options.rootElement;e&&(Em.isSetUp=!1,this._mouseClientOffset={},this.removeEventListener(e,"start",this.handleTopMoveStartCapture,!0),this.removeEventListener(e,"start",this.handleTopMoveStart),this.removeEventListener(e,"move",this.handleTopMoveCapture,!0),this.removeEventListener(e,"move",this.handleTopMove),this.removeEventListener(e,"end",this.handleTopMoveEndCapture,!0),this.options.enableMouseEvents&&!this.options.ignoreContextMenu&&this.removeEventListener(e,"contextmenu",this.handleTopMoveEndCapture),this.options.enableKeyboardEvents&&this.removeEventListener(e,"keydown",this.handleCancelOnEscape,!0),this.uninstallSourceNodeRemovalObserver())}addEventListener(e,n,r,a=!1){const i=sO?{capture:a,passive:!1}:a;this.listenerTypes.forEach(function(o){const s=dh[o][n];s&&e.addEventListener(s,r,i)})}removeEventListener(e,n,r,a=!1){const i=sO?{capture:a,passive:!1}:a;this.listenerTypes.forEach(function(o){const s=dh[o][n];s&&e.removeEventListener(s,r,i)})}connectDragSource(e,n){const r=this.handleMoveStart.bind(this,e);return this.sourceNodes.set(e,n),this.addEventListener(n,"start",r),()=>{this.sourceNodes.delete(e),this.removeEventListener(n,"start",r)}}connectDragPreview(e,n,r){return this.sourcePreviewNodeOptions.set(e,r),this.sourcePreviewNodes.set(e,n),()=>{this.sourcePreviewNodes.delete(e),this.sourcePreviewNodeOptions.delete(e)}}connectDropTarget(e,n){const r=this.options.rootElement;if(!this.document||!r)return()=>{};const a=i=>{if(!this.document||!r||!this.monitor.isDragging())return;let o;switch(i.type){case dh.mouse.move:o={x:i.clientX,y:i.clientY};break;case dh.touch.move:var s,l;o={x:((s=i.touches[0])===null||s===void 0?void 0:s.clientX)||0,y:((l=i.touches[0])===null||l===void 0?void 0:l.clientY)||0};break}const u=o!=null?this.document.elementFromPoint(o.x,o.y):void 0,c=u&&n.contains(u);if(u===n||c)return this.handleMove(i,e)};return this.addEventListener(this.document.body,"move",a),this.targetNodes.set(e,n),()=>{this.document&&(this.targetNodes.delete(e),this.removeEventListener(this.document.body,"move",a))}}getTopMoveStartHandler(){return!this.options.delayTouchStart&&!this.options.delayMouseStart?this.handleTopMoveStart:this.handleTopMoveStartDelay}installSourceNodeRemovalObserver(e){this.uninstallSourceNodeRemovalObserver(),this.draggedSourceNode=e,this.draggedSourceNodeRemovalObserver=new MutationObserver(()=>{e&&!e.parentElement&&(this.resurrectSourceNode(),this.uninstallSourceNodeRemovalObserver())}),!(!e||!e.parentElement)&&this.draggedSourceNodeRemovalObserver.observe(e.parentElement,{childList:!0})}resurrectSourceNode(){this.document&&this.draggedSourceNode&&(this.draggedSourceNode.style.display="none",this.draggedSourceNode.removeAttribute("data-reactid"),this.document.body.appendChild(this.draggedSourceNode))}uninstallSourceNodeRemovalObserver(){this.draggedSourceNodeRemovalObserver&&this.draggedSourceNodeRemovalObserver.disconnect(),this.draggedSourceNodeRemovalObserver=void 0,this.draggedSourceNode=void 0}constructor(e,n,r){this.getSourceClientOffset=a=>{const i=this.sourceNodes.get(a);return i&&DU(i)},this.handleTopMoveStartCapture=a=>{Ek(a)&&(this.moveStartSourceIds=[])},this.handleMoveStart=a=>{Array.isArray(this.moveStartSourceIds)&&this.moveStartSourceIds.unshift(a)},this.handleTopMoveStart=a=>{if(!Ek(a))return;const i=D0(a);i&&(oO(a)&&(this.lastTargetTouchFallback=a.targetTouches[0]),this._mouseClientOffset=i),this.waitingForDelay=!1},this.handleTopMoveStartDelay=a=>{if(!Ek(a))return;const i=a.type===dh.touch.start?this.options.delayTouchStart:this.options.delayMouseStart;this.timeout=setTimeout(this.handleTopMoveStart.bind(this,a),i),this.waitingForDelay=!0},this.handleTopMoveCapture=()=>{this.dragOverTargetIds=[]},this.handleMove=(a,i)=>{this.dragOverTargetIds&&this.dragOverTargetIds.unshift(i)},this.handleTopMove=a=>{if(this.timeout&&clearTimeout(this.timeout),!this.document||this.waitingForDelay)return;const{moveStartSourceIds:i,dragOverTargetIds:o}=this,s=this.options.enableHoverOutsideTarget,l=D0(a,this.lastTargetTouchFallback);if(!l)return;if(this._isScrolling||!this.monitor.isDragging()&&RU(this._mouseClientOffset.x||0,this._mouseClientOffset.y||0,l.x,l.y,this.options.scrollAngleRanges)){this._isScrolling=!0;return}if(!this.monitor.isDragging()&&this._mouseClientOffset.hasOwnProperty("x")&&i&&$U(this._mouseClientOffset.x||0,this._mouseClientOffset.y||0,l.x,l.y)>(this.options.touchSlop?this.options.touchSlop:0)&&(this.moveStartSourceIds=void 0,this.actions.beginDrag(i,{clientOffset:this._mouseClientOffset,getSourceClientOffset:this.getSourceClientOffset,publishSource:!1})),!this.monitor.isDragging())return;const u=this.sourceNodes.get(this.monitor.getSourceId());this.installSourceNodeRemovalObserver(u),this.actions.publishDragSource(),a.cancelable&&a.preventDefault();const c=(o||[]).map(m=>this.targetNodes.get(m)).filter(m=>!!m),d=this.options.getDropTargetElementsAtPoint?this.options.getDropTargetElementsAtPoint(l.x,l.y,c):this.document.elementsFromPoint(l.x,l.y),p=[];for(const m in d){if(!d.hasOwnProperty(m))continue;let y=d[m];for(y!=null&&p.push(y);y;)y=y.parentElement,y&&p.indexOf(y)===-1&&p.push(y)}const f=p.filter(m=>c.indexOf(m)>-1).map(m=>this._getDropTargetId(m)).filter(m=>!!m).filter((m,y,x)=>x.indexOf(m)===y);if(s)for(const m in this.targetNodes){const y=this.targetNodes.get(m);if(u&&y&&y.contains(u)&&f.indexOf(m)===-1){f.unshift(m);break}}f.reverse(),this.actions.hover(f,{clientOffset:l})},this._getDropTargetId=a=>{const i=this.targetNodes.keys();let o=i.next();for(;o.done===!1;){const s=o.value;if(a===this.targetNodes.get(s))return s;o=i.next()}},this.handleTopMoveEndCapture=a=>{if(this._isScrolling=!1,this.lastTargetTouchFallback=void 0,!!PU(a)){if(!this.monitor.isDragging()||this.monitor.didDrop()){this.moveStartSourceIds=void 0;return}a.cancelable&&a.preventDefault(),this._mouseClientOffset={},this.uninstallSourceNodeRemovalObserver(),this.actions.drop(),this.actions.endDrag()}},this.handleCancelOnEscape=a=>{a.key==="Escape"&&this.monitor.isDragging()&&(this._mouseClientOffset={},this.uninstallSourceNodeRemovalObserver(),this.actions.endDrag())},this.options=new OU(r,n),this.actions=e.getActions(),this.monitor=e.getMonitor(),this.sourceNodes=new Map,this.sourcePreviewNodes=new Map,this.sourcePreviewNodeOptions=new Map,this.targetNodes=new Map,this.listenerTypes=[],this._mouseClientOffset={},this._isScrolling=!1,this.options.enableMouseEvents&&this.listenerTypes.push(Xs.mouse),this.options.enableTouchEvents&&this.listenerTypes.push(Xs.touch),this.options.enableKeyboardEvents&&this.listenerTypes.push(Xs.keyboard)}}const BU=function(t,e={},n={}){return new Em(t,e,n)};var lO={exports:{}},Xa={},uO={exports:{}},cO={};/**
* @license React
* scheduler.production.min.js
*
* Copyright (c) Facebook, Inc. and its affiliates.
*
* This source code is licensed under the MIT license found in the
* LICENSE file in the root directory of this source tree.
*/(function(t){function e(F,Y){var Q=F.length;F.push(Y);e:for(;0<Q;){var ne=Q-1>>>1,le=F[ne];if(0<a(le,Y))F[ne]=Y,F[Q]=le,Q=ne;else break e}}function n(F){return F.length===0?null:F[0]}function r(F){if(F.length===0)return null;var Y=F[0],Q=F.pop();if(Q!==Y){F[0]=Q;e:for(var ne=0,le=F.length,de=le>>>1;ne<de;){var re=2*(ne+1)-1,he=F[re],ve=re+1,H=F[ve];if(0>a(he,Q))ve<le&&0>a(H,he)?(F[ne]=H,F[ve]=Q,ne=ve):(F[ne]=he,F[re]=Q,ne=re);else if(ve<le&&0>a(H,Q))F[ne]=H,F[ve]=Q,ne=ve;else break e}}return Y}function a(F,Y){var Q=F.sortIndex-Y.sortIndex;return Q!==0?Q:F.id-Y.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,s=o.now();t.unstable_now=function(){return o.now()-s}}var l=[],u=[],c=1,d=null,p=3,f=!1,m=!1,y=!1,x=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(F){for(var Y=n(u);Y!==null;){if(Y.callback===null)r(u);else if(Y.startTime<=F)r(u),Y.sortIndex=Y.expirationTime,e(l,Y);else break;Y=n(u)}}function S(F){if(y=!1,w(F),!m)if(n(l)!==null)m=!0,Z(C);else{var Y=n(u);Y!==null&&q(S,Y.startTime-F)}}function C(F,Y){m=!1,y&&(y=!1,b(E),E=-1),f=!0;var Q=p;try{for(w(Y),d=n(l);d!==null&&(!(d.expirationTime>Y)||F&&!D());){var ne=d.callback;if(typeof ne=="function"){d.callback=null,p=d.priorityLevel;var le=ne(d.expirationTime<=Y);Y=t.unstable_now(),typeof le=="function"?d.callback=le:d===n(l)&&r(l),w(Y)}else r(l);d=n(l)}if(d!==null)var de=!0;else{var re=n(u);re!==null&&q(S,re.startTime-Y),de=!1}return de}finally{d=null,p=Q,f=!1}}var I=!1,_=null,E=-1,P=5,A=-1;function D(){return!(t.unstable_now()-A<P)}function V(){if(_!==null){var F=t.unstable_now();A=F;var Y=!0;try{Y=_(!0,F)}finally{Y?z():(I=!1,_=null)}}else I=!1}var z;if(typeof v=="function")z=function(){v(V)};else if(typeof MessageChannel<"u"){var K=new MessageChannel,X=K.port2;K.port1.onmessage=V,z=function(){X.postMessage(null)}}else z=function(){x(V,0)};function Z(F){_=F,I||(I=!0,z())}function q(F,Y){E=x(function(){F(t.unstable_now())},Y)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(F){F.callback=null},t.unstable_continueExecution=function(){m||f||(m=!0,Z(C))},t.unstable_forceFrameRate=function(F){0>F||125<F?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<F?Math.floor(1e3/F):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(F){switch(p){case 1:case 2:case 3:var Y=3;break;default:Y=p}var Q=p;p=Y;try{return F()}finally{p=Q}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(F,Y){switch(F){case 1:case 2:case 3:case 4:case 5:break;default:F=3}var Q=p;p=F;try{return Y()}finally{p=Q}},t.unstable_scheduleCallback=function(F,Y,Q){var ne=t.unstable_now();switch(typeof Q=="object"&&Q!==null?(Q=Q.delay,Q=typeof Q=="number"&&0<Q?ne+Q:ne):Q=ne,F){case 1:var le=-1;break;case 2:le=250;break;case 5:le=1073741823;break;case 4:le=1e4;break;default:le=5e3}return le=Q+le,F={id:c++,callback:Y,priorityLevel:F,startTime:Q,expirationTime:le,sortIndex:-1},Q>ne?(F.sortIndex=Q,e(u,F),n(l)===null&&F===n(u)&&(y?(b(E),E=-1):y=!0,q(S,Q-ne))):(F.sortIndex=le,e(l,F),m||f||(m=!0,Z(C))),F},t.unstable_shouldYield=D,t.unstable_wrapCallback=function(F){var Y=p;return function(){var Q=p;p=Y;try{return F.apply(this,arguments)}finally{p=Q}}}})(cO),uO.exports=cO;var ph=uO.exports;/**
* @license React
* react-dom.production.min.js
*
* Copyright (c) Facebook, Inc. and its affiliates.
*
* This source code is licensed under the MIT license found in the
* LICENSE file in the root directory of this source tree.
*/var dO=R,Ya=ph;function Se(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var pO=new Set,hh={};function fu(t,e){Hc(t,e),Hc(t+"Capture",e)}function Hc(t,e){for(hh[t]=e,t=0;t<e.length;t++)pO.add(e[t])}var ns=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),_k=Object.prototype.hasOwnProperty,zU=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,hO={},fO={};function jU(t){return _k.call(fO,t)?!0:_k.call(hO,t)?!1:zU.test(t)?fO[t]=!0:(hO[t]=!0,!1)}function VU(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function WU(t,e,n,r){if(e===null||typeof e>"u"||VU(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function xa(t,e,n,r,a,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var Dr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Dr[t]=new xa(t,0,!1,t,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Dr[e]=new xa(e,1,!1,t[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(t){Dr[t]=new xa(t,2,!1,t.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Dr[t]=new xa(t,2,!1,t,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Dr[t]=new xa(t,3,!1,t.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(t){Dr[t]=new xa(t,3,!0,t,null,!1,!1)}),["capture","download"].forEach(function(t){Dr[t]=new xa(t,4,!1,t,null,!1,!1)}),["cols","rows","size","span"].forEach(function(t){Dr[t]=new xa(t,6,!1,t,null,!1,!1)}),["rowSpan","start"].forEach(function(t){Dr[t]=new xa(t,5,!1,t.toLowerCase(),null,!1,!1)});var Ok=/[\-:]([a-z])/g;function $k(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Ok,$k);Dr[e]=new xa(e,1,!1,t,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Ok,$k);Dr[e]=new xa(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Ok,$k);Dr[e]=new xa(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(t){Dr[t]=new xa(t,1,!1,t.toLowerCase(),null,!1,!1)}),Dr.xlinkHref=new xa("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(t){Dr[t]=new xa(t,1,!1,t.toLowerCase(),null,!0,!0)});function Rk(t,e,n,r){var a=Dr.hasOwnProperty(e)?Dr[e]:null;(a!==null?a.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(WU(e,n,a,r)&&(n=null),r||a===null?jU(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):a.mustUseProperty?t[a.propertyName]=n===null?a.type===3?!1:"":n:(e=a.attributeName,r=a.attributeNamespace,n===null?t.removeAttribute(e):(a=a.type,n=a===3||a===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var rs=dO.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,F0=Symbol.for("react.element"),qc=Symbol.for("react.portal"),Kc=Symbol.for("react.fragment"),Mk=Symbol.for("react.strict_mode"),Ak=Symbol.for("react.profiler"),gO=Symbol.for("react.provider"),mO=Symbol.for("react.context"),Pk=Symbol.for("react.forward_ref"),Lk=Symbol.for("react.suspense"),Dk=Symbol.for("react.suspense_list"),Fk=Symbol.for("react.memo"),Ys=Symbol.for("react.lazy"),yO=Symbol.for("react.offscreen"),bO=Symbol.iterator;function fh(t){return t===null||typeof t!="object"?null:(t=bO&&t[bO]||t["@@iterator"],typeof t=="function"?t:null)}var Rn=Object.assign,Bk;function gh(t){if(Bk===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Bk=e&&e[1]||""}return`
`+Bk+t}var zk=!1;function jk(t,e){if(!t||zk)return"";zk=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var a=u.stack.split(`
`),i=r.stack.split(`
`),o=a.length-1,s=i.length-1;1<=o&&0<=s&&a[o]!==i[s];)s--;for(;1<=o&&0<=s;o--,s--)if(a[o]!==i[s]){if(o!==1||s!==1)do if(o--,s--,0>s||a[o]!==i[s]){var l=`
`+a[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=s);break}}}finally{zk=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?gh(t):""}function UU(t){switch(t.tag){case 5:return gh(t.type);case 16:return gh("Lazy");case 13:return gh("Suspense");case 19:return gh("SuspenseList");case 0:case 2:case 15:return t=jk(t.type,!1),t;case 11:return t=jk(t.type.render,!1),t;case 1:return t=jk(t.type,!0),t;default:return""}}function Vk(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Kc:return"Fragment";case qc:return"Portal";case Ak:return"Profiler";case Mk:return"StrictMode";case Lk:return"Suspense";case Dk:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case mO:return(t.displayName||"Context")+".Consumer";case gO:return(t._context.displayName||"Context")+".Provider";case Pk:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Fk:return e=t.displayName||null,e!==null?e:Vk(t.type)||"Memo";case Ys:e=t._payload,t=t._init;try{return Vk(t(e))}catch{}}return null}function GU(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Vk(e);case 8:return e===Mk?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Qs(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function vO(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function HU(t){var e=vO(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var a=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return a.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function B0(t){t._valueTracker||(t._valueTracker=HU(t))}function xO(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=vO(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function z0(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Wk(t,e){var n=e.checked;return Rn({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function wO(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Qs(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function kO(t,e){e=e.checked,e!=null&&Rk(t,"checked",e,!1)}function Uk(t,e){kO(t,e);var n=Qs(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Gk(t,e.type,n):e.hasOwnProperty("defaultValue")&&Gk(t,e.type,Qs(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function SO(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Gk(t,e,n){(e!=="number"||z0(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var mh=Array.isArray;function Xc(t,e,n,r){if(t=t.options,e){e={};for(var a=0;a<n.length;a++)e["$"+n[a]]=!0;for(n=0;n<t.length;n++)a=e.hasOwnProperty("$"+t[n].value),t[n].selected!==a&&(t[n].selected=a),a&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Qs(n),e=null,a=0;a<t.length;a++){if(t[a].value===n){t[a].selected=!0,r&&(t[a].defaultSelected=!0);return}e!==null||t[a].disabled||(e=t[a])}e!==null&&(e.selected=!0)}}function Hk(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Se(91));return Rn({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function CO(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(Se(92));if(mh(n)){if(1<n.length)throw Error(Se(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Qs(n)}}function NO(t,e){var n=Qs(e.value),r=Qs(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function TO(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function IO(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function qk(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?IO(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var j0,EO=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,a){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,a)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(j0=j0||document.createElement("div"),j0.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=j0.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function yh(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var bh={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},qU=["Webkit","ms","Moz","O"];Object.keys(bh).forEach(function(t){qU.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),bh[e]=bh[t]})});function _O(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||bh.hasOwnProperty(t)&&bh[t]?(""+e).trim():e+"px"}function OO(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,a=_O(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,a):t[n]=a}}var KU=Rn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Kk(t,e){if(e){if(KU[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Se(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Se(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Se(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Se(62))}}function Xk(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Yk=null;function Qk(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Zk=null,Yc=null,Qc=null;function $O(t){if(t=zh(t)){if(typeof Zk!="function")throw Error(Se(280));var e=t.stateNode;e&&(e=c1(e),Zk(t.stateNode,t.type,e))}}function RO(t){Yc?Qc?Qc.push(t):Qc=[t]:Yc=t}function MO(){if(Yc){var t=Yc,e=Qc;if(Qc=Yc=null,$O(t),e)for(t=0;t<e.length;t++)$O(e[t])}}function AO(t,e){return t(e)}function PO(){}var Jk=!1;function LO(t,e,n){if(Jk)return t(e,n);Jk=!0;try{return AO(t,e,n)}finally{Jk=!1,(Yc!==null||Qc!==null)&&(PO(),MO())}}function vh(t,e){var n=t.stateNode;if(n===null)return null;var r=c1(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(Se(231,e,typeof n));return n}var eS=!1;if(ns)try{var xh={};Object.defineProperty(xh,"passive",{get:function(){eS=!0}}),window.addEventListener("test",xh,xh),window.removeEventListener("test",xh,xh)}catch{eS=!1}function XU(t,e,n,r,a,i,o,s,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(c){this.onError(c)}}var wh=!1,V0=null,W0=!1,tS=null,YU={onError:function(t){wh=!0,V0=t}};function QU(t,e,n,r,a,i,o,s,l){wh=!1,V0=null,XU.apply(YU,arguments)}function ZU(t,e,n,r,a,i,o,s,l){if(QU.apply(this,arguments),wh){if(wh){var u=V0;wh=!1,V0=null}else throw Error(Se(198));W0||(W0=!0,tS=u)}}function gu(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function DO(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function FO(t){if(gu(t)!==t)throw Error(Se(188))}function JU(t){var e=t.alternate;if(!e){if(e=gu(t),e===null)throw Error(Se(188));return e!==t?null:t}for(var n=t,r=e;;){var a=n.return;if(a===null)break;var i=a.alternate;if(i===null){if(r=a.return,r!==null){n=r;continue}break}if(a.child===i.child){for(i=a.child;i;){if(i===n)return FO(a),t;if(i===r)return FO(a),e;i=i.sibling}throw Error(Se(188))}if(n.return!==r.return)n=a,r=i;else{for(var o=!1,s=a.child;s;){if(s===n){o=!0,n=a,r=i;break}if(s===r){o=!0,r=a,n=i;break}s=s.sibling}if(!o){for(s=i.child;s;){if(s===n){o=!0,n=i,r=a;break}if(s===r){o=!0,r=i,n=a;break}s=s.sibling}if(!o)throw Error(Se(189))}}if(n.alternate!==r)throw Error(Se(190))}if(n.tag!==3)throw Error(Se(188));return n.stateNode.current===n?t:e}function BO(t){return t=JU(t),t!==null?zO(t):null}function zO(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=zO(t);if(e!==null)return e;t=t.sibling}return null}var jO=Ya.unstable_scheduleCallback,VO=Ya.unstable_cancelCallback,eG=Ya.unstable_shouldYield,tG=Ya.unstable_requestPaint,Kn=Ya.unstable_now,nG=Ya.unstable_getCurrentPriorityLevel,nS=Ya.unstable_ImmediatePriority,WO=Ya.unstable_UserBlockingPriority,U0=Ya.unstable_NormalPriority,rG=Ya.unstable_LowPriority,UO=Ya.unstable_IdlePriority,G0=null,Co=null;function aG(t){if(Co&&typeof Co.onCommitFiberRoot=="function")try{Co.onCommitFiberRoot(G0,t,void 0,(t.current.flags&128)===128)}catch{}}var qi=Math.clz32?Math.clz32:sG,iG=Math.log,oG=Math.LN2;function sG(t){return t>>>=0,t===0?32:31-(iG(t)/oG|0)|0}var H0=64,q0=4194304;function kh(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function K0(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,a=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var s=o&~a;s!==0?r=kh(s):(i&=o,i!==0&&(r=kh(i)))}else o=n&~a,o!==0?r=kh(o):i!==0&&(r=kh(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&a)&&(a=r&-r,i=e&-e,a>=i||a===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-qi(e),a=1<<n,r|=t[n],e&=~a;return r}function lG(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function uG(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,a=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-qi(i),s=1<<o,l=a[o];l===-1?(!(s&n)||s&r)&&(a[o]=lG(s,e)):l<=e&&(t.expiredLanes|=s),i&=~s}}function rS(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function GO(){var t=H0;return H0<<=1,!(H0&4194240)&&(H0=64),t}function aS(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Sh(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-qi(e),t[e]=n}function cG(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var a=31-qi(n),i=1<<a;e[a]=0,r[a]=-1,t[a]=-1,n&=~i}}function iS(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-qi(n),a=1<<r;a&e|t[r]&e&&(t[r]|=e),n&=~a}}var Zt=0;function HO(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var qO,oS,KO,XO,YO,sS=!1,X0=[],Zs=null,Js=null,el=null,Ch=new Map,Nh=new Map,tl=[],dG="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function QO(t,e){switch(t){case"focusin":case"focusout":Zs=null;break;case"dragenter":case"dragleave":Js=null;break;case"mouseover":case"mouseout":el=null;break;case"pointerover":case"pointerout":Ch.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Nh.delete(e.pointerId)}}function Th(t,e,n,r,a,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[a]},e!==null&&(e=zh(e),e!==null&&oS(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,a!==null&&e.indexOf(a)===-1&&e.push(a),t)}function pG(t,e,n,r,a){switch(e){case"focusin":return Zs=Th(Zs,t,e,n,r,a),!0;case"dragenter":return Js=Th(Js,t,e,n,r,a),!0;case"mouseover":return el=Th(el,t,e,n,r,a),!0;case"pointerover":var i=a.pointerId;return Ch.set(i,Th(Ch.get(i)||null,t,e,n,r,a)),!0;case"gotpointercapture":return i=a.pointerId,Nh.set(i,Th(Nh.get(i)||null,t,e,n,r,a)),!0}return!1}function ZO(t){var e=mu(t.target);if(e!==null){var n=gu(e);if(n!==null){if(e=n.tag,e===13){if(e=DO(n),e!==null){t.blockedOn=e,YO(t.priority,function(){KO(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Y0(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=uS(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Yk=r,n.target.dispatchEvent(r),Yk=null}else return e=zh(n),e!==null&&oS(e),t.blockedOn=n,!1;e.shift()}return!0}function JO(t,e,n){Y0(t)&&n.delete(e)}function hG(){sS=!1,Zs!==null&&Y0(Zs)&&(Zs=null),Js!==null&&Y0(Js)&&(Js=null),el!==null&&Y0(el)&&(el=null),Ch.forEach(JO),Nh.forEach(JO)}function Ih(t,e){t.blockedOn===e&&(t.blockedOn=null,sS||(sS=!0,Ya.unstable_scheduleCallback(Ya.unstable_NormalPriority,hG)))}function Eh(t){function e(a){return Ih(a,t)}if(0<X0.length){Ih(X0[0],t);for(var n=1;n<X0.length;n++){var r=X0[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Zs!==null&&Ih(Zs,t),Js!==null&&Ih(Js,t),el!==null&&Ih(el,t),Ch.forEach(e),Nh.forEach(e),n=0;n<tl.length;n++)r=tl[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<tl.length&&(n=tl[0],n.blockedOn===null);)ZO(n),n.blockedOn===null&&tl.shift()}var Zc=rs.ReactCurrentBatchConfig,Q0=!0;function fG(t,e,n,r){var a=Zt,i=Zc.transition;Zc.transition=null;try{Zt=1,lS(t,e,n,r)}finally{Zt=a,Zc.transition=i}}function gG(t,e,n,r){var a=Zt,i=Zc.transition;Zc.transition=null;try{Zt=4,lS(t,e,n,r)}finally{Zt=a,Zc.transition=i}}function lS(t,e,n,r){if(Q0){var a=uS(t,e,n,r);if(a===null)TS(t,e,r,Z0,n),QO(t,r);else if(pG(a,t,e,n,r))r.stopPropagation();else if(QO(t,r),e&4&&-1<dG.indexOf(t)){for(;a!==null;){var i=zh(a);if(i!==null&&qO(i),i=uS(t,e,n,r),i===null&&TS(t,e,r,Z0,n),i===a)break;a=i}a!==null&&r.stopPropagation()}else TS(t,e,r,null,n)}}var Z0=null;function uS(t,e,n,r){if(Z0=null,t=Qk(r),t=mu(t),t!==null)if(e=gu(t),e===null)t=null;else if(n=e.tag,n===13){if(t=DO(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Z0=t,null}function e$(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(nG()){case nS:return 1;case WO:return 4;case U0:case rG:return 16;case UO:return 536870912;default:return 16}default:return 16}}var nl=null,cS=null,J0=null;function t$(){if(J0)return J0;var t,e=cS,n=e.length,r,a="value"in nl?nl.value:nl.textContent,i=a.length;for(t=0;t<n&&e[t]===a[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===a[i-r];r++);return J0=a.slice(t,1<r?1-r:void 0)}function e1(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function t1(){return!0}function n$(){return!1}function Qa(t){function e(n,r,a,i,o){this._reactName=n,this._targetInst=a,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var s in t)t.hasOwnProperty(s)&&(n=t[s],this[s]=n?n(i):i[s]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?t1:n$,this.isPropagationStopped=n$,this}return Rn(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=t1)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=t1)},persist:function(){},isPersistent:t1}),e}var Jc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},dS=Qa(Jc),_h=Rn({},Jc,{view:0,detail:0}),mG=Qa(_h),pS,hS,Oh,n1=Rn({},_h,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:gS,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Oh&&(Oh&&t.type==="mousemove"?(pS=t.screenX-Oh.screenX,hS=t.screenY-Oh.screenY):hS=pS=0,Oh=t),pS)},movementY:function(t){return"movementY"in t?t.movementY:hS}}),r$=Qa(n1),yG=Rn({},n1,{dataTransfer:0}),bG=Qa(yG),vG=Rn({},_h,{relatedTarget:0}),fS=Qa(vG),xG=Rn({},Jc,{animationName:0,elapsedTime:0,pseudoElement:0}),wG=Qa(xG),kG=Rn({},Jc,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),SG=Qa(kG),CG=Rn({},Jc,{data:0}),a$=Qa(CG),NG={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},TG={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},IG={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function EG(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=IG[t])?!!e[t]:!1}function gS(){return EG}var _G=Rn({},_h,{key:function(t){if(t.key){var e=NG[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=e1(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?TG[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:gS,charCode:function(t){return t.type==="keypress"?e1(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?e1(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),OG=Qa(_G),$G=Rn({},n1,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),i$=Qa($G),RG=Rn({},_h,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:gS}),MG=Qa(RG),AG=Rn({},Jc,{propertyName:0,elapsedTime:0,pseudoElement:0}),PG=Qa(AG),LG=Rn({},n1,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),DG=Qa(LG),FG=[9,13,27,32],mS=ns&&"CompositionEvent"in window,$h=null;ns&&"documentMode"in document&&($h=document.documentMode);var BG=ns&&"TextEvent"in window&&!$h,o$=ns&&(!mS||$h&&8<$h&&11>=$h),s$=" ",l$=!1;function u$(t,e){switch(t){case"keyup":return FG.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function c$(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var ed=!1;function zG(t,e){switch(t){case"compositionend":return c$(e);case"keypress":return e.which!==32?null:(l$=!0,s$);case"textInput":return t=e.data,t===s$&&l$?null:t;default:return null}}function jG(t,e){if(ed)return t==="compositionend"||!mS&&u$(t,e)?(t=t$(),J0=cS=nl=null,ed=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return o$&&e.locale!=="ko"?null:e.data;default:return null}}var VG={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function d$(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!VG[t.type]:e==="textarea"}function p$(t,e,n,r){RO(r),e=s1(e,"onChange"),0<e.length&&(n=new dS("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Rh=null,Mh=null;function WG(t){O$(t,0)}function r1(t){var e=id(t);if(xO(e))return t}function UG(t,e){if(t==="change")return e}var h$=!1;if(ns){var yS;if(ns){var bS="oninput"in document;if(!bS){var f$=document.createElement("div");f$.setAttribute("oninput","return;"),bS=typeof f$.oninput=="function"}yS=bS}else yS=!1;h$=yS&&(!document.documentMode||9<document.documentMode)}function g$(){Rh&&(Rh.detachEvent("onpropertychange",m$),Mh=Rh=null)}function m$(t){if(t.propertyName==="value"&&r1(Mh)){var e=[];p$(e,Mh,t,Qk(t)),LO(WG,e)}}function GG(t,e,n){t==="focusin"?(g$(),Rh=e,Mh=n,Rh.attachEvent("onpropertychange",m$)):t==="focusout"&&g$()}function HG(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return r1(Mh)}function qG(t,e){if(t==="click")return r1(e)}function KG(t,e){if(t==="input"||t==="change")return r1(e)}function XG(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Ki=typeof Object.is=="function"?Object.is:XG;function Ah(t,e){if(Ki(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var a=n[r];if(!_k.call(e,a)||!Ki(t[a],e[a]))return!1}return!0}function y$(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function b$(t,e){var n=y$(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=y$(n)}}function v$(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?v$(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function x$(){for(var t=window,e=z0();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=z0(t.document)}return e}function vS(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function YG(t){var e=x$(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&v$(n.ownerDocument.documentElement,n)){if(r!==null&&vS(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var a=n.textContent.length,i=Math.min(r.start,a);r=r.end===void 0?i:Math.min(r.end,a),!t.extend&&i>r&&(a=r,r=i,i=a),a=b$(n,i);var o=b$(n,r);a&&o&&(t.rangeCount!==1||t.anchorNode!==a.node||t.anchorOffset!==a.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(a.node,a.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var QG=ns&&"documentMode"in document&&11>=document.documentMode,td=null,xS=null,Ph=null,wS=!1;function w$(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;wS||td==null||td!==z0(r)||(r=td,"selectionStart"in r&&vS(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Ph&&Ah(Ph,r)||(Ph=r,r=s1(xS,"onSelect"),0<r.length&&(e=new dS("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=td)))}function a1(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var nd={animationend:a1("Animation","AnimationEnd"),animationiteration:a1("Animation","AnimationIteration"),animationstart:a1("Animation","AnimationStart"),transitionend:a1("Transition","TransitionEnd")},kS={},k$={};ns&&(k$=document.createElement("div").style,"AnimationEvent"in window||(delete nd.animationend.animation,delete nd.animationiteration.animation,delete nd.animationstart.animation),"TransitionEvent"in window||delete nd.transitionend.transition);function i1(t){if(kS[t])return kS[t];if(!nd[t])return t;var e=nd[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in k$)return kS[t]=e[n];return t}var S$=i1("animationend"),C$=i1("animationiteration"),N$=i1("animationstart"),T$=i1("transitionend"),I$=new Map,E$="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function rl(t,e){I$.set(t,e),fu(e,[t])}for(var SS=0;SS<E$.length;SS++){var CS=E$[SS],ZG=CS.toLowerCase(),JG=CS[0].toUpperCase()+CS.slice(1);rl(ZG,"on"+JG)}rl(S$,"onAnimationEnd"),rl(C$,"onAnimationIteration"),rl(N$,"onAnimationStart"),rl("dblclick","onDoubleClick"),rl("focusin","onFocus"),rl("focusout","onBlur"),rl(T$,"onTransitionEnd"),Hc("onMouseEnter",["mouseout","mouseover"]),Hc("onMouseLeave",["mouseout","mouseover"]),Hc("onPointerEnter",["pointerout","pointerover"]),Hc("onPointerLeave",["pointerout","pointerover"]),fu("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),fu("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),fu("onBeforeInput",["compositionend","keypress","textInput","paste"]),fu("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),fu("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),fu("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Lh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),eH=new Set("cancel close invalid load scroll toggle".split(" ").concat(Lh));function _$(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,ZU(r,e,void 0,t),t.currentTarget=null}function O$(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],a=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var s=r[o],l=s.instance,u=s.currentTarget;if(s=s.listener,l!==i&&a.isPropagationStopped())break e;_$(a,s,u),i=l}else for(o=0;o<r.length;o++){if(s=r[o],l=s.instance,u=s.currentTarget,s=s.listener,l!==i&&a.isPropagationStopped())break e;_$(a,s,u),i=l}}}if(W0)throw t=tS,W0=!1,tS=null,t}function vn(t,e){var n=e[RS];n===void 0&&(n=e[RS]=new Set);var r=t+"__bubble";n.has(r)||($$(e,t,2,!1),n.add(r))}function NS(t,e,n){var r=0;e&&(r|=4),$$(n,t,r,e)}var o1="_reactListening"+Math.random().toString(36).slice(2);function Dh(t){if(!t[o1]){t[o1]=!0,pO.forEach(function(n){n!=="selectionchange"&&(eH.has(n)||NS(n,!1,t),NS(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[o1]||(e[o1]=!0,NS("selectionchange",!1,e))}}function $$(t,e,n,r){switch(e$(e)){case 1:var a=fG;break;case 4:a=gG;break;default:a=lS}n=a.bind(null,e,n,t),a=void 0,!eS||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(a=!0),r?a!==void 0?t.addEventListener(e,n,{capture:!0,passive:a}):t.addEventListener(e,n,!0):a!==void 0?t.addEventListener(e,n,{passive:a}):t.addEventListener(e,n,!1)}function TS(t,e,n,r,a){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var s=r.stateNode.containerInfo;if(s===a||s.nodeType===8&&s.parentNode===a)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===a||l.nodeType===8&&l.parentNode===a))return;o=o.return}for(;s!==null;){if(o=mu(s),o===null)return;if(l=o.tag,l===5||l===6){r=i=o;continue e}s=s.parentNode}}r=r.return}LO(function(){var u=i,c=Qk(n),d=[];e:{var p=I$.get(t);if(p!==void 0){var f=dS,m=t;switch(t){case"keypress":if(e1(n)===0)break e;case"keydown":case"keyup":f=OG;break;case"focusin":m="focus",f=fS;break;case"focusout":m="blur",f=fS;break;case"beforeblur":case"afterblur":f=fS;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=r$;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=bG;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=MG;break;case S$:case C$:case N$:f=wG;break;case T$:f=PG;break;case"scroll":f=mG;break;case"wheel":f=DG;break;case"copy":case"cut":case"paste":f=SG;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=i$}var y=(e&4)!==0,x=!y&&t==="scroll",b=y?p!==null?p+"Capture":null:p;y=[];for(var v=u,w;v!==null;){w=v;var S=w.stateNode;if(w.tag===5&&S!==null&&(w=S,b!==null&&(S=vh(v,b),S!=null&&y.push(Fh(v,S,w)))),x)break;v=v.return}0<y.length&&(p=new f(p,m,null,n,c),d.push({event:p,listeners:y}))}}if(!(e&7)){e:{if(p=t==="mouseover"||t==="pointerover",f=t==="mouseout"||t==="pointerout",p&&n!==Yk&&(m=n.relatedTarget||n.fromElement)&&(mu(m)||m[as]))break e;if((f||p)&&(p=c.window===c?c:(p=c.ownerDocument)?p.defaultView||p.parentWindow:window,f?(m=n.relatedTarget||n.toElement,f=u,m=m?mu(m):null,m!==null&&(x=gu(m),m!==x||m.tag!==5&&m.tag!==6)&&(m=null)):(f=null,m=u),f!==m)){if(y=r$,S="onMouseLeave",b="onMouseEnter",v="mouse",(t==="pointerout"||t==="pointerover")&&(y=i$,S="onPointerLeave",b="onPointerEnter",v="pointer"),x=f==null?p:id(f),w=m==null?p:id(m),p=new y(S,v+"leave",f,n,c),p.target=x,p.relatedTarget=w,S=null,mu(c)===u&&(y=new y(b,v+"enter",m,n,c),y.target=w,y.relatedTarget=x,S=y),x=S,f&&m)t:{for(y=f,b=m,v=0,w=y;w;w=rd(w))v++;for(w=0,S=b;S;S=rd(S))w++;for(;0<v-w;)y=rd(y),v--;for(;0<w-v;)b=rd(b),w--;for(;v--;){if(y===b||b!==null&&y===b.alternate)break t;y=rd(y),b=rd(b)}y=null}else y=null;f!==null&&R$(d,p,f,y,!1),m!==null&&x!==null&&R$(d,x,m,y,!0)}}e:{if(p=u?id(u):window,f=p.nodeName&&p.nodeName.toLowerCase(),f==="select"||f==="input"&&p.type==="file")var C=UG;else if(d$(p))if(h$)C=KG;else{C=HG;var I=GG}else(f=p.nodeName)&&f.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(C=qG);if(C&&(C=C(t,u))){p$(d,C,n,c);break e}I&&I(t,p,u),t==="focusout"&&(I=p._wrapperState)&&I.controlled&&p.type==="number"&&Gk(p,"number",p.value)}switch(I=u?id(u):window,t){case"focusin":(d$(I)||I.contentEditable==="true")&&(td=I,xS=u,Ph=null);break;case"focusout":Ph=xS=td=null;break;case"mousedown":wS=!0;break;case"contextmenu":case"mouseup":case"dragend":wS=!1,w$(d,n,c);break;case"selectionchange":if(QG)break;case"keydown":case"keyup":w$(d,n,c)}var _;if(mS)e:{switch(t){case"compositionstart":var E="onCompositionStart";break e;case"compositionend":E="onCompositionEnd";break e;case"compositionupdate":E="onCompositionUpdate";break e}E=void 0}else ed?u$(t,n)&&(E="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(E="onCompositionStart");E&&(o$&&n.locale!=="ko"&&(ed||E!=="onCompositionStart"?E==="onCompositionEnd"&&ed&&(_=t$()):(nl=c,cS="value"in nl?nl.value:nl.textContent,ed=!0)),I=s1(u,E),0<I.length&&(E=new a$(E,t,null,n,c),d.push({event:E,listeners:I}),_?E.data=_:(_=c$(n),_!==null&&(E.data=_)))),(_=BG?zG(t,n):jG(t,n))&&(u=s1(u,"onBeforeInput"),0<u.length&&(c=new a$("onBeforeInput","beforeinput",null,n,c),d.push({event:c,listeners:u}),c.data=_))}O$(d,e)})}function Fh(t,e,n){return{instance:t,listener:e,currentTarget:n}}function s1(t,e){for(var n=e+"Capture",r=[];t!==null;){var a=t,i=a.stateNode;a.tag===5&&i!==null&&(a=i,i=vh(t,n),i!=null&&r.unshift(Fh(t,i,a)),i=vh(t,e),i!=null&&r.push(Fh(t,i,a))),t=t.return}return r}function rd(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function R$(t,e,n,r,a){for(var i=e._reactName,o=[];n!==null&&n!==r;){var s=n,l=s.alternate,u=s.stateNode;if(l!==null&&l===r)break;s.tag===5&&u!==null&&(s=u,a?(l=vh(n,i),l!=null&&o.unshift(Fh(n,l,s))):a||(l=vh(n,i),l!=null&&o.push(Fh(n,l,s)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var tH=/\r\n?/g,nH=/\u0000|\uFFFD/g;function M$(t){return(typeof t=="string"?t:""+t).replace(tH,`
`).replace(nH,"")}function l1(t,e,n){if(e=M$(e),M$(t)!==e&&n)throw Error(Se(425))}function u1(){}var IS=null,ES=null;function _S(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var OS=typeof setTimeout=="function"?setTimeout:void 0,rH=typeof clearTimeout=="function"?clearTimeout:void 0,A$=typeof Promise=="function"?Promise:void 0,aH=typeof queueMicrotask=="function"?queueMicrotask:typeof A$<"u"?function(t){return A$.resolve(null).then(t).catch(iH)}:OS;function iH(t){setTimeout(function(){throw t})}function $S(t,e){var n=e,r=0;do{var a=n.nextSibling;if(t.removeChild(n),a&&a.nodeType===8)if(n=a.data,n==="/$"){if(r===0){t.removeChild(a),Eh(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=a}while(n);Eh(e)}function al(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function P$(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var ad=Math.random().toString(36).slice(2),No="__reactFiber$"+ad,Bh="__reactProps$"+ad,as="__reactContainer$"+ad,RS="__reactEvents$"+ad,oH="__reactListeners$"+ad,sH="__reactHandles$"+ad;function mu(t){var e=t[No];if(e)return e;for(var n=t.parentNode;n;){if(e=n[as]||n[No]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=P$(t);t!==null;){if(n=t[No])return n;t=P$(t)}return e}t=n,n=t.parentNode}return null}function zh(t){return t=t[No]||t[as],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function id(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Se(33))}function c1(t){return t[Bh]||null}var MS=[],od=-1;function il(t){return{current:t}}function xn(t){0>od||(t.current=MS[od],MS[od]=null,od--)}function fn(t,e){od++,MS[od]=t.current,t.current=e}var ol={},ea=il(ol),Ra=il(!1),yu=ol;function sd(t,e){var n=t.type.contextTypes;if(!n)return ol;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var a={},i;for(i in n)a[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=a),a}function Ma(t){return t=t.childContextTypes,t!=null}function d1(){xn(Ra),xn(ea)}function L$(t,e,n){if(ea.current!==ol)throw Error(Se(168));fn(ea,e),fn(Ra,n)}function D$(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var a in r)if(!(a in e))throw Error(Se(108,GU(t)||"Unknown",a));return Rn({},n,r)}function p1(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||ol,yu=ea.current,fn(ea,t),fn(Ra,Ra.current),!0}function F$(t,e,n){var r=t.stateNode;if(!r)throw Error(Se(169));n?(t=D$(t,e,yu),r.__reactInternalMemoizedMergedChildContext=t,xn(Ra),xn(ea),fn(ea,t)):xn(Ra),fn(Ra,n)}var is=null,h1=!1,AS=!1;function B$(t){is===null?is=[t]:is.push(t)}function lH(t){h1=!0,B$(t)}function sl(){if(!AS&&is!==null){AS=!0;var t=0,e=Zt;try{var n=is;for(Zt=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}is=null,h1=!1}catch(a){throw is!==null&&(is=is.slice(t+1)),jO(nS,sl),a}finally{Zt=e,AS=!1}}return null}var ld=[],ud=0,f1=null,g1=0,yi=[],bi=0,bu=null,os=1,ss="";function vu(t,e){ld[ud++]=g1,ld[ud++]=f1,f1=t,g1=e}function z$(t,e,n){yi[bi++]=os,yi[bi++]=ss,yi[bi++]=bu,bu=t;var r=os;t=ss;var a=32-qi(r)-1;r&=~(1<<a),n+=1;var i=32-qi(e)+a;if(30<i){var o=a-a%5;i=(r&(1<<o)-1).toString(32),r>>=o,a-=o,os=1<<32-qi(e)+a|n<<a|r,ss=i+t}else os=1<<i|n<<a|r,ss=t}function PS(t){t.return!==null&&(vu(t,1),z$(t,1,0))}function LS(t){for(;t===f1;)f1=ld[--ud],ld[ud]=null,g1=ld[--ud],ld[ud]=null;for(;t===bu;)bu=yi[--bi],yi[bi]=null,ss=yi[--bi],yi[bi]=null,os=yi[--bi],yi[bi]=null}var Za=null,Ja=null,Nn=!1,Xi=null;function j$(t,e){var n=ki(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function V$(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Za=t,Ja=al(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Za=t,Ja=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=bu!==null?{id:os,overflow:ss}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=ki(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Za=t,Ja=null,!0):!1;default:return!1}}function DS(t){return(t.mode&1)!==0&&(t.flags&128)===0}function FS(t){if(Nn){var e=Ja;if(e){var n=e;if(!V$(t,e)){if(DS(t))throw Error(Se(418));e=al(n.nextSibling);var r=Za;e&&V$(t,e)?j$(r,n):(t.flags=t.flags&-4097|2,Nn=!1,Za=t)}}else{if(DS(t))throw Error(Se(418));t.flags=t.flags&-4097|2,Nn=!1,Za=t}}}function W$(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Za=t}function m1(t){if(t!==Za)return!1;if(!Nn)return W$(t),Nn=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!_S(t.type,t.memoizedProps)),e&&(e=Ja)){if(DS(t))throw U$(),Error(Se(418));for(;e;)j$(t,e),e=al(e.nextSibling)}if(W$(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Se(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Ja=al(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Ja=null}}else Ja=Za?al(t.stateNode.nextSibling):null;return!0}function U$(){for(var t=Ja;t;)t=al(t.nextSibling)}function cd(){Ja=Za=null,Nn=!1}function BS(t){Xi===null?Xi=[t]:Xi.push(t)}var uH=rs.ReactCurrentBatchConfig;function Yi(t,e){if(t&&t.defaultProps){e=Rn({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var y1=il(null),b1=null,dd=null,zS=null;function jS(){zS=dd=b1=null}function VS(t){var e=y1.current;xn(y1),t._currentValue=e}function WS(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function pd(t,e){b1=t,zS=dd=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Aa=!0),t.firstContext=null)}function vi(t){var e=t._currentValue;if(zS!==t)if(t={context:t,memoizedValue:e,next:null},dd===null){if(b1===null)throw Error(Se(308));dd=t,b1.dependencies={lanes:0,firstContext:t}}else dd=dd.next=t;return e}var xu=null;function US(t){xu===null?xu=[t]:xu.push(t)}function G$(t,e,n,r){var a=e.interleaved;return a===null?(n.next=n,US(e)):(n.next=a.next,a.next=n),e.interleaved=n,ls(t,r)}function ls(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var ll=!1;function GS(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function H$(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function us(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function ul(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Lt&2){var a=r.pending;return a===null?e.next=e:(e.next=a.next,a.next=e),r.pending=e,ls(t,n)}return a=r.interleaved,a===null?(e.next=e,US(r)):(e.next=a.next,a.next=e),r.interleaved=e,ls(t,n)}function v1(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,iS(t,n)}}function q$(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var a=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?a=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?a=i=e:i=i.next=e}else a=i=e;n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function x1(t,e,n,r){var a=t.updateQueue;ll=!1;var i=a.firstBaseUpdate,o=a.lastBaseUpdate,s=a.shared.pending;if(s!==null){a.shared.pending=null;var l=s,u=l.next;l.next=null,o===null?i=u:o.next=u,o=l;var c=t.alternate;c!==null&&(c=c.updateQueue,s=c.lastBaseUpdate,s!==o&&(s===null?c.firstBaseUpdate=u:s.next=u,c.lastBaseUpdate=l))}if(i!==null){var d=a.baseState;o=0,c=u=l=null,s=i;do{var p=s.lane,f=s.eventTime;if((r&p)===p){c!==null&&(c=c.next={eventTime:f,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var m=t,y=s;switch(p=e,f=n,y.tag){case 1:if(m=y.payload,typeof m=="function"){d=m.call(f,d,p);break e}d=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=y.payload,p=typeof m=="function"?m.call(f,d,p):m,p==null)break e;d=Rn({},d,p);break e;case 2:ll=!0}}s.callback!==null&&s.lane!==0&&(t.flags|=64,p=a.effects,p===null?a.effects=[s]:p.push(s))}else f={eventTime:f,lane:p,tag:s.tag,payload:s.payload,callback:s.callback,next:null},c===null?(u=c=f,l=d):c=c.next=f,o|=p;if(s=s.next,s===null){if(s=a.shared.pending,s===null)break;p=s,s=p.next,p.next=null,a.lastBaseUpdate=p,a.shared.pending=null}}while(!0);if(c===null&&(l=d),a.baseState=l,a.firstBaseUpdate=u,a.lastBaseUpdate=c,e=a.shared.interleaved,e!==null){a=e;do o|=a.lane,a=a.next;while(a!==e)}else i===null&&(a.shared.lanes=0);Su|=o,t.lanes=o,t.memoizedState=d}}function K$(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],a=r.callback;if(a!==null){if(r.callback=null,r=n,typeof a!="function")throw Error(Se(191,a));a.call(r)}}}var X$=new dO.Component().refs;function HS(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Rn({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var w1={isMounted:function(t){return(t=t._reactInternals)?gu(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=ka(),a=hl(t),i=us(r,a);i.payload=e,n!=null&&(i.callback=n),e=ul(t,i,a),e!==null&&(Ji(e,t,a,r),v1(e,t,a))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=ka(),a=hl(t),i=us(r,a);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=ul(t,i,a),e!==null&&(Ji(e,t,a,r),v1(e,t,a))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=ka(),r=hl(t),a=us(n,r);a.tag=2,e!=null&&(a.callback=e),e=ul(t,a,r),e!==null&&(Ji(e,t,r,n),v1(e,t,r))}};function Y$(t,e,n,r,a,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!Ah(n,r)||!Ah(a,i):!0}function Q$(t,e,n){var r=!1,a=ol,i=e.contextType;return typeof i=="object"&&i!==null?i=vi(i):(a=Ma(e)?yu:ea.current,r=e.contextTypes,i=(r=r!=null)?sd(t,a):ol),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=w1,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=a,t.__reactInternalMemoizedMaskedChildContext=i),e}function Z$(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&w1.enqueueReplaceState(e,e.state,null)}function qS(t,e,n,r){var a=t.stateNode;a.props=n,a.state=t.memoizedState,a.refs=X$,GS(t);var i=e.contextType;typeof i=="object"&&i!==null?a.context=vi(i):(i=Ma(e)?yu:ea.current,a.context=sd(t,i)),a.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(HS(t,e,i,n),a.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(e=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),e!==a.state&&w1.enqueueReplaceState(a,a.state,null),x1(t,n,a,r),a.state=t.memoizedState),typeof a.componentDidMount=="function"&&(t.flags|=4194308)}function jh(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Se(309));var r=n.stateNode}if(!r)throw Error(Se(147,t));var a=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var s=a.refs;s===X$&&(s=a.refs={}),o===null?delete s[i]:s[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(Se(284));if(!n._owner)throw Error(Se(290,t))}return t}function k1(t,e){throw t=Object.prototype.toString.call(e),Error(Se(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function J$(t){var e=t._init;return e(t._payload)}function eR(t){function e(b,v){if(t){var w=b.deletions;w===null?(b.deletions=[v],b.flags|=16):w.push(v)}}function n(b,v){if(!t)return null;for(;v!==null;)e(b,v),v=v.sibling;return null}function r(b,v){for(b=new Map;v!==null;)v.key!==null?b.set(v.key,v):b.set(v.index,v),v=v.sibling;return b}function a(b,v){return b=gl(b,v),b.index=0,b.sibling=null,b}function i(b,v,w){return b.index=w,t?(w=b.alternate,w!==null?(w=w.index,w<v?(b.flags|=2,v):w):(b.flags|=2,v)):(b.flags|=1048576,v)}function o(b){return t&&b.alternate===null&&(b.flags|=2),b}function s(b,v,w,S){return v===null||v.tag!==6?(v=_C(w,b.mode,S),v.return=b,v):(v=a(v,w),v.return=b,v)}function l(b,v,w,S){var C=w.type;return C===Kc?c(b,v,w.props.children,S,w.key):v!==null&&(v.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===Ys&&J$(C)===v.type)?(S=a(v,w.props),S.ref=jh(b,v,w),S.return=b,S):(S=j1(w.type,w.key,w.props,null,b.mode,S),S.ref=jh(b,v,w),S.return=b,S)}function u(b,v,w,S){return v===null||v.tag!==4||v.stateNode.containerInfo!==w.containerInfo||v.stateNode.implementation!==w.implementation?(v=OC(w,b.mode,S),v.return=b,v):(v=a(v,w.children||[]),v.return=b,v)}function c(b,v,w,S,C){return v===null||v.tag!==7?(v=Iu(w,b.mode,S,C),v.return=b,v):(v=a(v,w),v.return=b,v)}function d(b,v,w){if(typeof v=="string"&&v!==""||typeof v=="number")return v=_C(""+v,b.mode,w),v.return=b,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case F0:return w=j1(v.type,v.key,v.props,null,b.mode,w),w.ref=jh(b,null,v),w.return=b,w;case qc:return v=OC(v,b.mode,w),v.return=b,v;case Ys:var S=v._init;return d(b,S(v._payload),w)}if(mh(v)||fh(v))return v=Iu(v,b.mode,w,null),v.return=b,v;k1(b,v)}return null}function p(b,v,w,S){var C=v!==null?v.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return C!==null?null:s(b,v,""+w,S);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case F0:return w.key===C?l(b,v,w,S):null;case qc:return w.key===C?u(b,v,w,S):null;case Ys:return C=w._init,p(b,v,C(w._payload),S)}if(mh(w)||fh(w))return C!==null?null:c(b,v,w,S,null);k1(b,w)}return null}function f(b,v,w,S,C){if(typeof S=="string"&&S!==""||typeof S=="number")return b=b.get(w)||null,s(v,b,""+S,C);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case F0:return b=b.get(S.key===null?w:S.key)||null,l(v,b,S,C);case qc:return b=b.get(S.key===null?w:S.key)||null,u(v,b,S,C);case Ys:var I=S._init;return f(b,v,w,I(S._payload),C)}if(mh(S)||fh(S))return b=b.get(w)||null,c(v,b,S,C,null);k1(v,S)}return null}function m(b,v,w,S){for(var C=null,I=null,_=v,E=v=0,P=null;_!==null&&E<w.length;E++){_.index>E?(P=_,_=null):P=_.sibling;var A=p(b,_,w[E],S);if(A===null){_===null&&(_=P);break}t&&_&&A.alternate===null&&e(b,_),v=i(A,v,E),I===null?C=A:I.sibling=A,I=A,_=P}if(E===w.length)return n(b,_),Nn&&vu(b,E),C;if(_===null){for(;E<w.length;E++)_=d(b,w[E],S),_!==null&&(v=i(_,v,E),I===null?C=_:I.sibling=_,I=_);return Nn&&vu(b,E),C}for(_=r(b,_);E<w.length;E++)P=f(_,b,E,w[E],S),P!==null&&(t&&P.alternate!==null&&_.delete(P.key===null?E:P.key),v=i(P,v,E),I===null?C=P:I.sibling=P,I=P);return t&&_.forEach(function(D){return e(b,D)}),Nn&&vu(b,E),C}function y(b,v,w,S){var C=fh(w);if(typeof C!="function")throw Error(Se(150));if(w=C.call(w),w==null)throw Error(Se(151));for(var I=C=null,_=v,E=v=0,P=null,A=w.next();_!==null&&!A.done;E++,A=w.next()){_.index>E?(P=_,_=null):P=_.sibling;var D=p(b,_,A.value,S);if(D===null){_===null&&(_=P);break}t&&_&&D.alternate===null&&e(b,_),v=i(D,v,E),I===null?C=D:I.sibling=D,I=D,_=P}if(A.done)return n(b,_),Nn&&vu(b,E),C;if(_===null){for(;!A.done;E++,A=w.next())A=d(b,A.value,S),A!==null&&(v=i(A,v,E),I===null?C=A:I.sibling=A,I=A);return Nn&&vu(b,E),C}for(_=r(b,_);!A.done;E++,A=w.next())A=f(_,b,E,A.value,S),A!==null&&(t&&A.alternate!==null&&_.delete(A.key===null?E:A.key),v=i(A,v,E),I===null?C=A:I.sibling=A,I=A);return t&&_.forEach(function(V){return e(b,V)}),Nn&&vu(b,E),C}function x(b,v,w,S){if(typeof w=="object"&&w!==null&&w.type===Kc&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case F0:e:{for(var C=w.key,I=v;I!==null;){if(I.key===C){if(C=w.type,C===Kc){if(I.tag===7){n(b,I.sibling),v=a(I,w.props.children),v.return=b,b=v;break e}}else if(I.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===Ys&&J$(C)===I.type){n(b,I.sibling),v=a(I,w.props),v.ref=jh(b,I,w),v.return=b,b=v;break e}n(b,I);break}else e(b,I);I=I.sibling}w.type===Kc?(v=Iu(w.props.children,b.mode,S,w.key),v.return=b,b=v):(S=j1(w.type,w.key,w.props,null,b.mode,S),S.ref=jh(b,v,w),S.return=b,b=S)}return o(b);case qc:e:{for(I=w.key;v!==null;){if(v.key===I)if(v.tag===4&&v.stateNode.containerInfo===w.containerInfo&&v.stateNode.implementation===w.implementation){n(b,v.sibling),v=a(v,w.children||[]),v.return=b,b=v;break e}else{n(b,v);break}else e(b,v);v=v.sibling}v=OC(w,b.mode,S),v.return=b,b=v}return o(b);case Ys:return I=w._init,x(b,v,I(w._payload),S)}if(mh(w))return m(b,v,w,S);if(fh(w))return y(b,v,w,S);k1(b,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,v!==null&&v.tag===6?(n(b,v.sibling),v=a(v,w),v.return=b,b=v):(n(b,v),v=_C(w,b.mode,S),v.return=b,b=v),o(b)):n(b,v)}return x}var hd=eR(!0),tR=eR(!1),Vh={},To=il(Vh),Wh=il(Vh),Uh=il(Vh);function wu(t){if(t===Vh)throw Error(Se(174));return t}function KS(t,e){switch(fn(Uh,e),fn(Wh,t),fn(To,Vh),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:qk(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=qk(e,t)}xn(To),fn(To,e)}function fd(){xn(To),xn(Wh),xn(Uh)}function nR(t){wu(Uh.current);var e=wu(To.current),n=qk(e,t.type);e!==n&&(fn(Wh,t),fn(To,n))}function XS(t){Wh.current===t&&(xn(To),xn(Wh))}var Mn=il(0);function S1(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var YS=[];function QS(){for(var t=0;t<YS.length;t++)YS[t]._workInProgressVersionPrimary=null;YS.length=0}var C1=rs.ReactCurrentDispatcher,ZS=rs.ReactCurrentBatchConfig,ku=0,An=null,lr=null,kr=null,N1=!1,Gh=!1,Hh=0,cH=0;function ta(){throw Error(Se(321))}function JS(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Ki(t[n],e[n]))return!1;return!0}function eC(t,e,n,r,a,i){if(ku=i,An=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,C1.current=t===null||t.memoizedState===null?fH:gH,t=n(r,a),Gh){i=0;do{if(Gh=!1,Hh=0,25<=i)throw Error(Se(301));i+=1,kr=lr=null,e.updateQueue=null,C1.current=mH,t=n(r,a)}while(Gh)}if(C1.current=E1,e=lr!==null&&lr.next!==null,ku=0,kr=lr=An=null,N1=!1,e)throw Error(Se(300));return t}function tC(){var t=Hh!==0;return Hh=0,t}function Io(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return kr===null?An.memoizedState=kr=t:kr=kr.next=t,kr}function xi(){if(lr===null){var t=An.alternate;t=t!==null?t.memoizedState:null}else t=lr.next;var e=kr===null?An.memoizedState:kr.next;if(e!==null)kr=e,lr=t;else{if(t===null)throw Error(Se(310));lr=t,t={memoizedState:lr.memoizedState,baseState:lr.baseState,baseQueue:lr.baseQueue,queue:lr.queue,next:null},kr===null?An.memoizedState=kr=t:kr=kr.next=t}return kr}function qh(t,e){return typeof e=="function"?e(t):e}function nC(t){var e=xi(),n=e.queue;if(n===null)throw Error(Se(311));n.lastRenderedReducer=t;var r=lr,a=r.baseQueue,i=n.pending;if(i!==null){if(a!==null){var o=a.next;a.next=i.next,i.next=o}r.baseQueue=a=i,n.pending=null}if(a!==null){i=a.next,r=r.baseState;var s=o=null,l=null,u=i;do{var c=u.lane;if((ku&c)===c)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var d={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(s=l=d,o=r):l=l.next=d,An.lanes|=c,Su|=c}u=u.next}while(u!==null&&u!==i);l===null?o=r:l.next=s,Ki(r,e.memoizedState)||(Aa=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){a=t;do i=a.lane,An.lanes|=i,Su|=i,a=a.next;while(a!==t)}else a===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function rC(t){var e=xi(),n=e.queue;if(n===null)throw Error(Se(311));n.lastRenderedReducer=t;var r=n.dispatch,a=n.pending,i=e.memoizedState;if(a!==null){n.pending=null;var o=a=a.next;do i=t(i,o.action),o=o.next;while(o!==a);Ki(i,e.memoizedState)||(Aa=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function rR(){}function aR(t,e){var n=An,r=xi(),a=e(),i=!Ki(r.memoizedState,a);if(i&&(r.memoizedState=a,Aa=!0),r=r.queue,aC(sR.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||kr!==null&&kr.memoizedState.tag&1){if(n.flags|=2048,Kh(9,oR.bind(null,n,r,a,e),void 0,null),Sr===null)throw Error(Se(349));ku&30||iR(n,e,a)}return a}function iR(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=An.updateQueue,e===null?(e={lastEffect:null,stores:null},An.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function oR(t,e,n,r){e.value=n,e.getSnapshot=r,lR(e)&&uR(t)}function sR(t,e,n){return n(function(){lR(e)&&uR(t)})}function lR(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Ki(t,n)}catch{return!0}}function uR(t){var e=ls(t,1);e!==null&&Ji(e,t,1,-1)}function cR(t){var e=Io();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:qh,lastRenderedState:t},e.queue=t,t=t.dispatch=hH.bind(null,An,t),[e.memoizedState,t]}function Kh(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=An.updateQueue,e===null?(e={lastEffect:null,stores:null},An.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function dR(){return xi().memoizedState}function T1(t,e,n,r){var a=Io();An.flags|=t,a.memoizedState=Kh(1|e,n,void 0,r===void 0?null:r)}function I1(t,e,n,r){var a=xi();r=r===void 0?null:r;var i=void 0;if(lr!==null){var o=lr.memoizedState;if(i=o.destroy,r!==null&&JS(r,o.deps)){a.memoizedState=Kh(e,n,i,r);return}}An.flags|=t,a.memoizedState=Kh(1|e,n,i,r)}function pR(t,e){return T1(8390656,8,t,e)}function aC(t,e){return I1(2048,8,t,e)}function hR(t,e){return I1(4,2,t,e)}function fR(t,e){return I1(4,4,t,e)}function gR(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function mR(t,e,n){return n=n!=null?n.concat([t]):null,I1(4,4,gR.bind(null,e,t),n)}function iC(){}function yR(t,e){var n=xi();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&JS(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function bR(t,e){var n=xi();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&JS(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function vR(t,e,n){return ku&21?(Ki(n,e)||(n=GO(),An.lanes|=n,Su|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Aa=!0),t.memoizedState=n)}function dH(t,e){var n=Zt;Zt=n!==0&&4>n?n:4,t(!0);var r=ZS.transition;ZS.transition={};try{t(!1),e()}finally{Zt=n,ZS.transition=r}}function xR(){return xi().memoizedState}function pH(t,e,n){var r=hl(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},wR(t))kR(e,n);else if(n=G$(t,e,n,r),n!==null){var a=ka();Ji(n,t,r,a),SR(n,e,r)}}function hH(t,e,n){var r=hl(t),a={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(wR(t))kR(e,a);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,s=i(o,n);if(a.hasEagerState=!0,a.eagerState=s,Ki(s,o)){var l=e.interleaved;l===null?(a.next=a,US(e)):(a.next=l.next,l.next=a),e.interleaved=a;return}}catch{}finally{}n=G$(t,e,a,r),n!==null&&(a=ka(),Ji(n,t,r,a),SR(n,e,r))}}function wR(t){var e=t.alternate;return t===An||e!==null&&e===An}function kR(t,e){Gh=N1=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function SR(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,iS(t,n)}}var E1={readContext:vi,useCallback:ta,useContext:ta,useEffect:ta,useImperativeHandle:ta,useInsertionEffect:ta,useLayoutEffect:ta,useMemo:ta,useReducer:ta,useRef:ta,useState:ta,useDebugValue:ta,useDeferredValue:ta,useTransition:ta,useMutableSource:ta,useSyncExternalStore:ta,useId:ta,unstable_isNewReconciler:!1},fH={readContext:vi,useCallback:function(t,e){return Io().memoizedState=[t,e===void 0?null:e],t},useContext:vi,useEffect:pR,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,T1(4194308,4,gR.bind(null,e,t),n)},useLayoutEffect:function(t,e){return T1(4194308,4,t,e)},useInsertionEffect:function(t,e){return T1(4,2,t,e)},useMemo:function(t,e){var n=Io();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Io();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=pH.bind(null,An,t),[r.memoizedState,t]},useRef:function(t){var e=Io();return t={current:t},e.memoizedState=t},useState:cR,useDebugValue:iC,useDeferredValue:function(t){return Io().memoizedState=t},useTransition:function(){var t=cR(!1),e=t[0];return t=dH.bind(null,t[1]),Io().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=An,a=Io();if(Nn){if(n===void 0)throw Error(Se(407));n=n()}else{if(n=e(),Sr===null)throw Error(Se(349));ku&30||iR(r,e,n)}a.memoizedState=n;var i={value:n,getSnapshot:e};return a.queue=i,pR(sR.bind(null,r,i,t),[t]),r.flags|=2048,Kh(9,oR.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=Io(),e=Sr.identifierPrefix;if(Nn){var n=ss,r=os;n=(r&~(1<<32-qi(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Hh++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=cH++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},gH={readContext:vi,useCallback:yR,useContext:vi,useEffect:aC,useImperativeHandle:mR,useInsertionEffect:hR,useLayoutEffect:fR,useMemo:bR,useReducer:nC,useRef:dR,useState:function(){return nC(qh)},useDebugValue:iC,useDeferredValue:function(t){var e=xi();return vR(e,lr.memoizedState,t)},useTransition:function(){var t=nC(qh)[0],e=xi().memoizedState;return[t,e]},useMutableSource:rR,useSyncExternalStore:aR,useId:xR,unstable_isNewReconciler:!1},mH={readContext:vi,useCallback:yR,useContext:vi,useEffect:aC,useImperativeHandle:mR,useInsertionEffect:hR,useLayoutEffect:fR,useMemo:bR,useReducer:rC,useRef:dR,useState:function(){return rC(qh)},useDebugValue:iC,useDeferredValue:function(t){var e=xi();return lr===null?e.memoizedState=t:vR(e,lr.memoizedState,t)},useTransition:function(){var t=rC(qh)[0],e=xi().memoizedState;return[t,e]},useMutableSource:rR,useSyncExternalStore:aR,useId:xR,unstable_isNewReconciler:!1};function gd(t,e){try{var n="",r=e;do n+=UU(r),r=r.return;while(r);var a=n}catch(i){a=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:a,digest:null}}function oC(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function sC(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var yH=typeof WeakMap=="function"?WeakMap:Map;function CR(t,e,n){n=us(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){P1||(P1=!0,wC=r),sC(t,e)},n}function NR(t,e,n){n=us(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var a=e.value;n.payload=function(){return r(a)},n.callback=function(){sC(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){sC(t,e),typeof r!="function"&&(dl===null?dl=new Set([this]):dl.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function TR(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new yH;var a=new Set;r.set(e,a)}else a=r.get(e),a===void 0&&(a=new Set,r.set(e,a));a.has(n)||(a.add(n),t=$H.bind(null,t,e,n),e.then(t,t))}function IR(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function ER(t,e,n,r,a){return t.mode&1?(t.flags|=65536,t.lanes=a,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=us(-1,1),e.tag=2,ul(n,e,1))),n.lanes|=1),t)}var bH=rs.ReactCurrentOwner,Aa=!1;function wa(t,e,n,r){e.child=t===null?tR(e,null,n,r):hd(e,t.child,n,r)}function _R(t,e,n,r,a){n=n.render;var i=e.ref;return pd(e,a),r=eC(t,e,n,r,i,a),n=tC(),t!==null&&!Aa?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~a,cs(t,e,a)):(Nn&&n&&PS(e),e.flags|=1,wa(t,e,r,a),e.child)}function OR(t,e,n,r,a){if(t===null){var i=n.type;return typeof i=="function"&&!EC(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,$R(t,e,i,r,a)):(t=j1(n.type,null,r,e,e.mode,a),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&a)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:Ah,n(o,r)&&t.ref===e.ref)return cs(t,e,a)}return e.flags|=1,t=gl(i,r),t.ref=e.ref,t.return=e,e.child=t}function $R(t,e,n,r,a){if(t!==null){var i=t.memoizedProps;if(Ah(i,r)&&t.ref===e.ref)if(Aa=!1,e.pendingProps=r=i,(t.lanes&a)!==0)t.flags&131072&&(Aa=!0);else return e.lanes=t.lanes,cs(t,e,a)}return lC(t,e,n,r,a)}function RR(t,e,n){var r=e.pendingProps,a=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},fn(yd,ei),ei|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,fn(yd,ei),ei|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,fn(yd,ei),ei|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,fn(yd,ei),ei|=r;return wa(t,e,a,n),e.child}function MR(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function lC(t,e,n,r,a){var i=Ma(n)?yu:ea.current;return i=sd(e,i),pd(e,a),n=eC(t,e,n,r,i,a),r=tC(),t!==null&&!Aa?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~a,cs(t,e,a)):(Nn&&r&&PS(e),e.flags|=1,wa(t,e,n,a),e.child)}function AR(t,e,n,r,a){if(Ma(n)){var i=!0;p1(e)}else i=!1;if(pd(e,a),e.stateNode===null)O1(t,e),Q$(e,n,r),qS(e,n,r,a),r=!0;else if(t===null){var o=e.stateNode,s=e.memoizedProps;o.props=s;var l=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=vi(u):(u=Ma(n)?yu:ea.current,u=sd(e,u));var c=n.getDerivedStateFromProps,d=typeof c=="function"||typeof o.getSnapshotBeforeUpdate=="function";d||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(s!==r||l!==u)&&Z$(e,o,r,u),ll=!1;var p=e.memoizedState;o.state=p,x1(e,r,o,a),l=e.memoizedState,s!==r||p!==l||Ra.current||ll?(typeof c=="function"&&(HS(e,n,c,r),l=e.memoizedState),(s=ll||Y$(e,n,s,r,p,l,u))?(d||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=u,r=s):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,H$(t,e),s=e.memoizedProps,u=e.type===e.elementType?s:Yi(e.type,s),o.props=u,d=e.pendingProps,p=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=vi(l):(l=Ma(n)?yu:ea.current,l=sd(e,l));var f=n.getDerivedStateFromProps;(c=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(s!==d||p!==l)&&Z$(e,o,r,l),ll=!1,p=e.memoizedState,o.state=p,x1(e,r,o,a);var m=e.memoizedState;s!==d||p!==m||Ra.current||ll?(typeof f=="function"&&(HS(e,n,f,r),m=e.memoizedState),(u=ll||Y$(e,n,u,r,p,m,l)||!1)?(c||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,m,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,m,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||s===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||s===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=m),o.props=r,o.state=m,o.context=l,r=u):(typeof o.componentDidUpdate!="function"||s===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||s===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),r=!1)}return uC(t,e,n,r,i,a)}function uC(t,e,n,r,a,i){MR(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return a&&F$(e,n,!1),cs(t,e,i);r=e.stateNode,bH.current=e;var s=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=hd(e,t.child,null,i),e.child=hd(e,null,s,i)):wa(t,e,s,i),e.memoizedState=r.state,a&&F$(e,n,!0),e.child}function PR(t){var e=t.stateNode;e.pendingContext?L$(t,e.pendingContext,e.pendingContext!==e.context):e.context&&L$(t,e.context,!1),KS(t,e.containerInfo)}function LR(t,e,n,r,a){return cd(),BS(a),e.flags|=256,wa(t,e,n,r),e.child}var cC={dehydrated:null,treeContext:null,retryLane:0};function dC(t){return{baseLanes:t,cachePool:null,transitions:null}}function DR(t,e,n){var r=e.pendingProps,a=Mn.current,i=!1,o=(e.flags&128)!==0,s;if((s=o)||(s=t!==null&&t.memoizedState===null?!1:(a&2)!==0),s?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(a|=1),fn(Mn,a&1),t===null)return FS(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=V1(o,r,0,null),t=Iu(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=dC(n),e.memoizedState=cC,t):pC(e,o));if(a=t.memoizedState,a!==null&&(s=a.dehydrated,s!==null))return vH(t,e,o,r,s,a,n);if(i){i=r.fallback,o=e.mode,a=t.child,s=a.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==a?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=gl(a,l),r.subtreeFlags=a.subtreeFlags&14680064),s!==null?i=gl(s,i):(i=Iu(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?dC(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=cC,r}return i=t.child,t=i.sibling,r=gl(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function pC(t,e){return e=V1({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function _1(t,e,n,r){return r!==null&&BS(r),hd(e,t.child,null,n),t=pC(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function vH(t,e,n,r,a,i,o){if(n)return e.flags&256?(e.flags&=-257,r=oC(Error(Se(422))),_1(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,a=e.mode,r=V1({mode:"visible",children:r.children},a,0,null),i=Iu(i,a,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&hd(e,t.child,null,o),e.child.memoizedState=dC(o),e.memoizedState=cC,i);if(!(e.mode&1))return _1(t,e,o,null);if(a.data==="$!"){if(r=a.nextSibling&&a.nextSibling.dataset,r)var s=r.dgst;return r=s,i=Error(Se(419)),r=oC(i,r,void 0),_1(t,e,o,r)}if(s=(o&t.childLanes)!==0,Aa||s){if(r=Sr,r!==null){switch(o&-o){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(r.suspendedLanes|o)?0:a,a!==0&&a!==i.retryLane&&(i.retryLane=a,ls(t,a),Ji(r,t,a,-1))}return IC(),r=oC(Error(Se(421))),_1(t,e,o,r)}return a.data==="$?"?(e.flags|=128,e.child=t.child,e=RH.bind(null,t),a._reactRetry=e,null):(t=i.treeContext,Ja=al(a.nextSibling),Za=e,Nn=!0,Xi=null,t!==null&&(yi[bi++]=os,yi[bi++]=ss,yi[bi++]=bu,os=t.id,ss=t.overflow,bu=e),e=pC(e,r.children),e.flags|=4096,e)}function FR(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),WS(t.return,e,n)}function hC(t,e,n,r,a){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=a)}function BR(t,e,n){var r=e.pendingProps,a=r.revealOrder,i=r.tail;if(wa(t,e,r.children,n),r=Mn.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&FR(t,n,e);else if(t.tag===19)FR(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(fn(Mn,r),!(e.mode&1))e.memoizedState=null;else switch(a){case"forwards":for(n=e.child,a=null;n!==null;)t=n.alternate,t!==null&&S1(t)===null&&(a=n),n=n.sibling;n=a,n===null?(a=e.child,e.child=null):(a=n.sibling,n.sibling=null),hC(e,!1,a,n,i);break;case"backwards":for(n=null,a=e.child,e.child=null;a!==null;){if(t=a.alternate,t!==null&&S1(t)===null){e.child=a;break}t=a.sibling,a.sibling=n,n=a,a=t}hC(e,!0,n,null,i);break;case"together":hC(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function O1(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function cs(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Su|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Se(153));if(e.child!==null){for(t=e.child,n=gl(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=gl(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function xH(t,e,n){switch(e.tag){case 3:PR(e),cd();break;case 5:nR(e);break;case 1:Ma(e.type)&&p1(e);break;case 4:KS(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,a=e.memoizedProps.value;fn(y1,r._currentValue),r._currentValue=a;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(fn(Mn,Mn.current&1),e.flags|=128,null):n&e.child.childLanes?DR(t,e,n):(fn(Mn,Mn.current&1),t=cs(t,e,n),t!==null?t.sibling:null);fn(Mn,Mn.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return BR(t,e,n);e.flags|=128}if(a=e.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),fn(Mn,Mn.current),r)break;return null;case 22:case 23:return e.lanes=0,RR(t,e,n)}return cs(t,e,n)}var zR,fC,jR,VR;zR=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},fC=function(){},jR=function(t,e,n,r){var a=t.memoizedProps;if(a!==r){t=e.stateNode,wu(To.current);var i=null;switch(n){case"input":a=Wk(t,a),r=Wk(t,r),i=[];break;case"select":a=Rn({},a,{value:void 0}),r=Rn({},r,{value:void 0}),i=[];break;case"textarea":a=Hk(t,a),r=Hk(t,r),i=[];break;default:typeof a.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=u1)}Kk(n,r);var o;n=null;for(u in a)if(!r.hasOwnProperty(u)&&a.hasOwnProperty(u)&&a[u]!=null)if(u==="style"){var s=a[u];for(o in s)s.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(hh.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in r){var l=r[u];if(s=a?.[u],r.hasOwnProperty(u)&&l!==s&&(l!=null||s!=null))if(u==="style")if(s){for(o in s)!s.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&s[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(i||(i=[]),i.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,s=s?s.__html:void 0,l!=null&&s!==l&&(i=i||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(hh.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&vn("scroll",t),i||s===l||(i=[])):(i=i||[]).push(u,l))}n&&(i=i||[]).push("style",n);var u=i;(e.updateQueue=u)&&(e.flags|=4)}},VR=function(t,e,n,r){n!==r&&(e.flags|=4)};function Xh(t,e){if(!Nn)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function na(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var a=t.child;a!==null;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags&14680064,r|=a.flags&14680064,a.return=t,a=a.sibling;else for(a=t.child;a!==null;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags,r|=a.flags,a.return=t,a=a.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function wH(t,e,n){var r=e.pendingProps;switch(LS(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return na(e),null;case 1:return Ma(e.type)&&d1(),na(e),null;case 3:return r=e.stateNode,fd(),xn(Ra),xn(ea),QS(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(m1(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Xi!==null&&(CC(Xi),Xi=null))),fC(t,e),na(e),null;case 5:XS(e);var a=wu(Uh.current);if(n=e.type,t!==null&&e.stateNode!=null)jR(t,e,n,r,a),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(Se(166));return na(e),null}if(t=wu(To.current),m1(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[No]=e,r[Bh]=i,t=(e.mode&1)!==0,n){case"dialog":vn("cancel",r),vn("close",r);break;case"iframe":case"object":case"embed":vn("load",r);break;case"video":case"audio":for(a=0;a<Lh.length;a++)vn(Lh[a],r);break;case"source":vn("error",r);break;case"img":case"image":case"link":vn("error",r),vn("load",r);break;case"details":vn("toggle",r);break;case"input":wO(r,i),vn("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},vn("invalid",r);break;case"textarea":CO(r,i),vn("invalid",r)}Kk(n,i),a=null;for(var o in i)if(i.hasOwnProperty(o)){var s=i[o];o==="children"?typeof s=="string"?r.textContent!==s&&(i.suppressHydrationWarning!==!0&&l1(r.textContent,s,t),a=["children",s]):typeof s=="number"&&r.textContent!==""+s&&(i.suppressHydrationWarning!==!0&&l1(r.textContent,s,t),a=["children",""+s]):hh.hasOwnProperty(o)&&s!=null&&o==="onScroll"&&vn("scroll",r)}switch(n){case"input":B0(r),SO(r,i,!0);break;case"textarea":B0(r),TO(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=u1)}r=a,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=a.nodeType===9?a:a.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=IO(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[No]=e,t[Bh]=r,zR(t,e,!1,!1),e.stateNode=t;e:{switch(o=Xk(n,r),n){case"dialog":vn("cancel",t),vn("close",t),a=r;break;case"iframe":case"object":case"embed":vn("load",t),a=r;break;case"video":case"audio":for(a=0;a<Lh.length;a++)vn(Lh[a],t);a=r;break;case"source":vn("error",t),a=r;break;case"img":case"image":case"link":vn("error",t),vn("load",t),a=r;break;case"details":vn("toggle",t),a=r;break;case"input":wO(t,r),a=Wk(t,r),vn("invalid",t);break;case"option":a=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},a=Rn({},r,{value:void 0}),vn("invalid",t);break;case"textarea":CO(t,r),a=Hk(t,r),vn("invalid",t);break;default:a=r}Kk(n,a),s=a;for(i in s)if(s.hasOwnProperty(i)){var l=s[i];i==="style"?OO(t,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&EO(t,l)):i==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&yh(t,l):typeof l=="number"&&yh(t,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(hh.hasOwnProperty(i)?l!=null&&i==="onScroll"&&vn("scroll",t):l!=null&&Rk(t,i,l,o))}switch(n){case"input":B0(t),SO(t,r,!1);break;case"textarea":B0(t),TO(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Qs(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?Xc(t,!!r.multiple,i,!1):r.defaultValue!=null&&Xc(t,!!r.multiple,r.defaultValue,!0);break;default:typeof a.onClick=="function"&&(t.onclick=u1)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return na(e),null;case 6:if(t&&e.stateNode!=null)VR(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(Se(166));if(n=wu(Uh.current),wu(To.current),m1(e)){if(r=e.stateNode,n=e.memoizedProps,r[No]=e,(i=r.nodeValue!==n)&&(t=Za,t!==null))switch(t.tag){case 3:l1(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&l1(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[No]=e,e.stateNode=r}return na(e),null;case 13:if(xn(Mn),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Nn&&Ja!==null&&e.mode&1&&!(e.flags&128))U$(),cd(),e.flags|=98560,i=!1;else if(i=m1(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(Se(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Se(317));i[No]=e}else cd(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;na(e),i=!1}else Xi!==null&&(CC(Xi),Xi=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Mn.current&1?ur===0&&(ur=3):IC())),e.updateQueue!==null&&(e.flags|=4),na(e),null);case 4:return fd(),fC(t,e),t===null&&Dh(e.stateNode.containerInfo),na(e),null;case 10:return VS(e.type._context),na(e),null;case 17:return Ma(e.type)&&d1(),na(e),null;case 19:if(xn(Mn),i=e.memoizedState,i===null)return na(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)Xh(i,!1);else{if(ur!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=S1(t),o!==null){for(e.flags|=128,Xh(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return fn(Mn,Mn.current&1|2),e.child}t=t.sibling}i.tail!==null&&Kn()>bd&&(e.flags|=128,r=!0,Xh(i,!1),e.lanes=4194304)}else{if(!r)if(t=S1(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Xh(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Nn)return na(e),null}else 2*Kn()-i.renderingStartTime>bd&&n!==1073741824&&(e.flags|=128,r=!0,Xh(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Kn(),e.sibling=null,n=Mn.current,fn(Mn,r?n&1|2:n&1),e):(na(e),null);case 22:case 23:return TC(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?ei&1073741824&&(na(e),e.subtreeFlags&6&&(e.flags|=8192)):na(e),null;case 24:return null;case 25:return null}throw Error(Se(156,e.tag))}function kH(t,e){switch(LS(e),e.tag){case 1:return Ma(e.type)&&d1(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return fd(),xn(Ra),xn(ea),QS(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return XS(e),null;case 13:if(xn(Mn),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Se(340));cd()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return xn(Mn),null;case 4:return fd(),null;case 10:return VS(e.type._context),null;case 22:case 23:return TC(),null;case 24:return null;default:return null}}var $1=!1,ra=!1,SH=typeof WeakSet=="function"?WeakSet:Set,Be=null;function md(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){zn(t,e,r)}else n.current=null}function WR(t,e,n){try{n()}catch(r){zn(t,e,r)}}var UR=!1;function CH(t,e){if(IS=Q0,t=x$(),vS(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var a=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,s=-1,l=-1,u=0,c=0,d=t,p=null;t:for(;;){for(var f;d!==n||a!==0&&d.nodeType!==3||(s=o+a),d!==i||r!==0&&d.nodeType!==3||(l=o+r),d.nodeType===3&&(o+=d.nodeValue.length),(f=d.firstChild)!==null;)p=d,d=f;for(;;){if(d===t)break t;if(p===n&&++u===a&&(s=o),p===i&&++c===r&&(l=o),(f=d.nextSibling)!==null)break;d=p,p=d.parentNode}d=f}n=s===-1||l===-1?null:{start:s,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(ES={focusedElem:t,selectionRange:n},Q0=!1,Be=e;Be!==null;)if(e=Be,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Be=t;else for(;Be!==null;){e=Be;try{var m=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var y=m.memoizedProps,x=m.memoizedState,b=e.stateNode,v=b.getSnapshotBeforeUpdate(e.elementType===e.type?y:Yi(e.type,y),x);b.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var w=e.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Se(163))}}catch(S){zn(e,e.return,S)}if(t=e.sibling,t!==null){t.return=e.return,Be=t;break}Be=e.return}return m=UR,UR=!1,m}function Yh(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var a=r=r.next;do{if((a.tag&t)===t){var i=a.destroy;a.destroy=void 0,i!==void 0&&WR(e,n,i)}a=a.next}while(a!==r)}}function R1(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function gC(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function GR(t){var e=t.alternate;e!==null&&(t.alternate=null,GR(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[No],delete e[Bh],delete e[RS],delete e[oH],delete e[sH])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function HR(t){return t.tag===5||t.tag===3||t.tag===4}function qR(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||HR(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function mC(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=u1));else if(r!==4&&(t=t.child,t!==null))for(mC(t,e,n),t=t.sibling;t!==null;)mC(t,e,n),t=t.sibling}function yC(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(yC(t,e,n),t=t.sibling;t!==null;)yC(t,e,n),t=t.sibling}var Fr=null,Qi=!1;function cl(t,e,n){for(n=n.child;n!==null;)KR(t,e,n),n=n.sibling}function KR(t,e,n){if(Co&&typeof Co.onCommitFiberUnmount=="function")try{Co.onCommitFiberUnmount(G0,n)}catch{}switch(n.tag){case 5:ra||md(n,e);case 6:var r=Fr,a=Qi;Fr=null,cl(t,e,n),Fr=r,Qi=a,Fr!==null&&(Qi?(t=Fr,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Fr.removeChild(n.stateNode));break;case 18:Fr!==null&&(Qi?(t=Fr,n=n.stateNode,t.nodeType===8?$S(t.parentNode,n):t.nodeType===1&&$S(t,n),Eh(t)):$S(Fr,n.stateNode));break;case 4:r=Fr,a=Qi,Fr=n.stateNode.containerInfo,Qi=!0,cl(t,e,n),Fr=r,Qi=a;break;case 0:case 11:case 14:case 15:if(!ra&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){a=r=r.next;do{var i=a,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&WR(n,e,o),a=a.next}while(a!==r)}cl(t,e,n);break;case 1:if(!ra&&(md(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(s){zn(n,e,s)}cl(t,e,n);break;case 21:cl(t,e,n);break;case 22:n.mode&1?(ra=(r=ra)||n.memoizedState!==null,cl(t,e,n),ra=r):cl(t,e,n);break;default:cl(t,e,n)}}function XR(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new SH),e.forEach(function(r){var a=MH.bind(null,t,r);n.has(r)||(n.add(r),r.then(a,a))})}}function Zi(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var a=n[r];try{var i=t,o=e,s=o;e:for(;s!==null;){switch(s.tag){case 5:Fr=s.stateNode,Qi=!1;break e;case 3:Fr=s.stateNode.containerInfo,Qi=!0;break e;case 4:Fr=s.stateNode.containerInfo,Qi=!0;break e}s=s.return}if(Fr===null)throw Error(Se(160));KR(i,o,a),Fr=null,Qi=!1;var l=a.alternate;l!==null&&(l.return=null),a.return=null}catch(u){zn(a,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)YR(e,t),e=e.sibling}function YR(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Zi(e,t),Eo(t),r&4){try{Yh(3,t,t.return),R1(3,t)}catch(y){zn(t,t.return,y)}try{Yh(5,t,t.return)}catch(y){zn(t,t.return,y)}}break;case 1:Zi(e,t),Eo(t),r&512&&n!==null&&md(n,n.return);break;case 5:if(Zi(e,t),Eo(t),r&512&&n!==null&&md(n,n.return),t.flags&32){var a=t.stateNode;try{yh(a,"")}catch(y){zn(t,t.return,y)}}if(r&4&&(a=t.stateNode,a!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,s=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{s==="input"&&i.type==="radio"&&i.name!=null&&kO(a,i),Xk(s,o);var u=Xk(s,i);for(o=0;o<l.length;o+=2){var c=l[o],d=l[o+1];c==="style"?OO(a,d):c==="dangerouslySetInnerHTML"?EO(a,d):c==="children"?yh(a,d):Rk(a,c,d,u)}switch(s){case"input":Uk(a,i);break;case"textarea":NO(a,i);break;case"select":var p=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!i.multiple;var f=i.value;f!=null?Xc(a,!!i.multiple,f,!1):p!==!!i.multiple&&(i.defaultValue!=null?Xc(a,!!i.multiple,i.defaultValue,!0):Xc(a,!!i.multiple,i.multiple?[]:"",!1))}a[Bh]=i}catch(y){zn(t,t.return,y)}}break;case 6:if(Zi(e,t),Eo(t),r&4){if(t.stateNode===null)throw Error(Se(162));a=t.stateNode,i=t.memoizedProps;try{a.nodeValue=i}catch(y){zn(t,t.return,y)}}break;case 3:if(Zi(e,t),Eo(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Eh(e.containerInfo)}catch(y){zn(t,t.return,y)}break;case 4:Zi(e,t),Eo(t);break;case 13:Zi(e,t),Eo(t),a=t.child,a.flags&8192&&(i=a.memoizedState!==null,a.stateNode.isHidden=i,!i||a.alternate!==null&&a.alternate.memoizedState!==null||(xC=Kn())),r&4&&XR(t);break;case 22:if(c=n!==null&&n.memoizedState!==null,t.mode&1?(ra=(u=ra)||c,Zi(e,t),ra=u):Zi(e,t),Eo(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!c&&t.mode&1)for(Be=t,c=t.child;c!==null;){for(d=Be=c;Be!==null;){switch(p=Be,f=p.child,p.tag){case 0:case 11:case 14:case 15:Yh(4,p,p.return);break;case 1:md(p,p.return);var m=p.stateNode;if(typeof m.componentWillUnmount=="function"){r=p,n=p.return;try{e=r,m.props=e.memoizedProps,m.state=e.memoizedState,m.componentWillUnmount()}catch(y){zn(r,n,y)}}break;case 5:md(p,p.return);break;case 22:if(p.memoizedState!==null){JR(d);continue}}f!==null?(f.return=p,Be=f):JR(d)}c=c.sibling}e:for(c=null,d=t;;){if(d.tag===5){if(c===null){c=d;try{a=d.stateNode,u?(i=a.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(s=d.stateNode,l=d.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,s.style.display=_O("display",o))}catch(y){zn(t,t.return,y)}}}else if(d.tag===6){if(c===null)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(y){zn(t,t.return,y)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===t)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;c===d&&(c=null),d=d.return}c===d&&(c=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Zi(e,t),Eo(t),r&4&&XR(t);break;case 21:break;default:Zi(e,t),Eo(t)}}function Eo(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(HR(n)){var r=n;break e}n=n.return}throw Error(Se(160))}switch(r.tag){case 5:var a=r.stateNode;r.flags&32&&(yh(a,""),r.flags&=-33);var i=qR(t);yC(t,i,a);break;case 3:case 4:var o=r.stateNode.containerInfo,s=qR(t);mC(t,s,o);break;default:throw Error(Se(161))}}catch(l){zn(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function NH(t,e,n){Be=t,QR(t)}function QR(t,e,n){for(var r=(t.mode&1)!==0;Be!==null;){var a=Be,i=a.child;if(a.tag===22&&r){var o=a.memoizedState!==null||$1;if(!o){var s=a.alternate,l=s!==null&&s.memoizedState!==null||ra;s=$1;var u=ra;if($1=o,(ra=l)&&!u)for(Be=a;Be!==null;)o=Be,l=o.child,o.tag===22&&o.memoizedState!==null?eM(a):l!==null?(l.return=o,Be=l):eM(a);for(;i!==null;)Be=i,QR(i),i=i.sibling;Be=a,$1=s,ra=u}ZR(t)}else a.subtreeFlags&8772&&i!==null?(i.return=a,Be=i):ZR(t)}}function ZR(t){for(;Be!==null;){var e=Be;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:ra||R1(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!ra)if(n===null)r.componentDidMount();else{var a=e.elementType===e.type?n.memoizedProps:Yi(e.type,n.memoizedProps);r.componentDidUpdate(a,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&K$(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}K$(e,o,n)}break;case 5:var s=e.stateNode;if(n===null&&e.flags&4){n=s;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var d=c.dehydrated;d!==null&&Eh(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Se(163))}ra||e.flags&512&&gC(e)}catch(p){zn(e,e.return,p)}}if(e===t){Be=null;break}if(n=e.sibling,n!==null){n.return=e.return,Be=n;break}Be=e.return}}function JR(t){for(;Be!==null;){var e=Be;if(e===t){Be=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Be=n;break}Be=e.return}}function eM(t){for(;Be!==null;){var e=Be;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{R1(4,e)}catch(l){zn(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var a=e.return;try{r.componentDidMount()}catch(l){zn(e,a,l)}}var i=e.return;try{gC(e)}catch(l){zn(e,i,l)}break;case 5:var o=e.return;try{gC(e)}catch(l){zn(e,o,l)}}}catch(l){zn(e,e.return,l)}if(e===t){Be=null;break}var s=e.sibling;if(s!==null){s.return=e.return,Be=s;break}Be=e.return}}var TH=Math.ceil,M1=rs.ReactCurrentDispatcher,bC=rs.ReactCurrentOwner,wi=rs.ReactCurrentBatchConfig,Lt=0,Sr=null,tr=null,Br=0,ei=0,yd=il(0),ur=0,Qh=null,Su=0,A1=0,vC=0,Zh=null,Pa=null,xC=0,bd=1/0,ds=null,P1=!1,wC=null,dl=null,L1=!1,pl=null,D1=0,Jh=0,kC=null,F1=-1,B1=0;function ka(){return Lt&6?Kn():F1!==-1?F1:F1=Kn()}function hl(t){return t.mode&1?Lt&2&&Br!==0?Br&-Br:uH.transition!==null?(B1===0&&(B1=GO()),B1):(t=Zt,t!==0||(t=window.event,t=t===void 0?16:e$(t.type)),t):1}function Ji(t,e,n,r){if(50<Jh)throw Jh=0,kC=null,Error(Se(185));Sh(t,n,r),(!(Lt&2)||t!==Sr)&&(t===Sr&&(!(Lt&2)&&(A1|=n),ur===4&&fl(t,Br)),La(t,r),n===1&&Lt===0&&!(e.mode&1)&&(bd=Kn()+500,h1&&sl()))}function La(t,e){var n=t.callbackNode;uG(t,e);var r=K0(t,t===Sr?Br:0);if(r===0)n!==null&&VO(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&VO(n),e===1)t.tag===0?lH(nM.bind(null,t)):B$(nM.bind(null,t)),aH(function(){!(Lt&6)&&sl()}),n=null;else{switch(HO(r)){case 1:n=nS;break;case 4:n=WO;break;case 16:n=U0;break;case 536870912:n=UO;break;default:n=U0}n=cM(n,tM.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function tM(t,e){if(F1=-1,B1=0,Lt&6)throw Error(Se(327));var n=t.callbackNode;if(vd()&&t.callbackNode!==n)return null;var r=K0(t,t===Sr?Br:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=z1(t,r);else{e=r;var a=Lt;Lt|=2;var i=aM();(Sr!==t||Br!==e)&&(ds=null,bd=Kn()+500,Nu(t,e));do try{_H();break}catch(s){rM(t,s)}while(!0);jS(),M1.current=i,Lt=a,tr!==null?e=0:(Sr=null,Br=0,e=ur)}if(e!==0){if(e===2&&(a=rS(t),a!==0&&(r=a,e=SC(t,a))),e===1)throw n=Qh,Nu(t,0),fl(t,r),La(t,Kn()),n;if(e===6)fl(t,r);else{if(a=t.current.alternate,!(r&30)&&!IH(a)&&(e=z1(t,r),e===2&&(i=rS(t),i!==0&&(r=i,e=SC(t,i))),e===1))throw n=Qh,Nu(t,0),fl(t,r),La(t,Kn()),n;switch(t.finishedWork=a,t.finishedLanes=r,e){case 0:case 1:throw Error(Se(345));case 2:Tu(t,Pa,ds);break;case 3:if(fl(t,r),(r&130023424)===r&&(e=xC+500-Kn(),10<e)){if(K0(t,0)!==0)break;if(a=t.suspendedLanes,(a&r)!==r){ka(),t.pingedLanes|=t.suspendedLanes&a;break}t.timeoutHandle=OS(Tu.bind(null,t,Pa,ds),e);break}Tu(t,Pa,ds);break;case 4:if(fl(t,r),(r&4194240)===r)break;for(e=t.eventTimes,a=-1;0<r;){var o=31-qi(r);i=1<<o,o=e[o],o>a&&(a=o),r&=~i}if(r=a,r=Kn()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*TH(r/1960))-r,10<r){t.timeoutHandle=OS(Tu.bind(null,t,Pa,ds),r);break}Tu(t,Pa,ds);break;case 5:Tu(t,Pa,ds);break;default:throw Error(Se(329))}}}return La(t,Kn()),t.callbackNode===n?tM.bind(null,t):null}function SC(t,e){var n=Zh;return t.current.memoizedState.isDehydrated&&(Nu(t,e).flags|=256),t=z1(t,e),t!==2&&(e=Pa,Pa=n,e!==null&&CC(e)),t}function CC(t){Pa===null?Pa=t:Pa.push.apply(Pa,t)}function IH(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var a=n[r],i=a.getSnapshot;a=a.value;try{if(!Ki(i(),a))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function fl(t,e){for(e&=~vC,e&=~A1,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-qi(e),r=1<<n;t[n]=-1,e&=~r}}function nM(t){if(Lt&6)throw Error(Se(327));vd();var e=K0(t,0);if(!(e&1))return La(t,Kn()),null;var n=z1(t,e);if(t.tag!==0&&n===2){var r=rS(t);r!==0&&(e=r,n=SC(t,r))}if(n===1)throw n=Qh,Nu(t,0),fl(t,e),La(t,Kn()),n;if(n===6)throw Error(Se(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Tu(t,Pa,ds),La(t,Kn()),null}function NC(t,e){var n=Lt;Lt|=1;try{return t(e)}finally{Lt=n,Lt===0&&(bd=Kn()+500,h1&&sl())}}function Cu(t){pl!==null&&pl.tag===0&&!(Lt&6)&&vd();var e=Lt;Lt|=1;var n=wi.transition,r=Zt;try{if(wi.transition=null,Zt=1,t)return t()}finally{Zt=r,wi.transition=n,Lt=e,!(Lt&6)&&sl()}}function TC(){ei=yd.current,xn(yd)}function Nu(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,rH(n)),tr!==null)for(n=tr.return;n!==null;){var r=n;switch(LS(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&d1();break;case 3:fd(),xn(Ra),xn(ea),QS();break;case 5:XS(r);break;case 4:fd();break;case 13:xn(Mn);break;case 19:xn(Mn);break;case 10:VS(r.type._context);break;case 22:case 23:TC()}n=n.return}if(Sr=t,tr=t=gl(t.current,null),Br=ei=e,ur=0,Qh=null,vC=A1=Su=0,Pa=Zh=null,xu!==null){for(e=0;e<xu.length;e++)if(n=xu[e],r=n.interleaved,r!==null){n.interleaved=null;var a=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=a,r.next=o}n.pending=r}xu=null}return t}function rM(t,e){do{var n=tr;try{if(jS(),C1.current=E1,N1){for(var r=An.memoizedState;r!==null;){var a=r.queue;a!==null&&(a.pending=null),r=r.next}N1=!1}if(ku=0,kr=lr=An=null,Gh=!1,Hh=0,bC.current=null,n===null||n.return===null){ur=1,Qh=e,tr=null;break}e:{var i=t,o=n.return,s=n,l=e;if(e=Br,s.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,c=s,d=c.tag;if(!(c.mode&1)&&(d===0||d===11||d===15)){var p=c.alternate;p?(c.updateQueue=p.updateQueue,c.memoizedState=p.memoizedState,c.lanes=p.lanes):(c.updateQueue=null,c.memoizedState=null)}var f=IR(o);if(f!==null){f.flags&=-257,ER(f,o,s,i,e),f.mode&1&&TR(i,u,e),e=f,l=u;var m=e.updateQueue;if(m===null){var y=new Set;y.add(l),e.updateQueue=y}else m.add(l);break e}else{if(!(e&1)){TR(i,u,e),IC();break e}l=Error(Se(426))}}else if(Nn&&s.mode&1){var x=IR(o);if(x!==null){!(x.flags&65536)&&(x.flags|=256),ER(x,o,s,i,e),BS(gd(l,s));break e}}i=l=gd(l,s),ur!==4&&(ur=2),Zh===null?Zh=[i]:Zh.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var b=CR(i,l,e);q$(i,b);break e;case 1:s=l;var v=i.type,w=i.stateNode;if(!(i.flags&128)&&(typeof v.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(dl===null||!dl.has(w)))){i.flags|=65536,e&=-e,i.lanes|=e;var S=NR(i,s,e);q$(i,S);break e}}i=i.return}while(i!==null)}oM(n)}catch(C){e=C,tr===n&&n!==null&&(tr=n=n.return);continue}break}while(!0)}function aM(){var t=M1.current;return M1.current=E1,t===null?E1:t}function IC(){(ur===0||ur===3||ur===2)&&(ur=4),Sr===null||!(Su&268435455)&&!(A1&268435455)||fl(Sr,Br)}function z1(t,e){var n=Lt;Lt|=2;var r=aM();(Sr!==t||Br!==e)&&(ds=null,Nu(t,e));do try{EH();break}catch(a){rM(t,a)}while(!0);if(jS(),Lt=n,M1.current=r,tr!==null)throw Error(Se(261));return Sr=null,Br=0,ur}function EH(){for(;tr!==null;)iM(tr)}function _H(){for(;tr!==null&&!eG();)iM(tr)}function iM(t){var e=uM(t.alternate,t,ei);t.memoizedProps=t.pendingProps,e===null?oM(t):tr=e,bC.current=null}function oM(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=kH(n,e),n!==null){n.flags&=32767,tr=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{ur=6,tr=null;return}}else if(n=wH(n,e,ei),n!==null){tr=n;return}if(e=e.sibling,e!==null){tr=e;return}tr=e=t}while(e!==null);ur===0&&(ur=5)}function Tu(t,e,n){var r=Zt,a=wi.transition;try{wi.transition=null,Zt=1,OH(t,e,n,r)}finally{wi.transition=a,Zt=r}return null}function OH(t,e,n,r){do vd();while(pl!==null);if(Lt&6)throw Error(Se(327));n=t.finishedWork;var a=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(Se(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(cG(t,i),t===Sr&&(tr=Sr=null,Br=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||L1||(L1=!0,cM(U0,function(){return vd(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=wi.transition,wi.transition=null;var o=Zt;Zt=1;var s=Lt;Lt|=4,bC.current=null,CH(t,n),YR(n,t),YG(ES),Q0=!!IS,ES=IS=null,t.current=n,NH(n),tG(),Lt=s,Zt=o,wi.transition=i}else t.current=n;if(L1&&(L1=!1,pl=t,D1=a),i=t.pendingLanes,i===0&&(dl=null),aG(n.stateNode),La(t,Kn()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)a=e[n],r(a.value,{componentStack:a.stack,digest:a.digest});if(P1)throw P1=!1,t=wC,wC=null,t;return D1&1&&t.tag!==0&&vd(),i=t.pendingLanes,i&1?t===kC?Jh++:(Jh=0,kC=t):Jh=0,sl(),null}function vd(){if(pl!==null){var t=HO(D1),e=wi.transition,n=Zt;try{if(wi.transition=null,Zt=16>t?16:t,pl===null)var r=!1;else{if(t=pl,pl=null,D1=0,Lt&6)throw Error(Se(331));var a=Lt;for(Lt|=4,Be=t.current;Be!==null;){var i=Be,o=i.child;if(Be.flags&16){var s=i.deletions;if(s!==null){for(var l=0;l<s.length;l++){var u=s[l];for(Be=u;Be!==null;){var c=Be;switch(c.tag){case 0:case 11:case 15:Yh(8,c,i)}var d=c.child;if(d!==null)d.return=c,Be=d;else for(;Be!==null;){c=Be;var p=c.sibling,f=c.return;if(GR(c),c===u){Be=null;break}if(p!==null){p.return=f,Be=p;break}Be=f}}}var m=i.alternate;if(m!==null){var y=m.child;if(y!==null){m.child=null;do{var x=y.sibling;y.sibling=null,y=x}while(y!==null)}}Be=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,Be=o;else e:for(;Be!==null;){if(i=Be,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Yh(9,i,i.return)}var b=i.sibling;if(b!==null){b.return=i.return,Be=b;break e}Be=i.return}}var v=t.current;for(Be=v;Be!==null;){o=Be;var w=o.child;if(o.subtreeFlags&2064&&w!==null)w.return=o,Be=w;else e:for(o=v;Be!==null;){if(s=Be,s.flags&2048)try{switch(s.tag){case 0:case 11:case 15:R1(9,s)}}catch(C){zn(s,s.return,C)}if(s===o){Be=null;break e}var S=s.sibling;if(S!==null){S.return=s.return,Be=S;break e}Be=s.return}}if(Lt=a,sl(),Co&&typeof Co.onPostCommitFiberRoot=="function")try{Co.onPostCommitFiberRoot(G0,t)}catch{}r=!0}return r}finally{Zt=n,wi.transition=e}}return!1}function sM(t,e,n){e=gd(n,e),e=CR(t,e,1),t=ul(t,e,1),e=ka(),t!==null&&(Sh(t,1,e),La(t,e))}function zn(t,e,n){if(t.tag===3)sM(t,t,n);else for(;e!==null;){if(e.tag===3){sM(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(dl===null||!dl.has(r))){t=gd(n,t),t=NR(e,t,1),e=ul(e,t,1),t=ka(),e!==null&&(Sh(e,1,t),La(e,t));break}}e=e.return}}function $H(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=ka(),t.pingedLanes|=t.suspendedLanes&n,Sr===t&&(Br&n)===n&&(ur===4||ur===3&&(Br&130023424)===Br&&500>Kn()-xC?Nu(t,0):vC|=n),La(t,e)}function lM(t,e){e===0&&(t.mode&1?(e=q0,q0<<=1,!(q0&130023424)&&(q0=4194304)):e=1);var n=ka();t=ls(t,e),t!==null&&(Sh(t,e,n),La(t,n))}function RH(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),lM(t,n)}function MH(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,a=t.memoizedState;a!==null&&(n=a.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(Se(314))}r!==null&&r.delete(e),lM(t,n)}var uM;uM=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Ra.current)Aa=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Aa=!1,xH(t,e,n);Aa=!!(t.flags&131072)}else Aa=!1,Nn&&e.flags&1048576&&z$(e,g1,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;O1(t,e),t=e.pendingProps;var a=sd(e,ea.current);pd(e,n),a=eC(null,e,r,t,a,n);var i=tC();return e.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Ma(r)?(i=!0,p1(e)):i=!1,e.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,GS(e),a.updater=w1,e.stateNode=a,a._reactInternals=e,qS(e,r,t,n),e=uC(null,e,r,!0,i,n)):(e.tag=0,Nn&&i&&PS(e),wa(null,e,a,n),e=e.child),e;case 16:r=e.elementType;e:{switch(O1(t,e),t=e.pendingProps,a=r._init,r=a(r._payload),e.type=r,a=e.tag=PH(r),t=Yi(r,t),a){case 0:e=lC(null,e,r,t,n);break e;case 1:e=AR(null,e,r,t,n);break e;case 11:e=_R(null,e,r,t,n);break e;case 14:e=OR(null,e,r,Yi(r.type,t),n);break e}throw Error(Se(306,r,""))}return e;case 0:return r=e.type,a=e.pendingProps,a=e.elementType===r?a:Yi(r,a),lC(t,e,r,a,n);case 1:return r=e.type,a=e.pendingProps,a=e.elementType===r?a:Yi(r,a),AR(t,e,r,a,n);case 3:e:{if(PR(e),t===null)throw Error(Se(387));r=e.pendingProps,i=e.memoizedState,a=i.element,H$(t,e),x1(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){a=gd(Error(Se(423)),e),e=LR(t,e,r,n,a);break e}else if(r!==a){a=gd(Error(Se(424)),e),e=LR(t,e,r,n,a);break e}else for(Ja=al(e.stateNode.containerInfo.firstChild),Za=e,Nn=!0,Xi=null,n=tR(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(cd(),r===a){e=cs(t,e,n);break e}wa(t,e,r,n)}e=e.child}return e;case 5:return nR(e),t===null&&FS(e),r=e.type,a=e.pendingProps,i=t!==null?t.memoizedProps:null,o=a.children,_S(r,a)?o=null:i!==null&&_S(r,i)&&(e.flags|=32),MR(t,e),wa(t,e,o,n),e.child;case 6:return t===null&&FS(e),null;case 13:return DR(t,e,n);case 4:return KS(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=hd(e,null,r,n):wa(t,e,r,n),e.child;case 11:return r=e.type,a=e.pendingProps,a=e.elementType===r?a:Yi(r,a),_R(t,e,r,a,n);case 7:return wa(t,e,e.pendingProps,n),e.child;case 8:return wa(t,e,e.pendingProps.children,n),e.child;case 12:return wa(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,a=e.pendingProps,i=e.memoizedProps,o=a.value,fn(y1,r._currentValue),r._currentValue=o,i!==null)if(Ki(i.value,o)){if(i.children===a.children&&!Ra.current){e=cs(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var s=i.dependencies;if(s!==null){o=i.child;for(var l=s.firstContext;l!==null;){if(l.context===r){if(i.tag===1){l=us(-1,n&-n),l.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?l.next=l:(l.next=c.next,c.next=l),u.pending=l}}i.lanes|=n,l=i.alternate,l!==null&&(l.lanes|=n),WS(i.return,n,e),s.lanes|=n;break}l=l.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(Se(341));o.lanes|=n,s=o.alternate,s!==null&&(s.lanes|=n),WS(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}wa(t,e,a.children,n),e=e.child}return e;case 9:return a=e.type,r=e.pendingProps.children,pd(e,n),a=vi(a),r=r(a),e.flags|=1,wa(t,e,r,n),e.child;case 14:return r=e.type,a=Yi(r,e.pendingProps),a=Yi(r.type,a),OR(t,e,r,a,n);case 15:return $R(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,a=e.pendingProps,a=e.elementType===r?a:Yi(r,a),O1(t,e),e.tag=1,Ma(r)?(t=!0,p1(e)):t=!1,pd(e,n),Q$(e,r,a),qS(e,r,a,n),uC(null,e,r,!0,t,n);case 19:return BR(t,e,n);case 22:return RR(t,e,n)}throw Error(Se(156,e.tag))};function cM(t,e){return jO(t,e)}function AH(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ki(t,e,n,r){return new AH(t,e,n,r)}function EC(t){return t=t.prototype,!(!t||!t.isReactComponent)}function PH(t){if(typeof t=="function")return EC(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Pk)return 11;if(t===Fk)return 14}return 2}function gl(t,e){var n=t.alternate;return n===null?(n=ki(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function j1(t,e,n,r,a,i){var o=2;if(r=t,typeof t=="function")EC(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Kc:return Iu(n.children,a,i,e);case Mk:o=8,a|=8;break;case Ak:return t=ki(12,n,e,a|2),t.elementType=Ak,t.lanes=i,t;case Lk:return t=ki(13,n,e,a),t.elementType=Lk,t.lanes=i,t;case Dk:return t=ki(19,n,e,a),t.elementType=Dk,t.lanes=i,t;case yO:return V1(n,a,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case gO:o=10;break e;case mO:o=9;break e;case Pk:o=11;break e;case Fk:o=14;break e;case Ys:o=16,r=null;break e}throw Error(Se(130,t==null?t:typeof t,""))}return e=ki(o,n,e,a),e.elementType=t,e.type=r,e.lanes=i,e}function Iu(t,e,n,r){return t=ki(7,t,r,e),t.lanes=n,t}function V1(t,e,n,r){return t=ki(22,t,r,e),t.elementType=yO,t.lanes=n,t.stateNode={isHidden:!1},t}function _C(t,e,n){return t=ki(6,t,null,e),t.lanes=n,t}function OC(t,e,n){return e=ki(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function LH(t,e,n,r,a){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=aS(0),this.expirationTimes=aS(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=aS(0),this.identifierPrefix=r,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function $C(t,e,n,r,a,i,o,s,l){return t=new LH(t,e,n,s,l),e===1?(e=1,i===!0&&(e|=8)):e=0,i=ki(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},GS(i),t}function DH(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:qc,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function dM(t){if(!t)return ol;t=t._reactInternals;e:{if(gu(t)!==t||t.tag!==1)throw Error(Se(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Ma(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Se(171))}if(t.tag===1){var n=t.type;if(Ma(n))return D$(t,n,e)}return e}function pM(t,e,n,r,a,i,o,s,l){return t=$C(n,r,!0,t,a,i,o,s,l),t.context=dM(null),n=t.current,r=ka(),a=hl(n),i=us(r,a),i.callback=e??null,ul(n,i,a),t.current.lanes=a,Sh(t,a,r),La(t,r),t}function W1(t,e,n,r){var a=e.current,i=ka(),o=hl(a);return n=dM(n),e.context===null?e.context=n:e.pendingContext=n,e=us(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=ul(a,e,o),t!==null&&(Ji(t,a,o,i),v1(t,a,o)),o}function U1(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function hM(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function RC(t,e){hM(t,e),(t=t.alternate)&&hM(t,e)}function FH(){return null}var fM=typeof reportError=="function"?reportError:function(t){console.error(t)};function MC(t){this._internalRoot=t}G1.prototype.render=MC.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Se(409));W1(t,e,null,null)},G1.prototype.unmount=MC.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Cu(function(){W1(null,t,null,null)}),e[as]=null}};function G1(t){this._internalRoot=t}G1.prototype.unstable_scheduleHydration=function(t){if(t){var e=XO();t={blockedOn:null,target:t,priority:e};for(var n=0;n<tl.length&&e!==0&&e<tl[n].priority;n++);tl.splice(n,0,t),n===0&&ZO(t)}};function AC(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function H1(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function gM(){}function BH(t,e,n,r,a){if(a){if(typeof r=="function"){var i=r;r=function(){var u=U1(o);i.call(u)}}var o=pM(e,r,t,0,null,!1,!1,"",gM);return t._reactRootContainer=o,t[as]=o.current,Dh(t.nodeType===8?t.parentNode:t),Cu(),o}for(;a=t.lastChild;)t.removeChild(a);if(typeof r=="function"){var s=r;r=function(){var u=U1(l);s.call(u)}}var l=$C(t,0,!1,null,null,!1,!1,"",gM);return t._reactRootContainer=l,t[as]=l.current,Dh(t.nodeType===8?t.parentNode:t),Cu(function(){W1(e,l,n,r)}),l}function q1(t,e,n,r,a){var i=n._reactRootContainer;if(i){var o=i;if(typeof a=="function"){var s=a;a=function(){var l=U1(o);s.call(l)}}W1(e,o,t,a)}else o=BH(n,e,t,a,r);return U1(o)}qO=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=kh(e.pendingLanes);n!==0&&(iS(e,n|1),La(e,Kn()),!(Lt&6)&&(bd=Kn()+500,sl()))}break;case 13:Cu(function(){var r=ls(t,1);if(r!==null){var a=ka();Ji(r,t,1,a)}}),RC(t,1)}},oS=function(t){if(t.tag===13){var e=ls(t,134217728);if(e!==null){var n=ka();Ji(e,t,134217728,n)}RC(t,134217728)}},KO=function(t){if(t.tag===13){var e=hl(t),n=ls(t,e);if(n!==null){var r=ka();Ji(n,t,e,r)}RC(t,e)}},XO=function(){return Zt},YO=function(t,e){var n=Zt;try{return Zt=t,e()}finally{Zt=n}},Zk=function(t,e,n){switch(e){case"input":if(Uk(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var a=c1(r);if(!a)throw Error(Se(90));xO(r),Uk(r,a)}}}break;case"textarea":NO(t,n);break;case"select":e=n.value,e!=null&&Xc(t,!!n.multiple,e,!1)}},AO=NC,PO=Cu;var zH={usingClientEntryPoint:!1,Events:[zh,id,c1,RO,MO,NC]},ef={findFiberByHostInstance:mu,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},jH={bundleType:ef.bundleType,version:ef.version,rendererPackageName:ef.rendererPackageName,rendererConfig:ef.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:rs.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=BO(t),t===null?null:t.stateNode},findFiberByHostInstance:ef.findFiberByHostInstance||FH,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var K1=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!K1.isDisabled&&K1.supportsFiber)try{G0=K1.inject(jH),Co=K1}catch{}}Xa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=zH,Xa.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!AC(e))throw Error(Se(200));return DH(t,e,null,n)},Xa.createRoot=function(t,e){if(!AC(t))throw Error(Se(299));var n=!1,r="",a=fM;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(a=e.onRecoverableError)),e=$C(t,1,!1,null,null,n,!1,r,a),t[as]=e.current,Dh(t.nodeType===8?t.parentNode:t),new MC(e)},Xa.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Se(188)):(t=Object.keys(t).join(","),Error(Se(268,t)));return t=BO(e),t=t===null?null:t.stateNode,t},Xa.flushSync=function(t){return Cu(t)},Xa.hydrate=function(t,e,n){if(!H1(e))throw Error(Se(200));return q1(null,t,e,!0,n)},Xa.hydrateRoot=function(t,e,n){if(!AC(t))throw Error(Se(405));var r=n!=null&&n.hydratedSources||null,a=!1,i="",o=fM;if(n!=null&&(n.unstable_strictMode===!0&&(a=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=pM(e,null,t,1,n??null,a,!1,i,o),t[as]=e.current,Dh(t),r)for(t=0;t<r.length;t++)n=r[t],a=n._getVersion,a=a(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,a]:e.mutableSourceEagerHydrationData.push(n,a);return new G1(e)},Xa.render=function(t,e,n){if(!H1(e))throw Error(Se(200));return q1(null,t,e,!1,n)},Xa.unmountComponentAtNode=function(t){if(!H1(t))throw Error(Se(40));return t._reactRootContainer?(Cu(function(){q1(null,null,t,!1,function(){t._reactRootContainer=null,t[as]=null})}),!0):!1},Xa.unstable_batchedUpdates=NC,Xa.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!H1(n))throw Error(Se(200));if(t==null||t._reactInternals===void 0)throw Error(Se(38));return q1(t,e,n,!1,r)},Xa.version="18.2.0-next-9e3b772b8-20220608";function mM(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(mM)}catch(t){console.error(t)}}mM(),lO.exports=Xa;var X1=lO.exports;const VH=gi(X1);var yM,bM=X1;yM=bM.createRoot,bM.hydrateRoot;function WH(){if(console&&console.warn){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];typeof e[0]=="string"&&(e[0]=`react-i18next:: ${e[0]}`),console.warn(...e)}}const vM={};function PC(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];typeof e[0]=="string"&&vM[e[0]]||(typeof e[0]=="string"&&(vM[e[0]]=new Date),WH(...e))}const xM=(t,e)=>()=>{if(t.isInitialized)e();else{const n=()=>{setTimeout(()=>{t.off("initialized",n)},0),e()};t.on("initialized",n)}};function wM(t,e,n){t.loadNamespaces(e,xM(t,n))}function kM(t,e,n,r){typeof n=="string"&&(n=[n]),n.forEach(a=>{t.options.ns.indexOf(a)<0&&t.options.ns.push(a)}),t.loadLanguages(e,xM(t,r))}function UH(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=e.languages[0],a=e.options?e.options.fallbackLng:!1,i=e.languages[e.languages.length-1];if(r.toLowerCase()==="cimode")return!0;const o=(s,l)=>{const u=e.services.backendConnector.state[`${s}|${l}`];return u===-1||u===2};return n.bindI18n&&n.bindI18n.indexOf("languageChanging")>-1&&e.services.backendConnector.backend&&e.isLanguageChangingTo&&!o(e.isLanguageChangingTo,t)?!1:!!(e.hasResourceBundle(r,t)||!e.services.backendConnector.backend||e.options.resources&&!e.options.partialBundledLanguages||o(r,t)&&(!a||o(i,t)))}function GH(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return!e.languages||!e.languages.length?(PC("i18n.languages were undefined or empty",e.languages),!0):e.options.ignoreJSONStructure!==void 0?e.hasLoadedNamespace(t,{lng:n.lng,precheck:(r,a)=>{if(n.bindI18n&&n.bindI18n.indexOf("languageChanging")>-1&&r.services.backendConnector.backend&&r.isLanguageChangingTo&&!a(r.isLanguageChangingTo,t))return!1}}):UH(t,e,n)}const HH=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,qH={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"\xA9","&#169;":"\xA9","&reg;":"\xAE","&#174;":"\xAE","&hellip;":"\u2026","&#8230;":"\u2026","&#x2F;":"/","&#47;":"/"},KH=t=>qH[t],XH=t=>t.replace(HH,KH);let YH={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape:XH};function QH(){return YH}let ZH;function JH(){return ZH}const SM=R.createContext();class eq{constructor(){this.usedNamespaces={}}addUsedNamespaces(e){e.forEach(n=>{this.usedNamespaces[n]||(this.usedNamespaces[n]=!0)})}getUsedNamespaces(){return Object.keys(this.usedNamespaces)}}const tq=(t,e)=>{const n=R.useRef();return R.useEffect(()=>{n.current=e?n.current:t},[t,e]),n.current};function CM(t,e,n,r){return t.getFixedT(e,n,r)}function nq(t,e,n,r){return R.useCallback(CM(t,e,n,r),[t,e,n,r])}function Eu(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{i18n:n}=e,{i18n:r,defaultNS:a}=R.useContext(SM)||{},i=n||r||JH();if(i&&!i.reportNamespaces&&(i.reportNamespaces=new eq),!i){PC("You will need to pass in an i18next instance by using initReactI18next");const C=(_,E)=>typeof E=="string"?E:E&&typeof E=="object"&&typeof E.defaultValue=="string"?E.defaultValue:Array.isArray(_)?_[_.length-1]:_,I=[C,{},!1];return I.t=C,I.i18n={},I.ready=!1,I}i.options.react&&i.options.react.wait!==void 0&&PC("It seems you are still using the old wait option, you may migrate to the new useSuspense behaviour.");const o={...QH(),...i.options.react,...e},{useSuspense:s,keyPrefix:l}=o;let u=t||a||i.options&&i.options.defaultNS;u=typeof u=="string"?[u]:u||["translation"],i.reportNamespaces.addUsedNamespaces&&i.reportNamespaces.addUsedNamespaces(u);const c=(i.isInitialized||i.initializedStoreOnce)&&u.every(C=>GH(C,i,o)),d=nq(i,e.lng||null,o.nsMode==="fallback"?u:u[0],l),p=()=>d,f=()=>CM(i,e.lng||null,o.nsMode==="fallback"?u:u[0],l),[m,y]=R.useState(p);let x=u.join();e.lng&&(x=`${e.lng}${x}`);const b=tq(x),v=R.useRef(!0);R.useEffect(()=>{const{bindI18n:C,bindI18nStore:I}=o;v.current=!0,!c&&!s&&(e.lng?kM(i,e.lng,u,()=>{v.current&&y(f)}):wM(i,u,()=>{v.current&&y(f)})),c&&b&&b!==x&&v.current&&y(f);function _(){v.current&&y(f)}return C&&i&&i.on(C,_),I&&i&&i.store.on(I,_),()=>{v.current=!1,C&&i&&C.split(" ").forEach(E=>i.off(E,_)),I&&i&&I.split(" ").forEach(E=>i.store.off(E,_))}},[i,x]);const w=R.useRef(!0);R.useEffect(()=>{v.current&&!w.current&&y(p),w.current=!1},[i,l]);const S=[m,i,c];if(S.t=m,S.i18n=i,S.ready=c,c||!c&&!s)return S;throw new Promise(C=>{e.lng?kM(i,e.lng,u,()=>C()):wM(i,u,()=>C())})}function rq(t){let{i18n:e,defaultNS:n,children:r}=t;const a=R.useMemo(()=>({i18n:e,defaultNS:n}),[e,n]);return R.createElement(SM.Provider,{value:a},r)}/**
* @remix-run/router v1.15.1
*
* Copyright (c) Remix Software Inc.
*
* This source code is licensed under the MIT license found in the
* LICENSE.md file in the root directory of this source tree.
*
* @license MIT
*/function tf(){return tf=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},tf.apply(this,arguments)}var ml;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(ml||(ml={}));const NM="popstate";function aq(t){t===void 0&&(t={});function e(r,a){let{pathname:i,search:o,hash:s}=r.location;return LC("",{pathname:i,search:o,hash:s},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function n(r,a){return typeof a=="string"?a:Y1(a)}return oq(e,n,null,t)}function Pn(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function TM(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function iq(){return Math.random().toString(36).substr(2,8)}function IM(t,e){return{usr:t.state,key:t.key,idx:e}}function LC(t,e,n,r){return n===void 0&&(n=null),tf({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?xd(e):e,{state:n,key:e&&e.key||r||iq()})}function Y1(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function xd(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function oq(t,e,n,r){r===void 0&&(r={});let{window:a=document.defaultView,v5Compat:i=!1}=r,o=a.history,s=ml.Pop,l=null,u=c();u==null&&(u=0,o.replaceState(tf({},o.state,{idx:u}),""));function c(){return(o.state||{idx:null}).idx}function d(){s=ml.Pop;let x=c(),b=x==null?null:x-u;u=x,l&&l({action:s,location:y.location,delta:b})}function p(x,b){s=ml.Push;let v=LC(y.location,x,b);n&&n(v,x),u=c()+1;let w=IM(v,u),S=y.createHref(v);try{o.pushState(w,"",S)}catch(C){if(C instanceof DOMException&&C.name==="DataCloneError")throw C;a.location.assign(S)}i&&l&&l({action:s,location:y.location,delta:1})}function f(x,b){s=ml.Replace;let v=LC(y.location,x,b);n&&n(v,x),u=c();let w=IM(v,u),S=y.createHref(v);o.replaceState(w,"",S),i&&l&&l({action:s,location:y.location,delta:0})}function m(x){let b=a.location.origin!=="null"?a.location.origin:a.location.href,v=typeof x=="string"?x:Y1(x);return v=v.replace(/ $/,"%20"),Pn(b,"No window.location.(origin|href) available to create URL for href: "+v),new URL(v,b)}let y={get action(){return s},get location(){return t(a,o)},listen(x){if(l)throw new Error("A history only accepts one active listener");return a.addEventListener(NM,d),l=x,()=>{a.removeEventListener(NM,d),l=null}},createHref(x){return e(a,x)},createURL:m,encodeLocation(x){let b=m(x);return{pathname:b.pathname,search:b.search,hash:b.hash}},push:p,replace:f,go(x){return o.go(x)}};return y}var EM;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(EM||(EM={}));function sq(t,e,n){n===void 0&&(n="/");let r=typeof e=="string"?xd(e):e,a=wd(r.pathname||"/",n);if(a==null)return null;let i=_M(t);lq(i);let o=null;for(let s=0;o==null&&s<i.length;++s){let l=vq(a);o=yq(i[s],l)}return o}function _M(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let a=(i,o,s)=>{let l={relativePath:s===void 0?i.path||"":s,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};l.relativePath.startsWith("/")&&(Pn(l.relativePath.startsWith(r),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(r.length));let u=yl([r,l.relativePath]),c=n.concat(l);i.children&&i.children.length>0&&(Pn(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),_M(i.children,e,c,u)),!(i.path==null&&!i.index)&&e.push({path:u,score:gq(u,i.index),routesMeta:c})};return t.forEach((i,o)=>{var s;if(i.path===""||!((s=i.path)!=null&&s.includes("?")))a(i,o);else for(let l of OM(i.path))a(i,o,l)}),e}function OM(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,a=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return a?[i,""]:[i];let o=OM(r.join("/")),s=[];return s.push(...o.map(l=>l===""?i:[i,l].join("/"))),a&&s.push(...o),s.map(l=>t.startsWith("/")&&l===""?"/":l)}function lq(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:mq(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const uq=/^:[\w-]+$/,cq=3,dq=2,pq=1,hq=10,fq=-2,$M=t=>t==="*";function gq(t,e){let n=t.split("/"),r=n.length;return n.some($M)&&(r+=fq),e&&(r+=dq),n.filter(a=>!$M(a)).reduce((a,i)=>a+(uq.test(i)?cq:i===""?pq:hq),r)}function mq(t,e){return t.length===e.length&&t.slice(0,-1).every((n,r)=>n===e[r])?t[t.length-1]-e[e.length-1]:0}function yq(t,e){let{routesMeta:n}=t,r={},a="/",i=[];for(let o=0;o<n.length;++o){let s=n[o],l=o===n.length-1,u=a==="/"?e:e.slice(a.length)||"/",c=Q1({path:s.relativePath,caseSensitive:s.caseSensitive,end:l},u);if(!c)return null;Object.assign(r,c.params);let d=s.route;i.push({params:r,pathname:yl([a,c.pathname]),pathnameBase:Sq(yl([a,c.pathnameBase])),route:d}),c.pathnameBase!=="/"&&(a=yl([a,c.pathnameBase]))}return i}function Q1(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=bq(t.path,t.caseSensitive,t.end),a=e.match(n);if(!a)return null;let i=a[0],o=i.replace(/(.)\/+$/,"$1"),s=a.slice(1);return{params:r.reduce((l,u,c)=>{let{paramName:d,isOptional:p}=u;if(d==="*"){let m=s[c]||"";o=i.slice(0,i.length-m.length).replace(/(.)\/+$/,"$1")}const f=s[c];return p&&!f?l[d]=void 0:l[d]=(f||"").replace(/%2F/g,"/"),l},{}),pathname:i,pathnameBase:o,pattern:t}}function bq(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),TM(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],a="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,o,s)=>(r.push({paramName:o,isOptional:s!=null}),s?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),a+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":t!==""&&t!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),r]}function vq(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return TM(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function wd(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function xq(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:a=""}=typeof t=="string"?xd(t):t;return{pathname:n?n.startsWith("/")?n:wq(n,e):e,search:Cq(r),hash:Nq(a)}}function wq(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(r=>{r===".."?n.length>1&&n.pop():r!=="."&&n.push(r)}),n.length>1?n.join("/"):"/"}function DC(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function kq(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function RM(t,e){let n=kq(t);return e?n.map((r,a)=>a===t.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function MM(t,e,n,r){r===void 0&&(r=!1);let a;typeof t=="string"?a=xd(t):(a=tf({},t),Pn(!a.pathname||!a.pathname.includes("?"),DC("?","pathname","search",a)),Pn(!a.pathname||!a.pathname.includes("#"),DC("#","pathname","hash",a)),Pn(!a.search||!a.search.includes("#"),DC("#","search","hash",a)));let i=t===""||a.pathname==="",o=i?"/":a.pathname,s;if(o==null)s=n;else{let d=e.length-1;if(!r&&o.startsWith("..")){let p=o.split("/");for(;p[0]==="..";)p.shift(),d-=1;a.pathname=p.join("/")}s=d>=0?e[d]:"/"}let l=xq(a,s),u=o&&o!=="/"&&o.endsWith("/"),c=(i||o===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(u||c)&&(l.pathname+="/"),l}const yl=t=>t.join("/").replace(/\/\/+/g,"/"),Sq=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),Cq=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,Nq=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function Tq(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const AM=["post","put","patch","delete"];new Set(AM);const Iq=["get",...AM];new Set(Iq);/**
* React Router v6.22.1
*
* Copyright (c) Remix Software Inc.
*
* This source code is licensed under the MIT license found in the
* LICENSE.md file in the root directory of this source tree.
*
* @license MIT
*/function nf(){return nf=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},nf.apply(this,arguments)}const Z1=R.createContext(null),PM=R.createContext(null),bl=R.createContext(null),J1=R.createContext(null),vl=R.createContext({outlet:null,matches:[],isDataRoute:!1}),LM=R.createContext(null);function Eq(t,e){let{relative:n}=e===void 0?{}:e;kd()||Pn(!1);let{basename:r,navigator:a}=R.useContext(bl),{hash:i,pathname:o,search:s}=Si(t,{relative:n}),l=o;return r!=="/"&&(l=o==="/"?r:yl([r,o])),a.createHref({pathname:l,search:s,hash:i})}function kd(){return R.useContext(J1)!=null}function Sd(){return kd()||Pn(!1),R.useContext(J1).location}function xl(t){kd()||Pn(!1);let{pathname:e}=Sd();return R.useMemo(()=>Q1(t,e),[e,t])}function DM(t){R.useContext(bl).static||R.useLayoutEffect(t)}function _q(){let{isDataRoute:t}=R.useContext(vl);return t?Uq():Oq()}function Oq(){kd()||Pn(!1);let t=R.useContext(Z1),{basename:e,future:n,navigator:r}=R.useContext(bl),{matches:a}=R.useContext(vl),{pathname:i}=Sd(),o=JSON.stringify(RM(a,n.v7_relativeSplatPath)),s=R.useRef(!1);return DM(()=>{s.current=!0}),R.useCallback(function(l,u){if(u===void 0&&(u={}),!s.current)return;if(typeof l=="number"){r.go(l);return}let c=MM(l,JSON.parse(o),i,u.relative==="path");t==null&&e!=="/"&&(c.pathname=c.pathname==="/"?e:yl([e,c.pathname])),(u.replace?r.replace:r.push)(c,u.state,u)},[e,r,o,i,t])}const $q=R.createContext(null);function Rq(t){let e=R.useContext(vl).outlet;return e&&R.createElement($q.Provider,{value:t},e)}function Si(t,e){let{relative:n}=e===void 0?{}:e,{future:r}=R.useContext(bl),{matches:a}=R.useContext(vl),{pathname:i}=Sd(),o=JSON.stringify(RM(a,r.v7_relativeSplatPath));return R.useMemo(()=>MM(t,JSON.parse(o),i,n==="path"),[t,o,i,n])}function Mq(t,e){return Aq(t,e)}function Aq(t,e,n,r){kd()||Pn(!1);let{navigator:a}=R.useContext(bl),{matches:i}=R.useContext(vl),o=i[i.length-1],s=o?o.params:{};o&&o.pathname;let l=o?o.pathnameBase:"/";o&&o.route;let u=Sd(),c;if(e){var d;let x=typeof e=="string"?xd(e):e;l==="/"||(d=x.pathname)!=null&&d.startsWith(l)||Pn(!1),c=x}else c=u;let p=c.pathname||"/",f=p;if(l!=="/"){let x=l.replace(/^\//,"").split("/");f="/"+p.replace(/^\//,"").split("/").slice(x.length).join("/")}let m=sq(t,{pathname:f}),y=Bq(m&&m.map(x=>Object.assign({},x,{params:Object.assign({},s,x.params),pathname:yl([l,a.encodeLocation?a.encodeLocation(x.pathname).pathname:x.pathname]),pathnameBase:x.pathnameBase==="/"?l:yl([l,a.encodeLocation?a.encodeLocation(x.pathnameBase).pathname:x.pathnameBase])})),i,n,r);return e&&y?R.createElement(J1.Provider,{value:{location:nf({pathname:"/",search:"",hash:"",state:null,key:"default"},c),navigationType:ml.Pop}},y):y}function Pq(){let t=Wq(),e=Tq(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,r={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return R.createElement(R.Fragment,null,R.createElement("h2",null,"Unexpected Application Error!"),R.createElement("h3",{style:{fontStyle:"italic"}},e),n?R.createElement("pre",{style:r},n):null,null)}const Lq=R.createElement(Pq,null);class Dq extends R.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?R.createElement(vl.Provider,{value:this.props.routeContext},R.createElement(LM.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Fq(t){let{routeContext:e,match:n,children:r}=t,a=R.useContext(Z1);return a&&a.static&&a.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=n.route.id),R.createElement(vl.Provider,{value:e},r)}function Bq(t,e,n,r){var a;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var i;if((i=n)!=null&&i.errors)t=n.matches;else return null}let o=t,s=(a=n)==null?void 0:a.errors;if(s!=null){let c=o.findIndex(d=>d.route.id&&s?.[d.route.id]);c>=0||Pn(!1),o=o.slice(0,Math.min(o.length,c+1))}let l=!1,u=-1;if(n&&r&&r.v7_partialHydration)for(let c=0;c<o.length;c++){let d=o[c];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(u=c),d.route.id){let{loaderData:p,errors:f}=n,m=d.route.loader&&p[d.route.id]===void 0&&(!f||f[d.route.id]===void 0);if(d.route.lazy||m){l=!0,u>=0?o=o.slice(0,u+1):o=[o[0]];break}}}return o.reduceRight((c,d,p)=>{let f,m=!1,y=null,x=null;n&&(f=s&&d.route.id?s[d.route.id]:void 0,y=d.route.errorElement||Lq,l&&(u<0&&p===0?(Gq("route-fallback",!1),m=!0,x=null):u===p&&(m=!0,x=d.route.hydrateFallbackElement||null)));let b=e.concat(o.slice(0,p+1)),v=()=>{let w;return f?w=y:m?w=x:d.route.Component?w=R.createElement(d.route.Component,null):d.route.element?w=d.route.element:w=c,R.createElement(Fq,{match:d,routeContext:{outlet:c,matches:b,isDataRoute:n!=null},children:w})};return n&&(d.route.ErrorBoundary||d.route.errorElement||p===0)?R.createElement(Dq,{location:n.location,revalidation:n.revalidation,component:y,error:f,children:v(),routeContext:{outlet:null,matches:b,isDataRoute:!0}}):v()},null)}var FM=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(FM||{}),ey=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(ey||{});function zq(t){let e=R.useContext(Z1);return e||Pn(!1),e}function jq(t){let e=R.useContext(PM);return e||Pn(!1),e}function Vq(t){let e=R.useContext(vl);return e||Pn(!1),e}function BM(t){let e=Vq(),n=e.matches[e.matches.length-1];return n.route.id||Pn(!1),n.route.id}function Wq(){var t;let e=R.useContext(LM),n=jq(ey.UseRouteError),r=BM(ey.UseRouteError);return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}function Uq(){let{router:t}=zq(FM.UseNavigateStable),e=BM(ey.UseNavigateStable),n=R.useRef(!1);return DM(()=>{n.current=!0}),R.useCallback(function(r,a){a===void 0&&(a={}),n.current&&(typeof r=="number"?t.navigate(r):t.navigate(r,nf({fromRouteId:e},a)))},[t,e])}const zM={};function Gq(t,e,n){!e&&!zM[t]&&(zM[t]=!0)}function Hq(t){return Rq(t.context)}function Cd(t){Pn(!1)}function qq(t){let{basename:e="/",children:n=null,location:r,navigationType:a=ml.Pop,navigator:i,static:o=!1,future:s}=t;kd()&&Pn(!1);let l=e.replace(/^\/*/,"/"),u=R.useMemo(()=>({basename:l,navigator:i,static:o,future:nf({v7_relativeSplatPath:!1},s)}),[l,s,i,o]);typeof r=="string"&&(r=xd(r));let{pathname:c="/",search:d="",hash:p="",state:f=null,key:m="default"}=r,y=R.useMemo(()=>{let x=wd(c,l);return x==null?null:{location:{pathname:x,search:d,hash:p,state:f,key:m},navigationType:a}},[l,c,d,p,f,m,a]);return y==null?null:R.createElement(bl.Provider,{value:u},R.createElement(J1.Provider,{children:n,value:y}))}function Kq(t){let{children:e,location:n}=t;return Mq(FC(e),n)}new Promise(()=>{});function FC(t,e){e===void 0&&(e=[]);let n=[];return R.Children.forEach(t,(r,a)=>{if(!R.isValidElement(r))return;let i=[...e,a];if(r.type===R.Fragment){n.push.apply(n,FC(r.props.children,i));return}r.type!==Cd&&Pn(!1),!r.props.index||!r.props.children||Pn(!1);let o={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=FC(r.props.children,i)),n.push(o)}),n}/**
* React Router DOM v6.22.1
*
* Copyright (c) Remix Software Inc.
*
* This source code is licensed under the MIT license found in the
* LICENSE.md file in the root directory of this source tree.
*
* @license MIT
*/function ty(){return ty=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},ty.apply(this,arguments)}function jM(t,e){if(t==null)return{};var n={},r=Object.keys(t),a,i;for(i=0;i<r.length;i++)a=r[i],!(e.indexOf(a)>=0)&&(n[a]=t[a]);return n}function Xq(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function Yq(t,e){return t.button===0&&(!e||e==="_self")&&!Xq(t)}const Qq=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","unstable_viewTransition"],Zq=["aria-current","caseSensitive","className","end","style","to","unstable_viewTransition","children"],Jq="6";try{window.__reactRouterVersion=Jq}catch{}const eK=R.createContext({isTransitioning:!1}),tK="startTransition",VM=T5[tK];function nK(t){let{basename:e,children:n,future:r,window:a}=t,i=R.useRef();i.current==null&&(i.current=aq({window:a,v5Compat:!0}));let o=i.current,[s,l]=R.useState({action:o.action,location:o.location}),{v7_startTransition:u}=r||{},c=R.useCallback(d=>{u&&VM?VM(()=>l(d)):l(d)},[l,u]);return R.useLayoutEffect(()=>o.listen(c),[o,c]),R.createElement(qq,{basename:e,children:n,location:s.location,navigationType:s.action,navigator:o,future:r})}const rK=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",aK=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ny=R.forwardRef(function(t,e){let{onClick:n,relative:r,reloadDocument:a,replace:i,state:o,target:s,to:l,preventScrollReset:u,unstable_viewTransition:c}=t,d=jM(t,Qq),{basename:p}=R.useContext(bl),f,m=!1;if(typeof l=="string"&&aK.test(l)&&(f=l,rK))try{let v=new URL(window.location.href),w=l.startsWith("//")?new URL(v.protocol+l):new URL(l),S=wd(w.pathname,p);w.origin===v.origin&&S!=null?l=S+w.search+w.hash:m=!0}catch{}let y=Eq(l,{relative:r}),x=oK(l,{replace:i,state:o,target:s,preventScrollReset:u,relative:r,unstable_viewTransition:c});function b(v){n&&n(v),v.defaultPrevented||x(v)}return R.createElement("a",ty({},d,{href:f||y,onClick:m||a?n:b,ref:e,target:s}))}),ry=R.forwardRef(function(t,e){let{"aria-current":n="page",caseSensitive:r=!1,className:a="",end:i=!1,style:o,to:s,unstable_viewTransition:l,children:u}=t,c=jM(t,Zq),d=Si(s,{relative:c.relative}),p=Sd(),f=R.useContext(PM),{navigator:m,basename:y}=R.useContext(bl),x=f!=null&&sK(d)&&l===!0,b=m.encodeLocation?m.encodeLocation(d).pathname:d.pathname,v=p.pathname,w=f&&f.navigation&&f.navigation.location?f.navigation.location.pathname:null;r||(v=v.toLowerCase(),w=w?w.toLowerCase():null,b=b.toLowerCase()),w&&y&&(w=wd(w,y)||w);const S=b!=="/"&&b.endsWith("/")?b.length-1:b.length;let C=v===b||!i&&v.startsWith(b)&&v.charAt(S)==="/",I=w!=null&&(w===b||!i&&w.startsWith(b)&&w.charAt(b.length)==="/"),_={isActive:C,isPending:I,isTransitioning:x},E=C?n:void 0,P;typeof a=="function"?P=a(_):P=[a,C?"active":null,I?"pending":null,x?"transitioning":null].filter(Boolean).join(" ");let A=typeof o=="function"?o(_):o;return R.createElement(ny,ty({},c,{"aria-current":E,className:P,ref:e,style:A,to:s,unstable_viewTransition:l}),typeof u=="function"?u(_):u)});var BC;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(BC||(BC={}));var WM;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(WM||(WM={}));function iK(t){let e=R.useContext(Z1);return e||Pn(!1),e}function oK(t,e){let{target:n,replace:r,state:a,preventScrollReset:i,relative:o,unstable_viewTransition:s}=e===void 0?{}:e,l=_q(),u=Sd(),c=Si(t,{relative:o});return R.useCallback(d=>{if(Yq(d,n)){d.preventDefault();let p=r!==void 0?r:Y1(u)===Y1(c);l(t,{replace:p,state:a,preventScrollReset:i,relative:o,unstable_viewTransition:s})}},[u,l,c,r,a,n,t,i,o,s])}function sK(t,e){e===void 0&&(e={});let n=R.useContext(eK);n==null&&Pn(!1);let{basename:r}=iK(BC.useViewTransitionState),a=Si(t,{relative:e.relative});if(!n.isTransitioning)return!1;let i=wd(n.currentLocation.pathname,r)||n.currentLocation.pathname,o=wd(n.nextLocation.pathname,r)||n.nextLocation.pathname;return Q1(a.pathname,o)!=null||Q1(a.pathname,i)!=null}const rf=G.createContext({theme:"material",dark:!0,touchRipple:!0});function lK(t,e){return typeof window>"u"?R.useEffect(t,e):R.useLayoutEffect(t,e)}const UM=function(t,e){e===void 0&&(e=!0);const[n,r]=R.useState(t);return lK(()=>{if(e){if(t==="ios"||t==="material")n!==t&&r(t);else if(n==="parent"&&typeof window<"u"&&typeof document<"u"){const a=document.documentElement;a&&(a.classList.contains("ios")?r("ios"):(a.classList.contains("md")||a.classList.contains("material"))&&r("material"))}}},[t]),e?n:t},uK=t=>{const{theme:e,dark:n,touchRipple:r=!0,autoThemeDetection:a=!0,children:i}=t,o=UM(e,a);return G.createElement(rf.Provider,{value:{theme:o,dark:n,touchRipple:r}},i)};function M(){const t=[];for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];n.forEach(i=>{typeof i=="object"&&i.constructor===Object?Object.keys(i).forEach(o=>{i[o]&&t.push(o)}):Array.isArray(i)?t.push(...i):typeof i=="function"?t.push(i()):i&&i.value?t.push(i.value):i&&t.push(i)});const a=[];return t.forEach(i=>{a.indexOf(i)<0&&a.push(i)}),a.filter(i=>!!i).join(" ")}const Ln=function(t,e){return e===void 0&&(e=""),!e||typeof e!="string"?t:["static","relative","absolute","fixed","sticky"].filter(n=>e.indexOf(n)>=0).length>0?"":t},cK=(t,e,n)=>{const{safeAreas:r}=t;return M(e==="ios"&&"k-ios",e==="material"&&"k-material","k-app w-full h-full min-h-screen",r&&"safe-areas",Ln("relative",n),n)};function zC(){return zC=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},zC.apply(this,arguments)}const GM=R.forwardRef((t,e)=>{const{component:n="div",className:r,theme:a="material",dark:i=!0,touchRipple:o=!0,safeAreas:s=!0,children:l,...u}=t,c=R.useRef(null);R.useImperativeHandle(e,()=>({el:c.current}));const d=n,p={...u},f=UM(a),m=cK({...t,safeAreas:s},f,r);return G.createElement(uK,{theme:f,dark:i,touchRipple:o,autoThemeDetection:!1},G.createElement(d,zC({ref:c,className:m},p),l))});GM.displayName="App";const jC=(t,e,n)=>{if(typeof t=="string")return t;const r=[t.common,t[e]];return n&&t[n]&&(typeof t[n]=="string"?r.push(t[n]):r.push(t[n].common,t[n][e])),r},dK=(t,e,n)=>{const r={},a=["common","ios","material"];return Object.keys(t).forEach(i=>{const o=i==="base"?n:"";if(!(typeof t[i]!="string"&&Object.keys(t[i]).filter(l=>!a.includes(l)).length>0)){r[i]=M(jC(t[i],e),o);return}r[i]={};const s=jC(t[i],e);r[i].default=M(s,o),Object.keys(t[i]).filter(l=>!a.includes(l)).forEach(l=>{r[i][l]=M(s,jC(t[i],e,l),o)})}),r},Je=function(t){let{ios:e,material:n}=t===void 0?{}:t,r=R.useContext(rf).theme||"ios";return e&&(r="ios"),n&&(r="material"),(a,i)=>dK(a,r,i)},pK=(t,e)=>({base:{common:M("transition-transform z-40 left-1/2 bottom-0 transform -translate-x-1/2 max-w-md w-full overflow-hidden",Ln("fixed",e)),ios:"pt-2 px-2 pb-2-safe duration-300",material:"pb-safe last-child-hairline-b-none rounded-t-2xl duration-400 ease-material-in",opened:"",closed:"translate-y-full"},backdrop:{common:"fixed z-40 w-full h-full left-0 top-0 bg-black bg-opacity-50 duration-300",opened:"",closed:"opacity-0 pointer-events-none"}});function VC(){return VC=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},VC.apply(this,arguments)}const hK=R.forwardRef((t,e)=>{const{component:n="div",className:r,ios:a,material:i,opened:o,backdrop:s=!0,onBackdropClick:l,children:u,...c}=t,d=R.useRef(null);R.useImperativeHandle(e,()=>({el:d.current}));const p=o?"opened":"closed",f=n,m={...c},y=Je({ios:a,material:i})(pK(t,r),r);return G.createElement(G.Fragment,null,s&&G.createElement("div",{className:y.backdrop[p],onClick:l}),G.createElement(f,VC({ref:d,className:y.base[p]},m),u))});hK.displayName="Actions";const fK=t=>{const{dividers:e}=t;return{base:{common:"relative",ios:"mt-2 first:mt-0 last-child-hairline-b-none",material:M(e&&"hairline-b")}}};function WC(){return WC=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},WC.apply(this,arguments)}const gK=R.forwardRef((t,e)=>{const{component:n="div",className:r,ios:a,material:i,dividers:o=!0,children:s,...l}=t,u=R.useRef(null);R.useImperativeHandle(e,()=>({el:u.current}));const c=n,d={...l},p=Je({ios:a,material:i})(fK({dividers:o,...t}),r);return G.createElement(c,WC({ref:u,className:p.base},d),s)});gK.displayName="ActionsGroup";const Jt=function(t){let{ios:e,material:n}=t===void 0?{}:t,r=R.useContext(rf).theme||"ios";return e&&(r="ios"),n&&(r="material"),r};class mK{constructor(e,n,r){const a=this;if(!e)return;a.el=e;const{left:i,top:o,width:s,height:l}=e.getBoundingClientRect(),u={x:n-i,y:r-o};let c=Math.max((l**2+s**2)**.5,48);const d=e.classList.contains("k-touch-ripple-inset");d&&(c=Math.max(Math.min(s,l),48));const p=typeof window<"u"&&window.getComputedStyle(e,null).getPropertyValue("overflow")==="hidden";if(!d&&p){const m=((u.x-s/2)**2+(u.y-l/2)**2)**.5,y=(c/2+m)/(c/2);a.rippleTransform=`translate3d(0px, 0px, 0) scale(${y})`}else a.rippleTransform=`translate3d(${-u.x+s/2}px, ${-u.y+l/2}px, 0) scale(1)`;a.rippleWaveEl=document.createElement("span"),a.rippleWaveEl.classList.add("k-touch-ripple-wave"),a.rippleWaveEl.setAttribute("hidden",""),a.rippleWaveEl.style=`
      width: ${c}px;
      height: ${c}px;
      margin-top:-${c/2}px;
      margin-left:-${c/2}px;
      left:${u.x}px;
      top:${u.y}px; --k-ripple-transform: ${a.rippleTransform}`,e.insertAdjacentElement("afterbegin",a.rippleWaveEl);const f=()=>{a.rippleWaveEl.removeEventListener("animationend",f),a.rippleWaveEl&&(a.rippleWaveEl.classList.contains("k-touch-ripple-wave-out")||(a.rippleWaveEl.classList.add("k-touch-ripple-wave-in"),a.shouldBeRemoved&&a.out()))};return a.rippleWaveEl.addEventListener("animationend",f),a}destroy(){let e=this;e.rippleWaveEl&&e.el.removeChild(e.rippleWaveEl),Object.keys(e).forEach(n=>{e[n]=null,delete e[n]}),e=null}out(){const e=this,{rippleWaveEl:n}=this;clearTimeout(e.removeTimeout),n.classList.add("k-touch-ripple-wave-out"),e.removeTimeout=setTimeout(()=>{e.destroy()},300);const r=()=>{e.rippleWaveEl.removeEventListener("animationend",r),clearTimeout(e.removeTimeout),e.destroy()};e.rippleWaveEl.addEventListener("animationend",r)}remove(){const e=this;e.shouldBeRemoved||(e.removeTimeout=setTimeout(()=>{e.destroy()},400),e.shouldBeRemoved=!0,e.rippleWaveEl.classList.contains("k-touch-ripple-wave-in")&&e.out())}}const eo=(t,e,n)=>{const r=R.useContext(rf);n||(n=t);const a=R.useRef(null),i=()=>{a.current&&a.current.remove(),a.current=null},o=f=>{a.current=new mK(t.current,f.pageX,f.pageY)},s=()=>{i()},l=()=>{i()},u=()=>{if(!r.touchRipple)return;const f=n.current;f.addEventListener("pointerdown",o),f.addEventListener("pointermove",s),f.addEventListener("pointerup",l),f.addEventListener("pointercancel",l),f.addEventListener("contextmenu",l)},c=()=>{const f=n.current;f.removeEventListener("pointerdown",o),f.removeEventListener("pointermove",s),f.removeEventListener("pointerup",l),f.removeEventListener("pointercancel",l),f.removeEventListener("contextmenu",l)},d=()=>{!n||!n.current||!e||u()},p=()=>{!n||!n.current||!e||c()};R.useEffect(()=>(d(),()=>p()))},mt=()=>{const t=R.useContext(rf);return e=>t.dark?e:""},yK=(t,e,n)=>{const{fontSizeIos:r,fontSizeMaterial:a,bold:i,dividers:o}=t;return{base:{common:M("flex items-center w-full px-4 relative z-10 overflow-hidden",o&&"hairline-b"),ios:M("h-14",e.textIos,e.bgIos,e.activeBgIos,r,"first:rounded-t-xl last:rounded-b-xl justify-center",i&&"font-semibold"),material:M("h-12",e.textMaterial,e.bgMaterial,e.activeBgMaterial,a,"justify-start",n("dark:touch-ripple-white"),i&&"font-medium")}}},bK=function(t,e){return t===void 0&&(t={}),{bgIos:M("bg-white",e("dark:bg-neutral-800")),bgMaterial:M("bg-md-light-surface-3",e("dark:bg-md-dark-surface-3")),activeBgIos:M("active:bg-neutral-200",e("dark:active:bg-neutral-700")),activeBgMaterial:"",textIos:"text-primary",textMaterial:M("text-md-light-on-surface",e("dark:text-md-dark-on-surface")),...t}};function UC(){return UC=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},UC.apply(this,arguments)}const vK=R.forwardRef((t,e)=>{const{component:n="button",className:r,colors:a,ios:i,material:o,bold:s,boldIos:l=!1,boldMaterial:u=!1,fontSizeIos:c="text-xl",fontSizeMaterial:d="text-base",href:p,touchRipple:f=!0,dividers:m=void 0,children:y,...x}=t,b=R.useRef(null);R.useImperativeHandle(e,()=>({el:b.current}));let v=n;typeof t.component>"u"&&(p||p==="")&&(v="a");const w={href:p,...x},S=Jt({ios:i,material:o}),C=Je({ios:i,material:o}),I=mt();eo(b,S==="material"&&f);const _=bK(a,I),E=C(yK({fontSizeIos:c,fontSizeMaterial:d,bold:typeof s>"u"?S==="ios"?l:u:s,dividers:typeof m>"u"?S==="ios":m,...t},_,I),r);return G.createElement(v,UC({ref:b,role:"button",tabIndex:"0",className:E.base},w),y)});vK.displayName="ActionsButton";const xK=(t,e)=>{const{fontSizeIos:n,fontSizeMaterial:r,dividers:a}=t;return{base:{common:M(`flex items-center w-full px-4 relative z-10 overflow-hidden ${e.activeBg}`,a&&"hairline-b"),ios:M("h-14",e.bgIos,e.textIos,n,"first:rounded-t-xl last:rounded-b-xl justify-center"),material:M("h-12",e.bgMaterial,e.textMaterial,r,"font-medium","justify-start")}}},wK=function(t,e){return t===void 0&&(t={}),{bgIos:M("bg-white",e("dark:bg-neutral-800")),bgMaterial:M("bg-md-light-surface-3",e("dark:bg-md-dark-surface-3")),textIos:M("text-black text-opacity-55",e("dark:text-white dark:text-opacity-55")),textMaterial:M("text-md-light-primary",e("dark:text-md-dark-primary")),...t}};function GC(){return GC=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},GC.apply(this,arguments)}const kK=R.forwardRef((t,e)=>{const{component:n="div",className:r,colors:a,ios:i,material:o,fontSizeIos:s="text-sm",fontSizeMaterial:l="text-sm",dividers:u=void 0,children:c,...d}=t,p=R.useRef(null);R.useImperativeHandle(e,()=>({el:p.current}));const f=n,m={...d},y=Jt({ios:i,material:o}),x=Je({ios:i,material:o}),b=mt(),v=wK(a,b),w=x(xK({fontSizeIos:s,fontSizeMaterial:l,dividers:typeof u>"u"?y==="ios":u,...t},v),r);return G.createElement(f,GC({ref:p,className:w.base},m),c)});kK.displayName="ActionsLabel";const SK=(t,e)=>({base:{common:`${e.text} ${e.bg} inline-flex items-center justify-center rounded-full leading-none`,ios:"font-semibold",material:"font-medium",sm:"text-2xs min-w-4 min-h-4 px-0.5",md:"text-xs min-w-5 min-h-5 px-1.5 py-0.5"}}),CK=function(t){return t===void 0&&(t={}),{bg:"bg-primary",text:"text-white",...t}};function HC(){return HC=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},HC.apply(this,arguments)}const HM=R.forwardRef((t,e)=>{const{component:n="span",className:r,colors:a,small:i,ios:o,material:s,children:l,...u}=t,c=R.useRef(null);R.useImperativeHandle(e,()=>({el:c.current}));const d=n,p={...u},f=Je({ios:o,material:s}),m=CK(a),y=i?"sm":"md",x=f(SK(t,m),r);return G.createElement(d,HC({ref:c,className:x.base[y]},p),l)});HM.displayName="Badge";const NK=(t,e,n)=>{const{inset:r,nested:a,margin:i,padding:o,strong:s,outline:l}=t;return{base:{common:M("text-sm z-10",Ln("relative",n),!r&&!a&&l&&"hairline-t hairline-b",r&&l&&"border",r&&"px-4",!r&&"pl-4-safe pr-4-safe",!a&&i,(s||l)&&o),ios:M(e.textIos,s&&e.strongBgIos,r&&l&&e.outlineIos),material:M(e.textMaterial,s&&e.strongBgMaterial,r&&l&&e.outlineMaterial)},inset:{common:"ml-4-safe mr-4-safe overflow-hidden",ios:"rounded-lg",material:"rounded-2xl"}}},TK=function(t,e){return t===void 0&&(t={}),{outlineIos:M("border-black border-opacity-20",e("dark:border-white dark:border-opacity-15")),outlineMaterial:M("border-md-light-outline",e("border-md-dark-outline")),strongBgIos:M("bg-ios-light-surface-1",e("dark:bg-ios-dark-surface-1")),strongBgMaterial:M("bg-md-light-surface-1",e("dark:bg-md-dark-surface-1")),textIos:"",textMaterial:M("text-md-light-on-surface",e("dark:text-md-dark-on-surface")),...t}};function qC(){return qC=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},qC.apply(this,arguments)}const to=R.forwardRef((t,e)=>{const{component:n="div",className:r,colors:a,margin:i="my-8",padding:o="py-4",inset:s,insetIos:l,insetMaterial:u,strong:c,strongIos:d,strongMaterial:p,outline:f,outlineIos:m,outlineMaterial:y,nested:x,ios:b,material:v,children:w,...S}=t,C=R.useRef(null);R.useImperativeHandle(e,()=>({el:C.current}));const I=n,_={...S},E=Jt({ios:b,material:v}),P=Je({ios:b,material:v}),A=mt(),D=TK(a,A),V=typeof c>"u"?E==="ios"?d:p:c,z=typeof f>"u"?E==="ios"?m:y:f,K=typeof s>"u"?E==="ios"?l:u:s,X=P(NK({...t,margin:i,padding:o,inset:K,strong:V,outline:z},D,r)),Z=M(X.base,K&&X.inset,r);return G.createElement(I,qC({ref:C,className:Z},_),w)});to.displayName="Block";const IK=(t,e)=>{const{inset:n}=t;return{base:{common:M("mb-8 flex items-center -mt-6 text-sm",n?"pl-8-safe pr-8-safe":"pl-4-safe pr-4-safe"),ios:e.textIos,material:e.textMaterial}}},EK=function(t,e){return t===void 0&&(t={}),{textIos:M("text-black text-opacity-75",e("dark:text-white dark:text-opacity-75")),textMaterial:M("text-md-light-on-surface-variant",e("dark:text-md-dark-on-surface-variant")),...t}};function KC(){return KC=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},KC.apply(this,arguments)}const _K=R.forwardRef((t,e)=>{const{component:n="div",className:r,colors:a,ios:i,material:o,inset:s,insetIos:l,insetMaterial:u,children:c,...d}=t,p=R.useRef(null);R.useImperativeHandle(e,()=>({el:p.current}));const f=Jt(),m=typeof s>"u"?f==="ios"?l:u:s,y=n,x={...d},b=Je({ios:i,material:o}),v=mt(),w=EK(a,v),S=b(IK({...t,inset:m},w),r);return G.createElement(y,KC({ref:p,className:S.base},x),c)});_K.displayName="BlockFooter";const OK=(t,e)=>{const{inset:n}=t;return{base:{common:M("mt-8 flex items-center -mb-6 text-sm",n?"pl-8-safe pr-8-safe":"pl-4-safe pr-4-safe"),ios:e.textIos,material:e.textMaterial}}},$K=function(t,e){return t===void 0&&(t={}),{textIos:M("text-black",e("dark:text-white")),textMaterial:M("text-md-light-on-surface-variant",e("dark:text-md-dark-on-surface-variant")),...t}};function XC(){return XC=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},XC.apply(this,arguments)}const RK=R.forwardRef((t,e)=>{const{component:n="div",className:r,colors:a,ios:i,material:o,inset:s,insetIos:l,insetMaterial:u,children:c,...d}=t,p=R.useRef(null);R.useImperativeHandle(e,()=>({el:p.current}));const f=n,m={...d},y=Jt(),x=typeof s>"u"?y==="ios"?l:u:s,b=Je({ios:i,material:o}),v=mt(),w=$K(a,v),S=b(OK({...t,inset:x},w),r);return G.createElement(f,XC({ref:p,className:S.base},m),c)});RK.displayName="BlockHeader";const MK=(t,e)=>{const{withBlock:n,medium:r,large:a}=t;return{base:{common:`pl-4-safe pr-4-safe mt-8 flex justify-between items-center ${n?"-mb-6":"mb-2"}`,ios:M(`font-semibold ${e.textIos}`,a&&"text-[1.5rem]",r&&"text-[1.125rem]",!r&&!a&&"text-[1rem]"),material:M(`font-medium ${e.textMaterial}`,a&&"text-[1.375rem]",r&&"text-[1rem]",!r&&!a&&"text-[0.875rem]")}}},AK=function(t,e){return t===void 0&&(t={}),{textIos:"",textMaterial:M("text-md-light-primary",e("dark:text-md-dark-primary")),...t}};function YC(){return YC=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},YC.apply(this,arguments)}const PK=R.forwardRef((t,e)=>{const{component:n="div",className:r,colors:a,withBlock:i=!0,medium:o,large:s,ios:l,material:u,children:c,...d}=t,p=R.useRef(null);R.useImperativeHandle(e,()=>({el:p.current}));const f=n,m={...d},y=Je({ios:l,material:u}),x=mt(),b=AK(a,x),v=y(MK({...t,withBlock:i},b),r);return G.createElement(f,YC({ref:p,className:v.base},m),c)});PK.displayName="BlockTitle";const LK=t=>{const{fontSizeIos:e,fontSizeMaterial:n}=t;return{base:{common:"flex items-center justify-start overflow-auto whitespace-nowrap py-1 px-0 space-x-3 no-scrollbar rtl:space-x-reverse",ios:e,material:n}}};function QC(){return QC=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},QC.apply(this,arguments)}const DK=R.forwardRef((t,e)=>{const{component:n="div",className:r,fontSizeIos:a="text-[17px]",fontSizeMaterial:i="text-[14px]",ios:o,material:s,children:l,...u}=t,c=R.useRef(null);R.useImperativeHandle(e,()=>({el:c.current}));const d=n,p={...u},f=Je({ios:o,material:s})(LK({...t,fontSizeIos:a,fontSizeMaterial:i}),r);return G.createElement(d,QC({ref:c,className:f.base},p),l)});DK.displayName="Breadcrumbs";const FK=(t,e)=>{const{active:n}=t;return{base:{common:M("flex items-center overflow-hidden"),ios:M(e.textIos,e.bgIos,n?e.textActiveIos:e.textIos,n&&"font-semibold"),material:M("font-medium px-2 py-1 rounded-lg",e.bgMaterial,n?e.textActiveMaterial:e.textMaterial)}}},BK=function(t,e){return t===void 0&&(t={}),{textIos:M("text-black text-opacity-55",e("dark:text-white dark:text-opacity-55")),textMaterial:M("text-md-light-on-secondary-container",e("dark:text-md-dark-on-secondary-container")),bgIos:"",bgMaterial:M("bg-md-light-secondary-container",e("dark:bg-md-dark-secondary-container")),textActiveIos:M("text-black",e("dark:text-white")),textActiveMaterial:M("text-md-light-on-secondary-container",e("dark:text-md-dark-on-secondary-container")),...t}};function ZC(){return ZC=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},ZC.apply(this,arguments)}const zK=R.forwardRef((t,e)=>{const{component:n="div",className:r,ios:a,material:i,colors:o,active:s,children:l,...u}=t,c=R.useRef(null);R.useImperativeHandle(e,()=>({el:c.current}));const d=n,p={...u},f=Je({ios:a,material:i}),m=mt(),y=BK(o,m),x=f(FK({...t},y),r);return G.createElement(d,ZC({ref:c,className:x.base,role:"menuitem",tabIndex:"0"},p),l)});zK.displayName="BreadcrumbsItem";const jK=()=>({base:{common:"w-3 opacity-35 flex justify-center",ios:"",material:""},icon:{common:"rtl:rotate-180",ios:"h-3",material:"h-2.5"}});function JC(){return JC=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},JC.apply(this,arguments)}const qM=t=>G.createElement("svg",JC({xmlns:"http://www.w3.org/2000/svg",width:"8",height:"14",viewBox:"0 0 12 20",fill:"currentcolor"},t),G.createElement("path",{d:"M11.518406,10.5648622 C11.4831857,10.6163453 11.4426714,10.6653692 11.3968592,10.7111814 L2.5584348,19.5496058 C1.9753444,20.1326962 1.03186648,20.1345946 0.44199608,19.5447242 C-0.14379032,18.9589377 -0.14922592,18.0146258 0.43711448,17.4282854 L7.87507783,9.9903221 L0.4431923,2.5584366 C-0.1398981,1.9753462 -0.1417965,1.0318683 0.448074,0.4419979 C1.0338604,-0.1437886 1.9781723,-0.1492241 2.56451268,0.4371163 L11.4029371,9.2755407 C11.7556117,9.6282153 11.7969345,10.1725307 11.518406,10.5648622 Z"}));function eN(){return eN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},eN.apply(this,arguments)}const VK=R.forwardRef((t,e)=>{const{component:n="div",className:r,ios:a,material:i,children:o,...s}=t,l=R.useRef(null);R.useImperativeHandle(e,()=>({el:l.current}));const u=n,c={...s},d=Je({ios:a,material:i})(jK({...t}),r);return G.createElement(u,eN({ref:l,className:d.base},c),G.createElement(qM,{className:d.icon}),o)});VK.displayName="BreadcrumbsSeparator";const WK=(t,e)=>({base:{common:`flex items-center cursor-pointer space-x-0.75 rtl:space-x-reverse ${e.bg}`,ios:M("rounded active:opacity-30 px-1.5 h-[1em] duration-300 active:duration-0",e.bgIos),material:M("py-3 px-2 rounded-lg",e.bgMaterial)},dot:{common:`w-1 h-1 rounded-full ${e.dotBg}`,ios:e.dotBgIos,material:e.dotBgMaterial}}),UK=function(t,e){return t===void 0&&(t={}),{bgIos:M("bg-black bg-opacity-15",e("dark:bg-white dark:bg-opacity-15")),bgMaterial:M("bg-md-light-secondary-container",e("dark:bg-md-dark-secondary-container")),dotBgIos:M("bg-black",e("dark:bg-white")),dotBgMaterial:M("bg-md-light-primary",e("dark:bg-md-dark-primary")),...t}};function tN(){return tN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},tN.apply(this,arguments)}const GK=R.forwardRef((t,e)=>{const{component:n="div",className:r,colors:a,ios:i,material:o,children:s,...l}=t,u=R.useRef(null);R.useImperativeHandle(e,()=>({el:u.current}));const c=mt(),d=UK(a,c),p=n,f={...l},m=Je({ios:i,material:o})(WK({...t},d),r);return G.createElement(p,tN({ref:u,role:"button",tabIndex:"0",className:m.base},f),G.createElement("span",{className:m.dot}),G.createElement("span",{className:m.dot}),G.createElement("span",{className:m.dot}),s)});GK.displayName="BreadcrumbsCollapsed";const HK=(t,e,n,r)=>{const{inline:a,segmented:i,segmentedStrong:o,segmentedActive:s,disabled:l}=t;return{base:{common:M("flex text-center justify-center items-center appearance-none py-1 transition-colors focus:outline-none cursor-pointer select-none overflow-hidden z-10",a?"inline-flex":"w-full flex",Ln("relative",n),l&&"pointer-events-none",o&&s&&"k-segmented-strong-button-active"),ios:"uppercase duration-100 font-semibold px-2",material:"duration-300 font-medium px-4",square:{ios:i&&!o?"first:rounded-s last:rounded-e":"rounded",material:i&&!o?"first:rounded-lg-s last:rounded-lg-e":"rounded-lg"},rounded:i&&!o?"":"rounded-full"},style:{fill:{common:M(l&&M(e.disabledBg,e.disabledText)),ios:M(l?M(e.disabledBg,e.disabledText):`${e.fillTextIos} ${e.fillBgIos} ${e.fillActiveBgIos}`),material:M(l?M(e.disabledBg,e.disabledText):M(e.fillTextMaterial,e.fillBgMaterial,e.fillActiveBgMaterial,e.fillTouchRipple))},outline:{common:M(l?M(e.disabledText,e.disabledBorder):M("active:bg-opacity-15",e.touchRipple)),ios:M(!i&&"border-2",!l&&!i&&e.outlineBorderIos,!l&&M(e.textIos,e.activeBgIos)),material:M(!i&&"border",!l&&!i&&e.outlineBorderMaterial,!l&&M(e.textMaterial,e.activeBgMaterial))},clear:{common:M(l?e.disabledText:`active:bg-opacity-15 ${e.touchRipple}`),ios:!l&&M(e.textIos,e.activeBgIos),material:!l&&M(e.textMaterial,e.activeBgMaterial)},tonal:{common:l?M(e.disabledBg,e.disabledText):M(e.touchRipple),ios:!l&&M(e.tonalTextIos,e.tonalBgIos,e.activeBgIos,"bg-opacity-15 active:bg-opacity-25"),material:!l&&M(e.tonalTextMaterial,e.tonalBgMaterial,e.activeBgMaterial)},segmentedStrong:M("active:bg-black active:bg-opacity-10",r("dark:active:bg-white dark:active:bg-opacity-5 dark:touch-ripple-white")),segmentedStrongActive:"duration-0"},size:{small:{ios:"text-xs h-7",material:"text-sm h-8"},medium:{common:"text-sm",ios:"h-7",material:"h-10"},large:{ios:"h-11",material:"h-12"}},raised:"shadow active:shadow-lg"}},qK=function(t,e){return t===void 0&&(t={}),{activeBgIos:"active:bg-primary",activeBgMaterial:"",textIos:"text-primary",textMaterial:M("text-md-light-primary","dark:text-md-dark-primary"),fillTextIos:M("text-white"),fillTextMaterial:M("text-md-light-on-primary",e("dark:text-md-dark-on-primary")),fillActiveBgIos:"active:bg-ios-primary-shade",fillActiveBgMaterial:"",fillBgIos:"bg-primary",fillBgMaterial:M("bg-md-light-primary",e("dark:bg-md-dark-primary")),fillTouchRipple:M("touch-ripple-white","dark:touch-ripple-primary"),outlineBorderIos:"border-primary",outlineBorderMaterial:M("border-md-light-outline",e("dark:border-md-dark-outline")),tonalBgIos:"bg-primary",tonalBgMaterial:M("bg-md-light-secondary-container",e("dark:bg-md-dark-secondary-container")),tonalTextIos:"text-primary",tonalTextMaterial:M("text-md-light-on-secondary-container",e("dark:text-md-dark-on-secondary-container")),touchRipple:"touch-ripple-primary",disabledText:M("text-black text-opacity-30",e("dark:text-white dark:text-opacity-30")),disabledBg:M("bg-black bg-opacity-10",e("dark:bg-white dark:bg-opacity-10")),disabledBorder:M("border-black border-opacity-10",e("dark:border-white dark:border-opacity-10")),...t}};function nN(){return nN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},nN.apply(this,arguments)}const jn=R.forwardRef((t,e)=>{const{component:n="button",className:r,colors:a,ios:i,material:o,disabled:s,href:l,outline:u,outlineIos:c,outlineMaterial:d,clear:p,clearIos:f,clearMaterial:m,tonal:y,tonalIos:x,tonalMaterial:b,rounded:v,roundedIos:w,roundedMaterial:S,small:C,smallIos:I,smallMaterial:_,large:E,largeIos:P,largeMaterial:A,raised:D,raisedIos:V,raisedMaterial:z,inline:K,segmented:X,segmentedStrong:Z,segmentedActive:q,touchRipple:F=!0,children:Y,...Q}=t,ne=R.useRef(null);R.useImperativeHandle(e,()=>({el:ne.current}));let le=n;typeof t.component>"u"&&(l||l==="")&&(le="a");const de={href:l,...Q},re=Jt({ios:i,material:o}),he=Je({ios:i,material:o}),ve=mt();eo(ne,re==="material"&&F);const H=(Le=>{const He={};return Object.keys(Le).forEach(Me=>{He[Me]=typeof Le[Me]>"u"?re==="ios"?t[`${Me}Ios`]:t[`${Me}Material`]:Le[Me]}),He})({outline:u,clear:p,tonal:y,rounded:v,small:C,large:E,raised:D}),ie=H.large?"large":H.small?"small":"medium";let pe=H.outline?"outline":H.clear||X&&!q?"clear":H.tonal?"tonal":"fill";Z&&(pe="segmentedStrong"),Z&&q&&(pe="segmentedStrongActive");const ke=qK(a,ve),Ne=he(HK({...t,...H},ke,r,ve)),Ie=M(Ne.base[H.rounded?"rounded":"square"],Ne.style[pe],Ne.size[ie],H.raised&&Ne.raised,r);return G.createElement(le,nN({ref:ne,className:Ie,disabled:s,role:"button",tabIndex:"0"},de),Y)});jn.displayName="Button";const KK=(t,e)=>{const{margin:n,headerDivider:r,footerDivider:a,contentWrapPadding:i}=t;return{base:{common:M(n,"overflow-hidden"),ios:M("rounded-lg",e.bgIos,e.textIos),material:M("rounded-2xl",e.bgMaterial,e.textMaterial),plain:"",raised:"shadow",outline:{common:M("border"),ios:e.outlineIos,material:e.outlineMaterial}},header:{common:M(r&&"border-b","p-4"),ios:M(r&&e.outlineIos,t.headerFontSizeIos),material:M(r&&e.outlineMaterial,t.headerFontSizeMaterial)},content:M(i,"text-sm"),footer:{common:M(r&&"border-t","text-sm p-4"),ios:M(e.footerTextIos,a&&e.outlineIos),material:M(e.footerTextMaterial,a&&e.outlineMaterial)}}},XK=function(t,e){return t===void 0&&(t={}),{textIos:M(""),textMaterial:M("text-md-light-on-surface",e("dark:text-md-dark-on-surface")),bgIos:M("bg-ios-light-surface-1",e("dark:bg-ios-dark-surface-1")),bgMaterial:M("bg-md-light-surface-1",e("dark:bg-md-dark-surface-1")),footerTextIos:M("text-black text-opacity-55",e("dark:text-white dark:text-opacity-55")),footerTextMaterial:M("text-md-light-on-surface-variant",e("dark:text-md-dark-on-surface-variant")),outlineIos:M("border-black border-opacity-20",e("dark:border-white dark:border-opacity-20")),outlineMaterial:M("border-md-light-outline",e("dark:border-md-dark-outline")),...t}};function rN(){return rN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},rN.apply(this,arguments)}const KM=R.forwardRef((t,e)=>{const{component:n="div",className:r,margin:a="m-4",colors:i,header:o,footer:s,ios:l,material:u,headerFontSizeIos:c="text-[17px]",headerFontSizeMaterial:d="text-[22px]",contentWrap:p=!0,contentWrapPadding:f="p-4",raised:m,raisedIos:y,raisedMaterial:x,outline:b,outlineIos:v,outlineMaterial:w,headerDivider:S=!1,footerDivider:C=!1,children:I,..._}=t,E=R.useRef(null);R.useImperativeHandle(e,()=>({el:E.current}));const P=n,A={..._},D=Jt(),V=Je({ios:l,material:u}),z=mt(),K=XK(i,z),X=typeof b>"u"?D==="ios"?v:w:b,Z=typeof m>"u"?D==="ios"?y:x:m,q=X?"outline":Z?"raised":"plain",F=V(KK({...t,margin:a,contentWrapPadding:f,headerDivider:S,footerDivider:C,headerFontSizeIos:c,headerFontSizeMaterial:d,outline:X,raised:Z},K),r);return G.createElement(P,rN({ref:E,className:F.base[q]},A),o&&G.createElement("div",{className:F.header},o),p?G.createElement("div",{className:F.content},I):I,s&&G.createElement("div",{className:F.footer},s))});KM.displayName="Card";const YK=(t,e,n,r)=>({base:M("cursor-pointer inline-flex align-middle",Ln("relative",n),r("dark:touch-ripple-white")),iconWrap:{common:M("flex items-center justify-center text-white",r("dark:text-black")),ios:"w-5.5 h-5.5 rounded-full border",material:"w-4.5 h-4.5 rounded-sm border-2",notChecked:{ios:e.borderIos,material:e.borderMaterial},checked:{ios:`${e.bgCheckedIos} ${e.borderCheckedIos}`,material:`${e.bgCheckedMaterial} ${e.borderCheckedMaterial}`}},icon:{notChecked:"opacity-0",checked:"opacity-100"},indeterminateIcon:{common:M("bg-white w-3/4",r("dark:bg-black")),ios:"h-0.5 rounded-full",material:"h-0.5"},input:"hidden"}),QK=function(t,e){return t===void 0&&(t={}),{borderIos:M("border-black border-opacity-30",e("dark:border-white dark:border-opacity-30")),borderMaterial:M("border-md-light-outline",e("dark:border-md-dark-outline")),bgCheckedIos:"bg-primary",bgCheckedMaterial:M("bg-md-light-primary",e("dark:bg-md-dark-primary")),borderCheckedIos:"border-primary",borderCheckedMaterial:M("border-md-light-primary",e("dark:border-md-dark-primary")),...t}};function ay(){return ay=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},ay.apply(this,arguments)}const XM=t=>{const{ios:e,material:n,fill:r,...a}=t;return Jt({ios:e,material:n})==="ios"?G.createElement("svg",ay({xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20",fill:"currentcolor"},a),G.createElement("path",{fill:r||"currentColor",fillRule:"evenodd",d:"M10.6461792,0.119820016 C11.0022676,0.346673312 11.1070333,0.819240884 10.88018,1.17532923 L5.59004012,9.47918548 C5.44456028,9.70754308 5.19802823,9.83254199 4.94596825,9.83309245 C4.59813173,9.83364386 4.39457446,9.67360825 4.28105047,9.53831563 L1.17887189,5.84128316 C0.907480501,5.5178515 0.949667479,5.03565214 1.27309914,4.76426075 C1.59653081,4.49286936 2.07873017,4.53505633 2.35012156,4.858488 L4.8346263,7.81909046 L9.59067001,0.353820775 C9.81752331,-0.00226757161 10.2900909,-0.10703328 10.6461792,0.119820016 Z",transform:"translate(4 5.483)"})):G.createElement("svg",ay({xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 18 14",fill:"currentcolor"},a),G.createElement("polygon",{fill:r,points:"6 11.17 1.83 7 .41 8.41 6 14 18 2 16.59 .59"}))};function aN(){return aN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},aN.apply(this,arguments)}const ZK=R.forwardRef((t,e)=>{const{component:n="label",className:r,colors:a,defaultChecked:i,checked:o,indeterminate:s,name:l,value:u,disabled:c,readOnly:d,onChange:p,ios:f,material:m,touchRipple:y=!0,children:x,...b}=t,v=R.useRef(null),w=R.useRef(null);R.useImperativeHandle(e,()=>({el:w.current,inputEl:v.current}));const S=n,C={...b},I=Jt({ios:f,material:m}),_=Je({ios:f,material:m}),E=mt();eo(w,I==="material"&&y);const P=QK(a,E),A=o||i&&!p||s?"checked":"notChecked",D=_(YK(t,P,r,E),r);return R.useEffect(()=>{v.current&&(v.current.indeterminate=!!s)},[s]),G.createElement(S,aN({ref:w,className:D.base},C),G.createElement("input",{ref:v,type:"checkbox",name:l,value:u,disabled:c,readOnly:d,checked:o,defaultChecked:i,onChange:p,className:D.input}),G.createElement("i",{className:D.iconWrap[A]},s?G.createElement("span",{className:D.indeterminateIcon}):G.createElement(XM,{ios:f,material:m,className:D.icon[A]})),x)});ZK.displayName="Checkbox";const JK=(t,e)=>({base:{common:"text-sm inline-flex items-center justify-center align-middle rounded-full px-3",ios:"rounded-full h-7",material:"rounded-lg h-8 font-medium",fill:{ios:M(e.fillBg||e.fillBgIos,e.fillText||e.fillTextIos),material:M(e.fillBg||e.fillBgMaterial,e.fillText||e.fillTextMaterial)},outline:{common:"border",ios:M(e.outlineText||e.outlineTextIos,e.outlineBorder||e.outlineBorderIos),material:M(e.outlineText||e.outlineTextMaterial,e.outlineBorder||e.outlineBorderMaterial)}},media:{common:"-my-1 me-1 select-none",ios:"-ms-3",material:"-ms-2"},deleteButton:"-me-2 -my-1 ms-1 h-full flex items-center justify-center w-6 cursor-pointer opacity-50 active:opacity-100 select-none"}),eX=function(t,e){return t===void 0&&(t={}),{fillTextIos:"text-current",fillTextMaterial:M("text-md-light-on-secondary-container",e("dark:text-md-dark-on-secondary-container")),fillBgIos:M("bg-black bg-opacity-10",e("dark:bg-white dark:bg-opacity-10")),fillBgMaterial:M("bg-md-light-secondary-container",e("dark:bg-md-dark-secondary-container")),outlineTextIos:M("text-current"),outlineTextMaterial:M("text-md-light-on-surface",e("dark:text-md-dark-on-surface")),outlineBorderIos:M("border-black border-opacity-20",e("dark:border-white dark:border-opacity-20")),outlineBorderMaterial:M("border-md-light-outline",e("dark:border-md-dark-outline")),...t}};function iy(){return iy=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},iy.apply(this,arguments)}const af=t=>{let{theme:e,...n}=t;return e==="ios"?G.createElement("svg",iy({xmlns:"http://www.w3.org/2000/svg",width:"28",height:"28",viewBox:"0 0 28 28",fill:"currentcolor"},n),G.createElement("path",{d:"M14,0 C21.7319865,0 28,6.2680135 28,14 C28,21.7319865 21.7319865,28 14,28 C6.2680135,28 0,21.7319865 0,14 C0,6.2680135 6.2680135,0 14,0 Z M18.9393398,6.93933983 L14,11.8786797 L9.06066017,6.93933983 L6.93933983,9.06066017 L11.8786797,14 L6.93933983,18.9393398 L9.06066017,21.0606602 L14,16.1213203 L18.9393398,21.0606602 L21.0606602,18.9393398 L16.1213203,14 L21.0606602,9.06066017 L18.9393398,6.93933983 Z"})):G.createElement("svg",iy({width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},n),G.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12 2C6.47 2 2 6.47 2 12C2 17.53 6.47 22 12 22C17.53 22 22 17.53 22 12C22 6.47 17.53 2 12 2ZM12 20C7.59 20 4 16.41 4 12C4 7.59 7.59 4 12 4C16.41 4 20 7.59 20 12C20 16.41 16.41 20 12 20ZM12 10.59L15.59 7L17 8.41L13.41 12L17 15.59L15.59 17L12 13.41L8.41 17L7 15.59L10.59 12L7 8.41L8.41 7L12 10.59Z",fill:"currentcolor"}))};function iN(){return iN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},iN.apply(this,arguments)}const tX=R.forwardRef((t,e)=>{const{component:n="div",className:r,colors:a,media:i,deleteButton:o,onDelete:s,ios:l,material:u,outline:c,children:d,...p}=t,f=R.useRef(null);R.useImperativeHandle(e,()=>({el:f.current}));const m=n,y={...p},x=Je({ios:l,material:u}),b=Jt({ios:l,material:u}),v=mt(),w=c?"outline":"fill",S=eX(a,v),C=x(JK(t,S),r);return G.createElement(m,iN({ref:f,className:C.base[w]},y),i&&G.createElement("div",{className:C.media},i),d,o&&G.createElement("div",{className:C.deleteButton,role:"button",tabIndex:"0",onClick:s},G.createElement(af,{theme:b,className:"h-4 w-4"})))});tX.displayName="Chip";const nX=(t,e,n,r)=>{let{hasButtons:a}=r;const{titleFontSizeMaterial:i,titleFontSizeIos:o,translucent:s,sizeIos:l,sizeMaterial:u}=t;return{base:{common:M("left-1/2 top-1/2 transform -translate-x-1/2 -translate-y-1/2 z-40 max-h-full overflow-hidden duration-400",Ln("fixed",n)),ios:M("rounded-xl max-w-full",l,e.bgIos,s&&"translucent"),material:M("rounded-[1.75rem] p-6 max-w-[90%]",u,e.bgMaterial),opened:"",closed:"scale-[0.85] opacity-0 pointer-events-none"},contentWrap:{common:"flex flex-col items-center justify-center",material:"space-y-3",ios:M("p-4 space-y-1 relative",a&&"hairline-b")},title:{common:M("w-full"),ios:M(e.titleIos,o,"font-semibold text-center"),material:M(e.titleMaterial,i)},content:{common:M("text-sm w-full"),ios:M(e.contentTextIos,"text-center"),material:M(e.contentTextMaterial)},buttons:{common:"flex items-center",ios:M("justify-center last-child-hairline-r-none"),material:M("justify-end pt-6 space-x-2 rtl:space-x-reverse")},backdrop:{common:"fixed z-40 w-full h-full left-0 top-0 bg-black bg-opacity-50 duration-400",opened:"",closed:"opacity-0 pointer-events-none"}}},rX=function(t,e){return t===void 0&&(t={}),{bgIos:M("bg-white",e("dark:bg-neutral-800")),bgMaterial:M("bg-md-light-surface-3",e("dark:bg-md-dark-surface-3")),titleIos:"",titleMaterial:M("text-md-light-on-surface",e("dark:text-md-dark-on-surface")),contentTextIos:"",contentTextMaterial:M("text-md-light-on-surface-variant",e("dark:text-md-dark-on-surface-variant")),...t}};function oN(){return oN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},oN.apply(this,arguments)}const aX=R.forwardRef((t,e)=>{const{component:n="div",className:r,colors:a,opened:i,backdrop:o=!0,onBackdropClick:s,translucent:l=!0,sizeIos:u="w-[16.875rem]",sizeMaterial:c="w-[19.5rem]",titleFontSizeIos:d="text-[18px]",titleFontSizeMaterial:p="text-[24px]",title:f,content:m,buttons:y,ios:x,material:b,children:v,...w}=t,S=R.useRef(null);R.useImperativeHandle(e,()=>({el:S.current}));const C=i?"opened":"closed",I=n,_={...w},E=Je({ios:x,material:b}),P=mt(),A=rX(a,P),D=E(nX({...t,titleFontSizeIos:d,titleFontSizeMaterial:p,translucent:l,sizeIos:u,sizeMaterial:c},A,r,{hasButtons:!!y}),r);return G.createElement(G.Fragment,null,o&&G.createElement("div",{className:D.backdrop[C],onClick:s}),G.createElement(I,oN({ref:S,className:D.base[C]},_),G.createElement("div",{className:D.contentWrap},f&&G.createElement("div",{className:D.title},f),(m||v)&&G.createElement("div",{className:D.content},m,v)),y&&G.createElement("div",{className:D.buttons},y)))});aX.displayName="Dialog";const iX=(t,e)=>{const{strong:n,disabled:r}=t;return{base:{ios:M("text-center text-[17px] flex items-center justify-center h-11 w-full hairline-r rtl:hairline-l relative first:rounded-bl-xl last:rounded-br-xl rtl:first:rounded-br-xl rtl:first:rounded-bl-none rtl:last:rounded-bl-xl rtl:last:rounded-br-none",r?e.disabledTextIos:e.textIos,n&&"font-semibold",!r&&e.activeBgIos)}}},oX=function(t,e){return t===void 0&&(t={}),{activeBgIos:M("active:bg-black active:bg-opacity-10",e("dark:active:bg-white dark:active:bg-opacity-10")),textIos:"text-primary",disabledTextIos:M("text-black text-opacity-30",e("dark:text-white dark:text-opacity-30")),...t}};function oy(){return oy=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},oy.apply(this,arguments)}const sX=R.forwardRef((t,e)=>{const{component:n="button",className:r,colors:a,ios:i,material:o,disabled:s,strong:l,strongIos:u,strongMaterial:c,children:d,...p}=t,f=R.useRef(null);R.useImperativeHandle(e,()=>({el:f.current}));const m={...p},y=Jt({ios:i,material:o}),x=Je({ios:i,material:o}),b=mt(),v=oX(a,b),w=typeof l>"u"?y==="ios"?u:c:l,S=x(iX({...t,strong:w},v),r),C=n;return y==="ios"?G.createElement(C,oy({className:S.base,disabled:s,role:"button",tabIndex:"0"},m),d):G.createElement(jn,oy({component:n,inline:!0,rounded:!0,disabled:s,clear:!w,className:r},m),d)});sX.displayName="DialogButton";const lX=(t,e)=>({base:{common:"flex items-center justify-center space-x-2 rtl:!space-x-reverse cursor-pointer overflow-hidden select-none",ios:`h-12 duration-100 rounded-full shadow-lg ${e.bgIos} ${e.activeBgIos} ${e.textIos}`,material:`duration-300 rounded-2xl shadow ${e.bgMaterial} ${e.activeBgMaterial} ${e.textMaterial} ${e.touchRipple}`,iconOnly:{ios:"w-12",material:"w-14 h-14"},withText:{common:"px-4",material:"h-14"}},text:{common:"text-sm",ios:"font-semibold uppercase",material:"font-medium"},icon:{common:"h-1em w-1em",ios:"text-icon-ios",material:"text-icon-material"}}),uX=function(t,e){return t===void 0&&(t={}),{bgIos:"bg-primary",bgMaterial:M("bg-md-light-primary-container",e("dark:bg-md-dark-primary-container")),activeBgIos:"active:bg-ios-primary-shade",activeBgMaterial:"",textIos:"text-white",textMaterial:M("text-md-light-on-primary-container",e("dark:text-md-dark-on-primary-container")),touchRipple:M("touch-ripple-primary",e("dark:touch-ripple-white")),...t}};function sN(){return sN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},sN.apply(this,arguments)}const cX=R.forwardRef((t,e)=>{const{component:n="a",className:r,colors:a,href:i,text:o,textPosition:s="after",icon:l,ios:u,material:c,touchRipple:d=!0,children:p,...f}=t,m=R.useRef(null);R.useImperativeHandle(e,()=>({el:m.current}));const y=n,x={...f},b=Jt({ios:u,material:c}),v=Je({ios:u,material:c}),w=mt();eo(m,b==="material"&&d);const S=uX(a,w),C=v(lX(t,S),r);return G.createElement(y,sN({className:o?C.base.withText:C.base.iconOnly,href:i,ref:m,role:"button",tabIndex:"0"},x),o&&s==="before"&&G.createElement("span",{className:C.text},o),l&&G.createElement("span",{className:C.icon},l),o&&s==="after"&&G.createElement("span",{className:C.text},o),p)});cX.displayName="Fab";const dX=(t,e)=>({base:`${Ln("relative",e)} inline-block not-italic`,badge:"absolute -end-1.5 -top-0.5"});function lN(){return lN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},lN.apply(this,arguments)}const aa=R.forwardRef((t,e)=>{const{component:n="i",className:r,ios:a,material:i,badge:o,badgeColors:s,children:l,...u}=t,c=R.useRef(null);R.useImperativeHandle(e,()=>({el:c.current}));const d=n,p={...u},f=Je(),m=Jt(),y=f(dX(t,r),r);return G.createElement(d,lN({ref:c,className:y.base},p),m==="ios"?a:i,typeof o<"u"&&o!==null&&G.createElement(HM,{small:!0,className:y.badge,colors:s},o),l)});aa.displayName="Icon";const pX=(t,e,n)=>{let{textColor:r,needsTouchRipple:a}=e;const{iconOnly:i,tabbar:o}=t;return{base:{common:M(!o&&r,"inline-flex space-x-1 rtl:!space-x-reverse justify-center items-center cursor-pointer select-none",a&&`touch-ripple-primary ${Ln("relative",n)} z-10`),notTabbar:{ios:"active:opacity-30 duration-300 active:duration-0",material:a?"":"active:opacity-55"}},tabbar:{common:M(Ln("relative",n),"w-full h-full duration-300"),material:"font-medium text-sm z-10",active:"k-tabbar-link-active",inactive:""},toolbar:{common:M("h-full max-h-12",i&&"k-touch-ripple-inset"),material:"px-3 text-sm font-medium"},navbar:{common:M("h-full max-h-12",i&&"k-touch-ripple-inset"),material:"px-3"}}},hX=function(t,e){return t===void 0&&(t={}),{textIos:"text-primary",textMaterial:M("text-md-light-primary",e("dark:text-md-dark-primary")),navbarTextIos:"text-primary",navbarTextMaterial:"",...t}};function uN(){return uN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},uN.apply(this,arguments)}const Nd=R.forwardRef((t,e)=>{const{component:n="a",className:r,colors:a,navbar:i,toolbar:o,iconOnly:s,linkProps:l={},tabbar:u,tabbarActive:c,touchRipple:d=void 0,ios:p,material:f,onClick:m,children:y,...x}=t,b=R.useRef(null);R.useImperativeHandle(e,()=>({el:b.current}));const v=n,w={...l,...x},S=Jt({ios:p,material:f}),C=Je({ios:p,material:f}),I=mt(),_=S==="material"&&(d||(o||u||i)&&typeof d>"u");eo(b,_);const E=hX(a,I),P=t.navbar?S==="material"?E.navbarTextMaterial:E.navbarTextIos:S==="material"?E.textMaterial:E.textIos,A=u&&!c?E.tabbarInactive:P,D=c?"active":"inactive",V=C(pX(t,{textColor:A,needsTouchRipple:_},r)),z=M(V.base[u?"default":"notTabbar"],o&&V.toolbar,i&&V.navbar,u&&V.tabbar[D],r);return G.createElement(v,uN({ref:b,className:z},w,{role:"link",tabIndex:"0",onClick:m}),y)});Nd.displayName="Link";const fX=(t,e,n)=>{const{nested:r,margin:a,inset:i,strong:o,outline:s}=t;return{base:{common:M(!r&&a,!i&&!r&&s&&"hairline-t hairline-b",i&&s&&"border",Ln("relative",n),"z-10"),ios:M(o&&e.strongBgIos,i&&s&&e.outlineIos),material:M(o&&e.strongBgMaterial,i&&s&&e.outlineMaterial)},ul:{common:M(i&&"no-safe-areas","last-child-hairline-b-none")},inset:{common:"ml-4-safe mr-4-safe overflow-hidden",ios:"rounded-lg",material:"rounded-2xl"},menuList:{common:"py-1"}}},gX=function(t,e){return t===void 0&&(t={}),{outlineIos:M("border-black border-opacity-20",e("dark:border-white dark:border-opacity-15")),outlineMaterial:M("border-md-light-outline",e("border-md-dark-outline")),strongBgIos:M("bg-ios-light-surface-1",e("dark:bg-ios-dark-surface-1")),strongBgMaterial:M("bg-md-light-surface-1",e("dark:bg-md-dark-surface-1")),...t}},YM=G.createContext(!1);function cN(){return cN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},cN.apply(this,arguments)}const Td=R.forwardRef((t,e)=>{const{component:n="div",className:r,colors:a,margin:i="my-8",nested:o,menuList:s,dividers:l,dividersIos:u=!0,dividersMaterial:c=!1,inset:d,insetIos:p,insetMaterial:f,strong:m,strongIos:y,strongMaterial:x,outline:b,outlineIos:v,outlineMaterial:w,ios:S,material:C,children:I,..._}=t,E=R.useRef(null);R.useImperativeHandle(e,()=>({el:E.current}));const P=n,A={..._},D=Jt(),V=Je({ios:S,material:C}),z=mt(),K=typeof l>"u"?D==="ios"?u:c:l,X=typeof m>"u"?D==="ios"?y:x:m,Z=typeof b>"u"?D==="ios"?v:w:b,q=typeof d>"u"?D==="ios"?p:f:d,F=gX(a,z),Y=V(fX({...t,margin:i,inset:q,strong:X,outline:Z},F,r)),Q=M(Y.base,q&&Y.inset,s&&Y.menuList,r);return G.createElement(YM.Provider,{value:K},G.createElement(P,cN({ref:E,className:Q},A),G.createElement("ul",{className:Y.ul},I)))});Td.displayName="List";function dN(){return dN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},dN.apply(this,arguments)}const mX=R.forwardRef((t,e)=>{const{children:n,...r}=t,a=R.useRef(null);R.useImperativeHandle(e,()=>({el:a.current}));const i={...r};return G.createElement("li",{ref:a},G.createElement(Td,dN({nested:!0},i),n))});mX.displayName="ListGroup";const yX=(t,e,n)=>{const{dividers:r}=t;return{base:"",button:{common:M(Ln("relative",n),r&&"hairline-b active:hairline-transparent",`flex items-center justify-center px-4 space-x-1 w-full duration-300 active:duration-0 focus:outline-none ${e.touchRipple} overflow-hidden select-none`),ios:M("h-11",e.textIos,e.activeBgIos,e.activeBgIos),material:M("h-12",e.textMaterial,e.activeBgMaterial)}}},bX=function(t,e){return t===void 0&&(t={}),{textIos:"text-primary",textMaterial:M("text-md-light-primary",e("dark:text-md-dark-primary")),activeBgIos:"active:bg-primary active:bg-opacity-15",activeBgMaterial:"",touchRipple:"touch-ripple-primary",...t}},QM=()=>R.useContext(YM);function sy(){return sy=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},sy.apply(this,arguments)}const vX=R.forwardRef((t,e)=>{const{component:n="li",className:r,colors:a,href:i,target:o,type:s,value:l,linkComponent:u="a",linkProps:c={},ios:d,material:p,touchRipple:f=!0,children:m,...y}=t,x=R.useRef(null),b=R.useRef(null),v=QM();R.useImperativeHandle(e,()=>({el:x.current}));const w=n,S={...y},C=Jt({ios:d,material:p}),I=Je({ios:d,material:p});eo(b,C==="material"&&f);const _=mt(),E=bX(a,_),P=I(yX({...t,dividers:v},E,r),r),A=!!i||i==="",D={href:!A||i===!0||i===!1?void 0:i||"",target:o,type:s,value:l,...c},V=A?u:"button";return G.createElement(w,sy({ref:x,className:P.base},S),G.createElement(V,sy({ref:b,className:P.button},D),m))});vX.displayName="ListButton";const xX=(t,e,n)=>{let{className:r,isMediaItem:a,theme:i,textColor:o,needsTouchRipple:s,isMenuListItemActive:l,autoStrongTitle:u}=n;const{menuListItem:c,dividers:d,mediaClassName:p="",mediaClass:f="",innerClassName:m="",innerClass:y="",contentClassName:x="",contentClass:b="",titleWrapClassName:v="",titleWrapClass:w="",titleFontSizeIos:S,titleFontSizeMaterial:C,strongTitle:I,contacts:_}=t;return{base:{common:c?`${o} py-1`:"",material:_&&"[&:nth-child(2)]:-mt-12"},itemContent:{common:M(`flex items-center ${x||b}`),ios:M(!c&&M(e.primaryTextIos,"ps-4-safe"),c&&"rounded-lg ml-2-safe mr-2-safe ps-2"),material:M(!c&&M(e.primaryTextMaterial,a?"ml-2-safe mr-2-safe rounded-2xl ps-2":"ps-4-safe",_&&"ml-10"),c&&"rounded-full min-h-[3.5rem] ml-4-safe mr-4-safe ps-4"),link:M("duration-300 active:duration-0 cursor-pointer select-none",d&&i==="ios"&&"active:hairline-transparent",s&&M("relative overflow-hidden z-10",e.touchRipple),M(l?i==="ios"?e.menuListItemActiveBgIos:e.menuListItemActiveBgMaterial:c?i==="ios"?e.menuListItemBgIos:e.menuListItemBgMaterial:i==="ios"?e.activeBgIos:e.activeBgMaterial))},media:{common:`shrink-0 flex ${p||f}`,ios:"py-2 me-4",material:M("py-3",c?"me-3":"me-4")},inner:{common:M("w-full relative",!c&&d&&"hairline-b",m||y),ios:"py-2.5 pe-4-safe",material:M("py-3",a&&!c?"pe-2":"pe-4-safe")},titleWrap:{common:M(`flex justify-between items-center ${v||w}`),ios:M(!c&&S),material:M(!c&&C)},title:{common:"shrink",menuListItem:M("text-sm",I===!0||u?"font-semibold":"font-medium"),strong:{common:"",ios:"font-semibold",material:"font-medium"}},after:{common:M("shrink-0 ms-auto ps-1 flex items-center space-x-1"),ios:e.secondaryTextIos,material:M(e.secondaryTextMaterial,"text-sm")},chevron:"opacity-20 shrink-0 ms-3 rtl:rotate-180",subtitle:"text-sm",text:{common:M("text-sm line-clamp-2"),ios:e.secondaryTextIos,material:e.secondaryTextMaterial},header:{common:"text-xs mb-0.5",ios:e.secondaryTextIos,material:e.secondaryTextMaterial},footer:{common:M("text-xs mt-0.5"),ios:e.secondaryTextIos,material:e.secondaryTextMaterial},groupTitle:{common:M("pl-4-safe pr-4-safe py-1 flex items-center z-20",Ln("relative",r)),ios:`h-8${d?" hairline-t":""} -mt-px ${S} ${e.secondaryTextIos} ${e.groupTitleBgIos} ${_&&M("font-semibold top-11-safe sticky",e.groupTitleContactsTextIos,e.groupTitleContactsBgIos)}`,material:`h-12 ${C} ${e.secondaryTextMaterial} ${e.groupTitleBgMaterial} ${_&&M("pointer-events-none overflow-visible h-12 box-border text-xl font-medium flex max-w-full items-center px-4 top-16-safe sticky",e.groupTitleContactsTextMaterial,e.groupTitleContactsBgMaterial)}`}}},wX=function(t,e){return t===void 0&&(t={}),{primaryTextIos:M("text-black",e("dark:text-white")),primaryTextMaterial:M("text-md-light-on-surface",e("dark:text-md-dark-on-surface")),secondaryTextIos:M("text-black text-opacity-55",e("dark:text-white dark:text-opacity-55")),secondaryTextMaterial:M("text-md-light-on-surface-variant",e("dark:text-md-dark-on-surface-variant")),activeBgIos:M("active:bg-black active:bg-opacity-10",e("dark:active:bg-white dark:active:bg-opacity-10")),activeBgMaterial:"",groupTitleBgIos:M("bg-ios-light-surface-variant",e("dark:bg-ios-dark-surface-variant")),groupTitleBgMaterial:M("bg-md-light-surface-2",e("dark:bg-md-dark-surface-2")),menuListItemTextIos:M("text-black",e("dark:text-white")),menuListItemTextMaterial:M("text-md-light-on-surface-variant",e("dark:text-md-dark-on-surface-variant")),menuListItemBgIos:M("active:bg-black active:bg-opacity-10",e("dark:active:bg-white dark:active:bg-opacity-10")),menuListItemBgMaterial:M("bg-md-light-surface-1",e("dark:bg-md-dark-surface-1")),menuListItemActiveTextIos:M("text-primary",e("dark:text-white")),menuListItemActiveTextMaterial:M("text-md-light-on-secondary-container",e("dark:text-md-dark-on-secondary-container")),menuListItemActiveBgIos:M("bg-primary bg-opacity-15",e("dark:bg-primary")),menuListItemActiveBgMaterial:M("bg-md-light-secondary-container",e("dark:bg-md-dark-secondary-container")),touchRipple:M("touch-ripple-black",e("dark:touch-ripple-white")),groupTitleContactsTextIos:M("text-opacity-90",e("dark:text-opacity-90")),groupTitleContactsTextMaterial:M("text-md-light-primary",e("dark:text-md-dark-primary")),groupTitleContactsBgIos:M(e("dark:bg-[#323234]")),groupTitleContactsBgMaterial:M("bg-transparent",e("dark:bg-transparent")),...t}};function ly(){return ly=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},ly.apply(this,arguments)}const Id=R.forwardRef((t,e)=>{const{component:n="li",colors:r,className:a,mediaClassName:i="",innerClassName:o="",innerChildren:s,contentClassName:l="",contentChildren:u,titleWrapClassName:c="",titleFontSizeIos:d="text-[17px]",titleFontSizeMaterial:p="text-[16px]",title:f,subtitle:m,text:y,after:x,media:b,header:v,footer:w,menuListItem:S,menuListItemActive:C,groupTitle:I,strongTitle:_="auto",label:E,chevron:P=void 0,chevronIos:A=!0,chevronMaterial:D=!0,chevronIcon:V,href:z,target:K,link:X,linkComponent:Z="a",linkProps:q={},dividers:F,contacts:Y,ios:Q,material:ne,touchRipple:le=!0,children:de,...re}=t,he=R.useRef(null),ve=R.useRef(null);R.useImperativeHandle(e,()=>({el:ve.current}));const H=n,ie={...re},pe=typeof F>"u"?QM():F,ke=Jt({ios:Q,material:ne}),Ne=Je({ios:Q,material:ne}),Ie=mt(),Le=typeof P>"u"?ke==="ios"?A:D:P,He=wX(r,Ie),Me=S&&C,it=He[`${Me?"menuListItemActiveText":S?"menuListItemText":"text"}${ke==="ios"?"Ios":"Material"}`],Ye=!!z||z===""||S||X,Ze=!!E,Qe=ke==="material"&&(Ze||Ye)&&le;eo(he,Qe);const Xt=z===!0||z===!1||typeof z>"u"?void 0:z||"",Vt=Ye?Z:Ze?"label":"div",Ht=Ye?{href:Xt,target:K,...q}:{},Yt=f&&(m||y),Wt=_==="auto"&&Yt,Tt=Ne(xX({...t,titleFontSizeIos:d,titleFontSizeMaterial:p,dividers:pe,strongTitle:_,mediaClassName:i,innerClassName:o,contentClassName:l,titleWrapClassName:c},He,{isMediaItem:Yt,theme:ke,textColor:it,needsTouchRipple:Qe,isMenuListItemActive:Me,darkClasses:Ie,autoStrongTitle:Wt,className:a}),a),Hn=Ye||Ze?Tt.itemContent.link:Tt.itemContent.default,yr=S?Tt.title.menuListItem:_===!0||Wt?Tt.title.strong:Tt.title.default;return I?G.createElement(H,{className:M(Tt.groupTitle,a)},f,de):G.createElement(H,ly({ref:ve,className:Tt.base},ie),G.createElement(Vt,ly({ref:he,className:Hn},Ht),b&&G.createElement("div",{className:Tt.media},b),G.createElement("div",{className:Tt.inner},v&&G.createElement("div",{className:Tt.header},v),(f||x)&&G.createElement("div",{className:Tt.titleWrap},f&&G.createElement("div",{className:yr},f),x&&G.createElement("div",{className:Tt.after},x),Ye&&Le&&!S&&(V||G.createElement(qM,{className:Tt.chevron}))),m&&G.createElement("div",{className:Tt.subtitle},m),y&&G.createElement("div",{className:Tt.text},y),w&&G.createElement("div",{className:Tt.footer},w),s),u),de)});Id.displayName="ListItem";function pN(){return pN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},pN.apply(this,arguments)}const kX=t=>G.createElement("svg",pN({xmlns:"http://www.w3.org/2000/svg",width:"8",height:"5",viewBox:"0 0 8 5",fill:"currentcolor"},t),G.createElement("polygon",{fillRule:"evenodd",points:"0 0 8 0 4 5"})),SX=(t,e,n)=>{let{isFloatingTransformed:r,isFocused:a,darkClasses:i,getLabelColor:o,hasLabel:s}=n;const{error:l,type:u,outline:c,inputClassName:d="",inputClass:p=""}=t;return{base:{common:"",ios:M(c&&"my-4"),material:M("py-2")},itemContent:{common:"relative",ios:M(c&&"ml-4 mr-4 rounded-lg",!c&&e.bgIos),material:M("min-h-[56px] ml-4 mr-4",c?M("rounded"):M(e.bgMaterial,"rounded-t relative "))},inner:{common:"",material:M(c?"pt-4 pb-4":"pt-2 pb-2"),stacked:"",floating:""},label:{common:M("duration-200 text-xs",o(),c&&"flex"),ios:M(c&&"-mt-4"),material:M(c&&"-mt-4"),stacked:"",floating:{common:M("pointer-events-none duration-200 transform origin-left rtl:origin-right max-w-[66%]",r&&"scale-133"),ios:r?c?"translate-y-6":"translate-y-4":"",material:r?c?"translate-y-8":"translate-y-3":""}},labelText:{common:M(c&&"relative p-1 block -m-1"),ios:M(c&&M("-top-1",e.outlineLabelBgIos)),material:M(c&&M("-top-2",e.outlineLabelBgMaterial))},inputWrap:{common:"relative",ios:M((!s||c)&&"-mt-2.5","-mb-2.5"),stacked:"",floating:""},media:{material:""},titleWrap:{material:`duration-200 ${o()}`},input:{common:`block text-base appearance-none w-full focus:outline-none bg-transparent ${d||p}`,ios:"h-10",material:"h-6",notFloating:{common:M("placeholder-black placeholder-opacity-30",i("dark:placeholder-white dark:placeholder-opacity-30")),material:M(u==="textarea"&&"py-1"),ios:M(u==="textarea"&&"py-2")},floating:r?"placeholder-transparent":M("placeholder-black placeholder-opacity-30",i("dark:placeholder-white dark:placeholder-opacity-30"))},errorInfo:{common:"text-xs relative z-10",ios:"mt-1",material:""},error:e.errorText,info:"opacity-50",clearButton:{common:"absolute end-0 top-1/2 transform -translate-y-1/2 cursor-pointer",ios:M("w-3.5 h-3.5 opacity-45 active:opacity-30",e.labelTextIos),material:M("w-6 h-6 active:opacity-55",e.labelTextMaterial)},dropdown:"absolute end-0 top-1/2 transform -translate-y-1/2 pointer-events-none opacity-50",border:{common:"pointer-events-none absolute start-0 bottom-0 duration-200 w-full",ios:c&&M(l?e.errorBorder:a?e.outlineBorderFocusIos:e.outlineBorderIos,"h-full border rounded-lg -z-10"),material:M(l?e.errorBorder:a?e.outlineBorderFocusMaterial:e.outlineBorderMaterial,c&&M("h-full border rounded -z-10",a&&"border-2"),!c&&M("border-b h-px origin-bottom",a&&"scale-y-[2]"))}}},CX=function(t,e){return t===void 0&&(t={}),{bgIos:"",bgMaterial:M("bg-md-light-surface-variant",e("dark:bg-md-dark-surface-variant")),outlineBorderIos:M("border-black border-opacity-30",e("dark:border-white dark:border-opacity-30")),outlineBorderFocusIos:"border-primary",outlineBorderMaterial:M("border-md-light-on-surface",e("dark:border-md-dark-on-surface")),outlineBorderFocusMaterial:M("border-md-light-primary",e("dark:border-md-dark-primary")),outlineLabelBgIos:M("bg-ios-light-surface-1",e("dark:bg-ios-dark-surface-1")),outlineLabelBgMaterial:M("bg-md-light-surface",e("dark:bg-md-dark-surface")),labelTextIos:"",labelTextFocusIos:"",labelTextMaterial:M("text-md-light-on-surface-variant",e("dark:text-md-dark-on-surface-variant")),labelTextFocusMaterial:M("text-md-light-primary",e("dark:text-md-dark-primary")),errorText:"text-red-500",errorBorder:"border-red-500",...t}};function hN(){return hN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},hN.apply(this,arguments)}const NX=R.forwardRef((t,e)=>{const{component:n="li",className:r,colors:a,label:i,floatingLabel:o,outline:s,outlineIos:l,outlineMaterial:u,media:c,input:d,info:p,error:f,clearButton:m,dropdown:y,inputId:x,inputStyle:b,inputClassName:v="",name:w,value:S,defaultValue:C,type:I="text",inputMode:_,readOnly:E,required:P,disabled:A,placeholder:D,size:V,accept:z,autoComplete:K,autoCorrect:X,autoCapitalize:Z,spellCheck:q,autoFocus:F,autoSave:Y,max:Q,min:ne,step:le,maxLength:de,minLength:re,multiple:he,pattern:ve,tabIndex:H,onInput:ie,onChange:pe,onFocus:ke,onBlur:Ne,onClear:Ie,ios:Le,material:He,children:Me,...it}=t,Ye=R.useRef(null),Ze=R.useRef(null);R.useImperativeHandle(e,()=>({el:Ze.current,inputEl:Ye.current}));const[Qe,Xt]=R.useState(!1),Vt=Jt({ios:Le,material:He}),Ht=Je({ios:Le,material:He}),Yt=mt(),Wt=CX(a,Yt),Tt=i&&o?"floating":"stacked",Hn=Tt==="floating"?"floating":"notFloating",yr=()=>{if(Ye.current)return Ye.current.value},Ha=i&&o&&!(()=>{const Na=yr();return typeof S>"u"?Na||Na===0:S||S===0})()&&!Qe,Or=()=>f?Wt.errorText:Vt==="material"?Qe?Wt.labelTextFocusMaterial:Wt.labelTextMaterial:Vt==="ios"?Qe?Wt.labelTextFocusIos:Wt.labelTextIos:"",Fi=Na=>{Xt(!0),ke&&ke(Na)},Ds=Na=>{Xt(!1),Ne&&Ne(Na)},fo=typeof s>"u"?Vt==="ios"?l:u:s,rn=Ht(SX({...t,outline:fo},Wt,{isFloatingTransformed:Ha,isFocused:Qe,darkClasses:Yt,getLabelColor:Or,inputClassName:v,hasLabel:!!i})),Bi={...it},Fs=()=>{if(d)return d;const Na=I==="select"||I==="textarea"?I:"input",Lp=Na==="input";return G.createElement(Na,{id:x,ref:Ye,className:rn.input[Hn],style:b,name:w,type:Lp?I:void 0,placeholder:D,inputMode:_,size:V,accept:z,autoComplete:K,autoCorrect:X,autoCapitalize:Z,spellCheck:q,autoFocus:F,autoSave:Y,disabled:A,max:Q,maxLength:de,min:ne,minLength:re,step:le,multiple:he,readOnly:E,required:P,pattern:ve,tabIndex:H,value:S,defaultValue:C,onInput:ie,onChange:pe,onFocus:Fi,onBlur:Ds},I==="select"?Me:null)},go=G.createElement(G.Fragment,null,f&&f!==!0&&G.createElement("div",{className:M(rn.errorInfo,rn.error)},f),p&&!f&&G.createElement("div",{className:M(rn.errorInfo,rn.info)},p)),Pp=G.createElement(G.Fragment,null,i&&G.createElement("div",{className:rn.label[Tt]},G.createElement("div",{className:rn.labelText},i)),G.createElement("div",{className:rn.inputWrap[Tt]},Fs(),m&&G.createElement(af,{theme:Vt,onClick:Ie,className:rn.clearButton}),y&&G.createElement(kX,{className:rn.dropdown})),go);return G.createElement(Id,hN({ref:Ze,component:n,media:c,className:rn.base,title:null,mediaClassName:rn.media,innerClassName:rn.inner[Tt],contentClassName:rn.itemContent,titleWrapClassName:rn.titleWrap,innerChildren:Pp,contentChildren:(fo||Vt==="material")&&G.createElement("span",{className:rn.border}),dividers:Vt==="material"||fo?!1:void 0},Bi),I!=="select"?Me:null)});NX.displayName="ListInput";function fN(){return fN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},fN.apply(this,arguments)}const TX=R.forwardRef((t,e)=>{const{children:n,...r}=t,a=R.useRef(null);R.useImperativeHandle(e,()=>({el:a.current}));const i={...r};return G.createElement(Td,fN({ref:a,menuList:!0},i),n)});TX.displayName="MenuList";function gN(){return gN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},gN.apply(this,arguments)}const IX=R.forwardRef((t,e)=>{const{active:n,href:r,children:a,...i}=t,o=R.useRef(null);R.useImperativeHandle(e,()=>({el:o.current}));const s={...i};return G.createElement(Id,gN({ref:o,menuListItem:!0,menuListItemActive:n,href:r||!1},s),a)});IX.displayName="MenuListItem";const EX=(t,e)=>{const{type:n}=t;return{message:{common:"max-w-[70%] box-border flex relative z-1 transform translate-z-0 mb-2 first:mt-2"},messageSent:{common:M("self-end",e.messageSent)},messageReceived:{common:e.messageReceived},messageName:{common:"text-xs",ios:M("mb-0.5 ms-4",e.messageNameIos),material:M("ms-4 mb-0.5",e.messageNameMd)},messageHeader:{common:"text-xs",ios:M("mb-0.5 ms-4",e.messageNameIos),material:M("ms-4 mb-0.5",e.messageNameMd)},messageFooter:{common:"text-xs",ios:M("mb-0.5 ms-4",e.messageNameIos),material:M("ms-4 mb-0.5",e.messageNameMd)},messageAvatar:{common:M("rounded-full relative bg-cover self-end shrink-0 me-1.5 w-8 h-8")},messageContent:{common:"flex flex-col"},messageBubble:{...n==="sent"&&{ios:M("rounded-3xl box-border break-words flex flex-col relative rounded-2xl py-1.5 px-4",e.bubbleSentIos),material:M("box-border break-words flex flex-col relative rounded-3xl py-2.5 px-4",e.bubbleSentMd)},...n==="received"&&{ios:M("rounded-2xl box-border break-words flex flex-col relative rounded-2xl py-1.5 px-4",e.bubbleReceivedIos),material:M("box-border break-words flex flex-col relative rounded-3xl py-2.5 px-4 ",e.bubbleReceivedMd)}},messageTextHeader:{common:"w-full text-left leading-tight text-sm opacity-80"},messageTextFooter:{common:"w-full text-left leading-tight text-sm opacity-80"},messageText:{common:"w-full text-left leading-tight"}}},_X=function(t,e){return t===void 0&&(t={}),{messageSent:"text-white",messageReceived:"text-inherit",messageNameIos:M("text-black text-opacity-45",e("dark:text-white dark:text-opacity-45")),messageNameMd:M("text-md-light-on-surface-variant",e("dark:text-md-dark-on-surface-variant")),bubbleSentIos:M("bg-primary"),bubbleSentMd:M("bg-md-light-primary",e("dark:bg-md-dark-primary dark:text-md-dark-on-primary")),bubbleReceivedIos:M("bg-[#e5e5ea]",e("dark:bg-[#252525]")),bubbleReceivedMd:M(e("dark:bg-md-dark-surface-variant"),"bg-[#e5e5ea]"),...t}};function mN(){return mN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},mN.apply(this,arguments)}const OX=R.forwardRef((t,e)=>{const{component:n="div",className:r,colors:a,id:i,text:o,name:s,type:l="sent",header:u,footer:c,textHeader:d,textFooter:p,avatar:f,ios:m,material:y,children:x,...b}=t,v=R.useRef(null);R.useImperativeHandle(e,()=>({el:v.current}));const w=Je({ios:m,material:y}),S=mt(),C=_X(a,S),I=w(EX({...t},C)),_=n,E={...b},P=M(r,I.message,{[I.messageSent]:l==="sent",[I.messageReceived]:l==="received"});return G.createElement(_,mN({id:i,ref:v,className:P},E),f&&G.createElement("div",{className:I.messageAvatar},f),G.createElement("div",{className:I.messageContent},s&&G.createElement("div",{className:I.messageName},s),u&&G.createElement("div",{className:I.messageHeader},u),G.createElement("div",{className:I.messageBubble},d&&G.createElement("div",{className:I.messageTextHeader},d),o&&G.createElement("div",{className:I.messageText},o),p&&G.createElement("div",{className:I.messageTextFooter},p)),c&&G.createElement("div",{className:I.messageFooter},c)))});OX.displayName="Message";const $X=(t,e,n)=>{let{isFocused:r}=n;const{rightClassName:a="",rightClass:i="",leftClassName:o="",leftClass:s=""}=t;return{base:{common:"fixed bottom-0 start-0 w-full"},toolbar:{material:e.bgMessage},left:{common:M("mt-1 -ms-2",o||s),ios:M("px-2",e.toolbarIconIos),material:M("",e.toolbarIconMd)},right:{common:M("mt-1 -me-2",a||i),ios:M("px-2",e.toolbarIconIos)},messagebarArea:{common:"w-full"},messagebarInput:{common:M("block w-full focus:outline-none resize-none",r&&"outline-offset-0"),ios:M("border h-8 rounded-3xl px-4 leading-4 py-1.5",e.inputBgIos,e.borderIos,e.placeholderIos),material:M("rounded-3xl h-12 px-4 py-4 leading-4 ",e.inputBgMd,e.placeholderMd)}}},RX=function(t,e){return t===void 0&&(t={}),{toolbarIconIos:M("fill-primary",e("dark:fill-md-dark-primary")),toolbarIconMd:M("fill-black"),inputBgIos:M("bg-transparent"),borderIos:M("border-[#c8c8cd]",e("dark:border-white dark:border-opacity-30")),inputBgMd:M("bg-md-light-surface-2",e("dark:bg-md-dark-surface-variant")),placeholderIos:M(e("dark:placeholder-white dark:placeholder-opacity-40")),placeholderMd:M("placeholder-md-light-on-surface-variant",e("dark:placeholder-md-dark-on-surface-variant")),bgIos:M("bg-white",e("dark:bg-black")),bgMaterial:M("bg-md-light-surface",e("dark:bg-md-dark-surface")),...t}},MX=(t,e,n)=>{const{bgClassName:r="",bgClass:a="",outline:i,translucent:o,innerClassName:s="",innerClass:l="",tabbar:u,tabbarIcons:c,top:d}=t;return{base:{common:M("w-full z-20",Ln("relative",n),!d&&"pb-safe")},bg:{common:M("absolute w-full h-full left-0 top-0",i&&(d?"hairline-b":"hairline-t"),r||a),ios:M(e.bgIos,o&&"translucent"),material:M(`${e.bgMaterial}`)},inner:{common:M("flex relative justify-between items-center w-full overflow-hidden",s||l),ios:M("pl-2-safe pr-2-safe",c?"h-12.5":"h-11"),material:M(u?"":"pl-2-safe pr-2-safe",c?"h-20":"h-14")},highlight:{common:M(d?"bottom-0":"top-0","absolute left-0 w-full h-0.5 duration-200 pointer-events-none transition-transform"),ios:e.tabbarHighlightBgIos,material:e.tabbarHighlightBgMaterial}}},AX=function(t,e){return t===void 0&&(t={}),{bgIos:M("bg-ios-light-surface-2",e("dark:bg-ios-dark-surface-2")),bgMaterial:M("bg-md-light-surface-2",e("dark:bg-md-dark-surface-2")),tabbarHighlightBgIos:"bg-primary",tabbarHighlightBgMaterial:M("bg-md-light-primary",e("dark:bg-md-dark-primary")),...t}};function yN(){return yN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},yN.apply(this,arguments)}const bN=R.forwardRef((t,e)=>{const{component:n="div",className:r,colors:a,translucent:i=!0,bgClassName:o="",innerClassName:s="",outline:l,tabbar:u,tabbarIcons:c,tabbarLabels:d,top:p,ios:f,material:m,children:y,...x}=t,b=R.useRef(null),v=R.useRef(null);R.useImperativeHandle(e,()=>({el:v.current}));const w=n,[S,C]=R.useState({transform:"",width:""}),I=Jt({ios:f,material:m}),_=Je({ios:f,material:m}),E=mt(),P={...x},A=AX(a,E),D=_(MX({...t,outline:typeof l>"u"?I==="ios":l,translucent:i,bgClassName:o,innerClassName:s},A,r),r),V=I==="material"&&u&&!c;return R.useEffect(()=>{if(V&&b.current){const z=b.current.previousElementSibling,K=1/z.children.length*100,X=[...z.children].indexOf(z.querySelector(".k-tabbar-link-active"));C({...S,width:`${K}%`,transform:`translateX(${X*100}%)`})}},[y]),G.createElement(w,yN({ref:v,className:D.base},P),G.createElement("div",{className:D.bg}),G.createElement("div",{className:D.inner},y),V&&G.createElement("span",{className:D.highlight,style:S,ref:b}))});bN.displayName="Toolbar";function vN(){return vN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},vN.apply(this,arguments)}const PX=R.forwardRef((t,e)=>{const{component:n="div",className:r,colors:a,id:i,style:o,name:s,placeholder:l="Message",value:u,outline:c=!1,leftClassName:d="",rightClassName:p="",textareaId:f,disabled:m,size:y,left:x,right:b,ios:v,material:w,onInput:S,onChange:C,onFocus:I,children:_,...E}=t,P=R.useRef(null),A=R.useRef(null);R.useImperativeHandle(e,()=>({el:P.current,areaElRef:A.current}));const[D,V]=R.useState(!1),z=Je({ios:v,material:w}),K=mt(),X=RX(a,K),Z=Q=>{V(!0),I&&I(Q)},q=z($X({...t},X,{isFocused:D})),F=n,Y={...E};return G.createElement(F,vN({ref:P,id:i,style:o,className:q.base},Y),G.createElement(bN,{colors:X,outline:c},x&&G.createElement("div",{className:q.left},x),G.createElement("div",{className:q.messagebarArea},G.createElement("textarea",{id:f,ref:A,type:"textarea",className:q.messagebarInput,placeholder:l,name:s,size:y,disabled:m,onInput:S,onChange:C,onFocus:Z,value:u})),b&&G.createElement("div",{className:q.right},b)))});PX.displayName="Messagebar";const LX=()=>({base:{common:M("flex flex-col relative z-1 px-2"),ios:"mb-12",material:"mb-16"}});function xN(){return xN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},xN.apply(this,arguments)}const DX=R.forwardRef((t,e)=>{const{component:n="div",className:r,colors:a,id:i,ios:o,material:s,children:l,...u}=t,c=R.useRef(null);R.useImperativeHandle(e,()=>({el:c.current}));const d=Je({ios:o,material:s})(LX({...t})),p=n,f={...u};return G.createElement(p,xN({id:i,className:d.base,ref:c},f),l)});DX.displayName="Messages";const FX=(t,e)=>({base:{common:M("text-center text-xs leading-none"),ios:M("w-full mt-2.5",e.titleIos),material:M("mt-4",e.titleMd)}}),BX=function(t,e){return t===void 0&&(t={}),{titleIos:M("text-black text-opacity-45",e("dark:text-white dark:text-opacity-45")),titleMd:M("text-md-light-on-surface-variant",e("dark:text-md-dark-on-surface-variant")),...t}};function wN(){return wN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},wN.apply(this,arguments)}const zX=R.forwardRef((t,e)=>{const{component:n="div",className:r,colors:a,ios:i,material:o,id:s,children:l,...u}=t,c=R.useRef(null);R.useImperativeHandle(e,()=>({el:c.current}));const d=Je({ios:i,material:o}),p=mt(),f=BX(a,p),m=d(FX({...t},f)),y=n,x={...u};return G.createElement(y,wN({id:s,className:m.base,ref:c},x),l)});zX.displayName="MessagesTitle";const jX=(t,e,n)=>{const{outline:r,translucent:a,large:i,medium:o,transparent:s,left:l,right:u,fontSizeIos:c,fontSizeMaterial:d,titleFontSizeIos:p,titleFontSizeMaterial:f,titleLargeFontSizeIos:m,titleLargeFontSizeMaterial:y,titleMediumFontSizeIos:x,titleMediumFontSizeMaterial:b,bgClassName:v="",bgClass:w="",subnavbarClassName:S="",subnavbarClass:C="",innerClassName:I="",innerClass:_="",leftClassName:E="",leftClass:P="",titleClassName:A="",titleClass:D="",subtitleClassName:V="",subtitleClass:z="",rightClassName:K="",rightClass:X="",centerTitle:Z}=t;return{base:{common:M("w-full z-20 top-0 pt-safe",(i||o)&&"pointer-events-none",Ln("sticky",n)),ios:M(c,e.textIos),material:M(d,e.textMaterial)},bg:{common:M("absolute w-full h-full left-0 top-0",r&&"hairline-b",v||w),ios:M(e.bgIos,a&&"translucent"),material:`${e.bgMaterial}`},subnavbar:{common:M("relative flex items-center",S||C,(i||o)&&"pointer-events-auto"),ios:"h-11 pl-2-safe pr-2-safe",material:"h-14 pl-4-safe pr-4-safe"},inner:{common:M("flex relative items-center w-full overflow-hidden",I||_,(i||o)&&"pointer-events-auto z-10"),ios:M("pl-2-safe pr-2-safe h-11",!l&&u?"justify-end":"justify-between"),material:"justify-start h-16 pl-safe pr-safe"},titleContainer:{common:M("flex items-center px-4 relative",(i||o)&&"pointer-events-auto"),ios:M(o&&M(x,"h-11 font-semibold"),i&&M(m,"h-13 font-bold")),material:M(o&&M(b,"h-12 pb-4"),i&&M(y,"h-[5.5rem]"))},left:{common:M("flex justify-center items-center h-full",E||P),ios:"me-2 transform transform-gpu",material:"mx-1"},title:{common:M("whitespace-nowrap leading-tight",A||D,(i||o||s)&&"opacity-0",Z?"absolute top-1/2 left-1/2 transform-gpu -translate-x-1/2 -translate-y-1/2 text-center":"text-start"),ios:M(`${p} font-semibold`,!Z&&"first:mx-2"),material:M(`${f} font-normal`,!Z&&"first:mx-4")},subtitle:{common:M("font-normal leading-none",V||z),ios:"text-2xs opacity-55",material:"text-sm opacity-85"},right:{common:M("flex justify-center items-center h-full",K||X),ios:M("transform transform-gpu",Z?"ms-2":"ms-auto"),material:"ms-auto me-1"}}},VX=(t,e)=>({bgIos:M("bg-ios-light-surface-2",e("dark:bg-ios-dark-surface-2")),bgMaterial:M("bg-md-light-surface-2",e("dark:bg-md-dark-surface-2")),textIos:M("text-black",e("dark:text-white")),textMaterial:M("text-md-light-on-surface",e("dark:text-md-dark-on-surface")),...t});function kN(){return kN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},kN.apply(this,arguments)}const uy=R.forwardRef((t,e)=>{const{component:n="div",className:r,bgClassName:a="",innerClassName:i="",leftClassName:o="",titleClassName:s="",subtitleClassName:l="",rightClassName:u="",subnavbarClassName:c="",centerTitle:d,colors:p,translucent:f=!0,outline:m,medium:y,large:x,transparent:b,fontSizeIos:v="text-[17px]",fontSizeMaterial:w="text-[16px]",titleFontSizeIos:S="text-[17px]",titleFontSizeMaterial:C="text-[22px]",titleMediumFontSizeIos:I="text-[24px]",titleMediumFontSizeMaterial:_="text-[24px]",titleLargeFontSizeIos:E="text-[34px]",titleLargeFontSizeMaterial:P="text-[28px]",scrollEl:A,left:D,title:V,subtitle:z,right:K,subnavbar:X,ios:Z,material:q,children:F,...Y}=t,Q=R.useRef(null),ne=R.useRef(0),le=R.useRef(null),de=R.useRef(null),re=R.useRef(null),he=R.useRef(null),ve=R.useRef(null),H=R.useRef(null);R.useImperativeHandle(e,()=>({el:Q.current}));const ie=n,pe=Jt({ios:Z,material:q}),ke=Je({ios:Z,material:q}),Ne=mt(),Ie={...Y},Le=VX(p,Ne),He=Qe=>{const{scrollTop:Xt}=Qe.target;if(!b&&!x&&!y){H.current&&(he.current&&(he.current.style.opacity=""),le.current&&(le.current.style.opacity=""));return}const Vt=ne.current,Ht=Math.max(Math.min(Xt/Vt,1),0);le.current.style.opacity=b?-.5+Ht*1.5:"",(y||x)&&(le.current.style.transform=`translateY(-${Ht*Vt}px)`),re.current&&(re.current.style.transform=`translateY(-${Ht*Vt}px)`,re.current.style.opacity=1-Ht*2),he.current&&(he.current.style.opacity=-.5+Ht*1.5),(y||x)&&ve.current&&(ve.current.style.transform=`translateY(-${Ht*Vt}px)`)},Me=()=>typeof A>"u"?Q.current&&Q.current.parentNode:A.current||A,it=()=>{if(!x&&!y&&!b){H.current&&(He({target:{scrollTop:0}}),H.current=!1);return}H.current=!0,re.current?ne.current=re.current.offsetHeight:ne.current=de.current.offsetHeight;const Qe=Me();Qe?(Qe.addEventListener("scroll",He),He({target:Qe})):He({target:{scrollTop:0}})},Ye=()=>{const Qe=Me();Qe&&Qe.removeEventListener("scroll",He)};R.useEffect(()=>(it(),Ye));const Ze=ke(jX({...t,centerTitle:typeof d>"u"?pe==="ios":d,translucent:f,outline:typeof m>"u"?pe==="ios":m,fontSizeIos:v,fontSizeMaterial:w,titleFontSizeIos:S,titleFontSizeMaterial:C,titleMediumFontSizeIos:I,titleMediumFontSizeMaterial:_,titleLargeFontSizeIos:E,titleLargeFontSizeMaterial:P,bgClassName:a,innerClassName:i,leftClassName:o,titleClassName:s,subtitleClassName:l,rightClassName:u,subnavbarClassName:c},Le,r),r);return G.createElement(ie,kN({ref:Q,className:Ze.base},Ie),G.createElement("div",{className:Ze.bg,ref:le}),G.createElement("div",{className:Ze.inner,ref:de},D&&G.createElement("div",{className:Ze.left},D),(V||z)&&G.createElement("div",{className:Ze.title,ref:he},V,z&&G.createElement("div",{className:Ze.subtitle},z)),K&&G.createElement("div",{className:Ze.right},K),F),(x||y)&&G.createElement("div",{className:Ze.titleContainer,ref:re},V),X&&G.createElement("div",{className:Ze.subnavbar,ref:ve},X))});uy.displayName="Navbar";function cy(){return cy=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},cy.apply(this,arguments)}const ZM=t=>{let{theme:e,...n}=t;return e==="ios"?G.createElement("svg",cy({xmlns:"http://www.w3.org/2000/svg",width:"12",height:"20",viewBox:"0 0 12 20",fill:"currentcolor"},n),G.createElement("path",{d:"M0.18261596,9.4221638 C0.21783626,9.37068075 0.25835058,9.32165682 0.30416276,9.27584463 L9.1425872,0.4374202 C9.7256776,-0.14567018 10.6691555,-0.1475686 11.2590259,0.44230183 C11.8448123,1.02808827 11.8502479,1.97240019 11.2639075,2.55874056 L3.82594417,9.9967039 L11.2578297,17.4285894 C11.8409201,18.0116798 11.8428185,18.9551577 11.252948,19.5450281 C10.6671616,20.1308146 9.7228497,20.1362501 9.13650932,19.5499097 L0.2980849,10.7114853 C-0.0545897,10.3588107 -0.0959125,9.8144953 0.18261596,9.4221638 Z"})):G.createElement("svg",cy({xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentcolor"},n),G.createElement("polygon",{points:"16 7 3.83 7 9.42 1.41 8 0 0 8 8 16 9.41 14.59 3.83 9 16 9"}))},WX=()=>({base:{common:"cursor-pointer",material:"min-w-12 k-touch-ripple-inset"},icon:"rtl:rotate-180"});function SN(){return SN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},SN.apply(this,arguments)}const UX=R.forwardRef((t,e)=>{const{component:n="a",className:r,text:a="Back",showText:i="auto",ios:o,material:s,onClick:l,children:u,...c}=t,d=R.useRef(null);R.useImperativeHandle(e,()=>({el:d.current}));const p={...c},f=Jt({ios:o,material:s}),m=Je({ios:o,material:s}),y=i==="auto"&&f==="ios"||i===!0,x=m(WX(),r);return G.createElement(Nd,SN({ref:d,component:n,className:x.base,navbar:!0},p,{onClick:l}),G.createElement("span",{className:x.icon},G.createElement(ZM,{theme:f})),y&&G.createElement("span",null,a),u)});UX.displayName="NavbarBackLink";const GX=(t,e,n)=>{const{opened:r,translucent:a}=t;return{base:{common:M(Ln("absolute",n),"z-50 transform transition-transform-opacity box-border duration-500",!r&&"-translate-y-full opacity-0 pointer-events-none transition duration-500","md:w-[568px] md:end-auto md:start-1/2 md:-ms-[256px]"),ios:M("rounded-xl px-2.5 py-2.5 start-2 end-2 top-2 shadow-lg",e.bgIos,a&&"translucent"),material:M("rounded-2xl py-5 px-4 start-4 end-4 top-4",e.bgMaterial)},content:{common:"",ios:"mt-2.5 ",material:M("mt-2")},header:{common:M("flex justify-start"),ios:"items-center",material:"items-start"},icon:{ios:M("me-2"),material:"me-4"},contentTitle:{material:M("flex flex-row items-center")},title:{ios:M("tracking-wide text-[13px] uppercase",e.titleIos),material:M("font-medium")},titleRightText:{ios:M("me-1 ms-auto text-[13px]",e.titleRightIos),material:M("ms-1 text-xs before:w-0.75 before:h-0.75 before:rounded-full before:inline-block before:align-middle before:me-1",e.titleRightMd)},button:{ios:M("me-1 ms-auto cursor-pointer"),material:M("ms-auto cursor-pointer")},deleteIcon:{ios:M("w-5 h-5",e.deleteIconIos),material:M("w-6 h-6",e.deleteIconMd)},subtitle:{ios:M("text-[15px] font-semibold",e.subtitleIos),material:M("text-sm")},text:{ios:M("text-[15px]"),material:M("text-sm",e.textMaterial)}}},HX=(t,e)=>({bgIos:M("bg-white",e("dark:bg-[#1e1e1e]")),bgMaterial:M("bg-md-light-surface-5",e("dark:bg-md-dark-surface-5")),titleIos:M("text-black",e("dark:text-white")),titleRightIos:M("text-opacity-45 text-black",e("dark:text-white dark:text-opacity-45")),titleRightMd:M("text-md-light-on-surface-variant before:bg-md-light-on-surface-variant",e("dark:text-md-dark-on-surface-variant before:dark:bg-md-dark-on-surface-variant")),subtitleIos:M("text-black ",e("dark:text-white")),textMaterial:M("text-md-light-on-surface-variant",e("dark:text-md-dark-on-surface-variant ")),deleteIconIos:M("fill-stone-400 active:fill-stone-200",e("dark:fill-stone-500 dark:active:fill-stone-700")),deleteIconMd:M("text-md-light-on-surface-variant",e("dark:text-md-dark-on-surface-variant")),...t});function dy(){return dy=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},dy.apply(this,arguments)}const qX=R.forwardRef((t,e)=>{const{component:n="div",className:r,colors:a,button:i,icon:o,title:s,titleRightText:l,subtitle:u,text:c,translucent:d=!0,opened:p,onClose:f,ios:m,material:y,children:x,...b}=t,v=R.useRef(null);R.useImperativeHandle(e,()=>({el:v.current}));const w=n,S={...b},C=Jt({ios:m,material:y}),I=Je({ios:m,material:y}),_=mt(),E=HX(a,_),P=I(GX({...t,translucent:d},E,r),r);return C==="ios"?G.createElement(w,dy({ref:v,className:P.base},S),G.createElement("div",{className:P.header},o&&G.createElement("div",{className:P.icon},o),s&&G.createElement("div",{className:P.title},s),l&&G.createElement("div",{className:P.titleRightText},l),i&&G.createElement("div",{className:P.button,role:"button",tabIndex:"0",onClick:f},G.createElement(af,{theme:C,className:P.deleteIcon}))),G.createElement("div",{className:P.content},u&&G.createElement("div",{className:P.subtitle},u),c&&G.createElement("div",{className:P.text},c),x)):G.createElement(w,dy({ref:v,className:P.base},S),G.createElement("div",{className:P.header},o&&G.createElement("div",{className:P.icon},o),G.createElement("div",{className:P.contentWrapper},G.createElement("div",{className:P.contentTitle},s&&G.createElement("div",{className:P.title},s),l&&G.createElement("div",{className:P.titleRightText},l)),G.createElement("div",{className:P.content},u&&G.createElement("div",{className:P.subtitle},u),c&&G.createElement("div",{className:P.text},c),x)),i&&G.createElement("div",{className:P.button,role:"button",tabIndex:"0",onClick:f},G.createElement(af,{theme:C,className:P.deleteIcon}))))});qX.displayName="Notification";const KX=(t,e,n)=>({base:{common:M("h-full w-full left-0 top-0 overflow-auto",Ln("absolute",n)),ios:e.bgIos,material:e.bgMaterial}}),XX=function(t,e){return t===void 0&&(t={}),{bgIos:M("bg-ios-light-surface",e("dark:bg-ios-dark-surface")),bgMaterial:M("bg-md-light-surface",e("dark:bg-md-dark-surface")),...t}};function CN(){return CN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},CN.apply(this,arguments)}const py=R.forwardRef((t,e)=>{const{component:n="div",className:r,colors:a,ios:i,material:o,children:s,...l}=t,u=R.useRef(null);R.useImperativeHandle(e,()=>({el:u.current}));const c=n,d={...l},p=Je({ios:i,material:o}),f=mt(),m=XX(a,f),y=p(KX(t,m,r),r);return G.createElement(c,CN({ref:u,className:y.base},d),s)});py.displayName="Page";const YX=(t,e,n)=>{const{size:r,floating:a}=t;return{base:{common:M("transition-transform transform duration-400 z-40 max-w-full overflow-hidden",a?"top-2-safe bottom-2-safe !h-auto":"top-0 max-h-full",e.bg,Ln("fixed",n),r),ios:"",material:"ease-material-in"},left:{common:M("no-safe-areas-right",a?"right-full -mr-2 rounded-2xl":"right-full"),material:M(!a&&"rounded-r-2xl"),opened:"translate-x-full",closed:"-translate-x-2"},right:{common:M("no-safe-areas-left",a?"left-full -ml-2 rounded-2xl":"left-full"),material:M(!a&&"rounded-l-2xl"),opened:"-translate-x-full",closed:"translate-x-2"},backdrop:{common:"fixed z-40 w-full h-full left-0 top-0 bg-black bg-opacity-50 duration-400",opened:"",closed:"opacity-0 pointer-events-none"}}},QX=function(t,e){return t===void 0&&(t={}),{bg:M("bg-white",e("dark:bg-black")),...t}};function NN(){return NN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},NN.apply(this,arguments)}const JM=R.forwardRef((t,e)=>{const{component:n="div",className:r,colors:a,size:i="w-72 h-screen",side:o="left",opened:s,backdrop:l=!0,floating:u=!1,onBackdropClick:c,ios:d,material:p,children:f,...m}=t,y=R.useRef(null);R.useImperativeHandle(e,()=>({el:y.current}));const x=s?"opened":"closed",b=n,v={...m},w=Je({ios:d,material:p}),S=mt(),C=QX(a,S),I=w(YX({...t,size:i,floating:u},C,r),r),_=M(I.base,I[o][x]);return G.createElement(G.Fragment,null,l&&G.createElement("div",{className:I.backdrop[x],onClick:c}),G.createElement(b,NN({ref:y,className:_},v),f))});JM.displayName="Panel";const ZX=t=>{let{popoverEl:e,targetEl:n,angleEl:r,needsAngle:a,targetX:i,targetY:o,targetWidth:s=0,targetHeight:l=0,theme:u}=t;n.current?n=n.current:n.value?n=n.value:n.el?n=n.el:n.$el&&(n=n.$el),typeof n=="string"&&(n=document.querySelector(n));let c=document.body.offsetWidth,d=document.body.offsetHeight;c===0&&(c=window.innerWidth),d===0&&(d=window.innerHeight);const[p,f]=[e.offsetWidth,e.offsetHeight];let m=0,y,x,b="";a&&(m=r.offsetWidth/2);let v,w;const S=window.getComputedStyle(n);let C=parseInt(S.getPropertyValue("--k-safe-area-top"),10)||0,I=parseInt(S.getPropertyValue("--k-safe-area-left"),10)||0,_=parseInt(S.getPropertyValue("--k-safe-area-right"),10)||0;if(Number.isNaN(C)&&(C=0),Number.isNaN(I)&&(I=0),Number.isNaN(_)&&(_=0),n){s=n.offsetWidth,l=n.offsetHeight;const X=n.getBoundingClientRect();v=X.left,w=X.top}else typeof i<"u"&&o!=="undefined"&&(v=i,w=o);let[E,P,A]=[0,0,0];const D=u==="ios"?13:23;let V="top";f+m<w-C?P=w-f-m:f+m<d-w-l?(V="bottom",P=w+l+m):(V="middle",P=l/2+w-f/2,A=P,P=Math.max(5,Math.min(P,d-f-5)),A-=P),V==="top"||V==="bottom"?(E=s/2+v-p/2,A=E,E=Math.max(5,Math.min(E,c-p-5)),I&&(E=Math.max(E,I)),_&&E+p>c-5-_&&(E=c-5-_-p),V==="top"&&(b="bottom"),V==="bottom"&&(b="top"),A-=E,y=p/2-m+A,y=Math.max(Math.min(y,p-m*2-D),D)):V==="middle"&&(E=v-p-m,b="right",(E<5||E+p+_>c||E<I)&&(E<5&&(E=v+s+m),E+p+_>c&&(E=c-p-5-_),E<I&&(E=I),b="left"),x=f/2-m+A,x=Math.max(Math.min(x,f-m*2-D),D));const z=V,K=E<v?"left":"right";return{set:!0,angleTop:typeof x>"u"?void 0:`${x}px`,angleLeft:typeof y>"u"?void 0:`${y}px`,anglePosition:b,popoverTop:`${P}px`,popoverLeft:`${E}px`,popoverPosition:`${z}-${K}`}},JX=(t,e,n)=>{const{size:r,translucent:a,angleClassName:i,angleClass:o}=t;return{base:{common:M("transition-transform-opacity z-40 no-safe-areas",Ln("fixed",n),r),ios:"duration-300",material:"duration-400 ease-material-in",opened:"",closed:{common:"opacity-0 pointer-events-none",ios:"",material:"scale-x-90 scale-y-75"}},inner:{common:M("overflow-hidden relative"),ios:M("rounded-xl",a&&"translucent",e.bgIos),material:M("rounded-[1.75rem]",e.bgMaterial)},angleWrap:{common:M(i||o||"","pointer-events-none"),ios:M("absolute w-6.5 h-6.5 z-50 overflow-hidden",a&&"opacity-80"),material:M("absolute w-6.5 h-6.5 z-50 overflow-hidden"),bottom:"top-full",top:"bottom-full",left:"right-full",right:"left-full"},angleArrow:{common:M("absolute rounded w-full h-full transform rotate-45"),ios:e.bgIos,material:e.bgMaterial,bottom:"-top-4.75",top:"top-4.75",left:"left-4.75",right:"-left-4.75"},backdrop:{common:"fixed z-40 w-full h-full left-0 top-0 bg-black bg-opacity-50 duration-300",opened:"",closed:"opacity-0 pointer-events-none"}}},eY=function(t,e){return t===void 0&&(t={}),{bgIos:M("bg-ios-light-surface-3",e("dark:bg-ios-dark-surface-3")),bgMaterial:M("bg-md-light-surface-3",e("dark:bg-md-dark-surface-3")),...t}};function TN(){return TN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},TN.apply(this,arguments)}const tY=R.forwardRef((t,e)=>{const{component:n="div",className:r,angle:a=!0,angleClassName:i="",colors:o,size:s="w-64",opened:l,backdrop:u=!0,onBackdropClick:c,target:d,targetX:p,targetY:f,targetWidth:m,targetHeight:y,translucent:x=!0,ios:b,material:v,children:w,style:S={},...C}=t,I=R.useRef(null),_=R.useRef(null),[E,P]=R.useState({set:!1,angleTop:0,angleLeft:0,anglePosition:"bottom",popoverTop:0,popoverLeft:0,popoverPosition:"top-left"});R.useImperativeHandle(e,()=>({el:I.current}));const A=l?"opened":"closed",D=n,V={...C},z=Jt({ios:b,material:v}),K=Je({ios:b,material:v}),X=mt(),Z=eY(o,X),q=K(JX({...t,size:s,angleClassName:i,translucent:x},Z,r),r),F=()=>{!d||!I.current||!l||P(ZX({popoverEl:I.current,targetEl:d,angleEl:_.current,needsAngle:a,targetX:p,targetY:f,targetHeight:y,targetWidth:m,theme:z}))},Y=()=>{typeof window>"u"||window.addEventListener("resize",F)},Q=()=>{typeof window>"u"||window.removeEventListener("resize",F)};R.useEffect(()=>(Y(),()=>Q())),R.useEffect(()=>{F()},[l]);const ne=E.set?{...S||{},left:E.popoverLeft,top:E.popoverTop}:S,le=E.set?{left:E.angleLeft,top:E.angleTop}:void 0,de={"top-right":"origin-bottom-left","top-left":"origin-bottom-right","middle-left":"origin-right","middle-right":"origin-left","bottom-right":"origin-top-left","bottom-left":"origin-top-right"},re=M(q.base[A],z==="material"&&de[E.popoverPosition]);return G.createElement(G.Fragment,null,u&&G.createElement("div",{className:q.backdrop[A],onClick:c}),G.createElement(D,TN({ref:I,className:re,style:ne},V),a&&G.createElement("div",{ref:_,style:le,className:q.angleWrap[E.anglePosition]},G.createElement("div",{className:q.angleArrow[E.anglePosition]})),G.createElement("div",{className:q.inner},w)))});tY.displayName="Popover";const nY=(t,e,n)=>{const{size:r}=t;return{base:{common:M("left-1/2 top-1/2 transition-transform transform -translate-x-1/2 z-40 max-w-full max-h-full overflow-hidden md:no-safe-areas",e.bg,Ln("fixed",n),r),ios:"duration-400 md:rounded-lg",material:" md:rounded-[1.75rem]",opened:{common:"-translate-y-1/2",material:M("ease-material-in-popup duration-[600ms]")},closed:{common:"translate-y-full",material:"duration-400"}},backdrop:{common:"fixed z-40 w-full h-full left-0 top-0 bg-black bg-opacity-50 duration-400",opened:"",closed:"opacity-0 pointer-events-none"}}},rY=function(t,e){return t===void 0&&(t={}),{bg:M("bg-white",e("dark:bg-black")),...t}};function IN(){return IN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},IN.apply(this,arguments)}const e6=R.forwardRef((t,e)=>{const{component:n="div",className:r,colors:a,size:i="w-screen h-screen md:w-160 md:h-160",opened:o,backdrop:s=!0,onBackdropClick:l,ios:u,material:c,children:d,...p}=t,f=R.useRef(null);R.useImperativeHandle(e,()=>({el:f.current}));const m=o?"opened":"closed",y=n,x={...p},b=Je({ios:u,material:c}),v=mt(),w=rY(a,v),S=b(nY({...t,size:i},w,r),r);return G.createElement(G.Fragment,null,s&&G.createElement("div",{className:S.backdrop[m],onClick:l}),G.createElement(y,IN({ref:f,className:S.base[m]},x),d))});e6.displayName="Popup";function EN(){return EN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},EN.apply(this,arguments)}const aY=t=>G.createElement("svg",EN({xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20",fill:"currentcolor"},t),G.createElement("path",{d:"M10,0 C10.5522847,0 11,0.44771525 11,1 L11,6 C11,6.55228475 10.5522847,7 10,7 C9.44771525,7 9,6.55228475 9,6 L9,1 C9,0.44771525 9.44771525,0 10,0 Z"}),G.createElement("path",{d:"M10,13 C10.5522847,13 11,13.4477153 11,14 L11,19 C11,19.5522847 10.5522847,20 10,20 C9.44771525,20 9,19.5522847 9,19 L9,14 C9,13.4477153 9.44771525,13 10,13 Z",opacity:".64"}),G.createElement("path",{d:"M13,10 C13,9.44771525 13.4477153,9 14,9 L19,9 C19.5522847,9 20,9.44771525 20,10 C20,10.5522847 19.5522847,11 19,11 L14,11 C13.4477153,11 13,10.5522847 13,10 Z",opacity:".82"}),G.createElement("path",{d:"M-3.8285687e-16,10 C-3.8285687e-16,9.44771525 0.44771525,9 1,9 L6,9 C6.55228475,9 7,9.44771525 7,10 C7,10.5522847 6.55228475,11 6,11 L1,11 C0.44771525,11 -3.8285687e-16,10.5522847 -3.8285687e-16,10 Z",opacity:".46"}),G.createElement("path",{d:"M2.92912627,2.92912627 C3.31965056,2.53860197 3.95281554,2.53860197 4.34333983,2.92912627 L7.87887373,6.46466017 C8.26939803,6.85518446 8.26939803,7.48834944 7.87887373,7.87887373 C7.48834944,8.26939803 6.85518446,8.26939803 6.46466017,7.87887373 L2.92912627,4.34333983 C2.53860197,3.95281554 2.53860197,3.31965056 2.92912627,2.92912627 Z",opacity:".37"}),G.createElement("path",{d:"M12.1211263,12.1211263 C12.5116506,11.730602 13.1448155,11.730602 13.5353398,12.1211263 L17.0708737,15.6566602 C17.461398,16.0471845 17.461398,16.6803494 17.0708737,17.0708737 C16.6803494,17.461398 16.0471845,17.461398 15.6566602,17.0708737 L12.1211263,13.5353398 C11.730602,13.1448155 11.730602,12.5116506 12.1211263,12.1211263 Z",opacity:".73"}),G.createElement("path",{d:"M12.1211263,7.87887373 C11.730602,7.48834944 11.730602,6.85518446 12.1211263,6.46466017 L15.6566602,2.92912627 C16.0471845,2.53860197 16.6803494,2.53860197 17.0708737,2.92912627 C17.461398,3.31965056 17.461398,3.95281554 17.0708737,4.34333983 L13.5353398,7.87887373 C13.1448155,8.26939803 12.5116506,8.26939803 12.1211263,7.87887373 Z",opacity:".91"}),G.createElement("path",{d:"M2.92912627,17.0708737 C2.53860197,16.6803494 2.53860197,16.0471845 2.92912627,15.6566602 L6.46466017,12.1211263 C6.85518446,11.730602 7.48834944,11.730602 7.87887373,12.1211263 C8.26939803,12.5116506 8.26939803,13.1448155 7.87887373,13.5353398 L4.34333983,17.0708737 C3.95281554,17.461398 3.31965056,17.461398 2.92912627,17.0708737 Z",opacity:".55"}));function _N(){return _N=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},_N.apply(this,arguments)}const iY=t=>G.createElement("svg",_N({viewBox:"0 0 36 36"},t,{fill:"none",stroke:"currentcolor"}),G.createElement("circle",{cx:"18",cy:"18",r:"16"})),oY=(t,e,n)=>{const{size:r}=t;return{base:{common:M(n==="ios"?"k-ios-preloader":"k-material-preloader",`inline-block ${r}`),ios:e.iconIos,material:`stroke-4 ${e.iconMaterial}`},inner:{common:"block w-full h-full"}}},sY=function(t,e){return t===void 0&&(t={}),{iconIos:"text-primary",iconMaterial:M("text-md-light-primary",e("dark:text-md-dark-primary")),...t}};function ON(){return ON=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},ON.apply(this,arguments)}const lY=R.forwardRef((t,e)=>{const{component:n="span",className:r,colors:a,size:i="w-8 h-8",ios:o,material:s,children:l,...u}=t,c=R.useRef(null);R.useImperativeHandle(e,()=>({el:c.current}));const d=n,p={...u},f=Jt({ios:o,material:s}),m=Je({ios:o,material:s}),y=mt(),x=sY(a,y),b=f==="ios"?aY:iY,v=m(oY({...t,size:i},x,f),r);return G.createElement(d,ON({ref:c,className:v.base},p),G.createElement("span",{className:v.inner},G.createElement(b,{className:"w-full h-full"})),l)});lY.displayName="Preloader";const uY=t=>({base:{common:"block h-1 bg-opacity-30 dark:bg-opacity-30 overflow-hidden rtl:rotate-180",ios:"bg-black rounded-full",material:t.bgMaterial},inner:{common:"block duration-200 w-full h-full",ios:t.bgIos,material:t.bgMaterial}}),cY=function(t,e){return t===void 0&&(t={}),{bgIos:"bg-primary",bgMaterial:M("bg-md-light-primary",e("dark:bg-md-dark-primary")),...t}};function $N(){return $N=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},$N.apply(this,arguments)}const dY=R.forwardRef((t,e)=>{const{component:n="span",className:r,colors:a,ios:i,material:o,progress:s=0,children:l,...u}=t,c=R.useRef(null);R.useImperativeHandle(e,()=>({el:c.current}));const d=n,p={...u},f=Je({ios:i,material:o}),m=mt(),y=cY(a,m),x=f(uY(y),r);return G.createElement(d,$N({ref:c,className:x.base},p),G.createElement("span",{className:x.inner,style:{transform:`translateX(-${100-s/1*100}%)`}}),l)});dY.displayName="Progressbar";const pY=(t,e,n,r)=>({base:M("cursor-pointer inline-flex align-middle",Ln("relative",n),r("dark:touch-ripple-white")),iconWrap:{common:"flex items-center justify-center rounded-full",ios:"w-5.5 h-5.5 border",material:"w-5 h-5 border-2",notChecked:{ios:e.borderIos,material:e.borderMaterial},checked:{ios:e.borderCheckedIos,material:e.borderCheckedMaterial}},icon:{ios:"text-primary",material:`w-3 h-3 rounded-full ${e.bgCheckedMaterial}`,notChecked:"opacity-0",checked:"opacity-100"},indeterminateIcon:{common:"bg-white w-3/4",ios:"h-0.25",material:"h-0.5"},input:{common:"hidden"}}),hY=function(t,e){return t===void 0&&(t={}),{borderIos:M("border-black border-opacity-30",e("dark:border-white dark:border-opacity-30")),borderMaterial:M("border-md-light-outline",e("dark:border-md-dark-outline")),bgCheckedIos:"bg-primary",bgCheckedMaterial:M("bg-md-light-primary",e("dark:bg-md-dark-primary")),borderCheckedIos:"border-primary",borderCheckedMaterial:M("border-md-light-primary",e("dark:border-md-dark-primary")),...t}};function RN(){return RN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},RN.apply(this,arguments)}const fY=R.forwardRef((t,e)=>{const{component:n="label",className:r,colors:a,defaultChecked:i,checked:o,name:s,value:l,disabled:u,readOnly:c,onChange:d,ios:p,material:f,touchRipple:m=!0,children:y,...x}=t,b=R.useRef(null);R.useImperativeHandle(e,()=>({el:b.current}));const v=n,w={...x},S=Jt({ios:p,material:f}),C=Je({ios:p,material:f}),I=mt();eo(b,S==="material"&&m);const _=hY(a,I),E=o||i&&!d?"checked":"notChecked",P=C(pY(t,_,r,I),r);return G.createElement(v,RN({ref:b,className:P.base},w),G.createElement("input",{type:"radio",name:s,value:l,disabled:u,readOnly:c,checked:o,defaultChecked:i,onChange:d,className:P.input}),G.createElement("i",{className:P.iconWrap[E]},S==="ios"?G.createElement(XM,{className:P.icon[E]}):G.createElement("span",{className:P.icon[E]})),y)});fY.displayName="Radio";const gY=(t,e,n)=>({base:{common:"block relative select-none w-full self-center touch-pan-y",ios:"h-7",material:"h-5"},trackBg:{common:M("absolute top-1/2 left-0 w-full transform -translate-y-1/2 bg-black bg-opacity-20",n("dark:bg-white dark:bg-opacity-20")),ios:"h-1 rounded-full",material:"h-0.5"},trackValue:{common:"absolute top-1/2 start-0 w-full transform -translate-y-1/2",ios:`h-1 rounded-full ${e.valueBgIos}`,material:`h-0.5 ${e.valueBgMaterial}`},input:{common:"appearance-none w-full bg-transparent cursor-pointer block focus:outline-none relative",ios:"h-7",material:"h-5"},inputThumb:{common:"range-thumb:relative range-thumb:appearance-none range-thumb:rounded-full range-thumb:border-none",ios:`range-thumb:w-7 range-thumb:h-7 range-thumb:-mt-3.5 ${e.thumbBgIos} range-thumb:shadow-ios-toggle`,material:`range-thumb:w-3 range-thumb:h-3 ${e.thumbBgMaterial} range-thumb:-mt-1.5 range-thumb:transform range-thumb:duration-200 active:range-thumb:scale-150`},inputTrack:{common:"range-track:appearance-none range-track:h-px"}}),mY=function(t,e){return t===void 0&&(t={}),{valueBgIos:"bg-primary",valueBgMaterial:M("bg-md-light-primary",e("dark:bg-md-dark-primary")),thumbBgIos:"range-thumb:bg-white",thumbBgMaterial:M("range-thumb:bg-md-light-primary",e("dark:range-thumb:bg-md-dark-primary")),...t}};function MN(){return MN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},MN.apply(this,arguments)}const hy=R.forwardRef((t,e)=>{const{component:n="div",className:r,colors:a,ios:i,material:o,children:s,inputId:l,name:u,value:c=void 0,defaultValue:d,readOnly:p,disabled:f,step:m=1,min:y=0,max:x=100,onInput:b,onChange:v,onFocus:w,onBlur:S,...C}=t,I=R.useRef(null);R.useImperativeHandle(e,()=>({el:I.current}));const _=n,E={...C},P=Je({ios:i,material:o}),A=mt(),D=mY(a,A),V=P(gY(t,D,A),r),z=((c||0)-y)/(x-y)*100;return G.createElement(_,MN({ref:I,className:V.base},E),G.createElement("span",{className:V.trackBg}),G.createElement("span",{className:V.trackValue,style:{width:`${z}%`}}),G.createElement("input",{className:M(V.input,V.inputThumb,V.inputTrack),type:"range",id:l,name:u,min:y,max:x,step:m,value:c,defaultValue:d,readOnly:p,disabled:f,onInput:b,onChange:v,onFocus:w,onBlur:S}))});hy.displayName="Range";const yY=(t,e,n)=>{let{isEnabled:r,darkClasses:a}=n;return{base:{common:"relative flex overflow-hidden items-center",ios:"px-2 w-full",material:"px-0 py-2 -mx-2 w-[calc(100%+32px)]"},inner:{common:"w-full shrink-1 relative",ios:"transition-all duration-300"},searchIconWrap:{common:"absolute inset-y-0 flex items-center z-40",ios:"start-2",material:"start-4"},clearButton:{common:"absolute justify-center inset-y-0 flex items-center z-40 cursor-pointer end-0",ios:"w-8 h-8",material:"w-12 h-12"},input:{common:"block appearance-none  w-full py-2  focus:outline-none z-30",ios:M("h-8 bg-black/10 pl-7 pr-7 rounded-lg text-base",a("dark:placeholder-white dark:placeholder-opacity-30 dark:bg-white/10"),e.placeholderIos,e.inputBgIos),material:M("h-12 ps-12 pe-4 rounded-full",e.placeholderMaterial,e.inputBgMaterial)},deleteIcon:{common:"",ios:"w-3.5 h-3.5 opacity-45",material:"w-6 h-6 active:opacity-20"},searchIcon:{common:"",ios:M("w-4 h-4 opacity-45"),material:M("w-5 h-5 z-30",r?"opacity-0 transform rotate-90 scale-50 transition-transform-opacity  duration-400 ":"block transform transition-transform-opacity scale-100 rotate-0 duration-400")},cancelButton:{ios:M("ps-2 flex items-center h-8 cursor-pointer bg-transparent text-primary shrink-0 z-40 transition-all duration-300 active:opacity-30",r?"":"opacity-0"),material:M("absolute left-4 cursor-pointer",r?"z-40 transform scale-100 rotate-0 transition-transform-opacity  duration-400":"opacity-0 transform -rotate-90 scale-50 transition-transform-opacity duration-400")}}},bY=function(t,e){return t===void 0&&(t={}),{inputBgIos:"",inputBgMaterial:M("bg-md-light-secondary-container",e("dark:bg-md-dark-secondary-container")),placeholderIos:"",placeholderMaterial:M("placeholder-md-light-on-surface-variant",e("dark:placeholder-md-dark-on-surface-variant")),...t}};function fy(){return fy=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},fy.apply(this,arguments)}const vY=t=>{let{theme:e,...n}=t;return e==="ios"?G.createElement("svg",fy({xmlns:"http://www.w3.org/2000/svg",width:"13",height:"13",viewBox:"0 0 56 56",fill:"currentcolor"},n),G.createElement("path",{d:"M 23.9570 41.7695 C 27.8476 41.7695 31.4804 40.5039 34.4336 38.3945 L 45.5429 49.5039 C 46.0585 50.0195 46.7382 50.2774 47.4414 50.2774 C 48.9648 50.2774 50.0664 49.1055 50.0664 47.6055 C 50.0664 46.9023 49.8322 46.2461 49.3162 45.7305 L 38.2773 34.6679 C 40.5976 31.6211 41.9804 27.8476 41.9804 23.7461 C 41.9804 13.8320 33.8710 5.7226 23.9570 5.7226 C 14.0195 5.7226 5.9336 13.8320 5.9336 23.7461 C 5.9336 33.6601 14.0195 41.7695 23.9570 41.7695 Z M 23.9570 37.8789 C 16.1992 37.8789 9.8242 31.4805 9.8242 23.7461 C 9.8242 16.0117 16.1992 9.6133 23.9570 9.6133 C 31.6914 9.6133 38.0898 16.0117 38.0898 23.7461 C 38.0898 31.4805 31.6914 37.8789 23.9570 37.8789 Z"})):G.createElement("svg",fy({xmlns:"http://www.w3.org/2000/svg",width:"48",height:"48",viewBox:"0 0 56 56",fill:"currentcolor"},n),G.createElement("path",{d:"M 23.9570 41.7695 C 27.8476 41.7695 31.4804 40.5039 34.4336 38.3945 L 45.5429 49.5039 C 46.0585 50.0195 46.7382 50.2774 47.4414 50.2774 C 48.9648 50.2774 50.0664 49.1055 50.0664 47.6055 C 50.0664 46.9023 49.8322 46.2461 49.3162 45.7305 L 38.2773 34.6679 C 40.5976 31.6211 41.9804 27.8476 41.9804 23.7461 C 41.9804 13.8320 33.8710 5.7226 23.9570 5.7226 C 14.0195 5.7226 5.9336 13.8320 5.9336 23.7461 C 5.9336 33.6601 14.0195 41.7695 23.9570 41.7695 Z M 23.9570 37.8789 C 16.1992 37.8789 9.8242 31.4805 9.8242 23.7461 C 9.8242 16.0117 16.1992 9.6133 23.9570 9.6133 C 31.6914 9.6133 38.0898 16.0117 38.0898 23.7461 C 38.0898 31.4805 31.6914 37.8789 23.9570 37.8789 Z"}))};function AN(){return AN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},AN.apply(this,arguments)}const xY=R.forwardRef((t,e)=>{const{component:n="div",className:r,colors:a,placeholder:i="Search",value:o,inputId:s,inputStyle:l,disableButton:u=!1,disableButtonText:c="Cancel",clearButton:d=!0,onInput:p,onChange:f,onFocus:m,onBlur:y,onClear:x,onDisable:b,ios:v,material:w,...S}=t,C=R.useRef(null),I=R.useRef(null),_=R.useRef(null),[E,P]=R.useState(0),A=R.useRef(null),D=R.useRef(!1);R.useImperativeHandle(e,()=>({el:I.current,searchEl:C.current}));const[V,z]=R.useState(!1),K=Jt({ios:v,material:w}),X=Je({ios:v,material:w}),Z=mt(),q=bY(a,Z),F=pe=>{p&&p(pe)},Y=pe=>{f&&f(pe)},Q=pe=>{z(!0),m&&m(pe)},ne=pe=>{y&&y(pe)},le=()=>{o||(A.current=setTimeout(()=>{z(!1)}))},de=()=>{clearTimeout(A.current)},re=pe=>{pe.preventDefault(),z(!1),C.current&&C.current.blur(),b&&b(),x&&x()};R.useEffect(()=>{_.current&&P(_.current.offsetWidth),requestAnimationFrame(()=>{requestAnimationFrame(()=>{D.current=!0})})},[]);const he=X(yY({...t},q,{isEnabled:V,darkClasses:Z})),ve=K==="ios"?G.createElement("button",{type:"button",ref:_,style:{marginRight:V?0:`-${E}px`,transitionDuration:D.current?"":"0ms"},className:he.cancelButton,onClick:re,onPointerDown:pe=>pe.preventDefault()},c):G.createElement(ZM,{theme:K,onClick:re,className:M(he.cancelButton),onPointerDown:pe=>pe.preventDefault()}),H=n,ie={...S};return G.createElement(H,AN({ref:I,className:he.base},ie,{onBlurCapture:le,onFocusCapture:de}),G.createElement("div",{className:he.inner},G.createElement("span",{className:he.searchIconWrap},G.createElement(vY,{ios:v,material:w,className:he.searchIcon})),G.createElement("input",{id:s,ref:C,className:M(he.input),style:l,type:"text",name:"search",placeholder:i,value:o,onInput:F,onChange:Y,onFocus:Q,onBlur:ne}),o&&d&&G.createElement("button",{className:he.clearButton,onClick:x,type:"button"},G.createElement(af,{theme:K,className:he.deleteIcon}))),u&&ve)});xY.displayName="Searchbar";const wY=(t,e,n)=>{const{outline:r,rounded:a}=t;return{base:{common:"flex justify-center items-center overflow-hidden w-full",square:{ios:"rounded",material:"rounded-lg"},rounded:"rounded-full"},raised:r?"shadow":"shadow divide-x divide-black divide-opacity-10 rtl:divide-x-reverse",outline:{common:"",ios:`${e.borderIos} border-2`,material:`${e.borderMaterial} border`},outlineInner:{common:"-m-0.5 flex w-full justify-center items-center rtl:divide-x-reverse",ios:`divide-x-2 ${e.divideIos}`,material:`divide-x ${e.divideMaterial}`},strong:{common:M("p-0.5 space-x-1 relative"),ios:e.strongBgIos,material:e.strongBgMaterial},strongHighlight:{common:M("absolute start-0.5 top-0.5 bottom-0.5 !ms-0 pointer-events-none duration-200",a&&"rounded-full","bg-white shadow",n("dark:bg-opacity-15 dark:touch-ripple-white")),ios:M(!a&&"rounded"),material:M(!a&&"rounded-md")}}},kY=function(t,e){return t===void 0&&(t={}),{strongBgIos:M("bg-black bg-opacity-5",e("dark:bg-white dark:bg-opacity-10")),strongBgMaterial:M("bg-md-light-surface-variant",e("dark:bg-md-dark-surface-variant")),borderIos:"border-primary",borderMaterial:M("border-md-light-outline",e("dark:border-md-dark-outline")),divideIos:"divide-primary",divideMaterial:M("divide-md-light-outline",e("dark:divide-md-dark-outline")),...t}};function PN(){return PN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},PN.apply(this,arguments)}const SY=R.forwardRef((t,e)=>{const{component:n="div",className:r,colors:a,ios:i,material:o,raised:s,outline:l,strong:u,rounded:c,children:d,...p}=t,f=R.useRef(null),m=R.useRef(null);R.useImperativeHandle(e,()=>({el:f.current}));const[y,x]=R.useState({transform:"",width:""}),b=n,v={...p},w=Je({ios:i,material:o}),S=mt(),C=kY(a,S),I=w(wY(t,C,S)),_=M(c?I.base.rounded:I.base.square,s&&I.raised,l&&I.outline,u&&I.strong,r);return R.useEffect(()=>{if(u&&m.current){const E=m.current.parentElement,P=E.children.length-1,A=[...E.children].indexOf(E.querySelector(".k-segmented-strong-button-active")),D="4px";x({...y,width:`calc((100% - 2px * 2 - ${D} * (${P} - 1)) / ${P})`,transform:`translateX(calc((${A} * 100% + ${A} * ${D}) * var(--k-rtl-reverse)))`})}},[d]),G.createElement(b,PN({ref:f,className:_},v),l?G.createElement("span",{className:I.outlineInner},d):d,u&&G.createElement("span",{ref:m,className:I.strongHighlight,style:y}))});SY.displayName="Segmented";function LN(){return LN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},LN.apply(this,arguments)}const CY=R.forwardRef((t,e)=>{const{active:n,children:r,outline:a,strong:i,clear:o,rounded:s,...l}=t,u=R.useRef(null);return R.useImperativeHandle(e,()=>({el:u.current})),G.createElement(jn,LN({ref:u,segmented:!0,segmentedActive:n,segmentedStrong:i,rounded:s&&i},l),r)});CY.displayName="SegmentedButton";const NY=(t,e,n)=>({base:{common:M("left-0 top-full transition-transform duration-400 z-40 overflow-hidden",Ln("fixed",n)),ios:"",material:`rounded-t-2xl ease-material-in ${e.bgIos}`,opened:`-translate-y-full ${e.bgMaterial}`,closed:""},backdrop:{common:"fixed z-40 w-full h-full left-0 top-0 bg-black bg-opacity-50 duration-400",opened:"",closed:"opacity-0 pointer-events-none"}}),TY=function(t,e){return t===void 0&&(t={}),{bgIos:M("bg-white",e("dark:bg-black")),bgMaterial:M("bg-md-light-surface",e("dark:bg-md-dark-surface")),...t}};function DN(){return DN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},DN.apply(this,arguments)}const IY=R.forwardRef((t,e)=>{const{component:n="div",className:r,colors:a,opened:i,backdrop:o=!0,onBackdropClick:s,ios:l,material:u,children:c,...d}=t,p=R.useRef(null);R.useImperativeHandle(e,()=>({el:p.current}));const f=i?"opened":"closed",m=n,y={...d},x=Je({ios:l,material:u}),b=mt(),v=TY(a,b),w=x(NY(t,v,r),r);return G.createElement(G.Fragment,null,o&&G.createElement("div",{className:w.backdrop[f],onClick:s}),G.createElement(m,DN({ref:p,className:w.base[f]},y),c))});IY.displayName="Sheet";const EY=(t,e)=>{const{buttonsOnly:n}=t;return{base:`${e.text} inline-flex items-stretch`,raised:"shadow",size:{small:{ios:"h-6",material:"h-8"},medium:{ios:"h-7",material:"h-10"},large:{ios:"h-11",material:"h-12"}},shape:{square:{ios:"rounded",material:"rounded-lg"},rounded:"rounded-full"},button:{common:"relative flex items-center justify-center w-10 cursor-pointer overflow-hidden z-10 select-none"},buttonLeftShape:{square:{ios:"rounded-s",material:"rounded-s-lg"},rounded:"rounded-s-full"},buttonRightShape:{square:{ios:"rounded-e",material:"rounded-e-lg"},rounded:"rounded-e-full"},buttonStyle:{fill:{common:M(e.fillTouchRipple,n&&"first:border-r border-black border-opacity-10 rtl:first:border-l rtl:first:border-r-0"),ios:M(e.fillBgIos,e.fillTextIos,e.fillActiveBgIos),material:M(e.fillBgMaterial,e.fillTextMaterial,e.fillActiveBgMaterial)},outline:{common:M(e.touchRipple,"active:bg-opacity-15",n&&"first:border-r-0 rtl:last:border-r-0"),ios:M("border-2",e.textIos,e.activeBgIos,e.outlineBorderIos,n&&"rtl:first:border-r-2"),material:M("border",e.textMaterial,e.activeBgMaterial,e.outlineBorderMaterial,n&&"rtl:first:border-r")},clear:{common:`${e.touchRipple} active:bg-opacity-15 last:border-l rtl:last:border-l-0 rtl:first:border-l border-black border-opacity-10`,ios:M(e.textIos,e.activeBgIos),material:M(e.textMaterial,e.activeBgMaterial)}},input:{common:"focus:outline-none text-center appearance-none bg-transparent"},value:{common:"w-11 flex items-center justify-center font-medium",ios:`text-base ${e.textIos}`,material:`text-sm ${e.textMaterial}`,fill:{common:"",ios:`border-t-2 border-b-2 ${e.outlineBorderIos}`,material:`border-t border-b ${e.outlineBorderMaterial}`},outline:{common:"",ios:`border-t-2 border-b-2 ${e.outlineBorderIos}`,material:`border-t border-b ${e.outlineBorderMaterial}`},clear:"border-l border-black border-opacity-10"},hBar:"w-4 h-0.5 bg-current block",vBar:"w-0.5 h-4 bg-current block absolute inset-1/2 transform -translate-x-1/2 rtl:translate-x-1/2 -translate-y-1/2"}},_Y=function(t,e){return t===void 0&&(t={}),{activeBgIos:"active:bg-primary",activeBgMaterial:"",textIos:"text-primary",textMaterial:M("text-md-light-primary","dark:text-md-dark-primary"),fillTextIos:M("text-white"),fillTextMaterial:M("text-md-light-on-primary",e("dark:text-md-dark-on-primary")),fillBgIos:"bg-primary",fillBgMaterial:M("bg-md-light-primary",e("dark:bg-md-dark-primary")),fillActiveBgIos:"active:bg-ios-primary-shade",fillActiveBgMaterial:"",fillTouchRipple:M("touch-ripple-white","dark:touch-ripple-primary"),outlineBorderIos:"border-primary",outlineBorderMaterial:M("border-md-light-outline",e("dark:border-md-dark-outline")),touchRipple:"touch-ripple-primary",...t}};function FN(){return FN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},FN.apply(this,arguments)}const OY=R.forwardRef((t,e)=>{const{component:n="span",className:r,colors:a,value:i=0,defaultValue:o,input:s=!1,inputType:l="text",inputPlaceholder:u,inputDisabled:c,inputReadOnly:d,buttonsOnly:p,rounded:f,roundedIos:m,roundedMaterial:y,small:x,smallIos:b,smallMaterial:v,large:w,largeIos:S,largeMaterial:C,raised:I,raisedIos:_,raisedMaterial:E,outline:P,outlineIos:A,outlineMaterial:D,onInput:V,onChange:z,onFocus:K,onBlur:X,onMinus:Z,onPlus:q,ios:F,material:Y,touchRipple:Q=!0,children:ne,...le}=t,de=R.useRef(null),re=R.useRef(null),he=R.useRef(null);R.useImperativeHandle(e,()=>({el:de.current}));const ve=n,H=Jt({ios:F,material:Y}),ie=Je({ios:F,material:Y});eo(re,H==="material"&&Q),eo(he,H==="material"&&Q);const pe=typeof f>"u"?H==="ios"?m:y:f,ke=typeof x>"u"?H==="ios"?b:v:x,Ne=typeof w>"u"?H==="ios"?S:C:w,Ie=typeof I>"u"?H==="ios"?_:E:I,Le=typeof P>"u"?H==="ios"?A:D:P,He=mt(),Me=_Y(a,He),it=Ne?"large":ke?"small":"medium",Ye=Le&&Ie?"clear":Le?"outline":"fill",Ze=pe?"rounded":"square",Qe=ie(EY({...t,rounded:pe,small:ke,large:Ne,raised:Ie,outline:Le},Me)),Xt={...le},Vt=M(Qe.base,Ie&&Qe.raised,Qe.size[it],Qe.shape[Ze],r),Ht=M(Qe.button,Qe.buttonStyle[Ye],Qe.buttonLeftShape[Ze]),Yt=M(Qe.button,Qe.buttonStyle[Ye],Qe.buttonRightShape[Ze]),Wt=M(s&&Qe.input,Qe.value[Ye]);return G.createElement(ve,FN({ref:de,className:Vt},Xt),G.createElement("span",{ref:re,className:Ht,role:"button",tabIndex:"0",onClick:Z},G.createElement("span",{className:Qe.hBar})),s&&!p&&G.createElement("input",{className:Wt,placeholder:u,type:l,value:i,defaultValue:o,disabled:c,readOnly:d,onInput:V,onChange:z,onFocus:K,onBlur:X}),!s&&!p&&G.createElement("span",{className:Wt},i),G.createElement("span",{ref:he,className:Yt,role:"button",tabIndex:"0",onClick:q},G.createElement("span",{className:Qe.hBar}),G.createElement("span",{className:Qe.vBar})))});OY.displayName="Stepper";function BN(){return BN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},BN.apply(this,arguments)}const t6=R.forwardRef((t,e)=>{const{labels:n,icons:r,children:a,...i}=t,o=R.useRef(null);R.useImperativeHandle(e,()=>({el:o.current}));const s={...i};return G.createElement(bN,BN({ref:o,tabbar:!0,tabbarIcons:r,tabbarLabels:n},s),a)});t6.displayName="Tabbar";const $Y=function(t,e){let{hasIcon:n,hasLabel:r,active:a}=t===void 0?{}:t;return e===void 0&&(e={}),{content:{common:"flex flex-col items-center justify-center h-full",ios:M("py-1",a?e.textActiveIos:e.textIos),material:M("py-2",n&&r&&"space-y-1",a?e.textActiveMaterial:e.textMaterial)},iconContainer:{common:"flex items-center justify-center k-tabbar-link-icon relative",ios:M("w-7 h-7"),material:M("w-16 h-8 rounded-full")},iconBg:{common:"absolute left-0 top-0 w-full h-full rounded-full duration-200 -z-10 pointer-events-none",ios:M(a?e.iconBgActiveIos:e.iconBgIos),material:M(a?e.iconBgActiveMaterial:e.iconBgMaterial,!a&&"scale-x-[0.5] opacity-0")},label:{ios:M(n?"text-xs font-medium":"",""),material:M(n?"text-xs":"text-sm","font-medium")}}},RY=function(t,e){return t===void 0&&(t={}),{textIos:M("text-black text-opacity-40",e("dark:text-white dark:text-opacity-55")),textActiveIos:"text-primary",textMaterial:M("text-md-light-on-surface-variant",e("dark:text-md-dark-on-surface-variant")),textActiveMaterial:M("text-md-light-on-secondary-container",e("dark:text-md-dark-on-secondary-container")),iconBgIos:"",iconBgActiveIos:"",iconBgMaterial:"",iconBgActiveMaterial:M("bg-md-light-secondary-container",e("dark:bg-md-dark-secondary-container")),...t}};function zN(){return zN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},zN.apply(this,arguments)}const of=R.forwardRef((t,e)=>{const{className:n,active:r,ios:a,material:i,colors:o,linkProps:s={},icon:l,label:u,children:c,...d}=t,p=R.useRef(null);R.useImperativeHandle(e,()=>({el:p.current}));const f={...s,...d},m=mt(),y=RY(o,m),x=Je({ios:a,material:i}),b=!!l,v=u||c&&c.length,w=x($Y({hasLabel:v,hasIcon:b,active:r},y));return G.createElement(Nd,zN({ref:p,tabbar:!0,tabbarActive:r,className:n},f),G.createElement("span",{className:w.content},l&&G.createElement("span",{className:w.iconContainer},G.createElement("span",{className:w.iconBg}),l),(u||c&&c.length)&&G.createElement("span",{className:w.label},u,c)))});of.displayName="TabbarLink";const MY=()=>({base:{common:"w-full border-none p-0 m-0 border-collapse text-left table",ios:"",material:""}});function jN(){return jN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},jN.apply(this,arguments)}const AY=R.forwardRef((t,e)=>{const{className:n,ios:r,material:a,children:i,...o}=t,s=R.useRef(null);R.useImperativeHandle(e,()=>({el:s.current}));const l=Je({ios:r,material:a})(MY({...t})),u={...o};return G.createElement("table",jN({className:l.base,ref:s},u),i)});AY.displayName="Table";const PY=()=>({base:{common:"text-sm",ios:"",material:""}});function VN(){return VN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},VN.apply(this,arguments)}const LY=R.forwardRef((t,e)=>{const{className:n,ios:r,material:a,children:i,...o}=t,s=R.useRef(null);R.useImperativeHandle(e,()=>({el:s.current}));const l=Je({ios:r,material:a})(PY({...t})),u={...o};return G.createElement("tbody",VN({className:l.base,ref:s},u),i)});LY.displayName="TableBody";const DY=(t,e,n)=>{const{header:r}=t;return{base:{common:M("align-middle",n),ios:M(r?`text-xs font-semibold overflow-hidden whitespace-nowrap leading-4 h-11 bg-transparent ${e.textHeaderIos} py-0 px-4`:"h-11 relative py-0 px-4"),material:M(r?`${e.textHeaderMaterial} px-6 py-0  text-xs font-medium overflow-hidden text-ellipsis whitespace-nowrap leading-4 h-14 bg-transparent`:"py-0 first:px-6 px-7 h-12")}}},FY=function(t,e){return t===void 0&&(t={}),{textHeaderIos:M("text-black/45",e("dark:text-white/55")),textHeaderMaterial:M("text-md-light-on-surface-variant",e("dark:text-md-dark-on-surface-variant")),...t}};function WN(){return WN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},WN.apply(this,arguments)}const BY=R.forwardRef((t,e)=>{const{className:n,colors:r,header:a,ios:i,material:o,children:s,...l}=t,u=R.useRef(null);R.useImperativeHandle(e,()=>({el:u.current}));const c=a?"th":"td",d=Je({ios:i,material:o}),p=mt(),f=FY(r,p),m=d(DY({...t},f,n)),y={...l};return G.createElement(c,WN({className:m.base,ref:u},y),s)});BY.displayName="TableCell";const zY=()=>({base:{common:"align-middle relative",ios:"hairline-b",material:""}});function UN(){return UN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},UN.apply(this,arguments)}const jY=R.forwardRef((t,e)=>{const{className:n,ios:r,material:a,children:i,...o}=t,s=R.useRef(null);R.useImperativeHandle(e,()=>({el:s.current}));const l=Je({ios:r,material:a})(zY({...t})),u={...o};return G.createElement("thead",UN({className:l.base,ref:s},u),i)});jY.displayName="TableHead";const VY=(t,e)=>{const{header:n}=t;return{base:{common:"align-middle relative",ios:n?"":M(e.bgIos,"hairline-b last:hairline-transparent"),material:n?"":M(e.bgMaterial,`border-t ${e.dividerMaterial}`)}}},WY=function(t,e){return t===void 0&&(t={}),{bgIos:M("hover:bg-black/5",e("dark:hover:bg-white/10")),bgMaterial:M("hover:bg-md-light-secondary-container",e("dark:hover:bg-md-dark-secondary-container")),dividerMaterial:M("border-md-light-outline",e("dark:border-md-dark-outline")),...t}};function GN(){return GN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},GN.apply(this,arguments)}const UY=R.forwardRef((t,e)=>{const{className:n,colors:r,header:a,ios:i,material:o,children:s,...l}=t,u=R.useRef(null);R.useImperativeHandle(e,()=>({el:u.current}));const c=Je({ios:i,material:o}),d=mt(),p=WY(r,d),f=c(VY({...t},p)),m={...l};return G.createElement("tr",GN({className:f.base,ref:u},m),s)});UY.displayName="TableRow";const GY=(t,e,n)=>{const{translucent:r,opened:a}=t;return{base:{common:M(Ln("fixed",n),"z-50 transform transition-transform-opacity w-full sm:w-auto start-0 bottom-0 sm:max-w-lg",!a&&"translate-y-full opacity-0 pointer-events-none"),ios:M("sm:rounded-lg duration-300",e.textIos,e.bgIos,r&&"translucent"),material:M("sm:rounded-2xl duration-200",e.textMaterial,e.bgMaterial),left:"sm:start-4-safe sm:bottom-4-safe",right:"sm:end-4-safe sm:bottom-4-safe sm:start-auto",center:"sm:left-1/2 sm:bottom-4-safe sm:-translate-x-1/2"},content:{common:"flex items-center justify-between",ios:"pl-4-safe pr-4-safe pt-3 pb-3-safe sm:px-4 sm:py-3",material:"pl-6-safe pr-6-safe py-3.5 pb-3.5-safe sm:px-6 sm:py-3.5"},button:{common:"-my-2 shrink-0 ms-4",ios:"",material:"-me-2"}}},HY=function(t,e){return t===void 0&&(t={}),{bgIos:"bg-black",bgMaterial:M("bg-md-light-surface-5",e("dark:bg-md-dark-surface-5")),textIos:"text-white",textMaterial:M("text-md-light-primary",e("dark:text-md-dark-primary")),...t}};function HN(){return HN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},HN.apply(this,arguments)}const qY=R.forwardRef((t,e)=>{const{component:n="div",className:r,colors:a,translucent:i=!0,button:o,position:s="left",opened:l,ios:u,material:c,children:d,...p}=t,f=R.useRef(null);R.useImperativeHandle(e,()=>({el:f.current}));const m=n,y={...p},x=Je({ios:u,material:c}),b=mt(),v=HY(a,b),w=x(GY({...t,translucent:i},v,r),r);return G.createElement(m,HN({ref:f,className:w.base[s]},y),G.createElement("div",{className:w.content},d,o&&G.createElement("div",{className:w.button},o)))});qY.displayName="Toast";const KY=(t,e,n,r)=>({base:{common:M(Ln("relative",n),"cursor-pointer select-none inline-block align-middle relative duration-300 rounded-full group",r("dark:touch-ripple-white")),ios:"h-8 w-13 p-0.5",material:"w-13 h-8 border-2",notChecked:{ios:e.bgIos,material:M(e.bgMaterial,e.borderMaterial)},checked:{ios:`${e.checkedBgIos}`,material:M(e.checkedBgMaterial,e.checkedBorderMaterial)}},inner:{ios:M("w-full h-full bg-white rounded-full block duration-300 transform",r("dark:bg-opacity-0")),notChecked:{},checked:{ios:"scale-0"}},thumbWrap:{common:"rounded-full absolute duration-300 transform",ios:"w-7 h-7 start-0.5 top-0.5",material:"w-6 h-6 start-0.5 top-0.5",checked:{ios:M("translate-x-5 rtl:!-translate-x-5"),material:M("translate-x-5 rtl:!-translate-x-5")},notChecked:""},thumb:{common:"w-full h-full rounded-full absolute duration-300 transform start-0 top-0",ios:"shadow-ios-toggle",material:"group-active:scale-[1.1]",checked:{ios:M(e.checkedThumbBgIos),material:M(e.checkedThumbBgMaterial)},notChecked:{ios:e.thumbBgIos,material:M("scale-[0.666]",e.thumbBgMaterial)}},input:{common:"hidden"}}),XY=function(t,e){return t===void 0&&(t={}),{bgIos:M("bg-black bg-opacity-10",e("dark:bg-white dark:bg-opacity-20")),checkedBgIos:"bg-primary",thumbBgIos:"bg-white",checkedThumbBgIos:"bg-white",bgMaterial:M("bg-md-light-surface-variant",e("dark:bg-md-dark-surface-variant")),checkedBgMaterial:M("bg-md-light-primary",e("dark:bg-md-dark-primary")),borderMaterial:M("border-md-light-outline",e("dark:border-md-dark-outline")),checkedBorderMaterial:M("border-md-light-primary",e("dark:border-md-dark-primary")),thumbBgMaterial:M("bg-md-light-outline",e("dark:bg-md-dark-outline")),checkedThumbBgMaterial:M("bg-md-light-on-primary",e("dark:bg-md-dark-on-primary")),...t}};function qN(){return qN=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},qN.apply(this,arguments)}const YY=R.forwardRef((t,e)=>{const{component:n="label",className:r,colors:a,defaultChecked:i,checked:o,name:s,value:l,disabled:u,readOnly:c,onChange:d,touchRipple:p=!0,ios:f,material:m,children:y,...x}=t,b=R.useRef(null),v=R.useRef(null);R.useImperativeHandle(e,()=>({el:b.current}));const w=n,S={...x},C=Jt({ios:f,material:m}),I=Je({ios:f,material:m}),_=mt();eo(v,C==="material"&&p,b);const E=XY(a,_),P=o||i&&!d?"checked":"notChecked",A=I(KY(t,E,r,_),r);return G.createElement(w,qN({ref:b,className:A.base[P]},S),G.createElement("input",{type:"checkbox",name:s,value:l,disabled:u,readOnly:c,checked:o,defaultChecked:i,onChange:d,className:A.input}),G.createElement("span",{className:A.inner[P]}),G.createElement("span",{ref:v,className:A.thumbWrap[P]},G.createElement("span",{className:A.thumb[P]})),y)});YY.displayName="Toggle";var QY={BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const n6=t=>{let e;const n=new Set,r=(s,l)=>{const u=typeof s=="function"?s(e):s;if(!Object.is(u,e)){const c=e;e=l??(typeof u!="object"||u===null)?u:Object.assign({},e,u),n.forEach(d=>d(e,c))}},a=()=>e,i={setState:r,getState:a,getInitialState:()=>o,subscribe:s=>(n.add(s),()=>n.delete(s)),destroy:()=>{(QY?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},o=e=t(r,a,i);return i},ZY=t=>t?n6(t):n6;var r6={exports:{}},a6={},i6={exports:{}},o6={};/**
* @license React
* use-sync-external-store-shim.production.min.js
*
* Copyright (c) Facebook, Inc. and its affiliates.
*
* This source code is licensed under the MIT license found in the
* LICENSE file in the root directory of this source tree.
*/var Ed=R;function JY(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var eQ=typeof Object.is=="function"?Object.is:JY,tQ=Ed.useState,nQ=Ed.useEffect,rQ=Ed.useLayoutEffect,aQ=Ed.useDebugValue;function iQ(t,e){var n=e(),r=tQ({inst:{value:n,getSnapshot:e}}),a=r[0].inst,i=r[1];return rQ(function(){a.value=n,a.getSnapshot=e,KN(a)&&i({inst:a})},[t,n,e]),nQ(function(){return KN(a)&&i({inst:a}),t(function(){KN(a)&&i({inst:a})})},[t]),aQ(n),n}function KN(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!eQ(t,n)}catch{return!0}}function oQ(t,e){return e()}var sQ=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?oQ:iQ;o6.useSyncExternalStore=Ed.useSyncExternalStore!==void 0?Ed.useSyncExternalStore:sQ,i6.exports=o6;var lQ=i6.exports;/**
* @license React
* use-sync-external-store-shim/with-selector.production.min.js
*
* Copyright (c) Facebook, Inc. and its affiliates.
*
* This source code is licensed under the MIT license found in the
* LICENSE file in the root directory of this source tree.
*/var gy=R,uQ=lQ;function cQ(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var dQ=typeof Object.is=="function"?Object.is:cQ,pQ=uQ.useSyncExternalStore,hQ=gy.useRef,fQ=gy.useEffect,gQ=gy.useMemo,mQ=gy.useDebugValue;a6.useSyncExternalStoreWithSelector=function(t,e,n,r,a){var i=hQ(null);if(i.current===null){var o={hasValue:!1,value:null};i.current=o}else o=i.current;i=gQ(function(){function l(f){if(!u){if(u=!0,c=f,f=r(f),a!==void 0&&o.hasValue){var m=o.value;if(a(m,f))return d=m}return d=f}if(m=d,dQ(c,f))return m;var y=r(f);return a!==void 0&&a(m,y)?m:(c=f,d=y)}var u=!1,c,d,p=n===void 0?null:n;return[function(){return l(e())},p===null?void 0:function(){return l(p())}]},[e,n,r,a]);var s=pQ(t,i[0],i[1]);return fQ(function(){o.hasValue=!0,o.value=s},[s]),mQ(s),s},r6.exports=a6;var yQ=r6.exports;const bQ=gi(yQ);var s6={BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{useDebugValue:vQ}=G,{useSyncExternalStoreWithSelector:xQ}=bQ;let l6=!1;const wQ=t=>t;function kQ(t,e=wQ,n){(s6?"production":void 0)!=="production"&&n&&!l6&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),l6=!0);const r=xQ(t.subscribe,t.getState,t.getServerState||t.getInitialState,e,n);return vQ(r),r}const u6=t=>{(s6?"production":void 0)!=="production"&&typeof t!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof t=="function"?ZY(t):t,n=(r,a)=>kQ(e,r,a);return Object.assign(n,e),n},SQ=t=>t?u6(t):u6;var my={BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const XN=new Map,yy=t=>{const e=XN.get(t);return e?Object.fromEntries(Object.entries(e.stores).map(([n,r])=>[n,r.getState()])):{}},CQ=(t,e,n)=>{if(t===void 0)return{type:"untracked",connection:e.connect(n)};const r=XN.get(n.name);if(r)return{type:"tracked",store:t,...r};const a={connection:e.connect(n),stores:{}};return XN.set(n.name,a),{type:"tracked",store:t,...a}},NQ=(t,e={})=>(n,r,a)=>{const{enabled:i,anonymousActionType:o,store:s,...l}=e;let u;try{u=(i??(my?"production":void 0)!=="production")&&window.__REDUX_DEVTOOLS_EXTENSION__}catch{}if(!u)return(my?"production":void 0)!=="production"&&i&&console.warn("[zustand devtools middleware] Please install/enable Redux devtools extension"),t(n,r,a);const{connection:c,...d}=CQ(s,u,l);let p=!0;a.setState=(y,x,b)=>{const v=n(y,x);if(!p)return v;const w=b===void 0?{type:o||"anonymous"}:typeof b=="string"?{type:b}:b;return s===void 0?(c?.send(w,r()),v):(c?.send({...w,type:`${s}/${w.type}`},{...yy(l.name),[s]:a.getState()}),v)};const f=(...y)=>{const x=p;p=!1,n(...y),p=x},m=t(a.setState,r,a);if(d.type==="untracked"?c?.init(m):(d.stores[d.store]=a,c?.init(Object.fromEntries(Object.entries(d.stores).map(([y,x])=>[y,y===d.store?m:x.getState()])))),a.dispatchFromDevtools&&typeof a.dispatch=="function"){let y=!1;const x=a.dispatch;a.dispatch=(...b)=>{(my?"production":void 0)!=="production"&&b[0].type==="__setState"&&!y&&(console.warn('[zustand devtools middleware] "__setState" action type is reserved to set state from the devtools. Avoid using it.'),y=!0),x(...b)}}return c.subscribe(y=>{var x;switch(y.type){case"ACTION":if(typeof y.payload!="string"){console.error("[zustand devtools middleware] Unsupported action format");return}return YN(y.payload,b=>{if(b.type==="__setState"){if(s===void 0){f(b.state);return}Object.keys(b.state).length!==1&&console.error(`
                    [zustand devtools middleware] Unsupported __setState action format. 
                    When using 'store' option in devtools(), the 'state' should have only one key, which is a value of 'store' that was passed in devtools(),
                    and value of this only key should be a state object. Example: { "type": "__setState", "state": { "abc123Store": { "foo": "bar" } } }
                    `);const v=b.state[s];if(v==null)return;JSON.stringify(a.getState())!==JSON.stringify(v)&&f(v);return}a.dispatchFromDevtools&&typeof a.dispatch=="function"&&a.dispatch(b)});case"DISPATCH":switch(y.payload.type){case"RESET":return f(m),s===void 0?c?.init(a.getState()):c?.init(yy(l.name));case"COMMIT":if(s===void 0){c?.init(a.getState());return}return c?.init(yy(l.name));case"ROLLBACK":return YN(y.state,b=>{if(s===void 0){f(b),c?.init(a.getState());return}f(b[s]),c?.init(yy(l.name))});case"JUMP_TO_STATE":case"JUMP_TO_ACTION":return YN(y.state,b=>{if(s===void 0){f(b);return}JSON.stringify(a.getState())!==JSON.stringify(b[s])&&f(b[s])});case"IMPORT_STATE":{const{nextLiftedState:b}=y.payload,v=(x=b.computedStates.slice(-1)[0])==null?void 0:x.state;if(!v)return;f(s===void 0?v:v[s]),c?.send(null,b);return}case"PAUSE_RECORDING":return p=!p}return}}),m},TQ=NQ,YN=(t,e)=>{let n;try{n=JSON.parse(t)}catch(r){console.error("[zustand devtools middleware] Could not parse the received json",r)}n!==void 0&&e(n)};function IQ(t,e){let n;try{n=t()}catch{return}return{getItem:r=>{var a;const i=s=>s===null?null:JSON.parse(s,e?.reviver),o=(a=n.getItem(r))!=null?a:null;return o instanceof Promise?o.then(i):i(o)},setItem:(r,a)=>n.setItem(r,JSON.stringify(a,e?.replacer)),removeItem:r=>n.removeItem(r)}}const sf=t=>e=>{try{const n=t(e);return n instanceof Promise?n:{then(r){return sf(r)(n)},catch(r){return this}}}catch(n){return{then(r){return this},catch(r){return sf(r)(n)}}}},EQ=(t,e)=>(n,r,a)=>{let i={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:x=>x,version:0,merge:(x,b)=>({...b,...x}),...e},o=!1;const s=new Set,l=new Set;let u;try{u=i.getStorage()}catch{}if(!u)return t((...x)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),n(...x)},r,a);const c=sf(i.serialize),d=()=>{const x=i.partialize({...r()});let b;const v=c({state:x,version:i.version}).then(w=>u.setItem(i.name,w)).catch(w=>{b=w});if(b)throw b;return v},p=a.setState;a.setState=(x,b)=>{p(x,b),d()};const f=t((...x)=>{n(...x),d()},r,a);let m;const y=()=>{var x;if(!u)return;o=!1,s.forEach(v=>v(r()));const b=((x=i.onRehydrateStorage)==null?void 0:x.call(i,r()))||void 0;return sf(u.getItem.bind(u))(i.name).then(v=>{if(v)return i.deserialize(v)}).then(v=>{if(v)if(typeof v.version=="number"&&v.version!==i.version){if(i.migrate)return i.migrate(v.state,v.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return v.state}).then(v=>{var w;return m=i.merge(v,(w=r())!=null?w:f),n(m,!0),d()}).then(()=>{b?.(m,void 0),o=!0,l.forEach(v=>v(m))}).catch(v=>{b?.(void 0,v)})};return a.persist={setOptions:x=>{i={...i,...x},x.getStorage&&(u=x.getStorage())},clearStorage:()=>{u?.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>y(),hasHydrated:()=>o,onHydrate:x=>(s.add(x),()=>{s.delete(x)}),onFinishHydration:x=>(l.add(x),()=>{l.delete(x)})},y(),m||f},_Q=(t,e)=>(n,r,a)=>{let i={storage:IQ(()=>localStorage),partialize:y=>y,version:0,merge:(y,x)=>({...x,...y}),...e},o=!1;const s=new Set,l=new Set;let u=i.storage;if(!u)return t((...y)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),n(...y)},r,a);const c=()=>{const y=i.partialize({...r()});return u.setItem(i.name,{state:y,version:i.version})},d=a.setState;a.setState=(y,x)=>{d(y,x),c()};const p=t((...y)=>{n(...y),c()},r,a);a.getInitialState=()=>p;let f;const m=()=>{var y,x;if(!u)return;o=!1,s.forEach(v=>{var w;return v((w=r())!=null?w:p)});const b=((x=i.onRehydrateStorage)==null?void 0:x.call(i,(y=r())!=null?y:p))||void 0;return sf(u.getItem.bind(u))(i.name).then(v=>{if(v)if(typeof v.version=="number"&&v.version!==i.version){if(i.migrate)return i.migrate(v.state,v.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return v.state}).then(v=>{var w;return f=i.merge(v,(w=r())!=null?w:p),n(f,!0),c()}).then(()=>{b?.(f,void 0),f=r(),o=!0,l.forEach(v=>v(f))}).catch(v=>{b?.(void 0,v)})};return a.persist={setOptions:y=>{i={...i,...y},y.storage&&(u=y.storage)},clearStorage:()=>{u?.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>m(),hasHydrated:()=>o,onHydrate:y=>(s.add(y),()=>{s.delete(y)}),onFinishHydration:y=>(l.add(y),()=>{l.delete(y)})},i.skipHydration||m(),f||p},OQ=(t,e)=>"getStorage"in e||"serialize"in e||"deserialize"in e?((my?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),EQ(t,e)):_Q(t,e),$Q=OQ,c6=[{id:1,image:"./frame/frame_1.png",front:"./frame/frame_1_front.png"},{id:2,image:"./frame/frame_2.png",front:"./frame/frame_2_front.png"},{id:3,image:"./frame/frame_3.png",front:"./frame/frame_3_front.png"},{id:4,image:"./frame/frame_4.png",front:"./frame/frame_4_front.png"},{id:5,image:"./frame/frame_5.png",front:"./frame/frame_5_front.png"}],RQ=[{id:"Betende_Frau_Maria",image:"./sticker/Betende_Frau_Maria.png"},{id:"Blumentopf",image:"./sticker/Blumentopf.png"},{id:"Blume",image:"./sticker/Blume.png"},{id:"Frau_in_gelbem_Kleid",image:"./sticker/Frau_in_gelbem_Kleid.png"},{id:"Magd",image:"./sticker/Magd.png"},{id:"Mann_liegend",image:"./sticker/Mann_liegend.png"},{id:"Mann",image:"./sticker/Mann.png"},{id:"Mucha_Dekor",image:"./sticker/Mucha_Dekor.png"},{id:"The_Hare",image:"./sticker/The_Hare.png"},{id:"Wasserspeier",image:"./sticker/Wasserspeier.png"}],d6=[{id:"http://www.wikidata.org/entity/Q20355536",name:"A Street in Torello, Italy",year:"1890",country:"Denmark",location:"Statens Museum for Kunst",creator:"Peder Severin Kr\xF8yer",url:"https://api.smk.dk/api/v1/iiif/manifest/?id=KMS1435",identifier:"https://iip.smk.dk/iiif/jp2/z603r155c_KMS1435.tif.reconstructed.tif.jp2",image:"https://iip.smk.dk/iiif/jp2/z603r155c_KMS1435.tif.reconstructed.tif.jp2/full/400,/0/default.jpg",thumbnail:"https://iip.smk.dk/iiif/jp2/z603r155c_KMS1435.tif.reconstructed.tif.jp2/full/100,100/0/default.jpg"},{id:"http://www.wikidata.org/entity/Q20537703",name:"At the French Windows. The Artist's Wife",year:"1897",country:"Denmark",location:"Statens Museum for Kunst",creator:"Laurits Andersen Ring",url:"https://api.smk.dk/api/v1/iiif/manifest/?id=KMS3716",identifier:"https://iip.smk.dk/iiif/jp2/1544bs13w_kms3716.tif.reconstructed.tif.jp2",image:"https://iip.smk.dk/iiif/jp2/1544bs13w_kms3716.tif.reconstructed.tif.jp2/full/400,/0/default.jpg",thumbnail:"https://iip.smk.dk/iiif/jp2/1544bs13w_kms3716.tif.reconstructed.tif.jp2/full/100,100/0/default.jpg"},{id:"http://www.wikidata.org/entity/Q103297795",name:"Brot! (Bread!)",year:"1924",country:"Germany",location:"Vanderbilt University Fine Arts Gallery",creator:"K\xE4the Kollwitz",url:"https://iiif-manifest.library.vanderbilt.edu/gallery/1977/1977.011.json",identifier:"https://iiif.library.vanderbilt.edu/iiif/2/gallery%2F1977%2F1977.011.tif",image:"https://iiif.library.vanderbilt.edu/iiif/2/gallery%2F1977%2F1977.011.tif/full/400,/0/default.jpg",thumbnail:"https://iiif.library.vanderbilt.edu/iiif/2/gallery%2F1977%2F1977.011.tif/full/100,100/0/default.jpg"},{id:"http://www.wikidata.org/entity/Q103297971",name:"Business-Man, ffrom Genius, Zeitschrift f\xFCr werdende und alte Kunst (Magazine for Emerging and Ancient Art), Year 2, no. 1",year:"1920",country:"Belgium",location:"Vanderbilt University Fine Arts Gallery",creator:"Frans Masereel",url:"https://iiif-manifest.library.vanderbilt.edu/gallery/1976/1976.032.json",identifier:"https://iiif.library.vanderbilt.edu/iiif/2/gallery%2F1976%2F1976.032.med.jpg",image:"https://iiif.library.vanderbilt.edu/iiif/2/gallery%2F1976%2F1976.032.med.jpg/full/400,/0/default.jpg",thumbnail:"https://iiif.library.vanderbilt.edu/iiif/2/gallery%2F1976%2F1976.032.med.jpg/full/100,100/0/default.jpg"},{id:"http://www.wikidata.org/entity/Q3698180",name:"Calvary",year:"1475",country:"Belgium",location:"Royal Museum of Fine Arts Antwerp",creator:"Antonello da Messina",url:"https://iiif.kmska.be/iiif/2/5/manifest.json",identifier:"https://iiif.kmska.be/c/iiif/2/public@5.tif",image:"https://iiif.kmska.be/c/iiif/2/public@5.tif/full/400,/0/default.jpg",thumbnail:"https://iiif.kmska.be/c/iiif/2/public@5.tif/full/100,100/0/default.jpg"},{id:"http://www.wikidata.org/entity/Q103300860",name:"Half-Figure Prophet",year:"1450",country:"France",location:"Vanderbilt University Fine Arts Gallery",creator:"http://www.wikidata.org/.well-known/genid/d7c4865c9fae865605be887d7277ab75",url:"https://iiif-manifest.library.vanderbilt.edu/gallery/1975/1975.005.json",identifier:"https://iiif.library.vanderbilt.edu/iiif/2/gallery%2F1975%2F1975.005.jpg",image:"https://iiif.library.vanderbilt.edu/iiif/2/gallery%2F1975%2F1975.005.jpg/full/400,/0/default.jpg",thumbnail:"https://iiif.library.vanderbilt.edu/iiif/2/gallery%2F1975%2F1975.005.jpg/full/100,100/0/default.jpg"},{id:"http://www.wikidata.org/entity/Q102967848",name:"Landscape with Shepherds",year:"",country:"Netherlands",location:"Vanderbilt University Fine Arts Gallery",creator:"Jan Both",url:"https://iiif-manifest.library.vanderbilt.edu/gallery/1979/1979.0195P.json",identifier:"https://iiif.library.vanderbilt.edu/iiif/2/gallery%2F1979%2F1979.0195P.tif",image:"https://iiif.library.vanderbilt.edu/iiif/2/gallery%2F1979%2F1979.0195P.tif/full/400,/0/default.jpg",thumbnail:"https://iiif.library.vanderbilt.edu/iiif/2/gallery%2F1979%2F1979.0195P.tif/full/100,100/0/default.jpg"},{id:"http://www.wikidata.org/entity/Q106582838",name:"The Blacksmith Worker",year:"",country:"Switzerland",location:"Vanderbilt University Fine Arts Gallery",creator:"Antonello da Messina",url:"https://iiif-manifest.library.vanderbilt.edu/gallery/1976/1976.036.json",identifier:"https://iiif.library.vanderbilt.edu/iiif/2/gallery%2F1976%2F1976.036.tif",image:"https://iiif.library.vanderbilt.edu/iiif/2/gallery%2F1976%2F1976.036.tif/full/400,/0/default.jpg",thumbnail:"https://iiif.library.vanderbilt.edu/iiif/2/gallery%2F1976%2F1976.036.tif/full/100,100/0/default.jpg"},{id:"http://www.wikidata.org/entity/Q104032628",name:"The Empty Jug",year:"1653",country:"Netherlands",location:"Vanderbilt University Fine Arts Gallery",creator:"Adriaen van Ostade",url:"https://iiif-manifest.library.vanderbilt.edu/gallery/1979/1979.0845P.json",identifier:"https://iiif.library.vanderbilt.edu/iiif/2/gallery%2F1979%2F1979.0845P.tif",image:"https://iiif.library.vanderbilt.edu/iiif/2/gallery%2F1979%2F1979.0845P.tif/full/400,/0/default.jpg",thumbnail:"https://iiif.library.vanderbilt.edu/iiif/2/gallery%2F1979%2F1979.0845P.tif/full/100,100/0/default.jpg"},{id:"http://www.wikidata.org/entity/Q102975484",name:"Trostung (Consolation), from Genius, Zeitschrift f\xFCr werdende und alte Kunst (Magazine for Emerging and Ancient Art), Year 2, no. 1",year:"1920",country:"Austria",location:"Vanderbilt University Fine Arts Gallery",creator:"Georg Ehrlich",url:"https://iiif-manifest.library.vanderbilt.edu/gallery/1976/1976.031.json",identifier:"https://iiif.library.vanderbilt.edu/iiif/2/gallery%2F1976%2F1976.031.med.jpg",image:"https://iiif.library.vanderbilt.edu/iiif/2/gallery%2F1976%2F1976.031.med.jpg/full/400,/0/default.jpg",thumbnail:"https://iiif.library.vanderbilt.edu/iiif/2/gallery%2F1976%2F1976.031.med.jpg/full/100,100/0/default.jpg"}],ps=SQ()(TQ($Q(t=>({addToArtwork:(e,n)=>t(r=>({artworkList:[{id:e,image:n},...r.artworkList]})),addToCanvas:(e,n,r)=>t(a=>({canvasList:[...a.canvasList,{brightness:0,contrast:0,height:400,id:`${a.canvasList.length+1}`,image:e,isDragging:!1,opacity:1,width:400,x:n,y:r}]})),addToImageList:e=>t(n=>({imageList:[...n.imageList,...e]})),removeFromImageList:e=>t(n=>({imageList:n.imageList.filter(r=>r.id!==e)})),artworkList:RQ,canvasList:[],frame:c6[1],imageList:d6.sort(()=>Math.random()-.5),imageLikeList:[],likeImage:e=>t(n=>({imageLikeList:[...n.imageLikeList,e]})),resetState:()=>t(()=>({imageList:d6.sort(()=>Math.random()-.5),canvasList:[],imageLikeList:[]})),removeFromCanvas:e=>t(n=>({canvasList:n.canvasList.filter(r=>r.id!==e)})),setFrame:e=>t(()=>({frame:c6.find(n=>n.id===e)})),transformCanvasImage:e=>t(n=>({canvasList:n.canvasList.map(r=>r.id!==e.id?r:{...r,height:e.height,width:e.width,x:e.x,y:e.y,brightness:e.brightness,contrast:e.contrast,opacity:e.opacity})})),moveCanvasImage:(e,n)=>t(r=>{const a=r.canvasList.findIndex(i=>i.id===e);if(a!==-1){const i=n?a+1:a-1;if(i>=0&&i<r.canvasList.length){const o=[...r.canvasList],[s]=o.splice(a,1);return o.splice(i,0,s),{canvasList:o}}}return{}})}),{name:"glamStore"})));function MQ({title:t,titleId:e,...n},r){return R.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},n),t?R.createElement("title",{id:e},t):null,R.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"}))}const AQ=R.forwardRef(MQ),PQ=AQ;function LQ({title:t,titleId:e,...n},r){return R.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},n),t?R.createElement("title",{id:e},t):null,R.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m15 15-6 6m0 0-6-6m6 6V9a6 6 0 0 1 12 0v3"}))}const DQ=R.forwardRef(LQ),FQ=DQ;function BQ({title:t,titleId:e,...n},r){return R.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},n),t?R.createElement("title",{id:e},t):null,R.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m9 9 6-6m0 0 6 6m-6-6v12a6 6 0 0 1-12 0v-3"}))}const zQ=R.forwardRef(BQ),jQ=zQ;function VQ({title:t,titleId:e,...n},r){return R.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},n),t?R.createElement("title",{id:e},t):null,R.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"}))}const WQ=R.forwardRef(VQ),UQ=WQ;function GQ({title:t,titleId:e,...n},r){return R.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},n),t?R.createElement("title",{id:e},t):null,R.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 19.5 8.25 12l7.5-7.5"}))}const HQ=R.forwardRef(GQ),qQ=HQ;function KQ({title:t,titleId:e,...n},r){return R.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},n),t?R.createElement("title",{id:e},t):null,R.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m8.25 4.5 7.5 7.5-7.5 7.5"}))}const XQ=R.forwardRef(KQ),YQ=XQ;function QQ({title:t,titleId:e,...n},r){return R.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},n),t?R.createElement("title",{id:e},t):null,R.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7.498 15.25H4.372c-1.026 0-1.945-.694-2.054-1.715a12.137 12.137 0 0 1-.068-1.285c0-2.848.992-5.464 2.649-7.521C5.287 4.247 5.886 4 6.504 4h4.016a4.5 4.5 0 0 1 1.423.23l3.114 1.04a4.5 4.5 0 0 0 1.423.23h1.294M7.498 15.25c.618 0 .991.724.725 1.282A7.471 7.471 0 0 0 7.5 19.75 2.25 2.25 0 0 0 9.75 22a.75.75 0 0 0 .75-.75v-.633c0-.573.11-1.14.322-1.672.304-.76.93-1.33 1.653-1.715a9.04 9.04 0 0 0 2.86-2.4c.498-.634 1.226-1.08 2.032-1.08h.384m-10.253 1.5H9.7m8.075-9.75c.01.05.027.1.05.148.593 1.2.925 2.55.925 3.977 0 1.487-.36 2.89-.999 4.125m.023-8.25c-.076-.365.183-.75.575-.75h.908c.889 0 1.713.518 1.972 1.368.339 1.11.521 2.287.521 3.507 0 1.553-.295 3.036-.831 4.398-.306.774-1.086 1.227-1.918 1.227h-1.053c-.472 0-.745-.556-.5-.96a8.95 8.95 0 0 0 .303-.54"}))}const ZQ=R.forwardRef(QQ),JQ=ZQ;function eZ({title:t,titleId:e,...n},r){return R.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},n),t?R.createElement("title",{id:e},t):null,R.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.633 10.25c.806 0 1.533-.446 2.031-1.08a9.041 9.041 0 0 1 2.861-2.4c.723-.384 1.35-.956 1.653-1.715a4.498 4.498 0 0 0 .322-1.672V2.75a.75.75 0 0 1 .75-.75 2.25 2.25 0 0 1 2.25 2.25c0 1.152-.26 2.243-.723 3.218-.266.558.107 1.282.725 1.282m0 0h3.126c1.026 0 1.945.694 2.054 1.715.045.422.068.85.068 1.285a11.95 11.95 0 0 1-2.649 7.521c-.388.482-.987.729-1.605.729H13.48c-.483 0-.964-.078-1.423-.23l-3.114-1.04a4.501 4.501 0 0 0-1.423-.23H5.904m10.598-9.75H14.25M5.904 18.5c.083.205.173.405.27.602.197.4-.078.898-.523.898h-.908c-.889 0-1.713-.518-1.972-1.368a12 12 0 0 1-.521-3.507c0-1.553.295-3.036.831-4.398C3.387 9.953 4.167 9.5 5 9.5h1.053c.472 0 .745.556.5.96a8.958 8.958 0 0 0-1.302 4.665c0 1.194.232 2.333.654 3.375Z"}))}const tZ=R.forwardRef(eZ),nZ=tZ;function rZ({title:t,titleId:e,...n},r){return R.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},n),t?R.createElement("title",{id:e},t):null,R.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12Z"}))}const aZ=R.forwardRef(rZ),iZ=aZ;function oZ({title:t,titleId:e,...n},r){return R.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},n),t?R.createElement("title",{id:e},t):null,R.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m2.25 12 8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25"}))}const sZ=R.forwardRef(oZ),lZ=sZ;function uZ({title:t,titleId:e,...n},r){return R.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},n),t?R.createElement("title",{id:e},t):null,R.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m2.25 15.75 5.159-5.159a2.25 2.25 0 0 1 3.182 0l5.159 5.159m-1.5-1.5 1.409-1.409a2.25 2.25 0 0 1 3.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 0 0 1.5-1.5V6a1.5 1.5 0 0 0-1.5-1.5H3.75A1.5 1.5 0 0 0 2.25 6v12a1.5 1.5 0 0 0 1.5 1.5Zm10.5-11.25h.008v.008h-.008V8.25Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"}))}const cZ=R.forwardRef(uZ),dZ=cZ;function pZ({title:t,titleId:e,...n},r){return R.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},n),t?R.createElement("title",{id:e},t):null,R.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7.217 10.907a2.25 2.25 0 1 0 0 2.186m0-2.186c.18.324.283.696.283 1.093s-.103.77-.283 1.093m0-2.186 9.566-5.314m-9.566 7.5 9.566 5.314m0 0a2.25 2.25 0 1 0 3.935 2.186 2.25 2.25 0 0 0-3.935-2.186Zm0-12.814a2.25 2.25 0 1 0 3.933-2.185 2.25 2.25 0 0 0-3.933 2.185Z"}))}const hZ=R.forwardRef(pZ),fZ=hZ;function gZ({title:t,titleId:e,...n},r){return R.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},n),t?R.createElement("title",{id:e},t):null,R.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 8.25V6a2.25 2.25 0 0 0-2.25-2.25H6A2.25 2.25 0 0 0 3.75 6v8.25A2.25 2.25 0 0 0 6 16.5h2.25m8.25-8.25H18a2.25 2.25 0 0 1 2.25 2.25V18A2.25 2.25 0 0 1 18 20.25h-7.5A2.25 2.25 0 0 1 8.25 18v-1.5m8.25-8.25h-6a2.25 2.25 0 0 0-2.25 2.25v6"}))}const mZ=R.forwardRef(gZ),yZ=mZ;function bZ({title:t,titleId:e,...n},r){return R.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},n),t?R.createElement("title",{id:e},t):null,R.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z"}))}const vZ=R.forwardRef(bZ),QN=vZ;function xZ({title:t,titleId:e,...n},r){return R.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},n),t?R.createElement("title",{id:e},t):null,R.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"}))}const wZ=R.forwardRef(xZ),kZ=wZ;function SZ({title:t,titleId:e,...n},r){return R.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},n),t?R.createElement("title",{id:e},t):null,R.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18 18 6M6 6l12 12"}))}const CZ=R.forwardRef(SZ),NZ=CZ;var p6={exports:{}};(function(t,e){(function(n,r){r()})(ba,function(){function n(u,c){return typeof c>"u"?c={autoBom:!1}:typeof c!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),c={autoBom:!c}),c.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(u.type)?new Blob(["\uFEFF",u],{type:u.type}):u}function r(u,c,d){var p=new XMLHttpRequest;p.open("GET",u),p.responseType="blob",p.onload=function(){l(p.response,c,d)},p.onerror=function(){console.error("could not download file")},p.send()}function a(u){var c=new XMLHttpRequest;c.open("HEAD",u,!1);try{c.send()}catch{}return 200<=c.status&&299>=c.status}function i(u){try{u.dispatchEvent(new MouseEvent("click"))}catch{var c=document.createEvent("MouseEvents");c.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),u.dispatchEvent(c)}}var o=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof ba=="object"&&ba.global===ba?ba:void 0,s=o.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),l=o.saveAs||(typeof window!="object"||window!==o?function(){}:"download"in HTMLAnchorElement.prototype&&!s?function(u,c,d){var p=o.URL||o.webkitURL,f=document.createElement("a");c=c||u.name||"download",f.download=c,f.rel="noopener",typeof u=="string"?(f.href=u,f.origin===location.origin?i(f):a(f.href)?r(u,c,d):i(f,f.target="_blank")):(f.href=p.createObjectURL(u),setTimeout(function(){p.revokeObjectURL(f.href)},4e4),setTimeout(function(){i(f)},0))}:"msSaveOrOpenBlob"in navigator?function(u,c,d){if(c=c||u.name||"download",typeof u!="string")navigator.msSaveOrOpenBlob(n(u,d),c);else if(a(u))r(u,c,d);else{var p=document.createElement("a");p.href=u,p.target="_blank",setTimeout(function(){i(p)})}}:function(u,c,d,p){if(p=p||open("","_blank"),p&&(p.document.title=p.document.body.innerText="downloading..."),typeof u=="string")return r(u,c,d);var f=u.type==="application/octet-stream",m=/constructor/i.test(o.HTMLElement)||o.safari,y=/CriOS\/[\d]+/.test(navigator.userAgent);if((y||f&&m||s)&&typeof FileReader<"u"){var x=new FileReader;x.onloadend=function(){var w=x.result;w=y?w:w.replace(/^data:[^;]*;/,"data:attachment/file;"),p?p.location.href=w:location=w,p=null},x.readAsDataURL(u)}else{var b=o.URL||o.webkitURL,v=b.createObjectURL(u);p?p.location=v:location.href=v,p=null,setTimeout(function(){b.revokeObjectURL(v)},4e4)}});o.saveAs=l.saveAs=l,t.exports=l})})(p6);var TZ=p6.exports,ZN={exports:{}},by={},vy={},wt={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t._registerNode=t.Konva=t.glob=void 0;const e=Math.PI/180;function n(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}t.glob=typeof ba<"u"?ba:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},t.Konva={_global:t.glob,version:"9.3.3",isBrowser:n(),isUnminified:/param/.test(function(a){}.toString()),dblClickWindow:400,getAngle(a){return t.Konva.angleDeg?a*e:a},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return t.Konva.DD.isDragging},isDragReady(){return!!t.Konva.DD.node},releaseCanvasOnDestroy:!0,document:t.glob.document,_injectGlobal(a){t.glob.Konva=a}};const r=a=>{t.Konva[a.prototype.getClassName()]=a};t._registerNode=r,t.Konva._injectGlobal(t.Konva)})(wt);var Dn={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Util=t.Transform=void 0;const e=wt;class n{constructor(S=[1,0,0,1,0,0]){this.dirty=!1,this.m=S&&S.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new n(this.m)}copyInto(S){S.m[0]=this.m[0],S.m[1]=this.m[1],S.m[2]=this.m[2],S.m[3]=this.m[3],S.m[4]=this.m[4],S.m[5]=this.m[5]}point(S){var C=this.m;return{x:C[0]*S.x+C[2]*S.y+C[4],y:C[1]*S.x+C[3]*S.y+C[5]}}translate(S,C){return this.m[4]+=this.m[0]*S+this.m[2]*C,this.m[5]+=this.m[1]*S+this.m[3]*C,this}scale(S,C){return this.m[0]*=S,this.m[1]*=S,this.m[2]*=C,this.m[3]*=C,this}rotate(S){var C=Math.cos(S),I=Math.sin(S),_=this.m[0]*C+this.m[2]*I,E=this.m[1]*C+this.m[3]*I,P=this.m[0]*-I+this.m[2]*C,A=this.m[1]*-I+this.m[3]*C;return this.m[0]=_,this.m[1]=E,this.m[2]=P,this.m[3]=A,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(S,C){var I=this.m[0]+this.m[2]*C,_=this.m[1]+this.m[3]*C,E=this.m[2]+this.m[0]*S,P=this.m[3]+this.m[1]*S;return this.m[0]=I,this.m[1]=_,this.m[2]=E,this.m[3]=P,this}multiply(S){var C=this.m[0]*S.m[0]+this.m[2]*S.m[1],I=this.m[1]*S.m[0]+this.m[3]*S.m[1],_=this.m[0]*S.m[2]+this.m[2]*S.m[3],E=this.m[1]*S.m[2]+this.m[3]*S.m[3],P=this.m[0]*S.m[4]+this.m[2]*S.m[5]+this.m[4],A=this.m[1]*S.m[4]+this.m[3]*S.m[5]+this.m[5];return this.m[0]=C,this.m[1]=I,this.m[2]=_,this.m[3]=E,this.m[4]=P,this.m[5]=A,this}invert(){var S=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),C=this.m[3]*S,I=-this.m[1]*S,_=-this.m[2]*S,E=this.m[0]*S,P=S*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),A=S*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=C,this.m[1]=I,this.m[2]=_,this.m[3]=E,this.m[4]=P,this.m[5]=A,this}getMatrix(){return this.m}decompose(){var S=this.m[0],C=this.m[1],I=this.m[2],_=this.m[3],E=this.m[4],P=this.m[5],A=S*_-C*I;let D={x:E,y:P,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(S!=0||C!=0){var V=Math.sqrt(S*S+C*C);D.rotation=C>0?Math.acos(S/V):-Math.acos(S/V),D.scaleX=V,D.scaleY=A/V,D.skewX=(S*I+C*_)/A,D.skewY=0}else if(I!=0||_!=0){var z=Math.sqrt(I*I+_*_);D.rotation=Math.PI/2-(_>0?Math.acos(-I/z):-Math.acos(I/z)),D.scaleX=A/z,D.scaleY=z,D.skewX=0,D.skewY=(S*I+C*_)/A}return D.rotation=t.Util._getRotation(D.rotation),D}}t.Transform=n;var r="[object Array]",a="[object Number]",i="[object String]",o="[object Boolean]",s=Math.PI/180,l=180/Math.PI,u="#",c="",d="0",p="Konva warning: ",f="Konva error: ",m="rgb(",y={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},x=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/,b=[];const v=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(w){setTimeout(w,60)};t.Util={_isElement(w){return!!(w&&w.nodeType==1)},_isFunction(w){return!!(w&&w.constructor&&w.call&&w.apply)},_isPlainObject(w){return!!w&&w.constructor===Object},_isArray(w){return Object.prototype.toString.call(w)===r},_isNumber(w){return Object.prototype.toString.call(w)===a&&!isNaN(w)&&isFinite(w)},_isString(w){return Object.prototype.toString.call(w)===i},_isBoolean(w){return Object.prototype.toString.call(w)===o},isObject(w){return w instanceof Object},isValidSelector(w){if(typeof w!="string")return!1;var S=w[0];return S==="#"||S==="."||S===S.toUpperCase()},_sign(w){return w===0||w>0?1:-1},requestAnimFrame(w){b.push(w),b.length===1&&v(function(){const S=b;b=[],S.forEach(function(C){C()})})},createCanvasElement(){var w=document.createElement("canvas");try{w.style=w.style||{}}catch{}return w},createImageElement(){return document.createElement("img")},_isInDocument(w){for(;w=w.parentNode;)if(w==document)return!0;return!1},_urlToImage(w,S){var C=t.Util.createImageElement();C.onload=function(){S(C)},C.src=w},_rgbToHex(w,S,C){return((1<<24)+(w<<16)+(S<<8)+C).toString(16).slice(1)},_hexToRgb(w){w=w.replace(u,c);var S=parseInt(w,16);return{r:S>>16&255,g:S>>8&255,b:S&255}},getRandomColor(){for(var w=(Math.random()*16777215<<0).toString(16);w.length<6;)w=d+w;return u+w},getRGB(w){var S;return w in y?(S=y[w],{r:S[0],g:S[1],b:S[2]}):w[0]===u?this._hexToRgb(w.substring(1)):w.substr(0,4)===m?(S=x.exec(w.replace(/ /g,"")),{r:parseInt(S[1],10),g:parseInt(S[2],10),b:parseInt(S[3],10)}):{r:0,g:0,b:0}},colorToRGBA(w){return w=w||"black",t.Util._namedColorToRBA(w)||t.Util._hex3ColorToRGBA(w)||t.Util._hex4ColorToRGBA(w)||t.Util._hex6ColorToRGBA(w)||t.Util._hex8ColorToRGBA(w)||t.Util._rgbColorToRGBA(w)||t.Util._rgbaColorToRGBA(w)||t.Util._hslColorToRGBA(w)},_namedColorToRBA(w){var S=y[w.toLowerCase()];return S?{r:S[0],g:S[1],b:S[2],a:1}:null},_rgbColorToRGBA(w){if(w.indexOf("rgb(")===0){w=w.match(/rgb\(([^)]+)\)/)[1];var S=w.split(/ *, */).map(Number);return{r:S[0],g:S[1],b:S[2],a:1}}},_rgbaColorToRGBA(w){if(w.indexOf("rgba(")===0){w=w.match(/rgba\(([^)]+)\)/)[1];var S=w.split(/ *, */).map((C,I)=>C.slice(-1)==="%"?I===3?parseInt(C)/100:parseInt(C)/100*255:Number(C));return{r:S[0],g:S[1],b:S[2],a:S[3]}}},_hex8ColorToRGBA(w){if(w[0]==="#"&&w.length===9)return{r:parseInt(w.slice(1,3),16),g:parseInt(w.slice(3,5),16),b:parseInt(w.slice(5,7),16),a:parseInt(w.slice(7,9),16)/255}},_hex6ColorToRGBA(w){if(w[0]==="#"&&w.length===7)return{r:parseInt(w.slice(1,3),16),g:parseInt(w.slice(3,5),16),b:parseInt(w.slice(5,7),16),a:1}},_hex4ColorToRGBA(w){if(w[0]==="#"&&w.length===5)return{r:parseInt(w[1]+w[1],16),g:parseInt(w[2]+w[2],16),b:parseInt(w[3]+w[3],16),a:parseInt(w[4]+w[4],16)/255}},_hex3ColorToRGBA(w){if(w[0]==="#"&&w.length===4)return{r:parseInt(w[1]+w[1],16),g:parseInt(w[2]+w[2],16),b:parseInt(w[3]+w[3],16),a:1}},_hslColorToRGBA(w){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(w)){const[S,...C]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(w),I=Number(C[0])/360,_=Number(C[1])/100,E=Number(C[2])/100;let P,A,D;if(_===0)return D=E*255,{r:Math.round(D),g:Math.round(D),b:Math.round(D),a:1};E<.5?P=E*(1+_):P=E+_-E*_;const V=2*E-P,z=[0,0,0];for(let K=0;K<3;K++)A=I+1/3*-(K-1),A<0&&A++,A>1&&A--,6*A<1?D=V+(P-V)*6*A:2*A<1?D=P:3*A<2?D=V+(P-V)*(2/3-A)*6:D=V,z[K]=D*255;return{r:Math.round(z[0]),g:Math.round(z[1]),b:Math.round(z[2]),a:1}}},haveIntersection(w,S){return!(S.x>w.x+w.width||S.x+S.width<w.x||S.y>w.y+w.height||S.y+S.height<w.y)},cloneObject(w){var S={};for(var C in w)this._isPlainObject(w[C])?S[C]=this.cloneObject(w[C]):this._isArray(w[C])?S[C]=this.cloneArray(w[C]):S[C]=w[C];return S},cloneArray(w){return w.slice(0)},degToRad(w){return w*s},radToDeg(w){return w*l},_degToRad(w){return t.Util.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),t.Util.degToRad(w)},_radToDeg(w){return t.Util.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),t.Util.radToDeg(w)},_getRotation(w){return e.Konva.angleDeg?t.Util.radToDeg(w):w},_capitalize(w){return w.charAt(0).toUpperCase()+w.slice(1)},throw(w){throw new Error(f+w)},error(w){console.error(f+w)},warn(w){e.Konva.showWarnings&&console.warn(p+w)},each(w,S){for(var C in w)S(C,w[C])},_inRange(w,S,C){return S<=w&&w<C},_getProjectionToSegment(w,S,C,I,_,E){var P,A,D,V=(w-C)*(w-C)+(S-I)*(S-I);if(V==0)P=w,A=S,D=(_-C)*(_-C)+(E-I)*(E-I);else{var z=((_-w)*(C-w)+(E-S)*(I-S))/V;z<0?(P=w,A=S,D=(w-_)*(w-_)+(S-E)*(S-E)):z>1?(P=C,A=I,D=(C-_)*(C-_)+(I-E)*(I-E)):(P=w+z*(C-w),A=S+z*(I-S),D=(P-_)*(P-_)+(A-E)*(A-E))}return[P,A,D]},_getProjectionToLine(w,S,C){var I=t.Util.cloneObject(w),_=Number.MAX_VALUE;return S.forEach(function(E,P){if(!(!C&&P===S.length-1)){var A=S[(P+1)%S.length],D=t.Util._getProjectionToSegment(E.x,E.y,A.x,A.y,w.x,w.y),V=D[0],z=D[1],K=D[2];K<_&&(I.x=V,I.y=z,_=K)}}),I},_prepareArrayForTween(w,S,C){var I,_=[],E=[];if(w.length>S.length){var P=S;S=w,w=P}for(I=0;I<w.length;I+=2)_.push({x:w[I],y:w[I+1]});for(I=0;I<S.length;I+=2)E.push({x:S[I],y:S[I+1]});var A=[];return E.forEach(function(D){var V=t.Util._getProjectionToLine(D,_,C);A.push(V.x),A.push(V.y)}),A},_prepareToStringify(w){var S;w.visitedByCircularReferenceRemoval=!0;for(var C in w)if(w.hasOwnProperty(C)&&w[C]&&typeof w[C]=="object"){if(S=Object.getOwnPropertyDescriptor(w,C),w[C].visitedByCircularReferenceRemoval||t.Util._isElement(w[C]))if(S.configurable)delete w[C];else return null;else if(t.Util._prepareToStringify(w[C])===null)if(S.configurable)delete w[C];else return null}return delete w.visitedByCircularReferenceRemoval,w},_assign(w,S){for(var C in S)w[C]=S[C];return w},_getFirstPointerId(w){return w.touches?w.changedTouches[0].identifier:w.pointerId||999},releaseCanvas(...w){e.Konva.releaseCanvasOnDestroy&&w.forEach(S=>{S.width=0,S.height=0})},drawRoundedRectPath(w,S,C,I){let _=0,E=0,P=0,A=0;typeof I=="number"?_=E=P=A=Math.min(I,S/2,C/2):(_=Math.min(I[0]||0,S/2,C/2),E=Math.min(I[1]||0,S/2,C/2),A=Math.min(I[2]||0,S/2,C/2),P=Math.min(I[3]||0,S/2,C/2)),w.moveTo(_,0),w.lineTo(S-E,0),w.arc(S-E,E,E,Math.PI*3/2,0,!1),w.lineTo(S,C-A),w.arc(S-A,C-A,A,0,Math.PI/2,!1),w.lineTo(P,C),w.arc(P,C-P,P,Math.PI/2,Math.PI,!1),w.lineTo(0,_),w.arc(_,_,_,Math.PI,Math.PI*3/2,!1)}}})(Dn);var Tn={},kt={},Ge={};Object.defineProperty(Ge,"__esModule",{value:!0}),Ge.getComponentValidator=Ge.getBooleanValidator=Ge.getNumberArrayValidator=Ge.getFunctionValidator=Ge.getStringOrGradientValidator=Ge.getStringValidator=Ge.getNumberOrAutoValidator=Ge.getNumberOrArrayOfNumbersValidator=Ge.getNumberValidator=Ge.alphaComponent=Ge.RGBComponent=void 0;const hs=wt,Vn=Dn;function fs(t){return Vn.Util._isString(t)?'"'+t+'"':Object.prototype.toString.call(t)==="[object Number]"||Vn.Util._isBoolean(t)?t:Object.prototype.toString.call(t)}function IZ(t){return t>255?255:t<0?0:Math.round(t)}Ge.RGBComponent=IZ;function EZ(t){return t>1?1:t<1e-4?1e-4:t}Ge.alphaComponent=EZ;function _Z(){if(hs.Konva.isUnminified)return function(t,e){return Vn.Util._isNumber(t)||Vn.Util.warn(fs(t)+' is a not valid value for "'+e+'" attribute. The value should be a number.'),t}}Ge.getNumberValidator=_Z;function OZ(t){if(hs.Konva.isUnminified)return function(e,n){let r=Vn.Util._isNumber(e),a=Vn.Util._isArray(e)&&e.length==t;return!r&&!a&&Vn.Util.warn(fs(e)+' is a not valid value for "'+n+'" attribute. The value should be a number or Array<number>('+t+")"),e}}Ge.getNumberOrArrayOfNumbersValidator=OZ;function $Z(){if(hs.Konva.isUnminified)return function(t,e){var n=Vn.Util._isNumber(t),r=t==="auto";return n||r||Vn.Util.warn(fs(t)+' is a not valid value for "'+e+'" attribute. The value should be a number or "auto".'),t}}Ge.getNumberOrAutoValidator=$Z;function RZ(){if(hs.Konva.isUnminified)return function(t,e){return Vn.Util._isString(t)||Vn.Util.warn(fs(t)+' is a not valid value for "'+e+'" attribute. The value should be a string.'),t}}Ge.getStringValidator=RZ;function MZ(){if(hs.Konva.isUnminified)return function(t,e){const n=Vn.Util._isString(t),r=Object.prototype.toString.call(t)==="[object CanvasGradient]"||t&&t.addColorStop;return n||r||Vn.Util.warn(fs(t)+' is a not valid value for "'+e+'" attribute. The value should be a string or a native gradient.'),t}}Ge.getStringOrGradientValidator=MZ;function AZ(){if(hs.Konva.isUnminified)return function(t,e){return Vn.Util._isFunction(t)||Vn.Util.warn(fs(t)+' is a not valid value for "'+e+'" attribute. The value should be a function.'),t}}Ge.getFunctionValidator=AZ;function PZ(){if(hs.Konva.isUnminified)return function(t,e){const n=Int8Array?Object.getPrototypeOf(Int8Array):null;return n&&t instanceof n||(Vn.Util._isArray(t)?t.forEach(function(r){Vn.Util._isNumber(r)||Vn.Util.warn('"'+e+'" attribute has non numeric element '+r+". Make sure that all elements are numbers.")}):Vn.Util.warn(fs(t)+' is a not valid value for "'+e+'" attribute. The value should be a array of numbers.')),t}}Ge.getNumberArrayValidator=PZ;function LZ(){if(hs.Konva.isUnminified)return function(t,e){var n=t===!0||t===!1;return n||Vn.Util.warn(fs(t)+' is a not valid value for "'+e+'" attribute. The value should be a boolean.'),t}}Ge.getBooleanValidator=LZ;function DZ(t){if(hs.Konva.isUnminified)return function(e,n){return e==null||Vn.Util.isObject(e)||Vn.Util.warn(fs(e)+' is a not valid value for "'+n+'" attribute. The value should be an object with properties '+t),e}}Ge.getComponentValidator=DZ,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Factory=void 0;const e=Dn,n=Ge;var r="get",a="set";t.Factory={addGetterSetter(i,o,s,l,u){t.Factory.addGetter(i,o,s),t.Factory.addSetter(i,o,l,u),t.Factory.addOverloadedGetterSetter(i,o)},addGetter(i,o,s){var l=r+e.Util._capitalize(o);i.prototype[l]=i.prototype[l]||function(){var u=this.attrs[o];return u===void 0?s:u}},addSetter(i,o,s,l){var u=a+e.Util._capitalize(o);i.prototype[u]||t.Factory.overWriteSetter(i,o,s,l)},overWriteSetter(i,o,s,l){var u=a+e.Util._capitalize(o);i.prototype[u]=function(c){return s&&c!==void 0&&c!==null&&(c=s.call(this,c,o)),this._setAttr(o,c),l&&l.call(this),this}},addComponentsGetterSetter(i,o,s,l,u){var c=s.length,d=e.Util._capitalize,p=r+d(o),f=a+d(o),m,y;i.prototype[p]=function(){var b={};for(m=0;m<c;m++)y=s[m],b[y]=this.getAttr(o+d(y));return b};var x=(0,n.getComponentValidator)(s);i.prototype[f]=function(b){var v=this.attrs[o],w;l&&(b=l.call(this,b)),x&&x.call(this,b,o);for(w in b)b.hasOwnProperty(w)&&this._setAttr(o+d(w),b[w]);return b||s.forEach(S=>{this._setAttr(o+d(S),void 0)}),this._fireChangeEvent(o,v,b),u&&u.call(this),this},t.Factory.addOverloadedGetterSetter(i,o)},addOverloadedGetterSetter(i,o){var s=e.Util._capitalize(o),l=a+s,u=r+s;i.prototype[o]=function(){return arguments.length?(this[l](arguments[0]),this):this[u]()}},addDeprecatedGetterSetter(i,o,s,l){e.Util.error("Adding deprecated "+o);var u=r+e.Util._capitalize(o),c=o+" property is deprecated and will be removed soon. Look at Konva change log for more information.";i.prototype[u]=function(){e.Util.error(c);var d=this.attrs[o];return d===void 0?s:d},t.Factory.addSetter(i,o,l,function(){e.Util.error(c)}),t.Factory.addOverloadedGetterSetter(i,o)},backCompat(i,o){e.Util.each(o,function(s,l){var u=i.prototype[l],c=r+e.Util._capitalize(s),d=a+e.Util._capitalize(s);function p(){u.apply(this,arguments),e.Util.error('"'+s+'" method is deprecated and will be removed soon. Use ""'+l+'" instead.')}i.prototype[s]=p,i.prototype[c]=p,i.prototype[d]=p})},afterSetFilter(){this._filterUpToDate=!1}}}(kt);var no={},gs={};Object.defineProperty(gs,"__esModule",{value:!0}),gs.HitContext=gs.SceneContext=gs.Context=void 0;const h6=Dn,FZ=wt;function BZ(t){var e=[],n=t.length,r=h6.Util,a,i;for(a=0;a<n;a++)i=t[a],r._isNumber(i)?i=Math.round(i*1e3)/1e3:r._isString(i)||(i=i+""),e.push(i);return e}var f6=",",zZ="(",jZ=")",VZ="([",WZ="])",UZ=";",GZ="()",HZ="=",g6=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],qZ=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"];const KZ=100;class xy{constructor(e){this.canvas=e,FZ.Konva.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(e){e.fillEnabled()&&this._fill(e)}_fill(e){}strokeShape(e){e.hasStroke()&&this._stroke(e)}_stroke(e){}fillStrokeShape(e){e.attrs.fillAfterStrokeEnabled?(this.strokeShape(e),this.fillShape(e)):(this.fillShape(e),this.strokeShape(e))}getTrace(e,n){var r=this.traceArr,a=r.length,i="",o,s,l,u;for(o=0;o<a;o++)s=r[o],l=s.method,l?(u=s.args,i+=l,e?i+=GZ:h6.Util._isArray(u[0])?i+=VZ+u.join(f6)+WZ:(n&&(u=u.map(c=>typeof c=="number"?Math.floor(c):c)),i+=zZ+u.join(f6)+jZ)):(i+=s.property,e||(i+=HZ+s.val)),i+=UZ;return i}clearTrace(){this.traceArr=[]}_trace(e){var n=this.traceArr,r;n.push(e),r=n.length,r>=KZ&&n.shift()}reset(){var e=this.getCanvas().getPixelRatio();this.setTransform(1*e,0,0,1*e,0,0)}getCanvas(){return this.canvas}clear(e){var n=this.getCanvas();e?this.clearRect(e.x||0,e.y||0,e.width||0,e.height||0):this.clearRect(0,0,n.getWidth()/n.pixelRatio,n.getHeight()/n.pixelRatio)}_applyLineCap(e){const n=e.attrs.lineCap;n&&this.setAttr("lineCap",n)}_applyOpacity(e){var n=e.getAbsoluteOpacity();n!==1&&this.setAttr("globalAlpha",n)}_applyLineJoin(e){const n=e.attrs.lineJoin;n&&this.setAttr("lineJoin",n)}setAttr(e,n){this._context[e]=n}arc(e,n,r,a,i,o){this._context.arc(e,n,r,a,i,o)}arcTo(e,n,r,a,i){this._context.arcTo(e,n,r,a,i)}beginPath(){this._context.beginPath()}bezierCurveTo(e,n,r,a,i,o){this._context.bezierCurveTo(e,n,r,a,i,o)}clearRect(e,n,r,a){this._context.clearRect(e,n,r,a)}clip(...e){this._context.clip.apply(this._context,e)}closePath(){this._context.closePath()}createImageData(e,n){var r=arguments;if(r.length===2)return this._context.createImageData(e,n);if(r.length===1)return this._context.createImageData(e)}createLinearGradient(e,n,r,a){return this._context.createLinearGradient(e,n,r,a)}createPattern(e,n){return this._context.createPattern(e,n)}createRadialGradient(e,n,r,a,i,o){return this._context.createRadialGradient(e,n,r,a,i,o)}drawImage(e,n,r,a,i,o,s,l,u){var c=arguments,d=this._context;c.length===3?d.drawImage(e,n,r):c.length===5?d.drawImage(e,n,r,a,i):c.length===9&&d.drawImage(e,n,r,a,i,o,s,l,u)}ellipse(e,n,r,a,i,o,s,l){this._context.ellipse(e,n,r,a,i,o,s,l)}isPointInPath(e,n,r,a){return r?this._context.isPointInPath(r,e,n,a):this._context.isPointInPath(e,n,a)}fill(...e){this._context.fill.apply(this._context,e)}fillRect(e,n,r,a){this._context.fillRect(e,n,r,a)}strokeRect(e,n,r,a){this._context.strokeRect(e,n,r,a)}fillText(e,n,r,a){a?this._context.fillText(e,n,r,a):this._context.fillText(e,n,r)}measureText(e){return this._context.measureText(e)}getImageData(e,n,r,a){return this._context.getImageData(e,n,r,a)}lineTo(e,n){this._context.lineTo(e,n)}moveTo(e,n){this._context.moveTo(e,n)}rect(e,n,r,a){this._context.rect(e,n,r,a)}roundRect(e,n,r,a,i){this._context.roundRect(e,n,r,a,i)}putImageData(e,n,r){this._context.putImageData(e,n,r)}quadraticCurveTo(e,n,r,a){this._context.quadraticCurveTo(e,n,r,a)}restore(){this._context.restore()}rotate(e){this._context.rotate(e)}save(){this._context.save()}scale(e,n){this._context.scale(e,n)}setLineDash(e){this._context.setLineDash?this._context.setLineDash(e):"mozDash"in this._context?this._context.mozDash=e:"webkitLineDash"in this._context&&(this._context.webkitLineDash=e)}getLineDash(){return this._context.getLineDash()}setTransform(e,n,r,a,i,o){this._context.setTransform(e,n,r,a,i,o)}stroke(e){e?this._context.stroke(e):this._context.stroke()}strokeText(e,n,r,a){this._context.strokeText(e,n,r,a)}transform(e,n,r,a,i,o){this._context.transform(e,n,r,a,i,o)}translate(e,n){this._context.translate(e,n)}_enableTrace(){var e=this,n=g6.length,r=this.setAttr,a,i,o=function(s){var l=e[s],u;e[s]=function(){return i=BZ(Array.prototype.slice.call(arguments,0)),u=l.apply(e,arguments),e._trace({method:s,args:i}),u}};for(a=0;a<n;a++)o(g6[a]);e.setAttr=function(){r.apply(e,arguments);var s=arguments[0],l=arguments[1];(s==="shadowOffsetX"||s==="shadowOffsetY"||s==="shadowBlur")&&(l=l/this.canvas.getPixelRatio()),e._trace({property:s,val:l})}}_applyGlobalCompositeOperation(e){const n=e.attrs.globalCompositeOperation;var r=!n||n==="source-over";r||this.setAttr("globalCompositeOperation",n)}}gs.Context=xy,qZ.forEach(function(t){Object.defineProperty(xy.prototype,t,{get(){return this._context[t]},set(e){this._context[t]=e}})});class XZ extends xy{constructor(e,{willReadFrequently:n=!1}={}){super(e),this._context=e._canvas.getContext("2d",{willReadFrequently:n})}_fillColor(e){var n=e.fill();this.setAttr("fillStyle",n),e._fillFunc(this)}_fillPattern(e){this.setAttr("fillStyle",e._getFillPattern()),e._fillFunc(this)}_fillLinearGradient(e){var n=e._getLinearGradient();n&&(this.setAttr("fillStyle",n),e._fillFunc(this))}_fillRadialGradient(e){const n=e._getRadialGradient();n&&(this.setAttr("fillStyle",n),e._fillFunc(this))}_fill(e){const n=e.fill(),r=e.getFillPriority();if(n&&r==="color"){this._fillColor(e);return}const a=e.getFillPatternImage();if(a&&r==="pattern"){this._fillPattern(e);return}const i=e.getFillLinearGradientColorStops();if(i&&r==="linear-gradient"){this._fillLinearGradient(e);return}const o=e.getFillRadialGradientColorStops();if(o&&r==="radial-gradient"){this._fillRadialGradient(e);return}n?this._fillColor(e):a?this._fillPattern(e):i?this._fillLinearGradient(e):o&&this._fillRadialGradient(e)}_strokeLinearGradient(e){const n=e.getStrokeLinearGradientStartPoint(),r=e.getStrokeLinearGradientEndPoint(),a=e.getStrokeLinearGradientColorStops(),i=this.createLinearGradient(n.x,n.y,r.x,r.y);if(a){for(var o=0;o<a.length;o+=2)i.addColorStop(a[o],a[o+1]);this.setAttr("strokeStyle",i)}}_stroke(e){var n=e.dash(),r=e.getStrokeScaleEnabled();if(e.hasStroke()){if(!r){this.save();var a=this.getCanvas().getPixelRatio();this.setTransform(a,0,0,a,0,0)}this._applyLineCap(e),n&&e.dashEnabled()&&(this.setLineDash(n),this.setAttr("lineDashOffset",e.dashOffset())),this.setAttr("lineWidth",e.strokeWidth()),e.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)");var i=e.getStrokeLinearGradientColorStops();i?this._strokeLinearGradient(e):this.setAttr("strokeStyle",e.stroke()),e._strokeFunc(this),r||this.restore()}}_applyShadow(e){var n,r,a,i=(n=e.getShadowRGBA())!==null&&n!==void 0?n:"black",o=(r=e.getShadowBlur())!==null&&r!==void 0?r:5,s=(a=e.getShadowOffset())!==null&&a!==void 0?a:{x:0,y:0},l=e.getAbsoluteScale(),u=this.canvas.getPixelRatio(),c=l.x*u,d=l.y*u;this.setAttr("shadowColor",i),this.setAttr("shadowBlur",o*Math.min(Math.abs(c),Math.abs(d))),this.setAttr("shadowOffsetX",s.x*c),this.setAttr("shadowOffsetY",s.y*d)}}gs.SceneContext=XZ;class YZ extends xy{constructor(e){super(e),this._context=e._canvas.getContext("2d",{willReadFrequently:!0})}_fill(e){this.save(),this.setAttr("fillStyle",e.colorKey),e._fillFuncHit(this),this.restore()}strokeShape(e){e.hasHitStroke()&&this._stroke(e)}_stroke(e){if(e.hasHitStroke()){const i=e.getStrokeScaleEnabled();if(!i){this.save();var n=this.getCanvas().getPixelRatio();this.setTransform(n,0,0,n,0,0)}this._applyLineCap(e);var r=e.hitStrokeWidth(),a=r==="auto"?e.strokeWidth():r;this.setAttr("lineWidth",a),this.setAttr("strokeStyle",e.colorKey),e._strokeFuncHit(this),i||this.restore()}}}gs.HitContext=YZ,Object.defineProperty(no,"__esModule",{value:!0}),no.HitCanvas=no.SceneCanvas=no.Canvas=void 0;const wy=Dn,m6=gs,y6=wt,QZ=kt,ZZ=Ge;var ky;function JZ(){if(ky)return ky;var t=wy.Util.createCanvasElement(),e=t.getContext("2d");return ky=function(){var n=y6.Konva._global.devicePixelRatio||1,r=e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1;return n/r}(),wy.Util.releaseCanvas(t),ky}class Sy{constructor(e){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;var n=e||{},r=n.pixelRatio||y6.Konva.pixelRatio||JZ();this.pixelRatio=r,this._canvas=wy.Util.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(e){var n=this.pixelRatio;this.pixelRatio=e,this.setSize(this.getWidth()/n,this.getHeight()/n)}setWidth(e){this.width=this._canvas.width=e*this.pixelRatio,this._canvas.style.width=e+"px";var n=this.pixelRatio,r=this.getContext()._context;r.scale(n,n)}setHeight(e){this.height=this._canvas.height=e*this.pixelRatio,this._canvas.style.height=e+"px";var n=this.pixelRatio,r=this.getContext()._context;r.scale(n,n)}getWidth(){return this.width}getHeight(){return this.height}setSize(e,n){this.setWidth(e||0),this.setHeight(n||0)}toDataURL(e,n){try{return this._canvas.toDataURL(e,n)}catch{try{return this._canvas.toDataURL()}catch(r){return wy.Util.error("Unable to get data URL. "+r.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}}no.Canvas=Sy,QZ.Factory.addGetterSetter(Sy,"pixelRatio",void 0,(0,ZZ.getNumberValidator)());class eJ extends Sy{constructor(e={width:0,height:0,willReadFrequently:!1}){super(e),this.context=new m6.SceneContext(this,{willReadFrequently:e.willReadFrequently}),this.setSize(e.width,e.height)}}no.SceneCanvas=eJ;class tJ extends Sy{constructor(e={width:0,height:0}){super(e),this.hitCanvas=!0,this.context=new m6.HitContext(this),this.setSize(e.width,e.height)}}no.HitCanvas=tJ;var Cy={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.DD=void 0;const e=wt,n=Dn;t.DD={get isDragging(){var r=!1;return t.DD._dragElements.forEach(a=>{a.dragStatus==="dragging"&&(r=!0)}),r},justDragged:!1,get node(){var r;return t.DD._dragElements.forEach(a=>{r=a.node}),r},_dragElements:new Map,_drag(r){const a=[];t.DD._dragElements.forEach((i,o)=>{const{node:s}=i,l=s.getStage();l.setPointersPositions(r),i.pointerId===void 0&&(i.pointerId=n.Util._getFirstPointerId(r));const u=l._changedPointerPositions.find(p=>p.id===i.pointerId);if(u){if(i.dragStatus!=="dragging"){var c=s.dragDistance(),d=Math.max(Math.abs(u.x-i.startPointerPos.x),Math.abs(u.y-i.startPointerPos.y));if(d<c||(s.startDrag({evt:r}),!s.isDragging()))return}s._setDragPosition(r,i),a.push(s)}}),a.forEach(i=>{i.fire("dragmove",{type:"dragmove",target:i,evt:r},!0)})},_endDragBefore(r){const a=[];t.DD._dragElements.forEach(i=>{const{node:o}=i,s=o.getStage();if(r&&s.setPointersPositions(r),!s._changedPointerPositions.find(u=>u.id===i.pointerId))return;(i.dragStatus==="dragging"||i.dragStatus==="stopped")&&(t.DD.justDragged=!0,e.Konva._mouseListenClick=!1,e.Konva._touchListenClick=!1,e.Konva._pointerListenClick=!1,i.dragStatus="stopped");const l=i.node.getLayer()||i.node instanceof e.Konva.Stage&&i.node;l&&a.indexOf(l)===-1&&a.push(l)}),a.forEach(i=>{i.draw()})},_endDragAfter(r){t.DD._dragElements.forEach((a,i)=>{a.dragStatus==="stopped"&&a.node.fire("dragend",{type:"dragend",target:a.node,evt:r},!0),a.dragStatus!=="dragging"&&t.DD._dragElements.delete(i)})}},e.Konva.isBrowser&&(window.addEventListener("mouseup",t.DD._endDragBefore,!0),window.addEventListener("touchend",t.DD._endDragBefore,!0),window.addEventListener("mousemove",t.DD._drag),window.addEventListener("touchmove",t.DD._drag),window.addEventListener("mouseup",t.DD._endDragAfter,!1),window.addEventListener("touchend",t.DD._endDragAfter,!1))})(Cy),Object.defineProperty(Tn,"__esModule",{value:!0}),Tn.Node=void 0;const _t=Dn,lf=kt,uf=no,_u=wt,Ci=Cy,Xn=Ge;var Ny="absoluteOpacity",Ty="allEventListeners",ms="absoluteTransform",b6="absoluteScale",Ou="canvas",nJ="Change",rJ="children",aJ="konva",JN="listening",v6="mouseenter",x6="mouseleave",w6="set",k6="Shape",Iy=" ",S6="stage",wl="transform",iJ="Stage",e3="visible",oJ=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(Iy);let sJ=1;class lt{constructor(e){this._id=sJ++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(e),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(e){(e===wl||e===ms)&&this._cache.get(e)?this._cache.get(e).dirty=!0:e?this._cache.delete(e):this._cache.clear()}_getCache(e,n){var r=this._cache.get(e),a=e===wl||e===ms,i=r===void 0||a&&r.dirty===!0;return i&&(r=n.call(this),this._cache.set(e,r)),r}_calculate(e,n,r){if(!this._attachedDepsListeners.get(e)){const a=n.map(i=>i+"Change.konva").join(Iy);this.on(a,()=>{this._clearCache(e)}),this._attachedDepsListeners.set(e,!0)}return this._getCache(e,r)}_getCanvasCache(){return this._cache.get(Ou)}_clearSelfAndDescendantCache(e){this._clearCache(e),e===ms&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(Ou)){const{scene:e,filter:n,hit:r}=this._cache.get(Ou);_t.Util.releaseCanvas(e,n,r),this._cache.delete(Ou)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(e){var n=e||{},r={};(n.x===void 0||n.y===void 0||n.width===void 0||n.height===void 0)&&(r=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));var a=Math.ceil(n.width||r.width),i=Math.ceil(n.height||r.height),o=n.pixelRatio,s=n.x===void 0?Math.floor(r.x):n.x,l=n.y===void 0?Math.floor(r.y):n.y,u=n.offset||0,c=n.drawBorder||!1,d=n.hitCanvasPixelRatio||1;if(!a||!i){_t.Util.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}const p=Math.abs(Math.round(r.x)-s)>.5?1:0,f=Math.abs(Math.round(r.y)-l)>.5?1:0;a+=u*2+p,i+=u*2+f,s-=u,l-=u;var m=new uf.SceneCanvas({pixelRatio:o,width:a,height:i}),y=new uf.SceneCanvas({pixelRatio:o,width:0,height:0,willReadFrequently:!0}),x=new uf.HitCanvas({pixelRatio:d,width:a,height:i}),b=m.getContext(),v=x.getContext();return x.isCache=!0,m.isCache=!0,this._cache.delete(Ou),this._filterUpToDate=!1,n.imageSmoothingEnabled===!1&&(m.getContext()._context.imageSmoothingEnabled=!1,y.getContext()._context.imageSmoothingEnabled=!1),b.save(),v.save(),b.translate(-s,-l),v.translate(-s,-l),this._isUnderCache=!0,this._clearSelfAndDescendantCache(Ny),this._clearSelfAndDescendantCache(b6),this.drawScene(m,this),this.drawHit(x,this),this._isUnderCache=!1,b.restore(),v.restore(),c&&(b.save(),b.beginPath(),b.rect(0,0,a,i),b.closePath(),b.setAttr("strokeStyle","red"),b.setAttr("lineWidth",5),b.stroke(),b.restore()),this._cache.set(Ou,{scene:m,filter:y,hit:x,x:s,y:l}),this._requestDraw(),this}isCached(){return this._cache.has(Ou)}getClientRect(e){throw new Error('abstract "getClientRect" method call')}_transformedRect(e,n){var r=[{x:e.x,y:e.y},{x:e.x+e.width,y:e.y},{x:e.x+e.width,y:e.y+e.height},{x:e.x,y:e.y+e.height}],a=1/0,i=1/0,o=-1/0,s=-1/0,l=this.getAbsoluteTransform(n);return r.forEach(function(u){var c=l.point(u);a===void 0&&(a=o=c.x,i=s=c.y),a=Math.min(a,c.x),i=Math.min(i,c.y),o=Math.max(o,c.x),s=Math.max(s,c.y)}),{x:a,y:i,width:o-a,height:s-i}}_drawCachedSceneCanvas(e){e.save(),e._applyOpacity(this),e._applyGlobalCompositeOperation(this);const n=this._getCanvasCache();e.translate(n.x,n.y);var r=this._getCachedSceneCanvas(),a=r.pixelRatio;e.drawImage(r._canvas,0,0,r.width/a,r.height/a),e.restore()}_drawCachedHitCanvas(e){var n=this._getCanvasCache(),r=n.hit;e.save(),e.translate(n.x,n.y),e.drawImage(r._canvas,0,0,r.width/r.pixelRatio,r.height/r.pixelRatio),e.restore()}_getCachedSceneCanvas(){var e=this.filters(),n=this._getCanvasCache(),r=n.scene,a=n.filter,i=a.getContext(),o,s,l,u;if(e){if(!this._filterUpToDate){var c=r.pixelRatio;a.setSize(r.width/r.pixelRatio,r.height/r.pixelRatio);try{for(o=e.length,i.clear(),i.drawImage(r._canvas,0,0,r.getWidth()/c,r.getHeight()/c),s=i.getImageData(0,0,a.getWidth(),a.getHeight()),l=0;l<o;l++){if(u=e[l],typeof u!="function"){_t.Util.error("Filter should be type of function, but got "+typeof u+" instead. Please check correct filters");continue}u.call(this,s),i.putImageData(s,0,0)}}catch(d){_t.Util.error("Unable to apply filter. "+d.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return a}return r}on(e,n){if(this._cache&&this._cache.delete(Ty),arguments.length===3)return this._delegate.apply(this,arguments);var r=e.split(Iy),a=r.length,i,o,s,l,u;for(i=0;i<a;i++)o=r[i],s=o.split("."),l=s[0],u=s[1]||"",this.eventListeners[l]||(this.eventListeners[l]=[]),this.eventListeners[l].push({name:u,handler:n});return this}off(e,n){var r=(e||"").split(Iy),a=r.length,i,o,s,l,u,c;if(this._cache&&this._cache.delete(Ty),!e)for(o in this.eventListeners)this._off(o);for(i=0;i<a;i++)if(s=r[i],l=s.split("."),u=l[0],c=l[1],u)this.eventListeners[u]&&this._off(u,c,n);else for(o in this.eventListeners)this._off(o,c,n);return this}dispatchEvent(e){var n={target:this,type:e.type,evt:e};return this.fire(e.type,n),this}addEventListener(e,n){return this.on(e,function(r){n.call(this,r.evt)}),this}removeEventListener(e){return this.off(e),this}_delegate(e,n,r){var a=this;this.on(e,function(i){for(var o=i.target.findAncestors(n,!0,a),s=0;s<o.length;s++)i=_t.Util.cloneObject(i),i.currentTarget=o[s],r.call(o[s],i)})}remove(){return this.isDragging()&&this.stopDrag(),Ci.DD._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(ms),this._clearSelfAndDescendantCache(Ny),this._clearSelfAndDescendantCache(b6),this._clearSelfAndDescendantCache(S6),this._clearSelfAndDescendantCache(e3),this._clearSelfAndDescendantCache(JN)}_remove(){this._clearCaches();var e=this.getParent();e&&e.children&&(e.children.splice(this.index,1),e._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(e){var n="get"+_t.Util._capitalize(e);return _t.Util._isFunction(this[n])?this[n]():this.attrs[e]}getAncestors(){for(var e=this.getParent(),n=[];e;)n.push(e),e=e.getParent();return n}getAttrs(){return this.attrs||{}}setAttrs(e){return this._batchTransformChanges(()=>{var n,r;if(!e)return this;for(n in e)n!==rJ&&(r=w6+_t.Util._capitalize(n),_t.Util._isFunction(this[r])?this[r](e[n]):this._setAttr(n,e[n]))}),this}isListening(){return this._getCache(JN,this._isListening)}_isListening(e){if(!this.listening())return!1;const n=this.getParent();return n&&n!==e&&this!==e?n._isListening(e):!0}isVisible(){return this._getCache(e3,this._isVisible)}_isVisible(e){if(!this.visible())return!1;const n=this.getParent();return n&&n!==e&&this!==e?n._isVisible(e):!0}shouldDrawHit(e,n=!1){if(e)return this._isVisible(e)&&this._isListening(e);var r=this.getLayer(),a=!1;Ci.DD._dragElements.forEach(o=>{o.dragStatus==="dragging"&&(o.node.nodeType==="Stage"||o.node.getLayer()===r)&&(a=!0)});var i=!n&&!_u.Konva.hitOnDragEnabled&&a;return this.isListening()&&this.isVisible()&&!i}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){var e=this.getDepth(),n=this,r=0,a,i,o,s;function l(c){for(a=[],i=c.length,o=0;o<i;o++)s=c[o],r++,s.nodeType!==k6&&(a=a.concat(s.getChildren().slice())),s._id===n._id&&(o=i);a.length>0&&a[0].getDepth()<=e&&l(a)}const u=this.getStage();return n.nodeType!==iJ&&u&&l(u.getChildren()),r}getDepth(){for(var e=0,n=this.parent;n;)e++,n=n.parent;return e}_batchTransformChanges(e){this._batchingTransformChange=!0,e(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(wl),this._clearSelfAndDescendantCache(ms)),this._needClearTransformCache=!1}setPosition(e){return this._batchTransformChanges(()=>{this.x(e.x),this.y(e.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){const e=this.getStage();if(!e)return null;var n=e.getPointerPosition();if(!n)return null;var r=this.getAbsoluteTransform().copy();return r.invert(),r.point(n)}getAbsolutePosition(e){let n=!1,r=this.parent;for(;r;){if(r.isCached()){n=!0;break}r=r.parent}n&&!e&&(e=!0);var a=this.getAbsoluteTransform(e).getMatrix(),i=new _t.Transform,o=this.offset();return i.m=a.slice(),i.translate(o.x,o.y),i.getTranslation()}setAbsolutePosition(e){const{x:n,y:r,...a}=this._clearTransform();this.attrs.x=n,this.attrs.y=r,this._clearCache(wl);var i=this._getAbsoluteTransform().copy();return i.invert(),i.translate(e.x,e.y),e={x:this.attrs.x+i.getTranslation().x,y:this.attrs.y+i.getTranslation().y},this._setTransform(a),this.setPosition({x:e.x,y:e.y}),this._clearCache(wl),this._clearSelfAndDescendantCache(ms),this}_setTransform(e){var n;for(n in e)this.attrs[n]=e[n]}_clearTransform(){var e={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,e}move(e){var n=e.x,r=e.y,a=this.x(),i=this.y();return n!==void 0&&(a+=n),r!==void 0&&(i+=r),this.setPosition({x:a,y:i}),this}_eachAncestorReverse(e,n){var r=[],a=this.getParent(),i,o;if(!(n&&n._id===this._id)){for(r.unshift(this);a&&(!n||a._id!==n._id);)r.unshift(a),a=a.parent;for(i=r.length,o=0;o<i;o++)e(r[o])}}rotate(e){return this.rotation(this.rotation()+e),this}moveToTop(){if(!this.parent)return _t.Util.warn("Node has no parent. moveToTop function is ignored."),!1;var e=this.index,n=this.parent.getChildren().length;return e<n-1?(this.parent.children.splice(e,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return _t.Util.warn("Node has no parent. moveUp function is ignored."),!1;var e=this.index,n=this.parent.getChildren().length;return e<n-1?(this.parent.children.splice(e,1),this.parent.children.splice(e+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return _t.Util.warn("Node has no parent. moveDown function is ignored."),!1;var e=this.index;return e>0?(this.parent.children.splice(e,1),this.parent.children.splice(e-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return _t.Util.warn("Node has no parent. moveToBottom function is ignored."),!1;var e=this.index;return e>0?(this.parent.children.splice(e,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(e){if(!this.parent)return _t.Util.warn("Node has no parent. zIndex parameter is ignored."),this;(e<0||e>=this.parent.children.length)&&_t.Util.warn("Unexpected value "+e+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");var n=this.index;return this.parent.children.splice(n,1),this.parent.children.splice(e,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(Ny,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){var e=this.opacity(),n=this.getParent();return n&&!n._isUnderCache&&(e*=n.getAbsoluteOpacity()),e}moveTo(e){return this.getParent()!==e&&(this._remove(),e.add(this)),this}toObject(){var e=this.getAttrs(),n,r,a,i,o;const s={attrs:{},className:this.getClassName()};for(n in e)r=e[n],o=_t.Util.isObject(r)&&!_t.Util._isPlainObject(r)&&!_t.Util._isArray(r),!o&&(a=typeof this[n]=="function"&&this[n],delete e[n],i=a?a.call(this):null,e[n]=r,i!==r&&(s.attrs[n]=r));return _t.Util._prepareToStringify(s)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(e,n,r){var a=[];n&&this._isMatch(e)&&a.push(this);for(var i=this.parent;i;){if(i===r)return a;i._isMatch(e)&&a.push(i),i=i.parent}return a}isAncestorOf(e){return!1}findAncestor(e,n,r){return this.findAncestors(e,n,r)[0]}_isMatch(e){if(!e)return!1;if(typeof e=="function")return e(this);var n=e.replace(/ /g,"").split(","),r=n.length,a,i;for(a=0;a<r;a++)if(i=n[a],_t.Util.isValidSelector(i)||(_t.Util.warn('Selector "'+i+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),_t.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),_t.Util.warn("Konva is awesome, right?")),i.charAt(0)==="#"){if(this.id()===i.slice(1))return!0}else if(i.charAt(0)==="."){if(this.hasName(i.slice(1)))return!0}else if(this.className===i||this.nodeType===i)return!0;return!1}getLayer(){var e=this.getParent();return e?e.getLayer():null}getStage(){return this._getCache(S6,this._getStage)}_getStage(){var e=this.getParent();return e?e.getStage():null}fire(e,n={},r){return n.target=n.target||this,r?this._fireAndBubble(e,n):this._fire(e,n),this}getAbsoluteTransform(e){return e?this._getAbsoluteTransform(e):this._getCache(ms,this._getAbsoluteTransform)}_getAbsoluteTransform(e){var n;if(e)return n=new _t.Transform,this._eachAncestorReverse(function(a){var i=a.transformsEnabled();i==="all"?n.multiply(a.getTransform()):i==="position"&&n.translate(a.x()-a.offsetX(),a.y()-a.offsetY())},e),n;n=this._cache.get(ms)||new _t.Transform,this.parent?this.parent.getAbsoluteTransform().copyInto(n):n.reset();var r=this.transformsEnabled();if(r==="all")n.multiply(this.getTransform());else if(r==="position"){const a=this.attrs.x||0,i=this.attrs.y||0,o=this.attrs.offsetX||0,s=this.attrs.offsetY||0;n.translate(a-o,i-s)}return n.dirty=!1,n}getAbsoluteScale(e){for(var n=this;n;)n._isUnderCache&&(e=n),n=n.getParent();const r=this.getAbsoluteTransform(e).decompose();return{x:r.scaleX,y:r.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(wl,this._getTransform)}_getTransform(){var e,n,r=this._cache.get(wl)||new _t.Transform;r.reset();var a=this.x(),i=this.y(),o=_u.Konva.getAngle(this.rotation()),s=(e=this.attrs.scaleX)!==null&&e!==void 0?e:1,l=(n=this.attrs.scaleY)!==null&&n!==void 0?n:1,u=this.attrs.skewX||0,c=this.attrs.skewY||0,d=this.attrs.offsetX||0,p=this.attrs.offsetY||0;return(a!==0||i!==0)&&r.translate(a,i),o!==0&&r.rotate(o),(u!==0||c!==0)&&r.skew(u,c),(s!==1||l!==1)&&r.scale(s,l),(d!==0||p!==0)&&r.translate(-1*d,-1*p),r.dirty=!1,r}clone(e){var n=_t.Util.cloneObject(this.attrs),r,a,i,o,s;for(r in e)n[r]=e[r];var l=new this.constructor(n);for(r in this.eventListeners)for(a=this.eventListeners[r],i=a.length,o=0;o<i;o++)s=a[o],s.name.indexOf(aJ)<0&&(l.eventListeners[r]||(l.eventListeners[r]=[]),l.eventListeners[r].push(s));return l}_toKonvaCanvas(e){e=e||{};var n=this.getClientRect(),r=this.getStage(),a=e.x!==void 0?e.x:Math.floor(n.x),i=e.y!==void 0?e.y:Math.floor(n.y),o=e.pixelRatio||1,s=new uf.SceneCanvas({width:e.width||Math.ceil(n.width)||(r?r.width():0),height:e.height||Math.ceil(n.height)||(r?r.height():0),pixelRatio:o}),l=s.getContext();const u=new uf.SceneCanvas({width:s.width/s.pixelRatio+Math.abs(a),height:s.height/s.pixelRatio+Math.abs(i),pixelRatio:s.pixelRatio});return e.imageSmoothingEnabled===!1&&(l._context.imageSmoothingEnabled=!1),l.save(),(a||i)&&l.translate(-1*a,-1*i),this.drawScene(s,void 0,u),l.restore(),s}toCanvas(e){return this._toKonvaCanvas(e)._canvas}toDataURL(e){e=e||{};var n=e.mimeType||null,r=e.quality||null,a=this._toKonvaCanvas(e).toDataURL(n,r);return e.callback&&e.callback(a),a}toImage(e){return new Promise((n,r)=>{try{const a=e?.callback;a&&delete e.callback,_t.Util._urlToImage(this.toDataURL(e),function(i){n(i),a?.(i)})}catch(a){r(a)}})}toBlob(e){return new Promise((n,r)=>{try{const a=e?.callback;a&&delete e.callback,this.toCanvas(e).toBlob(i=>{n(i),a?.(i)},e?.mimeType,e?.quality)}catch(a){r(a)}})}setSize(e){return this.width(e.width),this.height(e.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():_u.Konva.dragDistance}_off(e,n,r){var a=this.eventListeners[e],i,o,s;for(i=0;i<a.length;i++)if(o=a[i].name,s=a[i].handler,(o!=="konva"||n==="konva")&&(!n||o===n)&&(!r||r===s)){if(a.splice(i,1),a.length===0){delete this.eventListeners[e];break}i--}}_fireChangeEvent(e,n,r){this._fire(e+nJ,{oldVal:n,newVal:r})}addName(e){if(!this.hasName(e)){var n=this.name(),r=n?n+" "+e:e;this.name(r)}return this}hasName(e){if(!e)return!1;const n=this.name();if(!n)return!1;var r=(n||"").split(/\s/g);return r.indexOf(e)!==-1}removeName(e){var n=(this.name()||"").split(/\s/g),r=n.indexOf(e);return r!==-1&&(n.splice(r,1),this.name(n.join(" "))),this}setAttr(e,n){var r=this[w6+_t.Util._capitalize(e)];return _t.Util._isFunction(r)?r.call(this,n):this._setAttr(e,n),this}_requestDraw(){if(_u.Konva.autoDrawEnabled){const e=this.getLayer()||this.getStage();e?.batchDraw()}}_setAttr(e,n){var r=this.attrs[e];r===n&&!_t.Util.isObject(n)||(n==null?delete this.attrs[e]:this.attrs[e]=n,this._shouldFireChangeEvents&&this._fireChangeEvent(e,r,n),this._requestDraw())}_setComponentAttr(e,n,r){var a;r!==void 0&&(a=this.attrs[e],a||(this.attrs[e]=this.getAttr(e)),this.attrs[e][n]=r,this._fireChangeEvent(e,a,r))}_fireAndBubble(e,n,r){n&&this.nodeType===k6&&(n.target=this);var a=(e===v6||e===x6)&&(r&&(this===r||this.isAncestorOf&&this.isAncestorOf(r))||this.nodeType==="Stage"&&!r);if(!a){this._fire(e,n);var i=(e===v6||e===x6)&&r&&r.isAncestorOf&&r.isAncestorOf(this)&&!r.isAncestorOf(this.parent);(n&&!n.cancelBubble||!n)&&this.parent&&this.parent.isListening()&&!i&&(r&&r.parent?this._fireAndBubble.call(this.parent,e,n,r):this._fireAndBubble.call(this.parent,e,n))}}_getProtoListeners(e){var n,r,a;const i=(n=this._cache.get(Ty))!==null&&n!==void 0?n:{};let o=i?.[e];if(o===void 0){o=[];let s=Object.getPrototypeOf(this);for(;s;){const l=(a=(r=s.eventListeners)===null||r===void 0?void 0:r[e])!==null&&a!==void 0?a:[];o.push(...l),s=Object.getPrototypeOf(s)}i[e]=o,this._cache.set(Ty,i)}return o}_fire(e,n){n=n||{},n.currentTarget=this,n.type=e;const r=this._getProtoListeners(e);if(r)for(var a=0;a<r.length;a++)r[a].handler.call(this,n);const i=this.eventListeners[e];if(i)for(var a=0;a<i.length;a++)i[a].handler.call(this,n)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(e){var n=e?e.pointerId:void 0,r=this.getStage(),a=this.getAbsolutePosition();if(r){var i=r._getPointerById(n)||r._changedPointerPositions[0]||a;Ci.DD._dragElements.set(this._id,{node:this,startPointerPos:i,offset:{x:i.x-a.x,y:i.y-a.y},dragStatus:"ready",pointerId:n})}}startDrag(e,n=!0){Ci.DD._dragElements.has(this._id)||this._createDragElement(e);const r=Ci.DD._dragElements.get(this._id);r.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:e&&e.evt},n)}_setDragPosition(e,n){const r=this.getStage()._getPointerById(n.pointerId);if(r){var a={x:r.x-n.offset.x,y:r.y-n.offset.y},i=this.dragBoundFunc();if(i!==void 0){const o=i.call(this,a,e);o?a=o:_t.Util.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==a.x||this._lastPos.y!==a.y)&&(this.setAbsolutePosition(a),this._requestDraw()),this._lastPos=a}}stopDrag(e){const n=Ci.DD._dragElements.get(this._id);n&&(n.dragStatus="stopped"),Ci.DD._endDragBefore(e),Ci.DD._endDragAfter(e)}setDraggable(e){this._setAttr("draggable",e),this._dragChange()}isDragging(){const e=Ci.DD._dragElements.get(this._id);return e?e.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(e){var n=e.evt.button!==void 0,r=!n||_u.Konva.dragButtons.indexOf(e.evt.button)>=0;if(r&&!this.isDragging()){var a=!1;Ci.DD._dragElements.forEach(i=>{this.isAncestorOf(i.node)&&(a=!0)}),a||this._createDragElement(e)}})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{this._dragCleanup();var e=this.getStage();if(!e)return;const n=Ci.DD._dragElements.get(this._id),r=n&&n.dragStatus==="dragging",a=n&&n.dragStatus==="ready";r?this.stopDrag():a&&Ci.DD._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(e={x:0,y:0}){const n=this.getStage();if(!n)return!1;const r={x:-e.x,y:-e.y,width:n.width()+2*e.x,height:n.height()+2*e.y};return _t.Util.haveIntersection(r,this.getClientRect())}static create(e,n){return _t.Util._isString(e)&&(e=JSON.parse(e)),this._createNode(e,n)}static _createNode(e,n){var r=lt.prototype.getClassName.call(e),a=e.children,i,o,s;n&&(e.attrs.container=n),_u.Konva[r]||(_t.Util.warn('Can not find a node with class name "'+r+'". Fallback to "Shape".'),r="Shape");const l=_u.Konva[r];if(i=new l(e.attrs),a)for(o=a.length,s=0;s<o;s++)i.add(lt._createNode(a[s]));return i}}Tn.Node=lt,lt.prototype.nodeType="Node",lt.prototype._attrsAffectingSize=[],lt.prototype.eventListeners={},lt.prototype.on.call(lt.prototype,oJ,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(wl),this._clearSelfAndDescendantCache(ms)}),lt.prototype.on.call(lt.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(e3)}),lt.prototype.on.call(lt.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(JN)}),lt.prototype.on.call(lt.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(Ny)});const sn=lf.Factory.addGetterSetter;sn(lt,"zIndex"),sn(lt,"absolutePosition"),sn(lt,"position"),sn(lt,"x",0,(0,Xn.getNumberValidator)()),sn(lt,"y",0,(0,Xn.getNumberValidator)()),sn(lt,"globalCompositeOperation","source-over",(0,Xn.getStringValidator)()),sn(lt,"opacity",1,(0,Xn.getNumberValidator)()),sn(lt,"name","",(0,Xn.getStringValidator)()),sn(lt,"id","",(0,Xn.getStringValidator)()),sn(lt,"rotation",0,(0,Xn.getNumberValidator)()),lf.Factory.addComponentsGetterSetter(lt,"scale",["x","y"]),sn(lt,"scaleX",1,(0,Xn.getNumberValidator)()),sn(lt,"scaleY",1,(0,Xn.getNumberValidator)()),lf.Factory.addComponentsGetterSetter(lt,"skew",["x","y"]),sn(lt,"skewX",0,(0,Xn.getNumberValidator)()),sn(lt,"skewY",0,(0,Xn.getNumberValidator)()),lf.Factory.addComponentsGetterSetter(lt,"offset",["x","y"]),sn(lt,"offsetX",0,(0,Xn.getNumberValidator)()),sn(lt,"offsetY",0,(0,Xn.getNumberValidator)()),sn(lt,"dragDistance",null,(0,Xn.getNumberValidator)()),sn(lt,"width",0,(0,Xn.getNumberValidator)()),sn(lt,"height",0,(0,Xn.getNumberValidator)()),sn(lt,"listening",!0,(0,Xn.getBooleanValidator)()),sn(lt,"preventDefault",!0,(0,Xn.getBooleanValidator)()),sn(lt,"filters",null,function(t){return this._filterUpToDate=!1,t}),sn(lt,"visible",!0,(0,Xn.getBooleanValidator)()),sn(lt,"transformsEnabled","all",(0,Xn.getStringValidator)()),sn(lt,"size"),sn(lt,"dragBoundFunc"),sn(lt,"draggable",!1,(0,Xn.getBooleanValidator)()),lf.Factory.backCompat(lt,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"});var $u={};Object.defineProperty($u,"__esModule",{value:!0}),$u.Container=void 0;const _d=kt,t3=Tn,Ey=Ge;class Ru extends t3.Node{constructor(){super(...arguments),this.children=[]}getChildren(e){if(!e)return this.children||[];const n=this.children||[];var r=[];return n.forEach(function(a){e(a)&&r.push(a)}),r}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(e=>{e.parent=null,e.index=0,e.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(e=>{e.parent=null,e.index=0,e.destroy()}),this.children=[],this._requestDraw(),this}add(...e){if(e.length===0)return this;if(e.length>1){for(var n=0;n<e.length;n++)this.add(e[n]);return this}const r=e[0];return r.getParent()?(r.moveTo(this),this):(this._validateAdd(r),r.index=this.getChildren().length,r.parent=this,r._clearCaches(),this.getChildren().push(r),this._fire("add",{child:r}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(e){return this._generalFind(e,!1)}findOne(e){var n=this._generalFind(e,!0);return n.length>0?n[0]:void 0}_generalFind(e,n){var r=[];return this._descendants(a=>{const i=a._isMatch(e);return i&&r.push(a),!!(i&&n)}),r}_descendants(e){let n=!1;const r=this.getChildren();for(const a of r)if(n=e(a),n||a.hasChildren()&&(n=a._descendants(e),n))return!0;return!1}toObject(){var e=t3.Node.prototype.toObject.call(this);return e.children=[],this.getChildren().forEach(n=>{e.children.push(n.toObject())}),e}isAncestorOf(e){for(var n=e.getParent();n;){if(n._id===this._id)return!0;n=n.getParent()}return!1}clone(e){var n=t3.Node.prototype.clone.call(this,e);return this.getChildren().forEach(function(r){n.add(r.clone())}),n}getAllIntersections(e){var n=[];return this.find("Shape").forEach(r=>{r.isVisible()&&r.intersects(e)&&n.push(r)}),n}_clearSelfAndDescendantCache(e){var n;super._clearSelfAndDescendantCache(e),!this.isCached()&&((n=this.children)===null||n===void 0||n.forEach(function(r){r._clearSelfAndDescendantCache(e)}))}_setChildrenIndices(){var e;(e=this.children)===null||e===void 0||e.forEach(function(n,r){n.index=r}),this._requestDraw()}drawScene(e,n,r){var a=this.getLayer(),i=e||a&&a.getCanvas(),o=i&&i.getContext(),s=this._getCanvasCache(),l=s&&s.scene,u=i&&i.isCache;if(!this.isVisible()&&!u)return this;if(l){o.save();var c=this.getAbsoluteTransform(n).getMatrix();o.transform(c[0],c[1],c[2],c[3],c[4],c[5]),this._drawCachedSceneCanvas(o),o.restore()}else this._drawChildren("drawScene",i,n,r);return this}drawHit(e,n){if(!this.shouldDrawHit(n))return this;var r=this.getLayer(),a=e||r&&r.hitCanvas,i=a&&a.getContext(),o=this._getCanvasCache(),s=o&&o.hit;if(s){i.save();var l=this.getAbsoluteTransform(n).getMatrix();i.transform(l[0],l[1],l[2],l[3],l[4],l[5]),this._drawCachedHitCanvas(i),i.restore()}else this._drawChildren("drawHit",a,n);return this}_drawChildren(e,n,r,a){var i,o=n&&n.getContext(),s=this.clipWidth(),l=this.clipHeight(),u=this.clipFunc(),c=s&&l||u;const d=r===this;if(c){o.save();var p=this.getAbsoluteTransform(r),f=p.getMatrix();o.transform(f[0],f[1],f[2],f[3],f[4],f[5]),o.beginPath();let b;if(u)b=u.call(this,o,this);else{var m=this.clipX(),y=this.clipY();o.rect(m,y,s,l)}o.clip.apply(o,b),f=p.copy().invert().getMatrix(),o.transform(f[0],f[1],f[2],f[3],f[4],f[5])}var x=!d&&this.globalCompositeOperation()!=="source-over"&&e==="drawScene";x&&(o.save(),o._applyGlobalCompositeOperation(this)),(i=this.children)===null||i===void 0||i.forEach(function(b){b[e](n,r,a)}),x&&o.restore(),c&&o.restore()}getClientRect(e={}){var n,r=e.skipTransform,a=e.relativeTo,i,o,s,l,u={x:1/0,y:1/0,width:0,height:0},c=this;(n=this.children)===null||n===void 0||n.forEach(function(y){if(y.visible()){var x=y.getClientRect({relativeTo:c,skipShadow:e.skipShadow,skipStroke:e.skipStroke});x.width===0&&x.height===0||(i===void 0?(i=x.x,o=x.y,s=x.x+x.width,l=x.y+x.height):(i=Math.min(i,x.x),o=Math.min(o,x.y),s=Math.max(s,x.x+x.width),l=Math.max(l,x.y+x.height)))}});for(var d=this.find("Shape"),p=!1,f=0;f<d.length;f++){var m=d[f];if(m._isVisible(this)){p=!0;break}}return p&&i!==void 0?u={x:i,y:o,width:s-i,height:l-o}:u={x:0,y:0,width:0,height:0},r?u:this._transformedRect(u,a)}}$u.Container=Ru,_d.Factory.addComponentsGetterSetter(Ru,"clip",["x","y","width","height"]),_d.Factory.addGetterSetter(Ru,"clipX",void 0,(0,Ey.getNumberValidator)()),_d.Factory.addGetterSetter(Ru,"clipY",void 0,(0,Ey.getNumberValidator)()),_d.Factory.addGetterSetter(Ru,"clipWidth",void 0,(0,Ey.getNumberValidator)()),_d.Factory.addGetterSetter(Ru,"clipHeight",void 0,(0,Ey.getNumberValidator)()),_d.Factory.addGetterSetter(Ru,"clipFunc");var C6={},ti={};Object.defineProperty(ti,"__esModule",{value:!0}),ti.releaseCapture=ti.setPointerCapture=ti.hasPointerCapture=ti.createEvent=ti.getCapturedShape=void 0;const lJ=wt,cf=new Map,N6=lJ.Konva._global.PointerEvent!==void 0;function uJ(t){return cf.get(t)}ti.getCapturedShape=uJ;function n3(t){return{evt:t,pointerId:t.pointerId}}ti.createEvent=n3;function cJ(t,e){return cf.get(t)===e}ti.hasPointerCapture=cJ;function dJ(t,e){T6(t),e.getStage()&&(cf.set(t,e),N6&&e._fire("gotpointercapture",n3(new PointerEvent("gotpointercapture"))))}ti.setPointerCapture=dJ;function T6(t,e){const n=cf.get(t);if(!n)return;const r=n.getStage();r&&r.content,cf.delete(t),N6&&n._fire("lostpointercapture",n3(new PointerEvent("lostpointercapture")))}ti.releaseCapture=T6,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Stage=t.stages=void 0;const e=Dn,n=kt,r=$u,a=wt,i=no,o=Cy,s=wt,l=ti;var u="Stage",c="string",d="px",p="mouseout",f="mouseleave",m="mouseover",y="mouseenter",x="mousemove",b="mousedown",v="mouseup",w="pointermove",S="pointerdown",C="pointerup",I="pointercancel",_="lostpointercapture",E="pointerout",P="pointerleave",A="pointerover",D="pointerenter",V="contextmenu",z="touchstart",K="touchend",X="touchmove",Z="touchcancel",q="wheel",F=5,Y=[[y,"_pointerenter"],[b,"_pointerdown"],[x,"_pointermove"],[v,"_pointerup"],[f,"_pointerleave"],[z,"_pointerdown"],[X,"_pointermove"],[K,"_pointerup"],[Z,"_pointercancel"],[m,"_pointerover"],[q,"_wheel"],[V,"_contextmenu"],[S,"_pointerdown"],[w,"_pointermove"],[C,"_pointerup"],[I,"_pointercancel"],[_,"_lostpointercapture"]];const Q={mouse:{[E]:p,[P]:f,[A]:m,[D]:y,[w]:x,[S]:b,[C]:v,[I]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[E]:"touchout",[P]:"touchleave",[A]:"touchover",[D]:"touchenter",[w]:X,[S]:z,[C]:K,[I]:Z,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[E]:E,[P]:P,[A]:A,[D]:D,[w]:w,[S]:S,[C]:C,[I]:I,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},ne=ve=>ve.indexOf("pointer")>=0?"pointer":ve.indexOf("touch")>=0?"touch":"mouse",le=ve=>{const H=ne(ve);if(H==="pointer")return a.Konva.pointerEventsEnabled&&Q.pointer;if(H==="touch")return Q.touch;if(H==="mouse")return Q.mouse};function de(ve={}){return(ve.clipFunc||ve.clipWidth||ve.clipHeight)&&e.Util.warn("Stage does not support clipping. Please use clip for Layers or Groups."),ve}const re="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);";t.stages=[];class he extends r.Container{constructor(H){super(de(H)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),t.stages.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{de(this.attrs)}),this._checkVisibility()}_validateAdd(H){const ie=H.getType()==="Layer",pe=H.getType()==="FastLayer";ie||pe||e.Util.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const H=this.visible()?"":"none";this.content.style.display=H}setContainer(H){if(typeof H===c){if(H.charAt(0)==="."){var ie=H.slice(1);H=document.getElementsByClassName(ie)[0]}else{var pe;H.charAt(0)!=="#"?pe=H:pe=H.slice(1),H=document.getElementById(pe)}if(!H)throw"Can not find container in document with id "+pe}return this._setAttr("container",H),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),H.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){var H=this.children,ie=H.length,pe;for(pe=0;pe<ie;pe++)H[pe].clear();return this}clone(H){return H||(H={}),H.container=typeof document<"u"&&document.createElement("div"),r.Container.prototype.clone.call(this,H)}destroy(){super.destroy();var H=this.content;H&&e.Util._isInDocument(H)&&this.container().removeChild(H);var ie=t.stages.indexOf(this);return ie>-1&&t.stages.splice(ie,1),e.Util.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const H=this._pointerPositions[0]||this._changedPointerPositions[0];return H?{x:H.x,y:H.y}:(e.Util.warn(re),null)}_getPointerById(H){return this._pointerPositions.find(ie=>ie.id===H)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(H){H=H||{},H.x=H.x||0,H.y=H.y||0,H.width=H.width||this.width(),H.height=H.height||this.height();var ie=new i.SceneCanvas({width:H.width,height:H.height,pixelRatio:H.pixelRatio||1}),pe=ie.getContext()._context,ke=this.children;return(H.x||H.y)&&pe.translate(-1*H.x,-1*H.y),ke.forEach(function(Ne){if(Ne.isVisible()){var Ie=Ne._toKonvaCanvas(H);pe.drawImage(Ie._canvas,H.x,H.y,Ie.getWidth()/Ie.getPixelRatio(),Ie.getHeight()/Ie.getPixelRatio())}}),ie}getIntersection(H){if(!H)return null;var ie=this.children,pe=ie.length,ke=pe-1,Ne;for(Ne=ke;Ne>=0;Ne--){const Ie=ie[Ne].getIntersection(H);if(Ie)return Ie}return null}_resizeDOM(){var H=this.width(),ie=this.height();this.content&&(this.content.style.width=H+d,this.content.style.height=ie+d),this.bufferCanvas.setSize(H,ie),this.bufferHitCanvas.setSize(H,ie),this.children.forEach(pe=>{pe.setSize({width:H,height:ie}),pe.draw()})}add(H,...ie){if(arguments.length>1){for(var pe=0;pe<arguments.length;pe++)this.add(arguments[pe]);return this}super.add(H);var ke=this.children.length;return ke>F&&e.Util.warn("The stage has "+ke+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),H.setSize({width:this.width(),height:this.height()}),H.draw(),a.Konva.isBrowser&&this.content.appendChild(H.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(H){return l.hasPointerCapture(H,this)}setPointerCapture(H){l.setPointerCapture(H,this)}releaseCapture(H){l.releaseCapture(H,this)}getLayers(){return this.children}_bindContentEvents(){a.Konva.isBrowser&&Y.forEach(([H,ie])=>{this.content.addEventListener(H,pe=>{this[ie](pe)},{passive:!1})})}_pointerenter(H){this.setPointersPositions(H);const ie=le(H.type);ie&&this._fire(ie.pointerenter,{evt:H,target:this,currentTarget:this})}_pointerover(H){this.setPointersPositions(H);const ie=le(H.type);ie&&this._fire(ie.pointerover,{evt:H,target:this,currentTarget:this})}_getTargetShape(H){let ie=this[H+"targetShape"];return ie&&!ie.getStage()&&(ie=null),ie}_pointerleave(H){const ie=le(H.type),pe=ne(H.type);if(ie){this.setPointersPositions(H);var ke=this._getTargetShape(pe),Ne=!o.DD.isDragging||a.Konva.hitOnDragEnabled;ke&&Ne?(ke._fireAndBubble(ie.pointerout,{evt:H}),ke._fireAndBubble(ie.pointerleave,{evt:H}),this._fire(ie.pointerleave,{evt:H,target:this,currentTarget:this}),this[pe+"targetShape"]=null):Ne&&(this._fire(ie.pointerleave,{evt:H,target:this,currentTarget:this}),this._fire(ie.pointerout,{evt:H,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}}_pointerdown(H){const ie=le(H.type),pe=ne(H.type);if(ie){this.setPointersPositions(H);var ke=!1;this._changedPointerPositions.forEach(Ne=>{var Ie=this.getIntersection(Ne);if(o.DD.justDragged=!1,a.Konva["_"+pe+"ListenClick"]=!0,!Ie||!Ie.isListening())return;a.Konva.capturePointerEventsEnabled&&Ie.setPointerCapture(Ne.id),this[pe+"ClickStartShape"]=Ie,Ie._fireAndBubble(ie.pointerdown,{evt:H,pointerId:Ne.id}),ke=!0;const Le=H.type.indexOf("touch")>=0;Ie.preventDefault()&&H.cancelable&&Le&&H.preventDefault()}),ke||this._fire(ie.pointerdown,{evt:H,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}}_pointermove(H){const ie=le(H.type),pe=ne(H.type);if(!ie)return;o.DD.isDragging&&o.DD.node.preventDefault()&&H.cancelable&&H.preventDefault(),this.setPointersPositions(H);var ke=!o.DD.isDragging||a.Konva.hitOnDragEnabled;if(!ke)return;var Ne={};let Ie=!1;var Le=this._getTargetShape(pe);this._changedPointerPositions.forEach(He=>{const Me=l.getCapturedShape(He.id)||this.getIntersection(He),it=He.id,Ye={evt:H,pointerId:it};var Ze=Le!==Me;if(Ze&&Le&&(Le._fireAndBubble(ie.pointerout,{...Ye},Me),Le._fireAndBubble(ie.pointerleave,{...Ye},Me)),Me){if(Ne[Me._id])return;Ne[Me._id]=!0}Me&&Me.isListening()?(Ie=!0,Ze&&(Me._fireAndBubble(ie.pointerover,{...Ye},Le),Me._fireAndBubble(ie.pointerenter,{...Ye},Le),this[pe+"targetShape"]=Me),Me._fireAndBubble(ie.pointermove,{...Ye})):Le&&(this._fire(ie.pointerover,{evt:H,target:this,currentTarget:this,pointerId:it}),this[pe+"targetShape"]=null)}),Ie||this._fire(ie.pointermove,{evt:H,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(H){const ie=le(H.type),pe=ne(H.type);if(!ie)return;this.setPointersPositions(H);const ke=this[pe+"ClickStartShape"],Ne=this[pe+"ClickEndShape"];var Ie={};let Le=!1;this._changedPointerPositions.forEach(He=>{const Me=l.getCapturedShape(He.id)||this.getIntersection(He);if(Me){if(Me.releaseCapture(He.id),Ie[Me._id])return;Ie[Me._id]=!0}const it=He.id,Ye={evt:H,pointerId:it};let Ze=!1;a.Konva["_"+pe+"InDblClickWindow"]?(Ze=!0,clearTimeout(this[pe+"DblTimeout"])):o.DD.justDragged||(a.Konva["_"+pe+"InDblClickWindow"]=!0,clearTimeout(this[pe+"DblTimeout"])),this[pe+"DblTimeout"]=setTimeout(function(){a.Konva["_"+pe+"InDblClickWindow"]=!1},a.Konva.dblClickWindow),Me&&Me.isListening()?(Le=!0,this[pe+"ClickEndShape"]=Me,Me._fireAndBubble(ie.pointerup,{...Ye}),a.Konva["_"+pe+"ListenClick"]&&ke&&ke===Me&&(Me._fireAndBubble(ie.pointerclick,{...Ye}),Ze&&Ne&&Ne===Me&&Me._fireAndBubble(ie.pointerdblclick,{...Ye}))):(this[pe+"ClickEndShape"]=null,a.Konva["_"+pe+"ListenClick"]&&this._fire(ie.pointerclick,{evt:H,target:this,currentTarget:this,pointerId:it}),Ze&&this._fire(ie.pointerdblclick,{evt:H,target:this,currentTarget:this,pointerId:it}))}),Le||this._fire(ie.pointerup,{evt:H,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),a.Konva["_"+pe+"ListenClick"]=!1,H.cancelable&&pe!=="touch"&&H.preventDefault()}_contextmenu(H){this.setPointersPositions(H);var ie=this.getIntersection(this.getPointerPosition());ie&&ie.isListening()?ie._fireAndBubble(V,{evt:H}):this._fire(V,{evt:H,target:this,currentTarget:this})}_wheel(H){this.setPointersPositions(H);var ie=this.getIntersection(this.getPointerPosition());ie&&ie.isListening()?ie._fireAndBubble(q,{evt:H}):this._fire(q,{evt:H,target:this,currentTarget:this})}_pointercancel(H){this.setPointersPositions(H);const ie=l.getCapturedShape(H.pointerId)||this.getIntersection(this.getPointerPosition());ie&&ie._fireAndBubble(C,l.createEvent(H)),l.releaseCapture(H.pointerId)}_lostpointercapture(H){l.releaseCapture(H.pointerId)}setPointersPositions(H){var ie=this._getContentPosition(),pe=null,ke=null;H=H||window.event,H.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(H.touches,Ne=>{this._pointerPositions.push({id:Ne.identifier,x:(Ne.clientX-ie.left)/ie.scaleX,y:(Ne.clientY-ie.top)/ie.scaleY})}),Array.prototype.forEach.call(H.changedTouches||H.touches,Ne=>{this._changedPointerPositions.push({id:Ne.identifier,x:(Ne.clientX-ie.left)/ie.scaleX,y:(Ne.clientY-ie.top)/ie.scaleY})})):(pe=(H.clientX-ie.left)/ie.scaleX,ke=(H.clientY-ie.top)/ie.scaleY,this.pointerPos={x:pe,y:ke},this._pointerPositions=[{x:pe,y:ke,id:e.Util._getFirstPointerId(H)}],this._changedPointerPositions=[{x:pe,y:ke,id:e.Util._getFirstPointerId(H)}])}_setPointerPosition(H){e.Util.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(H)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};var H=this.content.getBoundingClientRect();return{top:H.top,left:H.left,scaleX:H.width/this.content.clientWidth||1,scaleY:H.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new i.SceneCanvas({width:this.width(),height:this.height()}),this.bufferHitCanvas=new i.HitCanvas({pixelRatio:1,width:this.width(),height:this.height()}),!!a.Konva.isBrowser){var H=this.container();if(!H)throw"Stage has no container. A container is required.";H.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),H.appendChild(this.content),this._resizeDOM()}}cache(){return e.Util.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(H){H.batchDraw()}),this}}t.Stage=he,he.prototype.nodeType=u,(0,s._registerNode)(he),n.Factory.addGetterSetter(he,"container")}(C6);var df={},cr={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Shape=t.shapes=void 0;const e=wt,n=Dn,r=kt,a=Tn,i=Ge,o=wt,s=ti;var l="hasShadow",u="shadowRGBA",c="patternImage",d="linearGradient",p="radialGradient";let f;function m(){return f||(f=n.Util.createCanvasElement().getContext("2d"),f)}t.shapes={};function y(P){const A=this.attrs.fillRule;A?P.fill(A):P.fill()}function x(P){P.stroke()}function b(P){P.fill()}function v(P){P.stroke()}function w(){this._clearCache(l)}function S(){this._clearCache(u)}function C(){this._clearCache(c)}function I(){this._clearCache(d)}function _(){this._clearCache(p)}class E extends a.Node{constructor(A){super(A);let D;for(;D=n.Util.getRandomColor(),!(D&&!(D in t.shapes)););this.colorKey=D,t.shapes[D]=this}getContext(){return n.Util.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return n.Util.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(l,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(c,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){var A=m();const D=A.createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(D&&D.setTransform){const V=new n.Transform;V.translate(this.fillPatternX(),this.fillPatternY()),V.rotate(e.Konva.getAngle(this.fillPatternRotation())),V.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),V.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const z=V.getMatrix(),K=typeof DOMMatrix>"u"?{a:z[0],b:z[1],c:z[2],d:z[3],e:z[4],f:z[5]}:new DOMMatrix(z);D.setTransform(K)}return D}}_getLinearGradient(){return this._getCache(d,this.__getLinearGradient)}__getLinearGradient(){var A=this.fillLinearGradientColorStops();if(A){for(var D=m(),V=this.fillLinearGradientStartPoint(),z=this.fillLinearGradientEndPoint(),K=D.createLinearGradient(V.x,V.y,z.x,z.y),X=0;X<A.length;X+=2)K.addColorStop(A[X],A[X+1]);return K}}_getRadialGradient(){return this._getCache(p,this.__getRadialGradient)}__getRadialGradient(){var A=this.fillRadialGradientColorStops();if(A){for(var D=m(),V=this.fillRadialGradientStartPoint(),z=this.fillRadialGradientEndPoint(),K=D.createRadialGradient(V.x,V.y,this.fillRadialGradientStartRadius(),z.x,z.y,this.fillRadialGradientEndRadius()),X=0;X<A.length;X+=2)K.addColorStop(A[X],A[X+1]);return K}}getShadowRGBA(){return this._getCache(u,this._getShadowRGBA)}_getShadowRGBA(){if(this.hasShadow()){var A=n.Util.colorToRGBA(this.shadowColor());if(A)return"rgba("+A.r+","+A.g+","+A.b+","+A.a*(this.shadowOpacity()||1)+")"}}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){const A=this.hitStrokeWidth();return A==="auto"?this.hasStroke():this.strokeEnabled()&&!!A}intersects(A){var D=this.getStage();if(!D)return!1;const V=D.bufferHitCanvas;return V.getContext().clear(),this.drawHit(V,void 0,!0),V.context.getImageData(Math.round(A.x),Math.round(A.y),1,1).data[3]>0}destroy(){return a.Node.prototype.destroy.call(this),delete t.shapes[this.colorKey],delete this.colorKey,this}_useBufferCanvas(A){var D;if(!(!((D=this.attrs.perfectDrawEnabled)!==null&&D!==void 0)||D))return!1;const V=A||this.hasFill(),z=this.hasStroke(),K=this.getAbsoluteOpacity()!==1;if(V&&z&&K)return!0;const X=this.hasShadow(),Z=this.shadowForStrokeEnabled();return!!(V&&z&&X&&Z)}setStrokeHitEnabled(A){n.Util.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),A?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){var A=this.size();return{x:this._centroid?-A.width/2:0,y:this._centroid?-A.height/2:0,width:A.width,height:A.height}}getClientRect(A={}){const D=A.skipTransform,V=A.relativeTo,z=this.getSelfRect(),K=!A.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,X=z.width+K,Z=z.height+K,q=!A.skipShadow&&this.hasShadow(),F=q?this.shadowOffsetX():0,Y=q?this.shadowOffsetY():0,Q=X+Math.abs(F),ne=Z+Math.abs(Y),le=q&&this.shadowBlur()||0,de=Q+le*2,re=ne+le*2,he={width:de,height:re,x:-(K/2+le)+Math.min(F,0)+z.x,y:-(K/2+le)+Math.min(Y,0)+z.y};return D?he:this._transformedRect(he,V)}drawScene(A,D,V){var z=this.getLayer(),K=A||z.getCanvas(),X=K.getContext(),Z=this._getCanvasCache(),q=this.getSceneFunc(),F=this.hasShadow(),Y,Q,ne=K.isCache,le=D===this;if(!this.isVisible()&&!le)return this;if(Z){X.save();var de=this.getAbsoluteTransform(D).getMatrix();return X.transform(de[0],de[1],de[2],de[3],de[4],de[5]),this._drawCachedSceneCanvas(X),X.restore(),this}if(!q)return this;if(X.save(),this._useBufferCanvas()&&!ne){Y=this.getStage();const ve=V||Y.bufferCanvas;Q=ve.getContext(),Q.clear(),Q.save(),Q._applyLineJoin(this);var re=this.getAbsoluteTransform(D).getMatrix();Q.transform(re[0],re[1],re[2],re[3],re[4],re[5]),q.call(this,Q,this),Q.restore();var he=ve.pixelRatio;F&&X._applyShadow(this),X._applyOpacity(this),X._applyGlobalCompositeOperation(this),X.drawImage(ve._canvas,0,0,ve.width/he,ve.height/he)}else{if(X._applyLineJoin(this),!le){var re=this.getAbsoluteTransform(D).getMatrix();X.transform(re[0],re[1],re[2],re[3],re[4],re[5]),X._applyOpacity(this),X._applyGlobalCompositeOperation(this)}F&&X._applyShadow(this),q.call(this,X,this)}return X.restore(),this}drawHit(A,D,V=!1){if(!this.shouldDrawHit(D,V))return this;var z=this.getLayer(),K=A||z.hitCanvas,X=K&&K.getContext(),Z=this.hitFunc()||this.sceneFunc(),q=this._getCanvasCache(),F=q&&q.hit;if(this.colorKey||n.Util.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),F){X.save();var Y=this.getAbsoluteTransform(D).getMatrix();return X.transform(Y[0],Y[1],Y[2],Y[3],Y[4],Y[5]),this._drawCachedHitCanvas(X),X.restore(),this}if(!Z)return this;if(X.save(),X._applyLineJoin(this),this!==D){var Q=this.getAbsoluteTransform(D).getMatrix();X.transform(Q[0],Q[1],Q[2],Q[3],Q[4],Q[5])}return Z.call(this,X,this),X.restore(),this}drawHitFromCache(A=0){var D=this._getCanvasCache(),V=this._getCachedSceneCanvas(),z=D.hit,K=z.getContext(),X=z.getWidth(),Z=z.getHeight(),q,F,Y,Q,ne,le;K.clear(),K.drawImage(V._canvas,0,0,X,Z);try{for(q=K.getImageData(0,0,X,Z),F=q.data,Y=F.length,Q=n.Util._hexToRgb(this.colorKey),ne=0;ne<Y;ne+=4)le=F[ne+3],le>A?(F[ne]=Q.r,F[ne+1]=Q.g,F[ne+2]=Q.b,F[ne+3]=255):F[ne+3]=0;K.putImageData(q,0,0)}catch(de){n.Util.error("Unable to draw hit graph from cached scene canvas. "+de.message)}return this}hasPointerCapture(A){return s.hasPointerCapture(A,this)}setPointerCapture(A){s.setPointerCapture(A,this)}releaseCapture(A){s.releaseCapture(A,this)}}t.Shape=E,E.prototype._fillFunc=y,E.prototype._strokeFunc=x,E.prototype._fillFuncHit=b,E.prototype._strokeFuncHit=v,E.prototype._centroid=!1,E.prototype.nodeType="Shape",(0,o._registerNode)(E),E.prototype.eventListeners={},E.prototype.on.call(E.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",w),E.prototype.on.call(E.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",S),E.prototype.on.call(E.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",C),E.prototype.on.call(E.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",I),E.prototype.on.call(E.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",_),r.Factory.addGetterSetter(E,"stroke",void 0,(0,i.getStringOrGradientValidator)()),r.Factory.addGetterSetter(E,"strokeWidth",2,(0,i.getNumberValidator)()),r.Factory.addGetterSetter(E,"fillAfterStrokeEnabled",!1),r.Factory.addGetterSetter(E,"hitStrokeWidth","auto",(0,i.getNumberOrAutoValidator)()),r.Factory.addGetterSetter(E,"strokeHitEnabled",!0,(0,i.getBooleanValidator)()),r.Factory.addGetterSetter(E,"perfectDrawEnabled",!0,(0,i.getBooleanValidator)()),r.Factory.addGetterSetter(E,"shadowForStrokeEnabled",!0,(0,i.getBooleanValidator)()),r.Factory.addGetterSetter(E,"lineJoin"),r.Factory.addGetterSetter(E,"lineCap"),r.Factory.addGetterSetter(E,"sceneFunc"),r.Factory.addGetterSetter(E,"hitFunc"),r.Factory.addGetterSetter(E,"dash"),r.Factory.addGetterSetter(E,"dashOffset",0,(0,i.getNumberValidator)()),r.Factory.addGetterSetter(E,"shadowColor",void 0,(0,i.getStringValidator)()),r.Factory.addGetterSetter(E,"shadowBlur",0,(0,i.getNumberValidator)()),r.Factory.addGetterSetter(E,"shadowOpacity",1,(0,i.getNumberValidator)()),r.Factory.addComponentsGetterSetter(E,"shadowOffset",["x","y"]),r.Factory.addGetterSetter(E,"shadowOffsetX",0,(0,i.getNumberValidator)()),r.Factory.addGetterSetter(E,"shadowOffsetY",0,(0,i.getNumberValidator)()),r.Factory.addGetterSetter(E,"fillPatternImage"),r.Factory.addGetterSetter(E,"fill",void 0,(0,i.getStringOrGradientValidator)()),r.Factory.addGetterSetter(E,"fillPatternX",0,(0,i.getNumberValidator)()),r.Factory.addGetterSetter(E,"fillPatternY",0,(0,i.getNumberValidator)()),r.Factory.addGetterSetter(E,"fillLinearGradientColorStops"),r.Factory.addGetterSetter(E,"strokeLinearGradientColorStops"),r.Factory.addGetterSetter(E,"fillRadialGradientStartRadius",0),r.Factory.addGetterSetter(E,"fillRadialGradientEndRadius",0),r.Factory.addGetterSetter(E,"fillRadialGradientColorStops"),r.Factory.addGetterSetter(E,"fillPatternRepeat","repeat"),r.Factory.addGetterSetter(E,"fillEnabled",!0),r.Factory.addGetterSetter(E,"strokeEnabled",!0),r.Factory.addGetterSetter(E,"shadowEnabled",!0),r.Factory.addGetterSetter(E,"dashEnabled",!0),r.Factory.addGetterSetter(E,"strokeScaleEnabled",!0),r.Factory.addGetterSetter(E,"fillPriority","color"),r.Factory.addComponentsGetterSetter(E,"fillPatternOffset",["x","y"]),r.Factory.addGetterSetter(E,"fillPatternOffsetX",0,(0,i.getNumberValidator)()),r.Factory.addGetterSetter(E,"fillPatternOffsetY",0,(0,i.getNumberValidator)()),r.Factory.addComponentsGetterSetter(E,"fillPatternScale",["x","y"]),r.Factory.addGetterSetter(E,"fillPatternScaleX",1,(0,i.getNumberValidator)()),r.Factory.addGetterSetter(E,"fillPatternScaleY",1,(0,i.getNumberValidator)()),r.Factory.addComponentsGetterSetter(E,"fillLinearGradientStartPoint",["x","y"]),r.Factory.addComponentsGetterSetter(E,"strokeLinearGradientStartPoint",["x","y"]),r.Factory.addGetterSetter(E,"fillLinearGradientStartPointX",0),r.Factory.addGetterSetter(E,"strokeLinearGradientStartPointX",0),r.Factory.addGetterSetter(E,"fillLinearGradientStartPointY",0),r.Factory.addGetterSetter(E,"strokeLinearGradientStartPointY",0),r.Factory.addComponentsGetterSetter(E,"fillLinearGradientEndPoint",["x","y"]),r.Factory.addComponentsGetterSetter(E,"strokeLinearGradientEndPoint",["x","y"]),r.Factory.addGetterSetter(E,"fillLinearGradientEndPointX",0),r.Factory.addGetterSetter(E,"strokeLinearGradientEndPointX",0),r.Factory.addGetterSetter(E,"fillLinearGradientEndPointY",0),r.Factory.addGetterSetter(E,"strokeLinearGradientEndPointY",0),r.Factory.addComponentsGetterSetter(E,"fillRadialGradientStartPoint",["x","y"]),r.Factory.addGetterSetter(E,"fillRadialGradientStartPointX",0),r.Factory.addGetterSetter(E,"fillRadialGradientStartPointY",0),r.Factory.addComponentsGetterSetter(E,"fillRadialGradientEndPoint",["x","y"]),r.Factory.addGetterSetter(E,"fillRadialGradientEndPointX",0),r.Factory.addGetterSetter(E,"fillRadialGradientEndPointY",0),r.Factory.addGetterSetter(E,"fillPatternRotation",0),r.Factory.addGetterSetter(E,"fillRule",void 0,(0,i.getStringValidator)()),r.Factory.backCompat(E,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"})})(cr),Object.defineProperty(df,"__esModule",{value:!0}),df.Layer=void 0;const ys=Dn,r3=$u,Od=Tn,a3=kt,I6=no,pJ=Ge,hJ=cr,fJ=wt;var gJ="#",mJ="beforeDraw",yJ="draw",E6=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],bJ=E6.length;let $d=class extends r3.Container{constructor(t){super(t),this.canvas=new I6.SceneCanvas,this.hitCanvas=new I6.HitCanvas({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(t){return this.getContext().clear(t),this.getHitCanvas().getContext().clear(t),this}setZIndex(t){super.setZIndex(t);var e=this.getStage();return e&&e.content&&(e.content.removeChild(this.getNativeCanvasElement()),t<e.children.length-1?e.content.insertBefore(this.getNativeCanvasElement(),e.children[t+1].getCanvas()._canvas):e.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){Od.Node.prototype.moveToTop.call(this);var t=this.getStage();return t&&t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){var t=Od.Node.prototype.moveUp.call(this);if(!t)return!1;var e=this.getStage();return!e||!e.content?!1:(e.content.removeChild(this.getNativeCanvasElement()),this.index<e.children.length-1?e.content.insertBefore(this.getNativeCanvasElement(),e.children[this.index+1].getCanvas()._canvas):e.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(Od.Node.prototype.moveDown.call(this)){var t=this.getStage();if(t){var e=t.children;t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.insertBefore(this.getNativeCanvasElement(),e[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(Od.Node.prototype.moveToBottom.call(this)){var t=this.getStage();if(t){var e=t.children;t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.insertBefore(this.getNativeCanvasElement(),e[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){var t=this.getNativeCanvasElement();return Od.Node.prototype.remove.call(this),t&&t.parentNode&&ys.Util._isInDocument(t)&&t.parentNode.removeChild(t),this}getStage(){return this.parent}setSize({width:t,height:e}){return this.canvas.setSize(t,e),this.hitCanvas.setSize(t,e),this._setSmoothEnabled(),this}_validateAdd(t){var e=t.getType();e!=="Group"&&e!=="Shape"&&ys.Util.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(t){return t=t||{},t.width=t.width||this.getWidth(),t.height=t.height||this.getHeight(),t.x=t.x!==void 0?t.x:this.x(),t.y=t.y!==void 0?t.y:this.y(),Od.Node.prototype._toKonvaCanvas.call(this,t)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){ys.Util.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){ys.Util.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,ys.Util.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(t){if(!this.isListening()||!this.isVisible())return null;for(var e=1,n=!1;;){for(let r=0;r<bJ;r++){const a=E6[r],i=this._getIntersection({x:t.x+a.x*e,y:t.y+a.y*e}),o=i.shape;if(o)return o;if(n=!!i.antialiased,!i.antialiased)break}if(n)e+=1;else return null}}_getIntersection(t){const e=this.hitCanvas.pixelRatio,n=this.hitCanvas.context.getImageData(Math.round(t.x*e),Math.round(t.y*e),1,1).data,r=n[3];if(r===255){const a=ys.Util._rgbToHex(n[0],n[1],n[2]),i=hJ.shapes[gJ+a];return i?{shape:i}:{antialiased:!0}}else if(r>0)return{antialiased:!0};return{}}drawScene(t,e){var n=this.getLayer(),r=t||n&&n.getCanvas();return this._fire(mJ,{node:this}),this.clearBeforeDraw()&&r.getContext().clear(),r3.Container.prototype.drawScene.call(this,r,e),this._fire(yJ,{node:this}),this}drawHit(t,e){var n=this.getLayer(),r=t||n&&n.hitCanvas;return n&&n.clearBeforeDraw()&&n.getHitCanvas().getContext().clear(),r3.Container.prototype.drawHit.call(this,r,e),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(t){ys.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(t)}getHitGraphEnabled(t){return ys.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!(!this.parent||!this.parent.content)){var t=this.parent,e=!!this.hitCanvas._canvas.parentNode;e?t.content.removeChild(this.hitCanvas._canvas):t.content.appendChild(this.hitCanvas._canvas)}}destroy(){return ys.Util.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}};df.Layer=$d,$d.prototype.nodeType="Layer",(0,fJ._registerNode)($d),a3.Factory.addGetterSetter($d,"imageSmoothingEnabled",!0),a3.Factory.addGetterSetter($d,"clearBeforeDraw",!0),a3.Factory.addGetterSetter($d,"hitGraphEnabled",!0,(0,pJ.getBooleanValidator)());var _y={};Object.defineProperty(_y,"__esModule",{value:!0}),_y.FastLayer=void 0;const vJ=Dn,xJ=df,wJ=wt;class i3 extends xJ.Layer{constructor(e){super(e),this.listening(!1),vJ.Util.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}}_y.FastLayer=i3,i3.prototype.nodeType="FastLayer",(0,wJ._registerNode)(i3);var Rd={};Object.defineProperty(Rd,"__esModule",{value:!0}),Rd.Group=void 0;const kJ=Dn,SJ=$u,CJ=wt;class o3 extends SJ.Container{_validateAdd(e){var n=e.getType();n!=="Group"&&n!=="Shape"&&kJ.Util.throw("You may only add groups and shapes to groups.")}}Rd.Group=o3,o3.prototype.nodeType="Group",(0,CJ._registerNode)(o3);var Md={};Object.defineProperty(Md,"__esModule",{value:!0}),Md.Animation=void 0;const s3=wt,_6=Dn,l3=function(){return s3.glob.performance&&s3.glob.performance.now?function(){return s3.glob.performance.now()}:function(){return new Date().getTime()}}();class Uo{constructor(e,n){this.id=Uo.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:l3(),frameRate:0},this.func=e,this.setLayers(n)}setLayers(e){let n=[];return e&&(n=Array.isArray(e)?e:[e]),this.layers=n,this}getLayers(){return this.layers}addLayer(e){const n=this.layers,r=n.length;for(let a=0;a<r;a++)if(n[a]._id===e._id)return!1;return this.layers.push(e),!0}isRunning(){const e=Uo.animations,n=e.length;for(let r=0;r<n;r++)if(e[r].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=l3(),Uo._addAnimation(this),this}stop(){return Uo._removeAnimation(this),this}_updateFrameObject(e){this.frame.timeDiff=e-this.frame.lastTime,this.frame.lastTime=e,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(e){this.animations.push(e),this._handleAnimation()}static _removeAnimation(e){const n=e.id,r=this.animations,a=r.length;for(let i=0;i<a;i++)if(r[i].id===n){this.animations.splice(i,1);break}}static _runFrames(){const e={},n=this.animations;for(let r=0;r<n.length;r++){const a=n[r],i=a.layers,o=a.func;a._updateFrameObject(l3());const s=i.length;let l;if(o?l=o.call(a,a.frame)!==!1:l=!0,!!l)for(let u=0;u<s;u++){const c=i[u];c._id!==void 0&&(e[c._id]=c)}}for(let r in e)e.hasOwnProperty(r)&&e[r].batchDraw()}static _animationLoop(){const e=Uo;e.animations.length?(e._runFrames(),_6.Util.requestAnimFrame(e._animationLoop)):e.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,_6.Util.requestAnimFrame(this._animationLoop))}}Md.Animation=Uo,Uo.animations=[],Uo.animIdCounter=0,Uo.animRunning=!1;var O6={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Easings=t.Tween=void 0;const e=Dn,n=Md,r=Tn,a=wt;var i={node:1,duration:1,easing:1,onFinish:1,yoyo:1},o=1,s=2,l=3,u=0,c=["fill","stroke","shadowColor"];class d{constructor(m,y,x,b,v,w,S){this.prop=m,this.propFunc=y,this.begin=b,this._pos=b,this.duration=w,this._change=0,this.prevPos=0,this.yoyo=S,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=x,this._change=v-this.begin,this.pause()}fire(m){var y=this[m];y&&y()}setTime(m){m>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():m<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=m,this.update())}getTime(){return this._time}setPosition(m){this.prevPos=this._pos,this.propFunc(m),this._pos=m}getPosition(m){return m===void 0&&(m=this._time),this.func(m,this.begin,this._change,this.duration)}play(){this.state=s,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=l,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(m){this.pause(),this._time=m,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){var m=this.getTimer()-this._startTime;this.state===s?this.setTime(m):this.state===l&&this.setTime(this.duration-m)}pause(){this.state=o,this.fire("onPause")}getTimer(){return new Date().getTime()}}class p{constructor(m){var y=this,x=m.node,b=x._id,v,w=m.easing||t.Easings.Linear,S=!!m.yoyo,C;typeof m.duration>"u"?v=.3:m.duration===0?v=.001:v=m.duration,this.node=x,this._id=u++;var I=x.getLayer()||(x instanceof a.Konva.Stage?x.getLayers():null);I||e.Util.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new n.Animation(function(){y.tween.onEnterFrame()},I),this.tween=new d(C,function(_){y._tweenFunc(_)},w,0,1,v*1e3,S),this._addListeners(),p.attrs[b]||(p.attrs[b]={}),p.attrs[b][this._id]||(p.attrs[b][this._id]={}),p.tweens[b]||(p.tweens[b]={});for(C in m)i[C]===void 0&&this._addAttr(C,m[C]);this.reset(),this.onFinish=m.onFinish,this.onReset=m.onReset,this.onUpdate=m.onUpdate}_addAttr(m,y){var x=this.node,b=x._id,v,w,S,C,I,_,E,P;if(S=p.tweens[b][m],S&&delete p.attrs[b][S][m],v=x.getAttr(m),e.Util._isArray(y))if(w=[],I=Math.max(y.length,v.length),m==="points"&&y.length!==v.length&&(y.length>v.length?(E=v,v=e.Util._prepareArrayForTween(v,y,x.closed())):(_=y,y=e.Util._prepareArrayForTween(y,v,x.closed()))),m.indexOf("fill")===0)for(C=0;C<I;C++)if(C%2===0)w.push(y[C]-v[C]);else{var A=e.Util.colorToRGBA(v[C]);P=e.Util.colorToRGBA(y[C]),v[C]=A,w.push({r:P.r-A.r,g:P.g-A.g,b:P.b-A.b,a:P.a-A.a})}else for(C=0;C<I;C++)w.push(y[C]-v[C]);else c.indexOf(m)!==-1?(v=e.Util.colorToRGBA(v),P=e.Util.colorToRGBA(y),w={r:P.r-v.r,g:P.g-v.g,b:P.b-v.b,a:P.a-v.a}):w=y-v;p.attrs[b][this._id][m]={start:v,diff:w,end:y,trueEnd:_,trueStart:E},p.tweens[b][m]=this._id}_tweenFunc(m){var y=this.node,x=p.attrs[y._id][this._id],b,v,w,S,C,I,_,E;for(b in x){if(v=x[b],w=v.start,S=v.diff,E=v.end,e.Util._isArray(w))if(C=[],_=Math.max(w.length,E.length),b.indexOf("fill")===0)for(I=0;I<_;I++)I%2===0?C.push((w[I]||0)+S[I]*m):C.push("rgba("+Math.round(w[I].r+S[I].r*m)+","+Math.round(w[I].g+S[I].g*m)+","+Math.round(w[I].b+S[I].b*m)+","+(w[I].a+S[I].a*m)+")");else for(I=0;I<_;I++)C.push((w[I]||0)+S[I]*m);else c.indexOf(b)!==-1?C="rgba("+Math.round(w.r+S.r*m)+","+Math.round(w.g+S.g*m)+","+Math.round(w.b+S.b*m)+","+(w.a+S.a*m)+")":C=w+S*m;y.setAttr(b,C)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{var m=this.node,y=p.attrs[m._id][this._id];y.points&&y.points.trueEnd&&m.setAttr("points",y.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{var m=this.node,y=p.attrs[m._id][this._id];y.points&&y.points.trueStart&&m.points(y.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(m){return this.tween.seek(m*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){var m=this.node._id,y=this._id,x=p.tweens[m],b;this.pause();for(b in x)delete p.tweens[m][b];delete p.attrs[m][y]}}t.Tween=p,p.attrs={},p.tweens={},r.Node.prototype.to=function(f){var m=f.onFinish;f.node=this,f.onFinish=function(){this.destroy(),m&&m()};var y=new p(f);y.play()},t.Easings={BackEaseIn(f,m,y,x){var b=1.70158;return y*(f/=x)*f*((b+1)*f-b)+m},BackEaseOut(f,m,y,x){var b=1.70158;return y*((f=f/x-1)*f*((b+1)*f+b)+1)+m},BackEaseInOut(f,m,y,x){var b=1.70158;return(f/=x/2)<1?y/2*(f*f*(((b*=1.525)+1)*f-b))+m:y/2*((f-=2)*f*(((b*=1.525)+1)*f+b)+2)+m},ElasticEaseIn(f,m,y,x,b,v){var w=0;return f===0?m:(f/=x)===1?m+y:(v||(v=x*.3),!b||b<Math.abs(y)?(b=y,w=v/4):w=v/(2*Math.PI)*Math.asin(y/b),-(b*Math.pow(2,10*(f-=1))*Math.sin((f*x-w)*(2*Math.PI)/v))+m)},ElasticEaseOut(f,m,y,x,b,v){var w=0;return f===0?m:(f/=x)===1?m+y:(v||(v=x*.3),!b||b<Math.abs(y)?(b=y,w=v/4):w=v/(2*Math.PI)*Math.asin(y/b),b*Math.pow(2,-10*f)*Math.sin((f*x-w)*(2*Math.PI)/v)+y+m)},ElasticEaseInOut(f,m,y,x,b,v){var w=0;return f===0?m:(f/=x/2)===2?m+y:(v||(v=x*(.3*1.5)),!b||b<Math.abs(y)?(b=y,w=v/4):w=v/(2*Math.PI)*Math.asin(y/b),f<1?-.5*(b*Math.pow(2,10*(f-=1))*Math.sin((f*x-w)*(2*Math.PI)/v))+m:b*Math.pow(2,-10*(f-=1))*Math.sin((f*x-w)*(2*Math.PI)/v)*.5+y+m)},BounceEaseOut(f,m,y,x){return(f/=x)<1/2.75?y*(7.5625*f*f)+m:f<2/2.75?y*(7.5625*(f-=1.5/2.75)*f+.75)+m:f<2.5/2.75?y*(7.5625*(f-=2.25/2.75)*f+.9375)+m:y*(7.5625*(f-=2.625/2.75)*f+.984375)+m},BounceEaseIn(f,m,y,x){return y-t.Easings.BounceEaseOut(x-f,0,y,x)+m},BounceEaseInOut(f,m,y,x){return f<x/2?t.Easings.BounceEaseIn(f*2,0,y,x)*.5+m:t.Easings.BounceEaseOut(f*2-x,0,y,x)*.5+y*.5+m},EaseIn(f,m,y,x){return y*(f/=x)*f+m},EaseOut(f,m,y,x){return-y*(f/=x)*(f-2)+m},EaseInOut(f,m,y,x){return(f/=x/2)<1?y/2*f*f+m:-y/2*(--f*(f-2)-1)+m},StrongEaseIn(f,m,y,x){return y*(f/=x)*f*f*f*f+m},StrongEaseOut(f,m,y,x){return y*((f=f/x-1)*f*f*f*f+1)+m},StrongEaseInOut(f,m,y,x){return(f/=x/2)<1?y/2*f*f*f*f*f+m:y/2*((f-=2)*f*f*f*f+2)+m},Linear(f,m,y,x){return y*f/x+m}}})(O6),function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Konva=void 0;const e=wt,n=Dn,r=Tn,a=$u,i=C6,o=df,s=_y,l=Rd,u=Cy,c=cr,d=Md,p=O6,f=gs,m=no;t.Konva=n.Util._assign(e.Konva,{Util:n.Util,Transform:n.Transform,Node:r.Node,Container:a.Container,Stage:i.Stage,stages:i.stages,Layer:o.Layer,FastLayer:s.FastLayer,Group:l.Group,DD:u.DD,Shape:c.Shape,shapes:c.shapes,Animation:d.Animation,Tween:p.Tween,Easings:p.Easings,Context:f.Context,Canvas:m.Canvas}),t.default=t.Konva}(vy);var Oy={};Object.defineProperty(Oy,"__esModule",{value:!0}),Oy.Arc=void 0;const $y=kt,NJ=cr,$6=wt,Ry=Ge,TJ=wt;class bs extends NJ.Shape{_sceneFunc(e){var n=$6.Konva.getAngle(this.angle()),r=this.clockwise();e.beginPath(),e.arc(0,0,this.outerRadius(),0,n,r),e.arc(0,0,this.innerRadius(),n,0,!r),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}getSelfRect(){const e=this.innerRadius(),n=this.outerRadius(),r=this.clockwise(),a=$6.Konva.getAngle(r?360-this.angle():this.angle()),i=Math.cos(Math.min(a,Math.PI)),o=1,s=Math.sin(Math.min(Math.max(Math.PI,a),3*Math.PI/2)),l=Math.sin(Math.min(a,Math.PI/2)),u=i*(i>0?e:n),c=o*n,d=s*(s>0?e:n),p=l*(l>0?n:e);return{x:u,y:r?-1*p:d,width:c-u,height:p-d}}}Oy.Arc=bs,bs.prototype._centroid=!0,bs.prototype.className="Arc",bs.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,TJ._registerNode)(bs),$y.Factory.addGetterSetter(bs,"innerRadius",0,(0,Ry.getNumberValidator)()),$y.Factory.addGetterSetter(bs,"outerRadius",0,(0,Ry.getNumberValidator)()),$y.Factory.addGetterSetter(bs,"angle",0,(0,Ry.getNumberValidator)()),$y.Factory.addGetterSetter(bs,"clockwise",!1,(0,Ry.getBooleanValidator)());var My={},pf={};Object.defineProperty(pf,"__esModule",{value:!0}),pf.Line=void 0;const Ay=kt,IJ=cr,R6=Ge,EJ=wt;function u3(t,e,n,r,a,i,o){var s=Math.sqrt(Math.pow(n-t,2)+Math.pow(r-e,2)),l=Math.sqrt(Math.pow(a-n,2)+Math.pow(i-r,2)),u=o*s/(s+l),c=o*l/(s+l),d=n-u*(a-t),p=r-u*(i-e),f=n+c*(a-t),m=r+c*(i-e);return[d,p,f,m]}function M6(t,e){var n=t.length,r=[],a,i;for(a=2;a<n-2;a+=2)i=u3(t[a-2],t[a-1],t[a],t[a+1],t[a+2],t[a+3],e),!isNaN(i[0])&&(r.push(i[0]),r.push(i[1]),r.push(t[a]),r.push(t[a+1]),r.push(i[2]),r.push(i[3]));return r}class kl extends IJ.Shape{constructor(e){super(e),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(e){var n=this.points(),r=n.length,a=this.tension(),i=this.closed(),o=this.bezier(),s,l,u;if(r){if(e.beginPath(),e.moveTo(n[0],n[1]),a!==0&&r>4){for(s=this.getTensionPoints(),l=s.length,u=i?0:4,i||e.quadraticCurveTo(s[0],s[1],s[2],s[3]);u<l-2;)e.bezierCurveTo(s[u++],s[u++],s[u++],s[u++],s[u++],s[u++]);i||e.quadraticCurveTo(s[l-2],s[l-1],n[r-2],n[r-1])}else if(o)for(u=2;u<r;)e.bezierCurveTo(n[u++],n[u++],n[u++],n[u++],n[u++],n[u++]);else for(u=2;u<r;u+=2)e.lineTo(n[u],n[u+1]);i?(e.closePath(),e.fillStrokeShape(this)):e.strokeShape(this)}}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():M6(this.points(),this.tension())}_getTensionPointsClosed(){var e=this.points(),n=e.length,r=this.tension(),a=u3(e[n-2],e[n-1],e[0],e[1],e[2],e[3],r),i=u3(e[n-4],e[n-3],e[n-2],e[n-1],e[0],e[1],r),o=M6(e,r),s=[a[2],a[3]].concat(o).concat([i[0],i[1],e[n-2],e[n-1],i[2],i[3],a[0],a[1],e[0],e[1]]);return s}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){var e=this.points();if(e.length<4)return{x:e[0]||0,y:e[1]||0,width:0,height:0};this.tension()!==0?e=[e[0],e[1],...this._getTensionPoints(),e[e.length-2],e[e.length-1]]:e=this.points();for(var n=e[0],r=e[0],a=e[1],i=e[1],o,s,l=0;l<e.length/2;l++)o=e[l*2],s=e[l*2+1],n=Math.min(n,o),r=Math.max(r,o),a=Math.min(a,s),i=Math.max(i,s);return{x:n,y:a,width:r-n,height:i-a}}}pf.Line=kl,kl.prototype.className="Line",kl.prototype._attrsAffectingSize=["points","bezier","tension"],(0,EJ._registerNode)(kl),Ay.Factory.addGetterSetter(kl,"closed",!1),Ay.Factory.addGetterSetter(kl,"bezier",!1),Ay.Factory.addGetterSetter(kl,"tension",0,(0,R6.getNumberValidator)()),Ay.Factory.addGetterSetter(kl,"points",[],(0,R6.getNumberArrayValidator)());var Ad={},A6={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.t2length=t.getQuadraticArcLength=t.getCubicArcLength=t.binomialCoefficients=t.cValues=t.tValues=void 0,t.tValues=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],t.cValues=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],t.binomialCoefficients=[[1],[1,1],[1,2,1],[1,3,3,1]];const e=(o,s,l)=>{let u,c,d;u=l/2,c=0;for(let p=0;p<20;p++)d=u*t.tValues[20][p]+u,c+=t.cValues[20][p]*r(o,s,d);return u*c};t.getCubicArcLength=e;const n=(o,s,l)=>{l===void 0&&(l=1);const u=o[0]-2*o[1]+o[2],c=s[0]-2*s[1]+s[2],d=2*o[1]-2*o[0],p=2*s[1]-2*s[0],f=4*(u*u+c*c),m=4*(u*d+c*p),y=d*d+p*p;if(f===0)return l*Math.sqrt(Math.pow(o[2]-o[0],2)+Math.pow(s[2]-s[0],2));const x=m/(2*f),b=y/f,v=l+x,w=b-x*x,S=v*v+w>0?Math.sqrt(v*v+w):0,C=x*x+w>0?Math.sqrt(x*x+w):0,I=x+Math.sqrt(x*x+w)!==0?w*Math.log(Math.abs((v+S)/(x+C))):0;return Math.sqrt(f)/2*(v*S-x*C+I)};t.getQuadraticArcLength=n;function r(o,s,l){const u=a(1,l,o),c=a(1,l,s),d=u*u+c*c;return Math.sqrt(d)}const a=(o,s,l)=>{const u=l.length-1;let c,d;if(u===0)return 0;if(o===0){d=0;for(let p=0;p<=u;p++)d+=t.binomialCoefficients[u][p]*Math.pow(1-s,u-p)*Math.pow(s,p)*l[p];return d}else{c=new Array(u);for(let p=0;p<u;p++)c[p]=u*(l[p+1]-l[p]);return a(o-1,s,c)}},i=(o,s,l)=>{let u=1,c=o/s,d=(o-l(c))/s,p=0;for(;u>.001;){const f=l(c+d),m=Math.abs(o-f)/s;if(m<u)u=m,c+=d;else{const y=l(c-d),x=Math.abs(o-y)/s;x<u?(u=x,c-=d):d/=2}if(p++,p>500)break}return c};t.t2length=i})(A6),Object.defineProperty(Ad,"__esModule",{value:!0}),Ad.Path=void 0;const _J=kt,OJ=cr,$J=wt,Pd=A6;class mr extends OJ.Shape{constructor(e){super(e),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=mr.parsePathData(this.data()),this.pathLength=mr.getPathLength(this.dataArray)}_sceneFunc(e){var n=this.dataArray;e.beginPath();for(var r=!1,a=0;a<n.length;a++){var i=n[a].command,o=n[a].points;switch(i){case"L":e.lineTo(o[0],o[1]);break;case"M":e.moveTo(o[0],o[1]);break;case"C":e.bezierCurveTo(o[0],o[1],o[2],o[3],o[4],o[5]);break;case"Q":e.quadraticCurveTo(o[0],o[1],o[2],o[3]);break;case"A":var s=o[0],l=o[1],u=o[2],c=o[3],d=o[4],p=o[5],f=o[6],m=o[7],y=u>c?u:c,x=u>c?1:u/c,b=u>c?c/u:1;e.translate(s,l),e.rotate(f),e.scale(x,b),e.arc(0,0,y,d,d+p,1-m),e.scale(1/x,1/b),e.rotate(-f),e.translate(-s,-l);break;case"z":r=!0,e.closePath();break}}!r&&!this.hasFill()?e.strokeShape(this):e.fillStrokeShape(this)}getSelfRect(){var e=[];this.dataArray.forEach(function(u){if(u.command==="A"){var c=u.points[4],d=u.points[5],p=u.points[4]+d,f=Math.PI/180;if(Math.abs(c-p)<f&&(f=Math.abs(c-p)),d<0)for(let m=c-f;m>p;m-=f){const y=mr.getPointOnEllipticalArc(u.points[0],u.points[1],u.points[2],u.points[3],m,0);e.push(y.x,y.y)}else for(let m=c+f;m<p;m+=f){const y=mr.getPointOnEllipticalArc(u.points[0],u.points[1],u.points[2],u.points[3],m,0);e.push(y.x,y.y)}}else if(u.command==="C")for(let m=0;m<=1;m+=.01){const y=mr.getPointOnCubicBezier(m,u.start.x,u.start.y,u.points[0],u.points[1],u.points[2],u.points[3],u.points[4],u.points[5]);e.push(y.x,y.y)}else e=e.concat(u.points)});for(var n=e[0],r=e[0],a=e[1],i=e[1],o,s,l=0;l<e.length/2;l++)o=e[l*2],s=e[l*2+1],isNaN(o)||(n=Math.min(n,o),r=Math.max(r,o)),isNaN(s)||(a=Math.min(a,s),i=Math.max(i,s));return{x:n,y:a,width:r-n,height:i-a}}getLength(){return this.pathLength}getPointAtLength(e){return mr.getPointAtLengthOfDataArray(e,this.dataArray)}static getLineLength(e,n,r,a){return Math.sqrt((r-e)*(r-e)+(a-n)*(a-n))}static getPathLength(e){let n=0;for(var r=0;r<e.length;++r)n+=e[r].pathLength;return n}static getPointAtLengthOfDataArray(e,n){var r,a=0,i=n.length;if(!i)return null;for(;a<i&&e>n[a].pathLength;)e-=n[a].pathLength,++a;if(a===i)return r=n[a-1].points.slice(-2),{x:r[0],y:r[1]};if(e<.01)return r=n[a].points.slice(0,2),{x:r[0],y:r[1]};var o=n[a],s=o.points;switch(o.command){case"L":return mr.getPointOnLine(e,o.start.x,o.start.y,s[0],s[1]);case"C":return mr.getPointOnCubicBezier((0,Pd.t2length)(e,mr.getPathLength(n),y=>(0,Pd.getCubicArcLength)([o.start.x,s[0],s[2],s[4]],[o.start.y,s[1],s[3],s[5]],y)),o.start.x,o.start.y,s[0],s[1],s[2],s[3],s[4],s[5]);case"Q":return mr.getPointOnQuadraticBezier((0,Pd.t2length)(e,mr.getPathLength(n),y=>(0,Pd.getQuadraticArcLength)([o.start.x,s[0],s[2]],[o.start.y,s[1],s[3]],y)),o.start.x,o.start.y,s[0],s[1],s[2],s[3]);case"A":var l=s[0],u=s[1],c=s[2],d=s[3],p=s[4],f=s[5],m=s[6];return p+=f*e/o.pathLength,mr.getPointOnEllipticalArc(l,u,c,d,p,m)}return null}static getPointOnLine(e,n,r,a,i,o,s){o===void 0&&(o=n),s===void 0&&(s=r);var l=(i-r)/(a-n+1e-8),u=Math.sqrt(e*e/(1+l*l));a<n&&(u*=-1);var c=l*u,d;if(a===n)d={x:o,y:s+c};else if((s-r)/(o-n+1e-8)===l)d={x:o+u,y:s+c};else{var p,f,m=this.getLineLength(n,r,a,i),y=(o-n)*(a-n)+(s-r)*(i-r);y=y/(m*m),p=n+y*(a-n),f=r+y*(i-r);var x=this.getLineLength(o,s,p,f),b=Math.sqrt(e*e-x*x);u=Math.sqrt(b*b/(1+l*l)),a<n&&(u*=-1),c=l*u,d={x:p+u,y:f+c}}return d}static getPointOnCubicBezier(e,n,r,a,i,o,s,l,u){function c(x){return x*x*x}function d(x){return 3*x*x*(1-x)}function p(x){return 3*x*(1-x)*(1-x)}function f(x){return(1-x)*(1-x)*(1-x)}var m=l*c(e)+o*d(e)+a*p(e)+n*f(e),y=u*c(e)+s*d(e)+i*p(e)+r*f(e);return{x:m,y}}static getPointOnQuadraticBezier(e,n,r,a,i,o,s){function l(f){return f*f}function u(f){return 2*f*(1-f)}function c(f){return(1-f)*(1-f)}var d=o*l(e)+a*u(e)+n*c(e),p=s*l(e)+i*u(e)+r*c(e);return{x:d,y:p}}static getPointOnEllipticalArc(e,n,r,a,i,o){var s=Math.cos(o),l=Math.sin(o),u={x:r*Math.cos(i),y:a*Math.sin(i)};return{x:e+(u.x*s-u.y*l),y:n+(u.x*l+u.y*s)}}static parsePathData(e){if(!e)return[];var n=e,r=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];n=n.replace(new RegExp(" ","g"),",");for(var a=0;a<r.length;a++)n=n.replace(new RegExp(r[a],"g"),"|"+r[a]);var i=n.split("|"),o=[],s=[],l=0,u=0,c=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi,d;for(a=1;a<i.length;a++){var p=i[a],f=p.charAt(0);for(p=p.slice(1),s.length=0;d=c.exec(p);)s.push(d[0]);for(var m=[],y=0,x=s.length;y<x;y++){if(s[y]==="00"){m.push(0,0);continue}var b=parseFloat(s[y]);isNaN(b)?m.push(0):m.push(b)}for(;m.length>0&&!isNaN(m[0]);){var v="",w=[],S=l,C=u,I,_,E,P,A,D,V,z,K,X;switch(f){case"l":l+=m.shift(),u+=m.shift(),v="L",w.push(l,u);break;case"L":l=m.shift(),u=m.shift(),w.push(l,u);break;case"m":var Z=m.shift(),q=m.shift();if(l+=Z,u+=q,v="M",o.length>2&&o[o.length-1].command==="z"){for(var F=o.length-2;F>=0;F--)if(o[F].command==="M"){l=o[F].points[0]+Z,u=o[F].points[1]+q;break}}w.push(l,u),f="l";break;case"M":l=m.shift(),u=m.shift(),v="M",w.push(l,u),f="L";break;case"h":l+=m.shift(),v="L",w.push(l,u);break;case"H":l=m.shift(),v="L",w.push(l,u);break;case"v":u+=m.shift(),v="L",w.push(l,u);break;case"V":u=m.shift(),v="L",w.push(l,u);break;case"C":w.push(m.shift(),m.shift(),m.shift(),m.shift()),l=m.shift(),u=m.shift(),w.push(l,u);break;case"c":w.push(l+m.shift(),u+m.shift(),l+m.shift(),u+m.shift()),l+=m.shift(),u+=m.shift(),v="C",w.push(l,u);break;case"S":_=l,E=u,I=o[o.length-1],I.command==="C"&&(_=l+(l-I.points[2]),E=u+(u-I.points[3])),w.push(_,E,m.shift(),m.shift()),l=m.shift(),u=m.shift(),v="C",w.push(l,u);break;case"s":_=l,E=u,I=o[o.length-1],I.command==="C"&&(_=l+(l-I.points[2]),E=u+(u-I.points[3])),w.push(_,E,l+m.shift(),u+m.shift()),l+=m.shift(),u+=m.shift(),v="C",w.push(l,u);break;case"Q":w.push(m.shift(),m.shift()),l=m.shift(),u=m.shift(),w.push(l,u);break;case"q":w.push(l+m.shift(),u+m.shift()),l+=m.shift(),u+=m.shift(),v="Q",w.push(l,u);break;case"T":_=l,E=u,I=o[o.length-1],I.command==="Q"&&(_=l+(l-I.points[0]),E=u+(u-I.points[1])),l=m.shift(),u=m.shift(),v="Q",w.push(_,E,l,u);break;case"t":_=l,E=u,I=o[o.length-1],I.command==="Q"&&(_=l+(l-I.points[0]),E=u+(u-I.points[1])),l+=m.shift(),u+=m.shift(),v="Q",w.push(_,E,l,u);break;case"A":P=m.shift(),A=m.shift(),D=m.shift(),V=m.shift(),z=m.shift(),K=l,X=u,l=m.shift(),u=m.shift(),v="A",w=this.convertEndpointToCenterParameterization(K,X,l,u,V,z,P,A,D);break;case"a":P=m.shift(),A=m.shift(),D=m.shift(),V=m.shift(),z=m.shift(),K=l,X=u,l+=m.shift(),u+=m.shift(),v="A",w=this.convertEndpointToCenterParameterization(K,X,l,u,V,z,P,A,D);break}o.push({command:v||f,points:w,start:{x:S,y:C},pathLength:this.calcLength(S,C,v||f,w)})}(f==="z"||f==="Z")&&o.push({command:"z",points:[],start:void 0,pathLength:0})}return o}static calcLength(e,n,r,a){var i,o,s,l,u=mr;switch(r){case"L":return u.getLineLength(e,n,a[0],a[1]);case"C":return(0,Pd.getCubicArcLength)([e,a[0],a[2],a[4]],[n,a[1],a[3],a[5]],1);case"Q":return(0,Pd.getQuadraticArcLength)([e,a[0],a[2]],[n,a[1],a[3]],1);case"A":i=0;var c=a[4],d=a[5],p=a[4]+d,f=Math.PI/180;if(Math.abs(c-p)<f&&(f=Math.abs(c-p)),o=u.getPointOnEllipticalArc(a[0],a[1],a[2],a[3],c,0),d<0)for(l=c-f;l>p;l-=f)s=u.getPointOnEllipticalArc(a[0],a[1],a[2],a[3],l,0),i+=u.getLineLength(o.x,o.y,s.x,s.y),o=s;else for(l=c+f;l<p;l+=f)s=u.getPointOnEllipticalArc(a[0],a[1],a[2],a[3],l,0),i+=u.getLineLength(o.x,o.y,s.x,s.y),o=s;return s=u.getPointOnEllipticalArc(a[0],a[1],a[2],a[3],p,0),i+=u.getLineLength(o.x,o.y,s.x,s.y),i}return 0}static convertEndpointToCenterParameterization(e,n,r,a,i,o,s,l,u){var c=u*(Math.PI/180),d=Math.cos(c)*(e-r)/2+Math.sin(c)*(n-a)/2,p=-1*Math.sin(c)*(e-r)/2+Math.cos(c)*(n-a)/2,f=d*d/(s*s)+p*p/(l*l);f>1&&(s*=Math.sqrt(f),l*=Math.sqrt(f));var m=Math.sqrt((s*s*(l*l)-s*s*(p*p)-l*l*(d*d))/(s*s*(p*p)+l*l*(d*d)));i===o&&(m*=-1),isNaN(m)&&(m=0);var y=m*s*p/l,x=m*-l*d/s,b=(e+r)/2+Math.cos(c)*y-Math.sin(c)*x,v=(n+a)/2+Math.sin(c)*y+Math.cos(c)*x,w=function(A){return Math.sqrt(A[0]*A[0]+A[1]*A[1])},S=function(A,D){return(A[0]*D[0]+A[1]*D[1])/(w(A)*w(D))},C=function(A,D){return(A[0]*D[1]<A[1]*D[0]?-1:1)*Math.acos(S(A,D))},I=C([1,0],[(d-y)/s,(p-x)/l]),_=[(d-y)/s,(p-x)/l],E=[(-1*d-y)/s,(-1*p-x)/l],P=C(_,E);return S(_,E)<=-1&&(P=Math.PI),S(_,E)>=1&&(P=0),o===0&&P>0&&(P=P-2*Math.PI),o===1&&P<0&&(P=P+2*Math.PI),[b,v,s,l,I,P,c,o]}}Ad.Path=mr,mr.prototype.className="Path",mr.prototype._attrsAffectingSize=["data"],(0,$J._registerNode)(mr),_J.Factory.addGetterSetter(mr,"data"),Object.defineProperty(My,"__esModule",{value:!0}),My.Arrow=void 0;const Py=kt,RJ=pf,P6=Ge,MJ=wt,L6=Ad;class Mu extends RJ.Line{_sceneFunc(e){super._sceneFunc(e);var n=Math.PI*2,r=this.points(),a=r,i=this.tension()!==0&&r.length>4;i&&(a=this.getTensionPoints());var o=this.pointerLength(),s=r.length,l,u;if(i){const p=[a[a.length-4],a[a.length-3],a[a.length-2],a[a.length-1],r[s-2],r[s-1]],f=L6.Path.calcLength(a[a.length-4],a[a.length-3],"C",p),m=L6.Path.getPointOnQuadraticBezier(Math.min(1,1-o/f),p[0],p[1],p[2],p[3],p[4],p[5]);l=r[s-2]-m.x,u=r[s-1]-m.y}else l=r[s-2]-r[s-4],u=r[s-1]-r[s-3];var c=(Math.atan2(u,l)+n)%n,d=this.pointerWidth();this.pointerAtEnding()&&(e.save(),e.beginPath(),e.translate(r[s-2],r[s-1]),e.rotate(c),e.moveTo(0,0),e.lineTo(-o,d/2),e.lineTo(-o,-d/2),e.closePath(),e.restore(),this.__fillStroke(e)),this.pointerAtBeginning()&&(e.save(),e.beginPath(),e.translate(r[0],r[1]),i?(l=(a[0]+a[2])/2-r[0],u=(a[1]+a[3])/2-r[1]):(l=r[2]-r[0],u=r[3]-r[1]),e.rotate((Math.atan2(-u,-l)+n)%n),e.moveTo(0,0),e.lineTo(-o,d/2),e.lineTo(-o,-d/2),e.closePath(),e.restore(),this.__fillStroke(e))}__fillStroke(e){var n=this.dashEnabled();n&&(this.attrs.dashEnabled=!1,e.setLineDash([])),e.fillStrokeShape(this),n&&(this.attrs.dashEnabled=!0)}getSelfRect(){const e=super.getSelfRect(),n=this.pointerWidth()/2;return{x:e.x-n,y:e.y-n,width:e.width+n*2,height:e.height+n*2}}}My.Arrow=Mu,Mu.prototype.className="Arrow",(0,MJ._registerNode)(Mu),Py.Factory.addGetterSetter(Mu,"pointerLength",10,(0,P6.getNumberValidator)()),Py.Factory.addGetterSetter(Mu,"pointerWidth",10,(0,P6.getNumberValidator)()),Py.Factory.addGetterSetter(Mu,"pointerAtBeginning",!1),Py.Factory.addGetterSetter(Mu,"pointerAtEnding",!0);var Ly={};Object.defineProperty(Ly,"__esModule",{value:!0}),Ly.Circle=void 0;const AJ=kt,PJ=cr,LJ=Ge,DJ=wt;class Ld extends PJ.Shape{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius()!==e/2&&this.radius(e/2)}setHeight(e){this.radius()!==e/2&&this.radius(e/2)}}Ly.Circle=Ld,Ld.prototype._centroid=!0,Ld.prototype.className="Circle",Ld.prototype._attrsAffectingSize=["radius"],(0,DJ._registerNode)(Ld),AJ.Factory.addGetterSetter(Ld,"radius",0,(0,LJ.getNumberValidator)());var Dy={};Object.defineProperty(Dy,"__esModule",{value:!0}),Dy.Ellipse=void 0;const c3=kt,FJ=cr,D6=Ge,BJ=wt;class Sl extends FJ.Shape{_sceneFunc(e){var n=this.radiusX(),r=this.radiusY();e.beginPath(),e.save(),n!==r&&e.scale(1,r/n),e.arc(0,0,n,0,Math.PI*2,!1),e.restore(),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(e){this.radiusX(e/2)}setHeight(e){this.radiusY(e/2)}}Dy.Ellipse=Sl,Sl.prototype.className="Ellipse",Sl.prototype._centroid=!0,Sl.prototype._attrsAffectingSize=["radiusX","radiusY"],(0,BJ._registerNode)(Sl),c3.Factory.addComponentsGetterSetter(Sl,"radius",["x","y"]),c3.Factory.addGetterSetter(Sl,"radiusX",0,(0,D6.getNumberValidator)()),c3.Factory.addGetterSetter(Sl,"radiusY",0,(0,D6.getNumberValidator)());var Fy={};Object.defineProperty(Fy,"__esModule",{value:!0}),Fy.Image=void 0;const d3=Dn,Au=kt,zJ=cr,jJ=wt,hf=Ge;let _o=class rj extends zJ.Shape{constructor(e){super(e),this.on("imageChange.konva",()=>{this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){const e=this.image();e&&e.complete||e&&e.readyState===4||e&&e.addEventListener&&e.addEventListener("load",()=>{this._requestDraw()})}_useBufferCanvas(){return super._useBufferCanvas(!0)}_sceneFunc(e){const n=this.getWidth(),r=this.getHeight(),a=this.cornerRadius(),i=this.attrs.image;let o;if(i){const s=this.attrs.cropWidth,l=this.attrs.cropHeight;s&&l?o=[i,this.cropX(),this.cropY(),s,l,0,0,n,r]:o=[i,0,0,n,r]}(this.hasFill()||this.hasStroke()||a)&&(e.beginPath(),a?d3.Util.drawRoundedRectPath(e,n,r,a):e.rect(0,0,n,r),e.closePath(),e.fillStrokeShape(this)),i&&(a&&e.clip(),e.drawImage.apply(e,o))}_hitFunc(e){var n=this.width(),r=this.height(),a=this.cornerRadius();e.beginPath(),a?d3.Util.drawRoundedRectPath(e,n,r,a):e.rect(0,0,n,r),e.closePath(),e.fillStrokeShape(this)}getWidth(){var e,n;return(e=this.attrs.width)!==null&&e!==void 0?e:(n=this.image())===null||n===void 0?void 0:n.width}getHeight(){var e,n;return(e=this.attrs.height)!==null&&e!==void 0?e:(n=this.image())===null||n===void 0?void 0:n.height}static fromURL(e,n,r=null){var a=d3.Util.createImageElement();a.onload=function(){var i=new rj({image:a});n(i)},a.onerror=r,a.crossOrigin="Anonymous",a.src=e}};Fy.Image=_o,_o.prototype.className="Image",(0,jJ._registerNode)(_o),Au.Factory.addGetterSetter(_o,"cornerRadius",0,(0,hf.getNumberOrArrayOfNumbersValidator)(4)),Au.Factory.addGetterSetter(_o,"image"),Au.Factory.addComponentsGetterSetter(_o,"crop",["x","y","width","height"]),Au.Factory.addGetterSetter(_o,"cropX",0,(0,hf.getNumberValidator)()),Au.Factory.addGetterSetter(_o,"cropY",0,(0,hf.getNumberValidator)()),Au.Factory.addGetterSetter(_o,"cropWidth",0,(0,hf.getNumberValidator)()),Au.Factory.addGetterSetter(_o,"cropHeight",0,(0,hf.getNumberValidator)());var Dd={};Object.defineProperty(Dd,"__esModule",{value:!0}),Dd.Tag=Dd.Label=void 0;const By=kt,VJ=cr,WJ=Rd,p3=Ge,F6=wt;var B6=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],UJ="Change.konva",GJ="none",h3="up",f3="right",g3="down",m3="left",HJ=B6.length;class y3 extends WJ.Group{constructor(e){super(e),this.on("add.konva",function(n){this._addListeners(n.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(e){var n=this,r,a=function(){n._sync()};for(r=0;r<HJ;r++)e.on(B6[r]+UJ,a)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){var e=this.getText(),n=this.getTag(),r,a,i,o,s,l,u;if(e&&n){switch(r=e.width(),a=e.height(),i=n.pointerDirection(),o=n.pointerWidth(),u=n.pointerHeight(),s=0,l=0,i){case h3:s=r/2,l=-1*u;break;case f3:s=r+o,l=a/2;break;case g3:s=r/2,l=a+u;break;case m3:s=-1*o,l=a/2;break}n.setAttrs({x:-1*s,y:-1*l,width:r,height:a}),e.setAttrs({x:-1*s,y:-1*l})}}}Dd.Label=y3,y3.prototype.className="Label",(0,F6._registerNode)(y3);class Pu extends VJ.Shape{_sceneFunc(e){var n=this.width(),r=this.height(),a=this.pointerDirection(),i=this.pointerWidth(),o=this.pointerHeight(),s=this.cornerRadius();let l=0,u=0,c=0,d=0;typeof s=="number"?l=u=c=d=Math.min(s,n/2,r/2):(l=Math.min(s[0]||0,n/2,r/2),u=Math.min(s[1]||0,n/2,r/2),d=Math.min(s[2]||0,n/2,r/2),c=Math.min(s[3]||0,n/2,r/2)),e.beginPath(),e.moveTo(l,0),a===h3&&(e.lineTo((n-i)/2,0),e.lineTo(n/2,-1*o),e.lineTo((n+i)/2,0)),e.lineTo(n-u,0),e.arc(n-u,u,u,Math.PI*3/2,0,!1),a===f3&&(e.lineTo(n,(r-o)/2),e.lineTo(n+i,r/2),e.lineTo(n,(r+o)/2)),e.lineTo(n,r-d),e.arc(n-d,r-d,d,0,Math.PI/2,!1),a===g3&&(e.lineTo((n+i)/2,r),e.lineTo(n/2,r+o),e.lineTo((n-i)/2,r)),e.lineTo(c,r),e.arc(c,r-c,c,Math.PI/2,Math.PI,!1),a===m3&&(e.lineTo(0,(r+o)/2),e.lineTo(-1*i,r/2),e.lineTo(0,(r-o)/2)),e.lineTo(0,l),e.arc(l,l,l,Math.PI,Math.PI*3/2,!1),e.closePath(),e.fillStrokeShape(this)}getSelfRect(){var e=0,n=0,r=this.pointerWidth(),a=this.pointerHeight(),i=this.pointerDirection(),o=this.width(),s=this.height();return i===h3?(n-=a,s+=a):i===g3?s+=a:i===m3?(e-=r*1.5,o+=r):i===f3&&(o+=r*1.5),{x:e,y:n,width:o,height:s}}}Dd.Tag=Pu,Pu.prototype.className="Tag",(0,F6._registerNode)(Pu),By.Factory.addGetterSetter(Pu,"pointerDirection",GJ),By.Factory.addGetterSetter(Pu,"pointerWidth",0,(0,p3.getNumberValidator)()),By.Factory.addGetterSetter(Pu,"pointerHeight",0,(0,p3.getNumberValidator)()),By.Factory.addGetterSetter(Pu,"cornerRadius",0,(0,p3.getNumberOrArrayOfNumbersValidator)(4));var ff={};Object.defineProperty(ff,"__esModule",{value:!0}),ff.Rect=void 0;const qJ=kt,KJ=cr,XJ=wt,YJ=Dn,QJ=Ge;class zy extends KJ.Shape{_sceneFunc(e){var n=this.cornerRadius(),r=this.width(),a=this.height();e.beginPath(),n?YJ.Util.drawRoundedRectPath(e,r,a,n):e.rect(0,0,r,a),e.closePath(),e.fillStrokeShape(this)}}ff.Rect=zy,zy.prototype.className="Rect",(0,XJ._registerNode)(zy),qJ.Factory.addGetterSetter(zy,"cornerRadius",0,(0,QJ.getNumberOrArrayOfNumbersValidator)(4));var jy={};Object.defineProperty(jy,"__esModule",{value:!0}),jy.RegularPolygon=void 0;const z6=kt,ZJ=cr,j6=Ge,JJ=wt;class Lu extends ZJ.Shape{_sceneFunc(e){const n=this._getPoints();e.beginPath(),e.moveTo(n[0].x,n[0].y);for(var r=1;r<n.length;r++)e.lineTo(n[r].x,n[r].y);e.closePath(),e.fillStrokeShape(this)}_getPoints(){const e=this.attrs.sides,n=this.attrs.radius||0,r=[];for(var a=0;a<e;a++)r.push({x:n*Math.sin(a*2*Math.PI/e),y:-1*n*Math.cos(a*2*Math.PI/e)});return r}getSelfRect(){const e=this._getPoints();var n=e[0].x,r=e[0].y,a=e[0].x,i=e[0].y;return e.forEach(o=>{n=Math.min(n,o.x),r=Math.max(r,o.x),a=Math.min(a,o.y),i=Math.max(i,o.y)}),{x:n,y:a,width:r-n,height:i-a}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius(e/2)}setHeight(e){this.radius(e/2)}}jy.RegularPolygon=Lu,Lu.prototype.className="RegularPolygon",Lu.prototype._centroid=!0,Lu.prototype._attrsAffectingSize=["radius"],(0,JJ._registerNode)(Lu),z6.Factory.addGetterSetter(Lu,"radius",0,(0,j6.getNumberValidator)()),z6.Factory.addGetterSetter(Lu,"sides",0,(0,j6.getNumberValidator)());var Vy={};Object.defineProperty(Vy,"__esModule",{value:!0}),Vy.Ring=void 0;const V6=kt,eee=cr,W6=Ge,tee=wt;var U6=Math.PI*2;class Du extends eee.Shape{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.innerRadius(),0,U6,!1),e.moveTo(this.outerRadius(),0),e.arc(0,0,this.outerRadius(),U6,0,!0),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}}Vy.Ring=Du,Du.prototype.className="Ring",Du.prototype._centroid=!0,Du.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,tee._registerNode)(Du),V6.Factory.addGetterSetter(Du,"innerRadius",0,(0,W6.getNumberValidator)()),V6.Factory.addGetterSetter(Du,"outerRadius",0,(0,W6.getNumberValidator)());var Wy={};Object.defineProperty(Wy,"__esModule",{value:!0}),Wy.Sprite=void 0;const Fu=kt,nee=cr,ree=Md,G6=Ge,aee=wt;class Oo extends nee.Shape{constructor(e){super(e),this._updated=!0,this.anim=new ree.Animation(()=>{var n=this._updated;return this._updated=!1,n}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(e){var n=this.animation(),r=this.frameIndex(),a=r*4,i=this.animations()[n],o=this.frameOffsets(),s=i[a+0],l=i[a+1],u=i[a+2],c=i[a+3],d=this.image();if((this.hasFill()||this.hasStroke())&&(e.beginPath(),e.rect(0,0,u,c),e.closePath(),e.fillStrokeShape(this)),d)if(o){var p=o[n],f=r*2;e.drawImage(d,s,l,u,c,p[f+0],p[f+1],u,c)}else e.drawImage(d,s,l,u,c,0,0,u,c)}_hitFunc(e){var n=this.animation(),r=this.frameIndex(),a=r*4,i=this.animations()[n],o=this.frameOffsets(),s=i[a+2],l=i[a+3];if(e.beginPath(),o){var u=o[n],c=r*2;e.rect(u[c+0],u[c+1],s,l)}else e.rect(0,0,s,l);e.closePath(),e.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){var e=this;this.interval=setInterval(function(){e._updateIndex()},1e3/this.frameRate())}start(){if(!this.isRunning()){var e=this.getLayer();this.anim.setLayers(e),this._setInterval(),this.anim.start()}}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){var e=this.frameIndex(),n=this.animation(),r=this.animations(),a=r[n],i=a.length/4;e<i-1?this.frameIndex(e+1):this.frameIndex(0)}}Wy.Sprite=Oo,Oo.prototype.className="Sprite",(0,aee._registerNode)(Oo),Fu.Factory.addGetterSetter(Oo,"animation"),Fu.Factory.addGetterSetter(Oo,"animations"),Fu.Factory.addGetterSetter(Oo,"frameOffsets"),Fu.Factory.addGetterSetter(Oo,"image"),Fu.Factory.addGetterSetter(Oo,"frameIndex",0,(0,G6.getNumberValidator)()),Fu.Factory.addGetterSetter(Oo,"frameRate",17,(0,G6.getNumberValidator)()),Fu.Factory.backCompat(Oo,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"});var Uy={};Object.defineProperty(Uy,"__esModule",{value:!0}),Uy.Star=void 0;const b3=kt,iee=cr,v3=Ge,oee=wt;class Cl extends iee.Shape{_sceneFunc(e){var n=this.innerRadius(),r=this.outerRadius(),a=this.numPoints();e.beginPath(),e.moveTo(0,0-r);for(var i=1;i<a*2;i++){var o=i%2===0?r:n,s=o*Math.sin(i*Math.PI/a),l=-1*o*Math.cos(i*Math.PI/a);e.lineTo(s,l)}e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}}Uy.Star=Cl,Cl.prototype.className="Star",Cl.prototype._centroid=!0,Cl.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,oee._registerNode)(Cl),b3.Factory.addGetterSetter(Cl,"numPoints",5,(0,v3.getNumberValidator)()),b3.Factory.addGetterSetter(Cl,"innerRadius",0,(0,v3.getNumberValidator)()),b3.Factory.addGetterSetter(Cl,"outerRadius",0,(0,v3.getNumberValidator)());var Bu={};Object.defineProperty(Bu,"__esModule",{value:!0}),Bu.Text=Bu.stringToArray=void 0;const x3=Dn,ia=kt,see=cr,Nl=Ge,lee=wt;function H6(t){return Array.from(t)}Bu.stringToArray=H6;var Fd="auto",uee="center",q6="inherit",gf="justify",cee="Change.konva",dee="2d",K6="-",X6="left",pee="text",hee="Text",fee="top",gee="bottom",Y6="middle",Q6="normal",mee="px ",Gy=" ",yee="right",Z6="rtl",bee="word",vee="char",J6="none",w3="\u2026",eA=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],xee=eA.length;function wee(t){return t.split(",").map(e=>{e=e.trim();const n=e.indexOf(" ")>=0,r=e.indexOf('"')>=0||e.indexOf("'")>=0;return n&&!r&&(e=`"${e}"`),e}).join(", ")}var k3;function S3(){return k3||(k3=x3.Util.createCanvasElement().getContext(dee),k3)}function kee(t){t.fillText(this._partialText,this._partialTextX,this._partialTextY)}function See(t){t.setAttr("miterLimit",2),t.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function Cee(t){return t=t||{},!t.fillLinearGradientColorStops&&!t.fillRadialGradientColorStops&&!t.fillPatternImage&&(t.fill=t.fill||"black"),t}class Wn extends see.Shape{constructor(e){super(Cee(e)),this._partialTextX=0,this._partialTextY=0;for(var n=0;n<xee;n++)this.on(eA[n]+cee,this._setTextData);this._setTextData()}_sceneFunc(e){var n=this.textArr,r=n.length;if(this.text()){var a=this.padding(),i=this.fontSize(),o=this.lineHeight()*i,s=this.verticalAlign(),l=this.direction(),u=0,c=this.align(),d=this.getWidth(),p=this.letterSpacing(),f=this.fill(),m=this.textDecoration(),y=m.indexOf("underline")!==-1,x=m.indexOf("line-through")!==-1,b;l=l===q6?e.direction:l;var v=0,v=o/2,w=0,S=0;for(l===Z6&&e.setAttr("direction",l),e.setAttr("font",this._getContextFont()),e.setAttr("textBaseline",Y6),e.setAttr("textAlign",X6),s===Y6?u=(this.getHeight()-r*o-a*2)/2:s===gee&&(u=this.getHeight()-r*o-a*2),e.translate(a,u+a),b=0;b<r;b++){var w=0,S=0,C=n[b],I=C.text,_=C.width,E=C.lastInParagraph,P,A,D;if(e.save(),c===yee?w+=d-_-a*2:c===uee&&(w+=(d-_-a*2)/2),y){e.save(),e.beginPath(),e.moveTo(w,v+S+Math.round(i/2)),P=I.split(" ").length-1,A=P===0,D=c===gf&&!E?d-a*2:_,e.lineTo(w+Math.round(D),v+S+Math.round(i/2)),e.lineWidth=i/15;const q=this._getLinearGradient();e.strokeStyle=q||f,e.stroke(),e.restore()}if(x){e.save(),e.beginPath(),e.moveTo(w,v+S),P=I.split(" ").length-1,A=P===0,D=c===gf&&E&&!A?d-a*2:_,e.lineTo(w+Math.round(D),v+S),e.lineWidth=i/15;const q=this._getLinearGradient();e.strokeStyle=q||f,e.stroke(),e.restore()}if(l!==Z6&&(p!==0||c===gf)){P=I.split(" ").length-1;for(var V=H6(I),z=0;z<V.length;z++){var K=V[z];K===" "&&!E&&c===gf&&(w+=(d-a*2-_)/P),this._partialTextX=w,this._partialTextY=v+S,this._partialText=K,e.fillStrokeShape(this),w+=this.measureSize(K).width+p}}else p!==0&&e.setAttr("letterSpacing",`${p}px`),this._partialTextX=w,this._partialTextY=v+S,this._partialText=I,e.fillStrokeShape(this);e.restore(),r>1&&(v+=o)}}}_hitFunc(e){var n=this.getWidth(),r=this.getHeight();e.beginPath(),e.rect(0,0,n,r),e.closePath(),e.fillStrokeShape(this)}setText(e){var n=x3.Util._isString(e)?e:e==null?"":e+"";return this._setAttr(pee,n),this}getWidth(){var e=this.attrs.width===Fd||this.attrs.width===void 0;return e?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){var e=this.attrs.height===Fd||this.attrs.height===void 0;return e?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return x3.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(e){var n=S3(),r=this.fontSize(),a;return n.save(),n.font=this._getContextFont(),a=n.measureText(e),n.restore(),{width:a.width,height:r}}_getContextFont(){return this.fontStyle()+Gy+this.fontVariant()+Gy+(this.fontSize()+mee)+wee(this.fontFamily())}_addTextLine(e){this.align()===gf&&(e=e.trim());var n=this._getTextWidth(e);return this.textArr.push({text:e,width:n,lastInParagraph:!1})}_getTextWidth(e){var n=this.letterSpacing(),r=e.length;return S3().measureText(e).width+(r?n*(r-1):0)}_setTextData(){var e=this.text().split(`
`),n=+this.fontSize(),r=0,a=this.lineHeight()*n,i=this.attrs.width,o=this.attrs.height,s=i!==Fd&&i!==void 0,l=o!==Fd&&o!==void 0,u=this.padding(),c=i-u*2,d=o-u*2,p=0,f=this.wrap(),m=f!==J6,y=f!==vee&&m,x=this.ellipsis();this.textArr=[],S3().font=this._getContextFont();for(var b=x?this._getTextWidth(w3):0,v=0,w=e.length;v<w;++v){var S=e[v],C=this._getTextWidth(S);if(s&&C>c)for(;S.length>0;){for(var I=0,_=S.length,E="",P=0;I<_;){var A=I+_>>>1,D=S.slice(0,A+1),V=this._getTextWidth(D)+b;V<=c?(I=A+1,E=D,P=V):_=A}if(E){if(y){var z,K=S[E.length],X=K===Gy||K===K6;X&&P<=c?z=E.length:z=Math.max(E.lastIndexOf(Gy),E.lastIndexOf(K6))+1,z>0&&(I=z,E=E.slice(0,I),P=this._getTextWidth(E))}E=E.trimRight(),this._addTextLine(E),r=Math.max(r,P),p+=a;var Z=this._shouldHandleEllipsis(p);if(Z){this._tryToAddEllipsisToLastLine();break}if(S=S.slice(I),S=S.trimLeft(),S.length>0&&(C=this._getTextWidth(S),C<=c)){this._addTextLine(S),p+=a,r=Math.max(r,C);break}}else break}else this._addTextLine(S),p+=a,r=Math.max(r,C),this._shouldHandleEllipsis(p)&&v<w-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),l&&p+a>d)break}this.textHeight=n,this.textWidth=r}_shouldHandleEllipsis(e){var n=+this.fontSize(),r=this.lineHeight()*n,a=this.attrs.height,i=a!==Fd&&a!==void 0,o=this.padding(),s=a-o*2,l=this.wrap(),u=l!==J6;return!u||i&&e+r>s}_tryToAddEllipsisToLastLine(){var e=this.attrs.width,n=e!==Fd&&e!==void 0,r=this.padding(),a=e-r*2,i=this.ellipsis(),o=this.textArr[this.textArr.length-1];if(!(!o||!i)){if(n){var s=this._getTextWidth(o.text+w3)<a;s||(o.text=o.text.slice(0,o.text.length-3))}this.textArr.splice(this.textArr.length-1,1),this._addTextLine(o.text+w3)}}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){const e=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,n=this.hasShadow();return e&&n?!0:super._useBufferCanvas()}}Bu.Text=Wn,Wn.prototype._fillFunc=kee,Wn.prototype._strokeFunc=See,Wn.prototype.className=hee,Wn.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"],(0,lee._registerNode)(Wn),ia.Factory.overWriteSetter(Wn,"width",(0,Nl.getNumberOrAutoValidator)()),ia.Factory.overWriteSetter(Wn,"height",(0,Nl.getNumberOrAutoValidator)()),ia.Factory.addGetterSetter(Wn,"direction",q6),ia.Factory.addGetterSetter(Wn,"fontFamily","Arial"),ia.Factory.addGetterSetter(Wn,"fontSize",12,(0,Nl.getNumberValidator)()),ia.Factory.addGetterSetter(Wn,"fontStyle",Q6),ia.Factory.addGetterSetter(Wn,"fontVariant",Q6),ia.Factory.addGetterSetter(Wn,"padding",0,(0,Nl.getNumberValidator)()),ia.Factory.addGetterSetter(Wn,"align",X6),ia.Factory.addGetterSetter(Wn,"verticalAlign",fee),ia.Factory.addGetterSetter(Wn,"lineHeight",1,(0,Nl.getNumberValidator)()),ia.Factory.addGetterSetter(Wn,"wrap",bee),ia.Factory.addGetterSetter(Wn,"ellipsis",!1,(0,Nl.getBooleanValidator)()),ia.Factory.addGetterSetter(Wn,"letterSpacing",0,(0,Nl.getNumberValidator)()),ia.Factory.addGetterSetter(Wn,"text","",(0,Nl.getStringValidator)()),ia.Factory.addGetterSetter(Wn,"textDecoration","");var Hy={};Object.defineProperty(Hy,"__esModule",{value:!0}),Hy.TextPath=void 0;const C3=Dn,ro=kt,Nee=cr,mf=Ad,N3=Bu,tA=Ge,Tee=wt;var Iee="",nA="normal";function rA(t){t.fillText(this.partialText,0,0)}function aA(t){t.strokeText(this.partialText,0,0)}class dr extends Nee.Shape{constructor(e){super(e),this.dummyCanvas=C3.Util.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return mf.Path.getPathLength(this.dataArray)}_getPointAtLength(e){if(!this.attrs.data)return null;const n=this.pathLength;return e-1>n?null:mf.Path.getPointAtLengthOfDataArray(e,this.dataArray)}_readDataAttribute(){this.dataArray=mf.Path.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(e){e.setAttr("font",this._getContextFont()),e.setAttr("textBaseline",this.textBaseline()),e.setAttr("textAlign","left"),e.save();var n=this.textDecoration(),r=this.fill(),a=this.fontSize(),i=this.glyphInfo;n==="underline"&&e.beginPath();for(var o=0;o<i.length;o++){e.save();var s=i[o].p0;e.translate(s.x,s.y),e.rotate(i[o].rotation),this.partialText=i[o].text,e.fillStrokeShape(this),n==="underline"&&(o===0&&e.moveTo(0,a/2+1),e.lineTo(a,a/2+1)),e.restore()}n==="underline"&&(e.strokeStyle=r,e.lineWidth=a/20,e.stroke()),e.restore()}_hitFunc(e){e.beginPath();var n=this.glyphInfo;if(n.length>=1){var r=n[0].p0;e.moveTo(r.x,r.y)}for(var a=0;a<n.length;a++){var i=n[a].p1;e.lineTo(i.x,i.y)}e.setAttr("lineWidth",this.fontSize()),e.setAttr("strokeStyle",this.colorKey),e.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return C3.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(e){return N3.Text.prototype.setText.call(this,e)}_getContextFont(){return N3.Text.prototype._getContextFont.call(this)}_getTextSize(e){var n=this.dummyCanvas,r=n.getContext("2d");r.save(),r.font=this._getContextFont();var a=r.measureText(e);return r.restore(),{width:a.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){const{width:e,height:n}=this._getTextSize(this.attrs.text);if(this.textWidth=e,this.textHeight=n,this.glyphInfo=[],!this.attrs.data)return null;const r=this.letterSpacing(),a=this.align(),i=this.kerningFunc(),o=Math.max(this.textWidth+((this.attrs.text||"").length-1)*r,0);let s=0;a==="center"&&(s=Math.max(0,this.pathLength/2-o/2)),a==="right"&&(s=Math.max(0,this.pathLength-o));const l=(0,N3.stringToArray)(this.text());let u=s;for(var c=0;c<l.length;c++){const d=this._getPointAtLength(u);if(!d)return;let p=this._getTextSize(l[c]).width+r;if(l[c]===" "&&a==="justify"){const v=this.text().split(" ").length-1;p+=(this.pathLength-o)/v}const f=this._getPointAtLength(u+p);if(!f)return;const m=mf.Path.getLineLength(d.x,d.y,f.x,f.y);let y=0;if(i)try{y=i(l[c-1],l[c])*this.fontSize()}catch{y=0}d.x+=y,f.x+=y,this.textWidth+=y;const x=mf.Path.getPointOnLine(y+m/2,d.x,d.y,f.x,f.y),b=Math.atan2(f.y-d.y,f.x-d.x);this.glyphInfo.push({transposeX:x.x,transposeY:x.y,text:l[c],rotation:b,p0:d,p1:f}),u+=p}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};var e=[];this.glyphInfo.forEach(function(c){e.push(c.p0.x),e.push(c.p0.y),e.push(c.p1.x),e.push(c.p1.y)});for(var n=e[0]||0,r=e[0]||0,a=e[1]||0,i=e[1]||0,o,s,l=0;l<e.length/2;l++)o=e[l*2],s=e[l*2+1],n=Math.min(n,o),r=Math.max(r,o),a=Math.min(a,s),i=Math.max(i,s);var u=this.fontSize();return{x:n-u/2,y:a-u/2,width:r-n+u,height:i-a+u}}destroy(){return C3.Util.releaseCanvas(this.dummyCanvas),super.destroy()}}Hy.TextPath=dr,dr.prototype._fillFunc=rA,dr.prototype._strokeFunc=aA,dr.prototype._fillFuncHit=rA,dr.prototype._strokeFuncHit=aA,dr.prototype.className="TextPath",dr.prototype._attrsAffectingSize=["text","fontSize","data"],(0,Tee._registerNode)(dr),ro.Factory.addGetterSetter(dr,"data"),ro.Factory.addGetterSetter(dr,"fontFamily","Arial"),ro.Factory.addGetterSetter(dr,"fontSize",12,(0,tA.getNumberValidator)()),ro.Factory.addGetterSetter(dr,"fontStyle",nA),ro.Factory.addGetterSetter(dr,"align","left"),ro.Factory.addGetterSetter(dr,"letterSpacing",0,(0,tA.getNumberValidator)()),ro.Factory.addGetterSetter(dr,"textBaseline","middle"),ro.Factory.addGetterSetter(dr,"fontVariant",nA),ro.Factory.addGetterSetter(dr,"text",Iee),ro.Factory.addGetterSetter(dr,"textDecoration",null),ro.Factory.addGetterSetter(dr,"kerningFunc",null);var qy={};Object.defineProperty(qy,"__esModule",{value:!0}),qy.Transformer=void 0;const en=Dn,Ut=kt,iA=Tn,Eee=cr,_ee=ff,oA=Rd,ao=wt,Tl=Ge,Oee=wt;var sA="tr-konva",$ee=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(t=>t+`.${sA}`).join(" "),lA="nodesRect",Ree=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange"],Mee={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135};const Aee="ontouchstart"in ao.Konva._global;function Pee(t,e,n){if(t==="rotater")return n;e+=en.Util.degToRad(Mee[t]||0);var r=(en.Util.radToDeg(e)%360+360)%360;return en.Util._inRange(r,315+22.5,360)||en.Util._inRange(r,0,22.5)?"ns-resize":en.Util._inRange(r,45-22.5,45+22.5)?"nesw-resize":en.Util._inRange(r,90-22.5,90+22.5)?"ew-resize":en.Util._inRange(r,135-22.5,135+22.5)?"nwse-resize":en.Util._inRange(r,180-22.5,180+22.5)?"ns-resize":en.Util._inRange(r,225-22.5,225+22.5)?"nesw-resize":en.Util._inRange(r,270-22.5,270+22.5)?"ew-resize":en.Util._inRange(r,315-22.5,315+22.5)?"nwse-resize":(en.Util.error("Transformer has unknown angle for cursor detection: "+r),"pointer")}var Ky=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"],uA=1e8;function Lee(t){return{x:t.x+t.width/2*Math.cos(t.rotation)+t.height/2*Math.sin(-t.rotation),y:t.y+t.height/2*Math.cos(t.rotation)+t.width/2*Math.sin(t.rotation)}}function cA(t,e,n){const r=n.x+(t.x-n.x)*Math.cos(e)-(t.y-n.y)*Math.sin(e),a=n.y+(t.x-n.x)*Math.sin(e)+(t.y-n.y)*Math.cos(e);return{...t,rotation:t.rotation+e,x:r,y:a}}function Dee(t,e){const n=Lee(t);return cA(t,e,n)}function Fee(t,e,n){let r=e;for(let a=0;a<t.length;a++){const i=ao.Konva.getAngle(t[a]),o=Math.abs(i-e)%(Math.PI*2);Math.min(o,Math.PI*2-o)<n&&(r=i)}return r}let At=class extends oA.Group{constructor(t){super(t),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on($ee,this.update),this.getNode()&&this.update()}attachTo(t){return this.setNode(t),this}setNode(t){return en.Util.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([t])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return sA+this._id}setNodes(t=[]){this._nodes&&this._nodes.length&&this.detach();const e=t.filter(r=>r.isAncestorOf(this)?(en.Util.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);this._nodes=t=e,t.length===1&&this.useSingleNodeRotation()?this.rotation(t[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(r=>{const a=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()},i=r._attrsAffectingSize.map(o=>o+"Change."+this._getEventNamespace()).join(" ");r.on(i,a),r.on(Ree.map(o=>o+`.${this._getEventNamespace()}`).join(" "),a),r.on(`absoluteTransformChange.${this._getEventNamespace()}`,a),this._proxyDrag(r)}),this._resetTransformCache();var n=!!this.findOne(".top-left");return n&&this.update(),this}_proxyDrag(t){let e;t.on(`dragstart.${this._getEventNamespace()}`,n=>{e=t.getAbsolutePosition(),!this.isDragging()&&t!==this.findOne(".back")&&this.startDrag(n,!1)}),t.on(`dragmove.${this._getEventNamespace()}`,n=>{if(!e)return;const r=t.getAbsolutePosition(),a=r.x-e.x,i=r.y-e.y;this.nodes().forEach(o=>{if(o===t||o.isDragging())return;const s=o.getAbsolutePosition();o.setAbsolutePosition({x:s.x+a,y:s.y+i}),o.startDrag(n)}),e=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(t=>{t.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(lA),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(lA,this.__getNodeRect)}__getNodeShape(t,e=this.rotation(),n){var r=t.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),a=t.getAbsoluteScale(n),i=t.getAbsolutePosition(n),o=r.x*a.x-t.offsetX()*a.x,s=r.y*a.y-t.offsetY()*a.y;const l=(ao.Konva.getAngle(t.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),u={x:i.x+o*Math.cos(l)+s*Math.sin(-l),y:i.y+s*Math.cos(l)+o*Math.sin(l),width:r.width*a.x,height:r.height*a.y,rotation:l};return cA(u,-ao.Konva.getAngle(e),{x:0,y:0})}__getNodeRect(){var t=this.getNode();if(!t)return{x:-uA,y:-uA,width:0,height:0,rotation:0};const e=[];this.nodes().map(l=>{const u=l.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()});var c=[{x:u.x,y:u.y},{x:u.x+u.width,y:u.y},{x:u.x+u.width,y:u.y+u.height},{x:u.x,y:u.y+u.height}],d=l.getAbsoluteTransform();c.forEach(function(p){var f=d.point(p);e.push(f)})});const n=new en.Transform;n.rotate(-ao.Konva.getAngle(this.rotation()));var r=1/0,a=1/0,i=-1/0,o=-1/0;e.forEach(function(l){var u=n.point(l);r===void 0&&(r=i=u.x,a=o=u.y),r=Math.min(r,u.x),a=Math.min(a,u.y),i=Math.max(i,u.x),o=Math.max(o,u.y)}),n.invert();const s=n.point({x:r,y:a});return{x:s.x,y:s.y,width:i-r,height:o-a,rotation:ao.Konva.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),Ky.forEach(t=>{this._createAnchor(t)}),this._createAnchor("rotater")}_createAnchor(t){var e=new _ee.Rect({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:t+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:Aee?10:"auto"}),n=this;e.on("mousedown touchstart",function(r){n._handleMouseDown(r)}),e.on("dragstart",r=>{e.stopDrag(),r.cancelBubble=!0}),e.on("dragend",r=>{r.cancelBubble=!0}),e.on("mouseenter",()=>{var r=ao.Konva.getAngle(this.rotation()),a=this.rotateAnchorCursor(),i=Pee(t,r,a);e.getStage().content&&(e.getStage().content.style.cursor=i),this._cursorChange=!0}),e.on("mouseout",()=>{e.getStage().content&&(e.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(e)}_createBack(){var t=new Eee.Shape({name:"back",width:0,height:0,draggable:!0,sceneFunc(e,n){var r=n.getParent(),a=r.padding();e.beginPath(),e.rect(-a,-a,n.width()+a*2,n.height()+a*2),e.moveTo(n.width()/2,-a),r.rotateEnabled()&&r.rotateLineVisible()&&e.lineTo(n.width()/2,-r.rotateAnchorOffset()*en.Util._sign(n.height())-a),e.fillStrokeShape(n)},hitFunc:(e,n)=>{if(this.shouldOverdrawWholeArea()){var r=this.padding();e.beginPath(),e.rect(-r,-r,n.width()+r*2,n.height()+r*2),e.fillStrokeShape(n)}}});this.add(t),this._proxyDrag(t),t.on("dragstart",e=>{e.cancelBubble=!0}),t.on("dragmove",e=>{e.cancelBubble=!0}),t.on("dragend",e=>{e.cancelBubble=!0}),this.on("dragmove",e=>{this.update()})}_handleMouseDown(t){this._movingAnchorName=t.target.name().split(" ")[0];var e=this._getNodeRect(),n=e.width,r=e.height,a=Math.sqrt(Math.pow(n,2)+Math.pow(r,2));this.sin=Math.abs(r/a),this.cos=Math.abs(n/a),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;var i=t.target.getAbsolutePosition(),o=t.target.getStage().getPointerPosition();this._anchorDragOffset={x:o.x-i.x,y:o.y-i.y},this._fire("transformstart",{evt:t.evt,target:this.getNode()}),this._nodes.forEach(s=>{s._fire("transformstart",{evt:t.evt,target:s})})}_handleMouseMove(t){var e,n,r,a=this.findOne("."+this._movingAnchorName),i=a.getStage();i.setPointersPositions(t);const o=i.getPointerPosition();let s={x:o.x-this._anchorDragOffset.x,y:o.y-this._anchorDragOffset.y};const l=a.getAbsolutePosition();this.anchorDragBoundFunc()&&(s=this.anchorDragBoundFunc()(l,s,t)),a.setAbsolutePosition(s);const u=a.getAbsolutePosition();if(!(l.x===u.x&&l.y===u.y)){if(this._movingAnchorName==="rotater"){var c=this._getNodeRect();e=a.x()-c.width/2,n=-a.y()+c.height/2;let V=Math.atan2(-n,e)+Math.PI/2;c.height<0&&(V-=Math.PI);var d=ao.Konva.getAngle(this.rotation());const z=d+V,K=ao.Konva.getAngle(this.rotationSnapTolerance()),X=Fee(this.rotationSnaps(),z,K)-c.rotation,Z=Dee(c,X);this._fitNodesInto(Z,t);return}var p=this.shiftBehavior(),f;p==="inverted"?f=this.keepRatio()&&!t.shiftKey:p==="none"?f=this.keepRatio():f=this.keepRatio()||t.shiftKey;var v=this.centeredScaling()||t.altKey;if(this._movingAnchorName==="top-left"){if(f){var m=v?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};r=Math.sqrt(Math.pow(m.x-a.x(),2)+Math.pow(m.y-a.y(),2));var y=this.findOne(".top-left").x()>m.x?-1:1,x=this.findOne(".top-left").y()>m.y?-1:1;e=r*this.cos*y,n=r*this.sin*x,this.findOne(".top-left").x(m.x-e),this.findOne(".top-left").y(m.y-n)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(a.y());else if(this._movingAnchorName==="top-right"){if(f){var m=v?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};r=Math.sqrt(Math.pow(a.x()-m.x,2)+Math.pow(m.y-a.y(),2));var y=this.findOne(".top-right").x()<m.x?-1:1,x=this.findOne(".top-right").y()>m.y?-1:1;e=r*this.cos*y,n=r*this.sin*x,this.findOne(".top-right").x(m.x+e),this.findOne(".top-right").y(m.y-n)}var b=a.position();this.findOne(".top-left").y(b.y),this.findOne(".bottom-right").x(b.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(a.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(a.x());else if(this._movingAnchorName==="bottom-left"){if(f){var m=v?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};r=Math.sqrt(Math.pow(m.x-a.x(),2)+Math.pow(a.y()-m.y,2));var y=m.x<a.x()?-1:1,x=a.y()<m.y?-1:1;e=r*this.cos*y,n=r*this.sin*x,a.x(m.x-e),a.y(m.y+n)}b=a.position(),this.findOne(".top-left").x(b.x),this.findOne(".bottom-right").y(b.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(a.y());else if(this._movingAnchorName==="bottom-right"){if(f){var m=v?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};r=Math.sqrt(Math.pow(a.x()-m.x,2)+Math.pow(a.y()-m.y,2));var y=this.findOne(".bottom-right").x()<m.x?-1:1,x=this.findOne(".bottom-right").y()<m.y?-1:1;e=r*this.cos*y,n=r*this.sin*x,this.findOne(".bottom-right").x(m.x+e),this.findOne(".bottom-right").y(m.y+n)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));var v=this.centeredScaling()||t.altKey;if(v){var w=this.findOne(".top-left"),S=this.findOne(".bottom-right"),C=w.x(),I=w.y(),_=this.getWidth()-S.x(),E=this.getHeight()-S.y();S.move({x:-C,y:-I}),w.move({x:_,y:E})}var P=this.findOne(".top-left").getAbsolutePosition();e=P.x,n=P.y;var A=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),D=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:e,y:n,width:A,height:D,rotation:ao.Konva.getAngle(this.rotation())},t)}}_handleMouseUp(t){this._removeEvents(t)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(t){if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));var e=this.getNode();this._fire("transformend",{evt:t,target:e}),e&&this._nodes.forEach(n=>{n._fire("transformend",{evt:t,target:n})}),this._movingAnchorName=null}}_fitNodesInto(t,e){var n=this._getNodeRect();const r=1;if(en.Util._inRange(t.width,-this.padding()*2-r,r)){this.update();return}if(en.Util._inRange(t.height,-this.padding()*2-r,r)){this.update();return}var a=new en.Transform;if(a.rotate(ao.Konva.getAngle(this.rotation())),this._movingAnchorName&&t.width<0&&this._movingAnchorName.indexOf("left")>=0){const d=a.point({x:-this.padding()*2,y:0});t.x+=d.x,t.y+=d.y,t.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=d.x,this._anchorDragOffset.y-=d.y}else if(this._movingAnchorName&&t.width<0&&this._movingAnchorName.indexOf("right")>=0){const d=a.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=d.x,this._anchorDragOffset.y-=d.y,t.width+=this.padding()*2}if(this._movingAnchorName&&t.height<0&&this._movingAnchorName.indexOf("top")>=0){const d=a.point({x:0,y:-this.padding()*2});t.x+=d.x,t.y+=d.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=d.x,this._anchorDragOffset.y-=d.y,t.height+=this.padding()*2}else if(this._movingAnchorName&&t.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const d=a.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=d.x,this._anchorDragOffset.y-=d.y,t.height+=this.padding()*2}if(this.boundBoxFunc()){const d=this.boundBoxFunc()(n,t);d?t=d:en.Util.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const i=1e7,o=new en.Transform;o.translate(n.x,n.y),o.rotate(n.rotation),o.scale(n.width/i,n.height/i);const s=new en.Transform,l=t.width/i,u=t.height/i;this.flipEnabled()===!1?(s.translate(t.x,t.y),s.rotate(t.rotation),s.translate(t.width<0?t.width:0,t.height<0?t.height:0),s.scale(Math.abs(l),Math.abs(u))):(s.translate(t.x,t.y),s.rotate(t.rotation),s.scale(l,u));const c=s.multiply(o.invert());this._nodes.forEach(d=>{var p;const f=d.getParent().getAbsoluteTransform(),m=d.getTransform().copy();m.translate(d.offsetX(),d.offsetY());const y=new en.Transform;y.multiply(f.copy().invert()).multiply(c).multiply(f).multiply(m);const x=y.decompose();d.setAttrs(x),this._fire("transform",{evt:e,target:d}),d._fire("transform",{evt:e,target:d}),(p=d.getLayer())===null||p===void 0||p.batchDraw()}),this.rotation(en.Util._getRotation(t.rotation)),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(t,e){this.findOne(t).setAttrs(e)}update(){var t,e=this._getNodeRect();this.rotation(en.Util._getRotation(e.rotation));var n=e.width,r=e.height,a=this.enabledAnchors(),i=this.resizeEnabled(),o=this.padding(),s=this.anchorSize();const l=this.find("._anchor");l.forEach(c=>{c.setAttrs({width:s,height:s,offsetX:s/2,offsetY:s/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:s/2+o,offsetY:s/2+o,visible:i&&a.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:n/2,y:0,offsetY:s/2+o,visible:i&&a.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:n,y:0,offsetX:s/2-o,offsetY:s/2+o,visible:i&&a.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:r/2,offsetX:s/2+o,visible:i&&a.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:n,y:r/2,offsetX:s/2-o,visible:i&&a.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:r,offsetX:s/2+o,offsetY:s/2-o,visible:i&&a.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:n/2,y:r,offsetY:s/2-o,visible:i&&a.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:n,y:r,offsetX:s/2-o,offsetY:s/2-o,visible:i&&a.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:n/2,y:-this.rotateAnchorOffset()*en.Util._sign(r)-o,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:n,height:r,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),x:0,y:0});const u=this.anchorStyleFunc();u&&l.forEach(c=>{u(c)}),(t=this.getLayer())===null||t===void 0||t.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();var t=this.findOne("."+this._movingAnchorName);t&&t.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),oA.Group.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return iA.Node.prototype.toObject.call(this)}clone(t){var e=iA.Node.prototype.clone.call(this,t);return e}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}};qy.Transformer=At;function Bee(t){return t instanceof Array||en.Util.warn("enabledAnchors value should be an array"),t instanceof Array&&t.forEach(function(e){Ky.indexOf(e)===-1&&en.Util.warn("Unknown anchor name: "+e+". Available names are: "+Ky.join(", "))}),t||[]}At.prototype.className="Transformer",(0,Oee._registerNode)(At),Ut.Factory.addGetterSetter(At,"enabledAnchors",Ky,Bee),Ut.Factory.addGetterSetter(At,"flipEnabled",!0,(0,Tl.getBooleanValidator)()),Ut.Factory.addGetterSetter(At,"resizeEnabled",!0),Ut.Factory.addGetterSetter(At,"anchorSize",10,(0,Tl.getNumberValidator)()),Ut.Factory.addGetterSetter(At,"rotateEnabled",!0),Ut.Factory.addGetterSetter(At,"rotateLineVisible",!0),Ut.Factory.addGetterSetter(At,"rotationSnaps",[]),Ut.Factory.addGetterSetter(At,"rotateAnchorOffset",50,(0,Tl.getNumberValidator)()),Ut.Factory.addGetterSetter(At,"rotateAnchorCursor","crosshair"),Ut.Factory.addGetterSetter(At,"rotationSnapTolerance",5,(0,Tl.getNumberValidator)()),Ut.Factory.addGetterSetter(At,"borderEnabled",!0),Ut.Factory.addGetterSetter(At,"anchorStroke","rgb(0, 161, 255)"),Ut.Factory.addGetterSetter(At,"anchorStrokeWidth",1,(0,Tl.getNumberValidator)()),Ut.Factory.addGetterSetter(At,"anchorFill","white"),Ut.Factory.addGetterSetter(At,"anchorCornerRadius",0,(0,Tl.getNumberValidator)()),Ut.Factory.addGetterSetter(At,"borderStroke","rgb(0, 161, 255)"),Ut.Factory.addGetterSetter(At,"borderStrokeWidth",1,(0,Tl.getNumberValidator)()),Ut.Factory.addGetterSetter(At,"borderDash"),Ut.Factory.addGetterSetter(At,"keepRatio",!0),Ut.Factory.addGetterSetter(At,"shiftBehavior","default"),Ut.Factory.addGetterSetter(At,"centeredScaling",!1),Ut.Factory.addGetterSetter(At,"ignoreStroke",!1),Ut.Factory.addGetterSetter(At,"padding",0,(0,Tl.getNumberValidator)()),Ut.Factory.addGetterSetter(At,"node"),Ut.Factory.addGetterSetter(At,"nodes"),Ut.Factory.addGetterSetter(At,"boundBoxFunc"),Ut.Factory.addGetterSetter(At,"anchorDragBoundFunc"),Ut.Factory.addGetterSetter(At,"anchorStyleFunc"),Ut.Factory.addGetterSetter(At,"shouldOverdrawWholeArea",!1),Ut.Factory.addGetterSetter(At,"useSingleNodeRotation",!0),Ut.Factory.backCompat(At,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"});var Xy={};Object.defineProperty(Xy,"__esModule",{value:!0}),Xy.Wedge=void 0;const Yy=kt,zee=cr,jee=wt,dA=Ge,Vee=wt;class vs extends zee.Shape{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.radius(),0,jee.Konva.getAngle(this.angle()),this.clockwise()),e.lineTo(0,0),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius(e/2)}setHeight(e){this.radius(e/2)}}Xy.Wedge=vs,vs.prototype.className="Wedge",vs.prototype._centroid=!0,vs.prototype._attrsAffectingSize=["radius"],(0,Vee._registerNode)(vs),Yy.Factory.addGetterSetter(vs,"radius",0,(0,dA.getNumberValidator)()),Yy.Factory.addGetterSetter(vs,"angle",0,(0,dA.getNumberValidator)()),Yy.Factory.addGetterSetter(vs,"clockwise",!1),Yy.Factory.backCompat(vs,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"});var Qy={};Object.defineProperty(Qy,"__esModule",{value:!0}),Qy.Blur=void 0;const pA=kt,Wee=Tn,Uee=Ge;function hA(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}var Gee=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],Hee=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function qee(t,e){var n=t.data,r=t.width,a=t.height,i,o,s,l,u,c,d,p,f,m,y,x,b,v,w,S,C,I,_,E,P,A,D,V,z=e+e+1,K=r-1,X=a-1,Z=e+1,q=Z*(Z+1)/2,F=new hA,Y=null,Q=F,ne=null,le=null,de=Gee[e],re=Hee[e];for(s=1;s<z;s++)Q=Q.next=new hA,s===Z&&(Y=Q);for(Q.next=F,d=c=0,o=0;o<a;o++){for(S=C=I=_=p=f=m=y=0,x=Z*(E=n[c]),b=Z*(P=n[c+1]),v=Z*(A=n[c+2]),w=Z*(D=n[c+3]),p+=q*E,f+=q*P,m+=q*A,y+=q*D,Q=F,s=0;s<Z;s++)Q.r=E,Q.g=P,Q.b=A,Q.a=D,Q=Q.next;for(s=1;s<Z;s++)l=c+((K<s?K:s)<<2),p+=(Q.r=E=n[l])*(V=Z-s),f+=(Q.g=P=n[l+1])*V,m+=(Q.b=A=n[l+2])*V,y+=(Q.a=D=n[l+3])*V,S+=E,C+=P,I+=A,_+=D,Q=Q.next;for(ne=F,le=Y,i=0;i<r;i++)n[c+3]=D=y*de>>re,D!==0?(D=255/D,n[c]=(p*de>>re)*D,n[c+1]=(f*de>>re)*D,n[c+2]=(m*de>>re)*D):n[c]=n[c+1]=n[c+2]=0,p-=x,f-=b,m-=v,y-=w,x-=ne.r,b-=ne.g,v-=ne.b,w-=ne.a,l=d+((l=i+e+1)<K?l:K)<<2,S+=ne.r=n[l],C+=ne.g=n[l+1],I+=ne.b=n[l+2],_+=ne.a=n[l+3],p+=S,f+=C,m+=I,y+=_,ne=ne.next,x+=E=le.r,b+=P=le.g,v+=A=le.b,w+=D=le.a,S-=E,C-=P,I-=A,_-=D,le=le.next,c+=4;d+=r}for(i=0;i<r;i++){for(C=I=_=S=f=m=y=p=0,c=i<<2,x=Z*(E=n[c]),b=Z*(P=n[c+1]),v=Z*(A=n[c+2]),w=Z*(D=n[c+3]),p+=q*E,f+=q*P,m+=q*A,y+=q*D,Q=F,s=0;s<Z;s++)Q.r=E,Q.g=P,Q.b=A,Q.a=D,Q=Q.next;for(u=r,s=1;s<=e;s++)c=u+i<<2,p+=(Q.r=E=n[c])*(V=Z-s),f+=(Q.g=P=n[c+1])*V,m+=(Q.b=A=n[c+2])*V,y+=(Q.a=D=n[c+3])*V,S+=E,C+=P,I+=A,_+=D,Q=Q.next,s<X&&(u+=r);for(c=i,ne=F,le=Y,o=0;o<a;o++)l=c<<2,n[l+3]=D=y*de>>re,D>0?(D=255/D,n[l]=(p*de>>re)*D,n[l+1]=(f*de>>re)*D,n[l+2]=(m*de>>re)*D):n[l]=n[l+1]=n[l+2]=0,p-=x,f-=b,m-=v,y-=w,x-=ne.r,b-=ne.g,v-=ne.b,w-=ne.a,l=i+((l=o+Z)<X?l:X)*r<<2,p+=S+=ne.r=n[l],f+=C+=ne.g=n[l+1],m+=I+=ne.b=n[l+2],y+=_+=ne.a=n[l+3],ne=ne.next,x+=E=le.r,b+=P=le.g,v+=A=le.b,w+=D=le.a,S-=E,C-=P,I-=A,_-=D,le=le.next,c+=r}}const Kee=function(t){var e=Math.round(this.blurRadius());e>0&&qee(t,e)};Qy.Blur=Kee,pA.Factory.addGetterSetter(Wee.Node,"blurRadius",0,(0,Uee.getNumberValidator)(),pA.Factory.afterSetFilter);var Zy={};Object.defineProperty(Zy,"__esModule",{value:!0}),Zy.Brighten=void 0;const fA=kt,Xee=Tn,Yee=Ge,Qee=function(t){var e=this.brightness()*255,n=t.data,r=n.length,a;for(a=0;a<r;a+=4)n[a]+=e,n[a+1]+=e,n[a+2]+=e};Zy.Brighten=Qee,fA.Factory.addGetterSetter(Xee.Node,"brightness",0,(0,Yee.getNumberValidator)(),fA.Factory.afterSetFilter);var Jy={};Object.defineProperty(Jy,"__esModule",{value:!0}),Jy.Contrast=void 0;const gA=kt,Zee=Tn,Jee=Ge,ete=function(t){var e=Math.pow((this.contrast()+100)/100,2),n=t.data,r=n.length,a=150,i=150,o=150,s;for(s=0;s<r;s+=4)a=n[s],i=n[s+1],o=n[s+2],a/=255,a-=.5,a*=e,a+=.5,a*=255,i/=255,i-=.5,i*=e,i+=.5,i*=255,o/=255,o-=.5,o*=e,o+=.5,o*=255,a=a<0?0:a>255?255:a,i=i<0?0:i>255?255:i,o=o<0?0:o>255?255:o,n[s]=a,n[s+1]=i,n[s+2]=o};Jy.Contrast=ete,gA.Factory.addGetterSetter(Zee.Node,"contrast",0,(0,Jee.getNumberValidator)(),gA.Factory.afterSetFilter);var eb={};Object.defineProperty(eb,"__esModule",{value:!0}),eb.Emboss=void 0;const Il=kt,tb=Tn,tte=Dn,mA=Ge,nte=function(t){var e=this.embossStrength()*10,n=this.embossWhiteLevel()*255,r=this.embossDirection(),a=this.embossBlend(),i=0,o=0,s=t.data,l=t.width,u=t.height,c=l*4,d=u;switch(r){case"top-left":i=-1,o=-1;break;case"top":i=-1,o=0;break;case"top-right":i=-1,o=1;break;case"right":i=0,o=1;break;case"bottom-right":i=1,o=1;break;case"bottom":i=1,o=0;break;case"bottom-left":i=1,o=-1;break;case"left":i=0,o=-1;break;default:tte.Util.error("Unknown emboss direction: "+r)}do{var p=(d-1)*c,f=i;d+f<1&&(f=0),d+f>u&&(f=0);var m=(d-1+f)*l*4,y=l;do{var x=p+(y-1)*4,b=o;y+b<1&&(b=0),y+b>l&&(b=0);var v=m+(y-1+b)*4,w=s[x]-s[v],S=s[x+1]-s[v+1],C=s[x+2]-s[v+2],I=w,_=I>0?I:-I,E=S>0?S:-S,P=C>0?C:-C;if(E>_&&(I=S),P>_&&(I=C),I*=e,a){var A=s[x]+I,D=s[x+1]+I,V=s[x+2]+I;s[x]=A>255?255:A<0?0:A,s[x+1]=D>255?255:D<0?0:D,s[x+2]=V>255?255:V<0?0:V}else{var z=n-I;z<0?z=0:z>255&&(z=255),s[x]=s[x+1]=s[x+2]=z}}while(--y)}while(--d)};eb.Emboss=nte,Il.Factory.addGetterSetter(tb.Node,"embossStrength",.5,(0,mA.getNumberValidator)(),Il.Factory.afterSetFilter),Il.Factory.addGetterSetter(tb.Node,"embossWhiteLevel",.5,(0,mA.getNumberValidator)(),Il.Factory.afterSetFilter),Il.Factory.addGetterSetter(tb.Node,"embossDirection","top-left",null,Il.Factory.afterSetFilter),Il.Factory.addGetterSetter(tb.Node,"embossBlend",!1,null,Il.Factory.afterSetFilter);var nb={};Object.defineProperty(nb,"__esModule",{value:!0}),nb.Enhance=void 0;const yA=kt,rte=Tn,ate=Ge;function T3(t,e,n,r,a){var i=n-e,o=a-r,s;return i===0?r+o/2:o===0?r:(s=(t-e)/i,s=o*s+r,s)}const ite=function(t){var e=t.data,n=e.length,r=e[0],a=r,i,o=e[1],s=o,l,u=e[2],c=u,d,p,f=this.enhance();if(f!==0){for(p=0;p<n;p+=4)i=e[p+0],i<r?r=i:i>a&&(a=i),l=e[p+1],l<o?o=l:l>s&&(s=l),d=e[p+2],d<u?u=d:d>c&&(c=d);a===r&&(a=255,r=0),s===o&&(s=255,o=0),c===u&&(c=255,u=0);var m,y,x,b,v,w,S,C,I;for(f>0?(y=a+f*(255-a),x=r-f*(r-0),v=s+f*(255-s),w=o-f*(o-0),C=c+f*(255-c),I=u-f*(u-0)):(m=(a+r)*.5,y=a+f*(a-m),x=r+f*(r-m),b=(s+o)*.5,v=s+f*(s-b),w=o+f*(o-b),S=(c+u)*.5,C=c+f*(c-S),I=u+f*(u-S)),p=0;p<n;p+=4)e[p+0]=T3(e[p+0],r,a,x,y),e[p+1]=T3(e[p+1],o,s,w,v),e[p+2]=T3(e[p+2],u,c,I,C)}};nb.Enhance=ite,yA.Factory.addGetterSetter(rte.Node,"enhance",0,(0,ate.getNumberValidator)(),yA.Factory.afterSetFilter);var rb={};Object.defineProperty(rb,"__esModule",{value:!0}),rb.Grayscale=void 0;const ote=function(t){var e=t.data,n=e.length,r,a;for(r=0;r<n;r+=4)a=.34*e[r]+.5*e[r+1]+.16*e[r+2],e[r]=a,e[r+1]=a,e[r+2]=a};rb.Grayscale=ote;var ab={};Object.defineProperty(ab,"__esModule",{value:!0}),ab.HSL=void 0;const Bd=kt,I3=Tn,E3=Ge;Bd.Factory.addGetterSetter(I3.Node,"hue",0,(0,E3.getNumberValidator)(),Bd.Factory.afterSetFilter),Bd.Factory.addGetterSetter(I3.Node,"saturation",0,(0,E3.getNumberValidator)(),Bd.Factory.afterSetFilter),Bd.Factory.addGetterSetter(I3.Node,"luminance",0,(0,E3.getNumberValidator)(),Bd.Factory.afterSetFilter);const ste=function(t){var e=t.data,n=e.length,r=1,a=Math.pow(2,this.saturation()),i=Math.abs(this.hue()+360)%360,o=this.luminance()*127,s,l=r*a*Math.cos(i*Math.PI/180),u=r*a*Math.sin(i*Math.PI/180),c=.299*r+.701*l+.167*u,d=.587*r-.587*l+.33*u,p=.114*r-.114*l-.497*u,f=.299*r-.299*l-.328*u,m=.587*r+.413*l+.035*u,y=.114*r-.114*l+.293*u,x=.299*r-.3*l+1.25*u,b=.587*r-.586*l-1.05*u,v=.114*r+.886*l-.2*u,w,S,C,I;for(s=0;s<n;s+=4)w=e[s+0],S=e[s+1],C=e[s+2],I=e[s+3],e[s+0]=c*w+d*S+p*C+o,e[s+1]=f*w+m*S+y*C+o,e[s+2]=x*w+b*S+v*C+o,e[s+3]=I};ab.HSL=ste;var ib={};Object.defineProperty(ib,"__esModule",{value:!0}),ib.HSV=void 0;const zd=kt,_3=Tn,O3=Ge,lte=function(t){var e=t.data,n=e.length,r=Math.pow(2,this.value()),a=Math.pow(2,this.saturation()),i=Math.abs(this.hue()+360)%360,o,s=r*a*Math.cos(i*Math.PI/180),l=r*a*Math.sin(i*Math.PI/180),u=.299*r+.701*s+.167*l,c=.587*r-.587*s+.33*l,d=.114*r-.114*s-.497*l,p=.299*r-.299*s-.328*l,f=.587*r+.413*s+.035*l,m=.114*r-.114*s+.293*l,y=.299*r-.3*s+1.25*l,x=.587*r-.586*s-1.05*l,b=.114*r+.886*s-.2*l,v,w,S,C;for(o=0;o<n;o+=4)v=e[o+0],w=e[o+1],S=e[o+2],C=e[o+3],e[o+0]=u*v+c*w+d*S,e[o+1]=p*v+f*w+m*S,e[o+2]=y*v+x*w+b*S,e[o+3]=C};ib.HSV=lte,zd.Factory.addGetterSetter(_3.Node,"hue",0,(0,O3.getNumberValidator)(),zd.Factory.afterSetFilter),zd.Factory.addGetterSetter(_3.Node,"saturation",0,(0,O3.getNumberValidator)(),zd.Factory.afterSetFilter),zd.Factory.addGetterSetter(_3.Node,"value",0,(0,O3.getNumberValidator)(),zd.Factory.afterSetFilter);var ob={};Object.defineProperty(ob,"__esModule",{value:!0}),ob.Invert=void 0;const ute=function(t){var e=t.data,n=e.length,r;for(r=0;r<n;r+=4)e[r]=255-e[r],e[r+1]=255-e[r+1],e[r+2]=255-e[r+2]};ob.Invert=ute;var sb={};Object.defineProperty(sb,"__esModule",{value:!0}),sb.Kaleidoscope=void 0;const lb=kt,bA=Tn,vA=Dn,xA=Ge;var cte=function(t,e,n){var r=t.data,a=e.data,i=t.width,o=t.height,s=n.polarCenterX||i/2,l=n.polarCenterY||o/2,u,c,d,p=0,f=0,m=0,y=0,x,b=Math.sqrt(s*s+l*l);c=i-s,d=o-l,x=Math.sqrt(c*c+d*d),b=x>b?x:b;var v=o,w=i,S,C,I=360/w*Math.PI/180,_,E;for(C=0;C<w;C+=1)for(_=Math.sin(C*I),E=Math.cos(C*I),S=0;S<v;S+=1)c=Math.floor(s+b*S/v*E),d=Math.floor(l+b*S/v*_),u=(d*i+c)*4,p=r[u+0],f=r[u+1],m=r[u+2],y=r[u+3],u=(C+S*i)*4,a[u+0]=p,a[u+1]=f,a[u+2]=m,a[u+3]=y},dte=function(t,e,n){var r=t.data,a=e.data,i=t.width,o=t.height,s=n.polarCenterX||i/2,l=n.polarCenterY||o/2,u,c,d,p,f,m=0,y=0,x=0,b=0,v,w=Math.sqrt(s*s+l*l);c=i-s,d=o-l,v=Math.sqrt(c*c+d*d),w=v>w?v:w;var S=o,C=i,I,_,E=n.polarRotation||0,P,A;for(c=0;c<i;c+=1)for(d=0;d<o;d+=1)p=c-s,f=d-l,I=Math.sqrt(p*p+f*f)*S/w,_=(Math.atan2(f,p)*180/Math.PI+360+E)%360,_=_*C/360,P=Math.floor(_),A=Math.floor(I),u=(A*i+P)*4,m=r[u+0],y=r[u+1],x=r[u+2],b=r[u+3],u=(d*i+c)*4,a[u+0]=m,a[u+1]=y,a[u+2]=x,a[u+3]=b};const pte=function(t){var e=t.width,n=t.height,r,a,i,o,s,l,u,c,d,p,f=Math.round(this.kaleidoscopePower()),m=Math.round(this.kaleidoscopeAngle()),y=Math.floor(e*(m%360)/360);if(!(f<1)){var x=vA.Util.createCanvasElement();x.width=e,x.height=n;var b=x.getContext("2d").getImageData(0,0,e,n);vA.Util.releaseCanvas(x),cte(t,b,{polarCenterX:e/2,polarCenterY:n/2});for(var v=e/Math.pow(2,f);v<=8;)v=v*2,f-=1;v=Math.ceil(v);var w=v,S=0,C=w,I=1;for(y+v>e&&(S=w,C=0,I=-1),a=0;a<n;a+=1)for(r=S;r!==C;r+=I)i=Math.round(r+y)%e,d=(e*a+i)*4,s=b.data[d+0],l=b.data[d+1],u=b.data[d+2],c=b.data[d+3],p=(e*a+r)*4,b.data[p+0]=s,b.data[p+1]=l,b.data[p+2]=u,b.data[p+3]=c;for(a=0;a<n;a+=1)for(w=Math.floor(v),o=0;o<f;o+=1){for(r=0;r<w+1;r+=1)d=(e*a+r)*4,s=b.data[d+0],l=b.data[d+1],u=b.data[d+2],c=b.data[d+3],p=(e*a+w*2-r-1)*4,b.data[p+0]=s,b.data[p+1]=l,b.data[p+2]=u,b.data[p+3]=c;w*=2}dte(b,t,{polarRotation:0})}};sb.Kaleidoscope=pte,lb.Factory.addGetterSetter(bA.Node,"kaleidoscopePower",2,(0,xA.getNumberValidator)(),lb.Factory.afterSetFilter),lb.Factory.addGetterSetter(bA.Node,"kaleidoscopeAngle",0,(0,xA.getNumberValidator)(),lb.Factory.afterSetFilter);var ub={};Object.defineProperty(ub,"__esModule",{value:!0}),ub.Mask=void 0;const wA=kt,hte=Tn,fte=Ge;function cb(t,e,n){var r=(n*t.width+e)*4,a=[];return a.push(t.data[r++],t.data[r++],t.data[r++],t.data[r++]),a}function yf(t,e){return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2)+Math.pow(t[2]-e[2],2))}function gte(t){for(var e=[0,0,0],n=0;n<t.length;n++)e[0]+=t[n][0],e[1]+=t[n][1],e[2]+=t[n][2];return e[0]/=t.length,e[1]/=t.length,e[2]/=t.length,e}function mte(t,e){var n=cb(t,0,0),r=cb(t,t.width-1,0),a=cb(t,0,t.height-1),i=cb(t,t.width-1,t.height-1),o=e||10;if(yf(n,r)<o&&yf(r,i)<o&&yf(i,a)<o&&yf(a,n)<o){for(var s=gte([r,n,i,a]),l=[],u=0;u<t.width*t.height;u++){var c=yf(s,[t.data[u*4],t.data[u*4+1],t.data[u*4+2]]);l[u]=c<o?0:255}return l}}function yte(t,e){for(var n=0;n<t.width*t.height;n++)t.data[4*n+3]=e[n]}function bte(t,e,n){for(var r=[1,1,1,1,0,1,1,1,1],a=Math.round(Math.sqrt(r.length)),i=Math.floor(a/2),o=[],s=0;s<n;s++)for(var l=0;l<e;l++){for(var u=s*e+l,c=0,d=0;d<a;d++)for(var p=0;p<a;p++){var f=s+d-i,m=l+p-i;if(f>=0&&f<n&&m>=0&&m<e){var y=f*e+m,x=r[d*a+p];c+=t[y]*x}}o[u]=c===255*8?255:0}return o}function vte(t,e,n){for(var r=[1,1,1,1,1,1,1,1,1],a=Math.round(Math.sqrt(r.length)),i=Math.floor(a/2),o=[],s=0;s<n;s++)for(var l=0;l<e;l++){for(var u=s*e+l,c=0,d=0;d<a;d++)for(var p=0;p<a;p++){var f=s+d-i,m=l+p-i;if(f>=0&&f<n&&m>=0&&m<e){var y=f*e+m,x=r[d*a+p];c+=t[y]*x}}o[u]=c>=255*4?255:0}return o}function xte(t,e,n){for(var r=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],a=Math.round(Math.sqrt(r.length)),i=Math.floor(a/2),o=[],s=0;s<n;s++)for(var l=0;l<e;l++){for(var u=s*e+l,c=0,d=0;d<a;d++)for(var p=0;p<a;p++){var f=s+d-i,m=l+p-i;if(f>=0&&f<n&&m>=0&&m<e){var y=f*e+m,x=r[d*a+p];c+=t[y]*x}}o[u]=c}return o}const wte=function(t){var e=this.threshold(),n=mte(t,e);return n&&(n=bte(n,t.width,t.height),n=vte(n,t.width,t.height),n=xte(n,t.width,t.height),yte(t,n)),t};ub.Mask=wte,wA.Factory.addGetterSetter(hte.Node,"threshold",0,(0,fte.getNumberValidator)(),wA.Factory.afterSetFilter);var db={};Object.defineProperty(db,"__esModule",{value:!0}),db.Noise=void 0;const kA=kt,kte=Tn,Ste=Ge,Cte=function(t){var e=this.noise()*255,n=t.data,r=n.length,a=e/2,i;for(i=0;i<r;i+=4)n[i+0]+=a-2*a*Math.random(),n[i+1]+=a-2*a*Math.random(),n[i+2]+=a-2*a*Math.random()};db.Noise=Cte,kA.Factory.addGetterSetter(kte.Node,"noise",.2,(0,Ste.getNumberValidator)(),kA.Factory.afterSetFilter);var pb={};Object.defineProperty(pb,"__esModule",{value:!0}),pb.Pixelate=void 0;const SA=kt,Nte=Dn,Tte=Tn,Ite=Ge,Ete=function(t){var e=Math.ceil(this.pixelSize()),n=t.width,r=t.height,a,i,o,s,l,u,c,d=Math.ceil(n/e),p=Math.ceil(r/e),f,m,y,x,b,v,w,S=t.data;if(e<=0){Nte.Util.error("pixelSize value can not be <= 0");return}for(b=0;b<d;b+=1)for(v=0;v<p;v+=1){for(s=0,l=0,u=0,c=0,f=b*e,m=f+e,y=v*e,x=y+e,w=0,a=f;a<m;a+=1)if(!(a>=n))for(i=y;i<x;i+=1)i>=r||(o=(n*i+a)*4,s+=S[o+0],l+=S[o+1],u+=S[o+2],c+=S[o+3],w+=1);for(s=s/w,l=l/w,u=u/w,c=c/w,a=f;a<m;a+=1)if(!(a>=n))for(i=y;i<x;i+=1)i>=r||(o=(n*i+a)*4,S[o+0]=s,S[o+1]=l,S[o+2]=u,S[o+3]=c)}};pb.Pixelate=Ete,SA.Factory.addGetterSetter(Tte.Node,"pixelSize",8,(0,Ite.getNumberValidator)(),SA.Factory.afterSetFilter);var hb={};Object.defineProperty(hb,"__esModule",{value:!0}),hb.Posterize=void 0;const CA=kt,_te=Tn,Ote=Ge,$te=function(t){var e=Math.round(this.levels()*254)+1,n=t.data,r=n.length,a=255/e,i;for(i=0;i<r;i+=1)n[i]=Math.floor(n[i]/a)*a};hb.Posterize=$te,CA.Factory.addGetterSetter(_te.Node,"levels",.5,(0,Ote.getNumberValidator)(),CA.Factory.afterSetFilter);var fb={};Object.defineProperty(fb,"__esModule",{value:!0}),fb.RGB=void 0;const gb=kt,$3=Tn,Rte=Ge,Mte=function(t){var e=t.data,n=e.length,r=this.red(),a=this.green(),i=this.blue(),o,s;for(o=0;o<n;o+=4)s=(.34*e[o]+.5*e[o+1]+.16*e[o+2])/255,e[o]=s*r,e[o+1]=s*a,e[o+2]=s*i,e[o+3]=e[o+3]};fb.RGB=Mte,gb.Factory.addGetterSetter($3.Node,"red",0,function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)}),gb.Factory.addGetterSetter($3.Node,"green",0,function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)}),gb.Factory.addGetterSetter($3.Node,"blue",0,Rte.RGBComponent,gb.Factory.afterSetFilter);var mb={};Object.defineProperty(mb,"__esModule",{value:!0}),mb.RGBA=void 0;const bf=kt,yb=Tn,Ate=Ge,Pte=function(t){var e=t.data,n=e.length,r=this.red(),a=this.green(),i=this.blue(),o=this.alpha(),s,l;for(s=0;s<n;s+=4)l=1-o,e[s]=r*o+e[s]*l,e[s+1]=a*o+e[s+1]*l,e[s+2]=i*o+e[s+2]*l};mb.RGBA=Pte,bf.Factory.addGetterSetter(yb.Node,"red",0,function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)}),bf.Factory.addGetterSetter(yb.Node,"green",0,function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)}),bf.Factory.addGetterSetter(yb.Node,"blue",0,Ate.RGBComponent,bf.Factory.afterSetFilter),bf.Factory.addGetterSetter(yb.Node,"alpha",1,function(t){return this._filterUpToDate=!1,t>1?1:t<0?0:t});var bb={};Object.defineProperty(bb,"__esModule",{value:!0}),bb.Sepia=void 0;const Lte=function(t){var e=t.data,n=e.length,r,a,i,o;for(r=0;r<n;r+=4)a=e[r+0],i=e[r+1],o=e[r+2],e[r+0]=Math.min(255,a*.393+i*.769+o*.189),e[r+1]=Math.min(255,a*.349+i*.686+o*.168),e[r+2]=Math.min(255,a*.272+i*.534+o*.131)};bb.Sepia=Lte;var vb={};Object.defineProperty(vb,"__esModule",{value:!0}),vb.Solarize=void 0;const Dte=function(t){var e=t.data,n=t.width,r=t.height,a=n*4,i=r;do{var o=(i-1)*a,s=n;do{var l=o+(s-1)*4,u=e[l],c=e[l+1],d=e[l+2];u>127&&(u=255-u),c>127&&(c=255-c),d>127&&(d=255-d),e[l]=u,e[l+1]=c,e[l+2]=d}while(--s)}while(--i)};vb.Solarize=Dte;var xb={};Object.defineProperty(xb,"__esModule",{value:!0}),xb.Threshold=void 0;const NA=kt,Fte=Tn,Bte=Ge,zte=function(t){var e=this.threshold()*255,n=t.data,r=n.length,a;for(a=0;a<r;a+=1)n[a]=n[a]<e?0:255};xb.Threshold=zte,NA.Factory.addGetterSetter(Fte.Node,"threshold",.5,(0,Bte.getNumberValidator)(),NA.Factory.afterSetFilter),Object.defineProperty(by,"__esModule",{value:!0}),by.Konva=void 0;const TA=vy,jte=Oy,Vte=My,Wte=Ly,Ute=Dy,Gte=Fy,IA=Dd,Hte=pf,qte=Ad,Kte=ff,Xte=jy,Yte=Vy,Qte=Wy,Zte=Uy,Jte=Bu,ene=Hy,tne=qy,nne=Xy,rne=Qy,ane=Zy,ine=Jy,one=eb,sne=nb,lne=rb,une=ab,cne=ib,dne=ob,pne=sb,hne=ub,fne=db,gne=pb,mne=hb,yne=fb,bne=mb,vne=bb,xne=vb,wne=xb;by.Konva=TA.Konva.Util._assign(TA.Konva,{Arc:jte.Arc,Arrow:Vte.Arrow,Circle:Wte.Circle,Ellipse:Ute.Ellipse,Image:Gte.Image,Label:IA.Label,Tag:IA.Tag,Line:Hte.Line,Path:qte.Path,Rect:Kte.Rect,RegularPolygon:Xte.RegularPolygon,Ring:Yte.Ring,Sprite:Qte.Sprite,Star:Zte.Star,Text:Jte.Text,TextPath:ene.TextPath,Transformer:tne.Transformer,Wedge:nne.Wedge,Filters:{Blur:rne.Blur,Brighten:ane.Brighten,Contrast:ine.Contrast,Emboss:one.Emboss,Enhance:sne.Enhance,Grayscale:lne.Grayscale,HSL:une.HSL,HSV:cne.HSV,Invert:dne.Invert,Kaleidoscope:pne.Kaleidoscope,Mask:hne.Mask,Noise:fne.Noise,Pixelate:gne.Pixelate,Posterize:mne.Posterize,RGB:yne.RGB,RGBA:bne.RGBA,Sepia:vne.Sepia,Solarize:xne.Solarize,Threshold:wne.Threshold}});var kne=ZN.exports;Object.defineProperty(kne,"__esModule",{value:!0});const Sne=by;ZN.exports=Sne.Konva;var Cne=ZN.exports;const EA=gi(Cne);var R3={exports:{}};(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.Konva=void 0;var n=vy;Object.defineProperty(e,"Konva",{enumerable:!0,get:function(){return n.Konva}});const r=vy;t.exports=r.Konva})(R3,R3.exports);var Nne=R3.exports;const vf=gi(Nne);var _A={exports:{}};/**
* @license React
* react-reconciler.production.min.js
*
* Copyright (c) Facebook, Inc. and its affiliates.
*
* This source code is licensed under the MIT license found in the
* LICENSE file in the root directory of this source tree.
*/var Tne=function(t){var e={},n=R,r=ph,a=Object.assign;function i(h){for(var g="https://reactjs.org/docs/error-decoder.html?invariant="+h,k=1;k<arguments.length;k++)g+="&args[]="+encodeURIComponent(arguments[k]);return"Minified React error #"+h+"; visit "+g+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,s=Symbol.for("react.element"),l=Symbol.for("react.portal"),u=Symbol.for("react.fragment"),c=Symbol.for("react.strict_mode"),d=Symbol.for("react.profiler"),p=Symbol.for("react.provider"),f=Symbol.for("react.context"),m=Symbol.for("react.forward_ref"),y=Symbol.for("react.suspense"),x=Symbol.for("react.suspense_list"),b=Symbol.for("react.memo"),v=Symbol.for("react.lazy"),w=Symbol.for("react.offscreen"),S=Symbol.iterator;function C(h){return h===null||typeof h!="object"?null:(h=S&&h[S]||h["@@iterator"],typeof h=="function"?h:null)}function I(h){if(h==null)return null;if(typeof h=="function")return h.displayName||h.name||null;if(typeof h=="string")return h;switch(h){case u:return"Fragment";case l:return"Portal";case d:return"Profiler";case c:return"StrictMode";case y:return"Suspense";case x:return"SuspenseList"}if(typeof h=="object")switch(h.$$typeof){case f:return(h.displayName||"Context")+".Consumer";case p:return(h._context.displayName||"Context")+".Provider";case m:var g=h.render;return h=h.displayName,h||(h=g.displayName||g.name||"",h=h!==""?"ForwardRef("+h+")":"ForwardRef"),h;case b:return g=h.displayName||null,g!==null?g:I(h.type)||"Memo";case v:g=h._payload,h=h._init;try{return I(h(g))}catch{}}return null}function _(h){var g=h.type;switch(h.tag){case 24:return"Cache";case 9:return(g.displayName||"Context")+".Consumer";case 10:return(g._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return h=g.render,h=h.displayName||h.name||"",g.displayName||(h!==""?"ForwardRef("+h+")":"ForwardRef");case 7:return"Fragment";case 5:return g;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return I(g);case 8:return g===c?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof g=="function")return g.displayName||g.name||null;if(typeof g=="string")return g}return null}function E(h){var g=h,k=h;if(h.alternate)for(;g.return;)g=g.return;else{h=g;do g=h,g.flags&4098&&(k=g.return),h=g.return;while(h)}return g.tag===3?k:null}function P(h){if(E(h)!==h)throw Error(i(188))}function A(h){var g=h.alternate;if(!g){if(g=E(h),g===null)throw Error(i(188));return g!==h?null:h}for(var k=h,N=g;;){var T=k.return;if(T===null)break;var $=T.alternate;if($===null){if(N=T.return,N!==null){k=N;continue}break}if(T.child===$.child){for($=T.child;$;){if($===k)return P(T),h;if($===N)return P(T),g;$=$.sibling}throw Error(i(188))}if(k.return!==N.return)k=T,N=$;else{for(var U=!1,oe=T.child;oe;){if(oe===k){U=!0,k=T,N=$;break}if(oe===N){U=!0,N=T,k=$;break}oe=oe.sibling}if(!U){for(oe=$.child;oe;){if(oe===k){U=!0,k=$,N=T;break}if(oe===N){U=!0,N=$,k=T;break}oe=oe.sibling}if(!U)throw Error(i(189))}}if(k.alternate!==N)throw Error(i(190))}if(k.tag!==3)throw Error(i(188));return k.stateNode.current===k?h:g}function D(h){return h=A(h),h!==null?V(h):null}function V(h){if(h.tag===5||h.tag===6)return h;for(h=h.child;h!==null;){var g=V(h);if(g!==null)return g;h=h.sibling}return null}function z(h){if(h.tag===5||h.tag===6)return h;for(h=h.child;h!==null;){if(h.tag!==4){var g=z(h);if(g!==null)return g}h=h.sibling}return null}var K=Array.isArray,X=t.getPublicInstance,Z=t.getRootHostContext,q=t.getChildHostContext,F=t.prepareForCommit,Y=t.resetAfterCommit,Q=t.createInstance,ne=t.appendInitialChild,le=t.finalizeInitialChildren,de=t.prepareUpdate,re=t.shouldSetTextContent,he=t.createTextInstance,ve=t.scheduleTimeout,H=t.cancelTimeout,ie=t.noTimeout,pe=t.isPrimaryRenderer,ke=t.supportsMutation,Ne=t.supportsPersistence,Ie=t.supportsHydration,Le=t.getInstanceFromNode,He=t.preparePortalMount,Me=t.getCurrentEventPriority,it=t.detachDeletedInstance,Ye=t.supportsMicrotasks,Ze=t.scheduleMicrotask,Qe=t.supportsTestSelectors,Xt=t.findFiberRoot,Vt=t.getBoundingRect,Ht=t.getTextContent,Yt=t.isHiddenSubtree,Wt=t.matchAccessibilityRole,Tt=t.setFocusIfFocusable,Hn=t.setupIntersectionObserver,yr=t.appendChild,Ha=t.appendChildToContainer,Or=t.commitTextUpdate,Fi=t.commitMount,Ds=t.commitUpdate,fo=t.insertBefore,rn=t.insertInContainerBefore,Bi=t.removeChild,Fs=t.removeChildFromContainer,go=t.resetTextContent,Pp=t.hideInstance,Na=t.hideTextInstance,Lp=t.unhideInstance,Om=t.unhideTextInstance,eu=t.clearContainer,$t=t.cloneInstance,$m=t.createContainerChildSet,Rm=t.appendChildToContainerChildSet,Dp=t.finalizeContainerChildren,tu=t.replaceContainerChildren,Fp=t.cloneHiddenInstance,Sc=t.cloneHiddenTextInstance,Mm=t.canHydrateInstance,Am=t.canHydrateTextInstance,Pm=t.canHydrateSuspenseInstance,Bp=t.isSuspenseInstancePending,Cc=t.isSuspenseInstanceFallback,J2=t.getSuspenseInstanceFallbackErrorDetails,ew=t.registerSuspenseInstanceRetry,zi=t.getNextHydratableSibling,Nc=t.getFirstHydratableChild,tw=t.getFirstHydratableChildWithinContainer,Ta=t.getFirstHydratableChildWithinSuspenseInstance,Tc=t.hydrateInstance,zp=t.hydrateTextInstance,nu=t.hydrateSuspenseInstance,nw=t.getNextHydratableInstanceAfterSuspenseInstance,rw=t.commitHydratedContainer,aw=t.commitHydratedSuspenseInstance,Lm=t.clearSuspenseBoundary,iw=t.clearSuspenseBoundaryFromContainer,Ic=t.shouldDeleteUnhydratedTailInstances,Dm=t.didNotMatchHydratedContainerTextInstance,jp=t.didNotMatchHydratedTextInstance,Go;function Mt(h){if(Go===void 0)try{throw Error()}catch(k){var g=k.stack.trim().match(/\n( *(at )?)/);Go=g&&g[1]||""}return`
`+Go+h}var Ec=!1;function Vp(h,g){if(!h||Ec)return"";Ec=!0;var k=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(g)if(g=function(){throw Error()},Object.defineProperty(g.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(g,[])}catch(Te){var N=Te}Reflect.construct(h,[],g)}else{try{g.call()}catch(Te){N=Te}h.call(g.prototype)}else{try{throw Error()}catch(Te){N=Te}h()}}catch(Te){if(Te&&N&&typeof Te.stack=="string"){for(var T=Te.stack.split(`
`),$=N.stack.split(`
`),U=T.length-1,oe=$.length-1;1<=U&&0<=oe&&T[U]!==$[oe];)oe--;for(;1<=U&&0<=oe;U--,oe--)if(T[U]!==$[oe]){if(U!==1||oe!==1)do if(U--,oe--,0>oe||T[U]!==$[oe]){var ge=`
`+T[U].replace(" at new "," at ");return h.displayName&&ge.includes("<anonymous>")&&(ge=ge.replace("<anonymous>",h.displayName)),ge}while(1<=U&&0<=oe);break}}}finally{Ec=!1,Error.prepareStackTrace=k}return(h=h?h.displayName||h.name:"")?Mt(h):""}var ow=Object.prototype.hasOwnProperty,ru=[],Bs=-1;function li(h){return{current:h}}function an(h){0>Bs||(h.current=ru[Bs],ru[Bs]=null,Bs--)}function Qt(h,g){Bs++,ru[Bs]=h.current,h.current=g}var ui={},br=li(ui),Hr=li(!1),Ho=ui;function zs(h,g){var k=h.type.contextTypes;if(!k)return ui;var N=h.stateNode;if(N&&N.__reactInternalMemoizedUnmaskedChildContext===g)return N.__reactInternalMemoizedMaskedChildContext;var T={},$;for($ in k)T[$]=g[$];return N&&(h=h.stateNode,h.__reactInternalMemoizedUnmaskedChildContext=g,h.__reactInternalMemoizedMaskedChildContext=T),T}function qr(h){return h=h.childContextTypes,h!=null}function _c(){an(Hr),an(br)}function Fm(h,g,k){if(br.current!==ui)throw Error(i(168));Qt(br,g),Qt(Hr,k)}function kn(h,g,k){var N=h.stateNode;if(g=g.childContextTypes,typeof N.getChildContext!="function")return k;N=N.getChildContext();for(var T in N)if(!(T in g))throw Error(i(108,_(h)||"Unknown",T));return a({},k,N)}function mo(h){return h=(h=h.stateNode)&&h.__reactInternalMemoizedMergedChildContext||ui,Ho=br.current,Qt(br,h),Qt(Hr,Hr.current),!0}function au(h,g,k){var N=h.stateNode;if(!N)throw Error(i(169));k?(h=kn(h,g,Ho),N.__reactInternalMemoizedMergedChildContext=h,an(Hr),an(br),Qt(br,h)):an(Hr),Qt(Hr,k)}var qa=Math.clz32?Math.clz32:sw,Bm=Math.log,Wp=Math.LN2;function sw(h){return h>>>=0,h===0?32:31-(Bm(h)/Wp|0)|0}var Oc=64,qo=4194304;function iu(h){switch(h&-h){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return h&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return h&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return h}}function Ko(h,g){var k=h.pendingLanes;if(k===0)return 0;var N=0,T=h.suspendedLanes,$=h.pingedLanes,U=k&268435455;if(U!==0){var oe=U&~T;oe!==0?N=iu(oe):($&=U,$!==0&&(N=iu($)))}else U=k&~T,U!==0?N=iu(U):$!==0&&(N=iu($));if(N===0)return 0;if(g!==0&&g!==N&&!(g&T)&&(T=N&-N,$=g&-g,T>=$||T===16&&($&4194240)!==0))return g;if(N&4&&(N|=k&16),g=h.entangledLanes,g!==0)for(h=h.entanglements,g&=N;0<g;)k=31-qa(g),T=1<<k,N|=h[k],g&=~T;return N}function L(h,g){switch(h){case 1:case 2:case 4:return g+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return g+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function W(h,g){for(var k=h.suspendedLanes,N=h.pingedLanes,T=h.expirationTimes,$=h.pendingLanes;0<$;){var U=31-qa($),oe=1<<U,ge=T[U];ge===-1?(!(oe&k)||oe&N)&&(T[U]=L(oe,g)):ge<=g&&(h.expiredLanes|=oe),$&=~oe}}function J(h){return h=h.pendingLanes&-1073741825,h!==0?h:h&1073741824?1073741824:0}function ae(){var h=Oc;return Oc<<=1,!(Oc&4194240)&&(Oc=64),h}function ye(h){for(var g=[],k=0;31>k;k++)g.push(h);return g}function we(h,g,k){h.pendingLanes|=g,g!==536870912&&(h.suspendedLanes=0,h.pingedLanes=0),h=h.eventTimes,g=31-qa(g),h[g]=k}function Oe(h,g){var k=h.pendingLanes&~g;h.pendingLanes=g,h.suspendedLanes=0,h.pingedLanes=0,h.expiredLanes&=g,h.mutableReadLanes&=g,h.entangledLanes&=g,g=h.entanglements;var N=h.eventTimes;for(h=h.expirationTimes;0<k;){var T=31-qa(k),$=1<<T;g[T]=0,N[T]=-1,h[T]=-1,k&=~$}}function Ee(h,g){var k=h.entangledLanes|=g;for(h=h.entanglements;k;){var N=31-qa(k),T=1<<N;T&g|h[N]&g&&(h[N]|=g),k&=~T}}var Ce=0;function De(h){return h&=-h,1<h?4<h?h&268435455?16:536870912:4:1}var st=r.unstable_scheduleCallback,Ke=r.unstable_cancelCallback,bt=r.unstable_shouldYield,ct=r.unstable_requestPaint,We=r.unstable_now,tt=r.unstable_ImmediatePriority,rt=r.unstable_UserBlockingPriority,Xe=r.unstable_NormalPriority,dt=r.unstable_IdlePriority,et=null,ut=null;function Fn(h){if(ut&&typeof ut.onCommitFiberRoot=="function")try{ut.onCommitFiberRoot(et,h,void 0,(h.current.flags&128)===128)}catch{}}function Ia(h,g){return h===g&&(h!==0||1/h===1/g)||h!==h&&g!==g}var It=typeof Object.is=="function"?Object.is:Ia,Sn=null,yn=!1,Kr=!1;function ga(h){Sn===null?Sn=[h]:Sn.push(h)}function ji(h){yn=!0,ga(h)}function Qn(){if(!Kr&&Sn!==null){Kr=!0;var h=0,g=Ce;try{var k=Sn;for(Ce=1;h<k.length;h++){var N=k[h];do N=N(!0);while(N!==null)}Sn=null,yn=!1}catch(T){throw Sn!==null&&(Sn=Sn.slice(h+1)),st(tt,Qn),T}finally{Ce=g,Kr=!1}}return null}var at=[],yt=0,Zn=null,Jn=0,qt=[],hn=0,$r=null,Vi=1,Rr="";function Xo(h,g){at[yt++]=Jn,at[yt++]=Zn,Zn=h,Jn=g}function Up(h,g,k){qt[hn++]=Vi,qt[hn++]=Rr,qt[hn++]=$r,$r=h;var N=Vi;h=Rr;var T=32-qa(N)-1;N&=~(1<<T),k+=1;var $=32-qa(g)+T;if(30<$){var U=T-T%5;$=(N&(1<<U)-1).toString(32),N>>=U,T-=U,Vi=1<<32-qa(g)+T|k<<T|N,Rr=$+h}else Vi=1<<$|k<<T|N,Rr=h}function ma(h){h.return!==null&&(Xo(h,1),Up(h,1,0))}function Yo(h){for(;h===Zn;)Zn=at[--yt],at[yt]=null,Jn=at[--yt],at[yt]=null;for(;h===$r;)$r=qt[--hn],qt[hn]=null,Rr=qt[--hn],qt[hn]=null,Vi=qt[--hn],qt[hn]=null}var Bn=null,Mr=null,Bt=!1,Qo=!1,Wi=null;function FE(h,g){var k=fi(5,null,null,0);k.elementType="DELETED",k.stateNode=g,k.return=h,g=h.deletions,g===null?(h.deletions=[k],h.flags|=16):g.push(k)}function BE(h,g){switch(h.tag){case 5:return g=Mm(g,h.type,h.pendingProps),g!==null?(h.stateNode=g,Bn=h,Mr=Nc(g),!0):!1;case 6:return g=Am(g,h.pendingProps),g!==null?(h.stateNode=g,Bn=h,Mr=null,!0):!1;case 13:if(g=Pm(g),g!==null){var k=$r!==null?{id:Vi,overflow:Rr}:null;return h.memoizedState={dehydrated:g,treeContext:k,retryLane:1073741824},k=fi(18,null,null,0),k.stateNode=g,k.return=h,h.child=k,Bn=h,Mr=null,!0}return!1;default:return!1}}function lw(h){return(h.mode&1)!==0&&(h.flags&128)===0}function uw(h){if(Bt){var g=Mr;if(g){var k=g;if(!BE(h,g)){if(lw(h))throw Error(i(418));g=zi(k);var N=Bn;g&&BE(h,g)?FE(N,k):(h.flags=h.flags&-4097|2,Bt=!1,Bn=h)}}else{if(lw(h))throw Error(i(418));h.flags=h.flags&-4097|2,Bt=!1,Bn=h}}}function zE(h){for(h=h.return;h!==null&&h.tag!==5&&h.tag!==3&&h.tag!==13;)h=h.return;Bn=h}function zm(h){if(!Ie||h!==Bn)return!1;if(!Bt)return zE(h),Bt=!0,!1;if(h.tag!==3&&(h.tag!==5||Ic(h.type)&&!re(h.type,h.memoizedProps))){var g=Mr;if(g){if(lw(h))throw jE(),Error(i(418));for(;g;)FE(h,g),g=zi(g)}}if(zE(h),h.tag===13){if(!Ie)throw Error(i(316));if(h=h.memoizedState,h=h!==null?h.dehydrated:null,!h)throw Error(i(317));Mr=nw(h)}else Mr=Bn?zi(h.stateNode):null;return!0}function jE(){for(var h=Mr;h;)h=zi(h)}function $c(){Ie&&(Mr=Bn=null,Qo=Bt=!1)}function cw(h){Wi===null?Wi=[h]:Wi.push(h)}var aj=o.ReactCurrentBatchConfig;function jm(h,g){if(It(h,g))return!0;if(typeof h!="object"||h===null||typeof g!="object"||g===null)return!1;var k=Object.keys(h),N=Object.keys(g);if(k.length!==N.length)return!1;for(N=0;N<k.length;N++){var T=k[N];if(!ow.call(g,T)||!It(h[T],g[T]))return!1}return!0}function ij(h){switch(h.tag){case 5:return Mt(h.type);case 16:return Mt("Lazy");case 13:return Mt("Suspense");case 19:return Mt("SuspenseList");case 0:case 2:case 15:return h=Vp(h.type,!1),h;case 11:return h=Vp(h.type.render,!1),h;case 1:return h=Vp(h.type,!0),h;default:return""}}function Ui(h,g){if(h&&h.defaultProps){g=a({},g),h=h.defaultProps;for(var k in h)g[k]===void 0&&(g[k]=h[k]);return g}return g}var Vm=li(null),Wm=null,Rc=null,dw=null;function pw(){dw=Rc=Wm=null}function VE(h,g,k){pe?(Qt(Vm,g._currentValue),g._currentValue=k):(Qt(Vm,g._currentValue2),g._currentValue2=k)}function hw(h){var g=Vm.current;an(Vm),pe?h._currentValue=g:h._currentValue2=g}function fw(h,g,k){for(;h!==null;){var N=h.alternate;if((h.childLanes&g)!==g?(h.childLanes|=g,N!==null&&(N.childLanes|=g)):N!==null&&(N.childLanes&g)!==g&&(N.childLanes|=g),h===k)break;h=h.return}}function Mc(h,g){Wm=h,dw=Rc=null,h=h.dependencies,h!==null&&h.firstContext!==null&&(h.lanes&g&&(Ea=!0),h.firstContext=null)}function ci(h){var g=pe?h._currentValue:h._currentValue2;if(dw!==h)if(h={context:h,memoizedValue:g,next:null},Rc===null){if(Wm===null)throw Error(i(308));Rc=h,Wm.dependencies={lanes:0,firstContext:h}}else Rc=Rc.next=h;return g}var ou=null;function gw(h){ou===null?ou=[h]:ou.push(h)}function WE(h,g,k,N){var T=g.interleaved;return T===null?(k.next=k,gw(g)):(k.next=T.next,T.next=k),g.interleaved=k,yo(h,N)}function yo(h,g){h.lanes|=g;var k=h.alternate;for(k!==null&&(k.lanes|=g),k=h,h=h.return;h!==null;)h.childLanes|=g,k=h.alternate,k!==null&&(k.childLanes|=g),k=h,h=h.return;return k.tag===3?k.stateNode:null}var js=!1;function mw(h){h.updateQueue={baseState:h.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function UE(h,g){h=h.updateQueue,g.updateQueue===h&&(g.updateQueue={baseState:h.baseState,firstBaseUpdate:h.firstBaseUpdate,lastBaseUpdate:h.lastBaseUpdate,shared:h.shared,effects:h.effects})}function Zo(h,g){return{eventTime:h,lane:g,tag:0,payload:null,callback:null,next:null}}function Vs(h,g,k){var N=h.updateQueue;if(N===null)return null;if(N=N.shared,Ct&2){var T=N.pending;return T===null?g.next=g:(g.next=T.next,T.next=g),N.pending=g,yo(h,k)}return T=N.interleaved,T===null?(g.next=g,gw(N)):(g.next=T.next,T.next=g),N.interleaved=g,yo(h,k)}function Um(h,g,k){if(g=g.updateQueue,g!==null&&(g=g.shared,(k&4194240)!==0)){var N=g.lanes;N&=h.pendingLanes,k|=N,g.lanes=k,Ee(h,k)}}function GE(h,g){var k=h.updateQueue,N=h.alternate;if(N!==null&&(N=N.updateQueue,k===N)){var T=null,$=null;if(k=k.firstBaseUpdate,k!==null){do{var U={eventTime:k.eventTime,lane:k.lane,tag:k.tag,payload:k.payload,callback:k.callback,next:null};$===null?T=$=U:$=$.next=U,k=k.next}while(k!==null);$===null?T=$=g:$=$.next=g}else T=$=g;k={baseState:N.baseState,firstBaseUpdate:T,lastBaseUpdate:$,shared:N.shared,effects:N.effects},h.updateQueue=k;return}h=k.lastBaseUpdate,h===null?k.firstBaseUpdate=g:h.next=g,k.lastBaseUpdate=g}function Gm(h,g,k,N){var T=h.updateQueue;js=!1;var $=T.firstBaseUpdate,U=T.lastBaseUpdate,oe=T.shared.pending;if(oe!==null){T.shared.pending=null;var ge=oe,Te=ge.next;ge.next=null,U===null?$=Te:U.next=Te,U=ge;var Ve=h.alternate;Ve!==null&&(Ve=Ve.updateQueue,oe=Ve.lastBaseUpdate,oe!==U&&(oe===null?Ve.firstBaseUpdate=Te:oe.next=Te,Ve.lastBaseUpdate=ge))}if($!==null){var ht=T.baseState;U=0,Ve=Te=ge=null,oe=$;do{var Ae=oe.lane,bn=oe.eventTime;if((N&Ae)===Ae){Ve!==null&&(Ve=Ve.next={eventTime:bn,lane:0,tag:oe.tag,payload:oe.payload,callback:oe.callback,next:null});e:{var on=h,$a=oe;switch(Ae=g,bn=k,$a.tag){case 1:if(on=$a.payload,typeof on=="function"){ht=on.call(bn,ht,Ae);break e}ht=on;break e;case 3:on.flags=on.flags&-65537|128;case 0:if(on=$a.payload,Ae=typeof on=="function"?on.call(bn,ht,Ae):on,Ae==null)break e;ht=a({},ht,Ae);break e;case 2:js=!0}}oe.callback!==null&&oe.lane!==0&&(h.flags|=64,Ae=T.effects,Ae===null?T.effects=[oe]:Ae.push(oe))}else bn={eventTime:bn,lane:Ae,tag:oe.tag,payload:oe.payload,callback:oe.callback,next:null},Ve===null?(Te=Ve=bn,ge=ht):Ve=Ve.next=bn,U|=Ae;if(oe=oe.next,oe===null){if(oe=T.shared.pending,oe===null)break;Ae=oe,oe=Ae.next,Ae.next=null,T.lastBaseUpdate=Ae,T.shared.pending=null}}while(!0);if(Ve===null&&(ge=ht),T.baseState=ge,T.firstBaseUpdate=Te,T.lastBaseUpdate=Ve,g=T.shared.interleaved,g!==null){T=g;do U|=T.lane,T=T.next;while(T!==g)}else $===null&&(T.shared.lanes=0);lu|=U,h.lanes=U,h.memoizedState=ht}}function HE(h,g,k){if(h=g.effects,g.effects=null,h!==null)for(g=0;g<h.length;g++){var N=h[g],T=N.callback;if(T!==null){if(N.callback=null,N=k,typeof T!="function")throw Error(i(191,T));T.call(N)}}}var qE=new n.Component().refs;function yw(h,g,k,N){g=h.memoizedState,k=k(N,g),k=k==null?g:a({},g,k),h.memoizedState=k,h.lanes===0&&(h.updateQueue.baseState=k)}var Hm={isMounted:function(h){return(h=h._reactInternals)?E(h)===h:!1},enqueueSetState:function(h,g,k){h=h._reactInternals;var N=Zr(),T=Gs(h),$=Zo(N,T);$.payload=g,k!=null&&($.callback=k),g=Vs(h,$,T),g!==null&&(hi(g,h,T,N),Um(g,h,T))},enqueueReplaceState:function(h,g,k){h=h._reactInternals;var N=Zr(),T=Gs(h),$=Zo(N,T);$.tag=1,$.payload=g,k!=null&&($.callback=k),g=Vs(h,$,T),g!==null&&(hi(g,h,T,N),Um(g,h,T))},enqueueForceUpdate:function(h,g){h=h._reactInternals;var k=Zr(),N=Gs(h),T=Zo(k,N);T.tag=2,g!=null&&(T.callback=g),g=Vs(h,T,N),g!==null&&(hi(g,h,N,k),Um(g,h,N))}};function KE(h,g,k,N,T,$,U){return h=h.stateNode,typeof h.shouldComponentUpdate=="function"?h.shouldComponentUpdate(N,$,U):g.prototype&&g.prototype.isPureReactComponent?!jm(k,N)||!jm(T,$):!0}function XE(h,g,k){var N=!1,T=ui,$=g.contextType;return typeof $=="object"&&$!==null?$=ci($):(T=qr(g)?Ho:br.current,N=g.contextTypes,$=(N=N!=null)?zs(h,T):ui),g=new g(k,$),h.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,g.updater=Hm,h.stateNode=g,g._reactInternals=h,N&&(h=h.stateNode,h.__reactInternalMemoizedUnmaskedChildContext=T,h.__reactInternalMemoizedMaskedChildContext=$),g}function YE(h,g,k,N){h=g.state,typeof g.componentWillReceiveProps=="function"&&g.componentWillReceiveProps(k,N),typeof g.UNSAFE_componentWillReceiveProps=="function"&&g.UNSAFE_componentWillReceiveProps(k,N),g.state!==h&&Hm.enqueueReplaceState(g,g.state,null)}function bw(h,g,k,N){var T=h.stateNode;T.props=k,T.state=h.memoizedState,T.refs=qE,mw(h);var $=g.contextType;typeof $=="object"&&$!==null?T.context=ci($):($=qr(g)?Ho:br.current,T.context=zs(h,$)),T.state=h.memoizedState,$=g.getDerivedStateFromProps,typeof $=="function"&&(yw(h,g,$,k),T.state=h.memoizedState),typeof g.getDerivedStateFromProps=="function"||typeof T.getSnapshotBeforeUpdate=="function"||typeof T.UNSAFE_componentWillMount!="function"&&typeof T.componentWillMount!="function"||(g=T.state,typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount(),g!==T.state&&Hm.enqueueReplaceState(T,T.state,null),Gm(h,k,T,N),T.state=h.memoizedState),typeof T.componentDidMount=="function"&&(h.flags|=4194308)}function Gp(h,g,k){if(h=k.ref,h!==null&&typeof h!="function"&&typeof h!="object"){if(k._owner){if(k=k._owner,k){if(k.tag!==1)throw Error(i(309));var N=k.stateNode}if(!N)throw Error(i(147,h));var T=N,$=""+h;return g!==null&&g.ref!==null&&typeof g.ref=="function"&&g.ref._stringRef===$?g.ref:(g=function(U){var oe=T.refs;oe===qE&&(oe=T.refs={}),U===null?delete oe[$]:oe[$]=U},g._stringRef=$,g)}if(typeof h!="string")throw Error(i(284));if(!k._owner)throw Error(i(290,h))}return h}function qm(h,g){throw h=Object.prototype.toString.call(g),Error(i(31,h==="[object Object]"?"object with keys {"+Object.keys(g).join(", ")+"}":h))}function QE(h){var g=h._init;return g(h._payload)}function ZE(h){function g(fe,ue){if(h){var be=fe.deletions;be===null?(fe.deletions=[ue],fe.flags|=16):be.push(ue)}}function k(fe,ue){if(!h)return null;for(;ue!==null;)g(fe,ue),ue=ue.sibling;return null}function N(fe,ue){for(fe=new Map;ue!==null;)ue.key!==null?fe.set(ue.key,ue):fe.set(ue.index,ue),ue=ue.sibling;return fe}function T(fe,ue){return fe=qs(fe,ue),fe.index=0,fe.sibling=null,fe}function $(fe,ue,be){return fe.index=be,h?(be=fe.alternate,be!==null?(be=be.index,be<ue?(fe.flags|=2,ue):be):(fe.flags|=2,ue)):(fe.flags|=1048576,ue)}function U(fe){return h&&fe.alternate===null&&(fe.flags|=2),fe}function oe(fe,ue,be,Pe){return ue===null||ue.tag!==6?(ue=ak(be,fe.mode,Pe),ue.return=fe,ue):(ue=T(ue,be),ue.return=fe,ue)}function ge(fe,ue,be,Pe){var nt=be.type;return nt===u?Ve(fe,ue,be.props.children,Pe,be.key):ue!==null&&(ue.elementType===nt||typeof nt=="object"&&nt!==null&&nt.$$typeof===v&&QE(nt)===ue.type)?(Pe=T(ue,be.props),Pe.ref=Gp(fe,ue,be),Pe.return=fe,Pe):(Pe=v0(be.type,be.key,be.props,null,fe.mode,Pe),Pe.ref=Gp(fe,ue,be),Pe.return=fe,Pe)}function Te(fe,ue,be,Pe){return ue===null||ue.tag!==4||ue.stateNode.containerInfo!==be.containerInfo||ue.stateNode.implementation!==be.implementation?(ue=ik(be,fe.mode,Pe),ue.return=fe,ue):(ue=T(ue,be.children||[]),ue.return=fe,ue)}function Ve(fe,ue,be,Pe,nt){return ue===null||ue.tag!==7?(ue=pu(be,fe.mode,Pe,nt),ue.return=fe,ue):(ue=T(ue,be),ue.return=fe,ue)}function ht(fe,ue,be){if(typeof ue=="string"&&ue!==""||typeof ue=="number")return ue=ak(""+ue,fe.mode,be),ue.return=fe,ue;if(typeof ue=="object"&&ue!==null){switch(ue.$$typeof){case s:return be=v0(ue.type,ue.key,ue.props,null,fe.mode,be),be.ref=Gp(fe,null,ue),be.return=fe,be;case l:return ue=ik(ue,fe.mode,be),ue.return=fe,ue;case v:var Pe=ue._init;return ht(fe,Pe(ue._payload),be)}if(K(ue)||C(ue))return ue=pu(ue,fe.mode,be,null),ue.return=fe,ue;qm(fe,ue)}return null}function Ae(fe,ue,be,Pe){var nt=ue!==null?ue.key:null;if(typeof be=="string"&&be!==""||typeof be=="number")return nt!==null?null:oe(fe,ue,""+be,Pe);if(typeof be=="object"&&be!==null){switch(be.$$typeof){case s:return be.key===nt?ge(fe,ue,be,Pe):null;case l:return be.key===nt?Te(fe,ue,be,Pe):null;case v:return nt=be._init,Ae(fe,ue,nt(be._payload),Pe)}if(K(be)||C(be))return nt!==null?null:Ve(fe,ue,be,Pe,null);qm(fe,be)}return null}function bn(fe,ue,be,Pe,nt){if(typeof Pe=="string"&&Pe!==""||typeof Pe=="number")return fe=fe.get(be)||null,oe(ue,fe,""+Pe,nt);if(typeof Pe=="object"&&Pe!==null){switch(Pe.$$typeof){case s:return fe=fe.get(Pe.key===null?be:Pe.key)||null,ge(ue,fe,Pe,nt);case l:return fe=fe.get(Pe.key===null?be:Pe.key)||null,Te(ue,fe,Pe,nt);case v:var vt=Pe._init;return bn(fe,ue,be,vt(Pe._payload),nt)}if(K(Pe)||C(Pe))return fe=fe.get(be)||null,Ve(ue,fe,Pe,nt,null);qm(ue,Pe)}return null}function on(fe,ue,be,Pe){for(var nt=null,vt=null,ft=ue,zt=ue=0,wr=null;ft!==null&&zt<be.length;zt++){ft.index>zt?(wr=ft,ft=null):wr=ft.sibling;var jt=Ae(fe,ft,be[zt],Pe);if(jt===null){ft===null&&(ft=wr);break}h&&ft&&jt.alternate===null&&g(fe,ft),ue=$(jt,ue,zt),vt===null?nt=jt:vt.sibling=jt,vt=jt,ft=wr}if(zt===be.length)return k(fe,ft),Bt&&Xo(fe,zt),nt;if(ft===null){for(;zt<be.length;zt++)ft=ht(fe,be[zt],Pe),ft!==null&&(ue=$(ft,ue,zt),vt===null?nt=ft:vt.sibling=ft,vt=ft);return Bt&&Xo(fe,zt),nt}for(ft=N(fe,ft);zt<be.length;zt++)wr=bn(ft,fe,zt,be[zt],Pe),wr!==null&&(h&&wr.alternate!==null&&ft.delete(wr.key===null?zt:wr.key),ue=$(wr,ue,zt),vt===null?nt=wr:vt.sibling=wr,vt=wr);return h&&ft.forEach(function(Ks){return g(fe,Ks)}),Bt&&Xo(fe,zt),nt}function $a(fe,ue,be,Pe){var nt=C(be);if(typeof nt!="function")throw Error(i(150));if(be=nt.call(be),be==null)throw Error(i(151));for(var vt=nt=null,ft=ue,zt=ue=0,wr=null,jt=be.next();ft!==null&&!jt.done;zt++,jt=be.next()){ft.index>zt?(wr=ft,ft=null):wr=ft.sibling;var Ks=Ae(fe,ft,jt.value,Pe);if(Ks===null){ft===null&&(ft=wr);break}h&&ft&&Ks.alternate===null&&g(fe,ft),ue=$(Ks,ue,zt),vt===null?nt=Ks:vt.sibling=Ks,vt=Ks,ft=wr}if(jt.done)return k(fe,ft),Bt&&Xo(fe,zt),nt;if(ft===null){for(;!jt.done;zt++,jt=be.next())jt=ht(fe,jt.value,Pe),jt!==null&&(ue=$(jt,ue,zt),vt===null?nt=jt:vt.sibling=jt,vt=jt);return Bt&&Xo(fe,zt),nt}for(ft=N(fe,ft);!jt.done;zt++,jt=be.next())jt=bn(ft,fe,zt,jt.value,Pe),jt!==null&&(h&&jt.alternate!==null&&ft.delete(jt.key===null?zt:jt.key),ue=$(jt,ue,zt),vt===null?nt=jt:vt.sibling=jt,vt=jt);return h&&ft.forEach(function(Pj){return g(fe,Pj)}),Bt&&Xo(fe,zt),nt}function ts(fe,ue,be,Pe){if(typeof be=="object"&&be!==null&&be.type===u&&be.key===null&&(be=be.props.children),typeof be=="object"&&be!==null){switch(be.$$typeof){case s:e:{for(var nt=be.key,vt=ue;vt!==null;){if(vt.key===nt){if(nt=be.type,nt===u){if(vt.tag===7){k(fe,vt.sibling),ue=T(vt,be.props.children),ue.return=fe,fe=ue;break e}}else if(vt.elementType===nt||typeof nt=="object"&&nt!==null&&nt.$$typeof===v&&QE(nt)===vt.type){k(fe,vt.sibling),ue=T(vt,be.props),ue.ref=Gp(fe,vt,be),ue.return=fe,fe=ue;break e}k(fe,vt);break}else g(fe,vt);vt=vt.sibling}be.type===u?(ue=pu(be.props.children,fe.mode,Pe,be.key),ue.return=fe,fe=ue):(Pe=v0(be.type,be.key,be.props,null,fe.mode,Pe),Pe.ref=Gp(fe,ue,be),Pe.return=fe,fe=Pe)}return U(fe);case l:e:{for(vt=be.key;ue!==null;){if(ue.key===vt)if(ue.tag===4&&ue.stateNode.containerInfo===be.containerInfo&&ue.stateNode.implementation===be.implementation){k(fe,ue.sibling),ue=T(ue,be.children||[]),ue.return=fe,fe=ue;break e}else{k(fe,ue);break}else g(fe,ue);ue=ue.sibling}ue=ik(be,fe.mode,Pe),ue.return=fe,fe=ue}return U(fe);case v:return vt=be._init,ts(fe,ue,vt(be._payload),Pe)}if(K(be))return on(fe,ue,be,Pe);if(C(be))return $a(fe,ue,be,Pe);qm(fe,be)}return typeof be=="string"&&be!==""||typeof be=="number"?(be=""+be,ue!==null&&ue.tag===6?(k(fe,ue.sibling),ue=T(ue,be),ue.return=fe,fe=ue):(k(fe,ue),ue=ak(be,fe.mode,Pe),ue.return=fe,fe=ue),U(fe)):k(fe,ue)}return ts}var Ac=ZE(!0),JE=ZE(!1),Hp={},di=li(Hp),qp=li(Hp),Pc=li(Hp);function bo(h){if(h===Hp)throw Error(i(174));return h}function vw(h,g){Qt(Pc,g),Qt(qp,h),Qt(di,Hp),h=Z(g),an(di),Qt(di,h)}function Lc(){an(di),an(qp),an(Pc)}function e_(h){var g=bo(Pc.current),k=bo(di.current);g=q(k,h.type,g),k!==g&&(Qt(qp,h),Qt(di,g))}function xw(h){qp.current===h&&(an(di),an(qp))}var On=li(0);function Km(h){for(var g=h;g!==null;){if(g.tag===13){var k=g.memoizedState;if(k!==null&&(k=k.dehydrated,k===null||Bp(k)||Cc(k)))return g}else if(g.tag===19&&g.memoizedProps.revealOrder!==void 0){if(g.flags&128)return g}else if(g.child!==null){g.child.return=g,g=g.child;continue}if(g===h)break;for(;g.sibling===null;){if(g.return===null||g.return===h)return null;g=g.return}g.sibling.return=g.return,g=g.sibling}return null}var ww=[];function kw(){for(var h=0;h<ww.length;h++){var g=ww[h];pe?g._workInProgressVersionPrimary=null:g._workInProgressVersionSecondary=null}ww.length=0}var Xm=o.ReactCurrentDispatcher,Sw=o.ReactCurrentBatchConfig,su=0,$n=null,or=null,vr=null,Ym=!1,Kp=!1,Xp=0,oj=0;function Xr(){throw Error(i(321))}function Cw(h,g){if(g===null)return!1;for(var k=0;k<g.length&&k<h.length;k++)if(!It(h[k],g[k]))return!1;return!0}function Nw(h,g,k,N,T,$){if(su=$,$n=g,g.memoizedState=null,g.updateQueue=null,g.lanes=0,Xm.current=h===null||h.memoizedState===null?cj:dj,h=k(N,T),Kp){$=0;do{if(Kp=!1,Xp=0,25<=$)throw Error(i(301));$+=1,vr=or=null,g.updateQueue=null,Xm.current=pj,h=k(N,T)}while(Kp)}if(Xm.current=Jm,g=or!==null&&or.next!==null,su=0,vr=or=$n=null,Ym=!1,g)throw Error(i(300));return h}function Tw(){var h=Xp!==0;return Xp=0,h}function vo(){var h={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return vr===null?$n.memoizedState=vr=h:vr=vr.next=h,vr}function pi(){if(or===null){var h=$n.alternate;h=h!==null?h.memoizedState:null}else h=or.next;var g=vr===null?$n.memoizedState:vr.next;if(g!==null)vr=g,or=h;else{if(h===null)throw Error(i(310));or=h,h={memoizedState:or.memoizedState,baseState:or.baseState,baseQueue:or.baseQueue,queue:or.queue,next:null},vr===null?$n.memoizedState=vr=h:vr=vr.next=h}return vr}function Yp(h,g){return typeof g=="function"?g(h):g}function Iw(h){var g=pi(),k=g.queue;if(k===null)throw Error(i(311));k.lastRenderedReducer=h;var N=or,T=N.baseQueue,$=k.pending;if($!==null){if(T!==null){var U=T.next;T.next=$.next,$.next=U}N.baseQueue=T=$,k.pending=null}if(T!==null){$=T.next,N=N.baseState;var oe=U=null,ge=null,Te=$;do{var Ve=Te.lane;if((su&Ve)===Ve)ge!==null&&(ge=ge.next={lane:0,action:Te.action,hasEagerState:Te.hasEagerState,eagerState:Te.eagerState,next:null}),N=Te.hasEagerState?Te.eagerState:h(N,Te.action);else{var ht={lane:Ve,action:Te.action,hasEagerState:Te.hasEagerState,eagerState:Te.eagerState,next:null};ge===null?(oe=ge=ht,U=N):ge=ge.next=ht,$n.lanes|=Ve,lu|=Ve}Te=Te.next}while(Te!==null&&Te!==$);ge===null?U=N:ge.next=oe,It(N,g.memoizedState)||(Ea=!0),g.memoizedState=N,g.baseState=U,g.baseQueue=ge,k.lastRenderedState=N}if(h=k.interleaved,h!==null){T=h;do $=T.lane,$n.lanes|=$,lu|=$,T=T.next;while(T!==h)}else T===null&&(k.lanes=0);return[g.memoizedState,k.dispatch]}function Ew(h){var g=pi(),k=g.queue;if(k===null)throw Error(i(311));k.lastRenderedReducer=h;var N=k.dispatch,T=k.pending,$=g.memoizedState;if(T!==null){k.pending=null;var U=T=T.next;do $=h($,U.action),U=U.next;while(U!==T);It($,g.memoizedState)||(Ea=!0),g.memoizedState=$,g.baseQueue===null&&(g.baseState=$),k.lastRenderedState=$}return[$,N]}function t_(){}function n_(h,g){var k=$n,N=pi(),T=g(),$=!It(N.memoizedState,T);if($&&(N.memoizedState=T,Ea=!0),N=N.queue,_w(i_.bind(null,k,N,h),[h]),N.getSnapshot!==g||$||vr!==null&&vr.memoizedState.tag&1){if(k.flags|=2048,Qp(9,a_.bind(null,k,N,T,g),void 0,null),xr===null)throw Error(i(349));su&30||r_(k,g,T)}return T}function r_(h,g,k){h.flags|=16384,h={getSnapshot:g,value:k},g=$n.updateQueue,g===null?(g={lastEffect:null,stores:null},$n.updateQueue=g,g.stores=[h]):(k=g.stores,k===null?g.stores=[h]:k.push(h))}function a_(h,g,k,N){g.value=k,g.getSnapshot=N,o_(g)&&s_(h)}function i_(h,g,k){return k(function(){o_(g)&&s_(h)})}function o_(h){var g=h.getSnapshot;h=h.value;try{var k=g();return!It(h,k)}catch{return!0}}function s_(h){var g=yo(h,1);g!==null&&hi(g,h,1,-1)}function l_(h){var g=vo();return typeof h=="function"&&(h=h()),g.memoizedState=g.baseState=h,h={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Yp,lastRenderedState:h},g.queue=h,h=h.dispatch=uj.bind(null,$n,h),[g.memoizedState,h]}function Qp(h,g,k,N){return h={tag:h,create:g,destroy:k,deps:N,next:null},g=$n.updateQueue,g===null?(g={lastEffect:null,stores:null},$n.updateQueue=g,g.lastEffect=h.next=h):(k=g.lastEffect,k===null?g.lastEffect=h.next=h:(N=k.next,k.next=h,h.next=N,g.lastEffect=h)),h}function u_(){return pi().memoizedState}function Qm(h,g,k,N){var T=vo();$n.flags|=h,T.memoizedState=Qp(1|g,k,void 0,N===void 0?null:N)}function Zm(h,g,k,N){var T=pi();N=N===void 0?null:N;var $=void 0;if(or!==null){var U=or.memoizedState;if($=U.destroy,N!==null&&Cw(N,U.deps)){T.memoizedState=Qp(g,k,$,N);return}}$n.flags|=h,T.memoizedState=Qp(1|g,k,$,N)}function c_(h,g){return Qm(8390656,8,h,g)}function _w(h,g){return Zm(2048,8,h,g)}function d_(h,g){return Zm(4,2,h,g)}function p_(h,g){return Zm(4,4,h,g)}function h_(h,g){if(typeof g=="function")return h=h(),g(h),function(){g(null)};if(g!=null)return h=h(),g.current=h,function(){g.current=null}}function f_(h,g,k){return k=k!=null?k.concat([h]):null,Zm(4,4,h_.bind(null,g,h),k)}function Ow(){}function g_(h,g){var k=pi();g=g===void 0?null:g;var N=k.memoizedState;return N!==null&&g!==null&&Cw(g,N[1])?N[0]:(k.memoizedState=[h,g],h)}function m_(h,g){var k=pi();g=g===void 0?null:g;var N=k.memoizedState;return N!==null&&g!==null&&Cw(g,N[1])?N[0]:(h=h(),k.memoizedState=[h,g],h)}function y_(h,g,k){return su&21?(It(k,g)||(k=ae(),$n.lanes|=k,lu|=k,h.baseState=!0),g):(h.baseState&&(h.baseState=!1,Ea=!0),h.memoizedState=k)}function sj(h,g){var k=Ce;Ce=k!==0&&4>k?k:4,h(!0);var N=Sw.transition;Sw.transition={};try{h(!1),g()}finally{Ce=k,Sw.transition=N}}function b_(){return pi().memoizedState}function lj(h,g,k){var N=Gs(h);if(k={lane:N,action:k,hasEagerState:!1,eagerState:null,next:null},v_(h))x_(g,k);else if(k=WE(h,g,k,N),k!==null){var T=Zr();hi(k,h,N,T),w_(k,g,N)}}function uj(h,g,k){var N=Gs(h),T={lane:N,action:k,hasEagerState:!1,eagerState:null,next:null};if(v_(h))x_(g,T);else{var $=h.alternate;if(h.lanes===0&&($===null||$.lanes===0)&&($=g.lastRenderedReducer,$!==null))try{var U=g.lastRenderedState,oe=$(U,k);if(T.hasEagerState=!0,T.eagerState=oe,It(oe,U)){var ge=g.interleaved;ge===null?(T.next=T,gw(g)):(T.next=ge.next,ge.next=T),g.interleaved=T;return}}catch{}finally{}k=WE(h,g,T,N),k!==null&&(T=Zr(),hi(k,h,N,T),w_(k,g,N))}}function v_(h){var g=h.alternate;return h===$n||g!==null&&g===$n}function x_(h,g){Kp=Ym=!0;var k=h.pending;k===null?g.next=g:(g.next=k.next,k.next=g),h.pending=g}function w_(h,g,k){if(k&4194240){var N=g.lanes;N&=h.pendingLanes,k|=N,g.lanes=k,Ee(h,k)}}var Jm={readContext:ci,useCallback:Xr,useContext:Xr,useEffect:Xr,useImperativeHandle:Xr,useInsertionEffect:Xr,useLayoutEffect:Xr,useMemo:Xr,useReducer:Xr,useRef:Xr,useState:Xr,useDebugValue:Xr,useDeferredValue:Xr,useTransition:Xr,useMutableSource:Xr,useSyncExternalStore:Xr,useId:Xr,unstable_isNewReconciler:!1},cj={readContext:ci,useCallback:function(h,g){return vo().memoizedState=[h,g===void 0?null:g],h},useContext:ci,useEffect:c_,useImperativeHandle:function(h,g,k){return k=k!=null?k.concat([h]):null,Qm(4194308,4,h_.bind(null,g,h),k)},useLayoutEffect:function(h,g){return Qm(4194308,4,h,g)},useInsertionEffect:function(h,g){return Qm(4,2,h,g)},useMemo:function(h,g){var k=vo();return g=g===void 0?null:g,h=h(),k.memoizedState=[h,g],h},useReducer:function(h,g,k){var N=vo();return g=k!==void 0?k(g):g,N.memoizedState=N.baseState=g,h={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:h,lastRenderedState:g},N.queue=h,h=h.dispatch=lj.bind(null,$n,h),[N.memoizedState,h]},useRef:function(h){var g=vo();return h={current:h},g.memoizedState=h},useState:l_,useDebugValue:Ow,useDeferredValue:function(h){return vo().memoizedState=h},useTransition:function(){var h=l_(!1),g=h[0];return h=sj.bind(null,h[1]),vo().memoizedState=h,[g,h]},useMutableSource:function(){},useSyncExternalStore:function(h,g,k){var N=$n,T=vo();if(Bt){if(k===void 0)throw Error(i(407));k=k()}else{if(k=g(),xr===null)throw Error(i(349));su&30||r_(N,g,k)}T.memoizedState=k;var $={value:k,getSnapshot:g};return T.queue=$,c_(i_.bind(null,N,$,h),[h]),N.flags|=2048,Qp(9,a_.bind(null,N,$,k,g),void 0,null),k},useId:function(){var h=vo(),g=xr.identifierPrefix;if(Bt){var k=Rr,N=Vi;k=(N&~(1<<32-qa(N)-1)).toString(32)+k,g=":"+g+"R"+k,k=Xp++,0<k&&(g+="H"+k.toString(32)),g+=":"}else k=oj++,g=":"+g+"r"+k.toString(32)+":";return h.memoizedState=g},unstable_isNewReconciler:!1},dj={readContext:ci,useCallback:g_,useContext:ci,useEffect:_w,useImperativeHandle:f_,useInsertionEffect:d_,useLayoutEffect:p_,useMemo:m_,useReducer:Iw,useRef:u_,useState:function(){return Iw(Yp)},useDebugValue:Ow,useDeferredValue:function(h){var g=pi();return y_(g,or.memoizedState,h)},useTransition:function(){var h=Iw(Yp)[0],g=pi().memoizedState;return[h,g]},useMutableSource:t_,useSyncExternalStore:n_,useId:b_,unstable_isNewReconciler:!1},pj={readContext:ci,useCallback:g_,useContext:ci,useEffect:_w,useImperativeHandle:f_,useInsertionEffect:d_,useLayoutEffect:p_,useMemo:m_,useReducer:Ew,useRef:u_,useState:function(){return Ew(Yp)},useDebugValue:Ow,useDeferredValue:function(h){var g=pi();return or===null?g.memoizedState=h:y_(g,or.memoizedState,h)},useTransition:function(){var h=Ew(Yp)[0],g=pi().memoizedState;return[h,g]},useMutableSource:t_,useSyncExternalStore:n_,useId:b_,unstable_isNewReconciler:!1};function Dc(h,g){try{var k="",N=g;do k+=ij(N),N=N.return;while(N);var T=k}catch($){T=`
Error generating stack: `+$.message+`
`+$.stack}return{value:h,source:g,stack:T,digest:null}}function $w(h,g,k){return{value:h,source:null,stack:k??null,digest:g??null}}function Rw(h,g){try{console.error(g.value)}catch(k){setTimeout(function(){throw k})}}var hj=typeof WeakMap=="function"?WeakMap:Map;function k_(h,g,k){k=Zo(-1,k),k.tag=3,k.payload={element:null};var N=g.value;return k.callback=function(){h0||(h0=!0,Qw=N),Rw(h,g)},k}function S_(h,g,k){k=Zo(-1,k),k.tag=3;var N=h.type.getDerivedStateFromError;if(typeof N=="function"){var T=g.value;k.payload=function(){return N(T)},k.callback=function(){Rw(h,g)}}var $=h.stateNode;return $!==null&&typeof $.componentDidCatch=="function"&&(k.callback=function(){Rw(h,g),typeof N!="function"&&(Ws===null?Ws=new Set([this]):Ws.add(this));var U=g.stack;this.componentDidCatch(g.value,{componentStack:U!==null?U:""})}),k}function C_(h,g,k){var N=h.pingCache;if(N===null){N=h.pingCache=new hj;var T=new Set;N.set(g,T)}else T=N.get(g),T===void 0&&(T=new Set,N.set(g,T));T.has(k)||(T.add(k),h=Ij.bind(null,h,g,k),g.then(h,h))}function N_(h){do{var g;if((g=h.tag===13)&&(g=h.memoizedState,g=g!==null?g.dehydrated!==null:!0),g)return h;h=h.return}while(h!==null);return null}function T_(h,g,k,N,T){return h.mode&1?(h.flags|=65536,h.lanes=T,h):(h===g?h.flags|=65536:(h.flags|=128,k.flags|=131072,k.flags&=-52805,k.tag===1&&(k.alternate===null?k.tag=17:(g=Zo(-1,1),g.tag=2,Vs(k,g,1))),k.lanes|=1),h)}var fj=o.ReactCurrentOwner,Ea=!1;function ya(h,g,k,N){g.child=h===null?JE(g,null,k,N):Ac(g,h.child,k,N)}function I_(h,g,k,N,T){k=k.render;var $=g.ref;return Mc(g,T),N=Nw(h,g,k,N,$,T),k=Tw(),h!==null&&!Ea?(g.updateQueue=h.updateQueue,g.flags&=-2053,h.lanes&=~T,Jo(h,g,T)):(Bt&&k&&ma(g),g.flags|=1,ya(h,g,N,T),g.child)}function E_(h,g,k,N,T){if(h===null){var $=k.type;return typeof $=="function"&&!rk($)&&$.defaultProps===void 0&&k.compare===null&&k.defaultProps===void 0?(g.tag=15,g.type=$,__(h,g,$,N,T)):(h=v0(k.type,null,N,g,g.mode,T),h.ref=g.ref,h.return=g,g.child=h)}if($=h.child,!(h.lanes&T)){var U=$.memoizedProps;if(k=k.compare,k=k!==null?k:jm,k(U,N)&&h.ref===g.ref)return Jo(h,g,T)}return g.flags|=1,h=qs($,N),h.ref=g.ref,h.return=g,g.child=h}function __(h,g,k,N,T){if(h!==null){var $=h.memoizedProps;if(jm($,N)&&h.ref===g.ref)if(Ea=!1,g.pendingProps=N=$,(h.lanes&T)!==0)h.flags&131072&&(Ea=!0);else return g.lanes=h.lanes,Jo(h,g,T)}return Mw(h,g,k,N,T)}function O_(h,g,k){var N=g.pendingProps,T=N.children,$=h!==null?h.memoizedState:null;if(N.mode==="hidden")if(!(g.mode&1))g.memoizedState={baseLanes:0,cachePool:null,transitions:null},Qt(Bc,Ka),Ka|=k;else{if(!(k&1073741824))return h=$!==null?$.baseLanes|k:k,g.lanes=g.childLanes=1073741824,g.memoizedState={baseLanes:h,cachePool:null,transitions:null},g.updateQueue=null,Qt(Bc,Ka),Ka|=h,null;g.memoizedState={baseLanes:0,cachePool:null,transitions:null},N=$!==null?$.baseLanes:k,Qt(Bc,Ka),Ka|=N}else $!==null?(N=$.baseLanes|k,g.memoizedState=null):N=k,Qt(Bc,Ka),Ka|=N;return ya(h,g,T,k),g.child}function $_(h,g){var k=g.ref;(h===null&&k!==null||h!==null&&h.ref!==k)&&(g.flags|=512,g.flags|=2097152)}function Mw(h,g,k,N,T){var $=qr(k)?Ho:br.current;return $=zs(g,$),Mc(g,T),k=Nw(h,g,k,N,$,T),N=Tw(),h!==null&&!Ea?(g.updateQueue=h.updateQueue,g.flags&=-2053,h.lanes&=~T,Jo(h,g,T)):(Bt&&N&&ma(g),g.flags|=1,ya(h,g,k,T),g.child)}function R_(h,g,k,N,T){if(qr(k)){var $=!0;mo(g)}else $=!1;if(Mc(g,T),g.stateNode===null)t0(h,g),XE(g,k,N),bw(g,k,N,T),N=!0;else if(h===null){var U=g.stateNode,oe=g.memoizedProps;U.props=oe;var ge=U.context,Te=k.contextType;typeof Te=="object"&&Te!==null?Te=ci(Te):(Te=qr(k)?Ho:br.current,Te=zs(g,Te));var Ve=k.getDerivedStateFromProps,ht=typeof Ve=="function"||typeof U.getSnapshotBeforeUpdate=="function";ht||typeof U.UNSAFE_componentWillReceiveProps!="function"&&typeof U.componentWillReceiveProps!="function"||(oe!==N||ge!==Te)&&YE(g,U,N,Te),js=!1;var Ae=g.memoizedState;U.state=Ae,Gm(g,N,U,T),ge=g.memoizedState,oe!==N||Ae!==ge||Hr.current||js?(typeof Ve=="function"&&(yw(g,k,Ve,N),ge=g.memoizedState),(oe=js||KE(g,k,oe,N,Ae,ge,Te))?(ht||typeof U.UNSAFE_componentWillMount!="function"&&typeof U.componentWillMount!="function"||(typeof U.componentWillMount=="function"&&U.componentWillMount(),typeof U.UNSAFE_componentWillMount=="function"&&U.UNSAFE_componentWillMount()),typeof U.componentDidMount=="function"&&(g.flags|=4194308)):(typeof U.componentDidMount=="function"&&(g.flags|=4194308),g.memoizedProps=N,g.memoizedState=ge),U.props=N,U.state=ge,U.context=Te,N=oe):(typeof U.componentDidMount=="function"&&(g.flags|=4194308),N=!1)}else{U=g.stateNode,UE(h,g),oe=g.memoizedProps,Te=g.type===g.elementType?oe:Ui(g.type,oe),U.props=Te,ht=g.pendingProps,Ae=U.context,ge=k.contextType,typeof ge=="object"&&ge!==null?ge=ci(ge):(ge=qr(k)?Ho:br.current,ge=zs(g,ge));var bn=k.getDerivedStateFromProps;(Ve=typeof bn=="function"||typeof U.getSnapshotBeforeUpdate=="function")||typeof U.UNSAFE_componentWillReceiveProps!="function"&&typeof U.componentWillReceiveProps!="function"||(oe!==ht||Ae!==ge)&&YE(g,U,N,ge),js=!1,Ae=g.memoizedState,U.state=Ae,Gm(g,N,U,T);var on=g.memoizedState;oe!==ht||Ae!==on||Hr.current||js?(typeof bn=="function"&&(yw(g,k,bn,N),on=g.memoizedState),(Te=js||KE(g,k,Te,N,Ae,on,ge)||!1)?(Ve||typeof U.UNSAFE_componentWillUpdate!="function"&&typeof U.componentWillUpdate!="function"||(typeof U.componentWillUpdate=="function"&&U.componentWillUpdate(N,on,ge),typeof U.UNSAFE_componentWillUpdate=="function"&&U.UNSAFE_componentWillUpdate(N,on,ge)),typeof U.componentDidUpdate=="function"&&(g.flags|=4),typeof U.getSnapshotBeforeUpdate=="function"&&(g.flags|=1024)):(typeof U.componentDidUpdate!="function"||oe===h.memoizedProps&&Ae===h.memoizedState||(g.flags|=4),typeof U.getSnapshotBeforeUpdate!="function"||oe===h.memoizedProps&&Ae===h.memoizedState||(g.flags|=1024),g.memoizedProps=N,g.memoizedState=on),U.props=N,U.state=on,U.context=ge,N=Te):(typeof U.componentDidUpdate!="function"||oe===h.memoizedProps&&Ae===h.memoizedState||(g.flags|=4),typeof U.getSnapshotBeforeUpdate!="function"||oe===h.memoizedProps&&Ae===h.memoizedState||(g.flags|=1024),N=!1)}return Aw(h,g,k,N,$,T)}function Aw(h,g,k,N,T,$){$_(h,g);var U=(g.flags&128)!==0;if(!N&&!U)return T&&au(g,k,!1),Jo(h,g,$);N=g.stateNode,fj.current=g;var oe=U&&typeof k.getDerivedStateFromError!="function"?null:N.render();return g.flags|=1,h!==null&&U?(g.child=Ac(g,h.child,null,$),g.child=Ac(g,null,oe,$)):ya(h,g,oe,$),g.memoizedState=N.state,T&&au(g,k,!0),g.child}function M_(h){var g=h.stateNode;g.pendingContext?Fm(h,g.pendingContext,g.pendingContext!==g.context):g.context&&Fm(h,g.context,!1),vw(h,g.containerInfo)}function A_(h,g,k,N,T){return $c(),cw(T),g.flags|=256,ya(h,g,k,N),g.child}var Pw={dehydrated:null,treeContext:null,retryLane:0};function Lw(h){return{baseLanes:h,cachePool:null,transitions:null}}function P_(h,g,k){var N=g.pendingProps,T=On.current,$=!1,U=(g.flags&128)!==0,oe;if((oe=U)||(oe=h!==null&&h.memoizedState===null?!1:(T&2)!==0),oe?($=!0,g.flags&=-129):(h===null||h.memoizedState!==null)&&(T|=1),Qt(On,T&1),h===null)return uw(g),h=g.memoizedState,h!==null&&(h=h.dehydrated,h!==null)?(g.mode&1?Cc(h)?g.lanes=8:g.lanes=1073741824:g.lanes=1,null):(U=N.children,h=N.fallback,$?(N=g.mode,$=g.child,U={mode:"hidden",children:U},!(N&1)&&$!==null?($.childLanes=0,$.pendingProps=U):$=x0(U,N,0,null),h=pu(h,N,k,null),$.return=g,h.return=g,$.sibling=h,g.child=$,g.child.memoizedState=Lw(k),g.memoizedState=Pw,h):Dw(g,U));if(T=h.memoizedState,T!==null&&(oe=T.dehydrated,oe!==null))return gj(h,g,U,N,oe,T,k);if($){$=N.fallback,U=g.mode,T=h.child,oe=T.sibling;var ge={mode:"hidden",children:N.children};return!(U&1)&&g.child!==T?(N=g.child,N.childLanes=0,N.pendingProps=ge,g.deletions=null):(N=qs(T,ge),N.subtreeFlags=T.subtreeFlags&14680064),oe!==null?$=qs(oe,$):($=pu($,U,k,null),$.flags|=2),$.return=g,N.return=g,N.sibling=$,g.child=N,N=$,$=g.child,U=h.child.memoizedState,U=U===null?Lw(k):{baseLanes:U.baseLanes|k,cachePool:null,transitions:U.transitions},$.memoizedState=U,$.childLanes=h.childLanes&~k,g.memoizedState=Pw,N}return $=h.child,h=$.sibling,N=qs($,{mode:"visible",children:N.children}),!(g.mode&1)&&(N.lanes=k),N.return=g,N.sibling=null,h!==null&&(k=g.deletions,k===null?(g.deletions=[h],g.flags|=16):k.push(h)),g.child=N,g.memoizedState=null,N}function Dw(h,g){return g=x0({mode:"visible",children:g},h.mode,0,null),g.return=h,h.child=g}function e0(h,g,k,N){return N!==null&&cw(N),Ac(g,h.child,null,k),h=Dw(g,g.pendingProps.children),h.flags|=2,g.memoizedState=null,h}function gj(h,g,k,N,T,$,U){if(k)return g.flags&256?(g.flags&=-257,N=$w(Error(i(422))),e0(h,g,U,N)):g.memoizedState!==null?(g.child=h.child,g.flags|=128,null):($=N.fallback,T=g.mode,N=x0({mode:"visible",children:N.children},T,0,null),$=pu($,T,U,null),$.flags|=2,N.return=g,$.return=g,N.sibling=$,g.child=N,g.mode&1&&Ac(g,h.child,null,U),g.child.memoizedState=Lw(U),g.memoizedState=Pw,$);if(!(g.mode&1))return e0(h,g,U,null);if(Cc(T))return N=J2(T).digest,$=Error(i(419)),N=$w($,N,void 0),e0(h,g,U,N);if(k=(U&h.childLanes)!==0,Ea||k){if(N=xr,N!==null){switch(U&-U){case 4:T=2;break;case 16:T=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:T=32;break;case 536870912:T=268435456;break;default:T=0}T=T&(N.suspendedLanes|U)?0:T,T!==0&&T!==$.retryLane&&($.retryLane=T,yo(h,T),hi(N,h,T,-1))}return nk(),N=$w(Error(i(421))),e0(h,g,U,N)}return Bp(T)?(g.flags|=128,g.child=h.child,g=Ej.bind(null,h),ew(T,g),null):(h=$.treeContext,Ie&&(Mr=Ta(T),Bn=g,Bt=!0,Wi=null,Qo=!1,h!==null&&(qt[hn++]=Vi,qt[hn++]=Rr,qt[hn++]=$r,Vi=h.id,Rr=h.overflow,$r=g)),g=Dw(g,N.children),g.flags|=4096,g)}function L_(h,g,k){h.lanes|=g;var N=h.alternate;N!==null&&(N.lanes|=g),fw(h.return,g,k)}function Fw(h,g,k,N,T){var $=h.memoizedState;$===null?h.memoizedState={isBackwards:g,rendering:null,renderingStartTime:0,last:N,tail:k,tailMode:T}:($.isBackwards=g,$.rendering=null,$.renderingStartTime=0,$.last=N,$.tail=k,$.tailMode=T)}function D_(h,g,k){var N=g.pendingProps,T=N.revealOrder,$=N.tail;if(ya(h,g,N.children,k),N=On.current,N&2)N=N&1|2,g.flags|=128;else{if(h!==null&&h.flags&128)e:for(h=g.child;h!==null;){if(h.tag===13)h.memoizedState!==null&&L_(h,k,g);else if(h.tag===19)L_(h,k,g);else if(h.child!==null){h.child.return=h,h=h.child;continue}if(h===g)break e;for(;h.sibling===null;){if(h.return===null||h.return===g)break e;h=h.return}h.sibling.return=h.return,h=h.sibling}N&=1}if(Qt(On,N),!(g.mode&1))g.memoizedState=null;else switch(T){case"forwards":for(k=g.child,T=null;k!==null;)h=k.alternate,h!==null&&Km(h)===null&&(T=k),k=k.sibling;k=T,k===null?(T=g.child,g.child=null):(T=k.sibling,k.sibling=null),Fw(g,!1,T,k,$);break;case"backwards":for(k=null,T=g.child,g.child=null;T!==null;){if(h=T.alternate,h!==null&&Km(h)===null){g.child=T;break}h=T.sibling,T.sibling=k,k=T,T=h}Fw(g,!0,k,null,$);break;case"together":Fw(g,!1,null,null,void 0);break;default:g.memoizedState=null}return g.child}function t0(h,g){!(g.mode&1)&&h!==null&&(h.alternate=null,g.alternate=null,g.flags|=2)}function Jo(h,g,k){if(h!==null&&(g.dependencies=h.dependencies),lu|=g.lanes,!(k&g.childLanes))return null;if(h!==null&&g.child!==h.child)throw Error(i(153));if(g.child!==null){for(h=g.child,k=qs(h,h.pendingProps),g.child=k,k.return=g;h.sibling!==null;)h=h.sibling,k=k.sibling=qs(h,h.pendingProps),k.return=g;k.sibling=null}return g.child}function mj(h,g,k){switch(g.tag){case 3:M_(g),$c();break;case 5:e_(g);break;case 1:qr(g.type)&&mo(g);break;case 4:vw(g,g.stateNode.containerInfo);break;case 10:VE(g,g.type._context,g.memoizedProps.value);break;case 13:var N=g.memoizedState;if(N!==null)return N.dehydrated!==null?(Qt(On,On.current&1),g.flags|=128,null):k&g.child.childLanes?P_(h,g,k):(Qt(On,On.current&1),h=Jo(h,g,k),h!==null?h.sibling:null);Qt(On,On.current&1);break;case 19:if(N=(k&g.childLanes)!==0,h.flags&128){if(N)return D_(h,g,k);g.flags|=128}var T=g.memoizedState;if(T!==null&&(T.rendering=null,T.tail=null,T.lastEffect=null),Qt(On,On.current),N)break;return null;case 22:case 23:return g.lanes=0,O_(h,g,k)}return Jo(h,g,k)}function xo(h){h.flags|=4}function F_(h,g){if(h!==null&&h.child===g.child)return!0;if(g.flags&16)return!1;for(h=g.child;h!==null;){if(h.flags&12854||h.subtreeFlags&12854)return!1;h=h.sibling}return!0}var Zp,Jp,n0,r0;if(ke)Zp=function(h,g){for(var k=g.child;k!==null;){if(k.tag===5||k.tag===6)ne(h,k.stateNode);else if(k.tag!==4&&k.child!==null){k.child.return=k,k=k.child;continue}if(k===g)break;for(;k.sibling===null;){if(k.return===null||k.return===g)return;k=k.return}k.sibling.return=k.return,k=k.sibling}},Jp=function(){},n0=function(h,g,k,N,T){if(h=h.memoizedProps,h!==N){var $=g.stateNode,U=bo(di.current);k=de($,k,h,N,T,U),(g.updateQueue=k)&&xo(g)}},r0=function(h,g,k,N){k!==N&&xo(g)};else if(Ne){Zp=function(h,g,k,N){for(var T=g.child;T!==null;){if(T.tag===5){var $=T.stateNode;k&&N&&($=Fp($,T.type,T.memoizedProps,T)),ne(h,$)}else if(T.tag===6)$=T.stateNode,k&&N&&($=Sc($,T.memoizedProps,T)),ne(h,$);else if(T.tag!==4){if(T.tag===22&&T.memoizedState!==null)$=T.child,$!==null&&($.return=T),Zp(h,T,!0,!0);else if(T.child!==null){T.child.return=T,T=T.child;continue}}if(T===g)break;for(;T.sibling===null;){if(T.return===null||T.return===g)return;T=T.return}T.sibling.return=T.return,T=T.sibling}};var B_=function(h,g,k,N){for(var T=g.child;T!==null;){if(T.tag===5){var $=T.stateNode;k&&N&&($=Fp($,T.type,T.memoizedProps,T)),Rm(h,$)}else if(T.tag===6)$=T.stateNode,k&&N&&($=Sc($,T.memoizedProps,T)),Rm(h,$);else if(T.tag!==4){if(T.tag===22&&T.memoizedState!==null)$=T.child,$!==null&&($.return=T),B_(h,T,!0,!0);else if(T.child!==null){T.child.return=T,T=T.child;continue}}if(T===g)break;for(;T.sibling===null;){if(T.return===null||T.return===g)return;T=T.return}T.sibling.return=T.return,T=T.sibling}};Jp=function(h,g){var k=g.stateNode;if(!F_(h,g)){h=k.containerInfo;var N=$m(h);B_(N,g,!1,!1),k.pendingChildren=N,xo(g),Dp(h,N)}},n0=function(h,g,k,N,T){var $=h.stateNode,U=h.memoizedProps;if((h=F_(h,g))&&U===N)g.stateNode=$;else{var oe=g.stateNode,ge=bo(di.current),Te=null;U!==N&&(Te=de(oe,k,U,N,T,ge)),h&&Te===null?g.stateNode=$:($=$t($,Te,k,U,N,g,h,oe),le($,k,N,T,ge)&&xo(g),g.stateNode=$,h?xo(g):Zp($,g,!1,!1))}},r0=function(h,g,k,N){k!==N?(h=bo(Pc.current),k=bo(di.current),g.stateNode=he(N,h,k,g),xo(g)):g.stateNode=h.stateNode}}else Jp=function(){},n0=function(){},r0=function(){};function eh(h,g){if(!Bt)switch(h.tailMode){case"hidden":g=h.tail;for(var k=null;g!==null;)g.alternate!==null&&(k=g),g=g.sibling;k===null?h.tail=null:k.sibling=null;break;case"collapsed":k=h.tail;for(var N=null;k!==null;)k.alternate!==null&&(N=k),k=k.sibling;N===null?g||h.tail===null?h.tail=null:h.tail.sibling=null:N.sibling=null}}function Yr(h){var g=h.alternate!==null&&h.alternate.child===h.child,k=0,N=0;if(g)for(var T=h.child;T!==null;)k|=T.lanes|T.childLanes,N|=T.subtreeFlags&14680064,N|=T.flags&14680064,T.return=h,T=T.sibling;else for(T=h.child;T!==null;)k|=T.lanes|T.childLanes,N|=T.subtreeFlags,N|=T.flags,T.return=h,T=T.sibling;return h.subtreeFlags|=N,h.childLanes=k,g}function yj(h,g,k){var N=g.pendingProps;switch(Yo(g),g.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Yr(g),null;case 1:return qr(g.type)&&_c(),Yr(g),null;case 3:return k=g.stateNode,Lc(),an(Hr),an(br),kw(),k.pendingContext&&(k.context=k.pendingContext,k.pendingContext=null),(h===null||h.child===null)&&(zm(g)?xo(g):h===null||h.memoizedState.isDehydrated&&!(g.flags&256)||(g.flags|=1024,Wi!==null&&(ek(Wi),Wi=null))),Jp(h,g),Yr(g),null;case 5:xw(g),k=bo(Pc.current);var T=g.type;if(h!==null&&g.stateNode!=null)n0(h,g,T,N,k),h.ref!==g.ref&&(g.flags|=512,g.flags|=2097152);else{if(!N){if(g.stateNode===null)throw Error(i(166));return Yr(g),null}if(h=bo(di.current),zm(g)){if(!Ie)throw Error(i(175));h=Tc(g.stateNode,g.type,g.memoizedProps,k,h,g,!Qo),g.updateQueue=h,h!==null&&xo(g)}else{var $=Q(T,N,k,h,g);Zp($,g,!1,!1),g.stateNode=$,le($,T,N,k,h)&&xo(g)}g.ref!==null&&(g.flags|=512,g.flags|=2097152)}return Yr(g),null;case 6:if(h&&g.stateNode!=null)r0(h,g,h.memoizedProps,N);else{if(typeof N!="string"&&g.stateNode===null)throw Error(i(166));if(h=bo(Pc.current),k=bo(di.current),zm(g)){if(!Ie)throw Error(i(176));if(h=g.stateNode,k=g.memoizedProps,(N=zp(h,k,g,!Qo))&&(T=Bn,T!==null))switch(T.tag){case 3:Dm(T.stateNode.containerInfo,h,k,(T.mode&1)!==0);break;case 5:jp(T.type,T.memoizedProps,T.stateNode,h,k,(T.mode&1)!==0)}N&&xo(g)}else g.stateNode=he(N,h,k,g)}return Yr(g),null;case 13:if(an(On),N=g.memoizedState,h===null||h.memoizedState!==null&&h.memoizedState.dehydrated!==null){if(Bt&&Mr!==null&&g.mode&1&&!(g.flags&128))jE(),$c(),g.flags|=98560,T=!1;else if(T=zm(g),N!==null&&N.dehydrated!==null){if(h===null){if(!T)throw Error(i(318));if(!Ie)throw Error(i(344));if(T=g.memoizedState,T=T!==null?T.dehydrated:null,!T)throw Error(i(317));nu(T,g)}else $c(),!(g.flags&128)&&(g.memoizedState=null),g.flags|=4;Yr(g),T=!1}else Wi!==null&&(ek(Wi),Wi=null),T=!0;if(!T)return g.flags&65536?g:null}return g.flags&128?(g.lanes=k,g):(k=N!==null,k!==(h!==null&&h.memoizedState!==null)&&k&&(g.child.flags|=8192,g.mode&1&&(h===null||On.current&1?sr===0&&(sr=3):nk())),g.updateQueue!==null&&(g.flags|=4),Yr(g),null);case 4:return Lc(),Jp(h,g),h===null&&He(g.stateNode.containerInfo),Yr(g),null;case 10:return hw(g.type._context),Yr(g),null;case 17:return qr(g.type)&&_c(),Yr(g),null;case 19:if(an(On),T=g.memoizedState,T===null)return Yr(g),null;if(N=(g.flags&128)!==0,$=T.rendering,$===null)if(N)eh(T,!1);else{if(sr!==0||h!==null&&h.flags&128)for(h=g.child;h!==null;){if($=Km(h),$!==null){for(g.flags|=128,eh(T,!1),h=$.updateQueue,h!==null&&(g.updateQueue=h,g.flags|=4),g.subtreeFlags=0,h=k,k=g.child;k!==null;)N=k,T=h,N.flags&=14680066,$=N.alternate,$===null?(N.childLanes=0,N.lanes=T,N.child=null,N.subtreeFlags=0,N.memoizedProps=null,N.memoizedState=null,N.updateQueue=null,N.dependencies=null,N.stateNode=null):(N.childLanes=$.childLanes,N.lanes=$.lanes,N.child=$.child,N.subtreeFlags=0,N.deletions=null,N.memoizedProps=$.memoizedProps,N.memoizedState=$.memoizedState,N.updateQueue=$.updateQueue,N.type=$.type,T=$.dependencies,N.dependencies=T===null?null:{lanes:T.lanes,firstContext:T.firstContext}),k=k.sibling;return Qt(On,On.current&1|2),g.child}h=h.sibling}T.tail!==null&&We()>Yw&&(g.flags|=128,N=!0,eh(T,!1),g.lanes=4194304)}else{if(!N)if(h=Km($),h!==null){if(g.flags|=128,N=!0,h=h.updateQueue,h!==null&&(g.updateQueue=h,g.flags|=4),eh(T,!0),T.tail===null&&T.tailMode==="hidden"&&!$.alternate&&!Bt)return Yr(g),null}else 2*We()-T.renderingStartTime>Yw&&k!==1073741824&&(g.flags|=128,N=!0,eh(T,!1),g.lanes=4194304);T.isBackwards?($.sibling=g.child,g.child=$):(h=T.last,h!==null?h.sibling=$:g.child=$,T.last=$)}return T.tail!==null?(g=T.tail,T.rendering=g,T.tail=g.sibling,T.renderingStartTime=We(),g.sibling=null,h=On.current,Qt(On,N?h&1|2:h&1),g):(Yr(g),null);case 22:case 23:return tk(),k=g.memoizedState!==null,h!==null&&h.memoizedState!==null!==k&&(g.flags|=8192),k&&g.mode&1?Ka&1073741824&&(Yr(g),ke&&g.subtreeFlags&6&&(g.flags|=8192)):Yr(g),null;case 24:return null;case 25:return null}throw Error(i(156,g.tag))}function bj(h,g){switch(Yo(g),g.tag){case 1:return qr(g.type)&&_c(),h=g.flags,h&65536?(g.flags=h&-65537|128,g):null;case 3:return Lc(),an(Hr),an(br),kw(),h=g.flags,h&65536&&!(h&128)?(g.flags=h&-65537|128,g):null;case 5:return xw(g),null;case 13:if(an(On),h=g.memoizedState,h!==null&&h.dehydrated!==null){if(g.alternate===null)throw Error(i(340));$c()}return h=g.flags,h&65536?(g.flags=h&-65537|128,g):null;case 19:return an(On),null;case 4:return Lc(),null;case 10:return hw(g.type._context),null;case 22:case 23:return tk(),null;case 24:return null;default:return null}}var a0=!1,Qr=!1,vj=typeof WeakSet=="function"?WeakSet:Set,Fe=null;function Fc(h,g){var k=h.ref;if(k!==null)if(typeof k=="function")try{k(null)}catch(N){Cn(h,g,N)}else k.current=null}function z_(h,g,k){try{k()}catch(N){Cn(h,g,N)}}var j_=!1;function xj(h,g){for(F(h.containerInfo),Fe=g;Fe!==null;)if(h=Fe,g=h.child,(h.subtreeFlags&1028)!==0&&g!==null)g.return=h,Fe=g;else for(;Fe!==null;){h=Fe;try{var k=h.alternate;if(h.flags&1024)switch(h.tag){case 0:case 11:case 15:break;case 1:if(k!==null){var N=k.memoizedProps,T=k.memoizedState,$=h.stateNode,U=$.getSnapshotBeforeUpdate(h.elementType===h.type?N:Ui(h.type,N),T);$.__reactInternalSnapshotBeforeUpdate=U}break;case 3:ke&&eu(h.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(i(163))}}catch(oe){Cn(h,h.return,oe)}if(g=h.sibling,g!==null){g.return=h.return,Fe=g;break}Fe=h.return}return k=j_,j_=!1,k}function th(h,g,k){var N=g.updateQueue;if(N=N!==null?N.lastEffect:null,N!==null){var T=N=N.next;do{if((T.tag&h)===h){var $=T.destroy;T.destroy=void 0,$!==void 0&&z_(g,k,$)}T=T.next}while(T!==N)}}function i0(h,g){if(g=g.updateQueue,g=g!==null?g.lastEffect:null,g!==null){var k=g=g.next;do{if((k.tag&h)===h){var N=k.create;k.destroy=N()}k=k.next}while(k!==g)}}function Bw(h){var g=h.ref;if(g!==null){var k=h.stateNode;switch(h.tag){case 5:h=X(k);break;default:h=k}typeof g=="function"?g(h):g.current=h}}function V_(h){var g=h.alternate;g!==null&&(h.alternate=null,V_(g)),h.child=null,h.deletions=null,h.sibling=null,h.tag===5&&(g=h.stateNode,g!==null&&it(g)),h.stateNode=null,h.return=null,h.dependencies=null,h.memoizedProps=null,h.memoizedState=null,h.pendingProps=null,h.stateNode=null,h.updateQueue=null}function W_(h){return h.tag===5||h.tag===3||h.tag===4}function U_(h){e:for(;;){for(;h.sibling===null;){if(h.return===null||W_(h.return))return null;h=h.return}for(h.sibling.return=h.return,h=h.sibling;h.tag!==5&&h.tag!==6&&h.tag!==18;){if(h.flags&2||h.child===null||h.tag===4)continue e;h.child.return=h,h=h.child}if(!(h.flags&2))return h.stateNode}}function zw(h,g,k){var N=h.tag;if(N===5||N===6)h=h.stateNode,g?rn(k,h,g):Ha(k,h);else if(N!==4&&(h=h.child,h!==null))for(zw(h,g,k),h=h.sibling;h!==null;)zw(h,g,k),h=h.sibling}function jw(h,g,k){var N=h.tag;if(N===5||N===6)h=h.stateNode,g?fo(k,h,g):yr(k,h);else if(N!==4&&(h=h.child,h!==null))for(jw(h,g,k),h=h.sibling;h!==null;)jw(h,g,k),h=h.sibling}var Ar=null,Gi=!1;function wo(h,g,k){for(k=k.child;k!==null;)Vw(h,g,k),k=k.sibling}function Vw(h,g,k){if(ut&&typeof ut.onCommitFiberUnmount=="function")try{ut.onCommitFiberUnmount(et,k)}catch{}switch(k.tag){case 5:Qr||Fc(k,g);case 6:if(ke){var N=Ar,T=Gi;Ar=null,wo(h,g,k),Ar=N,Gi=T,Ar!==null&&(Gi?Fs(Ar,k.stateNode):Bi(Ar,k.stateNode))}else wo(h,g,k);break;case 18:ke&&Ar!==null&&(Gi?iw(Ar,k.stateNode):Lm(Ar,k.stateNode));break;case 4:ke?(N=Ar,T=Gi,Ar=k.stateNode.containerInfo,Gi=!0,wo(h,g,k),Ar=N,Gi=T):(Ne&&(N=k.stateNode.containerInfo,T=$m(N),tu(N,T)),wo(h,g,k));break;case 0:case 11:case 14:case 15:if(!Qr&&(N=k.updateQueue,N!==null&&(N=N.lastEffect,N!==null))){T=N=N.next;do{var $=T,U=$.destroy;$=$.tag,U!==void 0&&($&2||$&4)&&z_(k,g,U),T=T.next}while(T!==N)}wo(h,g,k);break;case 1:if(!Qr&&(Fc(k,g),N=k.stateNode,typeof N.componentWillUnmount=="function"))try{N.props=k.memoizedProps,N.state=k.memoizedState,N.componentWillUnmount()}catch(oe){Cn(k,g,oe)}wo(h,g,k);break;case 21:wo(h,g,k);break;case 22:k.mode&1?(Qr=(N=Qr)||k.memoizedState!==null,wo(h,g,k),Qr=N):wo(h,g,k);break;default:wo(h,g,k)}}function G_(h){var g=h.updateQueue;if(g!==null){h.updateQueue=null;var k=h.stateNode;k===null&&(k=h.stateNode=new vj),g.forEach(function(N){var T=_j.bind(null,h,N);k.has(N)||(k.add(N),N.then(T,T))})}}function Hi(h,g){var k=g.deletions;if(k!==null)for(var N=0;N<k.length;N++){var T=k[N];try{var $=h,U=g;if(ke){var oe=U;e:for(;oe!==null;){switch(oe.tag){case 5:Ar=oe.stateNode,Gi=!1;break e;case 3:Ar=oe.stateNode.containerInfo,Gi=!0;break e;case 4:Ar=oe.stateNode.containerInfo,Gi=!0;break e}oe=oe.return}if(Ar===null)throw Error(i(160));Vw($,U,T),Ar=null,Gi=!1}else Vw($,U,T);var ge=T.alternate;ge!==null&&(ge.return=null),T.return=null}catch(Te){Cn(T,g,Te)}}if(g.subtreeFlags&12854)for(g=g.child;g!==null;)H_(g,h),g=g.sibling}function H_(h,g){var k=h.alternate,N=h.flags;switch(h.tag){case 0:case 11:case 14:case 15:if(Hi(g,h),ko(h),N&4){try{th(3,h,h.return),i0(3,h)}catch(Ae){Cn(h,h.return,Ae)}try{th(5,h,h.return)}catch(Ae){Cn(h,h.return,Ae)}}break;case 1:Hi(g,h),ko(h),N&512&&k!==null&&Fc(k,k.return);break;case 5:if(Hi(g,h),ko(h),N&512&&k!==null&&Fc(k,k.return),ke){if(h.flags&32){var T=h.stateNode;try{go(T)}catch(Ae){Cn(h,h.return,Ae)}}if(N&4&&(T=h.stateNode,T!=null)){var $=h.memoizedProps;if(k=k!==null?k.memoizedProps:$,N=h.type,g=h.updateQueue,h.updateQueue=null,g!==null)try{Ds(T,g,N,k,$,h)}catch(Ae){Cn(h,h.return,Ae)}}}break;case 6:if(Hi(g,h),ko(h),N&4&&ke){if(h.stateNode===null)throw Error(i(162));T=h.stateNode,$=h.memoizedProps,k=k!==null?k.memoizedProps:$;try{Or(T,k,$)}catch(Ae){Cn(h,h.return,Ae)}}break;case 3:if(Hi(g,h),ko(h),N&4){if(ke&&Ie&&k!==null&&k.memoizedState.isDehydrated)try{rw(g.containerInfo)}catch(Ae){Cn(h,h.return,Ae)}if(Ne){T=g.containerInfo,$=g.pendingChildren;try{tu(T,$)}catch(Ae){Cn(h,h.return,Ae)}}}break;case 4:if(Hi(g,h),ko(h),N&4&&Ne){$=h.stateNode,T=$.containerInfo,$=$.pendingChildren;try{tu(T,$)}catch(Ae){Cn(h,h.return,Ae)}}break;case 13:Hi(g,h),ko(h),T=h.child,T.flags&8192&&($=T.memoizedState!==null,T.stateNode.isHidden=$,!$||T.alternate!==null&&T.alternate.memoizedState!==null||(Xw=We())),N&4&&G_(h);break;case 22:var U=k!==null&&k.memoizedState!==null;if(h.mode&1?(Qr=(k=Qr)||U,Hi(g,h),Qr=k):Hi(g,h),ko(h),N&8192){if(k=h.memoizedState!==null,(h.stateNode.isHidden=k)&&!U&&h.mode&1)for(Fe=h,N=h.child;N!==null;){for(g=Fe=N;Fe!==null;){U=Fe;var oe=U.child;switch(U.tag){case 0:case 11:case 14:case 15:th(4,U,U.return);break;case 1:Fc(U,U.return);var ge=U.stateNode;if(typeof ge.componentWillUnmount=="function"){var Te=U,Ve=U.return;try{var ht=Te;ge.props=ht.memoizedProps,ge.state=ht.memoizedState,ge.componentWillUnmount()}catch(Ae){Cn(Te,Ve,Ae)}}break;case 5:Fc(U,U.return);break;case 22:if(U.memoizedState!==null){X_(g);continue}}oe!==null?(oe.return=U,Fe=oe):X_(g)}N=N.sibling}if(ke){e:if(N=null,ke)for(g=h;;){if(g.tag===5){if(N===null){N=g;try{T=g.stateNode,k?Pp(T):Lp(g.stateNode,g.memoizedProps)}catch(Ae){Cn(h,h.return,Ae)}}}else if(g.tag===6){if(N===null)try{$=g.stateNode,k?Na($):Om($,g.memoizedProps)}catch(Ae){Cn(h,h.return,Ae)}}else if((g.tag!==22&&g.tag!==23||g.memoizedState===null||g===h)&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===h)break e;for(;g.sibling===null;){if(g.return===null||g.return===h)break e;N===g&&(N=null),g=g.return}N===g&&(N=null),g.sibling.return=g.return,g=g.sibling}}}break;case 19:Hi(g,h),ko(h),N&4&&G_(h);break;case 21:break;default:Hi(g,h),ko(h)}}function ko(h){var g=h.flags;if(g&2){try{if(ke){e:{for(var k=h.return;k!==null;){if(W_(k)){var N=k;break e}k=k.return}throw Error(i(160))}switch(N.tag){case 5:var T=N.stateNode;N.flags&32&&(go(T),N.flags&=-33);var $=U_(h);jw(h,$,T);break;case 3:case 4:var U=N.stateNode.containerInfo,oe=U_(h);zw(h,oe,U);break;default:throw Error(i(161))}}}catch(ge){Cn(h,h.return,ge)}h.flags&=-3}g&4096&&(h.flags&=-4097)}function wj(h,g,k){Fe=h,q_(h)}function q_(h,g,k){for(var N=(h.mode&1)!==0;Fe!==null;){var T=Fe,$=T.child;if(T.tag===22&&N){var U=T.memoizedState!==null||a0;if(!U){var oe=T.alternate,ge=oe!==null&&oe.memoizedState!==null||Qr;oe=a0;var Te=Qr;if(a0=U,(Qr=ge)&&!Te)for(Fe=T;Fe!==null;)U=Fe,ge=U.child,U.tag===22&&U.memoizedState!==null?Y_(T):ge!==null?(ge.return=U,Fe=ge):Y_(T);for(;$!==null;)Fe=$,q_($),$=$.sibling;Fe=T,a0=oe,Qr=Te}K_(h)}else T.subtreeFlags&8772&&$!==null?($.return=T,Fe=$):K_(h)}}function K_(h){for(;Fe!==null;){var g=Fe;if(g.flags&8772){var k=g.alternate;try{if(g.flags&8772)switch(g.tag){case 0:case 11:case 15:Qr||i0(5,g);break;case 1:var N=g.stateNode;if(g.flags&4&&!Qr)if(k===null)N.componentDidMount();else{var T=g.elementType===g.type?k.memoizedProps:Ui(g.type,k.memoizedProps);N.componentDidUpdate(T,k.memoizedState,N.__reactInternalSnapshotBeforeUpdate)}var $=g.updateQueue;$!==null&&HE(g,$,N);break;case 3:var U=g.updateQueue;if(U!==null){if(k=null,g.child!==null)switch(g.child.tag){case 5:k=X(g.child.stateNode);break;case 1:k=g.child.stateNode}HE(g,U,k)}break;case 5:var oe=g.stateNode;k===null&&g.flags&4&&Fi(oe,g.type,g.memoizedProps,g);break;case 6:break;case 4:break;case 12:break;case 13:if(Ie&&g.memoizedState===null){var ge=g.alternate;if(ge!==null){var Te=ge.memoizedState;if(Te!==null){var Ve=Te.dehydrated;Ve!==null&&aw(Ve)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(i(163))}Qr||g.flags&512&&Bw(g)}catch(ht){Cn(g,g.return,ht)}}if(g===h){Fe=null;break}if(k=g.sibling,k!==null){k.return=g.return,Fe=k;break}Fe=g.return}}function X_(h){for(;Fe!==null;){var g=Fe;if(g===h){Fe=null;break}var k=g.sibling;if(k!==null){k.return=g.return,Fe=k;break}Fe=g.return}}function Y_(h){for(;Fe!==null;){var g=Fe;try{switch(g.tag){case 0:case 11:case 15:var k=g.return;try{i0(4,g)}catch(ge){Cn(g,k,ge)}break;case 1:var N=g.stateNode;if(typeof N.componentDidMount=="function"){var T=g.return;try{N.componentDidMount()}catch(ge){Cn(g,T,ge)}}var $=g.return;try{Bw(g)}catch(ge){Cn(g,$,ge)}break;case 5:var U=g.return;try{Bw(g)}catch(ge){Cn(g,U,ge)}}}catch(ge){Cn(g,g.return,ge)}if(g===h){Fe=null;break}var oe=g.sibling;if(oe!==null){oe.return=g.return,Fe=oe;break}Fe=g.return}}var o0=0,s0=1,l0=2,u0=3,c0=4;if(typeof Symbol=="function"&&Symbol.for){var nh=Symbol.for;o0=nh("selector.component"),s0=nh("selector.has_pseudo_class"),l0=nh("selector.role"),u0=nh("selector.test_id"),c0=nh("selector.text")}function Ww(h){var g=Le(h);if(g!=null){if(typeof g.memoizedProps["data-testname"]!="string")throw Error(i(364));return g}if(h=Xt(h),h===null)throw Error(i(362));return h.stateNode.current}function Uw(h,g){switch(g.$$typeof){case o0:if(h.type===g.value)return!0;break;case s0:e:{g=g.value,h=[h,0];for(var k=0;k<h.length;){var N=h[k++],T=h[k++],$=g[T];if(N.tag!==5||!Yt(N)){for(;$!=null&&Uw(N,$);)T++,$=g[T];if(T===g.length){g=!0;break e}else for(N=N.child;N!==null;)h.push(N,T),N=N.sibling}}g=!1}return g;case l0:if(h.tag===5&&Wt(h.stateNode,g.value))return!0;break;case c0:if((h.tag===5||h.tag===6)&&(h=Ht(h),h!==null&&0<=h.indexOf(g.value)))return!0;break;case u0:if(h.tag===5&&(h=h.memoizedProps["data-testname"],typeof h=="string"&&h.toLowerCase()===g.value.toLowerCase()))return!0;break;default:throw Error(i(365))}return!1}function Gw(h){switch(h.$$typeof){case o0:return"<"+(I(h.value)||"Unknown")+">";case s0:return":has("+(Gw(h)||"")+")";case l0:return'[role="'+h.value+'"]';case c0:return'"'+h.value+'"';case u0:return'[data-testname="'+h.value+'"]';default:throw Error(i(365))}}function Q_(h,g){var k=[];h=[h,0];for(var N=0;N<h.length;){var T=h[N++],$=h[N++],U=g[$];if(T.tag!==5||!Yt(T)){for(;U!=null&&Uw(T,U);)$++,U=g[$];if($===g.length)k.push(T);else for(T=T.child;T!==null;)h.push(T,$),T=T.sibling}}return k}function Hw(h,g){if(!Qe)throw Error(i(363));h=Ww(h),h=Q_(h,g),g=[],h=Array.from(h);for(var k=0;k<h.length;){var N=h[k++];if(N.tag===5)Yt(N)||g.push(N.stateNode);else for(N=N.child;N!==null;)h.push(N),N=N.sibling}return g}var kj=Math.ceil,d0=o.ReactCurrentDispatcher,qw=o.ReactCurrentOwner,qn=o.ReactCurrentBatchConfig,Ct=0,xr=null,er=null,Pr=0,Ka=0,Bc=li(0),sr=0,rh=null,lu=0,p0=0,Kw=0,ah=null,_a=null,Xw=0,Yw=1/0,es=null;function zc(){Yw=We()+500}var h0=!1,Qw=null,Ws=null,f0=!1,Us=null,g0=0,ih=0,Zw=null,m0=-1,y0=0;function Zr(){return Ct&6?We():m0!==-1?m0:m0=We()}function Gs(h){return h.mode&1?Ct&2&&Pr!==0?Pr&-Pr:aj.transition!==null?(y0===0&&(y0=ae()),y0):(h=Ce,h!==0?h:Me()):1}function hi(h,g,k,N){if(50<ih)throw ih=0,Zw=null,Error(i(185));we(h,k,N),(!(Ct&2)||h!==xr)&&(h===xr&&(!(Ct&2)&&(p0|=k),sr===4&&Hs(h,Pr)),Oa(h,N),k===1&&Ct===0&&!(g.mode&1)&&(zc(),yn&&Qn()))}function Oa(h,g){var k=h.callbackNode;W(h,g);var N=Ko(h,h===xr?Pr:0);if(N===0)k!==null&&Ke(k),h.callbackNode=null,h.callbackPriority=0;else if(g=N&-N,h.callbackPriority!==g){if(k!=null&&Ke(k),g===1)h.tag===0?ji(J_.bind(null,h)):ga(J_.bind(null,h)),Ye?Ze(function(){!(Ct&6)&&Qn()}):st(tt,Qn),k=null;else{switch(De(N)){case 1:k=tt;break;case 4:k=rt;break;case 16:k=Xe;break;case 536870912:k=dt;break;default:k=Xe}k=l5(k,Z_.bind(null,h))}h.callbackPriority=g,h.callbackNode=k}}function Z_(h,g){if(m0=-1,y0=0,Ct&6)throw Error(i(327));var k=h.callbackNode;if(du()&&h.callbackNode!==k)return null;var N=Ko(h,h===xr?Pr:0);if(N===0)return null;if(N&30||N&h.expiredLanes||g)g=b0(h,N);else{g=N;var T=Ct;Ct|=2;var $=n5();(xr!==h||Pr!==g)&&(es=null,zc(),uu(h,g));do try{Nj();break}catch(oe){t5(h,oe)}while(!0);pw(),d0.current=$,Ct=T,er!==null?g=0:(xr=null,Pr=0,g=sr)}if(g!==0){if(g===2&&(T=J(h),T!==0&&(N=T,g=Jw(h,T))),g===1)throw k=rh,uu(h,0),Hs(h,N),Oa(h,We()),k;if(g===6)Hs(h,N);else{if(T=h.current.alternate,!(N&30)&&!Sj(T)&&(g=b0(h,N),g===2&&($=J(h),$!==0&&(N=$,g=Jw(h,$))),g===1))throw k=rh,uu(h,0),Hs(h,N),Oa(h,We()),k;switch(h.finishedWork=T,h.finishedLanes=N,g){case 0:case 1:throw Error(i(345));case 2:cu(h,_a,es);break;case 3:if(Hs(h,N),(N&130023424)===N&&(g=Xw+500-We(),10<g)){if(Ko(h,0)!==0)break;if(T=h.suspendedLanes,(T&N)!==N){Zr(),h.pingedLanes|=h.suspendedLanes&T;break}h.timeoutHandle=ve(cu.bind(null,h,_a,es),g);break}cu(h,_a,es);break;case 4:if(Hs(h,N),(N&4194240)===N)break;for(g=h.eventTimes,T=-1;0<N;){var U=31-qa(N);$=1<<U,U=g[U],U>T&&(T=U),N&=~$}if(N=T,N=We()-N,N=(120>N?120:480>N?480:1080>N?1080:1920>N?1920:3e3>N?3e3:4320>N?4320:1960*kj(N/1960))-N,10<N){h.timeoutHandle=ve(cu.bind(null,h,_a,es),N);break}cu(h,_a,es);break;case 5:cu(h,_a,es);break;default:throw Error(i(329))}}}return Oa(h,We()),h.callbackNode===k?Z_.bind(null,h):null}function Jw(h,g){var k=ah;return h.current.memoizedState.isDehydrated&&(uu(h,g).flags|=256),h=b0(h,g),h!==2&&(g=_a,_a=k,g!==null&&ek(g)),h}function ek(h){_a===null?_a=h:_a.push.apply(_a,h)}function Sj(h){for(var g=h;;){if(g.flags&16384){var k=g.updateQueue;if(k!==null&&(k=k.stores,k!==null))for(var N=0;N<k.length;N++){var T=k[N],$=T.getSnapshot;T=T.value;try{if(!It($(),T))return!1}catch{return!1}}}if(k=g.child,g.subtreeFlags&16384&&k!==null)k.return=g,g=k;else{if(g===h)break;for(;g.sibling===null;){if(g.return===null||g.return===h)return!0;g=g.return}g.sibling.return=g.return,g=g.sibling}}return!0}function Hs(h,g){for(g&=~Kw,g&=~p0,h.suspendedLanes|=g,h.pingedLanes&=~g,h=h.expirationTimes;0<g;){var k=31-qa(g),N=1<<k;h[k]=-1,g&=~N}}function J_(h){if(Ct&6)throw Error(i(327));du();var g=Ko(h,0);if(!(g&1))return Oa(h,We()),null;var k=b0(h,g);if(h.tag!==0&&k===2){var N=J(h);N!==0&&(g=N,k=Jw(h,N))}if(k===1)throw k=rh,uu(h,0),Hs(h,g),Oa(h,We()),k;if(k===6)throw Error(i(345));return h.finishedWork=h.current.alternate,h.finishedLanes=g,cu(h,_a,es),Oa(h,We()),null}function e5(h){Us!==null&&Us.tag===0&&!(Ct&6)&&du();var g=Ct;Ct|=1;var k=qn.transition,N=Ce;try{if(qn.transition=null,Ce=1,h)return h()}finally{Ce=N,qn.transition=k,Ct=g,!(Ct&6)&&Qn()}}function tk(){Ka=Bc.current,an(Bc)}function uu(h,g){h.finishedWork=null,h.finishedLanes=0;var k=h.timeoutHandle;if(k!==ie&&(h.timeoutHandle=ie,H(k)),er!==null)for(k=er.return;k!==null;){var N=k;switch(Yo(N),N.tag){case 1:N=N.type.childContextTypes,N!=null&&_c();break;case 3:Lc(),an(Hr),an(br),kw();break;case 5:xw(N);break;case 4:Lc();break;case 13:an(On);break;case 19:an(On);break;case 10:hw(N.type._context);break;case 22:case 23:tk()}k=k.return}if(xr=h,er=h=qs(h.current,null),Pr=Ka=g,sr=0,rh=null,Kw=p0=lu=0,_a=ah=null,ou!==null){for(g=0;g<ou.length;g++)if(k=ou[g],N=k.interleaved,N!==null){k.interleaved=null;var T=N.next,$=k.pending;if($!==null){var U=$.next;$.next=T,N.next=U}k.pending=N}ou=null}return h}function t5(h,g){do{var k=er;try{if(pw(),Xm.current=Jm,Ym){for(var N=$n.memoizedState;N!==null;){var T=N.queue;T!==null&&(T.pending=null),N=N.next}Ym=!1}if(su=0,vr=or=$n=null,Kp=!1,Xp=0,qw.current=null,k===null||k.return===null){sr=1,rh=g,er=null;break}e:{var $=h,U=k.return,oe=k,ge=g;if(g=Pr,oe.flags|=32768,ge!==null&&typeof ge=="object"&&typeof ge.then=="function"){var Te=ge,Ve=oe,ht=Ve.tag;if(!(Ve.mode&1)&&(ht===0||ht===11||ht===15)){var Ae=Ve.alternate;Ae?(Ve.updateQueue=Ae.updateQueue,Ve.memoizedState=Ae.memoizedState,Ve.lanes=Ae.lanes):(Ve.updateQueue=null,Ve.memoizedState=null)}var bn=N_(U);if(bn!==null){bn.flags&=-257,T_(bn,U,oe,$,g),bn.mode&1&&C_($,Te,g),g=bn,ge=Te;var on=g.updateQueue;if(on===null){var $a=new Set;$a.add(ge),g.updateQueue=$a}else on.add(ge);break e}else{if(!(g&1)){C_($,Te,g),nk();break e}ge=Error(i(426))}}else if(Bt&&oe.mode&1){var ts=N_(U);if(ts!==null){!(ts.flags&65536)&&(ts.flags|=256),T_(ts,U,oe,$,g),cw(Dc(ge,oe));break e}}$=ge=Dc(ge,oe),sr!==4&&(sr=2),ah===null?ah=[$]:ah.push($),$=U;do{switch($.tag){case 3:$.flags|=65536,g&=-g,$.lanes|=g;var fe=k_($,ge,g);GE($,fe);break e;case 1:oe=ge;var ue=$.type,be=$.stateNode;if(!($.flags&128)&&(typeof ue.getDerivedStateFromError=="function"||be!==null&&typeof be.componentDidCatch=="function"&&(Ws===null||!Ws.has(be)))){$.flags|=65536,g&=-g,$.lanes|=g;var Pe=S_($,oe,g);GE($,Pe);break e}}$=$.return}while($!==null)}a5(k)}catch(nt){g=nt,er===k&&k!==null&&(er=k=k.return);continue}break}while(!0)}function n5(){var h=d0.current;return d0.current=Jm,h===null?Jm:h}function nk(){(sr===0||sr===3||sr===2)&&(sr=4),xr===null||!(lu&268435455)&&!(p0&268435455)||Hs(xr,Pr)}function b0(h,g){var k=Ct;Ct|=2;var N=n5();(xr!==h||Pr!==g)&&(es=null,uu(h,g));do try{Cj();break}catch(T){t5(h,T)}while(!0);if(pw(),Ct=k,d0.current=N,er!==null)throw Error(i(261));return xr=null,Pr=0,sr}function Cj(){for(;er!==null;)r5(er)}function Nj(){for(;er!==null&&!bt();)r5(er)}function r5(h){var g=s5(h.alternate,h,Ka);h.memoizedProps=h.pendingProps,g===null?a5(h):er=g,qw.current=null}function a5(h){var g=h;do{var k=g.alternate;if(h=g.return,g.flags&32768){if(k=bj(k,g),k!==null){k.flags&=32767,er=k;return}if(h!==null)h.flags|=32768,h.subtreeFlags=0,h.deletions=null;else{sr=6,er=null;return}}else if(k=yj(k,g,Ka),k!==null){er=k;return}if(g=g.sibling,g!==null){er=g;return}er=g=h}while(g!==null);sr===0&&(sr=5)}function cu(h,g,k){var N=Ce,T=qn.transition;try{qn.transition=null,Ce=1,Tj(h,g,k,N)}finally{qn.transition=T,Ce=N}return null}function Tj(h,g,k,N){do du();while(Us!==null);if(Ct&6)throw Error(i(327));k=h.finishedWork;var T=h.finishedLanes;if(k===null)return null;if(h.finishedWork=null,h.finishedLanes=0,k===h.current)throw Error(i(177));h.callbackNode=null,h.callbackPriority=0;var $=k.lanes|k.childLanes;if(Oe(h,$),h===xr&&(er=xr=null,Pr=0),!(k.subtreeFlags&2064)&&!(k.flags&2064)||f0||(f0=!0,l5(Xe,function(){return du(),null})),$=(k.flags&15990)!==0,k.subtreeFlags&15990||$){$=qn.transition,qn.transition=null;var U=Ce;Ce=1;var oe=Ct;Ct|=4,qw.current=null,xj(h,k),H_(k,h),Y(h.containerInfo),h.current=k,wj(k),ct(),Ct=oe,Ce=U,qn.transition=$}else h.current=k;if(f0&&(f0=!1,Us=h,g0=T),$=h.pendingLanes,$===0&&(Ws=null),Fn(k.stateNode),Oa(h,We()),g!==null)for(N=h.onRecoverableError,k=0;k<g.length;k++)T=g[k],N(T.value,{componentStack:T.stack,digest:T.digest});if(h0)throw h0=!1,h=Qw,Qw=null,h;return g0&1&&h.tag!==0&&du(),$=h.pendingLanes,$&1?h===Zw?ih++:(ih=0,Zw=h):ih=0,Qn(),null}function du(){if(Us!==null){var h=De(g0),g=qn.transition,k=Ce;try{if(qn.transition=null,Ce=16>h?16:h,Us===null)var N=!1;else{if(h=Us,Us=null,g0=0,Ct&6)throw Error(i(331));var T=Ct;for(Ct|=4,Fe=h.current;Fe!==null;){var $=Fe,U=$.child;if(Fe.flags&16){var oe=$.deletions;if(oe!==null){for(var ge=0;ge<oe.length;ge++){var Te=oe[ge];for(Fe=Te;Fe!==null;){var Ve=Fe;switch(Ve.tag){case 0:case 11:case 15:th(8,Ve,$)}var ht=Ve.child;if(ht!==null)ht.return=Ve,Fe=ht;else for(;Fe!==null;){Ve=Fe;var Ae=Ve.sibling,bn=Ve.return;if(V_(Ve),Ve===Te){Fe=null;break}if(Ae!==null){Ae.return=bn,Fe=Ae;break}Fe=bn}}}var on=$.alternate;if(on!==null){var $a=on.child;if($a!==null){on.child=null;do{var ts=$a.sibling;$a.sibling=null,$a=ts}while($a!==null)}}Fe=$}}if($.subtreeFlags&2064&&U!==null)U.return=$,Fe=U;else e:for(;Fe!==null;){if($=Fe,$.flags&2048)switch($.tag){case 0:case 11:case 15:th(9,$,$.return)}var fe=$.sibling;if(fe!==null){fe.return=$.return,Fe=fe;break e}Fe=$.return}}var ue=h.current;for(Fe=ue;Fe!==null;){U=Fe;var be=U.child;if(U.subtreeFlags&2064&&be!==null)be.return=U,Fe=be;else e:for(U=ue;Fe!==null;){if(oe=Fe,oe.flags&2048)try{switch(oe.tag){case 0:case 11:case 15:i0(9,oe)}}catch(nt){Cn(oe,oe.return,nt)}if(oe===U){Fe=null;break e}var Pe=oe.sibling;if(Pe!==null){Pe.return=oe.return,Fe=Pe;break e}Fe=oe.return}}if(Ct=T,Qn(),ut&&typeof ut.onPostCommitFiberRoot=="function")try{ut.onPostCommitFiberRoot(et,h)}catch{}N=!0}return N}finally{Ce=k,qn.transition=g}}return!1}function i5(h,g,k){g=Dc(k,g),g=k_(h,g,1),h=Vs(h,g,1),g=Zr(),h!==null&&(we(h,1,g),Oa(h,g))}function Cn(h,g,k){if(h.tag===3)i5(h,h,k);else for(;g!==null;){if(g.tag===3){i5(g,h,k);break}else if(g.tag===1){var N=g.stateNode;if(typeof g.type.getDerivedStateFromError=="function"||typeof N.componentDidCatch=="function"&&(Ws===null||!Ws.has(N))){h=Dc(k,h),h=S_(g,h,1),g=Vs(g,h,1),h=Zr(),g!==null&&(we(g,1,h),Oa(g,h));break}}g=g.return}}function Ij(h,g,k){var N=h.pingCache;N!==null&&N.delete(g),g=Zr(),h.pingedLanes|=h.suspendedLanes&k,xr===h&&(Pr&k)===k&&(sr===4||sr===3&&(Pr&130023424)===Pr&&500>We()-Xw?uu(h,0):Kw|=k),Oa(h,g)}function o5(h,g){g===0&&(h.mode&1?(g=qo,qo<<=1,!(qo&130023424)&&(qo=4194304)):g=1);var k=Zr();h=yo(h,g),h!==null&&(we(h,g,k),Oa(h,k))}function Ej(h){var g=h.memoizedState,k=0;g!==null&&(k=g.retryLane),o5(h,k)}function _j(h,g){var k=0;switch(h.tag){case 13:var N=h.stateNode,T=h.memoizedState;T!==null&&(k=T.retryLane);break;case 19:N=h.stateNode;break;default:throw Error(i(314))}N!==null&&N.delete(g),o5(h,k)}var s5;s5=function(h,g,k){if(h!==null)if(h.memoizedProps!==g.pendingProps||Hr.current)Ea=!0;else{if(!(h.lanes&k)&&!(g.flags&128))return Ea=!1,mj(h,g,k);Ea=!!(h.flags&131072)}else Ea=!1,Bt&&g.flags&1048576&&Up(g,Jn,g.index);switch(g.lanes=0,g.tag){case 2:var N=g.type;t0(h,g),h=g.pendingProps;var T=zs(g,br.current);Mc(g,k),T=Nw(null,g,N,h,T,k);var $=Tw();return g.flags|=1,typeof T=="object"&&T!==null&&typeof T.render=="function"&&T.$$typeof===void 0?(g.tag=1,g.memoizedState=null,g.updateQueue=null,qr(N)?($=!0,mo(g)):$=!1,g.memoizedState=T.state!==null&&T.state!==void 0?T.state:null,mw(g),T.updater=Hm,g.stateNode=T,T._reactInternals=g,bw(g,N,h,k),g=Aw(null,g,N,!0,$,k)):(g.tag=0,Bt&&$&&ma(g),ya(null,g,T,k),g=g.child),g;case 16:N=g.elementType;e:{switch(t0(h,g),h=g.pendingProps,T=N._init,N=T(N._payload),g.type=N,T=g.tag=$j(N),h=Ui(N,h),T){case 0:g=Mw(null,g,N,h,k);break e;case 1:g=R_(null,g,N,h,k);break e;case 11:g=I_(null,g,N,h,k);break e;case 14:g=E_(null,g,N,Ui(N.type,h),k);break e}throw Error(i(306,N,""))}return g;case 0:return N=g.type,T=g.pendingProps,T=g.elementType===N?T:Ui(N,T),Mw(h,g,N,T,k);case 1:return N=g.type,T=g.pendingProps,T=g.elementType===N?T:Ui(N,T),R_(h,g,N,T,k);case 3:e:{if(M_(g),h===null)throw Error(i(387));N=g.pendingProps,$=g.memoizedState,T=$.element,UE(h,g),Gm(g,N,null,k);var U=g.memoizedState;if(N=U.element,Ie&&$.isDehydrated)if($={element:N,isDehydrated:!1,cache:U.cache,pendingSuspenseBoundaries:U.pendingSuspenseBoundaries,transitions:U.transitions},g.updateQueue.baseState=$,g.memoizedState=$,g.flags&256){T=Dc(Error(i(423)),g),g=A_(h,g,N,k,T);break e}else if(N!==T){T=Dc(Error(i(424)),g),g=A_(h,g,N,k,T);break e}else for(Ie&&(Mr=tw(g.stateNode.containerInfo),Bn=g,Bt=!0,Wi=null,Qo=!1),k=JE(g,null,N,k),g.child=k;k;)k.flags=k.flags&-3|4096,k=k.sibling;else{if($c(),N===T){g=Jo(h,g,k);break e}ya(h,g,N,k)}g=g.child}return g;case 5:return e_(g),h===null&&uw(g),N=g.type,T=g.pendingProps,$=h!==null?h.memoizedProps:null,U=T.children,re(N,T)?U=null:$!==null&&re(N,$)&&(g.flags|=32),$_(h,g),ya(h,g,U,k),g.child;case 6:return h===null&&uw(g),null;case 13:return P_(h,g,k);case 4:return vw(g,g.stateNode.containerInfo),N=g.pendingProps,h===null?g.child=Ac(g,null,N,k):ya(h,g,N,k),g.child;case 11:return N=g.type,T=g.pendingProps,T=g.elementType===N?T:Ui(N,T),I_(h,g,N,T,k);case 7:return ya(h,g,g.pendingProps,k),g.child;case 8:return ya(h,g,g.pendingProps.children,k),g.child;case 12:return ya(h,g,g.pendingProps.children,k),g.child;case 10:e:{if(N=g.type._context,T=g.pendingProps,$=g.memoizedProps,U=T.value,VE(g,N,U),$!==null)if(It($.value,U)){if($.children===T.children&&!Hr.current){g=Jo(h,g,k);break e}}else for($=g.child,$!==null&&($.return=g);$!==null;){var oe=$.dependencies;if(oe!==null){U=$.child;for(var ge=oe.firstContext;ge!==null;){if(ge.context===N){if($.tag===1){ge=Zo(-1,k&-k),ge.tag=2;var Te=$.updateQueue;if(Te!==null){Te=Te.shared;var Ve=Te.pending;Ve===null?ge.next=ge:(ge.next=Ve.next,Ve.next=ge),Te.pending=ge}}$.lanes|=k,ge=$.alternate,ge!==null&&(ge.lanes|=k),fw($.return,k,g),oe.lanes|=k;break}ge=ge.next}}else if($.tag===10)U=$.type===g.type?null:$.child;else if($.tag===18){if(U=$.return,U===null)throw Error(i(341));U.lanes|=k,oe=U.alternate,oe!==null&&(oe.lanes|=k),fw(U,k,g),U=$.sibling}else U=$.child;if(U!==null)U.return=$;else for(U=$;U!==null;){if(U===g){U=null;break}if($=U.sibling,$!==null){$.return=U.return,U=$;break}U=U.return}$=U}ya(h,g,T.children,k),g=g.child}return g;case 9:return T=g.type,N=g.pendingProps.children,Mc(g,k),T=ci(T),N=N(T),g.flags|=1,ya(h,g,N,k),g.child;case 14:return N=g.type,T=Ui(N,g.pendingProps),T=Ui(N.type,T),E_(h,g,N,T,k);case 15:return __(h,g,g.type,g.pendingProps,k);case 17:return N=g.type,T=g.pendingProps,T=g.elementType===N?T:Ui(N,T),t0(h,g),g.tag=1,qr(N)?(h=!0,mo(g)):h=!1,Mc(g,k),XE(g,N,T),bw(g,N,T,k),Aw(null,g,N,!0,h,k);case 19:return D_(h,g,k);case 22:return O_(h,g,k)}throw Error(i(156,g.tag))};function l5(h,g){return st(h,g)}function Oj(h,g,k,N){this.tag=h,this.key=k,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=g,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=N,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function fi(h,g,k,N){return new Oj(h,g,k,N)}function rk(h){return h=h.prototype,!(!h||!h.isReactComponent)}function $j(h){if(typeof h=="function")return rk(h)?1:0;if(h!=null){if(h=h.$$typeof,h===m)return 11;if(h===b)return 14}return 2}function qs(h,g){var k=h.alternate;return k===null?(k=fi(h.tag,g,h.key,h.mode),k.elementType=h.elementType,k.type=h.type,k.stateNode=h.stateNode,k.alternate=h,h.alternate=k):(k.pendingProps=g,k.type=h.type,k.flags=0,k.subtreeFlags=0,k.deletions=null),k.flags=h.flags&14680064,k.childLanes=h.childLanes,k.lanes=h.lanes,k.child=h.child,k.memoizedProps=h.memoizedProps,k.memoizedState=h.memoizedState,k.updateQueue=h.updateQueue,g=h.dependencies,k.dependencies=g===null?null:{lanes:g.lanes,firstContext:g.firstContext},k.sibling=h.sibling,k.index=h.index,k.ref=h.ref,k}function v0(h,g,k,N,T,$){var U=2;if(N=h,typeof h=="function")rk(h)&&(U=1);else if(typeof h=="string")U=5;else e:switch(h){case u:return pu(k.children,T,$,g);case c:U=8,T|=8;break;case d:return h=fi(12,k,g,T|2),h.elementType=d,h.lanes=$,h;case y:return h=fi(13,k,g,T),h.elementType=y,h.lanes=$,h;case x:return h=fi(19,k,g,T),h.elementType=x,h.lanes=$,h;case w:return x0(k,T,$,g);default:if(typeof h=="object"&&h!==null)switch(h.$$typeof){case p:U=10;break e;case f:U=9;break e;case m:U=11;break e;case b:U=14;break e;case v:U=16,N=null;break e}throw Error(i(130,h==null?h:typeof h,""))}return g=fi(U,k,g,T),g.elementType=h,g.type=N,g.lanes=$,g}function pu(h,g,k,N){return h=fi(7,h,N,g),h.lanes=k,h}function x0(h,g,k,N){return h=fi(22,h,N,g),h.elementType=w,h.lanes=k,h.stateNode={isHidden:!1},h}function ak(h,g,k){return h=fi(6,h,null,g),h.lanes=k,h}function ik(h,g,k){return g=fi(4,h.children!==null?h.children:[],h.key,g),g.lanes=k,g.stateNode={containerInfo:h.containerInfo,pendingChildren:null,implementation:h.implementation},g}function Rj(h,g,k,N,T){this.tag=g,this.containerInfo=h,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=ie,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ye(0),this.expirationTimes=ye(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ye(0),this.identifierPrefix=N,this.onRecoverableError=T,Ie&&(this.mutableSourceEagerHydrationData=null)}function u5(h,g,k,N,T,$,U,oe,ge){return h=new Rj(h,g,k,oe,ge),g===1?(g=1,$===!0&&(g|=8)):g=0,$=fi(3,null,null,g),h.current=$,$.stateNode=h,$.memoizedState={element:N,isDehydrated:k,cache:null,transitions:null,pendingSuspenseBoundaries:null},mw($),h}function c5(h){if(!h)return ui;h=h._reactInternals;e:{if(E(h)!==h||h.tag!==1)throw Error(i(170));var g=h;do{switch(g.tag){case 3:g=g.stateNode.context;break e;case 1:if(qr(g.type)){g=g.stateNode.__reactInternalMemoizedMergedChildContext;break e}}g=g.return}while(g!==null);throw Error(i(171))}if(h.tag===1){var k=h.type;if(qr(k))return kn(h,k,g)}return g}function d5(h){var g=h._reactInternals;if(g===void 0)throw typeof h.render=="function"?Error(i(188)):(h=Object.keys(h).join(","),Error(i(268,h)));return h=D(g),h===null?null:h.stateNode}function p5(h,g){if(h=h.memoizedState,h!==null&&h.dehydrated!==null){var k=h.retryLane;h.retryLane=k!==0&&k<g?k:g}}function w0(h,g){p5(h,g),(h=h.alternate)&&p5(h,g)}function Mj(h){return h=D(h),h===null?null:h.stateNode}function Aj(){return null}return e.attemptContinuousHydration=function(h){if(h.tag===13){var g=yo(h,134217728);if(g!==null){var k=Zr();hi(g,h,134217728,k)}w0(h,134217728)}},e.attemptDiscreteHydration=function(h){if(h.tag===13){var g=yo(h,1);if(g!==null){var k=Zr();hi(g,h,1,k)}w0(h,1)}},e.attemptHydrationAtCurrentPriority=function(h){if(h.tag===13){var g=Gs(h),k=yo(h,g);if(k!==null){var N=Zr();hi(k,h,g,N)}w0(h,g)}},e.attemptSynchronousHydration=function(h){switch(h.tag){case 3:var g=h.stateNode;if(g.current.memoizedState.isDehydrated){var k=iu(g.pendingLanes);k!==0&&(Ee(g,k|1),Oa(g,We()),!(Ct&6)&&(zc(),Qn()))}break;case 13:e5(function(){var N=yo(h,1);if(N!==null){var T=Zr();hi(N,h,1,T)}}),w0(h,1)}},e.batchedUpdates=function(h,g){var k=Ct;Ct|=1;try{return h(g)}finally{Ct=k,Ct===0&&(zc(),yn&&Qn())}},e.createComponentSelector=function(h){return{$$typeof:o0,value:h}},e.createContainer=function(h,g,k,N,T,$,U){return u5(h,g,!1,null,k,N,T,$,U)},e.createHasPseudoClassSelector=function(h){return{$$typeof:s0,value:h}},e.createHydrationContainer=function(h,g,k,N,T,$,U,oe,ge){return h=u5(k,N,!0,h,T,$,U,oe,ge),h.context=c5(null),k=h.current,N=Zr(),T=Gs(k),$=Zo(N,T),$.callback=g??null,Vs(k,$,T),h.current.lanes=T,we(h,T,N),Oa(h,N),h},e.createPortal=function(h,g,k){var N=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:l,key:N==null?null:""+N,children:h,containerInfo:g,implementation:k}},e.createRoleSelector=function(h){return{$$typeof:l0,value:h}},e.createTestNameSelector=function(h){return{$$typeof:u0,value:h}},e.createTextSelector=function(h){return{$$typeof:c0,value:h}},e.deferredUpdates=function(h){var g=Ce,k=qn.transition;try{return qn.transition=null,Ce=16,h()}finally{Ce=g,qn.transition=k}},e.discreteUpdates=function(h,g,k,N,T){var $=Ce,U=qn.transition;try{return qn.transition=null,Ce=1,h(g,k,N,T)}finally{Ce=$,qn.transition=U,Ct===0&&zc()}},e.findAllNodes=Hw,e.findBoundingRects=function(h,g){if(!Qe)throw Error(i(363));g=Hw(h,g),h=[];for(var k=0;k<g.length;k++)h.push(Vt(g[k]));for(g=h.length-1;0<g;g--){k=h[g];for(var N=k.x,T=N+k.width,$=k.y,U=$+k.height,oe=g-1;0<=oe;oe--)if(g!==oe){var ge=h[oe],Te=ge.x,Ve=Te+ge.width,ht=ge.y,Ae=ht+ge.height;if(N>=Te&&$>=ht&&T<=Ve&&U<=Ae){h.splice(g,1);break}else if(N!==Te||k.width!==ge.width||Ae<$||ht>U){if(!($!==ht||k.height!==ge.height||Ve<N||Te>T)){Te>N&&(ge.width+=Te-N,ge.x=N),Ve<T&&(ge.width=T-Te),h.splice(g,1);break}}else{ht>$&&(ge.height+=ht-$,ge.y=$),Ae<U&&(ge.height=U-ht),h.splice(g,1);break}}}return h},e.findHostInstance=d5,e.findHostInstanceWithNoPortals=function(h){return h=A(h),h=h!==null?z(h):null,h===null?null:h.stateNode},e.findHostInstanceWithWarning=function(h){return d5(h)},e.flushControlled=function(h){var g=Ct;Ct|=1;var k=qn.transition,N=Ce;try{qn.transition=null,Ce=1,h()}finally{Ce=N,qn.transition=k,Ct=g,Ct===0&&(zc(),Qn())}},e.flushPassiveEffects=du,e.flushSync=e5,e.focusWithin=function(h,g){if(!Qe)throw Error(i(363));for(h=Ww(h),g=Q_(h,g),g=Array.from(g),h=0;h<g.length;){var k=g[h++];if(!Yt(k)){if(k.tag===5&&Tt(k.stateNode))return!0;for(k=k.child;k!==null;)g.push(k),k=k.sibling}}return!1},e.getCurrentUpdatePriority=function(){return Ce},e.getFindAllNodesFailureDescription=function(h,g){if(!Qe)throw Error(i(363));var k=0,N=[];h=[Ww(h),0];for(var T=0;T<h.length;){var $=h[T++],U=h[T++],oe=g[U];if(($.tag!==5||!Yt($))&&(Uw($,oe)&&(N.push(Gw(oe)),U++,U>k&&(k=U)),U<g.length))for($=$.child;$!==null;)h.push($,U),$=$.sibling}if(k<g.length){for(h=[];k<g.length;k++)h.push(Gw(g[k]));return`findAllNodes was able to match part of the selector:
  `+(N.join(" > ")+`

No matching component was found for:
  `)+h.join(" > ")}return null},e.getPublicRootInstance=function(h){if(h=h.current,!h.child)return null;switch(h.child.tag){case 5:return X(h.child.stateNode);default:return h.child.stateNode}},e.injectIntoDevTools=function(h){if(h={bundleType:h.bundleType,version:h.version,rendererPackageName:h.rendererPackageName,rendererConfig:h.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:o.ReactCurrentDispatcher,findHostInstanceByFiber:Mj,findFiberByHostInstance:h.findFiberByHostInstance||Aj,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")h=!1;else{var g=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(g.isDisabled||!g.supportsFiber)h=!0;else{try{et=g.inject(h),ut=g}catch{}h=!!g.checkDCE}}return h},e.isAlreadyRendering=function(){return!1},e.observeVisibleRects=function(h,g,k,N){if(!Qe)throw Error(i(363));h=Hw(h,g);var T=Hn(h,k,N).disconnect;return{disconnect:function(){T()}}},e.registerMutableSourceForHydration=function(h,g){var k=g._getVersion;k=k(g._source),h.mutableSourceEagerHydrationData==null?h.mutableSourceEagerHydrationData=[g,k]:h.mutableSourceEagerHydrationData.push(g,k)},e.runWithPriority=function(h,g){var k=Ce;try{return Ce=h,g()}finally{Ce=k}},e.shouldError=function(){return null},e.shouldSuspend=function(){return!1},e.updateContainer=function(h,g,k,N){var T=g.current,$=Zr(),U=Gs(T);return k=c5(k),g.context===null?g.context=k:g.pendingContext=k,g=Zo($,U),g.payload={element:h},N=N===void 0?null:N,N!==null&&(g.callback=N),h=Vs(T,g,U),h!==null&&(hi(h,T,U,$),Um(h,T,U)),U},e};_A.exports=Tne;var Ine=_A.exports;const Ene=gi(Ine);var OA={exports:{}},zu={};/**
* @license React
* react-reconciler-constants.production.min.js
*
* Copyright (c) Facebook, Inc. and its affiliates.
*
* This source code is licensed under the MIT license found in the
* LICENSE file in the root directory of this source tree.
*/zu.ConcurrentRoot=1,zu.ContinuousEventPriority=4,zu.DefaultEventPriority=16,zu.DiscreteEventPriority=1,zu.IdleEventPriority=536870912,zu.LegacyRoot=0,OA.exports=zu;var $A=OA.exports;const RA={children:!0,ref:!0,key:!0,style:!0,forwardedRef:!0,unstable_applyCache:!0,unstable_applyDrawHitFromCache:!0};let MA=!1,AA=!1;const M3=".react-konva-event",_ne=`ReactKonva: You have a Konva node with draggable = true and position defined but no onDragMove or onDragEnd events are handled.
Position of a node will be changed during drag&drop, so you should update state of the react app as well.
Consider to add onDragMove or onDragEnd events.
For more info see: https://github.com/konvajs/react-konva/issues/256
`,One=`ReactKonva: You are using "zIndex" attribute for a Konva node.
react-konva may get confused with ordering. Just define correct order of elements in your render function of a component.
For more info see: https://github.com/konvajs/react-konva/issues/194
`,$ne={};function wb(t,e,n=$ne){if(!MA&&"zIndex"in e&&(console.warn(One),MA=!0),!AA&&e.draggable){var r=e.x!==void 0||e.y!==void 0,a=e.onDragEnd||e.onDragMove;r&&!a&&(console.warn(_ne),AA=!0)}for(var i in n)if(!RA[i]){var o=i.slice(0,2)==="on",s=n[i]!==e[i];if(o&&s){var l=i.substr(2).toLowerCase();l.substr(0,7)==="content"&&(l="content"+l.substr(7,1).toUpperCase()+l.substr(8)),t.off(l,n[i])}var u=!e.hasOwnProperty(i);u&&t.setAttr(i,void 0)}var c=e._useStrictMode,d={},p=!1;const f={};for(var i in e)if(!RA[i]){var o=i.slice(0,2)==="on",m=n[i]!==e[i];if(o&&m){var l=i.substr(2).toLowerCase();l.substr(0,7)==="content"&&(l="content"+l.substr(7,1).toUpperCase()+l.substr(8)),e[i]&&(f[l]=e[i])}!o&&(e[i]!==n[i]||c&&e[i]!==t.getAttr(i))&&(p=!0,d[i]=e[i])}p&&(t.setAttrs(d),El(t));for(var l in f)t.on(l+M3,f[l])}function El(t){if(!wt.Konva.autoDrawEnabled){var e=t.getLayer()||t.getStage();e&&e.batchDraw()}}const PA={},Rne={};vf.Node.prototype._applyProps=wb;function Mne(t,e){if(typeof e=="string"){console.error(`Do not use plain text as child of Konva.Node. You are using text: ${e}`);return}t.add(e),El(t)}function Ane(t,e,n){let r=vf[t];r||(console.error(`Konva has no node with the type ${t}. Group will be used instead. If you use minimal version of react-konva, just import required nodes into Konva: "import "konva/lib/shapes/${t}"  If you want to render DOM elements as part of canvas tree take a look into this demo: https://konvajs.github.io/docs/react/DOM_Portal.html`),r=vf.Group);const a={},i={};for(var o in e){var s=o.slice(0,2)==="on";s?i[o]=e[o]:a[o]=e[o]}const l=new r(a);return wb(l,i),l}function Pne(t,e,n){console.error(`Text components are not supported for now in ReactKonva. Your text is: "${t}"`)}function Lne(t,e,n){return!1}function Dne(t){return t}function Fne(){return null}function Bne(){return null}function zne(t,e,n,r){return Rne}function jne(){}function Vne(t){}function Wne(t,e){return!1}function Une(){return PA}function Gne(){return PA}const Hne=setTimeout,qne=clearTimeout,Kne=-1;function Xne(t,e){return!1}const Yne=!1,Qne=!0,Zne=!0;function Jne(t,e){e.parent===t?e.moveToTop():t.add(e),El(t)}function ere(t,e){e.parent===t?e.moveToTop():t.add(e),El(t)}function LA(t,e,n){e._remove(),t.add(e),e.setZIndex(n.getZIndex()),El(t)}function tre(t,e,n){LA(t,e,n)}function nre(t,e){e.destroy(),e.off(M3),El(t)}function rre(t,e){e.destroy(),e.off(M3),El(t)}function are(t,e,n){console.error(`Text components are not yet supported in ReactKonva. You text is: "${n}"`)}function ire(t,e,n){}function ore(t,e,n,r,a){wb(t,a,r)}function sre(t){t.hide(),El(t)}function lre(t){}function ure(t,e){(e.visible==null||e.visible)&&t.show()}function cre(t,e){}function dre(t){}function pre(){}const hre=()=>$A.DefaultEventPriority,fre=Object.freeze(Object.defineProperty({__proto__:null,appendChild:Jne,appendChildToContainer:ere,appendInitialChild:Mne,cancelTimeout:qne,clearContainer:dre,commitMount:ire,commitTextUpdate:are,commitUpdate:ore,createInstance:Ane,createTextInstance:Pne,detachDeletedInstance:pre,finalizeInitialChildren:Lne,getChildHostContext:Gne,getCurrentEventPriority:hre,getPublicInstance:Dne,getRootHostContext:Une,hideInstance:sre,hideTextInstance:lre,idlePriority:ph.unstable_IdlePriority,insertBefore:LA,insertInContainerBefore:tre,isPrimaryRenderer:Yne,noTimeout:Kne,now:ph.unstable_now,prepareForCommit:Fne,preparePortalMount:Bne,prepareUpdate:zne,removeChild:nre,removeChildFromContainer:rre,resetAfterCommit:jne,resetTextContent:Vne,run:ph.unstable_runWithPriority,scheduleTimeout:Hne,shouldDeprioritizeSubtree:Wne,shouldSetTextContent:Xne,supportsMutation:Zne,unhideInstance:ure,unhideTextInstance:cre,warnsIfNotActing:Qne},Symbol.toStringTag,{value:"Module"}));var gre=Object.defineProperty,mre=Object.defineProperties,yre=Object.getOwnPropertyDescriptors,DA=Object.getOwnPropertySymbols,bre=Object.prototype.hasOwnProperty,vre=Object.prototype.propertyIsEnumerable,FA=(t,e,n)=>e in t?gre(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,BA=(t,e)=>{for(var n in e||(e={}))bre.call(e,n)&&FA(t,n,e[n]);if(DA)for(var n of DA(e))vre.call(e,n)&&FA(t,n,e[n]);return t},xre=(t,e)=>mre(t,yre(e));function zA(t,e,n){if(!t)return;if(n(t)===!0)return t;let r=e?t.return:t.child;for(;r;){const a=zA(r,e,n);if(a)return a;r=e?null:r.sibling}}function jA(t){try{return Object.defineProperties(t,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return t}}const A3=jA(R.createContext(null));class VA extends R.Component{render(){return R.createElement(A3.Provider,{value:this._reactInternals},this.props.children)}}const{ReactCurrentOwner:WA,ReactCurrentDispatcher:UA}=R.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function wre(){const t=R.useContext(A3);if(t===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=R.useId();return R.useMemo(()=>{for(const n of[WA?.current,t,t?.alternate]){if(!n)continue;const r=zA(n,!1,a=>{let i=a.memoizedState;for(;i;){if(i.memoizedState===e)return!0;i=i.next}});if(r)return r}},[t,e])}function kre(){var t,e;const n=wre(),[r]=R.useState(()=>new Map);r.clear();let a=n;for(;a;){const i=(t=a.type)==null?void 0:t._context;i&&i!==A3&&!r.has(i)&&r.set(i,(e=UA?.current)==null?void 0:e.readContext(jA(i))),a=a.return}return r}function Sre(){const t=kre();return R.useMemo(()=>Array.from(t.keys()).reduce((e,n)=>r=>R.createElement(e,null,R.createElement(n.Provider,xre(BA({},r),{value:t.get(n)}))),e=>R.createElement(VA,BA({},e))),[t])}function Cre(t){const e=G.useRef({});return G.useLayoutEffect(()=>{e.current=t}),G.useLayoutEffect(()=>()=>{e.current={}},[]),e.current}const Nre=t=>{const e=G.useRef(),n=G.useRef(),r=G.useRef(),a=Cre(t),i=Sre(),o=s=>{const{forwardedRef:l}=t;l&&(typeof l=="function"?l(s):l.current=s)};return G.useLayoutEffect(()=>(n.current=new vf.Stage({width:t.width,height:t.height,container:e.current}),o(n.current),r.current=xf.createContainer(n.current,$A.LegacyRoot,!1,null),xf.updateContainer(G.createElement(i,{},t.children),r.current),()=>{vf.isBrowser&&(o(null),xf.updateContainer(null,r.current,null),n.current.destroy())}),[]),G.useLayoutEffect(()=>{o(n.current),wb(n.current,t,a),xf.updateContainer(G.createElement(i,{},t.children),r.current,null)}),G.createElement("div",{ref:e,id:t.id,accessKey:t.accessKey,className:t.className,role:t.role,style:t.style,tabIndex:t.tabIndex,title:t.title})},P3="Layer",GA="Image",Tre="Transformer",xf=Ene(fre);xf.injectIntoDevTools({findHostInstanceByFiber:()=>null,bundleType:0,version:G.version,rendererPackageName:"react-konva"});const Ire=G.forwardRef((t,e)=>G.createElement(VA,{},G.createElement(Nre,{...t,forwardedRef:e})));var ju=R,Ere=function(t,e,n){const r=ju.useRef("loading"),a=ju.useRef(),[i,o]=ju.useState(0),s=ju.useRef(),l=ju.useRef(),u=ju.useRef();return(s.current!==t||l.current!==e||u.current!==n)&&(r.current="loading",a.current=void 0,s.current=t,l.current=e,u.current=n),ju.useLayoutEffect(function(){if(!t)return;var c=document.createElement("img");function d(){r.current="loaded",a.current=c,o(Math.random())}function p(){r.current="failed",a.current=void 0,o(Math.random())}return c.addEventListener("load",d),c.addEventListener("error",p),e&&(c.crossOrigin=e),n&&(c.referrerPolicy=n),c.src=t,function(){c.removeEventListener("load",d),c.removeEventListener("error",p)}},[t,e,n]),[a.current,r.current]};const HA=gi(Ere),qA=({front:t})=>{const{frame:e}=ps(),[n]=HA(t?e.front:e.image,"anonymous");return se.jsx(GA,{image:n,draggable:!1})},_re=({canvasImage:t,isSelected:e,onSelect:n})=>{const r=R.useRef(),a=R.useRef(),[i]=HA(t.image,"anonymous"),o=ps(c=>c.transformCanvasImage);R.useEffect(()=>{var c;e&&(a.current.nodes([r.current]),(c=a.current.getLayer())==null||c.batchDraw())},[e]),R.useEffect(()=>{i&&r.current.cache()},[i]);const s=()=>{o({...t,isDragging:!0})},l=c=>{o({...t,isDragging:!1,x:c.target.x(),y:c.target.y()})},u=()=>{var c;const d=r.current,p=d.scaleX(),f=d.scaleY(),m=Math.max(5,d.width()*p),y=Math.max(d.height()*f);o({...t,x:d.x(),y:d.y(),width:m,height:y}),a.current.nodes([r.current]),(c=a.current.getLayer())==null||c.batchDraw()};return se.jsxs(se.Fragment,{children:[se.jsx(GA,{brightness:t.brightness,contrast:t.contrast,draggable:!0,filters:[EA.Filters.Brighten,EA.Filters.Contrast],id:t.id,image:i,onClick:n,onDragEnd:l,onDragStart:s,onTap:n,onTransformEnd:u,opacity:t.opacity||1,ref:r,scaleX:.5,scaleY:.5,x:t.x,y:t.y},t.id),e&&se.jsx(Tre,{ref:a,flipEnabled:!1,enabledAnchors:["top-left","top-right","bottom-left","bottom-right"],borderStroke:"#BC13FE"})]})},Ore=()=>{const{addToCanvas:t,artworkList:e,canvasList:n,frame:r,moveCanvasImage:a,removeFromCanvas:i,setFrame:o,transformCanvasImage:s}=ps(),l=R.useRef(null),[u,c]=R.useState(null),[d,p]=R.useState(0),[f,m]=R.useState(0),[y,x]=R.useState(1),[b,v]=R.useState(!1),[w,S]=R.useState(!1),[C,I]=R.useState(!1),_=1080,E=1080;R.useEffect(()=>{const re=()=>{const he=(window.innerWidth*.8||0)/_;l.current&&(l.current.width(_*he),l.current.height(E*he),l.current.scale({x:he,y:he}))};return re(),window.addEventListener("resize",re),()=>{window.removeEventListener("resize",re)}},[]);const P=re=>{re.target===re.target.getStage()&&c(null)},A=re=>{c(re),p(re.brightness),m(re.contrast),x(re.opacity)},D=re=>{u&&a(u.id,re)},V=(re,he)=>{if(!u)return;const ve={...u,[he]:re};switch(s(ve),he){case"brightness":p(re);break;case"contrast":m(re);break;case"opacity":x(re);break}},z=()=>{u&&(i(u.id),c(null))},K=()=>{navigator.share?navigator.share({title:"GLAMorous Europe",text:"Check out my GLAMorous Europe artwork!",url:window.location.href}).then(()=>console.log("Share successful")).catch(re=>console.error("Error sharing:",re)):console.log("Web Share API not supported")},X=()=>{var re;const he=(re=l.current)==null?void 0:re.toDataURL();he&&TZ.saveAs(he,"GLAMorousEurope.png")},Z=()=>{v(!b),I(!1),S(!1)},q=()=>{S(!w),I(!1),v(!1)},F=()=>{I(!C),S(!1),v(!1)},[{canDrop:Y,isOver:Q},ne]=_U(()=>({accept:"artwork",drop:(re,he)=>{const ve=he.getClientOffset();if(re&&ve){const H=e.find(ie=>ie.id===re.id);if(H){const ie=l.current;if(ie){const pe=ve.x-ie.container().getBoundingClientRect().left,ke=ve.y-ie.container().getBoundingClientRect().top;t(H.image,pe,ke)}}}},collect:re=>({isOver:re.isOver(),canDrop:re.canDrop()})})),le=Y&&Q;let de="transparent";return le&&(de="#ebb2ff"),se.jsxs(se.Fragment,{children:[se.jsxs(to,{className:"flex flex-wrap gap-1 container justify-center content-center text-center mx-auto",children:[se.jsx(jn,{className:"p-2 text-black",rounded:!0,inline:!0,onClick:K,children:se.jsx(aa,{material:se.jsx(fZ,{className:"w-6 h-6"})})}),se.jsx(jn,{className:"p-2 text-black",rounded:!0,inline:!0,onClick:X,children:se.jsx(aa,{material:se.jsx(PQ,{className:"w-6 h-6"})})}),u&&se.jsxs(se.Fragment,{children:[se.jsx(jn,{className:"p-2 text-black",rounded:!0,inline:!0,onClick:()=>D(!0),children:se.jsx(aa,{material:se.jsx(jQ,{className:"w-6 h-6"})})}),se.jsx(jn,{className:"p-2 text-black",rounded:!0,inline:!0,onClick:()=>D(!1),children:se.jsx(aa,{material:se.jsx(FQ,{className:"w-6 h-6"})})}),se.jsx(jn,{className:"p-2 text-black",rounded:!0,inline:!0,onClick:z,children:se.jsx(aa,{material:se.jsx(kZ,{className:"w-6 h-6"})})}),se.jsx(jn,{className:"p-2 text-black",rounded:!0,inline:!0,onClick:F,children:se.jsx(aa,{material:se.jsx(QN,{className:"w-6 h-6"})})}),C&&se.jsx(Td,{strong:!0,insetMaterial:!0,outlineIos:!0,className:"w-1/3 my-0",children:se.jsx(Id,{innerClassName:"flex space-x-4 w-6",innerChildren:se.jsx(hy,{value:y,min:0,max:1,step:.01,onChange:re=>V(parseFloat(re.target.value),"opacity")})})}),se.jsx(jn,{className:"p-2 text-black",rounded:!0,inline:!0,onClick:Z,children:se.jsx(aa,{material:se.jsx(QN,{className:"w-6 h-6"})})}),b&&se.jsx(Td,{strong:!0,insetMaterial:!0,outlineIos:!0,className:"w-1/3 my-0",children:se.jsx(Id,{innerClassName:"flex space-x-4 w-6",innerChildren:se.jsx(hy,{value:d,min:-1,max:1,step:.01,onChange:re=>V(parseFloat(re.target.value),"brightness")})})}),se.jsx(jn,{className:"p-2 text-black",rounded:!0,inline:!0,onClick:q,children:se.jsx(aa,{material:se.jsx(QN,{className:"w-6 h-6"})})}),w&&se.jsx(Td,{strong:!0,insetMaterial:!0,outlineIos:!0,className:"w-1/3 my-0",children:se.jsx(Id,{innerClassName:"flex space-x-4 w-6",innerChildren:se.jsx(hy,{value:f,min:-100,max:100,step:1,onChange:re=>V(parseFloat(re.target.value),"contrast")})})})]})]}),se.jsxs("div",{className:"mx-auto flex items-center gap-2",ref:ne,children:[se.jsx(jn,{className:"p-4 text-xl text-black",rounded:!0,inline:!0,onClick:()=>o(Math.max(1,r.id-1)),children:se.jsx(aa,{material:se.jsx(qQ,{className:"w-6 h-6"})})}),se.jsxs(Ire,{style:{border:"4px solid",borderColor:de},width:_,height:E,ref:l,onMouseDown:P,onTouchStart:P,children:[se.jsx(P3,{listening:!1,children:se.jsx(qA,{front:!1})}),se.jsx(P3,{children:n.map(re=>se.jsx(_re,{canvasImage:re,isSelected:u?.id===re.id,onSelect:()=>A(re)},re.id))}),se.jsx(P3,{listening:!1,children:se.jsx(qA,{front:!0})})]}),se.jsx(jn,{className:"p-4 text-xl text-black",rounded:!0,inline:!0,onClick:()=>o(Math.min(5,r.id+1)),children:se.jsx(aa,{material:se.jsx(YQ,{className:"w-6 h-6"})})})]})]})};function $re({id:t,image:e}){const[{opacity:n},r,a]=wU(()=>({type:"artwork",item:{id:t},collect:i=>({opacity:i.isDragging()?.4:1})}));return se.jsxs(se.Fragment,{children:[se.jsx(JW,{connect:a,src:e}),se.jsx("img",{src:e,alt:t,role:"presentation",style:{cursor:"move",marginRight:"10px",maxHeight:"100px",opacity:n,scrollSnapAlign:"start",width:"auto"},ref:r})]})}function Rre(){const{t}=Eu(),{artworkList:e}=ps();return se.jsxs(to,{className:"flex flex-col flex-wrap gap-4 container justify-center content-center text-center mx-auto",children:[se.jsx("div",{className:"p-2 m-4",children:se.jsx("h1",{className:"text-2xl",children:t("artworkTitle")})}),se.jsx(to,{className:"flex mx-auto overflow-x-auto",style:{maxHeight:"100px",scrollSnapType:"x mandatory",scrollBehavior:"smooth",WebkitOverflowScrolling:"touch"},children:e.map((n,r)=>se.jsx($re,{...n},n.id+r))}),e.length===0?se.jsx(jn,{className:"p-4 text-xl text-black w-2/3 mx-auto h-20",rounded:!0,inline:!0,children:se.jsx(ny,{to:"/selection",children:t("artworkEmpty")})}):se.jsx(Ore,{})]})}const Mre="modulepreload",Are=function(t){return"/"+t},KA={},Pre=function(t,e,n){let r=Promise.resolve();if(e&&e.length>0){const a=document.getElementsByTagName("link");r=Promise.all(e.map(i=>{if(i=Are(i),i in KA)return;KA[i]=!0;const o=i.endsWith(".css"),s=o?'[rel="stylesheet"]':"";if(n)for(let u=a.length-1;u>=0;u--){const c=a[u];if(c.href===i&&(!o||c.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${i}"]${s}`))return;const l=document.createElement("link");if(l.rel=o?"stylesheet":Mre,o||(l.as="script",l.crossOrigin=""),l.href=i,document.head.appendChild(l),o)return new Promise((u,c)=>{l.addEventListener("load",u),l.addEventListener("error",()=>c(new Error(`Unable to preload CSS for ${i}`)))})}))}return r.then(()=>t()).catch(a=>{const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=a,window.dispatchEvent(i),!i.defaultPrevented)throw a})};var XA={exports:{}},Lre="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",Dre=Lre,Fre=Dre;function YA(){}function QA(){}QA.resetWarningCache=YA;var Bre=function(){function t(r,a,i,o,s,l){if(l!==Fre){var u=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw u.name="Invariant Violation",u}}t.isRequired=t;function e(){return t}var n={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:QA,resetWarningCache:YA};return n.PropTypes=n,n};XA.exports=Bre();var zre=XA.exports;const zr=gi(zre);/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var L3=function(t,e){return L3=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(n[a]=r[a])},L3(t,e)};function ZA(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");L3(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var io=function(){return io=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])}return t},io.apply(this,arguments)};function JA(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(t);a<r.length;a++)e.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(t,r[a])&&(n[r[a]]=t[r[a]]);return n}function Vu(t,e){for(var n=0,r=e.length,a=t.length;n<r;n++,a++)t[a]=e[n];return t}var jre=function(t){return Object.keys(t).filter(function(e){return t[e]}).join(" ")},kb=function(t,e){return t.x===e.x&&t.y===e.y},Sb=function(t,e){return!t&&e||t&&!e||t.length!==e.length?!1:t.every(function(n,r){return kb(n,e[r])})},Wu=function(t,e){var n=t.x,r=t.y;return e===void 0&&(e=1),{x:Math.round((n+Number.EPSILON)*e)/e,y:Math.round((r+Number.EPSILON)*e)/e}},Vre=function(t,e,n){n===void 0&&(n=0);var r=t.findIndex(function(a){return Math.max(Math.abs(a.x-e.x),Math.abs(a.y-e.y))<=n});return{point:io({},t[r]||{x:NaN,y:NaN}),index:r}},eP=function(t,e){return Math.hypot(e.x-t.x,e.y-t.y)},tP=function(t,e){return Math.atan2(e.y-t.y,e.x-t.x)},Wre=function(t,e,n){var r=eP(t,e),a=tP(t,e),i=Math.round(a/n)*n;return{x:t.x+r*Math.cos(i),y:t.y+r*Math.sin(i)}},Ure=function(t,e,n){var r=eP(t,e),a=tP(t,e),i=n.reduce(function(o,s){return Math.abs(s-a)<Math.abs(o-a)?s:o},1/0);return i!==1/0&&(e.x=t.x+r*Math.cos(i),e.y=t.y+r*Math.sin(i)),e},Gre=function(t){for(var e=[],n=1;n<t.length;n++){var r=Math.atan2(t[n].y-t[n-1].y,t[n].x-t[n-1].x),a=r+Math.PI;e.push(r,a>Math.PI?a-2*Math.PI:a)}return e.filter(function(i,o,s){return s.indexOf(i)===o})};function Hre(t,e,n,r){r===void 0&&(r=!0);var a=new Image;a.crossOrigin="Anonymous";var i=document.createElement("canvas"),o=i.getContext("2d");if(!o)return n(new Error("CTX is null"),i);a.onerror=function(){n(new Error("Failed to load image"),i)},a.onload=function(){try{if(i.width=a.naturalWidth+2,i.height=a.naturalHeight+2,o.drawImage(a,0,0),e.length<3){n(null,i);return}if(o.beginPath(),o.moveTo(0,0),o.lineTo(i.width,0),o.lineTo(i.width,i.height),o.lineTo(0,i.height),o.lineTo(0,0),o.lineTo(e[0].x+1,e[0].y+1),e.slice(1).forEach(function(w){var S=w.x,C=w.y;return o.lineTo(S+1,C+1)}),o.lineTo(e[0].x+1,e[0].y+1),o.lineTo(0,0),o.closePath(),o.clip("evenodd"),o.globalCompositeOperation="destination-out",o.fill(),r){var s=e.map(function(w){var S=w.x;return S+1}),l=e.map(function(w){var S=w.y;return S+1}),u=[Math.min.apply(null,s),Math.min.apply(null,l)],c=u[0],d=u[1],p=[Math.max.apply(null,s),Math.max.apply(null,l)],f=p[0],m=p[1],y=[f-c,m-d],x=y[0],b=y[1],v=o.getImageData(c,d,x,b);i.width=x,i.height=b,o.putImageData(v,0,0)}n(null,i)}catch(w){n(w instanceof Error?w:new Error(String(w)),i)}},a.src=t}var nP=function(){function t(e){this.getSvgElement=e}return t.prototype.getSvg=function(){var e=this.getSvgElement();if(!e)throw new Error("SVG is null");return e},t.prototype.getCTM=function(){var e=this.getSvg(),n=e.getCTM();if(n===null){var r=e.querySelector('rect[visibility="hidden"]');n=r.getCTM()}if(!n)throw new Error("CTM is null");return n},t.prototype.getViewboxSize=function(){return this.getSvg().viewBox.baseVal},t.prototype.getRealSize=function(){var e=this.getSvg();return{width:e.clientWidth,height:e.clientHeight}},t.prototype.getViewboxOffset=function(){var e=this.getSvg(),n=this.getRealSize(),r=n.width,a=n.height,i=this.getViewboxSize(),o=i.width,s=i.height,l=Object.assign(e.createSVGPoint(),{x:r,y:a}),u=this.getCTM(),c=l.matrixTransform(u.inverse()),d=c.x,p=c.y;return{x:d-o,y:p-s}},t.prototype.convertViewboxPointsToReal=function(e){var n=this.getSvg(),r=this.getCTM();return e.map(function(a){var i=a.x,o=a.y,s=Object.assign(n.createSVGPoint(),{x:i,y:o}).matrixTransform(r);return Wu(s)})},t.prototype.convertRealPointsToViewbox=function(e){var n=this.getSvg(),r=this.getCTM().inverse();return e.map(function(a){var i=a.x,o=a.y,s=Object.assign(n.createSVGPoint(),{x:i,y:o}).matrixTransform(r);return Wu(s,1e3)})},t.prototype.getBorderPoints=function(e){e===void 0&&(e=!0);var n=this.getViewboxSize(),r=n.width,a=n.height,i=this.getViewboxOffset(),o=i.x,s=i.y,l=[{x:-o,y:-s},{x:r+o,y:-s},{x:r+o,y:a+s},{x:-o,y:a+s}];return e&&l.push({x:-o,y:-s}),l},t.prototype.isAboveTheBorder=function(e){var n=e.x,r=e.y,a=this.getViewboxSize(),i=a.width,o=a.height,s=this.getViewboxOffset(),l=s.x,u=s.y;return n<-l||n>i+l||r<-u||r>o+u},t.prototype.getMouseCoordinates=function(e){var n=e,r=n.changedTouches&&n.touches?n.changedTouches[0]||n.touches[0]:n,a=r.clientX,i=r.clientY,o=this.getSvg(),s=o.getScreenCTM();if(!s)throw new Error("ScreenCTM is null");var l=o.createSVGPoint();l.x=a,l.y=i;var u=l.matrixTransform(s.inverse()),c=u.x,d=u.y;return{x:c,y:d}},t}(),rP=function(t){return function(e){ZA(n,e);function n(){var r=e!==null&&e.apply(this,arguments)||this;return r.ref=G.createRef(),r.svg=new nP(function(){var a,i;return(i=(a=r.ref)===null||a===void 0?void 0:a.current)===null||i===void 0?void 0:i.ownerSVGElement}),r.dragLastPosition=null,r.wasMoved=!1,r.onMouseTouchDown=function(a){if(a.target===r.ref.current&&r.props.draggable){a.stopImmediatePropagation(),a.preventDefault();var i=a.target;r.dragLastPosition=r.getMousePosition(a),i.ownerSVGElement&&i.ownerSVGElement.focus({preventScroll:!0})}},r.onMouseTouchMove=function(a){if(r.dragLastPosition){a.stopImmediatePropagation(),a.preventDefault();var i=r.getMousePosition(a),o=i.x,s=i.y,l=o-r.dragLastPosition.x,u=s-r.dragLastPosition.y;!r.wasMoved&&r.props.onDragStart&&r.props.onDragStart({x:r.dragLastPosition.x,y:r.dragLastPosition.y,dx:l,dy:u}),r.props.onDrag&&r.props.onDrag({dx:l,dy:u}),r.dragLastPosition={x:o,y:s},r.wasMoved=!0}},r.onMouseTouchUp=function(a){r.dragLastPosition&&r.wasMoved&&(a.stopImmediatePropagation(),a.preventDefault(),(a instanceof MouseEvent||!a.touches)&&window.addEventListener("click",function(i){return i.stopPropagation()},{capture:!0,once:!0}),r.props.onDragEnd&&r.props.onDragEnd({x:r.dragLastPosition.x,y:r.dragLastPosition.y})),r.dragLastPosition=null,r.wasMoved=!1},r}return n.prototype.render=function(){var r=this.props,a=r.draggable;r.onDrag,r.onDragStart,r.onDragEnd;var i=JA(r,["draggable","onDrag","onDragStart","onDragEnd"]);return G.createElement(t,io({ref:this.ref},i,{draggable:a}))},n.prototype.componentDidUpdate=function(r){r.draggable&&!this.props.draggable&&this.dragLastPosition&&this.wasMoved&&(this.props.onDragEnd&&this.props.onDragEnd({x:this.dragLastPosition.x,y:this.dragLastPosition.y}),this.dragLastPosition=null,this.wasMoved=!1)},n.prototype.componentDidMount=function(){window.addEventListener("mousedown",this.onMouseTouchDown,!0),window.addEventListener("mousemove",this.onMouseTouchMove,!0),window.addEventListener("mouseup",this.onMouseTouchUp,!0),window.addEventListener("touchstart",this.onMouseTouchDown,!0),window.addEventListener("touchmove",this.onMouseTouchMove,!0),window.addEventListener("touchend",this.onMouseTouchUp,!0)},n.prototype.componentWillUnmount=function(){window.removeEventListener("mousedown",this.onMouseTouchDown),window.removeEventListener("mousemove",this.onMouseTouchMove),window.removeEventListener("mouseup",this.onMouseTouchUp),window.removeEventListener("touchstart",this.onMouseTouchDown),window.removeEventListener("touchmove",this.onMouseTouchMove),window.removeEventListener("touchend",this.onMouseTouchUp)},n.prototype.getMousePosition=function(r){var a=r;return this.svg.getMouseCoordinates(a)},n}(G.Component)},qre=rP(G.forwardRef(function(t,e){var n=t.path,r=t.animate,a=t.draggable;return G.createElement("polyline",{ref:e,style:{cursor:a?"move":""},points:n.map(function(i){var o=i.x,s=i.y;return o+","+s}).join(" "),fill:"rgba(0,0,0,0)",stroke:"white",strokeWidth:"1.5",shapeRendering:"geometricPrecision",strokeDasharray:"3",strokeDashoffset:"0",vectorEffect:"non-scaling-stroke"},r&&G.createElement("animate",{attributeName:"stroke-dashoffset",values:"0;1000;0",dur:"100s",repeatCount:"indefinite"}))}));function Kre(t){var e=t.path;return G.createElement("polygon",{style:{pointerEvents:"none",transform:"translate(-1px, -1px)"},points:e.map(function(n){var r=n.x,a=n.y;return r+","+a}).join(" "),fill:"rgba(0, 0, 0, 0.5)",fillRule:"evenodd",stroke:"null",shapeRendering:"geometricPrecision"})}var Xre=rP(G.forwardRef(function(t,e){var n=t.x,r=t.y,a=t.onClickTouchEvent,i=t.draggable,o=t.style,s=o.cursor,l=s===void 0?i?"move":"default":s,u=JA(o,["cursor"]);return G.createElement("rect",{style:io({cursor:l},u),ref:e,x:n-10,y:r-10,onClick:function(c){c.stopPropagation(),c.preventDefault(),a(c)},onTouchEnd:function(c){c.stopPropagation(),c.preventDefault(),a(c)},width:"20px",height:"20",fill:"rgba(0, 0, 0, 0)",stroke:"white",strokeWidth:"1.25",vectorEffect:"non-scaling-stroke"})})),pr;(function(t){t.ADD="ADD",t.DELETE="DELETE",t.MODIFY="MODIFY",t.MOVE="MOVE",t.RESET="RESET",t.CHANGE="CHANGE"})(pr||(pr={}));function Yre(t,e){var n=t.points.length;switch(e.type){case pr.ADD:{if(t.closed)return[t,!1];if(n>0&&kb(t.points[n-1],e.payload)||n>1&&kb(t.points[n-2],e.payload))return[t,!1];var r=n>2&&kb(t.points[0],e.payload);return r?[{points:Vu([],t.points),closed:!0},!0]:[{points:Vu(Vu([],t.points,!0),[e.payload]),closed:!1},!0]}case pr.DELETE:return[{points:Vu([],t.points.filter(function(u,c){return e.payload!==c})),closed:n>4&&t.closed},!0];case pr.MODIFY:{var a=t.points[e.payload.index],i=a.x,o=a.y,s=t.points.map(function(u){var c=u.x,d=u.y;return c===i&&d===o?{x:e.payload.x,y:e.payload.y}:{x:c,y:d}});return[{points:s,closed:t.closed},!!(e.payload.x||e.payload.y)]}case pr.MOVE:return[{points:t.points.map(function(u){var c=u.x,d=u.y;return{x:c+e.payload.x,y:d+e.payload.y}}),closed:t.closed},!!(e.payload.x||e.payload.y)];case pr.CHANGE:{var l=!Sb(e.payload,t.points);return[{points:e.payload,closed:l?e.payload.length>2:t.closed},l]}case pr.RESET:return[{points:[],closed:!1},!!t.points.length];default:return[t,!1]}}var Qre=function(t){ZA(e,t);function e(n){var r=t.call(this,n)||this;return r.imageRef=G.createRef(),r.svgRef=G.createRef(),r.svg=new nP(function(){var a;return(a=r.svgRef)===null||a===void 0?void 0:a.current}),r.angles=[],r.path={points:[],closed:!1},r.lastEmittedPoints=[],r.lastUpdatedPoints=[],r.imgError=!1,r.setPathFromPropsOnMediaLoad=!0,r.hidePointer=function(){var a=r.path.points[r.path.points.length-1]||{x:0,y:0};r.setPointer(io({},a),!0)},r.onShapeDrag=function(a){var i=a.dx,o=a.dy,s=r.path.points.map(function(l){var u=l.x,c=l.y;return{x:u+i,y:c+o}});s.some(function(l){return r.svg.isAboveTheBorder(l)})||r.dispatchPathAction({type:pr.MOVE,payload:{x:i,y:o}})},r.onPointDrag=function(a,i){var o=i.dx,s=i.dy,l=io({},r.path.points[a]);l.x+=o,l.y+=s,r.svg.isAboveTheBorder(l)||r.dispatchPathAction({type:pr.MODIFY,payload:io(io({},l),{index:a})})},r.onPointClick=function(a){r.isLoaded()&&!r.props.disabled&&!r.path.closed&&r.dispatchPathAction({type:pr.ADD,payload:r.path.points[a]})},r.onDragEnd=function(){r.checkIfPathUpdated(!1)},r.onMediaLoaded=function(a){r.setPathFromPropsOnMediaLoad&&(r.setPathStateFromProps(),r.setPathFromPropsOnMediaLoad=!1),r.imgError=!1,r.props.onImageLoad(a)},r.onMediaError=function(a){r.dispatchPathAction({type:pr.RESET}),r.imgError=!0,r.props.onImageError(a)},r.onClickTouchEvent=function(a){if(r.isLoaded()&&!r.props.disabled){if(r.path.closed){a.target===r.svgRef.current&&r.dispatchPathAction({type:pr.RESET});return}var i=r.getMousePosition(a)[0];r.svg.isAboveTheBorder(i)?r.hidePointer():r.dispatchPathAction({type:pr.ADD,payload:Wu(i,1e3),pointer:i})}},r.onClick=function(a){r.onClickTouchEvent(a)},r.onTouchEnd=function(a){a.cancelable&&(a.preventDefault(),r.onClickTouchEvent(a)),r.hidePointer()},r.onMouseTouchMove=function(a){if(r.isLoaded()){var i=r.getMousePosition(a)[0];r.setPointer(i)}},r.onContextMenu=function(a){if(r.isLoaded()&&(a.preventDefault(),!r.props.disabled&&!r.path.closed)){var i=r.getMousePosition(a),o=i[0],s=i[1].index;s>-1?r.dispatchPathAction({type:pr.DELETE,payload:s,pointer:o}):r.setPointer(o)}},r.state={path:{points:[],closed:!1},pointer:{x:n.viewBox.width/2,y:n.viewBox.width/2}},r}return e.prototype.render=function(){var n=this;return G.createElement("div",{className:jre({ReactFreeSelect__Component:!0,ReactFreeSelect__Closed:this.state.path.closed,ReactFreeSelect__Disabled:this.props.disabled}),style:io({display:"inline-block",position:"relative",margin:"0",padding:"0",fontSize:"0",cursor:this.props.disabled?"not-allowed":"default"},this.props.style)},G.createElement("img",{ref:this.imageRef,src:this.props.src,alt:this.props.imageAlt,crossOrigin:this.props.crossOrigin,style:this.props.imageStyle,onLoad:this.onMediaLoaded,onError:this.onMediaError}),G.createElement("svg",{ref:this.svgRef,style:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%",overflow:"hidden",userSelect:"none",touchAction:"none"},viewBox:"0 0 "+this.props.viewBox.width+" "+this.props.viewBox.height,onMouseMove:this.onMouseTouchMove,onTouchMove:this.onMouseTouchMove,onClick:this.onClick,onTouchEnd:this.onTouchEnd,onContextMenu:this.onContextMenu,onMouseLeave:this.hidePointer},G.createElement("rect",{visibility:"hidden"}),!!this.state.path.points.length&&G.createElement(Kre,{path:this.getPolygonPoints()}),G.createElement(qre,{draggable:this.state.path.closed&&!this.props.disabled,onDrag:this.onShapeDrag,onDragEnd:this.onDragEnd,animate:!this.props.disabled,path:this.getPolylinePoints()}),this.getRoundedPoints().map(function(r,a){var i=r.x,o=r.y;return G.createElement(Xre,{key:a,x:i,y:o,draggable:!n.props.disabled,style:{cursor:!a&&n.state.path.points.length>2&&!n.state.path.closed?"pointer":void 0},onDrag:function(s){var l=s.dx,u=s.dy;return n.onPointDrag(a,{dx:l,dy:u})},onDragEnd:n.onDragEnd,onClickTouchEvent:function(){return n.onPointClick(a)}})})))},e.prototype.componentDidUpdate=function(n){!n.disabled&&this.props.disabled&&!this.path.closed&&this.hidePointer(),n.src&&n.src!==this.props.src?this.dispatchPathAction({type:pr.RESET}):Sb(n.value,this.props.value)||(this.isLoaded()?this.setPathStateFromProps():this.setPathFromPropsOnMediaLoad=!0)},e.prototype.convertPoints=function(n){var r=this.getAspectRatio();return this.svg.convertViewboxPointsToReal(n).map(function(a){var i=a.x,o=a.y;return{x:Math.round(i/r.x),y:Math.round(o/r.y)}})},e.prototype.checkIfPathUpdated=function(n){if(this.path.closed||n){var r=this.convertPoints(this.path.points);Sb(r,this.lastUpdatedPoints)||(this.emitOnComplete(r),this.lastUpdatedPoints=r.map(function(a){var i=a.x,o=a.y;return{x:i,y:o}}))}},e.prototype.emitOnChange=function(n){var r=n.points;if(this.props.onChange){var a=this.convertPoints(r);this.lastEmittedPoints=a,this.props.onChange(a)}},e.prototype.emitOnComplete=function(n){this.props.onComplete&&this.props.onComplete(n)},e.prototype.setPointer=function(n,r){var a=n.x,i=n.y;r===void 0&&(r=!1),(r||!this.props.disabled)&&this.setState({path:this.path,pointer:{x:a,y:i}})},e.prototype.dispatchPathAction=function(n){var r=this.path.closed,a=Yre(this.path,n),i=a[0],o=a[1];i.points=i.points.map(function(s){return Wu(s,1e3)}),o&&(this.path=i,this.setState({pointer:n.pointer||this.path.points[this.path.points.length-1]||{x:0,y:0},path:i}),this.angles=Gre(i.points),this.emitOnChange(i),[pr.MODIFY,pr.MOVE].includes(n.type)||this.checkIfPathUpdated(r))},e.prototype.isLoaded=function(){if(this.imgError||!this.svgRef.current)return!1;var n=this.svgRef.current;return!!(n.width.baseVal.value&&n.height.baseVal.value)},e.prototype.getAspectRatio=function(){return this.imageRef.current?{x:this.imageRef.current.clientWidth/this.imageRef.current.naturalWidth,y:this.imageRef.current.clientHeight/this.imageRef.current.naturalHeight}:{x:NaN,y:NaN}},e.prototype.setPathStateFromProps=function(){if(!Sb(this.lastEmittedPoints,this.props.value)){var n=this.getAspectRatio(),r=this.svg.convertRealPointsToViewbox(this.props.value.map(function(a){var i=a.x,o=a.y;return{x:i*n.x,y:o*n.y}}));this.dispatchPathAction({type:pr.CHANGE,payload:r})}},e.prototype.getRoundedPoints=function(){return this.state.path.points.map(function(n){return Wu(n)})},e.prototype.getBorder=function(){return this.svg.getBorderPoints().map(function(n){return Wu(n)}).map(function(n){var r=n.x,a=n.y;return{x:r-1,y:a+1}})},e.prototype.getPolygonPoints=function(){var n=this.getRoundedPoints(),r=this.getBorder();return this.state.path.closed?Vu(Vu(Vu([],r,!0),n,!0),[n[0],r[0]]):r},e.prototype.getPolylinePoints=function(){var n=this.getRoundedPoints();return n.concat(this.state.path.closed?n[0]:Wu(this.state.pointer))},e.prototype.getMousePosition=function(n,r,a){r===void 0&&(r=!0),a===void 0&&(a=!0);var i=this.svg.getMouseCoordinates(n);if(a){var o=navigator.platform.includes("Mac")?n.metaKey:n.ctrlKey,s=this.path.points[this.path.points.length-1];o&&s&&(n.shiftKey?i=Ure(s,i,this.angles):i=Wre(s,i,Math.PI/12))}var l=Vre(this.path.points,i,10),u=l.point,c=l.index;return r&&c>-1&&(i=io({},u)),[i,{point:u,index:c}]},e.propTypes={value:zr.arrayOf(zr.exact({x:zr.number.isRequired,y:zr.number.isRequired})),style:zr.shape({}),viewBox:zr.exact({width:zr.number.isRequired,height:zr.number.isRequired}),disabled:zr.bool,onChange:zr.func,onComplete:zr.func,src:zr.string.isRequired,imageAlt:zr.string,crossOrigin:zr.string,imageStyle:zr.shape({}),onImageLoad:zr.func,onImageError:zr.func},e.defaultProps={value:[],style:{},imageStyle:{},viewBox:{width:1e3,height:1e3},disabled:!1,onImageError:Function.prototype,onImageLoad:Function.prototype},e}(G.Component);/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Zre=1e-7,Jre=1e-4;class D3{constructor(e,n){this.backend=e,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,n){this.dataIdsCount++,this.data.set(e,n)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}}class Cb{refCount(e){return ni("refCount")}incRef(e){return ni("incRef")}timerAvailable(){return!0}time(e){return ni("time")}read(e){return ni("read")}readSync(e){return ni("readSync")}readToGPU(e,n){return ni("readToGPU")}numDataIds(){return ni("numDataIds")}disposeData(e,n){return ni("disposeData")}write(e,n,r){return ni("write")}move(e,n,r,a,i){return ni("move")}memory(){return ni("memory")}floatPrecision(){return ni("floatPrecision")}epsilon(){return this.floatPrecision()===32?Zre:Jre}dispose(){return ni("dispose")}}function ni(t){throw new Error(`'${t}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function aP(t){let e=t.length,n=0;for(;e>0;)n=Math.random()*e|0,e--,xs(t,e,n)}function eae(t,e){if(t.length!==e.length)throw new Error(`Array sizes must match to be shuffled together First array length was ${t.length}Second array length was ${e.length}`);let n=t.length,r=0;for(;n>0;)r=Math.random()*n|0,n--,xs(t,n,r),xs(e,n,r)}function _l(t,e,n){return Math.max(t,Math.min(e,n))}function Nb(t){return t%2===0?t:t+1}function xs(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function iP(t){let e=0;for(let n=0;n<t.length;n++)e+=t[n];return e}function tae(t,e){const n=Math.random();return e*n+(1-n)*t}function nae(t,e){let n=0;for(let r=0;r<t.length;r++){const a=Number(t[r])-Number(e[r]);n+=a*a}return n}function j(t,e){if(!t)throw new Error(typeof e=="string"?e:e())}function Cr(t,e,n=""){j(tn(t,e),()=>n+` Shapes ${t} and ${e} must match`)}function Uu(t){j(t!=null,()=>"The input to the tensor constructor must be a non-null value.")}function ws(t,e=[],n=!1){if(e==null&&(e=[]),Array.isArray(t)||jr(t)&&!n)for(let r=0;r<t.length;++r)ws(t[r],e,n);else e.push(t);return e}function me(t){if(t.length===0)return 1;let e=t[0];for(let n=1;n<t.length;n++)e*=t[n];return e}function rae(t){return t.length===0}function tn(t,e){if(t===e)return!0;if(t==null||e==null||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function Gu(t){return t%1===0}function aae(t){if(Math.tanh!=null)return Math.tanh(t);if(t===1/0)return 1;if(t===-1/0)return-1;{const e=Math.exp(2*t);return(e-1)/(e+1)}}function Tb(t){const e=Math.ceil(Math.sqrt(t));return[e,Math.ceil(t/e)]}function iae(t){const e=new Uint32Array(t);for(let n=0;n<t;++n)e[n]=n;return aP(e),e}function Hu(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)}function F3(t,e=a=>0,n,r=setTimeout){return new Promise((a,i)=>{let o=0;const s=()=>{if(t()){a();return}o++;const l=e(o);if(n!=null&&o>=n){i();return}r(s,l)};s()})}function B3(t,e){let n=1,r=-1;for(let i=0;i<t.length;++i)if(t[i]>=0)n*=t[i];else if(t[i]===-1){if(r!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${r} and dim ${i}`);r=i}else if(t[i]<0)throw Error(`Shapes can not be < 0. Found ${t[i]} at dim ${i}`);if(r===-1){if(e>0&&e!==n)throw Error(`Size(${e}) must match the product of shape ${t}`);return t}if(n===0)throw Error(`Cannot infer the missing size in [${t}] when there are 0 elements`);if(e%n!==0)throw Error(`The implicit shape can't be a fractional number. Got ${e} / ${n}`);const a=t.slice();return a[r]=e/n,a}function Pt(t,e){const n=e.length;return t=t==null?e.map((r,a)=>a):[].concat(t),j(t.every(r=>r>=-n&&r<n),()=>`All values in axis param must be in range [-${n}, ${n}) but got axis ${t}`),j(t.every(r=>Gu(r)),()=>`All values in axis param must be integers but got axis ${t}`),t.map(r=>r<0?n+r:r)}function ks(t,e){const n=[],r=[],a=e!=null&&Array.isArray(e)&&e.length===0,i=e==null||a?null:Pt(e,t).sort();let o=0;for(let s=0;s<t.length;++s){if(i!=null){if(i[o]===s&&t[s]!==1)throw new Error(`Can't squeeze axis ${s} since its dim '${t[s]}' is not 1`);(i[o]==null||i[o]>s)&&t[s]===1&&(n.push(t[s]),r.push(s)),i[o]<=s&&o++}t[s]!==1&&(n.push(t[s]),r.push(s))}return{newShape:n,keptDims:r}}function nr(t,e){let n=null;if(t==null||t==="float32")n=new Float32Array(e);else if(t==="int32")n=new Int32Array(e);else if(t==="bool")n=new Uint8Array(e);else throw new Error(`Unknown data type ${t}`);return n}function rr(t,e){let n=null;if(t==null||t==="float32")n=new Float32Array(e);else if(t==="int32")n=new Int32Array(e);else if(t==="bool")n=new Uint8Array(e);else if(t==="string")n=new Array(e);else throw new Error(`Unknown data type ${t}`);return n}function oP(t,e){for(let n=0;n<t.length;n++){const r=t[n];if(isNaN(r)||!isFinite(r))throw Error(`A tensor of type ${e} being uploaded contains ${r}.`)}}function sP(t){return t==="bool"||t==="complex64"||t==="float32"||t==="int32"||t==="string"}function z3(t,e){return!(e==="complex64"||e==="float32"&&t!=="complex64"||e==="int32"&&t!=="float32"&&t!=="complex64"||e==="bool"&&t==="bool")}function jr(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray}function Ib(t){if(t==="float32"||t==="int32")return 4;if(t==="complex64")return 8;if(t==="bool")return 1;throw new Error(`Unknown dtype ${t}`)}function lP(t){if(t==null)return 0;let e=0;return t.forEach(n=>e+=n.length),e}function $o(t){return typeof t=="string"||t instanceof String}function uP(t){return typeof t=="boolean"}function cP(t){return typeof t=="number"}function jd(t){return Array.isArray(t)?jd(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray?"int32":cP(t)?"float32":$o(t)?"string":uP(t)?"bool":"float32"}function Ol(t){return!!(t&&t.constructor&&t.call&&t.apply)}function Eb(t,e){for(let n=e;n<t;++n)if(t%n===0)return n;return t}function qe(t){const e=t.length;if(e<2)return[];const n=new Array(e-1);n[e-2]=t[e-1];for(let r=e-3;r>=0;--r)n[r]=n[r+1]*t[r+1];return n}function dP(t,e,n,r=!1){const a=new Array;if(e.length===1){const i=e[0]*(r?2:1);for(let o=0;o<i;o++)a[o]=n[t+o]}else{const i=e[0],o=e.slice(1),s=o.reduce((l,u)=>l*u)*(r?2:1);for(let l=0;l<i;l++)a[l]=dP(t+l*s,o,n,r)}return a}function ri(t,e,n=!1){if(t.length===0)return e[0];const r=t.reduce((a,i)=>a*i)*(n?2:1);if(r===0)return[];if(r!==e.length)throw new Error(`[${t}] does not match the input size ${e.length}${n?" for a complex tensor":""}.`);return dP(0,t,e,n)}function _b(t,e){const n=Nr(t,e);for(let r=0;r<n.length;r++)n[r]=1;return n}function Nr(t,e){if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool")return new Uint8Array(t);throw new Error(`Unknown data type ${e}`)}function j3(t,e){const n=t.reduce((r,a)=>r*a,1);if(e==null||e==="float32")return ri(t,new Float32Array(n));if(e==="int32")return ri(t,new Int32Array(n));if(e==="bool")return ri(t,new Uint8Array(n));throw new Error(`Unknown data type ${e}`)}function V3(t){t.forEach(e=>{j(Number.isInteger(e)&&e>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${t}].`)})}function oo(t,e,n){if(e===0)return 0;if(e===1)return t[0];let r=t[t.length-1];for(let a=0;a<t.length-1;++a)r+=n[a]*t[a];return r}function qu(t,e,n){if(e===0)return[];if(e===1)return[t];const r=new Array(e);for(let a=0;a<r.length-1;++a)r[a]=Math.floor(t/n[a]),t-=r[a]*n[a];return r[r.length-1]=t,r}function Ku(t){return t&&t.then&&typeof t.then=="function"}/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const pP="tfjsflags";class hP{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=oae,this.populateURLFlags()}setPlatform(e,n){this.platform!=null&&(ce().getBool("IS_TEST")||ce().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${e}.`)),this.platformName=e,this.platform=n}registerFlag(e,n,r){if(this.flagRegistry[e]={evaluationFn:n,setHook:r},this.urlFlags[e]!=null){const a=this.urlFlags[e];ce().getBool("IS_TEST")||ce().getBool("PROD")||console.warn(`Setting feature override from URL ${e}: ${a}.`),this.set(e,a)}}async getAsync(e){return e in this.flags?this.flags[e]:(this.flags[e]=await this.evaluateFlag(e),this.flags[e])}get(e){if(e in this.flags)return this.flags[e];const n=this.evaluateFlag(e);if(Ku(n))throw new Error(`Flag ${e} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[e]=n,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,n){if(this.flagRegistry[e]==null)throw new Error(`Cannot set flag ${e} as it has not been registered.`);this.flags[e]=n,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(n)}evaluateFlag(e){if(this.flagRegistry[e]==null)throw new Error(`Cannot evaluate flag '${e}': no evaluation function found.`);return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;const e=this.getQueryParams(this.global.location.search);pP in e&&e[pP].split(",").forEach(n=>{const[r,a]=n.split(":");this.urlFlags[r]=lae(r,a)})}}function oae(t){const e={};return t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(n,...r)=>(sae(e,r[0],r[1]),r.join("="))),e}function sae(t,e,n){t[decodeURIComponent(e)]=decodeURIComponent(n||"")}function lae(t,e){if(e=e.toLowerCase(),e==="true"||e==="false")return e==="true";if(`${+e}`===e)return+e;throw new Error(`Could not parse value flag value ${e} for flag ${t}.`)}function ce(){return W3}let W3=null;function uae(t){W3=t}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/let U3;function fP(){if(U3==null){let t;if(typeof window<"u")t=window;else if(typeof global<"u")t=global;else if(typeof process<"u")t=process;else if(typeof self<"u")t=self;else throw new Error("Could not find a global object");U3=t}return U3}function cae(){const t=fP();return t._tfGlobals==null&&(t._tfGlobals=new Map),t._tfGlobals}function G3(t,e){const n=cae();if(n.has(t))return n.get(t);{const r=e();return n.set(t,r),n.get(t)}}const Ob="Abs",wf="Acos",kf="Acosh",Vd="Add",$b="AddN",Rb="All",Mb="Any",Ab="ArgMax",Pb="ArgMin",Sf="Asin",Cf="Asinh",Nf="Atan",Tf="Atanh",If="Atan2",Lb="AvgPool",H3="AvgPoolGrad",Db="AvgPool3D",q3="AvgPool3DGrad",Fb="BatchMatMul",Bb="BatchToSpaceND",zb="Bincount",dae="BroadcastTo",jb="BroadcastArgs",Ef="Cast",_f="Ceil",Of="ClipByValue",Vb="Complex",Wb="ComplexAbs",Ub="Concat",Gb="Conv2D",Hb="Conv2DBackpropFilter",qb="Conv2DBackpropInput",Kb="Conv3D",K3="Conv3DBackpropFilterV2",Xb="Conv3DBackpropInputV2",$f="Cos",Rf="Cosh",Yb="Cumprod",Qb="Cumsum",Zb="CropAndResize",Jb="DenseBincount",ev="DepthToSpace",tv="DepthwiseConv2dNative",nv="DepthwiseConv2dNativeBackpropFilter",rv="DepthwiseConv2dNativeBackpropInput",av="Diag",iv="Dilation2D",X3="Dilation2DBackpropInput",Y3="Dilation2DBackpropFilter",Mf="RealDiv",ov="Einsum",Af="Elu",Q3="EluGrad",Pf="Erf",Lf="Equal",Df="Exp",sv="ExpandDims",Ff="Expm1",lv="FFT",uv="Fill",cv="FlipLeftRight",Bf="Floor",zf="FloorDiv",dv="FusedBatchNorm",pv="GatherV2",hv="GatherNd",jf="Greater",Vf="GreaterEqual",Wf="Identity",fv="IFFT",gv="Imag",Uf="IsFinite",Gf="IsInf",Hf="IsNan",mv="LeakyRelu",qf="Less",Kf="LessEqual",yv="LinSpace",Xf="Log",Yf="Log1p",Qf="LogicalAnd",Zf="LogicalNot",Jf="LogicalOr",pae="LogicalXor",hae="LogSoftmax",fae="LowerBound",bv="LRN",Z3="LRNGrad",vv="Max",eg="Maximum",xv="MaxPool",J3="MaxPoolGrad",wv="MaxPool3D",eT="MaxPool3DGrad",kv="MaxPoolWithArgmax",Sv="Mean",Cv="Min",tg="Minimum",Nv="MirrorPad",ng="Mod",Tv="Multinomial",rg="Multiply",Iv="Neg",ag="NotEqual",Ev="NonMaxSuppressionV3",_v="NonMaxSuppressionV4",Ov="NonMaxSuppressionV5",$v="OnesLike",Rv="OneHot",Mv="Pack",Av="PadV2",gae="Pool",ig="Pow",Pv="Prelu",Lv="Prod",Dv="RaggedGather",Fv="RaggedTensorToTensor",Bv="Range",zv="Real",og="Reciprocal",sg="Relu",jv="Reshape",Vv="ResizeNearestNeighbor",tT="ResizeNearestNeighborGrad",Wv="ResizeBilinear",nT="ResizeBilinearGrad",lg="Relu6",Uv="Reverse",ug="Round",cg="Rsqrt",Gv="ScatterNd",Hv="SearchSorted",qv="Select",dg="Selu",Kv="Slice",pg="Sin",hg="Sinh",fg="Sign",gg="Sigmoid",mg="Softplus",yg="Sqrt",Xv="Sum",Yv="SpaceToBatchND",Qv="SplitV",Zv="Softmax",Jv="SparseFillEmptyRows",ex="SparseReshape",tx="SparseSegmentMean",nx="SparseSegmentSum",rx="SparseToDense",bg="SquaredDifference",rT="Square",ax="StridedSlice",ix="StringNGrams",ox="StringSplit",sx="StringToHashBucketFast",vg="Sub",xg="Tan",wg="Tanh",kg="Tile",lx="TopK",ux="Transform",Wd="Transpose",cx="Unique",dx="Unpack",px="UnsortedSegmentSum",mae="UpperBound",hx="ZerosLike",Sg="Step",fx="FromPixels",gx="RotateWithOffset",Cg="_FusedMatMul",Ng="FusedConv2D",Tg="FusedDepthwiseConv2D";/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function ai(...t){ce().getBool("IS_TEST")||ce().getBool("PROD")||console.warn(...t)}function yae(...t){ce().getBool("IS_TEST")||ce().getBool("PROD")||console.log(...t)}/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Ud=G3("kernelRegistry",()=>new Map),Ig=G3("gradRegistry",()=>new Map);function mx(t,e){const n=iT(t,e);return Ud.get(n)}function aT(t){return Ig.get(t)}function yx(t){const e=Ud.entries(),n=[];for(;;){const{done:r,value:a}=e.next();if(r)break;const[i,o]=a,[s]=i.split("_");s===t&&n.push(o)}return n}function bx(t){const{kernelName:e,backendName:n}=t,r=iT(e,n);Ud.has(r)&&ai(`The kernel '${e}' for backend '${n}' is already registered`),Ud.set(r,t)}function bae(t){const{kernelName:e}=t;Ig.has(e)&&ce().getBool("DEBUG")&&ai(`Overriding the gradient for '${e}'`),Ig.set(e,t)}function vae(t,e){const n=iT(t,e);if(!Ud.has(n))throw new Error(`The kernel '${t}' for backend '${e}' is not registered`);Ud.delete(n)}function xae(t){if(!Ig.has(t))throw new Error(`The gradient '${t}' for backend is not registered`);Ig.delete(t)}function wae(t,e){yx(t).forEach(n=>{const r=Object.assign({},n,{backendName:e});bx(r)})}function iT(t,e){return`${e}_${t}`}var gP=gn,Ni=null;try{Ni=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function gn(t,e,n){this.low=t|0,this.high=e|0,this.unsigned=!!n}gn.prototype.__isLong__,Object.defineProperty(gn.prototype,"__isLong__",{value:!0});function Da(t){return(t&&t.__isLong__)===!0}gn.isLong=Da;var mP={},yP={};function Xu(t,e){var n,r,a;return e?(t>>>=0,(a=0<=t&&t<256)&&(r=yP[t],r)?r:(n=mn(t,(t|0)<0?-1:0,!0),a&&(yP[t]=n),n)):(t|=0,(a=-128<=t&&t<128)&&(r=mP[t],r)?r:(n=mn(t,t<0?-1:0,!1),a&&(mP[t]=n),n))}gn.fromInt=Xu;function Ti(t,e){if(isNaN(t))return e?Yu:Ii;if(e){if(t<0)return Yu;if(t>=vP)return CP}else{if(t<=-xP)return Fa;if(t+1>=xP)return SP}return t<0?Ti(-t,e).neg():mn(t%Gd|0,t/Gd|0,e)}gn.fromNumber=Ti;function mn(t,e,n){return new gn(t,e,n)}gn.fromBits=mn;var vx=Math.pow;function oT(t,e,n){if(t.length===0)throw Error("empty string");if(t==="NaN"||t==="Infinity"||t==="+Infinity"||t==="-Infinity")return Ii;if(typeof e=="number"?(n=e,e=!1):e=!!e,n=n||10,n<2||36<n)throw RangeError("radix");var r;if((r=t.indexOf("-"))>0)throw Error("interior hyphen");if(r===0)return oT(t.substring(1),e,n).neg();for(var a=Ti(vx(n,8)),i=Ii,o=0;o<t.length;o+=8){var s=Math.min(8,t.length-o),l=parseInt(t.substring(o,o+s),n);if(s<8){var u=Ti(vx(n,s));i=i.mul(u).add(Ti(l))}else i=i.mul(a),i=i.add(Ti(l))}return i.unsigned=e,i}gn.fromString=oT;function so(t,e){return typeof t=="number"?Ti(t,e):typeof t=="string"?oT(t,e):mn(t.low,t.high,typeof e=="boolean"?e:t.unsigned)}gn.fromValue=so;var bP=65536,kae=1<<24,Gd=bP*bP,vP=Gd*Gd,xP=vP/2,wP=Xu(kae),Ii=Xu(0);gn.ZERO=Ii;var Yu=Xu(0,!0);gn.UZERO=Yu;var Hd=Xu(1);gn.ONE=Hd;var kP=Xu(1,!0);gn.UONE=kP;var sT=Xu(-1);gn.NEG_ONE=sT;var SP=mn(-1,2147483647,!1);gn.MAX_VALUE=SP;var CP=mn(-1,-1,!0);gn.MAX_UNSIGNED_VALUE=CP;var Fa=mn(0,-2147483648,!1);gn.MIN_VALUE=Fa;var _e=gn.prototype;_e.toInt=function(){return this.unsigned?this.low>>>0:this.low},_e.toNumber=function(){return this.unsigned?(this.high>>>0)*Gd+(this.low>>>0):this.high*Gd+(this.low>>>0)},_e.toString=function(t){if(t=t||10,t<2||36<t)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(Fa)){var e=Ti(t),n=this.div(e),r=n.mul(e).sub(this);return n.toString(t)+r.toInt().toString(t)}else return"-"+this.neg().toString(t);for(var a=Ti(vx(t,6),this.unsigned),i=this,o="";;){var s=i.div(a),l=i.sub(s.mul(a)).toInt()>>>0,u=l.toString(t);if(i=s,i.isZero())return u+o;for(;u.length<6;)u="0"+u;o=""+u+o}},_e.getHighBits=function(){return this.high},_e.getHighBitsUnsigned=function(){return this.high>>>0},_e.getLowBits=function(){return this.low},_e.getLowBitsUnsigned=function(){return this.low>>>0},_e.getNumBitsAbs=function(){if(this.isNegative())return this.eq(Fa)?64:this.neg().getNumBitsAbs();for(var t=this.high!=0?this.high:this.low,e=31;e>0&&!(t&1<<e);e--);return this.high!=0?e+33:e+1},_e.isZero=function(){return this.high===0&&this.low===0},_e.eqz=_e.isZero,_e.isNegative=function(){return!this.unsigned&&this.high<0},_e.isPositive=function(){return this.unsigned||this.high>=0},_e.isOdd=function(){return(this.low&1)===1},_e.isEven=function(){return(this.low&1)===0},_e.equals=function(t){return Da(t)||(t=so(t)),this.unsigned!==t.unsigned&&this.high>>>31===1&&t.high>>>31===1?!1:this.high===t.high&&this.low===t.low},_e.eq=_e.equals,_e.notEquals=function(t){return!this.eq(t)},_e.neq=_e.notEquals,_e.ne=_e.notEquals,_e.lessThan=function(t){return this.comp(t)<0},_e.lt=_e.lessThan,_e.lessThanOrEqual=function(t){return this.comp(t)<=0},_e.lte=_e.lessThanOrEqual,_e.le=_e.lessThanOrEqual,_e.greaterThan=function(t){return this.comp(t)>0},_e.gt=_e.greaterThan,_e.greaterThanOrEqual=function(t){return this.comp(t)>=0},_e.gte=_e.greaterThanOrEqual,_e.ge=_e.greaterThanOrEqual,_e.compare=function(t){if(Da(t)||(t=so(t)),this.eq(t))return 0;var e=this.isNegative(),n=t.isNegative();return e&&!n?-1:!e&&n?1:this.unsigned?t.high>>>0>this.high>>>0||t.high===this.high&&t.low>>>0>this.low>>>0?-1:1:this.sub(t).isNegative()?-1:1},_e.comp=_e.compare,_e.negate=function(){return!this.unsigned&&this.eq(Fa)?Fa:this.not().add(Hd)},_e.neg=_e.negate,_e.add=function(t){Da(t)||(t=so(t));var e=this.high>>>16,n=this.high&65535,r=this.low>>>16,a=this.low&65535,i=t.high>>>16,o=t.high&65535,s=t.low>>>16,l=t.low&65535,u=0,c=0,d=0,p=0;return p+=a+l,d+=p>>>16,p&=65535,d+=r+s,c+=d>>>16,d&=65535,c+=n+o,u+=c>>>16,c&=65535,u+=e+i,u&=65535,mn(d<<16|p,u<<16|c,this.unsigned)},_e.subtract=function(t){return Da(t)||(t=so(t)),this.add(t.neg())},_e.sub=_e.subtract,_e.multiply=function(t){if(this.isZero())return Ii;if(Da(t)||(t=so(t)),Ni){var e=Ni.mul(this.low,this.high,t.low,t.high);return mn(e,Ni.get_high(),this.unsigned)}if(t.isZero())return Ii;if(this.eq(Fa))return t.isOdd()?Fa:Ii;if(t.eq(Fa))return this.isOdd()?Fa:Ii;if(this.isNegative())return t.isNegative()?this.neg().mul(t.neg()):this.neg().mul(t).neg();if(t.isNegative())return this.mul(t.neg()).neg();if(this.lt(wP)&&t.lt(wP))return Ti(this.toNumber()*t.toNumber(),this.unsigned);var n=this.high>>>16,r=this.high&65535,a=this.low>>>16,i=this.low&65535,o=t.high>>>16,s=t.high&65535,l=t.low>>>16,u=t.low&65535,c=0,d=0,p=0,f=0;return f+=i*u,p+=f>>>16,f&=65535,p+=a*u,d+=p>>>16,p&=65535,p+=i*l,d+=p>>>16,p&=65535,d+=r*u,c+=d>>>16,d&=65535,d+=a*l,c+=d>>>16,d&=65535,d+=i*s,c+=d>>>16,d&=65535,c+=n*u+r*l+a*s+i*o,c&=65535,mn(p<<16|f,c<<16|d,this.unsigned)},_e.mul=_e.multiply,_e.divide=function(t){if(Da(t)||(t=so(t)),t.isZero())throw Error("division by zero");if(Ni){if(!this.unsigned&&this.high===-2147483648&&t.low===-1&&t.high===-1)return this;var e=(this.unsigned?Ni.div_u:Ni.div_s)(this.low,this.high,t.low,t.high);return mn(e,Ni.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?Yu:Ii;var n,r,a;if(this.unsigned){if(t.unsigned||(t=t.toUnsigned()),t.gt(this))return Yu;if(t.gt(this.shru(1)))return kP;a=Yu}else{if(this.eq(Fa)){if(t.eq(Hd)||t.eq(sT))return Fa;if(t.eq(Fa))return Hd;var i=this.shr(1);return n=i.div(t).shl(1),n.eq(Ii)?t.isNegative()?Hd:sT:(r=this.sub(t.mul(n)),a=n.add(r.div(t)),a)}else if(t.eq(Fa))return this.unsigned?Yu:Ii;if(this.isNegative())return t.isNegative()?this.neg().div(t.neg()):this.neg().div(t).neg();if(t.isNegative())return this.div(t.neg()).neg();a=Ii}for(r=this;r.gte(t);){n=Math.max(1,Math.floor(r.toNumber()/t.toNumber()));for(var o=Math.ceil(Math.log(n)/Math.LN2),s=o<=48?1:vx(2,o-48),l=Ti(n),u=l.mul(t);u.isNegative()||u.gt(r);)n-=s,l=Ti(n,this.unsigned),u=l.mul(t);l.isZero()&&(l=Hd),a=a.add(l),r=r.sub(u)}return a},_e.div=_e.divide,_e.modulo=function(t){if(Da(t)||(t=so(t)),Ni){var e=(this.unsigned?Ni.rem_u:Ni.rem_s)(this.low,this.high,t.low,t.high);return mn(e,Ni.get_high(),this.unsigned)}return this.sub(this.div(t).mul(t))},_e.mod=_e.modulo,_e.rem=_e.modulo,_e.not=function(){return mn(~this.low,~this.high,this.unsigned)},_e.and=function(t){return Da(t)||(t=so(t)),mn(this.low&t.low,this.high&t.high,this.unsigned)},_e.or=function(t){return Da(t)||(t=so(t)),mn(this.low|t.low,this.high|t.high,this.unsigned)},_e.xor=function(t){return Da(t)||(t=so(t)),mn(this.low^t.low,this.high^t.high,this.unsigned)},_e.shiftLeft=function(t){return Da(t)&&(t=t.toInt()),(t&=63)===0?this:t<32?mn(this.low<<t,this.high<<t|this.low>>>32-t,this.unsigned):mn(0,this.low<<t-32,this.unsigned)},_e.shl=_e.shiftLeft,_e.shiftRight=function(t){return Da(t)&&(t=t.toInt()),(t&=63)===0?this:t<32?mn(this.low>>>t|this.high<<32-t,this.high>>t,this.unsigned):mn(this.high>>t-32,this.high>=0?0:-1,this.unsigned)},_e.shr=_e.shiftRight,_e.shiftRightUnsigned=function(t){if(Da(t)&&(t=t.toInt()),t&=63,t===0)return this;var e=this.high;if(t<32){var n=this.low;return mn(n>>>t|e<<32-t,e>>>t,this.unsigned)}else return t===32?mn(e,0,this.unsigned):mn(e>>>t-32,0,this.unsigned)},_e.shru=_e.shiftRightUnsigned,_e.shr_u=_e.shiftRightUnsigned,_e.toSigned=function(){return this.unsigned?mn(this.low,this.high,!1):this},_e.toUnsigned=function(){return this.unsigned?this:mn(this.low,this.high,!0)},_e.toBytes=function(t){return t?this.toBytesLE():this.toBytesBE()},_e.toBytesLE=function(){var t=this.high,e=this.low;return[e&255,e>>>8&255,e>>>16&255,e>>>24,t&255,t>>>8&255,t>>>16&255,t>>>24]},_e.toBytesBE=function(){var t=this.high,e=this.low;return[t>>>24,t>>>16&255,t>>>8&255,t&255,e>>>24,e>>>16&255,e>>>8&255,e&255]},gn.fromBytes=function(t,e,n){return n?gn.fromBytesLE(t,e):gn.fromBytesBE(t,e)},gn.fromBytesLE=function(t,e){return new gn(t[0]|t[1]<<8|t[2]<<16|t[3]<<24,t[4]|t[5]<<8|t[6]<<16|t[7]<<24,e)},gn.fromBytesBE=function(t,e){return new gn(t[4]<<24|t[5]<<16|t[6]<<8|t[7],t[0]<<24|t[1]<<16|t[2]<<8|t[3],e)};const NP=gi(gP),Sae=h5({__proto__:null,default:NP},[gP]);/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Qu=NP||Sae;function Eg(t){return Qu.fromString(t,!0,16)}const TP=Eg("c3a5c85c97cb3127"),Zu=Eg("b492b66fbe98f273"),oa=Eg("9ae16a3b2f90404f");function lT(t){return t.xor(t.shru(47))}function IP(t,e,n){const r=t.slice(e,e+n);return Qu.fromBytes(Array.from(r),!0,!0)}function ln(t,e){return IP(t,e,8)}function EP(t,e){return IP(t,e,4)}function hr(t,e){return e===0?t:t.shru(e).or(t.shl(64-e))}function $l(t,e,n=Eg("9ddfea08eb382d69")){let r=t.xor(e).mul(n);r=r.xor(r.shru(47));let a=e.xor(r).mul(n);return a=a.xor(a.shru(47)),a=a.mul(n),a}function Cae(t,e,n,r,a,i){a=a.add(t),i=hr(i.add(a).add(r),21);const o=a;return a=a.add(e),a=a.add(n),i=i.add(hr(a,44)),[a.add(r),i.add(o)]}function xx(t,e,n,r){return Cae(ln(t,e),ln(t,e+8),ln(t,e+16),ln(t,e+24),n,r)}function Nae(t,e=t.length){if(e>=8){const n=oa.add(e*2),r=ln(t,0).add(oa),a=ln(t,e-8),i=hr(a,37).mul(n).add(r),o=hr(r,25).add(a).mul(n);return $l(i,o,n)}if(e>=4){const n=oa.add(e*2),r=EP(t,0);return $l(r.shl(3).add(e),EP(t,e-4),n)}if(e>0){const n=t[0],r=t[e>>1],a=t[e-1],i=n+(r<<8),o=e+(a<<2);return lT(oa.mul(i).xor(TP.mul(o))).mul(oa)}return oa}function Tae(t,e=t.length){const n=oa.add(e*2),r=ln(t,0).mul(Zu),a=ln(t,8),i=ln(t,e-8).mul(n),o=ln(t,e-16).mul(oa);return $l(hr(r.add(a),43).add(hr(i,30)).add(o),r.add(hr(a.add(oa),18)).add(i),n)}function Iae(t,e=t.length){const n=oa.add(e*2),r=ln(t,0).mul(oa),a=ln(t,8),i=ln(t,e-8).mul(n),o=ln(t,e-16).mul(oa),s=hr(r.add(a),43).add(hr(i,30)).add(o),l=$l(s,r.add(hr(a.add(oa),18)).add(i),n),u=ln(t,16).mul(n),c=ln(t,24),d=s.add(ln(t,e-32)).mul(n),p=l.add(ln(t,e-24)).mul(n);return $l(hr(u.add(c),43).add(hr(d,30)).add(p),u.add(hr(c.add(r),18)).add(d),n)}function _P(t,e=t.length){const n=Qu.fromNumber(81,!0);if(e<=32)return e<=16?Nae(t,e):Tae(t,e);if(e<=64)return Iae(t,e);let r=n,a=n.mul(Zu).add(113),i=lT(a.mul(oa).add(113)).mul(oa),o=[Qu.UZERO,Qu.UZERO],s=[Qu.UZERO,Qu.UZERO];r=r.mul(oa).add(ln(t,0));let l=0;const u=(e-1>>6)*64,c=u+(e-1&63)-63;do r=hr(r.add(a).add(o[0]).add(ln(t,l+8)),37).mul(Zu),a=hr(a.add(o[1]).add(ln(t,l+48)),42).mul(Zu),r=r.xor(s[1]),a=a.add(o[0]).add(ln(t,l+40)),i=hr(i.add(s[0]),33).mul(Zu),o=xx(t,l,o[1].mul(Zu),r.add(s[0])),s=xx(t,l+32,i.add(s[1]),a.add(ln(t,l+16))),[i,r]=[r,i],l+=64;while(l!==u);const d=Zu.add(i.and(255).shl(1));return l=c,s[0]=s[0].add(e-1&63),o[0]=o[0].add(s[0]),s[0]=s[0].add(o[0]),r=hr(r.add(a).add(o[0]).add(ln(t,l+8)),37).mul(d),a=hr(a.add(o[1]).add(ln(t,l+48)),42).mul(d),r=r.xor(s[1].mul(9)),a=a.add(o[0].mul(9).add(ln(t,l+40))),i=hr(i.add(s[0]),33).mul(d),o=xx(t,l,o[1].mul(d),r.add(s[0])),s=xx(t,l+32,i.add(s[1]),a.add(ln(t,l+16))),[i,r]=[r,i],$l($l(o[0],s[0],d).add(lT(a).mul(TP)).add(i),$l(o[1],s[1],d).add(r),d)}/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Ss(t,e){return e==="string"?Ro(t):Rl([t],e)}function Eae(t,e){return t instanceof Float32Array&&e==="float32"||t instanceof Int32Array&&e==="int32"||t instanceof Uint8Array&&e==="bool"}function Rl(t,e){if(e==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=ws(t)),ce().getBool("DEBUG")&&oP(t,e),Eae(t,e))return t;if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool"){const n=new Uint8Array(t.length);for(let r=0;r<n.length;++r)Math.round(t[r])!==0&&(n[r]=1);return n}else throw new Error(`Unknown data type ${e}`)}function Ba(){return ce().platform.now()}function _ae(t,e){return ce().platform.fetch(t,e)}function Ro(t,e="utf-8"){return e=e||"utf-8",ce().platform.encode(t,e)}function Cs(t,e="utf-8"){return e=e||"utf-8",ce().platform.decode(t,e)}const Oae=Object.freeze(Object.defineProperty({__proto__:null,arraysEqual:tn,assert:j,assertNonNegativeIntegerDimensions:V3,assertNonNull:Uu,assertShapesMatch:Cr,bytesFromStringArray:lP,bytesPerElement:Ib,checkConversionForErrors:oP,clamp:_l,computeStrides:qe,createScalarValue:Ss,createShuffledIndices:iae,decodeString:Cs,distSquared:nae,encodeString:Ro,fetch:_ae,fingerPrint64:_P,flatten:ws,getArrayFromDType:rr,getTypedArrayFromDType:nr,hasEncodingLoss:z3,hexToLong:Eg,indexToLoc:qu,inferDtype:jd,inferFromImplicitShape:B3,isBoolean:uP,isFunction:Ol,isInt:Gu,isNumber:cP,isPromise:Ku,isScalarShape:rae,isString:$o,isTypedArray:jr,isValidDtype:sP,locToIndex:oo,makeOnesTypedArray:_b,makeZerosNestedTypedArray:j3,makeZerosTypedArray:Nr,nearestDivisor:Eb,nearestLargerEven:Nb,now:Ba,parseAxisParam:Pt,randUniform:tae,repeatedTry:F3,rightPad:Hu,shuffle:aP,shuffleCombo:eae,sizeFromShape:me,sizeToSquarishShape:Tb,squeezeShape:ks,sum:iP,swap:xs,tanh:aae,toNestedArray:ri,toTypedArray:Rl},Symbol.toStringTag,{value:"Module"}));/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class $ae{constructor(e,n){this.backendTimer=e,this.logger=n,n==null&&(this.logger=new Mae)}profileKernel(e,n,r){let a;const i=()=>{a=r()};let o;const s=Ba();if(this.backendTimer.timerAvailable())o=this.backendTimer.time(i);else{i();for(const l of a)l.dataSync();o=Promise.resolve({kernelMs:Ba()-s})}if(ce().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let l=0;l<a.length;l++){const u=a[l];u.data().then(c=>{Rae(c,u.dtype,e)})}return{kernelName:e,outputs:a,inputs:n,timeMs:o.then(l=>l.kernelMs),extraInfo:o.then(l=>l.getExtraProfileInfo!=null?l.getExtraProfileInfo():"")}}logKernelProfile(e){const{kernelName:n,outputs:r,timeMs:a,inputs:i,extraInfo:o}=e;r.forEach(s=>{Promise.all([s.data(),a,o]).then(l=>{this.logger.logKernelProfile(n,s,l[0],l[1],i,l[2])})})}}function Rae(t,e,n){if(e!=="float32")return!1;for(let r=0;r<t.length;r++){const a=t[r];if(isNaN(a)||!isFinite(a))return console.warn(`Found ${a} in the result of '${n}'`),!0}return!1}class Mae{logKernelProfile(e,n,r,a,i,o){const s=typeof a=="number"?Hu(`${a}ms`,9):a.error,l=Hu(e,25),u=n.rank,c=n.size,d=Hu(n.shape.toString(),14);let p="";for(const f in i){const m=i[f];if(m!=null){const y=m.shape||n.shape,x=y.length;p+=`${f}: ${x}D ${x>0?y:""} `}}console.log(`%c${l}	%c${s}	%c${u}D ${d}	%c${c}	%c${p}	%c${o}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Aae(t,e,n){const r={},a={};for(let l=0;l<e.length;l++)r[e[l].id]=!0;for(let l=0;l<t.length;l++){const u=t[l],c=u.inputs;for(const d in c){const p=c[d];let f=!1;for(let m=0;m<e.length;m++)if(r[p.id]){u.outputs.forEach(y=>r[y.id]=!0),f=!0,a[u.id]=!0;break}if(f)break}}const i={};i[n.id]=!0;const o={};for(let l=t.length-1;l>=0;l--){const u=t[l],c=u.inputs;for(let d=0;d<u.outputs.length;d++)if(i[u.outputs[d].id]){for(const p in c)i[c[p].id]=!0,o[u.id]=!0;break}}const s=[];for(let l=0;l<t.length;l++){const u=t[l];if(a[u.id]&&o[u.id]){const c={};for(const p in u.inputs){const f=u.inputs[p];r[f.id]&&(c[p]=f)}const d=Object.assign({},u);d.inputs=c,d.outputs=u.outputs,s.push(d)}}return s}function Pae(t,e,n,r){for(let a=e.length-1;a>=0;a--){const i=e[a],o=[];if(i.outputs.forEach(l=>{const u=t[l.id];u!=null?o.push(u):o.push(null)}),i.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${i.kernelName}.`);const s=i.gradient(o);for(const l in i.inputs){if(!(l in s))throw new Error(`Cannot backprop through input ${l}. Available gradients found: ${Object.keys(s)}.`);const u=n(()=>s[l]());if(u.dtype!=="float32")throw new Error(`Error in gradient for op ${i.kernelName}. The gradient of input ${l} must have 'float32' dtype, but has '${u.dtype}'`);const c=i.inputs[l];if(!tn(u.shape,c.shape))throw new Error(`Error in gradient for op ${i.kernelName}. The gradient of input '${l}' has shape '${u.shape}', which does not match the shape of the input '${c.shape}'`);if(t[c.id]==null)t[c.id]=u;else{const d=t[c.id];t[c.id]=r(d,u),d.dispose()}}}}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const OP=20,_g=3,uT=7;function Lae(t,e,n,r){const a=qe(e),i=Dae(t,e,n,a),o=e.length,s=wx(t,e,n,a,i),l=["Tensor"];return r&&(l.push(`  dtype: ${n}`),l.push(`  rank: ${o}`),l.push(`  shape: [${e}]`),l.push("  values:")),l.push(s.map(u=>"    "+u).join(`
`)),l.join(`
`)}function Dae(t,e,n,r){const a=me(e),i=r[r.length-1],o=new Array(i).fill(0),s=e.length,l=n==="complex64"?$g(t):t;if(s>1)for(let u=0;u<a/i;u++){const c=u*i;for(let d=0;d<i;d++)o[d]=Math.max(o[d],Og(l[c+d],0,n).length)}return o}function Og(t,e,n){let r;return Array.isArray(t)?r=`${parseFloat(t[0].toFixed(uT))} + ${parseFloat(t[1].toFixed(uT))}j`:$o(t)?r=`'${t}'`:n==="bool"?r=$P(t):r=parseFloat(t.toFixed(uT)).toString(),Hu(r,e)}function $P(t){return t===0?"false":"true"}function wx(t,e,n,r,a,i=!0){const o=n==="complex64"?2:1,s=e[0],l=e.length;if(l===0){if(n==="complex64"){const y=$g(t);return[Og(y[0],0,n)]}return n==="bool"?[$P(t[0])]:[t[0].toString()]}if(l===1){if(s>OP){const y=_g*o;let x=Array.from(t.slice(0,y)),b=Array.from(t.slice((s-_g)*o,s*o));return n==="complex64"&&(x=$g(x),b=$g(b)),["["+x.map((v,w)=>Og(v,a[w],n)).join(", ")+", ..., "+b.map((v,w)=>Og(v,a[s-_g+w],n)).join(", ")+"]"]}return["["+(n==="complex64"?$g(t):Array.from(t)).map((y,x)=>Og(y,a[x],n)).join(", ")+"]"]}const u=e.slice(1),c=r.slice(1),d=r[0]*o,p=[];if(s>OP){for(let y=0;y<_g;y++){const x=y*d,b=x+d;p.push(...wx(t.slice(x,b),u,n,c,a,!1))}p.push("...");for(let y=s-_g;y<s;y++){const x=y*d,b=x+d;p.push(...wx(t.slice(x,b),u,n,c,a,y===s-1))}}else for(let y=0;y<s;y++){const x=y*d,b=x+d;p.push(...wx(t.slice(x,b),u,n,c,a,y===s-1))}const f=l===2?",":"";p[0]="["+p[0]+f;for(let y=1;y<p.length-1;y++)p[y]=" "+p[y]+f;let m=`,
`;for(let y=2;y<l;y++)m+=`
`;return p[p.length-1]=" "+p[p.length-1]+"]"+(i?"":m),p}function $g(t){const e=[];for(let n=0;n<t.length;n+=2)e.push([t[n],t[n+1]]);return e}/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class ar{constructor(e,n,r){if(this.dtype=n,this.shape=e.slice(),this.size=me(e),r!=null){const a=r.length;j(a===this.size,()=>`Length of values '${a}' does not match the size inferred by the shape '${this.size}'.`)}if(n==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||rr(n,this.size),this.strides=qe(e)}set(e,...n){n.length===0&&(n=[0]),j(n.length===this.rank,()=>`The number of provided coordinates (${n.length}) must match the rank (${this.rank})`);const r=this.locToIndex(n);this.values[r]=e}get(...e){e.length===0&&(e=[0]);let n=0;for(const a of e){if(a<0||a>=this.shape[n]){const i=`Requested out of range element at ${e}.   Buffer shape=${this.shape}`;throw new Error(i)}n++}let r=e[e.length-1];for(let a=0;a<e.length-1;++a)r+=this.strides[a]*e[a];return this.values[r]}locToIndex(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];let n=e[e.length-1];for(let r=0;r<e.length-1;++r)n+=this.strides[r]*e[r];return n}indexToLoc(e){if(this.rank===0)return[];if(this.rank===1)return[e];const n=new Array(this.shape.length);for(let r=0;r<n.length-1;++r)n[r]=Math.floor(e/this.strides[r]),e-=n[r]*this.strides[r];return n[n.length-1]=e,n}get rank(){return this.shape.length}toTensor(){return lo().makeTensor(this.values,this.shape,this.dtype)}}let lo=null,qd=null;function Fae(t){lo=t}function Bae(t){qd=t}class In{constructor(e,n,r,a){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=n||"float32",this.size=me(e),this.strides=qe(e),this.dataId=r,this.id=a,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const e=await this.data();return qd.buffer(this.shape,this.dtype,e)}bufferSync(){return qd.buffer(this.shape,this.dtype,this.dataSync())}async array(){const e=await this.data();return ri(this.shape,e,this.dtype==="complex64")}arraySync(){return ri(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();const e=lo().read(this.dataId);if(this.dtype==="string"){const n=await e;try{return n.map(r=>Cs(r))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),lo().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();const e=lo().readSync(this.dataId);if(this.dtype==="string")try{return e.map(n=>Cs(n))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();const e=await lo().read(this.dataId);return this.dtype==="string"?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(lo().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(e=!1){return qd.print(this,e)}clone(){return this.throwIfDisposed(),qd.clone(this)}toString(e=!1){const n=this.dataSync();return Lae(n,this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),qd.cast(this,e)}variable(e=!0,n,r){return this.throwIfDisposed(),lo().makeVariable(this,e,n,r)}}Object.defineProperty(In,Symbol.hasInstance,{value:t=>!!t&&t.data!=null&&t.dataSync!=null&&t.throwIfDisposed!=null});function zae(){return G3("Tensor",()=>In)}zae();class Rg extends In{constructor(e,n,r,a){super(e.shape,e.dtype,e.dataId,a),this.trainable=n,this.name=r}assign(e){if(e.dtype!==this.dtype)throw new Error(`dtype of the new value (${e.dtype}) and previous value (${this.dtype}) must match`);if(!tn(e.shape,this.shape))throw new Error(`shape of the new value (${e.shape}) and previous value (${this.shape}) must match`);lo().disposeTensor(this),this.dataId=e.dataId,lo().incRef(this,null)}dispose(){lo().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(Rg,Symbol.hasInstance,{value:t=>t instanceof In&&t.assign!=null&&t.assign instanceof Function});/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/var cT;(function(t){t.R0="R0",t.R1="R1",t.R2="R2",t.R3="R3",t.R4="R4",t.R5="R5",t.R6="R6"})(cT||(cT={}));var dT;(function(t){t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64"})(dT||(dT={}));var pT;(function(t){t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64"})(pT||(pT={}));var hT;(function(t){t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64"})(hT||(hT={}));var fT;(function(t){t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64"})(fT||(fT={}));const jae={float32:hT,int32:dT,bool:pT,complex64:fT};function Sa(t,e){if(t==="string"||e==="string"){if(t==="string"&&e==="string")return"string";throw new Error(`Can not upcast ${t} with ${e}`)}return jae[t][e]}function kx(t){return Sa(t,"int32")}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function En(t,e){if(t.dtype===e.dtype)return[t,e];const n=Sa(t.dtype,e.dtype);return[t.cast(n),e.cast(n)]}function RP(t,e){j(t.dtype===e.dtype,()=>`The dtypes of the first(${t.dtype}) and second(${e.dtype}) input must match`)}function Vae(t,e){return e.some(n=>n.id===t.id)}function gT(t){const e=[];return MP(t,e,new Set),e}function MP(t,e,n){if(t==null)return;if(t instanceof In){e.push(t);return}if(!Wae(t))return;const r=t;for(const a in r){const i=r[a];n.has(i)||(n.add(i),MP(i,e,n))}}function Wae(t){return Array.isArray(t)||typeof t=="object"}const Uae=Object.freeze(Object.defineProperty({__proto__:null,assertTypesMatch:RP,getTensorsInContainer:gT,isTensorInList:Vae,makeTypesMatch:En},Symbol.toStringTag,{value:"Module"}));/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function mT(t){return t.kernelName!=null}class AP{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(e=>e.name)))}}}dispose(){for(const e in this.registeredVariables)this.registeredVariables[e].dispose()}}class Ap{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new AP}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;const e=this.getSortedBackends();for(let n=0;n<e.length;n++){const r=e[n];if(await this.initializeBackend(r).success){await this.setBackend(r);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){const{name:e,asyncInit:n}=this.initializeBackendsAndReturnBest();if(n)throw new Error(`The highest priority backend '${e}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry))if(e in this.registryFactory){const{asyncInit:n}=this.initializeBackend(e);if(n)return null}else return null;return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,n,r=1){return e in this.registryFactory?(ai(`${e} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[e]={factory:n,priority:r},!0)}async setBackend(e){if(this.registryFactory[e]==null)throw new Error(`Backend name '${e}' not found in registry`);if(this.backendName=e,this.registry[e]==null){this.backendInstance=null;const{success:n,asyncInit:r}=this.initializeBackend(e);if(!(r?await n:n))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new $ae(this.backendInstance),!0}setupRegisteredKernels(){yx(this.backendName).forEach(e=>{e.setupFunc!=null&&e.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){yx(e).forEach(n=>{n.disposeFunc!=null&&n.disposeFunc(this.registry[e])})}initializeBackend(e){const n=this.registryFactory[e];if(n==null)throw new Error(`Cannot initialize backend ${e}, no registration found.`);try{const r=n.factory();if(r&&!(r instanceof Cb)&&typeof r.then=="function"){const a=++this.pendingBackendInitId,i=r.then(o=>a<this.pendingBackendInitId?!1:(this.registry[e]=o,this.pendingBackendInit=null,!0)).catch(o=>(a<this.pendingBackendInitId||(this.pendingBackendInit=null,ai(`Initialization of backend ${e} failed`),ai(o.stack||o.message)),!1));return this.pendingBackendInit=i,{success:i,asyncInit:!0}}else return this.registry[e]=r,{success:!0,asyncInit:!1}}catch(r){return ai(`Initialization of backend ${e} failed`),ai(r.stack||r.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error(`${e} backend not found in registry`);this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((e,n)=>this.registryFactory[n].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){const e=this.getSortedBackends();for(let n=0;n<e.length;n++){const r=e[n],{success:a,asyncInit:i}=this.initializeBackend(r);if(i||a)return{name:r,asyncInit:i}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,n){const r=this.state.tensorInfo.get(n),a=r.backend,i=this.readSync(n),o=a.refCount(n);a.disposeData(n,!0),r.backend=e,e.move(n,i,r.shape,r.dtype,o),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,n){let r=null;if(n==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");n=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof n!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");r=e}let a;return this.scopedRun(()=>this.startScope(r),()=>this.endScope(a),()=>(a=n(),a instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),a))}scopedRun(e,n,r){e();try{const a=r();return n(),a}catch(a){throw n(),a}}nextTensorId(){return Ap.nextTensorId++}nextVariableId(){return Ap.nextVariableId++}clone(e){const n=te.runKernel(Wf,{x:e}),r={x:e},a=o=>({x:()=>{const s="float32",l={x:o},u={dtype:s};return te.runKernel(Ef,l,u)}}),i=[];return this.addTapeNode(this.state.activeScope.name,r,[n],a,i,{}),n}runKernel(e,n,r){if(this.backendName==null&&this.backend,mx(e,this.backendName)==null)throw new Error(`Kernel '${e}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:e,inputs:n,attrs:r})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,n,r){const a=this.backend.numDataIds();let i=0;r.forEach(l=>{i+=l.dtype==="complex64"?3:1});const o=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],s=a-n-i-o;if(s>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${s} data ids) after running '${e}'`)}runKernelFunc(e){let n,r=[];const a=this.isTapeOn(),i=this.state.numBytes,o=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let s;this.backendName==null&&this.backend;let l;const u=mT(e)?e.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(mT(e)){const{kernelName:m,inputs:y,attrs:x}=e;this.backendName==null&&this.backend;const b=mx(m,this.backendName);j(b!=null,()=>`Cannot find registered kernel '${m}' for backend '${this.backendName}'`),s=()=>{const v=this.backend.numDataIds();l=b.kernelFunc({inputs:y,attrs:x,backend:this.backend});const w=Array.isArray(l)?l:[l];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(m,v,w);const S=w.map(C=>C.rank!=null?C:this.makeTensorFromTensorInfo(C));if(a){const C=this.getTensorsForGradient(m,y,S);r=this.saveTensorsForBackwardMode(C)}return S}}else{const{forwardFunc:m}=e,y=x=>{a&&(r=x.map(b=>this.keep(this.clone(b))))};s=()=>{const x=this.backend.numDataIds();l=this.tidy(()=>m(this.backend,y));const b=Array.isArray(l)?l:[l];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(u,x,b),b}}const{inputs:c,attrs:d}=e,p=mT(e)?null:e.backwardsFunc;let f;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?n=s():(f=this.profiler.profileKernel(u,c,()=>s()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(f),n=f.outputs)}),a&&this.addTapeNode(u,c,n,p,r,d),this.state.profiling&&this.state.activeProfile.kernels.push({name:u,bytesAdded:this.state.numBytes-i,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-o,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(c).map(m=>c[m]!=null?c[m].shape:null),outputShapes:n.map(m=>m.shape),kernelTimeMs:f.timeMs,extraInfo:f.extraInfo}),Array.isArray(l)?n:n[0]}saveTensorsForBackwardMode(e){return e.map(n=>this.keep(this.clone(n)))}getTensorsForGradient(e,n,r){const a=aT(e);if(a!=null){const i=a.inputsToSave||[],o=a.outputsToSave||[];let s;a.saveAllInputs?(j(Array.isArray(n),()=>"saveAllInputs is true, expected inputs to be an array."),s=Object.keys(n).map(u=>n[u])):s=i.map(u=>n[u]);const l=r.filter((u,c)=>o[c]);return s.concat(l)}return[]}makeTensor(e,n,r,a){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");r=r||"float32",a=a||this.backend;let i=e;r==="string"&&$o(e[0])&&(i=e.map(l=>Ro(l)));const o=a.write(i,n,r),s=new In(n,r,o,this.nextTensorId());if(this.trackTensor(s,a),r==="string"){const l=this.state.tensorInfo.get(o),u=lP(i);this.state.numBytes+=u-l.bytes,l.bytes=u}return s}makeTensorFromDataId(e,n,r,a){r=r||"float32";const i={dataId:e,shape:n,dtype:r};return this.makeTensorFromTensorInfo(i,a)}makeTensorFromTensorInfo(e,n){const{dataId:r,shape:a,dtype:i}=e,o=new In(a,i,r,this.nextTensorId());return this.trackTensor(o,n),o}makeVariable(e,n=!0,r,a){r=r||this.nextVariableId().toString(),a!=null&&a!==e.dtype&&(e=e.cast(a));const i=new Rg(e,n,r,this.nextTensorId());if(this.state.registeredVariables[i.name]!=null)throw new Error(`Variable with name ${i.name} was already registered`);return this.state.registeredVariables[i.name]=i,this.incRef(i,this.backend),i}trackTensor(e,n){this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++;let r=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(r=e.size*Ib(e.dtype)),this.state.numBytes+=r,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:n||this.backend,dtype:e.dtype,shape:e.shape,bytes:r})),e instanceof Rg||this.track(e)}incRef(e,n){this.trackTensor(e,n),this.backend.incRef(e.dataId)}removeDataId(e,n){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===n&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;const n=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,e.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=n.bytes),e.dtype!=="complex64"&&e.dtype!=="string"){const r=e.size*Ib(e.dtype);this.state.numBytes-=r}n.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,n.backend)}disposeVariables(){for(const e in this.state.registeredVariables){const n=this.state.registeredVariables[e];this.disposeVariable(n)}}disposeVariable(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]}memory(){const e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;const n=this.state.numBytes,r=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(a=>a.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-r;for(const a of this.state.activeProfile.kernels)a.kernelTimeMs=await a.kernelTimeMs,a.extraInfo=await a.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(e,n,r,a,i,o){const s={id:this.state.nextTapeNodeId++,kernelName:e,inputs:n,outputs:r,saved:i},l=aT(e);l!=null&&(a=l.gradFunc),a!=null&&(s.gradient=u=>(u=u.map((c,d)=>{if(c==null){const p=r[d],f=Nr(p.size,p.dtype);return this.makeTensor(f,p.shape,p.dtype)}return c}),a(u.length>1?u:u[0],i,o))),this.state.activeTape.push(s)}keep(e){return e.kept=!0,e}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){const n={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(n.name=e),this.state.scopeStack.push(n),this.state.activeScope=n}endScope(e){const n=gT(e),r=new Set(n.map(i=>i.id));for(let i=0;i<this.state.activeScope.track.length;i++){const o=this.state.activeScope.track[i];!o.kept&&!r.has(o.id)&&o.dispose()}const a=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach(i=>{!i.kept&&i.scopeId===a.id&&this.track(i)})}gradients(e,n,r,a=!1){if(j(n.length>0,()=>"gradients() received an empty list of xs."),r!=null&&r.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${r.dtype}'`);const i=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",e));j(i instanceof In,()=>"The result y returned by f() must be a tensor.");const o=Aae(this.state.activeTape,n,i);if(!a&&o.length===0&&n.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const s={};s[i.id]=r??Gae(i.shape),Pae(s,o,u=>this.tidy(u),Hae);const l=n.map(u=>s[u.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(u=>{for(const c of u.saved)c.dispose()}),this.state.activeTape=null),{value:i,grads:l}})}customGrad(e){return j(Ol(e),()=>"The f passed in customGrad(f) must be a function."),(...n)=>{j(n.every(s=>s instanceof In),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let r;const a={};n.forEach((s,l)=>{a[l]=s});const i=(s,l)=>(r=e(...n,l),j(r.value instanceof In,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),j(Ol(r.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),r.value),o=(s,l)=>{const u=r.gradFunc(s,l),c=Array.isArray(u)?u:[u];j(c.length===n.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),j(c.every(p=>p instanceof In),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const d={};return c.forEach((p,f)=>{d[f]=()=>p}),d};return this.runKernelFunc({forwardFunc:i,backwardsFunc:o,inputs:a})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,n){return this.state.tensorInfo.get(e).backend.readToGPU(e,n)}async time(e){const n=Ba(),r=await this.backend.time(e);return r.wallMs=Ba()-n,r}track(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new AP;for(const e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}Ap.nextTensorId=0,Ap.nextVariableId=0;function Gae(t){const e=_b(me(t),"float32");return te.makeTensor(e,t,"float32")}function PP(){const t=fP();if(t._tfengine==null){const e=new hP(t);t._tfengine=new Ap(e)}return uae(t._tfengine.ENV),Fae(()=>t._tfengine),t._tfengine}const te=PP();function Hae(t,e){const n={a:t,b:e};return te.runKernel(Vd,n)}/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function qae(){return typeof navigator<"u"&&navigator!=null}let yT;function Kae(t){yT=t}function bT(t){if(yT!==void 0)return yT;if(t||qae()){if(t||(t=navigator),t.product==="ReactNative")return!0;const e=t.userAgent||t.vendor||(typeof window<"u"?window.opera:"");if(!e){const n=t;return n.userAgentData&&n.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}return!1}function vT(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}const Xae=Object.freeze(Object.defineProperty({__proto__:null,isBrowser:vT,isMobile:bT,mockIsMobile:Kae},Symbol.toStringTag,{value:"Module"}));/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const za=ce();za.registerFlag("DEBUG",()=>!1,t=>{t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")}),za.registerFlag("IS_BROWSER",()=>vT()),za.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"),za.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)),za.registerFlag("PROD",()=>!1),za.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>za.getBool("DEBUG")),za.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0),za.registerFlag("IS_TEST",()=>!1),za.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>!0),za.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1),za.registerFlag("ENGINE_COMPILE_ONLY",()=>!1),za.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1),za.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Mo(t,e){let n=t;if(jr(t))return e==="string"?[]:[t.length];if(!Array.isArray(t))return[];const r=[];for(;Array.isArray(n)||jr(n)&&e!=="string";)r.push(n.length),n=n[0];return Array.isArray(t)&&ce().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&LP(t,r,[]),r}function LP(t,e,n){if(n=n||[],!Array.isArray(t)&&!jr(t)){j(e.length===0,()=>`Element arr[${n.join("][")}] is a primitive, but should be an array/TypedArray of ${e[0]} elements`);return}j(e.length>0,()=>`Element arr[${n.join("][")}] should be a primitive, but is an array of ${t.length} elements`),j(t.length===e[0],()=>`Element arr[${n.join("][")}] should have ${e[0]} elements, but has ${t.length} elements`);const r=e.slice(1);for(let a=0;a<t.length;++a)LP(t[a],r,n.concat(a))}function DP(t,e,n,r){if(t!=="string_or_numeric"){if(t==null)throw new Error("Expected dtype cannot be null.");if(t!=="numeric"&&t!==e||t==="numeric"&&e==="string")throw new Error(`Argument '${n}' passed to '${r}' must be ${t} tensor, but got ${e} tensor`)}}function B(t,e,n,r="numeric"){if(t instanceof In)return DP(r,t.dtype,e,n),t;let a=jd(t);if(a!=="string"&&["bool","int32","float32"].indexOf(r)>=0&&(a=r),DP(r,a,e,n),t==null||!jr(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string"){const s=t==null?"null":t.constructor.name;throw new Error(`Argument '${e}' passed to '${n}' must be a Tensor or TensorLike, but got '${s}'`)}const i=Mo(t,a);!jr(t)&&!Array.isArray(t)&&(t=[t]);const o=a!=="string"?Rl(t,a):ws(t,[],!0);return te.makeTensor(o,i,a)}function Mg(t,e,n,r="numeric"){if(!Array.isArray(t))throw new Error(`Argument ${e} passed to ${n} must be a \`Tensor[]\` or \`TensorLike[]\``);return t.map((a,i)=>B(a,`${e}[${i}]`,n,r))}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const xT="__op";function ee(t){const e=Object.keys(t);if(e.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${e.length} keys.`);let n=e[0];const r=t[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n=n+xT;const a=(...i)=>{te.startScope(n);try{const o=r(...i);return Ku(o)&&console.error("Cannot return a Promise inside of tidy."),te.endScope(o),o}catch(o){throw te.endScope(null),o}};return Object.defineProperty(a,"name",{value:n,configurable:!0}),a}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Yae(t,e){const n=B(t,"real","complex"),r=B(e,"imag","complex");Cr(n.shape,r.shape,`real and imag shapes, ${n.shape} and ${r.shape}, must match in call to tf.complex().`);const a={real:n,imag:r};return te.runKernel(Vb,a)}const Ns=ee({complex_:Yae});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Ml(t,e,n,r){if(r==null&&(r=jd(t)),r==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!jr(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(e!=null){V3(e);const a=me(e),i=me(n);j(a===i,()=>`Based on the provided shape, [${e}], the tensor should have ${a} values but has ${i}`);for(let o=0;o<n.length;++o){const s=n[o],l=o===n.length-1?s!==me(e.slice(o)):!0;j(n[o]===e[o]||!l,()=>`Error creating a new Tensor. Inferred shape (${n}) does not match the provided shape (${e}). `)}}return!jr(t)&&!Array.isArray(t)&&(t=[t]),e=e||n,t=r!=="string"?Rl(t,r):ws(t,[],!0),te.makeTensor(t,e,r)}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function uo(t,e,n){const r=Mo(t,n);return Ml(t,e,r,n)}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const wT={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Sx=4;async function Qae(t,e){const n=[],r=[],a=Array.isArray(t)?t.map(o=>o.name):Object.keys(t);for(let o=0;o<a.length;++o){const s=a[o],l=Array.isArray(t)?t[o].tensor:t[s];if(l.dtype!=="float32"&&l.dtype!=="int32"&&l.dtype!=="bool"&&l.dtype!=="string"&&l.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${s}': ${l.dtype}`);const u={name:s,shape:l.shape,dtype:l.dtype};if(l.dtype==="string"){const c=new Promise(async d=>{const p=await l.bytes(),f=p.reduce((x,b)=>x+b.length,0)+Sx*p.length,m=new Uint8Array(f);let y=0;for(let x=0;x<p.length;x++){const b=p[x],v=new Uint8Array(new Uint32Array([b.length]).buffer);m.set(v,y),y+=Sx,m.set(b,y),y+=b.length}d(m)});r.push(c)}else r.push(l.data());e!=null&&(u.group=e),n.push(u)}const i=await Promise.all(r);return{data:Zae(i),specs:n}}function FP(t,e){const n={};let r,a=0;for(const i of e){const o=i.name,s=i.dtype,l=i.shape,u=me(l);let c;if("quantization"in i){const d=i.quantization;if(d.dtype==="uint8"||d.dtype==="uint16"){if(!("min"in d&&"scale"in d))throw new Error(`Weight ${i.name} with quantization ${d.dtype} doesn't have corresponding metadata min and scale.`)}else if(d.dtype==="float16"){if(s!=="float32")throw new Error(`Weight ${i.name} is quantized with ${d.dtype} which only supports weights of type float32 not ${s}.`)}else throw new Error(`Weight ${i.name} has unknown quantization dtype ${d.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);const p=wT[d.dtype],f=t.slice(a,a+u*p),m=d.dtype==="uint8"?new Uint8Array(f):new Uint16Array(f);if(s==="float32")if(d.dtype==="uint8"||d.dtype==="uint16"){c=new Float32Array(m.length);for(let y=0;y<m.length;y++){const x=m[y];c[y]=x*d.scale+d.min}}else if(d.dtype==="float16")r===void 0&&(r=aie()),c=r(m);else throw new Error(`Unsupported quantization type ${d.dtype} for weight type float32.`);else if(s==="int32"){if(d.dtype!=="uint8"&&d.dtype!=="uint16")throw new Error(`Unsupported quantization type ${d.dtype} for weight type int32.`);c=new Int32Array(m.length);for(let y=0;y<m.length;y++){const x=m[y];c[y]=Math.round(x*d.scale+d.min)}}else throw new Error(`Unsupported dtype in weight '${o}': ${s}`);a+=u*p}else if(s==="string"){const d=me(i.shape);c=[];for(let p=0;p<d;p++){const f=new Uint32Array(t.slice(a,a+Sx))[0];a+=Sx;const m=new Uint8Array(t.slice(a,a+f));c.push(m),a+=f}}else{const d=wT[s],p=t.slice(a,a+u*d);if(s==="float32")c=new Float32Array(p);else if(s==="int32")c=new Int32Array(p);else if(s==="bool")c=new Uint8Array(p);else if(s==="complex64"){c=new Float32Array(p);const f=new Float32Array(c.length/2),m=new Float32Array(c.length/2);for(let b=0;b<f.length;b++)f[b]=c[b*2],m[b]=c[b*2+1];const y=uo(f,l,"float32"),x=uo(m,l,"float32");n[o]=Ns(y,x),y.dispose(),x.dispose()}else throw new Error(`Unsupported dtype in weight '${o}': ${s}`);a+=u*d}s!=="complex64"&&(n[o]=uo(c,l,s))}return n}function Zae(t){if(t===null)throw new Error(`Invalid input value: ${JSON.stringify(t)}`);let e=0;const n=[];t.forEach(i=>{if(e+=i.byteLength,n.push(i.byteLength===i.buffer.byteLength?i:new i.constructor(i)),!(i instanceof Float32Array||i instanceof Int32Array||i instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${i.constructor.name}`)});const r=new Uint8Array(e);let a=0;return n.forEach(i=>{r.set(new Uint8Array(i.buffer),a),a+=i.byteLength}),r.buffer}const kT=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function BP(t){return kT?Buffer.byteLength(t):new Blob([t]).size}function Jae(t){if(kT)return Buffer.from(t).toString("base64");const e=new Uint8Array(t);let n="";for(let r=0,a=e.length;r<a;r++)n+=String.fromCharCode(e[r]);return btoa(n)}function eie(t){if(kT){const r=Buffer.from(t,"base64");return r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength)}const e=atob(t),n=new Uint8Array(e.length);for(let r=0;r<e.length;++r)n.set([e.charCodeAt(r)],r);return n.buffer}function ST(t){if(t.length===1)return t[0];let e=0;t.forEach(a=>{e+=a.byteLength});const n=new Uint8Array(e);let r=0;return t.forEach(a=>{n.set(new Uint8Array(a),r),r+=a.byteLength}),n.buffer}function zP(t){const e="/";for(t=t.trim();t.endsWith(e);)t=t.slice(0,t.length-1);const n=t.split(e);return n[n.length-1]}function jP(t,e){const n={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:e};return t.signature!=null&&(n.signature=t.signature),t.userDefinedMetadata!=null&&(n.userDefinedMetadata=t.userDefinedMetadata),t.modelInitializer!=null&&(n.modelInitializer=t.modelInitializer),t.trainingConfig!=null&&(n.trainingConfig=t.trainingConfig),n}function VP(t,e,n){const r={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy};if(t.trainingConfig!=null&&(r.trainingConfig=t.trainingConfig),t.weightsManifest!=null){if(!e)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!n)throw new Error("modelJSON has weightsManifest but weightData is null");r.weightSpecs=e,r.weightData=n}return t.signature!=null&&(r.signature=t.signature),t.userDefinedMetadata!=null&&(r.userDefinedMetadata=t.userDefinedMetadata),t.modelInitializer!=null&&(r.modelInitializer=t.modelInitializer),r}async function CT(t,e){let n,r;return t.weightsManifest!=null&&([n,r]=await e(t.weightsManifest)),VP(t,n,r)}function Ag(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:t.modelTopology==null?0:BP(JSON.stringify(t.modelTopology)),weightSpecsBytes:t.weightSpecs==null?0:BP(JSON.stringify(t.weightSpecs)),weightDataBytes:t.weightData==null?0:t.weightData.byteLength}}function WP(t){const e=[];for(const n of t)e.push(...n.weights);return e}function tie(){const t=n=>{let r=n<<13,a=0;for(;!(r&8388608);)a-=8388608,r<<=1;return r&=-8388609,a+=947912704,r|a},e=new Uint32Array(2048);e[0]=0;for(let n=1;n<1024;n++)e[n]=t(n);for(let n=1024;n<2048;n++)e[n]=939524096+(n-1024<<13);return e}function nie(){const t=new Uint32Array(64);t[0]=0,t[31]=1199570944,t[32]=2147483648,t[63]=3347054592;for(let e=1;e<31;e++)t[e]=e<<23;for(let e=33;e<63;e++)t[e]=2147483648+(e-32<<23);return t}function rie(){const t=new Uint32Array(64);for(let e=0;e<64;e++)t[e]=1024;return t[0]=t[32]=0,t}function aie(){const t=tie(),e=nie(),n=rie();return r=>{const a=new ArrayBuffer(4*r.length),i=new Uint32Array(a);for(let o=0;o<r.length;o++){const s=r[o],l=t[n[s>>10]+(s&1023)]+e[s>>10];i[o]=l}return new Float32Array(a)}}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class _n{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return _n.instance==null&&(_n.instance=new _n),_n.instance}static registerSaveRouter(e){_n.getInstance().saveRouters.push(e)}static registerLoadRouter(e){_n.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return _n.getHandlers(e,"save")}static getLoadHandlers(e,n){return _n.getHandlers(e,"load",n)}static getHandlers(e,n,r){const a=[];return(n==="load"?_n.getInstance().loadRouters:_n.getInstance().saveRouters).forEach(i=>{const o=i(e,r);o!==null&&a.push(o)}),a}}const iie=t=>_n.registerSaveRouter(t),oie=t=>_n.registerLoadRouter(t),sie=t=>_n.getSaveHandlers(t),lie=(t,e)=>_n.getLoadHandlers(t,e);/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const NT="tensorflowjs",TT=1,Ju="models_store",Al="model_info_store";function UP(){if(!ce().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const t=typeof window>"u"?self:window,e=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(e==null)throw new Error("The current browser does not appear to support IndexedDB.");return e}function IT(t){const e=t.result;e.createObjectStore(Ju,{keyPath:"modelPath"}),e.createObjectStore(Al,{keyPath:"modelPath"})}class ec{constructor(e){if(this.indexedDB=UP(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,n){return new Promise((r,a)=>{const i=this.indexedDB.open(NT,TT);i.onupgradeneeded=()=>IT(i),i.onsuccess=()=>{const o=i.result;if(n==null){const s=o.transaction(Ju,"readonly"),l=s.objectStore(Ju).get(this.modelPath);l.onsuccess=()=>{if(l.result==null)return o.close(),a(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));r(l.result.modelArtifacts)},l.onerror=u=>(o.close(),a(l.error)),s.oncomplete=()=>o.close()}else{const s=Ag(n),l=o.transaction(Al,"readwrite");let u=l.objectStore(Al);const c=u.put({modelPath:this.modelPath,modelArtifactsInfo:s});let d;c.onsuccess=()=>{d=o.transaction(Ju,"readwrite");const p=d.objectStore(Ju).put({modelPath:this.modelPath,modelArtifacts:n,modelArtifactsInfo:s});p.onsuccess=()=>r({modelArtifactsInfo:s}),p.onerror=f=>{u=l.objectStore(Al);const m=u.delete(this.modelPath);m.onsuccess=()=>(o.close(),a(p.error)),m.onerror=y=>(o.close(),a(p.error))}},c.onerror=p=>(o.close(),a(c.error)),l.oncomplete=()=>{d==null?o.close():d.oncomplete=()=>o.close()}}},i.onerror=o=>a(i.error)})}}ec.URL_SCHEME="indexeddb://";const GP=t=>ce().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(ec.URL_SCHEME)?uie(t.slice(ec.URL_SCHEME.length)):null;_n.registerSaveRouter(GP),_n.registerLoadRouter(GP);function uie(t){return new ec(t)}function cie(t){return t.startsWith(ec.URL_SCHEME)?t.slice(ec.URL_SCHEME.length):t}class die{constructor(){this.indexedDB=UP()}async listModels(){return new Promise((e,n)=>{const r=this.indexedDB.open(NT,TT);r.onupgradeneeded=()=>IT(r),r.onsuccess=()=>{const a=r.result,i=a.transaction(Al,"readonly"),o=i.objectStore(Al).getAll();o.onsuccess=()=>{const s={};for(const l of o.result)s[l.modelPath]=l.modelArtifactsInfo;e(s)},o.onerror=s=>(a.close(),n(o.error)),i.oncomplete=()=>a.close()},r.onerror=a=>n(r.error)})}async removeModel(e){return e=cie(e),new Promise((n,r)=>{const a=this.indexedDB.open(NT,TT);a.onupgradeneeded=()=>IT(a),a.onsuccess=()=>{const i=a.result,o=i.transaction(Al,"readwrite"),s=o.objectStore(Al),l=s.get(e);let u;l.onsuccess=()=>{if(l.result==null)return i.close(),r(new Error(`Cannot find model with path '${e}' in IndexedDB.`));{const c=s.delete(e),d=()=>{u=i.transaction(Ju,"readwrite");const p=u.objectStore(Ju).delete(e);p.onsuccess=()=>n(l.result.modelArtifactsInfo),p.onerror=f=>r(l.error)};c.onsuccess=d,c.onerror=p=>(d(),i.close(),r(l.error))}},l.onerror=c=>(i.close(),r(l.error)),o.oncomplete=()=>{u==null?i.close():u.oncomplete=()=>i.close()}},a.onerror=i=>r(a.error)})}}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Ts="/",Kd="tensorflowjs_models",HP="info",pie="model_topology",hie="weight_specs",fie="weight_data",gie="model_metadata";function qP(t){return{info:[Kd,t,HP].join(Ts),topology:[Kd,t,pie].join(Ts),weightSpecs:[Kd,t,hie].join(Ts),weightData:[Kd,t,fie].join(Ts),modelMetadata:[Kd,t,gie].join(Ts)}}function KP(t){for(const e of Object.values(t))window.localStorage.removeItem(e)}function mie(t){const e=t.split(Ts);if(e.length<3)throw new Error(`Invalid key format: ${t}`);return e.slice(1,e.length-1).join(Ts)}function yie(t){return t.startsWith(tc.URL_SCHEME)?t.slice(tc.URL_SCHEME.length):t}class tc{constructor(e){if(!ce().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=qP(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const n=JSON.stringify(e.modelTopology),r=JSON.stringify(e.weightSpecs),a=Ag(e);try{this.LS.setItem(this.keys.info,JSON.stringify(a)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,Jae(e.weightData));const i={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:e.signature!=null?e.signature:void 0,userDefinedMetadata:e.userDefinedMetadata!=null?e.userDefinedMetadata:void 0,modelInitializer:e.modelInitializer!=null?e.modelInitializer:void 0,trainingConfig:e.trainingConfig!=null?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(i)),{modelArtifactsInfo:a}}catch{throw KP(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${a.modelTopologyBytes}, weightSpecsBytes=${a.weightSpecsBytes}, weightDataBytes=${a.weightDataBytes}.`)}}}async load(){const e=JSON.parse(this.LS.getItem(this.keys.info));if(e==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const n={},r=JSON.parse(this.LS.getItem(this.keys.topology));if(r==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);n.modelTopology=r;const a=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(a==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);n.weightSpecs=a;const i=this.LS.getItem(this.keys.modelMetadata);if(i!=null){const s=JSON.parse(i);n.format=s.format,n.generatedBy=s.generatedBy,n.convertedBy=s.convertedBy,s.signature!=null&&(n.signature=s.signature),s.userDefinedMetadata!=null&&(n.userDefinedMetadata=s.userDefinedMetadata),s.modelInitializer!=null&&(n.modelInitializer=s.modelInitializer),s.trainingConfig!=null&&(n.trainingConfig=s.trainingConfig)}const o=this.LS.getItem(this.keys.weightData);if(o==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return n.weightData=eie(o),n}}tc.URL_SCHEME="localstorage://";const XP=t=>ce().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(tc.URL_SCHEME)?bie(t.slice(tc.URL_SCHEME.length)):null;_n.registerSaveRouter(XP),_n.registerLoadRouter(XP);function bie(t){return new tc(t)}class vie{constructor(){j(ce().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),j(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const e={},n=Kd+Ts,r=Ts+HP;for(let a=0;a<this.LS.length;++a){const i=this.LS.key(a);if(i.startsWith(n)&&i.endsWith(r)){const o=mie(i);e[o]=JSON.parse(this.LS.getItem(i))}}return e}async removeModel(e){e=yie(e);const n=qP(e);if(this.LS.getItem(n.info)==null)throw new Error(`Cannot find model at path '${e}'`);const r=JSON.parse(this.LS.getItem(n.info));return KP(n),r}}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Xd="://";class fa{constructor(){this.managers={}}static getInstance(){return fa.instance==null&&(fa.instance=new fa),fa.instance}static registerManager(e,n){j(e!=null,()=>"scheme must not be undefined or null."),e.endsWith(Xd)&&(e=e.slice(0,e.indexOf(Xd))),j(e.length>0,()=>"scheme must not be an empty string.");const r=fa.getInstance();j(r.managers[e]==null,()=>`A model store manager is already registered for scheme '${e}'.`),r.managers[e]=n}static getManager(e){const n=fa.getInstance().managers[e];if(n==null)throw new Error(`Cannot find model manager for scheme '${e}'`);return n}static getSchemes(){return Object.keys(fa.getInstance().managers)}}function Cx(t){if(t.indexOf(Xd)===-1)throw new Error(`The url string provided does not contain a scheme. Supported schemes are: ${fa.getSchemes().join(",")}`);return{scheme:t.split(Xd)[0],path:t.split(Xd)[1]}}async function YP(t,e,n=!1){j(t!==e,()=>`Old path and new path are the same: '${t}'`);const r=_n.getLoadHandlers(t);j(r.length>0,()=>`Copying failed because no load handler is found for source URL ${t}.`),j(r.length<2,()=>`Copying failed because more than one (${r.length}) load handlers for source URL ${t}.`);const a=r[0],i=_n.getSaveHandlers(e);j(i.length>0,()=>`Copying failed because no save handler is found for destination URL ${e}.`),j(i.length<2,()=>`Copying failed because more than one (${r.length}) save handlers for destination URL ${e}.`);const o=i[0],s=Cx(t).scheme,l=Cx(t).path,u=s===Cx(t).scheme,c=await a.load();n&&u&&await fa.getManager(s).removeModel(l);const d=await o.save(c);return n&&!u&&await fa.getManager(s).removeModel(l),d.modelArtifactsInfo}async function xie(){const t=fa.getSchemes(),e={};for(const n of t){const r=await fa.getManager(n).listModels();for(const a in r){const i=n+Xd+a;e[i]=r[a]}}return e}async function wie(t){const e=Cx(t);return fa.getManager(e.scheme).removeModel(e.path)}async function kie(t,e){return YP(t,e,!1)}async function Sie(t,e){return YP(t,e,!0)}/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class Cie{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,n){return fetch(e,n)}now(){return performance.now()}encode(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${n}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,n){return new TextDecoder(n).decode(e)}setTimeoutCustom(e,n){if(!window||!ce().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(e,n);return}this.functionRefs.push(e),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},n),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",r=>{if(r.source===window&&r.data.name===this.messageName){r.stopPropagation();const a=this.functionRefs[r.data.index];a(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}}if(ce().get("IS_BROWSER")){ce().setPlatform("browser",new Cie);try{fa.registerManager(tc.URL_SCHEME,new vie)}catch{}try{fa.registerManager(ec.URL_SCHEME,new die)}catch{}}/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Nie={importFetch:()=>require("node-fetch")};let ET;class Tie{constructor(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}fetch(e,n){return ce().global.fetch!=null?ce().global.fetch(e,n):(ET==null&&(ET=Nie.importFetch()),ET(e,n))}now(){const e=process.hrtime();return e[0]*1e3+e[1]/1e6}encode(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${n}`);return this.textEncoder.encode(e)}decode(e,n){return e.length===0?"":new this.util.TextDecoder(n).decode(e)}}ce().get("IS_NODE")&&!ce().get("IS_BROWSER")&&ce().setPlatform("node",new Tie);/**
* @license
* Copyright 2020 Google Inc. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function pt(t,e="float32",n){return e=e||"float32",V3(t),new ar(t,e,n)}/**
* @license
* Copyright 2020 Google Inc. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Iie(t,e){const n=B(t,"x","cast");if(!sP(e))throw new Error(`Failed to cast to unknown dtype ${e}`);if(e==="string"&&n.dtype!=="string"||e!=="string"&&n.dtype==="string")throw new Error("Only strings can be casted to strings");const r={x:n},a={dtype:e};return te.runKernel(Ef,r,a)}const wn=ee({cast_:Iie});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Eie(t){const e={x:B(t,"x","clone","string_or_numeric")};return te.runKernel(Wf,e)}const Is=ee({clone_:Eie});/**
* @license
* Copyright 2020 Google Inc. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function _T(t,e=!1){console.log(t.toString(e))}/**
* @license
* Copyright 2020 Google Inc. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/PP();const _ie={buffer:pt,cast:wn,clone:Is,print:_T};Bae(_ie);/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Oie="model",$ie=".json",Rie=".weights.bin";function QP(t){return new Promise(e=>setTimeout(e)).then(t)}class wc{constructor(e){if(!ce().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(wc.URL_SCHEME)&&(e=e.slice(wc.URL_SCHEME.length)),(e==null||e.length===0)&&(e=Oie),this.modelJsonFileName=e+$ie,this.weightDataFileName=e+Rie}async save(e){if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");const n=window.URL.createObjectURL(new Blob([e.weightData],{type:"application/octet-stream"}));if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const r=[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}],a=jP(e,r),i=window.URL.createObjectURL(new Blob([JSON.stringify(a)],{type:"application/json"})),o=this.modelJsonAnchor==null?document.createElement("a"):this.modelJsonAnchor;if(o.download=this.modelJsonFileName,o.href=i,await QP(()=>o.dispatchEvent(new MouseEvent("click"))),e.weightData!=null){const s=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor;s.download=this.weightDataFileName,s.href=n,await QP(()=>s.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:Ag(e)}}}}wc.URL_SCHEME="downloads://";class Mie{constructor(e){if(e==null||e.length<1)throw new Error(`When calling browserFiles, at least 1 file is required, but received ${e}`);this.jsonFile=e[0],this.weightsFiles=e.slice(1)}async load(){return new Promise((e,n)=>{const r=new FileReader;r.onload=a=>{const i=JSON.parse(a.target.result),o=i.modelTopology;if(o==null){n(new Error(`modelTopology field is missing from file ${this.jsonFile.name}`));return}if(i.weightsManifest==null){n(new Error(`weightManifest field is missing from file ${this.jsonFile.name}`));return}if(this.weightsFiles.length===0){e({modelTopology:o});return}const s=CT(i,l=>this.loadWeights(l));e(s)},r.onerror=a=>n(`Failed to read model topology and weights manifest JSON from file '${this.jsonFile.name}'. BrowserFiles supports loading Keras-style tf.Model artifacts only.`),r.readAsText(this.jsonFile)})}loadWeights(e){const n=[],r=[];for(const o of e)n.push(...o.weights),r.push(...o.paths);const a=this.checkManifestAndWeightFiles(e),i=r.map(o=>this.loadWeightsFile(o,a[o]));return Promise.all(i).then(o=>[n,ST(o)])}loadWeightsFile(e,n){return new Promise((r,a)=>{const i=new FileReader;i.onload=o=>{const s=o.target.result;r(s)},i.onerror=o=>a(`Failed to weights data from file of path '${e}'.`),i.readAsArrayBuffer(n)})}checkManifestAndWeightFiles(e){const n=[],r=this.weightsFiles.map(i=>zP(i.name)),a={};for(const i of e)i.paths.forEach(o=>{const s=zP(o);if(n.indexOf(s)!==-1)throw new Error(`Duplicate file basename found in weights manifest: '${s}'`);if(n.push(s),r.indexOf(s)===-1)throw new Error(`Weight file with basename '${s}' is not provided.`);a[o]=this.weightsFiles[r.indexOf(s)]});if(n.length!==this.weightsFiles.length)throw new Error(`Mismatch in the number of files in weights manifest (${n.length}) and the number of weight files provided (${this.weightsFiles.length}).`);return a}}const Aie=t=>ce().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(wc.URL_SCHEME)?Pie(t.slice(wc.URL_SCHEME.length)):null;_n.registerSaveRouter(Aie);function Pie(t="model"){return new wc(t)}function Lie(t){return new Mie(t)}/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function ZP(t,e,n,r){o(t),n=n??0,r=r??1,s(n,r);let a=0;const i=l=>(l.then(u=>{const c=n+ ++a/t.length*(r-n);return e(c),u}),l);function o(l){j(l!=null&&Array.isArray(l)&&l.length>0,()=>"promises must be a none empty array")}function s(l,u){j(l>=0&&l<=1,()=>`Progress fraction must be in range [0, 1], but got startFraction ${l}`),j(u>=0&&u<=1,()=>`Progress fraction must be in range [0, 1], but got endFraction ${u}`),j(u>=l,()=>`startFraction must be no more than endFraction, but got startFraction ${l} and endFraction ${u}`)}return Promise.all(t.map(i))}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/async function JP(t,e){e==null&&(e={});const n=e.fetchFunc==null?ce().platform.fetch:e.fetchFunc,r=t.map(u=>n(u,e.requestInit,{isBinary:!0})),a=0,i=.5,o=(e.onProgress==null?await Promise.all(r):await ZP(r,e.onProgress,a,i)).map(u=>u.arrayBuffer());return e.onProgress==null?await Promise.all(o):await ZP(o,e.onProgress,.5,1)}async function Die(t,e="",n,r){return e8(a=>JP(a,{requestInit:r}))(t,e,n)}function e8(t){return async(e,n="",r)=>{const a=e.map(()=>!1),i={},o=r!=null?r.map(()=>!1):[],s=[];if(e.forEach((f,m)=>{let y=0;f.weights.forEach(x=>{const b="quantization"in x?x.quantization.dtype:x.dtype,v=wT[b]*me(x.shape),w=()=>{a[m]=!0,i[m]==null&&(i[m]=[]),i[m].push({manifestEntry:x,groupOffset:y,sizeBytes:v})};r!=null?r.forEach((S,C)=>{S===x.name&&(w(),o[C]=!0)}):w(),s.push(x.name),y+=v})}),!o.every(f=>f)){const f=r.filter((m,y)=>!o[y]);throw new Error(`Could not find weights in manifest with names: ${f.join(", ")}. 
Manifest JSON has weights with names: ${s.join(", ")}.`)}const l=a.reduce((f,m,y)=>(m&&f.push(y),f),[]),u=[];l.forEach(f=>{e[f].paths.forEach(m=>{const y=n+(n.endsWith("/")?"":"/")+m;u.push(y)})});const c=await t(u),d={};let p=0;return l.forEach(f=>{const m=e[f].paths.length;let y=0;for(let w=0;w<m;w++)y+=c[p+w].byteLength;const x=new ArrayBuffer(y),b=new Uint8Array(x);let v=0;for(let w=0;w<m;w++){const S=new Uint8Array(c[p+w]);b.set(S,v),v+=S.byteLength}i[f].forEach(w=>{const S=x.slice(w.groupOffset,w.groupOffset+w.sizeBytes),C=FP(S,[w.manifestEntry]);for(const I in C)d[I]=C[I]}),p+=m}),d}}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Fie="application/octet-stream",Bie="application/json";class OT{constructor(e,n){if(this.DEFAULT_METHOD="POST",n==null&&(n={}),this.weightPathPrefix=n.weightPathPrefix,this.onProgress=n.onProgress,this.weightUrlConverter=n.weightUrlConverter,n.fetchFunc!=null?(j(typeof n.fetchFunc=="function",()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=n.fetchFunc):this.fetch=ce().platform.fetch,j(e!=null&&e.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(e)&&j(e.length===2,()=>`URL paths for http must have a length of 2, (actual length is ${e.length}).`),this.path=e,n.requestInit!=null&&n.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=n.requestInit||{}}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const n=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);n.body=new FormData;const r=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],a=jP(e,r);n.body.append("model.json",new Blob([JSON.stringify(a)],{type:Bie}),"model.json"),e.weightData!=null&&n.body.append("model.weights.bin",new Blob([e.weightData],{type:Fie}),"model.weights.bin");const i=await this.fetch(this.path,n);if(i.ok)return{modelArtifactsInfo:Ag(e),responses:[i]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${i.status}.`)}async load(){const e=await this.fetch(this.path,this.requestInit);if(!e.ok)throw new Error(`Request to ${this.path} failed with status code ${e.status}. Please verify this URL points to the model JSON of the model to load.`);let n;try{n=await e.json()}catch{let i=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?i+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":i+=" Please make sure the server is serving valid JSON for this request.",new Error(i)}const r=n.modelTopology,a=n.weightsManifest;if(r==null&&a==null)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);return CT(n,i=>this.loadWeights(i))}async loadWeights(e){const n=Array.isArray(this.path)?this.path[1]:this.path,[r,a]=zie(n),i=this.weightPathPrefix||r,o=WP(e),s=[],l=[];for(const c of e)for(const d of c.paths)this.weightUrlConverter!=null?l.push(this.weightUrlConverter(d)):s.push(i+d+a);this.weightUrlConverter&&s.push(...await Promise.all(l));const u=await JP(s,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress});return[o,ST(u)]}}OT.URL_SCHEME_REGEX=/^https?:\/\//;function zie(t){const e=t.lastIndexOf("/"),n=t.lastIndexOf("?"),r=t.substring(0,e),a=n>e?t.substring(n):"";return[r+"/",a]}function $T(t){return t.match(OT.URL_SCHEME_REGEX)!=null}const t8=(t,e)=>{if(typeof fetch>"u"&&(e==null||e.fetchFunc==null))return null;{let n=!0;if(Array.isArray(t)?n=t.every(r=>$T(r)):n=$T(t),n)return RT(t,e)}return null};_n.registerSaveRouter(t8),_n.registerLoadRouter(t8);function RT(t,e){return new OT(t,e)}function jie(t,e){return RT(t,e)}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class MT{constructor(e){this.modelArtifacts=e}load(){return this.modelArtifacts}}class n8{constructor(e){this.saveHandler=e}save(e){return this.saveHandler(e)}}class Vie{constructor(e){e.load&&(this.load=()=>Promise.resolve(e.load())),e.save&&(this.save=n=>Promise.resolve(e.save(n)))}}function Wie(t,e,n,r){const a=arguments;return new Vie(r8(...a))}function r8(t,e,n,r){return arguments.length===1?t.modelTopology!=null||t.weightSpecs!=null?new MT(t):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new MT({modelTopology:t})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new MT({modelTopology:t,weightSpecs:e,weightData:n,trainingConfig:r}))}function Uie(t){return new n8(t)}function Gie(t){return new n8(t)}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const AT=Object.freeze(Object.defineProperty({__proto__:null,browserFiles:Lie,browserHTTPRequest:jie,concatenateArrayBuffers:ST,copyModel:kie,decodeWeights:FP,encodeWeights:Qae,fromMemory:Wie,fromMemorySync:r8,getLoadHandlers:lie,getModelArtifactsForJSON:CT,getModelArtifactsForJSONSync:VP,getModelArtifactsInfoForJSON:Ag,getSaveHandlers:sie,getWeightSpecs:WP,http:RT,isHTTPScheme:$T,listModels:xie,loadWeights:Die,moveModel:Sie,registerLoadRouter:oie,registerSaveRouter:iie,removeModel:wie,weightsLoaderFactory:e8,withSaveHandler:Uie,withSaveHandlerSync:Gie},Symbol.toStringTag,{value:"Module"}));/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Hie(t,e,n=!1,r=!1){let a=B(t,"a","matMul"),i=B(e,"b","matMul");[a,i]=En(a,i);const o={a,b:i},s={transposeA:n,transposeB:r};return te.runKernel(Fb,o,s)}const Gt=ee({matMul_:Hie});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function qie(t,e,n=1,r=0,a="int32"){if(e<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${e}`);const i={indices:B(t,"indices","oneHot","int32")},o={dtype:a,depth:e,onValue:n,offValue:r};return te.runKernel(Rv,i,o)}const Nx=ee({oneHot_:qie});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Kie(){ce().set("PROD",!0)}function Xie(){ce().set("DEBUG",!0)}function Yie(){ce().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}function Qie(t){ce().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(t+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function Zie(){te.disposeVariables()}function Es(){return te}function Jie(){return te.memory()}function eoe(t){return te.profile(t)}function Ot(t,e){return te.tidy(t,e)}function Vr(t){gT(t).forEach(e=>e.dispose())}function Ao(t){return te.keep(t)}function toe(t){return te.time(t)}function noe(t){return te.setBackend(t)}function roe(){return te.ready()}function aoe(){return te.backendName}function ioe(t){te.removeBackend(t)}function ooe(t){return te.findBackend(t)}function soe(t){return te.findBackendFactory(t)}function PT(t,e,n=1){return te.registerBackend(t,e,n)}function loe(){return te.backend}function uoe(t,e){ce().setPlatform(t,e)}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function coe(t){const e={input:B(t,"input","imag")};return te.runKernel(gv,e)}const Pg=ee({imag_:coe});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function doe(t){const e={x:B(t,"x","neg")};return te.runKernel(Iv,e)}const Po=ee({neg_:doe});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function poe(t){const e={input:B(t,"input","real")};return te.runKernel(zv,e)}const Yd=ee({real_:poe});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function hoe(t,e,n){const r=B(t,"x","transpose");if(e==null&&(e=r.shape.map((o,s)=>s).reverse()),j(r.rank===e.length,()=>`Error in transpose: rank of input ${r.rank} must match length of perm ${e}.`),e.forEach(o=>{j(o>=0&&o<r.rank,()=>`All entries in 'perm' must be between 0 and ${r.rank-1} but got ${e}`)}),r.rank<=1)return r.clone();const a={x:r},i={perm:e};return r.dtype==="complex64"?Ot(()=>{let o=Yd(r),s=Pg(r);return o=te.runKernel(Wd,{x:o},i),s=te.runKernel(Wd,{x:s},i),n&&(s=Po(s)),Ns(o,s)}):te.runKernel(Wd,a,i)}const Lg=ee({transpose_:hoe});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function foe(t,e,n){const r=B(t,"labels","confusionMatrix"),a=B(e,"predictions","confusionMatrix");j(n==null||n>0&&Number.isInteger(n),()=>`If provided, numClasses must be a positive integer, but got ${n}`),j(r.rank===1,()=>`Expected the rank of labels to be 1, but got ${r.rank}`),j(a.rank===1,()=>`Expected the rank of predictions to be 1, but got ${a.rank}`),j(r.shape[0]===a.shape[0],()=>`Mismatch in the number of examples: ${r.shape[0]} vs. ${a.shape[0]}. Labels and predictions should have the same number of elements.`),j(n>0&&Number.isInteger(n),()=>`numClasses is required to be a positive integer, but got ${n}`);const i=Nx(wn(r,"int32"),n),o=Nx(wn(a,"int32"),n),s=Lg(i),l=Gt(s,o);return wn(l,"int32")}const goe=ee({confusionMatrix_:foe});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const moe=Object.freeze(Object.defineProperty({__proto__:null,confusionMatrix:goe},Symbol.toStringTag,{value:"Module"}));/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function nc(t,e){const n=t.length,r=[];for(let a=0;a<n;a++){const i=n-1-a,o=t[i]||1;(e[e.length-1-a]||1)>1&&o===1&&r.unshift(i)}return r}function LT(t,e){const n=[];for(let r=0;r<e.length;r++){const a=t[t.length-r-1],i=e.length-r-1,o=e[i];(a==null||a===1&&o>1)&&n.unshift(i)}return n}function Nt(t,e){const n=[],r=Math.max(t.length,e.length);for(let a=0;a<r;a++){let i=t[t.length-a-1];i==null&&(i=1);let o=e[e.length-a-1];if(o==null&&(o=1),i===1)n.unshift(o);else if(o===1)n.unshift(i);else if(i!==o){const s=`Operands could not be broadcast together with shapes ${t} and ${e}.`;throw Error(s)}else n.unshift(i)}return n}const yoe=Object.freeze(Object.defineProperty({__proto__:null,assertAndGetBroadcastShape:Nt,getBroadcastDims:nc,getReductionAxes:LT},Symbol.toStringTag,{value:"Module"}));/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function DT(t,e,n){if(Uu(t),e!=null&&e.length!==3)throw new Error("tensor3d() requires shape to have three numbers");const r=Mo(t,n);if(r.length!==3&&r.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return Ml(t,e,r,n)}/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/let rc;function a8(t,e=3){if(e>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(t==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let n=!1,r=!1,a=!1,i=!1,o=!1,s=!1;if(t.data instanceof Uint8Array)n=!0;else if(typeof ImageData<"u"&&t instanceof ImageData)r=!0;else if(typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement)a=!0;else if(typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement)i=!0;else if(t.getContext!=null)o=!0;else if(typeof ImageBitmap<"u"&&t instanceof ImageBitmap)s=!0;else throw new Error(`pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was ${t.constructor.name}`);if(mx(fx,te.backendName)!=null){const p={pixels:t},f={numChannels:e};return te.runKernel(fx,p,f)}const[l,u]=a?[t.videoWidth,t.videoHeight]:[t.width,t.height];let c;if(o)c=t.getContext("2d").getImageData(0,0,l,u).data;else if(r||n)c=t.data;else if(i||a||s){if(rc==null)if(typeof document>"u")if(typeof OffscreenCanvas<"u"&&typeof OffscreenCanvasRenderingContext2D<"u")rc=new OffscreenCanvas(1,1).getContext("2d");else throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");else rc=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});rc.canvas.width=l,rc.canvas.height=u,rc.drawImage(t,0,0,l,u),c=rc.getImageData(0,0,l,u).data}let d;if(e===4)d=new Int32Array(c);else{const p=l*u;d=new Int32Array(p*e);for(let f=0;f<p;f++)for(let m=0;m<e;++m)d[f*e+m]=c[f*4+m]}return DT(d,[u,l,e],"int32")}function boe(t){return t!=null&&t.data instanceof Uint8Array}function voe(){return typeof window<"u"&&typeof ImageBitmap<"u"&&window.hasOwnProperty("createImageBitmap")}function xoe(t){return t!=null&&t.width!==0&&t.height!==0}function woe(t){return voe()&&!(t instanceof ImageBitmap)&&xoe(t)&&!boe(t)}async function koe(t,e=3){let n=null;if(ce().getBool("WRAP_TO_IMAGEBITMAP")&&woe(t)){let r;try{r=await createImageBitmap(t,{premultiplyAlpha:"none"})}catch{r=null}r!=null&&r.width===t.width&&r.height===t.height?n=r:n=t}else n=t;return a8(n,e)}async function i8(t,e){let n=B(t,"img","toPixels");if(!(t instanceof In)){const u=n;n=wn(u,"int32"),u.dispose()}if(n.rank!==2&&n.rank!==3)throw new Error(`toPixels only supports rank 2 or 3 tensors, got rank ${n.rank}.`);const[r,a]=n.shape.slice(0,2),i=n.rank===2?1:n.shape[2];if(i>4||i===2)throw new Error(`toPixels only supports depth of size 1, 3 or 4 but got ${i}`);if(n.dtype!=="float32"&&n.dtype!=="int32")throw new Error(`Unsupported type for toPixels: ${n.dtype}. Please use float32 or int32 tensors.`);const o=await n.data(),s=n.dtype==="float32"?255:1,l=new Uint8ClampedArray(a*r*4);for(let u=0;u<r*a;++u){const c=[0,0,0,255];for(let p=0;p<i;p++){const f=o[u*i+p];if(n.dtype==="float32"){if(f<0||f>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${f}.`)}else if(n.dtype==="int32"&&(f<0||f>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${f}.`);i===1?(c[0]=f*s,c[1]=f*s,c[2]=f*s):c[p]=f*s}const d=u*4;l[d+0]=Math.round(c[0]),l[d+1]=Math.round(c[1]),l[d+2]=Math.round(c[2]),l[d+3]=Math.round(c[3])}if(e!=null){e.width=a,e.height=r;const u=e.getContext("2d"),c=new ImageData(l,a,r);u.putImageData(c,0,0)}return n!==t&&n.dispose(),l}const o8=ee({fromPixels_:a8}),Soe=Object.freeze(Object.defineProperty({__proto__:null,fromPixels:o8,fromPixelsAsync:koe,toPixels:i8},Symbol.toStringTag,{value:"Module"}));function Tx(t,e){const n=t.shape.length,r=e.shape.length;if(n<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${n}.`);if(r<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${r}.`);if(e.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.shape[r-1]>n)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${e.shape[r-1]} vs. ${n}`);if(me(t.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${t.shape}.`);const a=e.shape,i=a[a.length-1];let o=1;for(let d=0;d<a.length-1;++d)o*=a[d];const s=t.shape,l=a.slice();l.pop();let u=1;for(let d=i;d<n;++d)u*=s[d],l.push(s[d]);const c=[...qe(t.shape).map(d=>d/u),1].slice(0,i);return[l,o,u,c]}const Coe=Object.freeze(Object.defineProperty({__proto__:null,prepareAndValidate:Tx},Symbol.toStringTag,{value:"Module"}));function FT(t,e,n){const r=e.rank>1?e.shape[e.rank-1]:1,a=e.rank>1?e.rank-1:1,i=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${n.shape}, indices.shape: ${e.shape}, shape: ${t}, sliceDim: ${r}, and batchDim: ${a}.`;if(n.rank<a)throw new Error(i+` update.rank < ${a}. `);if(t.length<r+(n.rank-a))throw new Error(i+` Output shape length < ${r+(n.rank-a)}`);if(n.rank!==a+t.length-r)throw new Error(i+` update.rank != ${a+t.length-r}`);for(let o=0;o<a;++o)if(n.shape[o]!==e.shape[o])throw new Error(i+` updates.shape[${o}] (${n.shape[o]}) != indices.shape[${o}] (${e.shape[o]}).`);for(let o=0;o<n.rank-a;++o)if(n.shape[o+a]!==t[o+r])throw new Error(i+` updates.shape[${o+a}] (${n.shape[o+a]}) != shape[${o+a}] (${t[o+a]})`)}function BT(t,e,n){if(e.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${e.rank}.`);if(t.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${t.rank}.`);if(e.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${e.dtype}`);if(n.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${n}`);if(n.length===0){if(e.size===0)throw new Error(`Indices specified for empty output. indices shape: ${e.shape}`);if(t.size===0)throw new Error(`Updates specified for empty output. updates shape: ${t.shape}`)}FT(n,e,t)}function Qd(t,e,n){const r=e.shape.length,a=r>1?e.shape[r-1]:1,i=n.length;let o=1;for(let d=a;d<i;++d)o*=n[d];const s=a<1?1:a,l=me(e.shape)/s,u=[...qe(n.slice(0,a)),1],c=me(n);return{sliceRank:a,numUpdates:l,sliceSize:o,strides:u,outputSize:c}}const Noe=Object.freeze(Object.defineProperty({__proto__:null,calculateShapes:Qd,validateInput:BT,validateUpdateShape:FT},Symbol.toStringTag,{value:"Module"}));/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const zT=-2,Toe=-1;function jT(t,e,n){const r=t.shape.length;j(r===e.length,()=>`Error in slice${r}D: Length of begin ${e} must match the rank of the array (${r}).`),j(r===n.length,()=>`Error in slice${r}D: Length of size ${n} must match the rank of the array (${r}).`);for(let a=0;a<r;++a)j(e[a]+n[a]<=t.shape[a],()=>`Error in slice${r}D: begin[${a}] + size[${a}] (${e[a]+n[a]}) would overflow input.shape[${a}] (${t.shape[a]})`)}function Ioe(t){const e=[];let n=0;for(;t>0;)t&1&&e.push(n),t/=2,n++;return e}function VT(t,e,n){const r=[];for(let a=0;a<t.length;a++)r[a]=Math.ceil((e[a]-t[a])/n[a]);return r}function s8(t,e,n,r){const a=[...t];for(let i=a.length;i<r.length;i++)a.push(1);for(let i=0;i<n;i++)i===0?a[e]=1:(a.splice(e,0,1),a.pop());return a}function l8(t,e,n){return n<=t?n:n-(e-1)}function u8(t,e){const n=[];for(let r=0;r<t;r++)n.push(e+r);return n}function Eoe(t,e,n,r,a,i,o,s,l){const u=t.length;let c=new Array(u),d=new Array(u),p=new Array(u);if(e.length&&n>0){const f=e[0],m=n+1;c=c8(o,f,m,r,t),d=d8(s,f,m,a,t),p=s8(i,f,m,t)}else for(let f=0;f<u;f++)c[f]=h8(o,r,i,t,f,l),d[f]=f8(s,a,i,t,f,l),p[f]=p8(i,f,l);return{begin:c,end:d,strides:p}}function c8(t,e,n,r,a){const i=[...a],o=u8(n,e);for(let s=0;s<i.length;s++)if(o.indexOf(s)>-1)i[s]=0;else{const l=l8(e,n,s);let u=r[l];t&1<<l&&(u=0),i[s]=u}return i}function d8(t,e,n,r,a){const i=[...a],o=u8(n,e);for(let s=0;s<i.length;s++)if(o.indexOf(s)>-1)i[s]=Number.MAX_SAFE_INTEGER;else{const l=l8(e,n,s);let u=r[l];t&1<<l&&(u=Number.MAX_SAFE_INTEGER),i[s]=u}for(let s=0;s<i.length;s++){const l=a[s];i[s]<0&&(i[s]+=l),i[s]=_l(0,i[s],a[s])}return i}function p8(t,e,n){let r=t[e];return(n&1<<e||r==null)&&(r=1),r}function h8(t,e,n,r,a,i){let o=e[a];const s=n[a]||1;(t&1<<a||i&1<<a||o==null)&&(s>0?o=Number.MIN_SAFE_INTEGER:o=Number.MAX_SAFE_INTEGER);const l=r[a];return o<0&&(o+=l),o=_l(0,o,l-1),o}function f8(t,e,n,r,a,i){let o=e[a];const s=n[a]||1;(t&1<<a||i&1<<a||o==null)&&(s>0?o=Number.MAX_SAFE_INTEGER:o=Number.MIN_SAFE_INTEGER);const l=r[a];return o<0&&(o+=l),s>0?o=_l(0,o,l):o=_l(-1,o,l-1),o}function WT(t,e,n){let r=n.length;for(let a=0;a<n.length;a++)if(n[a]>1){r=a;break}for(let a=r+1;a<n.length;a++)if(e[a]>0||n[a]!==t[a])return!1;return!0}function UT(t,e){let n=t.length>0?t[t.length-1]:1;for(let r=0;r<t.length-1;r++)n+=t[r]*e[r];return n}function GT(t,e,n){let r;const a=t.shape.length;typeof e=="number"?r=[e,...new Array(a-1).fill(0)]:e.length<a?r=e.concat(new Array(a-e.length).fill(0)):r=e.slice(),r.forEach(o=>{j(o!==-1,()=>"slice() does not support negative begin indexing.")});let i;return n==null?i=new Array(a).fill(-1):typeof n=="number"?i=[n,...new Array(a-1).fill(-1)]:n.length<a?i=n.concat(new Array(a-n.length).fill(-1)):i=n,i=i.map((o,s)=>o>=0?o:(j(o===-1,()=>`Negative size values should be exactly -1 but got ${o} for the slice() size at index ${s}.`),t.shape[s]-r[s])),[r,i]}function HT(t,e,n,r,a,i,o,s,l){let u;if(r==null?(u=new Array(e.length),u.fill(1)):u=r,o!=null&&o&o-1)throw new Error("Multiple ellipses in slice is not allowed.");let c=!1;const d={dims:u.length,numAddAxisAfterEllipsis:0,begin:e.slice(),end:n.slice(),strides:u.slice(),beginMask:a,endMask:i,ellipsisMask:o,newAxisMask:s,shrinkAxisMask:l};for(let v=0;v<d.dims;v++)c&&1<<v&s&&d.numAddAxisAfterEllipsis++,1<<v&o&&(c=!0);c||(d.ellipsisMask|=1<<d.dims,d.dims++);const p={dims:t.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};_oe(d,p);let f=!0,m=!0,y=!0;const x=[],b=[];for(let v=0;v<t.length;++v){if(p.strides[v]===0)throw Error(`strides[${v}] must be non-zero`);const w=!!(p.shrinkAxisMask&1<<v),S=t[v];if(S===-1){x.push(w?1:-1);continue}const C=[p.beginMask&1<<v,p.endMask&1<<v],I=[p.strides[v]>0?0:-1,p.strides[v]>0?S:S-1];if(w&&p.strides[v]<=0)throw Error("only stride 1 allowed on non-range indexing.");y=y&&p.strides[v]===1;const _=!!(p.beginMask&1<<v&&p.endMask&1<<v);if(p.beginValid&&p.endValid){if(w){const D=p.begin[v]<0?S+p.begin[v]:p.begin[v];if(p.begin[v]=D,p.end[v]=p.begin[v]+1,D<0||D>=S)throw Error(`slice index ${p.begin[v]} of dimension ${v} out of bounds.`)}else p.begin[v]=g8(p.begin[v],0,p.strides[v],S,C,I),p.end[v]=g8(p.end[v],1,p.strides[v],S,C,I);const A=p.strides[v]===1&&p.begin[v]===0&&p.end[v]===S;f=f&&A,m=m&&(v===0&&p.strides[v]===1||A)}else f=f&&p.strides[v]===1&&_,m=m&&(v===0&&p.strides[v]===1||_);let E,P=!1;if(p.beginValid&&p.endValid?(E=p.end[v]-p.begin[v],P=!0):w?(E=1,P=!0):_&&S>=0&&(p.strides[v]<0?E=-S:E=S,P=!0),P){let A;E===0||E<0!=p.strides[v]<0?A=0:A=Math.trunc(E/p.strides[v])+(E%p.strides[v]!==0?1:0),x.push(A)}else x.push(-1)}for(let v=0;v<p.finalShapeGatherIndices.length;++v){const w=p.finalShapeGatherIndices[v];w>=0?b.push(x[w]):w===zT&&b.push(1)}return{finalShapeSparse:b.filter((v,w)=>p.finalShapeGatherIndices[w]!==zT),finalShape:b,isIdentity:f,sliceDim0:m,isSimpleSlice:y,begin:p.begin,end:p.end,strides:p.strides}}function _oe(t,e){e.beginMask=0,e.endMask=0,e.shrinkAxisMask=0;let n=0;e.beginValid=t.begin!=null,e.endValid=t.end!=null,e.begin=new Array(e.dims),e.end=new Array(e.dims),e.strides=new Array(e.dims),e.finalShapeGatherIndices=[],e.finalShapeGatherIndicesSparse=[],e.inputShapeGatherIndicesSparse=new Array(e.dims);for(let r=0;r<t.dims;r++)if(1<<r&t.ellipsisMask){const a=Math.min(e.dims-(t.dims-r)+1+t.numAddAxisAfterEllipsis,e.dims);for(;n<a;n++)e.begin[n]=0,e.end[n]=0,e.strides[n]=1,e.beginMask|=1<<n,e.endMask|=1<<n,e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(-1),e.inputShapeGatherIndicesSparse[n]=r}else if(1<<r&t.newAxisMask)e.finalShapeGatherIndices.push(zT),e.finalShapeGatherIndicesSparse.push(-1);else{if(n===e.begin.length)throw Error(`Index out of range using input dim ${n}; input has only ${e.dims} dims, ${e.begin.length}.`);t.begin!=null&&(e.begin[n]=t.begin[r]),t.end!=null&&(e.end[n]=t.end[r]),e.strides[n]=t.strides[r],t.beginMask&1<<r&&(e.beginMask|=1<<n),t.endMask&1<<r&&(e.endMask|=1<<n),t.shrinkAxisMask&1<<r?(e.finalShapeGatherIndices.push(Toe),e.finalShapeGatherIndicesSparse.push(-1),e.shrinkAxisMask|=1<<n):(e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(r)),e.inputShapeGatherIndicesSparse[n]=r,n++}}function g8(t,e,n,r,a,i){if(a[e])return n>0?i[e]:i[e+1&1];{const o=t<0?r+t:t;return o<i[0]?i[0]:o>i[1]?i[1]:o}}const m8=Object.freeze(Object.defineProperty({__proto__:null,assertParamsValid:jT,computeFlatOffset:UT,computeOutShape:VT,getNormalizedAxes:Eoe,isSliceContinous:WT,maskToAxes:Ioe,parseSliceParams:GT,sliceInfo:HT,startForAxis:h8,startIndicesWithElidedDims:c8,stopForAxis:f8,stopIndicesWithElidedDims:d8,stridesForAxis:p8,stridesWithElidedDims:s8},Symbol.toStringTag,{value:"Module"}));/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class y8{getClassName(){return this.constructor.className}static fromConfig(e,n){return new e(n)}}class Jl{constructor(){this.classNameMap={}}static getMap(){return Jl.instance==null&&(Jl.instance=new Jl),Jl.instance}static register(e){Jl.getMap().classNameMap[e.className]=[e,e.fromConfig]}}function Pl(t){j(t.className!=null,()=>"Class being registered does not have the static className property defined."),j(typeof t.className=="string",()=>"className is required to be a string, but got type "+typeof t.className),j(t.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),Jl.register(t)}const Ooe=Object.freeze(Object.defineProperty({__proto__:null,Serializable:y8,SerializationMap:Jl,registerClass:Pl},Symbol.toStringTag,{value:"Module"}));/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const $oe=.001,b8=.1;function Roe(t,e,n){return n==null&&(n=qT()),KT(t,e,(r,a)=>XT(r,a,n))}function qT(){return te.backend.floatPrecision()===32?$oe:b8}function KT(t,e,n){let r=!0;if((jr(t)||jr(e))&&(r=!1),jr(t)&&jr(e)&&(r=!0),r){const o=t.constructor.name,s=e.constructor.name;if(o!==s)throw new Error(`Arrays are of different type. Actual: ${o}. Expected: ${s}`)}if(Array.isArray(t)&&Array.isArray(e)){const o=Mo(t),s=Mo(e);if(!tn(o,s))throw new Error(`Arrays have different shapes. Actual: [${o}]. Expected: [${s}]`)}const a=jr(t)?t:ws(t),i=jr(e)?e:ws(e);if(a.length!==i.length)throw new Error(`Arrays have different lengths actual: ${a.length} vs expected: ${i.length}.
Actual:   ${a}.
Expected: ${i}.`);for(let o=0;o<i.length;++o){const s=a[o],l=i[o];if(!n(s,l))throw new Error(`Arrays differ: actual[${o}] = ${s}, expected[${o}] = ${l}.
Actual:   ${a}.
Expected: ${i}.`)}typeof expect<"u"&&expect().nothing()}function Moe(t,e){t().then(()=>e.fail(),()=>e()),typeof expect<"u"&&expect().nothing()}function Aoe(t,e){const n=typeof e=="string"||typeof e=="number"||typeof e=="boolean"?[e]:e;return $o(t)||$o(t[0])||$o(e)||$o(e[0])?KT(t,n,(r,a)=>r==a):KT(t,e,(r,a)=>XT(r,a,0))}function Poe(t,e,n){if(n==null&&(n=qT()),!XT(t,e,n))throw new Error(`Numbers differ: actual === ${t}, expected === ${e}`);typeof expect<"u"&&expect().nothing()}function XT(t,e,n){return!isFinite(t)&&!isFinite(e)?!0:!(isNaN(t)||isNaN(e)||Math.abs(t-e)>n)}function Loe(t,e,n){for(let r=0;r<t.length;r++)if(t[r]<e||t[r]>n)throw new Error(`Value out of range:${t[r]} low: ${e}, high: ${n}`)}function Doe(t,e){const n=new Float32Array(t),r=new Float32Array(e);if(n.length!==r.length)throw new Error(`Expected ArrayBuffer to be of length ${r.length}, but it was ${n.length}`);for(let a=0;a<r.length;a++)if(n[a]!==r[a])throw new Error(`Expected ArrayBuffer value at ${a} to be ${r[a]} but got ${n[a]} instead`)}function v8(t){for(let e=0;e<t.length;e++){const n=t[e];Array.isArray(n)?v8(n):t[e]=Ro(n)}return t}function Foe(t){const e=document.createElement("video");return"playsInline"in e&&(e.playsInline=!0),e.muted=!0,e.loop=!0,e.style.position="fixed",e.style.left="0px",e.style.top="0px",e.preload="auto",e.appendChild(t),new Promise(n=>{e.addEventListener("loadeddata",r=>n(e)),e.load()})}async function Boe(t){await t.play(),"requestVideoFrameCallback"in t&&await new Promise(e=>{t.requestVideoFrameCallback(e)})}const zoe=Object.freeze(Object.defineProperty({__proto__:null,TEST_EPSILON_FLOAT16:b8,createVideoElement:Foe,encodeStrings:v8,expectArrayBuffersEqual:Doe,expectArraysClose:Roe,expectArraysEqual:Aoe,expectNumbersClose:Poe,expectPromiseToFail:Moe,expectValuesInRange:Loe,play:Boe,testEpsilon:qT},Symbol.toStringTag,{value:"Module"}));/** @license See the LICENSE file. */const joe="3.21.0";/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Voe(t,e){let n=B(t,"a","add"),r=B(e,"b","add");[n,r]=En(n,r);const a={a:n,b:r};return te.runKernel(Vd,a)}const ot=ee({add_:Voe});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Woe(t,e){let n=B(t,"a","floorDiv"),r=B(e,"b","floorDiv");[n,r]=En(n,r);const a={a:n,b:r};return te.runKernel(zf,a)}const YT=ee({floorDiv_:Woe});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Uoe(t,e){let n=B(t,"a","div"),r=B(e,"b","div");if([n,r]=En(n,r),n.dtype==="int32"&&r.dtype==="int32")return YT(n,r);const a={a:n,b:r},i={};return te.runKernel(Mf,a,i)}const un=ee({div_:Uoe});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Goe(t,e){let n=B(t,"a","mul"),r=B(e,"b","mul");[n,r]=En(n,r);const a={a:n,b:r};return te.runKernel(rg,a)}const $e=ee({mul_:Goe});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Hoe(t){const e=B(t,"x","abs");if(e.dtype==="complex64"){const n={x:e};return te.runKernel(Wb,n)}else{const n={x:e};return te.runKernel(Ob,n)}}const ja=ee({abs_:Hoe});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function qoe(t){const e={x:B(t,"x","acos")};return te.runKernel(wf,e)}const x8=ee({acos_:qoe});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Koe(t){const e={x:B(t,"x","acosh")};return te.runKernel(kf,e)}const w8=ee({acosh_:Koe});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Xoe(t){j(Array.isArray(t),()=>"The argument passed to tf.addN() must be a list of tensors"),j(t.length>=1,()=>`Must pass at least one tensor to tf.addN(), but got ${t.length}`);const e=t.map((a,i)=>B(a,`tensors${i}`,"addN")),n=e[0];e.forEach(a=>{if(a.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),e.forEach(a=>{if(!tn(a.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});const r=e;return te.runKernel($b,r)}const k8=ee({addN_:Xoe});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Yoe(t,e=null,n=!1){const r={x:B(t,"x","all","bool")},a={axis:e,keepDims:n};return te.runKernel(Rb,r,a)}const S8=ee({all_:Yoe});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Qoe(t,e=null,n=!1){const r={x:B(t,"x","any","bool")},a={axis:e,keepDims:n};return te.runKernel(Mb,r,a)}const C8=ee({any_:Qoe});/**
* @license
* Copyright 2020 Google Inc. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Zoe(t,e=0){const n={x:B(t,"x","argMax")},r={axis:e};return te.runKernel(Ab,n,r)}const N8=ee({argMax_:Zoe});/**
* @license
* Copyright 2020 Google Inc. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Joe(t,e=0){const n={x:B(t,"x","argMin")},r={axis:e};return te.runKernel(Pb,n,r)}const T8=ee({argMin_:Joe});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function ese(t){const e={x:B(t,"x","asin")};return te.runKernel(Sf,e)}const I8=ee({asin_:ese});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function tse(t){const e={x:B(t,"x","asinh")};return te.runKernel(Cf,e)}const E8=ee({asinh_:tse});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function nse(t){const e={x:B(t,"x","atan")};return te.runKernel(Nf,e)}const _8=ee({atan_:nse});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function rse(t,e){let n=B(t,"a","atan2"),r=B(e,"b","atan2");[n,r]=En(n,r);const a={a:n,b:r};return te.runKernel(If,a)}const O8=ee({atan2_:rse});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function ase(t){const e={x:B(t,"x","atanh")};return te.runKernel(Tf,e)}const $8=ee({atanh_:ase});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Dg(t,e,n,r,a="NHWC",i){const o=t[3],s=[...e,o],l=Os(a);return fr(t,s,n,i,r,null,null,l)}function Ei(t,e,n,r,a,i,o="channelsLast"){const[s,l]=Ix(e);let u;if(o==="channelsLast")u=[s,l,t[3],t[3]];else if(o==="channelsFirst")u=[s,l,t[1],t[1]];else throw new Error(`Unknown dataFormat ${o}`);return fr(t,u,n,r,a,i,!1,o)}function _s(t,e,n,r,a,i,o="NDHWC"){const[s,l,u]=ZT(e);let c,d;if(o==="NDHWC")d="channelsLast",c=[s,l,u,t[4],t[4]];else if(o==="NCDHW")d="channelsFirst",c=[s,l,u,t[1],t[1]];else throw new Error(`Unknown dataFormat ${o}`);return Ll(t,c,n,r,a,!1,d,i)}function fr(t,e,n,r,a,i,o=!1,s="channelsLast"){let[l,u,c,d]=[-1,-1,-1,-1];if(s==="channelsLast")[l,u,c,d]=t;else if(s==="channelsFirst")[l,d,u,c]=t;else throw new Error(`Unknown dataFormat ${s}`);const[p,f,,m]=e,[y,x]=Ix(n),[b,v]=Ix(r),w=Zd(p,b),S=Zd(f,v),{padInfo:C,outHeight:I,outWidth:_}=sse(a,u,c,y,x,w,S,i,s),E=o?m*d:m;let P;return s==="channelsFirst"?P=[l,E,I,_]:s==="channelsLast"&&(P=[l,I,_,E]),{batchSize:l,dataFormat:s,inHeight:u,inWidth:c,inChannels:d,outHeight:I,outWidth:_,outChannels:E,padInfo:C,strideHeight:y,strideWidth:x,filterHeight:p,filterWidth:f,effectiveFilterHeight:w,effectiveFilterWidth:S,dilationHeight:b,dilationWidth:v,inShape:t,outShape:P,filterShape:e}}function Ll(t,e,n,r,a,i=!1,o="channelsLast",s){let[l,u,c,d,p]=[-1,-1,-1,-1,-1];if(o==="channelsLast")[l,u,c,d,p]=t;else if(o==="channelsFirst")[l,p,u,c,d]=t;else throw new Error(`Unknown dataFormat ${o}`);const[f,m,y,,x]=e,[b,v,w]=ZT(n),[S,C,I]=ZT(r),_=Zd(f,S),E=Zd(m,C),P=Zd(y,I),{padInfo:A,outDepth:D,outHeight:V,outWidth:z}=lse(a,u,c,d,b,v,w,_,E,P,s),K=i?x*p:x;let X;return o==="channelsFirst"?X=[l,K,D,V,z]:o==="channelsLast"&&(X=[l,D,V,z,K]),{batchSize:l,dataFormat:o,inDepth:u,inHeight:c,inWidth:d,inChannels:p,outDepth:D,outHeight:V,outWidth:z,outChannels:K,padInfo:A,strideDepth:b,strideHeight:v,strideWidth:w,filterDepth:f,filterHeight:m,filterWidth:y,effectiveFilterDepth:_,effectiveFilterHeight:E,effectiveFilterWidth:P,dilationDepth:S,dilationHeight:C,dilationWidth:I,inShape:t,outShape:X,filterShape:e}}function ise(t,e,n,r,a){r==null&&(r=QT(t,e,n));const i=t[0],o=t[1],s=ac((i-e+2*r)/n+1,a),l=ac((o-e+2*r)/n+1,a);return[s,l]}function ose(t,e,n,r,a,i){a==null&&(a=QT(t,e,r));const o=t[0],s=t[1],l=t[2],u=ac((o-e+2*a)/r+1,i),c=ac((s-e+2*a)/r+1,i),d=ac((l-e+2*a)/r+1,i);return[u,c,d,n]}function QT(t,e,n,r=1){const a=Zd(e,r);return Math.floor((t[0]*(n-1)-n+a)/2)}function Ix(t){return typeof t=="number"?[t,t,t]:t.length===2?[t[0],t[1],1]:t}function ZT(t){return typeof t=="number"?[t,t,t]:t}function Zd(t,e){return e<=1?t:t+(t-1)*(e-1)}function sse(t,e,n,r,a,i,o,s,l){let u,c,d;if(typeof t=="number"){u={top:t,bottom:t,left:t,right:t,type:t===0?"VALID":"NUMBER"};const p=ise([e,n],i,r,t,s);c=p[0],d=p[1]}else if(t==="same"){c=Math.ceil(e/r),d=Math.ceil(n/a);const p=Math.max(0,(c-1)*r+i-e),f=Math.max(0,(d-1)*a+o-n),m=Math.floor(p/2),y=p-m,x=Math.floor(f/2),b=f-x;u={top:m,bottom:y,left:x,right:b,type:"SAME"}}else if(t==="valid")u={top:0,bottom:0,left:0,right:0,type:"VALID"},c=Math.ceil((e-i+1)/r),d=Math.ceil((n-o+1)/a);else if(typeof t=="object"){const p=l==="channelsLast"?t[1][0]:t[2][0],f=l==="channelsLast"?t[1][1]:t[2][1],m=l==="channelsLast"?t[2][0]:t[3][0],y=l==="channelsLast"?t[2][1]:t[3][1];u={top:p,bottom:f,left:m,right:y,type:p===0&&f===0&&m===0&&y===0?"VALID":"EXPLICIT"},c=ac((e-i+p+f)/r+1,s),d=ac((n-o+m+y)/a+1,s)}else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:u,outHeight:c,outWidth:d}}function lse(t,e,n,r,a,i,o,s,l,u,c){let d,p,f,m;if(typeof t=="number"){d={top:t,bottom:t,left:t,right:t,front:t,back:t,type:t===0?"VALID":"NUMBER"};const y=ose([e,n,r,1],s,1,a,t,c);p=y[0],f=y[1],m=y[2]}else if(t==="same"){p=Math.ceil(e/a),f=Math.ceil(n/i),m=Math.ceil(r/o);const y=(p-1)*a+s-e,x=(f-1)*i+l-n,b=(m-1)*o+u-r,v=Math.floor(y/2),w=y-v,S=Math.floor(x/2),C=x-S,I=Math.floor(b/2),_=b-I;d={top:S,bottom:C,left:I,right:_,front:v,back:w,type:"SAME"}}else if(t==="valid")d={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},p=Math.ceil((e-s+1)/a),f=Math.ceil((n-l+1)/i),m=Math.ceil((r-u+1)/o);else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:d,outDepth:p,outHeight:f,outWidth:m}}function ac(t,e){if(!e)return Math.trunc(t);switch(e){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error(`Unknown roundingMode ${e}`)}}function Fg(t){const[e,n,r]=Ix(t);return e===1&&n===1&&r===1}function Wr(t,e){return Fg(t)||Fg(e)}function Os(t){if(t==="NHWC")return"channelsLast";if(t==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${t}`)}function _i(t,e,n){if(n!=null){if(typeof e=="string")throw Error(`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);if(typeof e=="number")j(Gu(e),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);else if(typeof e=="object")e.forEach(r=>{r.forEach(a=>{j(Gu(a),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${a}.`)})});else throw Error(`Error in ${t}: Unknown padding parameter: ${e}`)}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function use(t,e){const n={x:B(t,"x","reshape","string_or_numeric")},r={shape:e};return te.runKernel(jv,n,r)}const xe=ee({reshape_:use});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function cse(t,e,n,r,a){const i=B(t,"x","avgPool","float32"),o=1;j(Wr(n,o),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`);let s=i,l=!1;i.rank===3&&(l=!0,s=xe(i,[1,i.shape[0],i.shape[1],i.shape[2]])),j(s.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${s.rank}.`),_i("avgPool",r,a);const u={x:s},c={filterSize:e,strides:n,pad:r,dimRoundingMode:a};let d=te.runKernel(Lb,u,c);return d=wn(d,i.dtype),l?xe(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const JT=ee({avgPool_:cse});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function dse(t,e,n,r,a,i="NDHWC"){const o=B(t,"x","avgPool3d","float32");let s=o,l=!1;o.rank===4&&(l=!0,s=xe(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),j(s.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${s.rank}.`),j(i==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${i}`),_i("avgPool3d",r,a);const u={x:s},c={filterSize:e,strides:n,pad:r,dimRoundingMode:a,dataFormat:i};let d=te.runKernel(Db,u,c);return d=wn(d,s.dtype),l?xe(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const R8=ee({avgPool3d_:dse});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function pse(t,e=0){j(t.length>=1,()=>"Pass at least one tensor to concat");const n=Mg(t,"tensors","concat","string_or_numeric");if(n[0].dtype==="complex64"&&n.forEach(i=>{if(i.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${i.dtype}. `)}),n.length===1)return Is(n[0]);const r=n,a={axis:e};return te.runKernel(Ub,r,a)}const Ur=ee({concat_:pse});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function hse(t){const e={x:B(t,"x","sigmoid","float32")};return te.runKernel(gg,e)}const ic=ee({sigmoid_:hse});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function fse(t,e,n){const r=B(t,"x","slice","string_or_numeric");if(r.rank===0)throw new Error("Slicing scalar is not possible");const a={x:r},i={begin:e,size:n};return te.runKernel(Kv,a,i)}const nn=ee({slice_:fse});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function gse(t){const e={x:B(t,"x","tanh","float32")};return te.runKernel(wg,e)}const Ex=ee({tanh_:gse});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function mse(t,e,n,r,a,i){const o=B(t,"forgetBias","basicLSTMCell"),s=B(e,"lstmKernel","basicLSTMCell"),l=B(n,"lstmBias","basicLSTMCell"),u=B(r,"data","basicLSTMCell"),c=B(a,"c","basicLSTMCell"),d=B(i,"h","basicLSTMCell"),p=Ur([u,d],1),f=Gt(p,s),m=ot(f,l),y=m.shape[0],x=m.shape[1]/4,b=[y,x],v=nn(m,[0,0],b),w=nn(m,[0,x],b),S=nn(m,[0,x*2],b),C=nn(m,[0,x*3],b),I=ot($e(ic(v),Ex(w)),$e(c,ic(ot(o,S)))),_=$e(Ex(I),ic(C));return[I,_]}const M8=ee({basicLSTMCell_:mse});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function yse(t,e,n){const r=B(t,"x","batchToSpaceND"),a=e.reduce((s,l)=>s*l);j(r.rank>=1+e.length,()=>`input rank is ${r.rank} but should be > than blockShape.length ${e.length}`),j(n.length===e.length,()=>`crops.length is ${n.length} but should be equal to blockShape.length  ${e.length}`),j(r.shape[0]%a===0,()=>`input tensor batch is ${r.shape[0]} but is not divisible by the product of the elements of blockShape ${e.join(" * ")} === ${a}`);const i={x:r},o={blockShape:e,crops:n};return te.runKernel(Bb,i,o)}const eI=ee({batchToSpaceND_:yse});function bse(t){let e;return t.rank===0||t.rank===1?e=xe(t,[1,1,1,t.size]):t.rank===2?e=xe(t,[1,1,t.shape[0],t.shape[1]]):t.rank===3?e=xe(t,[1,t.shape[0],t.shape[1],t.shape[2]]):e=t,e}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function vse(t,e,n,r,a,i){i==null&&(i=.001);const o=B(t,"x","batchNorm"),s=B(e,"mean","batchNorm"),l=B(n,"variance","batchNorm");let u;a!=null&&(u=B(a,"scale","batchNorm"));let c;r!=null&&(c=B(r,"offset","batchNorm")),j(s.rank===l.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),j(c==null||s.rank===c.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),j(u==null||s.rank===u.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const d={x:bse(o),scale:u,offset:c,mean:s,variance:l},p={varianceEpsilon:i},f=te.runKernel(dv,d,p);return xe(f,o.shape)}const Bg=ee({batchNorm_:vse});function xse(t,e,n,r,a,i){const o=B(t,"x","batchNorm"),s=B(e,"mean","batchNorm"),l=B(n,"variance","batchNorm");let u;a!=null&&(u=B(a,"scale","batchNorm"));let c;return r!=null&&(c=B(r,"offset","batchNorm")),j(o.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${o.rank}.`),j(s.rank===2||s.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${s.rank}.`),j(l.rank===2||l.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${l.rank}.`),u!=null&&j(u.rank===2||u.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${u.rank}.`),c!=null&&j(c.rank===2||c.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${c.rank}.`),Bg(o,s,l,c,u,i)}const A8=ee({batchNorm2d_:xse});function wse(t,e,n,r,a,i){const o=B(t,"x","batchNorm"),s=B(e,"mean","batchNorm"),l=B(n,"variance","batchNorm");let u;a!=null&&(u=B(a,"scale","batchNorm"));let c;return r!=null&&(c=B(r,"offset","batchNorm")),j(o.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${o.rank}.`),j(s.rank===3||s.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${s.rank}.`),j(l.rank===3||l.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${l.rank}.`),u!=null&&j(u.rank===3||u.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${u.rank}.`),c!=null&&j(c.rank===3||c.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${c.rank}.`),Bg(o,s,l,c,u,i)}const P8=ee({batchNorm3d_:wse});function kse(t,e,n,r,a,i){const o=B(t,"x","batchNorm"),s=B(e,"mean","batchNorm"),l=B(n,"variance","batchNorm");let u;a!=null&&(u=B(a,"scale","batchNorm"));let c;return r!=null&&(c=B(r,"offset","batchNorm")),j(o.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${o.rank}.`),j(s.rank===4||s.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${s.rank}.`),j(l.rank===4||l.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${l.rank}.`),u!=null&&j(u.rank===4||u.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${u.rank}.`),c!=null&&j(c.rank===4||c.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${c.rank}.`),Bg(o,s,l,c,u,i)}const L8=ee({batchNorm4d_:kse});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Sse(t,e,n){const r=B(t,"x","bincount"),a=B(e,"weights","bincount");j(r.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${r.dtype}`),j(n>=0,()=>`size must be non-negative, but got ${n}.`),j(a.size===r.size||a.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${r.shape}, weights shape: ${a.shape}.`);const i={x:r,weights:a},o={size:n};return te.runKernel(zb,i,o)}const tI=ee({bincount_:Sse});/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Cse(t,e){const n=B(t,"s0","broadcastArgs","int32"),r=B(e,"s1","broadcastArgs","int32");if(n.rank!==1)throw new Error(`broadcastArgs(): first input must be a vector (rank=1). Has rank ${n.rank}`);if(r.rank!==1)throw new Error(`broadcastArgs(): second input must be a vector (rank=1). Has rank ${r.rank}`);const a={s0:n,s1:r};return te.runKernel(jb,a)}const D8=ee({broadcastArgs_:Cse});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Nse(t,e){let n=B(t,"broadcastTo","x");const r=n.shape;if(e.some(l=>!(l>0)||l%1!==0))throw new Error(`broadcastTo(): Invalid broadcast shape [${e}].`);if(e.length<n.rank)throw new Error(`broadcastTo(): shape.length=${e.length} < input.rank=${n.rank}.`);if(e.length>n.rank){const l=n.shape.slice();for(;l.length<e.length;)l.unshift(1);n=xe(n,l)}const a=n.shape,i=Array.from(e);for(let l=e.length-1;l>=0;l--)if(a[l]===e[l])i[l]=1;else if(n.shape[l]!==1)throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${e}].`);if(i.map((l,u)=>l>1?u:-1).filter(l=>l>=0).length===0)return Is(n);const o={x:n},s={reps:i};return te.runKernel(kg,o,s)}const Jd=ee({broadcastTo_:Nse});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Tse(t){const e={x:B(t,"x","ceil","float32")};return te.runKernel(_f,e)}const F8=ee({ceil_:Tse});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function ep(t,e,n){const r={shape:t,value:e,dtype:n};return te.runKernel(uv,{},r)}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Ise(t,e,n){const r=B(t,"x","clipByValue");if(j(e<=n,()=>`Error in clip: min (${e}) must be less than or equal to max (${n}).`),e===n)return ep(r.shape,e,r.dtype);const a={x:r},i={clipValueMin:e,clipValueMax:n};return te.runKernel(Of,a,i)}const B8=ee({clipByValue_:Ise});function Ese(t){return Ur(t,0)}const z8=ee({concat1d_:Ese});function _se(t,e){return Ur(t,e)}const j8=ee({concat2d_:_se});function Ose(t,e){return Ur(t,e)}const V8=ee({concat3d_:Ose});function $se(t,e){return Ur(t,e)}const W8=ee({concat4d_:$se});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Rse(t,e,n,r,a="NHWC",i=[1,1],o){const s=B(t,"x","conv2d","float32"),l=B(e,"filter","conv2d","float32");let u=s,c=!1;s.rank===3&&(c=!0,u=xe(s,[1,s.shape[0],s.shape[1],s.shape[2]])),j(u.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${u.rank}.`),j(l.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${l.rank}.`),_i("conv2d",r,o);const d=a==="NHWC"?u.shape[3]:u.shape[1];j(d===l.shape[2],()=>`Error in conv2d: depth of input (${d}) must match input depth for filter ${l.shape[2]}.`),j(Wr(n,i),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`);const p={x:u,filter:l},f={strides:n,pad:r,dataFormat:a,dilations:i,dimRoundingMode:o},m=te.runKernel(Gb,p,f);return c?xe(m,[m.shape[1],m.shape[2],m.shape[3]]):m}const zg=ee({conv2d_:Rse});function Mse(t,e,n,r,a="NWC",i=1,o){const s=B(t,"x","conv1d"),l=B(e,"filter","conv1d");let u=s,c=!1;s.rank===2&&(c=!0,u=xe(s,[1,s.shape[0],s.shape[1]])),j(u.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${u.rank}.`),j(l.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${l.rank}.`),_i("conv1d",r,o),j(u.shape[2]===l.shape[1],()=>`Error in conv1d: depth of input (${u.shape[2]}) must match input depth for filter ${l.shape[1]}.`),j(Wr(n,i),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${n} and dilation '${i}'`),j(a==="NWC",()=>`Error in conv1d: got dataFormat of ${a} but only NWC is currently supported.`);const d=xe(l,[1,l.shape[0],l.shape[1],l.shape[2]]),p=xe(u,[u.shape[0],1,u.shape[1],u.shape[2]]),f=zg(p,d,[1,n],r,"NHWC",[1,i],o);return c?xe(f,[f.shape[2],f.shape[3]]):xe(f,[f.shape[0],f.shape[2],f.shape[3]])}const U8=ee({conv1d_:Mse});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Ase(t,e,n,r,a,i="NHWC",o){j(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let s=t,l=e,u=!1;e.rank===3&&(u=!0,l=xe(e,[1,e.shape[0],e.shape[1],e.shape[2]]),s=[1,t[0],t[1],t[2]]),j(s.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${s.length}.`),j(l.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${l.rank}`),j(n.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${n.rank}`);const c=i==="NHWC"?s[3]:s[1],d=i==="NHWC"?l.shape[3]:l.shape[1];j(c===n.shape[2],()=>`Error in conv2dDerInput: depth of input (${c}) must match input depth for filter ${n.shape[2]}.`),j(d===n.shape[3],()=>`Error in conv2dDerInput: depth of output (${d}) must match output depth for filter ${n.shape[3]}.`),_i("conv2dDerInput",a,o);const p={dy:l,filter:n},f={strides:r,pad:a,dataFormat:i,dimRoundingMode:o,inputShape:s},m=te.runKernel(qb,p,f);return u?xe(m,[m.shape[1],m.shape[2],m.shape[3]]):m}const G8=ee({conv2DBackpropInput_:Ase});function Pse(t,e,n,r,a,i){const o=B(t,"x","conv2dTranspose"),s=B(e,"filter","conv2dTranspose");return G8(n,o,s,r,a,"NHWC",i)}const H8=ee({conv2dTranspose_:Pse});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Lse(t,e,n,r,a="NDHWC",i=[1,1,1]){const o=B(t,"x","conv3d"),s=B(e,"filter","conv3d");let l=o,u=!1;o.rank===4&&(u=!0,l=xe(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),j(l.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${l.rank}.`),j(s.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${s.rank}.`),j(l.shape[4]===s.shape[3],()=>`Error in conv3d: depth of input (${l.shape[4]}) must match input depth for filter ${s.shape[3]}.`),j(Wr(n,i),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`),j(a==="NDHWC",()=>`Error in conv3d: got dataFormat of ${a} but only NDHWC is currently supported.`);const c={x:l,filter:s},d={strides:n,pad:r,dataFormat:a,dilations:i},p=te.runKernel(Kb,c,d);return u?xe(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}const q8=ee({conv3d_:Lse});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Dse(t,e,n,r,a){j(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let i=t,o=e,s=!1;e.rank===4&&(s=!0,o=xe(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),i=[1,t[0],t[1],t[2],t[3]]);const l=i[4],u=o.shape[4];j(i.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${i.length}.`),j(o.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${o.rank}`),j(n.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${n.rank}`),j(l===n.shape[3],()=>`Error in conv3dDerInput: depth of input (${l}) must match input depth for filter ${n.shape[3]}.`),j(u===n.shape[4],()=>`Error in conv3dDerInput: depth of output (${u}) must match output depth for filter ${n.shape[4]}.`);const c={dy:o,filter:n},d={pad:a,strides:r,inputShape:i},p=te.runKernel(Xb,c,d);return s?xe(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}const Fse=ee({conv3DBackpropInput_:Dse});function Bse(t,e,n,r,a){const i=B(t,"x","conv3dTranspose"),o=B(e,"filter","conv3dTranspose");return Fse(n,i,o,r,a)}const K8=ee({conv3dTranspose_:Bse});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function zse(t){const e={x:B(t,"x","cos","float32")};return te.runKernel($f,e)}const X8=ee({cos_:zse});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function jse(t){const e={x:B(t,"x","cosh","float32")};return te.runKernel(Rf,e)}const Y8=ee({cosh_:jse});/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the 'License');
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an 'AS IS' BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Vse(t,e=0,n=!1,r=!1){const a={x:B(t,"x","cumprod")},i={axis:e,exclusive:n,reverse:r};return te.runKernel(Yb,a,i)}const Q8=ee({cumprod_:Vse});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Wse(t,e=0,n=!1,r=!1){const a={x:B(t,"x","cumsum")},i={axis:e,exclusive:n,reverse:r};return te.runKernel(Qb,a,i)}const Z8=ee({cumsum_:Wse});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Use(t,e,n,r=!1){const a=B(t,"x","denseBincount"),i=B(e,"weights","denseBincount");j(a.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${a.dtype}`),j(a.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${a.rank}.`),j(n>=0,()=>`size must be non-negative, but got ${n}.`),j(i.size===a.size||i.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${a.shape}, weights shape: ${i.shape}.`);const o={x:a,weights:i},s={size:n,binaryOutput:r};return te.runKernel(Jb,o,s)}const J8=ee({denseBincount_:Use});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Gse(t,e,n="NHWC"){const r=B(t,"x","depthToSpace","float32"),a=n==="NHWC"?r.shape[1]:r.shape[2],i=n==="NHWC"?r.shape[2]:r.shape[3],o=n==="NHWC"?r.shape[3]:r.shape[1];j(e>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${e}`),j(a*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${a} and ${e}  for depthToSpace with input shape
    ${r.shape}`),j(i*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${i} and ${e} for depthToSpace with input shape
        ${r.shape}`),j(o%(e*e)===0,()=>`Dimension size must be evenly divisible by ${e*e} but is ${o} for depthToSpace with input shape ${r.shape}`);const s={x:r},l={blockSize:e,dataFormat:n};return te.runKernel(ev,s,l)}const eL=ee({depthToSpace_:Gse});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Hse(t,e,n,r,a="NHWC",i=[1,1],o){const s=B(t,"x","depthwiseConv2d","float32"),l=B(e,"filter","depthwiseConv2d","float32");let u=s,c=!1;s.rank===3&&(c=!0,u=xe(s,[1,s.shape[0],s.shape[1],s.shape[2]])),j(u.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${u.rank}.`),j(l.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${l.rank}.`);const d=a==="NHWC"?u.shape[3]:u.shape[1];j(d===l.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${d}) must match the inChannels dimension in filter ${l.shape[2]}.`),_i("depthwiseConv2d",r,o);const p={x:u,filter:l},f={strides:n,pad:r,dataFormat:a,dilations:i,dimRoundingMode:o},m=te.runKernel(tv,p,f);return c?xe(m,[m.shape[1],m.shape[2],m.shape[3]]):m}const _x=ee({depthwiseConv2d_:Hse});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function qse(t){const e={x:B(t,"x","diag")};return te.runKernel(av,e)}const tL=ee({diag_:qse});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Kse(t,e,n,r,a=[1,1],i="NHWC"){const o=B(t,"x","dilation2d"),s=B(e,"filter","dilation2d");j(o.rank===3||o.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${o.rank}.`),j(s.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${s.rank}.`),j(i==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${i}`);let l=o,u=!1;o.rank===3&&(l=xe(o,[1,o.shape[0],o.shape[1],o.shape[2]]),u=!0);const c={x:l,filter:s},d={strides:n,pad:r,dilations:a},p=te.runKernel(iv,c,d);return u?xe(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const nL=ee({dilation2d_:Kse});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Xse(t,e){let n=B(t,"a","equal","string_or_numeric"),r=B(e,"b","equal","string_or_numeric");[n,r]=En(n,r),Nt(n.shape,r.shape);const a={a:n,b:r};return te.runKernel(Lf,a)}const nI=ee({equal_:Xse});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Yse(t,e,n){const r=B(e,"a","where"),a=B(n,"b","where"),i=B(t,"condition","where","bool"),o=Nt(Nt(i.shape,r.shape),a.shape),s=Jd(i,o),l=Jd(r,o),u=Jd(a,o),c={condition:s,t:l,e:u};return te.runKernel(qv,c)}const oc=ee({where_:Yse});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Qse(t){const e={x:B(t,"x","zerosLike")};return te.runKernel(hx,e)}const Va=ee({zerosLike_:Qse});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Zse(t,e){let n=B(t,"a","div"),r=B(e,"b","div");[n,r]=En(n,r);const a=un(n,r),i=Va(a),o=nI(r,i);return oc(o,i,a)}const rL=ee({divNoNan_:Zse});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Jse(t,e){const n=B(t,"t1","dot"),r=B(e,"t2","dot");j((n.rank===1||n.rank===2)&&(r.rank===1||r.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${n.rank} and ${r.rank}.`);const a=n.rank===1?n.size:n.shape[1],i=r.rank===1?r.size:r.shape[0];if(j(a===i,()=>`Error in dot: inner dimensions of inputs must match, but got ${a} and ${i}.`),n.rank===1&&r.rank===1){const o=xe(n,[1,-1]),s=xe(r,[-1,1]),l=Gt(o,s);return xe(l,[])}else if(n.rank===1&&r.rank===2){const o=xe(n,[1,-1]),s=xe(r,[r.shape[0],r.shape[1]]),l=Gt(o,s);return xe(l,[l.size])}else if(n.rank===2&&r.rank===1){const o=xe(r,[-1,1]),s=Gt(n,o);return xe(s,[s.size])}else{const o=xe(r,[r.shape[0],r.shape[1]]);return Gt(n,o)}}const aL=ee({dot_:Jse});/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function ele(t,...e){const n=e.map((a,i)=>B(a,`tensors${i}`,"einsum")),r={equation:t};return te.runKernel(ov,n,r)}const iL=ee({einsum_:ele});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function tle(t){const e={x:B(t,"x","elu","float32")};return te.runKernel(Af,e)}const rI=ee({elu_:tle});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function nle(t){let e=B(t,"x","erf");j(e.dtype==="int32"||e.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),e.dtype==="int32"&&(e=wn(e,"float32"));const n={x:e};return te.runKernel(Pf,n)}const oL=ee({erf_:nle});/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function aI(t,e){for(let n=0;n<t.length;++n)if(t[t.length-n-1]!==e-1-n)return!1;return!0}function sL(t,e,n){const r=t.length+e.length,a=[];let i=0,o=0;for(let s=0;s<r;s++)n.indexOf(s)===-1?a.push(t[i++]):a.push(e[o++]);return a}function Tr(t,e){const n=[],r=t.length;for(let i=0;i<r;i++)e.indexOf(i)===-1&&n.push(t[i]);const a=e.map(i=>t[i]);return[n,a]}function ir(t,e){const n=e.map(r=>1);return sL(t,n,e)}function Ir(t,e,n){j(aI(e,n),()=>`${t} supports only inner-most axes for now. Got axes ${e} and rank-${n} input.`)}function Un(t,e){if(aI(t,e))return null;const n=[];for(let r=0;r<e;++r)t.indexOf(r)===-1&&n.push(r);return t.forEach(r=>n.push(r)),n}function jg(t){return t.map((e,n)=>[n,e]).sort((e,n)=>e[1]-n[1]).map(e=>e[0])}function Gn(t,e){const n=[];for(let r=e-t;r<e;++r)n.push(r);return n}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function rle(t,e=null,n=!1){const r={x:B(t,"x","max")},a={reductionIndices:e,keepDims:n};return te.runKernel(vv,r,a)}const sc=ee({max_:rle});/**
* @license
* Copyright 2020 Google Inc. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function ale(t,e=null,n=!1){const r={x:B(t,"x","min")},a={axis:e,keepDims:n};return te.runKernel(Cv,r,a)}const Ox=ee({min_:ale});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function ile(t,e){let n=B(t,"base","pow"),r=B(e,"exp","pow");[n,r]=En(n,r);const a={a:n,b:r};return te.runKernel(ig,a)}const tp=ee({pow_:ile});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function St(t,e){if((jr(t)&&e!=="string"||Array.isArray(t))&&e!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(e==="string"&&jr(t)&&!(t instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Ml(t,[],[],e)}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function ole(t){const e={x:B(t,"x","sqrt","float32")};return te.runKernel(yg,e)}const Lo=ee({sqrt_:ole});/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function sle(t){const e=B(t,"x","square"),n={};return te.runKernel("Square",{x:e},n)}const Oi=ee({square_:sle});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function lle(t,e=null,n=!1){let r=B(t,"x","sum");r.dtype==="bool"&&(r=wn(r,"int32"));const a={x:r},i={axis:e,keepDims:n};return te.runKernel(Xv,a,i)}const cn=ee({sum_:lle});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function ule(t,e="euclidean",n=null,r=!1){t=B(t,"x","norm");const a=lL(t,e,n);let i=a.shape;if(r){const o=Pt(n,t.shape);i=ir(a.shape,o)}return xe(a,i)}function lL(t,e,n=null){if(t.rank===0)return ja(t);if(t.rank!==1&&n===null)return lL(xe(t,[-1]),e,n);if(t.rank===1||typeof n=="number"||Array.isArray(n)&&n.length===1){if(e===1)return cn(ja(t),n);if(e===1/0)return sc(ja(t),n);if(e===-1/0)return Ox(ja(t),n);if(e==="euclidean"||e===2)return Lo(cn(tp(ja(t),St(2,"int32")),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}if(Array.isArray(n)&&n.length===2){if(e===1)return sc(cn(ja(t),n[0]),n[1]-1);if(e===1/0)return sc(cn(ja(t),n[1]),n[0]);if(e===-1/0)return Ox(cn(ja(t),n[1]),n[0]);if(e==="fro"||e==="euclidean")return Lo(cn(Oi(t),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}throw new Error(`Error in norm: invalid axis: ${n}`)}const Vg=ee({norm_:ule});/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function cle(t,e=null,n=!1){return Vg(t,"euclidean",e,n)}const uL=ee({euclideanNorm_:cle});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function dle(t){const e={x:B(t,"x","exp")};return te.runKernel(Df,e)}const Dl=ee({exp_:dle});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function ple(t,e=0){const n=B(t,"x","expandDims","string_or_numeric");j(e<=n.rank,()=>"Axis must be <= rank of the tensor");const r={input:n},a={dim:e};return te.runKernel(sv,r,a)}const $s=ee({expandDims_:ple});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function hle(t){const e={x:B(t,"x","expm1")};return te.runKernel(Ff,e)}const cL=ee({expm1_:hle});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function fle(t,e){const n=B(t,"x","tile","string_or_numeric");j(n.rank===e.length,()=>`Error in transpose: rank of input ${n.rank} must match length of reps ${e}.`);const r={x:n},a={reps:e};return te.runKernel(kg,r,a)}const np=ee({tile_:fle});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function gle(t,e,n,r="float32"){e==null&&(e=t);const a=pt([t,e],r),i=t<=e?t:e;for(let s=0;s<i;++s)a.set(1,s,s);const o=xe(a.toTensor(),[t,e]);if(n==null)return o;if(n.length===1)return np($s(o,0),[n[0],1,1]);if(n.length===2)return np($s($s(o,0),0),[n[0],n[1],1,1]);if(n.length===3)return np($s($s($s(o,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${n.length}D.`)}const iI=ee({eye_:gle});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function mle(t){const e={x:B(t,"x","floor","float32")};return te.runKernel(Bf,e)}const oI=ee({floor_:mle});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function yle(t,e,n=0,r=0){const a=B(t,"x","gather"),i=B(e,"indices","gather","int32"),o={x:a,indices:i},s={axis:n,batchDims:r};return te.runKernel(pv,o,s)}const sI=ee({gather_:yle});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function ble(t,e){let n=B(t,"a","greater","string_or_numeric"),r=B(e,"b","greater","string_or_numeric");[n,r]=En(n,r),Nt(n.shape,r.shape);const a={a:n,b:r};return te.runKernel(jf,a)}const Wg=ee({greater_:ble});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function vle(t,e){let n=B(t,"a","greaterEqual","string_or_numeric"),r=B(e,"b","greaterEqual","string_or_numeric");[n,r]=En(n,r),Nt(n.shape,r.shape);const a={a:n,b:r};return te.runKernel(Vf,a)}const lI=ee({greaterEqual_:vle});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function xle(t){const e={x:B(t,"x","isFinite")};return te.runKernel(Uf,e)}const dL=ee({isFinite_:xle});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function wle(t){const e={x:B(t,"x","isInf")};return te.runKernel(Gf,e)}const pL=ee({isInf_:wle});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function kle(t){const e={x:B(t,"x","isNaN")};return te.runKernel(Hf,e)}const hL=ee({isNaN_:kle});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Sle(t,e=.2){const n={x:B(t,"x","leakyRelu")},r={alpha:e};return te.runKernel(mv,n,r)}const uI=ee({leakyRelu_:Sle});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Cle(t,e){let n=B(t,"a","less","string_or_numeric"),r=B(e,"b","less","string_or_numeric");[n,r]=En(n,r),Nt(n.shape,r.shape);const a={a:n,b:r};return te.runKernel(qf,a)}const fL=ee({less_:Cle});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Nle(t,e){let n=B(t,"a","lessEqual","string_or_numeric"),r=B(e,"b","lessEqual","string_or_numeric");[n,r]=En(n,r),Nt(n.shape,r.shape);const a={a:n,b:r};return te.runKernel(Kf,a)}const $x=ee({lessEqual_:Nle});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function gL(t,e,n){if(n<=0)throw new Error("The number of values should be positive.");const r={start:t,stop:e,num:n};return te.runKernel(yv,{},r)}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Tle(t,e=5,n=1,r=1,a=.5){const i=B(t,"x","localResponseNormalization");j(i.rank===4||i.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${i.rank}.`),j(Gu(e),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${e}.`);let o=i,s=!1;i.rank===3&&(s=!0,o=xe(i,[1,i.shape[0],i.shape[1],i.shape[2]]));const l={x:o},u={depthRadius:e,bias:n,alpha:r,beta:a},c=te.runKernel(bv,l,u);return s?xe(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const mL=ee({localResponseNormalization_:Tle});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Ile(t){const e={x:B(t,"x","log","float32")};return te.runKernel(Xf,e)}const rp=ee({log_:Ile});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Ele(t){const e={x:B(t,"x","log1p")};return te.runKernel(Yf,e)}const cI=ee({log1p_:Ele});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function _le(t){return j(Ol(t),()=>"The f passed in grad(f) must be a function"),(e,n)=>{const r=B(e,"x","tf.grad","string_or_numeric"),a=n!=null?B(n,"dy","tf.grad"):null;return te.tidy(()=>{const{value:i,grads:o}=te.gradients(()=>t(r),[r],a);return a!=null&&Cr(i.shape,a.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),Rx(o),o[0]})}}function Ole(t){return j(Ol(t),()=>"The f passed in grads(f) must be a function"),(e,n)=>{j(Array.isArray(e),()=>"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s");const r=Mg(e,"args","tf.grads","string_or_numeric"),a=n!=null?B(n,"dy","tf.grads"):null;return te.tidy(()=>{const{value:i,grads:o}=te.gradients(()=>t(...r),r,a);return a!=null&&Cr(i.shape,a.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),Rx(o),o})}}function $le(t){return j(Ol(t),()=>"The f passed in valueAndGrad(f) must be a function"),(e,n)=>{j(e instanceof In,()=>"The x passed in valueAndGrad(f)(x) must be a tensor"),j(n==null||n instanceof In,()=>"The dy passed in valueAndGrad(f)(x, dy) must be a tensor");const{grads:r,value:a}=te.gradients(()=>t(e),[e],n);return Rx(r),{grad:r[0],value:a}}}function Rle(t){return j(Ol(t),()=>"The f passed in valueAndGrads(f) must be a function"),(e,n)=>{j(Array.isArray(e)&&e.every(a=>a instanceof In),()=>"The args passed in valueAndGrads(f)(args) must be array of tensors"),j(n==null||n instanceof In,()=>"The dy passed in valueAndGrads(f)(args, dy) must be a tensor");const r=te.gradients(()=>t(...e),e,n);return n!=null&&Cr(r.value.shape,n.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),Rx(r.grads),r}}function yL(t,e){j(Ol(t),()=>"The f passed in variableGrads(f) must be a function"),j(e==null||Array.isArray(e)&&e.every(u=>u instanceof Rg),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const n=e!=null;if(!n){e=[];for(const u in te.registeredVariables)e.push(te.registeredVariables[u])}const r=n?e.filter(u=>!u.trainable):null,a=e.length;e=e.filter(u=>u.trainable),j(e.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${a} variables is trainable.`);const i=!0,{value:o,grads:s}=te.gradients(t,e,null,i);j(s.some(u=>u!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),j(o.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${o.rank} tensor`);const l={};return e.forEach((u,c)=>{s[c]!=null&&(l[u.name]=s[c])}),r?.forEach(u=>l[u.name]=null),{value:o,grads:l}}function Do(t){return te.customGrad(t)}function Rx(t){if(t.filter(e=>e==null).length>0)throw new Error(`Cannot compute gradient of y=f(x) with respect to x. Make sure that
    the f you passed encloses all operations that lead from x to y.`)}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Mle(t){const e={x:B(t,"x","softplus")};return te.runKernel(mg,e)}const dI=ee({softplus_:Mle});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Ale(t){const e=B(t,"x","logSigmoid");return Do(n=>({value:Po(dI(Po(n))),gradFunc:r=>$e(r,ic(Po(n)))}))(e)}const bL=ee({logSigmoid_:Ale});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Ple(t,e){let n=B(t,"a","sub"),r=B(e,"b","sub");[n,r]=En(n,r);const a={a:n,b:r};return te.runKernel(vg,a)}const xt=ee({sub_:Ple});/**
* @license
* Copyright 2020 Google Inc. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Lle(t,e=-1){const n=B(t,"logits","logSoftmax");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and axis was ${e}`);return Do((r,a)=>{const i=sc(r,e,!0),o=xt(r,i),s=xt(wn(o,"float32"),rp(cn(Dl(o),e,!0)));return a([s]),{value:s,gradFunc:(l,u)=>{const[c]=u,d=!0,p=Dl(c);return xt(l,$e(cn(l,e,d),p))}}})(n)}const vL=ee({logSoftmax_:Lle});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Dle(t,e=null,n=!1){const r=B(t,"x","logSumExp"),a=Pt(e,r.shape),i=sc(r,a,!0),o=xt(r,i),s=Dl(o),l=cn(s,a),u=rp(l),c=ot(xe(i,u.shape),u);if(n){const d=ir(c.shape,a);return xe(c,d)}return c}const pI=ee({logSumExp_:Dle});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Fle(t,e){const n=B(t,"a","logicalAnd","bool"),r=B(e,"b","logicalAnd","bool");Nt(n.shape,r.shape);const a={a:n,b:r};return te.runKernel(Qf,a)}const Ug=ee({logicalAnd_:Fle});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Ble(t){const e={x:B(t,"x","logicalNot","bool")};return te.runKernel(Zf,e)}const hI=ee({logicalNot_:Ble});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function zle(t,e){const n=B(t,"a","logicalOr","bool"),r=B(e,"b","logicalOr","bool");Nt(n.shape,r.shape);const a={a:n,b:r};return te.runKernel(Jf,a)}const fI=ee({logicalOr_:zle});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function jle(t,e){const n=B(t,"a","logicalXor","bool"),r=B(e,"b","logicalXor","bool");return Nt(n.shape,r.shape),Ug(fI(t,e),hI(Ug(t,e)))}const xL=ee({logicalXor_:jle});/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Mx=2147483648;function Vle(t,e,n="left"){const r=B(t,"sortedSequence","searchSorted"),a=B(e,"values","searchSorted"),i=r.shape[r.shape.length-1],o=a.shape[a.shape.length-1],s=xe(r,[-1,i]),l=xe(a,[-1,o]);if(s.rank<2)throw new Error("Sorted input argument must be at least 2-dimensional");if(s.shape[0]!==l.shape[0])throw new Error("Leading dimension of 'sortedSequence' and 'values' must match.");if(me(l.shape)>=Mx)throw new Error(`values tensor size must less than ${Mx}`);if(s.shape[1]>=Mx)throw new Error(`trailing dim_size must less than ${Mx} for int32 output type, was ${s.shape[1]}`);const u={sortedSequence:s,values:l},c={side:n};return te.runKernel(Hv,u,c)}const Ax=ee({searchSorted_:Vle});/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function wL(t,e){return Ax(t,e,"left")}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Wle(t,e,n,r,a){const i=B(t,"x","maxPool"),o=1;let s=i,l=!1;i.rank===3&&(l=!0,s=xe(i,[1,i.shape[0],i.shape[1],i.shape[2]])),j(s.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${s.rank}.`),j(Wr(n,o),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`),_i("maxPool",r,a);const u={x:s},c={filterSize:e,strides:n,pad:r,dimRoundingMode:a},d=te.runKernel(xv,u,c);return l?xe(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const gI=ee({maxPool_:Wle});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Ule(t,e=[1,1,1],n,r,a,i="NDHWC"){const o=B(t,"x","maxPool3d");let s=o,l=!1;o.rank===4&&(l=!0,s=xe(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),j(s.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${s.rank}.`),j(i==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${i}`),_i("maxPool3d",r,a);const u={x:s},c={filterSize:e,strides:n,pad:r,dimRoundingMode:a,dataFormat:i},d=te.runKernel(wv,u,c);return l?xe(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const kL=ee({maxPool3d_:Ule});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Gle(t,e,n,r,a=!1){const i={x:B(t,"x","maxPoolWithArgmax")},o={filterSize:e,strides:n,pad:r,includeBatchInIndex:a},s=te.runKernel(kv,i,o);return{result:s[0],indexes:s[1]}}const SL=ee({maxPoolWithArgmax_:Gle});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Hle(t,e){let n=B(t,"a","maximum"),r=B(e,"b","maximum");[n,r]=En(n,r),n.dtype==="bool"&&(n=wn(n,"int32"),r=wn(r,"int32")),Nt(n.shape,r.shape);const a={a:n,b:r};return te.runKernel(eg,a)}const mI=ee({maximum_:Hle});/**
* @license
* Copyright 2020 Google Inc. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function qle(t,e=null,n=!1){const r={x:B(t,"x","mean")},a={axis:e,keepDims:n};return te.runKernel(Sv,r,a)}const Gg=ee({mean_:qle});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Fl(t,e="float32"){if(e==="complex64"){const r=Fl(t,"float32"),a=Fl(t,"float32");return Ns(r,a)}const n=Nr(me(t),e);return te.makeTensor(n,t,e)}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Bl(t,e="float32"){if(e==="complex64"){const r=Bl(t,"float32"),a=Fl(t,"float32");return Ns(r,a)}const n=_b(me(t),e);return te.makeTensor(n,t,e)}/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function CL(t,e,{indexing:n="xy"}={}){if(n!=="xy"&&n!=="ij")throw new TypeError(`${n} is not a valid third argument to meshgrid`);if(t===void 0)return[];let r=B(t,"x","meshgrid",t instanceof In?t.dtype:"float32");if(e===void 0)return[r];let a=B(e,"y","meshgrid",e instanceof In?e.dtype:"float32");const i=me(r.shape),o=me(a.shape);return n==="xy"?(r=xe(r,[1,-1]),a=xe(a,[-1,1]),[Gt(Bl([o,1],r.dtype),r),Gt(a,Bl([1,i],a.dtype))]):(r=xe(r,[-1,1]),a=xe(a,[1,-1]),[Gt(r,Bl([1,o],r.dtype)),Gt(Bl([i,1],a.dtype),a)])}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Kle(t,e){let n=B(t,"a","minimum"),r=B(e,"b","minimum");[n,r]=En(n,r),n.dtype==="bool"&&(n=wn(n,"int32"),r=wn(r,"int32")),Nt(n.shape,r.shape);const a={a:n,b:r};return te.runKernel(tg,a)}const yI=ee({minimum_:Kle});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Xle(t,e,n){j(n==="reflect"||n==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${n}.`);const r=B(t,"x","mirrorPad");if(r.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");j(e.length===r.rank,()=>`Padding doesn't match input. Must be ${r.rank}. Got ${e.length}.`);const a=n==="reflect"?1:0;for(let s=0;s<r.rank;s++)j(e[s].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),j(e[s][0]>=0&&e[s][0]<=r.shape[s]-a&&e[s][1]>=0&&e[s][1]<=r.shape[s]-a,()=>`Padding in dimension ${s} cannot be greater than or equal to ${r.shape[s]-a} or less than 0 for input of shape ${r.shape}`);const i={paddings:e,mode:n},o={x:r};return te.runKernel(Nv,o,i)}const NL=ee({mirrorPad_:Xle});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Yle(t,e){let n=B(t,"a","mod"),r=B(e,"b","mod");[n,r]=En(n,r);const a={a:n,b:r};return te.runKernel(ng,a)}const TL=ee({mod_:Yle});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Qle(t,e=null,n=!1){t=B(t,"x","moments");const r=Pt(e,t.shape),a=Gg(t,r,n);let i=a.shape;n||(i=ir(a.shape,r));const o=Oi(xt(wn(t,"float32"),xe(a,i))),s=Gg(o,r,n);return{mean:a,variance:s}}const IL=ee({moments_:Qle});function Zle(t,e,n,r){const a=B(e,"data","multiRNNCell"),i=Mg(n,"c","multiRNNCell"),o=Mg(r,"h","multiRNNCell");let s=a;const l=[];for(let d=0;d<t.length;d++){const p=t[d](s,i[d],o[d]);l.push(p[0]),l.push(p[1]),s=p[1]}const u=[],c=[];for(let d=0;d<l.length;d+=2)u.push(l[d]),c.push(l[d+1]);return[u,c]}const EL=ee({multiRNNCell_:Zle});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Jle(t,e,n,r=!1){const a=B(t,"logits","multinomial"),i=a.size,o=a.rank;if(i<2)throw new Error(`Error in multinomial: you need at least 2 outcomes, but got ${i}.`);if(o>2)throw new Error(`Rank of probabilities must be 1 or 2, but is ${o}`);n=n||Math.random();const s={logits:o===1?xe(a,[1,-1]):a},l={numSamples:e,seed:n,normalized:r},u=te.runKernel(Tv,s,l);return o===1?xe(u,[u.size]):u}const _L=ee({multinomial_:Jle});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function eue(t,e){let n=B(t,"a","notEqual","string_or_numeric"),r=B(e,"b","notEqual","string_or_numeric");[n,r]=En(n,r),Nt(n.shape,r.shape);const a={a:n,b:r};return te.runKernel(ag,a)}const bI=ee({notEqual_:eue});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function tue(t){const e={x:B(t,"x","onesLike")};return te.runKernel($v,e)}const OL=ee({onesLike_:tue});function nue(t,e){const n=B(t,"v1","outerProduct"),r=B(e,"v2","outerProduct");j(n.rank===1&&r.rank===1,()=>`Error in outerProduct: inputs must be rank 1, but got ranks ${n.rank} and ${r.rank}.`);const a=xe(n,[-1,1]),i=xe(r,[1,-1]);return Gt(a,i)}const $L=ee({outerProduct_:nue});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function rue(t,e,n=0){const r=B(t,"x","pad");if(r.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const a={paddings:e,constantValue:n},i={x:r};return te.runKernel(Av,i,a)}const ap=ee({pad_:rue});function aue(t,e,n=0){return j(e.length===2,()=>"Invalid number of paddings. Must be length of 2."),ap(t,[e],n)}const RL=ee({pad1d_:aue});function iue(t,e,n=0){return j(e.length===2&&e[0].length===2&&e[1].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),ap(t,e,n)}const ML=ee({pad2d_:iue});function oue(t,e,n=0){return j(e.length===3&&e[0].length===2&&e[1].length===2&&e[2].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),ap(t,e,n)}const AL=ee({pad3d_:oue});function sue(t,e,n=0){return j(e.length===4&&e[0].length===2&&e[1].length===2&&e[2].length===2&&e[3].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),ap(t,e,n)}const PL=ee({pad4d_:sue});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function lue(t,e,n){const r=B(t,"x","spaceToBatchND");j(r.rank>=1+e.length,()=>`input rank ${r.rank} should be > than [blockShape] ${e.length}`),j(n.length===e.length,()=>`paddings.shape[0] ${n.length} must be equal to [blockShape] ${e.length}`),j(r.shape.reduce((o,s,l)=>l>0&&l<=e.length?o&&(s+n[l-1][0]+n[l-1][1])%e[l-1]===0:o,!0),()=>`input spatial dimensions ${r.shape.slice(1)} with paddings ${n.toString()} must be divisible by blockShapes ${e.toString()}`);const a={x:r},i={blockShape:e,paddings:n};return te.runKernel(Yv,a,i)}const vI=ee({spaceToBatchND_:lue});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function uue(t,e,n,r,a,i,o){a==null&&(a=[1,1]),i==null&&(i=1),r===0&&(r="valid");const s=B(t,"x","maxPool");let l=s,u=!1;s.rank===3&&(u=!0,l=xe(s,[1,s.shape[0],s.shape[1],s.shape[2]])),j(Wr(i,a),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${i} and dilations '${a}'`);const c=Ei(l.shape,e,i,a,r),d=[c.dilationHeight,c.dilationWidth];let p;r==="same"?p=due([c.filterHeight,c.filterWidth],d):p=[[0,0],[0,0]];const f=d[0]===1&&d[1]===1,[m,y]=cue([c.inHeight,c.inWidth],d,p),x=f?r:"valid",b=f?l:vI(l,d,m),v=(n==="avg"?()=>JT(b,e,i,x,o):()=>gI(b,e,i,x,o))(),w=f?v:eI(v,d,y);return u?xe(w,[w.shape[1],w.shape[2],w.shape[3]]):w}function cue(t,e,n){const r=n.map(c=>c[0]),a=n.map(c=>c[1]),i=t.concat(r,a),o=e.map((c,d)=>(c-i[d]%c)%c),s=a.map((c,d)=>c+o[d]),l=e.map((c,d)=>[r[d],s[d]]),u=e.map((c,d)=>[0,o[d]]);return[l,u]}function due(t,e){const n=t.map((i,o)=>i+(i-1)*(e[o]-1)).map(i=>i-1),r=n.map(i=>Math.floor(i/2)),a=n.map((i,o)=>i-r[o]);return n.map((i,o)=>[r[o],a[o]])}const LL=ee({pool_:uue});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function pue(t,e){const n=B(t,"x","prelu"),r=B(e,"alpha","prelu"),a={x:n,alpha:r};return te.runKernel(Pv,a)}const xI=ee({prelu_:pue});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function hue(t,e=null,n=!1){let r=B(t,"x","prod");r.dtype==="bool"&&(r=wn(r,"int32"));const a={x:r},i={axis:e,keepDims:n};return te.runKernel(Lv,a,i)}const DL=ee({prod_:hue});/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function fue(t,e,n,r){const a=t.map((c,d)=>B(c,`tensors${d}`,"raggedGather","int32")),i=B(e,"paramsDenseValues","raggedGather"),o=B(n,"indices","raggedGather","int32"),s={paramsNestedSplits:a,paramsDenseValues:i,indices:o},l={outputRaggedRank:r},u=te.runKernel(Dv,s,l);return{outputNestedSplits:u.slice(0,u.length-1),outputDenseValues:u[u.length-1]}}const FL=ee({raggedGather_:fue});/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function gue(t,e,n,r,a){const i=B(t,"shape","raggedTensorToTensor","int32"),o=B(e,"values","raggedTensorToTensor"),s=B(n,"defaultValue","raggedTensorToTensor",o.dtype),l=r.map((d,p)=>B(d,`tensors${p}`,"raggedTensorToTensor","int32")),u={shape:i,values:o,defaultValue:s,rowPartitionTensors:l},c={rowPartitionTypes:a};return te.runKernel(Fv,u,c)}const BL=ee({raggedTensorToTensor_:gue});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function mue(t,e,n){const r=me(t);let a=null;if(n==null||n==="float32")a=new Float32Array(r);else if(n==="int32")a=new Int32Array(r);else if(n==="bool")a=new Uint8Array(r);else throw new Error(`Unknown data type ${n}`);for(let i=0;i<r;i++)a[i]=e();return te.makeTensor(a,t,n)}const zL=ee({rand_:mue});var wI={exports:{}};wI.exports,function(t){(function(e,n,r){function a(l){var u=this,c=s();u.next=function(){var d=2091639*u.s0+u.c*23283064365386963e-26;return u.s0=u.s1,u.s1=u.s2,u.s2=d-(u.c=d|0)},u.c=1,u.s0=c(" "),u.s1=c(" "),u.s2=c(" "),u.s0-=c(l),u.s0<0&&(u.s0+=1),u.s1-=c(l),u.s1<0&&(u.s1+=1),u.s2-=c(l),u.s2<0&&(u.s2+=1),c=null}function i(l,u){return u.c=l.c,u.s0=l.s0,u.s1=l.s1,u.s2=l.s2,u}function o(l,u){var c=new a(l),d=u&&u.state,p=c.next;return p.int32=function(){return c.next()*4294967296|0},p.double=function(){return p()+(p()*2097152|0)*11102230246251565e-32},p.quick=p,d&&(typeof d=="object"&&i(d,c),p.state=function(){return i(c,{})}),p}function s(){var l=4022871197,u=function(c){c=String(c);for(var d=0;d<c.length;d++){l+=c.charCodeAt(d);var p=.02519603282416938*l;l=p>>>0,p-=l,p*=l,l=p>>>0,p-=l,l+=p*4294967296}return(l>>>0)*23283064365386963e-26};return u}n&&n.exports?n.exports=o:r&&r.amd?r(function(){return o}):this.alea=o})(ba,t,!1)}(wI);var yue=wI.exports,kI={exports:{}};kI.exports,function(t){(function(e,n,r){function a(s){var l=this,u="";l.x=0,l.y=0,l.z=0,l.w=0,l.next=function(){var d=l.x^l.x<<11;return l.x=l.y,l.y=l.z,l.z=l.w,l.w^=l.w>>>19^d^d>>>8},s===(s|0)?l.x=s:u+=s;for(var c=0;c<u.length+64;c++)l.x^=u.charCodeAt(c)|0,l.next()}function i(s,l){return l.x=s.x,l.y=s.y,l.z=s.z,l.w=s.w,l}function o(s,l){var u=new a(s),c=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var p=u.next()>>>11,f=(u.next()>>>0)/4294967296,m=(p+f)/(1<<21);while(m===0);return m},d.int32=u.next,d.quick=d,c&&(typeof c=="object"&&i(c,u),d.state=function(){return i(u,{})}),d}n&&n.exports?n.exports=o:r&&r.amd?r(function(){return o}):this.xor128=o})(ba,t,!1)}(kI);var bue=kI.exports,SI={exports:{}};SI.exports,function(t){(function(e,n,r){function a(s){var l=this,u="";l.next=function(){var d=l.x^l.x>>>2;return l.x=l.y,l.y=l.z,l.z=l.w,l.w=l.v,(l.d=l.d+362437|0)+(l.v=l.v^l.v<<4^(d^d<<1))|0},l.x=0,l.y=0,l.z=0,l.w=0,l.v=0,s===(s|0)?l.x=s:u+=s;for(var c=0;c<u.length+64;c++)l.x^=u.charCodeAt(c)|0,c==u.length&&(l.d=l.x<<10^l.x>>>4),l.next()}function i(s,l){return l.x=s.x,l.y=s.y,l.z=s.z,l.w=s.w,l.v=s.v,l.d=s.d,l}function o(s,l){var u=new a(s),c=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var p=u.next()>>>11,f=(u.next()>>>0)/4294967296,m=(p+f)/(1<<21);while(m===0);return m},d.int32=u.next,d.quick=d,c&&(typeof c=="object"&&i(c,u),d.state=function(){return i(u,{})}),d}n&&n.exports?n.exports=o:r&&r.amd?r(function(){return o}):this.xorwow=o})(ba,t,!1)}(SI);var vue=SI.exports,CI={exports:{}};CI.exports,function(t){(function(e,n,r){function a(s){var l=this;l.next=function(){var c=l.x,d=l.i,p,f;return p=c[d],p^=p>>>7,f=p^p<<24,p=c[d+1&7],f^=p^p>>>10,p=c[d+3&7],f^=p^p>>>3,p=c[d+4&7],f^=p^p<<7,p=c[d+7&7],p=p^p<<13,f^=p^p<<9,c[d]=f,l.i=d+1&7,f};function u(c,d){var p,f=[];if(d===(d|0))f[0]=d;else for(d=""+d,p=0;p<d.length;++p)f[p&7]=f[p&7]<<15^d.charCodeAt(p)+f[p+1&7]<<13;for(;f.length<8;)f.push(0);for(p=0;p<8&&f[p]===0;++p);for(p==8?f[7]=-1:f[p],c.x=f,c.i=0,p=256;p>0;--p)c.next()}u(l,s)}function i(s,l){return l.x=s.x.slice(),l.i=s.i,l}function o(s,l){s==null&&(s=+new Date);var u=new a(s),c=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var p=u.next()>>>11,f=(u.next()>>>0)/4294967296,m=(p+f)/(1<<21);while(m===0);return m},d.int32=u.next,d.quick=d,c&&(c.x&&i(c,u),d.state=function(){return i(u,{})}),d}n&&n.exports?n.exports=o:r&&r.amd?r(function(){return o}):this.xorshift7=o})(ba,t,!1)}(CI);var xue=CI.exports,NI={exports:{}};NI.exports,function(t){(function(e,n,r){function a(s){var l=this;l.next=function(){var c=l.w,d=l.X,p=l.i,f,m;return l.w=c=c+1640531527|0,m=d[p+34&127],f=d[p=p+1&127],m^=m<<13,f^=f<<17,m^=m>>>15,f^=f>>>12,m=d[p]=m^f,l.i=p,m+(c^c>>>16)|0};function u(c,d){var p,f,m,y,x,b=[],v=128;for(d===(d|0)?(f=d,d=null):(d=d+"\0",f=0,v=Math.max(v,d.length)),m=0,y=-32;y<v;++y)d&&(f^=d.charCodeAt((y+32)%d.length)),y===0&&(x=f),f^=f<<10,f^=f>>>15,f^=f<<4,f^=f>>>13,y>=0&&(x=x+1640531527|0,p=b[y&127]^=f+x,m=p==0?m+1:0);for(m>=128&&(b[(d&&d.length||0)&127]=-1),m=127,y=4*128;y>0;--y)f=b[m+34&127],p=b[m=m+1&127],f^=f<<13,p^=p<<17,f^=f>>>15,p^=p>>>12,b[m]=f^p;c.w=x,c.X=b,c.i=m}u(l,s)}function i(s,l){return l.i=s.i,l.w=s.w,l.X=s.X.slice(),l}function o(s,l){s==null&&(s=+new Date);var u=new a(s),c=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var p=u.next()>>>11,f=(u.next()>>>0)/4294967296,m=(p+f)/(1<<21);while(m===0);return m},d.int32=u.next,d.quick=d,c&&(c.X&&i(c,u),d.state=function(){return i(u,{})}),d}n&&n.exports?n.exports=o:r&&r.amd?r(function(){return o}):this.xor4096=o})(ba,t,!1)}(NI);var wue=NI.exports,TI={exports:{}};TI.exports,function(t){(function(e,n,r){function a(s){var l=this,u="";l.next=function(){var d=l.b,p=l.c,f=l.d,m=l.a;return d=d<<25^d>>>7^p,p=p-f|0,f=f<<24^f>>>8^m,m=m-d|0,l.b=d=d<<20^d>>>12^p,l.c=p=p-f|0,l.d=f<<16^p>>>16^m,l.a=m-d|0},l.a=0,l.b=0,l.c=-1640531527,l.d=1367130551,s===Math.floor(s)?(l.a=s/4294967296|0,l.b=s|0):u+=s;for(var c=0;c<u.length+20;c++)l.b^=u.charCodeAt(c)|0,l.next()}function i(s,l){return l.a=s.a,l.b=s.b,l.c=s.c,l.d=s.d,l}function o(s,l){var u=new a(s),c=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var p=u.next()>>>11,f=(u.next()>>>0)/4294967296,m=(p+f)/(1<<21);while(m===0);return m},d.int32=u.next,d.quick=d,c&&(typeof c=="object"&&i(c,u),d.state=function(){return i(u,{})}),d}n&&n.exports?n.exports=o:r&&r.amd?r(function(){return o}):this.tychei=o})(ba,t,!1)}(TI);var kue=TI.exports,jL={exports:{}};const Sue={},Cue=Object.freeze(Object.defineProperty({__proto__:null,default:Sue},Symbol.toStringTag,{value:"Module"})),VL=Lj(Cue);(function(t){(function(e,n,r){var a=256,i=6,o=52,s="random",l=r.pow(a,i),u=r.pow(2,o),c=u*2,d=a-1,p;function f(S,C,I){var _=[];C=C==!0?{entropy:!0}:C||{};var E=b(x(C.entropy?[S,w(n)]:S??v(),3),_),P=new m(_),A=function(){for(var D=P.g(i),V=l,z=0;D<u;)D=(D+z)*a,V*=a,z=P.g(1);for(;D>=c;)D/=2,V/=2,z>>>=1;return(D+z)/V};return A.int32=function(){return P.g(4)|0},A.quick=function(){return P.g(4)/4294967296},A.double=A,b(w(P.S),n),(C.pass||I||function(D,V,z,K){return K&&(K.S&&y(K,P),D.state=function(){return y(P,{})}),z?(r[s]=D,V):D})(A,E,"global"in C?C.global:this==r,C.state)}function m(S){var C,I=S.length,_=this,E=0,P=_.i=_.j=0,A=_.S=[];for(I||(S=[I++]);E<a;)A[E]=E++;for(E=0;E<a;E++)A[E]=A[P=d&P+S[E%I]+(C=A[E])],A[P]=C;(_.g=function(D){for(var V,z=0,K=_.i,X=_.j,Z=_.S;D--;)V=Z[K=d&K+1],z=z*a+Z[d&(Z[K]=Z[X=d&X+V])+(Z[X]=V)];return _.i=K,_.j=X,z})(a)}function y(S,C){return C.i=S.i,C.j=S.j,C.S=S.S.slice(),C}function x(S,C){var I=[],_=typeof S,E;if(C&&_=="object")for(E in S)try{I.push(x(S[E],C-1))}catch{}return I.length?I:_=="string"?S:S+"\0"}function b(S,C){for(var I=S+"",_,E=0;E<I.length;)C[d&E]=d&(_^=C[d&E]*19)+I.charCodeAt(E++);return w(C)}function v(){try{var S;return p&&(S=p.randomBytes)?S=S(a):(S=new Uint8Array(a),(e.crypto||e.msCrypto).getRandomValues(S)),w(S)}catch{var C=e.navigator,I=C&&C.plugins;return[+new Date,e,I,e.screen,w(n)]}}function w(S){return String.fromCharCode.apply(0,S)}if(b(r.random(),n),t.exports){t.exports=f;try{p=VL}catch{}}else r["seed"+s]=f})(typeof self<"u"?self:ba,[],Math)})(jL);var Nue=jL.exports,Tue=yue,Iue=bue,Eue=vue,_ue=xue,Oue=wue,$ue=kue,lc=Nue;lc.alea=Tue,lc.xor128=Iue,lc.xorwow=Eue,lc.xorshift7=_ue,lc.xor4096=Oue,lc.tychei=$ue;var Px=lc;/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class II{constructor(e,n,r,a,i){this.mean=e,this.stdDev=n,this.dtype=r,this.nextVal=NaN,this.truncated=a,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);const o=i||Math.random();this.random=Px.alea(o.toString())}nextValue(){if(!isNaN(this.nextVal)){const a=this.nextVal;return this.nextVal=NaN,a}let e,n,r=!1;for(;!r;){let a,i,o;do a=2*this.random()-1,i=2*this.random()-1,o=a*a+i*i;while(o>=1||o===0);const s=Math.sqrt(-2*Math.log(o)/o);e=this.mean+this.stdDev*a*s,n=this.mean+this.stdDev*i*s,(!this.truncated||this.isValidTruncated(e))&&(r=!0)}return(!this.truncated||this.isValidTruncated(n))&&(this.nextVal=this.convertValue(n)),this.convertValue(e)}convertValue(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}}class Rue{constructor(e,n,r,a){this.alpha=e,this.beta=1/n,this.dtype=r;const i=a||Math.random();this.randu=Px.alea(i.toString()),this.randn=new II(0,1,r,!1,this.randu()),e<1?this.d=e+2/3:this.d=e-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let e,n,r,a,i,o;for(;;){do a=this.randn.nextValue(),o=1+this.c*a;while(o<=0);if(o*=o*o,e=a*a,n=1-.331*e*e,r=.5*e+this.d*(1-o+Math.log(o)),i=this.randu(),i<n||Math.log(i)<r)break}return o=1/this.beta*this.d*o,this.alpha<1&&(o*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(o)}convertValue(e){return this.dtype==="float32"?e:Math.round(e)}}class Mue{constructor(e=0,n=1,r,a){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=e,this.range=n-e,this.dtype=r,a==null&&(a=Math.random()),typeof a=="number"&&(a=a.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${e} - ${n} <= 1 and dtype is not float`);this.random=Px.alea(a)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Aue(t,e,n=1,r="float32",a){if(n==null&&(n=1),r==null&&(r="float32"),r!=="float32"&&r!=="int32")throw new Error(`Unsupported data type ${r}`);const i=new Rue(e,n,r,a),o=pt(t,r);for(let s=0;s<o.values.length;s++)o.values[s]=i.nextValue();return o.toTensor()}const WL=ee({randomGamma_:Aue});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Pue(t,e=0,n=1,r,a){if(r!=null&&r==="bool")throw new Error(`Unsupported data type ${r}`);const i=new II(e,n,r,!1,a),o=pt(t,r);for(let s=0;s<o.values.length;s++)o.values[s]=i.nextValue();return o.toTensor()}const EI=ee({randomNormal_:Pue});/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Lue(t,e,n){if(e!=null&&e==="bool")throw new Error(`Unsupported data type ${e}`);return EI(t,0,1,e,n)}const UL=ee({randomStandardNormal_:Lue});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Due(t,e=0,n=1,r="float32",a){const i=pt(t,r),o=new Mue(e,n,null,a);for(let s=0;s<i.values.length;s++)i.values[s]=o.nextValue();return i.toTensor()}const _I=ee({randomUniform_:Due});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function ip(t,e,n=1,r="float32"){if(n===0)throw new Error("Cannot have a step of zero");const a={start:t,stop:e,step:n,dtype:r};return te.runKernel(Bv,{},a)}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Fue(t){const e={x:B(t,"x","reciprocal")};return te.runKernel(og,e)}const GL=ee({reciprocal_:Fue});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Bue(t){const e={x:B(t,"x","relu")};return te.runKernel(sg,e)}const Hg=ee({relu_:Bue});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function zue(t){const e={x:B(t,"x","relu6")};return te.runKernel(lg,e)}const OI=ee({relu6_:zue});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function jue(t,e){const n={x:B(t,"x","reverse")},r={dims:e};return te.runKernel(Uv,n,r)}const zl=ee({reverse_:jue});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Vue(t){const e=B(t,"x","reverse");return j(e.rank===1,()=>`Error in reverse1D: x must be rank 1 but got rank ${e.rank}.`),zl(e,0)}const HL=ee({reverse1d_:Vue});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Wue(t,e){const n=B(t,"x","reverse");return j(n.rank===2,()=>`Error in reverse2D: x must be rank 2 but got rank ${n.rank}.`),zl(n,e)}const qL=ee({reverse2d_:Wue});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Uue(t,e){const n=B(t,"x","reverse");return j(n.rank===3,()=>`Error in reverse3D: x must be rank 3 but got rank ${n.rank}.`),zl(n,e)}const KL=ee({reverse3d_:Uue});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Gue(t,e){const n=B(t,"x","reverse");return j(n.rank===4,()=>`Error in reverse4D: x must be rank 4 but got rank ${n.rank}.`),zl(n,e)}const XL=ee({reverse4d_:Gue});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Hue(t){const e={x:B(t,"x","round")};return te.runKernel(ug,e)}const $I=ee({round_:Hue});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function que(t){const e={x:B(t,"x","rsqrt","float32")};return te.runKernel(cg,e)}const YL=ee({rsqrt_:que});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Kue(t){const e={x:B(t,"x","selu")};return te.runKernel(dg,e)}const QL=ee({selu_:Kue});function Xue(t,e,n,r,a,i=[1,1],o="NHWC"){const s=B(t,"x","separableConv2d"),l=B(e,"depthwiseFilter","separableConv2d"),u=B(n,"pointwiseFilter","separableConv2d");let c=s,d=!1;if(s.rank===3&&(d=!0,c=xe(s,[1,s.shape[0],s.shape[1],s.shape[2]])),o==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");j(c.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${c.rank}.`),j(l.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${l.rank}.`),j(u.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${l.rank}.`),j(u.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${u.shape[0]}.`),j(u.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${u.shape[1]}.`);const p=l.shape[2],f=l.shape[3];j(u.shape[2]===p*f,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${p*f}, but got ${u.shape[2]}.`);const m=_x(c,l,r,a,o,i),y=zg(m,u,1,"valid",o);return d?xe(y,[y.shape[1],y.shape[2],y.shape[3]]):y}const ZL=ee({separableConv2d_:Xue});/**
* @license
* Copyright 2020 Google Inc. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/async function Yue(t,e){const n=B(t,"x","setdiff1d"),r=B(e,"y","setdiff1d");j(n.dtype===r.dtype,()=>`x and y should have the same dtype, but got x (${n.dtype}) and y (${r.dtype}).`),j(n.rank===1,()=>`x should be 1D tensor, but got x (${n.shape}).`),j(r.rank===1,()=>`y should be 1D tensor, but got y (${r.shape}).`);const a=await n.data(),i=await r.data(),o=new Set(i);let s=0;for(let c=0;c<a.length;c++)o.has(a[c])||s++;const l=new ar([s],n.dtype),u=new ar([s],"int32");for(let c=0,d=0;c<a.length;c++)o.has(a[c])||(l.values[d]=a[c],u.values[d]=c,d++);return[l.toTensor(),u.toTensor()]}const JL=Yue;/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Que(t){const e={x:B(t,"x","sign")};return te.runKernel(fg,e)}const eD=ee({sign_:Que});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Zue(t){const e={x:B(t,"x","sin","float32")};return te.runKernel(pg,e)}const tD=ee({sin_:Zue});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Jue(t){const e={x:B(t,"x","sinh")};return te.runKernel(hg,e)}const nD=ee({sinh_:Jue});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function ece(t,e,n){const r=B(t,"x","slice1d");return j(r.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${r.rank} tensor`),nn(r,[e],[n])}const rD=ee({slice1d_:ece});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function tce(t,e,n){const r=B(t,"x","slice2d");return j(r.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${r.rank} tensor`),nn(r,e,n)}const aD=ee({slice2d_:tce});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function nce(t,e,n){const r=B(t,"x","slice3d");return j(r.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${r.rank} tensor`),nn(r,e,n)}const iD=ee({slice3d_:nce});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function rce(t,e,n){const r=B(t,"x","slice4d");return j(r.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${r.rank} tensor`),nn(r,e,n)}const oD=ee({slice4d_:rce});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function ace(t,e=-1){const n=B(t,"logits","softmax","float32");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and dim was ${e}`);const r={logits:n},a={dim:e};return te.runKernel(Zv,r,a)}const sD=ee({softmax_:ace});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function ice(t){j(t.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${t.dtype}.`);const e={input:t};return te.runKernel(lv,e)}const Lx=ee({fft_:ice});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function oce(t){j(t.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${t.dtype}.`);const e={input:t};return te.runKernel(fv,e)}const qg=ee({ifft_:oce});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function sce(t){const e=t.shape[t.shape.length-1],n=t.size/e;let r;if(e<=2){const a=xe(t,[n,e]);r=qg(a)}else{const a=[n,2*(e-1)],i=xe(Yd(t),[n,e]),o=xe(Pg(t),[n,e]),s=zl(nn(i,[0,1],[n,e-2]),1),l=$e(zl(nn(o,[0,1],[n,e-2]),1),St(-1)),u=Ur([i,s],1),c=Ur([o,l],1),d=xe(Ns(u,c),[a[0],a[1]]);r=qg(d)}if(r=Yd(r),t.rank===3&&t.shape[0]!==0){const a=r,i=t.shape[0];r=xe(r,[i,r.shape[0]/i,r.shape[1]]),a.dispose()}return r}const RI=ee({irfft_:sce});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function lce(t,e,n=0){const r={x:B(t,"x","split")},a={numOrSizeSplits:e,axis:n};return te.runKernel(Qv,r,a)}const op=ee({split_:lce});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function uce(t,e){j(t.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${t.dtype}`);let n=t.shape[t.shape.length-1];const r=t.size/n;let a;if(e!=null&&e<n){const m=t.shape.map(x=>0),y=t.shape.map(x=>x);y[t.shape.length-1]=e,a=nn(t,m,y),n=e}else if(e!=null&&e>n){const m=t.shape.map(y=>y);m[t.shape.length-1]=e-n,a=Ur([t,Fl(m)],t.shape.length-1),n=e}else a=t;const i=Va(a),o=xe(Ns(a,i),[r,n]),s=Lx(o),l=Math.floor(n/2)+1,u=Yd(s),c=Pg(s),d=op(u,[l,n-l],u.shape.length-1),p=op(c,[l,n-l],c.shape.length-1),f=a.shape.slice();return f[a.shape.length-1]=l,xe(Ns(d[0],p[0]),f)}const Dx=ee({rfft_:uce});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function cce(t,e){let n=B(t,"a","squaredDifference"),r=B(e,"b","squaredDifference");[n,r]=En(n,r),Nt(n.shape,r.shape);const a={a:n,b:r},i={};return te.runKernel(bg,a,i)}const MI=ee({squaredDifference_:cce});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function dce(t,e){const n=B(t,"x","squeeze","string_or_numeric");return xe(n,ks(n.shape,e).newShape)}const Kg=ee({squeeze_:dce});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function pce(t,e=0){const n=Mg(t,"tensors","stack","string_or_numeric");j(n.length>=1,()=>"Pass at least one tensor to tf.stack"),n.length>0&&j(e<=n[0].rank,()=>"Axis must be <= rank of the tensor");const r=n,a={axis:e};return te.runKernel(Mv,r,a)}const Fo=ee({stack_:pce});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function hce(t,e=0){const n={x:B(t,"x","step")},r={alpha:e};return te.runKernel(Sg,n,r)}const AI=ee({step_:hce});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function fce(t,e,n,r,a=0,i=0,o=0,s=0,l=0){const u={x:B(t,"x","stridedSlice","string_or_numeric")},c={begin:e,end:n,strides:r,beginMask:a,endMask:i,ellipsisMask:o,newAxisMask:s,shrinkAxisMask:l};return te.runKernel(ax,u,c)}const lD=ee({stridedSlice_:fce});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function gce(t){const e={x:B(t,"x","tan","float32")};return te.runKernel(xg,e)}const uD=ee({tan_:gce});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function $i(t,e){Uu(t);const n=Mo(t,e);if(n.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Ml(t,null,n,e)}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function sp(t,e,n){if(Uu(t),e!=null&&e.length!==2)throw new Error("tensor2d() requires shape to have two numbers");const r=Mo(t,n);if(r.length!==2&&r.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Ml(t,e,r,n)}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function cD(t,e,n){if(Uu(t),e!=null&&e.length!==4)throw new Error("tensor4d() requires shape to have four numbers");const r=Mo(t,n);if(r.length!==4&&r.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return Ml(t,e,r,n)}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function dD(t,e,n){if(Uu(t),e!=null&&e.length!==5)throw new Error("tensor5d() requires shape to have five numbers");const r=Mo(t,n);if(r.length!==5&&r.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return Ml(t,e,r,n)}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function pD(t,e,n){if(Uu(t),e!=null&&e.length!==6)throw new Error("tensor6d() requires shape to have six numbers");const r=Mo(t,n);if(r.length!==6&&r.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return e=e||r,Ml(t,e,r,n)}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function mce(t,e=1,n=!0){const r=B(t,"x","topk");if(r.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");const a=r.shape[r.shape.length-1];if(e<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${e}`);if(e>a)throw new Error(`'k' passed to topk() must be <= the last dimension (${a}) but got ${e}`);const i={x:r},o={k:e,sorted:n},[s,l]=te.runKernel(lx,i,o);return{values:s,indices:l}}const hD=ee({topk_:mce});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function yce(t,e=0,n=1,r,a){if(r!=null&&r==="bool")throw new Error("Unsupported data type $ { dtype }");const i=new II(e,n,r,!0,a),o=pt(t,r);for(let s=0;s<o.values.length;s++)o.values[s]=i.nextValue();return o.toTensor()}const fD=ee({truncatedNormal_:yce});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function bce(t,e=0){const n=B(t,"x","unique","string_or_numeric");j(n.rank>0,()=>"The input tensor must be at least 1D");const r={x:n},a={axis:e},[i,o]=te.runKernel(cx,r,a);return{values:i,indices:o}}const gD=ee({unique_:bce});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function vce(t,e,n){const r=B(t,"x","unsortedSegmentSum"),a=B(e,"segmentIds","unsortedSegmentSum","int32");j(Gu(n),()=>"numSegments must be of dtype int");const i={x:r,segmentIds:a},o={numSegments:n};return te.runKernel(px,i,o)}const mD=ee({unsortedSegmentSum_:vce});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function xce(t,e=0){const n=B(t,"x","unstack","string_or_numeric");j(e>=-n.shape.length&&e<n.shape.length,()=>`Axis = ${e} is not in [-${n.shape.length}, ${n.shape.length})`);const r={value:n},a={axis:e};return te.runKernel(dx,r,a)}const jl=ee({unstack_:xce});/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function yD(t,e){return Ax(t,e,"right")}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function bD(t,e=!0,n,r){return te.makeVariable(t,e,n,r)}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Fx(t,e){const n=[];for(let i=0;i<e.length;i++)e[i]&&n.push(i);const r=pt(t,"int32"),a=pt([n.length,t.length],"int32");for(let i=0;i<n.length;i++){const o=r.indexToLoc(n[i]),s=i*t.length;a.values.set(o,s)}return a.toTensor()}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/async function wce(t){const e=B(t,"condition","whereAsync","bool"),n=await e.data(),r=Fx(e.shape,n);return t!==e&&e.dispose(),r}const PI=wce;/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/async function kce(t,e,n){const r=B(t,"tensor","boolMask"),a=B(e,"mask","boolMask","bool"),i=n??0,o=a.rank,s=r.shape;j(o>0,()=>"mask cannot be scalar"),Cr(s.slice(i,i+o),a.shape,"mask's shape must match the first K dimensions of tensor's shape,");let l=1;for(let y=i;y<i+o;y++)l*=s[y];const u=s.slice(0,i).concat([l],s.slice(i+o)),c=xe(r,u),d=xe(a,[-1]),p=await PI(d),f=Kg(p,[1]),m=sI(c,f,i);return t!==r&&r.dispose(),e!==a&&a.dispose(),f.dispose(),c.dispose(),d.dispose(),p.dispose(),m}const vD=kce;/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Sce(t,e,n,r,a=!0){const i=B(t,"v","movingAverage"),o=B(e,"x","movingAverage"),s=B(n,"decay","movingAverage");RP(i,o),j(tn(i.shape,o.shape),()=>"Shape mismatch in v and x");const l=St(1),u=xt(l,s);let c=$e(xt(o,i),u);if(a){j(r!=null,()=>"When using zeroDebias: true, step is required.");const d=B(r,"step","movingAverage");c=un(c,xt(l,tp(s,d)))}return ot(i,c)}const xD=ee({movingAverage_:Sce});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Cce(t,e,n){const r=B(t,"indices","scatterND","int32"),a=B(e,"updates","scatterND");BT(a,r,n);const i={indices:r,updates:a},o={shape:n};return te.runKernel(Gv,i,o)}const wD=ee({scatterND_:Cce});function Nce(t,e,n,r){if(t.dtype!=="int32")throw new Error(`tf.sparseToDense() expects the indices to be int32 type, but the dtype was ${t.dtype}.`);if(t.rank>2)throw new Error(`sparseIndices should be a scalar, vector, or matrix, but got shape ${t.shape}.`);const a=t.rank>0?t.shape[0]:1,i=t.rank>1?t.shape[1]:1;if(n.length!==i)throw new Error(`outputShape has incorrect number of elements:, ${n.length}, should be: ${i}.`);const o=e.size;if(!(e.rank===0||e.rank===1&&o===a))throw new Error(`sparseValues has incorrect shape ${e.shape}, should be [] or [${a}]`);if(e.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Tce(t,e,n,r=0){const a=B(t,"sparseIndices","sparseToDense","int32"),i=B(e,"sparseValues","sparseToDense","string_or_numeric"),o=B(r,"defaultValue","sparseToDense",i.dtype);Nce(a,i,n,o);const s={sparseIndices:a,sparseValues:i,defaultValue:o},l={outputShape:n};return te.runKernel(rx,s,l)}const kD=ee({sparseToDense_:Tce});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Ice(t,e){const n=B(e,"indices","gatherND","int32"),r={params:B(t,"x","gatherND","string_or_numeric"),indices:n};return te.runKernel(hv,r)}const SD=ee({gatherND_:Ice});/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Ece(t,e){if(e==null)return t.shape.slice();if(tn(t.shape,e))return e;if(t.shape.length===e.length){const n=[];for(let r=0;r<t.shape.length;r++)e[r]==null&&t.shape[r]!=null?n.push(t.shape[r]):n.push(e[r]);return n}return e}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function _ce(t,e,n,r){const a=B(t,"x","dropout");if(j(a.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${a.dtype} tensor instead.`),j(e>=0&&e<1,()=>`rate must be a float in the range [0, 1), but got ${e}.`),e===0)return t instanceof In?a.clone():a;const i=Ece(a,n),o=1-e,s=un(oI(ot(_I(i,0,1,"float32",r),o)),o);return $e(a,s)}const CD=ee({dropout_:_ce});/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function LI(t){return Math.floor(Math.pow(2,Math.ceil(Math.log(t)/Math.log(2))))}function Bx(t,e,n){const r=1-t%2,a=new Float32Array(t);for(let i=0;i<t;++i){const o=2*Math.PI*i/(t+r-1);a[i]=e-n*Math.cos(o)}return $i(a,"float32")}/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/async function Oce(t,e,n=1){const r=B(t,"predictions","inTopK"),a=B(e,"targets","inTopK");j(r.rank>1,()=>`inTopK() expects the predictions to be of rank 2 or higher, but got ${r.rank}`),j(r.rank-1===a.rank,()=>`predictions rank should be 1 larger than targets rank, but got predictions rank ${r.rank} and targets rank ${a.rank}`),Cr(r.shape.slice(0,r.shape.length-1),a.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");const i=r.shape[r.shape.length-1];j(n>0&&n<=i,()=>`'k' passed to inTopK() must be > 0 && <= the predictions last dimension (${i}), but got ${n}`);const o=await r.data(),s=await a.data(),[l,u]=[o.length/i,i],c=nr("bool",l);for(let d=0;d<l;d++){const p=d*u,f=o.subarray(p,p+u),m=[];for(let y=0;y<f.length;y++)m.push({value:f[y],index:y});m.sort((y,x)=>x.value-y.value),c[d]=0;for(let y=0;y<n;y++)if(m[y].index===s[d]){c[d]=1;break}}return t!==r&&r.dispose(),e!==a&&a.dispose(),uo(c,a.shape,"bool")}const ND=Oce;/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function $ce(t,e,n,r,a,i="NHWC",o){let s=t;t.rank===3&&(s=xe(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l=e;l.rank===3&&(l=xe(e,[1,e.shape[0],e.shape[1],e.shape[2]])),j(s.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${s.shape}.`),j(l.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${l.shape}.`),j(n.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${n}.`);const u=i==="NHWC"?s.shape[3]:s.shape[1],c=i==="NHWC"?l.shape[3]:l.shape[1];j(u===n[2],()=>`Error in conv2dDerFilter: depth of input ${u}) must match input depth in filter (${n[2]}.`),j(c===n[3],()=>`Error in conv2dDerFilter: depth of dy (${c}) must match output depth for filter (${n[3]}).`),_i("conv2dDerFilter",a,o);const d={x:s,dy:l},p={strides:r,pad:a,dataFormat:i,dimRoundingMode:o,filterShape:n};return te.runKernel(Hb,d,p)}const Rce=ee({conv2DBackpropFilter_:$ce});/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function zx(t,e,n){if(n==null||n==="linear")return t;if(n==="relu")return $e(t,AI(e));throw new Error(`Cannot compute gradient for fused activation ${n}.`)}function jx(t,e){let n=e;const r=LT(t.shape,e.shape);return r.length>0&&(n=cn(n,r)),xe(n,t.shape)}function Vx(t,e,n,r){if(e==="linear")return t;if(e==="relu")return Hg(t);if(e==="elu")return rI(t);if(e==="relu6")return OI(t);if(e==="prelu")return xI(t,n);if(e==="leakyrelu")return uI(t,r);if(e==="sigmoid")return ic(t);throw new Error(`Unknown fused activation ${e}.`)}const Wx=(t,e)=>!(t>0)||e==="linear";/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Mce({x:t,filter:e,strides:n,pad:r,dataFormat:a="NHWC",dilations:i=[1,1],dimRoundingMode:o,bias:s,activation:l="linear",preluActivationWeights:u,leakyreluAlpha:c}){if(l=l||"linear",Wx(te.state.gradientDepth,l)===!1){j(a==="NHWC",()=>`Error in fused conv2d: got dataFormat of ${a} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let I=zg(t,e,n,r,a,i,o);return s!=null&&(I=ot(I,s)),Vx(I,l,u,c)}const d=B(t,"x","conv2d","float32"),p=B(e,"filter","conv2d","float32");let f=d,m=!1;d.rank===3&&(m=!0,f=xe(d,[1,d.shape[0],d.shape[1],d.shape[2]])),j(f.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${f.rank}.`),j(p.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${p.rank}.`),_i("fused conv2d",r,o);const y=a==="NHWC"?f.shape[3]:f.shape[1];j(p.shape[2]===y,()=>`Error in conv2d: depth of input (${y}) must match input depth for filter ${p.shape[2]}.`),j(Wr(n,i),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`);const x=fr(f.shape,p.shape,n,i,r,o);let b;s!=null&&(b=B(s,"bias","fused conv2d"),[b]=En(b,d),a==="NHWC"?Nt(x.outShape,b.shape):(j(b.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${b.shape.length}.`),j(b.shape.length===0||b.shape[0]===x.outChannels||b.shape[0]===1,()=>`Error in fused conv2d: bias shape (${b.shape}) is not compatible with the number of output channels (${x.outChannels})`)));let v;if(u!=null){const I=u.shape;if(j(I.length<=1||I.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${I.length}.`),I.length===1)j(I[0]===1||I[0]===x.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${I}) is not compatible with the number of output channels (${x.outChannels}).`);else if(I.length===3)try{Nt(I,x.outShape)}catch{const _=`Error in fused conv2d: PReLU activation weights (${I}) is not compatible with the output shape of the conv2d (${x.outShape}).`;throw Error(_)}v=B(u,"prelu weights","fused conv2d")}const w=(I,_)=>{j(a==="NHWC",()=>`Error in gradient of fused conv2D: got dataFormat of ${a} but only NHWC is currently supported.`);const[E,P,A,D]=_,V=zx(I,A,l);j(Fg(i),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${i}'`);const z=G8(P.shape,V,E,n,r),K=Rce(P,V,E.shape,n,r),X=[z,K];if(D!=null){const Z=jx(D,V);X.push(Z)}return X},S={x:f,filter:p,bias:b,preluActivationWeights:v},C={strides:n,pad:r,dataFormat:a,dilations:i,dimRoundingMode:o,activation:l,leakyreluAlpha:c};return s==null?Do((I,_,E)=>{let P=te.runKernel(Ng,S,C);return E([_,I,P]),m&&(P=xe(P,[P.shape[1],P.shape[2],P.shape[3]])),{value:P,gradFunc:w}})(f,p):Do((I,_,E,P)=>{let A=te.runKernel(Ng,S,C);return P([_,I,A,E]),m&&(A=xe(A,[A.shape[1],A.shape[2],A.shape[3]])),{value:A,gradFunc:w}})(f,p,b)}const Ace=ee({fusedConv2d_:Mce});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Pce(t,e,n,r,a,i=[1,1],o){let s=t;t.rank===3&&(s=xe(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l=e;l.rank===3&&(l=xe(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const u={x:s,dy:l},c={strides:r,pad:a,dimRoundingMode:o,dilations:i,filterShape:n};return te.runKernel(nv,u,c)}const Lce=ee({depthwiseConv2dNativeBackpropFilter_:Pce});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Dce(t,e,n,r,a,i=[1,1],o){let s=e,l=!1;e.rank===3&&(l=!0,s=xe(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const u={dy:s,filter:n},c={strides:r,pad:a,dimRoundingMode:o,dilations:i,inputShape:t},d=te.runKernel(rv,u,c);return l?xe(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const Fce=ee({depthwiseConv2dNativeBackpropInput_:Dce});/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Bce({x:t,filter:e,strides:n,pad:r,dataFormat:a="NHWC",dilations:i=[1,1],dimRoundingMode:o,bias:s,activation:l="linear",preluActivationWeights:u,leakyreluAlpha:c}){if(Wx(te.state.gradientDepth,l)===!1){let C=_x(t,e,n,r,a,i,o);return s!=null&&(C=ot(C,s)),Vx(C,l,u,c)}const d=B(t,"x","depthwiseConv2d","float32"),p=B(e,"filter","depthwiseConv2d","float32");let f=d,m=!1;d.rank===3&&(m=!0,f=xe(d,[1,d.shape[0],d.shape[1],d.shape[2]])),j(f.rank===4,()=>`Error in fused depthwiseConv2d: input must be rank 4, but got rank ${f.rank}.`),j(p.rank===4,()=>`Error in fused depthwiseConv2d: filter must be rank 4, but got rank ${p.rank}.`),j(f.shape[3]===p.shape[2],()=>`Error in fused depthwiseConv2d: number of input channels (${f.shape[3]}) must match the inChannels dimension in filter ${p.shape[2]}.`),i==null&&(i=[1,1]),j(Wr(n,i),()=>`Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`),_i("fused depthwiseConv2d",r,o);const y=fr(f.shape,p.shape,n,i,r,o,!0);let x;s!=null&&(x=B(s,"bias","fused conv2d"),[x]=En(x,d),Nt(y.outShape,x.shape));let b;u!=null&&(b=B(u,"prelu weights","fused depthwiseConv2d"));const v=(C,I)=>{j(Fg(i),()=>`Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '${i}'`);const[_,E,P,A]=I,D=zx(C,P,l),V=Fce(E.shape,D,_,n,r,i,o),z=Lce(E,D,_.shape,n,r,i,o);if(A!=null){const K=jx(x,D);return[V,z,K]}return[V,z]},w={x:f,filter:p,bias:x,preluActivationWeights:b},S={strides:n,pad:r,dataFormat:a,dilations:i,dimRoundingMode:o,activation:l,leakyreluAlpha:c};return s==null?Do((C,I,_)=>{let E=te.runKernel(Tg,w,S);return _([I,C,E]),m&&(E=xe(E,[E.shape[1],E.shape[2],E.shape[3]])),{value:E,gradFunc:v}})(f,p):Do((C,I,_,E)=>{let P=te.runKernel(Tg,w,S);return E([I,C,P,_]),m&&(P=xe(P,[P.shape[1],P.shape[2],P.shape[3]])),{value:P,gradFunc:v}})(f,p,x)}const zce=ee({fusedDepthwiseConv2d_:Bce});/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function jce({a:t,b:e,transposeA:n=!1,transposeB:r=!1,bias:a,activation:i="linear",preluActivationWeights:o,leakyreluAlpha:s=.2}){if(Wx(te.state.gradientDepth,i)===!1){let A=Gt(t,e,n,r);return a!=null&&(A=ot(A,a)),Vx(A,i,o,s)}let l=B(t,"a","fused matMul"),u=B(e,"b","fused matMul");[l,u]=En(l,u);const c=n?l.shape[l.rank-2]:l.shape[l.rank-1],d=r?u.shape[u.rank-1]:u.shape[u.rank-2],p=n?l.shape[l.rank-1]:l.shape[l.rank-2],f=r?u.shape[u.rank-2]:u.shape[u.rank-1],m=l.shape.slice(0,-2),y=u.shape.slice(0,-2),x=me(m),b=me(y);j(c===d,()=>`Error in fused matMul: inner shapes (${c}) and (${d}) of Tensors with shapes ${l.shape} and ${u.shape} and transposeA=${n} and transposeB=${r} must match.`);const v=Nt(l.shape.slice(0,-2),u.shape.slice(0,-2)).concat([p,f]),w=n?xe(l,[x,c,p]):xe(l,[x,p,c]),S=r?xe(u,[b,f,d]):xe(u,[b,d,f]);let C;a!=null&&(C=B(a,"bias","fused matMul"),[C]=En(C,l),Nt(v,C.shape));let I;o!=null&&(I=B(o,"prelu weights","fused matMul"));const _=(A,D)=>{const[V,z,K,X]=D,Z=zx(xe(A,K.shape),K,i);let q,F;if(!n&&!r?(q=Gt(Z,z,!1,!0),F=Gt(V,Z,!0,!1)):!n&&r?(q=Gt(Z,z,!1,!1),F=Gt(Z,V,!0,!1)):n&&!r?(q=Gt(z,Z,!1,!0),F=Gt(V,Z,!1,!1)):(q=Gt(z,Z,!0,!0),F=Gt(Z,V,!0,!0)),a!=null){const Y=jx(X,Z);return[q,F,Y]}else return[q,F]},E={a:w,b:S,bias:C,preluActivationWeights:I},P={transposeA:n,transposeB:r,activation:i,leakyreluAlpha:s};return a==null?Do((A,D,V)=>{const z=te.runKernel(Cg,E,P);return V([A,D,z]),{value:xe(z,v),gradFunc:_}})(w,S):Do((A,D,V,z)=>{const K=te.runKernel(Cg,E,P);return z([A,D,K,V]),{value:xe(K,v),gradFunc:_}})(w,S,C)}const Vce=ee({fusedMatMul_:jce});/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const TD=Object.freeze(Object.defineProperty({__proto__:null,conv2d:Ace,depthwiseConv2d:zce,matMul:Vce},Symbol.toStringTag,{value:"Module"}));/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Wce(t){return Bx(t,.54,.46)}const Uce=ee({hammingWindow_:Wce});/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Gce(t){return Bx(t,.5,.5)}const ID=ee({hannWindow_:Gce});/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Hce(t,e,n,r=!1,a=0){let i=0;const o=[];for(;i+e<=t.size;)o.push(nn(t,i,e)),i+=n;if(r)for(;i<t.size;){const s=i+e-t.size,l=Ur([nn(t,i,e-s),ep([s],a)]);o.push(l),i+=n}return o.length===0?sp([],[0,e]):xe(Ur(o),[o.length,e])}const ED=ee({frame_:Hce});/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function qce(t,e,n,r,a=ID){r==null&&(r=LI(e));const i=ED(t,e,n),o=$e(i,a(e));return Dx(o,r)}const Kce=ee({stft_:qce});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Xce(t,e,n,r,a="bilinear",i=0){const o=B(t,"image","cropAndResize"),s=B(e,"boxes","cropAndResize","float32"),l=B(n,"boxInd","cropAndResize","int32"),u=s.shape[0];j(o.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${o.rank}.`),j(s.rank===2&&s.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${u},4] but had shape ${s.shape}.`),j(l.rank===1&&l.shape[0]===u,()=>`Error in cropAndResize: boxInd must be have size [${u}] but had shape ${s.shape}.`),j(r.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${r.length}.`),j(r[0]>=1&&r[1]>=1,()=>`cropSize must be atleast [1,1], but was ${r}`),j(a==="bilinear"||a==="nearest",()=>`method must be bilinear or nearest, but was ${a}`);const c={image:o,boxes:s,boxInd:l},d={method:a,extrapolationValue:i,cropSize:r};return te.runKernel(Zb,c,d)}const Yce=ee({cropAndResize_:Xce});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Qce(t){const e=B(t,"image","flipLeftRight","float32");j(e.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${e.rank}.`);const n={image:e};return te.runKernel(cv,n,{})}const Zce=ee({flipLeftRight_:Qce});/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Jce(t){const e=B(t,"image","grayscaleToRGB"),n=e.rank-1,r=e.shape[n];j(e.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${e.rank}.`),j(r===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${r}.`);const a=new Array(e.rank);return a.fill(1,0,n),a[n]=3,np(e,a)}const ede=ee({grayscaleToRGB_:Jce});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function tde(t,e,n=0,r=.5){const a=B(t,"image","rotateWithOffset","float32");j(a.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${a.rank}.`);const i={image:a},o={radians:e,fillValue:n,center:r};return te.runKernel(gx,i,o)}const nde=ee({rotateWithOffset_:tde});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function lp(t,e,n,r,a,i){r==null&&(r=.5),a==null&&(a=Number.NEGATIVE_INFINITY),i==null&&(i=0);const o=t.shape[0];return n=Math.min(n,o),j(0<=r&&r<=1,()=>`iouThreshold must be in [0, 1], but was '${r}'`),j(t.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${t.rank}'`),j(t.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${t.shape[1]}`),j(e.rank===1,()=>"scores must be a 1D tensor"),j(e.shape[0]===o,()=>`scores has incompatible shape with boxes. Expected ${o}, but was ${e.shape[0]}`),j(0<=i&&i<=1,()=>`softNmsSigma must be in [0, 1], but was '${i}'`),{maxOutputSize:n,iouThreshold:r,scoreThreshold:a,softNmsSigma:i}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function rde(t,e,n,r=.5,a=Number.NEGATIVE_INFINITY){const i=B(t,"boxes","nonMaxSuppression","float32"),o=B(e,"scores","nonMaxSuppression","float32"),s=lp(i,o,n,r,a);n=s.maxOutputSize,r=s.iouThreshold,a=s.scoreThreshold;const l={maxOutputSize:n,iouThreshold:r,scoreThreshold:a};return te.runKernel(Ev,{boxes:i,scores:o},l)}const ade=ee({nonMaxSuppression_:rde});/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function ide(t,e,n){const r=ode(t,e,n),a=r<0?-(r+1):r;t.splice(a,0,e)}function ode(t,e,n){return lde(t,e,n||sde)}function sde(t,e){return t>e?1:t<e?-1:0}function lde(t,e,n){let r=0,a=t.length,i=0,o=!1;for(;r<a;){i=r+(a-r>>>1);const s=n(e,t[i]);s>0?r=i+1:(a=i,o=!s)}return o?r:-r-1}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Ux(t,e,n,r,a){return DI(t,e,n,r,a,0)}function Gx(t,e,n,r,a,i){return DI(t,e,n,r,a,0,!1,i,!0)}function Hx(t,e,n,r,a,i){return DI(t,e,n,r,a,i,!0)}function DI(t,e,n,r,a,i,o=!1,s=!1,l=!1){const u=[];for(let x=0;x<e.length;x++)e[x]>a&&u.push({score:e[x],boxIndex:x,suppressBeginIndex:0});u.sort(_D);const c=i>0?-.5/i:0,d=[],p=[];for(;d.length<n&&u.length>0;){const x=u.pop(),{score:b,boxIndex:v,suppressBeginIndex:w}=x;if(b<a)break;let S=!1;for(let C=d.length-1;C>=w;--C){const I=ude(t,v,d[C]);if(I>=r){S=!0;break}if(x.score=x.score*cde(r,c,I),x.score<=a)break}x.suppressBeginIndex=d.length,S||(x.score===b?(d.push(v),p.push(x.score)):x.score>a&&ide(u,x,_D))}const f=d.length,m=n-f;s&&m>0&&(d.push(...new Array(m).fill(0)),p.push(...new Array(m).fill(0)));const y={selectedIndices:d};return o&&(y.selectedScores=p),l&&(y.validOutputs=f),y}function ude(t,e,n){const r=t.subarray(e*4,e*4+4),a=t.subarray(n*4,n*4+4),i=Math.min(r[0],r[2]),o=Math.min(r[1],r[3]),s=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]),u=Math.min(a[0],a[2]),c=Math.min(a[1],a[3]),d=Math.max(a[0],a[2]),p=Math.max(a[1],a[3]),f=(s-i)*(l-o),m=(d-u)*(p-c);if(f<=0||m<=0)return 0;const y=Math.max(i,u),x=Math.max(o,c),b=Math.min(s,d),v=Math.min(l,p),w=Math.max(b-y,0)*Math.max(v-x,0);return w/(f+m-w)}function cde(t,e,n){const r=Math.exp(e*n*n);return n<=t?r:0}function _D(t,e){return t.score-e.score||t.score===e.score&&e.boxIndex-t.boxIndex}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/async function dde(t,e,n,r=.5,a=Number.NEGATIVE_INFINITY){const i=B(t,"boxes","nonMaxSuppressionAsync"),o=B(e,"scores","nonMaxSuppressionAsync"),s=lp(i,o,n,r,a);n=s.maxOutputSize,r=s.iouThreshold,a=s.scoreThreshold;const l=await Promise.all([i.data(),o.data()]),u=l[0],c=l[1],{selectedIndices:d}=Ux(u,c,n,r,a);return i!==t&&i.dispose(),o!==e&&o.dispose(),$i(d,"int32")}const pde=dde;/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function hde(t,e,n,r=.5,a=Number.NEGATIVE_INFINITY,i=0){const o=B(t,"boxes","nonMaxSuppression"),s=B(e,"scores","nonMaxSuppression"),l=lp(o,s,n,r,a,i);n=l.maxOutputSize,r=l.iouThreshold,a=l.scoreThreshold,i=l.softNmsSigma;const u={boxes:o,scores:s},c={maxOutputSize:n,iouThreshold:r,scoreThreshold:a,softNmsSigma:i},d=te.runKernel(Ov,u,c);return{selectedIndices:d[0],selectedScores:d[1]}}const fde=ee({nonMaxSuppressionWithScore_:hde});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/async function gde(t,e,n,r=.5,a=Number.NEGATIVE_INFINITY,i=0){const o=B(t,"boxes","nonMaxSuppressionAsync"),s=B(e,"scores","nonMaxSuppressionAsync"),l=lp(o,s,n,r,a,i);n=l.maxOutputSize,r=l.iouThreshold,a=l.scoreThreshold,i=l.softNmsSigma;const u=await Promise.all([o.data(),s.data()]),c=u[0],d=u[1],{selectedIndices:p,selectedScores:f}=Hx(c,d,n,r,a,i);return o!==t&&o.dispose(),s!==e&&s.dispose(),{selectedIndices:$i(p,"int32"),selectedScores:$i(f)}}const mde=gde;/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function yde(t,e,n,r=.5,a=Number.NEGATIVE_INFINITY,i=!1){const o=B(t,"boxes","nonMaxSuppression"),s=B(e,"scores","nonMaxSuppression"),l=lp(o,s,n,r,a,null),u=l.maxOutputSize,c=l.iouThreshold,d=l.scoreThreshold,p={boxes:o,scores:s},f={maxOutputSize:u,iouThreshold:c,scoreThreshold:d,padToMaxOutputSize:i},m=te.runKernel(_v,p,f);return{selectedIndices:m[0],validOutputs:m[1]}}const bde=ee({nonMaxSuppressionPadded_:yde});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/async function vde(t,e,n,r=.5,a=Number.NEGATIVE_INFINITY,i=!1){const o=B(t,"boxes","nonMaxSuppressionAsync"),s=B(e,"scores","nonMaxSuppressionAsync"),l=lp(o,s,n,r,a,null),u=l.maxOutputSize,c=l.iouThreshold,d=l.scoreThreshold,[p,f]=await Promise.all([o.data(),s.data()]),{selectedIndices:m,validOutputs:y}=Gx(p,f,u,c,d,i);return o!==t&&o.dispose(),s!==e&&s.dispose(),{selectedIndices:$i(m,"int32"),validOutputs:St(y,"int32")}}const xde=vde;/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function wde(t,e,n=!1,r=!1){const a=B(t,"images","resizeBilinear");j(a.rank===3||a.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${a.rank}.`),j(e.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${e}.`),j(r===!1||n===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let i=a,o=!1;a.rank===3&&(o=!0,i=xe(a,[1,a.shape[0],a.shape[1],a.shape[2]]));const s={images:i},l={alignCorners:n,halfPixelCenters:r,size:e},u=te.runKernel(Wv,s,l);return o?xe(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const kde=ee({resizeBilinear_:wde});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Sde(t,e,n=!1,r=!1){const a=B(t,"images","resizeNearestNeighbor");j(a.rank===3||a.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${a.rank}.`),j(e.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${e}.`),j(a.dtype==="float32"||a.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),j(r===!1||n===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let i=a,o=!1;a.rank===3&&(o=!0,i=xe(a,[1,a.shape[0],a.shape[1],a.shape[2]]));const s={images:i},l={alignCorners:n,halfPixelCenters:r,size:e},u=te.runKernel(Vv,s,l);return o?xe(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const Cde=ee({resizeNearestNeighbor_:Sde});/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* https://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Nde(t,e="binary",n=!1,r=.5){const a=B(t,"image","threshold"),i=.2989,o=.587,s=.114,l=a.shape[0]*a.shape[1];let u=$e($i([r]),255),c,d,p,f;if(j(a.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${a.rank}.`),j(a.shape[2]===3||a.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${a.shape[2]}.`),j(a.dtype==="int32"||a.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${a.dtype}.`),j(e==="otsu"||e==="binary",()=>`Method must be binary or otsu, but was ${e}`),a.shape[2]===3){[c,d,p]=op(a,[1,1,1],-1);const y=$e(c,i),x=$e(d,o),b=$e(p,s);f=ot(ot(y,x),b)}else f=t;if(e==="otsu"){const y=tI(wn($I(f),"int32"),uo([]),256);u=Tde(y,l)}const m=n?$x(f,u):Wg(f,u);return wn($e(m,255),"int32")}function Tde(t,e){let n=$i([-1]),r=$i([0]),a=$i([0]),i,o,s,l,u,c;for(let d=0;d<t.size-1;d++){i=nn(t,0,d+1),o=nn(t,d+1),u=un(cn(i),e),c=un(cn(o),e);const p=cn($e(i,ip(0,i.size)));s=un(p,cn(i));const f=ep(o.shape,i.size),m=ot(ip(0,o.size),f),y=$e(o,m);l=un(cn(y),cn(o));const x=xt(s,l),b=xt(s,l),v=$e(u,c);a=$e($e(v,x),b);const w=Wg(a,r);r=oc(w,a,r),n=oc(w,$i([d]),n)}return n}const Ide=ee({threshold_:Nde});/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Ede(t,e,n="nearest",r="constant",a=0,i){const o=B(t,"image","transform","float32"),s=B(e,"transforms","transform","float32");j(o.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${o.rank}.`),j(s.rank===2&&(s.shape[0]===o.shape[0]||s.shape[0]===1)&&s.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),j(i==null||i.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${i}.`);const l={image:o,transforms:s},u={interpolation:n,fillMode:r,fillValue:a,outputShape:i};return te.runKernel(ux,l,u)}const _de=ee({transform_:Ede});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Ode(t,e,n){j(e%1===0,()=>`bandPart(): numLower must be an integer, got ${e}.`),j(n%1===0,()=>`bandPart(): numUpper must be an integer, got ${n}.`);const r=B(t,"a","bandPart");j(r.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${r.rank}.`);const a=r.shape,[i,o]=r.shape.slice(-2);if(!(e<=i))throw new Error(`bandPart(): numLower (${e}) must not be greater than the number of rows (${i}).`);if(!(n<=o))throw new Error(`bandPart(): numUpper (${n}) must not be greater than the number of columns (${o}).`);e<0&&(e=i),n<0&&(n=o);const s=xe(ip(0,i,1,"int32"),[-1,1]),l=ip(0,o,1,"int32"),u=xt(s,l),c=Ug($x(u,St(+e,"int32")),lI(u,St(-n,"int32"))),d=Fl([i,o],r.dtype);return xe(Fo(jl(xe(r,[-1,i,o])).map(p=>oc(c,p,d))),a)}const $de=ee({bandPart_:Ode});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Rde(t){let e;if(Array.isArray(t)){e=!1,j(t!=null&&t.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const a=t[0].shape[0];for(let i=1;i<t.length;++i)j(t[i].shape[0]===a,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${t[i].shape[0]} vs. ${a})`)}else e=!0,t=op(t,t.shape[0],0).map(a=>Kg(a,[0]));j(t.length<=t[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${t.length}) exceeds number of dimensions (${t[0].shape[0]}).`);const n=[],r=t;for(let a=0;a<t.length;++a)n.push(te.tidy(()=>{let i=r[a];if(a>0)for(let o=0;o<a;++o){const s=$e(cn($e(n[o],i)),n[o]);i=xt(i,s)}return un(i,Vg(i,"euclidean"))}));return e?Fo(n,0):n}const Mde=ee({gramSchmidt_:Rde});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Ade(t,e=!1){if(j(t.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${t.rank}`),t.rank===2)return OD(t,e);{const n=t.shape.slice(0,t.shape.length-2).reduce((l,u)=>l*u),r=jl(xe(t,[n,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),a=[],i=[];r.forEach(l=>{const[u,c]=OD(l,e);a.push(u),i.push(c)});const o=xe(Fo(a,0),t.shape),s=xe(Fo(i,0),t.shape);return[o,s]}}function OD(t,e=!1){return te.tidy(()=>{j(t.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${t.shape.length}D Tensor.`);const n=t.shape[0],r=t.shape[1];let a=iI(n),i=Is(t);const o=sp([[1]],[1,1]);let s=Is(o);const l=n>=r?r:n;for(let u=0;u<l;++u){const c=i,d=s,p=a;[s,i,a]=te.tidy(()=>{const f=nn(i,[u,u],[n-u,1]),m=Vg(f),y=nn(i,[u,u],[1,1]),x=oc(Wg(y,0),sp([[-1]]),sp([[1]])),b=xt(y,$e(x,m)),v=un(f,b);v.shape[0]===1?s=Is(o):s=Ur([o,nn(v,[1,0],[v.shape[0]-1,v.shape[1]])],0);const w=Po(un(Gt(x,b),m)),S=nn(i,[u,0],[n-u,r]),C=$e(w,s),I=Lg(s);if(u===0)i=xt(S,Gt(C,Gt(I,S)));else{const P=xt(S,Gt(C,Gt(I,S)));i=Ur([nn(i,[0,0],[u,r]),P],0)}const _=Lg(C),E=nn(a,[0,u],[n,a.shape[1]-u]);if(u===0)a=xt(E,Gt(Gt(E,s),_));else{const P=xt(E,Gt(Gt(E,s),_));a=Ur([nn(a,[0,0],[n,u]),P],1)}return[s,i,a]}),Vr([c,d,p])}return!e&&n>r&&(a=nn(a,[0,0],[n,r]),i=nn(i,[0,0],[r,r])),[a,i]})}const Pde=ee({qr_:Ade});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/var sa;(function(t){t[t.NONE=0]="NONE",t[t.MEAN=1]="MEAN",t[t.SUM=2]="SUM",t[t.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(sa||(sa={}));function Lde(t,e,n=sa.SUM_BY_NONZERO_WEIGHTS){const r=B(t,"losses","computeWeightedLoss");let a=null;e!=null&&(a=B(e,"weights","computeWeightedLoss"));const i=a==null?r:$e(r,a);if(n===sa.NONE)return i;if(n===sa.SUM)return cn(i);if(n===sa.MEAN){if(a==null)return Gg(i);{const o=r.size/a.size,s=un(cn(i),cn(a));return o>1?un(s,St(o)):s}}if(n===sa.SUM_BY_NONZERO_WEIGHTS){if(a==null)return un(cn(i),St(r.size));{const o=$e(a,Bl(r.shape)),s=wn(cn(bI(o,St(0))),"float32");return un(cn(i),s)}}throw Error(`Unknown reduction: ${n}`)}const Rs=ee({computeWeightedLoss_:Lde});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Dde(t,e,n,r=sa.SUM_BY_NONZERO_WEIGHTS){const a=B(t,"labels","absoluteDifference"),i=B(e,"predictions","absoluteDifference");let o=null;n!=null&&(o=B(n,"weights","absoluteDifference")),Cr(a.shape,i.shape,"Error in absoluteDifference: ");const s=ja(xt(a,i));return Rs(s,o,r)}const Fde=ee({absoluteDifference_:Dde});function Bde(t,e,n,r,a=sa.SUM_BY_NONZERO_WEIGHTS){const i=B(t,"labels","cosineDistance"),o=B(e,"predictions","cosineDistance");let s=null;r!=null&&(s=B(r,"weights","cosineDistance")),Cr(i.shape,o.shape,"Error in cosineDistance: ");const l=St(1),u=xt(l,cn($e(i,o),n,!0));return Rs(u,s,a)}const zde=ee({cosineDistance_:Bde});function jde(t,e,n,r=sa.SUM_BY_NONZERO_WEIGHTS){let a=B(t,"labels","hingeLoss");const i=B(e,"predictions","hingeLoss");let o=null;n!=null&&(o=B(n,"weights","hingeLoss")),Cr(a.shape,i.shape,"Error in hingeLoss: ");const s=St(1);a=xt($e(St(2),a),s);const l=Hg(xt(s,$e(a,i)));return Rs(l,o,r)}const Vde=ee({hingeLoss_:jde});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Wde(t,e,n,r=1,a=sa.SUM_BY_NONZERO_WEIGHTS){const i=B(t,"labels","huberLoss"),o=B(e,"predictions","huberLoss");let s=null;n!=null&&(s=B(n,"weights","huberLoss")),Cr(i.shape,o.shape,"Error in huberLoss: ");const l=St(r),u=ja(xt(o,i)),c=yI(u,l),d=xt(u,c),p=ot($e(St(.5),Oi(c)),$e(l,d));return Rs(p,s,a)}const Ude=ee({huberLoss_:Wde});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Gde(t,e,n,r=1e-7,a=sa.SUM_BY_NONZERO_WEIGHTS){const i=B(t,"labels","logLoss"),o=B(e,"predictions","logLoss");let s=null;n!=null&&(s=B(n,"weights","logLoss")),Cr(i.shape,o.shape,"Error in logLoss: ");const l=St(1),u=St(r),c=Po($e(i,rp(ot(o,u)))),d=$e(xt(l,i),rp(ot(xt(l,o),u))),p=xt(c,d);return Rs(p,s,a)}const Hde=ee({logLoss_:Gde});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function qde(t,e,n,r=sa.SUM_BY_NONZERO_WEIGHTS){const a=B(t,"labels","meanSquaredError"),i=B(e,"predictions","meanSquaredError");let o=null;n!=null&&(o=B(n,"weights","meanSquaredError")),Cr(a.shape,i.shape,"Error in meanSquaredError: ");const s=MI(a,i);return Rs(s,o,r)}const Kde=ee({meanSquaredError_:qde});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Xde(t,e){const n=B(t,"labels","sigmoidCrossEntropyWithLogits"),r=B(e,"logits","sigmoidCrossEntropyWithLogits");Cr(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");const a=Hg(r),i=$e(r,n),o=cI(Dl(Po(ja(r))));return ot(xt(a,i),o)}function Yde(t,e,n,r=0,a=sa.SUM_BY_NONZERO_WEIGHTS){let i=B(t,"multiClassLabels","sigmoidCrossEntropy");const o=B(e,"logits","sigmoidCrossEntropy");let s=null;if(n!=null&&(s=B(n,"weights","sigmoidCrossEntropy")),Cr(i.shape,o.shape,"Error in sigmoidCrossEntropy: "),r>0){const u=St(r),c=St(1),d=St(.5);i=ot($e(i,xt(c,u)),$e(d,u))}const l=Xde(i,o);return Rs(l,s,a)}const Qde=ee({sigmoidCrossEntropy_:Yde});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Zde(t,e,n=-1){if(n===-1&&(n=e.rank-1),n!==e.rank-1)throw Error(`Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ${e.rank} and dim was ${n}`);return Do((r,a,i)=>{const o=pI(a,[n],!0),s=xt(wn(a,"float32"),o);i([r,s]);const l=Po($e(s,r));return{value:cn(l,[n]),gradFunc:(u,c)=>{const[d,p]=c,f=ir(u.shape,[n]);return[$e(xe(u,f),xt(wn(d,"float32"),Dl(p))),$e(xe(u,f),xt(Dl(p),wn(d,"float32")))]}}})(t,e)}function Jde(t,e,n,r=0,a=sa.SUM_BY_NONZERO_WEIGHTS){let i=B(t,"onehotLabels","softmaxCrossEntropy");const o=B(e,"logits","softmaxCrossEntropy");let s=null;if(n!=null&&(s=B(n,"weights","softmaxCrossEntropy")),Cr(i.shape,o.shape,"Error in softmaxCrossEntropy: "),r>0){const u=St(r),c=St(1),d=St(i.shape[1]);i=ot($e(i,xt(c,u)),un(u,d))}const l=Zde(i,o);return Rs(l,s,a)}const epe=ee({softmaxCrossEntropy_:Jde});/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function tpe(t,e,n,r){const a=B(t,"indices","sparseFillEmptyRows","int32"),i=B(e,"values","sparseFillEmptyRows"),o=B(n,"denseShape","sparseFillEmptyRows","int32"),s=B(r,"defaultValue","sparseFillEmptyRows",i.dtype);if(a.rank!==2)throw new Error(`Indices should be Tensor2D but received shape
        ${a.shape}`);if(i.rank!==1)throw new Error(`Values should be Tensor1D but received shape ${i.shape}`);if(o.rank!==1)throw new Error(`Dense shape should be Tensor1D but received shape ${o.shape}`);if(s.rank!==0)throw new Error(`Default value should be a scalar but received shape ${s.shape}`);const l={indices:a,values:i,denseShape:o,defaultValue:s},u=te.runKernel(Jv,l);return{outputIndices:u[0],outputValues:u[1],emptyRowIndicator:u[2],reverseIndexMap:u[3]}}const npe=ee({sparseFillEmptyRows_:tpe});/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function rpe(t,e,n){const r=B(t,"inputIndices","sparseReshape","int32"),a=B(e,"inputShape","sparseReshape","int32"),i=B(n,"newShape","sparseReshape","int32");if(r.rank!==2)throw new Error(`Input indices should be Tensor2D but received shape
        ${r.shape}`);if(a.rank!==1)throw new Error(`Input shape should be Tensor1D but received shape ${a.shape}`);if(i.rank!==1)throw new Error(`New shape should be Tensor1D but received shape ${i.shape}`);const o={inputIndices:r,inputShape:a,newShape:i},s=te.runKernel(ex,o);return{outputIndices:s[0],outputShape:s[1]}}const ape=ee({sparseReshape_:rpe});/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function ipe(t,e,n){const r=B(t,"data","sparseSegmentMean"),a=B(e,"indices","sparseSegmentMean","int32"),i=B(n,"segmentIds","sparseSegmentMean","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(a.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
          ${a.shape}`);if(i.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
          ${i.shape}`);const o={data:r,indices:a,segmentIds:i};return te.runKernel(tx,o)}const ope=ee({sparseSegmentMean_:ipe});/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function spe(t,e,n){const r=B(t,"data","sparseSegmentSum"),a=B(e,"indices","sparseSegmentSum","int32"),i=B(n,"segmentIds","sparseSegmentSum","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(a.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
         ${a.shape}`);if(i.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
         ${i.shape}`);const o={data:r,indices:a,segmentIds:i};return te.runKernel(nx,o)}const lpe=ee({sparseSegmentSum_:spe});/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function upe(t,e,n,r,a,i,o,s){const l=B(t,"data","stringNGrams","string");if(l.dtype!=="string")throw new Error("Data must be of datatype string");if(l.shape.length!==1)throw new Error(`Data must be a vector, saw: ${l.shape}`);const u=B(e,"dataSplits","stringNGrams");if(u.dtype!=="int32")throw new Error("Data splits must be of datatype int32");const c={separator:n,nGramWidths:r,leftPad:a,rightPad:i,padWidth:o,preserveShortSequences:s},d={data:l,dataSplits:u},p=te.runKernel(ix,d,c);return{nGrams:p[0],nGramsSplits:p[1]}}const cpe=ee({stringNGrams_:upe});/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function dpe(t,e,n=!0){const r=B(t,"input","stringSplit","string"),a=B(e,"delimiter","stringSplit","string");if(r.rank!==1)throw new Error(`Input should be Tensor1D but received shape ${r.shape}`);if(a.rank!==0)throw new Error(`Delimiter should be a scalar but received shape ${a.shape}`);const i={skipEmpty:n},o={input:r,delimiter:a},s=te.runKernel(ox,o,i);return{indices:s[0],values:s[1],shape:s[2]}}const ppe=ee({stringSplit_:dpe});/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function hpe(t,e){const n=B(t,"input","stringToHashBucketFast","string"),r={numBuckets:e};if(e<=0)throw new Error("Number of buckets must be at least 1");const a={input:n};return te.runKernel(sx,a,r)}const fpe=ee({stringToHashBucketFast_:hpe});/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const $D={fft:Lx,ifft:qg,rfft:Dx,irfft:RI},RD={hammingWindow:Uce,hannWindow:ID,frame:ED,stft:Kce},FI={flipLeftRight:Zce,grayscaleToRGB:ede,resizeNearestNeighbor:Cde,resizeBilinear:kde,rotateWithOffset:nde,cropAndResize:Yce,nonMaxSuppression:ade,nonMaxSuppressionAsync:pde,nonMaxSuppressionWithScore:fde,nonMaxSuppressionWithScoreAsync:mde,nonMaxSuppressionPadded:bde,nonMaxSuppressionPaddedAsync:xde,threshold:Ide,transform:_de},MD={bandPart:$de,gramSchmidt:Mde,qr:Pde},AD={absoluteDifference:Fde,computeWeightedLoss:Rs,cosineDistance:zde,hingeLoss:Vde,huberLoss:Ude,logLoss:Hde,meanSquaredError:Kde,sigmoidCrossEntropy:Qde,softmaxCrossEntropy:epe},PD={sparseFillEmptyRows:npe,sparseReshape:ape,sparseSegmentMean:ope,sparseSegmentSum:lpe},LD={stringNGrams:cpe,stringSplit:ppe,stringToHashBucketFast:fpe};/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class Vl extends y8{minimize(e,n=!1,r){const{value:a,grads:i}=this.computeGradients(e,r);if(r!=null){const o=r.map(s=>({name:s.name,tensor:i[s.name]}));this.applyGradients(o)}else this.applyGradients(i);return Vr(i),n?a:(a.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,n){return yL(e,n)}dispose(){this.iterations_!=null&&Vr(this.iterations_)}async saveIterations(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:St(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(e){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}}Object.defineProperty(Vl,Symbol.hasInstance,{value:t=>t.minimize!=null&&t.computeGradients!=null&&t.applyGradients!=null});/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class qx extends Vl{constructor(e,n,r=null){super(),this.learningRate=e,this.rho=n,this.epsilon=r,this.accumulatedGrads=[],this.accumulatedUpdates=[],r==null&&(this.epsilon=te.backend.epsilon())}applyGradients(e){(Array.isArray(e)?e.map(n=>n.name):Object.keys(e)).forEach((n,r)=>{const a=te.registeredVariables[n],i=!1;this.accumulatedGrads[r]==null&&(this.accumulatedGrads[r]={originalName:`${n}/accum_grad`,variable:Ot(()=>Va(a).variable(i))}),this.accumulatedUpdates[r]==null&&(this.accumulatedUpdates[r]={originalName:`${n}/accum_var`,variable:Ot(()=>Va(a).variable(i))});const o=Array.isArray(e)?e[r].tensor:e[n];if(o==null)return;const s=this.accumulatedGrads[r].variable,l=this.accumulatedUpdates[r].variable;Ot(()=>{const u=ot($e(s,this.rho),$e(Oi(o),1-this.rho)),c=$e(un(Lo(ot(l,this.epsilon)),Lo(ot(s,this.epsilon))),o),d=ot($e(l,this.rho),$e(Oi(c),1-this.rho));s.assign(u),l.assign(d);const p=ot($e(c,-this.learningRate),a);a.assign(p)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(Vr(this.accumulatedGrads.map(e=>e.variable)),Vr(this.accumulatedUpdates.map(e=>e.variable)))}async getWeights(){const e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=e.length/2,r=!1;this.accumulatedGrads=e.slice(0,n).map(a=>({originalName:a.name,variable:a.tensor.variable(r)})),this.accumulatedUpdates=e.slice(n,n*2).map(a=>({originalName:a.name,variable:a.tensor.variable(r)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,n){return new e(n.learningRate,n.rho,n.epsilon)}}qx.className="Adadelta",Pl(qx);/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class Kx extends Vl{constructor(e,n=.1){super(),this.learningRate=e,this.initialAccumulatorValue=n,this.accumulatedGrads=[]}applyGradients(e){(Array.isArray(e)?e.map(n=>n.name):Object.keys(e)).forEach((n,r)=>{const a=te.registeredVariables[n];this.accumulatedGrads[r]==null&&(this.accumulatedGrads[r]={originalName:`${n}/accumulator`,variable:Ot(()=>ep(a.shape,this.initialAccumulatorValue).variable(!1))});const i=Array.isArray(e)?e[r].tensor:e[n];if(i==null)return;const o=this.accumulatedGrads[r].variable;Ot(()=>{const s=ot(o,Oi(i));o.assign(s);const l=ot($e(un(i,Lo(ot(s,te.backend.epsilon()))),-this.learningRate),a);a.assign(l)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&Vr(this.accumulatedGrads.map(e=>e.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=!1;this.accumulatedGrads=e.map(r=>({originalName:r.name,variable:r.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,n){return new e(n.learningRate,n.initialAccumulatorValue)}}Kx.className="Adagrad",Pl(Kx);/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class Xx extends Vl{constructor(e,n,r,a=null){super(),this.learningRate=e,this.beta1=n,this.beta2=r,this.epsilon=a,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],Ot(()=>{this.accBeta1=St(n).variable(),this.accBeta2=St(r).variable()}),a==null&&(this.epsilon=te.backend.epsilon())}applyGradients(e){const n=Array.isArray(e)?e.map(r=>r.name):Object.keys(e);Ot(()=>{const r=xt(1,this.accBeta1),a=xt(1,this.accBeta2);n.forEach((i,o)=>{const s=te.registeredVariables[i],l=!1;this.accumulatedFirstMoment[o]==null&&(this.accumulatedFirstMoment[o]={originalName:`${i}/m`,variable:Ot(()=>Va(s).variable(l))}),this.accumulatedSecondMoment[o]==null&&(this.accumulatedSecondMoment[o]={originalName:`${i}/v`,variable:Ot(()=>Va(s).variable(l))});const u=Array.isArray(e)?e[o].tensor:e[i];if(u==null)return;const c=this.accumulatedFirstMoment[o].variable,d=this.accumulatedSecondMoment[o].variable,p=ot($e(c,this.beta1),$e(u,1-this.beta1)),f=ot($e(d,this.beta2),$e(Oi(u),1-this.beta2)),m=un(p,r),y=un(f,a);c.assign(p),d.assign(f);const x=ot($e(un(m,ot(Lo(y),this.epsilon)),-this.learningRate),s);s.assign(x)}),this.accBeta1.assign($e(this.accBeta1,this.beta1)),this.accBeta2.assign($e(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&Vr(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedSecondMoment!=null&&Vr(this.accumulatedSecondMoment.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e),Ot(()=>{this.accBeta1.assign(tp(this.beta1,this.iterations_+1)),this.accBeta2.assign(tp(this.beta2,this.iterations_+1))});const n=e.length/2,r=!1;this.accumulatedFirstMoment=e.slice(0,n).map(a=>({originalName:a.name,variable:a.tensor.variable(r)})),this.accumulatedSecondMoment=e.slice(n,n*2).map(a=>({originalName:a.name,variable:a.tensor.variable(r)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon)}}Xx.className="Adam",Pl(Xx);/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class Yx extends Vl{constructor(e,n,r,a=null,i=0){super(),this.learningRate=e,this.beta1=n,this.beta2=r,this.epsilon=a,this.decay=i,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],Ot(()=>{this.iteration=St(0).variable(),this.accBeta1=St(n).variable()}),a==null&&(this.epsilon=te.backend.epsilon())}applyGradients(e){const n=Array.isArray(e)?e.map(r=>r.name):Object.keys(e);Ot(()=>{const r=xt(1,this.accBeta1),a=un(-this.learningRate,ot($e(this.iteration,this.decay),1));n.forEach((i,o)=>{const s=te.registeredVariables[i],l=!1;this.accumulatedFirstMoment[o]==null&&(this.accumulatedFirstMoment[o]={originalName:`${i}/m`,variable:Va(s).variable(l)}),this.accumulatedWeightedInfNorm[o]==null&&(this.accumulatedWeightedInfNorm[o]={originalName:`${i}/v`,variable:Va(s).variable(l)});const u=Array.isArray(e)?e[o].tensor:e[i];if(u==null)return;const c=this.accumulatedFirstMoment[o].variable,d=this.accumulatedWeightedInfNorm[o].variable,p=ot($e(c,this.beta1),$e(u,1-this.beta1)),f=$e(d,this.beta2),m=ja(u),y=mI(f,m);c.assign(p),d.assign(y);const x=ot($e(un(a,r),un(p,ot(y,this.epsilon))),s);s.assign(x)}),this.iteration.assign(ot(this.iteration,1)),this.accBeta1.assign($e(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&Vr(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedWeightedInfNorm!=null&&Vr(this.accumulatedWeightedInfNorm.map(e=>e.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon,n.decay)}}Yx.className="Adamax",Pl(Yx);/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class Xg extends Vl{constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){(Array.isArray(e)?e.map(n=>n.name):Object.keys(e)).forEach((n,r)=>{const a=Array.isArray(e)?e[r].tensor:e[n];if(a==null)return;const i=te.registeredVariables[n];Ot(()=>{const o=ot($e(this.c,a),i);i.assign(o)})}),this.incrementIterations()}setLearningRate(e){this.learningRate=e,this.c!=null&&this.c.dispose(),this.c=Ao(St(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(e=await this.extractIterations(e),e.length!==0)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,n){return new e(n.learningRate)}}Xg.className="SGD",Pl(Xg);/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class Qx extends Xg{constructor(e,n,r=!1){super(e),this.learningRate=e,this.momentum=n,this.useNesterov=r,this.accumulations=[],this.m=St(this.momentum)}applyGradients(e){(Array.isArray(e)?e.map(n=>n.name):Object.keys(e)).forEach((n,r)=>{const a=te.registeredVariables[n];this.accumulations[r]==null&&(this.accumulations[r]={originalName:`${n}/momentum`,variable:Ot(()=>Va(a).variable(!1))});const i=this.accumulations[r].variable,o=Array.isArray(e)?e[r].tensor:e[n];o!=null&&Ot(()=>{let s;const l=ot($e(this.m,i),o);this.useNesterov?s=ot($e(this.c,ot(o,$e(l,this.m))),a):s=ot($e(this.c,l),a),i.assign(l),a.assign(s)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&Vr(this.accumulations.map(e=>e.variable))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=!1;this.accumulations=e.map(r=>({originalName:r.name,variable:r.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,n){return new e(n.learningRate,n.momentum,n.useNesterov)}}Qx.className="Momentum",Pl(Qx);/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class Zx extends Vl{constructor(e,n=.9,r=0,a=null,i=!1){if(super(),this.learningRate=e,this.decay=n,this.momentum=r,this.epsilon=a,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=i,a==null&&(this.epsilon=te.backend.epsilon()),e==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(e){(Array.isArray(e)?e.map(n=>n.name):Object.keys(e)).forEach((n,r)=>{const a=te.registeredVariables[n],i=!1;this.accumulatedMeanSquares[r]==null&&(this.accumulatedMeanSquares[r]={originalName:`${n}/rms`,variable:Ot(()=>Va(a).variable(i))}),this.accumulatedMoments[r]==null&&(this.accumulatedMoments[r]={originalName:`${n}/momentum`,variable:Ot(()=>Va(a).variable(i))}),this.accumulatedMeanGrads[r]==null&&this.centered&&(this.accumulatedMeanGrads[r]={originalName:`${n}/mg`,variable:Ot(()=>Va(a).variable(i))});const o=Array.isArray(e)?e[r].tensor:e[n];if(o==null)return;const s=this.accumulatedMeanSquares[r].variable,l=this.accumulatedMoments[r].variable;Ot(()=>{const u=ot($e(s,this.decay),$e(Oi(o),1-this.decay));if(this.centered){const c=this.accumulatedMeanGrads[r].variable,d=ot($e(c,this.decay),$e(o,1-this.decay)),p=un($e(o,this.learningRate),Lo(xt(u,ot(Oi(d),this.epsilon)))),f=ot($e(l,this.momentum),p);s.assign(u),c.assign(d),l.assign(f);const m=xt(a,f);a.assign(m)}else{const c=ot($e(s,this.decay),$e(Oi(o),1-this.decay)),d=ot($e(l,this.momentum),un($e(o,this.learningRate),Lo(ot(c,this.epsilon))));s.assign(c),l.assign(d);const p=xt(a,d);a.assign(p)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&Vr(this.accumulatedMeanSquares.map(e=>e.variable)),this.accumulatedMeanGrads!=null&&this.centered&&Vr(this.accumulatedMeanGrads.map(e=>e.variable)),this.accumulatedMoments!=null&&Vr(this.accumulatedMoments.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=this.centered?e.length/3:e.length/2,r=!1;this.accumulatedMeanSquares=e.slice(0,n).map(a=>({originalName:a.name,variable:a.tensor.variable(r)})),this.accumulatedMoments=e.slice(n,n*2).map(a=>({originalName:a.name,variable:a.tensor.variable(r)})),this.centered&&(this.accumulatedMeanGrads=e.slice(n*2,n*3).map(a=>({originalName:a.name,variable:a.tensor.variable(r)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,n){return new e(n.learningRate,n.decay,n.momentum,n.epsilon,n.centered)}}Zx.className="RMSProp",Pl(Zx);/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class Wl{static sgd(e){return new Xg(e)}static momentum(e,n,r=!1){return new Qx(e,n,r)}static rmsprop(e,n=.9,r=0,a=null,i=!1){return new Zx(e,n,r,a,i)}static adam(e=.001,n=.9,r=.999,a=null){return new Xx(e,n,r,a)}static adadelta(e=.001,n=.95,r=null){return new qx(e,n,r)}static adamax(e=.002,n=.9,r=.999,a=null,i=0){return new Yx(e,n,r,a,i)}static adagrad(e,n=.1){return new Kx(e,n)}}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const gpe={sgd:Wl.sgd,momentum:Wl.momentum,adadelta:Wl.adadelta,adagrad:Wl.adagrad,rmsprop:Wl.rmsprop,adamax:Wl.adamax,adam:Wl.adam};/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const mpe=typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:t=>t();function DD(){return new Promise(t=>mpe(()=>t()))}/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function BI(t,e){const n=t[0].length;t.forEach((a,i)=>{j(a.length===n,()=>`Error in concat${n}D: rank of tensors[${i}] must be the same as the rank of the rest (${n})`)}),j(e>=0&&e<n,()=>`Error in concat${n}D: axis must be between 0 and ${n-1}.`);const r=t[0];t.forEach((a,i)=>{for(let o=0;o<n;o++)j(o===e||a[o]===r[o],()=>`Error in concat${n}D: Shape of tensors[${i}] (${a}) does not match the shape of the rest (${r}) along the non-concatenated axis ${i}.`)})}function Bo(t,e){const n=t[0].slice();for(let r=1;r<t.length;r++)n[e]+=t[r][e];return n}/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/var co;(function(t){t[t.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",t[t.VALUE_ROWIDS=1]="VALUE_ROWIDS",t[t.ROW_LENGTHS=2]="ROW_LENGTHS",t[t.ROW_SPLITS=3]="ROW_SPLITS",t[t.ROW_LIMITS=4]="ROW_LIMITS",t[t.ROW_STARTS=5]="ROW_STARTS"})(co||(co={}));function FD(t,e,n){let r=new Array;if(n==null&&e==null)return r;if(e==null)for(;r.length<t+n.length;)r.push(-1);else r=e.slice();if(n==null)return r;if(t+n.length!==r.length)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.rank = ${t+n.length}, but shape.rank = ${r.length}`);for(let a=1;a<n.length;++a){const i=n[a],o=r[r.length-n.length+a],s=r[o];if(i>=0)if(s>=0){if(s!==i)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.shape[${a+t}] = ${i} but shape[${a+t}] = ${s}`)}else r[o]=i}return r}function BD(t){const e={FIRST_DIM_SIZE:co.FIRST_DIM_SIZE,VALUE_ROWIDS:co.VALUE_ROWIDS,ROW_LENGTHS:co.ROW_LENGTHS,ROW_SPLITS:co.ROW_SPLITS,ROW_LIMITS:co.ROW_LIMITS,ROW_STARTS:co.ROW_STARTS},n=[];for(const r of t)if(r in e)n.push(e[r]);else break;return n}function zD(t){return t.length===0?0:t[0]===co.FIRST_DIM_SIZE?t.length-1:t.length}function jD(t,e){if(t==null||e==null)return;const n=t.length,r=e.length;if(n>=r)throw new Error(`defaultValue.shape=${t} and ragged tensor flatValues.shape=${e}, are incompatible: defaultValue.rank = ${n} must be less than ragged tensor input flatValues.rank = ${r})`);for(let a=0;a<Math.min(n,r-1);++a){const i=t[a],o=e[a+1];if(i>=0&&o>=0&&i!==1&&i!==o)throw new Error(`defaultValue.shape=${t}, and ragged tensor input flatValues.shape=${e} are incompatible: defaultValue.shape[${a-t.length}] = ${i} but ragged tensor input.flatValues.shape[${a-t.length}] = ${o}`)}}/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const zI=30;function Jx(t){return t<=zI?t:Eb(t,Math.floor(Math.sqrt(t)))}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function jI(t,e,n){const r=n*(typeof t=="number"?t:t[0]),a=e*(typeof t=="number"?t:t[1]);return[r,a]}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Yg(t,e,n,r=!0){let a=[];if(r)a=a.concat(e.slice(0)),a.push(t[0]/n),a=a.concat(t.slice(1));else{a=a.concat(t[0]);const i=e.length;for(let o=0;o<i;++o)a=a.concat([t[o+1]/e[o],e[o]]);a=a.concat(t.slice(i+1))}return a}function Qg(t,e,n=!0){const r=[];if(n){r.push(e);for(let a=e+1;a<t;++a)a<=2*e?(r.push(a),r.push(a-(e+1))):r.push(a)}else{const a=[],i=[];for(let o=1;o<t;++o)o>=e*2+1||o%2===1?i.push(o):a.push(o);r.push(...a),r.push(0),r.push(...i)}return r}function Zg(t,e,n,r=!0){const a=[];r?a.push(t[0]/n):a.push(t[0]*n);for(let i=1;i<t.length;++i)i<=e.length?r?a.push(e[i-1]*t[i]):a.push(t[i]/e[i-1]):a.push(t[i]);return a}function VI(t,e){const n=[0];for(let r=0;r<e;++r)n.push(t[r][0]);return n}function WI(t,e,n){const r=t.slice(0,1);for(let a=0;a<n;++a)r.push(t[a+1]-e[a][0]-e[a][1]);return r}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const UI=1.7580993408473768,GI=1.0507009873554805;/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const HI=.3275911,qI=.254829592,KI=-.284496736,XI=1.421413741,YI=-1.453152027,QI=1.061405429;/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Ms(t,e){if(t.length!==e.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${t.length}, imag: ${e.length}.`);const n=new Float32Array(t.length*2);for(let r=0;r<n.length;r+=2)n[r]=t[r/2],n[r+1]=e[r/2];return n}function VD(t){const e=new Float32Array(t.length/2),n=new Float32Array(t.length/2);for(let r=0;r<t.length;r+=2)e[r/2]=t[r],n[r/2]=t[r+1];return{real:e,imag:n}}function WD(t){const e=Math.ceil(t.length/4),n=new Float32Array(e),r=new Float32Array(e);for(let a=0;a<t.length;a+=4)n[Math.floor(a/4)]=t[a],r[Math.floor(a/4)]=t[a+1];return{real:n,imag:r}}function UD(t){const e=Math.floor(t.length/4),n=new Float32Array(e),r=new Float32Array(e);for(let a=2;a<t.length;a+=4)n[Math.floor(a/4)]=t[a],r[Math.floor(a/4)]=t[a+1];return{real:n,imag:r}}function ZI(t,e){const n=t[e*2],r=t[e*2+1];return{real:n,imag:r}}function GD(t,e,n,r){t[r*2]=e,t[r*2+1]=n}function HD(t,e){const n=new Float32Array(t/2),r=new Float32Array(t/2);for(let a=0;a<Math.ceil(t/2);a++){const i=(e?2:-2)*Math.PI*(a/t);n[a]=Math.cos(i),r[a]=Math.sin(i)}return{real:n,imag:r}}function qD(t,e,n){const r=(n?2:-2)*Math.PI*(t/e),a=Math.cos(r),i=Math.sin(r);return{real:a,imag:i}}/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const JI="->",ype=/->/g,KD=",",XD="...";function e4(t,e){t=t.replace(/\s/g,"");const n=(t.length-t.replace(ype,"").length)/JI.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error(`Equation must contain exactly one arrow ("${JI}").`);const[r,a]=t.split(JI);j(r.indexOf(XD)===-1,()=>`The ellipsis notation ("${XD}") is not supported yet.`);const i=r.split(KD),o=i.length;if(e!==o)throw new Error(`Expected ${o} input tensors, received ${e}`);if(o>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const s=[];for(let p=0;p<a.length;++p){const f=a[p];if(!i.some(m=>m.indexOf(f)!==-1))throw new Error(`Output subscripts contain the label ${f} not present in the input subscripts.`);s.indexOf(f)===-1&&s.push(f)}for(let p=0;p<r.length;++p){const f=r[p];s.indexOf(f)===-1&&f!==KD&&s.push(f)}const l=new Array(i.length);for(let p=0;p<o;++p){if(new Set(i[p].split("")).size!==i[p].length)throw new Error(`Found duplicate axes in input component ${i[p]}. Support for duplicate axes in input is not implemented yet.`);l[p]=[];for(let f=0;f<i[p].length;++f)l[p].push(s.indexOf(i[p][f]))}const u=s.length,c=a.length,d=[];for(let p=c;p<u;++p)d.push(p);return{allDims:s,summedDims:d,idDims:l}}function t4(t,e){let n=new Array(t);n.fill(-1);for(let a=0;a<e.length;++a)n[e[a]]=a;const r=[];for(let a=0;a<t;++a)n[a]===-1&&r.push(a);return n=n.filter(a=>a!==-1),{permutationIndices:n,expandDims:r}}function n4(t,e,n){const r=new Array(t);for(let a=0;a<n.length;++a){const i=n[a].shape;for(let o=0;o<e[a].length;++o)r[e[a][o]]===void 0?r[e[a][o]]=i[o]:j(r[e[a][o]]===i[o],()=>`Expected dimension ${r[e[a][o]]} at axis ${o} of input shaped ${JSON.stringify(i)}, but got dimension ${i[o]}`)}}function r4(t,e){const n=t,r=[];let a=0;t.length===0&&n.push(-1),a=t.length+1;for(let o=0;o<a;++o)r.push([]);const i=[];for(let o=0;o<n.length;++o){const s=n[o],l=bpe(e,s);for(const u of l)i.indexOf(u)===-1&&(r[o].push(u),i.push(u))}return{path:n,steps:r}}function a4(t){return t.every((e,n)=>e===n)}function bpe(t,e){const n=[];for(let r=0;r<t.length;++r)(t[r].length===0||t[r].indexOf(e)!==-1||e===-1)&&n.push(r);return n}function i4(t,e,n=0){let r=[];if(typeof e=="number")j(t.shape[n]%e===0,()=>"Number of splits must evenly divide the axis."),r=new Array(e).fill(t.shape[n]/e);else{const a=e.reduce((o,s)=>(s===-1&&(o+=1),o),0);j(a<=1,()=>"There should be only one negative value in split array.");const i=e.indexOf(-1);if(i!==-1){const o=e.reduce((s,l)=>l>0?s+l:s);e[i]=t.shape[n]-o}j(t.shape[n]===e.reduce((o,s)=>o+s),()=>"The sum of sizes must match the size of the axis dimension."),r=e}return r}/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function YD(t){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${t}`}function QD(t,e){return`indices(${t}, 0) is invalid: ${e} < 0`}function ZD(t,e,n){return`indices(${t}, 0) is invalid: ${e} >= ${n}`}/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function JD(t,e){return`only one output dimension may be -1, not both ${t} and ${e}`}function eF(t,e){return`size ${t} must be non-negative, not ${e}`}function tF(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function nF(t,e){const n=me(t),r=me(e);return`Input to reshape is a SparseTensor with ${n}
  dense values, but the requested shape requires a multiple of ${r}. inputShape=${t} outputShape= ${e}`}function rF(t,e){const n=me(t),r=me(e);return`Input to reshape is a tensor with ${n} dense values, but the requested shape has ${r}. inputShape=${t} outputShape=${e}`}/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function o4(){return"segment ids must be >= 0"}function aF(){return"segment ids are not increasing"}function iF(t,e){return`Segment id ${t} out of range [0, ${e}), possibly because segmentIds input is not sorted.`}function oF(t,e,n){return`Bad: indices[${t}] == ${e} out of range [0, ${n})`}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function sF(t,e){let n=!1,r;for(t<=zI?(r=t,n=!0):r=Eb(t,Math.floor(Math.sqrt(t)));!n;)r>e||r===t?n=!0:r=Eb(t,r+1);return r}function lF(t,e,n){const r=[],a=t.length;for(let i=0;i<a;i++)i!==e?r.push(t[i]):r.push(n);return r}function s4(t,e,n,r){const a=e.shape.length,i=t.shape.length;if(r!==0&&(r<-a||r>a))throw new Error(`Expect batchDims in the range of [-${a}, ${a}], but got ${r}`);if(r<0&&(r+=a),r>i)throw new Error(`batchDims (${r}) must be less than rank(x) (
    ${i}).`);if(n<r)throw new Error(`batchDims (${r}) must be less than or equal to axis (${n}).`);for(let d=0;d<r;++d)if(t.shape[d]!==e.shape[d])throw new Error(`x.shape[${d}]: ${t.shape[d]} should be equal to indices.shape[${d}]: ${e.shape[d]}.`);const o=t.shape[n],s=[];let l=1,u=1,c=1;for(let d=0;d<r;++d)s.push(t.shape[d]),l*=t.shape[d];for(let d=r;d<n;d++)s.push(t.shape[d]),u*=t.shape[d];for(let d=r;d<a;d++)s.push(e.shape[d]);for(let d=n+1;d<i;d++)s.push(t.shape[d]),c*=t.shape[d];return{batchSize:l,sliceSize:c,outerSize:u,dimSize:o,outputShape:s}}const vpe=Object.freeze(Object.defineProperty({__proto__:null,collectGatherOpShapeInfo:s4,computeOutShape:lF,segOpComputeOptimalWindowSize:sF},Symbol.toStringTag,{value:"Module"}));/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function uc(t){try{return t.map(e=>Cs(e))}catch(e){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${e}`)}}function uF(t){return t.map(e=>Ro(e))}const cF=Object.freeze(Object.defineProperty({__proto__:null,ERF_A1:qI,ERF_A2:KI,ERF_A3:XI,ERF_A4:YI,ERF_A5:QI,ERF_P:HI,PARALLELIZE_THRESHOLD:zI,get RowPartitionType(){return co},SELU_SCALE:GI,SELU_SCALEALPHA:UI,applyActivation:Vx,assertAndGetBroadcastShape:Nt,assertAxesAreInnerMostDims:Ir,assertParamsConsistent:BI,assignToTypedArray:GD,axesAreInnerMostDims:aI,calculateShapes:Qd,checkEinsumDimSizes:n4,checkPadOnDimRoundingMode:_i,combineLocations:sL,combineRaggedTensorToTensorShapes:FD,complexWithEvenIndex:WD,complexWithOddIndex:UD,computeConv2DInfo:fr,computeConv3DInfo:Ll,computeDefaultPad:QT,computeDilation2DInfo:Dg,computeOptimalWindowSize:Jx,computeOutAndReduceShapes:Tr,computeOutShape:Bo,computePool2DInfo:Ei,computePool3DInfo:_s,convertConv2DDataFormat:Os,decodeEinsumEquation:e4,eitherStridesOrDilationsAreOne:Wr,expandShapeToKeepDim:ir,exponent:qD,exponents:HD,fromStringArrayToUint8:uF,fromUint8ToStringArray:uc,getAxesPermutation:Un,getBroadcastDims:nc,getComplexWithIndex:ZI,getEinsumComputePath:r4,getEinsumPermutation:t4,getFusedBiasGradient:jx,getFusedDyActivation:zx,getImageCenter:jI,getInnerMostAxes:Gn,getPermuted:Qg,getRaggedRank:zD,getReductionAxes:LT,getReshaped:Yg,getReshapedPermuted:Zg,getRowPartitionTypesHelper:BD,getSliceBeginCoords:VI,getSliceSize:WI,getSparseFillEmptyRowsIndicesDenseShapeMismatch:YD,getSparseFillEmptyRowsNegativeIndexErrorMessage:QD,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:ZD,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:tF,getSparseReshapeInputOutputMismatchErrorMessage:rF,getSparseReshapeInputOutputMultipleErrorMessage:nF,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:JD,getSparseReshapeNegativeOutputDimErrorMessage:eF,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:oF,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:o4,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:aF,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:iF,getUndoAxesPermutation:jg,isIdentityPermutation:a4,log:yae,mergeRealAndImagArrays:Ms,prepareAndValidate:Tx,prepareSplitSize:i4,segment_util:vpe,shouldFuse:Wx,slice_util:m8,splitRealAndImagArrays:VD,tupleValuesAreOne:Fg,upcastType:Sa,validateDefaultValueShape:jD,validateInput:BT,validateUpdateShape:FT,warn:ai},Symbol.toStringTag,{value:"Module"}));/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const xpe=Object.freeze(Object.defineProperty({__proto__:null,nonMaxSuppressionV3Impl:Ux,nonMaxSuppressionV4Impl:Gx,nonMaxSuppressionV5Impl:Hx,whereImpl:Fx},Symbol.toStringTag,{value:"Module"}));/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const wpe=Object.freeze(Object.defineProperty({__proto__:null,Abs:Ob,Acos:wf,Acosh:kf,AdadeltaOptimizer:qx,AdagradOptimizer:Kx,AdamOptimizer:Xx,AdamaxOptimizer:Yx,Add:Vd,AddN:$b,All:Rb,Any:Mb,ArgMax:Ab,ArgMin:Pb,Asin:Sf,Asinh:Cf,Atan:Nf,Atan2:If,Atanh:Tf,AvgPool:Lb,AvgPool3D:Db,AvgPool3DGrad:q3,AvgPoolGrad:H3,BatchMatMul:Fb,BatchToSpaceND:Bb,Bincount:zb,BroadcastArgs:jb,BroadcastTo:dae,Cast:Ef,Ceil:_f,ClipByValue:Of,Complex:Vb,ComplexAbs:Wb,Concat:Ub,Conv2D:Gb,Conv2DBackpropFilter:Hb,Conv2DBackpropInput:qb,Conv3D:Kb,Conv3DBackpropFilterV2:K3,Conv3DBackpropInputV2:Xb,Cos:$f,Cosh:Rf,CropAndResize:Zb,Cumprod:Yb,Cumsum:Qb,DataStorage:D3,DenseBincount:Jb,DepthToSpace:ev,DepthwiseConv2dNative:tv,DepthwiseConv2dNativeBackpropFilter:nv,DepthwiseConv2dNativeBackpropInput:rv,Diag:av,Dilation2D:iv,Dilation2DBackpropFilter:Y3,Dilation2DBackpropInput:X3,get ENV(){return W3},Einsum:ov,Elu:Af,EluGrad:Q3,Environment:hP,Equal:Lf,Erf:Pf,Exp:Df,ExpandDims:sv,Expm1:Ff,FFT:lv,Fill:uv,FlipLeftRight:cv,Floor:Bf,FloorDiv:zf,FromPixels:fx,FusedBatchNorm:dv,FusedConv2D:Ng,FusedDepthwiseConv2D:Tg,GatherNd:hv,GatherV2:pv,Greater:jf,GreaterEqual:Vf,IFFT:fv,Identity:Wf,Imag:gv,IsFinite:Uf,IsInf:Gf,IsNan:Hf,KernelBackend:Cb,LRN:bv,LRNGrad:Z3,LeakyRelu:mv,Less:qf,LessEqual:Kf,LinSpace:yv,Log:Xf,Log1p:Yf,LogSoftmax:hae,LogicalAnd:Qf,LogicalNot:Zf,LogicalOr:Jf,LogicalXor:pae,LowerBound:fae,Max:vv,MaxPool:xv,MaxPool3D:wv,MaxPool3DGrad:eT,MaxPoolGrad:J3,MaxPoolWithArgmax:kv,Maximum:eg,Mean:Sv,Min:Cv,Minimum:tg,MirrorPad:Nv,Mod:ng,MomentumOptimizer:Qx,Multinomial:Tv,Multiply:rg,Neg:Iv,NonMaxSuppressionV3:Ev,NonMaxSuppressionV4:_v,NonMaxSuppressionV5:Ov,NotEqual:ag,OP_SCOPE_SUFFIX:xT,OneHot:Rv,OnesLike:$v,Optimizer:Vl,OptimizerConstructors:Wl,Pack:Mv,PadV2:Av,Pool:gae,Pow:ig,Prelu:Pv,Prod:Lv,RMSPropOptimizer:Zx,RaggedGather:Dv,RaggedTensorToTensor:Fv,Range:Bv,get Rank(){return cT},Real:zv,RealDiv:Mf,Reciprocal:og,get Reduction(){return sa},Relu:sg,Relu6:lg,Reshape:jv,ResizeBilinear:Wv,ResizeBilinearGrad:nT,ResizeNearestNeighbor:Vv,ResizeNearestNeighborGrad:tT,Reverse:Uv,RotateWithOffset:gx,Round:ug,Rsqrt:cg,SGDOptimizer:Xg,ScatterNd:Gv,SearchSorted:Hv,Select:qv,Selu:dg,Sigmoid:gg,Sign:fg,Sin:pg,Sinh:hg,Slice:Kv,Softmax:Zv,Softplus:mg,SpaceToBatchND:Yv,SparseFillEmptyRows:Jv,SparseReshape:ex,SparseSegmentMean:tx,SparseSegmentSum:nx,SparseToDense:rx,SplitV:Qv,Sqrt:yg,Square:rT,SquaredDifference:bg,Step:Sg,StridedSlice:ax,StringNGrams:ix,StringSplit:ox,StringToHashBucketFast:sx,Sub:vg,Sum:Xv,Tan:xg,Tanh:wg,Tensor:In,TensorBuffer:ar,Tile:kg,TopK:lx,Transform:ux,Transpose:Wd,Unique:cx,Unpack:dx,UnsortedSegmentSum:px,UpperBound:mae,Variable:Rg,ZerosLike:hx,_FusedMatMul:Cg,abs:ja,acos:x8,acosh:w8,add:ot,addN:k8,all:S8,any:C8,argMax:N8,argMin:T8,asin:I8,asinh:E8,atan:_8,atan2:O8,atanh:$8,avgPool:JT,avgPool3d:R8,backend:loe,backend_util:cF,basicLSTMCell:M8,batchNorm:Bg,batchNorm2d:A8,batchNorm3d:P8,batchNorm4d:L8,batchToSpaceND:eI,bincount:tI,booleanMaskAsync:vD,broadcastArgs:D8,broadcastTo:Jd,broadcast_util:yoe,browser:Soe,buffer:pt,cast:wn,ceil:F8,clipByValue:B8,clone:Is,complex:Ns,concat:Ur,concat1d:z8,concat2d:j8,concat3d:V8,concat4d:W8,conv1d:U8,conv2d:zg,conv2dTranspose:H8,conv3d:q8,conv3dTranspose:K8,copyRegisteredKernels:wae,cos:X8,cosh:Y8,cosineWindow:Bx,cumprod:Q8,cumsum:Z8,customGrad:Do,denseBincount:J8,deprecationWarn:Qie,depthToSpace:eL,depthwiseConv2d:_x,device_util:Xae,diag:tL,dilation2d:nL,disableDeprecationWarnings:Yie,dispose:Vr,disposeVariables:Zie,div:un,divNoNan:rL,dot:aL,dropout:CD,einsum:iL,elu:rI,enableDebugMode:Xie,enableProdMode:Kie,enclosingPowerOfTwo:LI,engine:Es,env:ce,equal:nI,erf:oL,euclideanNorm:uL,exp:Dl,expandDims:$s,expm1:cL,eye:iI,fft:Lx,fill:ep,findBackend:ooe,findBackendFactory:soe,floor:oI,floorDiv:YT,fused:TD,gather:sI,gatherND:SD,gather_util:Coe,getBackend:aoe,getGradient:aT,getKernel:mx,getKernelsForBackend:yx,grad:_le,grads:Ole,greater:Wg,greaterEqual:lI,ifft:qg,imag:Pg,image:FI,inTopKAsync:ND,io:AT,irfft:RI,isFinite:dL,isInf:pL,isNaN:hL,keep:Ao,kernel_impls:xpe,leakyRelu:uI,less:fL,lessEqual:$x,linalg:MD,linspace:gL,localResponseNormalization:mL,log:rp,log1p:cI,logSigmoid:bL,logSoftmax:vL,logSumExp:pI,logicalAnd:Ug,logicalNot:hI,logicalOr:fI,logicalXor:xL,losses:AD,lowerBound:wL,matMul:Gt,math:moe,max:sc,maxPool:gI,maxPool3d:kL,maxPoolWithArgmax:SL,maximum:mI,mean:Gg,memory:Jie,meshgrid:CL,min:Ox,minimum:yI,mirrorPad:NL,mod:TL,moments:IL,movingAverage:xD,mul:$e,multiRNNCell:EL,multinomial:_L,neg:Po,nextFrame:DD,norm:Vg,notEqual:bI,oneHot:Nx,ones:Bl,onesLike:OL,op:ee,outerProduct:$L,pad:ap,pad1d:RL,pad2d:ML,pad3d:AL,pad4d:PL,pool:LL,pow:tp,prelu:xI,print:_T,prod:DL,profile:eoe,raggedGather:FL,raggedTensorToTensor:BL,rand:zL,randomGamma:WL,randomNormal:EI,randomStandardNormal:UL,randomUniform:_I,range:ip,ready:roe,real:Yd,reciprocal:GL,registerBackend:PT,registerGradient:bae,registerKernel:bx,relu:Hg,relu6:OI,removeBackend:ioe,reshape:xe,reverse:zl,reverse1d:HL,reverse2d:qL,reverse3d:KL,reverse4d:XL,rfft:Dx,round:$I,rsqrt:YL,scalar:St,scatterND:wD,scatter_util:Noe,searchSorted:Ax,selu:QL,separableConv2d:ZL,serialization:Ooe,setBackend:noe,setPlatform:uoe,setdiff1dAsync:JL,sigmoid:ic,sign:eD,signal:RD,sin:tD,sinh:nD,slice:nn,slice1d:rD,slice2d:aD,slice3d:iD,slice4d:oD,slice_util:m8,softmax:sD,softplus:dI,spaceToBatchND:vI,sparse:PD,sparseToDense:kD,spectral:$D,split:op,sqrt:Lo,square:Oi,squaredDifference:MI,squeeze:Kg,stack:Fo,step:AI,stridedSlice:lD,string:LD,sub:xt,sum:cn,sumOutType:kx,tan:uD,tanh:Ex,tensor:uo,tensor1d:$i,tensor2d:sp,tensor3d:DT,tensor4d:cD,tensor5d:dD,tensor6d:pD,tensor_util:Uae,test_util:zoe,tidy:Ot,tile:np,time:toe,topk:hD,train:gpe,transpose:Lg,truncatedNormal:fD,unique:gD,unregisterGradient:xae,unregisterKernel:vae,unsortedSegmentSum:mD,unstack:jl,upcastType:Sa,upperBound:yD,util:Oae,valueAndGrad:$le,valueAndGrads:Rle,variable:bD,variableGrads:yL,version_core:joe,where:oc,whereAsync:PI,zeros:Fl,zerosLike:Va},Symbol.toStringTag,{value:"Module"}));/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const kpe=ce();kpe.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,t=>{t&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*
* =============================================================================
*/var Ri;(function(t){t[t.DT_INVALID=0]="DT_INVALID",t[t.DT_FLOAT=1]="DT_FLOAT",t[t.DT_DOUBLE=2]="DT_DOUBLE",t[t.DT_INT32=3]="DT_INT32",t[t.DT_UINT8=4]="DT_UINT8",t[t.DT_INT16=5]="DT_INT16",t[t.DT_INT8=6]="DT_INT8",t[t.DT_STRING=7]="DT_STRING",t[t.DT_COMPLEX64=8]="DT_COMPLEX64",t[t.DT_INT64=9]="DT_INT64",t[t.DT_BOOL=10]="DT_BOOL",t[t.DT_QINT8=11]="DT_QINT8",t[t.DT_QUINT8=12]="DT_QUINT8",t[t.DT_QINT32=13]="DT_QINT32",t[t.DT_BFLOAT16=14]="DT_BFLOAT16",t[t.DT_QINT16=15]="DT_QINT16",t[t.DT_QUINT16=16]="DT_QUINT16",t[t.DT_UINT16=17]="DT_UINT16",t[t.DT_COMPLEX128=18]="DT_COMPLEX128",t[t.DT_HALF=19]="DT_HALF",t[t.DT_RESOURCE=20]="DT_RESOURCE",t[t.DT_VARIANT=21]="DT_VARIANT",t[t.DT_UINT32=22]="DT_UINT32",t[t.DT_UINT64=23]="DT_UINT64",t[t.DT_FLOAT_REF=101]="DT_FLOAT_REF",t[t.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",t[t.DT_INT32_REF=103]="DT_INT32_REF",t[t.DT_UINT8_REF=104]="DT_UINT8_REF",t[t.DT_INT16_REF=105]="DT_INT16_REF",t[t.DT_INT8_REF=106]="DT_INT8_REF",t[t.DT_STRING_REF=107]="DT_STRING_REF",t[t.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",t[t.DT_INT64_REF=109]="DT_INT64_REF",t[t.DT_BOOL_REF=110]="DT_BOOL_REF",t[t.DT_QINT8_REF=111]="DT_QINT8_REF",t[t.DT_QUINT8_REF=112]="DT_QUINT8_REF",t[t.DT_QINT32_REF=113]="DT_QINT32_REF",t[t.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",t[t.DT_QINT16_REF=115]="DT_QINT16_REF",t[t.DT_QUINT16_REF=116]="DT_QUINT16_REF",t[t.DT_UINT16_REF=117]="DT_UINT16_REF",t[t.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",t[t.DT_HALF_REF=119]="DT_HALF_REF",t[t.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",t[t.DT_VARIANT_REF=121]="DT_VARIANT_REF",t[t.DT_UINT32_REF=122]="DT_UINT32_REF",t[t.DT_UINT64_REF=123]="DT_UINT64_REF"})(Ri||(Ri={}));var dF;(function(t){(function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"})(t.CheckpointFormatVersion||(t.CheckpointFormatVersion={}))})(dF||(dF={}));/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Spe={};function pF(t){return Spe[t]}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function O(t,e,n,r,a){const i=e.inputParams[t];if(i&&i.inputIndexStart!==void 0){const s=i.inputIndexStart,l=i.inputIndexEnd===0?void 0:i.inputIndexEnd===void 0?s+1:i.inputIndexEnd;if(i.type==="tensor")return la(e.inputNames[i.inputIndexStart],n,r,a);if(i.type==="tensors")return e.inputNames.slice(s,l).map(d=>la(d,n,r,a));const u=la(e.inputNames.slice(s)[0],n,r,a),c=u.dataSync();return i.type==="number"?c[0]:ri(u.shape,c)}const o=e.attrParams[t];return o&&o.value}function la(t,e,n,r){const[a,i]=Wa(t);if(r!=null){const s=r.getHashTableHandleByName(a);if(s!=null)return s}const o=n.currentContextIds.find(s=>!!e[e2(a,s)]);return o!==void 0?e[e2(a,o)][i]:void 0}function Cpe(t,e,n){return e[e2(t,n.currentContextId)]}function zo(t,e){const[n,r,a]=Wa(t);return[e2(n,e&&e.currentContextId),r,a]}function e2(t,e){return e?`${t}-${e}`:t}function Wa(t){const e=t.split(":");if(e.length===1)return[t,0,void 0];const n=e[0],r=e.length===3?e[1]:void 0,a=Number(e[e.length-1]);return[n,a,r]}function t2(t,e,n){let r=O("pad",t,e,n);if(r==="explicit"){r=O("explicitPaddings",t,e,n);const a=[[0,0],[0,0],[0,0],[0,0]];for(let i=0;i<4;i++)a[i][0]=r[i*2],a[i][1]=r[i*2+1];return a}return r}function As(t){return t.kept?t:Is(t)}/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Npe=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],Tpe=Object.freeze(Object.defineProperty({__proto__:null,json:Npe},Symbol.toStringTag,{value:"Module"}));/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Ipe=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Prod",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axes",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsNan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],Epe=Object.freeze(Object.defineProperty({__proto__:null,json:Ipe},Symbol.toStringTag,{value:"Module"}));/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const _pe=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcatV2",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListLength",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}]},{tfOpName:"TensorListResize",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"size",type:"number"}]}],Ope=Object.freeze(Object.defineProperty({__proto__:null,json:_pe},Symbol.toStringTag,{value:"Module"}));/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const $pe=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}],Rpe=Object.freeze(Object.defineProperty({__proto__:null,json:$pe},Symbol.toStringTag,{value:"Module"}));/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Mpe=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomStandardNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],Ape=Object.freeze(Object.defineProperty({__proto__:null,json:Mpe},Symbol.toStringTag,{value:"Module"}));/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Ppe=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],Lpe=Object.freeze(Object.defineProperty({__proto__:null,json:Ppe},Symbol.toStringTag,{value:"Module"}));/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Dpe=[{tfOpName:"LowerBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"UpperBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}],Fpe=Object.freeze(Object.defineProperty({__proto__:null,json:Dpe},Symbol.toStringTag,{value:"Module"}));/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Bpe=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],zpe=Object.freeze(Object.defineProperty({__proto__:null,json:Bpe},Symbol.toStringTag,{value:"Module"}));/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const jpe=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]}],Vpe=Object.freeze(Object.defineProperty({__proto__:null,json:jpe},Symbol.toStringTag,{value:"Module"}));/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Wpe=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]},{tfOpName:"ImageProjectiveTransformV3",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"transforms",type:"tensor"},{start:2,name:"outputShape",type:"number[]"},{start:3,name:"fillValue",type:"number"}],attrs:[{tfName:"interpolation",name:"interpolation",type:"string"},{tfName:"fill_mode",name:"fillMode",type:"string"}]}],Upe=Object.freeze(Object.defineProperty({__proto__:null,json:Wpe},Symbol.toStringTag,{value:"Module"}));/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Gpe=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],Hpe=Object.freeze(Object.defineProperty({__proto__:null,json:Gpe},Symbol.toStringTag,{value:"Module"}));/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const qpe=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Einsum",category:"matrices",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"equation",name:"equation",type:"string"},{tfName:"N",name:"n",type:"number",defaultValue:2},{tfName:"T",name:"dtype",type:"dtype"}]}],Kpe=Object.freeze(Object.defineProperty({__proto__:null,json:qpe},Symbol.toStringTag,{value:"Module"}));/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Xpe=[{tfOpName:"EuclideanNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",defaultValue:!1}]},{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"SparseToDense",category:"normalization",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!0,notSupported:!0}]}],Ype=Object.freeze(Object.defineProperty({__proto__:null,json:Xpe},Symbol.toStringTag,{value:"Module"}));/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Qpe=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Cumprod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}],Zpe=Object.freeze(Object.defineProperty({__proto__:null,json:Qpe},Symbol.toStringTag,{value:"Module"}));/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Jpe=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]}],ehe=Object.freeze(Object.defineProperty({__proto__:null,json:Jpe},Symbol.toStringTag,{value:"Module"}));/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const the=[{tfOpName:"SparseFillEmptyRows",category:"sparse",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"denseShape",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}]},{tfOpName:"SparseReshape",category:"sparse",inputs:[{start:0,name:"inputIndices",type:"tensor"},{start:1,name:"inputShape",type:"tensor"},{start:2,name:"newShape",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SparseSegmentMean",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]},{tfOpName:"SparseSegmentSum",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]}],nhe=Object.freeze(Object.defineProperty({__proto__:null,json:the},Symbol.toStringTag,{value:"Module"}));/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const rhe=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],ahe=Object.freeze(Object.defineProperty({__proto__:null,json:rhe},Symbol.toStringTag,{value:"Module"}));/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const ihe=[{tfOpName:"StringNGrams",category:"string",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"dataSplits",type:"tensor"}],attrs:[{tfName:"separator",name:"separator",type:"string"},{tfName:"ngram_widths",name:"nGramWidths",type:"number[]"},{tfName:"left_pad",name:"leftPad",type:"string"},{tfName:"right_pad",name:"rightPad",type:"string"},{tfName:"pad_width",name:"padWidth",type:"number"},{tfName:"preserve_short_sequences",name:"preserveShortSequences",type:"bool"}],outputs:["ngrams","ngrams_splits"]},{tfOpName:"StringSplit",category:"string",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"delimiter",type:"tensor"}],attrs:[{tfName:"skip_empty",name:"skipEmpty",type:"bool"}],outputs:["indices","values","shape"]},{tfOpName:"StringToHashBucketFast",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"num_buckets",name:"numBuckets",type:"number"}]}],ohe=Object.freeze(Object.defineProperty({__proto__:null,json:ihe},Symbol.toStringTag,{value:"Module"}));/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const she=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]},{tfOpName:"BroadcastArgs",category:"transformation",inputs:[{start:0,name:"s0",type:"tensor"},{start:1,name:"s1",type:"tensor"}],attrs:[]}],lhe=Object.freeze(Object.defineProperty({__proto__:null,json:she},Symbol.toStringTag,{value:"Module"}));/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class hF{static get Instance(){return this._instance||(this._instance=new this)}constructor(){const e=[Tpe,Epe,Ope,Rpe,Ape,Lpe,Fpe,zpe,Vpe,Upe,Hpe,Kpe,Ype,Zpe,ehe,nhe,ahe,ohe,lhe],n=[].concat(...e.map(r=>r.json));this.opMappers=n.reduce((r,a)=>(r[a.tfOpName]=a,r),{})}transformGraph(e,n={}){const r=e.node,a=[],i=[],o=[],s=r.reduce((y,x)=>(y[x.name]=this.mapNode(x),x.op.startsWith("Placeholder")?a.push(y[x.name]):x.op==="Const"?i.push(y[x.name]):(x.input==null||x.input.length===0)&&o.push(y[x.name]),y),{});let l=[];const u=[];let c={},d={};n!=null&&(c=this.mapSignatureEntries(n.inputs),d=this.mapSignatureEntries(n.outputs));const p=Object.keys(s);p.forEach(y=>{const x=s[y];x.inputNames.forEach((b,v)=>{const[w,,S]=zo(b),C=s[w];if(C.outputs!=null){const I=C.outputs.indexOf(S);if(I!==-1){const _=`${w}:${I}`;x.inputNames[v]=_}}x.inputs.push(C),C.children.push(x)})}),Object.keys(d).length===0?p.forEach(y=>{const x=s[y];x.children.length===0&&u.push(x)}):Object.keys(d).forEach(y=>{const[x]=zo(y),b=s[x];b!=null&&(b.signatureKey=d[y],u.push(b))}),Object.keys(c).length>0?Object.keys(c).forEach(y=>{const[x]=zo(y),b=s[x];b&&(b.signatureKey=c[y],l.push(b))}):l=a;let f={};e.library!=null&&e.library.function!=null&&(f=e.library.function.reduce((y,x)=>(y[x.signature.name]=this.mapFunction(x),y),{}));const m={nodes:s,inputs:l,outputs:u,weights:i,placeholders:a,signature:n,functions:f};return o.length>0&&(m.initNodes=o),m}mapSignatureEntries(e){return Object.keys(e||{}).reduce((n,r)=>(n[e[r].name]=r,n),{})}mapNode(e){const n=pF(e.op)||this.opMappers[e.op]||{};e.attr==null&&(e.attr={});const r={name:e.name,op:e.op,category:n.category,inputNames:(e.input||[]).map(a=>a.startsWith("^")?a.slice(1):a),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:e.attr,outputs:n.outputs};return n.inputs!=null&&(r.inputParams=n.inputs.reduce((a,i)=>(a[i.name]={type:i.type,inputIndexStart:i.start,inputIndexEnd:i.end},a),{})),n.attrs!=null&&(r.attrParams=n.attrs.reduce((a,i)=>{const o=i.type;let s;switch(i.type){case"string":s=l4(e.attr,i.tfName,i.defaultValue),s===void 0&&i.tfDeprecatedName&&(s=l4(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"string[]":s=m4(e.attr,i.tfName,i.defaultValue),s===void 0&&i.tfDeprecatedName&&(s=m4(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"number":s=c4(e.attr,i.tfName,i.defaultValue||0),s===void 0&&i.tfDeprecatedName&&(s=c4(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"number[]":s=g4(e.attr,i.tfName,i.defaultValue),s===void 0&&i.tfDeprecatedName&&(s=g4(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"bool":s=u4(e.attr,i.tfName,i.defaultValue),s===void 0&&i.tfDeprecatedName&&(s=u4(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"bool[]":s=b4(e.attr,i.tfName,i.defaultValue),s===void 0&&i.tfDeprecatedName&&(s=b4(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"shape":s=f4(e.attr,i.tfName,i.defaultValue),s===void 0&&i.tfDeprecatedName&&(s=f4(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"shape[]":s=y4(e.attr,i.tfName,i.defaultValue),s===void 0&&i.tfDeprecatedName&&(s=y4(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"dtype":s=p4(e.attr,i.tfName,i.defaultValue),s===void 0&&i.tfDeprecatedName&&(s=p4(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"dtype[]":s=h4(e.attr,i.tfName,i.defaultValue),s===void 0&&i.tfDeprecatedName&&(s=h4(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"func":s=gF(e.attr,i.tfName,i.defaultValue),s===void 0&&i.tfDeprecatedName&&(s=gF(e.attr,i.tfDeprecatedName,i.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error(`Unsupported param type: ${i.type} for op: ${e.op}`)}return a[i.name]={value:s,type:o},a},{})),r}mapFunction(e){const n=e.nodeDef,r=[],a=[];let i={};n!=null&&(i=n.reduce((c,d)=>(c[d.name]=this.mapNode(d),d.op==="Const"&&a.push(c[d.name]),c),{}));const o=[],s=[];e.signature.inputArg.forEach(c=>{const[d]=zo(c.name),p={name:d,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:d4(c.type),type:"dtype"}},children:[]};p.signatureKey=c.name,o.push(p),i[d]=p}),Object.keys(i).forEach(c=>{const d=i[c];d.inputNames.forEach((p,f)=>{const[m,,y]=zo(p),x=i[m];if(x.outputs!=null){const b=x.outputs.indexOf(y);if(b!==-1){const v=`${m}:${b}`;d.inputNames[f]=v}}d.inputs.push(x),x.children.push(d)})});const l=e.ret;e.signature.outputArg.forEach(c=>{const[d,p]=zo(l[c.name]),f=i[d];f!=null&&(f.defaultOutput=p,s.push(f))});const u=this.mapArgsToSignature(e);return{nodes:i,inputs:o,outputs:s,weights:a,placeholders:r,signature:u}}mapArgsToSignature(e){return{methodName:e.signature.name,inputs:e.signature.inputArg.reduce((n,r)=>(n[r.name]=this.mapArgToTensorInfo(r),n),{}),outputs:e.signature.outputArg.reduce((n,r)=>(n[r.name]=this.mapArgToTensorInfo(r,e.ret),n),{})}}mapArgToTensorInfo(e,n){let r=e.name;return n!=null&&(r=n[r]),{name:r,dtype:e.type}}}function uhe(t){const e=ce().global;if(typeof e.atob<"u")return e.atob(t);if(typeof Buffer<"u")return new Buffer(t,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}function fF(t,e){const n=Array.isArray(t)?String.fromCharCode.apply(null,t):uhe(t);return e?n:n.toLowerCase()}function l4(t,e,n,r=!1){const a=t[e];return a!=null?fF(a.s,r):n}function u4(t,e,n){const r=t[e];return r?r.b:n}function c4(t,e,n){const r=t[e]||{},a=r.i!=null?r.i:r.f!=null?r.f:n;return typeof a=="number"?a:parseInt(a,10)}function d4(t){switch(typeof t=="string"&&(t=Ri[t]),t){case Ri.DT_FLOAT:case Ri.DT_HALF:return"float32";case Ri.DT_INT32:case Ri.DT_INT64:case Ri.DT_INT8:case Ri.DT_UINT8:return"int32";case Ri.DT_BOOL:return"bool";case Ri.DT_DOUBLE:return"float32";case Ri.DT_STRING:return"string";default:return null}}function gF(t,e,n){const r=t[e];return r&&r.func?r.func.name:n}function p4(t,e,n){const r=t[e];return r&&r.type?d4(r.type):n}function h4(t,e,n){const r=t[e];return r&&r.list&&r.list.type?r.list.type.map(a=>d4(a)):n}function mF(t){if(!t.unknownRank)return t.dim!=null?t.dim.map(e=>typeof e.size=="number"?e.size:parseInt(e.size,10)):[]}function f4(t,e,n){const r=t[e];return r&&r.shape?mF(r.shape):n}function g4(t,e,n){const r=t[e];return r?((r.list.f&&r.list.f.length?r.list.f:r.list.i)||[]).map(a=>typeof a=="number"?a:parseInt(a,10)):n}function m4(t,e,n,r=!1){const a=t[e];return a&&a.list&&a.list.s?a.list.s.map(i=>fF(i,r)):n}function y4(t,e,n){const r=t[e];return r&&r.list&&r.list.shape?r.list.shape.map(a=>mF(a)):n}function b4(t,e,n){const r=t[e];return r&&r.list&&r.list.b?r.list.b:n}/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class che{constructor(e,n,r){this.node=e,this.tensorMap=n,this.context=r,this.inputs=[],this.attrs={},this.inputs=e.inputNames.map(a=>this.getInput(a)),e.rawAttrs!=null&&(this.attrs=Object.keys(e.rawAttrs).reduce((a,i)=>(a[i]=this.getAttr(i),a),{}))}getInput(e){return la(e,this.tensorMap,this.context)}getAttr(e,n){const r=this.node.rawAttrs[e];if(r.tensor!=null)return la(e,this.tensorMap,this.context);if(r.i!=null||r.f!=null)return c4(this.node.rawAttrs,e,n);if(r.s!=null)return l4(this.node.rawAttrs,e,n);if(r.b!=null)return u4(this.node.rawAttrs,e,n);if(r.shape!=null)return f4(this.node.rawAttrs,e,n);if(r.type!=null)return p4(this.node.rawAttrs,e,n);if(r.list!=null){if(r.list.i!=null||r.list.f!=null)return g4(this.node.rawAttrs,e,n);if(r.list.s!=null)return m4(this.node.rawAttrs,e,n);if(r.list.shape!=null)return y4(this.node.rawAttrs,e,n);if(r.list.b!=null)return b4(this.node.rawAttrs,e,n);if(r.list.type!=null)return h4(this.node.rawAttrs,e,n)}return n}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Gr=Object.freeze(Object.defineProperty({__proto__:null,OP_SCOPE_SUFFIX:xT,abs:ja,acos:x8,acosh:w8,add:ot,addN:k8,all:S8,any:C8,argMax:N8,argMin:T8,asin:I8,asinh:E8,atan:_8,atan2:O8,atanh:$8,avgPool:JT,avgPool3d:R8,basicLSTMCell:M8,batchNorm:Bg,batchNorm2d:A8,batchNorm3d:P8,batchNorm4d:L8,batchToSpaceND:eI,bincount:tI,booleanMaskAsync:vD,broadcastArgs:D8,broadcastTo:Jd,buffer:pt,cast:wn,ceil:F8,clipByValue:B8,clone:Is,complex:Ns,concat:Ur,concat1d:z8,concat2d:j8,concat3d:V8,concat4d:W8,conv1d:U8,conv2d:zg,conv2dTranspose:H8,conv3d:q8,conv3dTranspose:K8,cos:X8,cosh:Y8,cosineWindow:Bx,cumprod:Q8,cumsum:Z8,denseBincount:J8,depthToSpace:eL,depthwiseConv2d:_x,diag:tL,dilation2d:nL,div:un,divNoNan:rL,dot:aL,dropout:CD,einsum:iL,elu:rI,enclosingPowerOfTwo:LI,equal:nI,erf:oL,euclideanNorm:uL,exp:Dl,expandDims:$s,expm1:cL,eye:iI,fft:Lx,fill:ep,floor:oI,floorDiv:YT,fused:TD,gather:sI,gatherND:SD,greater:Wg,greaterEqual:lI,ifft:qg,imag:Pg,image:FI,inTopKAsync:ND,irfft:RI,isFinite:dL,isInf:pL,isNaN:hL,leakyRelu:uI,less:fL,lessEqual:$x,linalg:MD,linspace:gL,localResponseNormalization:mL,log:rp,log1p:cI,logSigmoid:bL,logSoftmax:vL,logSumExp:pI,logicalAnd:Ug,logicalNot:hI,logicalOr:fI,logicalXor:xL,losses:AD,lowerBound:wL,matMul:Gt,max:sc,maxPool:gI,maxPool3d:kL,maxPoolWithArgmax:SL,maximum:mI,mean:Gg,meshgrid:CL,min:Ox,minimum:yI,mirrorPad:NL,mod:TL,moments:IL,movingAverage:xD,mul:$e,multiRNNCell:EL,multinomial:_L,neg:Po,norm:Vg,notEqual:bI,oneHot:Nx,ones:Bl,onesLike:OL,op:ee,outerProduct:$L,pad:ap,pad1d:RL,pad2d:ML,pad3d:AL,pad4d:PL,pool:LL,pow:tp,prelu:xI,print:_T,prod:DL,raggedGather:FL,raggedTensorToTensor:BL,rand:zL,randomGamma:WL,randomNormal:EI,randomStandardNormal:UL,randomUniform:_I,range:ip,real:Yd,reciprocal:GL,relu:Hg,relu6:OI,reshape:xe,reverse:zl,reverse1d:HL,reverse2d:qL,reverse3d:KL,reverse4d:XL,rfft:Dx,round:$I,rsqrt:YL,scalar:St,scatterND:wD,searchSorted:Ax,selu:QL,separableConv2d:ZL,setdiff1dAsync:JL,sigmoid:ic,sign:eD,signal:RD,sin:tD,sinh:nD,slice:nn,slice1d:rD,slice2d:aD,slice3d:iD,slice4d:oD,softmax:sD,softplus:dI,spaceToBatchND:vI,sparse:PD,sparseToDense:kD,spectral:$D,split:op,sqrt:Lo,square:Oi,squaredDifference:MI,squeeze:Kg,stack:Fo,step:AI,stridedSlice:lD,string:LD,sub:xt,sum:cn,tan:uD,tanh:Ex,tensor:uo,tensor1d:$i,tensor2d:sp,tensor3d:DT,tensor4d:cD,tensor5d:dD,tensor6d:pD,tile:np,topk:hD,transpose:Lg,truncatedNormal:fD,unique:gD,unsortedSegmentSum:mD,unstack:jl,upperBound:yD,variable:bD,where:oc,whereAsync:PI,zeros:Fl,zerosLike:Va},Symbol.toStringTag,{value:"Module"}));/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const dhe=(t,e,n,r=Gr)=>{switch(t.op){case"BiasAdd":case"AddV2":case"Add":return[r.add(O("a",t,e,n),O("b",t,e,n))];case"AddN":return[r.addN(O("tensors",t,e,n))];case"FloorMod":case"Mod":return[r.mod(O("a",t,e,n),O("b",t,e,n))];case"Mul":return[r.mul(O("a",t,e,n),O("b",t,e,n))];case"RealDiv":case"Div":return[r.div(O("a",t,e,n),O("b",t,e,n))];case"DivNoNan":return[r.divNoNan(O("a",t,e,n),O("b",t,e,n))];case"FloorDiv":return[r.floorDiv(O("a",t,e,n),O("b",t,e,n))];case"Sub":return[r.sub(O("a",t,e,n),O("b",t,e,n))];case"Minimum":return[r.minimum(O("a",t,e,n),O("b",t,e,n))];case"Maximum":return[r.maximum(O("a",t,e,n),O("b",t,e,n))];case"Pow":return[r.pow(O("a",t,e,n),O("b",t,e,n))];case"SquaredDifference":return[r.squaredDifference(O("a",t,e,n),O("b",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const phe=(t,e,n,r=Gr)=>{switch(t.op){case"Abs":case"ComplexAbs":return[r.abs(O("x",t,e,n))];case"Acos":return[r.acos(O("x",t,e,n))];case"Acosh":return[r.acosh(O("x",t,e,n))];case"Asin":return[r.asin(O("x",t,e,n))];case"Asinh":return[r.asinh(O("x",t,e,n))];case"Atan":return[r.atan(O("x",t,e,n))];case"Atan2":return[r.atan2(O("x",t,e,n),O("y",t,e,n))];case"Atanh":return[r.atanh(O("x",t,e,n))];case"Ceil":return[r.ceil(O("x",t,e,n))];case"Complex":return[r.complex(O("real",t,e,n),O("imag",t,e,n))];case"Cos":return[r.cos(O("x",t,e,n))];case"Cosh":return[r.cosh(O("x",t,e,n))];case"Elu":return[r.elu(O("x",t,e,n))];case"Erf":return[r.erf(O("x",t,e,n))];case"Exp":return[r.exp(O("x",t,e,n))];case"Expm1":return[r.expm1(O("x",t,e,n))];case"Floor":return[r.floor(O("x",t,e,n))];case"Log":return[r.log(O("x",t,e,n))];case"Log1p":return[r.log1p(O("x",t,e,n))];case"Imag":return[r.imag(O("x",t,e,n))];case"Neg":return[r.neg(O("x",t,e,n))];case"Reciprocal":return[r.reciprocal(O("x",t,e,n))];case"Real":return[r.real(O("x",t,e,n))];case"Relu":return[r.relu(O("x",t,e,n))];case"Round":return[r.round(O("x",t,e,n))];case"Selu":return[r.selu(O("x",t,e,n))];case"Sigmoid":return[r.sigmoid(O("x",t,e,n))];case"Sin":return[r.sin(O("x",t,e,n))];case"Sign":return[r.sign(O("x",t,e,n))];case"Sinh":return[r.sinh(O("x",t,e,n))];case"Softplus":return[r.softplus(O("x",t,e,n))];case"Sqrt":return[r.sqrt(O("x",t,e,n))];case"Square":return[r.square(O("x",t,e,n))];case"Tanh":return[r.tanh(O("x",t,e,n))];case"Tan":return[r.tan(O("x",t,e,n))];case"ClipByValue":return[r.clipByValue(O("x",t,e,n),O("clipValueMin",t,e,n),O("clipValueMax",t,e,n))];case"Relu6":return[r.relu6(O("x",t,e,n))];case"Rsqrt":return[r.rsqrt(la(t.inputNames[0],e,n))];case"Prod":return[r.prod(O("x",t,e,n),O("axes",t,e,n))];case"LeakyRelu":return[r.leakyRelu(O("x",t,e,n),O("alpha",t,e,n))];case"Prelu":return[r.prelu(O("x",t,e,n),O("alpha",t,e,n))];case"IsNan":return[r.isNaN(la(t.inputNames[0],e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Mi(t,e,n=""){if(!(typeof t=="number"||typeof e=="number")){j(t.length===e.length,()=>n+` Shapes ${t} and ${e} must match`);for(let r=0;r<t.length;r++){const a=t[r],i=e[r];j(a<0||i<0||a===i,()=>n+` Shapes ${t} and ${e} must match`)}}}function yF(t){return!(typeof t=="number"||t.some(e=>e<0))}function Jg(t,e,n){let r=v4(t,n);const a=!yF(r);if(a&&e.length===0)throw new Error(`Tried to calculate elements of an empty list with non-fully-defined elementShape: ${r}`);if(a&&e.forEach(i=>{r=v4(i.shape,r)}),!yF(r))throw new Error(`Non-fully-defined elementShape: ${r}`);return r}function v4(t,e){if(typeof t=="number")return e;if(typeof e=="number")return t;if(t.length!==e.length)throw new Error(`Incompatible ranks during merge: ${t} vs. ${e}`);const n=[];for(let r=0;r<t.length;++r){const a=t[r],i=e[r];if(a>=0&&i>=0&&a!==i)throw new Error(`Incompatible shape during merge: ${t} vs. ${e}`);n[r]=a>=0?a:i}return n}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class hhe{constructor(e,n,r,a,i,o,s){this.name=e,this.dtype=n,this.maxSize=r,this.elementShape=a,this.identicalElementShapes=i,this.dynamicSize=o,this.clearAfterRead=s,this.tensors=[],this.closed_=!1,this.idTensor=St(0),Ao(this.idTensor)}get id(){return this.idTensor.id}get closed(){return this.closed_}clearAndClose(e){this.tensors.forEach(n=>{(e==null||!e.has(n.tensor.id))&&n.tensor.dispose()}),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}size(){return this.tensors.length}read(e){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||e>=this.size())throw new Error(`Tried to read from index ${e}, but array size is: ${this.size()}`);const n=this.tensors[e];if(n.cleared)throw new Error(`TensorArray ${this.name}: Could not read index ${e} twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).`);return this.clearAfterRead&&(n.cleared=!0),n.read=!0,n.tensor}readMany(e){return e.map(n=>this.read(n))}write(e,n){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||!this.dynamicSize&&e>=this.maxSize)throw new Error(`Tried to write to index ${e}, but array is not resizeable and size is: ${this.maxSize}`);const r=this.tensors[e]||{};if(n.dtype!==this.dtype)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e},
          because the value dtype is ${n.dtype}, but TensorArray dtype is ${this.dtype}.`);if(this.size()===0&&(this.elementShape==null||this.elementShape.length===0)&&(this.elementShape=n.shape),Mi(this.elementShape,n.shape,`TensorArray ${this.name}: Could not write to TensorArray index ${e}.`),r.read)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been read.`);if(r.written)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been written.`);r.tensor=n,Ao(n),r.written=!0,this.tensors[e]=r}writeMany(e,n){if(e.length!==n.length)throw new Error(`TensorArray ${this.name}: could not write multiple tensors,because the index size: ${e.length} is not the same as tensors size: ${n.length}.`);e.forEach((r,a)=>this.write(r,n[a]))}gather(e,n){if(n&&n!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but gather requested dtype ${n}`);if(e)e=e.slice(0,this.size());else{e=[];for(let a=0;a<this.size();a++)e.push(a)}if(e.length===0)return uo([],[0].concat(this.elementShape));const r=this.readMany(e);return Mi(this.elementShape,r[0].shape,"TensorArray shape mismatch: "),Fo(r,0)}concat(e){if(e&&e!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but concat requested dtype ${e}`);if(this.size()===0)return uo([],[0].concat(this.elementShape));const n=[];for(let a=0;a<this.size();a++)n.push(a);const r=this.readMany(n);return Mi(this.elementShape,r[0].shape,`TensorArray shape mismatch: tensor array shape (${this.elementShape}) vs first tensor shape (${r[0].shape})`),Ur(r,0)}scatter(e,n){if(n.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${n.dtype}`);if(e.length!==n.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${n.shape[0]}`);const r=Math.max(...e);if(!this.dynamicSize&&r>=this.maxSize)throw new Error(`Max index must be < array size (${r}  vs. ${this.maxSize})`);this.writeMany(e,jl(n,0))}split(e,n){if(n.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${n.dtype}`);let r=0;const a=e.map(l=>(r+=l,r));if(r!==n.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${r}, and tensor's shape is: ${n.shape}`);if(!this.dynamicSize&&e.length!==this.maxSize)throw new Error(`TensorArray's size is not equal to the size of lengths (${this.maxSize} vs. ${e.length}), and the TensorArray is not marked as dynamically resizeable`);const i=r===0?0:n.size/r,o=[];Ot(()=>{n=xe(n,[1,r,i]);for(let l=0;l<e.length;++l){const u=[0,l===0?0:a[l-1],0],c=[1,e[l],i];o[l]=xe(nn(n,u,c),this.elementShape)}return o});const s=[];for(let l=0;l<e.length;l++)s[l]=l;this.writeMany(s,o)}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class kc{constructor(e,n,r,a=-1){this.tensors=e,this.elementShape=n,this.elementDtype=r,e?.forEach(i=>{if(r!==i.dtype)throw new Error(`Invalid data types; op elements ${r}, but list elements ${i.dtype}`);Mi(n,i.shape,"TensorList shape mismatch: "),Ao(i)}),this.idTensor=St(0),this.maxNumElements=a,Ao(this.idTensor)}get id(){return this.idTensor.id}copy(){return new kc([...this.tensors],this.elementShape,this.elementDtype)}clearAndClose(e){this.tensors.forEach(n=>{(e==null||!e.has(n.id))&&n.dispose()}),this.tensors.length=0,this.idTensor.dispose()}size(){return this.tensors.length}stack(e,n,r=-1){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);if(r!==-1&&this.tensors.length!==r)throw new Error(`Operation expected a list with ${r} elements but got a list with ${this.tensors.length} elements.`);Mi(e,this.elementShape,"TensorList shape mismatch: ");const a=Jg(this.elementShape,this.tensors,e);return Ot(()=>{const i=this.tensors.map(o=>xe(o,a));return Fo(i,0)})}popBack(e,n){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);if(this.size()===0)throw new Error("Trying to pop from an empty list.");const r=Jg(this.elementShape,this.tensors,e),a=this.tensors.pop();return a.kept=!1,Mi(a.shape,e,"TensorList shape mismatch: "),xe(a,r)}pushBack(e){if(e.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${e.dtype}, but list elements ${this.elementDtype}`);if(Mi(e.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");Ao(e),this.tensors.push(e)}resize(e){if(e<0)throw new Error(`TensorListResize expects size to be non-negative. Got: ${e}`);if(this.maxNumElements!==-1&&e>this.maxNumElements)throw new Error(`TensorListResize input size ${e} is greater maxNumElement ${this.maxNumElements}.`);const n=new kc([],this.elementShape,this.elementDtype,this.maxNumElements);n.tensors.length=e;for(let r=0;r<Math.min(this.tensors.length,e);++r)n.tensors[r]=this.tensors[r];return n}getItem(e,n,r){if(r!==this.elementDtype)throw new Error(`Invalid data types; op elements ${r}, but list elements ${this.elementDtype}`);if(e<0||e>this.tensors.length)throw new Error(`Trying to access element ${e} in a list with ${this.tensors.length} elements.`);if(this.tensors[e]==null)throw new Error(`element at index ${e} is null.`);Mi(this.tensors[e].shape,n,"TensorList shape mismatch: ");const a=Jg(this.elementShape,this.tensors,n);return xe(this.tensors[e],a)}setItem(e,n){if(n.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n.dtype}, but list elements ${this.elementDtype}`);if(e<0||this.maxNumElements!==-1&&e>=this.maxNumElements)throw new Error(`Trying to set element ${e} in a list with max ${this.maxNumElements} elements.`);Mi(this.elementShape,n.shape,"TensorList shape mismatch: "),Ao(n),this.tensors[e]!=null&&(this.tensors[e].kept=!1),this.tensors[e]=n}gather(e,n,r){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);Mi(this.elementShape,r,"TensorList shape mismatch: "),e=e.slice(0,this.size());const a=Jg(this.elementShape,this.tensors,r);return e.length===0?uo([],[0].concat(a)):Ot(()=>{const i=e.map(o=>xe(this.tensors[o],a));return Fo(i,0)})}concat(e,n){if(e&&e!==this.elementDtype)throw new Error(`TensorList dtype is ${this.elementDtype} but concat requested dtype ${e}`);Mi(this.elementShape,n,"TensorList shape mismatch: ");const r=Jg(this.elementShape,this.tensors,n);return this.size()===0?uo([],[0].concat(r)):Ot(()=>{const a=this.tensors.map(i=>xe(i,r));return Ur(a,0)})}}function fhe(t,e,n){const r=t.dtype;if(t.shape.length<1)throw new Error(`Tensor must be at least a vector, but saw shape: ${t.shape}`);if(t.dtype!==n)throw new Error(`Invalid data types; op elements ${t.dtype}, but list elements ${n}`);const a=t.shape.slice(1);Mi(a,e,"TensorList shape mismatch: ");const i=jl(t);return new kc(i,e,r)}function ghe(t,e,n,r){return new kc([],t,e,r)}function mhe(t,e,n,r){if(e.length!==t.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${t.shape[0]}`);const a=Math.max(...e);if(r!=null&&r!==-1&&a>=r)throw new Error(`Max index must be < array size (${a}  vs. ${r})`);const i=new kc([],n,t.dtype,r),o=jl(t,0);return e.forEach((s,l)=>{i.setItem(s,o[l])}),i}function yhe(t,e,n){let r=0;const a=e.map(c=>(r+=c,r));if(r!==t.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${r}, and tensor's shape is: ${t.shape}`);const i=t.shape.slice(1),o=v4(i,n),s=r===0?0:t.size/r,l=Ot(()=>{const c=[];t=xe(t,[1,r,s]);for(let d=0;d<e.length;++d){const p=[0,d===0?0:a[d-1],0],f=[1,e[d],s];c[d]=xe(nn(t,p,f),o)}return t.dispose(),c}),u=new kc([],n,t.dtype,e.length);for(let c=0;c<l.length;c++)u.setItem(c,l[c]);return u}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const bhe=async(t,e,n)=>{switch(t.op){case"If":case"StatelessIf":{const r=O("thenBranch",t,e,n),a=O("elseBranch",t,e,n),i=O("cond",t,e,n),o=O("args",t,e,n);return(await i.data())[0]?n.functionMap[r].executeFunctionAsync(o,n.tensorArrayMap,n.tensorListMap):n.functionMap[a].executeFunctionAsync(o,n.tensorArrayMap,n.tensorListMap)}case"While":case"StatelessWhile":{const r=O("body",t,e,n),a=O("cond",t,e,n),i=O("args",t,e,n),o=await n.functionMap[a].executeFunctionAsync(i,n.tensorArrayMap,n.tensorListMap),s=i.map(c=>c.id);let l=await o[0].data();o.forEach(c=>{!c.kept&&s.indexOf(c.id)===-1&&c.dispose()});let u=i;for(;l[0];){const c=u;u=await n.functionMap[r].executeFunctionAsync(u,n.tensorArrayMap,n.tensorListMap);const d=u.map(f=>f.id);c.forEach(f=>{!f.kept&&s.indexOf(f.id)===-1&&d.indexOf(f.id)===-1&&f.dispose()});const p=await n.functionMap[a].executeFunctionAsync(u,n.tensorArrayMap,n.tensorListMap);l=await p[0].data(),p.forEach(f=>{!f.kept&&s.indexOf(f.id)===-1&&d.indexOf(f.id)===-1&&f.dispose()})}return u}case"LoopCond":{const r=O("pred",t,e,n);return[As(r)]}case"Switch":{const r=O("pred",t,e,n);let a=O("data",t,e,n);return a.kept||(a=As(a)),(await r.data())[0]?[void 0,a]:[a,void 0]}case"Merge":{const r=t.inputNames.find(a=>la(a,e,n)!==void 0);if(r){const a=la(r,e,n);return[As(a)]}return}case"Enter":{const r=O("frameName",t,e,n),a=O("tensor",t,e,n);return n.enterFrame(r),[As(a)]}case"Exit":{const r=O("tensor",t,e,n);return n.exitFrame(),[As(r)]}case"NextIteration":{const r=O("tensor",t,e,n);return n.nextIteration(),[As(r)]}case"TensorArrayV3":{const r=O("size",t,e,n),a=O("dtype",t,e,n),i=O("elementShape",t,e,n),o=O("dynamicSize",t,e,n),s=O("clearAfterRead",t,e,n),l=O("identicalElementShapes",t,e,n),u=O("name",t,e,n),c=new hhe(u,a,r,i,l,o,s);return n.addTensorArray(c),[c.idTensor,St(1)]}case"TensorArrayWriteV3":{const r=O("tensorArrayId",t,e,n),a=O("index",t,e,n),i=O("tensor",t,e,n),o=n.getTensorArray(r.id);return o.write(a,i),[o.idTensor]}case"TensorArrayReadV3":{const r=O("tensorArrayId",t,e,n),a=O("index",t,e,n);return[n.getTensorArray(r.id).read(a)]}case"TensorArrayGatherV3":{const r=O("tensorArrayId",t,e,n),a=O("indices",t,e,n),i=O("dtype",t,e,n);return[n.getTensorArray(r.id).gather(a,i)]}case"TensorArrayScatterV3":{const r=O("tensorArrayId",t,e,n),a=O("indices",t,e,n),i=O("tensor",t,e,n),o=n.getTensorArray(r.id);return o.scatter(a,i),[o.idTensor]}case"TensorArrayConcatV3":{const r=O("tensorArrayId",t,e,n),a=n.getTensorArray(r.id),i=O("dtype",t,e,n);return[a.concat(i)]}case"TensorArraySplitV3":{const r=O("tensorArrayId",t,e,n),a=O("tensor",t,e,n),i=O("lengths",t,e,n),o=n.getTensorArray(r.id);return o.split(i,a),[o.idTensor]}case"TensorArraySizeV3":{const r=O("tensorArrayId",t,e,n),a=n.getTensorArray(r.id);return[St(a.size(),"int32")]}case"TensorArrayCloseV3":{const r=O("tensorArrayId",t,e,n),a=n.getTensorArray(r.id);return a.clearAndClose(),[a.idTensor]}case"TensorListSetItem":{const r=O("tensorListId",t,e,n),a=O("index",t,e,n),i=O("tensor",t,e,n),o=n.getTensorList(r.id);return o.setItem(a,i),[o.idTensor]}case"TensorListGetItem":{const r=O("tensorListId",t,e,n),a=O("index",t,e,n),i=O("elementShape",t,e,n),o=O("elementDType",t,e,n);return[n.getTensorList(r.id).getItem(a,i,o)]}case"TensorListScatterV2":case"TensorListScatter":{const r=O("indices",t,e,n),a=O("tensor",t,e,n),i=O("elementShape",t,e,n),o=O("numElements",t,e,n),s=mhe(a,r,i,o);return n.addTensorList(s),[s.idTensor]}case"TensorListReserve":case"EmptyTensorList":{const r=O("elementShape",t,e,n),a=O("elementDType",t,e,n);let i;t.op==="TensorListReserve"?i="numElements":i="maxNumElements";const o=O(i,t,e,n),s=t.op==="TensorListReserve"?-1:o,l=ghe(r,a,o,s);return n.addTensorList(l),[l.idTensor]}case"TensorListGather":{const r=O("tensorListId",t,e,n),a=O("indices",t,e,n),i=O("elementShape",t,e,n),o=O("elementDType",t,e,n);return[n.getTensorList(r.id).gather(a,o,i)]}case"TensorListStack":{const r=O("tensorListId",t,e,n),a=O("elementShape",t,e,n),i=O("elementDType",t,e,n),o=O("numElements",t,e,n);return[n.getTensorList(r.id).stack(a,i,o)]}case"TensorListFromTensor":{const r=O("tensor",t,e,n),a=O("elementShape",t,e,n),i=O("elementDType",t,e,n),o=fhe(r,a,i);return n.addTensorList(o),[o.idTensor]}case"TensorListConcat":case"TensorListConcatV2":{const r=O("tensorListId",t,e,n),a=n.getTensorList(r.id),i=O("dtype",t,e,n),o=O("elementShape",t,e,n);return[a.concat(i,o)]}case"TensorListPushBack":{const r=O("tensorListId",t,e,n),a=O("tensor",t,e,n),i=n.getTensorList(r.id);return i.pushBack(a),[i.idTensor]}case"TensorListPopBack":{const r=O("tensorListId",t,e,n),a=O("elementShape",t,e,n),i=O("elementDType",t,e,n);return[n.getTensorList(r.id).popBack(a,i)]}case"TensorListSplit":{const r=O("tensor",t,e,n),a=O("elementShape",t,e,n),i=O("lengths",t,e,n),o=yhe(r,i,a);return n.addTensorList(o),[o.idTensor]}case"TensorListLength":{const r=O("tensorListId",t,e,n),a=n.getTensorList(r.id);return[St(a.size(),"int32")]}case"TensorListResize":{const r=O("tensorListId",t,e,n),a=O("size",t,e,n),i=n.getTensorList(r.id).resize(a);return n.addTensorList(i),[i.idTensor]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function bF(t,e,n){const[r,a]=O("fusedOps",t,e,n),i=r==="biasadd",o=!i,s=a==="prelu",l=r==="fusedbatchnorm",u=O("numArgs",t,e,n);if(i){if(s&&u!==2)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!s&&i&&u!==1)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(l)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported");const c=O("strides",t,e,n),d=t2(t,e,n),p=O("dataFormat",t,e,n).toUpperCase(),f=O("dilations",t,e,n);let[m,y]=O("args",t,e,n);o&&(y=m,m=void 0);const x=O("leakyreluAlpha",t,e,n);return{stride:c,pad:d,dataFormat:p,dilations:f,biasArg:m,preluArg:y,activationFunc:a,leakyreluAlpha:x}}const vhe=(t,e,n,r=Gr)=>{switch(t.op){case"Conv1D":{const a=O("stride",t,e,n),i=O("pad",t,e,n),o=O("dataFormat",t,e,n).toUpperCase(),s=O("dilation",t,e,n);return[r.conv1d(O("x",t,e,n),O("filter",t,e,n),a,i,o,s)]}case"Conv2D":{const a=O("strides",t,e,n),i=t2(t,e,n),o=O("dataFormat",t,e,n).toUpperCase(),s=O("dilations",t,e,n);return[r.conv2d(O("x",t,e,n),O("filter",t,e,n),[a[1],a[2]],i,o,[s[1],s[2]])]}case"_FusedConv2D":{const{stride:a,pad:i,dataFormat:o,dilations:s,biasArg:l,preluArg:u,activationFunc:c,leakyreluAlpha:d}=bF(t,e,n);return[r.fused.conv2d({x:O("x",t,e,n),filter:O("filter",t,e,n),strides:[a[1],a[2]],pad:i,dataFormat:o,dilations:[s[1],s[2]],bias:l,activation:c,preluActivationWeights:u,leakyreluAlpha:d})]}case"FusedDepthwiseConv2dNative":{const{stride:a,pad:i,dataFormat:o,dilations:s,biasArg:l,preluArg:u,activationFunc:c,leakyreluAlpha:d}=bF(t,e,n);return[r.fused.depthwiseConv2d({x:O("x",t,e,n),filter:O("filter",t,e,n),strides:[a[1],a[2]],pad:i,dataFormat:o,dilations:[s[1],s[2]],bias:l,activation:c,preluActivationWeights:u,leakyreluAlpha:d})]}case"Conv2DBackpropInput":case"Conv2dTranspose":{const a=O("outputShape",t,e,n),i=O("strides",t,e,n),o=t2(t,e,n);return[r.conv2dTranspose(O("x",t,e,n),O("filter",t,e,n),a,[i[1],i[2]],o)]}case"DepthwiseConv2dNative":case"DepthwiseConv2d":{const a=O("strides",t,e,n),i=t2(t,e,n),o=O("dilations",t,e,n),s=O("dataFormat",t,e,n).toUpperCase();return[r.depthwiseConv2d(O("input",t,e,n),O("filter",t,e,n),[a[1],a[2]],i,s,[o[1],o[2]])]}case"Conv3D":{const a=O("strides",t,e,n),i=O("pad",t,e,n),o=O("dataFormat",t,e,n).toUpperCase(),s=O("dilations",t,e,n);return[r.conv3d(O("x",t,e,n),O("filter",t,e,n),[a[1],a[2],a[3]],i,o,[s[1],s[2],s[3]])]}case"AvgPool":{const a=O("strides",t,e,n),i=O("pad",t,e,n),o=O("kernelSize",t,e,n);return[r.avgPool(O("x",t,e,n),[o[1],o[2]],[a[1],a[2]],i)]}case"MaxPool":{const a=O("strides",t,e,n),i=O("pad",t,e,n),o=O("kernelSize",t,e,n);return[r.maxPool(O("x",t,e,n),[o[1],o[2]],[a[1],a[2]],i)]}case"MaxPoolWithArgmax":{const a=O("strides",t,e,n),i=O("pad",t,e,n),o=O("kernelSize",t,e,n),s=O("includeBatchInIndex",t,e,n),{result:l,indexes:u}=r.maxPoolWithArgmax(O("x",t,e,n),[o[1],o[2]],[a[1],a[2]],i,s);return[l,u]}case"AvgPool3D":{const a=O("strides",t,e,n),i=O("pad",t,e,n),o=O("kernelSize",t,e,n);return[r.avgPool3d(O("x",t,e,n),[o[1],o[2],o[3]],[a[1],a[2],a[3]],i)]}case"MaxPool3D":{const a=O("strides",t,e,n),i=O("pad",t,e,n),o=O("kernelSize",t,e,n);return[r.maxPool3d(O("x",t,e,n),[o[1],o[2],o[3]],[a[1],a[2],a[3]],i)]}case"Dilation2D":{const a=O("strides",t,e,n),i=O("pad",t,e,n),o=O("dilations",t,e,n),s=a[1],l=a[2],u=o[1],c=o[2];return[r.dilation2d(O("x",t,e,n),O("filter",t,e,n),[s,l],i,[u,c],"NHWC")]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const xhe=(t,e,n,r=Gr)=>{switch(t.op){case"Fill":{const a=O("shape",t,e,n),i=O("dtype",t,e,n),o=O("value",t,e,n);return[r.fill(a,o,i)]}case"LinSpace":{const a=O("start",t,e,n),i=O("stop",t,e,n),o=O("num",t,e,n);return[r.linspace(a,i,o)]}case"Multinomial":{const a=O("logits",t,e,n),i=O("numSamples",t,e,n),o=O("seed",t,e,n);return[r.multinomial(a,i,o)]}case"OneHot":{const a=O("indices",t,e,n),i=O("depth",t,e,n),o=O("onValue",t,e,n),s=O("offValue",t,e,n),l=O("dtype",t,e,n);return[r.oneHot(a,i,o,s,l)]}case"Ones":return[r.ones(O("shape",t,e,n),O("dtype",t,e,n))];case"OnesLike":return[r.onesLike(O("x",t,e,n))];case"RandomStandardNormal":return[r.randomStandardNormal(O("shape",t,e,n),O("dtype",t,e,n),O("seed",t,e,n))];case"RandomUniform":return[r.randomUniform(O("shape",t,e,n),O("minval",t,e,n),O("maxval",t,e,n),O("dtype",t,e,n))];case"Range":{const a=O("start",t,e,n),i=O("stop",t,e,n),o=O("step",t,e,n);return[r.range(a,i,o,O("dtype",t,e,n))]}case"TruncatedNormal":{const a=O("shape",t,e,n),i=O("mean",t,e,n),o=O("stdDev",t,e,n),s=O("seed",t,e,n);return[r.truncatedNormal(a,i,o,O("dtype",t,e,n),s)]}case"Zeros":return[r.zeros(O("shape",t,e,n),O("dtype",t,e,n))];case"ZerosLike":return[r.zerosLike(O("x",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function x4(t,e,n){const r=O("boxes",t,e,n),a=O("scores",t,e,n),i=O("maxOutputSize",t,e,n),o=O("iouThreshold",t,e,n),s=O("scoreThreshold",t,e,n),l=O("softNmsSigma",t,e,n);return{boxes:r,scores:a,maxOutputSize:i,iouThreshold:o,scoreThreshold:s,softNmsSigma:l}}const whe=async(t,e,n,r,a=Gr)=>{switch(t.op){case"NonMaxSuppressionV5":{const{boxes:i,scores:o,maxOutputSize:s,iouThreshold:l,scoreThreshold:u,softNmsSigma:c}=x4(t,e,n),d=await a.image.nonMaxSuppressionWithScoreAsync(i,o,s,l,u,c);return[d.selectedIndices,d.selectedScores]}case"NonMaxSuppressionV4":{const{boxes:i,scores:o,maxOutputSize:s,iouThreshold:l,scoreThreshold:u}=x4(t,e,n),c=O("padToMaxOutputSize",t,e,n),d=await a.image.nonMaxSuppressionPaddedAsync(i,o,s,l,u,c);return[d.selectedIndices,d.validOutputs]}case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":{const{boxes:i,scores:o,maxOutputSize:s,iouThreshold:l,scoreThreshold:u}=x4(t,e,n);return[await a.image.nonMaxSuppressionAsync(i,o,s,l,u)]}case"Where":{const i=a.cast(O("condition",t,e,n),"bool"),o=[await a.whereAsync(i)];return i.dispose(),o}case"ListDiff":return a.setdiff1dAsync(O("x",t,e,n),O("y",t,e,n));default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const khe=(t,e,n,r=Gr)=>{switch(t.op){case"LowerBound":{const a=O("sortedSequence",t,e,n),i=O("values",t,e,n);return[r.lowerBound(a,i)]}case"TopKV2":{const a=O("x",t,e,n),i=O("k",t,e,n),o=O("sorted",t,e,n),s=r.topk(a,i,o);return[s.values,s.indices]}case"UpperBound":{const a=O("sortedSequence",t,e,n),i=O("values",t,e,n);return[r.upperBound(a,i)]}case"Unique":{const a=O("x",t,e,n),i=r.unique(a);return[i.values,i.indices]}case"UniqueV2":{const a=O("x",t,e,n),i=O("axis",t,e,n),o=r.unique(a,i);return[o.values,o.indices]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const She=(t,e,n,r=Gr)=>{switch(t.op){case"Const":return e[t.name];case"PlaceholderWithDefault":const a=O("default",t,e,n);return[la(t.name,e,n)||a];case"Placeholder":return[la(t.name,e,n)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":{const c=O("x",t,e,n);return[As(c)]}case"IdentityN":return O("x",t,e,n).map(c=>As(c));case"Snapshot":const i=O("x",t,e,n);return[As(i)];case"Shape":return[r.tensor1d(O("x",t,e,n).shape,"int32")];case"ShapeN":return O("x",t,e,n).map(c=>r.tensor1d(c.shape));case"Size":return[r.scalar(O("x",t,e,n).size,"int32")];case"Rank":return[r.scalar(O("x",t,e,n).rank,"int32")];case"NoOp":return[r.scalar(1)];case"Print":const o=O("x",t,e,n),s=O("data",t,e,n),l=O("message",t,e,n),u=O("summarize",t,e,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(l);for(let c=0;c<s.length;c++)console.log(Array.prototype.slice.call(s[c].dataSync()).slice(0,u));return[o];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class Che{constructor(e,n){this.keyDType=e,this.valueDType=n,this.handle=St(0),this.tensorMap=new Map,Ao(this.handle)}get id(){return this.handle.id}clearAndClose(){this.tensorMap.forEach(e=>e.dispose()),this.tensorMap.clear(),this.handle.dispose()}size(){return this.tensorMap.size}tensorSize(){return St(this.size(),"int32")}async import(e,n){this.checkKeyAndValueTensor(e,n);const r=await e.data();return this.tensorMap.forEach(a=>a.dispose()),this.tensorMap.clear(),Ot(()=>{const a=jl(n),i=r.length,o=a.length;j(i===o,()=>`The number of elements doesn't match, keys has ${i} elements, the values has ${o} elements.`);for(let s=0;s<i;s++){const l=r[s],u=a[s];Ao(u),this.tensorMap.set(l,u)}return this.handle})}async find(e,n){this.checkKeyAndValueTensor(e,n);const r=await e.data();return Ot(()=>{const a=[];for(let i=0;i<r.length;i++){const o=r[i],s=this.findWithDefault(o,n);a.push(s)}return Fo(a)})}findWithDefault(e,n){return this.tensorMap.get(e)??n}checkKeyAndValueTensor(e,n){if(e.dtype!==this.keyDType)throw new Error(`Expect key dtype ${this.keyDType}, but got ${e.dtype}`);if(n.dtype!==this.valueDType)throw new Error(`Expect value dtype ${this.valueDType}, but got ${n.dtype}`)}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Nhe=async(t,e,n,r)=>{switch(t.op){case"HashTable":case"HashTableV2":{const a=O("keyDType",t,e,n),i=O("valueDType",t,e,n),o=new Che(a,i);return r.addHashTable(t.name,o),[o.handle]}case"LookupTableImport":case"LookupTableImportV2":{const a=O("tableHandle",t,e,n,r),i=O("keys",t,e,n),o=O("values",t,e,n);return[await r.getHashTableById(a.id).import(i,o)]}case"LookupTableFind":case"LookupTableFindV2":{const a=O("tableHandle",t,e,n,r),i=O("keys",t,e,n),o=O("defaultValue",t,e,n);return[await r.getHashTableById(a.id).find(i,o)]}case"LookupTableSize":case"LookupTableSizeV2":{const a=O("tableHandle",t,e,n,r);return[r.getHashTableById(a.id).tensorSize()]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const The=(t,e,n,r=Gr)=>{switch(t.op){case"ResizeBilinear":{const a=O("images",t,e,n),i=O("size",t,e,n),o=O("alignCorners",t,e,n),s=O("halfPixelCenters",t,e,n);return[r.image.resizeBilinear(a,[i[0],i[1]],o,s)]}case"ResizeNearestNeighbor":{const a=O("images",t,e,n),i=O("size",t,e,n),o=O("alignCorners",t,e,n),s=O("halfPixelCenters",t,e,n);return[r.image.resizeNearestNeighbor(a,[i[0],i[1]],o,s)]}case"CropAndResize":{const a=O("image",t,e,n),i=O("boxes",t,e,n),o=O("boxInd",t,e,n),s=O("cropSize",t,e,n),l=O("method",t,e,n),u=O("extrapolationValue",t,e,n);return[r.image.cropAndResize(a,i,o,s,l,u)]}case"ImageProjectiveTransformV3":{const a=O("images",t,e,n),i=O("transforms",t,e,n),o=O("outputShape",t,e,n),s=O("fillValue",t,e,n),l=O("interpolation",t,e,n),u=O("fillMode",t,e,n);return[r.image.transform(a,i,l.toLowerCase(),u.toLowerCase(),s,o)]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Ihe=(t,e,n,r=Gr)=>{switch(t.op){case"Equal":return[r.equal(O("a",t,e,n),O("b",t,e,n))];case"NotEqual":return[r.notEqual(O("a",t,e,n),O("b",t,e,n))];case"Greater":return[r.greater(O("a",t,e,n),O("b",t,e,n))];case"GreaterEqual":return[r.greaterEqual(O("a",t,e,n),O("b",t,e,n))];case"Less":return[r.less(O("a",t,e,n),O("b",t,e,n))];case"LessEqual":return[r.lessEqual(O("a",t,e,n),O("b",t,e,n))];case"LogicalAnd":return[r.logicalAnd(O("a",t,e,n),O("b",t,e,n))];case"LogicalNot":return[r.logicalNot(O("a",t,e,n))];case"LogicalOr":return[r.logicalOr(O("a",t,e,n),O("b",t,e,n))];case"Select":case"SelectV2":return[r.where(O("condition",t,e,n),O("a",t,e,n),O("b",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Ehe=(t,e,n,r=Gr)=>{switch(t.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[r.matMul(O("a",t,e,n),O("b",t,e,n),O("transposeA",t,e,n),O("transposeB",t,e,n))];case"Einsum":return[r.einsum(O("equation",t,e,n),...O("tensors",t,e,n))];case"Transpose":return[r.transpose(O("x",t,e,n),O("perm",t,e,n))];case"_FusedMatMul":const[a,i]=O("fusedOps",t,e,n),o=a==="biasadd",s=i==="prelu",l=O("numArgs",t,e,n),u=O("leakyreluAlpha",t,e,n);if(o){if(s&&l!==2)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!s&&l!==1)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}const[c,d]=O("args",t,e,n);return[r.fused.matMul({a:O("a",t,e,n),b:O("b",t,e,n),transposeA:O("transposeA",t,e,n),transposeB:O("transposeB",t,e,n),bias:c,activation:i,preluActivationWeights:d,leakyreluAlpha:u})];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const _he=(t,e,n,r=Gr)=>{switch(t.op){case"EuclideanNorm":return[r.euclideanNorm(O("x",t,e,n),O("axis",t,e,n),O("keepDims",t,e,n))];case"FusedBatchNorm":case"FusedBatchNormV2":return[r.batchNorm(O("x",t,e,n),O("mean",t,e,n),O("variance",t,e,n),O("offset",t,e,n),O("scale",t,e,n),O("epsilon",t,e,n))];case"FusedBatchNormV3":return[r.batchNorm(O("x",t,e,n),O("mean",t,e,n),O("variance",t,e,n),O("offset",t,e,n),O("scale",t,e,n),O("epsilon",t,e,n))];case"LRN":return[r.localResponseNormalization(O("x",t,e,n),O("radius",t,e,n),O("bias",t,e,n),O("alpha",t,e,n),O("beta",t,e,n))];case"Softmax":return[r.softmax(O("x",t,e,n))];case"LogSoftmax":return[r.logSoftmax(O("x",t,e,n))];case"SparseToDense":return[r.sparseToDense(O("sparseIndices",t,e,n),O("outputShape",t,e,n),O("sparseValues",t,e,n),O("defaultValue",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Ohe=(t,e,n,r=Gr)=>{switch(t.op){case"Max":{const s=O("axis",t,e,n),l=O("keepDims",t,e,n);return[r.max(O("x",t,e,n),s,l)]}case"Mean":{const s=O("axis",t,e,n),l=O("keepDims",t,e,n);return[r.mean(O("x",t,e,n),s,l)]}case"Min":{const s=O("axis",t,e,n),l=O("keepDims",t,e,n);return[r.min(O("x",t,e,n),s,l)]}case"Sum":{const s=O("axis",t,e,n),l=O("keepDims",t,e,n);return[r.sum(O("x",t,e,n),s,l)]}case"All":{const s=O("axis",t,e,n),l=O("keepDims",t,e,n);return[r.all(O("x",t,e,n),s,l)]}case"Any":{const s=O("axis",t,e,n),l=O("keepDims",t,e,n);return[r.any(O("x",t,e,n),s,l)]}case"ArgMax":{const s=O("axis",t,e,n);return[r.argMax(O("x",t,e,n),s)]}case"ArgMin":{const s=O("axis",t,e,n);return[r.argMin(O("x",t,e,n),s)]}case"Prod":{const s=O("axis",t,e,n),l=O("keepDims",t,e,n);return[r.prod(O("x",t,e,n),s,l)]}case"Cumprod":{const s=O("axis",t,e,n),l=O("exclusive",t,e,n),u=O("reverse",t,e,n);return[r.cumprod(O("x",t,e,n),s,l,u)]}case"Cumsum":{const s=O("axis",t,e,n),l=O("exclusive",t,e,n),u=O("reverse",t,e,n);return[r.cumsum(O("x",t,e,n),s,l,u)]}case"Bincount":const a=O("x",t,e,n),i=O("weights",t,e,n),o=O("size",t,e,n);return[r.bincount(a,i,o)];case"DenseBincount":{const s=O("x",t,e,n),l=O("weights",t,e,n),u=O("size",t,e,n),c=O("binaryOutput",t,e,n);return[r.denseBincount(s,l,u,c)]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const $he=(t,e,n,r=Gr)=>{switch(t.op){case"ConcatV2":case"Concat":{const a=O("n",t,e,n),i=O("axis",t,e,n);let o=O("tensors",t,e,n);return o=o.slice(0,a),[r.concat(o,i)]}case"Gather":{const a=O("x",t,e,n),i=O("indices",t,e,n);return[r.gather(a,r.cast(i,"int32"),0)]}case"GatherV2":{const a=O("axis",t,e,n),i=O("batchDims",t,e,n),o=O("x",t,e,n),s=O("indices",t,e,n);return[r.gather(o,r.cast(s,"int32"),a,i)]}case"Reverse":{const a=O("dims",t,e,n),i=[];for(let s=0;s<a.length;s++)a[s]&&i.push(s);const o=O("x",t,e,n);return[r.reverse(o,i)]}case"ReverseV2":{const a=O("axis",t,e,n),i=O("x",t,e,n);return[r.reverse(i,a)]}case"Slice":{const a=O("begin",t,e,n),i=O("size",t,e,n);return[r.slice(O("x",t,e,n),a,i)]}case"StridedSlice":{const a=O("begin",t,e,n),i=O("end",t,e,n),o=O("strides",t,e,n),s=O("beginMask",t,e,n),l=O("endMask",t,e,n),u=O("ellipsisMask",t,e,n),c=O("newAxisMask",t,e,n),d=O("shrinkAxisMask",t,e,n),p=O("x",t,e,n);return[r.stridedSlice(p,a,i,o,s,l,u,c,d)]}case"Pack":return Ot(()=>{const a=O("axis",t,e,n),i=O("tensors",t,e,n),o=i[0].shape,s=r.squeeze(i[0]).shape,l=i.map(u=>{const c=tn(u.shape,o);if(!c&&!tn(r.squeeze(u).shape,s))throw new Error("the input tensors shape does not match");return c?u:r.reshape(u,o)});return[r.stack(l,a)]});case"Unpack":{const a=O("axis",t,e,n),i=O("tensor",t,e,n);return r.unstack(i,a)}case"Tile":{const a=O("reps",t,e,n);return[r.tile(O("x",t,e,n),a)]}case"Split":case"SplitV":{const a=O("axis",t,e,n),i=O("numOrSizeSplits",t,e,n),o=O("x",t,e,n);return r.split(o,i,a)}case"ScatterNd":{const a=O("indices",t,e,n),i=O("values",t,e,n),o=O("shape",t,e,n);return[r.scatterND(a,i,o)]}case"GatherNd":{const a=O("x",t,e,n),i=O("indices",t,e,n);return[r.gatherND(a,i)]}case"SparseToDense":{const a=O("sparseIndices",t,e,n),i=O("outputShape",t,e,n),o=O("sparseValues",t,e,n),s=O("defaultValue",t,e,n);return[r.sparseToDense(a,o,i,o.dtype===s.dtype?s:r.cast(s,o.dtype))]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Rhe=(t,e,n,r=Gr)=>{switch(t.op){case"SparseFillEmptyRows":{const{outputIndices:a,outputValues:i,emptyRowIndicator:o,reverseIndexMap:s}=r.sparse.sparseFillEmptyRows(O("indices",t,e,n),O("values",t,e,n),O("denseShape",t,e,n),O("defaultValue",t,e,n));return[a,i,o,s]}case"SparseReshape":{const{outputIndices:a,outputShape:i}=r.sparse.sparseReshape(O("inputIndices",t,e,n),O("inputShape",t,e,n),O("newShape",t,e,n));return[a,i]}case"SparseSegmentMean":return[r.sparse.sparseSegmentMean(O("data",t,e,n),O("indices",t,e,n),O("segmentIds",t,e,n))];case"SparseSegmentSum":return[r.sparse.sparseSegmentSum(O("data",t,e,n),O("indices",t,e,n),O("segmentIds",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Mhe=(t,e,n,r=Gr)=>{switch(t.op){case"FFT":return[r.fft(O("x",t,e,n))];case"IFFT":return[r.ifft(O("x",t,e,n))];case"RFFT":return[r.rfft(O("x",t,e,n))];case"IRFFT":return[r.irfft(O("x",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Ahe=(t,e,n,r=Gr)=>{switch(t.op){case"StringNGrams":{const{nGrams:a,nGramsSplits:i}=r.string.stringNGrams(O("data",t,e,n),O("dataSplits",t,e,n),O("separator",t,e,n),O("nGramWidths",t,e,n),O("leftPad",t,e,n),O("rightPad",t,e,n),O("padWidth",t,e,n),O("preserveShortSequences",t,e,n));return[a,i]}case"StringSplit":{const{indices:a,values:i,shape:o}=r.string.stringSplit(O("input",t,e,n),O("delimiter",t,e,n),O("skipEmpty",t,e,n));return[a,i,o]}case"StringToHashBucketFast":return[r.string.stringToHashBucketFast(O("input",t,e,n),O("numBuckets",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Phe=(t,e,n,r=Gr)=>{switch(t.op){case"Cast":return[r.cast(O("x",t,e,n),O("dtype",t,e,n))];case"ExpandDims":{const a=O("axis",t,e,n);return[r.expandDims(O("x",t,e,n),a)]}case"Squeeze":{const a=O("axis",t,e,n);return[r.squeeze(O("x",t,e,n),a)]}case"Reshape":return[r.reshape(O("x",t,e,n),O("shape",t,e,n))];case"MirrorPad":return[r.mirrorPad(O("x",t,e,n),O("padding",t,e,n),O("mode",t,e,n))];case"PadV2":case"Pad":return[r.pad(O("x",t,e,n),O("padding",t,e,n),O("constantValue",t,e,n))];case"SpaceToBatchND":{const a=O("blockShape",t,e,n),i=O("paddings",t,e,n);return[r.spaceToBatchND(O("x",t,e,n),a,i)]}case"BatchToSpaceND":{const a=O("blockShape",t,e,n),i=O("crops",t,e,n);return[r.batchToSpaceND(O("x",t,e,n),a,i)]}case"DepthToSpace":{const a=O("blockSize",t,e,n),i=O("dataFormat",t,e,n).toUpperCase();return[r.depthToSpace(O("x",t,e,n),a,i)]}case"BroadcastTo":return[r.broadcastTo(O("x",t,e,n),O("shape",t,e,n))];case"BroadcastArgs":return[r.broadcastArgs(O("s0",t,e,n),O("s1",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function vF(t,e,n,r,a=Ot){const i=((o,s,l)=>{switch(o.category){case"arithmetic":return a(()=>dhe(o,s,l));case"basic_math":return a(()=>phe(o,s,l));case"control":return bhe(o,s,l);case"convolution":return a(()=>vhe(o,s,l));case"creation":return a(()=>xhe(o,s,l));case"dynamic":return whe(o,s,l);case"evaluation":return a(()=>khe(o,s,l));case"image":return a(()=>The(o,s,l));case"graph":return a(()=>She(o,s,l));case"logical":return a(()=>Ihe(o,s,l));case"matrices":return a(()=>Ehe(o,s,l));case"normalization":return a(()=>_he(o,s,l));case"reduction":return a(()=>Ohe(o,s,l));case"slice_join":return a(()=>$he(o,s,l));case"sparse":return a(()=>Rhe(o,s,l));case"spectral":return a(()=>Mhe(o,s,l));case"string":return a(()=>Ahe(o,s,l));case"transformation":return a(()=>Phe(o,s,l));case"hash_table":return Nhe(o,s,l,r);case"custom":const u=pF(o.op);if(u&&u.customExecutor)return u.customExecutor(new che(o,s,l));throw TypeError(`Custom op ${o.op} is not registered.`);default:throw TypeError(`Unknown op '${o.op}'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()`)}})(t,e,n);return Ku(i)?i.then(o=>[].concat(o)):[].concat(i)}class xF{constructor(e={},n={},r={},a={}){this.weightMap=e,this.tensorArrayMap=n,this.tensorListMap=r,this.functionMap=a,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}newFrame(e,n){return{id:e,frameName:n,iterationId:0}}set currentContext(e){this.contexts!==e&&(this.contexts=e,this.generateCurrentContextIds())}get currentContext(){return this.contexts}get currentContextId(){return this._currentContextIds[0]}get currentContextIds(){return this._currentContextIds}generateCurrentContextIds(){const e=[];for(let n=0;n<this.contexts.length-1;n++){const r=this.contexts.slice(0,this.contexts.length-n);e.push(this.contextIdforContexts(r))}e.push(""),this._currentContextIds=e}contextIdforContexts(e){return e?e.map(n=>n.id===0&&n.iterationId===0?"":`${n.frameName}-${n.iterationId}`).join("/"):""}enterFrame(e){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,e)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}exitFrame(){if(this.contexts&&this.contexts.length>1)this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift();else throw new Error("Cannot exit frame, the context is empty")}nextIteration(){if(this.contexts&&this.contexts.length>0){this.contexts=this.contexts.slice(),this.lastId++;const e=Object.assign({},this.contexts[this.contexts.length-1]);e.iterationId+=1,e.id=this.lastId,this.contexts.splice(-1,1,e),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}else throw new Error("Cannot increase frame iteration, the context is empty")}getWeight(e){return this.weightMap[e]}addTensorArray(e){this.tensorArrayMap[e.id]=e}getTensorArray(e){return this.tensorArrayMap[e]}addTensorList(e){this.tensorListMap[e.id]=e}getTensorList(e){return this.tensorListMap[e]}dispose(e){for(const n in this.tensorArrayMap)this.tensorArrayMap[n].clearAndClose(e);for(const n in this.tensorListMap)this.tensorListMap[n].clearAndClose(e)}}/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function wF(t,e,n,r){const a=new Set,i=[];let o=null,s=null;const l=new Set,u=Object.keys(t).map(p=>Wa(p)[0]);let c=[];r!=null&&(c=r.map(p=>Wa(p.name)[0]));const d=[...e];for(;d.length>0;){const p=d.pop();if((kF(p)||zhe(p)||jhe(p))&&o==null&&(o=p,s=o.children.map(f=>f.name).filter(f=>a.has(f))),a.add(p.name),n[p.name]==null&&u.indexOf(p.name)===-1&&c.indexOf(p.name)===-1){if(p.inputs.length===0){i.push(p.name);continue}p.inputs.forEach(f=>{l.has(f.name)||(l.add(f.name),d.push(f))})}}return{inputs:t,outputs:e,usedNodes:a,missingInputs:i,dynamicNode:o,syncInputs:s}}function Lhe(t,e,n){const{usedNodes:r,inputs:a}=n,i=[],o=Object.keys(a).map(c=>Wa(c)[0]).map(c=>t.nodes[c]),s=t.initNodes;o.forEach(c=>{r.has(c.name)&&i.push(c)}),t.weights.forEach(c=>{r.has(c.name)&&i.push(c)}),s?.forEach(c=>{r.has(c.name)&&i.push(c)});const l=new Set,u=[];for(;i.length>0;){const c=i.pop();l.add(c.name),e[c.name]||u.push(c),c.children.forEach(d=>{!l.has(d.name)&&r.has(d.name)&&d.inputs.every(p=>l.has(p.name))&&i.push(d)})}return u}const Dhe=["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"],Fhe=["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"],Bhe=["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"];function kF(t){return Dhe.indexOf(t.op)>=0}function zhe(t){return Fhe.indexOf(t.op)>=0}function jhe(t){return Bhe.indexOf(t.op)>=0}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class X2{constructor(e,n){this.graph=e,this.parent=n,this.compiledMap=new Map,this._weightMap={},this.SEPERATOR=",",this._functions={},this._functionExecutorMap={},this.intermediateTensors={},this.keepTensorForDebug=!1,this._outputs=e.outputs,this._inputs=e.inputs,this._initNodes=e.initNodes,this._signature=e.signature,this._functions=e.functions,e.functions!=null&&Object.keys(e.functions).forEach(r=>{this._functionExecutorMap[r]=new X2(e.functions[r],this)})}get weightIds(){return this.parent?this.parent.weightIds:this._weightIds}get functionExecutorMap(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}get weightMap(){return this.parent?this.parent.weightMap:this._weightMap}set weightMap(e){const n=Object.keys(e).map(r=>e[r].map(a=>a.id));this._weightIds=[].concat(...n),this._weightMap=e}set resourceManager(e){this._resourceManager=e}get inputs(){return this._inputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get outputs(){return this._outputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get inputNodes(){return this._inputs.map(e=>e.signatureKey||e.name)}get outputNodes(){return this._outputs.map(e=>{const n=e.signatureKey||e.name;return e.defaultOutput?`${n}:${e.defaultOutput}`:n})}get functions(){return Object.keys(this._functions).reduce((e,n)=>(e[n]=this._functions[n].signature,e),{})}getCompilationKey(e,n){const r=e.map(i=>i.name).sort(),a=n.map(i=>i.name).sort();return r.join(this.SEPERATOR)+"--"+a.join(this.SEPERATOR)}compile(e,n){const r=wF(e,n,this.weightMap,this._initNodes),{missingInputs:a,dynamicNode:i,syncInputs:o}=r;if(i!=null)throw new Error(`This execution contains the node '${i.name}', which has the dynamic op '${i.op}'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs [${o}]`);if(a.length>0){const s=n.map(u=>u.name),l=Object.keys(e);throw new Error(`Cannot compute the outputs [${s}] from the provided inputs [${l}]. Missing the following inputs: [${a}]`)}return Lhe(this.graph,this.weightMap,r)}execute(e,n){e=this.mapInputs(e);const r=Object.keys(e).sort();this.checkInputs(e),this.checkInputShapeAndType(e),n=this.mapOutputs(n),this.checkOutputs(n);const a=r.map(d=>this.graph.nodes[Wa(d)[0]]),i=n.map(d=>Wa(d)[0]);let o=i.map(d=>this.graph.nodes[d]);this.resetIntermediateTensors(),o.length===0&&(o=this._outputs);const s=this.getCompilationKey(a,o);let l=this.compiledMap.get(s);l==null&&(l=this.compile(e,o),this.compiledMap.set(s,l));const u={},c={};return Ot(()=>{const d=new xF(this.weightMap,u,c,this.functionExecutorMap),p=Object.assign({},this.weightMap);Object.keys(e).forEach(y=>{const[x,b]=Wa(y),v=[];v[b]=e[y],p[x]=v});const f=this.getFrozenTensorIds(p),m={};for(let y=0;y<l.length;y++){const x=l[y];if(!p[x.name]){const b=vF(x,p,d,this._resourceManager);if(Ku(b))throw new Error(`The execution of the op '${x.op}' returned a promise. Please use model.executeAsync() instead.`);p[x.name]=b,this.checkTensorForDisposal(x.name,x,p,d,f,i,m)}}return this.parent==null&&d.dispose(f),n.map(y=>la(y,p,d))})}getFrozenTensorIds(e){const n=[].concat.apply([],Object.keys(e).map(r=>e[r]).map(r=>r.map(a=>a.id)));return new Set(n)}checkTensorForDisposal(e,n,r,a,i,o,s){n.category==="control"||o.indexOf(e)!==-1||(r[e].forEach(l=>{l!=null&&(s[l.id]=(s[l.id]||0)+n.children.length)}),n.inputs.forEach(l=>{if(l.category!=="control"){const u=Cpe(l.name,r,a);u?.forEach(c=>{if(c&&!c.kept&&!i.has(c.id)){const d=s[c.id];if(d===1){if(!this.keepTensorForDebug)c.dispose();else{const[p,f]=zo(n.name,a);this.intermediateTensors[p]?this.intermediateTensors[p][f]=c:(this.intermediateTensors[p]=[],this.intermediateTensors[p][f]=c)}delete s[c.id]}else d!=null&&s[c.id]--}})}}))}async executeAsync(e,n){return this._executeAsync(e,n)}disposeIntermediateTensors(){this.intermediateTensors&&(Object.keys(this.intermediateTensors).forEach(e=>this.intermediateTensors[e].forEach(n=>n.dispose())),this.disposeTensorsMap())}disposeTensorsMap(){this.tensorsMap&&Object.keys(this.tensorsMap).forEach(e=>{this.tensorsMap[e].forEach(n=>{n&&!n.kept&&!n.isDisposed&&!this.keepIds.has(n.id)&&n.dispose()})})}getIntermediateTensors(){return this.tensorsMap}resetIntermediateTensors(){for(const e in this.intermediateTensors)this.intermediateTensors[e].forEach(n=>n.dispose()),delete this.intermediateTensors[e]}async _executeAsync(e,n,r=!1,a={},i={}){r||(e=this.mapInputs(e),this.checkInputs(e),this.checkInputShapeAndType(e),n=this.mapOutputs(n),this.checkOutputs(n));try{this.keepTensorForDebug=ce().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(c){console.warn(c.message)}this.resetIntermediateTensors();const o=new xF(this.weightMap,a,i,this.functionExecutorMap);this.tensorsMap=await this.executeWithControlFlow(e,o,n,r);const s=n.map(c=>la(c,this.tensorsMap,o)),l=s.map(c=>c.id),u=Object.keys(e).map(c=>e[c].id);return this.keepIds=new Set([...l,...u,...this.weightIds]),this.keepTensorForDebug||this.disposeTensorsMap(),this.parent==null&&o.dispose(this.keepIds),s}async executeFunctionAsync(e,n,r){const a=e.reduce((i,o,s)=>(i[this.inputs[s].name]=o,i),{});return this._executeAsync(a,this.outputNodes,!0,n,r)}async executeWithControlFlow(e,n,r,a){const i=Object.keys(e),o=i.map(w=>this.graph.nodes[Wa(w)[0]]),s=r.map(w=>Wa(w)[0]);let l=s.map(w=>this.graph.nodes[w]);l.length===0&&(l=this._outputs);const{usedNodes:u,missingInputs:c,dynamicNode:d,syncInputs:p}=wF(e,l,this.weightMap,this._initNodes),f=[...o,...this.graph.weights,...this._initNodes||[]].map(w=>({node:w,contexts:n.currentContext})),m=Object.assign({},this.weightMap);Object.keys(e).forEach(w=>{const[S,C]=Wa(w),I=[];I[C]=e[w],m[S]=I});const y={},x=this.getFrozenTensorIds(m),b={};for(;f.length>0;){const w=this.processStack(o,f,n,m,b,x,s,y,u);await Promise.all(w)}d==null&&!a&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead.");const v=l.filter(w=>!kF(w)&&!la(w.name,m,n)).map(w=>w.name);if(v.length>0){let w="";throw d!=null&&(w=`Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs [${p}]`),new Error(`Cannot compute the outputs [${v}] from the provided inputs [${i}]. Consider providing the following inputs: [${c}]. ${w}`)}return m}processStack(e,n,r,a,i,o,s,l,u){const c=[];for(;n.length>0;){const d=n.pop();r.currentContext=d.contexts;let p="";if(d.node.op==="Enter"&&O("isConstant",d.node,a,r)&&([p]=zo(d.node.name,r)),a[d.node.name]==null){const f=vF(d.node,a,r,this._resourceManager);p||([p]=zo(d.node.name,r));const m=r.currentContext;Ku(f)?c.push(f.then(y=>(a[p]=y,r.currentContext=m,this.checkTensorForDisposal(p,d.node,a,r,o,s,l),this.processChildNodes(d.node,n,r,a,i,u),y))):(a[p]=f,this.checkTensorForDisposal(p,d.node,a,r,o,s,l),this.processChildNodes(d.node,n,r,a,i,u))}else this.processChildNodes(d.node,n,r,a,i,u)}return c}processChildNodes(e,n,r,a,i,o){e.children.forEach(s=>{const[l]=zo(s.name,r);i[l]||!o.has(s.name)||(s.op==="Merge"?s.inputNames.some(u=>!!la(u,a,r))&&(i[l]=!0,n.push({contexts:r.currentContext,node:s})):s.inputNames.every(u=>!!la(u,a,r))&&(i[l]=!0,n.push({contexts:r.currentContext,node:s})))})}dispose(){Object.keys(this.weightMap).forEach(e=>this.weightMap[e].forEach(n=>n.dispose()))}checkInputShapeAndType(e){Object.keys(e).forEach(n=>{const r=e[n],[a]=Wa(n),i=this.graph.nodes[a];if(i.attrParams.shape&&i.attrParams.shape.value){const o=i.attrParams.shape.value,s=o.length===r.shape.length&&r.shape.every((l,u)=>o[u]===-1||o[u]===l);j(s,()=>`The shape of dict['${i.name}'] provided in model.execute(dict) must be [${o}], but was [${r.shape}]`)}i.attrParams.dtype&&i.attrParams.dtype.value&&j(r.dtype===i.attrParams.dtype.value,()=>`The dtype of dict['${i.name}'] provided in model.execute(dict) must be ${i.attrParams.dtype.value}, but was ${r.dtype}`)})}mapInputs(e){const n={};for(const r in e)if(this._signature!=null&&this._signature.inputs!=null&&this._signature.inputs[r]!=null){const a=this._signature.inputs[r];n[a.name]=e[r]}else n[r]=e[r];return n}checkInputs(e){const n=Object.keys(e).filter(r=>{const[a]=Wa(r);return this.graph.nodes[a]==null});if(n.length>0)throw new Error(`The dict provided in model.execute(dict) has keys: [${n}] that are not part of graph`)}mapOutputs(e){return e.map(n=>this._signature!=null&&this._signature.outputs!=null&&this._signature.outputs[n]!=null?this._signature.outputs[n].name:n,{})}checkOutputs(e){e.forEach(n=>{const[r]=Wa(n);if(!this.graph.nodes[r])throw new Error(`The output '${n}' is not found in the graph`)})}}class Vhe{constructor(e={},n={}){this.hashTableNameToHandle=e,this.hashTableMap=n}addHashTable(e,n){this.hashTableNameToHandle[e]=n.handle,this.hashTableMap[n.id]=n}getHashTableHandleByName(e){return this.hashTableNameToHandle[e]}getHashTableById(e){return this.hashTableMap[e]}dispose(){for(const e in this.hashTableMap)this.hashTableMap[e].clearAndClose(),delete this.hashTableMap[e];for(const e in this.hashTableNameToHandle)this.hashTableNameToHandle[e].dispose(),delete this.hashTableNameToHandle[e]}}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Whe="?tfjs-format=file",Uhe="model.json";class Ghe{constructor(e,n={},r=AT){this.modelUrl=e,this.loadOptions=n,this.version="n/a",this.io=r,n==null&&(this.loadOptions={}),this.resourceManager=new Vhe}get modelVersion(){return this.version}get inputNodes(){return this.executor.inputNodes}get outputNodes(){return this.executor.outputNodes}get inputs(){return this.executor.inputs}get outputs(){return this.executor.outputs}get weights(){return this.executor.weightMap}get metadata(){return this.artifacts.userDefinedMetadata}get modelSignature(){return this.signature}get modelStructuredOutputKeys(){return this.structuredOutputKeys}findIOHandler(){const e=this.modelUrl;if(e.load!=null)this.handler=e;else if(this.loadOptions.requestInit!=null)this.handler=this.io.browserHTTPRequest(e,this.loadOptions);else{const n=this.io.getLoadHandlers(e,this.loadOptions);if(n.length===0)n.push(this.io.browserHTTPRequest(e,this.loadOptions));else if(n.length>1)throw new Error(`Found more than one (${n.length}) load handlers for URL '${[e]}'`);this.handler=n[0]}}load(){if(this.findIOHandler(),this.handler.load==null)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const e=this.handler.load();return Ku(e)?e.then(n=>this.loadSync(n)):this.loadSync(e)}loadSync(e){this.artifacts=e;const n=this.artifacts.modelTopology;let r=this.artifacts.signature;if(this.artifacts.userDefinedMetadata!=null){const i=this.artifacts.userDefinedMetadata;i.signature!=null&&(r=i.signature),i.structuredOutputKeys!=null&&(this.structuredOutputKeys=i.structuredOutputKeys)}this.signature=r,this.version=`${n.versions.producer}.${n.versions.minConsumer}`;const a=this.io.decodeWeights(this.artifacts.weightData,this.artifacts.weightSpecs);if(this.executor=new X2(hF.Instance.transformGraph(n,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(a),this.executor.resourceManager=this.resourceManager,e.modelInitializer!=null&&e.modelInitializer.node!=null){const i=hF.Instance.transformGraph(e.modelInitializer);this.initializer=new X2(i),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializer.executeAsync({},[])}return!0}async save(e,n){if(typeof e=="string"){const r=this.io.getSaveHandlers(e);if(r.length===0)throw new Error(`Cannot find any save handlers for URL '${e}'`);if(r.length>1)throw new Error(`Found more than one (${r.length}) save handlers for URL '${e}'`);e=r[0]}if(e.save==null)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return e.save(this.artifacts)}predict(e,n){const r=this.execute(e,this.outputNodes);if(this.structuredOutputKeys){const a=r instanceof In?[r]:r,i={};return a.forEach((o,s)=>i[this.structuredOutputKeys[s]]=o),i}return r}normalizeInputs(e){if(!(e instanceof In)&&!Array.isArray(e))return e;if(e=Array.isArray(e)?e:[e],e.length!==this.inputNodes.length)throw new Error(`Input tensor count mismatch,the graph model has ${this.inputNodes.length} placeholders, while there are ${e.length} input tensors.`);return this.inputNodes.reduce((n,r,a)=>(n[r]=e[a],n),{})}normalizeOutputs(e){return e=e||this.outputNodes,Array.isArray(e)?e:[e]}execute(e,n){e=this.normalizeInputs(e),n=this.normalizeOutputs(n);const r=this.executor.execute(e,n);return r.length>1?r:r[0]}async executeAsync(e,n){e=this.normalizeInputs(e),n=this.normalizeOutputs(n);const r=await this.executor.executeAsync(e,n);return r.length>1?r:r[0]}getIntermediateTensors(){return this.executor.getIntermediateTensors()}disposeIntermediateTensors(){this.executor.disposeIntermediateTensors()}convertTensorMapToTensorsMap(e){return Object.keys(e).reduce((n,r)=>(n[r]=[e[r]],n),{})}dispose(){this.executor.dispose(),this.initializer&&this.initializer.dispose(),this.resourceManager.dispose()}}async function Hhe(t,e={},n=AT){if(t==null)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");e==null&&(e={}),e.fromTFHub&&typeof t=="string"&&(t=qhe(t));const r=new Ghe(t,e,n);return await r.load(),r}function qhe(t){return t.endsWith("/")||(t=t+"/"),`${t}${Uhe}${Whe}`}/**
* @license
* Copyright 2023 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*//**
* @license
* Copyright 2023 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*//*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function n2(t,e,n,r){return new(n||(n=Promise))(function(a,i){function o(u){try{l(r.next(u))}catch(c){i(c)}}function s(u){try{l(r.throw(u))}catch(c){i(c)}}function l(u){u.done?a(u.value):new n(function(c){c(u.value)}).then(o,s)}l((r=r.apply(t,e||[])).next())})}function r2(t,e){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function s(l){return function(u){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&c[0]?r.return:c[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,c[1])).done)return a;switch(r=0,a&&(c=[2&c[0],a.value]),c[0]){case 0:case 1:a=c;break;case 4:return o.label++,{value:c[1],done:!1};case 5:o.label++,r=c[1],c=[0];continue;case 7:c=o.ops.pop(),o.trys.pop();continue;default:if(a=o.trys,!((a=a.length>0&&a[a.length-1])||c[0]!==6&&c[0]!==2)){o=0;continue}if(c[0]===3&&(!a||c[1]>a[0]&&c[1]<a[3])){o.label=c[1];break}if(c[0]===6&&o.label<a[1]){o.label=a[1],a=c;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(c);break}a[2]&&o.ops.pop(),o.trys.pop();continue}c=e.call(t,o)}catch(d){c=[6,d],r=0}finally{n=a=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([l,u])}}}/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/var Khe="https://tfhub.dev/tensorflow/tfjs-model/deeplab",Xhe=513,w4={ADE20K:[[0,0,0],[120,120,120],[180,120,120],[6,230,230],[80,50,50],[4,200,3],[120,120,80],[140,140,140],[204,5,255],[230,230,230],[4,250,7],[224,5,255],[235,255,7],[150,5,61],[120,120,70],[8,255,51],[255,6,82],[143,255,140],[204,255,4],[255,51,7],[204,70,3],[0,102,200],[61,230,250],[255,6,51],[11,102,255],[255,7,71],[255,9,224],[9,7,230],[220,220,220],[255,9,92],[112,9,255],[8,255,214],[7,255,224],[255,184,6],[10,255,71],[255,41,10],[7,255,255],[224,255,8],[102,8,255],[255,61,6],[255,194,7],[255,122,8],[0,255,20],[255,8,41],[255,5,153],[6,51,255],[235,12,255],[160,150,20],[0,163,255],[140,140,140],[250,10,15],[20,255,0],[31,255,0],[255,31,0],[255,224,0],[153,255,0],[0,0,255],[255,71,0],[0,235,255],[0,173,255],[31,0,255],[11,200,200],[255,82,0],[0,255,245],[0,61,255],[0,255,112],[0,255,133],[255,0,0],[255,163,0],[255,102,0],[194,255,0],[0,143,255],[51,255,0],[0,82,255],[0,255,41],[0,255,173],[10,0,255],[173,255,0],[0,255,153],[255,92,0],[255,0,255],[255,0,245],[255,0,102],[255,173,0],[255,0,20],[255,184,184],[0,31,255],[0,255,61],[0,71,255],[255,0,204],[0,255,194],[0,255,82],[0,10,255],[0,112,255],[51,0,255],[0,194,255],[0,122,255],[0,255,163],[255,153,0],[0,255,10],[255,112,0],[143,255,0],[82,0,255],[163,255,0],[255,235,0],[8,184,170],[133,0,255],[0,255,92],[184,0,255],[255,0,31],[0,184,255],[0,214,255],[255,0,112],[92,255,0],[0,224,255],[112,224,255],[70,184,160],[163,0,255],[153,0,255],[71,255,0],[255,0,163],[255,204,0],[255,0,143],[0,255,235],[133,255,0],[255,0,235],[245,0,255],[255,0,122],[255,245,0],[10,190,212],[214,255,0],[0,204,255],[20,0,255],[255,255,0],[0,153,255],[0,41,255],[0,255,204],[41,0,255],[41,255,0],[173,0,255],[0,245,255],[71,0,255],[122,0,255],[0,255,184],[0,92,255],[184,255,0],[0,133,255],[255,214,0],[25,194,194],[102,255,0],[92,0,255]],CITYSCAPES:[[128,64,128],[244,35,232],[70,70,70],[102,102,156],[190,153,153],[153,153,153],[250,170,30],[220,220,0],[107,142,35],[152,251,152],[70,130,180],[220,20,60],[255,0,0],[0,0,142],[0,0,70],[0,60,100],[0,80,100],[0,0,230],[119,11,32]],PASCAL:[[0,0,0],[128,0,0],[0,128,0],[128,128,0],[0,0,128],[128,0,128],[0,128,128],[128,128,128],[64,0,0],[192,0,0],[64,128,0],[192,128,0],[64,0,128],[192,0,128],[64,128,128],[192,128,128],[0,64,0],[128,64,0],[0,192,0],[128,192,0],[0,64,128],[128,64,128],[0,192,128],[128,192,128],[64,64,0],[192,64,0],[64,192,0],[192,192,0],[64,64,128],[192,64,128],[64,192,128],[192,192,128],[0,0,64],[128,0,64],[0,128,64],[128,128,64],[0,0,192],[128,0,192],[0,128,192],[128,128,192],[64,0,64],[192,0,64],[64,128,64],[192,128,64],[64,0,192],[192,0,192],[64,128,192],[192,128,192],[0,64,64],[128,64,64],[0,192,64],[128,192,64],[0,64,192],[128,64,192],[0,192,192],[128,192,192],[64,64,64],[192,64,64],[64,192,64],[192,192,64],[64,64,192],[192,64,192],[64,192,192],[192,192,192],[32,0,0],[160,0,0],[32,128,0],[160,128,0],[32,0,128],[160,0,128],[32,128,128],[160,128,128],[96,0,0],[224,0,0],[96,128,0],[224,128,0],[96,0,128],[224,0,128],[96,128,128],[224,128,128],[32,64,0],[160,64,0],[32,192,0],[160,192,0],[32,64,128],[160,64,128],[32,192,128],[160,192,128],[96,64,0],[224,64,0],[96,192,0],[224,192,0],[96,64,128],[224,64,128],[96,192,128],[224,192,128],[32,0,64],[160,0,64],[32,128,64],[160,128,64],[32,0,192],[160,0,192],[32,128,192],[160,128,192],[96,0,64],[224,0,64],[96,128,64],[224,128,64],[96,0,192],[224,0,192],[96,128,192],[224,128,192],[32,64,64],[160,64,64],[32,192,64],[160,192,64],[32,64,192],[160,64,192],[32,192,192],[160,192,192],[96,64,64],[224,64,64],[96,192,64],[224,192,64],[96,64,192],[224,64,192],[96,192,192],[224,192,192],[0,32,0],[128,32,0],[0,160,0],[128,160,0],[0,32,128],[128,32,128],[0,160,128],[128,160,128],[64,32,0],[192,32,0],[64,160,0],[192,160,0],[64,32,128],[192,32,128],[64,160,128],[192,160,128],[0,96,0],[128,96,0],[0,224,0],[128,224,0],[0,96,128],[128,96,128],[0,224,128],[128,224,128],[64,96,0],[192,96,0],[64,224,0],[192,224,0],[64,96,128],[192,96,128],[64,224,128],[192,224,128],[0,32,64],[128,32,64],[0,160,64],[128,160,64],[0,32,192],[128,32,192],[0,160,192],[128,160,192],[64,32,64],[192,32,64],[64,160,64],[192,160,64],[64,32,192],[192,32,192],[64,160,192],[192,160,192],[0,96,64],[128,96,64],[0,224,64],[128,224,64],[0,96,192],[128,96,192],[0,224,192],[128,224,192],[64,96,64],[192,96,64],[64,224,64],[192,224,64],[64,96,192],[192,96,192],[64,224,192],[192,224,192],[32,32,0],[160,32,0],[32,160,0],[160,160,0],[32,32,128],[160,32,128],[32,160,128],[160,160,128],[96,32,0],[224,32,0],[96,160,0],[224,160,0],[96,32,128],[224,32,128],[96,160,128],[224,160,128],[32,96,0],[160,96,0],[32,224,0],[160,224,0],[32,96,128],[160,96,128],[32,224,128],[160,224,128],[96,96,0],[224,96,0],[96,224,0],[224,224,0],[96,96,128],[224,96,128],[96,224,128],[224,224,128],[32,32,64],[160,32,64],[32,160,64],[160,160,64],[32,32,192],[160,32,192],[32,160,192],[160,160,192],[96,32,64],[224,32,64],[96,160,64],[224,160,64],[96,32,192],[224,32,192],[96,160,192],[224,160,192],[32,96,64],[160,96,64],[32,224,64],[160,224,64],[32,96,192],[160,96,192],[32,224,192],[160,224,192],[96,96,64],[224,96,64],[96,224,64],[224,224,64],[96,96,192],[224,96,192],[96,224,192],[224,224,192]]},k4={PASCAL:["background","aeroplane","bicycle","bird","boat","bottle","bus","car","cat","chair","cow","dining table","dog","horse","motorbike","person","potted plant","sheep","sofa","train","TV"],CITYSCAPES:["road","sidewalk","building","wall","fence","pole","traffic light","traffic sign","vegetation","terrain","sky","person","rider","car","truck","bus","train","motorcycle","bicycle"],ADE20K:["background","wall","building","sky","floor","tree","ceiling","road","bed","windowpane","grass","cabinet","sidewalk","person","earth","door","table","mountain","plant","curtain","chair","car","water","painting","sofa","shelf","house","sea","mirror","rug","field","armchair","seat","fence","desk","rock","wardrobe","lamp","bathtub","railing","cushion","base","box","column","signboard","chest","counter","sand","sink","skyscraper","fireplace","refrigerator","grandstand","path","stairs","runway","case","pool","pillow","screen","stairway","river","bridge","bookcase","blind","coffee","toilet","flower","book","hill","bench","countertop","stove","palm","kitchen","computer","swivel","boat","bar","arcade","hovel","bus","towel","light","truck","tower","chandelier","awning","streetlight","booth","television","airplane","dirt","apparel","pole","land","bannister","escalator","ottoman","bottle","buffet","poster","stage","van","ship","fountain","conveyer","canopy","washer","plaything","swimming","stool","barrel","basket","waterfall","tent","bag","minibike","cradle","oven","ball","food","step","tank","trade","microwave","pot","animal","bicycle","lake","dishwasher","screen","blanket","sculpture","hood","sconce","vase","traffic","tray","ashcan","fan","pier","screen","plate","monitor","bulletin","shower","radiator","glass","clock","flag"]};/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Yhe(t,e){return""+Khe+"/"+(e===4?t+"/1/default/1/model.json":t+"/1/quantized/"+e+"/1/model.json")+"?tfjs-format=file"}function Qhe(t){if(t==="pascal")return w4.PASCAL;if(t==="ade20k")return w4.ADE20K;if(t==="cityscapes")return w4.CITYSCAPES;throw new Error("SemanticSegmentation cannot be constructed with an invalid base model "+t+". Try one of 'pascal', 'cityscapes' and 'ade20k'.")}function Zhe(t){if(t==="pascal")return k4.PASCAL;if(t==="ade20k")return k4.ADE20K;if(t==="cityscapes")return k4.CITYSCAPES;throw new Error("SemanticSegmentation cannot be constructed with an invalid base model "+t+". Try one of 'pascal', 'cityscapes' and 'ade20k'.")}function Jhe(t,e,n,r){return n2(this,void 0,void 0,function(){var a,i,o,s,l,u,c,d,p,f,m,y,x,b;return r2(this,function(v){switch(v.label){case 0:if(t.length<e.length)throw new Error("The colormap must be expansive enough to encode each label. Aborting, since the given colormap has length "+t.length+", but there are "+e.length+" labels.");return a=n.shape,i=a[0],o=a[1],s=pt([i,o,3],"int32"),[4,n.array()];case 1:for(l=v.sent(),u=new Set,c=0;c<i;++c)for(d=0;d<o;++d)b=l[c][d],u.add(b),s.set(t[b][0],c,d,0),s.set(t[b][1],c,d,1),s.set(t[b][2],c,d,2);return p=s.toTensor(),[4,i8(p,r)];case 2:for(f=v.sent(),Vr(p),m={},y=0,x=Array.from(u);y<x.length;y++)b=x[y],m[e[b]]=t[b];return[2,{legend:m,segmentationMap:f}]}})})}/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function efe(t){return t===void 0&&(t={base:"pascal",quantizationBytes:2}),n2(this,void 0,void 0,function(){var e;return r2(this,function(n){switch(n.label){case 0:if(wpe==null)throw new Error("Cannot find TensorFlow.js. If you are using a <script> tag, please also include @tensorflow/tfjs on the page before using this model.");if(t.base){if(["pascal","cityscapes","ade20k"].indexOf(t.base)===-1)throw new Error("SemanticSegmentation cannot be constructed with an invalid base model "+t.base+". Try one of 'pascal', 'cityscapes' and 'ade20k'.");if([1,2,4].indexOf(t.quantizationBytes)===-1)throw new Error("Only quantization to 1, 2 or 4 bytes is supported.")}else if(!t.modelUrl)throw new Error("SemanticSegmentation can be constructed either by passing the weights URL or one of the supported base model names from 'pascal', 'cityscapes' and 'ade20k',together with the degree of quantization (either 1, 2 or 4).Aborting, since neither has been provided.");return[4,Hhe(t.modelUrl||Yhe(t.base,t.quantizationBytes))];case 1:return e=n.sent(),[2,new tfe(e,t.base)]}})})}var tfe=function(){function t(e,n){this.model=e,this.base=n}return t.prototype.predict=function(e){var n=this;return Ot(function(){var r=wn(function(a){return Ot(function(){var i=a instanceof In?a:o8(a),o=i.shape,s=o[0],l=o[1],u=Xhe/Math.max(l,s),c=Math.round(s*u),d=Math.round(l*u);return $s(FI.resizeBilinear(i,[c,d]))})}(e),"int32");return Kg(n.model.execute(r))})},t.prototype.segment=function(e,n){return n===void 0&&(n={}),n2(this,void 0,void 0,function(){var r,a,i,o,s,l,u,c,d,p,f=this;return r2(this,function(m){switch(m.label){case 0:if(!(n.colormap&&n.labels||this.base))throw new Error("Calling the 'segment' method requires either the 'base' attribute to be defined (e.g. 'pascal', 'cityscapes' or'ade20k'), or 'colormap' and 'labels' options to be set. Aborting, since neither has been provided.");return n.colormap&&n.labels||(n.colormap=Qhe(this.base),n.labels=Zhe(this.base)),r=n.colormap,a=n.labels,i=n.canvas,o=Ot(function(){return f.predict(e)}),s=o.shape,l=s[0],u=s[1],[4,Jhe(r,a,o,i)];case 1:return c=m.sent(),d=c.legend,p=c.segmentationMap,Vr(o),[2,{legend:d,height:l,width:u,segmentationMap:p}]}})})},t.prototype.dispose=function(){return n2(this,void 0,void 0,function(){return r2(this,function(e){return this.model&&this.model.dispose(),[2]})})},t}();/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function ze(t,e){Array.isArray(t)||(t=[t]),t.forEach(n=>{n!=null&&j(n.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the CPU backend.`)})}/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const nfe=Fx;class Y2 extends Cb{constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new D3(this,Es())}nextDataId(){return Y2.nextDataId++}write(e,n,r){this.firstUse&&(this.firstUse=!1,ce().get("IS_NODE")&&ai(`
============================
Hi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. 
============================`));const a={id:this.nextDataId()};return this.data.set(a,{values:e,dtype:r,refCount:1}),a}makeTensorInfo(e,n,r){let a;if(n==="string"&&r!=null&&r.length>0&&$o(r[0])){const i=r.map(o=>Ro(o));a=this.write(i,e,n)}else a=this.write(r,e,n);return{dataId:a,shape:e,dtype:n}}refCount(e){return this.data.has(e)?this.data.get(e).refCount:0}incRef(e){const n=this.data.get(e);n.refCount++}decRef(e){if(this.data.has(e)){const n=this.data.get(e);n.refCount--}}move(e,n,r,a,i){this.data.set(e,{values:n,dtype:a,refCount:i})}numDataIds(){return this.data.numDataIds()}async read(e){return this.readSync(e)}readSync(e){const{dtype:n,complexTensorInfos:r}=this.data.get(e);if(n==="complex64"){const a=this.readSync(r.real.dataId),i=this.readSync(r.imag.dataId);return Ms(a,i)}return this.data.get(e).values}bufferSync(e){const n=this.readSync(e.dataId);if(e.dtype==="string")try{const r=n.map(a=>Cs(a));return pt(e.shape,e.dtype,r)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return pt(e.shape,e.dtype,n)}makeOutput(e,n,r){return Es().makeTensorFromTensorInfo(this.makeTensorInfo(n,r,e),this)}disposeData(e,n=!1){if(this.data.has(e)){if(this.data.get(e).refCount--,!n&&this.data.get(e).refCount>0)return!1;const{complexTensorInfos:r}=this.data.get(e);r!=null&&(this.disposeData(r.real.dataId,!0),this.disposeData(r.imag.dataId,!0)),this.data.delete(e)}return!0}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}async time(e){const n=Ba();return e(),{kernelMs:Ba()-n}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(e){ze([e],"where");const n=this.readSync(e.dataId);return nfe(e.shape,n)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}Y2.nextDataId=0;/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function SF(t){const e=new Float32Array(t.length);for(let n=0;n<t.length;++n)e[n]=Math.abs(t[n]);return e}const rfe=t=>{const{x:e}=t.inputs,n=t.backend;ze(e,"abs");let r=new Float32Array(me(e.shape));const a=n.data.get(e.dataId).values;return r=SF(a),n.makeOutput(r,e.shape,e.dtype)},afe={kernelName:Ob,backendName:"cpu",kernelFunc:rfe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Yn(t){return(e,n,r,a,i)=>{const o=Nt(e,n),s=o.length,l=qe(o),u=me(o),c=nr(i,u),d=e.length,p=n.length,f=qe(e),m=qe(n),y=nc(e,o),x=nc(n,o);if(y.length+x.length===0)for(let b=0;b<c.length;++b)c[b]=t(r[b%r.length],a[b%a.length]);else for(let b=0;b<c.length;++b){const v=qu(b,s,l),w=v.slice(-d);y.forEach(_=>w[_]=0);const S=oo(w,d,f),C=v.slice(-p);x.forEach(_=>C[_]=0);const I=oo(C,p,m);c[b]=t(r[S],a[I])}return[c,o]}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Ua(t){const{inputs:e,backend:n}=t,{real:r,imag:a}=e,i=n.data.get(r.dataId).values,o=n.data.get(a.dataId).values,s=n.makeTensorInfo(r.shape,"complex64"),l=n.data.get(s.dataId);return l.complexTensorInfos={real:n.makeTensorInfo(r.shape,"float32",i),imag:n.makeTensorInfo(a.shape,"float32",o)},s}const ife={kernelName:Vb,backendName:"cpu",kernelFunc:Ua};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function a2(t,e,n="float32"){if(n==="complex64"){const a=a2(t,e,"float32"),i=a2(t,e,"float32");return Ua({inputs:{real:a,imag:i},backend:t})}const r=Nr(me(e),n);return t.makeTensorInfo(e,n,r)}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function jo(t){const{inputs:e,backend:n}=t,{x:r}=e;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const ofe={kernelName:Wf,backendName:"cpu",kernelFunc:jo};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function cc(t){const{inputs:e,backend:n}=t,{input:r}=e,a=n.data.get(r.dataId).complexTensorInfos.real,i=n.data.get(a.dataId).values;return n.makeTensorInfo(a.shape,a.dtype,i)}const sfe={kernelName:zv,backendName:"cpu",kernelFunc:cc};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function CF(t,e,n,r){if(r==="int32"){const a=Int32Array.from(t);return[e,"int32",a]}if(r==="bool"){const a=Rl([0],n),[i,o]=Yn((s,l)=>s!==l?1:0)(e,[],t,a,"bool");return[o,"bool",i]}throw new Error(`Error in Cast: failed to cast ${n} to ${r}`)}function Ul(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{dtype:i}=r;if(i==="complex64"){if(a.dtype==="complex64")return jo({inputs:{x:a},backend:n});const c=a2(n,a.shape,a.dtype),d=Ul({inputs:{x:a},backend:n,attrs:{dtype:"float32"}}),p=Ua({inputs:{real:d,imag:c},backend:n});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(d),p}if(a.dtype==="complex64"){const c=cc({inputs:{input:a},backend:n}),d=Ul({inputs:{x:c},backend:n,attrs:{dtype:i}});return n.disposeIntermediateTensorInfo(c),d}if(!z3(a.dtype,i)){const c=jo({inputs:{x:a},backend:n});return{dataId:c.dataId,shape:c.shape,dtype:i}}const o=n.data.get(a.dataId).values,[s,l,u]=CF(o,a.shape,a.dtype,i);return n.makeTensorInfo(s,l,u)}const lfe={kernelName:Ef,backendName:"cpu",kernelFunc:Ul};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function gr(t,e,n,r){return n==null?({inputs:a,backend:i})=>{const{a:o,b:s}=a,l=i;ze([o,s],t);const u=l.data.get(o.dataId).values,c=l.data.get(s.dataId).values,d=o.dtype==="string"?uc(u):u,p=o.dtype==="string"?uc(c):c,f=r||o.dtype,[m,y]=e(o.shape,s.shape,d,p,f);return l.makeTensorInfo(y,f,m)}:({inputs:a,backend:i})=>{const{a:o,b:s}=a,l=i;if(o.dtype==="complex64"||s.dtype==="complex64"){const u=Ul({inputs:{x:o},backend:l,attrs:{dtype:"complex64"}}),c=l.data.get(u.dataId),d=c.complexTensorInfos.real,p=c.complexTensorInfos.imag,f=l.data.get(d.dataId).values,m=l.data.get(p.dataId).values,y=Ul({inputs:{x:s},backend:l,attrs:{dtype:"complex64"}}),x=l.data.get(y.dataId),b=x.complexTensorInfos.real,v=x.complexTensorInfos.imag,w=l.data.get(b.dataId).values,S=l.data.get(v.dataId).values,[C,I,_]=n(o.shape,s.shape,f,m,w,S),E=l.makeTensorInfo(_,"float32",C),P=l.makeTensorInfo(_,"float32",I),A=Ua({inputs:{real:E,imag:P},backend:l});return l.disposeIntermediateTensorInfo(u),l.disposeIntermediateTensorInfo(y),l.disposeIntermediateTensorInfo(E),l.disposeIntermediateTensorInfo(P),A}else{const u=l.data.get(o.dataId).values,c=l.data.get(s.dataId).values,d=r||o.dtype,[p,f]=e(o.shape,s.shape,u,c,d);return l.makeTensorInfo(f,d,p)}}}function S4(t){return(e,n,r,a,i,o)=>{const s=Nt(e,n),l=me(s),u=s.length,c=qe(s),d=nr("float32",l),p=nr("float32",l),f=nc(e,s),m=nc(n,s),y=Ms(r,a),x=Ms(i,o),b=e.length,v=qe(e),w=n.length,S=qe(n);if(f.length+m.length===0)for(let C=0;C<d.length;C++){const I=C%y.length,_=C%x.length,E=t(y[I*2],y[I*2+1],x[_*2],x[_*2+1]);d[C]=E.real,p[C]=E.imag}else for(let C=0;C<d.length;C++){const I=qu(C,u,c),_=I.slice(-b);f.forEach(V=>_[V]=0);const E=oo(_,b,v),P=I.slice(-w);m.forEach(V=>P[V]=0);const A=oo(P,w,S),D=t(y[E*2],y[E*2+1],x[A*2],x[A*2+1]);d[C]=D.real,p[C]=D.imag}return[d,p,s]}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const NF=Yn((t,e)=>t+e),ufe=S4((t,e,n,r)=>({real:t+n,imag:e+r})),up=gr(Vd,NF,ufe),cfe={kernelName:Vd,backendName:"cpu",kernelFunc:up};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function C4(t,e,n,r,a){const i=me(r),o=Nr(a,n);for(let s=0;s<t.length;s++){const l=t[s];if(l<0)throw new Error("Input x must be non-negative!");l>=a||(i>0?o[l]+=e[s]:o[l]+=1)}return o}function TF(t,e,n,r=!1){const a=t.shape[0],i=t.shape[1],o=pt([a,n],e.dtype);for(let s=0;s<a;s++)for(let l=0;l<i;l++){const u=t.get(s,l);if(u<0)throw new Error("Input x must be non-negative!");u>=n||(r?o.set(1,s,u):e.size>0?o.set(o.get(s,u)+e.get(s,l),s,u):o.set(o.get(s,u)+1,s,u))}return o}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Gl(t){return(e,n,r)=>{const a=nr(n,e.length);for(let i=0;i<e.length;++i)a[i]=t(e[i],r);return a}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Kt(t,e,n){return({inputs:r,attrs:a,backend:i})=>{const{x:o}=r;if(ze(o,t),o.dtype==="string"||n==="string")throw new Error("unaryKernelFunc does not support string input/output");const s=i,l=s.data.get(o.dataId).values,u=me(o.shape),c=n||o.dtype,d=rr(c,u);for(let p=0;p<u;++p)d[p]=e(l[p],a);return s.makeTensorInfo(o.shape,c,d)}}function cp(t,e,n){return({inputs:r,attrs:a,backend:i})=>{const{x:o}=r;if(ze(o,t),o.dtype==="string"||n==="string")throw new Error("unaryKernelFunc does not support string input/output");const s=i,l=s.data.get(o.dataId).values,u=n||o.dtype,c=e(l,u,a);return s.makeTensorInfo(o.shape,u,c)}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const IF=Gl(t=>Math.ceil(t)),dfe=cp(_f,IF),pfe={kernelName:_f,backendName:"cpu",kernelFunc:dfe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function EF(t,e,n,r){const a=rr(n,me(e));if(r&&n!=="string"){let i=0;t.forEach(o=>{const s=me(o.shape);a.set(o.vals,i),i+=s})}else{let i=0;t.forEach(o=>{const s=n==="string"?uc(o.vals):o.vals;let l=0;for(let u=0;u<o.shape[0];++u){const c=u*e[1]+i;for(let d=0;d<o.shape[1];++d)a[c+d]=s[l++]}i+=o.shape[1]})}return a}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const _F=Yn((t,e)=>t===e?1:0),OF=gr(Lf,_F,null,"bool"),hfe={kernelName:Lf,backendName:"cpu",kernelFunc:OF};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const $F=Gl(t=>Math.exp(t)),RF=cp(Df,$F,"float32"),ffe={kernelName:Df,backendName:"cpu",kernelFunc:RF};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const MF=Gl(t=>Math.expm1(t)),gfe=cp(Ff,MF),mfe={kernelName:Ff,backendName:"cpu",kernelFunc:gfe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const AF=Gl(t=>Math.floor(t)),yfe=cp(Bf,AF),bfe={kernelName:Bf,backendName:"cpu",kernelFunc:yfe};/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function PF(t,e,n,r,a,i,o,s,l){const u=pt([r,i],n);for(let c=0;c<r;c++){const d=[];let p=0;for(let f=0;f<a;f++){const m=t[c*a+f];p+=m*o[f],d.push(m)}if(p<0||p>=l/i)throw new Error(`Invalid indices: ${d} does not index into ${s}`);for(let f=0;f<i;f++)u.values[c*i+f]=e.get(...e.indexToLoc(p*i+f))}return u}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function LF(t,e,n){const r=pt(n,t.dtype);for(let a=0;a<r.size;++a){const i=r.indexToLoc(a).slice(),o=i[0],s=i[2],l=e.locToIndex([o,s]);i[2]=e.values[l];const u=t.locToIndex(i);0<=u&&u<t.values.length&&(r.values[a]=t.values[u])}return r}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const DF=Yn((t,e)=>t>e?1:0),vfe=gr(jf,DF,null,"bool"),xfe={kernelName:jf,backendName:"cpu",kernelFunc:vfe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const FF=Yn((t,e)=>t>=e?1:0),wfe=gr(Vf,FF,null,"bool"),kfe={kernelName:Vf,backendName:"cpu",kernelFunc:wfe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const BF=Yn((t,e)=>t<e?1:0),Sfe=gr(qf,BF,null,"bool"),Cfe={kernelName:qf,backendName:"cpu",kernelFunc:Sfe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const zF=Yn((t,e)=>t<=e?1:0),Nfe=gr(Kf,zF,null,"bool"),Tfe={kernelName:Kf,backendName:"cpu",kernelFunc:Nfe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function jF(t,e,n){const r=(e-t)/(n-1),a=Nr(n,"float32");a[0]=t;for(let i=1;i<a.length;i++)a[i]=a[i-1]+r;return a}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const VF=Gl(t=>Math.log(t)),Ife=cp(Xf,VF),Efe={kernelName:Xf,backendName:"cpu",kernelFunc:Ife};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function WF(t,e,n,r){const a=nr(r,me(n));for(let i=0;i<a.length;++i){const o=i*e;let s=t[o];for(let l=0;l<e;++l){const u=t[o+l];(Number.isNaN(u)||u>s)&&(s=u)}a[i]=s}return a}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const UF=Yn((t,e)=>Math.max(t,e)),_fe=gr(eg,UF),Ofe={kernelName:eg,backendName:"cpu",kernelFunc:_fe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const GF=Yn((t,e)=>Math.min(t,e)),$fe=gr(tg,GF),Rfe={kernelName:tg,backendName:"cpu",kernelFunc:$fe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const N4=Yn((t,e)=>t*e),Mfe=S4((t,e,n,r)=>({real:t*n-e*r,imag:t*r+e*n})),i2=gr(rg,N4,Mfe),Afe={kernelName:rg,backendName:"cpu",kernelFunc:i2};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function HF(t,e,n){const r=Ss(-1,n);return N4([],e,r,t,n)}function Pfe(t){const{inputs:e,backend:n}=t,{x:r}=e;ze(r,"neg");const a=n.data.get(r.dataId).values,[i,o]=HF(a,r.shape,r.dtype);return n.makeTensorInfo(o,r.dtype,i)}const Lfe={kernelName:Iv,backendName:"cpu",kernelFunc:Pfe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const qF=Yn((t,e)=>t!==e?1:0),Dfe=gr(ag,qF,null,"bool"),Ffe={kernelName:ag,backendName:"cpu",kernelFunc:Dfe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function T4(t,e,n,r,a){const i=e.length,o=me(e),s=qe(e),l=qe(a),u=nr(n,me(a));for(let c=0;c<o;++c){const d=qu(c,i,s),p=new Array(d.length);for(let m=0;m<p.length;m++)p[m]=d[r[m]];const f=oo(p,i,l);u[f]=t[c]}return u}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Ca(t){const{inputs:e,attrs:n,backend:r}=t,{x:a}=e,{perm:i}=n;ze(a,"transpose");const o=a.shape.length,s=new Array(o);for(let c=0;c<s.length;c++)s[c]=a.shape[i[c]];const l=r.data.get(a.dataId).values,u=T4(l,a.shape,a.dtype,i,s);return{dataId:r.write(u,s,a.dtype),shape:s,dtype:a.dtype}}const Bfe={kernelName:Wd,backendName:"cpu",kernelFunc:Ca};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function KF(t,e,n,r){const[a,i]=Tr(t,r),o=Sa(e,"int32"),s=Nr(me(a),o),l=me(i);for(let u=0;u<s.length;++u){const c=u*l;let d=1;for(let p=0;p<l;++p)d*=n[c+p];s[u]=d}return{outVals:s,outShape:a,outDtype:o}}function zfe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:i,keepDims:o}=r;ze(a,"prod");const s=a.shape.length,l=Pt(i,a.shape),u=Un(l,s);let c=l,d=a;const p=[];u!=null&&(d=Ca({inputs:{x:a},backend:n,attrs:{perm:u}}),p.push(d),c=Gn(c.length,s));const f=n.data.get(d.dataId).values,{outVals:m,outShape:y,outDtype:x}=KF(d.shape,d.dtype,f,c);let b=y;return o&&(b=ir(y,l)),p.forEach(v=>n.disposeIntermediateTensorInfo(v)),n.makeTensorInfo(b,x,m)}const jfe={kernelName:Lv,backendName:"cpu",kernelFunc:zfe};/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Vfe(t,e,n){t.forEach((r,a)=>{if(r<0||r>=n){const i=qu(a,e.length,qe(e)).join(",");throw new Error(`indices[${i}] = ${r} is not in [0, ${n})`)}})}function Wfe(t,e){for(let n=0;n<t.length;++n){const r=t[n],a=n===t.length-1?e:t[n+1].length;if(r.length===0)throw new Error("Ragged splits may not be empty");if(r[0]<0)throw new Error("Ragged splits must be non-negative");if(r[r.length-1]>a)throw new Error("Ragged splits must not point past values");for(let i=1;i<r.length;++i)if(r[i-1]>r[i])throw new Error("Ragged splits must be sorted in ascending order")}}function Ufe(t,e,n,r){const a=[];let i=0;const o=e.length-1+n.length,s=new Array(o).fill(null).map(()=>[0]);Wfe(n,r);let l=1;for(let u=0;u<e.length-1;++u){l*=e[u];const c=e[u+1];for(let d=1;d<l+1;++d)s[u].push(d*c)}for(let u=0;u<t.length;++u){let c=t[u],d=t[u]+1;for(let p=0;p<n.length;++p){const f=n[p],m=p+e.length-1;if(m>=0){const y=s[m],x=y[y.length-1]-f[c];for(let b=c;b<d;++b)s[m].push(f[b+1]+x)}c=f[c],d=f[d]}d!==c&&(a.push([c,d]),i+=d-c)}return{outSplits:s,valueSlices:a,numValues:i}}function Gfe(t){const e=[];for(let n=0;n<t.length;++n){const r=t[n].length,a=rr("int32",r);e.push(a),t[n].forEach((i,o)=>a[o]=i)}return e}function XF(t,e){const n=t.slice(0,e);for(;n.length<e;)n.push(1);for(let r=e;r<t.length;r++)n[e-1]*=t[r];return n}function Hfe(t,e,n,r,a,i){const o=XF(e,2)[1],s=XF(i,2)[1];let l=0;for(const u of n)for(let c=u[0];c<u[1];++c){for(let d=0;d<r;++d)a[l*s+d]=t[c*o+d];++l}}function qfe(t,e,n,r,a){const i=e.slice();i[0]=a;const o=rr(n,me(i)),s=t.length,l=s===0?0:s/e[0];return Hfe(t,e,r,l,o,i),[o,i]}function YF(t,e,n,r,a,i,o,s){if(t.length===0)throw new Error("paramsNestedSplits must be non empty");if(e[0].length===0)throw new Error("Split tensors must not be scalars");const l=e[0][0]-1;if(Vfe(i,o,l),r.length===0)throw new Error("params.rank must be nonzero");const u=r[0],{outSplits:c,valueSlices:d,numValues:p}=Ufe(i,o,t,u),f=Gfe(c),m=qfe(n,r,a,d,p);return[f,m[0],m[1]]}/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/var Ai=co;class Q2{constructor(e,n,r,a,i,o,s,l,u,c){this.shape=e,this.shapeShape=n,this.values=r,this.valuesShape=a,this.valuesDType=i,this.defaultValue=o,this.defaultValueShape=s,this.rowPartitionValues=l,this.rowPartitionValuesShapes=u,this.rowPartitionTypes=BD(c),this.raggedRank=zD(this.rowPartitionTypes)}getRowPartitionTypeByDimension(e){return this.rowPartitionTypes[0]===Ai.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}getRowPartitionTensor(e){return this.rowPartitionTypes[0]===Ai.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}getMaxWidth(e){const n=this.getRowPartitionTensor(e-1);switch(this.getRowPartitionTypeByDimension(e-1)){case Ai.VALUE_ROWIDS:return Q2.getMaxWidthValueRowID(n);case Ai.ROW_SPLITS:return Q2.getMaxWidthRowSplit(n);default:throw new Error(`Cannot handle partition type ${Ai[this.getRowPartitionTypeByDimension(e-1)]}`)}}static getMaxWidthRowSplit(e){const n=e.length;if(n===0||n===1)return 0;let r=0;for(let a=0;a<n-1;++a){const i=e[a+1]-e[a];i>r&&(r=i)}return r}static getMaxWidthValueRowID(e){const n=e.length;if(n===0)return 0;let r=0,a=e[0],i=0;for(let o=1;o<n;++o){const s=e[o];s!==a&&(a=s,i=Math.max(o-r,i),r=o)}return Math.max(n-r,i)}tensorShapeFromTensor(e,n,r=!0){if(n.length===0){if(e[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return ZF(e,r)}calculateOutputSize(e){const n=this.valuesShape,r=this.defaultValueShape;jD(r,n);const a=this.tensorShapeFromTensor(this.shape,this.shapeShape),i=FD(this.raggedRank,a,n);i[0]<0&&(i[0]=e);for(let o=1;o<=this.raggedRank;++o)i[o]<0&&(i[o]=this.getMaxWidth(o));return i}calculateFirstParentOutputIndex(e,n,r){const a=Math.min(e,r),i=[];let o=0;for(let s=0;s<a;++s,o+=n)i.push(o);for(let s=a;s<e;++s)i.push(-1);return j(i.length===e,()=>"Final length of result must be equal to firstDimension."),i}calculateOutputIndexRowSplit(e,n,r,a){const i=e.length,o=[];for(let s=0;s<i-1;++s){const l=e[s+1]-e[s];let u=Math.min(a,l),c=n[s];c===-1&&(u=0);for(let d=0;d<u;++d)o.push(c),c+=r;for(let d=0;d<l-u;++d)o.push(-1)}if(i>0&&o.length!==e[i-1])throw new Error("Invalid row split size.");return o}calculateOutputIndexValueRowID(e,n,r,a){const i=e.length,o=[];if(i===0)return[];let s=0,l=e[0];if(l>=n.length)throw new Error(`Got currentValueRowId=${l}, which is not less than ${n.length}`);let u=n[l];o.push(u);for(let c=1;c<i;++c){const d=e[c];if(d===l)u>=0&&(++s,s<a?u+=r:u=-1);else{if(s=0,l=d,d>=n.length)throw new Error(`Got nextValueRowId=${d} which is not less than ${n.length}`);u=n[d]}o.push(u)}if(o.length!==e.length)throw new Error("Invalid row ids.");return o}calculateOutputIndex(e,n,r,a){const i=this.getRowPartitionTensor(e),o=this.getRowPartitionTypeByDimension(e);switch(o){case Ai.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(i,n,r,a);case Ai.ROW_SPLITS:if(i.length-1>n.length)throw new Error(`Row partition size is greater than output size: ${i.length-1} > ${n.length}`);return this.calculateOutputIndexRowSplit(i,n,r,a);default:throw new Error(`Unsupported partition type: ${Ai[o]}`)}}getFirstDimensionSize(){const e=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");const n=this.rowPartitionTypes[0];switch(n){case Ai.FIRST_DIM_SIZE:return e[0];case Ai.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case Ai.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${Ai[n]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const e=this.getFirstDimensionSize(),n=this.calculateOutputSize(e),r=new Array(this.raggedRank+1);r[r.length-1]=1;for(let o=r.length-2;o>=0;--o)r[o]=r[o+1]*n[o+1];const a=ZF(n,!1),i=rr(this.valuesDType,me(a));if(r[0]*n[0]>0){let o=this.calculateFirstParentOutputIndex(e,r[0],n[0]);for(let s=1;s<=this.raggedRank;++s)o=this.calculateOutputIndex(s-1,o,r[s],n[s]);this.setOutput(this.raggedRank,o,i,a)}return[a,i]}setOutput(e,n,r,a){if(r.length===0)return;const i=this.values,o=r;let s=a.slice();s=s.slice(e+1);const l=me(s),u=n.length;let c=this.defaultValue;if(c.length!==l&&c.length!==1){const m=this.defaultValueShape;Ot(()=>{const y=xe(c,m);c=Jd(y,s).dataSync()})}let d=0,p=0,f=0;for(let m=0;m<=u;++m){let y=m<u?n[m]:-1;if(y===f){++f;continue}if(p<f){const x=i.subarray(d*l),b=o.subarray(p*l),v=(f-p)*l;QF(b,x,v)}if(m>=u){const x=r.length;y=Math.floor(x/l)}if(y>f)if(this.defaultValue.length===1)o.subarray(f*l,y*l).fill(this.defaultValue[0]),f=y;else for(;y>f;){const x=o.slice(f*l);QF(x,c,l),++f}y<0?(d=m+1,p=f):(d=m,p=f,f=p+1)}}}function QF(t,e,n){for(let r=0;r<n;r++)t[r]=e[r]}function ZF(t,e){const n=[];for(let r of t){if(r<0){if(!e)throw new Error(`Dimension ${r} must be >= 0`);if(r<-1)throw new Error(`Dimension ${r} must be >= -1`);r=-1}n.push(r)}return n}function JF(t,e,n,r,a,i,o,s,l,u){return new Q2(t,e,n,r,a,i,o,s,l,u).compute()}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function e9(t,e,n,r){const a=t===e,i=t<e&&n<0,o=e<t&&n>1;if(a||i||o)return Nr(0,r);const s=Math.abs(Math.ceil((e-t)/n)),l=Nr(s,r);e<t&&n===1&&(n=-1),l[0]=t;for(let u=1;u<l.length;u++)l[u]=l[u-1]+n;return l}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const t9=Gl(t=>1/Math.sqrt(t)),Kfe=cp(cg,t9),Xfe={kernelName:cg,backendName:"cpu",kernelFunc:Kfe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function dp(t,e,n,r,a,i,o,s,l,u){const c=[r/a,a],d=t.values,p=e.values;if(r===0)return pt(n,e.dtype);const f=pt(c,e.dtype);typeof l=="string"||typeof l=="number"?f.values.fill(l):typeof l=="boolean"&&f.values.fill(+l);for(let m=0;m<i;m++){const y=[];let x=0;for(let b=0;b<o;b++){const v=d[m*o+b];y.push(v),x+=v*s[b]}if(x<0||x>=r/a)throw new Error(`Invalid indices: ${y} does not index into ${n}`);for(let b=0;b<a;b++)u?f.values[x*a+b]+=p[m*a+b]:f.values[x*a+b]=e.rank===0?p[0]:p[m*a+b]}return f}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Yfe=Gl(t=>1/(1+Math.exp(-t))),n9=Kt(gg,t=>1/(1+Math.exp(-t))),Qfe={kernelName:gg,backendName:"cpu",kernelFunc:n9};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function r9(t,e,n,r,a){const i=WT(r,e,n),o=me(n),s=qe(r);if(i){const d=UT(e,s);return a==="string"?t.slice(d,d+o):t.subarray(d,d+o)}const l=a==="string"?uc(t):t,u=pt(r,a,l),c=pt(n,a);for(let d=0;d<c.size;++d){const p=c.indexToLoc(d),f=p.map((m,y)=>m+e[y]);c.set(u.get(...f),...p)}return a==="string"?uF(c.values):c.values}function dc(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{begin:i,size:o}=r;ze(a,"slice");const[s,l]=GT(a,i,o);jT(a,s,l);const u=n.data.get(a.dataId).values,c=r9(u,s,l,a.shape,a.dtype);return n.makeTensorInfo(l,a.dtype,c)}const Zfe={kernelName:Kv,backendName:"cpu",kernelFunc:dc};/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function a9(t,e,n,r,a,i,o){const s=e[0],l=i[0],u=new Array(l),c=new Array(s),d=e[1];if(l===0){if(s!==0)throw new Error(YD(s));const x=rr(n,0),b=rr(a,0);return[x,[0,d],b,u,c]}let p=!0,f=0;const m=new Array(l).fill(0);for(let x=0;x<s;++x){const b=t[x*d];if(b<0)throw new Error(QD(x,b));if(b>=l)throw new Error(ZD(x,b,l));++m[b],p=p&&b>=f,f=b}let y=!0;for(let x=0;x<l;++x){const b=m[x]===0;u[x]=b,y=y&&!b,m[x]=Math.max(m[x],1),x>0&&(m[x]+=m[x-1])}if(y&&p){const x=t,b=r;for(let v=0;v<s;++v)c[v]=v;return[x,[s,d],b,u,c]}else{const x=m[l-1],b=rr(n,x*d),v=rr(a,x),w=new Array(l).fill(0);for(let S=0;S<s;++S){const C=t[S*d],I=w[C],_=(C===0?0:m[C-1])+I;w[C]++;for(let E=0;E<d;++E)b[_*d+E]=t[S*d+E];v[_]=r[S],c[S]=_}for(let S=0;S<l;++S)if(w[S]===0){const C=S===0?0:m[S-1];b[C*d+0]=S;for(let I=1;I<d;++I)b[C*d+I]=0;v[C]=o}return[b,[x,d],v,u,c]}}/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function i9(t,e,n,r,a){const i=me(r),o=e[0],s=a.length,l=[];let u=1,c=-1;for(let y=0;y<s;++y){const x=a[y];if(x===-1){if(c!==-1)throw new Error(JD(c,y));c=y,l.push(1)}else{if(x<0)throw new Error(eF(y,x));u*=x,l.push(x)}}if(c!==-1){if(u<=0)throw new Error(tF());const y=Math.trunc(i/u);if(u*y!==i)throw new Error(nF(r,l));l[c]=y}if(me(l)!==i)throw new Error(rF(r,l));const d=r.length,p=[];if(d>0){p[d-1]=1;for(let y=d-2;y>=0;--y)p[y]=p[y+1]*r[y+1]}const f=[];if(s>0){f[s-1]=1;for(let y=s-2;y>=0;--y)f[y]=f[y+1]*l[y+1]}const m=rr(n,o*s);for(let y=0;y<o;++y){let x=0;for(let b=0;b<d;++b)x+=t[y*d+b]*p[b];for(let b=0;b<s;++b)m[y*s+b]=Math.trunc(x/f[b]),x%=f[b]}return[m,[o,s],l]}/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function I4(t,e,n,r,a,i=!1,o=0){const s=r.length,l=[e[0],t.length/e[0]],u=l[1],c=s>0?a[s-1]+1:0;if(c<0)throw new Error(o4());const d=e.slice();d[0]=c;const p=d.reduce((v,w)=>v*w,1),f=rr(n,p);if(s===0)return c>0&&f.fill(o),[f,d];if(c<=0)throw new Error(o4());let m=0,y=1,x=0,b=a[m];for(;;){let v=0;if(y<s){if(v=a[y],b===v){++y;continue}if(b>=v)throw new Error(aF())}if(b<0||b>=c)throw new Error(iF(b,c));b>x&&f.fill(o,x*u,b*u);for(let w=m;w<y;++w){const S=r[w];if(S<0||S>=l[0])throw new Error(oF(w,r[w],l[0]));for(let C=0;C<u;C++)f[b*u+C]+=t[S*u+C]}if(i)for(let w=0;w<u;w++)f[b*u+w]/=y-m;if(m=y,++y,x=b+1,b=v,y>s)break}return x<c&&f.fill(o,x*u,c*u),[f,d]}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Jfe=Gl(t=>Math.sqrt(t)),ege=Kt(yg,t=>Math.sqrt(t)),tge={kernelName:yg,backendName:"cpu",kernelFunc:ege};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const o9=Yn((t,e)=>{const n=t-e;return n*n}),nge=gr(bg,o9),rge={kernelName:bg,backendName:"cpu",kernelFunc:nge};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function s9(t,e,n,r){const a=pt(t,e.dtype);for(let i=0;i<a.size;i++){const o=a.indexToLoc(i),s=new Array(o.length);for(let l=0;l<s.length;l++)s[l]=o[l]*n[l]+r[l];a.set(e.get(...s),...o)}return a}/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class age{constructor(e,n,r,a,i,o){this.separator=Ro(e),this.nGramWidths=n,this.leftPad=Ro(r),this.rightPad=Ro(a),this.padWidth=i,this.preserveShort=o}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,n){const r=this.getPadWidth(n);return Math.max(0,e+2*r-n+1)}createNGrams(e,n,r,a,i,o){for(let s=0;s<i;++s){const l=this.getPadWidth(o),u=Math.max(0,l-s),c=Math.max(0,l-(i-(s+1))),d=o-(u+c),p=n+(u>0?0:s-l);let f=0;f+=u*this.leftPad.length;for(let v=0;v<d;++v)f+=e[p+v].length;f+=c*this.rightPad.length;const m=u+c+d-1;f+=m*this.separator.length,r[a+s]=new Uint8Array(f);const y=r[a+s];let x=0;const b=v=>v.forEach(w=>y[x++]=w);for(let v=0;v<u;++v)b(this.leftPad),b(this.separator);for(let v=0;v<d-1;++v)b(e[p+v]),b(this.separator);if(d>0){b(e[p+d-1]);for(let v=0;v<c;++v)b(this.separator),b(this.rightPad)}else{for(let v=0;v<c-1;++v)b(this.rightPad),b(this.separator);b(this.rightPad)}}}compute(e,n){const r=e.length,a=n.length;if(a>0){let l=n[0];if(l!==0)throw new Error(`First split value must be 0, got ${l}`);for(let u=1;u<a;++u){let c=n[u]>=l;if(c=c&&n[u]<=r,!c)throw new Error(`Invalid split value ${n[u]}, must be in [${l}, ${r}]`);l=n[u]}if(l!==r)throw new Error(`Last split value must be data size. Expected ${r}, got ${l}`)}const i=a-1,o=rr("int32",a);if(r===0||a===0){const l=new Array(r);for(let u=0;u<=i;++u)o[u]=0;return[l,o]}o[0]=0;for(let l=1;l<=i;++l){const u=n[l]-n[l-1];let c=0;this.nGramWidths.forEach(d=>{c+=this.getNumNGrams(u,d)}),this.preserveShort&&u>0&&c===0&&(c=1),o[l]=o[l-1]+c}const s=new Array(o[i]);for(let l=0;l<i;++l){const u=n[l];let c=o[l];if(this.nGramWidths.forEach(d=>{const p=n[l+1]-n[l],f=this.getNumNGrams(p,d);this.createNGrams(e,u,s,c,f,d),c+=f}),this.preserveShort&&c===o[l]){const d=n[l+1]-n[l];if(d===0)continue;const p=d+2*this.padWidth;this.createNGrams(e,u,s,c,1,p)}}return[s,o]}}function l9(t,e,n,r,a,i,o,s){return new age(n,r,a,i,o,s).compute(t,e)}/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function ige(t,e,n,r){if(!t.length)return;if(e.length===0){for(let i=0;i<t.length;++i)r.push(t.subarray(i,i+1));return}if(e.length===1){const i=e[0];let o=t.indexOf(i);for(;o!==-1;){const s=t.subarray(0,o);(!n||s.length!==0)&&r.push(s),t=t.subarray(o+1),o=t.indexOf(i)}(!n||t.length!==0)&&r.push(t);return}let a=0;for(let i=0;i<t.length+1;i++)if(i===t.length||e.indexOf(t[i])!==-1){const o=t.subarray(a,i);(!n||o.length!==0)&&r.push(o),a=i+1}}function u9(t,e,n){const r=t.length,a=[];let i=0,o=0;const s=new Array(r);for(let p=0;p<r;++p){const f=a.length;ige(t[p],e,n,a);const m=a.length-f;s[p]=m,i+=m,o=Math.max(o,m)}const l=rr("int32",i*2),u=new Array(i),c=[r,o];let d=0;for(let p=0;p<r;++p)for(let f=0;f<s[p];++f)l[d*2]=p,l[d*2+1]=f,u[d]=a[d],++d;return[l,u,c]}/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function c9(t,e){const n=rr("int32",t.length);for(let r=0;r<t.length;++r)n[r]=_P(t[r]).modulo(e).getLowBitsUnsigned();return n}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const d9=Yn((t,e)=>t-e),oge=S4((t,e,n,r)=>({real:t-n,imag:e-r})),E4=gr(vg,d9,oge),sge={kernelName:vg,backendName:"cpu",kernelFunc:E4};/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function p9(t,e){const n=new Array(t.rank);for(let a=0;a<n.length;a++)n[a]=t.shape[a]*e[a];const r=pt(n,t.dtype);for(let a=0;a<r.values.length;++a){const i=r.indexToLoc(a),o=new Array(t.rank);for(let l=0;l<o.length;l++)o[l]=i[l]%t.shape[l];const s=t.locToIndex(o);r.values[a]=t.values[s]}return r}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const em=(t,e)=>{const n=e.value-t.value;return n===0?t.index-e.index:n};function h9(t,e,n=0,r=t.length-1){for(;r>n;){if(r-n>600){const s=r-n+1,l=e-n+1,u=Math.log(s),c=.5*Math.exp(2*u/3),d=.5*Math.sqrt(u*c*(s-c)/s)*Math.sign(l-s/2),p=Math.max(n,Math.floor(e-l*c/s+d)),f=Math.min(r,Math.floor(e+(s-l)*c/s+d));h9(t,e,p,f)}const a=t[e];let i=n,o=r;for(xs(t,n,e),em(t[r],a)>0&&xs(t,n,r);i<o;){for(xs(t,i,o),i++,o--;em(t[i],a)<0;)i=i+1;for(;em(t[o],a)>0;)o=o-1}em(t[n],a)===0?xs(t,n,o):(o=o+1,xs(t,o,r)),o<=e&&(n=o+1),e<=o&&(r=o-1)}}function f9(t,e,n,r,a){const i=e[e.length-1],[o,s]=[t.length/i,i],l=nr(n,o*r),u=nr("int32",o*r);for(let d=0;d<o;d++){const p=d*s,f=t.subarray(p,p+s);let m=new Array(f.length);f.forEach((v,w)=>m[w]={value:v,index:w}),r<m.length&&(h9(m,r),m=m.slice(0,r)),a&&m.sort(em);const y=d*r,x=l.subarray(y,y+r),b=u.subarray(y,y+r);for(let v=0;v<r;v++)x[v]=m[v].value,b[v]=m[v].index}const c=e.slice();return c[c.length-1]=r,[pt(c,n,l),pt(c,"int32",u)]}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function g9(t,e,n,r){const a=Pt(e,n)[0],i=[1,n[0],1];for(let m=0;m<a;m++)i[0]*=n[m];i[1]=n[a];for(let m=a+1;m<n.length;m++)i[2]*=n[m];const o={},s=new Int32Array(n[a]),l=new ar(i,r,t),u=[],c=i[0]===1&&i[2]===1;for(let m=0;m<n[a];m++){let y;if(c)y=t[m].toString();else{const x=[];for(let b=0;b<i[0];b++)for(let v=0;v<i[2];v++)x.push(l.get(b,m,v));y=x.join(",")}if(o[y]!==void 0)s[m]=o[y];else{const x=Object.keys(o).length;o[y]=x,s[m]=x,u.push(m)}}const d=i.slice();d[1]=Object.keys(o).length;const p=new ar(d,r);u.forEach((m,y)=>{for(let x=0;x<i[0];x++)for(let b=0;b<i[2];b++)p.set(l.get(x,m,b),x,y,b)});const f=n.slice();return f[a]=d[1],{outputValues:p.values,outputShape:f,indices:s}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const lge=Object.freeze(Object.defineProperty({__proto__:null,addImpl:NF,bincountImpl:C4,bincountReduceImpl:TF,castImpl:CF,ceilImpl:IF,concatImpl:EF,equalImpl:_F,expImpl:$F,expm1Impl:MF,floorImpl:AF,gatherNdImpl:PF,gatherV2Impl:LF,greaterEqualImpl:FF,greaterImpl:DF,lessEqualImpl:zF,lessImpl:BF,linSpaceImpl:jF,logImpl:VF,maxImpl:WF,maximumImpl:UF,minimumImpl:GF,multiplyImpl:N4,negImpl:HF,notEqualImpl:qF,prodImpl:KF,raggedGatherImpl:YF,raggedTensorToTensorImpl:JF,rangeImpl:e9,rsqrtImpl:t9,scatterImpl:dp,sigmoidImpl:Yfe,simpleAbsImpl:SF,sliceImpl:r9,sparseFillEmptyRowsImpl:a9,sparseReshapeImpl:i9,sparseSegmentReductionImpl:I4,sqrtImpl:Jfe,squaredDifferenceImpl:o9,stridedSliceImpl:s9,stringNGramsImpl:l9,stringSplitImpl:u9,stringToHashBucketFastImpl:c9,subImpl:d9,tileImpl:p9,topKImpl:f9,transposeImpl:T4,uniqueImpl:g9},Symbol.toStringTag,{value:"Module"}));/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/PT("cpu",()=>new Y2,1);/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const m9=Kt(Af,t=>t>=0?t:Math.exp(t)-1),uge={kernelName:Af,backendName:"cpu",kernelFunc:m9};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function y9(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{alpha:i}=r;ze([a],"leakyRelu");const o=me(a.shape),s=n.data.get(a.dataId).values,l=nr("float32",o);for(let u=0;u<s.length;u++)l[u]=s[u]<0?i*s[u]:s[u];return n.makeTensorInfo(a.shape,"float32",l)}const cge={kernelName:mv,backendName:"cpu",kernelFunc:y9};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const dge=Yn((t,e)=>t<0?e*t:t);function b9(t){const{inputs:e,backend:n}=t,{x:r,alpha:a}=e;ze([r,a],"prelu");const i=n.data.get(r.dataId).values,o=n.data.get(a.dataId).values,[s,l]=dge(r.shape,a.shape,i,o,"float32");return n.makeTensorInfo(l,"float32",s)}const pge={kernelName:Pv,backendName:"cpu",kernelFunc:b9};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const v9=Kt(sg,t=>Math.max(0,t)),hge={kernelName:sg,backendName:"cpu",kernelFunc:v9};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const x9=Kt(lg,t=>Math.min(Math.max(0,t),6)),fge={kernelName:lg,backendName:"cpu",kernelFunc:x9};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function o2(t,e,n,r,a){if(n==="linear")return jo({inputs:{x:e},backend:t});if(n==="relu")return v9({inputs:{x:e},backend:t});if(n==="elu")return m9({inputs:{x:e},backend:t});if(n==="relu6")return x9({inputs:{x:e},backend:t});if(n==="prelu")return b9({inputs:{x:e,alpha:r},backend:t});if(n==="leakyrelu")return y9({inputs:{x:e},backend:t,attrs:{alpha:a}});if(n==="sigmoid")return n9({inputs:{x:e},backend:t});throw new Error(`Activation ${n} has not been implemented for the CPU backend.`)}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function dn(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{shape:i}=r,o=me(a.shape),s=B3(i,o),l=me(s);j(o===l,()=>`The new shape (${s}) has ${l} elements and the old shape (${a.shape}) has ${o} elements. The new shape and old shape must have the same number of elements.`),n.incRef(a.dataId);const u=n.data.get(a.dataId);if(u.complexTensorInfos!=null){const c=u.complexTensorInfos.real,d=u.complexTensorInfos.imag;c.shape=s,d.shape=s}return{dataId:a.dataId,shape:s,dtype:a.dtype}}const gge={kernelName:jv,backendName:"cpu",kernelFunc:dn};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function w9(t){const{inputs:e,backend:n,attrs:r}=t,{a,b:i}=e,{transposeA:o,transposeB:s}=r;ze([a,i],"matMul");const l=a.shape.length,u=i.shape.length,c=o?a.shape[l-2]:a.shape[l-1],d=s?i.shape[u-1]:i.shape[u-2],p=o?a.shape[l-1]:a.shape[l-2],f=s?i.shape[u-2]:i.shape[u-1],m=a.shape.slice(0,-2),y=i.shape.slice(0,-2),x=me(m),b=me(y),v=Nt(a.shape.slice(0,-2),i.shape.slice(0,-2)).concat([p,f]);j(c===d,()=>`Error in matMul: inner shapes (${c}) and (${d}) of Tensors with shapes ${a.shape} and ${i.shape} and transposeA=${o} and transposeB=${s} must match.`);const w=o?[x,c,p]:[x,p,c],S=s?[b,f,d]:[b,d,f],C=dn({inputs:{x:a},backend:n,attrs:{shape:w}}),I=dn({inputs:{x:i},backend:n,attrs:{shape:S}}),_=o?C.shape[1]:C.shape[2],E=o?C.shape[2]:C.shape[1],P=s?I.shape[1]:I.shape[2],A=Math.max(x,b),D=n.data.get(C.dataId).values,V=n.data.get(I.dataId).values,z=qe(C.shape),K=qe(I.shape),[X,Z,q]=o?[z[0],1,z[1]]:[z[0],z[1],1],[F,Y,Q]=s?[1,K[1],K[0]]:[K[1],1,K[0]],ne=E*P,le=pt([A,E,P],C.dtype),de=le.values,re=n.blockSize;for(let he=0;he<A;he++)for(let ve=0;ve<E;ve+=re)for(let H=0;H<P;H+=re)for(let ie=0;ie<_;ie+=re){const pe=Math.min(ve+re,E),ke=Math.min(H+re,P),Ne=Math.min(ie+re,_);for(let Ie=ve;Ie<pe;Ie++)for(let Le=H;Le<ke;Le++){let He=0;for(let Me=ie;Me<Ne;Me++){const it=Math.min(he,x-1)*X,Ye=Math.min(he,b-1)*Q,Ze=D[it+Ie*Z+Me*q],Qe=V[Me*F+Le*Y+Ye];He+=Ze*Qe}de[he*ne+(Ie*P+Le)]+=He}}return n.disposeIntermediateTensorInfo(C),n.disposeIntermediateTensorInfo(I),n.makeTensorInfo(v,le.dtype,le.values)}const mge={kernelName:Fb,backendName:"cpu",kernelFunc:w9};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function yge(t){const{inputs:e,backend:n,attrs:r}=t,{a,b:i,bias:o,preluActivationWeights:s}=e,{transposeA:l,transposeB:u,activation:c,leakyreluAlpha:d}=r;let p,f,m;const y=[];p=w9({inputs:{a,b:i},attrs:{transposeA:l,transposeB:u},backend:n}),o&&(f=up({inputs:{a:p,b:o},backend:n}),y.push(p),p=f),c&&(m=o2(n,p,c,s,d),y.push(p),p=m);for(const x of y)n.disposeIntermediateTensorInfo(x);return p}const bge={kernelName:Cg,backendName:"cpu",kernelFunc:yge};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const vge=Kt(wf,t=>Math.acos(t)),xge={kernelName:wf,backendName:"cpu",kernelFunc:vge};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const wge=Kt(kf,t=>Math.acosh(t)),kge={kernelName:kf,backendName:"cpu",kernelFunc:wge};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Sge(t){const{inputs:e,backend:n}=t,r=e;ze(e,"addN");const a=r.map(s=>n.data.get(s.dataId).values),i=pt(r[0].shape,r[0].dtype),o=i.values;for(let s=0;s<r.length;s++){const l=a[s];for(let u=0;u<o.length;u++)o[u]+=l[u]}return n.makeTensorInfo(i.shape,i.dtype,i.values)}const Cge={kernelName:$b,backendName:"cpu",kernelFunc:Sge};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Nge(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:i,keepDims:o}=r;ze(a,"all");const s=Pt(i,a.shape);let l=s;const u=Un(l,a.shape.length);let c=a;u!=null&&(c=Ca({inputs:{x:a},backend:n,attrs:{perm:u}}),l=Gn(l.length,a.shape.length)),Ir("all",l,c.shape.length);const[d,p]=Tr(c.shape,l),f=me(p),m=Nr(me(d),c.dtype),y=n.data.get(c.dataId).values;for(let b=0;b<m.length;++b){const v=b*f;let w=y[v];for(let S=0;S<f;++S){const C=y[v+S];w=w&&C}m[b]=w}u!=null&&n.disposeIntermediateTensorInfo(c);const x=n.makeTensorInfo(d,c.dtype,m);if(o){const b=ir(d,s),v=dn({inputs:{x},backend:n,attrs:{shape:b}});return n.disposeIntermediateTensorInfo(x),v}return x}const Tge={kernelName:Rb,backendName:"cpu",kernelFunc:Nge};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Ige(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:i,keepDims:o}=r;ze(a,"any");const s=Pt(i,a.shape);let l=s;const u=Un(l,a.shape.length);let c=a;u!=null&&(c=Ca({inputs:{x:a},backend:n,attrs:{perm:u}}),l=Gn(l.length,a.shape.length)),Ir("any",l,c.shape.length);const[d,p]=Tr(c.shape,l),f=me(p),m=Nr(me(d),c.dtype),y=n.data.get(c.dataId).values;for(let b=0;b<m.length;++b){const v=b*f;let w=y[v];for(let S=0;S<f;++S){const C=y[v+S];w=w||C}m[b]=w}u!=null&&n.disposeIntermediateTensorInfo(c);const x=n.makeTensorInfo(d,c.dtype,m);if(o){const b=ir(d,s),v=dn({inputs:{x},backend:n,attrs:{shape:b}});return n.disposeIntermediateTensorInfo(x),v}return x}const Ege={kernelName:Mb,backendName:"cpu",kernelFunc:Ige};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function _ge(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:i}=r;ze(a,"argMax");let o=Pt(i,a.shape);const s=Un(o,a.shape.length);let l=a;const u=[];s!=null&&(l=Ca({inputs:{x:a},backend:n,attrs:{perm:s}}),u.push(l),o=Gn(o.length,l.shape.length)),o=[o[0]],Ir("argMax",o,l.shape.length);const[c,d]=Tr(l.shape,o),p=me(c),f=Nr(p,"int32"),m=me(d),y=n.data.get(l.dataId).values;for(let x=0;x<f.length;++x){const b=x*m;let v=y[b],w=0;for(let S=0;S<m;++S){const C=y[b+S];C>v&&(v=C,w=S)}f[x]=w}return u.forEach(x=>n.disposeIntermediateTensorInfo(x)),n.makeTensorInfo(c,"int32",f)}const Oge={kernelName:Ab,backendName:"cpu",kernelFunc:_ge};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function $ge(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:i}=r;ze(a,"argMin");let o=Pt(i,a.shape);const s=Un(o,a.shape.length);let l=a;const u=[];s!=null&&(l=Ca({inputs:{x:a},backend:n,attrs:{perm:s}}),u.push(l),o=Gn(o.length,l.shape.length)),o=[o[0]],Ir("argMin",o,l.shape.length);const[c,d]=Tr(l.shape,o),p=me(c),f=Nr(p,"int32"),m=me(d),y=n.data.get(l.dataId).values;for(let x=0;x<f.length;++x){const b=x*m;let v=y[b],w=0;for(let S=0;S<m;++S){const C=y[b+S];C<v&&(v=C,w=S)}f[x]=w}return u.forEach(x=>n.disposeIntermediateTensorInfo(x)),n.makeTensorInfo(c,"int32",f)}const Rge={kernelName:Pb,backendName:"cpu",kernelFunc:$ge};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Mge=Kt(Sf,t=>Math.asin(t)),Age={kernelName:Sf,backendName:"cpu",kernelFunc:Mge};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Pge=Kt(Cf,t=>Math.asinh(t)),Lge={kernelName:Cf,backendName:"cpu",kernelFunc:Pge};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Dge=Kt(Nf,t=>Math.atan(t)),Fge={kernelName:Nf,backendName:"cpu",kernelFunc:Dge};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Bge=Yn((t,e)=>Math.atan2(t,e)),zge=gr(If,Bge),jge={kernelName:If,backendName:"cpu",kernelFunc:zge};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Vge=Kt(Tf,t=>Math.atanh(t)),Wge={kernelName:Tf,backendName:"cpu",kernelFunc:Vge};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function _4(t,e,n,r,a,i){const o=a.strideHeight,s=a.strideWidth,l=a.dilationHeight,u=a.dilationWidth,c=a.effectiveFilterHeight,d=a.effectiveFilterWidth,p=a.padInfo.top,f=a.padInfo.left,m=i==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,y=pt(a.outShape,n),x=y.values,b=a.outShape[1]*a.outShape[2]*a.outShape[3],v=a.outShape[2]*a.outShape[3],w=a.outShape[3];for(let S=0;S<a.batchSize;++S){const C=S*b,I=S*r[0];for(let _=0;_<a.inChannels;++_)for(let E=0;E<a.outHeight;++E){const P=E*o-p,A=Math.max(0,P),D=Math.min(a.inHeight,c+P),V=C+E*v;for(let z=0;z<a.outWidth;++z){const K=z*s-f,X=Math.max(0,K),Z=Math.min(a.inWidth,d+K);let q=m,F=0,Y=0;for(let ne=A;ne<D;ne+=l){const le=I+ne*r[1];for(let de=X;de<Z;de+=u){const re=le+de*r[2],he=t[re+_];i==="max"&&he>q?q=he:i==="avg"&&(F+=he,Y++)}if(isNaN(q))break}const Q=V+z*w+_;x[Q]=i==="avg"?F/Y:q}}}return y}function k9(t,e,n,r,a=!1,i=!1){const o=pt(r.outShape,"int32"),s=r.strideHeight,l=r.strideWidth,u=r.dilationHeight,c=r.dilationWidth,d=r.effectiveFilterHeight,p=r.effectiveFilterWidth,f=r.padInfo.top,m=r.padInfo.left,y=pt(e,n,t);for(let x=0;x<r.batchSize;++x)for(let b=0;b<r.inChannels;++b)for(let v=0;v<r.outHeight;++v){const w=v*s-f;let S=w;for(;S<0;)S+=u;const C=Math.min(r.inHeight,d+w);for(let I=0;I<r.outWidth;++I){const _=I*l-m;let E=_;for(;E<0;)E+=c;const P=Math.min(r.inWidth,p+_);let A=Number.NEGATIVE_INFINITY,D=-1;for(let V=S;V<C;V+=u){const z=V-w;for(let K=E;K<P;K+=c){const X=K-_,Z=y.get(x,V,K,b);Z>A&&(A=Z,a?D=i?((x*r.inHeight+V)*r.inWidth+K)*r.inChannels+b:(V*r.inWidth+K)*r.inChannels+b:D=z*p+X)}}o.set(D,x,v,I,b)}}return o}function S9(t,e,n,r,a,i){const o=a.strideDepth,s=a.strideHeight,l=a.strideWidth,u=a.dilationDepth,c=a.dilationHeight,d=a.dilationWidth,p=a.effectiveFilterDepth,f=a.effectiveFilterHeight,m=a.effectiveFilterWidth,y=a.padInfo.front,x=a.padInfo.top,b=a.padInfo.left,v=i==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,w=pt(a.outShape,n),S=w.values,C=a.outShape[1]*a.outShape[2]*a.outShape[3]*a.outShape[4],I=a.outShape[2]*a.outShape[3]*a.outShape[4],_=a.outShape[3]*a.outShape[4],E=a.outShape[4];for(let P=0;P<a.batchSize;++P){const A=P*C,D=P*r[0];for(let V=0;V<a.inChannels;++V)for(let z=0;z<a.outDepth;++z){const K=z*o-y;let X=K;for(;X<0;)X+=u;const Z=Math.min(a.inDepth,p+K),q=A+z*I;for(let F=0;F<a.outHeight;++F){const Y=F*s-x;let Q=Y;for(;Q<0;)Q+=c;const ne=Math.min(a.inHeight,f+Y),le=q+F*_;for(let de=0;de<a.outWidth;++de){const re=de*l-b;let he=re;for(;he<0;)he+=d;const ve=Math.min(a.inWidth,m+re),H=le+de*E;let ie=v,pe=0,ke=0;for(let Ie=X;Ie<Z;Ie+=u){const Le=D+Ie*r[1];for(let He=Q;He<ne;He+=c){const Me=Le+He*r[2];for(let it=he;it<ve;it+=d){const Ye=Me+it*r[3],Ze=t[Ye+V];if(i==="max"&&Ze>ie?ie=Ze:i==="avg"&&(pe+=Ze,ke++),isNaN(ie))break}if(isNaN(ie))break}if(isNaN(ie))break}const Ne=H+V;S[Ne]=i==="avg"?pe/ke:ie}}}}return w}function Uge(t,e){const n=pt(e.outShape,"int32"),r=e.strideDepth,a=e.strideHeight,i=e.strideWidth,o=e.dilationDepth,s=e.dilationHeight,l=e.dilationWidth,u=e.effectiveFilterDepth,c=e.effectiveFilterHeight,d=e.effectiveFilterWidth,p=e.padInfo.front,f=e.padInfo.top,m=e.padInfo.left;for(let y=0;y<e.batchSize;++y)for(let x=0;x<e.inChannels;++x)for(let b=0;b<e.outDepth;++b){const v=b*r-p;let w=v;for(;w<0;)w+=o;const S=Math.min(e.inDepth,u+v);for(let C=0;C<e.outHeight;++C){const I=C*a-f;let _=I;for(;_<0;)_+=s;const E=Math.min(e.inHeight,c+I);for(let P=0;P<e.outWidth;++P){const A=P*i-m;let D=A;for(;D<0;)D+=l;const V=Math.min(e.inWidth,d+A);let z=Number.NEGATIVE_INFINITY,K=-1;for(let X=w;X<S;X+=o){const Z=X-v;for(let q=_;q<E;q+=s){const F=q-I;for(let Y=D;Y<V;Y+=l){const Q=Y-A,ne=t.get(y,X,q,Y,x);ne>=z&&(z=ne,K=Z*c*d+F*c+Q)}}}n.set(K,y,b,C,P,x)}}}return n}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Gge(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e;ze(a,"avgPool");const{filterSize:i,strides:o,pad:s,dimRoundingMode:l}=r,u=1;j(Wr(o,u),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${u}'`);const c=Ei(a.shape,i,o,u,s,l);let d;if(c.filterWidth===1&&c.filterHeight===1&&tn(c.inShape,c.outShape))d=jo({inputs:{x:a},backend:n});else{const p=n.data.get(a.dataId).values,f=qe(a.shape),m=_4(p,a.shape,a.dtype,f,c,"avg");d=n.makeTensorInfo(c.outShape,a.dtype,m.values)}return d}const Hge={kernelName:Lb,backendName:"cpu",kernelFunc:Gge};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function qge(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{filterSize:i,strides:o,pad:s,dimRoundingMode:l,dataFormat:u}=r;ze(a,"avgPool3d");const c=_s(a.shape,i,o,1,s,l,u),d=n.data.get(a.dataId).values,p=S9(d,a.shape,a.dtype,qe(a.shape),c,"avg");return n.makeTensorInfo(p.shape,"float32",p.values)}const Kge={kernelName:Db,backendName:"cpu",kernelFunc:qge};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Xge(t){const{inputs:e,backend:n,attrs:r}=t,{dy:a,input:i}=e,{filterSize:o,strides:s,pad:l,dimRoundingMode:u}=r;ze([a,i],"avgPool3DGrad");const c=_s(i.shape,o,s,1,l,u),d=c.strideDepth,p=c.strideHeight,f=c.strideWidth,m=c.filterDepth,y=c.filterHeight,x=c.filterWidth,b=c.dilationDepth,v=c.dilationHeight,w=c.dilationWidth,S=c.effectiveFilterDepth,C=c.effectiveFilterHeight,I=c.effectiveFilterWidth,_=S-1-c.padInfo.front,E=I-1-c.padInfo.left,P=C-1-c.padInfo.top,A=pt(i.shape,"float32"),D=1/(m*y*x),V=n.bufferSync(a);for(let z=0;z<c.batchSize;++z)for(let K=0;K<c.inChannels;++K)for(let X=0;X<c.inDepth;++X)for(let Z=0;Z<c.inHeight;++Z)for(let q=0;q<c.inWidth;++q){const F=X-_,Y=Z-P,Q=q-E;let ne=0;for(let le=0;le<S;le+=b){const de=(F+le)/d;if(!(de<0||de>=c.outDepth||Math.floor(de)!==de))for(let re=0;re<C;re+=v){const he=(Y+re)/p;if(!(he<0||he>=c.outHeight||Math.floor(he)!==he))for(let ve=0;ve<I;ve+=w){const H=(Q+ve)/f;if(H<0||H>=c.outWidth||Math.floor(H)!==H)continue;const ie=V.get(z,de,he,H,K);ne+=ie}}}A.set(ne*D,z,X,Z,q,K)}return n.makeTensorInfo(A.shape,A.dtype,A.values)}const Yge={kernelName:q3,backendName:"cpu",kernelFunc:Xge};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Qge(t){const{inputs:e,backend:n,attrs:r}=t,{dy:a,input:i}=e,o=i;ze([a,i],"avgPoolGrad");const{filterSize:s,strides:l,pad:u}=r,c=Ei(o.shape,s,l,1,u),d=c.strideHeight,p=c.strideWidth,f=c.filterHeight,m=c.filterWidth,y=c.dilationHeight,x=c.dilationWidth,b=c.effectiveFilterHeight,v=c.effectiveFilterWidth,w=v-1-c.padInfo.left,S=b-1-c.padInfo.top,C=pt(o.shape,"float32"),I=1/(f*m),_=n.data.get(a.dataId).values,E=pt(a.shape,"float32",_);for(let P=0;P<c.batchSize;++P)for(let A=0;A<c.inChannels;++A)for(let D=0;D<c.inHeight;++D)for(let V=0;V<c.inWidth;++V){const z=D-S,K=V-w;let X=0;for(let Z=0;Z<b;Z+=y){const q=(z+Z)/d;if(!(q<0||q>=c.outHeight||Math.floor(q)!==q))for(let F=0;F<v;F+=x){const Y=(K+F)/p;if(Y<0||Y>=c.outWidth||Math.floor(Y)!==Y)continue;const Q=E.get(P,q,Y,A);X+=Q}}C.set(X*I,P,D,V,A)}return n.makeTensorInfo(C.shape,C.dtype,C.values)}const Zge={kernelName:H3,backendName:"cpu",kernelFunc:Qge};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Jge(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,scale:i,offset:o,mean:s,variance:l}=e;j(s.shape.length===l.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),j(o==null||s.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),j(i==null||s.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),ze([a,s,l,i,o],"batchNorm");let{varianceEpsilon:u}=r;u==null&&(u=.001);const c=n.data.get(a.dataId).values,d=n.data.get(s.dataId).values,p=n.data.get(l.dataId).values,f=i?n.data.get(i.dataId).values:new Float32Array([1]),m=o?n.data.get(o.dataId).values:new Float32Array([0]),y=new Float32Array(c.length),x=m.length,b=f.length,v=p.length,w=d.length;let S=0,C=0,I=0,_=0;for(let E=0;E<c.length;++E)y[E]=m[S++]+(c[E]-d[C++])*f[I++]/Math.sqrt(p[_++]+u),S>=x&&(S=0),C>=w&&(C=0),I>=b&&(I=0),_>=v&&(_=0);return n.makeTensorInfo(a.shape,a.dtype,y)}const eme={kernelName:dv,backendName:"cpu",kernelFunc:Jge};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function tme(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{blockShape:i,crops:o}=r;ze([a],"batchToSpaceND");const s=i.reduce((b,v)=>b*v),l=Yg(a.shape,i,s),u=Qg(l.length,i.length),c=Zg(a.shape,i,s),d=VI(o,i.length),p=WI(c,o,i.length),f=dn({inputs:{x:a},backend:n,attrs:{shape:l}}),m=Ca({inputs:{x:f},backend:n,attrs:{perm:u}}),y=dn({inputs:{x:m},backend:n,attrs:{shape:c}}),x=dc({inputs:{x:y},backend:n,attrs:{begin:d,size:p}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(y),x}const nme={kernelName:Bb,backendName:"cpu",kernelFunc:tme};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function rme(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,weights:i}=e,{size:o}=r,s=n.data.get(a.dataId).values,l=n.data.get(i.dataId).values,u=C4(s,l,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,u)}const ame={kernelName:zb,backendName:"cpu",kernelFunc:rme};/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function ime(t){const{inputs:e,backend:n}=t,{s0:r,s1:a}=e,i=n.data.get(r.dataId).values,o=n.data.get(a.dataId).values,s=Nt(Array.from(i),Array.from(o));return n.makeTensorInfo([s.length],"int32",Int32Array.from(s))}const ome={kernelName:jb,backendName:"cpu",kernelFunc:ime};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const sme=Kt(Of,(t,e)=>{const n=e;return t>n.clipValueMax?n.clipValueMax:t<n.clipValueMin?n.clipValueMin:t}),lme={kernelName:Of,backendName:"cpu",kernelFunc:sme};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const ume=t=>{const{x:e}=t.inputs,n=t.backend,r=new Float32Array(me(e.shape)),a=n.data.get(e.dataId),i=a.complexTensorInfos.real,o=a.complexTensorInfos.imag,s=n.data.get(i.dataId).values,l=n.data.get(o.dataId).values;for(let u=0;u<s.length;u++){const c=s[u],d=l[u];r[u]=Math.hypot(c,d)}return n.makeOutput(r,e.shape,"float32")},cme={kernelName:Wb,backendName:"cpu",kernelFunc:ume};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function pp(t){const{inputs:e,backend:n}=t,{input:r}=e,a=n.data.get(r.dataId).complexTensorInfos.imag,i=n.data.get(a.dataId).values;return n.makeTensorInfo(a.shape,a.dtype,i)}const dme={kernelName:gv,backendName:"cpu",kernelFunc:pp};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function hp(t){const{inputs:e,backend:n,attrs:r}=t,{axis:a}=r,i=Pt(a,e[0].shape)[0],o=e.map(y=>y.shape);BI(o,i);let s=Bo(e.map(y=>y.shape),i);if(me(s)===0)return n.makeTensorInfo(s,e[0].dtype,[]);const l=e.filter(y=>me(y.shape)>0);if(l.length===1)return jo({inputs:{x:l[0]},backend:n});if(l[0].dtype==="complex64"){const y=l.map(S=>cc({inputs:{input:S},backend:n})),x=l.map(S=>pp({inputs:{input:S},backend:n})),b=hp({inputs:y,backend:n,attrs:{axis:i}}),v=hp({inputs:x,backend:n,attrs:{axis:i}}),w=Ua({inputs:{real:b,imag:v},backend:n});return y.forEach(S=>n.disposeIntermediateTensorInfo(S)),x.forEach(S=>n.disposeIntermediateTensorInfo(S)),n.disposeIntermediateTensorInfo(b),n.disposeIntermediateTensorInfo(v),w}const u=l.map(y=>{const x=[-1,me(y.shape.slice(i))];return dn({inputs:{x:y},backend:n,attrs:{shape:x}})}),c=u.map(y=>({vals:n.data.get(y.dataId).values,shape:y.shape}));s=Bo(u.map(y=>y.shape),1);const d=u[0].shape[0]===1,p=EF(c,s,e[0].dtype,d),f=Bo(l.map(y=>y.shape),i),m=n.makeTensorInfo(f,e[0].dtype,p);return u.forEach(y=>n.disposeIntermediateTensorInfo(y)),m}const pme={kernelName:Ub,backendName:"cpu",kernelFunc:hp};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function C9(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,filter:i}=e,{strides:o,pad:s,dataFormat:l,dilations:u,dimRoundingMode:c}=r;ze([a,i],"conv2d");const d=Os(l),p=fr(a.shape,i.shape,o,u,s,c,!1,d),f=p.filterHeight,m=p.filterWidth,y=p.dilationHeight,x=p.dilationWidth,b=p.padInfo.left,v=p.padInfo.top,w=p.dataFormat==="channelsLast",S=new ar(p.outShape,a.dtype),C=qe(a.shape),I=qe(i.shape),_=C[0],E=w?C[1]:C[2],P=w?C[2]:1,A=w?1:C[1],D=S.strides[0],V=w?S.strides[1]:S.strides[2],z=w?S.strides[2]:1,K=w?1:S.strides[1],X=n.data.get(a.dataId).values,Z=n.data.get(i.dataId).values,q=S.values;for(let F=0;F<p.batchSize;++F){const Y=F*_,Q=F*D;for(let ne=0;ne<p.outHeight;++ne){const le=Q+ne*V,de=ne*p.strideHeight-v;for(let re=0;re<f;++re){const he=de+re*y;if(he<0||he>=p.inHeight)continue;const ve=re*I[0],H=Y+he*E;for(let ie=0;ie<p.outWidth;++ie){const pe=le+ie*z,ke=ie*p.strideWidth-b;for(let Ne=0;Ne<m;++Ne){const Ie=ke+Ne*x;if(Ie<0||Ie>=p.inWidth)continue;const Le=ve+Ne*I[1],He=H+Ie*P;let Me=Le;for(let it=0;it<p.inChannels;++it){const Ye=X[He+it*A];for(let Ze=0;Ze<p.outChannels;++Ze)q[pe+Ze*K]+=Ye*Z[Me+Ze];Me+=p.outChannels}}}}}}return n.makeTensorInfo(S.shape,S.dtype,q)}const hme={kernelName:Gb,backendName:"cpu",kernelFunc:C9};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function fme(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,dy:i}=e,{strides:o,pad:s,dataFormat:l,dimRoundingMode:u,filterShape:c}=r;ze([a,i],"conv2dBackpropFilter");const d=Os(l),p=fr(a.shape,c,o,1,s,u,!1,d),{strideHeight:f,strideWidth:m,filterHeight:y,filterWidth:x}=p,b=p.dataFormat==="channelsLast",v=new ar(p.filterShape,"float32"),w=p.padInfo.left,S=p.padInfo.top,C=n.data.get(a.dataId).values,I=n.data.get(i.dataId).values,_=new ar(a.shape,a.dtype,C),E=new ar(i.shape,i.dtype,I);for(let P=0;P<y;++P){const A=Math.max(0,Math.ceil((S-P)/f)),D=Math.min(p.outHeight,(p.inHeight+S-P)/f);for(let V=0;V<x;++V){const z=Math.max(0,Math.ceil((w-V)/m)),K=Math.min(p.outWidth,(p.inWidth+w-V)/m);for(let X=0;X<p.inChannels;++X)for(let Z=0;Z<p.outChannels;++Z){let q=0;for(let F=0;F<p.batchSize;++F)for(let Y=A;Y<D;++Y){const Q=P+Y*f-S;for(let ne=z;ne<K;++ne){const le=V+ne*m-w;b?q+=_.get(F,Q,le,X)*E.get(F,Y,ne,Z):q+=_.get(F,X,Q,le)*E.get(F,Z,Y,ne)}}v.set(q,P,V,X,Z)}}}return n.makeTensorInfo(v.shape,v.dtype,v.values)}const gme={kernelName:Hb,backendName:"cpu",kernelFunc:fme};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function mme(t){const{inputs:e,backend:n,attrs:r}=t,{dy:a,filter:i}=e,{inputShape:o,strides:s,pad:l,dataFormat:u,dimRoundingMode:c}=r;ze([a,i],"conv2dBackpropInput");const d=qe(i.shape),p=qe(a.shape);let f=Os(u);const m=fr(o,i.shape,s,1,l,c,!1,f),y=new ar(m.inShape,"float32"),x=y.values,b=n.data.get(a.dataId).values,v=n.data.get(i.dataId).values,[w,S,C]=d,{batchSize:I,filterHeight:_,filterWidth:E,inChannels:P,inHeight:A,inWidth:D,outChannels:V,outHeight:z,outWidth:K,strideHeight:X,strideWidth:Z}=m;f=m.dataFormat;const q=_-1-m.padInfo.top,F=E-1-m.padInfo.left,Y=f==="channelsLast",Q=y.strides[0],ne=Y?y.strides[1]:y.strides[2],le=Y?y.strides[2]:1,de=Y?1:y.strides[1],re=p[0],he=Y?p[1]:p[2],ve=Y?p[2]:1,H=Y?1:p[1];for(let ie=0;ie<I;++ie)for(let pe=0;pe<P;++pe)for(let ke=0;ke<A;++ke){const Ne=ke-q,Ie=Math.max(0,Math.ceil(Ne/X)),Le=Math.min(z,(_+Ne)/X);for(let He=0;He<D;++He){const Me=He-F,it=Math.max(0,Math.ceil(Me/Z)),Ye=Math.min(K,(E+Me)/Z);let Ze=0;for(let Xt=Ie;Xt<Le;++Xt){const Vt=Xt*X-Ne;for(let Ht=it;Ht<Ye;++Ht){const Yt=Ht*Z-Me,Wt=re*ie+he*Xt+ve*Ht,Tt=w*(_-1-Vt)+S*(E-1-Yt)+C*pe;for(let Hn=0;Hn<V;++Hn){const yr=b[Wt+H*Hn],Ha=v[Tt+Hn];Ze+=yr*Ha}}}const Qe=Q*ie+ne*ke+le*He+de*pe;x[Qe]=Ze}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}const yme={kernelName:qb,backendName:"cpu",kernelFunc:mme};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function bme(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,filter:i}=e,{strides:o,pad:s,dilations:l}=r;ze([a,i],"conv3d");const u=Ll(a.shape,i.shape,o,l,s),{filterDepth:c,filterHeight:d,filterWidth:p,dilationDepth:f,dilationHeight:m,dilationWidth:y,padInfo:x}=u,b=x.front,v=x.left,w=x.top,S=new ar(u.outShape,a.dtype),C=n.data.get(a.dataId).values,I=n.data.get(i.dataId).values,_=S.values,E=qe(a.shape),P=qe(i.shape);for(let A=0;A<u.batchSize;++A){const D=A*E[0],V=A*S.strides[0];for(let z=0;z<u.outDepth;++z){const K=V+z*S.strides[1],X=z*u.strideDepth-b;for(let Z=0;Z<c;++Z){const q=X+Z*f;if(q<0||q>=u.inDepth)continue;const F=Z*P[0],Y=D+q*E[1];for(let Q=0;Q<u.outHeight;++Q){const ne=K+Q*S.strides[2],le=Q*u.strideHeight-w;for(let de=0;de<d;++de){const re=le+de*m;if(re<0||re>=u.inHeight)continue;const he=F+de*P[1],ve=Y+re*E[2];for(let H=0;H<u.outWidth;++H){const ie=ne+H*u.outChannels,pe=H*u.strideWidth-v;for(let ke=0;ke<p;++ke){const Ne=pe+ke*y;if(Ne<0||Ne>=u.inWidth)continue;const Ie=he+ke*P[2],Le=ve+Ne*u.inChannels;let He=Ie;for(let Me=0;Me<u.inChannels;++Me){const it=C[Le+Me];for(let Ye=0;Ye<u.outChannels;++Ye)_[ie+Ye]+=it*I[He+Ye];He+=u.outChannels}}}}}}}}return n.makeTensorInfo(S.shape,S.dtype,S.values)}const vme={kernelName:Kb,backendName:"cpu",kernelFunc:bme};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function xme(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,dy:i}=e,{strides:o,pad:s,filterShape:l}=r;ze([a,i],"conv3dBackpropFilterV2");const u=qe(a.shape),c=qe(i.shape),d=Ll(a.shape,l,o,1,s),p=d.strideDepth,f=d.strideHeight,m=d.strideWidth,y=d.filterDepth,x=d.filterHeight,b=d.filterWidth,v=new ar(d.filterShape,"float32"),w=v.values,[S,C,I,_]=v.strides,E=n.data.get(i.dataId).values,[P,A,D,V]=c,z=n.data.get(a.dataId).values,[K,X,Z,q]=u,F=d.padInfo.front,Y=d.padInfo.left,Q=d.padInfo.top;for(let ne=0;ne<y;++ne){const le=Math.max(0,Math.ceil((F-ne)/p)),de=Math.min(d.outDepth,(d.inDepth+F-ne)/p),re=ne*S;for(let he=0;he<x;++he){const ve=Math.max(0,Math.ceil((Q-he)/f)),H=Math.min(d.outHeight,(d.inHeight+Q-he)/f),ie=he*C+re;for(let pe=0;pe<b;++pe){const ke=Math.max(0,Math.ceil((Y-pe)/m)),Ne=Math.min(d.outWidth,(d.inWidth+Y-pe)/m),Ie=pe*I+ie;for(let Le=0;Le<d.inChannels;++Le){const He=Le*_+Ie;for(let Me=0;Me<d.outChannels;++Me){let it=0;for(let Ye=0;Ye<d.batchSize;++Ye){const Ze=Ye*K,Qe=Ye*P;for(let Xt=le;Xt<de;++Xt){const Vt=(ne+Xt*p-F)*X+Ze,Ht=Xt*A+Qe;for(let Yt=ve;Yt<H;++Yt){const Wt=(he+Yt*f-Q)*Z+Vt,Tt=Yt*D+Ht;for(let Hn=ke;Hn<Ne;++Hn){const yr=(pe+Hn*m-Y)*q+Wt,Ha=Hn*V+Tt;it+=z[yr+Le]*E[Ha+Me]}}}}w[He+Me]=it}}}}}return n.makeTensorInfo(v.shape,v.dtype,v.values)}const wme={kernelName:K3,backendName:"cpu",kernelFunc:xme};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function kme(t){const{inputs:e,backend:n,attrs:r}=t,{dy:a,filter:i}=e,{pad:o,strides:s,inputShape:l}=r;ze([a],"conv3dBackpropInputV2");const u=qe(a.shape),c=qe(i.shape),d=Ll(l,i.shape,s,1,o),p=new ar(d.inShape,"float32"),f=p.values,[m,y,x,b]=p.strides,v=n.data.get(a.dataId).values,[w,S,C,I]=u,_=n.data.get(i.dataId).values,[E,P,A,D]=c,{batchSize:V,filterDepth:z,filterHeight:K,filterWidth:X,inChannels:Z,inDepth:q,inHeight:F,inWidth:Y,outChannels:Q,outDepth:ne,outHeight:le,outWidth:de,strideDepth:re,strideHeight:he,strideWidth:ve}=d,H=z-1-d.padInfo.front,ie=K-1-d.padInfo.top,pe=X-1-d.padInfo.left;for(let ke=0;ke<V;++ke)for(let Ne=0;Ne<Z;++Ne)for(let Ie=0;Ie<q;++Ie){const Le=Ie-H,He=Math.max(0,Math.ceil(Le/re)),Me=Math.min(ne,(z+Le)/re);for(let it=0;it<F;++it){const Ye=it-ie,Ze=Math.max(0,Math.ceil(Ye/he)),Qe=Math.min(le,(K+Ye)/he);for(let Xt=0;Xt<Y;++Xt){const Vt=Xt-pe,Ht=Math.max(0,Math.ceil(Vt/ve)),Yt=Math.min(de,(X+Vt)/ve);let Wt=0;for(let Tt=He;Tt<Me;++Tt){const Hn=Tt*re-Le;for(let yr=Ze;yr<Qe;++yr){const Ha=yr*he-Ye;for(let Or=Ht;Or<Yt;++Or){const Fi=Or*ve-Vt,Ds=w*ke+S*Tt+C*yr+I*Or,fo=E*(z-1-Hn)+P*(K-1-Ha)+A*(X-1-Fi)+D*Ne;for(let rn=0;rn<Q;++rn){const Bi=v[Ds+rn],Fs=_[fo+rn];Wt+=Bi*Fs}}}}f[m*ke+y*Ie+x*it+b*Xt+Ne]=Wt}}}return n.makeTensorInfo(p.shape,p.dtype,p.values)}const Sme={kernelName:Xb,backendName:"cpu",kernelFunc:kme};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Cme=Kt($f,t=>Math.cos(t)),Nme={kernelName:$f,backendName:"cpu",kernelFunc:Cme};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Tme=Kt(Rf,t=>Math.cosh(t)),Ime={kernelName:Rf,backendName:"cpu",kernelFunc:Tme};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Eme(t){const{inputs:e,backend:n,attrs:r}=t,{image:a,boxes:i,boxInd:o}=e,{cropSize:s,method:l,extrapolationValue:u}=r,[c,d,p,f]=a.shape,m=i.shape[0],[y,x]=s,b=pt([m,y,x,f],"float32"),v=n.data.get(i.dataId).values,w=n.data.get(o.dataId).values,S=n.data.get(a.dataId).values,C=qe(a.shape),I=qe(b.shape);for(let _=0;_<m;_++){const E=_*4,P=v[E],A=v[E+1],D=v[E+2],V=v[E+3],z=w[_];if(z>=c)continue;const K=y>1?(D-P)*(d-1)/(y-1):0,X=x>1?(V-A)*(p-1)/(x-1):0;for(let Z=0;Z<y;Z++){const q=y>1?P*(d-1)+Z*K:.5*(P+D)*(d-1);if(q<0||q>d-1){for(let F=0;F<x;F++)for(let Y=0;Y<f;Y++){const Q=Y+F*I[2]+Z*I[1]+_*I[0];b.values[Q]=u}continue}if(l==="bilinear"){const F=Math.floor(q),Y=Math.ceil(q),Q=q-F;for(let ne=0;ne<x;ne++){const le=x>1?A*(p-1)+ne*X:.5*(A+V)*(p-1);if(le<0||le>p-1){for(let ve=0;ve<f;ve++){const H=ve+ne*I[2]+Z*I[1]+_*I[0];b.values[H]=u}continue}const de=Math.floor(le),re=Math.ceil(le),he=le-de;for(let ve=0;ve<f;ve++){let H=ve+de*C[2]+F*C[1]+z*C[0];const ie=S[H];H=ve+re*C[2]+F*C[1]+z*C[0];const pe=S[H];H=ve+de*C[2]+Y*C[1]+z*C[0];const ke=S[H];H=ve+re*C[2]+Y*C[1]+z*C[0];const Ne=S[H],Ie=ie+(pe-ie)*he,Le=ke+(Ne-ke)*he;H=ve+ne*I[2]+Z*I[1]+_*I[0],b.values[H]=Ie+(Le-Ie)*Q}}}else for(let F=0;F<x;++F){const Y=x>1?A*(p-1)+F*X:.5*(A+V)*(p-1);if(Y<0||Y>p-1){for(let le=0;le<f;le++){const de=le+F*I[2]+Z*I[1]+_*I[0];b.values[de]=u}continue}const Q=Math.round(Y),ne=Math.round(q);for(let le=0;le<f;le++){const de=le+Q*C[2]+ne*C[1]+z*C[0],re=le+F*I[2]+Z*I[1]+_*I[0];b.values[re]=S[de]}}}}return n.makeTensorInfo(b.shape,b.dtype,b.values)}const _me={kernelName:Zb,backendName:"cpu",kernelFunc:Eme};/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Ome(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:i,exclusive:o,reverse:s}=r;ze(a,"cumprod");const l=Un([i],a.shape.length);let u=a;l!=null&&(u=Ca({inputs:{x:a},backend:n,attrs:{perm:l}}));const c=Gn(1,a.shape.length)[0];if(c!==u.shape.length-1)throw new Error(`backend.cumprod in CPU expects an inner-most axis=${u.shape.length-1} but got axis=${c}`);const d=Sa(u.dtype,"int32"),p=_b(me(u.shape),d),f=n.data.get(u.dataId).values,m=u.shape[u.shape.length-1],y=s?(b,v)=>b+m-v-1:(b,v)=>b+v;for(let b=0;b<f.length;b+=m)for(let v=0;v<m;v++){const w=y(b,v);if(v===0)p[w]=o?1:f[w];else{const S=y(b,v-1);p[w]=o?f[S]*p[S]:f[w]*p[S]}}const x=n.makeTensorInfo(u.shape,d,p);if(l!=null){const b=jg(l),v=Ca({inputs:{x},backend:n,attrs:{perm:b}});return n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(u),v}return x}const $me={kernelName:Yb,backendName:"cpu",kernelFunc:Ome};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Rme(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:i,exclusive:o,reverse:s}=r;ze(a,"cumsum");const l=Un([i],a.shape.length);let u=a;l!=null&&(u=Ca({inputs:{x:a},backend:n,attrs:{perm:l}}));const c=Gn(1,a.shape.length)[0];if(c!==u.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${u.shape.length-1} but got axis=${c}`);const d=Sa(u.dtype,"int32"),p=Nr(me(u.shape),d),f=n.data.get(u.dataId).values,m=u.shape[u.shape.length-1],y=s?(b,v)=>b+m-v-1:(b,v)=>b+v;for(let b=0;b<f.length;b+=m)for(let v=0;v<m;v++){const w=y(b,v);if(v===0)p[w]=o?0:f[w];else{const S=y(b,v-1);p[w]=o?f[S]+p[S]:f[w]+p[S]}}const x=n.makeTensorInfo(u.shape,d,p);if(l!=null){const b=jg(l),v=Ca({inputs:{x},backend:n,attrs:{perm:b}});return n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(u),v}return x}const Mme={kernelName:Qb,backendName:"cpu",kernelFunc:Rme};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Ame(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,weights:i}=e,{size:o,binaryOutput:s}=r;if(a.shape.length===1){const l=n.data.get(a.dataId).values,u=n.data.get(i.dataId).values,c=C4(l,u,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,c)}else if(a.shape.length===2){const l=n.bufferSync(a),u=n.bufferSync(i),c=TF(l,u,o,s);return n.makeTensorInfo(c.shape,i.dtype,c.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${a.shape.length}.`)}const Pme={kernelName:Jb,backendName:"cpu",kernelFunc:Ame};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Lme(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{blockSize:i,dataFormat:o}=r;j(o==="NHWC",()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${o}`);const s=a.shape[0],l=a.shape[1],u=a.shape[2],c=a.shape[3],d=l*i,p=u*i,f=c/(i*i),m=n.data.get(a.dataId).values,y=new Float32Array(s*d*p*f);let x=0;for(let b=0;b<s;++b)for(let v=0;v<d;++v){const w=Math.floor(v/i),S=v%i;for(let C=0;C<p;++C){const I=Math.floor(C/i),_=C%i,E=(S*i+_)*f;for(let P=0;P<f;++P){const A=P+E+c*(I+u*(w+l*b));y[x++]=m[A]}}}return n.makeTensorInfo([s,d,p,f],a.dtype,y)}const Dme={kernelName:ev,backendName:"cpu",kernelFunc:Lme};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function N9(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,filter:i}=e,{strides:o,pad:s,dilations:l,dimRoundingMode:u}=r;ze([a,i],"depthwiseConv2DNative");const c=qe(a.shape),d=qe(i.shape);let p=l;p==null&&(p=[1,1]),j(Wr(o,p),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${o} and dilations '${p}'`);const f=fr(a.shape,i.shape,o,p,s,u,!0),{filterHeight:m,filterWidth:y,dilationHeight:x,dilationWidth:b,padInfo:v}=f,w=v.left,S=v.top,C=f.outChannels/f.inChannels,I=new ar(f.outShape,a.dtype),_=n.data.get(a.dataId).values,E=n.data.get(i.dataId).values,P=I.values;for(let A=0;A<f.batchSize;++A){const D=A*c[0],V=A*I.strides[0];for(let z=0;z<f.outHeight;++z){const K=V+z*I.strides[1],X=z*f.strideHeight-S;for(let Z=0;Z<m;++Z){const q=X+Z*x;if(q<0||q>=f.inHeight)continue;const F=Z*d[0],Y=D+q*c[1];for(let Q=0;Q<f.outWidth;++Q){const ne=K+Q*I.strides[2],le=Q*f.strideWidth-w;for(let de=0;de<y;++de){const re=le+de*b;if(re<0||re>=f.inWidth)continue;const he=F+de*d[1],ve=Y+re*f.inChannels;let H=ne,ie=he;for(let pe=0;pe<f.inChannels;++pe){const ke=_[ve+pe];for(let Ne=0;Ne<C;++Ne)P[H+Ne]+=ke*E[ie+Ne];H+=C,ie+=C}}}}}}return n.makeTensorInfo(I.shape,I.dtype,I.values)}const Fme={kernelName:tv,backendName:"cpu",kernelFunc:N9};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Bme(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,dy:i}=e,{strides:o,dilations:s,pad:l,dimRoundingMode:u,filterShape:c}=r;ze([a,i],"depthwiseConv2dNativeBackpropFilter");const d=fr(a.shape,c,o,s,l,u,!0),{strideHeight:p,strideWidth:f,filterHeight:m,filterWidth:y}=d,x=new ar(d.filterShape,"float32"),b=d.padInfo.left,v=d.padInfo.top,w=d.outChannels/d.inChannels,S=n.data.get(a.dataId).values,C=new ar(a.shape,a.dtype,S),I=n.data.get(i.dataId).values,_=new ar(i.shape,i.dtype,I);for(let E=0;E<m;++E){const P=Math.max(0,Math.ceil((v-E)/p)),A=Math.min(d.outHeight,(d.inHeight+v-E)/p);for(let D=0;D<y;++D){const V=Math.max(0,Math.ceil((b-D)/f)),z=Math.min(d.outWidth,(d.inWidth+b-D)/f);for(let K=0;K<d.outChannels;++K){const X=Math.trunc(K/w),Z=K%w;let q=0;for(let F=0;F<d.batchSize;++F)for(let Y=P;Y<A;++Y){const Q=E+Y*p-v;for(let ne=V;ne<z;++ne){const le=D+ne*f-b;q+=C.get(F,Q,le,X)*_.get(F,Y,ne,K)}}x.set(q,E,D,X,Z)}}}return n.makeTensorInfo(x.shape,x.dtype,x.values)}const zme={kernelName:nv,backendName:"cpu",kernelFunc:Bme};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function jme(t){const{inputs:e,backend:n,attrs:r}=t,{dy:a,filter:i}=e,{strides:o,dilations:s,pad:l,dimRoundingMode:u,inputShape:c}=r;ze([a,i],"depthwiseConv2DNativeBackpropInput");const d=qe(a.shape),p=qe(i.shape),f=fr(c,i.shape,o,s,l,u,!0),m=new ar(f.inShape,"float32"),y=m.values,[x,b,v]=m.strides,w=n.data.get(a.dataId).values,[S,C,I]=d,_=n.data.get(i.dataId).values,[E,P,A]=p,{batchSize:D,filterHeight:V,filterWidth:z,inChannels:K,inHeight:X,inWidth:Z,outChannels:q,outHeight:F,outWidth:Y,strideHeight:Q,strideWidth:ne}=f,le=V-1-f.padInfo.top,de=z-1-f.padInfo.left,re=q/K;for(let he=0;he<D;++he)for(let ve=0;ve<K;++ve)for(let H=0;H<X;++H){const ie=H-le,pe=Math.max(0,Math.ceil(ie/Q)),ke=Math.min(F,(V+ie)/Q);for(let Ne=0;Ne<Z;++Ne){const Ie=Ne-de,Le=Math.max(0,Math.ceil(Ie/ne)),He=Math.min(Y,(z+Ie)/ne);let Me=0;for(let it=pe;it<ke;++it){const Ye=it*Q-ie;for(let Ze=Le;Ze<He;++Ze){const Qe=Ze*ne-Ie,Xt=S*he+C*it+I*Ze,Vt=E*(V-1-Ye)+P*(z-1-Qe)+A*ve;for(let Ht=0;Ht<re;++Ht){const Yt=ve*re+Ht,Wt=w[Xt+Yt],Tt=_[Vt+Ht];Me+=Wt*Tt}}}y[x*he+b*H+v*Ne+ve]=Me}}return n.makeTensorInfo(m.shape,m.dtype,m.values)}const Vme={kernelName:rv,backendName:"cpu",kernelFunc:jme};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Wme(t){const{inputs:e,backend:n}=t,{x:r}=e,a=me(r.shape),i=n.data.get(r.dataId).values,o=pt([a,a],r.dtype),s=o.values;for(let u=0;u<i.length;u++)s[u*a+u]=i[u];const l=[...r.shape,...r.shape];return n.makeTensorInfo(l,o.dtype,o.values)}const Ume={kernelName:av,backendName:"cpu",kernelFunc:Wme};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Gme={kernelName:iv,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:r,filter:a}=t,{strides:i,pad:o,dilations:s}=n,l=e,u=l.data.get(r.dataId).values,c=r.shape.length,d=l.data.get(a.dataId).values,p=a.shape.length,{batchSize:f,inHeight:m,inWidth:y,inChannels:x,outHeight:b,outWidth:v,padInfo:w,strideHeight:S,strideWidth:C,filterHeight:I,filterWidth:_,dilationHeight:E,dilationWidth:P,outShape:A}=Dg(r.shape,a.shape,i,o,"NHWC",s),D=me(A),V=A.length,z=rr(r.dtype,D);for(let K=0;K<f;++K)for(let X=0;X<b;++X){const Z=X*S-w.top;for(let q=0;q<v;++q){const F=q*C-w.left;for(let Y=0;Y<x;++Y){let Q=Number.MIN_SAFE_INTEGER;for(let le=0;le<I;++le){const de=Z+le*E;if(de>=0&&de<m)for(let re=0;re<_;++re){const he=F+re*P;if(he>=0&&he<y){const ve=oo([K,de,he,Y],c,qe(r.shape)),H=oo([le,re,Y],p,qe(a.shape)),ie=u[ve]+d[H];ie>Q&&(Q=ie)}}}const ne=oo([K,X,q,Y],V,qe(A));z[ne]=Q}}}return{dataId:l.write(Rl(z,r.dtype),A,r.dtype),shape:A,dtype:r.dtype}}};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Hme={kernelName:Y3,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:r,filter:a,dy:i}=t,{strides:o,pad:s,dilations:l}=n,u=e,c=ri(r.shape,u.data.get(r.dataId).values),d=ri(a.shape,u.data.get(a.dataId).values),{batchSize:p,inHeight:f,inWidth:m,inChannels:y,outHeight:x,outWidth:b,padInfo:v,strideHeight:w,strideWidth:S,filterHeight:C,filterWidth:I,dilationHeight:_,dilationWidth:E,outShape:P}=Dg(r.shape,a.shape,o,s,"NHWC",l);j(i.rank===P.length,()=>`Error in ${Y3}, dy must have the same rank as output ${P.length}, but got ${i.rank}`);const A=ri(P,u.data.get(i.dataId).values),D=j3(a.shape,a.dtype);for(let V=0;V<p;++V)for(let z=0;z<x;++z){const K=z*w-v.top;for(let X=0;X<b;++X){const Z=X*S-v.left;for(let q=0;q<y;++q){let F=Number.MIN_SAFE_INTEGER,Y=0,Q=0;for(let ne=0;ne<C;++ne){const le=K+ne*_;if(le>=0&&le<f)for(let de=0;de<I;++de){const re=Z+de*E;if(re>=0&&re<m){const he=c[V][le][re][q]+d[ne][de][q];he>F&&(F=he,Y=ne,Q=de)}}}D[Y][Q][q]+=A[V][z][X][q]}}}return{dataId:u.write(Rl(D,r.dtype),a.shape,a.dtype),shape:a.shape,dtype:a.dtype}}};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const qme={kernelName:X3,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:r,filter:a,dy:i}=t,{strides:o,pad:s,dilations:l}=n,u=e,c=ri(r.shape,u.data.get(r.dataId).values),d=ri(a.shape,u.data.get(a.dataId).values),{batchSize:p,inHeight:f,inWidth:m,inChannels:y,outHeight:x,outWidth:b,padInfo:v,strideHeight:w,strideWidth:S,filterHeight:C,filterWidth:I,dilationHeight:_,dilationWidth:E,outShape:P}=Dg(r.shape,a.shape,o,s,"NHWC",l);j(i.rank===P.length,()=>`Error in ${X3}, dy must have the same rank as output ${P.length}, but got ${i.rank}`);const A=ri(P,u.data.get(i.dataId).values),D=j3(r.shape,r.dtype);for(let V=0;V<p;++V)for(let z=0;z<x;++z){const K=z*w-v.top;for(let X=0;X<b;++X){const Z=X*S-v.left;for(let q=0;q<y;++q){let F=Number.MIN_SAFE_INTEGER,Y=K<0?0:K,Q=Z<0?0:Z;for(let ne=0;ne<C;++ne){const le=K+ne*_;if(le>=0&&le<f)for(let de=0;de<I;++de){const re=Z+de*E;if(re>=0&&re<m){const he=c[V][le][re][q]+d[ne][de][q];he>F&&(F=he,Y=le,Q=re)}}}D[V][Y][Q][q]+=A[V][z][X][q]}}}return{dataId:u.write(Rl(D,r.dtype),r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function tm(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:i,keepDims:o}=r;ze(a,"sum");let s;a.dtype==="bool"?s=Ul({inputs:{x:a},backend:n,attrs:{dtype:"int32"}}):s=jo({inputs:{x:a},backend:n});const l=s.shape.length,u=Pt(i,s.shape),c=Un(u,l);let d=u,p=s;c!=null&&(p=Ca({inputs:{x:s},backend:n,attrs:{perm:c}}),d=Gn(d.length,l)),Ir("sum",d,p.shape.length);const[f,m]=Tr(p.shape,d),y=Sa(p.dtype,"int32");let x=a2(n,f,y);const b=me(m),v=n.data.get(x.dataId).values,w=n.data.get(p.dataId).values;for(let S=0;S<v.length;++S){const C=S*b;let I=0;for(let _=0;_<b;++_)I+=w[C+_];v[S]=I}if(o){const S=ir(x.shape,u),C=x;x=dn({inputs:{x},backend:n,attrs:{shape:S}}),n.disposeIntermediateTensorInfo(C)}return n.disposeIntermediateTensorInfo(s),c!=null&&n.disposeIntermediateTensorInfo(p),x}const Kme={kernelName:Xv,backendName:"cpu",kernelFunc:tm};/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Xme(t){const{inputs:e,backend:n,attrs:r}=t,{equation:a}=r,i=e,{allDims:o,summedDims:s,idDims:l}=e4(a,i.length);n4(o.length,l,i);const{path:u,steps:c}=r4(s,l),d=c.length;let p=null,f=o.length;const m=[];for(let y=0;y<d;++y){for(const x of c[y]){const{permutationIndices:b,expandDims:v}=t4(f,l[x]);let w;a4(b)?w=i[x]:(w=Ca({inputs:{x:i[x]},backend:n,attrs:{perm:b}}),m.push(w));const S=w.shape.slice();for(let C=0;C<v.length;++C)S.splice(v[C],0,1);tn(w.shape,S)||(w=dn({inputs:{x:w},backend:n,attrs:{shape:S}}),m.push(w)),p===null?p=w:(p=i2({inputs:{a:w,b:p},backend:n}),m.push(p))}y<d-1&&(u[y]>=0&&(p=tm({inputs:{x:p},backend:n,attrs:{axis:u[y]-(o.length-f),keepDims:!1}}),m.push(p)),f--)}for(const y of m)y!==p&&n.disposeIntermediateTensorInfo(y);return p}const Yme={kernelName:ov,backendName:"cpu",kernelFunc:Xme};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Qme(t){const{inputs:e,backend:n}=t,{dy:r,y:a}=e;ze([r,a],"eluGrad");const i=new Float32Array(me(a.shape)),o=n.data.get(a.dataId).values,s=n.data.get(r.dataId).values;for(let l=0;l<o.length;++l){const u=o[l];u>=1?i[l]=s[l]:i[l]=s[l]*(u+1)}return n.makeTensorInfo(a.shape,"float32",i)}const Zme={kernelName:Q3,backendName:"cpu",kernelFunc:Qme};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Jme=HI,e0e=qI,t0e=KI,n0e=XI,r0e=YI,a0e=QI,i0e=Kt(Pf,t=>{const e=Math.sign(t),n=Math.abs(t),r=1/(1+Jme*n);return e*(1-((((a0e*r+r0e)*r+n0e)*r+t0e)*r+e0e)*r*Math.exp(-n*n))}),o0e={kernelName:Pf,backendName:"cpu",kernelFunc:i0e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function s2(t){const{inputs:e,backend:n,attrs:r}=t,{input:a}=e,{dim:i}=r,o=a.shape.length,s=a.shape.slice();let l=i;return i<0&&(j(-(o+1)<=i,()=>`Axis must be in the interval [${-(o+1)}, ${o}]`),l=o+i+1),s.splice(l,0,1),dn({inputs:{x:a},backend:n,attrs:{shape:s}})}const s0e={kernelName:sv,backendName:"cpu",kernelFunc:s2};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const l0e=Yn((t,e)=>t/e),O4=gr(Mf,l0e),$4={kernelName:Mf,backendName:"cpu",kernelFunc:O4};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function T9(t,e,n){const r=t.shape,a=r[0],i=r[1],o=n.data.get(t.dataId),s=o.complexTensorInfos.real,l=o.complexTensorInfos.imag,u=[a,i],c=me(u),d=nr("float32",c),p=nr("float32",c);for(let x=0;x<a;x++){const b=dc({inputs:{x:s},backend:n,attrs:{begin:[x,0],size:[1,i]}}),v=dc({inputs:{x:l},backend:n,attrs:{begin:[x,0],size:[1,i]}}),w=Ua({inputs:{real:b,imag:v},backend:n}),{real:S,imag:C}=u0e(w,e,n),I=Ms(S,C);for(let _=0;_<i;_++){const E=ZI(I,_);d[x*i+_]=E.real,p[x*i+_]=E.imag}n.disposeIntermediateTensorInfo(b),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(w)}const f=n.makeTensorInfo(u,"float32",d),m=n.makeTensorInfo(u,"float32",p),y=Ua({inputs:{real:f,imag:m},backend:n});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),y}function u0e(t,e,n){const r=me(t.shape),a=n.data.get(t.dataId),i=n.data.get(a.complexTensorInfos.real.dataId).values,o=n.data.get(a.complexTensorInfos.imag.dataId).values;if(c0e(r)){const s=R4(i,o,r,e,n),l=[t.shape[0],t.shape[1]];if(e){const u=n.makeTensorInfo(l,"float32",s.real),c=n.makeTensorInfo(l,"float32",s.imag),d=n.makeTensorInfo([],"float32",Ss(r,"float32")),p=jo({inputs:{x:d},backend:n}),f=$4.kernelFunc({inputs:{a:u,b:d},backend:n}),m=$4.kernelFunc({inputs:{a:c,b:p},backend:n}),y=n.data.get(f.dataId).values,x=n.data.get(m.dataId).values;return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),{real:y,imag:x}}return s}else{const s=Ms(i,o),l=d0e(s,r,e);return VD(l)}}function c0e(t){return(t&t-1)===0}function R4(t,e,n,r,a){if(n===1)return{real:t,imag:e};const i=Ms(t,e),o=n/2,s=WD(i),l=s.real,u=s.imag,c=[l.length],d=a.makeTensorInfo(c,"float32",l),p=a.makeTensorInfo(c,"float32",u),f=Ua({inputs:{real:d,imag:p},backend:a}),m=UD(i),y=m.real,x=m.imag,b=[y.length],v=a.makeTensorInfo(b,"float32",y),w=a.makeTensorInfo(b,"float32",x),S=Ua({inputs:{real:v,imag:w},backend:a}),C=R4(l,u,o,r,a),I=C.real,_=C.imag,E=[I.length],P=a.makeTensorInfo(E,"float32",I),A=a.makeTensorInfo(E,"float32",_),D=Ua({inputs:{real:P,imag:A},backend:a}),V=R4(y,x,o,r,a),z=V.real,K=V.imag,X=[z.length],Z=a.makeTensorInfo(X,"float32",z),q=a.makeTensorInfo(X,"float32",K),F=Ua({inputs:{real:Z,imag:q},backend:a}),Y=HD(n,r),Q=[Y.real.length],ne=a.makeTensorInfo(Q,"float32",Y.real),le=a.makeTensorInfo(Q,"float32",Y.imag),de=Ua({inputs:{real:ne,imag:le},backend:a}),re=i2({inputs:{a:de,b:F},backend:a}),he=up({inputs:{a:D,b:re},backend:a}),ve=E4({inputs:{a:D,b:re},backend:a}),H=cc({inputs:{input:he},backend:a}),ie=cc({inputs:{input:ve},backend:a}),pe=pp({inputs:{input:he},backend:a}),ke=pp({inputs:{input:ve},backend:a}),Ne=hp({inputs:[H,ie],backend:a,attrs:{axis:0}}),Ie=hp({inputs:[pe,ke],backend:a,attrs:{axis:0}}),Le=a.data.get(Ne.dataId).values,He=a.data.get(Ie.dataId).values;return a.disposeIntermediateTensorInfo(d),a.disposeIntermediateTensorInfo(p),a.disposeIntermediateTensorInfo(f),a.disposeIntermediateTensorInfo(v),a.disposeIntermediateTensorInfo(w),a.disposeIntermediateTensorInfo(S),a.disposeIntermediateTensorInfo(P),a.disposeIntermediateTensorInfo(A),a.disposeIntermediateTensorInfo(D),a.disposeIntermediateTensorInfo(Z),a.disposeIntermediateTensorInfo(q),a.disposeIntermediateTensorInfo(F),a.disposeIntermediateTensorInfo(ne),a.disposeIntermediateTensorInfo(le),a.disposeIntermediateTensorInfo(de),a.disposeIntermediateTensorInfo(re),a.disposeIntermediateTensorInfo(he),a.disposeIntermediateTensorInfo(ve),a.disposeIntermediateTensorInfo(H),a.disposeIntermediateTensorInfo(pe),a.disposeIntermediateTensorInfo(ie),a.disposeIntermediateTensorInfo(ke),a.disposeIntermediateTensorInfo(Ne),a.disposeIntermediateTensorInfo(Ie),{real:Le,imag:He}}function d0e(t,e,n){const r=new Float32Array(e*2);for(let a=0;a<e;a++){let i=0,o=0;for(let s=0;s<e;s++){const l=qD(a*s,e,n),u=ZI(t,s);i+=u.real*l.real-u.imag*l.imag,o+=u.real*l.imag+u.imag*l.real}n&&(i/=e,o/=e),GD(r,i,o,a)}return r}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function p0e(t){const{inputs:e,backend:n}=t,{input:r}=e,a=me(r.shape),i=r.shape[r.shape.length-1],o=a/i,s=dn({inputs:{x:r},backend:n,attrs:{shape:[o,i]}}),l=T9(s,!1,n),u=dn({inputs:{x:l},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(l),u}const h0e={kernelName:lv,backendName:"cpu",kernelFunc:p0e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function M4(t){const{backend:e,attrs:n}=t,{shape:r,value:a,dtype:i}=n,o=i||jd(a),s=rr(o,me(r));return g0e(s,a,o),e.makeTensorInfo(r,o,s)}const f0e={kernelName:uv,backendName:"cpu",kernelFunc:M4};function g0e(t,e,n){t.fill(e)}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const m0e={kernelName:cv,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:r}=t,a=n,i=nr(r.dtype,me(r.shape)),[o,s,l,u]=r.shape,c=a.data.get(r.dataId).values;for(let d=0;d<o;d++){const p=d*l*s*u;for(let f=0;f<s;f++){const m=f*(l*u);for(let y=0;y<l;y++){const x=y*u;for(let b=0;b<u;b++){const v=Math.round(l-y-1),w=p+m+x+b;let S=c[w];if(v>=0&&v<l){const C=v*u,I=p+m+C+b;S=c[I]}i[w]=S}}}}return{dataId:a.write(i,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const y0e=Yn((t,e)=>Math.floor(t/e)),b0e=gr(zf,y0e,null,"int32"),v0e={kernelName:zf,backendName:"cpu",kernelFunc:b0e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function x0e(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,filter:i,bias:o,preluActivationWeights:s}=e,{strides:l,pad:u,dataFormat:c,dilations:d,dimRoundingMode:p,activation:f,leakyreluAlpha:m}=r;let y=C9({inputs:{x:a,filter:i},backend:n,attrs:{strides:l,pad:u,dataFormat:c,dilations:d,dimRoundingMode:p}});if(o){const x=y;if(c==="NCHW"&&o.shape.length===1&&o.shape[0]!==1){const b=dn({inputs:{x:o},backend:n,attrs:{shape:[o.shape[0],1,1]}});y=up({inputs:{a:y,b},backend:n}),n.disposeIntermediateTensorInfo(b)}else y=up({inputs:{a:y,b:o},backend:n});n.disposeIntermediateTensorInfo(x)}if(f){const x=y;if(c==="NCHW"&&f==="prelu"&&s.shape.length===1&&s.shape[0]!==1){const b=dn({inputs:{x:s},backend:n,attrs:{shape:[s.shape[0],1,1]}});y=o2(n,y,f,b,m),n.disposeIntermediateTensorInfo(b)}else y=o2(n,y,f,s,m);n.disposeIntermediateTensorInfo(x)}return y}const w0e={kernelName:Ng,backendName:"cpu",kernelFunc:x0e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function k0e(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,filter:i,bias:o,preluActivationWeights:s}=e,{strides:l,pad:u,dataFormat:c,dilations:d,dimRoundingMode:p,activation:f,leakyreluAlpha:m}=r;let y=N9({inputs:{x:a,filter:i},backend:n,attrs:{strides:l,pad:u,dataFormat:c,dilations:d,dimRoundingMode:p}});if(o){const x=y;y=up({inputs:{a:y,b:o},backend:n}),n.disposeIntermediateTensorInfo(x)}if(f){const x=y;y=o2(n,y,f,s,m),n.disposeIntermediateTensorInfo(x)}return y}const S0e={kernelName:Tg,backendName:"cpu",kernelFunc:k0e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function C0e(t){const{inputs:e,backend:n}=t,{params:r,indices:a}=e,i=me(r.shape),o=a.shape,s=o[o.length-1],[l,u,c,d]=Tx(r,a);if(u===0)return n.makeTensorInfo(l,r.dtype,[]);const p=n.data.get(a.dataId).values,f=n.bufferSync(r),m=PF(p,f,r.dtype,u,s,c,d,r.shape,i);return n.makeTensorInfo(l,r.dtype,m.values)}const N0e={kernelName:hv,backendName:"cpu",kernelFunc:C0e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function T0e(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,indices:i}=e,{axis:o,batchDims:s}=r;ze([a,i],"gatherV2");const l=Pt(o,a.shape)[0],u=n.data.get(i.dataId).values,c=a.shape[l];for(let S=0;S<u.length;++S){const C=u[S];j(C<=c-1&&C>=0,()=>`GatherV2: the index value ${C} is not in [0, ${c-1}]`)}let d=s;s==null&&(d=0);const p=me(i.shape),f=s4(a,i,l,d),m=dn({inputs:{x:a},backend:n,attrs:{shape:[f.batchSize,f.outerSize,f.dimSize,f.sliceSize]}}),y=dn({inputs:{x:i},backend:n,attrs:{shape:[f.batchSize,p/f.batchSize]}}),x=[f.batchSize,f.outerSize,p/f.batchSize,f.sliceSize],b=n.bufferSync(y),v=n.bufferSync(m),w=LF(v,b,x);return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(y),n.makeTensorInfo(f.outputShape,w.dtype,w.values)}const I0e={kernelName:pv,backendName:"cpu",kernelFunc:T0e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function E0e(t){const{inputs:e,backend:n}=t,{input:r}=e,a=me(r.shape),i=r.shape[r.shape.length-1],o=a/i,s=dn({inputs:{x:r},backend:n,attrs:{shape:[o,i]}}),l=T9(s,!0,n),u=dn({inputs:{x:l},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(l),u}const _0e={kernelName:fv,backendName:"cpu",kernelFunc:E0e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const O0e=Kt(Uf,t=>Number.isFinite(t)?1:0,"bool"),$0e={kernelName:Uf,backendName:"cpu",kernelFunc:O0e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const R0e=Kt(Gf,t=>Math.abs(t)===1/0?1:0,"bool"),M0e={kernelName:Gf,backendName:"cpu",kernelFunc:R0e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const A0e=Kt(Hf,t=>Number.isNaN(t)?1:0,"bool"),P0e={kernelName:Hf,backendName:"cpu",kernelFunc:A0e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function L0e(t){const{backend:e,attrs:n}=t,{start:r,stop:a,num:i}=n,o=jF(r,a,i);return e.makeTensorInfo([o.length],"float32",o)}const D0e={kernelName:yv,backendName:"cpu",kernelFunc:L0e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const F0e=Kt(Yf,t=>Math.log1p(t)),B0e={kernelName:Yf,backendName:"cpu",kernelFunc:F0e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const z0e=Yn((t,e)=>t&&e),j0e=gr(Qf,z0e,null,"bool"),V0e={kernelName:Qf,backendName:"cpu",kernelFunc:j0e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const W0e=Kt(Zf,t=>t?0:1,"bool"),U0e={kernelName:Zf,backendName:"cpu",kernelFunc:W0e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const G0e=Yn((t,e)=>t||e),H0e=gr(Jf,G0e,null,"bool"),q0e={kernelName:Jf,backendName:"cpu",kernelFunc:H0e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function K0e(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{depthRadius:i,bias:o,alpha:s,beta:l}=r;ze(a,"LRN");const u=a.shape[3],c=u-1,d=n.data.get(a.dataId).values,p=me(a.shape),f=new Float32Array(p);function m(y){const x=y%u;let b=y-x+Math.max(0,x-i);const v=y-x+Math.min(x+i,c);let w=0;for(;b<=v;b++){const S=d[b];w+=S*S}return w}for(let y=0;y<p;y++){const x=m(y),b=d[y]*Math.pow(o+s*x,-l);f[y]=b}return n.makeTensorInfo(a.shape,a.dtype,f)}const X0e={kernelName:bv,backendName:"cpu",kernelFunc:K0e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Y0e(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,y:i,dy:o}=e,{depthRadius:s,bias:l,alpha:u,beta:c}=r;ze(o,"LRNGrad");const d=me(o.shape),p=o.shape[3],f=n.data.get(o.dataId).values,m=n.data.get(a.dataId).values,y=n.data.get(i.dataId).values,x=new Float32Array(d),b=d;for(let v=0;v<b;v++){const w=v%p,S=v-w+Math.max(0,w-s),C=v-w+Math.min(p,w+s+1);let I=0;for(let _=S;_<C;_++)I+=Math.pow(m[_],2);I=u*I+l;for(let _=S;_<C;_++){let E=-2*u*c*m[_]*y[v]/I;v===_&&(E+=Math.pow(I,-c)),E*=f[v],x[_]+=E}}return n.makeTensorInfo(o.shape,a.dtype,x)}const Q0e={kernelName:Z3,backendName:"cpu",kernelFunc:Y0e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function I9(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{reductionIndices:i,keepDims:o}=r,s=n;let l=a.shape;const u=l.length,c=Pt(i,l);let d=c;const p=Un(d,u);let f=s.data.get(a.dataId).values;if(p!=null){const S=new Array(u);for(let C=0;C<S.length;C++)S[C]=l[p[C]];f=T4(f,l,a.dtype,p,S),d=Gn(d.length,u),l=S}ze(a,"max"),Ir("max",d,u);const[m,y]=Tr(l,d),x=me(y),b=WF(f,x,m,a.dtype),v=s.write(b,m,a.dtype);let w=m;return o&&(w=ir(m,c)),{dataId:v,shape:w,dtype:a.dtype}}const Z0e={kernelName:vv,backendName:"cpu",kernelFunc:I9};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function J0e(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e;ze(a,"maxPool");const{filterSize:i,strides:o,pad:s,dimRoundingMode:l}=r,u=1;j(Wr(o,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${u}'`);const c=Ei(a.shape,i,o,u,s,l);let d;if(c.filterWidth===1&&c.filterHeight===1&&tn(c.inShape,c.outShape))d=jo({inputs:{x:a},backend:n});else{const p=n.data.get(a.dataId).values,f=qe(a.shape),m=_4(p,a.shape,a.dtype,f,c,"max");d=n.makeTensorInfo(c.outShape,a.dtype,m.values)}return d}const e1e={kernelName:xv,backendName:"cpu",kernelFunc:J0e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function t1e(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{filterSize:i,strides:o,pad:s,dimRoundingMode:l,dataFormat:u}=r;ze(a,"maxPool3d");const c=_s(a.shape,i,o,1,s,l,u),d=n.data.get(a.dataId).values,p=S9(d,a.shape,a.dtype,qe(a.shape),c,"max");return n.makeTensorInfo(p.shape,"float32",p.values)}const n1e={kernelName:wv,backendName:"cpu",kernelFunc:t1e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function r1e(t){const{inputs:e,backend:n,attrs:r}=t,{dy:a,input:i}=e,{filterSize:o,strides:s,pad:l,dimRoundingMode:u}=r;ze([a,i],"maxPool3DGrad");const c=_s(i.shape,o,s,1,l,u),d=n.bufferSync(i),p=Uge(d,c),f=c.strideDepth,m=c.strideHeight,y=c.strideWidth,x=c.dilationDepth,b=c.dilationHeight,v=c.dilationWidth,w=c.effectiveFilterDepth,S=c.effectiveFilterHeight,C=c.effectiveFilterWidth,I=w-1-c.padInfo.front,_=C-1-c.padInfo.left,E=S-1-c.padInfo.top,P=pt(i.shape,"float32"),A=n.bufferSync(a);for(let D=0;D<c.batchSize;++D)for(let V=0;V<c.inChannels;++V)for(let z=0;z<c.inDepth;++z)for(let K=0;K<c.inHeight;++K)for(let X=0;X<c.inWidth;++X){const Z=z-I,q=K-E,F=X-_;let Y=0;for(let Q=0;Q<w;Q+=x){const ne=(Z+Q)/f;if(!(ne<0||ne>=c.outDepth||Math.floor(ne)!==ne))for(let le=0;le<S;le+=b){const de=(q+le)/m;if(!(de<0||de>=c.outHeight||Math.floor(de)!==de))for(let re=0;re<C;re+=v){const he=(F+re)/y;if(he<0||he>=c.outWidth||Math.floor(he)!==he)continue;const ve=w*S*C-1-p.get(D,ne,de,he,V),H=Q*S*C+le*C+re,ie=ve===H?1:0;if(ie===0)continue;const pe=A.get(D,ne,de,he,V);Y+=pe*ie}}}P.set(Y,D,z,K,X,V)}return n.makeTensorInfo(P.shape,P.dtype,P.values)}const a1e={kernelName:eT,backendName:"cpu",kernelFunc:r1e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function i1e(t){const{inputs:e,backend:n,attrs:r}=t,{dy:a,input:i,output:o}=e,s=i;ze([i,o],"maxPoolGrad");const{filterSize:l,strides:u,pad:c,dimRoundingMode:d}=r,p=Ei(s.shape,l,u,1,c,d),f=n.data.get(s.dataId).values,m=pt(p.outShape,s.dtype,k9(f,s.shape,s.dtype,p).values),y=p.strideHeight,x=p.strideWidth,b=p.dilationHeight,v=p.dilationWidth,w=p.effectiveFilterHeight,S=p.effectiveFilterWidth,C=S-1-p.padInfo.left,I=w-1-p.padInfo.top,_=pt(s.shape,"float32"),E=n.data.get(a.dataId).values,P=pt(a.shape,"float32",E);for(let A=0;A<p.batchSize;++A)for(let D=0;D<p.inChannels;++D)for(let V=0;V<p.inHeight;++V)for(let z=0;z<p.inWidth;++z){const K=V-I,X=z-C;let Z=0;for(let q=0;q<w;q+=b){const F=(K+q)/y;if(!(F<0||F>=p.outHeight||Math.floor(F)!==F))for(let Y=0;Y<S;Y+=v){const Q=(X+Y)/x;if(Q<0||Q>=p.outWidth||Math.floor(Q)!==Q)continue;const ne=w*S-1-m.get(A,F,Q,D),le=q*S+Y,de=ne===le?1:0;if(de===0)continue;const re=P.get(A,F,Q,D);Z+=re*de}}_.set(Z,A,V,z,D)}return n.makeTensorInfo(_.shape,_.dtype,_.values)}const o1e={kernelName:J3,backendName:"cpu",kernelFunc:i1e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function s1e(t,e,n,r,a){const i=qe(e),o=_4(t,e,n,i,a,"max"),s=k9(t,e,n,a,!0,r);return[o.values,s.values]}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const l1e={kernelName:kv,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:r}=t,{filterSize:a,strides:i,pad:o,includeBatchInIndex:s}=e,l=n;ze(r,"MaxPoolWithArgmax");const u=l.data.get(r.dataId).values,c=Ei(r.shape,a,i,[1,1],o),[d,p]=s1e(u,r.shape,r.dtype,s,c),f=l.write(d,c.outShape,r.dtype),m=l.write(p,c.outShape,r.dtype);return[{dataId:f,shape:c.outShape,dtype:r.dtype},{dataId:m,shape:c.outShape,dtype:"int32"}]}};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function u1e(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:i,keepDims:o}=r,s=Pt(i,a.shape),l=Tr(a.shape,s)[1],u=me(l),c=[],d=n.makeTensorInfo([],"float32",new Float32Array([u]));c.push(d);const p=Ul({inputs:{x:a},backend:n,attrs:{dtype:"float32"}});c.push(p);const f=O4({inputs:{a:p,b:d},backend:n});c.push(f);const m=tm({inputs:{x:f},backend:n,attrs:{axis:i,keepDims:o}});return c.forEach(y=>n.disposeIntermediateTensorInfo(y)),m}const c1e={kernelName:Sv,backendName:"cpu",kernelFunc:u1e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function d1e(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:i,keepDims:o}=r;ze(a,"min");const s=Pt(i,a.shape);let l=s;const u=Un(l,a.shape.length);let c=a;u!=null&&(c=Ca({inputs:{x:a},backend:n,attrs:{perm:u}}),l=Gn(l.length,a.shape.length)),Ir("min",l,c.shape.length);const[d,p]=Tr(c.shape,l),f=me(p),m=Nr(me(d),c.dtype),y=n.data.get(c.dataId).values;for(let b=0;b<m.length;++b){const v=b*f;let w=y[v];for(let S=0;S<f;++S){const C=y[v+S];(Number.isNaN(C)||C<w)&&(w=C)}m[b]=w}u!=null&&n.disposeIntermediateTensorInfo(c);const x=n.makeTensorInfo(d,c.dtype,m);if(o){const b=ir(d,s),v=dn({inputs:{x},backend:n,attrs:{shape:b}});return n.disposeIntermediateTensorInfo(x),v}return x}const p1e={kernelName:Cv,backendName:"cpu",kernelFunc:d1e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function h1e(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{paddings:i,mode:o}=r;ze(a,"mirrorPad");const s=i.map((v,w)=>v[0]+a.shape[w]+v[1]),l=i.map(v=>v[0]),u=i.map((v,w)=>v[0]+a.shape[w]),c=o==="reflect"?0:1,d=n.data.get(a.dataId).values,p=a.shape.length,f=qe(a.shape),m=me(s),y=s.length,x=qe(s),b=nr(a.dtype,m);for(let v=0;v<m;v++){let w=qu(v,y,x);for(let C=0;C<y;C++)w[C]<l[C]?w[C]=l[C]*2-w[C]-c:w[C]>=u[C]&&(w[C]=(u[C]-1)*2-w[C]+c);w=w.map((C,I)=>C-l[I]);const S=oo(w,p,f);b[v]=d[S]}return{dataId:n.write(b,s,a.dtype),shape:s,dtype:a.dtype}}const f1e={kernelName:Nv,backendName:"cpu",kernelFunc:h1e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const g1e=Yn((t,e)=>{const n=t%e;return t<0&&e<0||t>=0&&e>=0?n:(n+e)%e}),m1e=gr(ng,g1e),y1e={kernelName:ng,backendName:"cpu",kernelFunc:m1e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function E9(t){const{inputs:e,backend:n,attrs:r}=t,{logits:a}=e,{dim:i}=r,o=a.shape.length;let s=i;if(s===-1&&(s=o-1),s!==o-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${o} and dim was ${s}`);const l=Pt([s],a.shape),u=I9({inputs:{x:a},backend:n,attrs:{reductionIndices:l,keepDims:!1}}),c=ir(u.shape,l),d=dn({inputs:{x:u},backend:n,attrs:{shape:c}}),p=E4({inputs:{a,b:d},backend:n}),f=RF({inputs:{x:p},backend:n}),m=tm({inputs:{x:f},backend:n,attrs:{axis:l,keepDims:!1}}),y=dn({inputs:{x:m},backend:n,attrs:{shape:c}}),x=O4({inputs:{a:f,b:y},backend:n});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(y),x}const b1e={kernelName:Zv,backendName:"cpu",kernelFunc:E9};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function v1e(t){const{inputs:e,backend:n,attrs:r}=t,{logits:a}=e,{numSamples:i,seed:o,normalized:s}=r;ze(a,"multinomial");const l=s?a:E9({inputs:{logits:a},backend:n,attrs:{dim:-1}}),u=l.shape[0],c=l.shape[1],d=n.data.get(l.dataId).values,p=[u,i],f=Nr(me(p),"int32");for(let m=0;m<u;++m){const y=m*c,x=new Float32Array(c-1);x[0]=d[y];for(let w=1;w<x.length;++w)x[w]=x[w-1]+d[y+w];const b=Px.alea(o.toString()),v=m*i;for(let w=0;w<i;++w){const S=b();f[v+w]=x.length;for(let C=0;C<x.length;C++)if(S<x[C]){f[v+w]=C;break}}}return s||n.disposeIntermediateTensorInfo(l),n.makeTensorInfo(p,"int32",f)}const x1e={kernelName:Tv,backendName:"cpu",kernelFunc:v1e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const w1e=Ux;function k1e(t){const{inputs:e,backend:n,attrs:r}=t,{boxes:a,scores:i}=e,{maxOutputSize:o,iouThreshold:s,scoreThreshold:l}=r;ze(a,"NonMaxSuppression");const u=n.data.get(a.dataId).values,c=n.data.get(i.dataId).values,{selectedIndices:d}=w1e(u,c,o,s,l);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}const S1e={kernelName:Ev,backendName:"cpu",kernelFunc:k1e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const C1e=Gx;function N1e(t){const{inputs:e,backend:n,attrs:r}=t,{boxes:a,scores:i}=e,{maxOutputSize:o,iouThreshold:s,scoreThreshold:l,padToMaxOutputSize:u}=r;ze(a,"NonMaxSuppressionPadded");const c=n.data.get(a.dataId).values,d=n.data.get(i.dataId).values,{selectedIndices:p,validOutputs:f}=C1e(c,d,o,s,l,u);return[n.makeTensorInfo([p.length],"int32",new Int32Array(p)),n.makeTensorInfo([],"int32",new Int32Array([f]))]}const T1e={kernelName:_v,backendName:"cpu",kernelFunc:N1e};/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const I1e=Hx;function E1e(t){const{inputs:e,backend:n,attrs:r}=t,{boxes:a,scores:i}=e,{maxOutputSize:o,iouThreshold:s,scoreThreshold:l,softNmsSigma:u}=r;ze(a,"NonMaxSuppressionWithScore");const c=n.data.get(a.dataId).values,d=n.data.get(i.dataId).values,p=o,f=s,m=l,y=u,{selectedIndices:x,selectedScores:b}=I1e(c,d,p,f,m,y);return[n.makeTensorInfo([x.length],"int32",new Int32Array(x)),n.makeTensorInfo([b.length],"float32",new Float32Array(b))]}const _1e={kernelName:Ov,backendName:"cpu",kernelFunc:E1e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function O1e(t){const{inputs:e,backend:n,attrs:r}=t,{indices:a}=e,{dtype:i,depth:o,onValue:s,offValue:l}=r;ze(a,"oneHot");const u=me(a.shape),c=new Float32Array(u*o);c.fill(l);const d=n.data.get(a.dataId).values;for(let p=0;p<u;++p)d[p]>=0&&d[p]<o&&(c[p*o+d[p]]=s);return n.makeTensorInfo([...a.shape,o],i,c)}const $1e={kernelName:Rv,backendName:"cpu",kernelFunc:O1e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function l2(t){const{inputs:e,backend:n}=t,{x:r}=e;if(r.dtype==="string")throw new Error("zerosLike is not supported for string tensors");if(r.dtype==="complex64"){const a=cc({inputs:{input:r},backend:n}),i=l2({inputs:{x:a},backend:n}),o=pp({inputs:{input:r},backend:n}),s=l2({inputs:{x:o},backend:n}),l=Ua({inputs:{real:i,imag:s},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(s),l}else return M4({backend:n,attrs:{shape:r.shape,value:0,dtype:r.dtype}})}const R1e={kernelName:hx,backendName:"cpu",kernelFunc:l2};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function _9(t){const{inputs:e,backend:n}=t,{x:r}=e;if(r.dtype==="string")throw new Error("onesLike is not supported for string tensors");if(r.dtype==="complex64"){const a=cc({inputs:{input:r},backend:n}),i=_9({inputs:{x:a},backend:n}),o=pp({inputs:{input:r},backend:n}),s=l2({inputs:{x:o},backend:n}),l=Ua({inputs:{real:i,imag:s},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(s),l}else return M4({backend:n,attrs:{shape:r.shape,value:1,dtype:r.dtype}})}const M1e={kernelName:$v,backendName:"cpu",kernelFunc:_9};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function O9(t){const{inputs:e,backend:n,attrs:r}=t,{axis:a}=r;if(e.length===1)return s2({inputs:{input:e[0]},backend:n,attrs:{dim:a}});const i=e[0].shape,o=e[0].dtype;e.forEach(c=>{Cr(i,c.shape,"All tensors passed to stack must have matching shapes"),j(o===c.dtype,()=>"All tensors passed to stack must have matching dtypes")});const s=[],l=e.map(c=>{const d=s2({inputs:{input:c},backend:n,attrs:{dim:a}});return s.push(d),d}),u=hp({inputs:l,backend:n,attrs:{axis:a}});return s.forEach(c=>n.disposeIntermediateTensorInfo(c)),u}const A1e={kernelName:Mv,backendName:"cpu",kernelFunc:O9};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function P1e(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{paddings:i,constantValue:o}=r;ze(a,"pad");const s=i.map((b,v)=>b[0]+a.shape[v]+b[1]),l=i.map(b=>b[0]),u=n.data.get(a.dataId).values,c=me(a.shape),d=a.shape.length,p=qe(a.shape),f=me(s),m=s.length,y=qe(s),x=nr(a.dtype,f);o!==0&&x.fill(o);for(let b=0;b<c;b++){const v=qu(b,d,p).map((S,C)=>S+l[C]),w=oo(v,m,y);x[w]=u[b]}return{dataId:n.write(x,s,a.dtype),shape:s,dtype:a.dtype}}const $9={kernelName:Av,backendName:"cpu",kernelFunc:P1e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const L1e=Yn((t,e)=>Math.pow(t,e)),D1e=gr(ig,L1e),F1e={kernelName:ig,backendName:"cpu",kernelFunc:D1e};/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function B1e(t){const{inputs:e,backend:n,attrs:r}=t,{paramsNestedSplits:a,paramsDenseValues:i,indices:o}=e,s=a.map(x=>n.data.get(x.dataId).values),l=a.map(x=>x.shape),u=n.data.get(i.dataId).values,c=n.data.get(o.dataId).values,[d,p,f]=YF(s,l,u,i.shape,i.dtype,c,o.shape),m=d.map(x=>n.makeTensorInfo([x.length],"int32",x)),y=n.makeTensorInfo(f,i.dtype,p);return m.concat([y])}const z1e={kernelName:Dv,backendName:"cpu",kernelFunc:B1e};/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function j1e(t){const{inputs:e,backend:n,attrs:r}=t,{shape:a,values:i,defaultValue:o,rowPartitionTensors:s}=e,{rowPartitionTypes:l}=r,u=n.data.get(a.dataId).values,c=n.data.get(i.dataId).values,d=n.data.get(o.dataId).values,p=s.map(x=>n.data.get(x.dataId).values),f=s.map(x=>x.shape),[m,y]=JF(u,a.shape,c,i.shape,i.dtype,d,o.shape,p,f,l);return n.makeTensorInfo(m,i.dtype,y)}const V1e={kernelName:Fv,backendName:"cpu",kernelFunc:j1e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function W1e(t){const{backend:e,attrs:n}=t,{start:r,stop:a,dtype:i,step:o}=n,s=e9(r,a,o,i);return e.makeTensorInfo([s.length],i,s)}const U1e={kernelName:Bv,backendName:"cpu",kernelFunc:W1e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const G1e=Kt(og,t=>1/t),H1e={kernelName:og,backendName:"cpu",kernelFunc:G1e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function q1e(t){const{inputs:e,backend:n,attrs:r}=t,{images:a}=e,{alignCorners:i,halfPixelCenters:o,size:s}=r;ze(a,"resizeBilinear");const l=qe(a.shape),[u,c]=s,[d,p,f,m]=a.shape,y=n.data.get(a.dataId).values,x=new Float32Array(me([d,u,c,m])),b=[i&&u>1?p-1:p,i&&c>1?f-1:f],v=[i&&u>1?u-1:u,i&&c>1?c-1:c];let w=0;const S=b[0]/v[0],C=b[1]/v[1];for(let I=0;I<d;I++)for(let _=0;_<u;_++){let E;o?E=S*(_+.5)-.5:E=S*_;const P=Math.max(0,Math.floor(E)),A=E-P,D=Math.min(p-1,Math.ceil(E)),V=I*l[0]+P*l[1],z=I*l[0]+D*l[1];for(let K=0;K<c;K++){let X;o?X=C*(K+.5)-.5:X=C*K;const Z=Math.max(0,Math.floor(X)),q=X-Z,F=Math.min(f-1,Math.ceil(X)),Y=V+Z*l[2],Q=z+Z*l[2],ne=V+F*l[2],le=z+F*l[2];for(let de=0;de<m;de++){const re=y[Y+de],he=y[Q+de],ve=y[ne+de],H=y[le+de],ie=re+(ve-re)*q,pe=he+(H-he)*q,ke=ie+(pe-ie)*A;x[w++]=ke}}}return n.makeTensorInfo([d,u,c,m],"float32",x)}const K1e={kernelName:Wv,backendName:"cpu",kernelFunc:q1e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function X1e(t){const{inputs:e,backend:n,attrs:r}=t,{images:a,dy:i}=e,{alignCorners:o}=r;ze([i,a],"resizeBilinearGrad");const s=qe(a.shape),[l,u,c,d]=a.shape,[,p,f]=i.shape,m=new Float32Array(l*u*c*d),y=[o&&p>1?u-1:u,o&&f>1?c-1:c],x=[o&&p>1?p-1:p,o&&f>1?f-1:f],b=y[0]/x[0],v=y[1]/x[1],w=n.data.get(i.dataId).values;let S=0;for(let C=0;C<l;C++){const I=C*s[0];for(let _=0;_<p;_++){const E=_*b,P=Math.floor(E),A=Math.min(Math.ceil(E),u-1),D=I+P*s[1],V=I+A*s[1],z=E-P,K=1-z;for(let X=0;X<f;X++){const Z=X*v,q=Math.floor(Z),F=Math.min(Math.ceil(Z),c-1),Y=Z-q,Q=1-Y,ne=D+q*s[2],le=D+F*s[2],de=V+q*s[2],re=V+F*s[2],he=K*Q,ve=K*Y,H=z*Q,ie=z*Y;for(let pe=0;pe<d;pe++){const ke=w[S++];m[ne+pe]+=ke*he,m[le+pe]+=ke*ve,m[de+pe]+=ke*H,m[re+pe]+=ke*ie}}}}return n.makeTensorInfo([l,c,u,d],"float32",m)}const Y1e={kernelName:nT,backendName:"cpu",kernelFunc:X1e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Q1e(t){const{inputs:e,backend:n,attrs:r}=t,{images:a}=e,{alignCorners:i,halfPixelCenters:o,size:s}=r;ze(a,"resizeNearestNeighbor");const l=qe(a.shape),[u,c]=s,[d,p,f,m]=a.shape,y=n.data.get(a.dataId).values,x=new Float32Array(d*u*c*m),b=[i&&u>1?p-1:p,i&&c>1?f-1:f],v=[i&&u>1?u-1:u,i&&c>1?c-1:c],w=b[0]/v[0],S=b[1]/v[1];let C=0;for(let I=0;I<d;I++){const _=I*l[0];for(let E=0;E<u;E++){const P=o?w*(E+.5):w*E;let A=Math.min(p-1,i?Math.round(P):Math.floor(P));o&&(A=Math.max(0,A));const D=_+A*l[1];for(let V=0;V<c;V++){const z=o?S*(V+.5):S*V;let K=Math.min(f-1,i?Math.round(z):Math.floor(z));o&&(K=Math.max(0,K));const X=D+K*l[2];for(let Z=0;Z<m;Z++){const q=y[X+Z];x[C++]=q}}}}return n.makeTensorInfo([d,u,c,m],a.dtype,x)}const Z1e={kernelName:Vv,backendName:"cpu",kernelFunc:Q1e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function J1e(t){const{inputs:e,backend:n,attrs:r}=t,{images:a,dy:i}=e,{alignCorners:o}=r;ze([i,a],"resizeNearestNeighborGrad");const s=qe(a.shape),l=qe(i.shape),[u,c,d,p]=a.shape,[,f,m]=i.shape,y=new Float32Array(u*c*d*p),x=n.data.get(i.dataId).values,b=[o&&f>1?c-1:c,o&&m>1?d-1:d],v=[o&&f>1?f-1:f,o&&m>1?m-1:m],w=b[0]/v[0],S=b[1]/v[1],C=1/w,I=1/S,_=Math.ceil(C)*2+2,E=Math.ceil(I)*2+2;for(let P=0;P<u;P++){const A=P*s[0];for(let D=0;D<c;D++){const V=A+D*s[1],z=Math.floor(D*C),K=Math.floor(z-_/2);for(let X=0;X<d;X++){const Z=V+X*s[2],q=Math.floor(X*I),F=Math.floor(q-E/2);for(let Y=0;Y<p;Y++){let Q=0;for(let ne=0;ne<_;ne++){const le=ne+K;if(le<0||le>=f)continue;const de=A+le*l[1],re=le*w,he=Math.min(c-1,o?Math.round(re):Math.floor(re));if(D===he)for(let ve=0;ve<E;ve++){const H=ve+F;if(H<0||H>=m)continue;const ie=de+H*l[2],pe=H*S,ke=Math.min(d-1,o?Math.round(pe):Math.floor(pe));X===ke&&(Q+=x[ie+Y])}}y[Z+Y]=Q}}}}return n.makeTensorInfo(a.shape,a.dtype,y)}const eye={kernelName:tT,backendName:"cpu",kernelFunc:J1e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function tye(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{dims:i}=r;ze(a,"reverse");const o=a.shape.length,s=Pt(i,a.shape);if(o===0)return jo({inputs:{x:a},backend:n});const l=new ar(a.shape,a.dtype),u=n.bufferSync(a);for(let c=0;c<l.size;c++){const d=l.indexToLoc(c),p=d.slice();s.forEach(f=>p[f]=a.shape[f]-1-p[f]),l.set(u.get(...p),...d)}return n.makeTensorInfo(l.shape,l.dtype,l.values)}const nye={kernelName:Uv,backendName:"cpu",kernelFunc:tye};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const rye={kernelName:gx,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:r}=t,{radians:a,fillValue:i,center:o}=e,s=n,l=nr(r.dtype,me(r.shape)),[u,c,d,p]=r.shape,[f,m]=jI(o,c,d),y=255,x=Math.sin(a),b=Math.cos(a),v=s.data.get(r.dataId).values;for(let w=0;w<u;w++){const S=w*d*c*p;for(let C=0;C<c;C++){const I=C*(d*p);for(let _=0;_<d;_++){const E=_*p;for(let P=0;P<p;P++){const A=[u,C,_,P],D=A[2],V=A[1];let z=(D-f)*b-(V-m)*x,K=(D-f)*x+(V-m)*b;z=Math.round(z+f),K=Math.round(K+m);let X=i;if(typeof i!="number"&&(P===3?X=y:X=i[P]),z>=0&&z<d&&K>=0&&K<c){const q=K*(d*p),F=z*p,Y=S+q+F+P;X=v[Y]}const Z=S+I+E+P;l[Z]=X}}}}return{dataId:s.write(l,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const aye=Kt(ug,t=>{const e=Math.floor(t);return t-e<.5?Math.floor(t):t-e>.5?Math.ceil(t):e%2===0?e:e+1}),iye={kernelName:ug,backendName:"cpu",kernelFunc:aye};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function oye(t){const{inputs:e,backend:n,attrs:r}=t,{indices:a,updates:i}=e,{shape:o}=r,{sliceRank:s,numUpdates:l,sliceSize:u,strides:c,outputSize:d}=Qd(i,a,o),p=!0,f=n.bufferSync(a),m=n.bufferSync(i),y=dp(f,m,o,d,u,l,s,c,0,p);return n.makeTensorInfo(o,y.dtype,y.values)}const sye={kernelName:Gv,backendName:"cpu",kernelFunc:oye};/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function lye(t,e){let n=0,r=t.length,a=0;for(;n<r;)a=Math.floor((n+r)/2),t[a]<e?n=a+1:r=a;return r}function uye(t,e){let n=0,r=t.length,a=0;for(;n<r;)a=Math.floor((n+r)/2),t[a]<=e?n=a+1:r=a;return r}function cye(t,e,n,r,a,i){const o=rr("int32",n*a);for(let s=0;s<n;++s){const l=t.slice(s*r,(s+1)*r),u=s*a;for(let c=0;c<a;++c)o[u+c]=i==="left"?lye(l,e[c+u]):uye(l,e[c+u])}return o}/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function dye(t){const{inputs:e,backend:n,attrs:r}=t,{sortedSequence:a,values:i}=e,{side:o}=r,s=n.data.get(a.dataId).values,l=n.data.get(i.dataId).values,u=cye(s,l,a.shape[0],a.shape[1],i.shape[1],o);return n.makeTensorInfo(i.shape,"int32",u)}const pye={kernelName:Hv,backendName:"cpu",kernelFunc:dye};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function hye(t){const{inputs:e,backend:n}=t,{condition:r,t:a,e:i}=e;ze([r,a,i],"select");const o=r.shape.length,s=n.data.get(r.dataId).values,l=n.data.get(a.dataId).values,u=n.data.get(i.dataId).values,c=Sa(a.dtype,i.dtype),d=Nr(me(a.shape),c);let p=0;const f=o===0||o>1||a.shape.length===1?1:me(a.shape.slice(1));for(let m=0;m<s.length;m++)for(let y=0;y<f;y++)s[m]===1?d[p++]=l[m]:d[p++]=u[m];return n.makeTensorInfo(a.shape,c,d)}const fye={kernelName:qv,backendName:"cpu",kernelFunc:hye};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const gye=UI,mye=GI,yye=Kt(dg,t=>t>=0?mye*t:gye*(Math.exp(t)-1)),bye={kernelName:dg,backendName:"cpu",kernelFunc:yye};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const vye=Kt(fg,t=>t<0?-1:t>0?1:0),xye={kernelName:fg,backendName:"cpu",kernelFunc:vye};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const wye=Kt(pg,t=>Math.sin(t)),kye={kernelName:pg,backendName:"cpu",kernelFunc:wye};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Sye=Kt(hg,t=>Math.sinh(t)),Cye={kernelName:hg,backendName:"cpu",kernelFunc:Sye};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Nye=11920928955078125e-23,R9=Math.log(Nye)+2,Tye=Kt(mg,t=>{const e=t>-R9,n=t<R9,r=Math.exp(t);let a;return n?a=r:e?a=t:a=Math.log(1+r),a}),Iye={kernelName:mg,backendName:"cpu",kernelFunc:Tye};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Eye(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{blockShape:i,paddings:o}=r;ze([a],"spaceToBatchND");const s=me(i),l=[[0,0]];l.push(...o);for(let x=1+i.length;x<a.shape.length;++x)l.push([0,0]);const u=$9.kernelFunc({inputs:{x:a},backend:n,attrs:{paddings:l,constantValue:0}}),c=Yg(u.shape,i,s,!1),d=Qg(c.length,i.length,!1),p=Zg(u.shape,i,s,!1),f=dn({inputs:{x:u},backend:n,attrs:{shape:c}}),m=Ca({inputs:{x:f},backend:n,attrs:{perm:d}}),y=dn({inputs:{x:m},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),y}const _ye={kernelName:Yv,backendName:"cpu",kernelFunc:Eye};/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Oye(t){const{inputs:e,backend:n}=t,{indices:r,values:a,denseShape:i,defaultValue:o}=e;if(i.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
        ${i.shape}`);if(r.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
        ${r.shape}`);if(a.shape.length!==1)throw new Error(`Values must be a vector, saw:
        ${a.shape}`);if(o.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${o.shape}`);const s=n.data.get(r.dataId).values,l=n.data.get(a.dataId).values,u=n.data.get(i.dataId).values,c=n.data.get(o.dataId).values[0],[d,p,f,m,y]=a9(s,r.shape,r.dtype,l,a.dtype,u,c);return[n.makeTensorInfo(p,r.dtype,d),n.makeTensorInfo([p[0]],a.dtype,f),n.makeTensorInfo([m.length],"bool",new Uint8Array(m.map(x=>Number(x)))),n.makeTensorInfo([y.length],r.dtype,new Int32Array(y))]}const $ye={kernelName:Jv,backendName:"cpu",kernelFunc:Oye};/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Rye(t){const{inputs:e,backend:n}=t,{inputIndices:r,inputShape:a,newShape:i}=e;if(r.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape
        ${r.shape}`);if(a.shape.length!==1)throw new Error(`Input shape should be a vector but received shape
        ${a.shape}`);if(i.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${i.shape}`);const o=Array.from(n.data.get(a.dataId).values),s=n.data.get(r.dataId).values,l=Array.from(n.data.get(i.dataId).values),[u,c,d]=i9(s,r.shape,r.dtype,o,l);return[n.makeTensorInfo(c,r.dtype,u),n.makeTensorInfo([d.length],i.dtype,new Int32Array(d))]}const Mye={kernelName:ex,backendName:"cpu",kernelFunc:Rye};/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Aye(t){const{inputs:e,backend:n}=t,{data:r,indices:a,segmentIds:i}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(a.shape.length!==1)throw new Error(`Indices should be a vector but received shape
          ${a.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
          ${i.shape}`);if(a.shape[0]!==i.shape[0])throw new Error("segmentIds and indices should have same size.");const o=n.data.get(r.dataId).values,s=n.data.get(a.dataId).values,l=n.data.get(i.dataId).values,[u,c]=I4(o,r.shape,r.dtype,s,l,!0);return n.makeTensorInfo(c,r.dtype,u)}const Pye={kernelName:tx,backendName:"cpu",kernelFunc:Aye};/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Lye(t){const{inputs:e,backend:n}=t,{data:r,indices:a,segmentIds:i}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(a.shape.length!==1)throw new Error(`Indices should be a vector but received shape
         ${a.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
         ${i.shape}`);if(a.shape[0]!==i.shape[0])throw new Error("segmentIds and indices should have same size.");const o=n.data.get(r.dataId).values,s=n.data.get(a.dataId).values,l=n.data.get(i.dataId).values,[u,c]=I4(o,r.shape,r.dtype,s,l);return n.makeTensorInfo(c,r.dtype,u)}const Dye={kernelName:nx,backendName:"cpu",kernelFunc:Lye};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Fye(t){const{inputs:e,backend:n,attrs:r}=t,{sparseIndices:a,sparseValues:i,defaultValue:o}=e,{outputShape:s}=r,{sliceRank:l,numUpdates:u,sliceSize:c,strides:d,outputSize:p}=Qd(i,a,s),f=!1,m=n.bufferSync(a);let y;switch(i.dtype){case"bool":{const x=n.bufferSync(i),b=!!n.data.get(o.dataId).values[0];y=dp(m,x,s,p,c,u,l,d,b,f);break}case"float32":{const x=n.bufferSync(i),b=n.data.get(o.dataId).values[0];y=dp(m,x,s,p,c,u,l,d,b,f);break}case"int32":{const x=n.bufferSync(i),b=n.data.get(o.dataId).values[0];y=dp(m,x,s,p,c,u,l,d,b,f);break}case"string":{const x=n.bufferSync(i),b=Cs(n.data.get(o.dataId).values[0]);y=dp(m,x,s,p,c,u,l,d,b,f);break}default:throw new Error(`Unsupported type ${i.dtype}`)}return n.makeTensorInfo(s,y.dtype,y.values)}const Bye={kernelName:rx,backendName:"cpu",kernelFunc:Fye};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function zye(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{numOrSizeSplits:i,axis:o}=r,s=Pt(o,a.shape)[0],l=i4(a,i,s),u=new Array(a.shape.length).fill(0),c=a.shape.slice();return l.map(d=>{const p=[...c];p[s]=d;const f=dc({inputs:{x:a},backend:n,attrs:{begin:u,size:p}});return u[s]+=d,f})}const jye={kernelName:Qv,backendName:"cpu",kernelFunc:zye};/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Vye={kernelName:rT,backendName:"cpu",kernelFunc:({inputs:t,backend:e})=>{const{x:n}=t,r=e;ze(n,"square");const a=r.data.get(n.dataId).values,i=new Float32Array(a.length);for(let o=0;o<a.length;++o){const s=a[o];i[o]=s*s}return{dataId:r.write(i,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Wye=Kt(Sg,(t,e)=>{const n=e;return isNaN(t)?NaN:t>0?1:n.alpha}),Uye={kernelName:Sg,backendName:"cpu",kernelFunc:Wye};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Gye(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{begin:i,end:o,strides:s,beginMask:l,endMask:u,ellipsisMask:c,newAxisMask:d,shrinkAxisMask:p}=r;ze(a,"stridedSlice");const{finalShapeSparse:f,finalShape:m,isIdentity:y,sliceDim0:x,isSimpleSlice:b,begin:v,end:w,strides:S}=HT(a.shape,i,o,s,l,u,c,d,p);let C;if(y)C=dn({inputs:{x:a},backend:n,attrs:{shape:m}});else if(x||b){j(a.shape.length>=1,()=>`Input must have rank at least 1, got: ${a.shape.length}`);const I=VT(v,w,S),_=dc({inputs:{x:a},backend:n,attrs:{begin:v,size:I}});C=dn({inputs:{x:_},backend:n,attrs:{shape:m}}),n.disposeIntermediateTensorInfo(_)}else{const I=n.bufferSync(a),_=s9(f,I,S,v);C=n.makeTensorInfo(m,_.dtype,_.values)}return C}const Hye={kernelName:ax,backendName:"cpu",kernelFunc:Gye};/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function qye(t){const{inputs:e,backend:n,attrs:r}=t,{separator:a,nGramWidths:i,leftPad:o,rightPad:s,padWidth:l,preserveShortSequences:u}=r,{data:c,dataSplits:d}=e,p=n.data.get(c.dataId).values,f=n.data.get(d.dataId).values,[m,y]=l9(p,f,a,i,o,s,l,u);return[n.makeTensorInfo([m.length],"string",m),n.makeTensorInfo(d.shape,"int32",y)]}const Kye={kernelName:ix,backendName:"cpu",kernelFunc:qye};/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Xye(t){const{inputs:e,backend:n,attrs:r}=t,{skipEmpty:a}=r,{input:i,delimiter:o}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(i.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${i.shape}`);if(o.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${o.shape}`);const s=n.data.get(i.dataId).values,l=n.data.get(o.dataId).values[0],[u,c,d]=u9(s,l,a),p=c.length;return[n.makeTensorInfo([p,2],"int32",u),n.makeTensorInfo([p],"string",c),n.makeTensorInfo([2],"int32",new Int32Array(d))]}const Yye={kernelName:ox,backendName:"cpu",kernelFunc:Xye};/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Qye(t){const{inputs:e,backend:n,attrs:r}=t,{numBuckets:a}=r,{input:i}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(a<=0)throw new Error("Number of buckets must be at least 1");const o=n.data.get(i.dataId).values,s=c9(o,a);return n.makeTensorInfo(i.shape,"int32",s)}const Zye={kernelName:sx,backendName:"cpu",kernelFunc:Qye};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Jye=Kt(xg,t=>Math.tan(t)),ebe={kernelName:xg,backendName:"cpu",kernelFunc:Jye};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const tbe=Kt(wg,t=>Math.tanh(t)),nbe={kernelName:wg,backendName:"cpu",kernelFunc:tbe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function rbe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{reps:i}=r;ze(a,"tile");const o=p9(n.bufferSync(a),i);return n.makeTensorInfo(o.shape,o.dtype,o.values)}const abe={kernelName:kg,backendName:"cpu",kernelFunc:rbe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function ibe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{k:i,sorted:o}=r;ze(a,"topk");const s=n.data.get(a.dataId).values,[l,u]=f9(s,a.shape,a.dtype,i,o);return[n.makeTensorInfo(l.shape,l.dtype,l.values),n.makeTensorInfo(u.shape,u.dtype,u.values)]}const obe={kernelName:lx,backendName:"cpu",kernelFunc:ibe};/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function sbe(t){const{inputs:e,attrs:n,backend:r}=t,{image:a,transforms:i}=e,{interpolation:o,fillMode:s,fillValue:l,outputShape:u}=n,[c,d,p,f]=a.shape,[m,y]=u??[d,p],x=[c,m,y,f],b=qe(a.shape),v=b[0],w=b[1],S=b[2],C=qe(x),I=C[0],_=C[1],E=C[2],P=nr(a.dtype,me(x));P.fill(l);const A=r.data.get(a.dataId).values,D=r.data.get(i.dataId).values;for(let V=0;V<c;++V){const z=i.shape[0]===1?D:D.subarray(V*8,V*8+8);for(let K=0;K<m;++K)for(let X=0;X<y;++X)for(let Z=0;Z<f;++Z){let q;const F=z[6]*X+z[7]*K+1;if(F===0)continue;const Y=(z[0]*X+z[1]*K+z[2])/F,Q=(z[3]*X+z[4]*K+z[5])/F,ne=M9(Y,p,s),le=M9(Q,d,s);switch(o){case"nearest":q=hbe(A,d,p,v,w,S,V,le,ne,Z,l);break;case"bilinear":q=fbe(A,d,p,v,w,S,V,le,ne,Z,l);break;default:throw new Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${o}`)}const de=V*I+K*_+X*E+Z;P[de]=q}return r.makeTensorInfo(x,a.dtype,P)}return{dataId:r.write(P,x,a.dtype),shape:a.shape,dtype:a.dtype}}const lbe={kernelName:ux,backendName:"cpu",kernelFunc:sbe};function M9(t,e,n){switch(n){case"reflect":return ube(t,e);case"wrap":return cbe(t,e);case"nearest":return pbe(t,e);case"constant":default:return dbe(t)}}function ube(t,e){let n=t;if(n<0)if(e<=1)n=0;else{const r=2*e;n<r&&(n=r*Math.trunc(-n/r)+n),n=n<-e?n+r:-n-1}else if(n>e-1)if(e<=1)n=0;else{const r=2*e;n-=r*Math.trunc(n/r),n>=e&&(n=r-n-1)}return _l(0,n,e-1)}function cbe(t,e){let n=t;if(n<0)if(e<=1)n=0;else{const r=e-1;n+=e*(Math.trunc(-n/r)+1)}else if(n>e-1)if(e<=1)n=0;else{const r=e-1;n-=e*Math.trunc(n/r)}return _l(0,n,e-1)}function dbe(t,e){return t}function pbe(t,e){return _l(0,t,e-1)}function nm(t,e,n,r,a,i,o,s,l,u,c){const d=o*r+s*a+l*i+u;return 0<=s&&s<e&&0<=l&&l<n?t[d]:c}function hbe(t,e,n,r,a,i,o,s,l,u,c){const d=Math.round(s),p=Math.round(l);return nm(t,e,n,r,a,i,o,d,p,u,c)}function fbe(t,e,n,r,a,i,o,s,l,u,c){const d=Math.floor(s),p=Math.floor(l),f=d+1,m=p+1,y=(m-l)*nm(t,e,n,r,a,i,o,d,p,u,c)+(l-p)*nm(t,e,n,r,a,i,o,d,m,u,c),x=(m-l)*nm(t,e,n,r,a,i,o,f,p,u,c)+(l-p)*nm(t,e,n,r,a,i,o,f,m,u,c);return(f-s)*y+(s-d)*x}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function gbe(t){const{inputs:e,attrs:n,backend:r}=t,{axis:a}=n,{x:i}=e;ze(i,"unique");const o=r.data.get(i.dataId).values,{outputValues:s,outputShape:l,indices:u}=g9(o,a,i.shape,i.dtype);return[r.makeTensorInfo(l,i.dtype,s),r.makeTensorInfo([u.length],"int32",u)]}const mbe={kernelName:cx,backendName:"cpu",kernelFunc:gbe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function ybe(t){const{inputs:e,backend:n,attrs:r}=t,{value:a}=e;let{axis:i}=r;i<0&&(i+=a.shape.length);const o=a.shape.length,s=a.shape[i],l=new Array(o-1);let u=0;for(let f=0;f<o;f++)f!==i&&(l[u++]=a.shape[f]);const c=new Array(o).fill(0),d=a.shape.slice();d[i]=1;const p=new Array(s);for(let f=0;f<p.length;f++){c[i]=f;const m=dc({inputs:{x:a},backend:n,attrs:{begin:c,size:d}});p[f]=dn({inputs:{x:m},backend:n,attrs:{shape:l}}),n.disposeIntermediateTensorInfo(m)}return p}const bbe={kernelName:dx,backendName:"cpu",kernelFunc:ybe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function vbe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,segmentIds:i}=e,{numSegments:o}=r;ze(a,"unsortedSegmentSum");const s=a.shape.length,l=i.shape.length,u=[],c=[],d=s-l;let p=i;for(let m=0;m<d;++m){const y=s2({inputs:{input:p},backend:n,attrs:{dim:m+1}});p=y,c.push(y)}for(let m=0;m<o;++m){const y=Ss(m,"int32"),x=n.makeTensorInfo([],"int32",y),b=OF({inputs:{a:x,b:p},backend:n}),v=Ul({inputs:{x:b},backend:n,attrs:{dtype:"float32"}}),w=i2({inputs:{a:v,b:a},backend:n}),S=tm({inputs:{x:w},backend:n,attrs:{axis:0,keepDims:!1}});u.push(S),c.push(x),c.push(b),c.push(v),c.push(w),c.push(S)}const f=O9({inputs:u,backend:n,attrs:{axis:0}});return c.forEach(m=>n.disposeIntermediateTensorInfo(m)),f}const xbe={kernelName:px,backendName:"cpu",kernelFunc:vbe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const wbe=[bge,afe,xge,kge,cfe,Cge,Tge,Ege,Oge,Rge,Age,Lge,Fge,jge,Wge,Hge,Kge,Yge,Zge,mge,eme,nme,ame,ome,lfe,pfe,lme,ife,cme,pme,hme,gme,yme,vme,wme,Sme,Nme,Ime,_me,$me,Mme,Pme,Dme,Fme,zme,Vme,Ume,Gme,Hme,qme,Yme,uge,Zme,hfe,o0e,ffe,s0e,mfe,h0e,f0e,m0e,bfe,v0e,w0e,S0e,N0e,I0e,xfe,kfe,ofe,_0e,dme,$0e,M0e,P0e,cge,Cfe,Tfe,D0e,Efe,B0e,V0e,U0e,q0e,X0e,Q0e,Z0e,Ofe,e1e,n1e,a1e,o1e,l1e,c1e,p1e,Rfe,f1e,y1e,x1e,Afe,Lfe,S1e,T1e,_1e,Ffe,$1e,M1e,A1e,$9,F1e,pge,jfe,z1e,V1e,U1e,sfe,$4,H1e,hge,fge,gge,K1e,Y1e,Z1e,eye,nye,rye,iye,Xfe,sye,pye,fye,bye,Qfe,xye,kye,Cye,Zfe,b1e,Iye,_ye,$ye,Mye,Pye,Dye,Bye,jye,tge,Vye,rge,Uye,Hye,Kye,Yye,Zye,sge,Kme,ebe,nbe,abe,obe,lbe,Bfe,mbe,bbe,xbe,R1e];for(const t of wbe)bx(t);/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const pc={},u2={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function kbe(t,e){pc[t]=e}function po(t,e){if(!(t in pc)||e!=null){const r=Cbe(t,e);if(r!==null)pc[t]=r;else return console.log("Could not get context for WebGL version",t),null}const n=pc[t];return n==null||n.isContextLost()?(delete pc[t],po(t)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),pc[t])}function Sbe(t){if(typeof OffscreenCanvas<"u"&&t===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function Cbe(t,e){if(t!==1&&t!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const n=e??Sbe(t);return n.addEventListener("webglcontextlost",r=>{r.preventDefault(),delete pc[t]},!1),ce().getBool("SOFTWARE_WEBGL_ENABLED")&&(u2.failIfMajorPerformanceCaveat=!1),t===1?n.getContext("webgl",u2)||n.getContext("experimental-webgl",u2):n.getContext("webgl2",u2)}/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/var rm;(function(t){t[t.DENSE=0]="DENSE",t[t.SHARED_BATCH=1]="SHARED_BATCH"})(rm||(rm={}));var ii;(function(t){t[t.RENDER=0]="RENDER",t[t.UPLOAD=1]="UPLOAD",t[t.PIXELS=2]="PIXELS",t[t.DOWNLOAD=3]="DOWNLOAD"})(ii||(ii={}));var Er;(function(t){t[t.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",t[t.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",t[t.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",t[t.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",t[t.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(Er||(Er={}));function am(t,e){return[e,t]}function Nbe(t,e){return t*e}function c2(t){const e=me(t),n=Math.ceil(e/4);return Tb(n)}function fp(t,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(t/2))]}function Tbe(t,e){const[n,r]=fp(t,e);return n*r*4}function A4(t,e){const n=t;let r,a,i,o,s,l,u,c,d,p;return ce().getNumber("WEBGL_VERSION")===2?(r=n.R32F,a=n.R16F,i=n.RGBA16F,o=n.RGBA32F,s=n.RED,u=4,c=1,d=n.HALF_FLOAT,p=n.FLOAT,l=n.RGBA8):(r=t.RGBA,a=t.RGBA,i=t.RGBA,o=n.RGBA,s=t.RGBA,u=4,c=4,d=e!=null?e.HALF_FLOAT_OES:null,p=t.FLOAT,l=t.RGBA),{internalFormatFloat:r,internalFormatHalfFloat:a,internalFormatPackedHalfFloat:i,internalFormatPackedFloat:o,textureFormatFloat:s,downloadTextureFormat:l,downloadUnpackNumChannels:u,defaultNumChannels:c,textureTypeHalfFloat:d,textureTypeFloat:p}}/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function je(t,e){const n=e();return ce().getBool("DEBUG")&&Ibe(t),n}function Ibe(t){const e=t.getError();if(e!==t.NO_ERROR)throw new Error("WebGL Error: "+$be(t,e))}const Ebe=596e-10,_be=65504;function Obe(t){return!!(ce().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||t===0||Ebe<Math.abs(t)&&Math.abs(t)<_be)}function $be(t,e){switch(e){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case t.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${e}`}}function d2(t,e){return Ps(t,()=>t.getExtension(e),'Extension "'+e+'" not supported on this browser.')}function Rbe(t,e){const n=Ps(t,()=>t.createShader(t.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(je(t,()=>t.shaderSource(n,e)),je(t,()=>t.compileShader(n)),t.getShaderParameter(n,t.COMPILE_STATUS)===!1)throw console.log(t.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}function Mbe(t,e){const n=Ps(t,()=>t.createShader(t.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(je(t,()=>t.shaderSource(n,e)),je(t,()=>t.compileShader(n)),ce().get("ENGINE_COMPILE_ONLY"))return n;if(t.getShaderParameter(n,t.COMPILE_STATUS)===!1)throw A9(e,t.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}const Abe=/ERROR: [0-9]+:([0-9]+):/g;function A9(t,e){const n=Abe.exec(e);if(n==null){console.log(`Couldn't parse line number in error: ${e}`),console.log(t);return}const r=+n[1],a=t.split(`
`),i=a.length.toString().length+2,o=a.map((d,p)=>Hu((p+1).toString(),i)+d);let s=0;for(let d=0;d<o.length;d++)s=Math.max(o[d].length,s);const l=o.slice(0,r-1),u=o.slice(r-1,r),c=o.slice(r);console.log(l.join(`
`)),console.log(e.split(`
`)[0]),console.log(`%c ${Hu(u[0],s)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(c.join(`
`))}function Pbe(t){return Ps(t,()=>t.createProgram(),"Unable to create WebGLProgram.")}function Lbe(t,e){if(je(t,()=>t.linkProgram(e)),!ce().get("ENGINE_COMPILE_ONLY")&&t.getProgramParameter(e,t.LINK_STATUS)===!1)throw console.log(t.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}function P4(t,e){if(je(t,()=>t.validateProgram(e)),t.getProgramParameter(e,t.VALIDATE_STATUS)===!1)throw console.log(t.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function Dbe(t,e){const n=Ps(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return je(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),je(t,()=>t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW)),n}function Fbe(t,e){const n=Ps(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return je(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n)),je(t,()=>t.bufferData(t.ELEMENT_ARRAY_BUFFER,e,t.STATIC_DRAW)),n}function Bbe(t){return Ps(t,()=>t.createTexture(),"Unable to create WebGLTexture.")}function zbe(t,e){const n=ce().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t<=0||e<=0){const r=`[${t}x${e}]`;throw new Error("Requested texture size "+r+" is invalid.")}if(t>n||e>n){const r=`[${t}x${e}]`,a=`[${n}x${n}]`;throw new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU "+a+".")}}function jbe(t){return Ps(t,()=>t.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function P9(t,e,n,r,a,i,o){const s=t.getAttribLocation(e,n);return s===-1?!1:(je(t,()=>t.bindBuffer(t.ARRAY_BUFFER,r)),je(t,()=>t.vertexAttribPointer(s,a,t.FLOAT,!1,i,o)),je(t,()=>t.enableVertexAttribArray(s)),!0)}function Vbe(t,e,n){qbe(t,n),je(t,()=>t.activeTexture(t.TEXTURE0+n)),je(t,()=>t.bindTexture(t.TEXTURE_2D,e))}function Wbe(t,e,n){return Ps(t,()=>t.getUniformLocation(e,n),'uniform "'+n+'" not present in program.')}function Ube(t,e,n){return t.getUniformLocation(e,n)}function Gbe(t,e,n,r){je(t,()=>Vbe(t,e,r)),je(t,()=>t.uniform1i(n,r))}function L4(t,e,n){je(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,n)),je(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0))}function L9(t,e){je(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,e)),je(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0))}function p2(t){const e=t.checkFramebufferStatus(t.FRAMEBUFFER);if(e!==t.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+Hbe(t,e))}function Hbe(t,e){switch(e){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case t.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${e}`}}function Ps(t,e,n){const r=je(t,()=>e());if(r==null)throw new Error(n);return r}function qbe(t,e){const n=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=e+t.TEXTURE0;if(r<t.TEXTURE0||r>n){const a=`[gl.TEXTURE0, gl.TEXTURE${n}]`;throw new Error(`textureUnit must be in ${a}.`)}}function gp(t,e=2){return me(t.slice(0,t.length-e))}function mp(t){if(t.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[t.length>1?t[t.length-2]:1,t[t.length-1]]}function D4(t){let e=[1,1,1];return t.length===0||t.length===1&&t[0]===1||(e=[gp(t),...mp(t)]),e}function Kbe(t,e=!1){let n=ce().getNumber("WEBGL_MAX_TEXTURE_SIZE"),r=ce().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");r===1/0&&ce().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(r=n/2),e&&(n=n*2,r=r*2,t=t.map((s,l)=>l>=t.length-2?Nb(t[l]):t[l]),t.length===1&&(t=[2,t[0]])),t.length!==2&&(t=ks(t).newShape);let a=me(t),i=null;t.length<=1&&a<=n?i=[1,a]:t.length===2&&t[0]<=n&&t[1]<=n?i=t:t.length===3&&t[0]*t[1]<=n&&t[2]<=n?i=[t[0]*t[1],t[2]]:t.length===3&&t[0]<=n&&t[1]*t[2]<=n?i=[t[0],t[1]*t[2]]:t.length===4&&t[0]*t[1]*t[2]<=n&&t[3]<=n?i=[t[0]*t[1]*t[2],t[3]]:t.length===4&&t[0]<=n&&t[1]*t[2]*t[3]<=n&&(i=[t[0],t[1]*t[2]*t[3]]);const o=i!=null&&Math.max(...i)>r&&Math.min(...i)<=(e?2:1)&&Math.min(...i)>0;if(i==null||o)if(e){const s=gp(t);let l=2,u=2;t.length&&([l,u]=mp(t)),a=s*(l/2)*(u/2),i=Tb(a).map(c=>c*2)}else i=Tb(a);return i}function h2(t){return t%2===0}function f2(t,e){if(t=t.slice(-2),e=e.slice(-2),tn(t,e)||!t.length||!e.length||t[0]===0||t[1]===0||e[0]===0||e[1]===0)return!0;if(t.length!==e.length){const n=t.slice(-1)[0],r=e.slice(-1)[0];if(n===r||h2(n)&&h2(r)&&(t[0]===1||e[0]===1))return!0}return t[1]===e[1]&&h2(t[0])&&h2(e[0])}let F4,B4;function Xbe(t){if(F4==null){const e=po(t);F4=e.getParameter(e.MAX_TEXTURE_SIZE)}return F4}function Ybe(t){if(B4==null){const e=po(t);B4=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,B4)}function Qbe(t){if(t===0)return 0;let e;const n=po(t);return Pi(n,"EXT_disjoint_timer_query_webgl2")&&t===2?e=2:Pi(n,"EXT_disjoint_timer_query")?e=1:e=0,e}function Pi(t,e){return t.getExtension(e)!=null}function D9(t){try{if(po(t)!=null)return!0}catch(e){return console.log("Error when getting WebGL context: ",e),!1}return!1}function Zbe(t){if(t===0)return!1;const e=po(t);if(t===1){if(!Pi(e,"OES_texture_float"))return!1}else if(!Pi(e,"EXT_color_buffer_float"))return!1;return z4(e)}function Jbe(t){if(t===0)return!1;const e=po(t);if(t===1){if(!Pi(e,"OES_texture_float")||!Pi(e,"WEBGL_color_buffer_float"))return!1}else{if(Pi(e,"EXT_color_buffer_float"))return z4(e);const n="EXT_color_buffer_half_float";if(Pi(e,n)){const r=e.getExtension(n);return eve(e,r)}return!1}return z4(e)}function z4(t){const e=A4(t),n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n),t.texImage2D(t.TEXTURE_2D,0,e.internalFormatFloat,1,1,0,e.textureFormatFloat,e.textureTypeFloat,null);const i=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,i),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0);const o=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(n),t.deleteFramebuffer(i),o}function eve(t,e){const n=A4(t,e),r=t.createTexture();t.bindTexture(t.TEXTURE_2D,r),t.texImage2D(t.TEXTURE_2D,0,n.internalFormatHalfFloat,1,1,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);const o=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,o),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0);const s=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(r),t.deleteFramebuffer(o),s}function tve(t){return t!==2?!1:po(t).fenceSync!=null}function im(t,e){Array.isArray(t)||(t=[t]),t.forEach(n=>{n!=null&&j(n.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the WebGL backend.`)})}/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Ue=ce();Ue.registerFlag("HAS_WEBGL",()=>Ue.getNumber("WEBGL_VERSION")>0),Ue.registerFlag("WEBGL_VERSION",()=>D9(2)?2:D9(1)?1:0),Ue.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1),Ue.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>Ue.get("WEBGL_VERSION")===2),Ue.registerFlag("WEBGL_CPU_FORWARD",()=>!0),Ue.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1),Ue.registerFlag("WEBGL_PACK",()=>Ue.getBool("HAS_WEBGL")),Ue.registerFlag("WEBGL_PACK_NORMALIZATION",()=>Ue.getBool("WEBGL_PACK")),Ue.registerFlag("WEBGL_PACK_CLIP",()=>Ue.getBool("WEBGL_PACK")),Ue.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>Ue.getBool("WEBGL_PACK")),Ue.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>Ue.getBool("WEBGL_PACK")),Ue.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>Ue.getBool("WEBGL_PACK")),Ue.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>Ue.getBool("WEBGL_PACK")),Ue.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>Ue.getBool("WEBGL_PACK")),Ue.registerFlag("WEBGL_PACK_REDUCE",()=>Ue.getBool("WEBGL_PACK")),Ue.registerFlag("WEBGL_LAZILY_UNPACK",()=>Ue.getBool("WEBGL_PACK")),Ue.registerFlag("WEBGL_CONV_IM2COL",()=>Ue.getBool("WEBGL_PACK")),Ue.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>Xbe(Ue.getNumber("WEBGL_VERSION"))),Ue.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>Ybe(Ue.getNumber("WEBGL_VERSION"))),Ue.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const t=Ue.getNumber("WEBGL_VERSION");return t===0?0:Qbe(t)}),Ue.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>Ue.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!bT()),Ue.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>Zbe(Ue.getNumber("WEBGL_VERSION"))),Ue.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>Ue.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:Ue.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")),Ue.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>Jbe(Ue.getNumber("WEBGL_VERSION"))),Ue.registerFlag("WEBGL_FENCE_API_ENABLED",()=>tve(Ue.getNumber("WEBGL_VERSION"))),Ue.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>Ue.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0),Ue.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,t=>{if(t<0&&t!==-1)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${t}.`)}),Ue.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>bT()?1:-1,t=>{if(t<0&&t!==-1)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${t}.`)}),Ue.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128),Ue.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1),Ue.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5),Ue.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128),Ue.registerFlag("WEBGL_EXP_CONV",()=>!1),Ue.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>Ue.getBool("IS_TEST")),Ue.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0),Ue.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1),Ue.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1);/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function ua(){let t,e,n,r,a,i,o,s,l,u;return ce().getNumber("WEBGL_VERSION")===2?(t="#version 300 es",e="in",n="out",r="in",a="texture",i="outputColor",o="out vec4 outputColor;",s=ce().getBool("WEBGL2_ISNAN_CUSTOM")?`
      bool isnan_custom(float val) {
        uint floatToUint = floatBitsToUint(val);
        return (floatToUint & 0x7fffffffu) > 0x7f800000u;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `:"",l="",u=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(t="",e="attribute",n="varying",r="varying",a="texture2D",i="gl_FragColor",o="",s=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,l=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,u=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:t,attribute:e,varyingVs:n,varyingFs:r,texture2D:a,output:i,defineOutput:o,defineSpecialNaN:s,defineSpecialInf:l,defineRound:u}}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function hc(t,e,n="index"){const r=qe(e);return r.map((a,i)=>{const o=`int ${t[i]} = ${n} / ${a}`,s=i===r.length-1?`int ${t[i+1]} = ${n} - ${t[i]} * ${a}`:`index -= ${t[i]} * ${a}`;return`${o}; ${s};`}).join("")}function g2(t,e,n="index"){const r=qe(e);return r.map((a,i)=>{const o=`int ${t[i]} = ${n} / outShapeStrides[${i}]`,s=i===r.length-1?`int ${t[i+1]} = ${n} - ${t[i]} * outShapeStrides[${i}]`:`index -= ${t[i]} * outShapeStrides[${i}]`;return`${o}; ${s};`}).join("")}function nve(t,e){const n=t.length,r=t.map(i=>`${e}[${i}]`),a=new Array(n-1);a[n-2]=r[n-1];for(let i=n-3;i>=0;--i)a[i]=`(${a[i+1]} * ${r[i+1]})`;return a}function rve(t,e,n="index"){const r=t.map((i,o)=>o),a=nve(r,e);return a.map((i,o)=>{const s=`int ${t[o]} = ${n} / ${a[o]}`,l=o===a.length-1?`int ${t[o+1]} = ${n} - ${t[o]} * ${a[o]}`:`index -= ${t[o]} * ${a[o]}`;return`${s}; ${l};`}).join("")}function j4(t){const e=qe(t).map(n=>n.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${e[0]} + coords.y * ${e[1]} + coords.z;
  }
`}function V4(){return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`}const F9=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const{getBroadcastDims:B9}=cF;function ave(t,e,n){const r=[];if(t.forEach(p=>{const f=me(p.shapeInfo.logicalShape);if(p.shapeInfo.isUniform?r.push(`uniform float ${p.name}${f>1?`[${f}]`:""};`):(r.push(`uniform sampler2D ${p.name};`),r.push(`uniform int offset${p.name};`)),n.enableShapeUniforms){const{uniformShape:m}=W4(n.packedInputs,p.shapeInfo.logicalShape,p.shapeInfo.texShape);switch(m.length){case 1:r.push(`uniform int ${p.name}Shape;`);break;case 2:r.push(`uniform ivec2 ${p.name}Shape;`);break;case 3:r.push(`uniform ivec3 ${p.name}Shape;`);break;case 4:r.push(`uniform ivec4 ${p.name}Shape;`);break}r.push(`uniform ivec2 ${p.name}TexShape;`)}}),n.enableShapeUniforms){switch(e.logicalShape.length){case 1:r.push("uniform int outShape;");break;case 2:r.push("uniform ivec2 outShape;"),r.push("uniform int outShapeStrides;");break;case 3:r.push("uniform ivec3 outShape;"),r.push("uniform ivec2 outShapeStrides;");break;case 4:r.push("uniform ivec4 outShape;"),r.push("uniform ivec3 outShapeStrides;");break}r.push("uniform ivec2 outTexShape;")}n.customUniforms&&n.customUniforms.forEach(p=>{r.push(`uniform ${p.type} ${p.name}${p.arrayIndex?`[${p.arrayIndex}]`:""};`)});const a=r.join(`
`),i=t.map(p=>ive(p,e,n.packedInputs,n.enableShapeUniforms)).join(`
`),o=e.texShape,s=ua(),l=lve(s);let u,c,d=dve(s);return e.isPacked?(u=ove(e.logicalShape,o,n.enableShapeUniforms),c=cve(s)):(u=sve(e.logicalShape,o,n.enableShapeUniforms),c=uve(s)),n.packedInputs&&(d+=gve),[d,l,c,a,u,i,n.userCode].join(`
`)}function yp(t,e=!1){const n=t.shapeInfo.logicalShape;switch(n.length){case 0:return Ive(t,e);case 1:return _ve(t,e);case 2:return $ve(t,e);case 3:return Mve(t,e);case 4:return Pve(t,e);case 5:return Lve(t);case 6:return Dve(t);default:throw new Error(`${n.length}-D input sampling is not yet supported`)}}function z9(t,e){switch(t.shapeInfo.logicalShape.length){case 0:return Tve(t);case 1:return Eve(t,e);case 2:return Ove(t,e);case 3:return Rve(t,e);default:return Ave(t,e)}}function ive(t,e,n=!1,r){let a="";n?a+=z9(t,r):a+=yp(t,r);const i=t.shapeInfo.logicalShape,o=e.logicalShape;return i.length<=o.length&&(n?a+=Fve(t,e):a+=Bve(t,e)),a}function ove(t,e,n){switch(t.length){case 0:return j9();case 1:return mve(t,e,n);case 2:return Cve(t,e,n);case 3:return bve(t,e,n);default:return xve(t,e,n)}}function sve(t,e,n){switch(t.length){case 0:return j9();case 1:return yve(t,e,n);case 2:return Nve(t,e,n);case 3:return vve(t,e,n);case 4:return wve(t,e,n);case 5:return kve(t,e);case 6:return Sve(t,e);default:throw new Error(`${t.length}-D output sampling is not yet supported`)}}function lve(t){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return ${t.texture2D}(textureSampler, uv).r;
    }
  `}function uve(t){return`
    void setOutput(float val) {
      ${t.output} = vec4(val, 0, 0, 0);
    }
  `}function cve(t){return`
    void setOutput(vec4 val) {
      ${t.output} = val;
    }
  `}function dve(t){return`${t.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${t.varyingFs} vec2 resultUV;
    ${t.defineOutput}
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    ${t.defineSpecialNaN}
    ${t.defineSpecialInf}
    ${t.defineRound}

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${pve}
    ${hve}
    ${fve}
  `}const pve=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,hve=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,fve=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,gve=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function j9(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function mve(t,e,n){const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];return r[0]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ${r[1]}.0);
      }
    `:r[1]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ${r[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      return 2 * (resTexRC.x * ${r[1]} + resTexRC.y);
    }
  `}function yve(t,e,n){return e[0]===1?n?`
      int getOutputCoords() {
        return int(resultUV.x * float(outTexShape[1]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.x * ${e[1]}.0);
      }
    `:e[1]===1?n?`
      int getOutputCoords() {
        return int(resultUV.y * float(outTexShape[0]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.y * ${e[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      return resTexRC.x * outTexShape[1] + resTexRC.y;
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      return resTexRC.x * ${e[1]} + resTexRC.y;
    }
  `}function bve(t,e,n){if(n)return`
    ivec3 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec3(b, r, c);
    }
  `;const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],a=Math.ceil(t[2]/2),i=a*Math.ceil(t[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      int index = resTexRC.x * ${r[1]} + resTexRC.y;

      int b = index / ${i};
      index -= b * ${i};

      int r = 2 * (index / ${a});
      int c = imod(index, ${a}) * 2;

      return ivec3(b, r, c);
    }
  `}function vve(t,e,n){if(n)return`
  ivec3 getOutputCoords() {
    ivec2 resTexRC = ivec2(resultUV.yx *
                           vec2(outTexShape[0], outTexShape[1]));
    int index = resTexRC.x * outTexShape[1] + resTexRC.y;
    ${g2(["r","c","d"],t)}
    return ivec3(r, c, d);
  }
`;const r=hc(["r","c","d"],t);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${r}
      return ivec3(r, c, d);
    }
  `}function xve(t,e,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatchN = texelsInBatch * outShape[1];

      int b2 = index / texelsInBatchN;
      index -= b2 * texelsInBatchN;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec4(b2, b, r, c);
    }
  `;const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],a=Math.ceil(t[t.length-1]/2),i=a*Math.ceil(t[t.length-2]/2);let o=i,s="",l="b, r, c";for(let u=2;u<t.length-1;u++)o*=t[t.length-u-1],s=`
      int b${u} = index / ${o};
      index -= b${u} * ${o};
    `+s,l=`b${u}, `+l;return`
    ivec${t.length} getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      int index = resTexRC.x * ${r[1]} + resTexRC.y;

      ${s}

      int b = index / ${i};
      index -= b * ${i};

      int r = 2 * (index / ${a});
      int c = imod(index, ${a}) * 2;

      return ivec${t.length}(${l});
    }
  `}function wve(t,e,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      ${g2(["r","c","d","d2"],t)}
      return ivec4(r, c, d, d2);
    }
  `;const r=hc(["r","c","d","d2"],t);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${r}
      return ivec4(r, c, d, d2);
    }
  `}function kve(t,e){const n=hc(["r","c","d","d2","d3"],t);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${e[0]},
                             ${e[1]}));

      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${n}

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}function Sve(t,e){const n=hc(["r","c","d","d2","d3","d4"],t);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${n}

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}function Cve(t,e,n){const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(tn(t,e))return n?`
      ivec2 getOutputCoords() {
        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(${r[0]}, ${r[1]}));
      }
    `;const a=Math.ceil(t[1]/2);return n?`
    ivec2 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));

      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;
      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));

      int index = resTexRC.x * ${r[1]} + resTexRC.y;
      int r = 2 * (index / ${a});
      int c = imod(index, ${a}) * 2;

      return ivec2(r, c);
    }
  `}function Nve(t,e,n){return tn(t,e)?n?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(${e[0]}, ${e[1]}));
      }
    `:t[1]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(index, 0);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(index, 0);
      }
    `:t[0]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(0, index);
      }
    `:n?`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      int r = index / outShape[1];
      int c = index - r * outShape[1];
      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      int r = index / ${t[1]};
      int c = index - r * ${t[1]};
      return ivec2(r, c);
    }
  `}function fc(t){return`offset${t}`}function Tve(t){const e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),r=ua();return`
    vec4 ${n}() {
      return ${r.texture2D}(${e}, halfCR);
    }
  `}function Ive(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`float ${r}() {return ${n};}`;const[a,i]=t.shapeInfo.texShape;if(a===1&&i===1)return`
      float ${r}() {
        return sampleTexture(${n}, halfCR);
      }
    `;const o=fc(n);if(e)return`
    float ${r}() {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], ${o});
      return sampleTexture(${n}, uv);
    }
  `;const[s,l]=t.shapeInfo.texShape;return`
    float ${r}() {
      vec2 uv = uvFromFlat(${s}, ${l}, ${o});
      return sampleTexture(${n}, uv);
    }
  `}function Eve(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=t.shapeInfo.texShape,i=ua();if(e)return`
    vec4 ${r}(int index) {
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      vec2 uv = packedUVfrom1D(
        packedTexShape[0], packedTexShape[1], index);
      return ${i.texture2D}(${n}, uv);
    }
  `;const o=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)];return`
    vec4 ${r}(int index) {
      vec2 uv = packedUVfrom1D(
        ${o[0]}, ${o[1]}, index);
      return ${i.texture2D}(${n}, uv);
    }
  `}function _ve(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`
      float ${r}(int index) {
        ${bp(t)}
      }
    `;const a=t.shapeInfo.texShape,i=a[0],o=a[1];if(o===1&&i===1)return`
      float ${r}(int index) {
        return sampleTexture(${n}, halfCR);
      }
    `;const s=fc(n);return o===1?e?`
      float ${r}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${s}) + 0.5) / float(${n}TexShape[0]));
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${r}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${s}) + 0.5) / ${i}.0);
        return sampleTexture(${n}, uv);
      }
    `:i===1?e?`
      float ${r}(int index) {
        vec2 uv = vec2((float(index + ${s}) + 0.5) / float(${n}TexShape[1]), 0.5);
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${r}(int index) {
        vec2 uv = vec2((float(index + ${s}) + 0.5) / ${o}.0, 0.5);
        return sampleTexture(${n}, uv);
      }
    `:e?`
    float ${r}(int index) {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], index + ${s});
      return sampleTexture(${n}, uv);
    }
  `:`
    float ${r}(int index) {
      vec2 uv = uvFromFlat(${i}, ${o}, index + ${s});
      return sampleTexture(${n}, uv);
    }
  `}function Ove(t,e){const n=t.shapeInfo.logicalShape,r=t.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=t.shapeInfo.texShape,o=i[0],s=i[1],l=ua();if(i!=null&&tn(n,i))return e?`
      vec4 ${a}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);

        return ${l.texture2D}(${r}, uv);
      }
    `:`
      vec4 ${a}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${s}.0, ${o}.0);

        return ${l.texture2D}(${r}, uv);
      }
    `;if(e)return`
    vec4 ${a}(int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${r}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);
      return ${l.texture2D}(${r}, uv);
    }
  `;const u=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)],c=Math.ceil(n[1]/2);return`
    vec4 ${a}(int row, int col) {
      vec2 uv = packedUVfrom2D(${c}, ${u[0]}, ${u[1]}, row, col);
      return ${l.texture2D}(${r}, uv);
    }
  `}function $ve(t,e){const n=t.shapeInfo.logicalShape,r=t.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=t.shapeInfo.texShape;if(i!=null&&tn(n,i)){if(e)return`
      float ${a}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `;const p=i[0],f=i[1];return`
    float ${a}(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(${f}.0, ${p}.0);
      return sampleTexture(${r}, uv);
    }
  `}const{newShape:o,keptDims:s}=ks(n),l=o;if(l.length<n.length){const p=vp(t,l),f=["row","col"];return`
      ${yp(p,e)}
      float ${a}(int row, int col) {
        return ${a}(${xp(f,s)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${a}(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(${n[1]}, 1)));
        ${bp(t)}
      }
    `;const u=i[0],c=i[1],d=fc(r);return c===1?e?`
      float ${a}(int row, int col) {
        float index = dot(vec3(row, col, ${d}), vec3(${r}Shape[1], 1, 1));
        vec2 uv = vec2(0.5, (index + 0.5) / float(${r}TexShape[0]));
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${a}(int row, int col) {
      float index = dot(vec3(row, col, ${d}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / ${u}.0);
      return sampleTexture(${r}, uv);
    }
  `:u===1?e?`
      float ${a}(int row, int col) {
        float index = dot(vec3(row, col, ${d}), vec3(${r}Shape[1], 1, 1));
        vec2 uv = vec2((index + 0.5) / float(${r}TexShape[1]), 0.5);
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${a}(int row, int col) {
      float index = dot(vec3(row, col, ${d}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2((index + 0.5) / ${c}.0, 0.5);
      return sampleTexture(${r}, uv);
    }
  `:e?`
      float ${a}(int row, int col) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${r}Shape[1] + col + ${d};
        vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);
        return sampleTexture(${r}, uv);
      }
    `:`
  float ${a}(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * ${n[1]} + col + ${d};
    vec2 uv = uvFromFlat(${u}, ${c}, index);
    return sampleTexture(${r}, uv);
  }
`}function Rve(t,e){const n=t.shapeInfo.logicalShape,r=t.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=t.shapeInfo.texShape,o=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];if(n[0]===1){const p=n.slice(1),f=[1,2],m=vp(t,p),y=["b","row","col"];return`
        ${z9(m,e)}
        vec4 ${a}(int b, int row, int col) {
          return ${a}(${xp(y,f)});
        }
      `}const s=ua();if(e)return`
    vec4 ${a}(int b, int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${r}Shape[2]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${r}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom3D(
        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);
      return ${s.texture2D}(${r}, uv);
    }
  `;const l=o[0],u=o[1],c=Math.ceil(n[2]/2),d=c*Math.ceil(n[1]/2);return`
    vec4 ${a}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${l}, ${u}, ${d}, ${c}, b, row, col);
      return ${s.texture2D}(${r}, uv);
    }
  `}function Mve(t,e){const n=t.shapeInfo.logicalShape,r=t.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=n[1]*n[2],o=n[2],{newShape:s,keptDims:l}=ks(n),u=s;if(u.length<n.length){const y=vp(t,u),x=["row","col","depth"];return`
        ${yp(y,e)}
        float ${a}(int row, int col, int depth) {
          return ${a}(${xp(x,l)});
        }
      `}if(t.shapeInfo.isUniform)return`
      float ${a}(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(${i}, ${o}, 1)));
        ${bp(t)}
      }
    `;const c=t.shapeInfo.texShape,d=c[0],p=c[1],f=t.shapeInfo.flatOffset;if(p===i&&f==null)return e?`
      float ${a}(int row, int col, int depth) {
        int stride1 = ${r}Shape[2];
        float texR = float(row);
        float texC = dot(vec2(col, depth), vec2(stride1, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
        float ${a}(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(${o}, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(${p}.0, ${d}.0);
          return sampleTexture(${r}, uv);
        }
      `;if(p===o&&f==null)return e?`
      float ${a}(int row, int col, int depth) {
        float texR = dot(vec2(row, col), vec2(${r}Shape[1], 1));
        float texC = float(depth);
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${a}(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(${n[1]}, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${p}.0, ${d}.0);
      return sampleTexture(${r}, uv);
    }
  `;const m=fc(r);return e?`
    float ${a}(int row, int col, int depth) {
      // Explicitly use integer operations as dot() only works on floats.
      int stride0 = ${r}Shape[1] * ${r}Shape[2];
      int stride1 = ${r}Shape[2];
      int index = row * stride0 + col * stride1 + depth + ${m};
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);
      return sampleTexture(${r}, uv);
    }
    `:`
      float ${a}(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${i} + col * ${o} + depth + ${m};
        vec2 uv = uvFromFlat(${d}, ${p}, index);
        return sampleTexture(${r}, uv);
      }
  `}function Ave(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=ua();if(e)return`
    vec4 ${r}(int b2, int b, int row, int col) {
      int valuesPerRow = int(ceil(float(${n}Shape[3]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${n}Shape[2]) / 2.0));
      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);
      texelsInBatch *= ${n}Shape[1];
      index = b2 * texelsInBatch + index;
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      int texR = index / packedTexShape[1];
      int texC = index - texR * packedTexShape[1];
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${a.texture2D}(${n}, uv);
    }
  `;const i=t.shapeInfo.logicalShape,o=i.length,s=t.shapeInfo.texShape,l=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)],u=l[0],c=l[1],d=Math.ceil(i[o-1]/2);let p=d*Math.ceil(i[o-2]/2),f="int b, int row, int col",m=`b * ${p} + (row / 2) * ${d} + (col / 2)`;for(let y=2;y<o-1;y++)f=`int b${y}, `+f,p*=i[o-y-1],m=`b${y} * ${p} + `+m;return`
    vec4 ${r}(${f}) {
      int index = ${m};
      int texR = index / ${c};
      int texC = index - texR * ${c};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${c}, ${u});
      return ${a.texture2D}(${n}, uv);
    }
  `}function Pve(t,e){const n=t.shapeInfo.logicalShape,r=t.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=n[3],o=n[2]*i,s=n[1]*o,{newShape:l,keptDims:u}=ks(n);if(l.length<n.length){const v=vp(t,l),w=["row","col","depth","depth2"];return`
      ${yp(v,e)}
      float ${a}(int row, int col, int depth, int depth2) {
        return ${a}(${xp(w,u)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${a}(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(${s}, ${o}, ${i}, 1)));
        ${bp(t)}
      }
    `;const c=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,p=d[0],f=d[1],m=`int stride2 = ${r}Shape[3];`,y=`int stride1 = ${r}Shape[2] * stride2;`,x=`int stride0 = ${r}Shape[1] * stride1;`;if(f===s&&c==null)return e?`
      float ${a}(int row, int col, int depth, int depth2) {
        ${m}
        ${y}
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(stride1, stride2, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${a}(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(${o}, ${i}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${f}.0, ${p}.0);
        return sampleTexture(${r}, uv);
      }
    `;if(f===i&&c==null)return e?`
      float ${a}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${r}Shape[1] * ${r}Shape[2], ${r}Shape[2], 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${a}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${n[1]*n[2]}, ${n[2]}, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${f}.0, ${p}.0);
        return sampleTexture(${r}, uv);
      }
    `;const b=fc(r);return e?`
    float ${a}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      ${m}
      ${y}
      ${x}
      int index = row * stride0 + col * stride1 +
          depth * stride2 + depth2;
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index + ${b});
      return sampleTexture(${r}, uv);
    }
  `:`
    float ${a}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${s} + col * ${o} +
          depth * ${i} + depth2;
      vec2 uv = uvFromFlat(${p}, ${f}, index + ${b});
      return sampleTexture(${r}, uv);
    }
  `}function Lve(t){const e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=e[4],i=e[3]*a,o=e[2]*i,s=e[1]*o,{newShape:l,keptDims:u}=ks(e);if(l.length<e.length){const y=vp(t,l),x=["row","col","depth","depth2","depth3"];return`
      ${yp(y)}
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        return ${r}(${xp(x,u)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(${s}, ${o}, ${i}, ${a})) +
          depth3;
        ${bp(t)}
      }
    `;const c=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,p=d[0],f=d[1];if(f===s&&c==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(${o}, ${i}, ${a}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${f}.0, ${p}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(f===a&&c==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]},
               ${e[2]*e[3]}, ${e[3]}, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${f}.0, ${p}.0);
        return sampleTexture(${n}, uv);
      }
    `;const m=fc(n);return`
    float ${r}(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${s} + col * ${o} + depth * ${i} +
          depth2 * ${a} + depth3 + ${m};
      vec2 uv = uvFromFlat(${p}, ${f}, index);
      return sampleTexture(${n}, uv);
    }
  `}function Dve(t){const e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),{newShape:a,keptDims:i}=ks(e);if(a.length<e.length){const x=vp(t,a),b=["row","col","depth","depth2","depth3","depth4"];return`
      ${yp(x)}
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return ${r}(${xp(b,i)});
      }
    `}const o=e[5],s=e[4]*o,l=e[3]*s,u=e[2]*l,c=e[1]*u;if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(${c}, ${u}, ${l}, ${s})) +
          dot(
            vec2(depth3, depth4),
            vec2(${o}, 1)));
        ${bp(t)}
      }
    `;const d=t.shapeInfo.flatOffset,p=t.shapeInfo.texShape,f=p[0],m=p[1];if(m===c&&d==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(${u}, ${l}, ${s}, ${o})) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${m}.0, ${f}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(m===o&&d==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]*e[4]},
               ${e[2]*e[3]*e[4]},
               ${e[3]*e[4]},
               ${e[4]})) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${m}.0, ${f}.0);
        return sampleTexture(${n}, uv);
      }
    `;const y=fc(n);return`
    float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${c} + col * ${u} + depth * ${l} +
          depth2 * ${s} + depth3 * ${o} + depth4 + ${y};
      vec2 uv = uvFromFlat(${f}, ${m}, index);
      return sampleTexture(${n}, uv);
    }
  `}function bp(t){const e=t.name,n=me(t.shapeInfo.logicalShape);return n<2?`return ${e};`:`
    for (int i = 0; i < ${n}; i++) {
      if (i == index) {
        return ${e}[i];
      }
    }
  `}function Fve(t,e){const n=t.name,r=n.charAt(0).toUpperCase()+n.slice(1),a="get"+r+"AtOutCoords",i=t.shapeInfo.logicalShape.length,o=e.logicalShape.length,s=B9(t.shapeInfo.logicalShape,e.logicalShape),l=pn(o),u=o-i;let c;const d=["x","y","z","w","u","v"];i===0?c="":o<2&&s.length>=1?c="coords = 0;":c=s.map(x=>`coords.${d[x+u]} = 0;`).join(`
`);let p="";o<2&&i>0?p="coords":p=t.shapeInfo.logicalShape.map((x,b)=>`coords.${d[b+u]}`).join(", ");let f="return outputValue;";const m=me(t.shapeInfo.logicalShape)===1,y=me(e.logicalShape)===1;if(i===1&&!m&&!y)f=`
      return vec4(outputValue.xy, outputValue.xy);
    `;else if(m&&!y)o===1?f=`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:f=`
        return vec4(outputValue.x);
      `;else if(s.length){const x=i-2,b=i-1;s.indexOf(x)>-1&&s.indexOf(b)>-1?f="return vec4(outputValue.x);":s.indexOf(x)>-1?f="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":s.indexOf(b)>-1&&(f="return vec4(outputValue.xx, outputValue.zz);")}return`
    vec4 ${a}() {
      ${l} coords = getOutputCoords();
      ${c}
      vec4 outputValue = get${r}(${p});
      ${f}
    }
  `}function Bve(t,e){const n=t.name,r=n.charAt(0).toUpperCase()+n.slice(1),a="get"+r+"AtOutCoords",i=e.texShape,o=t.shapeInfo.texShape,s=t.shapeInfo.logicalShape.length,l=e.logicalShape.length;if(!t.shapeInfo.isUniform&&s===l&&t.shapeInfo.flatOffset==null&&tn(o,i))return`
      float ${a}() {
        return sampleTexture(${n}, resultUV);
      }
    `;const u=pn(l),c=B9(t.shapeInfo.logicalShape,e.logicalShape),d=l-s;let p;const f=["x","y","z","w","u","v"];s===0?p="":l<2&&c.length>=1?p="coords = 0;":p=c.map(y=>`coords.${f[y+d]} = 0;`).join(`
`);let m="";return l<2&&s>0?m="coords":m=t.shapeInfo.logicalShape.map((y,x)=>`coords.${f[x+d]}`).join(", "),`
    float ${a}() {
      ${u} coords = getOutputCoords();
      ${p}
      return get${r}(${m});
    }
  `}function pn(t){if(t<=1)return"int";if(t===2)return"ivec2";if(t===3)return"ivec3";if(t===4)return"ivec4";if(t===5)return"ivec5";if(t===6)return"ivec6";throw Error(`GPU for rank ${t} is not yet supported`)}function W4(t,e,n){const{newShape:r,keptDims:a}=ks(e),i=e.length,o=t&&i===3&&e[0]===1,s=o?e.slice(1):r,l=!t&&i>1&&!tn(e,n)&&r.length<i||o;return{useSqueezeShape:l,uniformShape:l?s:e,keptDims:a}}function vp(t,e){const n=JSON.parse(JSON.stringify(t));return n.shapeInfo.logicalShape=e,n}function xp(t,e){return e.map(n=>t[n]).join(", ")}/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function zve(t,e,n,r){const a=n.map((c,d)=>{const p={logicalShape:c.shape,texShape:c.isUniform?null:c.texData.texShape,isUniform:c.isUniform,isPacked:c.isUniform?!1:c.texData.isPacked,flatOffset:null};return c.texData!=null&&c.texData.slice!=null&&c.texData.slice.flatOffset>0&&(p.flatOffset=c.texData.slice.flatOffset),{name:e.variableNames[d],shapeInfo:p}}),i=a.map(c=>c.shapeInfo),o={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},s=ave(a,o,e),l=Mbe(t.gl,s),u=t.createProgram(l);return ce().get("ENGINE_COMPILE_ONLY")?{program:e,fragmentShader:l,source:s,webGLProgram:u,inShapeInfos:i,outShapeInfo:o,uniformLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,inShapesLocations:null,inTexShapesLocations:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:Object.assign({program:e,fragmentShader:l,source:s,webGLProgram:u,inShapeInfos:i,outShapeInfo:o},V9(t,e,u))}function V9(t,e,n){const r={},a={},i={},o=[];let s,l,u,c=null,d=null;d=t.getUniformLocation(n,"NAN",!1),ce().getNumber("WEBGL_VERSION")===1&&(c=t.getUniformLocation(n,"INFINITY",!1));const p=!1;for(let f=0;f<e.variableNames.length;f++){const m=e.variableNames[f];r[m]=t.getUniformLocation(n,m,p),r[`offset${m}`]=t.getUniformLocation(n,`offset${m}`,p),e.enableShapeUniforms&&(a[`${m}Shape`]=t.getUniformLocation(n,`${m}Shape`,p),i[`${m}TexShape`]=t.getUniformLocation(n,`${m}TexShape`,p))}return e.enableShapeUniforms&&(s=t.getUniformLocation(n,"outShape",p),u=t.getUniformLocation(n,"outShapeStrides",p),l=t.getUniformLocation(n,"outTexShape",p)),e.customUniforms&&e.customUniforms.forEach((f,m)=>{o[m]=t.getUniformLocation(n,f.name,p)}),{uniformLocations:r,customUniformLocations:o,infLoc:c,nanLoc:d,inShapesLocations:a,inTexShapesLocations:i,outShapeLocation:s,outShapeStridesLocation:u,outTexShapeLocation:l}}function W9(t,e){if(t.length!==e.length)throw Error(`Binary was compiled with ${t.length} inputs, but was executed with ${e.length} inputs`);t.forEach((n,r)=>{const a=n.logicalShape,i=e[r],o=i.shape;if(!tn(a,o))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${a} and ${o} must match`);if(n.isUniform&&i.isUniform)return;const s=n.texShape,l=i.isUniform?null:i.texData.texShape;if(!tn(s,l))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${s} and ${l} must match`)})}function jve(t,e,n,r,a){e.program.enableShapeUniforms||(W9(e.inShapeInfos,n),W9([e.outShapeInfo],[r]));const i=r.texData.texture,o=r.texData.texShape;r.texData.isPacked?t.setOutputPackedMatrixTexture(i.texture,o[0],o[1]):t.setOutputMatrixTexture(i.texture,o[0],o[1]),t.setProgram(e.webGLProgram),ce().getNumber("WEBGL_VERSION")===1&&e.infLoc!==null&&t.gl.uniform1f(e.infLoc,1/0),e.nanLoc!==null&&t.gl.uniform1f(e.nanLoc,NaN),n.forEach((l,u)=>{const c=e.program.variableNames[u],d=e.uniformLocations[c],p=e.uniformLocations[`offset${c}`],f=e.inShapesLocations[`${c}Shape`],m=e.inTexShapesLocations[`${c}TexShape`];if(f){const{uniformShape:y}=W4(e.program.packedInputs,l.shape,l.texData.texShape);switch(y.length){case 1:t.gl.uniform1iv(f,new Int32Array(y));break;case 2:t.gl.uniform2iv(f,new Int32Array(y));break;case 3:t.gl.uniform3iv(f,new Int32Array(y));break;case 4:t.gl.uniform4iv(f,new Int32Array(y));break}}if(m&&t.gl.uniform2i(m,l.texData.texShape[0],l.texData.texShape[1]),d!=null){if(l.isUniform){if(me(l.shape)<2)t.gl.uniform1f(d,l.uniformValues[0]);else{let y=l.uniformValues;y instanceof Float32Array||(y=new Float32Array(y)),t.gl.uniform1fv(d,y)}return}l.texData.slice!=null&&p!=null&&t.gl.uniform1i(p,l.texData.slice.flatOffset),t.setInputMatrixTexture(l.texData.texture.texture,d,u)}});const s=e.outShapeLocation;if(s)switch(r.shape.length){case 1:t.gl.uniform1iv(s,new Int32Array(r.shape));break;case 2:t.gl.uniform2iv(s,new Int32Array(r.shape));break;case 3:t.gl.uniform3iv(s,new Int32Array(r.shape));break;case 4:t.gl.uniform4iv(s,new Int32Array(r.shape));break}if(e.outShapeStridesLocation){const l=qe(r.shape);switch(r.shape.length){case 2:t.gl.uniform1iv(e.outShapeStridesLocation,new Int32Array(l));break;case 3:t.gl.uniform2iv(e.outShapeStridesLocation,new Int32Array(l));break;case 4:t.gl.uniform3iv(e.outShapeStridesLocation,new Int32Array(l));break}}e.outTexShapeLocation&&t.gl.uniform2i(e.outTexShapeLocation,r.texData.texShape[0],r.texData.texShape[1]),e.program.customUniforms&&a&&e.program.customUniforms.forEach((l,u)=>{const c=e.customUniformLocations[u],d=a[u];if(l.type==="float")t.gl.uniform1fv(c,d);else if(l.type==="vec2")t.gl.uniform2fv(c,d);else if(l.type==="vec3")t.gl.uniform3fv(c,d);else if(l.type==="vec4")t.gl.uniform4fv(c,d);else if(l.type==="int")t.gl.uniform1iv(c,d);else if(l.type==="ivec2")t.gl.uniform2iv(c,d);else if(l.type==="ivec3")t.gl.uniform3iv(c,d);else if(l.type==="ivec4")t.gl.uniform4iv(c,d);else throw Error(`uniform type ${l.type} is not supported yet.`)}),t.executeProgram()}function Vve(t,e,n){let r="";e.concat(n).forEach(o=>{const s=o.texData!=null&&o.texData.slice!=null&&o.texData.slice.flatOffset>0;if(t.enableShapeUniforms&&!o.isUniform){const l=o.texData.texShape,{useSqueezeShape:u,uniformShape:c,keptDims:d}=W4(t.packedInputs,o.shape,l);let p="",f="",m="";if(c.length===1&&t.packedInputs){const C=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)];p=`${C[0]>1}_${C[1]>1}`}else if(c.length===2&&!t.packedInputs)f=`${c[0]>1}_${c[1]>1}`;else if(c.length>2&&!t.packedInputs){const C=qe(c);m=`${C[0]===l[1]}_${C[C.length-1]===l[1]}`}const y=o.shape.length,x=c.length===2&&tn(o.shape,l),b=me(o.shape)===1,v=nc(o.shape,n.shape),w=!t.packedInputs&&y===n.shape.length&&tn(l,n.texData.texShape),S=t.packedInputs||c.length>2?"":`${l[0]>1}_${l[1]>1}`;r+=`${y}_${w}_${u?d:""}_${c.length}_${b}_${v}_${x}_${p}_${f}_${m}_${S}_${s}`}else{const l=o.isUniform?"uniform":o.texData.texShape;r+=`${o.shape}_${l}_${s}`}});const a=t.userCode;let i=t.constructor.name;return i+="_"+r+"_"+a+`${ce().getNumber("WEBGL_VERSION")}`,i}function ca(t){return ce().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&t<=4}/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class Wve{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=rm.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=ua();this.outputShape=e,this.enableShapeUniforms=ca(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?g2(["r","c","d"],e):hc(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${n.output} = result;
      }
    `}}/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class Uve{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=rm.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=ua();this.outputShape=e,this.enableShapeUniforms=ca(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?g2(["r","c","d"],e):hc(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${n.output} = result;
      }
    `}}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class Gve{constructor(e){this.variableNames=["A"],this.outTexUsage=ii.DOWNLOAD;const n=ua();this.outputShape=e,this.userCode=`
      ${F9}

      void main() {
        float x = getAAtOutCoords();
        ${n.output} = encode_float(x);
      }
    `}}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class Hve{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=ii.DOWNLOAD;const n=ua();this.outputShape=e,this.userCode=`
      ${F9}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${n.output} = encode_float(x);
      }
    `}}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class qve{constructor(e,n=!1){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const r=ua();this.outputShape=e,this.enableShapeUniforms=ca(this.outputShape.length);let a="result";n&&(a="floor(result * 255. + 0.5)"),this.userCode=`
      ${this.enableShapeUniforms?V4():j4(e)}

      void main() {
        ivec3 coords = getOutputCoords();

        int flatIndex = getFlatIndex(coords);
        int offset = imod(flatIndex, 4);

        flatIndex = idiv(flatIndex, 4, 1.);

        int r = flatIndex / texShape[1];
        int c = imod(flatIndex, texShape[1]);
        vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
        vec4 values = ${r.texture2D}(A, uv);

        float result;

        if(offset == 0) {
          result = values[0];
        } else if(offset == 1) {
          result = values[1];
        } else if(offset == 2) {
          result = values[2];
        } else {
          result = values[3];
        }

        ${r.output} = vec4(${a}, 0., 0., 0.);
      }
    `}}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class Kve{constructor(e,n=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const r=ua();this.outputShape=e,this.enableShapeUniforms=ca(this.outputShape.length);let a="",i="result";n&&(i="floor(result * 255. + 0.5)");for(let o=0;o<=1;o++)for(let s=0;s<=1;s++){const l=o*2+s;a+=`
          localCoords = coords;
          if(localCoords[2] + ${s} < ${this.enableShapeUniforms?"outShape[2]":`${e[2]}`}) {
          localCoords[2] += ${s};
          if (localCoords[1] + ${o} < ${this.enableShapeUniforms?"outShape[1]":`${e[1]}`}) {
            localCoords[1] += ${o};

            flatIndex = getFlatIndex(localCoords);
            offset = imod(flatIndex, 4);

            flatIndex = idiv(flatIndex, 4, 1.);

            int r = flatIndex / texShape[1];
            int c = imod(flatIndex, texShape[1]);
            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
            values = ${r.texture2D}(A, uv);

            if (offset == 0) {
              result[${l}] = values[0];
            } else if (offset == 1) {
              result[${l}] = values[1];
            } else if (offset == 2) {
              result[${l}] = values[2];
            } else {
              result[${l}] = values[3];
            }
          }
        }
        `}this.userCode=`
        ${this.enableShapeUniforms?V4():j4(e)}

        void main() {
          ivec3 coords = getOutputCoords();

          vec4 result = vec4(0.);
          int flatIndex, r, c, offset;
          ivec3 localCoords;
          vec2 uv;
          vec4 values;

          ${a}

          ${r.output} = ${i};
        }
    `}}/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Xve(t){const e=ua(),n=`${e.version}
    precision highp float;
    ${e.attribute} vec3 clipSpacePos;
    ${e.attribute} vec2 uv;
    ${e.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return Rbe(t,n)}function Yve(t){const e=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return Dbe(t,e)}function Qve(t){const e=new Uint16Array([0,1,2,2,1,3]);return Fbe(t,e)}function om(t,e,n,r,a,i){zbe(e,n);const o=Bbe(t),s=t.TEXTURE_2D;return je(t,()=>t.bindTexture(s,o)),je(t,()=>t.texParameteri(s,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE)),je(t,()=>t.texParameteri(s,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)),je(t,()=>t.texParameteri(s,t.TEXTURE_MIN_FILTER,t.NEAREST)),je(t,()=>t.texParameteri(s,t.TEXTURE_MAG_FILTER,t.NEAREST)),ce().getNumber("WEBGL_VERSION")===1?je(t,()=>t.texImage2D(s,0,r,e,n,0,a,i,null)):je(t,()=>t.texStorage2D(s,1,r,e,n)),je(t,()=>t.bindTexture(t.TEXTURE_2D,null)),{texture:o,texShape:[n,e]}}function U9(t){return t.internalFormatFloat}function Zve(t,e,n,r){const[a,i]=am(e,n);return om(t,a,i,U9(r),r.textureFormatFloat,t.FLOAT)}function G9(t){return t.internalFormatHalfFloat}function Jve(t,e,n,r){const[a,i]=am(e,n);return om(t,a,i,G9(r),r.textureFormatFloat,r.textureTypeHalfFloat)}function H9(t){return t.downloadTextureFormat}function exe(t,e,n,r){const[a,i]=am(e,n);return om(t,a,i,H9(r),t.RGBA,t.UNSIGNED_BYTE)}function q9(t){return t.internalFormatPackedFloat}function txe(t,e,n,r){const[a,i]=fp(e,n);return om(t,a,i,q9(r),t.RGBA,t.FLOAT)}function K9(t){return t.internalFormatPackedHalfFloat}function nxe(t,e,n,r){const[a,i]=fp(e,n);return om(t,a,i,K9(r),t.RGBA,r.textureTypeHalfFloat)}function rxe(t,e,n){return je(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),P9(t,e,"clipSpacePos",n,3,20,0)&&P9(t,e,"uv",n,2,20,12)}function axe(t,e,n,r,a,i){je(t,()=>t.bindTexture(t.TEXTURE_2D,e));let o,s,l;a instanceof Uint8Array?(o=new Uint8Array(n*r*4),s=t.UNSIGNED_BYTE,l=t.RGBA):(o=new Float32Array(n*r*4),s=t.FLOAT,l=i.internalFormatPackedFloat),o.set(a),ce().getNumber("WEBGL_VERSION")===2?je(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n,r,t.RGBA,s,o)):je(t,()=>t.texImage2D(t.TEXTURE_2D,0,l,n,r,0,t.RGBA,s,o)),je(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function ixe(t,e,n){je(t,()=>t.bindTexture(t.TEXTURE_2D,e)),n.data instanceof Uint8Array?ce().getNumber("WEBGL_VERSION")===2?je(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n.width,n.height,t.RGBA,t.UNSIGNED_BYTE,n.data)):je(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,n.width,n.height,0,t.RGBA,t.UNSIGNED_BYTE,n.data)):ce().getNumber("WEBGL_VERSION")===2?je(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,t.RGBA,t.UNSIGNED_BYTE,n)):je(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,n)),je(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function oxe(t,e,n,r){const a=t.createBuffer();je(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,a));const i=4*4*e*n;return je(t,()=>t.bufferData(t.PIXEL_PACK_BUFFER,i,t.STREAM_READ)),je(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,0)),je(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,null)),a}function sxe(t,e,n){const r=t,a=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,e),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,a),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),a}function lxe(t,e,n,r){const[a,i]=am(e,n),o=4,s=new Uint8Array(Nbe(e*n,o));return je(t,()=>t.readPixels(0,0,a,i,r.downloadTextureFormat,t.UNSIGNED_BYTE,s)),new Float32Array(s.buffer)}function uxe(t,e,n,r,a,i,o,s){const l=t,u=new Float32Array(Tbe(i,o));return l.bindBuffer(l.PIXEL_PACK_BUFFER,e),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,u),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),u}function cxe(t,e,n){const r=new Float32Array(e*n*4);return je(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,r)),r}/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class U4{constructor(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];const n=ce().getNumber("WEBGL_VERSION");e!=null?(this.gl=e,kbe(n,e)):this.gl=po(n);let r="WEBGL_color_buffer_float";const a="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),ce().getNumber("WEBGL_VERSION")===1){const i="OES_texture_float",o="OES_texture_half_float";if(this.textureFloatExtension=d2(this.gl,i),Pi(this.gl,o))this.textureHalfFloatExtension=d2(this.gl,o);else if(ce().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),Pi(this.gl,a))this.colorBufferHalfFloatExtension=d2(this.gl,a);else if(ce().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",Pi(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else if(Pi(this.gl,a))this.colorBufferHalfFloatExtension=this.gl.getExtension(a);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=Yve(this.gl),this.indexBuffer=Qve(this.gl),this.framebuffer=jbe(this.gl),this.textureConfig=A4(this.gl,this.textureHalfFloatExtension)}get debug(){return ce().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const e=this.gl;je(e,()=>e.finish()),je(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),je(e,()=>e.deleteFramebuffer(this.framebuffer)),je(e,()=>e.bindBuffer(e.ARRAY_BUFFER,null)),je(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)),je(e,()=>e.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(e,n){return this.throwIfDisposed(),Zve(this.gl,e,n,this.textureConfig)}createFloat16MatrixTexture(e,n){return this.throwIfDisposed(),Jve(this.gl,e,n,this.textureConfig)}createUnsignedBytesMatrixTexture(e,n){return this.throwIfDisposed(),exe(this.gl,e,n,this.textureConfig)}uploadPixelDataToTexture(e,n){this.throwIfDisposed(),ixe(this.gl,e,n)}uploadDenseMatrixToTexture(e,n,r,a){this.throwIfDisposed(),axe(this.gl,e,n,r,a,this.textureConfig)}createFloat16PackedMatrixTexture(e,n){return this.throwIfDisposed(),nxe(this.gl,e,n,this.textureConfig)}createPackedMatrixTexture(e,n){return this.throwIfDisposed(),txe(this.gl,e,n,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(L9(this.gl,this.framebuffer),this.outputTexture=null),je(this.gl,()=>this.gl.deleteTexture(e))}downloadByteEncodedFloatMatrixFromOutputTexture(e,n,r){return this.downloadMatrixDriver(e,()=>lxe(this.gl,n,r,this.textureConfig))}downloadPackedMatrixFromBuffer(e,n,r,a,i,o){return uxe(this.gl,e,n,r,a,i,o,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,n){return sxe(this.gl,e,n)}createBufferFromTexture(e,n,r){this.bindTextureToFrameBuffer(e);const a=oxe(this.gl,n,r,this.textureConfig);return this.unbindTextureToFrameBuffer(),a}createAndWaitForFence(){const e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let n,r;if(ce().getBool("WEBGL_FENCE_API_ENABLED")){const a=e,i=a.fenceSync(a.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),r=()=>{const o=a.clientWaitSync(i,0,0);return o===a.ALREADY_SIGNALED||o===a.CONDITION_SATISFIED},n=i}else ce().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(n=this.beginQuery(),this.endQuery(),r=()=>this.isQueryAvailable(n,ce().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):r=()=>!0;return{query:n,isFencePassed:r}}downloadMatrixFromPackedTexture(e,n,r){return this.downloadMatrixDriver(e,()=>cxe(this.gl,n,r))}createProgram(e){this.throwIfDisposed();const n=this.gl;this.vertexShader==null&&(this.vertexShader=Xve(n));const r=Pbe(n);return je(n,()=>n.attachShader(r,this.vertexShader)),je(n,()=>n.attachShader(r,e)),Lbe(n,r),this.debug&&P4(n,r),this.vertexAttrsAreBound||(this.setProgram(r),this.vertexAttrsAreBound=rxe(n,this.program,this.vertexBuffer)),r}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),e!=null&&je(this.gl,()=>this.gl.deleteProgram(e))}setProgram(e){this.throwIfDisposed(),this.program=e,this.program!=null&&this.debug&&P4(this.gl,this.program),je(this.gl,()=>this.gl.useProgram(e))}getUniformLocation(e,n,r=!0){return this.throwIfDisposed(),r?Wbe(this.gl,e,n):Ube(this.gl,e,n)}getAttributeLocation(e,n){return this.throwIfDisposed(),je(this.gl,()=>this.gl.getAttribLocation(e,n))}getUniformLocationNoThrow(e,n){return this.throwIfDisposed(),this.gl.getUniformLocation(e,n)}setInputMatrixTexture(e,n,r){this.throwIfDisposed(),this.throwIfNoProgram(),Gbe(this.gl,e,n,r)}setOutputMatrixTexture(e,n,r){this.setOutputMatrixTextureDriver(e,r,n)}setOutputPackedMatrixTexture(e,n,r){this.throwIfDisposed();const[a,i]=fp(n,r);this.setOutputMatrixTextureDriver(e,a,i)}setOutputMatrixWriteRegion(e,n,r,a){this.setOutputMatrixWriteRegionDriver(r,e,a,n)}setOutputPackedMatrixWriteRegion(e,n,r,a){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&P4(this.gl,this.program),p2(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const e=this.gl;this.debug&&this.debugValidate(),je(e,()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),je(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=d2(this.gl,ce().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(ce().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const r=this.gl,a=this.getQueryTimerExtensionWebGL2(),i=r.createQuery();return r.beginQuery(a.TIME_ELAPSED_EXT,i),i}const e=this.getQueryTimerExtensionWebGL1(),n=e.createQueryEXT();return e.beginQueryEXT(e.TIME_ELAPSED_EXT,n),n}endQuery(){if(ce().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const n=this.gl,r=this.getQueryTimerExtensionWebGL2();n.endQuery(r.TIME_ELAPSED_EXT);return}const e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(e){return await F3(()=>this.disposed||this.isQueryAvailable(e,ce().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(e,ce().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(e,n){if(n===0)return null;if(n===2){const r=this.gl;return r.getQueryParameter(e,r.QUERY_RESULT)/1e6}else{const r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(e,r.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(e,n){if(n===0)return!0;if(n===2){const r=this.gl,a=this.getQueryTimerExtensionWebGL2(),i=r.getQueryParameter(e,r.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(a.GPU_DISJOINT_EXT)),i&&!this.disjoint}else{const r=this.getQueryTimerExtensionWebGL1(),a=r.getQueryObjectEXT(e,r.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),a&&!this.disjoint}}pollFence(e){return new Promise(n=>{this.addItemToPoll(()=>e.isFencePassed(),()=>n())})}pollItems(){const e=dxe(this.itemsToPoll.map(n=>n.isDoneFn));for(let n=0;n<=e;++n){const{resolveFn:r}=this.itemsToPoll[n];r()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,n){if(this.itemsToPoll.push({isDoneFn:e,resolveFn:n}),this.itemsToPoll.length>1)return;let r;"setTimeoutCustom"in ce().platform&&(r=ce().platform.setTimeoutCustom.bind(ce().platform)),F3(()=>(this.pollItems(),this.itemsToPoll.length===0),()=>0,null,r)}bindTextureToFrameBuffer(e){this.throwIfDisposed(),L4(this.gl,e,this.framebuffer),this.debug&&p2(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(L4(this.gl,this.outputTexture,this.framebuffer),this.debug&&p2(this.gl)):L9(this.gl,this.framebuffer)}downloadMatrixDriver(e,n){this.bindTextureToFrameBuffer(e);const r=n();return this.unbindTextureToFrameBuffer(),r}setOutputMatrixTextureDriver(e,n,r){this.throwIfDisposed();const a=this.gl;L4(a,e,this.framebuffer),this.debug&&p2(a),this.outputTexture=e,je(a,()=>a.viewport(0,0,n,r)),je(a,()=>a.scissor(0,0,n,r))}setOutputMatrixWriteRegionDriver(e,n,r,a){this.throwIfDisposed(),je(this.gl,()=>this.gl.scissor(e,n,r,a))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}}function dxe(t){let e=0;for(;e<t.length&&t[e]();++e);return e-1}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const{addImpl:pxe,bincountImpl:X9,bincountReduceImpl:hxe,castImpl:fxe,ceilImpl:gxe,concatImpl:mxe,equalImpl:yxe,expImpl:bxe,expm1Impl:vxe,floorImpl:xxe,gatherNdImpl:wxe,gatherV2Impl:kxe,greaterImpl:Sxe,greaterEqualImpl:Cxe,lessImpl:Nxe,lessEqualImpl:Txe,linSpaceImpl:Ixe,logImpl:Exe,maxImpl:_xe,maximumImpl:Oxe,minimumImpl:$xe,multiplyImpl:Rxe,negImpl:Mxe,notEqualImpl:Axe,prodImpl:Pxe,raggedGatherImpl:Lxe,raggedTensorToTensorImpl:Dxe,rangeImpl:Fxe,rsqrtImpl:Bxe,scatterImpl:zxe,sigmoidImpl:jxe,simpleAbsImpl:Y9,sliceImpl:Vxe,sparseFillEmptyRowsImpl:Wxe,sparseReshapeImpl:Uxe,sparseSegmentReductionImpl:Q9,sqrtImpl:Gxe,stridedSliceImpl:Hxe,stringNGramsImpl:qxe,stringSplitImpl:Kxe,stringToHashBucketFastImpl:Xxe,subImpl:Yxe,tileImpl:Qxe,topKImpl:Zxe,transposeImpl:G4,uniqueImpl:Jxe}=lge;/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Z9(t,e){return["x","y","z","w","u","v"].slice(0,e).map(n=>`${t}.${n}`)}function da(t,e){return e===1?[t]:Z9(t,e)}function e2e(t,e){if(t===1)return"rc";let n="";for(let r=0;r<t;r++)n+=e[r],r<t-1&&(n+=",");return n}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class t2e{constructor(e){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.enableShapeUniforms=ca(this.outputShape.length),this.rank===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{const n=da("rc",this.rank),r=pn(this.rank),a=this.getOutOfBoundsCondition(n),i=this.getSetup(n),o=this.getOutput(n);this.userCode=`
        void main() {
          ${r} rc = getOutputCoords();

          if(${a}) {
            setOutput(vec4(0));
          } else {
            ${i}

            setOutput(vec4(${o}));
          }
        }
      `}}getSourceCoordsArr(e){const n=[];for(let r=0;r<=1;r++)for(let a=0;a<=1;a++){let i=`${r===0?"r":"rp1"}, ${a===0?"c":"cp1"}`;for(let o=2;o<this.rank;o++)i=`${e[e.length-1-o]},`+i;n.push(i)}return n}getOutOfBoundsCondition(e){if(this.rank===1)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let n="";for(let r=this.rank-2;r<this.rank;r++)n+=`${e[r]} >= ${this.enableShapeUniforms?`outShape[${r}]`:this.outputShape[r]}`,r<this.rank-1&&(n+="||");return n}getSetup(e){if(this.rank===1)return"";const n=e.slice(-2),r=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],a=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`
      int r = ${n[0]};
      int c = ${n[1]};
      int rp1 = r + 1;
      int cp1 = c + 1;

      bool cEdge = cp1 >= ${r};
      bool rEdge = rp1 >= ${a};
    `}getOutput(e){const n=this.getSourceCoordsArr(e);return this.rank===1?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${n[0]}),
            cEdge ? 0. : getA(${n[1]}),
            rEdge ? 0. : getA(${n[2]}),
            rEdge || cEdge ? 0. : getA(${n[3]})`}}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class J9{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=e,this.enableShapeUniforms=ca(this.outputShape.length);let r="";for(let a=0;a<4;a++){let i="thisRC = rc;";a%2===1&&(i+="thisRC.z += 1;"),a>1&&(i+="thisRC.y += 1;"),r+=`
        ${i}
        ${a>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${a}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${a>0?"}":""}
      `}this.userCode=`
      ${n2e(n,this.enableShapeUniforms)}
      ${this.enableShapeUniforms?V4():j4(e)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${this.enableShapeUniforms?"outShape[1]":e[1]};
        int cols = ${this.enableShapeUniforms?"outShape[2]":e[2]};

        ${r}

        setOutput(result);
      }
    `}}function n2e(t,e){return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${e?rve(["r","c","d"],"inputShape"):hc(["r","c","d"],t)}
      return ivec3(r, c, d);
    }
  `}/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class r2e{constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}acquireTexture(e,n,r){const a=t7(n,r),i=n7(e,a,r);i in this.freeTextures||(this.freeTextures[i]=[]),i in this.usedTextures||(this.usedTextures[i]=[]);const o=e7(e,a,this.gpgpu.gl,this.gpgpu.textureConfig,r);if(this.freeTextures[i].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=o,this.log();const l=this.freeTextures[i].shift();return this.usedTextures[i].push(l),l}let s;return a===Er.PACKED_2X2_FLOAT32?s=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):a===Er.PACKED_2X2_FLOAT16?s=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):a===Er.UNPACKED_FLOAT32?s=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):a===Er.UNPACKED_FLOAT16?s=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):a===Er.PACKED_4X1_UNSIGNED_BYTE&&(s=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[i].push(s),this.numUsedTextures++,this._numBytesAllocated+=o,this.log(),s}releaseTexture(e,n,r,a){if(this.freeTextures==null)return;const i=t7(r,a),o=n7(n,i,a);o in this.freeTextures||(this.freeTextures[o]=[]);const s=e7(n,i,this.gpgpu.gl,this.gpgpu.textureConfig,a),l=ce().get("WEBGL_DELETE_TEXTURE_THRESHOLD");l!==-1&&this._numBytesAllocated>l?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=s):(this.freeTextures[o].push(e),this.numFreeTextures++,this._numBytesFree+=s),this.numUsedTextures--;const u=this.usedTextures[o],c=u.indexOf(e);if(c<0)throw new Error("Cannot release a texture that was never provided by this texture manager");u.splice(c,1),this.log()}log(){if(!this.logEnabled)return;const e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${e})`);const n=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*n)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(const e in this.freeTextures)this.freeTextures[e].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});for(const e in this.usedTextures)this.usedTextures[e].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function a2e(t,e){const n=t;if(e===n.R32F)return 4;if(e===n.R16F)return 2;if(e===n.RGBA32F||e===t.RGBA)return 16;if(e===n.RGBA16F)return 8;if(e===n.RGBA8)return 4;throw new Error(`Unknown internal format ${e}`)}function e7(t,e,n,r,a){const i=i2e(e,r);let o;if(a){const[l,u]=fp(t[0],t[1]);o=l*u}else{const[l,u]=am(t[0],t[1]);o=l*u}const s=a2e(n,i);return o*s}function i2e(t,e){switch(t){case Er.PACKED_2X2_FLOAT32:return q9(e);case Er.PACKED_2X2_FLOAT16:return K9(e);case Er.UNPACKED_FLOAT32:return U9(e);case Er.UNPACKED_FLOAT16:return G9(e);case Er.PACKED_4X1_UNSIGNED_BYTE:return H9(e);default:throw new Error(`Unknown physical texture type ${t}`)}}function o2e(t){return ce().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?t?Er.PACKED_2X2_FLOAT32:Er.UNPACKED_FLOAT32:t?Er.PACKED_2X2_FLOAT16:Er.UNPACKED_FLOAT16}function t7(t,e){if(t===ii.UPLOAD)return Er.PACKED_2X2_FLOAT32;if(t===ii.RENDER||t==null)return o2e(e);if(t===ii.DOWNLOAD||t===ii.PIXELS)return Er.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${t}`)}function n7(t,e,n){return`${t[0]}_${t[1]}_${e}_${n}`}/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class Ls{constructor(e,n){this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=ca(this.outputShape.length),this.userCode=`
      float unaryOperation(float x) {
        ${n}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}}const Li="if (isnan(x)) return x;",s2e="return x;",r7="return abs(x);",l2e="return (x >= 0.0) ? x : (exp(x) - 1.0);",u2e=Li+`
  return (x < 0.0) ? 0.0 : x;
`,c2e=Li+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,wp="return x;",d2e="return 1.0 / (1.0 + exp(-1.0 * x));";/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const p2e="return x;",h2e=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,f2e=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,g2e=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,m2e="return 1.0 / (1.0 + exp(-1.0 * x));";class gc{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=ca(this.outputShape.length),this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${n}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class y2e{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e,this.enableShapeUniforms=ca(this.outputShape.length);const n=e.length,r=da("rc",n),a=pn(n),i=e2e(n,r),o=r.slice(-2),s=n<=1?"rc":`vec2(${o.join(",")})`;this.userCode=`
      void main() {
        ${a} rc = getOutputCoords();
        vec4 packedInput = getA(${i});

        setOutput(getChannel(packedInput, ${s}));
      }
    `}}/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const b2e=Fx,v2e=1e-7,x2e=1e-4,H4={};function w2e(t){return t in H4||(H4[t]={}),H4[t]}const k2e=ce().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),S2e=600;function C2e(){return ce().global.screen==null?1024:ce().global.screen.height*ce().global.screen.width*window.devicePixelRatio*S2e/1024/1024}class Z2 extends Cb{constructor(e){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!ce().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let n;if(e!=null){if(e instanceof U4)n=e;else{const r=po(ce().getNumber("WEBGL_VERSION"),e);n=new U4(r)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const r=po(ce().getNumber("WEBGL_VERSION"));n=new U4(r),this.binaryCache=w2e(ce().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=n,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new r2e(this.gpgpu),this.numMBBeforeWarning=C2e(),this.texData=new D3(this,Es())}nextDataId(){return Z2.nextDataId++}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}write(e,n,r){if((ce().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||ce().getBool("DEBUG"))&&this.checkNumericalProblems(e),r==="complex64"&&e!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const a={id:this.nextDataId()};return this.texData.set(a,{shape:n,dtype:r,values:e,usage:ii.UPLOAD,refCount:1}),a}refCount(e){return this.texData.has(e)?this.texData.get(e).refCount:0}incRef(e){const n=this.texData.get(e);n.refCount++}decRef(e){if(this.texData.has(e)){const n=this.texData.get(e);n.refCount--}}move(e,n,r,a,i){if(ce().getBool("DEBUG")&&this.checkNumericalProblems(n),a==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:r,dtype:a,values:n,usage:ii.UPLOAD,refCount:i})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){const n=this.texData.get(e),{values:r,dtype:a,complexTensorInfos:i,slice:o,shape:s,isPacked:l}=n;if(o!=null){let p;l?p=new gc(s,wp):p=new Ls(s,wp);const f=this.runWebGLProgram(p,[{dataId:e,shape:s,dtype:a}],a),m=this.readSync(f.dataId);return this.disposeIntermediateTensorInfo(f),m}if(r!=null)return this.convertAndCacheOnCPU(e);if(a==="string")return r;const u=this.activeTimers!=null;let c;u&&(c=Ba());let d;if(a==="complex64"){const p=this.readSync(i.real.dataId),f=this.readSync(i.imag.dataId);d=Ms(p,f)}else d=this.getValuesFromTexture(e);return u&&(this.downloadWaitMs+=Ba()-c),this.convertAndCacheOnCPU(e,d)}async read(e){if(this.pendingRead.has(e)){const m=this.pendingRead.get(e);return new Promise(y=>m.push(y))}const n=this.texData.get(e),{values:r,shape:a,slice:i,dtype:o,complexTensorInfos:s,isPacked:l}=n;if(i!=null){let m;l?m=new gc(a,wp):m=new Ls(a,wp);const y=this.runWebGLProgram(m,[{dataId:e,shape:a,dtype:o}],o),x=this.read(y.dataId);return this.disposeIntermediateTensorInfo(y),x}if(r!=null)return this.convertAndCacheOnCPU(e);if(ce().getBool("DEBUG")&&!ce().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&ce().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let u=null,c;if(o!=="complex64"&&ce().get("WEBGL_BUFFER_SUPPORTED")){c=this.decode(e);const m=this.texData.get(c.dataId);u=this.gpgpu.createBufferFromTexture(m.texture.texture,...c2(a))}this.pendingRead.set(e,[]),o!=="complex64"&&await this.gpgpu.createAndWaitForFence();let d;if(o==="complex64"){const m=await Promise.all([this.read(s.real.dataId),this.read(s.imag.dataId)]),y=m[0],x=m[1];d=Ms(y,x)}else if(u==null)d=this.getValuesFromTexture(e);else{const m=me(a);d=this.gpgpu.downloadFloat32MatrixFromBuffer(u,m)}if(c!=null&&this.disposeIntermediateTensorInfo(c),u!=null){const m=this.gpgpu.gl;je(m,()=>m.deleteBuffer(u))}const p=this.convertAndCacheOnCPU(e,d),f=this.pendingRead.get(e);return this.pendingRead.delete(e),f.forEach(m=>m(p)),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)&&Es().removeDataId(e,this),this.pendingDeletes--),p}readToGPU(e,n={}){const r=this.texData.get(e),{values:a,shape:i,slice:o,dtype:s,isPacked:l,texture:u}=r;if(s==="complex64")throw new Error("Does not support reading texture for complex64 dtype.");if(o!=null){let f;l?f=new gc(i,wp):f=new Ls(i,wp);const m=this.runWebGLProgram(f,[{dataId:e,shape:i,dtype:s}],s),y=this.readToGPU(m,n);return this.disposeIntermediateTensorInfo(m),y}if(u==null)throw a!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const c=this.decode(e,n.customTexShape),d=Es().makeTensorFromTensorInfo(c),p=this.texData.get(c.dataId);return Object.assign({tensorRef:d},p.texture)}bufferSync(e){const n=this.readSync(e.dataId);if(e.dtype==="string")try{const r=n.map(a=>Cs(a));return pt(e.shape,e.dtype,r)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return pt(e.shape,e.dtype,n)}checkNumericalProblems(e){if(e!=null)for(let n=0;n<e.length;n++){const r=e[n];if(!Obe(r))throw ce().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${r} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${r} cannot be represented on this device.`)}}getValuesFromTexture(e){const{shape:n,dtype:r,isPacked:a}=this.texData.get(e),i=me(n);if(ce().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const p=this.decode(e),f=this.texData.get(p.dataId),m=this.gpgpu.downloadMatrixFromPackedTexture(f.texture.texture,...c2(n)).subarray(0,i);return this.disposeIntermediateTensorInfo(p),m}const o=ce().getBool("WEBGL_PACK")&&a===!0,s=o?D4(n):n,l=o?new Hve(s):new Gve(s),u=this.runWebGLProgram(l,[{shape:s,dtype:r,dataId:e}],"float32"),c=this.texData.get(u.dataId),d=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(c.texture.texture,c.texShape[0],c.texShape[1]).subarray(0,i);return this.disposeIntermediateTensorInfo(u),d}timerAvailable(){return ce().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){const n=this.activeTimers,r=[];let a=!1;this.programTimersStack==null?(this.programTimersStack=r,a=!0):this.activeTimers.push(r),this.activeTimers=r,e();const i=ws(this.activeTimers.map(l=>l.query)).filter(l=>l!=null),o=ws(this.activeTimers.map(l=>l.name)).filter(l=>l!=null);this.activeTimers=n,a&&(this.programTimersStack=null);const s={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(ce().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const l=await Promise.all(i);s.kernelMs=iP(l),s.getExtraProfileInfo=()=>l.map((u,c)=>({name:o[c],ms:u})).map(u=>`${u.name}: ${u.ms}`).join(", ")}else s.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,s})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return ce().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:Ba(),endMs:null}}endTimer(e){return ce().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=Ba(),e)}async getQueryTime(e){if(ce().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(e);const n=e;return n.endMs-n.startMs}disposeData(e,n=!1){if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(n?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!n&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);const{complexTensorInfos:r}=this.texData.get(e);return r!=null&&(this.disposeData(r.real.dataId,n),this.disposeData(r.imag.dataId,n)),this.texData.delete(e),!0}releaseGPUData(e){const{texture:n,dtype:r,texShape:a,usage:i,isPacked:o,slice:s}=this.texData.get(e),l=s&&s.origDataId||e,u=this.dataRefCount.get(l);u>1?this.dataRefCount.set(l,u-1):(this.dataRefCount.delete(l),n!=null&&(this.numBytesInGPU-=this.computeBytes(a,r),this.textureManager.releaseTexture(n,a,i,o)));const c=this.texData.get(e);c.texture=null,c.texShape=null,c.isPacked=!1,c.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e,n=k2e){return ce().getBool("WEBGL_CPU_FORWARD")&&e.every(r=>this.texData.get(r.dataId).texture==null&&me(r.shape)<n)}getGPGPUContext(){return this.gpgpu}where(e){ai("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const n=e.dataSync();return b2e(e.shape,n)}packedUnaryOp(e,n,r){const a=new gc(e.shape,n),i=this.compileAndRun(a,[e],r);return Es().makeTensorFromTensorInfo(i)}abs(e){if(this.shouldExecuteOnCPU([e])&&e.dtype!=="complex64"){const a=Y9(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,a)}if(ce().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,r7,e.dtype);const n=new Ls(e.shape,r7),r=this.compileAndRun(n,[e]);return Es().makeTensorFromTensorInfo(r)}makeTensorInfo(e,n,r){let a;if(n==="string"&&r!=null&&r.length>0&&$o(r[0])){const i=r.map(o=>Ro(o));a=this.write(i,e,n)}else a=this.write(r,e,n);return this.texData.get(a).usage=null,{dataId:a,shape:e,dtype:n}}makeOutput(e,n,r){return Es().makeTensorFromTensorInfo(this.makeTensorInfo(e,n,r),this)}unpackTensor(e){const n=new y2e(e.shape);return this.runWebGLProgram(n,[e],e.dtype)}packTensor(e){const n=new t2e(e.shape);return this.runWebGLProgram(n,[e],e.dtype,null,!0)}packedReshape(e,n){const r=[gp(e.shape),...mp(e.shape)],a={dtype:e.dtype,shape:r,dataId:e.dataId},i=[gp(n),...mp(n)],o=new J9(i,r),s=!0,l=[r],u=this.runWebGLProgram(o,[a],e.dtype,l,s);return{dataId:u.dataId,shape:n,dtype:u.dtype}}decode(e,n){const r=this.texData.get(e),{isPacked:a,shape:i,dtype:o}=r;if(n!=null){const p=me(i),f=n[0]*n[1]*4;j(p<=f,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}const s=D4(i);let l;a?l=new Uve(s):l=new Wve(s);const u=!0,c=[n??c2(s)],d=this.runWebGLProgram(l,[{shape:s,dtype:o,dataId:e}],o,c,u,n);return{dtype:o,shape:i,dataId:d.dataId}}runWebGLProgram(e,n,r,a,i=!1,o){const s=this.makeTensorInfo(e.outputShape,r),l=this.texData.get(s.dataId);if(e.packedOutput&&(l.isPacked=!0),e.outPackingScheme===rm.DENSE){const b=o??c2(e.outputShape);l.texShape=b.map(v=>v*2)}if(e.outTexUsage!=null&&(l.usage=e.outTexUsage),me(s.shape)===0)return l.values=nr(s.dtype,0),s;const u=[],c=n.map(b=>{if(b.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let v=this.texData.get(b.dataId);if(v.texture==null){if(!e.packedInputs&&me(b.shape)<=ce().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:b.shape,texData:null,isUniform:!0,uniformValues:v.values};e.packedInputs&&(v.isPacked=!0,v.shape=b.shape)}if(this.uploadToGPU(b.dataId),!!v.isPacked!=!!e.packedInputs)b=v.isPacked?this.unpackTensor(b):this.packTensor(b),u.push(b),v=this.texData.get(b.dataId);else if(v.isPacked&&!f2(v.shape,b.shape)){const w=b,S=b.shape;b.shape=v.shape,b=this.packedReshape(b,S),u.push(b),v=this.texData.get(b.dataId),w.shape=S}return{shape:b.shape,texData:v,isUniform:!1}});this.uploadToGPU(s.dataId);const d={shape:s.shape,texData:l,isUniform:!1},p=Vve(e,c,d),f=this.getAndSaveBinary(p,()=>zve(this.gpgpu,e,c,d)),m=this.activeTimers!=null;let y;m&&(y=this.startTimer()),ce().get("ENGINE_COMPILE_ONLY")||jve(this.gpgpu,f,c,d,a),u.forEach(b=>this.disposeIntermediateTensorInfo(b)),m&&(y=this.endTimer(y),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(y)}));const x=ce().get("WEBGL_FLUSH_THRESHOLD");if(x>0){const b=Ba();b-this.lastGlFlushTime>x&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=b)}if(!ce().getBool("WEBGL_LAZILY_UNPACK")&&l.isPacked&&i===!1){const b=this.unpackTensor(s);return this.disposeIntermediateTensorInfo(s),b}return s}compileAndRun(e,n,r,a,i=!1){return r=r||n[0].dtype,this.runWebGLProgram(e,n,r,a,i)}getAndSaveBinary(e,n){return e in this.binaryCache||(this.binaryCache[e]=n()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(ce().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(e=>{this.gpgpu.deleteProgram(this.binaryCache[e].webGLProgram),delete this.binaryCache[e]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=Ot(()=>{if(!ce().get("WEBGL_RENDER_FLOAT32_ENABLED")){const e=ce().getBool("DEBUG");ce().set("DEBUG",!1);const n=this.abs(St(1e-8)).dataSync()[0];if(ce().set("DEBUG",e),n>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?v2e:x2e}uploadToGPU(e){const n=this.texData.get(e),{shape:r,dtype:a,values:i,texture:o,usage:s,isPacked:l}=n;if(o!=null)return;const u=this.activeTimers!=null;let c;u&&(c=Ba());let d=n.texShape;if(d==null&&(d=Kbe(r,l),n.texShape=d),i!=null){const p=D4(r);let f,m=d[1],y=d[0];const x=i instanceof Uint8Array||i instanceof Uint8ClampedArray;(l||!x)&&([m,y]=fp(d[0],d[1])),l?f=new Kve(p,x):f=new qve(p,x);const b=x?[y,m]:d,v=this.makeTensorInfo(b,a),w=this.texData.get(v.dataId);x?w.usage=ii.PIXELS:w.usage=ii.UPLOAD,w.texShape=b,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(v.dataId),m,y,i);const S=[[y,m]],C=!0,I=this.runWebGLProgram(f,[v],a,S,C),_=this.texData.get(I.dataId);n.texShape=_.texShape,n.isPacked=_.isPacked,n.usage=_.usage,ce().get("ENGINE_COMPILE_ONLY")?this.disposeData(I.dataId):(n.texture=_.texture,n.values=null,this.texData.delete(I.dataId)),this.disposeIntermediateTensorInfo(v),u&&(this.uploadWaitMs+=Ba()-c)}else{const p=this.acquireTexture(d,s,a,l);n.texture=p}}convertAndCacheOnCPU(e,n){const r=this.texData.get(e),{dtype:a}=r;return this.releaseGPUData(e),n!=null&&(r.values=N2e(n,a)),r.values}acquireTexture(e,n,r,a){if(this.numBytesInGPU+=this.computeBytes(e,r),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){const i=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${i} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(e,n,a)}computeBytes(e,n){return e[0]*e[1]*Ib(n)}checkCompileCompletion(){for(const[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}async checkCompileCompletionAsync(){const e=[];if(this.gpgpu.parallelCompilationExtension){for(const[,n]of Object.entries(this.binaryCache))e.push(this.checkCompletionAsync_(n));return Promise.all(e)}else{for(const[,n]of Object.entries(this.binaryCache)){const r=new Promise(a=>{try{this.checkCompletion_(n),a(!0)}catch(i){throw i}});e.push(r)}return Promise.all(e)}}async checkCompletionAsync_(e){return this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(e):(await DD(),this.checkCompletionAsync_(e))}checkCompletion_(e){if(this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)===!1)throw console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)===!1?(A9(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(const[,e]of Object.entries(this.binaryCache)){const{uniformLocations:n,customUniformLocations:r,infLoc:a,nanLoc:i,inShapesLocations:o,inTexShapesLocations:s,outShapeLocation:l,outShapeStridesLocation:u,outTexShapeLocation:c}=V9(this.gpgpu,e.program,e.webGLProgram);e.uniformLocations=n,e.customUniformLocations=r,e.infLoc=a,e.nanLoc=i,e.inShapesLocations=o,e.inTexShapesLocations=s,e.outShapeLocation=l,e.outShapeStridesLocation=u,e.outTexShapeLocation=c}}}Z2.nextDataId=0;function N2e(t,e){if(e==="float32"||e==="complex64")return t;if(e==="int32"||e==="bool"){const n=e==="int32"?new Int32Array(t.length):new Uint8Array(t.length);for(let r=0;r<n.length;++r)n[r]=Math.round(t[r]);return n}else throw new Error(`Unknown dtype ${e}`)}/**
* @license
* Copyright 2020 Google Inc. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/vT()&&PT("webgl",()=>new Z2,2);/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const q4=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`;class kp{constructor(e,n,r){this.variableNames=["A","B"],this.outputShape=Nt(n,r),this.enableShapeUniforms=ca(this.outputShape.length),this.userCode=`
      float binaryOperation(float a, float b) {
        ${e}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const sm=`
  result.r = isNaN.r ? NAN : result.r;
  result.g = isNaN.g ? NAN : result.g;
  result.b = isNaN.b ? NAN : result.b;
  result.a = isNaN.a ? NAN : result.a;
`;class lm{constructor(e,n,r,a=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Nt(n,r);const i=this.outputShape.length;this.enableShapeUniforms=ca(i);let o="";if(a)if(i===0||me(this.outputShape)===1)o=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(o=`
          ${pn(i)} coords = getOutputCoords();
        `,i===1)this.enableShapeUniforms?o+=`
            result.y = (coords + 1) >= outShape ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `:o+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{const s=da("coords",i);this.enableShapeUniforms?o+=`
            bool nextRowOutOfBounds =
              (${s[i-2]} + 1) >= outShape[${i} - 2];
            bool nextColOutOfBounds =
              (${s[i-1]} + 1) >= outShape[${i} - 1];
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `:o+=`
            bool nextRowOutOfBounds =
              (${s[i-2]} + 1) >= ${this.outputShape[i-2]};
            bool nextColOutOfBounds =
              (${s[i-1]} + 1) >= ${this.outputShape[i-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${e}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${o}

        setOutput(result);
      }
    `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Ga(t){const{inputs:e,backend:n}=t,{x:r}=e;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const T2e={kernelName:Wf,backendName:"webgl",kernelFunc:Ga};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Hl(t){const{inputs:e,backend:n}=t,{real:r,imag:a}=e,i=n.makeTensorInfo(r.shape,"complex64"),o=n.texData.get(i.dataId),s=Ga({inputs:{x:r},backend:n}),l=Ga({inputs:{x:a},backend:n});return o.complexTensorInfos={real:s,imag:l},i}const I2e={kernelName:Vb,backendName:"webgl",kernelFunc:Hl};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const a7="return (a < 0.) ? b * a : a;",i7=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function E2e(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{alpha:i}=r,o=n.makeTensorInfo([],"float32",Ss(i,"float32")),s=ce().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new lm(i7,a.shape,o.shape):new kp(a7,a.shape,o.shape),l=n.runWebGLProgram(s,[a,o],"float32");return n.disposeIntermediateTensorInfo(o),l}const _2e={kernelName:mv,backendName:"webgl",kernelFunc:E2e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const o7="return (a < 0.) ? b * a : a;",s7=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function O2e(t){const{inputs:e,backend:n}=t,{x:r,alpha:a}=e,i=ce().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new lm(s7,r.shape,a.shape):new kp(o7,r.shape,a.shape);return n.runWebGLProgram(i,[r,a],"float32")}const $2e={kernelName:Pv,backendName:"webgl",kernelFunc:O2e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Sp="if (isnan(x)) return x;";function Rt({opSnippet:t,packedOpSnippet:e,cpuKernelImpl:n,dtype:r}){return({inputs:a,backend:i})=>{const{x:o}=a,s=i,l=r||o.dtype;if(s.shouldExecuteOnCPU([o])&&n!=null){const d=s.texData.get(o.dataId),p=n(d.values,l);return s.makeTensorInfo(o.shape,l,p)}const u=ce().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&e!=null;let c;return u?c=new gc(o.shape,e):c=new Ls(o.shape,t),s.runWebGLProgram(c,[o],l)}}function _r({opSnippet:t,packedOpSnippet:e,checkOutOfBounds:n=!1,supportsComplex:r=!1,cpuKernelImpl:a,dtype:i}){return({inputs:o,backend:s})=>{const{a:l,b:u}=o,c=s;if(r&&l.dtype==="complex64"){const m=c.texData.get(l.dataId),y=c.texData.get(u.dataId),[x,b]=[[m.complexTensorInfos.real,y.complexTensorInfos.real],[m.complexTensorInfos.imag,y.complexTensorInfos.imag]].map(w=>{const[S,C]=w,I={dataId:S.dataId,dtype:S.dtype,shape:l.shape},_={dataId:C.dataId,dtype:C.dtype,shape:u.shape},E=new kp(t,l.shape,u.shape);return c.runWebGLProgram(E,[I,_],Sa(S.dtype,C.dtype))}),v=Hl({inputs:{real:x,imag:b},backend:c});return c.disposeIntermediateTensorInfo(x),c.disposeIntermediateTensorInfo(b),v}const d=i||Sa(l.dtype,u.dtype);if((l.dtype==="string"||u.dtype==="string"||c.shouldExecuteOnCPU([l,u]))&&a!=null){const m=c.texData.get(l.dataId).values,y=c.texData.get(u.dataId).values,x=l.dtype==="string"?uc(m):m,b=l.dtype==="string"?uc(y):y,[v,w]=a(l.shape,u.shape,x,b,d),S=c.makeTensorInfo(w,d),C=c.texData.get(S.dataId);return C.values=v,S}const p=ce().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&e!=null;let f;return p?f=new lm(e,l.shape,u.shape,n):f=new kp(t,l.shape,u.shape),c.runWebGLProgram(f,[l,u],d)}}function um(t,e=!1){if(t==="linear")return e?p2e:s2e;if(t==="relu")return e?f2e:u2e;if(t==="elu")return e?h2e:l2e;if(t==="relu6")return e?g2e:c2e;if(t==="prelu")return e?s7:o7;if(t==="leakyrelu")return e?i7:a7;if(t==="sigmoid")return e?m2e:d2e;throw new Error(`Activation ${t} has not been implemented for the WebGL backend.`)}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class l7{constructor(e,n,r,a=!1,i=!1,o=!1,s=null,l=!1,u=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r,this.enableShapeUniforms=ca(this.outputShape.length);const c=a?e[1]:e[2],d=Math.ceil(c/2),p=a?"i * 2, rc.y":"rc.y, i * 2",f=i?"rc.z, i * 2":"i * 2, rc.z",m=a?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],y=i?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let x="",b="";s&&(l?x=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:u?x=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:x=`vec4 activation(vec4 x) {
          ${s}
        }`,b="result = activation(result);");const v=o?"result += getBiasAtOutCoords();":"";o&&this.variableNames.push("bias"),l&&this.variableNames.push("preluActivationWeights"),u&&this.variableNames.push("leakyreluAlpha");let w="rc.x",S="rc.x";e[0]<n[0]?w=`int(min(float(rc.x), ${e[0]-1}.))`:n[0]<e[0]&&(S=`int(min(float(rc.x), ${n[0]-1}.))`),this.userCode=`
      ${x}
      // Don't use uniform for sharedDimensionPacked for performance.
      const float sharedDimension = ${d}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        for (int i = 0; i < ${d}; i++) {
          int batchA = ${w};
          int batchB = ${S};
          vec4 a = getMatrixA(batchA, ${p});
          vec4 b = getMatrixB(batchB, ${f});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${m[0]} * ${y[0]});
          result += (${m[1]} * ${y[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${v}

        ${b}

        setOutput(result);
      }
    `}}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const u7={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class c7{constructor(e,n,r){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=Nt(n,r),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${e}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const d7="return a * b;";function K4(t){const{inputs:e,backend:n}=t,{a:r,b:a}=e,i=Sa(r.dtype,a.dtype);if(r.dtype==="complex64"){const s=n.texData.get(r.dataId),l=n.texData.get(a.dataId),u=new c7(u7.REAL,r.shape,a.shape),c=new c7(u7.IMAG,r.shape,a.shape),d=[{dataId:s.complexTensorInfos.real.dataId,dtype:s.complexTensorInfos.real.dtype,shape:r.shape},{dataId:s.complexTensorInfos.imag.dataId,dtype:s.complexTensorInfos.imag.dtype,shape:r.shape},{dataId:l.complexTensorInfos.real.dataId,dtype:l.complexTensorInfos.real.dtype,shape:a.shape},{dataId:l.complexTensorInfos.imag.dataId,dtype:l.complexTensorInfos.imag.dtype,shape:a.shape}],p=n.runWebGLProgram(u,d,"float32"),f=n.runWebGLProgram(c,d,"float32"),m=Hl({inputs:{real:p,imag:f},backend:n});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),m}if(n.shouldExecuteOnCPU([r,a])){const s=n.texData.get(r.dataId),l=n.texData.get(a.dataId),[u,c]=Rxe(r.shape,a.shape,s.values,l.values,i),d=n.makeTensorInfo(c,i),p=n.texData.get(d.dataId);return p.values=u,d}let o;return ce().getBool("WEBGL_PACK_BINARY_OPERATIONS")?o=new lm(d7,r.shape,a.shape):o=new kp(d7,r.shape,a.shape),n.runWebGLProgram(o,[r,a],i)}const R2e={kernelName:rg,backendName:"webgl",kernelFunc:K4};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function M2e(t,e,n){const r=[gp(t.shape),...mp(t.shape)],a={dtype:t.dtype,shape:r,dataId:t.dataId},i=[gp(e),...mp(e)],o=new J9(i,r),s=!0,l=[r],u=n.runWebGLProgram(o,[a],t.dtype,l,s);return{dataId:u.dataId,shape:e,dtype:u.dtype}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Re(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{shape:i}=r,o=n,s=me(a.shape),l=B3(i,s),u=me(l);j(s===u,()=>`The new shape (${l}) has ${u} elements and the old shape (${a.shape}) has ${s} elements. The new shape and old shape must have the same number of elements.`);const c=o.texData.get(a.dataId);return c.isPacked&&!f2(a.shape,l)&&!(c.texture!==null&&f2(c.shape,l))?M2e(a,l,o):(o.incRef(a.dataId),{dataId:a.dataId,shape:l,dtype:a.dtype})}const A2e={kernelName:jv,backendName:"webgl",kernelFunc:Re};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class p7{constructor(e,n){this.variableNames=["x"];const{windowSize:r,batchSize:a,inSize:i,outSize:o}=e;this.outputShape=[a,o];const s=Math.floor(r/4)*4,l=r%4;let u="sumValue += dot(values, ones);";if(n!=null){const d=1/n;u=`sumValue += dot(values * ${Gu(d)?d.toPrecision(2):d}, ones);`}let c="";i%r>0&&(c=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${c}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        float sumValue = 0.0;

        for (int i = 0; i < ${s}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${u}
        }

        int inIdx = inOffset + ${s};
        if (${l===1}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${u}
        } else if (${l===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${u}
        } else if (${l===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${u}
        }
        setOutput(sumValue);
      }
    `}}/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class P2e{constructor(e,n){this.variableNames=["x"];const{windowSize:r,batchSize:a,inSize:i,outSize:o}=e;this.outputShape=[a,o];let s="0.0",l="";n==="prod"?s="1.0":n==="min"?(s="1.0 / 1e-20",l="min"):n==="max"&&(s="-1.0 / 1e-20",l="max");let u=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="sum"?u="sumValue":n==="prod"?u="prodValue":n==="all"?u="allValue":n==="any"&&(u="anyValue");const c=Math.floor(r/4)*4,d=r%4;let p=`
      if (${n==="sum"}) {
        sumValue += dot(values, ones);
      } else if (${n==="prod"}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${l}(values, minMaxValue);
        if (${n==="min"} || ${n==="max"}) {
          minMaxValue = ${l}(values, minMaxValue);
          bvec4 isNaN = isnan(values);
          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {
            minMaxValue = vec4(NAN);
          }
        }
      }
    `,f="vec4";n==="all"?(s="1.0",p=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,f="bvec4"):n==="any"&&(s="0.0",p=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,f="bvec4");let m="";i%r>0&&(m=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${s};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${m}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        vec4 minMaxValue = vec4(${s});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${c}; i += 4) {
          int inIdx = inOffset + i;
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${p}
        }

        int inIdx = inOffset + ${c};
        if (${d===1}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${p}
        } else if (${d===2}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${p}
        } else if (${d===3}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${p}
        }
        setOutput(${u});
      }
    `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function L2e(t){const e=[];for(;e.length===0||e[e.length-1].outSize!==1;){const n=e.length?e[e.length-1].outSize:t[1],r=Jx(n);e.push({inSize:n,windowSize:r,outSize:Math.ceil(n/r)})}return e}function mc(t,e,n,r){const a=L2e(t.shape);let i=t;for(let o=0;o<a.length;o++){const{inSize:s,windowSize:l,outSize:u}=a[o];let c,d;n==="mean"?c=o===0?new p7({windowSize:l,inSize:s,batchSize:t.shape[0],outSize:u},s):new p7({windowSize:l,inSize:s,batchSize:t.shape[0],outSize:u}):c=new P2e({windowSize:l,inSize:s,batchSize:t.shape[0],outSize:u},n),d=i,i=r.runWebGLProgram(c,[i],e),d.dataId!==t.dataId&&r.disposeIntermediateTensorInfo(d)}return i}/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class D2e{constructor(e,n){this.variableNames=["A"];const r=new Array(e.length);for(let o=0;o<r.length;o++)r[o]=e[n[o]];this.outputShape=r,this.rank=r.length;const a=pn(this.rank),i=F2e(n);this.userCode=`
    void main() {
      ${a} resRC = getOutputCoords();
      setOutput(getA(${i}));
    }
    `}}function F2e(t){const e=t.length;if(e>6)throw Error(`Transpose for rank ${e} is not yet supported`);const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(e);for(let a=0;a<t.length;a++)r[t[a]]=n[a];return r.join()}/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class B2e{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const r=new Array(e.length);for(let c=0;c<r.length;c++)r[c]=e[n[c]];if(this.outputShape=r,this.rank=r.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const a=pn(this.rank),i=Z9("rc",this.rank),o=new Array(this.rank);for(let c=0;c<n.length;c++)o[n[c]]=i[c];const s=`vec2(${o.slice(-2).join()})`,l=`++${i[this.rank-1]} < ${r[this.rank-1]}`,u=`getChannel(getA(${o.join()}), ${s})`;this.userCode=`
    void main() {
      ${a} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${u};
      if(${l}) {
        result[1] = ${u};
      }
      --${i[this.rank-1]};
      if(++${i[this.rank-2]} < ${r[this.rank-2]}) {
        result[2] = ${u};
        if(${l}) {
          result[3] = ${u};
        }
      }
      setOutput(result);
    }
    `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function m2(t,e,n){const r=ce().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new B2e(t.shape,e):new D2e(t.shape,e);return n.runWebGLProgram(r,[t],t.dtype)}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function z2e(t,e,n,r){const a=e,i=t.shape.length,o=Pt(a,t.shape);let s=o;const l=Un(s,i),u=l!=null;let c=t;u&&(c=m2(t,l,r),s=Gn(s.length,i)),Ir("sum",s,i);const[d,p]=Tr(c.shape,s);let f=d;n&&(f=ir(d,o));const m=me(p),y=me(t.shape)/m,x=Re({inputs:{x:c},attrs:{shape:[y,m]},backend:r}),b=kx(t.dtype),v=mc(x,b,"sum",r),w=Re({inputs:{x:v},attrs:{shape:f},backend:r});return r.disposeIntermediateTensorInfo(x),r.disposeIntermediateTensorInfo(v),u&&r.disposeIntermediateTensorInfo(c),w}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function y2(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:i,keepDims:o}=r;return z2e(a,i,o,n)}const j2e={kernelName:Xv,backendName:"webgl",kernelFunc:y2};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function pa(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{perm:i}=r,o=n,s=a.shape.length,l=new Array(s);for(let c=0;c<l.length;c++)l[c]=a.shape[i[c]];let u;if(o.shouldExecuteOnCPU([a])){const c=o.texData.get(a.dataId).values,d=G4(c,a.shape,a.dtype,i,l);u=o.makeTensorInfo(l,a.dtype);const p=o.texData.get(u.dataId);p.values=d}else u=m2(a,i,o);return u}const V2e={kernelName:Wd,backendName:"webgl",kernelFunc:pa};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const h7=1e3;function b2({a:t,b:e,transposeA:n,transposeB:r,backend:a,bias:i=null,preluActivationWeights:o=null,leakyreluAlpha:s=0,activation:l=null}){const u=t.shape.length,c=e.shape.length,d=n?t.shape[u-2]:t.shape[u-1],p=r?e.shape[c-1]:e.shape[c-2],f=n?t.shape[u-1]:t.shape[u-2],m=r?e.shape[c-2]:e.shape[c-1],y=t.shape.slice(0,-2),x=e.shape.slice(0,-2),b=me(y),v=me(x),w=Nt(t.shape.slice(0,-2),e.shape.slice(0,-2)).concat([f,m]);j(d===p,()=>`Error in matMul: inner shapes (${d}) and (${p}) of Tensors with shapes ${t.shape} and ${e.shape} and transposeA=${n} and transposeB=${r} must match.`);const S=n?[b,d,f]:[b,f,d],C=r?[v,m,p]:[v,p,m],I=Re({inputs:{x:t},backend:a,attrs:{shape:S}}),_=Re({inputs:{x:e},backend:a,attrs:{shape:C}}),E=[I,_],P=Math.max(b,v),A=n?I.shape[1]:I.shape[2],D=i!=null,V=o!=null,z=l==="leakyrelu",K=l!=null?um(l,!0):null,X=D||V||z||K!=null;let Z;if((f===1||m===1)&&A>h7&&X===!1){let F=I,Y=_;n&&(F=pa({inputs:{x:I},backend:a,attrs:{perm:[0,2,1]}}),E.push(F)),r&&(Y=pa({inputs:{x:_},backend:a,attrs:{perm:[0,2,1]}}),E.push(Y));const Q=m!==1,ne=m===1;let le=F;Q&&(le=Re({inputs:{x:F},backend:a,attrs:{shape:[P,A,1]}}),E.push(le));const de=m===1?2:1;let re=Y;ne&&(re=Re({inputs:{x:Y},backend:a,attrs:{shape:[P,1,A]}}),E.push(re));const he=K4({inputs:{a:le,b:re},backend:a});Z=y2({inputs:{x:he},backend:a,attrs:{axis:de,keepDims:!0}}),E.push(he)}else{const F=Sa(t.dtype,e.dtype),Y=new l7(S,C,[P,f,m],n,r,D,K,V,z),Q=[I,_];if(i!=null&&Q.push(i),V&&Q.push(o),z){const ne=a.makeTensorInfo([],"float32",Ss(s,"float32"));Q.push(ne),E.push(ne)}Z=a.runWebGLProgram(Y,Q,F)}const q=Re({inputs:{x:Z},backend:a,attrs:{shape:w}});E.push(Z);for(const F of E)a.disposeIntermediateTensorInfo(F);return q}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function W2e(t){const{inputs:e,backend:n,attrs:r}=t,{a,b:i,bias:o,preluActivationWeights:s}=e,{transposeA:l,transposeB:u,activation:c,leakyreluAlpha:d}=r;return b2({a,b:i,transposeA:l,transposeB:u,backend:n,bias:o,preluActivationWeights:s,leakyreluAlpha:d,activation:c})}const U2e={kernelName:Cg,backendName:"webgl",kernelFunc:W2e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const f7="return abs(x);";function G2e(t){const{inputs:e,backend:n}=t,{x:r}=e;if(n.shouldExecuteOnCPU([r])&&r.dtype!=="complex64"){const i=n.texData.get(r.dataId),o=Y9(i.values);return n.makeTensorInfo(r.shape,r.dtype,o)}let a;return ce().getBool("WEBGL_PACK_UNARY_OPERATIONS")?a=new gc(r.shape,f7):a=new Ls(r.shape,f7),n.runWebGLProgram(a,[r],r.dtype)}const H2e={kernelName:Ob,backendName:"webgl",kernelFunc:G2e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const q2e=Li+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,K2e=Rt({opSnippet:q2e}),X2e={kernelName:wf,backendName:"webgl",kernelFunc:K2e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Y2e=Li+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`,Q2e=Rt({opSnippet:Y2e}),Z2e={kernelName:kf,backendName:"webgl",kernelFunc:Q2e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const g7="return a + b;",J2e=_r({opSnippet:g7,packedOpSnippet:g7,supportsComplex:!0,cpuKernelImpl:pxe}),ewe={kernelName:Vd,backendName:"webgl",kernelFunc:J2e};/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class twe{constructor(e,n){this.outputShape=[],this.outputShape=e,this.variableNames=n.map((i,o)=>`T${o}`);const r=[];this.variableNames.forEach(i=>{r.push(`float v${i} = get${i}AtOutCoords();`)});const a=this.variableNames.map(i=>`v${i}`).join(" + ");this.userCode=`
      void main() {
        ${r.join(`
        `)}

        float result = ${a};
        setOutput(result);
      }
    `}}/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class nwe{constructor(e,n){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=n.map((i,o)=>`T${o}`);const r=[];this.variableNames.forEach(i=>{r.push(`vec4 v${i} = get${i}AtOutCoords();`)});const a=this.variableNames.map(i=>`v${i}`).join(" + ");this.userCode=`
      void main() {
        ${r.join(`
        `)}

        vec4 result = ${a};
        setOutput(result);
      }
    `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function v2(t){const{inputs:e,backend:n}=t,r=e;if(r.length===1)return Ga({inputs:{x:r[0]},backend:n});if(r.length>ce().get("WEBGL_MAX_TEXTURES_IN_SHADER")){const s=Math.floor(r.length/2),l=v2({inputs:r.slice(0,s),backend:n}),u=v2({inputs:r.slice(s),backend:n});return v2({inputs:[l,u],backend:n})}const a=r.map(s=>s.dtype).reduce((s,l)=>Sa(s,l)),i=r.map(s=>s.shape),o=ce().getBool("WEBGL_PACK")?new nwe(r[0].shape,i):new twe(r[0].shape,i);return n.runWebGLProgram(o,r,a)}const rwe={kernelName:$b,backendName:"webgl",kernelFunc:v2};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function awe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:i,keepDims:o}=r,s=a.shape.length,l=Pt(i,a.shape);let u=l;const c=Un(u,s);let d=a;c!=null&&(d=pa({inputs:{x:a},backend:n,attrs:{perm:c}}),u=Gn(u.length,s)),Ir("all",u,s);const[p,f]=Tr(d.shape,u),m=me(f),y=Re({inputs:{x:d},backend:n,attrs:{shape:[-1,m]}}),x=mc(y,y.dtype,"all",n);let b;if(o){const v=ir(p,l);b=Re({inputs:{x},backend:n,attrs:{shape:v}})}else b=Re({inputs:{x},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(x),c!=null&&n.disposeIntermediateTensorInfo(d),b}const iwe={kernelName:Rb,backendName:"webgl",kernelFunc:awe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function owe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:i,keepDims:o}=r,s=a.shape.length,l=Pt(i,a.shape);let u=l;const c=Un(u,s);let d=a;c!=null&&(d=pa({inputs:{x:a},backend:n,attrs:{perm:c}}),u=Gn(u.length,s)),Ir("any",u,s);const[p,f]=Tr(d.shape,u),m=me(f),y=Re({inputs:{x:d},backend:n,attrs:{shape:[-1,m]}}),x=mc(y,y.dtype,"any",n);let b;if(o){const v=ir(p,l);b=Re({inputs:{x},backend:n,attrs:{shape:v}})}else b=Re({inputs:{x},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(x),c!=null&&n.disposeIntermediateTensorInfo(d),b}const swe={kernelName:Mb,backendName:"webgl",kernelFunc:owe};/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class lwe{constructor(e,n,r){this.variableNames=["A"];const{windowSize:a,batchSize:i,outSize:o}=e;r||this.variableNames.push("bestIndicesA"),this.outputShape=[i,o];const s=n==="max"?">":"<",l=r?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${a};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${a}; i++) {
          int inIdx = ${l};
          float candidate = getA(batch, inIdx);
          if (candidate ${s} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}}/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class uwe{constructor(e,n,r,a){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,j(e.length>2,()=>`Packed arg${r.charAt(0).toUpperCase()+r.slice(1)} supports only inputs with rank above 2.`);const i=e[e.length-1],o=Math.ceil(i/n);this.outputShape=e.slice(0,-1),o>1&&this.outputShape.push(o),a||this.variableNames.push("bestIndicesA");const s=this.outputShape,l=s.length,u=pn(l),c=da("coords",l);let d,p;if(o===1){p=l+1;const E=pn(p);d=`
        ${E} sourceLocR = ${E}(${c.join()}, 0);
        ++${c[l-1]};
        ${E} sourceLocG = ${E}(${c.join()}, 0);
        ++${c[l-2]};
        ${E} sourceLocA = ${E}(${c.join()}, 0);
        --${c[l-1]};
        ${E} sourceLocB = ${E}(${c.join()}, 0);
        --${c[l-2]};`}else p=l,d=`
        ${u} sourceLocR = coords;
        ++${c[l-1]};
        ${u} sourceLocG = coords;
        ++${c[l-2]};
        ${u} sourceLocA = coords;
        --${c[l-1]};
        ${u} sourceLocB = coords;
        --${c[l-2]};`;const f=["x","y","z","w","u","v"].slice(0,p),m="."+f[p-1],y=f.map(E=>"int "+E),x=da("sourceLocR",p-1).concat("inIdx.r"),b=da("sourceLocG",p-1).concat("inIdx.g"),v=da("sourceLocB",p-1).concat("inIdx.b"),w=da("sourceLocA",p-1).concat("inIdx.a"),S=r==="max"?"greaterThan":"lessThan",C=a?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${x.join()}),
                             getBestIndicesAChannel(${b.join()}),
                             getBestIndicesAChannel(${v.join()}),
                             getBestIndicesAChannel(${w.join()})));`,I=`vec4(
            getAChannel(${x.join()}),
            hasNextCol ? getAChannel(${b.join()}) : 0.,
            hasNextRow ? getAChannel(${v.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${w.join()}) : 0.)`,_=a?"":`
      float getBestIndicesAChannel(${y.join()}) {
        return getChannel(getBestIndicesA(${f.join()}),
                                          vec2(${f.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${y.join()}) {
        return getChannel(getA(${f.join()}),
                               vec2(${f.slice(-2).join()}));
      }
      ${_}
      void main() {
        ${u} coords = getOutputCoords();
        bool hasNextCol = ${c[l-1]} < ${s[l-1]-1};
        bool hasNextRow = ${c[l-2]} < ${s[l-2]-1};
        ${d}
        ivec4 srcIdx = ivec4(sourceLocR${m}, sourceLocG${m},
          sourceLocB${m}, sourceLocA${m}) * ${n};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${I};

        for (int i = 0; i < ${n}; i++) {
          inIdx = srcIdx;
          ${C}
          vec4 candidate = ${I};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${S}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function m7(t,e,n,r=null){let a=e.shape[0],i=e.shape[1];r!=null&&(a=r.shape[0],i=r.shape[1]);const o=Jx(i),s={windowSize:o,inSize:i,batchSize:a,outSize:Math.ceil(i/o)},l=new lwe(s,n,r==null),u=[e];r!=null&&u.push(r);const c=t.runWebGLProgram(l,u,"int32");if(c.shape[1]===1)return c;const d=m7(t,e,n,c);return t.disposeIntermediateTensorInfo(c),d}function y7(t,e,n,r=null){const a=r!=null?r.shape:e.shape,i=a[a.length-1],o=Jx(i),s=new uwe(a,o,n,r==null),l=r==null?[e]:[e,r],u=t.runWebGLProgram(s,l,"int32");if(u.shape.length===e.shape.length){const c=y7(t,e,n,u);return t.disposeIntermediateTensorInfo(u),c}return u}function b7(t,e,n,r){const a=[n];if(Ir("arg"+r.charAt(0).toUpperCase()+r.slice(1),a,e.shape.length),!ce().getBool("WEBGL_PACK_REDUCE")||e.shape.length<=2){const i=[],o=t.texData.get(e.dataId),s=o!==null&&o.isPacked;let l=e;s&&(l=t.unpackTensor(e),i.push(l));const[u,c]=Tr(l.shape,a),d=me(c),p=Re({inputs:{x:l},backend:t,attrs:{shape:[-1,d]}});i.push(p);const f=m7(t,p,r);i.push(f);const m=Re({inputs:{x:f},backend:t,attrs:{shape:u}});return i.forEach(y=>t.disposeIntermediateTensorInfo(y)),m}return y7(t,e,r)}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function cwe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:i}=r;let o=Pt(i,a.shape);const s=Un(o,a.shape.length);let l=a;const u=[];s!=null&&(l=pa({inputs:{x:a},backend:n,attrs:{perm:s}}),u.push(l),o=Gn(o.length,l.shape.length)),Ir("argMax",[o[0]],l.shape.length);const c=b7(n,l,o[0],"max");return u.forEach(d=>n.disposeIntermediateTensorInfo(d)),c}const dwe={kernelName:Ab,backendName:"webgl",kernelFunc:cwe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function pwe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:i}=r;let o=Pt(i,a.shape);const s=Un(o,a.shape.length);let l=a;const u=[];s!=null&&(l=pa({inputs:{x:a},backend:n,attrs:{perm:s}}),u.push(l),o=Gn(o.length,l.shape.length)),Ir("argMin",[o[0]],l.shape.length);const c=b7(n,l,o[0],"min");return u.forEach(d=>n.disposeIntermediateTensorInfo(d)),c}const hwe={kernelName:Pb,backendName:"webgl",kernelFunc:pwe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const fwe=Li+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,gwe=Rt({opSnippet:fwe}),mwe={kernelName:Sf,backendName:"webgl",kernelFunc:gwe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const ywe=Li+"return log(x + sqrt(x * x + 1.0));",bwe=Rt({opSnippet:ywe}),vwe={kernelName:Cf,backendName:"webgl",kernelFunc:bwe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const xwe=Li+`
  return atan(x);
`,wwe=Rt({opSnippet:xwe}),kwe={kernelName:Nf,backendName:"webgl",kernelFunc:wwe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Swe=q4+`
  return atan(a, b);
`,Cwe=`
  vec4 result = atan(a, b);
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+sm+`
  return result;
`,Nwe=_r({opSnippet:Swe,packedOpSnippet:Cwe}),Twe={kernelName:If,backendName:"webgl",kernelFunc:Nwe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Iwe=Li+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,Ewe=Rt({opSnippet:Iwe}),_we={kernelName:Tf,backendName:"webgl",kernelFunc:Ewe};/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class cm{constructor(e,n,r,a=!1,i=!1){if(this.variableNames=["x"],n==="avg"&&r)throw new Error("Cannot compute positions for average pool.");const o=e.filterWidth,s=e.strideHeight,l=e.strideWidth,u=e.dilationHeight,c=e.dilationWidth,d=e.effectiveFilterHeight,p=e.effectiveFilterWidth,f=e.padInfo.top,m=e.padInfo.left;this.outputShape=e.outShape;const y=n==="avg",x=`((batch  * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + d`,b=`(xR * ${e.inWidth} + xC) * ${e.inChannels} + d`;let v="0.0";if(y||(v="-1.0 / 1e-20"),r){const E=">=";this.userCode=`
        const ivec2 strides = ivec2(${s}, ${l});
        const ivec2 pads = ivec2(${f}, ${m});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${d};
              wR += ${u}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${p};
                wC += ${c}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value ${E} currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${a?i?x:b:`wR * ${p} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const w="max";let S=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(S="avgValue / count");const C=Math.floor(o/4)*4,I=o%4,_=`
      if (${y}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${w}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${s}, ${l});
      const ivec2 pads = ivec2(${f}, ${m});
      const float initializationValue = ${v};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${v});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${d};
            wR += ${u}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${C}; wC += 4) {
            int xC = xCCorner + wC * ${c};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              getValue(batch, xR, xC + 2 * ${c}, d),
              getValue(batch, xR, xC + 3 * ${c}, d)
            );

            ${_}
          }

          int xC = xCCorner + ${C};
          if (${I===1}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${_}
          } else if (${I===2}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              initializationValue,
              initializationValue
            );

            ${_}
          } else if (${I===3}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              getValue(batch, xR, xC + 2 * ${c}, d),
              initializationValue
            );

            ${_}
          }
        }
        setOutput(${S});
      }
    `}}class X4{constructor(e,n,r,a=!1,i=!1){if(this.variableNames=["x"],n==="avg"&&r)throw new Error("Cannot compute positions for average pool.");const o=e.filterWidth,s=e.strideDepth,l=e.strideHeight,u=e.strideWidth,c=e.dilationDepth,d=e.dilationHeight,p=e.dilationWidth,f=e.effectiveFilterDepth,m=e.effectiveFilterHeight,y=e.effectiveFilterWidth,x=e.padInfo.front,b=e.padInfo.top,v=e.padInfo.left;this.outputShape=e.outShape;const w=n==="avg";let S="0.0";if(w||(S="-1.0 / 1e-20"),r){const A=">=";this.userCode=`
        const ivec3 strides =
            ivec3(${s}, ${l}, ${u});
        const ivec3 pads = ivec3(${x}, ${b}, ${v});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${f};
              wD += ${c}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${e.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${m};
                wR += ${d}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${y};
                  wC += ${p}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value ${A} currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${a?i?`(((batch * ${e.inDepth} + xD) * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`((xD * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`wD * ${m} * ${y} +
                      wR * ${y} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const C="max";let I=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(I="avgValue / count");const _=Math.floor(o/4)*4,E=o%4,P=`
      if (${w}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${C}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${s}, ${l}, ${u});
      const ivec3 pads = ivec3(${x}, ${b}, ${v});
      const float initializationValue = ${S};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${S});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${f};
            wD += ${c}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${m};
            wR += ${d}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${_}; wC += 4) {
              int xC = xCCorner + wC * ${p};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${p}, ch),
                getValue(batch, xD, xR, xC + 2 * ${p}, ch),
                getValue(batch, xD, xR, xC + 3 * ${p}, ch)
              );

              ${P}
            }

            int xC = xCCorner + ${_};
            if (${E===1}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${P}
            } else if (${E===2}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${p}, ch),
                initializationValue,
                initializationValue
              );

              ${P}
            } else if (${E===3}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${p}, ch),
                getValue(batch, xD, xR, xC + 2 * ${p}, ch),
                initializationValue
              );

              ${P}
            }
          }
          setOutput(${I});
        }
      }
    `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Owe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e;im(a,"avgPool");const{filterSize:i,strides:o,pad:s,dimRoundingMode:l}=r,u=1;j(Wr(o,u),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${u}'`);const c=Ei(a.shape,i,o,u,s,l);if(c.filterWidth===1&&c.filterHeight===1&&tn(c.inShape,c.outShape))return Ga({inputs:{x:a},backend:n});const d=new cm(c,"avg",!1);return n.runWebGLProgram(d,[a],"float32")}const $we={kernelName:Lb,backendName:"webgl",kernelFunc:Owe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Rwe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{filterSize:i,strides:o,pad:s,dimRoundingMode:l,dataFormat:u}=r,c=[1,1,1],d=_s(a.shape,i,o,c,s,l,u),p=new X4(d,"avg",!1);return n.runWebGLProgram(p,[a],"float32")}const Mwe={kernelName:Db,backendName:"webgl",kernelFunc:Rwe};/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class Awe{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const n=e.filterHeight,r=e.filterWidth,a=e.strideHeight,i=e.strideWidth,o=e.dilationHeight,s=e.dilationWidth,l=e.effectiveFilterHeight,u=e.effectiveFilterWidth,c=l-1-e.padInfo.top,d=u-1-e.padInfo.left,p=1/(n*r);this.userCode=`
      const ivec2 pads = ivec2(${c}, ${d});
      const float avgMultiplier = float(${p});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${l};
            wR += ${o}) {
          float dyR = float(dyRCorner + wR) / ${a}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${u};
            wC+= ${s}) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}}class Pwe{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const n=e.filterDepth,r=e.filterHeight,a=e.filterWidth,i=e.strideDepth,o=e.strideHeight,s=e.strideWidth,l=e.dilationDepth,u=e.dilationHeight,c=e.dilationWidth,d=e.effectiveFilterDepth,p=e.effectiveFilterHeight,f=e.effectiveFilterWidth,m=d-1-e.padInfo.front,y=p-1-e.padInfo.top,x=f-1-e.padInfo.left,b=1/(n*r*a);this.userCode=`
      const ivec3 pads = ivec3(${m}, ${y}, ${x});
      const float avgMultiplier = float(${b});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${d};
            wD += ${l}) {
          float dyD = float(dyDCorner + wD) / ${i}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${p};
              wR += ${u}) {
            float dyR = float(dyRCorner + wR) / ${o}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${f};
                wC += ${c}) {
              float dyC = float(dyCCorner + wC) / ${s}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Lwe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:a,input:i}=e,o=i,{filterSize:s,strides:l,pad:u,dimRoundingMode:c}=r,d=[1,1,1],p=_s(o.shape,s,l,d,u,c),f=new Pwe(p);return n.runWebGLProgram(f,[a],o.dtype)}const Dwe={kernelName:q3,backendName:"webgl",kernelFunc:Lwe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Fwe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:a,input:i}=e,o=i;im([a,i],"avgPoolGrad");const{filterSize:s,strides:l,pad:u}=r,c=Ei(o.shape,s,l,1,u),d=new Awe(c);return n.runWebGLProgram(d,[a],o.dtype)}const Bwe={kernelName:H3,backendName:"webgl",kernelFunc:Fwe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function zwe(t){const{inputs:e,backend:n,attrs:r}=t,{a,b:i}=e,{transposeA:o,transposeB:s}=r;return b2({a,b:i,transposeA:o,transposeB:s,backend:n})}const jwe={kernelName:Fb,backendName:"webgl",kernelFunc:zwe};/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class Vwe{constructor(e,n,r,a,i,o){this.outputShape=[],this.variableNames=["x","mean","variance"],Nt(e,n),Nt(e,r);let s="0.0";a!=null&&(Nt(e,a),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");let l="1.0";i!=null&&(Nt(e,i),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${s};
        float scale = ${l};
        float inv = scale * inversesqrt(variance + float(${o}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class Wwe{constructor(e,n,r,a,i,o){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],Nt(e,n),Nt(e,r);let s="vec4(0.0)";a!=null&&(Nt(e,a),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");let l="vec4(1.0)";i!=null&&(Nt(e,i),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = ${s};
        vec4 scale = ${l};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${o}));

        setOutput((x - mean) * inv + offset);
      }
    `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Uwe=({inputs:t,backend:e,attrs:n})=>{const{x:r,mean:a,variance:i,offset:o,scale:s}=t;j(a.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),j(o==null||a.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),j(s==null||a.shape.length===s.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:l}=n;l==null&&(l=.001);const u=[r,a,i];let c=null;o!=null&&(c=o.shape,u.push(o));let d=null;s!=null&&(d=s.shape,u.push(s));const p=ce().getBool("WEBGL_PACK_NORMALIZATION")?new Wwe(r.shape,a.shape,i.shape,c,d,l):new Vwe(r.shape,a.shape,i.shape,c,d,l);return e.runWebGLProgram(p,u,u[0].dtype)},Gwe={kernelName:dv,backendName:"webgl",kernelFunc:Uwe};/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class Hwe{constructor(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;const n=pn(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const r=qwe(this.rank);let a;const i=e.map((o,s)=>`sourceLoc.${Y4[s]} = start[${s}] + coords.${Y4[s]};`);a=`
        ${n} sourceLoc;
        ${n} coords = getOutputCoords();
        ${i.join(`
`)}
      `,this.userCode=`
      void main() {
        ${a}
        setOutput(getSource(${r}));
      }
    `}}const Y4=["x","y","z","w","u","v"];function qwe(t){if(t===1)return"sourceLoc";if(t<=6)return Y4.slice(0,t).map(e=>"sourceLoc."+e).join(",");throw Error(`Slicing for rank ${t} is not yet supported`)}/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class Kwe{constructor(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const n=pn(this.rank),r=da("coords",this.rank),a=da("sourceLoc",this.rank),i=this.rank===1?"sourceLoc":`vec2(${a.slice(-2).join()})`,o=`getChannel(getSource(${a.join()}), ${i})`,s=`
      result.x = ${o};
      if (++${r[this.rank-1]} < ${e[this.rank-1]}) {
        ++${a[this.rank-1]};
        result.y = ${o};
        --${a[this.rank-1]};
      }
    `,l=this.rank===1?"":`
      --${r[this.rank-1]};
      if (++${r[this.rank-2]} < ${e[this.rank-2]}) {
        ++${a[this.rank-2]};
        result.z = ${o};
        if (++${r[this.rank-1]} < ${e[this.rank-1]}) {
          ++${a[this.rank-1]};
          result.w = ${o};
        }
      }
    `,u=this.rank<=4?`sourceLoc = coords +
            ${n}(${e.map((c,d)=>`start[${d}]`).join()});`:e.map((c,d)=>`${a[d]} = ${r[d]} + start[${d}];`).join(`
`);this.userCode=`
      void main() {
        ${n} coords = getOutputCoords();
        ${n} sourceLoc;
        ${u}
        vec4 result = vec4(0.);
        ${s}
        ${l}
        setOutput(result);
      }
    `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Xwe(t,e,n,r){const a=r.texData.get(t.dataId),i=r.makeTensorInfo(n,t.dtype),o=r.texData.get(i.dataId);Object.assign(o,a),o.refCount=1,o.shape=n,o.dtype=t.dtype;let s=UT(e,qe(t.shape));a.slice&&(s+=a.slice.flatOffset),o.slice={flatOffset:s,origDataId:a.slice&&a.slice.origDataId||t.dataId};const l=r.dataRefCount.get(o.slice.origDataId)||1;return r.dataRefCount.set(o.slice.origDataId,l+1),i}function Cp(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{begin:i,size:o}=r,[s,l]=GT(a,i,o);if(jT(a,s,l),me(l)===0)return n.makeTensorInfo(l,a.dtype,[]);if(n.shouldExecuteOnCPU([a])||a.dtype==="string"){const d=n.texData.get(a.dataId),p=Vxe(d.values,s,l,a.shape,a.dtype);return n.makeTensorInfo(l,a.dtype,p)}const{isPacked:u}=n.texData.get(a.dataId),c=WT(a.shape,s,l);if(u||!c){const d=ce().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Kwe(l):new Hwe(l),p=[s];return n.runWebGLProgram(d,[a],a.dtype,p)}return n.uploadToGPU(a.dataId),Xwe(a,s,l,n)}const Ywe={kernelName:Kv,backendName:"webgl",kernelFunc:Cp};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Qwe=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{blockShape:i,crops:o}=r;j(a.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const s=i.reduce((v,w)=>v*w),l=Yg(a.shape,i,s),u=Qg(l.length,i.length),c=Zg(a.shape,i,s),d=VI(o,i.length),p=WI(c,o,i.length),f=[],m=Re({inputs:{x:a},backend:n,attrs:{shape:l}}),y=pa({inputs:{x:m},backend:n,attrs:{perm:u}}),x=Re({inputs:{x:y},backend:n,attrs:{shape:c}}),b=Cp({inputs:{x},backend:n,attrs:{begin:d,size:p}});return f.push(m),f.push(y),f.push(x),f.forEach(v=>n.disposeIntermediateTensorInfo(v)),b},Zwe={kernelName:Bb,backendName:"webgl",kernelFunc:Qwe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Jwe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,weights:i}=e,{size:o}=r,s=n.readSync(a.dataId),l=n.readSync(i.dataId),u=X9(s,l,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,u)}const eke={kernelName:zb,backendName:"webgl",kernelFunc:Jwe};/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function tke(t){const{inputs:e,backend:n}=t,{s0:r,s1:a}=e,i=n.readSync(r.dataId),o=n.readSync(a.dataId),s=Nt(Array.from(i),Array.from(o));return n.makeTensorInfo([s.length],"int32",Int32Array.from(s))}const nke={kernelName:jb,backendName:"webgl",kernelFunc:tke};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const rke="return float(a != b);",v7=_r({opSnippet:rke,cpuKernelImpl:Axe,dtype:"bool"}),ake={kernelName:ag,backendName:"webgl",kernelFunc:v7};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function dm(t){const{inputs:e,backend:n}=t,{input:r}=e,a=n.texData.get(r.dataId);return Ga({inputs:{x:a.complexTensorInfos.real},backend:n})}const ike={kernelName:zv,backendName:"webgl",kernelFunc:dm};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const oke="return float(int(x));";function ske(t,e){const n=new Ls(t.shape,oke),r=e.runWebGLProgram(n,[t],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Q4(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{dtype:i}=r;if(i==="complex64"){if(a.dtype==="complex64")return Ga({inputs:{x:a},backend:n});const o=Fl(a.shape),s=Q4({inputs:{x:a},backend:n,attrs:{dtype:"float32"}}),l=Hl({inputs:{real:s,imag:o},backend:n});return o.dispose(),n.disposeIntermediateTensorInfo(s),l}if(a.dtype==="complex64"){const o=dm({inputs:{input:a},backend:n}),s=Q4({inputs:{x:o},backend:n,attrs:{dtype:i}});return n.disposeIntermediateTensorInfo(o),s}if(!z3(a.dtype,i)){const o=Ga({inputs:{x:a},backend:n});return{dataId:o.dataId,shape:o.shape,dtype:i}}if(n.shouldExecuteOnCPU([a])){const o=n.texData.get(a.dataId).values,[s,l,u]=fxe(o,a.shape,a.dtype,i);return n.makeTensorInfo(s,l,u)}if(i==="int32")return ske(a,n);if(i==="bool"){const o=n.makeTensorInfo([],"bool",nr("bool",1)),s=v7({inputs:{a,b:o},backend:n});return n.disposeIntermediateTensorInfo(o),s}throw new Error(`Error in Cast: failed to cast ${a.dtype} to ${i}`)}const lke={kernelName:Ef,backendName:"webgl",kernelFunc:Q4};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const x7="return ceil(x);",uke=Rt({opSnippet:x7,packedOpSnippet:x7,cpuKernelImpl:gxe}),cke={kernelName:_f,backendName:"webgl",kernelFunc:uke};/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class dke{constructor(e){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class pke{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`
      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function hke(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{clipValueMin:i,clipValueMax:o}=r;let s;ce().getBool("WEBGL_PACK_CLIP")?s=new pke(a.shape):s=new dke(a.shape);const l=[[i],[o]];return n.runWebGLProgram(s,[a],a.dtype,l)}const fke={kernelName:Of,backendName:"webgl",kernelFunc:hke};/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class gke{constructor(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function w7(t,e){return{dataId:e.dataId,dtype:e.dtype,shape:t.shape}}function mke(t){const{inputs:e,backend:n}=t,{x:r}=e,a=n.texData.get(r.dataId),i=new gke(r.shape),o=[w7(r,a.complexTensorInfos.real),w7(r,a.complexTensorInfos.imag)];return n.runWebGLProgram(i,o,o[0].dtype)}const yke={kernelName:Wb,backendName:"webgl",kernelFunc:mke};/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class bke{constructor(e){this.outputShape=[],this.outputShape=Bo(e,1),this.variableNames=e.map((o,s)=>`T${s}`);const n=new Array(e.length-1);n[0]=e[0][1];for(let o=1;o<n.length;o++)n[o]=n[o-1]+e[o][1];const r=[`if (yC < ${n[0]}) setOutput(getT0(yR, yC));`];for(let o=1;o<n.length;o++){const s=n[o-1];r.push(`else if (yC < ${n[o]}) setOutput(getT${o}(yR, yC-${s}));`)}const a=n.length,i=n[n.length-1];r.push(`else setOutput(getT${a}(yR, yC-${i}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${r.join(`
        `)}
      }
    `}}/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class vke{constructor(e,n){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=Bo(e,n);const r=this.outputShape,a=r.length,i=pn(a),o=da("coords",a),s=["x","y","z","w","u","v"].slice(0,a);this.variableNames=e.map((y,x)=>`T${x}`);const l=new Array(e.length-1);l[0]=e[0][n];for(let y=1;y<l.length;y++)l[y]=l[y-1]+e[y][n];const u=s[n],c=s.slice(-2),d=s.join();let p=`if (${u} < ${l[0]}) {
        return getChannel(
            getT0(${d}), vec2(${c.join()}));
        }`;for(let y=1;y<l.length;y++){const x=l[y-1];p+=`
        if (${u} < ${l[y]}  && ${u} >= ${l[y-1]}) {
          return getChannel(
            getT${y}(${x2(s,u,x)}),
            vec2(${x2(c,u,x)}));
        }`}const f=l.length,m=l[l.length-1];p+=`
        return getChannel(
          getT${f}(${x2(s,u,m)}),
          vec2(${x2(c,u,m)}));`,this.userCode=`
      float getValue(${s.map(y=>"int "+y)}) {
        ${p}
      }

      void main() {
        ${i} coords = getOutputCoords();
        vec4 result = vec4(getValue(${o}), 0., 0., 0.);

        ${o[a-1]} = ${o[a-1]} + 1;
        if (${o[a-1]} < ${r[a-1]}) {
          result.g = getValue(${o});
        }

        ${o[a-2]} = ${o[a-2]} + 1;
        if (${o[a-2]} < ${r[a-2]}) {
          result.a = getValue(${o});
        }

        ${o[a-1]} = ${o[a-1]} - 1;
        if (${o[a-2]} < ${r[a-2]} &&
            ${o[a-1]} < ${r[a-1]}) {
          result.b = getValue(${o});
        }
        setOutput(result);
      }
    `}}function x2(t,e,n){const r=t.indexOf(e);return t.map((a,i)=>i===r?`${a} - ${n}`:a).join()}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function w2(t){const{inputs:e,backend:n}=t,{input:r}=e,a=n.texData.get(r.dataId);return Ga({inputs:{x:a.complexTensorInfos.imag},backend:n})}const xke={kernelName:gv,backendName:"webgl",kernelFunc:w2};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function pm(t,e,n){const r=t[0].dtype;if(r==="complex64"){const d=t.map(x=>dm({inputs:{input:x},backend:n})),p=t.map(x=>w2({inputs:{input:x},backend:n})),f=pm(d,e,n),m=pm(p,e,n),y=Hl({inputs:{real:f,imag:m},backend:n});return d.forEach(x=>n.disposeIntermediateTensorInfo(x)),p.forEach(x=>n.disposeIntermediateTensorInfo(x)),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),y}let a=n.shouldExecuteOnCPU(t);if(r==="string"&&(a=!0),a){const d=t.map(v=>{const w=[-1,me(v.shape.slice(e))];return Re({inputs:{x:v},backend:n,attrs:{shape:w}})}),p=d.map(v=>({vals:n.readSync(v.dataId),shape:v.shape})),f=Bo(d.map(v=>v.shape),1),m=d[0].shape[0]===1,y=mxe(p,f,r,m),x=Bo(t.map(v=>v.shape),e),b=n.makeTensorInfo(x,r,y);return d.forEach(v=>n.disposeIntermediateTensorInfo(v)),b}const i=ce().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(t.length>i){const d=[];for(let f=0;f<t.length;f+=i){const m=t.slice(f,f+i);d.push(pm(m,e,n))}const p=pm(d,e,n);for(const f of d)n.disposeIntermediateTensorInfo(f);return p}if(ce().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&t[0].shape.length>1){const d=new vke(t.map(p=>p.shape),e);return n.runWebGLProgram(d,t,r)}const{tensors2D:o,outShape:s}=wke(t,e,n),l=new bke(o.map(d=>d.shape)),u=n.runWebGLProgram(l,o,r);o.forEach(d=>n.disposeIntermediateTensorInfo(d));const c=Re({inputs:{x:u},attrs:{shape:s},backend:n});return n.disposeIntermediateTensorInfo(u),c}function wke(t,e,n){const r=Bo(t.map(a=>a.shape),e);return{tensors2D:t.map(a=>Re({inputs:{x:a},attrs:{shape:[-1,me(a.shape.slice(e))]},backend:n})),outShape:r}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function k7(t){const{inputs:e,backend:n,attrs:r}=t,{axis:a}=r,i=Pt(a,e[0].shape)[0],o=e.map(u=>u.shape);BI(o,i);const s=Bo(e.map(u=>u.shape),i);if(me(s)===0)return n.makeTensorInfo(s,e[0].dtype,[]);const l=e.filter(u=>me(u.shape)>0);return l.length===1?Ga({inputs:{x:l[0]},backend:n}):pm(l,i,n)}const kke={kernelName:Ub,backendName:"webgl",kernelFunc:k7};/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class S7{constructor(e,n=!1,r=null,a=!1,i=!1){this.variableNames=["x","W"],this.outputShape=e.outShape;const o=e.padInfo.top,s=e.padInfo.left,l=e.strideHeight,u=e.strideWidth,c=e.dilationHeight,d=e.dilationWidth,p=e.filterHeight,f=e.filterWidth,m=Math.floor(e.inChannels/4)*4,y=e.inChannels%4,x=e.dataFormat==="channelsLast",b=x?1:2,v=x?2:3,w=x?3:1;let S="",C="";r&&(a?S=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:i?S=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:S=`
          float activation(float x) {
            ${r}
          }
        `,C="result = activation(result);");const I=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${S}

      const ivec2 strides = ivec2(${l}, ${u});
      const ivec2 pads = ivec2(${o}, ${s});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${w}];

        ivec2 xRCCorner =
            ivec2(coords[${b}], coords[${v}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${p}; wR++) {
          int xR = xRCorner + wR * ${c};

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${f}; wC++) {
            int xC = xCCorner + wC * ${d};

            if (xC < 0 || xC >= ${e.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${m}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${x}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${y===1}) {

              if (${x}) {
                dotProd +=
                    getX(batch, xR, xC, ${m}) *
                    getW(wR, wC, ${m}, d2);
              } else {
                dotProd +=
                    getX(batch, ${m}, xR, xC) *
                    getW(wR, wC, ${m}, d2);
              }

            } else if (${y===2}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${m}, d2),
                getW(wR, wC, ${m} + 1, d2)
              );

              if (${x}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${m}),
                  getX(batch, xR, xC, ${m} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${m}, xR, xC),
                  getX(batch, ${m} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${y===3}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${m}, d2),
                getW(wR, wC, ${m} + 1, d2),
                getW(wR, wC, ${m} + 2, d2)
              );

              if (${x}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${m}),
                  getX(batch, xR, xC, ${m} + 1),
                  getX(batch, xR, xC, ${m} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${m}, xR, xC),
                  getX(batch, ${m} + 1, xR, xC),
                  getX(batch, ${m} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${I}
        ${C}
        setOutput(result);
      }
    `}}class Ske{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const n=e.padInfo.front,r=e.padInfo.top,a=e.padInfo.left,i=e.strideDepth,o=e.strideHeight,s=e.strideWidth,l=e.dilationDepth,u=e.dilationHeight,c=e.dilationWidth,d=e.filterDepth,p=e.filterHeight,f=e.filterWidth,m=Math.floor(e.inChannels/4)*4,y=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${i}, ${o}, ${s});
      const ivec3 pads = ivec3(${n}, ${r}, ${a});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${d}; wF++) {
          int xF = xFCorner + wF * ${l};

          if (xF < 0 || xF >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${p}; wR++) {
            int xR = xRCorner + wR * ${u};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${f}; wC++) {
              int xC = xCCorner + wC * ${c};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${m}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${y===1}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${m}) *
                  getW(wF, wR, wC, ${m}, d2);
              } else if (${y===2}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${m}),
                  getX(batch, xF, xR, xC, ${m} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${m}, d2),
                  getW(wF, wR, wC, ${m} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${y===3}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${m}),
                  getX(batch, xF, xR, xC, ${m} + 1),
                  getX(batch, xF, xR, xC, ${m} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${m}, d2),
                  getW(wF, wR, wC, ${m} + 1, d2),
                  getW(wF, wR, wC, ${m} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class C7{constructor(e,n=!1,r=null,a=!1,i=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=ca(this.outputShape.length);const o=e.padInfo.left,s=e.strideWidth,l=e.dilationWidth,u=e.filterHeight,c=e.filterWidth,d=c;let p=`
       int xR; int xC; int xCOffset;
       vec4 wTexel; vec4 previous; vec4 final;`;for(let x=0;x<c;x++)p+=`
           vec4 xTexelC${x*2};
           int xTexelC${x*2}Ready;
           vec4 xTexelC${x*2+1};
           int xTexelC${x*2+1}Ready;
           vec4 xC${x};`;p+=`
     for (int r = 0; r < ${u}; r++) {
      for (int d1 = 0; d1 < ${e.inChannels}; d1 += 2) {
       `;for(let x=0;x<c;x++)p+=`
           xTexelC${x*2} = vec4(0.0);
           xTexelC${x*2}Ready = 0;
           xTexelC${x*2+1} = vec4(0.0);
           xTexelC${x*2+1}Ready = 0;
           xC${x} = vec4(0.0);`;p+=`
         xR = xRCorner + r * dilations[0];
         if (xR >=0 && xR < inDims[0]) {
       `;for(let x=0;x<(d+1)/2;x++){const b=x*2;if(p+=`
           xC = xCCorner + ${b*l};
           `,s===1){if(b<c&&(o%2===1?(p+=`
                 xCOffset = xC + 1;
                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b}Ready == 0) {
                   xTexelC${b} = getX(batch, xR, xCOffset, d1);

                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${b}.zw = vec2(0.0);
                   }
                   xTexelC${b}Ready = 1;
                 }
               `,l===1&&b>0?p+=`
                 xC${b} = vec4(xTexelC${b-2}.zw, xTexelC${b}.xy);
                 `:p+=`
                   xCOffset = xC + 1 - 2;

                   if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       previous.zw = vec2(0.0);
                     }

                     xC${b} = vec4(previous.zw, xTexelC${b}.xy);
                   } else {
                     xC${b} = vec4(0.0, 0.0, xTexelC${b}.xy);
                   }
                   `):p+=`
                 if (xC >= 0 && xC < inDims[1] && xTexelC${b}Ready == 0) {
                   xTexelC${b} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${b}.zw = vec2(0.0);
                   }
                   xTexelC${b}Ready = 1;
                 }

                 xC${b} = xTexelC${b};
                 `,b+1<c)){const v=o%2===0?Nb(l):l;l%2===0&&o%2===1||l%2!==0&&o%2!==1?(p+=`
                   xCOffset = xC + imod(pads[1], 2) + ${v};

                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b+1}Ready == 0) {
                     xTexelC${b+1} = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       xTexelC${b+1}.zw = vec2(0.0);
                     }
                     xTexelC${b+1}Ready = 1;
                   }
                   `,l>1?p+=`
                     xCOffset -= 2;
                     if (xCOffset >= 0 && xCOffset < inDims[1]) {
                      previous = getX(batch, xR, xCOffset, d1);
                      xC${b+1} = vec4(previous.zw, xTexelC${b+1}.xy);
                     } else {
                      xC${b+1} = vec4(0.0, 0.0, xTexelC${b+1}.xy);
                     }
                     `:p+=`
                     xC${b+1} = vec4(xTexelC${b}.zw, xTexelC${b+1}.xy);
                     `):v===1?p+=`
                     xC${b+1} = xTexelC${b};
                     `:p+=`
                     xCOffset = xC + ${v};

                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b+1}Ready == 0) {
                       xTexelC${b+1} = getX(batch, xR, xCOffset, d1);
                       if (xCOffset + 1 >= inDims[1]) {
                         xTexelC${b+1}.zw = vec2(0.0);
                       }
                       xTexelC${b+1}Ready = 1;
                     }

                     xC${b+1} = xTexelC${b+1};
                     `}}else b<c&&(o%2===1?(p+=`
                 xCOffset = xC + 1 - strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b}Ready == 0) {
                   xTexelC${b} = getX(batch, xR, xCOffset, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${b}.zw = vec2(0.0);
                   }
                   xTexelC${b}Ready = 1;
                 }

                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${b+1}Ready == 0) {
                   xTexelC${b+1} = getX(batch, xR, xC + 1, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xC + 2 >= inDims[1]) {
                     xTexelC${b+1}.zw = vec2(0.0);
                   }
                   xTexelC${b+1}Ready = 1;
                 }

                 xC${b} = vec4(xTexelC${b}.zw, xTexelC${b+1}.zw);
               `,b+1<c&&(p+=`
                   final = vec4(0.0);
                   xCOffset = xC + 1 + strides[1];
                   if(xCOffset >= 0 && xCOffset < inDims[1]) {
                     final = getX(batch, xR, xCOffset, d1);
                   }
                   xC${b+1} = vec4(xTexelC${b+1}.xy, final.xy);
                 `)):(p+=`
                 if(xC >= 0 && xC < inDims[1] && xTexelC${b}Ready == 0) {
                   xTexelC${b} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${b}.zw = vec2(0.0);
                   }
                   xTexelC${b}Ready = 1;
                 }

                 xCOffset = xC + strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b+1}Ready == 0) {
                   xTexelC${b+1} = getX(batch, xR, xCOffset, d1);
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${b+1}.zw = vec2(0.);
                   }
                   xTexelC${b+1}Ready = 1;
                 }

                 xC${b} = vec4(
                   xTexelC${b}.xy, xTexelC${b+1}.xy);
               `,b+1<c&&(p+=`
                   xC${b+1} = vec4(xTexelC${b}.zw, xTexelC${b+1}.zw);
                 `)));b<c&&(p+=`
             wTexel = getW(r, ${b}, d1, d2);
             dotProd += xC${b}.xxzz * vec4(wTexel.xy, wTexel.xy);
             if(d1 + 1 < ${e.inChannels}) {
               dotProd += xC${b}.yyww * vec4(wTexel.zw, wTexel.zw);
             }
           `,b+1<c&&(p+=`
               wTexel = getW(r, ${b+1}, d1, d2);
               dotProd += xC${b+1}.xxzz * vec4(wTexel.xy, wTexel.xy);
               if(d1 + 1 < ${e.inChannels}) {
                 dotProd += xC${b+1}.yyww * vec4(wTexel.zw, wTexel.zw);
               }
             `))}p+=`
     }
   `,p+=`
     }
   `,p+=`
     }
   `;let f="",m="";r&&(a?f=`vec4 activation(vec4 a) {
           vec4 b = getPreluActivationWeightsAtOutCoords();
           ${r}
         }`:i?f=`vec4 activation(vec4 a) {
           vec4 b = getLeakyreluAlphaAtOutCoords();
           ${r}
         }`:f=`vec4 activation(vec4 x) {
           ${r}
         }`,m="result = activation(result);");const y=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
       ${f}

       void main() {
         ivec4 coords = getOutputCoords();
         int batch = coords.x;
         ivec2 xRCCorner = coords.yz * strides - pads;
         int d2 = coords.w;
         int xRCorner = xRCCorner.x;
         int xCCorner = xRCCorner.y;

         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
         vec4 dotProd = vec4(0.000000000000001);

         ${p}

         vec4 result = dotProd - vec4(0.000000000000001);
         ${y}
         ${m}
         setOutput(result);
       }
     `}}/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class Cke{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=e,this.enableShapeUniforms=ca(this.outputShape.length);const{dataFormat:r}=n,a=ua(),i=r==="channelsLast",o=i?1:2,s=i?2:3,l=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${e[2]} && pos < ${e[1]}) {`;let u="";for(let c=0;c<=1;c++)for(let d=0;d<=1;d++)u+=`
          blockIndex = rc.z + ${d};
          pos = rc.y + ${c};

          ${l}
            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];
            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);

            if(d0 < inputShape[${o}] && d0 >= 0) {
              // Use custom imod instead mod. On Intel GPU, mod may generate
              // unexpected value.
              // https://github.com/tensorflow/tfjs/issues/5447
              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];
              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /
                  inChannels);

              if(d1 < inputShape[${s}] && d1 >= 0) {

                ch = imod(pos, inChannels);

                if (${i}) {
                  innerDims = vec2(d1, ch);
                  result[${c*2+d}] = getChannel(
                    getA(rc.x, d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${c*2+d}] = getChannel(
                    getA(rc.x, ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${u}

        ${a.output} = result;
      }
    `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function k2(t,e){const n=t.length;return n>=3?e?[...t.slice(0,-3),t[n-3]*t[n-2],t[n-1]]:[...t.slice(0,-3),t[n-3],t[n-2]*t[n-1]]:!e&&n===1&&t[0]>1?[t[0],1]:null}function N7({x:t,filter:e,convInfo:n,backend:r,bias:a=null,preluActivationWeights:i=null,leakyreluAlpha:o=0,activation:s=null}){const l=t.shape,u=r.texData.get(t.dataId),c=n.inChannels,d=l[0]*l[1]*l[2],p=n.outChannels,f=n.dataFormat==="channelsLast",m=!1,y=!1;let x;const b=[];if(i!=null){const v=k2(i.shape,f);v!=null&&(i=Re({inputs:{x:i},backend:r,attrs:{shape:v}}),b.push(i))}if(a!=null){const v=k2(a.shape,f);v!=null&&(a=Re({inputs:{x:a},backend:r,attrs:{shape:v}}),b.push(a))}if(!((d===1||p===1)&&c>h7)&&u.isPacked&&f&&u.texture!=null&&l[2]%2!==0&&tn(u.shape.slice(-3),l.slice(-3))){const v=l[0]*l[1]*(l[2]+1),w={dataId:t.dataId,shape:[1,v,n.inChannels],dtype:t.dtype},S=u.shape;u.shape=u.shape.slice(),u.shape[u.shape.length-2]++,j(f2(u.shape,w.shape),()=>`packed reshape ${u.shape} to ${w.shape} isn't free`);const C=Re({inputs:{x:e},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}});b.push(C);const I=b2({a:w,b:C,backend:r,transposeA:m,transposeB:y,bias:a,activation:s,preluActivationWeights:i,leakyreluAlpha:o}),_=r.texData.get(I.dataId);j(_.isPacked,()=>"batchMatMul result is expected to be packed"),u.shape=S,_.shape=n.outShape,x=Ga({inputs:{x:I},backend:r}),x.shape=n.outShape,b.push(I)}else{const v=n.outHeight*n.outWidth,w=Re({inputs:{x:t},backend:r,attrs:{shape:f?[n.batchSize,v,n.inChannels]:[n.batchSize,n.inChannels,v]}}),S=Re({inputs:{x:e},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}}),C=b2({a:f?w:S,b:f?S:w,transposeA:!f,transposeB:y,backend:r,bias:a,activation:s,preluActivationWeights:i,leakyreluAlpha:o});x=Re({inputs:{x:C},backend:r,attrs:{shape:n.outShape}}),b.push(w),b.push(S),b.push(C)}for(const v of b)r.disposeIntermediateTensorInfo(v);return x}function T7({x:t,filter:e,convInfo:n,backend:r,bias:a=null,preluActivationWeights:i=null,leakyreluAlpha:o=0,activation:s=null}){const{filterWidth:l,filterHeight:u,inChannels:c,outWidth:d,outHeight:p,dataFormat:f}=n,m=f==="channelsLast",y=l*u*c,x=p*d,b=[n.batchSize,y,x],v=!0,w=!1,S=[];if(i!=null){const F=k2(i.shape,m);F!=null&&(i=Re({inputs:{x:i},backend:r,attrs:{shape:F}}),S.push(i))}if(a!=null){const F=k2(a.shape,m);F!=null&&(a=Re({inputs:{x:a},backend:r,attrs:{shape:F}}),S.push(a))}const C=Re({inputs:{x:e},backend:r,attrs:{shape:[1,y,me(e.shape)/y]}});S.push(C);const I=new Cke(b,n),_=[t.shape,[n.padInfo.top,n.padInfo.left],[n.strideHeight,n.strideWidth],[n.dilationHeight,n.dilationWidth],[n.inChannels],[n.filterWidth*n.inChannels],[n.outWidth]],E=r.runWebGLProgram(I,[t],"float32",_),P=Re({inputs:{x:E},backend:r,attrs:{shape:b}});S.push(E),S.push(P);const A=a!=null,D=i!=null,V=s==="leakyrelu",z=s?um(s,!0):null,K=new l7(m?P.shape:C.shape,m?C.shape:P.shape,m?[n.batchSize,x,n.outChannels]:[n.batchSize,n.outChannels,x],v,w,A,z,D,V),X=m?[P,C]:[C,P];if(a&&X.push(a),D&&X.push(i),V){const F=r.makeTensorInfo([],"float32",Ss(o,"float32"));X.push(F),S.push(F)}const Z=r.runWebGLProgram(K,X,"float32"),q=Re({inputs:{x:Z},backend:r,attrs:{shape:n.outShape}});S.push(Z);for(const F of S)r.disposeIntermediateTensorInfo(F);return q}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Nke(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,filter:i}=e,{strides:o,pad:s,dataFormat:l,dilations:u,dimRoundingMode:c}=r,d=Os(l),p=fr(a.shape,i.shape,o,u,s,c,!1,d);let f;if(p.filterHeight===1&&p.filterWidth===1&&p.dilationHeight===1&&p.dilationWidth===1&&p.strideHeight===1&&p.strideWidth===1&&(p.padInfo.type==="SAME"||p.padInfo.type==="VALID"))f=N7({x:a,filter:i,convInfo:p,backend:n});else if(p.strideWidth<=2&&d==="channelsLast"&&ce().getBool("WEBGL_EXP_CONV")){const y=new C7(p),x=[[p.padInfo.top,p.padInfo.left],[p.strideHeight,p.strideWidth],[p.dilationHeight,p.dilationWidth],[p.inHeight,p.inWidth]];f=n.runWebGLProgram(y,[a,i],"float32",x)}else if(ce().getBool("WEBGL_CONV_IM2COL"))f=T7({x:a,filter:i,convInfo:p,backend:n});else{const y=new S7(p);f=n.runWebGLProgram(y,[a,i],"float32")}const m=Re({inputs:{x:f},backend:n,attrs:{shape:p.outShape}});return n.disposeIntermediateTensorInfo(f),m}const Tke={kernelName:Gb,backendName:"webgl",kernelFunc:Nke};/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class Ike{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideHeight,r=e.strideWidth,a=e.padInfo.top,i=e.padInfo.left,o=e.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${a};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${r} - ${i};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              if (${o}) {
                float dyValue = getDy(b, yR, yC, d2);
                float xValue = getX(b, xR, xC, d1);
                dotProd += (xValue * dyValue);
              } else {
                float dyValue = getDy(b, d2, yR, yC);
                float xValue = getX(b, d1, xR, xC);
                dotProd += (xValue * dyValue);
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class Eke{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterHeight,r=e.filterWidth,a=e.strideHeight,i=e.strideWidth,o=e.dataFormat==="channelsLast",s=n-1-e.padInfo.top,l=r-1-e.padInfo.left,u=o?1:2,c=o?2:3,d=o?3:1;this.userCode=`
      const ivec2 pads = ivec2(${s}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${d}];

        ivec2 dyCorner = ivec2(coords[${u}], coords[${c}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${a}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${r} - 1 - wC;

            for (int d2 = 0; d2 < ${e.outChannels}; d2++) {

              if (${o}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class _ke{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideDepth,r=e.strideHeight,a=e.strideWidth,i=e.padInfo.front,o=e.padInfo.top,s=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yF = 0; yF < ${e.outDepth}; yF++) {
            int xF = wF + yF * ${n} - ${i};

            if (xF < 0 || xF >= ${e.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${e.outHeight}; yR++) {
              int xR = wR + yR * ${r} - ${o};

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${e.outWidth}; yC++) {
                int xC = wC + yC * ${a} - ${s};

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class Oke{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterDepth,r=e.filterHeight,a=e.filterWidth,i=e.strideDepth,o=e.strideHeight,s=e.strideWidth,l=n-1-e.padInfo.front,u=r-1-e.padInfo.top,c=a-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${l}, ${u}, ${c});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${n}; wF++) {
          float dyF = float(dyFCorner + wF) / ${i}.0;

          if (dyF < 0.0 || dyF >= ${e.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${n} - 1 - wF;

          for (int wR = 0; wR < ${r}; wR++) {
            float dyR = float(dyRCorner + wR) / ${o}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${r} - 1 - wR;

            for (int wC = 0; wC < ${a}; wC++) {
              float dyC = float(dyCCorner + wC) / ${s}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${a} - 1 - wC;

              for (int d2 = 0; d2 < ${e.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function $ke(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,dy:i}=e,{strides:o,pad:s,dataFormat:l,dimRoundingMode:u,filterShape:c}=r,d=Os(l),p=fr(a.shape,c,o,1,s,u,!1,d),f=new Ike(p);return n.runWebGLProgram(f,[a,i],"float32")}const Rke={kernelName:Hb,backendName:"webgl",kernelFunc:$ke};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Mke(t){const{inputs:e,backend:n,attrs:r}=t,{dy:a,filter:i}=e,{inputShape:o,strides:s,pad:l,dataFormat:u,dimRoundingMode:c}=r,d=Os(u),p=fr(o,i.shape,s,1,l,c,!1,d),f=new Eke(p);return n.runWebGLProgram(f,[a,i],"float32")}const Ake={kernelName:qb,backendName:"webgl",kernelFunc:Mke};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Pke(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,filter:i}=e,{strides:o,pad:s,dilations:l}=r,u=Ll(a.shape,i.shape,o,l,s),c=new Ske(u);return n.runWebGLProgram(c,[a,i],"float32")}const Lke={kernelName:Kb,backendName:"webgl",kernelFunc:Pke};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Dke(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,dy:i}=e,{strides:o,pad:s,filterShape:l}=r,u=Ll(a.shape,l,o,1,s),c=new _ke(u);return n.runWebGLProgram(c,[a,i],"float32")}const Fke={kernelName:K3,backendName:"webgl",kernelFunc:Dke};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Bke(t){const{inputs:e,backend:n,attrs:r}=t,{dy:a,filter:i}=e,{pad:o,strides:s,inputShape:l}=r,u=Ll(l,i.shape,s,1,o),c=new Oke(u);return n.runWebGLProgram(c,[a,i],"float32")}const zke={kernelName:Xb,backendName:"webgl",kernelFunc:Bke};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const jke=Sp+`
  return cos(x);
`,Vke=Rt({opSnippet:jke}),Wke={kernelName:$f,backendName:"webgl",kernelFunc:Vke};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Uke=`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`,Gke=Rt({opSnippet:Uke}),Hke={kernelName:Rf,backendName:"webgl",kernelFunc:Gke};/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class qke{constructor(e,n,r,a,i){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[o,s,l,u]=e,[c]=n,[d,p]=r;this.outputShape=[c,d,p,u];const f=a==="bilinear"?1:0,[m,y]=[`${s-1}.0`,`${l-1}.0`],[x,b,v]=d>1?[`${(s-1)/(d-1)}`,"(y2-y1) * height_ratio",`y1*${m} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${m}`],[w,S,C]=p>1?[`${(l-1)/(p-1)}`,"(x2-x1) * width_ratio",`x1*${y} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${y}`];this.userCode=`
      const float height_ratio = float(${x});
      const float width_ratio = float(${w});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${o}) {
          return;
        }

        float height_scale = ${b};
        float width_scale = ${S};

        float in_y = ${v};
        if( in_y < 0.0 || in_y > ${m} ) {
          setOutput(float(${i}));
          return;
        }
        float in_x = ${C};
        if( in_x < 0.0 || in_x > ${y} ) {
          setOutput(float(${i}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${f} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const Kke=t=>{const{inputs:e,backend:n,attrs:r}=t,{image:a,boxes:i,boxInd:o}=e,{cropSize:s,method:l,extrapolationValue:u}=r,c=new qke(a.shape,i.shape,s,l,u);return n.runWebGLProgram(c,[a,i,o],"float32")},Xke={kernelName:Zb,backendName:"webgl",kernelFunc:Kke};var hm;(function(t){t.Prod="*",t.Sum="+"})(hm||(hm={}));class I7{constructor(e,n,r,a){this.op=e,this.outputShape=n,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const i=this.outputShape.length,o=this.op===hm.Prod?"1.0":"0.0",s=r?o:`getX(${E7(i,"coords",this.op)})`,l=this.outputShape[this.outputShape.length-1];let u="",c="";r?(u=a?`end != ${l-1}`:"end != 0",c=a?"end + 1":"end - 1"):(u=a?`end + pow2 < ${l}`:"end >= pow2",c=a?"end + pow2":"end - pow2"),this.userCode=`
      void main() {
        ${pn(i)} coords = getOutputCoords();
        int end = ${_7(i,"coords",this.op)};
        float val = ${s};
        int pow2 = int(pow(2.0, index));
        if (${u}) {
          int idx = ${c};
          ${_7(i,"coords",this.op)} = idx;
          val ${this.op}= getX(${E7(i,"coords",this.op)});
        }
        setOutput(val);
      }
    `}}function E7(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.x, ${e}.y`;if(t===3)return`${e}.x, ${e}.y, ${e}.z`;if(t===4)return`${e}.x, ${e}.y, ${e}.z, ${e}.w`;throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}function _7(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.y`;if(t===3)return`${e}.z`;if(t===4)return`${e}.w`;throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function O7(t,e,n,r,a,i){const o=e.shape.length,s=Un([r],o);let l=e;s!=null&&(l=pa({inputs:{x:e},backend:n,attrs:{perm:s}}));const u=Gn(1,o)[0];if(u!==o-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${e.shape.length-1} but got axis=${r}`);const c=l.shape[u];let d=Ga({inputs:{x:l},backend:n});for(let p=0;p<=Math.ceil(Math.log2(c))-1;p++){const f=new I7(t,l.shape,!1,i),m=[[p]],y=d;d=n.runWebGLProgram(f,[d],d.dtype,m),n.disposeIntermediateTensorInfo(y)}if(a){const p=new I7(t,l.shape,a,i),f=d;d=n.runWebGLProgram(p,[d],d.dtype),n.disposeIntermediateTensorInfo(f)}if(s!=null){const p=jg(s),f=pa({inputs:{x:d},backend:n,attrs:{perm:p}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(l),f}return d}/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Yke(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:i,exclusive:o,reverse:s}=r;return O7(hm.Prod,a,n,i,o,s)}const Qke={kernelName:Yb,backendName:"webgl",kernelFunc:Yke};/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Zke(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:i,exclusive:o,reverse:s}=r;return O7(hm.Sum,a,n,i,o,s)}const Jke={kernelName:Qb,backendName:"webgl",kernelFunc:Zke};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function eSe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,weights:i}=e,{size:o,binaryOutput:s}=r;if(a.shape.length===1){const l=n.readSync(a.dataId),u=n.readSync(i.dataId),c=X9(l,u,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,c)}else if(a.shape.length===2){const l=n.bufferSync(a),u=n.bufferSync(i),c=hxe(l,u,o,s);return n.makeTensorInfo(c.shape,i.dtype,c.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${a.shape.length}.`)}const tSe={kernelName:Jb,backendName:"webgl",kernelFunc:eSe};/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class nSe{constructor(e,n,r){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=n,this.dataFormat=r,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${n};
      int offset_h = imod(h, ${n});
      int in_w = w / ${n};
      int offset_w = imod(w, ${n});
      int offset_d = (offset_h * ${n} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function rSe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{blockSize:i,dataFormat:o}=r,s=a.shape[0],l=o==="NHWC"?a.shape[1]:a.shape[2],u=o==="NHWC"?a.shape[2]:a.shape[3],c=o==="NHWC"?a.shape[3]:a.shape[1],d=l*i,p=u*i,f=c/(i*i),m=o==="NHWC"?[s,d,p,f]:[s,f,d,p],y=new nSe(m,i,o);return n.runWebGLProgram(y,[a],a.dtype)}const aSe={kernelName:ev,backendName:"webgl",kernelFunc:rSe};/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class $7{constructor(e,n=!1,r=null,a=!1,i=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=ca(this.outputShape.length);const o=e.filterHeight,s=e.filterWidth,l=e.outChannels/e.inChannels;let u="",c="";r&&(a?u=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:i?u=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:u=`
          float activation(float x) {
            ${r}
          }
        `,c="result = activation(result);");const d=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${u}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${l};
        int q = d2 - d1 * ${l};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${o}; wR++) {
          int xR = xRCorner + wR * dilations[0];

          if (xR < 0 || xR >= inDims[0]) {
            continue;
          }

          for (int wC = 0; wC < ${s}; wC++) {
            int xC = xCCorner + wC * dilations[1];

            if (xC < 0 || xC >= inDims[1]) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${d}
        ${c}
        setOutput(result);
      }
    `}}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class R7{constructor(e,n=!1,r=null,a=!1,i=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=ca(this.outputShape.length);const o=e.outChannels/e.inChannels,s=e.padInfo.left,l=e.strideWidth,u=e.dilationWidth,c=e.filterHeight,d=e.filterWidth,p=d;let f=`
      int xR; int xC; int xCOffset;
      vec4 wTexel; vec4 previous; vec4 final;`;for(let b=0;b<d;b++)f+=`
          vec4 xTexelC${b*2};
          int xTexelC${b*2}Ready;
          vec4 xTexelC${b*2+1};
          int xTexelC${b*2+1}Ready;
          vec4 xC${b};`;f+=`
    for (int r = 0; r < ${c}; r++) {
      `;for(let b=0;b<d;b++)f+=`
          xTexelC${b*2} = vec4(0.0);
          xTexelC${b*2}Ready = 0;
          xTexelC${b*2+1} = vec4(0.0);
          xTexelC${b*2+1}Ready = 0;
          xC${b} = vec4(0.0);`;f+=`
        xR = xRCorner + r * dilations[0];
        if (xR >=0 && xR < inDims[0]) {
      `;for(let b=0;b<(p+1)/2;b++){const v=b*2;if(f+=`
          xC = xCCorner + ${v*u};
          `,l===1){if(v<d&&(s%2===1?(f+=`
                xCOffset = xC + 1;
                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v}Ready == 0) {
                  xTexelC${v} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${v}.zw = vec2(0.0);
                  }
                  xTexelC${v}Ready = 1;
                }
              `,u===1&&v>0?f+=`
                xC${v} = vec4(xTexelC${v-2}.zw, xTexelC${v}.xy);
                `:f+=`
                  xCOffset = xC + 1 - 2;

                  if (xCOffset >= 0 && xCOffset < inDims[1]) {
                    previous = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      previous.zw = vec2(0.0);
                    }

                    xC${v} = vec4(previous.zw, xTexelC${v}.xy);
                  } else {
                    xC${v} = vec4(0.0, 0.0, xTexelC${v}.xy);
                  }
                  `):f+=`
                if (xC >= 0 && xC < inDims[1] && xTexelC${v}Ready == 0) {
                  xTexelC${v} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${v}.zw = vec2(0.0);
                  }
                  xTexelC${v}Ready = 1;
                }

                xC${v} = xTexelC${v};
                `,v+1<d)){const w=s%2===0?Nb(u):u;u%2===0&&s%2===1||u%2!==0&&s%2!==1?(f+=`
                  xCOffset = xC + imod(pads[1], 2) + ${w};

                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v+1}Ready == 0) {
                    xTexelC${v+1} = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      xTexelC${v+1}.zw = vec2(0.0);
                    }
                    xTexelC${v+1}Ready = 1;
                  }
                  `,u>1?f+=`
                    xCOffset -= 2;
                    if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);
                     xC${v+1} = vec4(previous.zw, xTexelC${v+1}.xy);
                    } else {
                     xC${v+1} = vec4(0.0, 0.0, xTexelC${v+1}.xy);
                    }
                    `:f+=`
                    xC${v+1} = vec4(xTexelC${v}.zw, xTexelC${v+1}.xy);
                    `):w===1?f+=`
                    xC${v+1} = xTexelC${v};
                    `:f+=`
                    xCOffset = xC + ${w};

                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v+1}Ready == 0) {
                      xTexelC${v+1} = getX(batch, xR, xCOffset, d1);
                      if (xCOffset + 1 >= inDims[1]) {
                        xTexelC${v+1}.zw = vec2(0.0);
                      }
                      xTexelC${v+1}Ready = 1;
                    }

                    xC${v+1} = xTexelC${v+1};
                    `}}else v<d&&(s%2===1?(f+=`
                xCOffset = xC + 1 - strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v}Ready == 0) {
                  xTexelC${v} = getX(batch, xR, xCOffset, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${v}.zw = vec2(0.0);
                  }
                  xTexelC${v}Ready = 1;
                }

                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${v+1}Ready == 0) {
                  xTexelC${v+1} = getX(batch, xR, xC + 1, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xC + 2 >= inDims[1]) {
                    xTexelC${v+1}.zw = vec2(0.0);
                  }
                  xTexelC${v+1}Ready = 1;
                }

                xC${v} = vec4(xTexelC${v}.zw, xTexelC${v+1}.zw);
              `,v+1<d&&(f+=`
                  final = vec4(0.0);
                  xCOffset = xC + 1 + strides[1];
                  if(xCOffset >= 0 && xCOffset < inDims[1]) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xC${v+1} = vec4(xTexelC${v+1}.xy, final.xy);
                `)):(f+=`
                if(xC >= 0 && xC < inDims[1] && xTexelC${v}Ready == 0) {
                  xTexelC${v} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${v}.zw = vec2(0.0);
                  }
                  xTexelC${v}Ready = 1;
                }

                xCOffset = xC + strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${v+1}Ready == 0) {
                  xTexelC${v+1} = getX(batch, xR, xCOffset, d1);
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${v+1}.zw = vec2(0.);
                  }
                  xTexelC${v+1}Ready = 1;
                }

                xC${v} = vec4(
                  xTexelC${v}.xy, xTexelC${v+1}.xy);
              `,v+1<d&&(f+=`
                  xC${v+1} = vec4(xTexelC${v}.zw, xTexelC${v+1}.zw);
                `)));v<d&&(f+=`
            wTexel = getW(r, ${v}, d1, q);
            dotProd += xC${v} * vec4(wTexel.xz, wTexel.xz);
          `,v+1<d&&(f+=`
              wTexel = getW(r, ${v+1}, d1, q);
              dotProd += xC${v+1} * vec4(wTexel.xz, wTexel.xz);
            `))}f+=`
    }
  `,f+=`
      }
    `;let m="",y="";r&&(a?m=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:i?m=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:m=`vec4 activation(vec4 x) {
          ${r}
        }`,y="result = activation(result);");const x=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${m}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${o};
        int q = d2 - d1 * ${o};
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
        vec4 dotProd = vec4(0.000000000000001);

        ${f}

        vec4 result = dotProd - vec4(0.000000000000001);
        ${x}
        ${y}
        setOutput(result);
      }
    `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function iSe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,filter:i}=e,{strides:o,pad:s,dilations:l,dimRoundingMode:u}=r;let c=l;c==null&&(c=[1,1]),j(Wr(o,c),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${o} and dilations '${c}'`);const d=fr(a.shape,i.shape,o,c,s,u,!0);let p;ce().getBool("WEBGL_PACK_DEPTHWISECONV")&&d.strideWidth<=2&&d.outChannels/d.inChannels===1?p=new R7(d):p=new $7(d);const f=[[d.padInfo.top,d.padInfo.left],[d.strideHeight,d.strideWidth],[d.dilationHeight,d.dilationWidth],[d.inHeight,d.inWidth]];return n.runWebGLProgram(p,[a,i],"float32",f)}const oSe={kernelName:tv,backendName:"webgl",kernelFunc:iSe};/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class sSe{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideHeight,r=e.strideWidth,a=e.padInfo.top,i=e.padInfo.left,o=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${o} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${a};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${r} - ${i};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class lSe{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterHeight,r=e.filterWidth,a=e.strideHeight,i=e.strideWidth,o=n-1-e.padInfo.top,s=r-1-e.padInfo.left,l=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${o}, ${s});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${a}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${r} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${l}; dm++) {
              int d2 = d1 * ${l} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function uSe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,dy:i}=e,{strides:o,dilations:s,pad:l,dimRoundingMode:u,filterShape:c}=r,d=fr(a.shape,c,o,s,l,u,!0),p=new sSe(d);return n.runWebGLProgram(p,[a,i],"float32")}const cSe={kernelName:nv,backendName:"webgl",kernelFunc:uSe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function dSe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:a,filter:i}=e,{strides:o,dilations:s,pad:l,dimRoundingMode:u,inputShape:c}=r,d=fr(c,i.shape,o,s,l,u,!0),p=new lSe(d);return n.runWebGLProgram(p,[a,i],"float32")}const pSe={kernelName:rv,backendName:"webgl",kernelFunc:dSe};/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class hSe{constructor(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function fSe(t){const{inputs:e,backend:n}=t,{x:r}=e,a=[...r.shape,...r.shape],i=me(r.shape),o=Re({inputs:{x:r},backend:n,attrs:{shape:[i]}}),s=new hSe(i),l=n.runWebGLProgram(s,[o],o.dtype),u=Re({inputs:{x:l},backend:n,attrs:{shape:a}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(l),u}const gSe={kernelName:av,backendName:"webgl",kernelFunc:fSe};/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class mSe{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const{inHeight:n,inWidth:r,padInfo:a,strideHeight:i,strideWidth:o,filterHeight:s,filterWidth:l,dilationHeight:u,dilationWidth:c}=e,{top:d,left:p}=a;this.userCode=`
      const ivec2 strides = ivec2(${i}, ${o});
      const ivec2 pads = ivec2(${d}, ${p});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${s}; h++) {
          int hIn = hBeg + h * ${u};

          if (hIn >= 0 && hIn < ${n}) {
            for (int w = 0; w < ${l}; w++) {
              int wIn = wBeg + w * ${c};

              if (wIn >= 0 && wIn < ${r}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function ySe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,filter:i}=e,{strides:o,pad:s,dilations:l}=r,u=Dg(a.shape,i.shape,o,s,"NHWC",l);let c;const d=new mSe(u);c=n.runWebGLProgram(d,[a,i],"float32");const p=Re({inputs:{x:c},backend:n,attrs:{shape:u.outShape}});return n.disposeIntermediateTensorInfo(c),p}const bSe={kernelName:iv,backendName:"webgl",kernelFunc:ySe};/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function vSe(t){const{inputs:e,backend:n,attrs:r}=t,{equation:a}=r,i=e,{allDims:o,summedDims:s,idDims:l}=e4(a,i.length);n4(o.length,l,i);const{path:u,steps:c}=r4(s,l),d=c.length;let p=null,f=o.length;const m=[];for(let y=0;y<d;++y){for(const x of c[y]){const{permutationIndices:b,expandDims:v}=t4(f,l[x]);let w;a4(b)?w=i[x]:(w=pa({inputs:{x:i[x]},backend:n,attrs:{perm:b}}),m.push(w));const S=w.shape.slice();for(let C=0;C<v.length;++C)S.splice(v[C],0,1);tn(w.shape,S)||(w=Re({inputs:{x:w},backend:n,attrs:{shape:S}}),m.push(w)),p===null?p=w:(p=K4({inputs:{a:w,b:p},backend:n}),m.push(p))}y<d-1&&(u[y]>=0&&(p=y2({inputs:{x:p},backend:n,attrs:{axis:u[y]-(o.length-f),keepDims:!1}}),m.push(p)),f--)}for(const y of m)y!==p&&n.disposeIntermediateTensorInfo(y);return p}const xSe={kernelName:ov,backendName:"webgl",kernelFunc:vSe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const wSe="return (x >= 0.0) ? x : (exp(x) - 1.0);",kSe=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,SSe=Rt({opSnippet:wSe,packedOpSnippet:kSe}),CSe={kernelName:Af,backendName:"webgl",kernelFunc:SSe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const NSe="return (b >= 1.0) ? a : a * (b + 1.0);",TSe=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,ISe=t=>{const{inputs:e,backend:n}=t,{dy:r,y:a}=e,i=ce().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new lm(TSe,r.shape,a.shape):new kp(NSe,r.shape,a.shape);return n.runWebGLProgram(i,[r,a],r.dtype)},ESe={kernelName:Q3,backendName:"webgl",kernelFunc:ISe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const _Se=`
  return vec4(equal(a, b));
`,OSe="return float(a == b);",$Se=_r({opSnippet:OSe,packedOpSnippet:_Se,dtype:"bool",cpuKernelImpl:yxe}),RSe={kernelName:Lf,backendName:"webgl",kernelFunc:$Se};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const MSe=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${HI};
  float a1 = ${qI};
  float a2 = ${KI};
  float a3 = ${XI};
  float a4 = ${YI};
  float a5 = ${QI};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`,ASe=Rt({opSnippet:MSe}),PSe={kernelName:Pf,backendName:"webgl",kernelFunc:ASe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const LSe=Sp+`
  return exp(x);
`,DSe=`
  vec4 result = exp(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,M7=Rt({opSnippet:LSe,packedOpSnippet:DSe,cpuKernelImpl:bxe,dtype:"float32"}),FSe={kernelName:Df,backendName:"webgl",kernelFunc:M7};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Z4(t){const{inputs:e,attrs:n,backend:r}=t,{dim:a}=n,{input:i}=e,o=i.shape.length,s=i.shape.slice();let l=a;return a<0&&(j(-(o+1)<=a,()=>`Axis must be in the interval [${-(o+1)}, ${o}]`),l=o+a+1),s.splice(l,0,1),Re({inputs:{x:i},backend:r,attrs:{shape:s}})}const BSe={kernelName:sv,backendName:"webgl",kernelFunc:Z4};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const A7="return exp(x) - 1.0;",zSe=Rt({opSnippet:A7,packedOpSnippet:A7,cpuKernelImpl:vxe}),jSe={kernelName:Ff,backendName:"webgl",kernelFunc:zSe};/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class P7{constructor(e,n,r){this.variableNames=["real","imag"];const a=n[1];this.outputShape=n;const i=r?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,o=r?`${a}.0`:"1.0";let s;if(e==="real")s="return real * expR - imag * expI;";else if(e==="imag")s="return real * expI + imag * expR;";else throw new Error(`FFT component must be either "real" or "imag", got ${e}.`);this.userCode=`
      const float exponentMultiplier = ${i};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${s}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${a});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${a}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${o};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function L7(t,e,n){const r=n.texData.get(t.dataId),a=me(t.shape),i=t.shape[t.shape.length-1],o=a/i,s=Re({inputs:{x:t},backend:n,attrs:{shape:[o,i]}}),l=s.shape,u=new P7("real",l,e),c=new P7("imag",l,e),d=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:l},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:l}],p=n.runWebGLProgram(u,d,"float32"),f=n.runWebGLProgram(c,d,"float32"),m=Hl({inputs:{real:p,imag:f},backend:n});n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f);const y=Re({inputs:{x:m},backend:n,attrs:{shape:t.shape}});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(m),y}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function VSe(t){const{inputs:e,backend:n}=t,{input:r}=e;return L7(r,!1,n)}const WSe={kernelName:lv,backendName:"webgl",kernelFunc:VSe};/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class USe{constructor(e,n){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode=`
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function fm(t){const{backend:e,attrs:n}=t,{shape:r,value:a}=n;let{dtype:i}=n;if(i=i||jd(a),i==="string"){const o=rr(i,me(r));return o.fill(a),e.makeTensorInfo(r,i,o)}else{const o=new USe(r,a),s=[[a]];return e.runWebGLProgram(o,[],i,s)}}const GSe={kernelName:uv,backendName:"webgl",kernelFunc:fm};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class HSe{constructor(e){this.variableNames=["Image"],this.outputShape=[];const n=e[2];this.outputShape=e,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${n} - x - 1;
          float outputValue;
          if(coordX >= 0 && coordX < ${n}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const qSe={kernelName:cv,backendName:"webgl",kernelFunc:({inputs:t,backend:e})=>{const{image:n}=t,r=e,a=new HSe(n.shape);return r.runWebGLProgram(a,[n],n.dtype)}};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const D7="return floor(x);",KSe=Rt({opSnippet:D7,packedOpSnippet:D7,cpuKernelImpl:xxe}),XSe={kernelName:Bf,backendName:"webgl",kernelFunc:KSe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const YSe=`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,QSe=`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,ZSe=_r({opSnippet:YSe,packedOpSnippet:QSe,dtype:"int32"}),JSe={kernelName:zf,backendName:"webgl",kernelFunc:ZSe};/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class eCe{constructor(e){this.variableNames=["A"];const n=ua(),[r,a]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${a}.0, ${r}.0);

        vec4 values = ${n.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}}/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class tCe{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const n=ua(),[r,a]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${a}.0, ${r}.0);
            vec4 values = ${n.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${n.output} = result;
      }
    `}}/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const nCe={kernelName:fx,backendName:"webgl",kernelFunc:rCe};let Np,J4=ce().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function rCe(t){const{inputs:e,backend:n,attrs:r}=t;let{pixels:a}=e;const{numChannels:i}=r,o=typeof HTMLVideoElement<"u"&&a instanceof HTMLVideoElement,s=typeof HTMLImageElement<"u"&&a instanceof HTMLImageElement,[l,u]=o?[a.videoWidth,a.videoHeight]:[a.width,a.height],c=[u,l],d=[u,l,i];if(s||o){const y=ce().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(Np==null||y!==J4)&&(J4=y,Np=document.createElement("canvas").getContext("2d",{willReadFrequently:J4})),Np.canvas.width=l,Np.canvas.height=u,Np.drawImage(a,0,0,l,u),a=Np.canvas}const p=n.makeTensorInfo(c,"int32");n.texData.get(p.dataId).usage=ii.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(p.dataId),a);const f=ce().getBool("WEBGL_PACK")?new tCe(d):new eCe(d),m=n.runWebGLProgram(f,[p],"int32");return n.disposeData(p.dataId),m}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function aCe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,filter:i,bias:o,preluActivationWeights:s}=e,{strides:l,pad:u,dataFormat:c,dilations:d,dimRoundingMode:p,activation:f,leakyreluAlpha:m}=r,y=Os(c),x=fr(a.shape,i.shape,l,d,u,p,!1,y);let b;const v=[],w=o!=null,S=s!=null,C=f==="leakyrelu",I=()=>{const E=[a,i],P=(A,D)=>{if(D==="NCHW"&&A.shape.length===1&&A.shape[0]!==1){const V=Re({inputs:{x:A},backend:n,attrs:{shape:[A.shape[0],1,1]}});return v.push(V),V}return A};if(w&&E.push(P(o,c)),S&&E.push(P(s,c)),C){const A=n.makeTensorInfo([],"float32",Ss(m,"float32"));E.push(A),v.push(A)}return E};if(x.filterHeight===1&&x.filterWidth===1&&x.dilationHeight===1&&x.dilationWidth===1&&x.strideHeight===1&&x.strideWidth===1&&(x.padInfo.type==="SAME"||x.padInfo.type==="VALID"))b=N7({x:a,filter:i,convInfo:x,backend:n,bias:o,activation:f,preluActivationWeights:s,leakyreluAlpha:m});else if(x.strideWidth<=2&&y==="channelsLast"&&ce().getBool("WEBGL_EXP_CONV")){const E=f?um(f,!0):null,P=new C7(x,w,E,S,C),A=[[x.padInfo.top,x.padInfo.left],[x.strideHeight,x.strideWidth],[x.dilationHeight,x.dilationWidth],[x.inHeight,x.inWidth]],D=I();b=n.runWebGLProgram(P,D,"float32",A)}else if(ce().getBool("WEBGL_CONV_IM2COL"))b=T7({x:a,filter:i,convInfo:x,backend:n,bias:o,activation:f,preluActivationWeights:s,leakyreluAlpha:m});else{const E=f?um(f,!1):null,P=new S7(x,w,E,S,C),A=I();b=n.runWebGLProgram(P,A,"float32")}const _=Re({inputs:{x:b},backend:n,attrs:{shape:x.outShape}});return v.push(b),v.forEach(E=>n.disposeIntermediateTensorInfo(E)),_}const iCe={kernelName:Ng,backendName:"webgl",kernelFunc:aCe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function oCe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,filter:i,bias:o,preluActivationWeights:s}=e,{strides:l,pad:u,dilations:c,dimRoundingMode:d,activation:p,leakyreluAlpha:f}=r,m=[];let y=c;y==null&&(y=[1,1]),j(Wr(l,y),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${l} and dilations '${y}'`);const x=fr(a.shape,i.shape,l,y,u,d,!0),b=ce().getBool("WEBGL_PACK_DEPTHWISECONV")&&x.strideWidth<=2&&x.outChannels/x.inChannels===1,v=p?um(p,b):null,w=[a,i],S=o!=null,C=s!=null,I=p==="leakyrelu";if(S&&w.push(o),C&&w.push(s),I){const A=n.makeTensorInfo([],"float32",Ss(f,"float32"));w.push(A),m.push(A)}let _;b?_=new R7(x,S,v,C,I):_=new $7(x,S,v,C,I);const E=[[x.padInfo.top,x.padInfo.left],[x.strideHeight,x.strideWidth],[x.dilationHeight,x.dilationWidth],[x.inHeight,x.inWidth]],P=n.runWebGLProgram(_,w,"float32",E);return m.forEach(A=>n.disposeIntermediateTensorInfo(A)),P}const sCe={kernelName:Tg,backendName:"webgl",kernelFunc:oCe};class lCe{constructor(e,n,r,a){this.sliceDim=e,this.strides=n,this.paramsShape=a,this.variableNames=["x","indices"],this.outputShape=r;const i=pn(r.length);let o=`
    int index;`;for(let s=0;s<this.sliceDim;s++)o+=`
          index = round(getIndices(coords[0], ${s}));
          out_of_bounds = out_of_bounds || index < 0;
          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[s]};
          flattenIndex += index * ${this.strides[s]};`;this.userCode=`
         void main() {
          ${i} coords = getOutputCoords();
          int flattenIndex = 0;
          bool out_of_bounds = false;

          ${o}

          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));
        }
      `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function uCe(t){const{inputs:e,backend:n}=t,{params:r,indices:a}=e,i=a.shape,o=i[i.length-1],s=me(r.shape),[l,u,c,d]=Tx(r,a),p=Re({inputs:{x:a},backend:n,attrs:{shape:[u,o]}}),f=Re({inputs:{x:r},backend:n,attrs:{shape:[me(r.shape)/c,c]}});if(n.shouldExecuteOnCPU([r,a])||r.dtype==="string"){const b=n.readSync(a.dataId),v=n.bufferSync(r),w=wxe(b,v,r.dtype,u,o,c,d,r.shape,s);return n.makeTensorInfo(l,r.dtype,w.values)}const m=new lCe(o,d,[u,c],r.shape),y=n.runWebGLProgram(m,[f,p],f.dtype),x=Re({inputs:{x:y},backend:n,attrs:{shape:l}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(y),x}const cCe={kernelName:hv,backendName:"webgl",kernelFunc:uCe};/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class dCe{constructor(e,n){this.variableNames=["A","indices"],this.outputShape=n,this.rank=n.length;const r=pn(this.rank),a=pCe(e);this.userCode=`
      void main() {
        ${r} resRC = getOutputCoords();
        int index = int(getIndices(resRC.x, resRC.z));
        float inBounds = (index >= 0) && (index < ${e[2]}) ? 1.0 : 0.0;
        setOutput(inBounds * getA(${a}));
      }
    `}}function pCe(t,e){const n=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[];for(let a=0;a<t.length;a++)a===2?r.push("index"):r.push(`${n[a]}`);return r.join()}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function F7(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,indices:i}=e,{axis:o,batchDims:s}=r,l=Pt(o,a.shape)[0];if(ce().get("DEBUG")){const v=n.readSync(i.dataId),w=a.shape[l];for(let S=0;S<v.length;++S){const C=v[S];j(C<=w-1&&C>=0,()=>`GatherV2: the index value ${C} is not in [0, ${w-1}]`)}}const u=s4(a,i,l,s),c=me(i.shape),d=[],p=Re({inputs:{x:a},backend:n,attrs:{shape:[u.batchSize,u.outerSize,u.dimSize,u.sliceSize]}}),f=Re({inputs:{x:i},backend:n,attrs:{shape:[u.batchSize,c/u.batchSize]}});d.push(p),d.push(f);const m=[u.batchSize,u.outerSize,c/u.batchSize,u.sliceSize];if(n.shouldExecuteOnCPU([a,i])||a.dtype==="string"){const v=n.bufferSync(f),w=n.bufferSync(p),S=kxe(w,v,m);return d.forEach(C=>n.disposeIntermediateTensorInfo(C)),n.makeTensorInfo(u.outputShape,S.dtype,S.values)}const y=new dCe(p.shape,m),x=n.runWebGLProgram(y,[p,f],p.dtype);d.push(x);const b=Re({inputs:{x},backend:n,attrs:{shape:u.outputShape}});return d.forEach(v=>n.disposeIntermediateTensorInfo(v)),b}const hCe={kernelName:pv,backendName:"webgl",kernelFunc:F7};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const fCe="return float(a > b);",gCe=`
  return vec4(greaterThan(a, b));
`,mCe=_r({opSnippet:fCe,packedOpSnippet:gCe,cpuKernelImpl:Sxe,dtype:"bool"}),yCe={kernelName:jf,backendName:"webgl",kernelFunc:mCe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const bCe="return float(a >= b);",vCe=`
  return vec4(greaterThanEqual(a, b));
`,xCe=_r({opSnippet:bCe,packedOpSnippet:vCe,dtype:"bool",cpuKernelImpl:Cxe}),wCe={kernelName:Vf,backendName:"webgl",kernelFunc:xCe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function kCe(t){const{inputs:e,backend:n}=t,{input:r}=e;return L7(r,!0,n)}const SCe={kernelName:fv,backendName:"webgl",kernelFunc:kCe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const CCe="return float(!isnan(x) && !isinf(x));",NCe=Rt({opSnippet:CCe,dtype:"bool"}),TCe={kernelName:Uf,backendName:"webgl",kernelFunc:NCe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const ICe="return float(isinf(x));",ECe=Rt({opSnippet:ICe,dtype:"bool"}),_Ce={kernelName:Gf,backendName:"webgl",kernelFunc:ECe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const OCe="return float(isnan(x));",$Ce=Rt({opSnippet:OCe,dtype:"bool"}),RCe={kernelName:Hf,backendName:"webgl",kernelFunc:$Ce};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const MCe="return float(a < b);",ACe=`
  return vec4(lessThan(a, b));
`,PCe=_r({opSnippet:MCe,packedOpSnippet:ACe,cpuKernelImpl:Nxe,dtype:"bool"}),LCe={kernelName:qf,backendName:"webgl",kernelFunc:PCe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const DCe="return float(a <= b);",FCe=`
  return vec4(lessThanEqual(a, b));
`,BCe=_r({opSnippet:DCe,packedOpSnippet:FCe,cpuKernelImpl:Txe,dtype:"bool"}),zCe={kernelName:Kf,backendName:"webgl",kernelFunc:BCe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function jCe(t){const{backend:e,attrs:n}=t,{start:r,stop:a,num:i}=n,o=Ixe(r,a,i);return e.makeTensorInfo([o.length],"float32",o)}const VCe={kernelName:yv,backendName:"webgl",kernelFunc:jCe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const WCe=Sp+`
  return x < 0.0 ? 0./0. : log(x);
`,UCe=`
  vec4 result = log(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);
  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);
  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);
  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);
  return result;
`,GCe=Rt({opSnippet:WCe,packedOpSnippet:UCe,cpuKernelImpl:Exe}),HCe={kernelName:Xf,backendName:"webgl",kernelFunc:GCe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const qCe=Sp+`
  return log(1.0 + x);
`,KCe=Rt({opSnippet:qCe}),XCe={kernelName:Yf,backendName:"webgl",kernelFunc:KCe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const YCe="return float(a >= 1.0 && b >= 1.0);",QCe=`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,ZCe=_r({opSnippet:YCe,packedOpSnippet:QCe,dtype:"bool"}),JCe={kernelName:Qf,backendName:"webgl",kernelFunc:ZCe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const eNe="return float(!(x >= 1.0));",tNe=Rt({opSnippet:eNe}),nNe={kernelName:Zf,backendName:"webgl",kernelFunc:tNe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const rNe="return float(a >= 1.0 || b >= 1.0);",aNe=`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,iNe=_r({opSnippet:rNe,packedOpSnippet:aNe,dtype:"bool"}),oNe={kernelName:Jf,backendName:"webgl",kernelFunc:iNe};/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class sNe{constructor(e,n,r,a,i){this.variableNames=["x"],this.outputShape=[];const o=n,s=e[3]-1;this.outputShape=e;let l;const u=`float(${r}) + float(${a}) * sum`;i===.5?l=`inversesqrt(${u})`:i===1?l=`1.0/(${u})`:l=`exp(log(${u}) * float(-${i}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${o}; j <= ${o}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${s}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${l};
        setOutput(val);
      }
    `}}/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class lNe{constructor(e,n,r,a,i){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const o=n,s=e[3]-1;this.outputShape=e;let l;const u=`float(${r}) + float(${a}) * sum`;i===.5?l=`inversesqrt(${u})`:i===1?l=`1.0/(${u})`:l=`exp(log(${u}) * float(-${i}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${o};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${o}; j <= ${o}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${s}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${l};
        setOutput(result);
      }
    `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const uNe=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{depthRadius:i,bias:o,alpha:s,beta:l}=r,u=ce().getBool("WEBGL_PACK_NORMALIZATION")?new lNe(a.shape,i,o,s,l):new sNe(a.shape,i,o,s,l);return n.runWebGLProgram(u,[a],a.dtype)},cNe={kernelName:bv,backendName:"webgl",kernelFunc:uNe};/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class dNe{constructor(e,n,r,a,i){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=n,this.bias=r,this.alpha=a,this.beta=i,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${n})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${n} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${a}) * norm + float(${r});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${a})
                * float(${i})
                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${i});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const pNe=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:a,y:i,dy:o}=e,{depthRadius:s,bias:l,alpha:u,beta:c}=r,d=new dNe(a.shape,s,l,u,c);return n.runWebGLProgram(d,[a,i,o],a.dtype)},hNe={kernelName:Z3,backendName:"webgl",kernelFunc:pNe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function fNe(t,e,n,r){const a=me(e),i=me(t.shape)/a,o=Re({inputs:{x:t},attrs:{shape:[i,a]},backend:r}),s=mc(o,t.dtype,"max",r),l=Re({inputs:{x:s},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(o),r.disposeIntermediateTensorInfo(s),l}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function B7(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{reductionIndices:i,keepDims:o}=r,s=a.shape.length,l=Pt(i,a.shape);let u=l;const c=Un(u,s),d=c!=null,p=n.shouldExecuteOnCPU([a]);let f=a;if(d){if(p){const v=n.texData.get(f.dataId).values,w=new Array(s);for(let I=0;I<w.length;I++)w[I]=a.shape[c[I]];const S=G4(v,a.shape,a.dtype,c,w);f=n.makeTensorInfo(w,a.dtype);const C=n.texData.get(f.dataId);C.values=S}else f=m2(a,c,n);u=Gn(u.length,s)}Ir("max",u,s);const[m,y]=Tr(f.shape,u);let x=m;o&&(x=ir(m,l));let b;if(p){const v=n.texData.get(f.dataId).values,w=_xe(v,me(y),x,a.dtype);b=n.makeTensorInfo(x,a.dtype);const S=n.texData.get(b.dataId);S.values=w}else b=fNe(f,y,x,n);return d&&n.disposeIntermediateTensorInfo(f),b}const gNe={kernelName:vv,backendName:"webgl",kernelFunc:B7};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const mNe=q4+`
  return max(a, b);
`,yNe=`
  vec4 result = vec4(max(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+sm+`
  return result;
`,bNe=_r({opSnippet:mNe,packedOpSnippet:yNe,cpuKernelImpl:Oxe}),vNe={kernelName:eg,backendName:"webgl",kernelFunc:bNe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function xNe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e;im(a,"maxPool");const{filterSize:i,strides:o,pad:s,dimRoundingMode:l}=r,u=1;j(Wr(o,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${u}'`);const c=Ei(a.shape,i,o,u,s,l);if(c.filterWidth===1&&c.filterHeight===1&&tn(c.inShape,c.outShape))return Ga({inputs:{x:a},backend:n});const d=new cm(c,"max",!1);return n.runWebGLProgram(d,[a],a.dtype)}const wNe={kernelName:xv,backendName:"webgl",kernelFunc:xNe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function kNe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{filterSize:i,strides:o,pad:s,dataFormat:l,dimRoundingMode:u}=r,c=[1,1,1],d=_s(a.shape,i,o,c,s,u,l),p=new X4(d,"max",!1);return n.runWebGLProgram(p,[a],a.dtype)}const SNe={kernelName:wv,backendName:"webgl",kernelFunc:kNe};/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class CNe{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const n=e.strideHeight,r=e.strideWidth,a=e.dilationHeight,i=e.effectiveFilterHeight,o=e.effectiveFilterWidth,s=i-1-e.padInfo.top,l=o-1-e.padInfo.left,u=i*o-1;this.userCode=`
      const ivec2 pads = ivec2(${s}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${i};
          wR += ${a}) {
          float dyR = float(dyRCorner + wR) / ${n}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${o}; wC++) {
            float dyC = float(dyCCorner + wC) / ${r}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${u} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${o} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}}class NNe{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const n=e.strideDepth,r=e.strideHeight,a=e.strideWidth,i=e.dilationDepth,o=e.dilationHeight,s=e.dilationWidth,l=e.effectiveFilterDepth,u=e.effectiveFilterHeight,c=e.effectiveFilterWidth,d=l-1-e.padInfo.front,p=u-1-e.padInfo.top,f=c-1-e.padInfo.left,m=l*u*c-1;this.userCode=`
      const ivec3 pads = ivec3(${d}, ${p}, ${f});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${l};
           wD += ${i}) {
          float dyD = float(dyDCorner + wD) / ${n}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${u};
              wR += ${o}) {
            float dyR = float(dyRCorner + wR) / ${r}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${c};
                wC += ${s}) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${m} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${u} * ${c} +
                  wR * ${c} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function TNe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:a,input:i}=e,o=i,{filterSize:s,strides:l,pad:u,dimRoundingMode:c}=r,d=[1,1,1],p=_s(o.shape,s,l,d,u,c),f=new X4(p,"max",!0),m=n.runWebGLProgram(f,[o],o.dtype),y=new NNe(p),x=n.runWebGLProgram(y,[a,m],o.dtype);return n.disposeIntermediateTensorInfo(m),x}const INe={kernelName:eT,backendName:"webgl",kernelFunc:TNe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function ENe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:a,input:i,output:o}=e,s=i;im([i,o],"maxPoolGrad");const{filterSize:l,strides:u,pad:c,dimRoundingMode:d}=r,p=Ei(s.shape,l,u,1,c,d),f=!0,m=new cm(p,"max",f),y=n.runWebGLProgram(m,[s],s.dtype),x=new CNe(p),b=n.runWebGLProgram(x,[a,y],s.dtype);return n.disposeIntermediateTensorInfo(y),b}const _Ne={kernelName:J3,backendName:"webgl",kernelFunc:ENe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function ONe(t,e,n,r){let a=new cm(n,"max",!1);const i=r.runWebGLProgram(a,[t],"float32");a=new cm(n,"max",!0,!0,e);const o=r.runWebGLProgram(a,[t],"float32");return[i,o]}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const $Ne={kernelName:kv,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:r}=t,{filterSize:a,strides:i,pad:o,includeBatchInIndex:s}=e,l=n;j(r.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${r.shape.length}.`);const u=[1,1];j(Wr(i,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${u}'`);const c=Ei(r.shape,a,i,u,o),[d,p]=ONe(r,s,c,l);return[d,p]}};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function RNe(t,e,n,r){const a=me(e),i=me(t.shape)/a,o=Re({inputs:{x:t},attrs:{shape:[i,a]},backend:r}),s=mc(o,"float32","mean",r),l=Re({inputs:{x:s},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(o),r.disposeIntermediateTensorInfo(s),l}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const MNe={kernelName:Sv,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:r}=t,{keepDims:a,axis:i}=e,o=n,s=r.shape.length,l=Pt(i,r.shape);let u=l;const c=Un(u,s),d=c!=null,p=o.shouldExecuteOnCPU([r]),f=[];let m=r;if(d){if(p){const w=o.texData.get(m.dataId).values,S=new Array(s);for(let _=0;_<S.length;_++)S[_]=r.shape[c[_]];const C=G4(w,r.shape,r.dtype,c,S);m=o.makeTensorInfo(S,r.dtype);const I=o.texData.get(m.dataId);I.values=C}else m=m2(r,c,o);f.push(m),u=Gn(u.length,s)}Ir("sum",u,s);const[y,x]=Tr(m.shape,u);let b=y;a&&(b=ir(y,l));const v=RNe(m,x,b,o);for(const w of f)o.disposeIntermediateTensorInfo(w);return v}};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function ANe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:i,keepDims:o}=r,s=a.shape.length,l=Pt(i,a.shape);let u=l;const c=Un(u,s);let d=a;c!=null&&(d=pa({inputs:{x:a},backend:n,attrs:{perm:c}}),u=Gn(u.length,a.shape.length)),Ir("min",u,s);const[p,f]=Tr(d.shape,u),m=me(f),y=Re({inputs:{x:d},backend:n,attrs:{shape:[-1,m]}}),x=mc(y,y.dtype,"min",n);let b;if(o){const v=ir(p,l);b=Re({inputs:{x},backend:n,attrs:{shape:v}})}else b=Re({inputs:{x},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(x),c!=null&&n.disposeIntermediateTensorInfo(d),b}const PNe={kernelName:Cv,backendName:"webgl",kernelFunc:ANe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const LNe=q4+`
  return min(a, b);
`,DNe=`
  vec4 result = vec4(min(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+sm+`
  return result;
`,FNe=_r({opSnippet:LNe,packedOpSnippet:DNe,cpuKernelImpl:$xe}),BNe={kernelName:tg,backendName:"webgl",kernelFunc:FNe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class zNe{constructor(e,n,r){this.variableNames=["x"],this.outputShape=n.map((c,d)=>c[0]+e[d]+c[1]);const a=e.length,i=pn(a),o=n.map(c=>c[0]).join(","),s=n.map((c,d)=>c[0]+e[d]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,a),u=r==="reflect"?0:1;if(a===1){this.userCode=`
        int start = ${o};
        int end = ${s};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${u};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${u};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${i} start = ${i}(${o});
      ${i} end = ${i}(${s});

      void main() {
        ${i} outC = getOutputCoords();
        for (int i = 0; i < ${a}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${u};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${u};
          }
        }
        ${i} coords = outC - start;
        setOutput(getX(${l}));
      }
    `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class jNe{constructor(e,n,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.map((m,y)=>m[0]+e[y]+m[1]);const a=e.length,i=pn(a),o=n.map(m=>m[0]).join(","),s=n.map((m,y)=>m[0]+e[y]).join(","),l=da("rc",a),u=da("source",a),c=`${l[a-1]} < ${this.outputShape[a-1]}`,d=a===1?"source":`vec2(${u.slice(-2).join()})`,p=r==="reflect"?0:1;let f="";if(a===1){const m=`
        ${i} source = rc;
        if (source < start) {
          source = start * 2 - source - ${p};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${p};
        }
        source -= start;
      `;f=`
        ${i} rc = outputLoc;
        ${m}
        result[0] = getChannel(getX(${u.join()}), ${d});
        ${l[a-1]} += 1;
        if(${c}) {
          ${m}
          result[1] = getChannel(getX(${u.join()}), ${d});
        }
      `}else{const m=`
        ${i} source = rc;
        ${i} lt = ${i}(lessThan(source, start));
        ${i} gte = ${i}(greaterThanEqual(source, end));
        ${i} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${p}) +
                gte * ((end - 1) * 2 - source + ${p});
        source -= start;
      `;f=`
        ${i} rc = outputLoc;
        ${m}
        result[0] = getChannel(getX(${u.join()}), ${d});
        ${l[a-1]} += 1;
        if(${c}) {
          ${m}
          result[1] = getChannel(getX(${u.join()}), ${d});
        }
        rc = outputLoc;
        ${l[a-2]} += 1;
        if(${l[a-2]} < ${this.outputShape[a-2]}) {
          ${m}
          result[2] = getChannel(getX(${u.join()}), ${d});
          ${l[a-1]} += 1;
          if(${c}) {
            ${m}
            result[3] = getChannel(getX(${u.join()}), ${d});
          }
        }
      `}this.userCode=`
      const ${i} start = ${i}(${o});
      const ${i} end = ${i}(${s});

      void main() {
        ${i} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${f}
        setOutput(result);
      }
    `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const VNe=({inputs:t,backend:e,attrs:n})=>{const{x:r}=t,{paddings:a,mode:i}=n,o=ce().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new jNe(r.shape,a,i):new zNe(r.shape,a,i);return e.runWebGLProgram(o,[r],r.dtype)},WNe={kernelName:Nv,backendName:"webgl",kernelFunc:VNe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const UNe=`if (b == 0.0) return NAN;
  return mod(a, b);`,GNe=`
  vec4 result = mod(a, b);
  bvec4 isNaN = equal(b, vec4(0.0));
  `+sm+`
  return result;
`,HNe=_r({opSnippet:UNe,packedOpSnippet:GNe}),qNe={kernelName:ng,backendName:"webgl",kernelFunc:HNe};/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class KNe{constructor(e,n,r){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[e,r],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${n-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${n-1}));
      }
    `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const XNe=`
if (a == b) {
  return 1.0;
};
return a / b;`,YNe=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,z7=_r({opSnippet:XNe,packedOpSnippet:YNe,checkOutOfBounds:!0}),QNe={kernelName:Mf,backendName:"webgl",kernelFunc:z7};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const j7="return a - b;",V7=_r({opSnippet:j7,packedOpSnippet:j7,supportsComplex:!0,cpuKernelImpl:Yxe}),ZNe={kernelName:vg,backendName:"webgl",kernelFunc:V7};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function W7(t){const{inputs:e,backend:n,attrs:r}=t,{logits:a}=e,{dim:i}=r,o=Pt([i],a.shape),s=B7({inputs:{x:a},backend:n,attrs:{reductionIndices:o,keepDims:!1}}),l=ir(s.shape,o),u=Re({inputs:{x:s},backend:n,attrs:{shape:l}}),c=V7({inputs:{a,b:u},backend:n}),d=M7({inputs:{x:c},backend:n}),p=y2({inputs:{x:d},backend:n,attrs:{axis:o,keepDims:!1}}),f=Re({inputs:{x:p},backend:n,attrs:{shape:l}}),m=z7({inputs:{a:d,b:f},backend:n});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),m}const JNe={kernelName:Zv,backendName:"webgl",kernelFunc:W7};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function e3e(t){const{inputs:e,backend:n,attrs:r}=t,{logits:a}=e,{numSamples:i,seed:o,normalized:s}=r,l=s?a:W7({inputs:{logits:a},backend:n,attrs:{dim:a.shape.length-1}}),u=l.shape[0],c=l.shape[1],d=new KNe(u,c,i),p=[[o]],f=n.runWebGLProgram(d,[l],"int32",p);return s||n.disposeIntermediateTensorInfo(l),f}const t3e={kernelName:Tv,backendName:"webgl",kernelFunc:e3e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const n3e=Li+`
  return -x;
`,r3e=`
  vec4 result = -x;
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`;function a3e(t){const{inputs:e,backend:n}=t,{x:r}=e;if(n.shouldExecuteOnCPU([r])){const i=n.texData.get(r.dataId),[o,s]=Mxe(i.values,r.shape,r.dtype);return n.makeTensorInfo(s,r.dtype,o)}let a;return ce().getBool("WEBGL_PACK_UNARY_OPERATIONS")?a=new gc(r.shape,r3e):a=new Ls(r.shape,n3e),n.runWebGLProgram(a,[r],r.dtype)}const i3e={kernelName:Iv,backendName:"webgl",kernelFunc:a3e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const o3e=Ux;function s3e(t){ai("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:a,scores:i}=e,{maxOutputSize:o,iouThreshold:s,scoreThreshold:l}=r,u=n.readSync(a.dataId),c=n.readSync(i.dataId),{selectedIndices:d}=o3e(u,c,o,s,l);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}const l3e={kernelName:Ev,backendName:"webgl",kernelFunc:s3e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const u3e=Gx;function c3e(t){ai("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:a,scores:i}=e,{maxOutputSize:o,iouThreshold:s,scoreThreshold:l,padToMaxOutputSize:u}=r,c=n.readSync(a.dataId),d=n.readSync(i.dataId),{selectedIndices:p,validOutputs:f}=u3e(c,d,o,s,l,u);return[n.makeTensorInfo([p.length],"int32",new Int32Array(p)),n.makeTensorInfo([],"int32",new Int32Array([f]))]}const d3e={kernelName:_v,backendName:"webgl",kernelFunc:c3e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const p3e=Hx;function h3e(t){ai("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:a,scores:i}=e,{maxOutputSize:o,iouThreshold:s,scoreThreshold:l,softNmsSigma:u}=r,c=n.readSync(a.dataId),d=n.readSync(i.dataId),p=o,f=s,m=l,y=u,{selectedIndices:x,selectedScores:b}=p3e(c,d,p,f,m,y);return[n.makeTensorInfo([x.length],"int32",new Int32Array(x)),n.makeTensorInfo([b.length],"float32",new Float32Array(b))]}const f3e={kernelName:Ov,backendName:"webgl",kernelFunc:h3e};/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class g3e{constructor(e,n,r,a){this.variableNames=["indices"],this.outputShape=[e,n],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${a}), float(${r}),
                      float(index == coords.y)));
      }
    `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const m3e=t=>{const{inputs:e,backend:n,attrs:r}=t,{indices:a}=e,{dtype:i,depth:o,onValue:s,offValue:l}=r,u=me(a.shape),c=new g3e(u,o,s,l),d=Re({inputs:{x:a},backend:n,attrs:{shape:[u]}}),p=n.runWebGLProgram(c,[d],i);n.disposeIntermediateTensorInfo(d);const f=[...a.shape,o],m=Re({inputs:{x:p},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(p),m},y3e={kernelName:Rv,backendName:"webgl",kernelFunc:m3e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function S2(t){const{inputs:e,backend:n}=t,{x:r}=e;if(r.dtype==="complex64"){const a=dm({inputs:{input:r},backend:n}),i=S2({inputs:{x:a},backend:n}),o=w2({inputs:{input:r},backend:n}),s=S2({inputs:{x:o},backend:n}),l=Hl({inputs:{real:i,imag:s},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(s),l}else return fm({attrs:{shape:r.shape,dtype:r.dtype,value:r.dtype==="string"?"":0},backend:n})}const b3e={kernelName:hx,backendName:"webgl",kernelFunc:S2};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function U7(t){const{inputs:e,backend:n}=t,{x:r}=e;if(r.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(r.dtype==="complex64"){const a=dm({inputs:{input:r},backend:n}),i=U7({inputs:{x:a},backend:n}),o=w2({inputs:{input:r},backend:n}),s=S2({inputs:{x:o},backend:n}),l=Hl({inputs:{real:i,imag:s},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(s),l}else return fm({attrs:{shape:r.shape,dtype:r.dtype,value:1},backend:n})}const v3e={kernelName:$v,backendName:"webgl",kernelFunc:U7};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function x3e(t){const{inputs:e,backend:n,attrs:r}=t,{axis:a}=r;if(e.length===1)return Z4({inputs:{input:e[0]},backend:n,attrs:{dim:a}});const i=e[0].shape,o=e[0].dtype;e.forEach(c=>{Cr(i,c.shape,"All tensors passed to stack must have matching shapes"),j(o===c.dtype,()=>"All tensors passed to stack must have matching dtypes")});const s=[],l=e.map(c=>{const d=Z4({inputs:{input:c},backend:n,attrs:{dim:a}});return s.push(d),d}),u=k7({inputs:l,backend:n,attrs:{axis:a}});return s.forEach(c=>n.disposeIntermediateTensorInfo(c)),u}const w3e={kernelName:Mv,backendName:"webgl",kernelFunc:x3e};/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class k3e{constructor(e,n,r){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((u,c)=>u[0]+e[c]+u[1]);const a=e.length,i=pn(a),o=n.map(u=>u[0]).join(","),s=n.map((u,c)=>u[0]+e[c]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,a);if(a===1){this.userCode=`
        int start = ${o};
        int end = ${s};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(value);
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${i} start = ${i}(${o});
      ${i} end = ${i}(${s});

      void main() {
        ${i} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(value);
        } else {
          ${i} coords = outC - start;
          setOutput(getX(${l}));
        }
      }
    `}}/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class S3e{constructor(e,n,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((y,x)=>y[0]+e[x]+y[1]);const a=e.length,i=pn(a),o=n.map(y=>y[0]).join(","),s=n.map((y,x)=>y[0]+e[x]).join(","),l=da("rc",a),u=da("source",a),c=`${l[a-1]} < ${this.outputShape[a-1]}`,d=a===1?"source":`vec2(${u.slice(-2).join()})`,p=[`${i} rc = outputLoc;`,`${l[a-1]} += 1;
       if(${c}) {
      `,a===1?"":`}
       rc = outputLoc;
       ${l[a-2]} += 1;
       if(${l[a-2]} < ${this.outputShape[a-2]}) {`,a===1?"":`  ${l[a-1]} += 1;
         if(${c}) {`],f=a===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let m="";for(let y=0,x=a===1?2:4;y<x;y++)m+=`
        ${p[y]}
        if (${f}) {
          result[${y}] = float(value);
        } else {
          ${i} source = rc - start;
          result[${y}] = getChannel(getX(${u.join()}), ${d});
        }
      `;m+=a===1?"} ":"}}",this.userCode=`
      const ${i} start = ${i}(${o});
      const ${i} end = ${i}(${s});

      void main() {
        ${i} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${m}
        setOutput(result);
      }
    `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const G7=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{paddings:i,constantValue:o}=r;if(me(a.shape)===0){const u=i.map((c,d)=>c[0]+a.shape[d]+c[1]);return fm({backend:n,attrs:{shape:u,value:o,dtype:a.dtype}})}const s=ce().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new S3e(a.shape,i,o):new k3e(a.shape,i,o),l=[[o]];return n.runWebGLProgram(s,[a],a.dtype,l)},C3e={kernelName:Av,backendName:"webgl",kernelFunc:G7};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const N3e=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,T3e=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  bvec4 isNaN1 = lessThan(a, vec4(0.0));
  bvec4 isNaN2 = lessThan(floor(b), b);
  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);
  `+sm+`
  return result;
`,I3e=_r({opSnippet:N3e,packedOpSnippet:T3e}),E3e={kernelName:ig,backendName:"webgl",kernelFunc:I3e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function _3e(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{axis:i,keepDims:o}=r,s=a.shape.length,l=[],u=Pt(i,a.shape);let c=u;const d=Un(c,s);let p=a;d!=null&&(p=pa({inputs:{x:a},backend:n,attrs:{perm:d}}),c=Gn(c.length,s),l.push(p)),Ir("prod",c,s);let f;if(n.shouldExecuteOnCPU([p])){const m=n.texData.get(p.dataId).values,{outVals:y,outShape:x,outDtype:b}=Pxe(p.shape,p.dtype,m,c);f=n.makeTensorInfo(x,b,y)}else{const[m,y]=Tr(p.shape,c),x=me(y),b=Re({inputs:{x:p},backend:n,attrs:{shape:[-1,x]}}),v=kx(a.dtype),w=mc(b,v,"prod",n);f=Re({inputs:{x:w},backend:n,attrs:{shape:m}}),l.push(b),l.push(w)}if(o){l.push(f);const m=ir(f.shape,u);f=Re({inputs:{x:f},backend:n,attrs:{shape:m}})}return l.forEach(m=>n.disposeIntermediateTensorInfo(m)),f}const O3e={kernelName:Lv,backendName:"webgl",kernelFunc:_3e};/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function $3e(t){const{inputs:e,backend:n,attrs:r}=t,{paramsNestedSplits:a,paramsDenseValues:i,indices:o}=e,{outputRaggedRank:s}=r,l=a.map(b=>n.readSync(b.dataId)),u=a.map(b=>b.shape),c=n.readSync(i.dataId),d=n.readSync(o.dataId),[p,f,m]=Lxe(l,u,c,i.shape,i.dtype,d,o.shape,s),y=p.map(b=>n.makeTensorInfo([b.length],"int32",b)),x=n.makeTensorInfo(m,i.dtype,f);return y.concat([x])}const R3e={kernelName:Dv,backendName:"webgl",kernelFunc:$3e};/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function M3e(t){const{inputs:e,backend:n,attrs:r}=t,{shape:a,values:i,defaultValue:o,rowPartitionTensors:s}=e,{rowPartitionTypes:l}=r,u=n.readSync(a.dataId),c=n.readSync(i.dataId),d=n.readSync(o.dataId),p=s.map(x=>n.readSync(x.dataId)),f=s.map(x=>x.shape),[m,y]=Dxe(u,a.shape,c,i.shape,i.dtype,d,o.shape,p,f,l);return n.makeTensorInfo(m,i.dtype,y)}const A3e={kernelName:Fv,backendName:"webgl",kernelFunc:M3e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const H7=t=>{const{backend:e,attrs:n}=t,{start:r,stop:a,step:i,dtype:o}=n,s=Fxe(r,a,i,o);return e.makeTensorInfo([s.length],o,s)},P3e={kernelName:Bv,backendName:"webgl",kernelFunc:H7};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const L3e="return 1.0 / x;",D3e=Rt({opSnippet:L3e}),F3e={kernelName:og,backendName:"webgl",kernelFunc:D3e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const B3e=Li+`
  return (x < 0.0) ? 0.0 : x;
`,z3e=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,j3e=Rt({opSnippet:B3e,packedOpSnippet:z3e}),V3e={kernelName:sg,backendName:"webgl",kernelFunc:j3e};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const W3e=Li+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,U3e=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,G3e=Rt({opSnippet:W3e,packedOpSnippet:U3e}),H3e={kernelName:lg,backendName:"webgl",kernelFunc:G3e};/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class q3e{constructor(e,n,r,a,i){this.variableNames=["A"],this.outputShape=[];const[o,s,l,u]=e;this.outputShape=[o,n,r,u];const c=[a&&n>1?s-1:s,a&&r>1?l-1:l],d=[a&&n>1?n-1:n,a&&r>1?r-1:r];let p;i?p="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":p="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${c[0]/d[0]},
          ${c[1]/d[1]});
      const vec2 inputShapeRC = vec2(${s}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${p};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}}/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class K3e{constructor(e,n,r,a,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[o,s,l,u]=e;this.outputShape=[o,n,r,u];const c=[a&&n>1?s-1:s,a&&r>1?l-1:l],d=[a&&n>1?n-1:n,a&&r>1?r-1:r];let p;i?p="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":p="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${c[0]/d[0]},
          ${c[1]/d[1]},
          ${c[1]/d[1]});
      const vec3 inputShapeRC = vec3(${s}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${p};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${u-1};
        bool hasNextRow = coords.z < ${r-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function X3e(t){const{inputs:e,backend:n,attrs:r}=t,{images:a}=e,{alignCorners:i,halfPixelCenters:o,size:s}=r,[l,u]=s,c=ce().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new K3e(a.shape,l,u,i,o):new q3e(a.shape,l,u,i,o);return n.runWebGLProgram(c,[a],"float32")}const Y3e={kernelName:Wv,backendName:"webgl",kernelFunc:X3e};/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class Q3e{constructor(e,n,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,a,i]=n,[,o,s]=e,l=[r&&o>1?a-1:a,r&&s>1?i-1:i],u=[r&&o>1?o-1:o,r&&s>1?s-1:s],c=l[0]/u[0],d=l[1]/u[1],p=1/c,f=1/d,m=Math.ceil(p)*2+2,y=Math.ceil(f)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${c});
        const float widthScale = float(${d});

        const float invHeightScale = float(${p});
        const float invWidthScale = float(${f});

        const int winHeight = int(${m});
        const int winWidth = int(${y});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${o}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${s}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${a-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${i-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Z3e(t){const{inputs:e,backend:n,attrs:r}=t,{images:a,dy:i}=e,{alignCorners:o}=r,s=new Q3e(i.shape,a.shape,o);return n.runWebGLProgram(s,[i],i.dtype)}const J3e={kernelName:nT,backendName:"webgl",kernelFunc:Z3e};/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class eTe{constructor(e,n,r,a,i){this.variableNames=["A"],this.outputShape=[];const[o,s,l,u]=e;this.outputShape=[o,n,r,u];const c=[a&&n>1?s-1:s,a&&r>1?l-1:l],d=[a&&n>1?n-1:n,a&&r>1?r-1:r],p=a?"0.5":"0.0";let f;i?f="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":f="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${c[0]/d[0]},
          ${c[1]/d[1]});
      const vec2 inputShapeRC = vec2(${s}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${f};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${p})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}}/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class tTe{constructor(e,n,r,a,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[o,s,l,u]=e;this.outputShape=[o,n,r,u];const c=[a&&n>1?s-1:s,a&&r>1?l-1:l],d=[a&&n>1?n-1:n,a&&r>1?r-1:r],p=a?"0.5":"0.0";let f;i?f="max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":f="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${c[0]/d[0]},
          ${c[1]/d[1]},
          ${c[1]/d[1]});
      const vec3 inputShapeRC = vec3(${s}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${f};

        // Compute the coordinators of nearest neighbor point.
        ivec3 sourceNearestRC = ivec3(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${p})));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${u-1};
        bool hasNextRow = coords.z < ${r-1};

        vec4 newValue = vec4(
          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),
          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);

        setOutput(newValue);
      }
    `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function nTe(t){const{inputs:e,backend:n,attrs:r}=t,{images:a}=e,{alignCorners:i,halfPixelCenters:o,size:s}=r,[l,u]=s,c=ce().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new tTe(a.shape,l,u,i,o):new eTe(a.shape,l,u,i,o);return n.runWebGLProgram(c,[a],a.dtype)}const rTe={kernelName:Vv,backendName:"webgl",kernelFunc:nTe};/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class aTe{constructor(e,n,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,a,i]=n,[,o,s]=e,l=[r&&o>1?a-1:a,r&&s>1?i-1:i],u=[r&&o>1?o-1:o,r&&s>1?s-1:s],c=l[0]/u[0],d=l[1]/u[1],p=1/c,f=1/d,m=Math.ceil(p)*2+2,y=Math.ceil(f)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${c});
        const float widthScale = float(${d});

        const float invHeightScale = float(${p});
        const float invWidthScale = float(${f});

        const int winHeight = int(${m});
        const int winWidth = int(${y});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${o}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${s}) {
              continue;
            }

            float sourceFracRow =
              float(${l[0]}) *
                (float(dyR) / float(${u[0]}));

            float sourceFracCol =
                float(${l[1]}) *
                  (float(dyC) / float(${u[1]}));

            int sourceNearestRow = int(min(
                float(int(${a}) - 1),
                ${r} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${i}) - 1),
                ${r} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function iTe(t){const{inputs:e,backend:n,attrs:r}=t,{images:a,dy:i}=e,{alignCorners:o}=r,s=new aTe(i.shape,a.shape,o);return n.runWebGLProgram(s,[i],i.dtype)}const oTe={kernelName:tT,backendName:"webgl",kernelFunc:iTe};/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class sTe{constructor(e,n){this.variableNames=["x"];const r=e.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);if(this.outputShape=e,r===1){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${e[0]} - coord - 1));
        }
      `;return}const a=s=>n.indexOf(s)!==-1&&e[s]!==1?`${e[s]} - coords[${s}] - 1`:`coords[${s}]`,i=e.map((s,l)=>a(l)).join(","),o=pn(r);this.userCode=`
      void main() {
        ${o} coords = getOutputCoords();
        setOutput(getX(${i}));
      }
    `}}/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class lTe{constructor(e,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const r=e.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);this.outputShape=e;const a=da("rc",r),i=`${a[r-1]} + 1 < ${this.outputShape[r-1]}`,o=`${a[r-2]} + 1 < ${this.outputShape[r-2]}`,s=pn(r);r===1?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${e[0]} - rc - 1),
            ${e[0]} - rc - 1);
          if(${i}){
              result.g = getChannel(getX(${e[0]} - (rc  + 1) - 1),
                ${e[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${s} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${l(a.slice())};
          if(${i}){
            result.g = ${u(a.slice())};
          }
          if(${o}) {
            result.b = ${c(a.slice())};
            if(${i}) {
              result.a = ${d(a.slice())};
            }
          }
          setOutput(result);
        }
    `;function l(m){return p(m)}function u(m){return m[r-1]="("+m[r-1]+" + 1)",p(m)}function c(m){return m[r-2]="("+m[r-2]+" + 1)",p(m)}function d(m){return m[r-1]="("+m[r-1]+" + 1)",m[r-2]="("+m[r-2]+" + 1)",p(m)}function p(m){const y=e.map((v,w)=>f(w,m)),x=y.join(","),b=y.slice(-2).join(",");return`getChannel(getX(${x}), vec2(${b}))`}function f(m,y){return n.indexOf(m)!==-1&&e[m]!==1?`${e[m]} - ${y[m]} - 1`:`${y[m]}`}}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function uTe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{dims:i}=r,o=a.shape.length,s=Pt(i,a.shape);if(o===0)return Ga({inputs:{x:a},backend:n});const l=ce().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new lTe(a.shape,s):new sTe(a.shape,s);return n.runWebGLProgram(l,[a],a.dtype)}const cTe={kernelName:Uv,backendName:"webgl",kernelFunc:uTe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class dTe{constructor(e,n){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const r=e[1],a=e[2];this.outputShape=e;let i="";typeof n=="number"?i=`float outputValue = ${n.toFixed(2)};`:i=`
        vec3 fill = vec3(${n.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - params[0]) * params[3] -
            (float(y) - params[1]) * params[2];
          float coordYFloat = (float(x) - params[0]) * params[2] +
            (float(y) - params[1]) * params[3];
          int coordX = int(round(coordXFloat + params[0]));
          int coordY = int(round(coordYFloat + params[1]));
          ${i}
          if(coordX >= 0 && coordX < ${a} && coordY >= 0 && coordY < ${r}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const pTe={kernelName:gx,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:r}=t,{radians:a,fillValue:i,center:o}=e,s=n,l=new dTe(r.shape,i),[u,c]=jI(o,r.shape[1],r.shape[2]),d=[[u,c,Math.sin(a),Math.cos(a)]];return s.runWebGLProgram(l,[r],r.dtype,d)}};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const hTe=`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`,fTe=Rt({opSnippet:hTe}),gTe={kernelName:ug,backendName:"webgl",kernelFunc:fTe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const mTe="return inversesqrt(x);",yTe=Rt({opSnippet:mTe,cpuKernelImpl:Bxe}),bTe={kernelName:cg,backendName:"webgl",kernelFunc:yTe};/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class q7{constructor(e,n,r,a,i,o,s=!0){this.variableNames=["updates","indices","defaultValue"],this.outputShape=o;const l=pn(i.length),u=pn(o.length);let c="";r===1?c="i":r===2&&(c="i, j");const d=`getIndices(${c})`;let p="";a===1?p="i":a===2&&(p="i, coords[1]");const f=`getUpdates(${p})`,m=n>1?"strides[j]":"strides";this.userCode=`
        ${l} strides = ${l}(${i});

        void main() {
          ${u} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${e}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${n}; j++) {
              int index = round(${d});
              flattenedIndex += index * ${m};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${f};
              found = true;
            }
          }
          setOutput(mix(getDefaultValue(), sum, float(found)));
        }
      `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function vTe(t){const{inputs:e,backend:n,attrs:r}=t,{indices:a,updates:i}=e,{shape:o}=r,{sliceRank:s,numUpdates:l,sliceSize:u,strides:c,outputSize:d}=Qd(i,a,o),p=[d/u,u];if(d===0)return n.makeTensorInfo(o,a.dtype);const f=Re({inputs:{x:a},backend:n,attrs:{shape:[l,s]}}),m=Re({inputs:{x:i},backend:n,attrs:{shape:[l,u]}}),y=n.makeTensorInfo([],"float32",new Float32Array([0])),x=new q7(l,s,f.shape.length,m.shape.length,c,p),b=n.runWebGLProgram(x,[m,f,y],m.dtype),v=Re({inputs:{x:b},backend:n,attrs:{shape:o}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(b),n.disposeIntermediateTensorInfo(y),v}const xTe={kernelName:Gv,backendName:"webgl",kernelFunc:vTe};/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class wTe{constructor(e,n,r,a){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[e,r];const i="while (left < right) {",o=`for (int i = 0; i < ${Math.ceil(Math.log2(n+1))}; ++i) { if (left >= right) break;`,s=ce().getNumber("WEBGL_VERSION")===2?i:o,l=a==="left"?"<":"<=";this.userCode=`
       int findBound(int batch, float value) {
         int left = 0;
         int right = numInputs;
         int mid;
         ${s}
           mid = (left + right) / 2;
           if (getSortedSequence(batch, mid) ${l} value) {
             left = mid + 1;
           } else {
             right = mid;
           }
         }
         return right;
       }

       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int valueIndex = coords[1];

         float value = getValues(batch, valueIndex);

         setOutput(float(findBound(batch, value)));
       }
     `}}/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function kTe(t){const{inputs:e,backend:n,attrs:r}=t,{sortedSequence:a,values:i}=e,{side:o}=r,s=new wTe(a.shape[0],a.shape[1],i.shape[1],o),l=[[a.shape[1]]];return n.runWebGLProgram(s,[a,i],"int32",l)}const STe={kernelName:Hv,backendName:"webgl",kernelFunc:kTe};/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class CTe{constructor(e,n,r){this.variableNames=["c","a","b"],this.outputShape=n;let a,i;if(r>4)throw Error(`Where for rank ${r} is not yet supported`);if(r===1)i="resRC",a="resRC";else{const s=["resRC.x","resRC.y","resRC.z","resRC.w"],l=[],u=[];for(let c=0;c<n.length;c++)u.push(`${s[c]}`),c<e&&l.push(`${s[c]}`);a=l.join(),i=u.join()}const o=pn(r);this.userCode=`
      void main() {
        ${o} resRC = getOutputCoords();
        float cVal = getC(${a});
        if (cVal >= 1.0) {
          setOutput(getA(${i}));
        } else {
          setOutput(getB(${i}));
        }
      }
    `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function NTe(t){const{inputs:e,backend:n}=t,{condition:r,t:a,e:i}=e,o=new CTe(r.shape.length,a.shape,a.shape.length);return n.runWebGLProgram(o,[r,a,i],Sa(a.dtype,i.dtype))}const TTe={kernelName:qv,backendName:"webgl",kernelFunc:NTe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const ITe=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${UI};
  float scale = ${GI};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,ETe=Rt({opSnippet:ITe}),_Te={kernelName:dg,backendName:"webgl",kernelFunc:ETe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const OTe=Sp+`
  return 1.0 / (1.0 + exp(-1.0 * x));
`,$Te=`
  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,RTe=Rt({opSnippet:OTe,packedOpSnippet:$Te,cpuKernelImpl:jxe}),MTe={kernelName:gg,backendName:"webgl",kernelFunc:RTe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const ATe=`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`,PTe=Rt({opSnippet:ATe}),LTe={kernelName:fg,backendName:"webgl",kernelFunc:PTe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const DTe=Sp+`
  return sin(x);
`,FTe=Rt({opSnippet:DTe}),BTe={kernelName:pg,backendName:"webgl",kernelFunc:FTe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const zTe=`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`,jTe=Rt({opSnippet:zTe}),VTe={kernelName:hg,backendName:"webgl",kernelFunc:jTe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const WTe=`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`,UTe=Rt({opSnippet:WTe}),GTe={kernelName:mg,backendName:"webgl",kernelFunc:UTe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const HTe=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{blockShape:i,paddings:o}=r;j(a.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const s=i.reduce((b,v)=>b*v),l=[[0,0]];l.push(...o);for(let b=1+i.length;b<a.shape.length;++b)l.push([0,0]);const u=[],c=G7({inputs:{x:a},backend:n,attrs:{paddings:l,constantValue:0}}),d=Yg(c.shape,i,s,!1),p=Qg(d.length,i.length,!1),f=Zg(c.shape,i,s,!1),m=Re({inputs:{x:c},backend:n,attrs:{shape:d}}),y=pa({inputs:{x:m},backend:n,attrs:{perm:p}}),x=Re({inputs:{x:y},backend:n,attrs:{shape:f}});return u.push(c),u.push(m),u.push(y),u.forEach(b=>n.disposeIntermediateTensorInfo(b)),x},qTe={kernelName:Yv,backendName:"webgl",kernelFunc:HTe};/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function KTe(t){const{inputs:e,backend:n}=t,{indices:r,values:a,denseShape:i,defaultValue:o}=e;if(i.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
         ${i.shape}`);if(r.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
         ${r.shape}`);if(a.shape.length!==1)throw new Error(`Values must be a vector, saw:
         ${a.shape}`);if(o.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${o.shape}`);const s=n.readSync(r.dataId),l=n.readSync(a.dataId),u=n.readSync(i.dataId),c=n.readSync(o.dataId)[0],[d,p,f,m,y]=Wxe(s,r.shape,r.dtype,l,a.dtype,u,c);return[n.makeTensorInfo(p,r.dtype,d),n.makeTensorInfo([p[0]],a.dtype,f),n.makeTensorInfo([m.length],"bool",new Uint8Array(m.map(x=>Number(x)))),n.makeTensorInfo([y.length],r.dtype,new Int32Array(y))]}const XTe={kernelName:Jv,backendName:"webgl",kernelFunc:KTe};/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function YTe(t){const{inputs:e,backend:n}=t,{inputIndices:r,inputShape:a,newShape:i}=e;if(r.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape ${r.shape}`);if(a.shape.length!==1)throw new Error(`Input shape should be a vector but received shape ${a.shape}`);if(i.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${i.shape}`);const o=Array.from(n.readSync(a.dataId)),s=n.readSync(r.dataId),l=Array.from(n.readSync(i.dataId)),[u,c,d]=Uxe(s,r.shape,r.dtype,o,l);return[n.makeTensorInfo(c,r.dtype,u),n.makeTensorInfo([d.length],i.dtype,new Int32Array(d))]}const QTe={kernelName:ex,backendName:"webgl",kernelFunc:YTe};/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function ZTe(t){const{inputs:e,backend:n}=t,{data:r,indices:a,segmentIds:i}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(a.shape.length!==1)throw new Error(`Indices should be a vector but received shape
              ${a.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
              ${i.shape}`);const o=n.readSync(r.dataId),s=n.readSync(a.dataId),l=n.readSync(i.dataId),[u,c]=Q9(o,r.shape,r.dtype,s,l,!0);return n.makeTensorInfo(c,r.dtype,u)}const JTe={kernelName:tx,backendName:"webgl",kernelFunc:ZTe};/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function eIe(t){const{inputs:e,backend:n}=t,{data:r,indices:a,segmentIds:i}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(a.shape.length!==1)throw new Error(`Indices should be a vector but received shape
             ${a.shape}`);if(i.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
             ${i.shape}`);const o=n.readSync(r.dataId),s=n.readSync(a.dataId),l=n.readSync(i.dataId),[u,c]=Q9(o,r.shape,r.dtype,s,l);return n.makeTensorInfo(c,r.dtype,u)}const tIe={kernelName:nx,backendName:"webgl",kernelFunc:eIe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function nIe(t){const{inputs:e,backend:n,attrs:r}=t,{sparseIndices:a,sparseValues:i,defaultValue:o}=e,{outputShape:s}=r,{sliceRank:l,numUpdates:u,sliceSize:c,strides:d,outputSize:p}=Qd(i,a,s),f=!1;if(i.dtype==="string"){const b=n.bufferSync(a),v=n.bufferSync(i),w=Cs(n.readSync(o.dataId)[0]),S=zxe(b,v,s,p,c,u,l,d,w,f);return n.makeTensorInfo(s,S.dtype,S.values)}const m=new q7(u,l,a.shape.length,i.shape.length,d,[p,1],f),y=n.runWebGLProgram(m,[i,a,o],i.dtype),x=Re({inputs:{x:y},backend:n,attrs:{shape:s}});return n.disposeIntermediateTensorInfo(y),x}const rIe={kernelName:rx,backendName:"webgl",kernelFunc:nIe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function aIe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{numOrSizeSplits:i,axis:o}=r,s=Pt(o,a.shape)[0],l=i4(a,i,s),u=a.shape.length,c=new Array(u).fill(0),d=a.shape.slice();return l.map(p=>{const f=[...d];f[s]=p;const m=Cp({inputs:{x:a},backend:n,attrs:{begin:c,size:f}});return c[s]+=p,m})}const iIe={kernelName:Qv,backendName:"webgl",kernelFunc:aIe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const K7="return sqrt(x);",oIe=Rt({opSnippet:K7,packedOpSnippet:K7,cpuKernelImpl:Gxe}),sIe={kernelName:yg,backendName:"webgl",kernelFunc:oIe};/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const lIe="return x * x;",uIe=Rt({opSnippet:lIe}),cIe={kernelName:rT,backendName:"webgl",kernelFunc:uIe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const X7="return (a - b) * (a - b);",dIe=_r({opSnippet:X7,packedOpSnippet:X7}),pIe={kernelName:bg,backendName:"webgl",kernelFunc:dIe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function hIe({inputs:t,attrs:e,backend:n}){const{x:r}=t,a=Li+`
    return x > 0.0 ? 1.0 : float(${e.alpha});
  `,i=new Ls(r.shape,a);return n.runWebGLProgram(i,[r],r.dtype)}const fIe={kernelName:Sg,backendName:"webgl",kernelFunc:hIe};/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class gIe{constructor(e,n,r){this.variableNames=["x"],this.outputShape=r;const a=r.length,i=pn(r.length),o=pn(r.length);let s="";if(a===1)s="coords * strides + begin";else{let l=0;s=r.map((u,c)=>(l++,r.length===1?`coords * strides[${c}] + begin[${c}]`:`coords[${l-1}] * strides[${c}] + begin[${c}]`)).join(",")}this.userCode=`
      ${i} begin = ${i}(${e});
      ${i} strides = ${i}(${n});

      void main() {
        ${o} coords = getOutputCoords();
        setOutput(getX(${s}));
      }
    `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function mIe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{begin:i,end:o,strides:s,beginMask:l,endMask:u,ellipsisMask:c,newAxisMask:d,shrinkAxisMask:p}=r,{finalShapeSparse:f,finalShape:m,isIdentity:y,sliceDim0:x,isSimpleSlice:b,begin:v,end:w,strides:S}=HT(a.shape,i,o,s,l,u,c,d,p);let C;if(y)C=Re({inputs:{x:a},backend:n,attrs:{shape:m}});else if(x||b){j(a.shape.length>=1,()=>`Input must have rank at least 1, got: ${a.shape.length}`);const _=VT(v,w,S),E=Cp({inputs:{x:a},backend:n,attrs:{begin:v,size:_}});C=Re({inputs:{x:E},backend:n,attrs:{shape:m}}),n.disposeIntermediateTensorInfo(E)}else if(n.shouldExecuteOnCPU([a])){const _=n.readSync(a.dataId),E=pt(a.shape,a.dtype,_),P=Hxe(f,E,S,v);C=n.makeTensorInfo(m,a.dtype,P.values)}else{const _=new gIe(v,S,f);C=n.runWebGLProgram(_,[a],a.dtype)}const I=Re({inputs:{x:C},backend:n,attrs:{shape:m}});return n.disposeIntermediateTensorInfo(C),I}const yIe={kernelName:ax,backendName:"webgl",kernelFunc:mIe};/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function bIe(t){const{inputs:e,backend:n,attrs:r}=t,{separator:a,nGramWidths:i,leftPad:o,rightPad:s,padWidth:l,preserveShortSequences:u}=r,{data:c,dataSplits:d}=e,p=n.readSync(c.dataId),f=n.readSync(d.dataId),[m,y]=qxe(p,f,a,i,o,s,l,u);return[n.makeTensorInfo([m.length],"string",m),n.makeTensorInfo(d.shape,"int32",y)]}const vIe={kernelName:ix,backendName:"webgl",kernelFunc:bIe};/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function xIe(t){const{inputs:e,backend:n,attrs:r}=t,{skipEmpty:a}=r,{input:i,delimiter:o}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(i.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${i.shape}`);if(o.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${o.shape}`);const s=n.readSync(i.dataId),l=n.readSync(o.dataId)[0],[u,c,d]=Kxe(s,l,a),p=c.length;return[n.makeTensorInfo([p,2],"int32",u),n.makeTensorInfo([p],"string",c),n.makeTensorInfo([2],"int32",new Int32Array(d))]}const wIe={kernelName:ox,backendName:"webgl",kernelFunc:xIe};/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function kIe(t){const{inputs:e,backend:n,attrs:r}=t,{numBuckets:a}=r,{input:i}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");if(a<=0)throw new Error("Number of buckets must be at least 1");const o=n.readSync(i.dataId),s=Xxe(o,a);return n.makeTensorInfo(i.shape,"int32",s)}const SIe={kernelName:sx,backendName:"webgl",kernelFunc:kIe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const CIe="return tan(x);",NIe=Rt({opSnippet:CIe}),TIe={kernelName:xg,backendName:"webgl",kernelFunc:NIe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const IIe=`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`,EIe=Rt({opSnippet:IIe}),_Ie={kernelName:wg,backendName:"webgl",kernelFunc:EIe};/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class OIe{constructor(e,n){this.variableNames=["A"];const r=new Array(e.length);for(let o=0;o<r.length;o++)r[o]=e[o]*n[o];this.outputShape=r,this.rank=r.length;const a=pn(this.rank),i=$Ie(e);this.userCode=`
      void main() {
        ${a} resRC = getOutputCoords();
        setOutput(getA(${i}));
      }
    `}}function $Ie(t){const e=t.length;if(e>5)throw Error(`Tile for rank ${e} is not yet supported`);if(e===1)return`imod(resRC, ${t[0]})`;const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[];for(let a=0;a<t.length;a++)r.push(`imod(${n[a]}, ${t[a]})`);return r.join()}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function Y7(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{reps:i}=r;if(a.dtype==="string"||a.shape.length>5){const s=n.readSync(a.dataId),l=a.dtype==="string"?s.map(d=>Cs(d)):s,u=pt(a.shape,a.dtype,l),c=Qxe(u,i);return n.makeTensorInfo(c.shape,c.dtype,c.values)}const o=new OIe(a.shape,i);return n.runWebGLProgram(o,[a],a.dtype)}const RIe={kernelName:kg,backendName:"webgl",kernelFunc:Y7};class MIe{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=e,this.userCode=`
       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // We compare elements pair-wise within a group of size 2 * inc.
         // The comparing rule for each group alternates between ascending
         // and descending. Within each group, we compare each pair at
         // positions i and i+inc. To decide whether an element at position i
         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
         // inc, it is in the first half of the group, we denote it as x0,
         // otherwise we denote it as x1.
         // For example, as shown in the Bitonic top K paper referenced above,
         // Figure5(a) shows that element[1] is in the
         // second half of the group when group size is 2, but it is in the
         // first half of the group when group size is 4.

         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;
         int i = isFirstInPair ? elemIdx : elemIdx - inc;

         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));
         float x0 = i0 < n ? getX(batch, i0) : negativeInf;
         float x1 = i1 < n ? getX(batch, i1) : negativeInf;

         // Denotes which direction indices are in (ascending or descending).
         bool reverse = imod(elemIdx, 2 * dir) >= dir;
         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
         if (reverse == isGreater) { // Elements in opposite order of direction
           int iTemp = i0;
           i0 = i1;
           i1 = iTemp;
         }
         if (isFirstInPair) {
            setOutput(float(i0));
         } else {
            setOutput(float(i1));
         }
       }
     `}}class AIe{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=e,this.userCode=`
    void main() {
         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // The output size is half of the previous size.
         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),
         // we only need to output the indices at positions |, the indices at
         // positions _ can be thrown away, see Figure5(b) After Phase 2
         // (Merge phase) in the Bitonic Top K paper referenced above.
         // For example, the paper shows we only need to output the orange bars.
         // The output sequence should look like this | | | | | | | |.
         // Because the sequence is halved, to map the output index back
         // to the previous sequence to find the corresponding value,
         // we need to double the index. When we double the index,
         // we basically interpolate a position, so 2i looks like
         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position
         // of each 2k positions by - elemIdx % k. E.g. for output at
         // index 4,5,6,7, we want to get the corresponding element at
         // original index 8,9,10,11, for output at index 8,9,10,11,
         // we want to get the corresponding element at original index
         // 16,17,18,19, so on and so forth.

         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));
         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));

         float x0 = getX(batch, i0);
         float x1 = i1 < n ? getX(batch, i1) : x0;

         setOutput(x0 >= x1 ? float(i0) : float(i1));
       }
     `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function yc(t,e){e!==null&&t.disposeIntermediateTensorInfo(e)}function Q7(t){let e=1;for(;e<t;)e*=2;return e}function PIe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a}=e,{k:i,sorted:o}=r,s=ce().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),l=ce().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),u=a.shape,c=u[u.length-1];if(n.shouldExecuteOnCPU([a])||c<s||i>l){const P=n.readSync(a.dataId),[A,D]=Zxe(P,u,a.dtype,i,o);return[n.makeTensorInfo(A.shape,A.dtype,A.values),n.makeTensorInfo(D.shape,D.dtype,D.values)]}if(i===0)return u[u.length-1]=0,[n.makeTensorInfo(u,a.dtype,[]),n.makeTensorInfo(u,"int32",[])];if(c===1)return[a,fm({attrs:{shape:u,dtype:"int32",value:0},backend:n})];const d=n.texData.get(a.dataId),p=d!==null&&d.isPacked,f=p?n.unpackTensor(a):a,m=me(u)/c,y=Re({inputs:{x:f},attrs:{shape:[m,c]},backend:n});p&&yc(n,f);const x=Q7(i),b=Q7(c);let v=null;const w=()=>v===null?[y,y]:[y,v],S=(P,A,D)=>{const V=w(),z=new MIe(D),K=[[c],[v===null?1:0],[Number.NEGATIVE_INFINITY],[P],[A]],X=v;v=n.runWebGLProgram(z,V,"int32",K),yc(n,X)};for(let P=1;P<x;P*=2){const A=P*2;for(let D=P;D>=1;D/=2)S(A,D,[m,b])}for(let P=b;P>x;P/=2){const A=w(),D=new AIe([m,P/2]),V=[[c],[v===null?1:0],[x]],z=v;v=n.runWebGLProgram(D,A,"int32",V),yc(n,z);const K=x/2,X=K*2;for(let Z=K;Z>=1;Z/=2)S(X,Z,v.shape)}let C=v;v=Cp({inputs:{x:v},backend:n,attrs:{begin:0,size:[m,i]}}),yc(n,C);let I=F7({inputs:{x:y,indices:v},backend:n,attrs:{axis:1,batchDims:1}});yc(n,y);const _=u.slice(0,-1);_.push(i),C=v,v=Re({inputs:{x:v},attrs:{shape:_},backend:n}),yc(n,C);const E=I;return I=Re({inputs:{x:I},attrs:{shape:_},backend:n}),yc(n,E),[I,v]}const LIe={kernelName:lx,backendName:"webgl",kernelFunc:PIe};/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class DIe{constructor(e,n,r,a,i,o){this.variableNames=["Image","Transforms"],this.outputShape=o;const s=r==="nearest"?1:2;let l;switch(a){case"constant":l=1;break;case"reflect":l=2;break;case"wrap":l=3;break;case"nearest":l=4;break;default:l=1;break}this.userCode=`
            float mapCoord(float outCoord, float len) {
              float inCoord = outCoord;
              if(${l} == 2) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    if (inCoord < sz2) {
                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +
                      inCoord;
                    }
                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    inCoord -= sz2 * float(int(float(inCoord / sz2)));
                    if (inCoord >= len) {
                      inCoord = sz2 - inCoord - 1.0;
                    }
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 3) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord -= len * float(int(float(inCoord / sz)));
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 4) {
                return clamp(outCoord, 0.0, len - 1.0);
              } else {
                return outCoord;
              }
            }

            float readWithFillValue(int batch, int coordY, int coordX,
              int channel) {
              float outputValue;
              if (0 <= coordY && coordY < ${e} && 0 <= coordX && coordX < ${n}) {
                  outputValue = getImage(batch, coordY, coordX, channel);
              } else {
                outputValue = float(${i});
              }
              return outputValue;
            }

            void main() {
              ivec4 coords = getOutputCoords();
              float outputValue;
              int batch = coords[0];
              int x = coords[2];
              int y = coords[1];
              int channel = coords[3];
              float xf = float(x);
              float yf = float(y);
              float a1 = getTransforms(batch, 0);
              float a2 = getTransforms(batch, 1);
              float a3 = getTransforms(batch, 2);
              float b1 = getTransforms(batch, 3);
              float b2 = getTransforms(batch, 4);
              float b3 = getTransforms(batch, 5);
              float c1 = getTransforms(batch, 6);
              float c2 = getTransforms(batch, 7);
              float projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = float(${i});
              } else {
                float inX = (a1 * xf + a2 * yf + a3) / projection;
                float inY = (b1 * xf + b2 * yf + b3) / projection;
                float mapX = mapCoord(inX, float(${n}));
                float mapY = mapCoord(inY, float(${e}));

                if (${s} == 1) {
                  int coordY = int(round(mapY));
                  int coordX = int(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  float yFloor = floor(mapY);
                  float xFloor = floor(mapX);
                  float yCeil = yFloor + 1.0;
                  float xCeil = xFloor + 1.0;
                  float valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);
                  float valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutput(outputValue);
            }
        `}}/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function FIe(t){const{inputs:e,backend:n,attrs:r}=t,{image:a,transforms:i}=e,{interpolation:o,fillMode:s,fillValue:l,outputShape:u}=r,[c,d,p,f]=a.shape,[m,y]=u??[d,p],x=[c,m,y,f],b=new DIe(d,p,o,s,l,x);return n.runWebGLProgram(b,[a,i],"float32")}const BIe={kernelName:ux,backendName:"webgl",kernelFunc:FIe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the License);
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an AS IS BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function zIe(t){const{inputs:e,attrs:n,backend:r}=t,{axis:a}=n,{x:i}=e;im(i,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const o=r.readSync(i.dataId),{outputValues:s,outputShape:l,indices:u}=Jxe(o,a,i.shape,i.dtype);return[r.makeTensorInfo(l,i.dtype,s),r.makeTensorInfo([u.length],"int32",u)]}const jIe={kernelName:cx,backendName:"webgl",kernelFunc:zIe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function VIe(t){const{inputs:e,backend:n,attrs:r}=t,{value:a}=e;let{axis:i}=r;i<0&&(i+=a.shape.length);const o=a,s=o.shape.length,l=a.shape[i],u=new Array(s-1);let c=0;for(let y=0;y<s;y++)y!==i&&(u[c++]=o.shape[y]);const d=[],p=new Array(s).fill(0),f=o.shape.slice();f[i]=1;const m=new Array(l);for(let y=0;y<m.length;y++){p[i]=y;const x=Cp({inputs:{x:o},backend:n,attrs:{begin:p,size:f}}),b=Re({inputs:{x},backend:n,attrs:{shape:u}});m[y]=b,d.push(x)}return d.forEach(y=>n.disposeIntermediateTensorInfo(y)),m}const WIe={kernelName:dx,backendName:"webgl",kernelFunc:VIe};/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/class UIe{constructor(e,n){this.variableNames=["x","segmentIds"];const r=e.windowSize,a=e.batchSize,i=e.inSize,o=e.numSegments,s=o*Math.ceil(i/r);this.outputShape=[a,s];const l="0.0",u="sumValue",c=Math.floor(r/4)*4,d=r%4,p=`
        sumValue += dot(values, segFilter);
    `;let f="";i%r>0&&(f=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return initializationValue;
        }
      `);let m="";i%r>0&&(m=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = ${l};

      float getValue(int batch, int inIdx) {
        ${f}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${m}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${o})) * float(${r}));
        int currentSeg = int(mod(float(outIdx), float(${o})));

        float sumValue = 0.0;

        for (int i = 0; i < ${c}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${p}
        }

        int inIdx = inOffset + ${c};
        if (${d===1}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${p}
        } else if (${d===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${p}
        } else if (${d===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${p}
        }
        setOutput(${u});
      }
    `}}/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/function GIe(t){const{inputs:e,backend:n,attrs:r}=t,{x:a,segmentIds:i}=e,{numSegments:o}=r,s=a.shape.length,l=[];let u=0;const c=Un([u],s);let d=a;c!=null&&(d=pa({inputs:{x:a},backend:n,attrs:{perm:c}}),l.push(d),u=Gn(1,s)[0]);const p=lF(d.shape,u,o),f=me([d.shape[u]]),m=Re({inputs:{x:d},backend:n,attrs:{shape:[-1,f]}});l.push(m);const y=kx(a.dtype),x=(S,C,I,_,E)=>{const P=S.shape[0],A=S.shape[1],D=sF(A,E),V={windowSize:D,inSize:A,batchSize:P,numSegments:E},z=new UIe(V,C),K=n.compileAndRun(z,[S,I],_);if(l.push(K),K.shape[1]===E)return K;const X=H7({backend:n,attrs:{start:0,stop:E,step:1,dtype:"float32"}}),Z=Y7({inputs:{x:X},backend:n,attrs:{reps:[A/D]}});return l.push(X),l.push(Z),x(K,C,Z,_,E)},b=x(m,"unsortedSegmentSum",i,y,o),v=Re({inputs:{x:b},backend:n,attrs:{shape:p}});let w=v;if(c!=null){l.push(v);const S=jg(c);w=pa({inputs:{x:w},backend:n,attrs:{perm:S}})}return l.forEach(S=>n.disposeIntermediateTensorInfo(S)),w}const HIe={kernelName:px,backendName:"webgl",kernelFunc:GIe};/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/const qIe=[U2e,H2e,X2e,Z2e,ewe,rwe,iwe,swe,dwe,hwe,mwe,vwe,kwe,Twe,_we,$we,Mwe,Dwe,Bwe,jwe,Gwe,Zwe,eke,nke,lke,cke,fke,I2e,yke,kke,Tke,Rke,Ake,Lke,Fke,zke,Wke,Hke,Xke,Qke,Jke,tSe,aSe,oSe,cSe,pSe,gSe,bSe,xSe,CSe,ESe,RSe,PSe,FSe,BSe,jSe,WSe,GSe,qSe,XSe,JSe,nCe,iCe,sCe,cCe,hCe,yCe,wCe,T2e,SCe,xke,TCe,_Ce,RCe,_2e,LCe,zCe,VCe,HCe,XCe,JCe,nNe,oNe,cNe,hNe,gNe,vNe,wNe,SNe,INe,_Ne,$Ne,MNe,PNe,BNe,WNe,qNe,t3e,R2e,i3e,l3e,d3e,f3e,ake,y3e,v3e,w3e,C3e,E3e,$2e,O3e,R3e,A3e,P3e,ike,QNe,F3e,V3e,H3e,A2e,Y3e,J3e,rTe,oTe,cTe,pTe,gTe,bTe,xTe,STe,TTe,_Te,MTe,LTe,BTe,VTe,Ywe,JNe,GTe,qTe,XTe,QTe,JTe,tIe,rIe,iIe,sIe,cIe,pIe,fIe,yIe,vIe,wIe,SIe,ZNe,j2e,TIe,_Ie,RIe,LIe,BIe,V2e,jIe,WIe,HIe,b3e];for(const t of qIe)bx(t);async function KIe(){return await efe({base:"pascal",quantizationBytes:2})}async function XIe(t,e){const n=await t.segment(e);return QIe(e,n)}function YIe(t,e,n,r,a){const i=document.createElement("canvas"),o=document.createElement("canvas"),s=i.getContext("2d"),l=o.getContext("2d");i.width=r,i.height=a,o.width=r,o.height=a,s.drawImage(e,0,0,r,a),l.putImageData(n,0,0);const u=s.getImageData(0,0,r,a),c=u.data,d=l.getImageData(0,0,r,a).data;for(let p=0,f=d.length;p<f;p+=4)d[p]===t[0]&&d[p+1]===t[1]&&d[p+2]===t[2]&&(c[p+3]=0);return s.putImageData(u,0,0),i.toDataURL()}function QIe(t,e){const{height:n,width:r,segmentationMap:a}=e,i=new ImageData(a,r,n);return YIe([0,0,0],t,i,r,n)}const ZIe=()=>{const t=R.useRef(),e=async n=>await XIe(t.current,n);return R.useEffect(()=>{KIe().then(n=>{t.current=n})}),{autoRemoveBackground:e}};async function JIe(t){try{const e=await fetch(t);if(!e.ok)throw new Error(e.statusText);const n=await e.json();return"@type"in n?n["@type"]!="sc:Manifest"?(console.log("The JSON for this Manifest doesn't look like a Manifest. It should have either a @type of sc:Manifest but has a type of: "+n["@type"]),null):t4e(n):"type"in n?n.type!="Manifest"?(console.log("The JSON for this Manifest doesn't look like a Manifest. It should have either a type of Manifest but has a type of: "+n.type),null):n4e(n):(console.log("The JSON for this Manifest doesn't look like a Manifest. It should have either a @type or type value of Manifest"),null)}catch(e){return console.log("I was unable to get the Manifest you supplied due to: "+e),null}}function e4e(t){return typeof t=="object"&&!Array.isArray(t)&&t!==null}function t4e(t){var e,n,r;if("sequences"in t){let a=t.sequences;e4e(a)&&(a=[a]);let i=!1;for(const o of a)if("canvases"in o){i=!0;for(const s of o.canvases){const l=(r=(n=(e=s.images[0])==null?void 0:e.resource)==null?void 0:n.service)==null?void 0:r["@id"];if(l)return l}}else i||console.log("The manifest you supplied contains no canvases so there are no images to show.")}else console.log("The manifest you supplied contains no sequence so there are no images to show.");return null}function n4e(t){if("items"in t){const e=t.items;for(const n of e){const r=n.items[0].items[0].body.service[0]["@id"];if(r)return r}}else console.log("The manifest you supplied contains no sequence so there are no images to show.");return null}function Z7(t,e){const n=window.getComputedStyle(t);return parseInt(n.getPropertyValue(e),10)}function r4e(t,e){const{width:n,height:r}=e,a=1080,i="0",o="default",s=".jpg",l=document.querySelector(".displayregioncontainer"),u=document.querySelector(".displayregion");if(!l||!u)throw new Error("Canvas or selection element not found");const{clientWidth:c,clientHeight:d}=l,p=n*d/r,f=(c-p)/2,m=n/p,y=9,x=Z7(u,"left"),b=Z7(u,"top"),v=Math.round(u.clientWidth+y),w=Math.round(u.clientHeight+y),S=Math.max(Math.round((x-f)*m),0),C=Math.max(Math.round(b*m),0),I=Math.min(Math.round(v*m),n),_=Math.min(Math.round(w*m),r),E=`${S},${C},${I},${_}`;return console.log(`Calculated selection region (x, y, width, height): ${E}`),`${t}/${E}/${a},/${i}/${o}${s}`}const J7={fetchIIIFIdentifier:async t=>{try{return await JIe(t)}catch(e){return console.error(e),null}},getCroppedImagePath:async t=>{try{const e=t+"/info.json",n=await fetch(e);if(!n.ok)throw new Error(n.statusText);const r=await n.json();return r4e(t,r)}catch(e){console.error(e)}}};function a4e({imageList:t,handleImageClick:e}){return se.jsx(to,{className:"flex overflow-x-auto",style:{maxHeight:"200px",scrollSnapType:"x mandatory",scrollBehavior:"smooth",WebkitOverflowScrolling:"touch"},children:t.map(n=>se.jsx("img",{src:n.thumbnail,alt:n.name,onClick:()=>e(n),style:{cursor:"pointer",marginRight:"10px",scrollSnapAlign:"start"},role:"presentation"},n.id))})}const i4e=R.lazy(()=>Pre(()=>import("./index-0urJz8-9.js"),q2([]))),o4e={canvasBackgroundColor:"010A01",gestureSettingsTouch:{dragToPan:!1,dblClickToZoom:!1,dblClickDragToZoom:!1,flickEnabled:!1,pinchRotate:!0},informationPanel:{open:!1},openSeadragon:{loadTilesWithAjax:!0,showNavigationControl:!1,showHomeControl:!1,showFullPageControl:!1,showRotationControl:!1,showFlipControl:!1},showTitle:!1,showIIIFBadge:!1,showZoomControl:!1},s4e={colors:{primary:"#BC13FE",accent:"#BC13FE",secondary:"#EDECEA"}};function l4e(){const{t}=Eu(),{imageLikeList:e}=ps(),n=ps(v=>v.addToArtwork),[r,a]=R.useState(e[0]||null),[i,o]=R.useState(""),[s,l]=R.useState("");R.useEffect(()=>{i&&setTimeout(()=>{l(document.querySelectorAll("canvas")[0].toDataURL())},1e3)},[i]);const u=v=>{a(v)},[c,d]=R.useState([]),[p,f]=R.useState(),{autoRemoveBackground:m}=ZIe(),y=v=>{const w=new Image;w.src=v,m(w).then(S=>{console.log(S),f(S)})},x=async(v,w)=>{try{const S=await J7.getCroppedImagePath(w);console.log("Cropped image path: ",S),S&&n(v,S)}catch(S){console.error("Error:",S)}},b=v=>{v&&console.log(o(v))};return se.jsxs(to,{className:"flex flex-col flex-wrap gap-4 container justify-center content-center text-center mx-auto",children:[se.jsx("div",{className:"p-2 m-4",children:se.jsx("h1",{className:"text-2xl",children:t("collectionTitle")})}),se.jsx(a4e,{imageList:e,handleImageClick:u}),r&&se.jsxs(to,{className:"space-y-4",children:[se.jsx(Qre,{value:c,src:s,onChange:v=>{d(v)},onComplete:v=>{v.length&&Hre(s,v,(w,S)=>{w||f(S.toDataURL())})}}),se.jsx("div",{children:se.jsx("img",{src:p,alt:""})}),p&&se.jsx(jn,{onClick:()=>y(p),children:"Remove Background"}),se.jsx(R.Suspense,{fallback:se.jsxs("h2",{children:["\u{1F300} ",t("collectionLoading")]}),children:se.jsx(i4e,{iiifContent:r.url,options:o4e,customTheme:s4e,canvasIdCallback:b})}),se.jsx(jn,{className:"p-4 text-xl text-black w-2/3 mx-auto h-16",rounded:!0,inline:!0,onClick:()=>x(r?.id,r?.identifier),children:t("collectionAddText")})]})]})}const u4e="/logos/bmbf_logo_de.jpg",c4e="/logos/bmbf_logo_en.jpg",d4e="/logos/digitalwarenkombinat.png",p4e="/logos/prototype_fund_logo.png",h4e=()=>se.jsx(Nd,{href:"https://prototypefund.de/",target:"_blank",children:se.jsx("img",{src:p4e,alt:"Logo Protype Fund",className:"w-96 m-auto"})}),f4e=()=>{const{i18n:t}=Eu();return se.jsx(Nd,{href:"https://www.bmbf.de/",target:"_blank",children:se.jsx("img",{src:t.resolvedLanguage==="en"?c4e:u4e,alt:"Logo Bundesministerium f\xFCr Bildung und Forschung",className:"w-96 m-auto"})})},g4e=()=>se.jsx(Nd,{href:"https://digitalwarenkombinat.de/",target:"_blank",children:se.jsx("img",{src:d4e,alt:"Logo Digitalwarenkombinat",className:"w-96 m-auto"})});function m4e(t,e){const{t:n,i18n:r}=Eu();return se.jsx(JM,{side:"right",opened:t,onBackdropClick:()=>e(!1),children:se.jsxs(py,{children:[se.jsx(uy,{right:se.jsx(NZ,{onClick:()=>e(!1),className:"mr-4 w-10 h-10"})}),se.jsxs(to,{className:"space-y-4",children:[se.jsx("p",{className:"text-xl",children:n("sidebarChooseLanguage")}),se.jsx(jn,{onClick:()=>r.changeLanguage("de"),className:"p-4 text-xl text-black w-10 mr-2 h-10",rounded:!0,inline:!0,children:"DE"}),se.jsx(jn,{onClick:()=>r.changeLanguage("en"),className:"p-4 text-xl text-black w-10 h-10",rounded:!0,inline:!0,children:"EN"}),se.jsx("p",{children:n("sidebarAbout")}),se.jsx("p",{children:n("sidebarLegal")}),se.jsx(h4e,{}),se.jsx(f4e,{}),se.jsx(g4e,{})]})]})})}function y4e(){const{t}=Eu(),[e,n]=R.useState(!1);return se.jsx(GM,{theme:"material",children:se.jsxs(py,{children:[se.jsx(uy,{className:"top-0 sticky",transparent:!0,right:se.jsx(UQ,{onClick:()=>n(!0),className:"mr-4 w-10 h-10"})}),se.jsxs(t6,{labels:!0,icons:!0,className:"left-0 bottom-0 fixed k-color-brand-primary text-center",innerClassName:"tabbar-inner",children:[se.jsx(of,{active:xl({path:Si("/").pathname,end:!0}),to:"/",component:ry,icon:se.jsx(aa,{material:se.jsx(lZ,{className:"w-10 h-10"}),className:`transition duration-300 ${xl({path:Si("/").pathname,end:!0})&&"animate-pulse"}`}),label:t("start"),touchRipple:!1}),se.jsx(of,{active:xl({path:Si("/selection").pathname,end:!0}),to:"/selection",component:ry,icon:se.jsx(aa,{material:se.jsx(iZ,{className:"w-10 h-10"}),className:`transition duration-300 ${xl({path:Si("/selection").pathname,end:!0})&&"animate-pulse"}`}),label:t("selection"),touchRipple:!1}),se.jsx(of,{active:xl({path:Si("/collection").pathname,end:!0}),to:"/collection",component:ry,icon:se.jsx(aa,{material:se.jsx(yZ,{className:"w-10 h-10"}),className:`transition duration-300 ${xl({path:Si("/collection").pathname,end:!0})&&"animate-pulse"}`}),label:t("collection"),touchRipple:!1}),se.jsx(of,{active:xl({path:Si("/creation").pathname,end:!0}),to:"/creation",component:ry,icon:se.jsx(aa,{material:se.jsx(dZ,{className:"w-10 h-10"}),className:`transition duration-300 ${xl({path:Si("/creation").pathname,end:!0})&&"animate-pulse"}`}),label:t("artwork"),touchRipple:!1})]}),se.jsx("main",{className:"h-[calc(100%_-_192px)] overflow-auto",children:se.jsx(Hq,{})}),m4e(e,n)]})})}var eB={exports:{}},tB={exports:{}},nB={exports:{}},rB={exports:{}},aB={exports:{}},eE=Object.defineProperty,b4e=Object.getOwnPropertyDescriptor,v4e=Object.getOwnPropertyNames,x4e=Object.prototype.hasOwnProperty,iB=(t,e)=>{for(var n in e)eE(t,n,{get:e[n],enumerable:!0})},w4e=(t,e,n,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let a of v4e(e))!x4e.call(t,a)&&a!==n&&eE(t,a,{get:()=>e[a],enumerable:!(r=b4e(e,a))||r.enumerable});return t},k4e=t=>w4e(eE({},"__esModule",{value:!0}),t),oB={};iB(oB,{FluidValue:()=>j4e,Globals:()=>sB,addFluidObserver:()=>V4e,callFluidObserver:()=>FB,callFluidObservers:()=>z4e,clamp:()=>kB,colorToRgba:()=>pE,colors:()=>R4e,createInterpolator:()=>hE,createStringInterpolator:()=>K4e,defineHidden:()=>N4e,deprecateDirectCall:()=>Z4e,deprecateInterpolate:()=>Y4e,each:()=>fB,eachProp:()=>I4e,easings:()=>D4e,flush:()=>gB,flushCalls:()=>_4e,frameLoop:()=>vB,getFluidObservers:()=>B4e,getFluidValue:()=>DB,hasFluidValue:()=>F4e,hex3:()=>IB,hex4:()=>EB,hex6:()=>_B,hex8:()=>OB,hsl:()=>NB,hsla:()=>TB,is:()=>Vo,isAnimatedString:()=>J4e,isEqual:()=>T4e,isSSR:()=>N2,noop:()=>hB,onResize:()=>WB,onScroll:()=>sEe,once:()=>gE,prefix:()=>P2,raf:()=>Dt,removeFluidObserver:()=>W4e,rgb:()=>SB,rgba:()=>CB,setFluidGetter:()=>BB,toArray:()=>E4e,useConstant:()=>uEe,useForceUpdate:()=>hEe,useIsomorphicLayoutEffect:()=>yE,useMemoOne:()=>fEe,useOnce:()=>yEe,usePrev:()=>vEe,useReducedMotion:()=>wEe});var S4e=k4e(oB),sB={};iB(sB,{assign:()=>bB,colors:()=>Xl,createStringInterpolator:()=>sE,skipAnimation:()=>yB,to:()=>mB,willAdvance:()=>lE});var tE=mm(),Dt=t=>gm(t,tE),nE=mm();Dt.write=t=>gm(t,nE);var C2=mm();Dt.onStart=t=>gm(t,C2);var rE=mm();Dt.onFrame=t=>gm(t,rE);var aE=mm();Dt.onFinish=t=>gm(t,aE);var Tp=[];Dt.setTimeout=(t,e)=>{let n=Dt.now()+e,r=()=>{let i=Tp.findIndex(o=>o.cancel==r);~i&&Tp.splice(i,1),Kl-=~i?1:0},a={time:n,handler:t,cancel:r};return Tp.splice(lB(n),0,a),Kl+=1,uB(),a};var lB=t=>~(~Tp.findIndex(e=>e.time>t)||~Tp.length);Dt.cancel=t=>{C2.delete(t),rE.delete(t),aE.delete(t),tE.delete(t),nE.delete(t)},Dt.sync=t=>{oE=!0,Dt.batchedUpdates(t),oE=!1},Dt.throttle=t=>{let e;function n(){try{t(...e)}finally{e=null}}function r(...a){e=a,Dt.onStart(n)}return r.handler=t,r.cancel=()=>{C2.delete(n),e=null},r};var iE=typeof window<"u"?window.requestAnimationFrame:()=>{};Dt.use=t=>iE=t,Dt.now=typeof performance<"u"?()=>performance.now():Date.now,Dt.batchedUpdates=t=>t(),Dt.catch=console.error,Dt.frameLoop="always",Dt.advance=()=>{Dt.frameLoop!=="demand"?console.warn("Cannot call the manual advancement of rafz whilst frameLoop is not set as demand"):dB()};var ql=-1,Kl=0,oE=!1;function gm(t,e){oE?(e.delete(t),t(0)):(e.add(t),uB())}function uB(){ql<0&&(ql=0,Dt.frameLoop!=="demand"&&iE(cB))}function C4e(){ql=-1}function cB(){~ql&&(iE(cB),Dt.batchedUpdates(dB))}function dB(){let t=ql;ql=Dt.now();let e=lB(ql);if(e&&(pB(Tp.splice(0,e),n=>n.handler()),Kl-=e),!Kl){C4e();return}C2.flush(),tE.flush(t?Math.min(64,ql-t):16.667),rE.flush(),nE.flush(),aE.flush()}function mm(){let t=new Set,e=t;return{add(n){Kl+=e==t&&!t.has(n)?1:0,t.add(n)},delete(n){return Kl-=e==t&&t.has(n)?1:0,t.delete(n)},flush(n){e.size&&(t=new Set,Kl-=e.size,pB(e,r=>r(n)&&t.add(r)),Kl+=t.size,e=t)}}}function pB(t,e){t.forEach(n=>{try{e(n)}catch(r){Dt.catch(r)}})}function hB(){}var N4e=(t,e,n)=>Object.defineProperty(t,e,{value:n,writable:!0,configurable:!0}),Vo={arr:Array.isArray,obj:t=>!!t&&t.constructor.name==="Object",fun:t=>typeof t=="function",str:t=>typeof t=="string",num:t=>typeof t=="number",und:t=>t===void 0};function T4e(t,e){if(Vo.arr(t)){if(!Vo.arr(e)||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}return t===e}var fB=(t,e)=>t.forEach(e);function I4e(t,e,n){if(Vo.arr(t)){for(let r=0;r<t.length;r++)e.call(n,t[r],`${r}`);return}for(let r in t)t.hasOwnProperty(r)&&e.call(n,t[r],r)}var E4e=t=>Vo.und(t)?[]:Vo.arr(t)?t:[t];function gB(t,e){if(t.size){let n=Array.from(t);t.clear(),fB(n,e)}}var _4e=(t,...e)=>gB(t,n=>n(...e)),N2=()=>typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),sE,mB,Xl=null,yB=!1,lE=hB,bB=t=>{t.to&&(mB=t.to),t.now&&(Dt.now=t.now),t.colors!==void 0&&(Xl=t.colors),t.skipAnimation!=null&&(yB=t.skipAnimation),t.createStringInterpolator&&(sE=t.createStringInterpolator),t.requestAnimationFrame&&Dt.use(t.requestAnimationFrame),t.batchedUpdates&&(Dt.batchedUpdates=t.batchedUpdates),t.willAdvance&&(lE=t.willAdvance),t.frameLoop&&(Dt.frameLoop=t.frameLoop)},ym=new Set,Di=[],uE=[],T2=0,vB={get idle(){return!ym.size&&!Di.length},start(t){T2>t.priority?(ym.add(t),Dt.onStart(O4e)):(xB(t),Dt(cE))},advance:cE,sort(t){if(T2)Dt.onFrame(()=>vB.sort(t));else{let e=Di.indexOf(t);~e&&(Di.splice(e,1),wB(t))}},clear(){Di=[],ym.clear()}};function O4e(){ym.forEach(xB),ym.clear(),Dt(cE)}function xB(t){Di.includes(t)||wB(t)}function wB(t){Di.splice($4e(Di,e=>e.priority>t.priority),0,t)}function cE(t){let e=uE;for(let n=0;n<Di.length;n++){let r=Di[n];T2=r.priority,r.idle||(lE(r),r.advance(t),r.idle||e.push(r))}return T2=0,uE=Di,uE.length=0,Di=e,Di.length>0}function $4e(t,e){let n=t.findIndex(e);return n<0?t.length:n}var kB=(t,e,n)=>Math.min(Math.max(n,t),e),R4e={transparent:0,aliceblue:4042850303,antiquewhite:4209760255,aqua:16777215,aquamarine:2147472639,azure:4043309055,beige:4126530815,bisque:4293182719,black:255,blanchedalmond:4293643775,blue:65535,blueviolet:2318131967,brown:2771004159,burlywood:3736635391,burntsienna:3934150143,cadetblue:1604231423,chartreuse:2147418367,chocolate:3530104575,coral:4286533887,cornflowerblue:1687547391,cornsilk:4294499583,crimson:3692313855,cyan:16777215,darkblue:35839,darkcyan:9145343,darkgoldenrod:3095792639,darkgray:2846468607,darkgreen:6553855,darkgrey:2846468607,darkkhaki:3182914559,darkmagenta:2332068863,darkolivegreen:1433087999,darkorange:4287365375,darkorchid:2570243327,darkred:2332033279,darksalmon:3918953215,darkseagreen:2411499519,darkslateblue:1211993087,darkslategray:793726975,darkslategrey:793726975,darkturquoise:13554175,darkviolet:2483082239,deeppink:4279538687,deepskyblue:12582911,dimgray:1768516095,dimgrey:1768516095,dodgerblue:512819199,firebrick:2988581631,floralwhite:4294635775,forestgreen:579543807,fuchsia:4278255615,gainsboro:3705462015,ghostwhite:4177068031,gold:4292280575,goldenrod:3668254975,gray:2155905279,green:8388863,greenyellow:2919182335,grey:2155905279,honeydew:4043305215,hotpink:4285117695,indianred:3445382399,indigo:1258324735,ivory:4294963455,khaki:4041641215,lavender:3873897215,lavenderblush:4293981695,lawngreen:2096890111,lemonchiffon:4294626815,lightblue:2916673279,lightcoral:4034953471,lightcyan:3774873599,lightgoldenrodyellow:4210742015,lightgray:3553874943,lightgreen:2431553791,lightgrey:3553874943,lightpink:4290167295,lightsalmon:4288707327,lightseagreen:548580095,lightskyblue:2278488831,lightslategray:2005441023,lightslategrey:2005441023,lightsteelblue:2965692159,lightyellow:4294959359,lime:16711935,limegreen:852308735,linen:4210091775,magenta:4278255615,maroon:2147483903,mediumaquamarine:1724754687,mediumblue:52735,mediumorchid:3126187007,mediumpurple:2473647103,mediumseagreen:1018393087,mediumslateblue:2070474495,mediumspringgreen:16423679,mediumturquoise:1221709055,mediumvioletred:3340076543,midnightblue:421097727,mintcream:4127193855,mistyrose:4293190143,moccasin:4293178879,navajowhite:4292783615,navy:33023,oldlace:4260751103,olive:2155872511,olivedrab:1804477439,orange:4289003775,orangered:4282712319,orchid:3664828159,palegoldenrod:4008225535,palegreen:2566625535,paleturquoise:2951671551,palevioletred:3681588223,papayawhip:4293907967,peachpuff:4292524543,peru:3448061951,pink:4290825215,plum:3718307327,powderblue:2967529215,purple:2147516671,rebeccapurple:1714657791,red:4278190335,rosybrown:3163525119,royalblue:1097458175,saddlebrown:2336560127,salmon:4202722047,sandybrown:4104413439,seagreen:780883967,seashell:4294307583,sienna:2689740287,silver:3233857791,skyblue:2278484991,slateblue:1784335871,slategray:1887473919,slategrey:1887473919,snow:4294638335,springgreen:16744447,steelblue:1182971135,tan:3535047935,teal:8421631,thistle:3636451583,tomato:4284696575,turquoise:1088475391,violet:4001558271,wheat:4125012991,white:4294967295,whitesmoke:4126537215,yellow:4294902015,yellowgreen:2597139199},ho="[-+]?\\d*\\.?\\d+",I2=ho+"%";function E2(...t){return"\\(\\s*("+t.join(")\\s*,\\s*(")+")\\s*\\)"}var SB=new RegExp("rgb"+E2(ho,ho,ho)),CB=new RegExp("rgba"+E2(ho,ho,ho,ho)),NB=new RegExp("hsl"+E2(ho,I2,I2)),TB=new RegExp("hsla"+E2(ho,I2,I2,ho)),IB=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,EB=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,_B=/^#([0-9a-fA-F]{6})$/,OB=/^#([0-9a-fA-F]{8})$/;function M4e(t){let e;return typeof t=="number"?t>>>0===t&&t>=0&&t<=4294967295?t:null:(e=_B.exec(t))?parseInt(e[1]+"ff",16)>>>0:Xl&&Xl[t]!==void 0?Xl[t]:(e=SB.exec(t))?(Ip(e[1])<<24|Ip(e[2])<<16|Ip(e[3])<<8|255)>>>0:(e=CB.exec(t))?(Ip(e[1])<<24|Ip(e[2])<<16|Ip(e[3])<<8|MB(e[4]))>>>0:(e=IB.exec(t))?parseInt(e[1]+e[1]+e[2]+e[2]+e[3]+e[3]+"ff",16)>>>0:(e=OB.exec(t))?parseInt(e[1],16)>>>0:(e=EB.exec(t))?parseInt(e[1]+e[1]+e[2]+e[2]+e[3]+e[3]+e[4]+e[4],16)>>>0:(e=NB.exec(t))?($B(RB(e[1]),_2(e[2]),_2(e[3]))|255)>>>0:(e=TB.exec(t))?($B(RB(e[1]),_2(e[2]),_2(e[3]))|MB(e[4]))>>>0:null}function dE(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function $B(t,e,n){let r=n<.5?n*(1+e):n+e-n*e,a=2*n-r,i=dE(a,r,t+1/3),o=dE(a,r,t),s=dE(a,r,t-1/3);return Math.round(i*255)<<24|Math.round(o*255)<<16|Math.round(s*255)<<8}function Ip(t){let e=parseInt(t,10);return e<0?0:e>255?255:e}function RB(t){return(parseFloat(t)%360+360)%360/360}function MB(t){let e=parseFloat(t);return e<0?0:e>1?255:Math.round(e*255)}function _2(t){let e=parseFloat(t);return e<0?0:e>100?1:e/100}function pE(t){let e=M4e(t);if(e===null)return t;e=e||0;let n=(e&4278190080)>>>24,r=(e&16711680)>>>16,a=(e&65280)>>>8,i=(e&255)/255;return`rgba(${n}, ${r}, ${a}, ${i})`}var hE=(t,e,n)=>{if(Vo.fun(t))return t;if(Vo.arr(t))return hE({range:t,output:e,extrapolate:n});if(Vo.str(t.output[0]))return sE(t);let r=t,a=r.output,i=r.range||[0,1],o=r.extrapolateLeft||r.extrapolate||"extend",s=r.extrapolateRight||r.extrapolate||"extend",l=r.easing||(u=>u);return u=>{let c=P4e(u,i);return A4e(u,i[c],i[c+1],a[c],a[c+1],l,o,s,r.map)}};function A4e(t,e,n,r,a,i,o,s,l){let u=l?l(t):t;if(u<e){if(o==="identity")return u;o==="clamp"&&(u=e)}if(u>n){if(s==="identity")return u;s==="clamp"&&(u=n)}return r===a?r:e===n?t<=e?r:a:(e===-1/0?u=-u:n===1/0?u=u-e:u=(u-e)/(n-e),u=i(u),r===-1/0?u=-u:a===1/0?u=u+r:u=u*(a-r)+r,u)}function P4e(t,e){for(var n=1;n<e.length-1&&!(e[n]>=t);++n);return n-1}var L4e=(t,e="end")=>n=>{n=e==="end"?Math.min(n,.999):Math.max(n,.001);let r=n*t,a=e==="end"?Math.floor(r):Math.ceil(r);return kB(0,1,a/t)},O2=1.70158,$2=O2*1.525,AB=O2+1,PB=2*Math.PI/3,LB=2*Math.PI/4.5,R2=t=>t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375,D4e={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>1-(1-t)*(1-t),easeInOutQuad:t=>t<.5?2*t*t:1-Math.pow(-2*t+2,2)/2,easeInCubic:t=>t*t*t,easeOutCubic:t=>1-Math.pow(1-t,3),easeInOutCubic:t=>t<.5?4*t*t*t:1-Math.pow(-2*t+2,3)/2,easeInQuart:t=>t*t*t*t,easeOutQuart:t=>1-Math.pow(1-t,4),easeInOutQuart:t=>t<.5?8*t*t*t*t:1-Math.pow(-2*t+2,4)/2,easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>1-Math.pow(1-t,5),easeInOutQuint:t=>t<.5?16*t*t*t*t*t:1-Math.pow(-2*t+2,5)/2,easeInSine:t=>1-Math.cos(t*Math.PI/2),easeOutSine:t=>Math.sin(t*Math.PI/2),easeInOutSine:t=>-(Math.cos(Math.PI*t)-1)/2,easeInExpo:t=>t===0?0:Math.pow(2,10*t-10),easeOutExpo:t=>t===1?1:1-Math.pow(2,-10*t),easeInOutExpo:t=>t===0?0:t===1?1:t<.5?Math.pow(2,20*t-10)/2:(2-Math.pow(2,-20*t+10))/2,easeInCirc:t=>1-Math.sqrt(1-Math.pow(t,2)),easeOutCirc:t=>Math.sqrt(1-Math.pow(t-1,2)),easeInOutCirc:t=>t<.5?(1-Math.sqrt(1-Math.pow(2*t,2)))/2:(Math.sqrt(1-Math.pow(-2*t+2,2))+1)/2,easeInBack:t=>AB*t*t*t-O2*t*t,easeOutBack:t=>1+AB*Math.pow(t-1,3)+O2*Math.pow(t-1,2),easeInOutBack:t=>t<.5?Math.pow(2*t,2)*(($2+1)*2*t-$2)/2:(Math.pow(2*t-2,2)*(($2+1)*(t*2-2)+$2)+2)/2,easeInElastic:t=>t===0?0:t===1?1:-Math.pow(2,10*t-10)*Math.sin((t*10-10.75)*PB),easeOutElastic:t=>t===0?0:t===1?1:Math.pow(2,-10*t)*Math.sin((t*10-.75)*PB)+1,easeInOutElastic:t=>t===0?0:t===1?1:t<.5?-(Math.pow(2,20*t-10)*Math.sin((20*t-11.125)*LB))/2:Math.pow(2,-20*t+10)*Math.sin((20*t-11.125)*LB)/2+1,easeInBounce:t=>1-R2(1-t),easeOutBounce:R2,easeInOutBounce:t=>t<.5?(1-R2(1-2*t))/2:(1+R2(2*t-1))/2,steps:L4e},bm=Symbol.for("FluidValue.get"),Ep=Symbol.for("FluidValue.observers"),F4e=t=>!!(t&&t[bm]),DB=t=>t&&t[bm]?t[bm]():t,B4e=t=>t[Ep]||null;function FB(t,e){t.eventObserved?t.eventObserved(e):t(e)}function z4e(t,e){let n=t[Ep];n&&n.forEach(r=>{FB(r,e)})}var j4e=class{constructor(t){if(!t&&!(t=this.get))throw Error("Unknown getter");BB(this,t)}},BB=(t,e)=>zB(t,bm,e);function V4e(t,e){if(t[bm]){let n=t[Ep];n||zB(t,Ep,n=new Set),n.has(e)||(n.add(e),t.observerAdded&&t.observerAdded(n.size,e))}return e}function W4e(t,e){let n=t[Ep];if(n&&n.has(e)){let r=n.size-1;r?n.delete(e):t[Ep]=null,t.observerRemoved&&t.observerRemoved(r,e)}}var zB=(t,e,n)=>Object.defineProperty(t,e,{value:n,writable:!0,configurable:!0}),M2=/[+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,U4e=/(#(?:[0-9a-f]{2}){2,4}|(#[0-9a-f]{3})|(rgb|hsl)a?\((-?\d+%?[,\s]+){2,3}\s*[\d\.]+%?\))/gi,jB=new RegExp(`(${M2.source})(%|[a-z]+)`,"i"),G4e=/rgba\(([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+)\)/gi,A2=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/,VB=t=>{let[e,n]=H4e(t);if(!e||N2())return t;let r=window.getComputedStyle(document.documentElement).getPropertyValue(e);return r?r.trim():n&&n.startsWith("--")?window.getComputedStyle(document.documentElement).getPropertyValue(n)||t:n&&A2.test(n)?VB(n):n||t},H4e=t=>{let e=A2.exec(t);if(!e)return[,];let[,n,r]=e;return[n,r]},fE,q4e=(t,e,n,r,a)=>`rgba(${Math.round(e)}, ${Math.round(n)}, ${Math.round(r)}, ${a})`,K4e=t=>{fE||(fE=Xl?new RegExp(`(${Object.keys(Xl).join("|")})(?!\\w)`,"g"):/^\b$/);let e=t.output.map(a=>DB(a).replace(A2,VB).replace(U4e,pE).replace(fE,pE)),n=e.map(a=>a.match(M2).map(Number)),r=n[0].map((a,i)=>n.map(o=>{if(!(i in o))throw Error('The arity of each "output" value must be equal');return o[i]})).map(a=>hE({...t,output:a}));return a=>{var i;let o=!jB.test(e[0])&&((i=e.find(l=>jB.test(l)))==null?void 0:i.replace(M2,"")),s=0;return e[0].replace(M2,()=>`${r[s++](a)}${o||""}`).replace(G4e,q4e)}},P2="react-spring: ",gE=t=>{let e=t,n=!1;if(typeof e!="function")throw new TypeError(`${P2}once requires a function parameter`);return(...r)=>{n||(e(...r),n=!0)}},X4e=gE(console.warn);function Y4e(){X4e(`${P2}The "interpolate" function is deprecated in v9 (use "to" instead)`)}var Q4e=gE(console.warn);function Z4e(){Q4e(`${P2}Directly calling start instead of using the api object is deprecated in v9 (use ".start" instead), this will be removed in later 0.X.0 versions`)}function J4e(t){return Vo.str(t)&&(t[0]=="#"||/\d/.test(t)||!N2()&&A2.test(t)||t in(Xl||{}))}var _p,L2=new WeakMap,eEe=t=>t.forEach(({target:e,contentRect:n})=>{var r;return(r=L2.get(e))==null?void 0:r.forEach(a=>a(n))});function tEe(t,e){_p||typeof ResizeObserver<"u"&&(_p=new ResizeObserver(eEe));let n=L2.get(e);return n||(n=new Set,L2.set(e,n)),n.add(t),_p&&_p.observe(e),()=>{let r=L2.get(e);r&&(r.delete(t),!r.size&&_p&&_p.unobserve(e))}}var D2=new Set,vm,nEe=()=>{let t=()=>{D2.forEach(e=>e({width:window.innerWidth,height:window.innerHeight}))};return window.addEventListener("resize",t),()=>{window.removeEventListener("resize",t)}},rEe=t=>(D2.add(t),vm||(vm=nEe()),()=>{D2.delete(t),!D2.size&&vm&&(vm(),vm=void 0)}),WB=(t,{container:e=document.documentElement}={})=>e===document.documentElement?rEe(t):tEe(t,e),aEe=(t,e,n)=>e-t===0?1:(n-t)/(e-t),iEe={x:{length:"Width",position:"Left"},y:{length:"Height",position:"Top"}},oEe=class{constructor(t,e){this.createAxis=()=>({current:0,progress:0,scrollLength:0}),this.updateAxis=n=>{let r=this.info[n],{length:a,position:i}=iEe[n];r.current=this.container[`scroll${i}`],r.scrollLength=this.container["scroll"+a]-this.container["client"+a],r.progress=aEe(0,r.scrollLength,r.current)},this.update=()=>{this.updateAxis("x"),this.updateAxis("y")},this.sendEvent=()=>{this.callback(this.info)},this.advance=()=>{this.update(),this.sendEvent()},this.callback=t,this.container=e,this.info={time:0,x:this.createAxis(),y:this.createAxis()}}},xm=new WeakMap,UB=new WeakMap,mE=new WeakMap,GB=t=>t===document.documentElement?window:t,sEe=(t,{container:e=document.documentElement}={})=>{let n=mE.get(e);n||(n=new Set,mE.set(e,n));let r=new oEe(t,e);if(n.add(r),!xm.has(e)){let i=()=>(n?.forEach(s=>s.advance()),!0);xm.set(e,i);let o=GB(e);window.addEventListener("resize",i,{passive:!0}),e!==document.documentElement&&UB.set(e,WB(i,{container:e})),o.addEventListener("scroll",i,{passive:!0})}let a=xm.get(e);return Dt(a),()=>{var i;Dt.cancel(a);let o=mE.get(e);if(!o||(o.delete(r),o.size))return;let s=xm.get(e);xm.delete(e),s&&(GB(e).removeEventListener("scroll",s),window.removeEventListener("resize",s),(i=UB.get(e))==null||i())}},lEe=R;function uEe(t){let e=(0,lEe.useRef)(null);return e.current===null&&(e.current=t()),e.current}var cEe=R,dEe=R,HB=R,yE=N2()?HB.useEffect:HB.useLayoutEffect,pEe=()=>{let t=(0,dEe.useRef)(!1);return yE(()=>(t.current=!0,()=>{t.current=!1}),[]),t};function hEe(){let t=(0,cEe.useState)()[1],e=pEe();return()=>{e.current&&t(Math.random())}}var bE=R;function fEe(t,e){let[n]=(0,bE.useState)(()=>({inputs:e,result:t()})),r=(0,bE.useRef)(),a=r.current,i=a;return i?e&&i.inputs&&gEe(e,i.inputs)||(i={inputs:e,result:t()}):i=n,(0,bE.useEffect)(()=>{r.current=i,a==n&&(n.inputs=n.result=void 0)},[i]),i.result}function gEe(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}var mEe=R,yEe=t=>(0,mEe.useEffect)(t,bEe),bEe=[],qB=R;function vEe(t){let e=(0,qB.useRef)();return(0,qB.useEffect)(()=>{e.current=t}),e.current}var xEe=R,wEe=()=>{let[t,e]=(0,xEe.useState)(null);return yE(()=>{let n=window.matchMedia("(prefers-reduced-motion)"),r=a=>{e(a.matches),bB({skipAnimation:a.matches})};return r(n),n.addEventListener("change",r),()=>{n.removeEventListener("change",r)}},[]),t};aB.exports=S4e;var Ft=aB.exports,KB={exports:{}},kEe=Object.create,F2=Object.defineProperty,SEe=Object.getOwnPropertyDescriptor,CEe=Object.getOwnPropertyNames,NEe=Object.getPrototypeOf,TEe=Object.prototype.hasOwnProperty,IEe=(t,e)=>{for(var n in e)F2(t,n,{get:e[n],enumerable:!0})},XB=(t,e,n,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let a of CEe(e))!TEe.call(t,a)&&a!==n&&F2(t,a,{get:()=>e[a],enumerable:!(r=SEe(e,a))||r.enumerable});return t},EEe=(t,e,n)=>(n=t!=null?kEe(NEe(t)):{},XB(e||!t||!t.__esModule?F2(n,"default",{value:t,enumerable:!0}):n,t)),_Ee=t=>XB(F2({},"__esModule",{value:!0}),t),YB={};IEe(YB,{Animated:()=>vE,AnimatedArray:()=>kE,AnimatedObject:()=>j2,AnimatedString:()=>B2,AnimatedValue:()=>km,createHost:()=>BEe,getAnimated:()=>ZB,getAnimatedType:()=>AEe,getPayload:()=>ez,isAnimated:()=>QB,setAnimated:()=>JB});var OEe=_Ee(YB),$Ee=Ft,wm=Symbol.for("Animated:node"),QB=t=>!!t&&t[wm]===t,ZB=t=>t&&t[wm],JB=(t,e)=>(0,$Ee.defineHidden)(t,wm,e),ez=t=>t&&t[wm]&&t[wm].getPayload(),vE=class{constructor(){JB(this,this)}getPayload(){return this.payload||[]}},xE=Ft,km=class extends vE{constructor(t){super(),this._value=t,this.done=!0,this.durationProgress=0,xE.is.num(this._value)&&(this.lastPosition=this._value)}static create(t){return new km(t)}getPayload(){return[this]}getValue(){return this._value}setValue(t,e){return xE.is.num(t)&&(this.lastPosition=t,e&&(t=Math.round(t/e)*e,this.done&&(this.lastPosition=t))),this._value===t?!1:(this._value=t,!0)}reset(){let{done:t}=this;this.done=!1,xE.is.num(this._value)&&(this.elapsedTime=0,this.durationProgress=0,this.lastPosition=this._value,t&&(this.lastVelocity=null),this.v0=null)}},wE=Ft,B2=class extends km{constructor(t){super(0),this._string=null,this._toString=(0,wE.createInterpolator)({output:[t,t]})}static create(t){return new B2(t)}getValue(){return this._string??(this._string=this._toString(this._value))}setValue(t){if(wE.is.str(t)){if(t==this._string)return!1;this._string=t,this._value=1}else if(super.setValue(t))this._string=null;else return!1;return!0}reset(t){t&&(this._toString=(0,wE.createInterpolator)({output:[this.getValue(),t]})),this._value=0,super.reset()}},REe=Ft,bc=Ft,z2={dependencies:null},j2=class extends vE{constructor(t){super(),this.source=t,this.setValue(t)}getValue(t){let e={};return(0,bc.eachProp)(this.source,(n,r)=>{QB(n)?e[r]=n.getValue(t):(0,bc.hasFluidValue)(n)?e[r]=(0,bc.getFluidValue)(n):t||(e[r]=n)}),e}setValue(t){this.source=t,this.payload=this._makePayload(t)}reset(){this.payload&&(0,bc.each)(this.payload,t=>t.reset())}_makePayload(t){if(t){let e=new Set;return(0,bc.eachProp)(t,this._addToPayload,e),Array.from(e)}}_addToPayload(t){z2.dependencies&&(0,bc.hasFluidValue)(t)&&z2.dependencies.add(t);let e=ez(t);e&&(0,bc.each)(e,n=>this.add(n))}},kE=class extends j2{constructor(t){super(t)}static create(t){return new kE(t)}getValue(){return this.source.map(t=>t.getValue())}setValue(t){let e=this.getPayload();return t.length==e.length?e.map((n,r)=>n.setValue(t[r])).some(Boolean):(super.setValue(t.map(MEe)),!0)}};function MEe(t){return((0,REe.isAnimatedString)(t)?B2:km).create(t)}var tz=Ft;function AEe(t){let e=ZB(t);return e?e.constructor:tz.is.arr(t)?kE:(0,tz.isAnimatedString)(t)?B2:km}var Op=Ft,PEe=EEe(R),Sm=R,oi=Ft,nz=(t,e)=>{let n=!oi.is.fun(t)||t.prototype&&t.prototype.isReactComponent;return(0,Sm.forwardRef)((r,a)=>{let i=(0,Sm.useRef)(null),o=n&&(0,Sm.useCallback)(m=>{i.current=FEe(a,m)},[a]),[s,l]=DEe(r,e),u=(0,oi.useForceUpdate)(),c=()=>{let m=i.current;n&&!m||(m?e.applyAnimatedValues(m,s.getValue(!0)):!1)===!1&&u()},d=new LEe(c,l),p=(0,Sm.useRef)();(0,oi.useIsomorphicLayoutEffect)(()=>(p.current=d,(0,oi.each)(l,m=>(0,oi.addFluidObserver)(m,d)),()=>{p.current&&((0,oi.each)(p.current.deps,m=>(0,oi.removeFluidObserver)(m,p.current)),oi.raf.cancel(p.current.update))})),(0,Sm.useEffect)(c,[]),(0,oi.useOnce)(()=>()=>{let m=p.current;(0,oi.each)(m.deps,y=>(0,oi.removeFluidObserver)(y,m))});let f=e.getComponentProps(s.getValue());return PEe.createElement(t,{...f,ref:o})})},LEe=class{constructor(t,e){this.update=t,this.deps=e}eventObserved(t){t.type=="change"&&oi.raf.write(this.update)}};function DEe(t,e){let n=new Set;return z2.dependencies=n,t.style&&(t={...t,style:e.createAnimatedStyle(t.style)}),t=new j2(t),z2.dependencies=null,[t,n]}function FEe(t,e){return t&&(oi.is.fun(t)?t(e):t.current=e),e}var rz=Symbol.for("AnimatedComponent"),BEe=(t,{applyAnimatedValues:e=()=>!1,createAnimatedStyle:n=a=>new j2(a),getComponentProps:r=a=>a}={})=>{let a={applyAnimatedValues:e,createAnimatedStyle:n,getComponentProps:r},i=o=>{let s=az(o)||"Anonymous";return Op.is.str(o)?o=i[o]||(i[o]=nz(o,a)):o=o[rz]||(o[rz]=nz(o,a)),o.displayName=`Animated(${s})`,o};return(0,Op.eachProp)(t,(o,s)=>{Op.is.arr(t)&&(s=az(o)),i[s]=i(o)}),{animated:i}},az=t=>Op.is.str(t)?t:t&&Op.is.str(t.displayName)?t.displayName:Op.is.fun(t)&&t.name||null;KB.exports=OEe;var Cm=KB.exports,iz={exports:{}},SE,oz;function zEe(){if(oz)return SE;oz=1;var t=Object.defineProperty,e=Object.getOwnPropertyDescriptor,n=Object.getOwnPropertyNames,r=Object.prototype.hasOwnProperty,a=(u,c)=>{for(var d in c)t(u,d,{get:c[d],enumerable:!0})},i=(u,c,d,p)=>{if(c&&typeof c=="object"||typeof c=="function")for(let f of n(c))!r.call(u,f)&&f!==d&&t(u,f,{get:()=>c[f],enumerable:!(p=e(c,f))||p.enumerable});return u},o=u=>i(t({},"__esModule",{value:!0}),u),s={};a(s,{Any:()=>l}),SE=o(s);var l=class{};return SE}var sz;function jEe(){return sz||(sz=1,iz.exports=zEe()),iz.exports}(function(t){var e=Object.create,n=Object.defineProperty,r=Object.getOwnPropertyDescriptor,a=Object.getOwnPropertyNames,i=Object.getPrototypeOf,o=Object.prototype.hasOwnProperty,s=(L,W)=>{for(var J in W)n(L,J,{get:W[J],enumerable:!0})},l=(L,W,J,ae)=>{if(W&&typeof W=="object"||typeof W=="function")for(let ye of a(W))!o.call(L,ye)&&ye!==J&&n(L,ye,{get:()=>W[ye],enumerable:!(ae=r(W,ye))||ae.enumerable});return L},u=(L,W,J)=>(l(L,W,"default"),J&&l(J,W,"default")),c=(L,W,J)=>(J=L!=null?e(i(L)):{},l(W||!L||!L.__esModule?n(J,"default",{value:L,enumerable:!0}):J,L)),d=L=>l(n({},"__esModule",{value:!0}),L),p={};s(p,{BailSignal:()=>Ye,Controller:()=>Dp,FrameValue:()=>Yt,Globals:()=>qo.Globals,Interpolation:()=>au,Spring:()=>Ho,SpringContext:()=>zi,SpringRef:()=>Tc,SpringValue:()=>rn,Trail:()=>qr,Transition:()=>_c,config:()=>ne,createInterpolator:()=>Ko.createInterpolator,easings:()=>Ko.easings,inferTo:()=>E,interpolate:()=>Oc,to:()=>sw,update:()=>iu,useChain:()=>K,useInView:()=>Hr,useIsomorphicLayoutEffect:()=>Ko.useIsomorphicLayoutEffect,useReducedMotion:()=>Ko.useReducedMotion,useResize:()=>an,useScroll:()=>Bs,useSpring:()=>nu,useSpringRef:()=>aw,useSpringValue:()=>iw,useSprings:()=>zp,useTrail:()=>Dm,useTransition:()=>Ec}),t.exports=d(p);var f=Ft,m=Ft;function y(L,...W){return m.is.fun(L)?L(...W):L}var x=(L,W)=>L===!0||!!(W&&L&&(m.is.fun(L)?L(W):(0,m.toArray)(L).includes(W))),b=(L,W)=>m.is.obj(L)?W&&L[W]:L,v=(L,W)=>L.default===!0?L[W]:L.default?L.default[W]:void 0,w=L=>L,S=(L,W=w)=>{let J=C;L.default&&L.default!==!0&&(L=L.default,J=Object.keys(L));let ae={};for(let ye of J){let we=W(L[ye],ye);m.is.und(we)||(ae[ye]=we)}return ae},C=["config","onProps","onStart","onChange","onPause","onResume","onRest"],I={config:1,from:1,to:1,ref:1,loop:1,reset:1,pause:1,cancel:1,reverse:1,immediate:1,default:1,delay:1,onProps:1,onStart:1,onChange:1,onPause:1,onResume:1,onRest:1,onResolve:1,items:1,trail:1,sort:1,expires:1,initial:1,enter:1,update:1,leave:1,children:1,onDestroyed:1,keys:1,callId:1,parentId:1};function _(L){let W={},J=0;if((0,m.eachProp)(L,(ae,ye)=>{I[ye]||(W[ye]=ae,J++)}),J)return W}function E(L){let W=_(L);if(W){let J={to:W};return(0,m.eachProp)(L,(ae,ye)=>ye in W||(J[ye]=ae)),J}return{...L}}function P(L){return L=(0,m.getFluidValue)(L),m.is.arr(L)?L.map(P):(0,m.isAnimatedString)(L)?m.Globals.createStringInterpolator({range:[0,1],output:[L,L]})(1):L}function A(L){for(let W in L)return!0;return!1}function D(L){return m.is.fun(L)||m.is.arr(L)&&m.is.obj(L[0])}function V(L,W){var J;(J=L.ref)==null||J.delete(L),W?.delete(L)}function z(L,W){var J;W&&L.ref!==W&&((J=L.ref)==null||J.delete(L),W.add(L),L.ref=W)}function K(L,W,J=1e3){(0,f.useIsomorphicLayoutEffect)(()=>{if(W){let ae=0;(0,f.each)(L,(ye,we)=>{let Oe=ye.current;if(Oe.length){let Ee=J*W[we];isNaN(Ee)?Ee=ae:ae=Ee,(0,f.each)(Oe,Ce=>{(0,f.each)(Ce.queue,De=>{let st=De.delay;De.delay=Ke=>Ee+y(st||0,Ke)})}),ye.start()}})}else{let ae=Promise.resolve();(0,f.each)(L,ye=>{let we=ye.current;if(we.length){let Oe=we.map(Ee=>{let Ce=Ee.queue;return Ee.queue=[],Ce});ae=ae.then(()=>((0,f.each)(we,(Ee,Ce)=>(0,f.each)(Oe[Ce]||[],De=>Ee.queue.push(De))),Promise.all(ye.start())))}})}})}var X=Ft,Z=R,q=Ft,F=Ft,Y=Cm,Q=Ft,ne={default:{tension:170,friction:26},gentle:{tension:120,friction:14},wobbly:{tension:180,friction:12},stiff:{tension:210,friction:20},slow:{tension:280,friction:60},molasses:{tension:280,friction:120}},le={...ne.default,mass:1,damping:1,easing:Q.easings.linear,clamp:!1},de=class{constructor(){this.velocity=0,Object.assign(this,le)}};function re(L,W,J){J&&(J={...J},he(J,W),W={...J,...W}),he(L,W),Object.assign(L,W);for(let Oe in le)L[Oe]==null&&(L[Oe]=le[Oe]);let{frequency:ae,damping:ye}=L,{mass:we}=L;return Q.is.und(ae)||(ae<.01&&(ae=.01),ye<0&&(ye=0),L.tension=Math.pow(2*Math.PI/ae,2)*we,L.friction=4*Math.PI*ye*we/ae),L}function he(L,W){if(!Q.is.und(W.decay))L.duration=void 0;else{let J=!Q.is.und(W.tension)||!Q.is.und(W.friction);(J||!Q.is.und(W.frequency)||!Q.is.und(W.damping)||!Q.is.und(W.mass))&&(L.duration=void 0,L.decay=void 0),J&&(L.frequency=void 0)}}var ve=[],H=class{constructor(){this.changed=!1,this.values=ve,this.toValues=null,this.fromValues=ve,this.config=new de,this.immediate=!1}},ie=Ft;function pe(L,{key:W,props:J,defaultProps:ae,state:ye,actions:we}){return new Promise((Oe,Ee)=>{let Ce,De,st=x(J.cancel??ae?.cancel,W);if(st)ct();else{ie.is.und(J.pause)||(ye.paused=x(J.pause,W));let We=ae?.pause;We!==!0&&(We=ye.paused||x(We,W)),Ce=y(J.delay||0,W),We?(ye.resumeQueue.add(bt),we.pause()):(we.resume(),bt())}function Ke(){ye.resumeQueue.add(bt),ye.timeouts.delete(De),De.cancel(),Ce=De.time-ie.raf.now()}function bt(){Ce>0&&!ie.Globals.skipAnimation?(ye.delayed=!0,De=ie.raf.setTimeout(ct,Ce),ye.pauseQueue.add(Ke),ye.timeouts.add(De)):ct()}function ct(){ye.delayed&&(ye.delayed=!1),ye.pauseQueue.delete(Ke),ye.timeouts.delete(De),L<=(ye.cancelId||0)&&(st=!0);try{we.start({...J,callId:L,cancel:st},Oe)}catch(We){Ee(We)}}})}var ke=Ft,Ne=(L,W)=>W.length==1?W[0]:W.some(J=>J.cancelled)?He(L.get()):W.every(J=>J.noop)?Ie(L.get()):Le(L.get(),W.every(J=>J.finished)),Ie=L=>({value:L,noop:!0,finished:!0,cancelled:!1}),Le=(L,W,J=!1)=>({value:L,finished:W,cancelled:J}),He=L=>({value:L,cancelled:!0,finished:!1});function Me(L,W,J,ae){let{callId:ye,parentId:we,onRest:Oe}=W,{asyncTo:Ee,promise:Ce}=J;return!we&&L===Ee&&!W.reset?Ce:J.promise=(async()=>{J.asyncId=ye,J.asyncTo=L;let De=S(W,(rt,Xe)=>Xe==="onRest"?void 0:rt),st,Ke,bt=new Promise((rt,Xe)=>(st=rt,Ke=Xe)),ct=rt=>{let Xe=ye<=(J.cancelId||0)&&He(ae)||ye!==J.asyncId&&Le(ae,!1);if(Xe)throw rt.result=Xe,Ke(rt),rt},We=(rt,Xe)=>{let dt=new Ye,et=new Ze;return(async()=>{if(ke.Globals.skipAnimation)throw it(J),et.result=Le(ae,!1),Ke(et),et;ct(dt);let ut=ke.is.obj(rt)?{...rt}:{...Xe,to:rt};ut.parentId=ye,(0,ke.eachProp)(De,(Ia,It)=>{ke.is.und(ut[It])&&(ut[It]=Ia)});let Fn=await ae.start(ut);return ct(dt),J.paused&&await new Promise(Ia=>{J.resumeQueue.add(Ia)}),Fn})()},tt;if(ke.Globals.skipAnimation)return it(J),Le(ae,!1);try{let rt;ke.is.arr(L)?rt=(async Xe=>{for(let dt of Xe)await We(dt)})(L):rt=Promise.resolve(L(We,ae.stop.bind(ae))),await Promise.all([rt.then(st),bt]),tt=Le(ae.get(),!0,!1)}catch(rt){if(rt instanceof Ye)tt=rt.result;else if(rt instanceof Ze)tt=rt.result;else throw rt}finally{ye==J.asyncId&&(J.asyncId=we,J.asyncTo=we?Ee:void 0,J.promise=we?Ce:void 0)}return ke.is.fun(Oe)&&ke.raf.batchedUpdates(()=>{Oe(tt,ae,ae.item)}),tt})()}function it(L,W){(0,ke.flush)(L.timeouts,J=>J.cancel()),L.pauseQueue.clear(),L.resumeQueue.clear(),L.asyncId=L.asyncTo=L.promise=void 0,W&&(L.cancelId=W)}var Ye=class extends Error{constructor(){super("An async animation has been interrupted. You see this error because you forgot to use `await` or `.catch(...)` on its returned promise.")}},Ze=class extends Error{constructor(){super("SkipAnimationSignal")}},Qe=Ft,Xt=Cm,Vt=L=>L instanceof Yt,Ht=1,Yt=class extends Qe.FluidValue{constructor(){super(...arguments),this.id=Ht++,this._priority=0}get priority(){return this._priority}set priority(L){this._priority!=L&&(this._priority=L,this._onPriorityChange(L))}get(){let L=(0,Xt.getAnimated)(this);return L&&L.getValue()}to(...L){return Qe.Globals.to(this,L)}interpolate(...L){return(0,Qe.deprecateInterpolate)(),Qe.Globals.to(this,L)}toJSON(){return this.get()}observerAdded(L){L==1&&this._attach()}observerRemoved(L){L==0&&this._detach()}_attach(){}_detach(){}_onChange(L,W=!1){(0,Qe.callFluidObservers)(this,{type:"change",parent:this,value:L,idle:W})}_onPriorityChange(L){this.idle||Qe.frameLoop.sort(this),(0,Qe.callFluidObservers)(this,{type:"priority",parent:this,priority:L})}},Wt=Symbol.for("SpringPhase"),Tt=1,Hn=2,yr=4,Ha=L=>(L[Wt]&Tt)>0,Or=L=>(L[Wt]&Hn)>0,Fi=L=>(L[Wt]&yr)>0,Ds=(L,W)=>W?L[Wt]|=Hn|Tt:L[Wt]&=~Hn,fo=(L,W)=>W?L[Wt]|=yr:L[Wt]&=~yr,rn=class extends Yt{constructor(L,W){if(super(),this.animation=new H,this.defaultProps={},this._state={paused:!1,delayed:!1,pauseQueue:new Set,resumeQueue:new Set,timeouts:new Set},this._pendingCalls=new Set,this._lastCallId=0,this._lastToId=0,this._memoizedDuration=0,!F.is.und(L)||!F.is.und(W)){let J=F.is.obj(L)?{...L}:{...W,from:L};F.is.und(J.default)&&(J.default=!0),this.start(J)}}get idle(){return!(Or(this)||this._state.asyncTo)||Fi(this)}get goal(){return(0,F.getFluidValue)(this.animation.to)}get velocity(){let L=(0,Y.getAnimated)(this);return L instanceof Y.AnimatedValue?L.lastVelocity||0:L.getPayload().map(W=>W.lastVelocity||0)}get hasAnimated(){return Ha(this)}get isAnimating(){return Or(this)}get isPaused(){return Fi(this)}get isDelayed(){return this._state.delayed}advance(L){let W=!0,J=!1,ae=this.animation,{toValues:ye}=ae,{config:we}=ae,Oe=(0,Y.getPayload)(ae.to);!Oe&&(0,F.hasFluidValue)(ae.to)&&(ye=(0,F.toArray)((0,F.getFluidValue)(ae.to))),ae.values.forEach((De,st)=>{if(De.done)return;let Ke=De.constructor==Y.AnimatedString?1:Oe?Oe[st].lastPosition:ye[st],bt=ae.immediate,ct=Ke;if(!bt){if(ct=De.lastPosition,we.tension<=0){De.done=!0;return}let We=De.elapsedTime+=L,tt=ae.fromValues[st],rt=De.v0!=null?De.v0:De.v0=F.is.arr(we.velocity)?we.velocity[st]:we.velocity,Xe,dt=we.precision||(tt==Ke?.005:Math.min(1,Math.abs(Ke-tt)*.001));if(F.is.und(we.duration))if(we.decay){let et=we.decay===!0?.998:we.decay,ut=Math.exp(-(1-et)*We);ct=tt+rt/(1-et)*(1-ut),bt=Math.abs(De.lastPosition-ct)<=dt,Xe=rt*ut}else{Xe=De.lastVelocity==null?rt:De.lastVelocity;let et=we.restVelocity||dt/10,ut=we.clamp?0:we.bounce,Fn=!F.is.und(ut),Ia=tt==Ke?De.v0>0:tt<Ke,It,Sn=!1,yn=1,Kr=Math.ceil(L/yn);for(let ga=0;ga<Kr&&(It=Math.abs(Xe)>et,!(!It&&(bt=Math.abs(Ke-ct)<=dt,bt)));++ga){Fn&&(Sn=ct==Ke||ct>Ke==Ia,Sn&&(Xe=-Xe*ut,ct=Ke));let ji=-we.tension*1e-6*(ct-Ke),Qn=-we.friction*.001*Xe,at=(ji+Qn)/we.mass;Xe=Xe+at*yn,ct=ct+Xe*yn}}else{let et=1;we.duration>0&&(this._memoizedDuration!==we.duration&&(this._memoizedDuration=we.duration,De.durationProgress>0&&(De.elapsedTime=we.duration*De.durationProgress,We=De.elapsedTime+=L)),et=(we.progress||0)+We/this._memoizedDuration,et=et>1?1:et<0?0:et,De.durationProgress=et),ct=tt+we.easing(et)*(Ke-tt),Xe=(ct-De.lastPosition)/L,bt=et==1}De.lastVelocity=Xe,Number.isNaN(ct)&&(console.warn("Got NaN while animating:",this),bt=!0)}Oe&&!Oe[st].done&&(bt=!1),bt?De.done=!0:W=!1,De.setValue(ct,we.round)&&(J=!0)});let Ee=(0,Y.getAnimated)(this),Ce=Ee.getValue();if(W){let De=(0,F.getFluidValue)(ae.to);(Ce!==De||J)&&!we.decay?(Ee.setValue(De),this._onChange(De)):J&&we.decay&&this._onChange(Ce),this._stop()}else J&&this._onChange(Ce)}set(L){return F.raf.batchedUpdates(()=>{this._stop(),this._focus(L),this._set(L)}),this}pause(){this._update({pause:!0})}resume(){this._update({pause:!1})}finish(){if(Or(this)){let{to:L,config:W}=this.animation;F.raf.batchedUpdates(()=>{this._onStart(),W.decay||this._set(L,!1),this._stop()})}return this}update(L){return(this.queue||(this.queue=[])).push(L),this}start(L,W){let J;return F.is.und(L)?(J=this.queue||[],this.queue=[]):J=[F.is.obj(L)?L:{...W,to:L}],Promise.all(J.map(ae=>this._update(ae))).then(ae=>Ne(this,ae))}stop(L){let{to:W}=this.animation;return this._focus(this.get()),it(this._state,L&&this._lastCallId),F.raf.batchedUpdates(()=>this._stop(W,L)),this}reset(){this._update({reset:!0})}eventObserved(L){L.type=="change"?this._start():L.type=="priority"&&(this.priority=L.priority+1)}_prepareNode(L){let W=this.key||"",{to:J,from:ae}=L;J=F.is.obj(J)?J[W]:J,(J==null||D(J))&&(J=void 0),ae=F.is.obj(ae)?ae[W]:ae,ae==null&&(ae=void 0);let ye={to:J,from:ae};return Ha(this)||(L.reverse&&([J,ae]=[ae,J]),ae=(0,F.getFluidValue)(ae),F.is.und(ae)?(0,Y.getAnimated)(this)||this._set(J):this._set(ae)),ye}_update({...L},W){let{key:J,defaultProps:ae}=this;L.default&&Object.assign(ae,S(L,(Oe,Ee)=>/^on/.test(Ee)?b(Oe,J):Oe)),Om(this,L,"onProps"),eu(this,"onProps",L,this);let ye=this._prepareNode(L);if(Object.isFrozen(this))throw Error("Cannot animate a `SpringValue` object that is frozen. Did you forget to pass your component to `animated(...)` before animating its props?");let we=this._state;return pe(++this._lastCallId,{key:J,props:L,defaultProps:ae,state:we,actions:{pause:()=>{Fi(this)||(fo(this,!0),(0,F.flushCalls)(we.pauseQueue),eu(this,"onPause",Le(this,Bi(this,this.animation.to)),this))},resume:()=>{Fi(this)&&(fo(this,!1),Or(this)&&this._resume(),(0,F.flushCalls)(we.resumeQueue),eu(this,"onResume",Le(this,Bi(this,this.animation.to)),this))},start:this._merge.bind(this,ye)}}).then(Oe=>{if(L.loop&&Oe.finished&&!(W&&Oe.noop)){let Ee=Fs(L);if(Ee)return this._update(Ee,!0)}return Oe})}_merge(L,W,J){if(W.cancel)return this.stop(!0),J(He(this));let ae=!F.is.und(L.to),ye=!F.is.und(L.from);if(ae||ye)if(W.callId>this._lastToId)this._lastToId=W.callId;else return J(He(this));let{key:we,defaultProps:Oe,animation:Ee}=this,{to:Ce,from:De}=Ee,{to:st=Ce,from:Ke=De}=L;ye&&!ae&&(!W.default||F.is.und(st))&&(st=Ke),W.reverse&&([st,Ke]=[Ke,st]);let bt=!(0,F.isEqual)(Ke,De);bt&&(Ee.from=Ke),Ke=(0,F.getFluidValue)(Ke);let ct=!(0,F.isEqual)(st,Ce);ct&&this._focus(st);let We=D(W.to),{config:tt}=Ee,{decay:rt,velocity:Xe}=tt;(ae||ye)&&(tt.velocity=0),W.config&&!We&&re(tt,y(W.config,we),W.config!==Oe.config?y(Oe.config,we):void 0);let dt=(0,Y.getAnimated)(this);if(!dt||F.is.und(st))return J(Le(this,!0));let et=F.is.und(W.reset)?ye&&!W.default:!F.is.und(Ke)&&x(W.reset,we),ut=et?Ke:this.get(),Fn=P(st),Ia=F.is.num(Fn)||F.is.arr(Fn)||(0,F.isAnimatedString)(Fn),It=!We&&(!Ia||x(Oe.immediate||W.immediate,we));if(ct){let ga=(0,Y.getAnimatedType)(st);if(ga!==dt.constructor)if(It)dt=this._set(Fn);else throw Error(`Cannot animate between ${dt.constructor.name} and ${ga.name}, as the "to" prop suggests`)}let Sn=dt.constructor,yn=(0,F.hasFluidValue)(st),Kr=!1;if(!yn){let ga=et||!Ha(this)&&bt;(ct||ga)&&(Kr=(0,F.isEqual)(P(ut),Fn),yn=!Kr),(!(0,F.isEqual)(Ee.immediate,It)&&!It||!(0,F.isEqual)(tt.decay,rt)||!(0,F.isEqual)(tt.velocity,Xe))&&(yn=!0)}if(Kr&&Or(this)&&(Ee.changed&&!et?yn=!0:yn||this._stop(Ce)),!We&&((yn||(0,F.hasFluidValue)(Ce))&&(Ee.values=dt.getPayload(),Ee.toValues=(0,F.hasFluidValue)(st)?null:Sn==Y.AnimatedString?[1]:(0,F.toArray)(Fn)),Ee.immediate!=It&&(Ee.immediate=It,!It&&!et&&this._set(Ce)),yn)){let{onRest:ga}=Ee;(0,F.each)(Lp,Qn=>Om(this,W,Qn));let ji=Le(this,Bi(this,Ce));(0,F.flushCalls)(this._pendingCalls,ji),this._pendingCalls.add(J),Ee.changed&&F.raf.batchedUpdates(()=>{var Qn;Ee.changed=!et,ga?.(ji,this),et?y(Oe.onRest,ji):(Qn=Ee.onStart)==null||Qn.call(Ee,ji,this)})}et&&this._set(ut),We?J(Me(W.to,W,this._state,this)):yn?this._start():Or(this)&&!ct?this._pendingCalls.add(J):J(Ie(ut))}_focus(L){let W=this.animation;L!==W.to&&((0,F.getFluidObservers)(this)&&this._detach(),W.to=L,(0,F.getFluidObservers)(this)&&this._attach())}_attach(){let L=0,{to:W}=this.animation;(0,F.hasFluidValue)(W)&&((0,F.addFluidObserver)(W,this),Vt(W)&&(L=W.priority+1)),this.priority=L}_detach(){let{to:L}=this.animation;(0,F.hasFluidValue)(L)&&(0,F.removeFluidObserver)(L,this)}_set(L,W=!0){let J=(0,F.getFluidValue)(L);if(!F.is.und(J)){let ae=(0,Y.getAnimated)(this);if(!ae||!(0,F.isEqual)(J,ae.getValue())){let ye=(0,Y.getAnimatedType)(J);!ae||ae.constructor!=ye?(0,Y.setAnimated)(this,ye.create(J)):ae.setValue(J),ae&&F.raf.batchedUpdates(()=>{this._onChange(J,W)})}}return(0,Y.getAnimated)(this)}_onStart(){let L=this.animation;L.changed||(L.changed=!0,eu(this,"onStart",Le(this,Bi(this,L.to)),this))}_onChange(L,W){W||(this._onStart(),y(this.animation.onChange,L,this)),y(this.defaultProps.onChange,L,this),super._onChange(L,W)}_start(){let L=this.animation;(0,Y.getAnimated)(this).reset((0,F.getFluidValue)(L.to)),L.immediate||(L.fromValues=L.values.map(W=>W.lastPosition)),Or(this)||(Ds(this,!0),Fi(this)||this._resume())}_resume(){F.Globals.skipAnimation?this.finish():F.frameLoop.start(this)}_stop(L,W){if(Or(this)){Ds(this,!1);let J=this.animation;(0,F.each)(J.values,ye=>{ye.done=!0}),J.toValues&&(J.onChange=J.onPause=J.onResume=void 0),(0,F.callFluidObservers)(this,{type:"idle",parent:this});let ae=W?He(this.get()):Le(this.get(),Bi(this,L??J.to));(0,F.flushCalls)(this._pendingCalls,ae),J.changed&&(J.changed=!1,eu(this,"onRest",ae,this))}}};function Bi(L,W){let J=P(W),ae=P(L.get());return(0,F.isEqual)(ae,J)}function Fs(L,W=L.loop,J=L.to){let ae=y(W);if(ae){let ye=ae!==!0&&E(ae),we=(ye||L).reverse,Oe=!ye||ye.reset;return go({...L,loop:W,default:!1,pause:void 0,to:!we||D(J)?J:void 0,from:Oe?L.from:void 0,reset:Oe,...ye})}}function go(L){let{to:W,from:J}=L=E(L),ae=new Set;return F.is.obj(W)&&Na(W,ae),F.is.obj(J)&&Na(J,ae),L.keys=ae.size?Array.from(ae):null,L}function Pp(L){let W=go(L);return F.is.und(W.default)&&(W.default=S(W)),W}function Na(L,W){(0,F.eachProp)(L,(J,ae)=>J!=null&&W.add(ae))}var Lp=["onStart","onRest","onChange","onPause","onResume"];function Om(L,W,J){L.animation[J]=W[J]!==v(W,J)?b(W[J],L.key):void 0}function eu(L,W,...J){var ae,ye,we,Oe;(ye=(ae=L.animation)[W])==null||ye.call(ae,...J),(Oe=(we=L.defaultProps)[W])==null||Oe.call(we,...J)}var $t=Ft,$m=["onStart","onChange","onRest"],Rm=1,Dp=class{constructor(L,W){this.id=Rm++,this.springs={},this.queue=[],this._lastAsyncId=0,this._active=new Set,this._changed=new Set,this._started=!1,this._state={paused:!1,pauseQueue:new Set,resumeQueue:new Set,timeouts:new Set},this._events={onStart:new Map,onChange:new Map,onRest:new Map},this._onFrame=this._onFrame.bind(this),W&&(this._flush=W),L&&this.start({default:!0,...L})}get idle(){return!this._state.asyncTo&&Object.values(this.springs).every(L=>L.idle&&!L.isDelayed&&!L.isPaused)}get item(){return this._item}set item(L){this._item=L}get(){let L={};return this.each((W,J)=>L[J]=W.get()),L}set(L){for(let W in L){let J=L[W];$t.is.und(J)||this.springs[W].set(J)}}update(L){return L&&this.queue.push(go(L)),this}start(L){let{queue:W}=this;return L?W=(0,$t.toArray)(L).map(go):this.queue=[],this._flush?this._flush(this,W):(Bp(this,W),tu(this,W))}stop(L,W){if(L!==!!L&&(W=L),W){let J=this.springs;(0,$t.each)((0,$t.toArray)(W),ae=>J[ae].stop(!!L))}else it(this._state,this._lastAsyncId),this.each(J=>J.stop(!!L));return this}pause(L){if($t.is.und(L))this.start({pause:!0});else{let W=this.springs;(0,$t.each)((0,$t.toArray)(L),J=>W[J].pause())}return this}resume(L){if($t.is.und(L))this.start({pause:!1});else{let W=this.springs;(0,$t.each)((0,$t.toArray)(L),J=>W[J].resume())}return this}each(L){(0,$t.eachProp)(this.springs,L)}_onFrame(){let{onStart:L,onChange:W,onRest:J}=this._events,ae=this._active.size>0,ye=this._changed.size>0;(ae&&!this._started||ye&&!this._started)&&(this._started=!0,(0,$t.flush)(L,([Ee,Ce])=>{Ce.value=this.get(),Ee(Ce,this,this._item)}));let we=!ae&&this._started,Oe=ye||we&&J.size?this.get():null;ye&&W.size&&(0,$t.flush)(W,([Ee,Ce])=>{Ce.value=Oe,Ee(Ce,this,this._item)}),we&&(this._started=!1,(0,$t.flush)(J,([Ee,Ce])=>{Ce.value=Oe,Ee(Ce,this,this._item)}))}eventObserved(L){if(L.type=="change")this._changed.add(L.parent),L.idle||this._active.add(L.parent);else if(L.type=="idle")this._active.delete(L.parent);else return;$t.raf.onFrame(this._onFrame)}};function tu(L,W){return Promise.all(W.map(J=>Fp(L,J))).then(J=>Ne(L,J))}async function Fp(L,W,J){let{keys:ae,to:ye,from:we,loop:Oe,onRest:Ee,onResolve:Ce}=W,De=$t.is.obj(W.default)&&W.default;Oe&&(W.loop=!1),ye===!1&&(W.to=null),we===!1&&(W.from=null);let st=$t.is.arr(ye)||$t.is.fun(ye)?ye:void 0;st?(W.to=void 0,W.onRest=void 0,De&&(De.onRest=void 0)):(0,$t.each)($m,tt=>{let rt=W[tt];if($t.is.fun(rt)){let Xe=L._events[tt];W[tt]=({finished:dt,cancelled:et})=>{let ut=Xe.get(rt);ut?(dt||(ut.finished=!1),et&&(ut.cancelled=!0)):Xe.set(rt,{value:null,finished:dt||!1,cancelled:et||!1})},De&&(De[tt]=W[tt])}});let Ke=L._state;W.pause===!Ke.paused?(Ke.paused=W.pause,(0,$t.flushCalls)(W.pause?Ke.pauseQueue:Ke.resumeQueue)):Ke.paused&&(W.pause=!0);let bt=(ae||Object.keys(L.springs)).map(tt=>L.springs[tt].start(W)),ct=W.cancel===!0||v(W,"cancel")===!0;(st||ct&&Ke.asyncId)&&bt.push(pe(++L._lastAsyncId,{props:W,state:Ke,actions:{pause:$t.noop,resume:$t.noop,start(tt,rt){ct?(it(Ke,L._lastAsyncId),rt(He(L))):(tt.onRest=Ee,rt(Me(st,tt,Ke,L)))}}})),Ke.paused&&await new Promise(tt=>{Ke.resumeQueue.add(tt)});let We=Ne(L,await Promise.all(bt));if(Oe&&We.finished&&!(J&&We.noop)){let tt=Fs(W,Oe,ye);if(tt)return Bp(L,[tt]),Fp(L,tt,!0)}return Ce&&$t.raf.batchedUpdates(()=>Ce(We,L,L.item)),We}function Sc(L,W){let J={...L.springs};return W&&(0,$t.each)((0,$t.toArray)(W),ae=>{$t.is.und(ae.keys)&&(ae=go(ae)),$t.is.obj(ae.to)||(ae={...ae,to:void 0}),Pm(J,ae,ye=>Am(ye))}),Mm(L,J),J}function Mm(L,W){(0,$t.eachProp)(W,(J,ae)=>{L.springs[ae]||(L.springs[ae]=J,(0,$t.addFluidObserver)(J,L))})}function Am(L,W){let J=new rn;return J.key=L,W&&(0,$t.addFluidObserver)(J,W),J}function Pm(L,W,J){W.keys&&(0,$t.each)(W.keys,ae=>{(L[ae]||(L[ae]=J(ae)))._prepareNode(W)})}function Bp(L,W){(0,$t.each)(W,J=>{Pm(L.springs,J,ae=>Am(ae,L))})}var Cc=c(R),J2=R,ew=Ft,zi=({children:L,...W})=>{let J=(0,J2.useContext)(Nc),ae=W.pause||!!J.pause,ye=W.immediate||!!J.immediate;W=(0,ew.useMemoOne)(()=>({pause:ae,immediate:ye}),[ae,ye]);let{Provider:we}=Nc;return Cc.createElement(we,{value:W},L)},Nc=tw(zi,{});zi.Provider=Nc.Provider,zi.Consumer=Nc.Consumer;function tw(L,W){return Object.assign(L,Cc.createContext(W)),L.Provider._context=L,L.Consumer._context=L,L}var Ta=Ft,Tc=()=>{let L=[],W=function(ae){(0,Ta.deprecateDirectCall)();let ye=[];return(0,Ta.each)(L,(we,Oe)=>{if(Ta.is.und(ae))ye.push(we.start());else{let Ee=J(ae,we,Oe);Ee&&ye.push(we.start(Ee))}}),ye};W.current=L,W.add=function(ae){L.includes(ae)||L.push(ae)},W.delete=function(ae){let ye=L.indexOf(ae);~ye&&L.splice(ye,1)},W.pause=function(){return(0,Ta.each)(L,ae=>ae.pause(...arguments)),this},W.resume=function(){return(0,Ta.each)(L,ae=>ae.resume(...arguments)),this},W.set=function(ae){(0,Ta.each)(L,(ye,we)=>{let Oe=Ta.is.fun(ae)?ae(we,ye):ae;Oe&&ye.set(Oe)})},W.start=function(ae){let ye=[];return(0,Ta.each)(L,(we,Oe)=>{if(Ta.is.und(ae))ye.push(we.start());else{let Ee=this._getProps(ae,we,Oe);Ee&&ye.push(we.start(Ee))}}),ye},W.stop=function(){return(0,Ta.each)(L,ae=>ae.stop(...arguments)),this},W.update=function(ae){return(0,Ta.each)(L,(ye,we)=>ye.update(this._getProps(ae,ye,we))),this};let J=function(ae,ye,we){return Ta.is.fun(ae)?ae(we,ye):ae};return W._getProps=J,W};function zp(L,W,J){let ae=q.is.fun(W)&&W;ae&&!J&&(J=[]);let ye=(0,Z.useMemo)(()=>ae||arguments.length==3?Tc():void 0,[]),we=(0,Z.useRef)(0),Oe=(0,q.useForceUpdate)(),Ee=(0,Z.useMemo)(()=>({ctrls:[],queue:[],flush(Xe,dt){let et=Sc(Xe,dt);return we.current>0&&!Ee.queue.length&&!Object.keys(et).some(ut=>!Xe.springs[ut])?tu(Xe,dt):new Promise(ut=>{Mm(Xe,et),Ee.queue.push(()=>{ut(tu(Xe,dt))}),Oe()})}}),[]),Ce=(0,Z.useRef)([...Ee.ctrls]),De=[],st=(0,q.usePrev)(L)||0;(0,Z.useMemo)(()=>{(0,q.each)(Ce.current.slice(L,st),Xe=>{V(Xe,ye),Xe.stop(!0)}),Ce.current.length=L,Ke(st,L)},[L]),(0,Z.useMemo)(()=>{Ke(0,Math.min(st,L))},J);function Ke(Xe,dt){for(let et=Xe;et<dt;et++){let ut=Ce.current[et]||(Ce.current[et]=new Dp(null,Ee.flush)),Fn=ae?ae(et,ut):W[et];Fn&&(De[et]=Pp(Fn))}}let bt=Ce.current.map((Xe,dt)=>Sc(Xe,De[dt])),ct=(0,Z.useContext)(zi),We=(0,q.usePrev)(ct),tt=ct!==We&&A(ct);(0,q.useIsomorphicLayoutEffect)(()=>{we.current++,Ee.ctrls=Ce.current;let{queue:Xe}=Ee;Xe.length&&(Ee.queue=[],(0,q.each)(Xe,dt=>dt())),(0,q.each)(Ce.current,(dt,et)=>{ye?.add(dt),tt&&dt.start({default:ct});let ut=De[et];ut&&(z(dt,ut.ref),dt.ref?dt.queue.push(ut):dt.start(ut))})}),(0,q.useOnce)(()=>()=>{(0,q.each)(Ee.ctrls,Xe=>Xe.stop(!0))});let rt=bt.map(Xe=>({...Xe}));return ye?[rt,ye]:rt}function nu(L,W){let J=X.is.fun(L),[[ae],ye]=zp(1,J?L:[L],J?W||[]:W);return J||arguments.length==2?[ae,ye]:ae}var nw=R,rw=()=>Tc(),aw=()=>(0,nw.useState)(rw)[0],Lm=Ft,iw=(L,W)=>{let J=(0,Lm.useConstant)(()=>new rn(L,W));return(0,Lm.useOnce)(()=>()=>{J.stop()}),J},Ic=Ft;function Dm(L,W,J){let ae=Ic.is.fun(W)&&W;ae&&!J&&(J=[]);let ye=!0,we,Oe=zp(L,(Ee,Ce)=>{let De=ae?ae(Ee,Ce):W;return we=De.ref,ye=ye&&De.reverse,De},J||[{}]);if((0,Ic.useIsomorphicLayoutEffect)(()=>{(0,Ic.each)(Oe[1].current,(Ee,Ce)=>{let De=Oe[1].current[Ce+(ye?1:-1)];if(z(Ee,we),Ee.ref){De&&Ee.update({to:De.springs});return}De?Ee.start({to:De.springs}):Ee.start()})},J),ae||arguments.length==3){let Ee=we??Oe[1];return Ee._getProps=(Ce,De,st)=>{let Ke=Ic.is.fun(Ce)?Ce(st,De):Ce;if(Ke){let bt=Ee.current[st+(Ke.reverse?1:-1)];return bt&&(Ke.to=bt.springs),Ke}},Oe}return Oe[0]}var jp=c(R),Go=R,Mt=Ft;function Ec(L,W,J){let ae=Mt.is.fun(W)&&W,{reset:ye,sort:we,trail:Oe=0,expires:Ee=!0,exitBeforeEnter:Ce=!1,onDestroyed:De,ref:st,config:Ke}=ae?ae():W,bt=(0,Go.useMemo)(()=>ae||arguments.length==3?Tc():void 0,[]),ct=(0,Mt.toArray)(L),We=[],tt=(0,Go.useRef)(null),rt=ye?null:tt.current;(0,Mt.useIsomorphicLayoutEffect)(()=>{tt.current=We}),(0,Mt.useOnce)(()=>((0,Mt.each)(We,at=>{bt?.add(at.ctrl),at.ctrl.ref=bt}),()=>{(0,Mt.each)(tt.current,at=>{at.expired&&clearTimeout(at.expirationId),V(at.ctrl,bt),at.ctrl.stop(!0)})}));let Xe=ow(ct,ae?ae():W,rt),dt=ye&&tt.current||[];(0,Mt.useIsomorphicLayoutEffect)(()=>(0,Mt.each)(dt,({ctrl:at,item:yt,key:Zn})=>{V(at,bt),y(De,yt,Zn)}));let et=[];if(rt&&(0,Mt.each)(rt,(at,yt)=>{at.expired?(clearTimeout(at.expirationId),dt.push(at)):(yt=et[yt]=Xe.indexOf(at.key),~yt&&(We[yt]=at))}),(0,Mt.each)(ct,(at,yt)=>{We[yt]||(We[yt]={key:Xe[yt],item:at,phase:"mount",ctrl:new Dp},We[yt].ctrl.item=at)}),et.length){let at=-1,{leave:yt}=ae?ae():W;(0,Mt.each)(et,(Zn,Jn)=>{let qt=rt[Jn];~Zn?(at=We.indexOf(qt),We[at]={...qt,item:ct[Zn]}):yt&&We.splice(++at,0,qt)})}Mt.is.fun(we)&&We.sort((at,yt)=>we(at.item,yt.item));let ut=-Oe,Fn=(0,Mt.useForceUpdate)(),Ia=S(W),It=new Map,Sn=(0,Go.useRef)(new Map),yn=(0,Go.useRef)(!1);(0,Mt.each)(We,(at,yt)=>{let Zn=at.key,Jn=at.phase,qt=ae?ae():W,hn,$r,Vi=y(qt.delay||0,Zn);if(Jn=="mount")hn=qt.enter,$r="enter";else{let ma=Xe.indexOf(Zn)<0;if(Jn!="leave")if(ma)hn=qt.leave,$r="leave";else if(hn=qt.update)$r="update";else return;else if(!ma)hn=qt.enter,$r="enter";else return}if(hn=y(hn,at.item,yt),hn=Mt.is.obj(hn)?E(hn):{to:hn},!hn.config){let ma=Ke||Ia.config;hn.config=y(ma,at.item,yt,$r)}ut+=Oe;let Rr={...Ia,delay:Vi+ut,ref:st,immediate:qt.immediate,reset:!1,...hn};if($r=="enter"&&Mt.is.und(Rr.from)){let ma=ae?ae():W,Yo=Mt.is.und(ma.initial)||rt?ma.from:ma.initial;Rr.from=y(Yo,at.item,yt)}let{onResolve:Xo}=Rr;Rr.onResolve=ma=>{y(Xo,ma);let Yo=tt.current,Bn=Yo.find(Mr=>Mr.key===Zn);if(Bn&&!(ma.cancelled&&Bn.phase!="update")&&Bn.ctrl.idle){let Mr=Yo.every(Bt=>Bt.ctrl.idle);if(Bn.phase=="leave"){let Bt=y(Ee,Bn.item);if(Bt!==!1){let Qo=Bt===!0?0:Bt;if(Bn.expired=!0,!Mr&&Qo>0){Qo<=2147483647&&(Bn.expirationId=setTimeout(Fn,Qo));return}}}Mr&&Yo.some(Bt=>Bt.expired)&&(Sn.current.delete(Bn),Ce&&(yn.current=!0),Fn())}};let Up=Sc(at.ctrl,Rr);$r==="leave"&&Ce?Sn.current.set(at,{phase:$r,springs:Up,payload:Rr}):It.set(at,{phase:$r,springs:Up,payload:Rr})});let Kr=(0,Go.useContext)(zi),ga=(0,Mt.usePrev)(Kr),ji=Kr!==ga&&A(Kr);(0,Mt.useIsomorphicLayoutEffect)(()=>{ji&&(0,Mt.each)(We,at=>{at.ctrl.start({default:Kr})})},[Kr]),(0,Mt.each)(It,(at,yt)=>{if(Sn.current.size){let Zn=We.findIndex(Jn=>Jn.key===yt.key);We.splice(Zn,1)}}),(0,Mt.useIsomorphicLayoutEffect)(()=>{(0,Mt.each)(Sn.current.size?Sn.current:It,({phase:at,payload:yt},Zn)=>{let{ctrl:Jn}=Zn;Zn.phase=at,bt?.add(Jn),ji&&at=="enter"&&Jn.start({default:Kr}),yt&&(z(Jn,yt.ref),(Jn.ref||bt)&&!yn.current?Jn.update(yt):(Jn.start(yt),yn.current&&(yn.current=!1)))})},ye?void 0:J);let Qn=at=>jp.createElement(jp.Fragment,null,We.map((yt,Zn)=>{let{springs:Jn}=It.get(yt)||yt.ctrl,qt=at({...Jn},yt.item,yt,Zn);return qt&&qt.type?jp.createElement(qt.type,{...qt.props,key:Mt.is.str(yt.key)||Mt.is.num(yt.key)?yt.key:yt.ctrl.id,ref:qt.ref}):qt}));return bt?[Qn,bt]:Qn}var Vp=1;function ow(L,{key:W,keys:J=W},ae){if(J===null){let ye=new Set;return L.map(we=>{let Oe=ae&&ae.find(Ee=>Ee.item===we&&Ee.phase!=="leave"&&!ye.has(Ee));return Oe?(ye.add(Oe),Oe.key):Vp++})}return Mt.is.und(J)?L:Mt.is.fun(J)?L.map(J):(0,Mt.toArray)(J)}var ru=Ft,Bs=({container:L,...W}={})=>{let[J,ae]=nu(()=>({scrollX:0,scrollY:0,scrollXProgress:0,scrollYProgress:0,...W}),[]);return(0,ru.useIsomorphicLayoutEffect)(()=>{let ye=(0,ru.onScroll)(({x:we,y:Oe})=>{ae.start({scrollX:we.current,scrollXProgress:we.progress,scrollY:Oe.current,scrollYProgress:Oe.progress})},{container:L?.current||void 0});return()=>{(0,ru.each)(Object.values(J),we=>we.stop()),ye()}},[]),J},li=Ft,an=({container:L,...W})=>{let[J,ae]=nu(()=>({width:0,height:0,...W}),[]);return(0,li.useIsomorphicLayoutEffect)(()=>{let ye=(0,li.onResize)(({width:we,height:Oe})=>{ae.start({width:we,height:Oe,immediate:J.width.get()===0||J.height.get()===0})},{container:L?.current||void 0});return()=>{(0,li.each)(Object.values(J),we=>we.stop()),ye()}},[]),J},Qt=R,ui=Ft,br={any:0,all:1};function Hr(L,W){let[J,ae]=(0,Qt.useState)(!1),ye=(0,Qt.useRef)(),we=ui.is.fun(L)&&L,Oe=we?we():{},{to:Ee={},from:Ce={},...De}=Oe,st=we?W:L,[Ke,bt]=nu(()=>({from:Ce,...De}),[]);return(0,ui.useIsomorphicLayoutEffect)(()=>{let ct=ye.current,{root:We,once:tt,amount:rt="any",...Xe}=st??{};if(!ct||tt&&J||typeof IntersectionObserver>"u")return;let dt=new WeakMap,et=()=>(Ee&&bt.start(Ee),ae(!0),tt?void 0:()=>{Ce&&bt.start(Ce),ae(!1)}),ut=Ia=>{Ia.forEach(It=>{let Sn=dt.get(It.target);if(It.isIntersecting!==!!Sn)if(It.isIntersecting){let yn=et();ui.is.fun(yn)?dt.set(It.target,yn):Fn.unobserve(It.target)}else Sn&&(Sn(),dt.delete(It.target))})},Fn=new IntersectionObserver(ut,{root:We&&We.current||void 0,threshold:typeof rt=="number"||Array.isArray(rt)?rt:br[rt],...Xe});return Fn.observe(ct),()=>Fn.unobserve(ct)},[st]),we?[ye,Ke]:[ye,J]}function Ho({children:L,...W}){return L(nu(W))}var zs=Ft;function qr({items:L,children:W,...J}){let ae=Dm(L.length,J);return L.map((ye,we)=>{let Oe=W(ye,we);return zs.is.fun(Oe)?Oe(ae[we]):Oe})}function _c({items:L,children:W,...J}){return Ec(L,J)(W)}var Fm=Ft,kn=Ft,mo=Cm,au=class extends Yt{constructor(L,W){super(),this.source=L,this.idle=!0,this._active=new Set,this.calc=(0,kn.createInterpolator)(...W);let J=this._get(),ae=(0,mo.getAnimatedType)(J);(0,mo.setAnimated)(this,ae.create(J))}advance(L){let W=this._get(),J=this.get();(0,kn.isEqual)(W,J)||((0,mo.getAnimated)(this).setValue(W),this._onChange(W,this.idle)),!this.idle&&Bm(this._active)&&Wp(this)}_get(){let L=kn.is.arr(this.source)?this.source.map(kn.getFluidValue):(0,kn.toArray)((0,kn.getFluidValue)(this.source));return this.calc(...L)}_start(){this.idle&&!Bm(this._active)&&(this.idle=!1,(0,kn.each)((0,mo.getPayload)(this),L=>{L.done=!1}),kn.Globals.skipAnimation?(kn.raf.batchedUpdates(()=>this.advance()),Wp(this)):kn.frameLoop.start(this))}_attach(){let L=1;(0,kn.each)((0,kn.toArray)(this.source),W=>{(0,kn.hasFluidValue)(W)&&(0,kn.addFluidObserver)(W,this),Vt(W)&&(W.idle||this._active.add(W),L=Math.max(L,W.priority+1))}),this.priority=L,this._start()}_detach(){(0,kn.each)((0,kn.toArray)(this.source),L=>{(0,kn.hasFluidValue)(L)&&(0,kn.removeFluidObserver)(L,this)}),this._active.clear(),Wp(this)}eventObserved(L){L.type=="change"?L.idle?this.advance():(this._active.add(L.parent),this._start()):L.type=="idle"?this._active.delete(L.parent):L.type=="priority"&&(this.priority=(0,kn.toArray)(this.source).reduce((W,J)=>Math.max(W,(Vt(J)?J.priority:0)+1),0))}};function qa(L){return L.idle!==!1}function Bm(L){return!L.size||Array.from(L).every(qa)}function Wp(L){L.idle||(L.idle=!0,(0,kn.each)((0,mo.getPayload)(L),W=>{W.done=!0}),(0,kn.callFluidObservers)(L,{type:"idle",parent:L}))}var sw=(L,...W)=>new au(L,W),Oc=(L,...W)=>((0,Fm.deprecateInterpolate)(),new au(L,W)),qo=Ft;qo.Globals.assign({createStringInterpolator:qo.createStringInterpolator,to:(L,W)=>new au(L,W)});var iu=qo.frameLoop.advance,Ko=Ft;u(p,jEe(),t.exports)})(rB);var VEe=rB.exports;nB.exports=VEe;var lz=nB.exports;(function(t){var e=Object.defineProperty,n=Object.getOwnPropertyDescriptor,r=Object.getOwnPropertyNames,a=Object.prototype.hasOwnProperty,i=(q,F)=>{for(var Y in F)e(q,Y,{get:F[Y],enumerable:!0})},o=(q,F,Y,Q)=>{if(F&&typeof F=="object"||typeof F=="function")for(let ne of r(F))!a.call(q,ne)&&ne!==Y&&e(q,ne,{get:()=>F[ne],enumerable:!(Q=n(F,ne))||Q.enumerable});return q},s=(q,F,Y)=>(o(q,F,"default"),Y&&o(Y,F,"default")),l=q=>o(e({},"__esModule",{value:!0}),q),u={};i(u,{a:()=>Z,animated:()=>Z}),t.exports=l(u);var c=lz,d=X1,p=Ft,f=Cm,m=/^--/;function y(q,F){return F==null||typeof F=="boolean"||F===""?"":typeof F=="number"&&F!==0&&!m.test(q)&&!(v.hasOwnProperty(q)&&v[q])?F+"px":(""+F).trim()}var x={};function b(q,F){if(!q.nodeType||!q.setAttribute)return!1;let Y=q.nodeName==="filter"||q.parentNode&&q.parentNode.nodeName==="filter",{style:Q,children:ne,scrollTop:le,scrollLeft:de,viewBox:re,...he}=F,ve=Object.values(he),H=Object.keys(he).map(ie=>Y||q.hasAttribute(ie)?ie:x[ie]||(x[ie]=ie.replace(/([A-Z])/g,pe=>"-"+pe.toLowerCase())));ne!==void 0&&(q.textContent=ne);for(let ie in Q)if(Q.hasOwnProperty(ie)){let pe=y(ie,Q[ie]);m.test(ie)?q.style.setProperty(ie,pe):q.style[ie]=pe}H.forEach((ie,pe)=>{q.setAttribute(ie,ve[pe])}),le!==void 0&&(q.scrollTop=le),de!==void 0&&(q.scrollLeft=de),re!==void 0&&q.setAttribute("viewBox",re)}var v={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},w=(q,F)=>q+F.charAt(0).toUpperCase()+F.substring(1),S=["Webkit","Ms","Moz","O"];v=Object.keys(v).reduce((q,F)=>(S.forEach(Y=>q[w(Y,F)]=q[F]),q),v);var C=Cm,I=Ft,_=/^(matrix|translate|scale|rotate|skew)/,E=/^(translate)/,P=/^(rotate|skew)/,A=(q,F)=>I.is.num(q)&&q!==0?q+F:q,D=(q,F)=>I.is.arr(q)?q.every(Y=>D(Y,F)):I.is.num(q)?q===F:parseFloat(q)===F,V=class extends C.AnimatedObject{constructor({x:q,y:F,z:Y,...Q}){let ne=[],le=[];(q||F||Y)&&(ne.push([q||0,F||0,Y||0]),le.push(de=>[`translate3d(${de.map(re=>A(re,"px")).join(",")})`,D(de,0)])),(0,I.eachProp)(Q,(de,re)=>{if(re==="transform")ne.push([de||""]),le.push(he=>[he,he===""]);else if(_.test(re)){if(delete Q[re],I.is.und(de))return;let he=E.test(re)?"px":P.test(re)?"deg":"";ne.push((0,I.toArray)(de)),le.push(re==="rotate3d"?([ve,H,ie,pe])=>[`rotate3d(${ve},${H},${ie},${A(pe,he)})`,D(pe,0)]:ve=>[`${re}(${ve.map(H=>A(H,he)).join(",")})`,D(ve,re.startsWith("scale")?1:0)])}}),ne.length&&(Q.transform=new z(ne,le)),super(Q)}},z=class extends I.FluidValue{constructor(q,F){super(),this.inputs=q,this.transforms=F,this._value=null}get(){return this._value||(this._value=this._get())}_get(){let q="",F=!0;return(0,I.each)(this.inputs,(Y,Q)=>{let ne=(0,I.getFluidValue)(Y[0]),[le,de]=this.transforms[Q](I.is.arr(ne)?ne:Y.map(I.getFluidValue));q+=" "+le,F=F&&de}),F?"none":q}observerAdded(q){q==1&&(0,I.each)(this.inputs,F=>(0,I.each)(F,Y=>(0,I.hasFluidValue)(Y)&&(0,I.addFluidObserver)(Y,this)))}observerRemoved(q){q==0&&(0,I.each)(this.inputs,F=>(0,I.each)(F,Y=>(0,I.hasFluidValue)(Y)&&(0,I.removeFluidObserver)(Y,this)))}eventObserved(q){q.type=="change"&&(this._value=null),(0,I.callFluidObservers)(this,q)}},K=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"];s(u,lz,t.exports),c.Globals.assign({batchedUpdates:d.unstable_batchedUpdates,createStringInterpolator:p.createStringInterpolator,colors:p.colors});var X=(0,f.createHost)(K,{applyAnimatedValues:b,createAnimatedStyle:q=>new V(q),getComponentProps:({scrollTop:q,scrollLeft:F,...Y})=>Y}),Z=X.animated})(tB);var WEe=tB.exports;eB.exports=WEe;var UEe=eB.exports;const{useState:GEe,useEffect:HEe}=R;function qEe(){const[t,e]=GEe({width:void 0,height:void 0});return HEe(()=>{function n(){e({width:window.innerWidth,height:window.innerHeight})}return window.addEventListener("resize",n),n(),()=>window.removeEventListener("resize",n)},[]),t}var KEe=qEe;const $p=R,{useSpring:XEe,animated:YEe}=UEe,QEe=KEe,Yl={maxTilt:25,rotationPower:50,swipeThreshold:.5},CE={touchResponsive:{friction:50,tension:2e3},animateOut:{friction:30,tension:400},animateBack:{friction:10,tension:200}},uz=(t,e)=>Math.sqrt(Math.pow(t,2)+Math.pow(e,2)),ZEe=t=>{const e=Math.sqrt(Math.pow(t.x,2)+Math.pow(t.y,2));return{x:t.x/e,y:t.y/e}},Nm=async(t,e,n,r)=>{const a=uz(n,r),i=uz(t.x,t.y),o=a*t.x,s=a*t.y,l=t.x*45,u=a/i;return e.start({xyrot:[o,s,l],config:{duration:u}}),await new Promise(c=>setTimeout(()=>{c()},u))},cz=t=>new Promise(e=>{t.start({xyrot:[0,0,0],config:CE.animateBack,onRest:e})}),dz=t=>{if(Math.abs(t.x)>Math.abs(t.y)){if(t.x>Yl.swipeThreshold)return"right";if(t.x<-Yl.swipeThreshold)return"left"}else{if(t.y>Yl.swipeThreshold)return"down";if(t.y<-Yl.swipeThreshold)return"up"}return"none"},JEe=YEe.div,e_e=$p.forwardRef(({flickOnSwipe:t=!0,children:e,onSwipe:n,onCardLeftScreen:r,className:a,preventSwipe:i=[],swipeRequirementType:o="velocity",swipeThreshold:s=Yl.swipeThreshold,onSwipeRequirementFulfilled:l,onSwipeRequirementUnfulfilled:u},c)=>{const{width:d,height:p}=QEe(),[{xyrot:f},m]=XEe(()=>({xyrot:[0,0,0],config:CE.touchResponsive}));Yl.swipeThreshold=s,$p.useImperativeHandle(c,()=>({async swipe(w="right"){n&&n(w);const S=1.3,C=(Math.random()-.5)/2;w==="right"?await Nm({x:S,y:C},m,d,p):w==="left"?await Nm({x:-S,y:C},m,d,p):w==="up"?await Nm({x:C,y:-S},m,d,p):w==="down"&&await Nm({x:C,y:S},m,d,p),r&&r(w)},async restoreCard(){await cz(m)}}));const y=$p.useCallback(async(w,S)=>{const C=dz({x:o==="velocity"?S.vx:S.dx,y:o==="velocity"?S.vy:S.dy});if(C!=="none"&&t&&!i.includes(C)){n&&n(C),await Nm(o==="velocity"?{x:S.vx,y:S.vy}:ZEe({x:S.dx,y:S.dy}),w,d,p),r&&r(C);return}cz(w)},[o,t,i,n,r,d,p]);let x="none";const b=(w,S,C,I)=>{let _=I?w.touches[0].clientX-S.x:w.clientX-S.x,E=I?w.touches[0].clientY-S.y:w.clientY-S.y;S.x===0&&S.y===0&&(_=0,E=0);const P=-(_-C.dx)/(C.timeStamp-Date.now()),A=-(E-C.dy)/(C.timeStamp-Date.now());return{dx:_,dy:E,vx:P,vy:A,timeStamp:Date.now()}};$p.useLayoutEffect(()=>{let w={x:0,y:0},S={dx:0,dy:0,vx:0,vy:0,timeStamp:Date.now()},C=!1;const I=z=>{!z.srcElement.className.includes("pressable")&&z.cancelable&&z.preventDefault(),S=b(z,w,S,!0),w={x:z.touches[0].clientX,y:z.touches[0].clientY}};v.current.addEventListener("touchstart",I);const _=z=>{C=!0,S=b(z,w,S,!1),w={x:z.clientX,y:z.clientY}};v.current.addEventListener("mousedown",_);const E=z=>{if(l||u){const X=dz({x:o==="velocity"?z.vx:z.dx,y:o==="velocity"?z.vy:z.dy});X!==x&&(x=X,x==="none"?u&&u():l&&l(X))}let K=z.vx*15;isNaN(K)&&(K=0),K=Math.max(Math.min(K,Yl.maxTilt),-Yl.maxTilt),m.start({xyrot:[z.dx,z.dy,K],config:CE.touchResponsive})},P=z=>{if(!C)return;const K=b(z,w,S,!1);S=K,E(K)};window.addEventListener("mousemove",P);const A=z=>{C&&(C=!1,y(m,S),w={x:0,y:0},S={dx:0,dy:0,vx:0,vy:0,timeStamp:Date.now()})};window.addEventListener("mouseup",A);const D=z=>{const K=b(z,w,S,!0);S=K,E(K)};v.current.addEventListener("touchmove",D);const V=z=>{y(m,S),w={x:0,y:0},S={dx:0,dy:0,vx:0,vy:0,timeStamp:Date.now()}};return v.current.addEventListener("touchend",V),()=>{v.current.removeEventListener("touchstart",I),v.current.removeEventListener("touchmove",D),v.current.removeEventListener("touchend",V),window.removeEventListener("mousemove",P),window.removeEventListener("mouseup",A),v.current.removeEventListener("mousedown",_)}},[y,m,l,u]);const v=$p.useRef();return $p.createElement(JEe,{ref:v,className:a,style:{transform:f.to((w,S,C)=>`translate3d(${w}px, ${S}px, 0px) rotate(${C}deg)`)},children:e})});var t_e=e_e;const n_e=gi(t_e);function si(t){return e=>typeof e=="string"&&new RegExp(t.source,t.flags).test(e)}const r_e=si(/^[1-9][0-9]*$/),NE=si(/^((Q|P|L|M)[1-9][0-9]*|L[1-9][0-9]*-(F|S)[1-9][0-9]*)$/),a_e=si(/^E[1-9][0-9]*$/),V2=si(/^Q[1-9][0-9]*$/),W2=si(/^P[1-9][0-9]*$/),pz=si(/^L[1-9][0-9]*$/),hz=si(/^L[1-9][0-9]*-F[1-9][0-9]*$/),fz=si(/^L[1-9][0-9]*-S[1-9][0-9]*$/),i_e=si(/^M[1-9][0-9]*$/),o_e=si(/^((Q|P|L|M)[1-9][0-9]*|L[1-9][0-9]*-(F|S)[1-9][0-9]*)\$[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i),s_e=si(/^[0-9a-f]{40}$/),gz=si(/^\d+$/),mz=si(/^(Q|P|L|M)[1-9][0-9]*$/);function l_e(t){if(typeof t!="string")return!1;const[e,n]=t.split("#");return NE(e)&&W2(n)}function yz(t){return typeof t!="string"?!1:t.startsWith("Item:")?V2(t.substring(5)):t.startsWith("Lexeme:")?pz(t.substring(7)):t.startsWith("Property:")?W2(t.substring(9)):V2(t)}function u_e(t){if(!mz(t))throw new Error(`invalid entity id: ${t}`);return t.replace(/^(Q|P|L|M)/,"")}function c_e(t,e){let n=`https://commons.wikimedia.org/wiki/Special:FilePath/${t}`;return typeof e=="number"&&(n+=`?width=${e}`),n}function d_e(t){const e=t.split(/[$-]/);if(e.length===6)return e[0].toUpperCase();if(e.length===7)return e.slice(0,2).join("-").toUpperCase();throw new Error(`invalid guid: ${t}`)}const p_e=Object.freeze(Object.defineProperty({__proto__:null,getEntityIdFromGuid:d_e,getImageUrl:c_e,getNumericId:u_e,isEntityId:NE,isEntityPageTitle:yz,isEntitySchemaId:a_e,isFormId:hz,isGuid:o_e,isHash:s_e,isItemId:V2,isLexemeId:pz,isMediaInfoId:i_e,isNonNestedEntityId:mz,isNumericId:r_e,isPropertyClaimsId:l_e,isPropertyId:W2,isRevisionId:gz,isSenseId:fz},Symbol.toStringTag,{value:"Module"}));function Wo(t){return typeof t=="string"?[t]:Array.isArray(t)?[...t]:[]}function bz(t){return!!t&&typeof t=="object"&&!Array.isArray(t)}const vz=t=>encodeURIComponent(t).replace(/[!'()*]/g,g_e),h_e=t=>t.replace(/\s/g,"_");function f_e(t){return Array.from(new Set(t))}const g_e=t=>"%"+t.charCodeAt(0).toString(16);function Ql(t){if(t.length!==1||!bz(t[0]))throw new Error(`Since wikibase-sdk v9.0.0, this function expects arguments to be passed in an object
    See https://github.com/maxlath/wikibase-sdk/blob/main/CHANGELOG.md`)}function Tm(t,e){return typeof e=="string"&&t.includes(e)}function TE(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function IE(t){return Object.entries(t)}function EE(t){typeof t=="object"&&(t=t.time);const e=t[0];let[n,r]=t.slice(1).split("T");n=n.replace(/-00/g,"-01");const a=`${n}T${r}`;return m_e(e,a)}const m_e=(t,e)=>{const n=e.split("-")[0];return t==="-"||n.length>4?y_e(t,e,n):new Date(e)},y_e=(t,e,n)=>{let r;return n.length===4?r=`${t}00${e}`:n.length===5?r=`${t}0${e}`:r=t+e,new Date(r)};function _E(t){return e=>{try{return t(e)}catch{e=typeof e=="string"?e:e.time;const n=e[0];let[r,a]=e.slice(1).split("T");if(!n||!r||!a)throw new Error("TimeInput is invalid: "+JSON.stringify(e));return r=r.replace(/-00/g,"-01"),`${n}${r}T${a}`}}}const b_e=t=>EE(t).getTime(),v_e=t=>EE(t).toISOString(),x_e=t=>{if(typeof t=="object"){const{time:e,precision:n}=t;n===9?t=e.replace("-01-01T","-00-00T"):n===10?t=e.replace("-01T","-00T"):t=e}return t.split("T")[0].replace(/^\+/,"").replace(/^(-?)0+/,"$1").replace(/-00$/,"").replace(/-00$/,"")},xz=_E(b_e),wz=_E(v_e),kz=_E(x_e),w_e=Object.freeze(Object.defineProperty({__proto__:null,wikibaseTimeToDateObject:EE,wikibaseTimeToEpochTime:xz,wikibaseTimeToISOString:wz,wikibaseTimeToSimpleDay:kz},Symbol.toStringTag,{value:"Module"})),Zl=t=>t.value,k_e=(t,e)=>e.keepRichValues?t.value:t.value.text,Rp=(t,e)=>C_e(t,e.entityPrefix),S_e={item:"Q",lexeme:"L",property:"P"},C_e=(t,e)=>{const{value:n}=t,r=n.id||S_e[n["entity-type"]]+n["numeric-id"];return typeof e=="string"?`${e}:${r}`:r},N_e=(t,e)=>{const{value:n}=t,r=parseFloat(n.amount);if(e.keepRichValues){const a={amount:parseFloat(n.amount),unit:n.unit.replace(/^https?:\/\/.*\/entity\//,"")};return n.upperBound!=null&&(a.upperBound=parseFloat(n.upperBound)),n.lowerBound!=null&&(a.lowerBound=parseFloat(n.lowerBound)),a}else return r},T_e=(t,e)=>e.keepRichValues?t.value:[t.value.latitude,t.value.longitude],I_e=(t,e)=>{let n;if(typeof e.timeConverter=="function"?n=e.timeConverter(t.value):n=E_e(e.timeConverter)(t.value),e.keepRichValues){const{timezone:r,before:a,after:i,precision:o,calendarmodel:s}=t.value;return{time:n,timezone:r,before:a,after:i,precision:o,calendarmodel:s}}else return n},E_e=(t="iso")=>{const e=__e[t];if(!e)throw new Error(`invalid converter key: ${JSON.stringify(t).substring(0,100)}`);return e},__e={iso:wz,epoch:xz,"simple-day":kz,none:t=>typeof t=="string"?t:t.time},O_e={commonsMedia:Zl,"external-id":Zl,"geo-shape":Zl,"globe-coordinate":T_e,math:Zl,monolingualtext:k_e,"musical-notation":Zl,quantity:N_e,string:Zl,"tabular-data":Zl,time:I_e,url:Zl,"wikibase-entityid":Rp,"wikibase-form":Rp,"wikibase-item":Rp,"wikibase-lexeme":Rp,"wikibase-property":Rp,"wikibase-sense":Rp},Sz=t=>t.toLowerCase().replace(/[\s-]/g,""),Cz={};for(const[t,e]of Object.entries(O_e))Cz[Sz(t)]=e;function $_e(t,e,n,r){t=t||e.type;try{const a=Cz[Sz(t)];return a(e,n)}catch(a){throw a.message==="parsers[datatype] is not a function"&&(a.message=`${t} claim parser isn't implemented
      Claim id: ${r}
      Please report to https://github.com/maxlath/wikibase-sdk/issues`),a}}function OE(t){const e={};for(const n of t){const{rank:r}=n;e[r]=e[r]||[],e[r].push(n)}return e.preferred||e.normal||[]}function Nz(t){return t.filter(e=>e.rank!=="deprecated")}function R_e(t){const e={};for(const[n,r]of IE(t))e[n]=OE(r);return e}const M_e=Object.freeze(Object.defineProperty({__proto__:null,nonDeprecatedPropertyClaims:Nz,truthyClaims:R_e,truthyPropertyClaims:OE},Symbol.toStringTag,{value:"Module"}));function $E(t,e){const{propertyPrefix:n}=e,r={};for(let a in t){const i=t[a];n&&(a=n+":"+a),r[a]=RE(i,e)}return r}function RE(t,e){if(t==null||t.length===0)return[];const{keepNonTruthy:n,keepNonDeprecated:r,areSubSnaks:a}=Oz(e);return r?t=Nz(t):n||a||(t=OE(t)),t=t.map(i=>ME(i,e)).filter(i=>i!==void 0),t[0]&&typeof t[0]!="object"?f_e(t):t}function Tz(t,e){const{keepQualifiers:n,keepReferences:r,keepIds:a,keepHashes:i,keepTypes:o,keepSnaktypes:s,keepRanks:l}=Oz(e),{mainsnak:u,rank:c}=t;let d,p,f,m,y,x;if(u?(p=u.datatype,f=u.datavalue,m=u.snaktype):(f=t.datavalue,p=t.datatype,m=t.snaktype,t.hash?y=!0:x=!0),f)d=$_e(p,f,e,t.id);else if(m==="somevalue")d=e.somevalueValue;else if(m==="novalue")d=e.novalueValue;else throw new Error("no datavalue or special snaktype found");if(y){if(!(i||o||s))return d;const w={value:d};return i&&(w.hash=t.hash),o&&(w.type=p),s&&(w.snaktype=m),w}if(x)return o?{type:p,value:d}:d;if(!(n||r||a||o||s||l))return d;const b={value:d};o&&(b.type=p),s&&(b.snaktype=m),l&&(b.rank=c);const v=U2(e);return v.keepHashes=i,n&&(b.qualifiers=Ez(t.qualifiers,v)),r&&(t.references=t.references||[],b.references=_z(t.references,v)),a&&(b.id=t.id),b}function Mp(t,e={}){return $E(t,e)}function Iz(t,e={}){return RE(t,e)}function ME(t,e={}){return Tz(t,e)}function Ez(t,e={}){return $E(t,U2(e))}function A_e(t,e={}){return RE(t,U2(e))}function P_e(t,e={}){return Tz(t,e)}function _z(t,e={}){return t.map(n=>L_e(n,e))}function L_e(t,e={}){const n=U2(e),r=$E(t.snaks,n);return n.keepHashes?{snaks:r,hash:t.hash}:r}const U2=(t={})=>t.areSubSnaks?t:Object.assign({},t,{areSubSnaks:!0}),D_e=["keepQualifiers","keepReferences","keepIds","keepHashes","keepTypes","keepSnaktypes","keepRanks","keepRichValues"],Oz=(t={})=>(t.keepAll&&D_e.forEach(e=>{t[e]==null&&(t[e]=!0)}),t);function Im(t){const e={};for(const[n,r]of IE(t))e[n]=r!=null?r.value:null;return e}function F_e(t){const e={};for(const[n,r]of IE(t))e[n]=r!=null?r.map(a=>a.value):[];return e}function $z(t){return Im(t)}function Rz(t){return Im(t)}function Mz(t){return F_e(t)}function Az(t){return Im(t)}function Pz(t){return Im(t)}function Lz(t){return Im(t)}const Dz=(t,e={})=>{const{id:n,representations:r,grammaticalFeatures:a,claims:i}=t;if(!hz(n))throw new Error("invalid form object");return{id:n,representations:Pz(r),grammaticalFeatures:a,claims:Mp(i,e)}},Fz=(t,e={})=>t.map(n=>Dz(n,e)),Bz=(t,e={})=>{const{id:n,glosses:r,claims:a}=t;if(!fz(n))throw new Error("invalid sense object");return{id:n,glosses:Lz(r),claims:Mp(a,e)}};function zz(t,e={}){return t.map(n=>Bz(n,e))}const AE={commonswiki:"commons",foundationwiki:"foundation",mediawikiwiki:"mediawiki",metawiki:"meta",outreachwiki:"outreach",sourceswiki:"sources",specieswiki:"species",wikidatawiki:"wikidata",wikifunctionswiki:"wikifunctions",wikimaniawiki:"wikimania"},PE=["aawiki","aawikibooks","aawiktionary","abwiki","abwiktionary","acewiki","adywiki","afwiki","afwikibooks","afwikiquote","afwiktionary","akwiki","akwikibooks","akwiktionary","alswiki","alswikibooks","alswikiquote","alswiktionary","altwiki","amiwiki","amwiki","amwikiquote","amwiktionary","angwiki","angwikibooks","angwikiquote","angwikisource","angwiktionary","anpwiki","anwiki","anwiktionary","arcwiki","arwiki","arwikibooks","arwikinews","arwikiquote","arwikisource","arwikiversity","arwiktionary","arywiki","arzwiki","astwiki","astwikibooks","astwikiquote","astwiktionary","aswiki","aswikibooks","aswikiquote","aswikisource","aswiktionary","atjwiki","avkwiki","avwiki","avwiktionary","awawiki","aywiki","aywikibooks","aywiktionary","azbwiki","azwiki","azwikibooks","azwikiquote","azwikisource","azwiktionary","banwiki","banwikisource","barwiki","bat_smgwiki","bawiki","bawikibooks","bbcwiki","bclwiki","bclwikiquote","bclwiktionary","be_x_oldwiki","bewiki","bewikibooks","bewikiquote","bewikisource","bewiktionary","bgwiki","bgwikibooks","bgwikinews","bgwikiquote","bgwikisource","bgwiktionary","bhwiki","bhwiktionary","biwiki","biwikibooks","biwiktionary","bjnwiki","bjnwikiquote","bjnwiktionary","blkwiki","blkwiktionary","bmwiki","bmwikibooks","bmwikiquote","bmwiktionary","bnwiki","bnwikibooks","bnwikiquote","bnwikisource","bnwikivoyage","bnwiktionary","bowiki","bowikibooks","bowiktionary","bpywiki","brwiki","brwikiquote","brwikisource","brwiktionary","bswiki","bswikibooks","bswikinews","bswikiquote","bswikisource","bswiktionary","btmwiktionary","bugwiki","bxrwiki","cawiki","cawikibooks","cawikinews","cawikiquote","cawikisource","cawiktionary","cbk_zamwiki","cdowiki","cebwiki","cewiki","chowiki","chrwiki","chrwiktionary","chwiki","chwikibooks","chwiktionary","chywiki","ckbwiki","ckbwiktionary","commonswiki","cowiki","cowikibooks","cowikiquote","cowiktionary","crhwiki","crwiki","crwikiquote","crwiktionary","csbwiki","csbwiktionary","cswiki","cswikibooks","cswikinews","cswikiquote","cswikisource","cswikiversity","cswiktionary","cuwiki","cvwiki","cvwikibooks","cywiki","cywikibooks","cywikiquote","cywikisource","cywiktionary","dagwiki","dawiki","dawikibooks","dawikiquote","dawikisource","dawiktionary","dewiki","dewikibooks","dewikinews","dewikiquote","dewikisource","dewikiversity","dewikivoyage","dewiktionary","dgawiki","dinwiki","diqwiki","diqwiktionary","dsbwiki","dtywiki","dvwiki","dvwiktionary","dzwiki","dzwiktionary","eewiki","elwiki","elwikibooks","elwikinews","elwikiquote","elwikisource","elwikiversity","elwikivoyage","elwiktionary","emlwiki","enwiki","enwikibooks","enwikinews","enwikiquote","enwikisource","enwikiversity","enwikivoyage","enwiktionary","eowiki","eowikibooks","eowikinews","eowikiquote","eowikisource","eowikivoyage","eowiktionary","eswiki","eswikibooks","eswikinews","eswikiquote","eswikisource","eswikiversity","eswikivoyage","eswiktionary","etwiki","etwikibooks","etwikiquote","etwikisource","etwiktionary","euwiki","euwikibooks","euwikiquote","euwikisource","euwiktionary","extwiki","fatwiki","fawiki","fawikibooks","fawikinews","fawikiquote","fawikisource","fawikivoyage","fawiktionary","ffwiki","fiu_vrowiki","fiwiki","fiwikibooks","fiwikinews","fiwikiquote","fiwikisource","fiwikiversity","fiwikivoyage","fiwiktionary","fjwiki","fjwiktionary","fonwiki","foundationwiki","fowiki","fowikisource","fowiktionary","frpwiki","frrwiki","frwiki","frwikibooks","frwikinews","frwikiquote","frwikisource","frwikiversity","frwikivoyage","frwiktionary","furwiki","fywiki","fywikibooks","fywiktionary","gagwiki","ganwiki","gawiki","gawikibooks","gawikiquote","gawiktionary","gcrwiki","gdwiki","gdwiktionary","glkwiki","glwiki","glwikibooks","glwikiquote","glwikisource","glwiktionary","gnwiki","gnwikibooks","gnwiktionary","gomwiki","gomwiktionary","gorwiki","gorwiktionary","gotwiki","gotwikibooks","gpewiki","gucwiki","gurwiki","guwiki","guwikibooks","guwikiquote","guwikisource","guwiktionary","guwwiki","guwwikinews","guwwikiquote","guwwiktionary","gvwiki","gvwiktionary","hakwiki","hawiki","hawiktionary","hawwiki","hewiki","hewikibooks","hewikinews","hewikiquote","hewikisource","hewikivoyage","hewiktionary","hifwiki","hifwiktionary","hiwiki","hiwikibooks","hiwikiquote","hiwikisource","hiwikiversity","hiwikivoyage","hiwiktionary","howiki","hrwiki","hrwikibooks","hrwikiquote","hrwikisource","hrwiktionary","hsbwiki","hsbwiktionary","htwiki","htwikisource","huwiki","huwikibooks","huwikinews","huwikiquote","huwikisource","huwiktionary","hywiki","hywikibooks","hywikiquote","hywikisource","hywiktionary","hywwiki","hzwiki","iawiki","iawikibooks","iawiktionary","idwiki","idwikibooks","idwikiquote","idwikisource","idwiktionary","iewiki","iewikibooks","iewiktionary","igwiki","igwikiquote","igwiktionary","iiwiki","ikwiki","ikwiktionary","ilowiki","inhwiki","iowiki","iowiktionary","iswiki","iswikibooks","iswikiquote","iswikisource","iswiktionary","itwiki","itwikibooks","itwikinews","itwikiquote","itwikisource","itwikiversity","itwikivoyage","itwiktionary","iuwiki","iuwiktionary","jamwiki","jawiki","jawikibooks","jawikinews","jawikiquote","jawikisource","jawikiversity","jawikivoyage","jawiktionary","jbowiki","jbowiktionary","jvwiki","jvwikisource","jvwiktionary","kaawiki","kabwiki","kawiki","kawikibooks","kawikiquote","kawiktionary","kbdwiki","kbdwiktionary","kbpwiki","kcgwiki","kcgwiktionary","kgwiki","kiwiki","kjwiki","kkwiki","kkwikibooks","kkwikiquote","kkwiktionary","klwiki","klwiktionary","kmwiki","kmwikibooks","kmwiktionary","knwiki","knwikibooks","knwikiquote","knwikisource","knwiktionary","koiwiki","kowiki","kowikibooks","kowikinews","kowikiquote","kowikisource","kowikiversity","kowiktionary","krcwiki","krwiki","krwikiquote","kshwiki","kswiki","kswikibooks","kswikiquote","kswiktionary","kuwiki","kuwikibooks","kuwikiquote","kuwiktionary","kvwiki","kwwiki","kwwikiquote","kwwiktionary","kywiki","kywikibooks","kywikiquote","kywiktionary","ladwiki","lawiki","lawikibooks","lawikiquote","lawikisource","lawiktionary","lbewiki","lbwiki","lbwikibooks","lbwikiquote","lbwiktionary","lezwiki","lfnwiki","lgwiki","lijwiki","lijwikisource","liwiki","liwikibooks","liwikinews","liwikiquote","liwikisource","liwiktionary","lldwiki","lmowiki","lmowiktionary","lnwiki","lnwikibooks","lnwiktionary","lowiki","lowiktionary","lrcwiki","ltgwiki","ltwiki","ltwikibooks","ltwikiquote","ltwikisource","ltwiktionary","lvwiki","lvwikibooks","lvwiktionary","madwiki","maiwiki","map_bmswiki","mdfwiki","mediawikiwiki","metawiki","mgwiki","mgwikibooks","mgwiktionary","mhrwiki","mhwiki","mhwiktionary","minwiki","minwiktionary","miwiki","miwikibooks","miwiktionary","mkwiki","mkwikibooks","mkwikisource","mkwiktionary","mlwiki","mlwikibooks","mlwikiquote","mlwikisource","mlwiktionary","mniwiki","mniwiktionary","mnwiki","mnwikibooks","mnwiktionary","mnwwiki","mnwwiktionary","mowiki","mowiktionary","mrjwiki","mrwiki","mrwikibooks","mrwikiquote","mrwikisource","mrwiktionary","mswiki","mswikibooks","mswiktionary","mtwiki","mtwiktionary","muswiki","mwlwiki","myvwiki","mywiki","mywikibooks","mywiktionary","mznwiki","nahwiki","nahwikibooks","nahwiktionary","napwiki","napwikisource","nawiki","nawikibooks","nawikiquote","nawiktionary","nds_nlwiki","ndswiki","ndswikibooks","ndswikiquote","ndswiktionary","newiki","newikibooks","newiktionary","newwiki","ngwiki","niawiki","niawiktionary","nlwiki","nlwikibooks","nlwikinews","nlwikiquote","nlwikisource","nlwikivoyage","nlwiktionary","nnwiki","nnwikiquote","nnwiktionary","novwiki","nowiki","nowikibooks","nowikinews","nowikiquote","nowikisource","nowiktionary","nqowiki","nrmwiki","nsowiki","nvwiki","nywiki","ocwiki","ocwikibooks","ocwiktionary","olowiki","omwiki","omwiktionary","orwiki","orwikisource","orwiktionary","oswiki","outreachwiki","pagwiki","pamwiki","papwiki","pawiki","pawikibooks","pawikisource","pawiktionary","pcdwiki","pcmwiki","pdcwiki","pflwiki","pihwiki","piwiki","piwiktionary","plwiki","plwikibooks","plwikinews","plwikiquote","plwikisource","plwikivoyage","plwiktionary","pmswiki","pmswikisource","pnbwiki","pnbwiktionary","pntwiki","pswiki","pswikibooks","pswikivoyage","pswiktionary","ptwiki","ptwikibooks","ptwikinews","ptwikiquote","ptwikisource","ptwikiversity","ptwikivoyage","ptwiktionary","pwnwiki","quwiki","quwikibooks","quwikiquote","quwiktionary","rmwiki","rmwikibooks","rmwiktionary","rmywiki","rnwiki","rnwiktionary","roa_rupwiki","roa_rupwiktionary","roa_tarawiki","rowiki","rowikibooks","rowikinews","rowikiquote","rowikisource","rowikivoyage","rowiktionary","ruewiki","ruwiki","ruwikibooks","ruwikinews","ruwikiquote","ruwikisource","ruwikiversity","ruwikivoyage","ruwiktionary","rwwiki","rwwiktionary","sahwiki","sahwikiquote","sahwikisource","satwiki","sawiki","sawikibooks","sawikiquote","sawikisource","sawiktionary","scnwiki","scnwiktionary","scowiki","scwiki","scwiktionary","sdwiki","sdwikinews","sdwiktionary","sewiki","sewikibooks","sgwiki","sgwiktionary","shiwiki","shnwiki","shnwikibooks","shnwikivoyage","shnwiktionary","shwiki","shwiktionary","shywiktionary","simplewiki","simplewikibooks","simplewikiquote","simplewiktionary","siwiki","siwikibooks","siwiktionary","skrwiki","skrwiktionary","skwiki","skwikibooks","skwikiquote","skwikisource","skwiktionary","slwiki","slwikibooks","slwikiquote","slwikisource","slwikiversity","slwiktionary","smnwiki","smwiki","smwiktionary","snwiki","snwiktionary","sourceswiki","sowiki","sowiktionary","specieswiki","sqwiki","sqwikibooks","sqwikinews","sqwikiquote","sqwiktionary","srnwiki","srwiki","srwikibooks","srwikinews","srwikiquote","srwikisource","srwiktionary","sswiki","sswiktionary","stqwiki","stwiki","stwiktionary","suwiki","suwikibooks","suwikiquote","suwikisource","suwiktionary","svwiki","svwikibooks","svwikinews","svwikiquote","svwikisource","svwikiversity","svwikivoyage","svwiktionary","swwiki","swwikibooks","swwiktionary","szlwiki","szywiki","tawiki","tawikibooks","tawikinews","tawikiquote","tawikisource","tawiktionary","taywiki","tcywiki","tetwiki","tewiki","tewikibooks","tewikiquote","tewikisource","tewiktionary","tgwiki","tgwikibooks","tgwiktionary","thwiki","thwikibooks","thwikinews","thwikiquote","thwikisource","thwiktionary","tiwiki","tiwiktionary","tkwiki","tkwikibooks","tkwikiquote","tkwiktionary","tlwiki","tlwikibooks","tlwikiquote","tlwiktionary","tlywiki","tnwiki","tnwiktionary","towiki","towiktionary","tpiwiki","tpiwiktionary","trvwiki","trwiki","trwikibooks","trwikinews","trwikiquote","trwikisource","trwikivoyage","trwiktionary","tswiki","tswiktionary","ttwiki","ttwikibooks","ttwikiquote","ttwiktionary","tumwiki","twwiki","twwiktionary","tyvwiki","tywiki","udmwiki","ugwiki","ugwikibooks","ugwikiquote","ugwiktionary","ukwiki","ukwikibooks","ukwikinews","ukwikiquote","ukwikisource","ukwikivoyage","ukwiktionary","urwiki","urwikibooks","urwikiquote","urwiktionary","uzwiki","uzwikibooks","uzwikiquote","uzwiktionary","vecwiki","vecwikisource","vecwiktionary","vepwiki","vewiki","viwiki","viwikibooks","viwikiquote","viwikisource","viwikivoyage","viwiktionary","vlswiki","vowiki","vowikibooks","vowikiquote","vowiktionary","warwiki","wawiki","wawikibooks","wawikisource","wawiktionary","wikidatawiki","wikifunctionswiki","wikimaniawiki","wowiki","wowikiquote","wowiktionary","wuuwiki","xalwiki","xhwiki","xhwikibooks","xhwiktionary","xmfwiki","yiwiki","yiwikisource","yiwiktionary","yowiki","yowikibooks","yowiktionary","yuewiktionary","zawiki","zawikibooks","zawikiquote","zawiktionary","zeawiki","zghwiki","zh_classicalwiki","zh_min_nanwiki","zh_min_nanwikibooks","zh_min_nanwikiquote","zh_min_nanwikisource","zh_min_nanwiktionary","zh_yuewiki","zhwiki","zhwikibooks","zhwikinews","zhwikiquote","zhwikisource","zhwikiversity","zhwikivoyage","zhwiktionary","zuwiki","zuwikibooks","zuwiktionary"],B_e="https://www.wikidata.org/wiki/";function jz({site:t,title:e}){if(Ql(arguments),!t)throw new Error("missing a site");if(!e)throw new Error("missing a title");if(TE(G2,t))return G2[t](e);const n=t.replace(/wiki$/,"");if(TE(G2,n))return G2[n](e);const{lang:r,project:a}=Vz(t);return e=vz(h_e(e)),`https://${r}.${a}.org/wiki/${e}`}const vc=t=>e=>`https://${t}.wikimedia.org/wiki/${e}`,G2={commons:vc("commons"),foundation:vc("foundation"),mediawiki:t=>`https://www.mediawiki.org/wiki/${t}`,meta:vc("meta"),outreach:vc("outreach"),sources:t=>`https://wikisource.org/wiki/${t}`,species:vc("species"),wikidata:t=>{const e=z_e[t[0]];let n=e?`${e}:${t}`:t;return n=n.replace("-","#"),`${B_e}${n}`},wikifunctions:vc("wikifunctions"),wikimania:vc("wikimania")},z_e={E:"EntitySchema",L:"Lexeme",P:"Property"},j_e=/^https?:\/\/([\w-]{2,10})\.(\w+)\.org\/\w+\/(.*)/;function Vz(t){if(t.startsWith("http")){const e=t,n=e.match(j_e);if(!n)throw new Error(`invalid sitelink url: ${e}`);let[r,a,i]=n.slice(1);if(i=decodeURIComponent(i),r==="commons")return{lang:"en",project:"commons",key:"commons",title:i,url:e};if(!Tm(W_e,a))throw new Error(`project is unknown: ${a}`);if(r==="www")return{lang:"en",project:a,key:a,title:i,url:e};const o=`${r.replace(/-/g,"_")}${a}`.replace("wikipedia","wiki");return{lang:r,project:a,key:o,title:i,url:e}}else{if(TE(AE,t))return{lang:"en",project:AE[t],key:t};if(!Tm(PE,t))throw new Error(`site not found: ${t}. Updating wikibase-sdk to a more recent version might fix the issue.`);let[e,n,r]=t.split("wik");if(r!=null)throw new Error(`invalid sitelink key: ${t}`);e=e.replace(/_/g,"-");const a=Uz[n];if(!a)throw new Error(`sitelink project not found: ${a}`);return{lang:e,project:a,key:t}}}const Wz=t=>Tm(PE,t),V_e=Wz,Uz={i:"wikipedia",isource:"wikisource",iquote:"wikiquote",tionary:"wiktionary",ibooks:"wikibooks",iversity:"wikiversity",ivoyage:"wikivoyage",inews:"wikinews"},W_e=[...Object.values(Uz),...Object.values(AE)],U_e=Object.freeze(Object.defineProperty({__proto__:null,getSitelinkData:Vz,getSitelinkUrl:jz,isSite:Wz,isSitelinkKey:V_e},Symbol.toStringTag,{value:"Module"}));function Gz(t,e={}){let{addUrl:n,keepBadges:r,keepAll:a}=e;return r=r||a,Object.keys(t).reduce(G_e({sitelinks:t,addUrl:n,keepBadges:r}),{})}const G_e=({sitelinks:t,addUrl:e,keepBadges:n})=>(r,a)=>{if(t[a]==null)return r[a]=t[a],r;const{title:i,badges:o}=t[a];return e||n?(r[a]={title:i},e&&(r[a].url=jz({site:a,title:i})),n&&(r[a].badges=o)):r[a]=i,r},H_e={labels:$z,descriptions:Rz,aliases:Mz,claims:Mp,statements:Mp,sitelinks:Gz,lemmas:Az,forms:Fz,senses:zz},Hz=(t,e={})=>{const{type:n}=t,r={id:t.id,type:n,modified:t.modified};return n==="item"?(ha(t,r,"labels"),ha(t,r,"descriptions"),ha(t,r,"aliases"),ha(t,r,"claims",e),ha(t,r,"sitelinks",e)):n==="property"?(r.datatype=t.datatype,ha(t,r,"labels"),ha(t,r,"descriptions"),ha(t,r,"aliases"),ha(t,r,"claims",e)):n==="lexeme"?(ha(t,r,"lemmas"),r.lexicalCategory=t.lexicalCategory,r.language=t.language,ha(t,r,"claims",e),ha(t,r,"forms",e),ha(t,r,"senses",e)):n==="mediainfo"&&(ha(t,r,"labels"),ha(t,r,"descriptions"),ha(t,r,"statements",e)),r},ha=(t,e,n,r)=>{t[n]!=null&&(e[n]=H_e[n](t[n],r))},qz=(t,e={})=>{t.entities&&(t=t.entities);const{entityPrefix:n}=e,r={};for(const[a,i]of Object.entries(t)){const o=n?`${n}:${a}`:a;r[o]=Hz(i,e)}return r};function q_e(t){t=t.body||t;const{entities:e}=t;return qz(e)}function K_e(t){return t=t.body||t,t.query.search.map(e=>e.title)}const X_e=Object.freeze(Object.defineProperty({__proto__:null,entities:q_e,pagesTitles:K_e},Symbol.toStringTag,{value:"Module"}));function Y_e(t,e={}){typeof t=="string"&&(t=JSON.parse(t));const{vars:n}=t.head,r=t.results.bindings;if(n.length===1&&e.minimize){const s=n[0];return r.map(l=>LE(l[s])).filter(l=>l!=null)}const{richVars:a,associatedVars:i,standaloneVars:o}=J_e(n);return r.map(s=>e5e(a,i,o,s))}function LE(t){if(!t||t.type==="bnode")return null;const{value:e}=t;if(t.type==="uri")return Q_e(e);const n=(t.datatype||"").replace("http://www.w3.org/2001/XMLSchema#","");return n==="decimal"||n==="integer"||n==="float"||n==="double"?parseFloat(e):n==="boolean"?e==="true":e}function Q_e(t){return t.match(/http.*\/entity\/statement\//)?Z_e(t):t.replace(/^https?:\/\/.*\/entity\//,"").replace(/^https?:\/\/.*\/prop\/direct\//,"")}function Z_e(t){t=t.replace(/^https?:\/\/.*\/entity\/statement\//,"");const e=t.split("-");return e[0]+"$"+e.slice(1).join("-")}function J_e(t){let e=t.filter(i=>{const o=new RegExp(`^${i}[A-Z]\\w+`);return t.some(s=>o.test(s))});e=e.filter(i=>!e.some(o=>i!==o&&i.startsWith(o)));const n=new RegExp(`^(${e.join("|")})[A-Z]`),r=t.filter(i=>n.test(i)),a=t.filter(i=>!e.includes(i)&&!n.test(i));return{richVars:e,associatedVars:r,standaloneVars:a}}function e5e(t,e,n,r){const a={};for(const i of t){const o={},s=LE(r[i]);s!=null&&(o.value=s);for(const l of e)l.startsWith(i)&&t5e(r,i,l,o);Object.keys(o).length>0&&(a[i]=o)}for(const i of n){const o=LE(r[i]);o!=null&&(a[i]=o)}return a}function t5e(t,e,n,r){let a=n.split(e)[1];a=a[0].toLowerCase()+a.slice(1),a=a==="altLabel"?"aliases":a;const i=t[n];i!=null&&(r[a]=i.value)}const n5e=Object.freeze(Object.defineProperty({__proto__:null,aliases:Mz,claim:ME,claims:Mp,descriptions:Rz,entities:qz,entity:Hz,form:Dz,forms:Fz,glosses:Lz,labels:$z,lemmas:Az,propertyClaims:Iz,propertyQualifiers:A_e,propertySnaks:Iz,qualifier:P_e,qualifiers:Ez,references:_z,representations:Pz,sense:Bz,senses:zz,sitelinks:Gz,snak:ME,snaks:Mp,sparqlResults:Y_e},Symbol.toStringTag,{value:"Module"})),r5e=/^\d+[|\d]*$/;function a5e(t){return function(e){Ql(arguments);for(const[f,m]of Object.entries(e))if(f.startsWith("sr")){const y=f.replace(/^sr/,"");if(e[y]!=null)throw new Error(`${y} and ${f} are the same`);e[y]=m}const{search:n,haswbstatement:r,format:a="json",limit:i,offset:o,profile:s,sort:l}=e;let{namespace:u,prop:c}=e;if(!(n||r))throw new Error('missing "search" or "haswbstatement" parameter');let d="";if(n&&(d+=n),r){const f=r instanceof Array?r:[r];for(const m of f)m[0]==="-"?d+=` -haswbstatement:${m.slice(1)}`:d+=` haswbstatement:${m}`}if(i!=null&&(typeof i!="number"||i<1))throw new Error(`invalid limit: ${i}`);if(o!=null&&(typeof o!="number"||o<0))throw new Error(`invalid offset: ${o}`);if(u instanceof Array?u=u.join("|"):typeof u=="number"&&(u=u.toString()),u&&!r5e.test(u))throw new Error(`invalid namespace: ${u}`);if(s!=null&&typeof s!="string")throw new Error(`invalid profile: ${s} (${typeof s}, expected string)`);if(l!=null&&typeof l!="string")throw new Error(`invalid sort: ${l} (${typeof l}, expected string)`);let p;if(c!=null){if(c instanceof Array&&(c=c.join("|")),typeof c!="string")throw new Error(`invalid prop: ${c} (${typeof c}, expected string)`);p=c.toString()}return t({action:"query",list:"search",srsearch:d.trim(),format:a,srnamespace:u,srlimit:i,sroffset:o,srqiprofile:s,srsort:l,srprop:p})}}function H2(t,e){return function(n){if(!e(n))throw new Error(`invalid ${t}: ${n} (type: ${l5e(n)})`)}}const Kz=H2("entity id",NE),i5e=H2("property id",W2),o5e=H2("entity page title",yz),s5e=H2("revision id",gz);function l5e(t){const e=typeof t;if(e==="object"){if(t===null)return"null";if(t instanceof Array)return"array";if(t instanceof Promise)return"promise"}return e==="number"&&Number.isNaN(t)?"NaN":e}function Xz(t){return function({ids:e,languages:n,props:r,format:a="json",redirects:i}){if(Ql(arguments),!(e&&e.length>0))throw new Error("no id provided");e=Wo(e),e.forEach(s=>Kz(s)),e.length>50&&console.warn(`getEntities accepts 50 ids max to match Wikidata API limitations:
      this request won't get all the desired entities.
      You can use getManyEntities instead to generate several request urls
      to work around this limitation`);const o={action:"wbgetentities",ids:e.join("|"),format:a};return i===!1&&(o.redirects="no"),n&&(n=Wo(n),o.languages=n.join("|")),r&&r.length>0&&(o.props=Wo(r).join("|")),t(o)}}function u5e(t){return function({titles:e,sites:n,languages:r,props:a,format:i="json",redirects:o}){if(Ql(arguments),!(e&&e.length>0))throw new Error("no titles provided");n&&n.length>0||(n=["enwiki"]),e=Wo(e),n=Wo(n).map(c5e),a=Wo(a);const s={action:"wbgetentities",titles:e.join("|"),sites:n.join("|"),format:i};return n.length===1&&e.length===1&&(s.normalize=!0),r&&(r=Wo(r),s.languages=r.join("|")),a.length>0&&(s.props=a.join("|")),o===!1&&(s.redirects="no"),t(s)}}function c5e(t){return Tm(PE,t)?t:t.replace(/-/g,"_")+"wiki"}function d5e(t,e){return function({id:n,revision:r}){return Ql(arguments),Kz(n),s5e(r),`${t}/${e}/index.php?title=Special:EntityData/${n}.json&revision=${r}`}}function p5e(t){const e=Xz(t);return function({ids:n,languages:r,props:a,format:i,redirects:o}){if(Ql(arguments),!(n instanceof Array))throw new Error("getManyEntities expects an array of ids");return h5e(n).map(s=>e({ids:s,languages:r,props:a,format:i,redirects:o}))}}function h5e(t){const e=[];for(;t.length>0;){const n=t.slice(0,50);t=t.slice(50),e.push(n)}return e}function Yz(t){return function(e){const n=vz(e);return`${t}?format=json&query=${n}`}}const f5e="FILTER NOT EXISTS { ?subject rdf:type wikibase:Property . } ",g5e=t=>{const e=Yz(t);return function(n){let{properties:r}=n;const{values:a,limit:i,caseInsensitive:o,keepProperties:s}=n,l=o?b5e:y5e,u=s?"":f5e;r=Wo(r),r.forEach(d=>i5e(d));let c=`SELECT DISTINCT ?subject WHERE { ${m5e(a,l,r,u)} }`;return i&&(c+=` LIMIT ${i}`),e(c)}},m5e=(t,e,n,r)=>(n=n.map(v5e).join("|"),t instanceof Array?"{ "+t.map(Qz).map(a=>e(n,a,r)).join("} UNION {")+" }":e(n,Qz(t),r)),Qz=t=>(V2(t)?t=`wd:${t}`:typeof t=="string"&&(t=`'${t}'`),t),y5e=(t,e,n)=>`?subject ${t} ${e} .
    ${n}`,b5e=(t,e,n)=>`?subject ${t} ?value .
    FILTER (lcase(?value) = ${e.toLowerCase()})
    ${n}`,v5e=t=>"wdt:"+t;function x5e(t){return function({ids:e,format:n,limit:r,start:a,end:i,prop:o,user:s,excludeuser:l,tag:u}){Ql(arguments),e=Wo(e),e.forEach(p=>o5e(p));const c=e.length===1,d={action:"query",prop:"revisions"};return d.titles=e.join("|"),d.format=n||"json",c&&(d.rvlimit=r||"max"),c&&a&&(d.rvstart=Zz(a)),c&&i&&(d.rvend=Zz(i)),o?d.rvprop=Wo(o).join("|"):d.rvprop="ids|flags|timestamp|user|userid|size|slotsize|sha1|slotsha1|contentmodel|comment|parsedcomment|content|tags|roles|oresscores",d.rvslots="*",s&&(d.rvuser=s),l&&(d.rvexcludeuser=l),u&&(d.rvtag=u),t(d)}}const Zz=t=>typeof t=="number"&&t<w5e?t:Math.trunc(new Date(t).getTime()/1e3),w5e=new Date("2000-01-01").getTime(),k5e=["item","property","lexeme","form","sense"],S5e=t=>function({search:e,language:n="en",uselang:r,limit:a="20",continue:i="0",format:o="json",type:s="item"}){if(Ql(arguments),r=r||n,!(e&&e.length>0))throw new Error("search can't be empty");if(!Tm(k5e,s))throw new Error(`invalid type: ${s}`);return t({action:"wbsearchentities",search:e,language:n,limit:a,continue:i,format:o,uselang:r,type:s})},C5e=typeof location<"u"&&typeof document<"u";function N5e(t){return e=>{C5e&&(e=Object.assign(Object.assign({},e),{origin:"*"}));const n=Object.entries(e).filter(([,a])=>a!=null).map(([a,i])=>[a,String(i)]),r=new URLSearchParams(n).toString();return t+"?"+r}}const T5e=`Tip: if you just want to access functions that don't need an instance or a sparqlEndpoint,
those are also exposed directly on the module object. Exemple:
import { isItemId, simplify } from 'wikibase-sdk'`,I5e=Object.assign(Object.assign(Object.assign(Object.assign({simplify:n5e,parse:X_e},p_e),U_e),M_e),w_e);function E5e(t){if(!bz(t))throw new Error("invalid config");const{instance:e,sparqlEndpoint:n}=t;let{wgScriptPath:r="w"}=t;if(r=r.replace(/^\//,""),!(e||n))throw new Error(`one of instance or sparqlEndpoint should be set at initialization.
${T5e}`);let a,i,o;if(e){Jz("instance",e),i=e.replace(/\/$/,"").replace(`/${r}/api.php`,""),o=`${i}/${r}/api.php`;const l=N5e(o);a={searchEntities:S5e(l),cirrusSearchPages:a5e(l),getEntities:Xz(l),getManyEntities:p5e(l),getRevisions:x5e(l),getEntityRevision:d5e(e,r),getEntitiesFromSitelinks:u5e(l)}}else a={searchEntities:xc("searchEntities"),cirrusSearchPages:xc("cirrusSearchPages"),getEntities:xc("getEntities"),getManyEntities:xc("getManyEntities"),getRevisions:xc("getRevisions"),getEntityRevision:xc("getEntityRevision"),getEntitiesFromSitelinks:xc("getEntitiesFromSitelinks")};let s;return n?(Jz("sparqlEndpoint",n),s={sparqlQuery:Yz(n),getReverseClaims:g5e(n)}):s={sparqlQuery:tj("sparqlQuery"),getReverseClaims:tj("getReverseClaims")},Object.assign(Object.assign(Object.assign({instance:{root:i,apiEndpoint:o}},I5e),a),s)}const Jz=(t,e)=>{if(!(typeof e=="string"&&e.startsWith("http")))throw new Error(`invalid ${t}: ${e}`)},ej=t=>e=>()=>{throw new Error(`${e} requires ${t} to be set at initialization`)},tj=ej("a sparqlEndpoint"),xc=ej("an instance"),_5e={sparqlQuery:(t="")=>{const e=E5e({instance:"https://www.wikidata.org",sparqlEndpoint:"https://query.wikidata.org/sparql"}),n=`
      SELECT ?item ?itemLabel ?artworkLabel ?countryLabel ?genreLabel ?year ?locationLabel ?creatorLabel ?materialLabel ?depictsLabel ?collectionLabel ?iiifManifest
      WITH {    
        SELECT ?item (SAMPLE(?artwork) as ?artwork) (SAMPLE(?country) as ?country) (SAMPLE(?genre) as ?genre) (SAMPLE(YEAR(?inception)) as ?year) (SAMPLE(?location) as ?location) (SAMPLE(?creator) as ?creator) (SAMPLE(?material) as ?material) (SAMPLE(?depicts) as ?depicts) (SAMPLE(?collection) as ?collection) (SAMPLE(?iiifManifest) as ?iiifManifest)
        WHERE {
          ?item wdt:P6108 ?iiifManifest ;
                wdt:P195 ?collection ;
                wdt:P31 ?artwork .
                FILTER ( ?artwork = wd:Q3305213 || ?artwork = wd:Q93184 || ?artwork = wd:Q11060274 || ?artwork = wd:Q860861 || ?artwork = wd:Q125191 )
                ${t!==""?`FILTER ( ?material = ${t} )`:""}
                OPTIONAL {
                  ?item wdt:P495 ?countryOfOrigin.
                  FILTER(?countryOfOrigin = wd:Q31 || ?countryOfOrigin = wd:Q213 || ?countryOfOrigin = wd:Q35 || ?countryOfOrigin = wd:Q142 || ?countryOfOrigin = wd:Q36 || ?countryOfOrigin = wd:Q39 || ?countryOfOrigin = wd:Q32 || ?countryOfOrigin = wd:Q40 || ?countryOfOrigin = wd:Q55 || ?countryOfOrigin = wd:Q183 )
                }
                OPTIONAL {
                  ?collection wdt:P17 ?country.
                  FILTER(?country = wd:Q31 || ?country = wd:Q213 || ?country = wd:Q35 || ?country = wd:Q142 || ?country = wd:Q36 || ?country = wd:Q39 || ?country = wd:Q32 || ?country = wd:Q40 || ?country = wd:Q55 || ?country = wd:Q183 )
                }
                BIND(COALESCE(?countryOfOrigin, ?country) AS ?country)
                FILTER(BOUND(?country))

                OPTIONAL { ?item wdt:P136 ?genre. }
                OPTIONAL { ?item wdt:P571 ?inception. }
                OPTIONAL { ?item wdt:P276 ?location. }
                OPTIONAL { ?item wdt:P170 ?creator. }
                OPTIONAL { ?item wdt:P186 ?material. }
                OPTIONAL { ?item wdt:P180 ?depicts. }
        }
        GROUP BY ?item
        LIMIT 10
      } AS %result
      WHERE {
        INCLUDE %result.
        SERVICE wikibase:label { bd:serviceParam wikibase:language "[AUTO_LANGUAGE],en". }
      } ORDER BY ?itemLabel
    `;return e.sparqlQuery(n)}},O5e=()=>{const[t,e]=R.useState([]),[n,r]=R.useState(!0),[a,i]=R.useState(null);return R.useEffect(()=>{(async()=>{try{const o=await fetch(_5e.sparqlQuery());if(!o.ok)throw new Error(`Error: ${o.status} - ${o.statusText}`);const s=await o.json();e(s.results.bindings)}catch(o){i(o.message)}finally{r(!1)}})()},[]),{data:t,loading:n,error:a}},nj=({onClick:t,materialIcon:e})=>se.jsx(jn,{className:"p-4 text-xl text-black",onClick:t,rounded:!0,inline:!0,children:se.jsx(aa,{material:e})});function $5e(){const{t}=Eu(),[e,n]=R.useState(0),{addToImageList:r,imageList:a,removeFromImageList:i}=ps(),{data:o}=O5e(),s=ps(b=>b.likeImage),l=R.useRef(e),u=R.useRef(null),c=R.useCallback(async b=>{if(!b)return;const v=async S=>{try{return await J7.fetchIIIFIdentifier(S)}catch(C){return console.error("Error:",C),null}},w=(await Promise.all(b.map(async S=>{var C,I,_,E,P;try{const A=await v(S.iiifManifest.value);return A!==null?{id:S.item.value,name:S.itemLabel.value||"",year:((C=S.year)==null?void 0:C.value)||"",country:(I=S.countryLabel)==null?void 0:I.value,location:((_=S?.locationLabel)==null?void 0:_.value)||"",creator:((E=S.creatorLabel)==null?void 0:E.value)||"",url:(P=S.iiifManifest)==null?void 0:P.value,identifier:A,image:`${A}/full/400,/0/default.jpg`,thumbnail:`${A}/full/100,100/0/default.jpg`}:null}catch(A){return console.error("Error processing image:",A),null}}))).filter(S=>S!==null);r(w)},[r]);R.useEffect(()=>{o.length>0&&c(o)},[o]);const d=b=>{n(b),l.current=b},p=e>=0,f=(b,v)=>{b==="right"&&s(x),i(x.id),d(v+1)},m=b=>{var v;l.current>=b&&((v=u.current)==null||v.restoreCard())},y=async b=>{var v;p&&e<a.length&&await((v=u.current)==null?void 0:v.swipe(b))},x=a[e];return se.jsxs(to,{className:"flex flex-col flex-wrap gap-4 container justify-center content-center text-center mx-auto",children:[se.jsx("div",{className:"p-2 m-4",children:se.jsx("h1",{className:"text-2xl",children:t("selectionTitle")})}),se.jsx("div",{className:"mx-auto h-2/3",children:se.jsx(KM,{className:"flex shadow-md shadow-[#BC13FE]/90",children:x&&se.jsxs(se.Fragment,{children:[se.jsx(n_e,{ref:u,className:"mb-4",onSwipe:b=>f(b,e),onCardLeftScreen:()=>m(e),preventSwipe:["up","down"],children:se.jsx("img",{alt:x.name,src:x.image})},x.id),se.jsxs("div",{className:"flex justify-between",children:[se.jsx(nj,{onClick:()=>y("left"),materialIcon:se.jsx(JQ,{className:"w-6 h-6"})}),se.jsx(nj,{onClick:()=>y("right"),materialIcon:se.jsx(nZ,{className:"w-6 h-6"})})]})]})})}),se.jsxs("div",{className:"mb-8 p-4 bg-white rounded h-1/3 opacity-90 max-w-lg w-2/3 text-center mx-auto shadow-md shadow-[#BC13FE]/90",children:[se.jsx("h2",{className:"text-2xl font-bold mb-4 text-black",children:x?.name}),se.jsxs("p",{className:"text-gray-600",children:[t("selectionYear")," ",x?.year!==""?x?.year:t("selectionUnknown")]}),se.jsxs("p",{className:"text-gray-600",children:[t("selectionCreator")," ",x?.creator!==""?x?.creator:t("selectionUnknown")]}),se.jsxs("p",{className:"text-gray-600",children:[t("selectionLocation")," ",x?.location!==""?x?.location:t("selectionUnknown")]})]})]})}const R5e="/collage.webp",M5e="/logo_animated.svg",A5e=()=>se.jsx("img",{src:M5e,alt:"Logo GLAMorous Europe",className:"w-96 m-auto"}),P5e=()=>se.jsx("img",{src:R5e,alt:"Collage GLAMorous Europe",className:"w-96 m-auto",decoding:"async"});function L5e(){const{t}=Eu(),{imageLikeList:e,resetState:n}=ps(),[r,a]=R.useState(!1),i=()=>{e.length>0?a(!0):window.location.href="/selection"},o=()=>{a(!1)},s=()=>{a(!1),n()};return se.jsxs(to,{className:"flex flex-col flex-wrap gap-4 container justify-center content-center text-center mx-auto",children:[se.jsx(A5e,{}),se.jsx("h1",{className:"text-3xl",children:t("startTitle")}),se.jsx(P5e,{}),se.jsx("p",{className:"text-xl",children:t("startText")}),se.jsx(jn,{large:!0,className:"text-4xl w-1/2 mx-auto h-16",rounded:!0,inline:!0,onClick:i,children:t("startButtonText")}),r&&se.jsx(e6,{opened:r,onBackdropClick:()=>a(!1),children:se.jsxs(py,{children:[se.jsx(uy,{title:t("discardModalTitle"),right:se.jsx(ny,{to:"/",onClick:o,children:t("discardModalCancel")})}),se.jsxs(to,{className:"space-y-4",children:[se.jsx("p",{children:t("discardModalMessage")}),se.jsx(jn,{className:"p-4 rounded-full text-xl bg-red-500 text-white",children:se.jsx(ny,{to:"/selection",onClick:s,children:t("discardModalConfirm")})}),se.jsx(jn,{className:"p-4 rounded-full text-xl bg-red-500 text-white",onClick:o,children:t("discardModalNotConfirm")})]})]})})]})}function D5e(){return se.jsx(Kq,{children:se.jsxs(Cd,{path:"/",element:se.jsx(y4e,{}),children:[se.jsx(Cd,{index:!0,element:se.jsx(L5e,{})}),se.jsx(Cd,{path:"selection",element:se.jsx($5e,{})}),se.jsx(Cd,{path:"collection",element:se.jsx(l4e,{})}),se.jsx(Cd,{path:"creation",element:se.jsx(Rre,{})})]})})}const F5e={artwork:"Meine Leinwand",artworkEmpty:"F\xFCge deine eigenen Bildausschnitte hinzu",artworkTitle:"Ziehe die Ausschnitte oder vorbereiteten Sticker in die Leinwand. Du kannst sie ver\xE4ndern und die Leinwand austauschen. Gestalte dein eigenes Kunstwerk und teile es mit deinen Freund:innen!",chooseLanguage:"Sprache w\xE4hlen:",collection:"Meine Sammlung",collectionAddText:"Ausschnitt hinzuf\xFCgen",collectionClose:"Schlie\xDFen",collectionLoading:"Lade...",collectionTitle:"W\xE4hle Bildausschnitte aus deinen Lieblingsobjekten aus, um sie deiner Leinwand hinzuzuf\xFCgen.",discardModalCancel:"Abbrechen",discardModalConfirm:"Ja",discardModalMessage:"M\xF6chtest du deine bisherige Auswahl verwerfen?",discardModalNotConfirm:"Nein",discardModalTitle:"Bisherige Auswahl",selection:"Meine Auswahl",selectionCreator:"K\xFCnstler:in:",selectionLocation:"Sammlungsort:",selectionTitle:"W\xE4hle deine Lieblingsobjekte per Swipe oder Klick. F\xFCge sie somit zu deiner Sammlung hinzu.",selectionUnknown:"Unbekannt",selectionYear:"Entstehungsjahr:",sidebarAbout:"\xDCber uns",sidebarChooseLanguage:"Sprache",sidebarLegal:"Impressum",start:"Start",startButtonText:"Los geht's!",startText:"Durchst\xF6bere Kunstwerke aus Museen, Galerien, Bibliotheken und Archiven. Sammle deine Lieblingsobjekte, w\xE4hle daraus Motive aus und gestalte dein ganz pers\xF6nliches Kunstwerk.",startTitle:"Entdecke mit GLAMorous Europe europ\xE4isches Kulturerbe!"},B5e={translation:F5e},z5e={artwork:"My Canvas",artworkEmpty:"Add your image details.",artworkTitle:"Drag the image details or prepared stickers onto the canvas. You can change them and replace the canvas. Create your own work of art and share it with your friends!",chooseLanguage:"Choose Language:",collection:"My Collection",collectionAddText:"Add choosen detail",collectionClose:"Close",collectionLoading:"Loading...",collectionTitle:"Select image details from your favorites to add them to your canvas.",discardModalCancel:"Close",discardModalConfirm:"Yes",discardModalMessage:"Would you like to discard your previous selection?",discardModalNotConfirm:"No",discardModalTitle:"Current selection",selection:"My Selection",selectionCreator:"Artist:",selectionLocation:"Location:",selectionTitle:"Select your favorites by swiping or clicking. This will add them to your collection.",selectionUnknown:"Unknown",selectionYear:"Year of creation:",sidebarAbout:"About",sidebarChooseLanguage:"Language",sidebarLegal:"Legal",start:"Start",startButtonText:"Let's go!",startText:"Explore works of art from museums, galleries, libraries and archives. Collect your favorite objects, select details from them and create your very own work of art.",startTitle:"Dating European cultural heritage with GLAMorous Europe!"},j5e={translation:z5e};Lr.init({interpolation:{escapeValue:!1},lng:"auto",fallbackLng:"de",resources:{de:{...B5e},en:{...j5e}}}),yM(document.getElementById("root")).render(se.jsx(G.StrictMode,{children:se.jsx(rq,{i18n:Lr,children:se.jsx(YW,{backend:BU,children:se.jsx(nK,{children:se.jsx(D5e,{})})})})}));export{T5 as $,fk as a,AV as b,MV as c,W5 as d,X1 as e,G as f,ba as g,VL as h,gi as i,VH as j,R as r};function q2(t){return q2.viteFileDeps||(q2.viteFileDeps=[]),t.map(e=>q2.viteFileDeps[e])}
